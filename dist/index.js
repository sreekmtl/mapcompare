(()=>{"use strict";var t={874:t=>{t.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},788:(t,e,n)=>{n.d(e,{Z:()=>a});var i=n(81),o=n.n(i),s=n(645),r=n.n(s)()(o());r.push([t.id,':root,\n:host {\n  --ol-background-color: white;\n  --ol-accent-background-color: #F5F5F5;\n  --ol-subtle-background-color: rgba(128, 128, 128, 0.25);\n  --ol-partial-background-color: rgba(255, 255, 255, 0.75);\n  --ol-foreground-color: #333333;\n  --ol-subtle-foreground-color: #666666;\n  --ol-brand-color: #00AAFF;\n}\n\n.ol-box {\n  box-sizing: border-box;\n  border-radius: 2px;\n  border: 1.5px solid var(--ol-background-color);\n  background-color: var(--ol-partial-background-color);\n}\n\n.ol-mouse-position {\n  top: 8px;\n  right: 8px;\n  position: absolute;\n}\n\n.ol-scale-line {\n  background: var(--ol-partial-background-color);\n  border-radius: 4px;\n  bottom: 8px;\n  left: 8px;\n  padding: 2px;\n  position: absolute;\n}\n\n.ol-scale-line-inner {\n  border: 1px solid var(--ol-subtle-foreground-color);\n  border-top: none;\n  color: var(--ol-foreground-color);\n  font-size: 10px;\n  text-align: center;\n  margin: 1px;\n  will-change: contents, width;\n  transition: all 0.25s;\n}\n\n.ol-scale-bar {\n  position: absolute;\n  bottom: 8px;\n  left: 8px;\n}\n\n.ol-scale-bar-inner {\n  display: flex;\n}\n\n.ol-scale-step-marker {\n  width: 1px;\n  height: 15px;\n  background-color: var(--ol-foreground-color);\n  float: right;\n  z-index: 10;\n}\n\n.ol-scale-step-text {\n  position: absolute;\n  bottom: -5px;\n  font-size: 10px;\n  z-index: 11;\n  color: var(--ol-foreground-color);\n  text-shadow: -1.5px 0 var(--ol-partial-background-color), 0 1.5px var(--ol-partial-background-color), 1.5px 0 var(--ol-partial-background-color), 0 -1.5px var(--ol-partial-background-color);\n}\n\n.ol-scale-text {\n  position: absolute;\n  font-size: 12px;\n  text-align: center;\n  bottom: 25px;\n  color: var(--ol-foreground-color);\n  text-shadow: -1.5px 0 var(--ol-partial-background-color), 0 1.5px var(--ol-partial-background-color), 1.5px 0 var(--ol-partial-background-color), 0 -1.5px var(--ol-partial-background-color);\n}\n\n.ol-scale-singlebar {\n  position: relative;\n  height: 10px;\n  z-index: 9;\n  box-sizing: border-box;\n  border: 1px solid var(--ol-foreground-color);\n}\n\n.ol-scale-singlebar-even {\n  background-color: var(--ol-subtle-foreground-color);\n}\n\n.ol-scale-singlebar-odd {\n  background-color: var(--ol-background-color);\n}\n\n.ol-unsupported {\n  display: none;\n}\n\n.ol-viewport,\n.ol-unselectable {\n  -webkit-touch-callout: none;\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  user-select: none;\n  -webkit-tap-highlight-color: transparent;\n}\n\n.ol-viewport canvas {\n  all: unset;\n  overflow: hidden;\n}\n\n.ol-viewport {\n  touch-action: pan-x pan-y;\n}\n\n.ol-selectable {\n  -webkit-touch-callout: default;\n  -webkit-user-select: text;\n  -moz-user-select: text;\n  user-select: text;\n}\n\n.ol-grabbing {\n  cursor: -webkit-grabbing;\n  cursor: -moz-grabbing;\n  cursor: grabbing;\n}\n\n.ol-grab {\n  cursor: move;\n  cursor: -webkit-grab;\n  cursor: -moz-grab;\n  cursor: grab;\n}\n\n.ol-control {\n  position: absolute;\n  background-color: var(--ol-subtle-background-color);\n  border-radius: 4px;\n}\n\n.ol-zoom {\n  top: .5em;\n  left: .5em;\n}\n\n.ol-rotate {\n  top: .5em;\n  right: .5em;\n  transition: opacity .25s linear, visibility 0s linear;\n}\n\n.ol-rotate.ol-hidden {\n  opacity: 0;\n  visibility: hidden;\n  transition: opacity .25s linear, visibility 0s linear .25s;\n}\n\n.ol-zoom-extent {\n  top: 4.643em;\n  left: .5em;\n}\n\n.ol-full-screen {\n  right: .5em;\n  top: .5em;\n}\n\n.ol-control button {\n  display: block;\n  margin: 1px;\n  padding: 0;\n  color: var(--ol-subtle-foreground-color);\n  font-weight: bold;\n  text-decoration: none;\n  font-size: inherit;\n  text-align: center;\n  height: 1.375em;\n  width: 1.375em;\n  line-height: .4em;\n  background-color: var(--ol-background-color);\n  border: none;\n  border-radius: 2px;\n}\n\n.ol-control button::-moz-focus-inner {\n  border: none;\n  padding: 0;\n}\n\n.ol-zoom-extent button {\n  line-height: 1.4em;\n}\n\n.ol-compass {\n  display: block;\n  font-weight: normal;\n  will-change: transform;\n}\n\n.ol-touch .ol-control button {\n  font-size: 1.5em;\n}\n\n.ol-touch .ol-zoom-extent {\n  top: 5.5em;\n}\n\n.ol-control button:hover,\n.ol-control button:focus {\n  text-decoration: none;\n  outline: 1px solid var(--ol-subtle-foreground-color);\n  color: var(--ol-foreground-color);\n}\n\n.ol-zoom .ol-zoom-in {\n  border-radius: 2px 2px 0 0;\n}\n\n.ol-zoom .ol-zoom-out {\n  border-radius: 0 0 2px 2px;\n}\n\n.ol-attribution {\n  text-align: right;\n  bottom: .5em;\n  right: .5em;\n  max-width: calc(100% - 1.3em);\n  display: flex;\n  flex-flow: row-reverse;\n  align-items: center;\n}\n\n.ol-attribution a {\n  color: var(--ol-subtle-foreground-color);\n  text-decoration: none;\n}\n\n.ol-attribution ul {\n  margin: 0;\n  padding: 1px .5em;\n  color: var(--ol-foreground-color);\n  text-shadow: 0 0 2px var(--ol-background-color);\n  font-size: 12px;\n}\n\n.ol-attribution li {\n  display: inline;\n  list-style: none;\n}\n\n.ol-attribution li:not(:last-child):after {\n  content: " ";\n}\n\n.ol-attribution img {\n  max-height: 2em;\n  max-width: inherit;\n  vertical-align: middle;\n}\n\n.ol-attribution button {\n  flex-shrink: 0;\n}\n\n.ol-attribution.ol-collapsed ul {\n  display: none;\n}\n\n.ol-attribution:not(.ol-collapsed) {\n  background: var(--ol-partial-background-color);\n}\n\n.ol-attribution.ol-uncollapsible {\n  bottom: 0;\n  right: 0;\n  border-radius: 4px 0 0;\n}\n\n.ol-attribution.ol-uncollapsible img {\n  margin-top: -.2em;\n  max-height: 1.6em;\n}\n\n.ol-attribution.ol-uncollapsible button {\n  display: none;\n}\n\n.ol-zoomslider {\n  top: 4.5em;\n  left: .5em;\n  height: 200px;\n}\n\n.ol-zoomslider button {\n  position: relative;\n  height: 10px;\n}\n\n.ol-touch .ol-zoomslider {\n  top: 5.5em;\n}\n\n.ol-overviewmap {\n  left: 0.5em;\n  bottom: 0.5em;\n}\n\n.ol-overviewmap.ol-uncollapsible {\n  bottom: 0;\n  left: 0;\n  border-radius: 0 4px 0 0;\n}\n\n.ol-overviewmap .ol-overviewmap-map,\n.ol-overviewmap button {\n  display: block;\n}\n\n.ol-overviewmap .ol-overviewmap-map {\n  border: 1px solid var(--ol-subtle-foreground-color);\n  height: 150px;\n  width: 150px;\n}\n\n.ol-overviewmap:not(.ol-collapsed) button {\n  bottom: 0;\n  left: 0;\n  position: absolute;\n}\n\n.ol-overviewmap.ol-collapsed .ol-overviewmap-map,\n.ol-overviewmap.ol-uncollapsible button {\n  display: none;\n}\n\n.ol-overviewmap:not(.ol-collapsed) {\n  background: var(--ol-subtle-background-color);\n}\n\n.ol-overviewmap-box {\n  border: 1.5px dotted var(--ol-subtle-foreground-color);\n}\n\n.ol-overviewmap .ol-overviewmap-box:hover {\n  cursor: move;\n}\n',""]);const a=r},828:(t,e,n)=>{n.d(e,{Z:()=>a});var i=n(81),o=n.n(i),s=n(645),r=n.n(s)()(o());r.push([t.id,'* {\n    box-sizing: border-box;\n  }\n.column {\n    float: left;\n    width: 50%;\n    padding: 10px;\n    height: 640px; /* Should be removed. Only for demonstration */\n  }\n  \n  /* Clear floats after the columns */\n  .row:after {\n    content: "";\n    display: table;\n    clear: both;\n  }\n\n.button {\n    background-color: #4CAF50; /* Green */\n    width: 50px;\n    height: 20px;\n    border: none;\n    color: white;\n    padding: 10px 16px;\n    text-align: center;\n    text-decoration: none;\n    display: inline-block;\n    font-size: 12px;\n  }',""]);const a=r},645:t=>{t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n="",i=void 0!==e[5];return e[4]&&(n+="@supports (".concat(e[4],") {")),e[2]&&(n+="@media ".concat(e[2]," {")),i&&(n+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),n+=t(e),i&&(n+="}"),e[2]&&(n+="}"),e[4]&&(n+="}"),n})).join("")},e.i=function(t,n,i,o,s){"string"==typeof t&&(t=[[null,t,void 0]]);var r={};if(i)for(var a=0;a<this.length;a++){var l=this[a][0];null!=l&&(r[l]=!0)}for(var h=0;h<t.length;h++){var c=[].concat(t[h]);i&&r[c[0]]||(void 0!==s&&(void 0===c[5]||(c[1]="@layer".concat(c[5].length>0?" ".concat(c[5]):""," {").concat(c[1],"}")),c[5]=s),n&&(c[2]?(c[1]="@media ".concat(c[2]," {").concat(c[1],"}"),c[2]=n):c[2]=n),o&&(c[4]?(c[1]="@supports (".concat(c[4],") {").concat(c[1],"}"),c[4]=o):c[4]="".concat(o)),e.push(c))}},e}},81:t=>{t.exports=function(t){return t[1]}},148:t=>{t.exports=function(t,o,r,a,l,h){if(!n(t)||!n(o)||r&&!n(r))throw new Error("Image data: Uint8Array, Uint8ClampedArray or Buffer expected.");if(t.length!==o.length||r&&r.length!==t.length)throw new Error("Image sizes do not match.");if(t.length!==a*l*4)throw new Error("Image data size does not match width/height.");h=Object.assign({},e,h);const d=a*l,g=new Uint32Array(t.buffer,t.byteOffset,d),p=new Uint32Array(o.buffer,o.byteOffset,d);let m=!0;for(let t=0;t<d;t++)if(g[t]!==p[t]){m=!1;break}if(m){if(r&&!h.diffMask)for(let e=0;e<d;e++)u(t,4*e,h.alpha,r);return 0}const _=35215*h.threshold*h.threshold;let f=0;for(let e=0;e<l;e++)for(let n=0;n<a;n++){const d=4*(e*a+n),g=s(t,o,d,d);Math.abs(g)>_?h.includeAA||!i(t,n,e,a,l,o)&&!i(o,n,e,a,l,t)?(r&&c(r,d,...g<0&&h.diffColorAlt||h.diffColor),f++):r&&!h.diffMask&&c(r,d,...h.aaColor):r&&(h.diffMask||u(t,d,h.alpha,r))}return f};const e={threshold:.1,includeAA:!1,alpha:.1,aaColor:[255,255,0],diffColor:[255,0,0],diffColorAlt:null,diffMask:!1};function n(t){return ArrayBuffer.isView(t)&&1===t.constructor.BYTES_PER_ELEMENT}function i(t,e,n,i,r,a){const l=Math.max(e-1,0),h=Math.max(n-1,0),c=Math.min(e+1,i-1),u=Math.min(n+1,r-1),d=4*(n*i+e);let g,p,m,_,f=e===l||e===c||n===h||n===u?1:0,v=0,y=0;for(let o=l;o<=c;o++)for(let r=h;r<=u;r++){if(o===e&&r===n)continue;const a=s(t,t,d,4*(r*i+o),!0);if(0===a){if(f++,f>2)return!1}else a<v?(v=a,g=o,p=r):a>y&&(y=a,m=o,_=r)}return 0!==v&&0!==y&&(o(t,g,p,i,r)&&o(a,g,p,i,r)||o(t,m,_,i,r)&&o(a,m,_,i,r))}function o(t,e,n,i,o){const s=Math.max(e-1,0),r=Math.max(n-1,0),a=Math.min(e+1,i-1),l=Math.min(n+1,o-1),h=4*(n*i+e);let c=e===s||e===a||n===r||n===l?1:0;for(let o=s;o<=a;o++)for(let s=r;s<=l;s++){if(o===e&&s===n)continue;const r=4*(s*i+o);if(t[h]===t[r]&&t[h+1]===t[r+1]&&t[h+2]===t[r+2]&&t[h+3]===t[r+3]&&c++,c>2)return!0}return!1}function s(t,e,n,i,o){let s=t[n+0],c=t[n+1],u=t[n+2],d=t[n+3],g=e[i+0],p=e[i+1],m=e[i+2],_=e[i+3];if(d===_&&s===g&&c===p&&u===m)return 0;d<255&&(d/=255,s=h(s,d),c=h(c,d),u=h(u,d)),_<255&&(_/=255,g=h(g,_),p=h(p,_),m=h(m,_));const f=r(s,c,u),v=r(g,p,m),y=f-v;if(o)return y;const x=a(s,c,u)-a(g,p,m),C=l(s,c,u)-l(g,p,m),w=.5053*y*y+.299*x*x+.1957*C*C;return f>v?-w:w}function r(t,e,n){return.29889531*t+.58662247*e+.11448223*n}function a(t,e,n){return.59597799*t-.2741761*e-.32180189*n}function l(t,e,n){return.21147017*t-.52261711*e+.31114694*n}function h(t,e){return 255+(t-255)*e}function c(t,e,n,i,o){t[e+0]=n,t[e+1]=i,t[e+2]=o,t[e+3]=255}function u(t,e,n,i){const o=h(r(t[e+0],t[e+1],t[e+2]),n*t[e+3]/255);c(i,e,o,o,o)}},379:t=>{var e=[];function n(t){for(var n=-1,i=0;i<e.length;i++)if(e[i].identifier===t){n=i;break}return n}function i(t,i){for(var s={},r=[],a=0;a<t.length;a++){var l=t[a],h=i.base?l[0]+i.base:l[0],c=s[h]||0,u="".concat(h," ").concat(c);s[h]=c+1;var d=n(u),g={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==d)e[d].references++,e[d].updater(g);else{var p=o(g,i);i.byIndex=a,e.splice(a,0,{identifier:u,updater:p,references:1})}r.push(u)}return r}function o(t,e){var n=e.domAPI(e);return n.update(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap&&e.supports===t.supports&&e.layer===t.layer)return;n.update(t=e)}else n.remove()}}t.exports=function(t,o){var s=i(t=t||[],o=o||{});return function(t){t=t||[];for(var r=0;r<s.length;r++){var a=n(s[r]);e[a].references--}for(var l=i(t,o),h=0;h<s.length;h++){var c=n(s[h]);0===e[c].references&&(e[c].updater(),e.splice(c,1))}s=l}}},569:t=>{var e={};t.exports=function(t,n){var i=function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}e[t]=n}return e[t]}(t);if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");i.appendChild(n)}},216:t=>{t.exports=function(t){var e=document.createElement("style");return t.setAttributes(e,t.attributes),t.insert(e,t.options),e}},565:(t,e,n)=>{t.exports=function(t){var e=n.nc;e&&t.setAttribute("nonce",e)}},795:t=>{t.exports=function(t){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var e=t.insertStyleElement(t);return{update:function(n){!function(t,e,n){var i="";n.supports&&(i+="@supports (".concat(n.supports,") {")),n.media&&(i+="@media ".concat(n.media," {"));var o=void 0!==n.layer;o&&(i+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),i+=n.css,o&&(i+="}"),n.media&&(i+="}"),n.supports&&(i+="}");var s=n.sourceMap;s&&"undefined"!=typeof btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(s))))," */")),e.styleTagTransform(i,t,e.options)}(e,t,n)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)}}}},589:t=>{t.exports=function(t,e){if(e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}}},e={};function n(i){var o=e[i];if(void 0!==o)return o.exports;var s=e[i]={id:i,exports:{}};return t[i](s,s.exports,n),s.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var i in e)n.o(e,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.nc=void 0,(()=>{const t=class{constructor(t){this.propagationStopped,this.defaultPrevented,this.type=t,this.target=null}preventDefault(){this.defaultPrevented=!0}stopPropagation(){this.propagationStopped=!0}},e="propertychange",i=class{constructor(){this.disposed=!1}dispose(){this.disposed||(this.disposed=!0,this.disposeInternal())}disposeInternal(){}};function o(t,e){return t>e?1:t<e?-1:0}function s(t,e,n){if(t[0]<=e)return 0;const i=t.length;if(e<=t[i-1])return i-1;if("function"==typeof n){for(let o=1;o<i;++o){const i=t[o];if(i===e)return o;if(i<e)return n(e,t[o-1],i)>0?o-1:o}return i-1}if(n>0){for(let n=1;n<i;++n)if(t[n]<e)return n-1;return i-1}if(n<0){for(let n=1;n<i;++n)if(t[n]<=e)return n;return i-1}for(let n=1;n<i;++n){if(t[n]==e)return n;if(t[n]<e)return t[n-1]-e<e-t[n]?n-1:n}return i-1}function r(t,e){const n=t.length;if(n!==e.length)return!1;for(let i=0;i<n;i++)if(t[i]!==e[i])return!1;return!0}function a(){return!0}function l(){return!1}function h(){}function c(t){for(const e in t)delete t[e]}const u=class extends i{constructor(t){super(),this.eventTarget_=t,this.pendingRemovals_=null,this.dispatching_=null,this.listeners_=null}addEventListener(t,e){if(!t||!e)return;const n=this.listeners_||(this.listeners_={}),i=n[t]||(n[t]=[]);i.includes(e)||i.push(e)}dispatchEvent(e){const n="string"==typeof e,i=n?e:e.type,o=this.listeners_&&this.listeners_[i];if(!o)return;const s=n?new t(e):e;s.target||(s.target=this.eventTarget_||this);const r=this.dispatching_||(this.dispatching_={}),a=this.pendingRemovals_||(this.pendingRemovals_={});let l;i in r||(r[i]=0,a[i]=0),++r[i];for(let t=0,e=o.length;t<e;++t)if(l="handleEvent"in o[t]?o[t].handleEvent(s):o[t].call(this,s),!1===l||s.propagationStopped){l=!1;break}if(0==--r[i]){let t=a[i];for(delete a[i];t--;)this.removeEventListener(i,h);delete r[i]}return l}disposeInternal(){this.listeners_&&c(this.listeners_)}getListeners(t){return this.listeners_&&this.listeners_[t]||void 0}hasListener(t){return!!this.listeners_&&(t?t in this.listeners_:Object.keys(this.listeners_).length>0)}removeEventListener(t,e){if(!this.listeners_)return;const n=this.listeners_[t];if(!n)return;const i=n.indexOf(e);-1!==i&&(this.pendingRemovals_&&t in this.pendingRemovals_?(n[i]=h,++this.pendingRemovals_[t]):(n.splice(i,1),0===n.length&&delete this.listeners_[t]))}},d="change",g="contextmenu",p="click",m="keydown",_="keypress",f="touchmove",v="wheel";function y(t,e,n,i,o){if(i&&i!==t&&(n=n.bind(i)),o){const i=n;n=function(){t.removeEventListener(e,n),i.apply(this,arguments)}}const s={target:t,type:e,listener:n};return t.addEventListener(e,n),s}function x(t,e,n,i){return y(t,e,n,i,!0)}function C(t){t&&t.target&&(t.target.removeEventListener(t.type,t.listener),c(t))}class w extends u{constructor(){super(),this.on=this.onInternal,this.once=this.onceInternal,this.un=this.unInternal,this.revision_=0}changed(){++this.revision_,this.dispatchEvent(d)}getRevision(){return this.revision_}onInternal(t,e){if(Array.isArray(t)){const n=t.length,i=new Array(n);for(let o=0;o<n;++o)i[o]=y(this,t[o],e);return i}return y(this,t,e)}onceInternal(t,e){let n;if(Array.isArray(t)){const i=t.length;n=new Array(i);for(let o=0;o<i;++o)n[o]=x(this,t[o],e)}else n=x(this,t,e);return e.ol_key=n,n}unInternal(t,e){const n=e.ol_key;if(n)!function(t){if(Array.isArray(t))for(let e=0,n=t.length;e<n;++e)C(t[e]);else C(t)}(n);else if(Array.isArray(t))for(let n=0,i=t.length;n<i;++n)this.removeEventListener(t[n],e);else this.removeEventListener(t,e)}}w.prototype.on,w.prototype.once,w.prototype.un;const b=w;function E(){throw new Error("Unimplemented abstract method.")}let T=0;function R(t){return t.ol_uid||(t.ol_uid=String(++T))}class S extends t{constructor(t,e,n){super(t),this.key=e,this.oldValue=n}}const P=class extends b{constructor(t){super(),this.on,this.once,this.un,R(this),this.values_=null,void 0!==t&&this.setProperties(t)}get(t){let e;return this.values_&&this.values_.hasOwnProperty(t)&&(e=this.values_[t]),e}getKeys(){return this.values_&&Object.keys(this.values_)||[]}getProperties(){return this.values_&&Object.assign({},this.values_)||{}}getPropertiesInternal(){return this.values_}hasProperties(){return!!this.values_}notify(t,n){let i;i=`change:${t}`,this.hasListener(i)&&this.dispatchEvent(new S(i,t,n)),i=e,this.hasListener(i)&&this.dispatchEvent(new S(i,t,n))}addChangeListener(t,e){this.addEventListener(`change:${t}`,e)}removeChangeListener(t,e){this.removeEventListener(`change:${t}`,e)}set(t,e,n){const i=this.values_||(this.values_={});if(n)i[t]=e;else{const n=i[t];i[t]=e,n!==e&&this.notify(t,n)}}setProperties(t,e){for(const n in t)this.set(n,t[n],e)}applyProperties(t){t.values_&&Object.assign(this.values_||(this.values_={}),t.values_)}unset(t,e){if(this.values_&&t in this.values_){const n=this.values_[t];delete this.values_[t],function(t){let e;for(e in t)return!1;return!e}(this.values_)&&(this.values_=null),e||this.notify(t,n)}}},M="add",I="remove",L="length";class F extends t{constructor(t,e,n){super(t),this.element=e,this.index=n}}const A=class extends P{constructor(t,e){if(super(),this.on,this.once,this.un,e=e||{},this.unique_=!!e.unique,this.array_=t||[],this.unique_)for(let t=0,e=this.array_.length;t<e;++t)this.assertUnique_(this.array_[t],t);this.updateLength_()}clear(){for(;this.getLength()>0;)this.pop()}extend(t){for(let e=0,n=t.length;e<n;++e)this.push(t[e]);return this}forEach(t){const e=this.array_;for(let n=0,i=e.length;n<i;++n)t(e[n],n,e)}getArray(){return this.array_}item(t){return this.array_[t]}getLength(){return this.get(L)}insertAt(t,e){if(t<0||t>this.getLength())throw new Error("Index out of bounds: "+t);this.unique_&&this.assertUnique_(e),this.array_.splice(t,0,e),this.updateLength_(),this.dispatchEvent(new F(M,e,t))}pop(){return this.removeAt(this.getLength()-1)}push(t){this.unique_&&this.assertUnique_(t);const e=this.getLength();return this.insertAt(e,t),this.getLength()}remove(t){const e=this.array_;for(let n=0,i=e.length;n<i;++n)if(e[n]===t)return this.removeAt(n)}removeAt(t){if(t<0||t>=this.getLength())return;const e=this.array_[t];return this.array_.splice(t,1),this.updateLength_(),this.dispatchEvent(new F(I,e,t)),e}setAt(t,e){if(t>=this.getLength())return void this.insertAt(t,e);if(t<0)throw new Error("Index out of bounds: "+t);this.unique_&&this.assertUnique_(e,t);const n=this.array_[t];this.array_[t]=e,this.dispatchEvent(new F(I,n,t)),this.dispatchEvent(new F(M,e,t))}updateLength_(){this.set(L,this.array_.length)}assertUnique_(t,e){for(let n=0,i=this.array_.length;n<i;++n)if(this.array_[n]===t&&n!==e)throw new Error("Duplicate item added to a unique collection")}},k="undefined"!=typeof navigator&&void 0!==navigator.userAgent?navigator.userAgent.toLowerCase():"",z=k.includes("firefox"),D=(k.includes("safari")&&!k.includes("chrom")&&(k.includes("version/15.4")||/cpu (os|iphone os) 15_4 like mac os x/.test(k)),k.includes("webkit")&&!k.includes("edge")),O=k.includes("macintosh"),N="undefined"!=typeof devicePixelRatio?devicePixelRatio:1,j="undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof OffscreenCanvas&&self instanceof WorkerGlobalScope,Z="undefined"!=typeof Image&&Image.prototype.decode,K=function(){let t=!1;try{const e=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("_",null,e),window.removeEventListener("_",null,e)}catch(t){}return t}();function G(t,e){if(!t)throw new Error(e)}function U(t,e){const n=e[0],i=e[1];return e[0]=t[0]*n+t[2]*i+t[4],e[1]=t[1]*n+t[3]*i+t[5],e}function X(t,e,n,i,o,s,r,a){const l=Math.sin(s),h=Math.cos(s);return t[0]=i*h,t[1]=o*l,t[2]=-i*l,t[3]=o*h,t[4]=r*i*h-a*i*l+e,t[5]=r*o*l+a*o*h+n,t}function V(t,e){const n=(i=e)[0]*i[3]-i[1]*i[2];var i;G(0!==n,"Transformation matrix cannot be inverted");const o=e[0],s=e[1],r=e[2],a=e[3],l=e[4],h=e[5];return t[0]=a/n,t[1]=-s/n,t[2]=-r/n,t[3]=o/n,t[4]=(r*h-a*l)/n,t[5]=-(o*h-s*l)/n,t}let q;new Array(6);const W={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};function Y(t){const e=[1/0,1/0,-1/0,-1/0];for(let n=0,i=t.length;n<i;++n)nt(e,t[n]);return e}function B(t,e,n){let i,o;return i=e<t[0]?t[0]-e:t[2]<e?e-t[2]:0,o=n<t[1]?t[1]-n:t[3]<n?n-t[3]:0,i*i+o*o}function H(t,e){return Q(t,e[0],e[1])}function Q(t,e,n){return t[0]<=e&&e<=t[2]&&t[1]<=n&&n<=t[3]}function $(t,e){const n=t[0],i=t[1],o=t[2],s=t[3],r=e[0],a=e[1];let l=W.UNKNOWN;return r<n?l|=W.LEFT:r>o&&(l|=W.RIGHT),a<i?l|=W.BELOW:a>s&&(l|=W.ABOVE),l===W.UNKNOWN&&(l=W.INTERSECTING),l}function J(t,e,n,i,o){return o?(o[0]=t,o[1]=e,o[2]=n,o[3]=i,o):[t,e,n,i]}function tt(t){return J(1/0,1/0,-1/0,-1/0,t)}function et(t,e){return t[0]==e[0]&&t[2]==e[2]&&t[1]==e[1]&&t[3]==e[3]}function nt(t,e){e[0]<t[0]&&(t[0]=e[0]),e[0]>t[2]&&(t[2]=e[0]),e[1]<t[1]&&(t[1]=e[1]),e[1]>t[3]&&(t[3]=e[1])}function it(t,e,n,i,o){for(;n<i;n+=o)ot(t,e[n],e[n+1]);return t}function ot(t,e,n){t[0]=Math.min(t[0],e),t[1]=Math.min(t[1],n),t[2]=Math.max(t[2],e),t[3]=Math.max(t[3],n)}function st(t,e){let n;return n=e(at(t)),n||(n=e(lt(t)),n||(n=e(_t(t)),n||(n=e(mt(t)),n||!1)))}function rt(t){let e=0;return yt(t)||(e=ft(t)*gt(t)),e}function at(t){return[t[0],t[1]]}function lt(t){return[t[2],t[1]]}function ht(t){return[(t[0]+t[2])/2,(t[1]+t[3])/2]}function ct(t,e){let n;if("bottom-left"===e)n=at(t);else if("bottom-right"===e)n=lt(t);else if("top-left"===e)n=mt(t);else{if("top-right"!==e)throw new Error("Invalid corner");n=_t(t)}return n}function ut(t,e,n,i,o){const[s,r,a,l,h,c,u,d]=dt(t,e,n,i);return J(Math.min(s,a,h,u),Math.min(r,l,c,d),Math.max(s,a,h,u),Math.max(r,l,c,d),o)}function dt(t,e,n,i){const o=e*i[0]/2,s=e*i[1]/2,r=Math.cos(n),a=Math.sin(n),l=o*r,h=o*a,c=s*r,u=s*a,d=t[0],g=t[1];return[d-l+u,g-h-c,d-l-u,g-h+c,d+l-u,g+h+c,d+l+u,g+h-c,d-l+u,g-h-c]}function gt(t){return t[3]-t[1]}function pt(t,e,n){const i=n||[1/0,1/0,-1/0,-1/0];return vt(t,e)?(t[0]>e[0]?i[0]=t[0]:i[0]=e[0],t[1]>e[1]?i[1]=t[1]:i[1]=e[1],t[2]<e[2]?i[2]=t[2]:i[2]=e[2],t[3]<e[3]?i[3]=t[3]:i[3]=e[3]):tt(i),i}function mt(t){return[t[0],t[3]]}function _t(t){return[t[2],t[3]]}function ft(t){return t[2]-t[0]}function vt(t,e){return t[0]<=e[2]&&t[2]>=e[0]&&t[1]<=e[3]&&t[3]>=e[1]}function yt(t){return t[2]<t[0]||t[3]<t[1]}function xt(t,e,n,i){if(yt(t))return tt(n);let o=[];if(i>1){const e=t[2]-t[0],n=t[3]-t[1];for(let s=0;s<i;++s)o.push(t[0]+e*s/i,t[1],t[2],t[1]+n*s/i,t[2]-e*s/i,t[3],t[0],t[3]-n*s/i)}else o=[t[0],t[1],t[2],t[1],t[2],t[3],t[0],t[3]];e(o,o,2);const s=[],r=[];for(let t=0,e=o.length;t<e;t+=2)s.push(o[t]),r.push(o[t+1]);return function(t,e,n){return J(Math.min.apply(null,t),Math.min.apply(null,e),Math.max.apply(null,t),Math.max.apply(null,e),n)}(s,r,n)}const Ct={name:"rgb",min:[0,0,0],max:[255,255,255],channel:["red","green","blue"],alias:["RGB"]};var wt={name:"xyz",min:[0,0,0],channel:["X","Y","Z"],alias:["XYZ","ciexyz","cie1931"],whitepoint:{2:{A:[109.85,100,35.585],C:[98.074,100,118.232],D50:[96.422,100,82.521],D55:[95.682,100,92.149],D65:[95.045592705167,100,108.9057750759878],D75:[94.972,100,122.638],F2:[99.187,100,67.395],F7:[95.044,100,108.755],F11:[100.966,100,64.37],E:[100,100,100]},10:{A:[111.144,100,35.2],C:[97.285,100,116.145],D50:[96.72,100,81.427],D55:[95.799,100,90.926],D65:[94.811,100,107.304],D75:[94.416,100,120.641],F2:[103.28,100,69.026],F7:[95.792,100,107.687],F11:[103.866,100,65.627],E:[100,100,100]}}};wt.max=wt.whitepoint[2].D65,wt.rgb=function(t,e){e=e||wt.whitepoint[2].E;var n,i,o,s=t[0]/e[0],r=t[1]/e[1],a=t[2]/e[2];return i=-.96924363628087*s+1.87596750150772*r+.041555057407175*a,o=.055630079696993*s+-.20397695888897*r+1.056971514242878*a,n=(n=3.240969941904521*s+-1.537383177570093*r+-.498610760293*a)>.0031308?1.055*Math.pow(n,1/2.4)-.055:n*=12.92,i=i>.0031308?1.055*Math.pow(i,1/2.4)-.055:i*=12.92,o=o>.0031308?1.055*Math.pow(o,1/2.4)-.055:o*=12.92,[255*(n=Math.min(Math.max(0,n),1)),255*(i=Math.min(Math.max(0,i),1)),255*(o=Math.min(Math.max(0,o),1))]},Ct.xyz=function(t,e){var n=t[0]/255,i=t[1]/255,o=t[2]/255,s=.21263900587151*(n=n>.04045?Math.pow((n+.055)/1.055,2.4):n/12.92)+.71516867876775*(i=i>.04045?Math.pow((i+.055)/1.055,2.4):i/12.92)+.072192315360733*(o=o>.04045?Math.pow((o+.055)/1.055,2.4):o/12.92),r=.019330818715591*n+.11919477979462*i+.95053215224966*o;return[(.41239079926595*n+.35758433938387*i+.18048078840183*o)*(e=e||wt.whitepoint[2].E)[0],s*e[1],r*e[2]]};const bt=wt,Et={name:"luv",min:[0,-134,-140],max:[100,224,122],channel:["lightness","u","v"],alias:["LUV","cieluv","cie1976"],xyz:function(t,e,n){var i,o,s,r,a,l,h,c,u;return s=t[0],r=t[1],a=t[2],0===s?[0,0,0]:(e=e||"D65",n=n||2,i=r/(13*s)+4*(h=bt.whitepoint[n][e][0])/(h+15*(c=bt.whitepoint[n][e][1])+3*(u=bt.whitepoint[n][e][2]))||0,o=a/(13*s)+9*c/(h+15*c+3*u)||0,[9*(l=s>8?c*Math.pow((s+16)/116,3):c*s*.0011070564598794539)*i/(4*o)||0,l,l*(12-3*i-20*o)/(4*o)||0])}};bt.luv=function(t,e,n){var i,o,s,r,a,l,h,c,u,d,g;e=e||"D65",n=n||2,d=4*(h=bt.whitepoint[n][e][0])/(h+15*(c=bt.whitepoint[n][e][1])+3*(u=bt.whitepoint[n][e][2])),g=9*c/(h+15*c+3*u),i=4*(r=t[0])/(r+15*(a=t[1])+3*(l=t[2]))||0,o=9*a/(r+15*a+3*l)||0;var p=a/c;return[s=p<=.008856451679035631?903.2962962962961*p:116*Math.pow(p,1/3)-16,13*s*(i-d),13*s*(o-g)]},Et.lchuv=function(t){var e=t[0],n=t[1],i=t[2],o=Math.sqrt(n*n+i*i),s=360*Math.atan2(i,n)/2/Math.PI;return s<0&&(s+=360),[e,o,s]},bt.lchuv=function(t){return Et.lchuv(bt.luv(t))};var Tt=n(874);const Rt=function(t){var e,n,i=[],o=1;if("number"==typeof t)return{space:"rgb",values:[t>>>16,(65280&t)>>>8,255&t],alpha:1};if("number"==typeof t)return{space:"rgb",values:[t>>>16,(65280&t)>>>8,255&t],alpha:1};if(t=String(t).toLowerCase(),Tt[t])i=Tt[t].slice(),n="rgb";else if("transparent"===t)o=0,n="rgb",i=[0,0,0];else if("#"===t[0]){var s=t.slice(1),r=s.length;o=1,r<=4?(i=[parseInt(s[0]+s[0],16),parseInt(s[1]+s[1],16),parseInt(s[2]+s[2],16)],4===r&&(o=parseInt(s[3]+s[3],16)/255)):(i=[parseInt(s[0]+s[1],16),parseInt(s[2]+s[3],16),parseInt(s[4]+s[5],16)],8===r&&(o=parseInt(s[6]+s[7],16)/255)),i[0]||(i[0]=0),i[1]||(i[1]=0),i[2]||(i[2]=0),n="rgb"}else if(e=/^((?:rgba?|hs[lvb]a?|hwba?|cmyk?|xy[zy]|gray|lab|lchu?v?|[ly]uv|lms|oklch|oklab|color))\s*\(([^\)]*)\)/.exec(t)){var a=e[1],l="cmyk"===(n=a.replace(/a$/,""))?4:"gray"===n?1:3;i=e[2].trim().split(/\s*[,\/]\s*|\s+/),"color"===n&&(n=i.shift()),o=(i=i.map((function(t,e){if("%"===t[t.length-1])return t=parseFloat(t)/100,3===e?t:"rgb"===n?255*t:"h"===n[0]?100*t:"l"!==n[0]||e?"lab"===n?125*t:"lch"===n?e<2?150*t:360*t:"o"!==n[0]||e?"oklab"===n?.4*t:"oklch"===n?e<2?.4*t:360*t:t:t:100*t;if("h"===n[e]||2===e&&"h"===n[n.length-1]){if(void 0!==St[t])return St[t];if(t.endsWith("deg"))return parseFloat(t);if(t.endsWith("turn"))return 360*parseFloat(t);if(t.endsWith("grad"))return 360*parseFloat(t)/400;if(t.endsWith("rad"))return 180*parseFloat(t)/Math.PI}return"none"===t?0:parseFloat(t)}))).length>l?i.pop():1}else/[0-9](?:\s|\/|,)/.test(t)&&(i=t.match(/([0-9]+)/g).map((function(t){return parseFloat(t)})),n=t.match(/([a-z])/gi)?.join("")?.toLowerCase()||"rgb");return{space:n,values:i,alpha:o}};var St={red:0,orange:60,yellow:120,green:180,blue:240,purple:300};const Pt={name:"hsl",min:[0,0,0],max:[360,100,100],channel:["hue","saturation","lightness"],alias:["HSL"],rgb:function(t){var e,n,i,o,s,r=t[0]/360,a=t[1]/100,l=t[2]/100,h=0;if(0===a)return[s=255*l,s,s];for(e=2*l-(n=l<.5?l*(1+a):l+a-l*a),o=[0,0,0];h<3;)(i=r+1/3*-(h-1))<0?i++:i>1&&i--,s=6*i<1?e+6*(n-e)*i:2*i<1?n:3*i<2?e+(n-e)*(2/3-i)*6:e,o[h++]=255*s;return o}};function Mt(t,e,n){return Math.min(Math.max(t,e),n)}function It(t,e,n,i,o,s){const r=o-n,a=s-i;if(0!==r||0!==a){const l=((t-n)*r+(e-i)*a)/(r*r+a*a);l>1?(n=o,i=s):l>0&&(n+=r*l,i+=a*l)}return Lt(t,e,n,i)}function Lt(t,e,n,i){const o=n-t,s=i-e;return o*o+s*s}function Ft(t){return t*Math.PI/180}function At(t,e){const n=t%e;return n*e<0?n+e:n}function kt(t,e,n){return t+n*(e-t)}function zt(t,e){const n=Math.pow(10,e);return Math.round(t*n)/n}function Dt(t,e){return Math.floor(zt(t,e))}function Ot(t,e){return Math.ceil(zt(t,e))}Ct.hsl=function(t){var e,n,i=t[0]/255,o=t[1]/255,s=t[2]/255,r=Math.min(i,o,s),a=Math.max(i,o,s),l=a-r;return a===r?e=0:i===a?e=(o-s)/l:o===a?e=2+(s-i)/l:s===a&&(e=4+(i-o)/l),(e=Math.min(60*e,360))<0&&(e+=360),n=(r+a)/2,[e,100*(a===r?0:n<=.5?l/(a+r):l/(2-a-r)),100*n]};const Nt=1024,jt={};let Zt=0;function Kt(t){return Array.isArray(t)?t:function(t){if(jt.hasOwnProperty(t))return jt[t];if(Zt>=Nt){let t=0;for(const e in jt)0==(3&t++)&&(delete jt[e],--Zt)}const e=function(t){var e;Array.isArray(t)&&t.raw&&(t=String.raw(...arguments)),t instanceof Number&&(t=+t);var n=Rt(t);if(!n.space)return[];const i="h"===n.space[0]?Pt.min:Ct.min,o="h"===n.space[0]?Pt.max:Ct.max;return(e=Array(3))[0]=Math.min(Math.max(n.values[0],i[0]),o[0]),e[1]=Math.min(Math.max(n.values[1],i[1]),o[1]),e[2]=Math.min(Math.max(n.values[2],i[2]),o[2]),"h"===n.space[0]&&(e=Pt.rgb(e)),e.push(Math.min(Math.max(n.alpha,0),1)),e}(t);if(4!==e.length)throw new Error('Failed to parse "'+t+'" as color');for(const n of e)if(isNaN(n))throw new Error('Failed to parse "'+t+'" as color');return function(t){t[0]=Mt(t[0]+.5|0,0,255),t[1]=Mt(t[1]+.5|0,0,255),t[2]=Mt(t[2]+.5|0,0,255),t[3]=Mt(t[3],0,1)}(e),jt[t]=e,++Zt,e}(t)}function Gt(t,e,n){return e+":"+t+":"+(n?function(t){return"string"==typeof t?t:function(t){let e=t[0];e!=(0|e)&&(e=e+.5|0);let n=t[1];n!=(0|n)&&(n=n+.5|0);let i=t[2];return i!=(0|i)&&(i=i+.5|0),"rgba("+e+","+n+","+i+","+(void 0===t[3]?1:Math.round(100*t[3])/100)+")"}(t)}(n):"null")}const Ut=new class{constructor(){this.cache_={},this.cacheSize_=0,this.maxCacheSize_=32}clear(){this.cache_={},this.cacheSize_=0}canExpireCache(){return this.cacheSize_>this.maxCacheSize_}expire(){if(this.canExpireCache()){let t=0;for(const e in this.cache_){const n=this.cache_[e];0!=(3&t++)||n.hasListener()||(delete this.cache_[e],--this.cacheSize_)}}}get(t,e,n){const i=Gt(t,e,n);return i in this.cache_?this.cache_[i]:null}set(t,e,n,i){const o=Gt(t,e,n);this.cache_[o]=i,++this.cacheSize_}setSize(t){this.maxCacheSize_=t,this.expire()}},Xt="opacity",Vt="visible",qt="extent",Wt="zIndex",Yt="maxResolution",Bt="minResolution",Ht="maxZoom",Qt="minZoom",$t="source",Jt=class extends P{constructor(t){super(),this.on,this.once,this.un,this.background_=t.background;const e=Object.assign({},t);"object"==typeof t.properties&&(delete e.properties,Object.assign(e,t.properties)),e[Xt]=void 0!==t.opacity?t.opacity:1,G("number"==typeof e[Xt],"Layer opacity must be a number"),e[Vt]=void 0===t.visible||t.visible,e[Wt]=t.zIndex,e[Yt]=void 0!==t.maxResolution?t.maxResolution:1/0,e[Bt]=void 0!==t.minResolution?t.minResolution:0,e[Qt]=void 0!==t.minZoom?t.minZoom:-1/0,e[Ht]=void 0!==t.maxZoom?t.maxZoom:1/0,this.className_=void 0!==e.className?e.className:"ol-layer",delete e.className,this.setProperties(e),this.state_=null}getBackground(){return this.background_}getClassName(){return this.className_}getLayerState(t){const e=this.state_||{layer:this,managed:void 0===t||t},n=this.getZIndex();return e.opacity=Mt(Math.round(100*this.getOpacity())/100,0,1),e.visible=this.getVisible(),e.extent=this.getExtent(),e.zIndex=void 0!==n||e.managed?n:1/0,e.maxResolution=this.getMaxResolution(),e.minResolution=Math.max(this.getMinResolution(),0),e.minZoom=this.getMinZoom(),e.maxZoom=this.getMaxZoom(),this.state_=e,e}getLayersArray(t){return E()}getLayerStatesArray(t){return E()}getExtent(){return this.get(qt)}getMaxResolution(){return this.get(Yt)}getMinResolution(){return this.get(Bt)}getMinZoom(){return this.get(Qt)}getMaxZoom(){return this.get(Ht)}getOpacity(){return this.get(Xt)}getSourceState(){return E()}getVisible(){return this.get(Vt)}getZIndex(){return this.get(Wt)}setBackground(t){this.background_=t,this.changed()}setExtent(t){this.set(qt,t)}setMaxResolution(t){this.set(Yt,t)}setMinResolution(t){this.set(Bt,t)}setMaxZoom(t){this.set(Ht,t)}setMinZoom(t){this.set(Qt,t)}setOpacity(t){G("number"==typeof t,"Layer opacity must be a number"),this.set(Xt,t)}setVisible(t){this.set(Vt,t)}setZIndex(t){this.set(Wt,t)}disposeInternal(){this.state_&&(this.state_.layer=null,this.state_=null),super.disposeInternal()}},te="precompose",ee="rendercomplete",ne={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"},ie=42,oe=256,se={radians:6370997/(2*Math.PI),degrees:2*Math.PI*6370997/360,ft:.3048,m:1,"us-ft":1200/3937},re=class{constructor(t){this.code_=t.code,this.units_=t.units,this.extent_=void 0!==t.extent?t.extent:null,this.worldExtent_=void 0!==t.worldExtent?t.worldExtent:null,this.axisOrientation_=void 0!==t.axisOrientation?t.axisOrientation:"enu",this.global_=void 0!==t.global&&t.global,this.canWrapX_=!(!this.global_||!this.extent_),this.getPointResolutionFunc_=t.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=t.metersPerUnit}canWrapX(){return this.canWrapX_}getCode(){return this.code_}getExtent(){return this.extent_}getUnits(){return this.units_}getMetersPerUnit(){return this.metersPerUnit_||se[this.units_]}getWorldExtent(){return this.worldExtent_}getAxisOrientation(){return this.axisOrientation_}isGlobal(){return this.global_}setGlobal(t){this.global_=t,this.canWrapX_=!(!t||!this.extent_)}getDefaultTileGrid(){return this.defaultTileGrid_}setDefaultTileGrid(t){this.defaultTileGrid_=t}setExtent(t){this.extent_=t,this.canWrapX_=!(!this.global_||!t)}setWorldExtent(t){this.worldExtent_=t}setGetPointResolution(t){this.getPointResolutionFunc_=t}getPointResolutionFunc(){return this.getPointResolutionFunc_}},ae=6378137,le=Math.PI*ae,he=[-le,-le,le,le],ce=[-180,-85,180,85],ue=ae*Math.log(Math.tan(Math.PI/2));class de extends re{constructor(t){super({code:t,units:"m",extent:he,global:!0,worldExtent:ce,getPointResolution:function(t,e){return t/Math.cosh(e[1]/ae)}})}}const ge=[new de("EPSG:3857"),new de("EPSG:102100"),new de("EPSG:102113"),new de("EPSG:900913"),new de("http://www.opengis.net/def/crs/EPSG/0/3857"),new de("http://www.opengis.net/gml/srs/epsg.xml#3857")];const pe=[-180,-90,180,90],me=6378137*Math.PI/180;class _e extends re{constructor(t,e){super({code:t,units:"degrees",extent:pe,axisOrientation:e,global:!0,metersPerUnit:me,worldExtent:pe})}}const fe=[new _e("CRS:84"),new _e("EPSG:4326","neu"),new _e("urn:ogc:def:crs:OGC:1.3:CRS84"),new _e("urn:ogc:def:crs:OGC:2:84"),new _e("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new _e("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new _e("http://www.opengis.net/def/crs/EPSG/0/4326","neu")];let ve={},ye={};function xe(t,e,n){const i=t.getCode(),o=e.getCode();i in ye||(ye[i]={}),ye[i][o]=n}function Ce(t,e){let n=!0;for(let i=t.length-1;i>=0;--i)if(t[i]!=e[i]){n=!1;break}return n}function we(t,e){const n=Math.cos(e),i=Math.sin(e),o=t[0]*n-t[1]*i,s=t[1]*n+t[0]*i;return t[0]=o,t[1]=s,t}const be=6371008.8;function Ee(t,e,n){n=n||be;const i=Ft(t[1]),o=Ft(e[1]),s=(o-i)/2,r=Ft(e[0]-t[0])/2,a=Math.sin(s)*Math.sin(s)+Math.sin(r)*Math.sin(r)*Math.cos(i)*Math.cos(o);return 2*n*Math.atan2(Math.sqrt(a),Math.sqrt(1-a))}const Te={info:1,warn:2,error:3,none:4};let Re=Te.info;function Se(...t){Re>Te.warn||console.warn(...t)}let Pe=!0;function Me(t,e){if(void 0!==e)for(let n=0,i=t.length;n<i;++n)e[n]=t[n];else e=t.slice();return e}function Ie(t,e){if(void 0!==e&&t!==e){for(let n=0,i=t.length;n<i;++n)e[n]=t[n];t=e}return t}function Le(t){!function(t,e){ve[t]=e}(t.getCode(),t),xe(t,t,Me)}function Fe(t){return"string"==typeof t?ve[e=t]||ve[e.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null:t||null;var e}function Ae(t,e,n,i){let o;const s=(t=Fe(t)).getPointResolutionFunc();if(s){if(o=s(e,n),i&&i!==t.getUnits()){const e=t.getMetersPerUnit();e&&(o=o*e/se[i])}}else{const s=t.getUnits();if("degrees"==s&&!i||"degrees"==i)o=e;else{const r=Oe(t,Fe("EPSG:4326"));if(r===Ie&&"degrees"!==s)o=e*t.getMetersPerUnit();else{let t=[n[0]-e/2,n[1],n[0]+e/2,n[1],n[0],n[1]-e/2,n[0],n[1]+e/2];t=r(t,t,2),o=(Ee(t.slice(0,2),t.slice(2,4))+Ee(t.slice(4,6),t.slice(6,8)))/2}const a=i?se[i]:t.getMetersPerUnit();void 0!==a&&(o/=a)}}return o}function ke(t){!function(t){t.forEach(Le)}(t),t.forEach((function(e){t.forEach((function(t){e!==t&&xe(e,t,Me)}))}))}function ze(t,e){return t?"string"==typeof t?Fe(t):t:Fe(e)}function De(t,e){if(t===e)return!0;const n=t.getUnits()===e.getUnits();return(t.getCode()===e.getCode()||Oe(t,e)===Me)&&n}function Oe(t,e){let n=function(t,e){let n;return t in ye&&e in ye[t]&&(n=ye[t][e]),n}(t.getCode(),e.getCode());return n||(n=Ie),n}function Ne(t,e){return Oe(Fe(t),Fe(e))}function je(t,e,n){return Ne(e,n)(t,void 0,t.length)}let Ze=null;function Ke(){return Ze}function Ge(t,e){return t}function Ue(t,e){return Pe&&!Ce(t,[0,0])&&t[0]>=-180&&t[0]<=180&&t[1]>=-90&&t[1]<=90&&(Pe=!1,Se("Call useGeographic() from ol/proj once to work with [longitude, latitude] coordinates.")),t}function Xe(t,e){return t}var Ve,qe,We;function Ye(t,e,n){return function(i,o,s,r,a){if(!i)return;if(!o&&!e)return i;const l=e?0:s[0]*o,h=e?0:s[1]*o,c=a?a[0]:0,u=a?a[1]:0;let d=t[0]+l/2+c,g=t[2]-l/2+c,p=t[1]+h/2+u,m=t[3]-h/2+u;d>g&&(d=(g+d)/2,g=d),p>m&&(p=(m+p)/2,m=p);let _=Mt(i[0],d,g),f=Mt(i[1],p,m);if(r&&n&&o){const t=30*o;_+=-t*Math.log(1+Math.max(0,d-i[0])/t)+t*Math.log(1+Math.max(0,i[0]-g)/t),f+=-t*Math.log(1+Math.max(0,p-i[1])/t)+t*Math.log(1+Math.max(0,i[1]-m)/t)}return[_,f]}}function Be(t){return t}function He(t,e,n,i){const o=ft(e)/n[0],s=gt(e)/n[1];return i?Math.min(t,Math.max(o,s)):Math.min(t,Math.min(o,s))}function Qe(t,e,n){let i=Math.min(t,e);return i*=Math.log(1+50*Math.max(0,t/e-1))/50+1,n&&(i=Math.max(i,n),i/=Math.log(1+50*Math.max(0,n/t-1))/50+1),Mt(i,n/2,2*e)}function $e(t,e,n,i,o){return n=void 0===n||n,function(s,r,a,l){if(void 0!==s){const r=i?He(t,i,a,o):t;return n&&l?Qe(s,r,e):Mt(s,e,r)}}}function Je(t){if(void 0!==t)return 0}function tn(t){if(void 0!==t)return t}function en(t){return Math.pow(t,3)}function nn(t){return 1-en(1-t)}function on(t){return 3*t*t-2*t*t*t}function sn(t){return t}ke(ge),ke(fe),Ve=ge,qe=function(t,e,n){const i=t.length;n=n>1?n:2,void 0===e&&(e=n>2?t.slice():new Array(i));for(let o=0;o<i;o+=n){e[o]=le*t[o]/180;let n=ae*Math.log(Math.tan(Math.PI*(+t[o+1]+90)/360));n>ue?n=ue:n<-ue&&(n=-ue),e[o+1]=n}return e},We=function(t,e,n){const i=t.length;n=n>1?n:2,void 0===e&&(e=n>2?t.slice():new Array(i));for(let o=0;o<i;o+=n)e[o]=180*t[o]/le,e[o+1]=360*Math.atan(Math.exp(t[o+1]/ae))/Math.PI-90;return e},fe.forEach((function(t){Ve.forEach((function(e){xe(t,e,qe),xe(e,t,We)}))}));const rn=[1,0,0,1,0,0],an=class extends P{constructor(){super(),this.extent_=[1/0,1/0,-1/0,-1/0],this.extentRevision_=-1,this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0,this.simplifyTransformedInternal=function(t){let e,n,i,o=!1;return function(){const s=Array.prototype.slice.call(arguments);return o&&this===i&&r(s,n)||(o=!0,i=this,n=s,e=t.apply(this,arguments)),e}}(((t,e,n)=>{if(!n)return this.getSimplifiedGeometry(e);const i=this.clone();return i.applyTransform(n),i.getSimplifiedGeometry(e)}))}simplifyTransformed(t,e){return this.simplifyTransformedInternal(this.getRevision(),t,e)}clone(){return E()}closestPointXY(t,e,n,i){return E()}containsXY(t,e){const n=this.getClosestPoint([t,e]);return n[0]===t&&n[1]===e}getClosestPoint(t,e){return e=e||[NaN,NaN],this.closestPointXY(t[0],t[1],e,1/0),e}intersectsCoordinate(t){return this.containsXY(t[0],t[1])}computeExtent(t){return E()}getExtent(t){if(this.extentRevision_!=this.getRevision()){const t=this.computeExtent(this.extent_);(isNaN(t[0])||isNaN(t[1]))&&tt(t),this.extentRevision_=this.getRevision()}return function(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t}(this.extent_,t)}rotate(t,e){E()}scale(t,e,n){E()}simplify(t){return this.getSimplifiedGeometry(t*t)}getSimplifiedGeometry(t){return E()}getType(){return E()}applyTransform(t){E()}intersectsExtent(t){return E()}translate(t,e){E()}transform(t,e){const n=Fe(t),i="tile-pixels"==n.getUnits()?function(t,i,o){const s=n.getExtent(),r=n.getWorldExtent(),a=gt(r)/gt(s);return X(rn,r[0],r[3],a,-a,0,0,0),function(t,e,n,i,o,s){s=s||[];let r=0;for(let e=0;e<n;e+=i){const n=t[e],i=t[e+1];s[r++]=o[0]*n+o[2]*i+o[4],s[r++]=o[1]*n+o[3]*i+o[5]}s&&s.length!=r&&(s.length=r)}(t,0,t.length,o,rn,i),Ne(n,e)(t,i,o)}:Ne(n,e);return this.applyTransform(i),this}};function ln(t){let e;return"XY"==t?e=2:"XYZ"==t||"XYM"==t?e=3:"XYZM"==t&&(e=4),e}const hn=class extends an{constructor(){super(),this.layout="XY",this.stride=2,this.flatCoordinates}computeExtent(t){return e=this.flatCoordinates,n=this.flatCoordinates.length,i=this.stride,it(tt(t),e,0,n,i);var e,n,i}getCoordinates(){return E()}getFirstCoordinate(){return this.flatCoordinates.slice(0,this.stride)}getFlatCoordinates(){return this.flatCoordinates}getLastCoordinate(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}getLayout(){return this.layout}getSimplifiedGeometry(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&t<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;const e=this.getSimplifiedGeometryInternal(t);return e.getFlatCoordinates().length<this.flatCoordinates.length?e:(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)}getSimplifiedGeometryInternal(t){return this}getStride(){return this.stride}setFlatCoordinates(t,e){this.stride=ln(t),this.layout=t,this.flatCoordinates=e}setCoordinates(t,e){E()}setLayout(t,e,n){let i;if(t)i=ln(t);else{for(let t=0;t<n;++t){if(0===e.length)return this.layout="XY",void(this.stride=2);e=e[0]}i=e.length,t=function(t){let e;return 2==t?e="XY":3==t?e="XYZ":4==t&&(e="XYZM"),e}(i)}this.layout=t,this.stride=i}applyTransform(t){this.flatCoordinates&&(t(this.flatCoordinates,this.flatCoordinates,this.stride),this.changed())}rotate(t,e){const n=this.getFlatCoordinates();if(n){const i=this.getStride();!function(t,e,n,i,o,s,r){r=r||[];const a=Math.cos(o),l=Math.sin(o),h=s[0],c=s[1];let u=0;for(let e=0;e<n;e+=i){const n=t[e]-h,o=t[e+1]-c;r[u++]=h+n*a-o*l,r[u++]=c+n*l+o*a;for(let n=e+2;n<e+i;++n)r[u++]=t[n]}r&&r.length!=u&&(r.length=u)}(n,0,n.length,i,t,e,n),this.changed()}}scale(t,e,n){void 0===e&&(e=t),n||(n=ht(this.getExtent()));const i=this.getFlatCoordinates();if(i){const o=this.getStride();!function(t,e,n,i,o,s,r,a){a=a||[];const l=r[0],h=r[1];let c=0;for(let e=0;e<n;e+=i){const n=t[e]-l,r=t[e+1]-h;a[c++]=l+o*n,a[c++]=h+s*r;for(let n=e+2;n<e+i;++n)a[c++]=t[n]}a&&a.length!=c&&(a.length=c)}(i,0,i.length,o,t,e,n,i),this.changed()}}translate(t,e){const n=this.getFlatCoordinates();if(n){const i=this.getStride();!function(t,e,n,i,o,s,r){r=r||[];let a=0;for(let e=0;e<n;e+=i){r[a++]=t[e]+o,r[a++]=t[e+1]+s;for(let n=e+2;n<e+i;++n)r[a++]=t[n]}r&&r.length!=a&&(r.length=a)}(n,0,n.length,i,t,e,n),this.changed()}}};function cn(t,e,n,i,o,s,r){const a=t[e],l=t[e+1],h=t[n]-a,c=t[n+1]-l;let u;if(0===h&&0===c)u=e;else{const d=((o-a)*h+(s-l)*c)/(h*h+c*c);if(d>1)u=n;else{if(d>0){for(let o=0;o<i;++o)r[o]=kt(t[e+o],t[n+o],d);return void(r.length=i)}u=e}}for(let e=0;e<i;++e)r[e]=t[u+e];r.length=i}function un(t,e,n,i,o){let s=t[e],r=t[e+1];for(e+=i;e<n;e+=i){const n=t[e],i=t[e+1],a=Lt(s,r,n,i);a>o&&(o=a),s=n,r=i}return o}function dn(t,e,n,i,o,s,r,a,l,h,c){if(e==n)return h;let u,d;if(0===o){if(d=Lt(r,a,t[e],t[e+1]),d<h){for(u=0;u<i;++u)l[u]=t[e+u];return l.length=i,d}return h}c=c||[NaN,NaN];let g=e+i;for(;g<n;)if(cn(t,g-i,g,i,r,a,c),d=Lt(r,a,c[0],c[1]),d<h){for(h=d,u=0;u<i;++u)l[u]=c[u];l.length=i,g+=i}else g+=i*Math.max((Math.sqrt(d)-Math.sqrt(h))/o|0,1);if(s&&(cn(t,n-i,e,i,r,a,c),d=Lt(r,a,c[0],c[1]),d<h)){for(h=d,u=0;u<i;++u)l[u]=c[u];l.length=i}return h}function gn(t,e,n,i){for(let o=0,s=n.length;o<s;++o){const s=n[o];for(let n=0;n<i;++n)t[e++]=s[n]}return e}function pn(t,e){return e*Math.round(t/e)}function mn(t,e,n,i,o,s,r){if(e==n)return r;let a,l,h=pn(t[e],o),c=pn(t[e+1],o);e+=i,s[r++]=h,s[r++]=c;do{if(a=pn(t[e],o),l=pn(t[e+1],o),(e+=i)==n)return s[r++]=a,s[r++]=l,r}while(a==h&&l==c);for(;e<n;){const n=pn(t[e],o),u=pn(t[e+1],o);if(e+=i,n==a&&u==l)continue;const d=a-h,g=l-c,p=n-h,m=u-c;d*m==g*p&&(d<0&&p<d||d==p||d>0&&p>d)&&(g<0&&m<g||g==m||g>0&&m>g)?(a=n,l=u):(s[r++]=a,s[r++]=l,h=a,c=l,a=n,l=u)}return s[r++]=a,s[r++]=l,r}function _n(t,e,n,i,o){o=void 0!==o?o:[];let s=0;for(let r=e;r<n;r+=i)o[s++]=t.slice(r,r+i);return o.length=s,o}function fn(t,e,n,i){let o=0,s=t[n-i],r=t[n-i+1];for(;e<n;e+=i){const n=t[e],i=t[e+1];o+=r*n-s*i,s=n,r=i}return o/2}class vn extends hn{constructor(t,e){super(),this.maxDelta_=-1,this.maxDeltaRevision_=-1,void 0===e||Array.isArray(t[0])?this.setCoordinates(t,e):this.setFlatCoordinates(e,t)}clone(){return new vn(this.flatCoordinates.slice(),this.layout)}closestPointXY(t,e,n,i){return i<B(this.getExtent(),t,e)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(un(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),dn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,t,e,n,i))}getArea(){return fn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinates(){return _n(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getSimplifiedGeometryInternal(t){const e=[];return e.length=function(t,e,n,i,o,s,r){const a=(n-e)/i;if(a<3){for(;e<n;e+=i)s[r++]=t[e],s[r++]=t[e+1];return r}const l=new Array(a);l[0]=1,l[a-1]=1;const h=[e,n-i];let c=0;for(;h.length>0;){const n=h.pop(),s=h.pop();let r=0;const a=t[s],u=t[s+1],d=t[n],g=t[n+1];for(let e=s+i;e<n;e+=i){const n=It(t[e],t[e+1],a,u,d,g);n>r&&(c=e,r=n)}r>o&&(l[(c-e)/i]=1,s+i<c&&h.push(s,c),c+i<n&&h.push(c,n))}for(let n=0;n<a;++n)l[n]&&(s[r++]=t[e+n*i],s[r++]=t[e+n*i+1]);return r}(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,0),new vn(e,"XY")}getType(){return"LinearRing"}intersectsExtent(t){return!1}setCoordinates(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=gn(this.flatCoordinates,0,t,this.stride),this.changed()}}const yn=vn;class xn extends hn{constructor(t,e){super(),this.setCoordinates(t,e)}clone(){const t=new xn(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(t,e,n,i){const o=this.flatCoordinates,s=Lt(t,e,o[0],o[1]);if(s<i){const t=this.stride;for(let e=0;e<t;++e)n[e]=o[e];return n.length=t,s}return i}getCoordinates(){return this.flatCoordinates.slice()}computeExtent(t){return function(t,e){const n=t[0],i=t[1];return J(n,i,n,i,e)}(this.flatCoordinates,t)}getType(){return"Point"}intersectsExtent(t){return Q(t,this.flatCoordinates[0],this.flatCoordinates[1])}setCoordinates(t,e){this.setLayout(e,t,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=function(t,e,n,i){for(let i=0,o=n.length;i<o;++i)t[e++]=n[i];return e}(this.flatCoordinates,0,t,this.stride),this.changed()}}const Cn=xn;function wn(t,e,n,i,o){return!st(o,(function(o){return!bn(t,e,n,i,o[0],o[1])}))}function bn(t,e,n,i,o,s){let r=0,a=t[n-i],l=t[n-i+1];for(;e<n;e+=i){const n=t[e],i=t[e+1];l<=s?i>s&&(n-a)*(s-l)-(o-a)*(i-l)>0&&r++:i<=s&&(n-a)*(s-l)-(o-a)*(i-l)<0&&r--,a=n,l=i}return 0!==r}function En(t,e,n,i,o,s){if(0===n.length)return!1;if(!bn(t,e,n[0],i,o,s))return!1;for(let e=1,r=n.length;e<r;++e)if(bn(t,n[e-1],n[e],i,o,s))return!1;return!0}function Tn(t,e,n,i,o){const s=it([1/0,1/0,-1/0,-1/0],t,e,n,i);return!!vt(o,s)&&(a=s,(r=o)[0]<=a[0]&&a[2]<=r[2]&&r[1]<=a[1]&&a[3]<=r[3]||s[0]>=o[0]&&s[2]<=o[2]||s[1]>=o[1]&&s[3]<=o[3]||function(t,e,n,i,s){let r;for(e+=i;e<n;e+=i)if(a=t.slice(e-i,e),l=t.slice(e,e+i),r=function(t,e,n){let i=!1;const o=$(t,e),s=$(t,n);if(o===W.INTERSECTING||s===W.INTERSECTING)i=!0;else{const r=t[0],a=t[1],l=t[2],h=t[3],c=e[0],u=e[1],d=n[0],g=n[1],p=(g-u)/(d-c);let m,_;s&W.ABOVE&&!(o&W.ABOVE)&&(m=d-(g-h)/p,i=m>=r&&m<=l),i||!(s&W.RIGHT)||o&W.RIGHT||(_=g-(d-l)*p,i=_>=a&&_<=h),i||!(s&W.BELOW)||o&W.BELOW||(m=d-(g-a)/p,i=m>=r&&m<=l),i||!(s&W.LEFT)||o&W.LEFT||(_=g-(d-r)*p,i=_>=a&&_<=h)}return i}(o,a,l),r)return r;var a,l;return!1}(t,e,n,i));var r,a}function Rn(t,e,n,i,o){return!!(Tn(t,e,n,i,o)||bn(t,e,n,i,o[0],o[1])||bn(t,e,n,i,o[0],o[3])||bn(t,e,n,i,o[2],o[1])||bn(t,e,n,i,o[2],o[3]))}function Sn(t,e,n,i){for(;e<n-i;){for(let o=0;o<i;++o){const s=t[e+o];t[e+o]=t[n-i+o],t[n-i+o]=s}e+=i,n-=i}}function Pn(t,e,n,i){let o=0,s=t[n-i],r=t[n-i+1];for(;e<n;e+=i){const n=t[e],i=t[e+1];o+=(n-s)*(i+r),s=n,r=i}return 0===o?void 0:o>0}function Mn(t,e,n,i,o){o=void 0!==o&&o;for(let s=0,r=n.length;s<r;++s){const r=n[s],a=Pn(t,e,r,i);(0===s?o&&a||!o&&!a:o&&!a||!o&&a)&&Sn(t,e,r,i),e=r}return e}class In extends hn{constructor(t,e,n){super(),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,void 0!==e&&n?(this.setFlatCoordinates(e,t),this.ends_=n):this.setCoordinates(t,e)}appendLinearRing(t){this.flatCoordinates?function(t,e){const n=Array.isArray(e)?e:[e],i=n.length;for(let e=0;e<i;e++)t[t.length]=n[e]}(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const t=new In(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return t.applyProperties(this),t}closestPointXY(t,e,n,i){return i<B(this.getExtent(),t,e)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(function(t,e,n,i,o){for(let s=0,r=n.length;s<r;++s){const r=n[s];o=un(t,e,r,i,o),e=r}return o}(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),function(t,e,n,i,o,s,r,a,l,h,c){c=c||[NaN,NaN];for(let u=0,d=n.length;u<d;++u){const d=n[u];h=dn(t,e,d,i,o,s,r,a,l,h,c),e=d}return h}(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,t,e,n,i))}containsXY(t,e){return En(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,e)}getArea(){return function(t,e,n,i){let o=0;for(let s=0,r=n.length;s<r;++s){const r=n[s];o+=fn(t,e,r,i),e=r}return o}(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)}getCoordinates(t){let e;return void 0!==t?(e=this.getOrientedFlatCoordinates().slice(),Mn(e,0,this.ends_,this.stride,t)):e=this.flatCoordinates,function(t,e,n,i,o){o=void 0!==o?o:[];let s=0;for(let r=0,a=n.length;r<a;++r){const a=n[r];o[s++]=_n(t,e,a,i,o[s]),e=a}return o.length=s,o}(e,0,this.ends_,this.stride)}getEnds(){return this.ends_}getFlatInteriorPoint(){if(this.flatInteriorPointRevision_!=this.getRevision()){const t=ht(this.getExtent());this.flatInteriorPoint_=function(t,e,n,i,s,r,a){let l,h,c,u,d,g,p;const m=s[r+1],_=[];for(let o=0,s=n.length;o<s;++o){const s=n[o];for(u=t[s-i],g=t[s-i+1],l=e;l<s;l+=i)d=t[l],p=t[l+1],(m<=g&&p<=m||g<=m&&m<=p)&&(c=(m-g)/(p-g)*(d-u)+u,_.push(c)),u=d,g=p}let f=NaN,v=-1/0;for(_.sort(o),u=_[0],l=1,h=_.length;l<h;++l){d=_[l];const o=Math.abs(d-u);o>v&&(c=(u+d)/2,En(t,e,n,i,c,m)&&(f=c,v=o)),u=d}return isNaN(f)&&(f=s[r]),a?(a.push(f,m,v),a):[f,m,v]}(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_}getInteriorPoint(){return new Cn(this.getFlatInteriorPoint(),"XYM")}getLinearRingCount(){return this.ends_.length}getLinearRing(t){return t<0||this.ends_.length<=t?null:new yn(this.flatCoordinates.slice(0===t?0:this.ends_[t-1],this.ends_[t]),this.layout)}getLinearRings(){const t=this.layout,e=this.flatCoordinates,n=this.ends_,i=[];let o=0;for(let s=0,r=n.length;s<r;++s){const r=n[s],a=new yn(e.slice(o,r),t);i.push(a),o=r}return i}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const t=this.flatCoordinates;!function(t,e,n,i,o){o=void 0!==o&&o;for(let s=0,r=n.length;s<r;++s){const r=n[s],a=Pn(t,e,r,i);if(0===s){if(o&&a||!o&&!a)return!1}else if(o&&!a||!o&&a)return!1;e=r}return!0}(t,0,this.ends_,this.stride)?(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=Mn(this.orientedFlatCoordinates_,0,this.ends_,this.stride)):this.orientedFlatCoordinates_=t,this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(t){const e=[],n=[];return e.length=function(t,e,n,i,o,s,r,a){for(let l=0,h=n.length;l<h;++l){const h=n[l];r=mn(t,e,h,i,o,s,r),a.push(r),e=h}return r}(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(t),e,0,n),new In(e,"XY",n)}getType(){return"Polygon"}intersectsExtent(t){return function(t,e,n,i,o){if(!Rn(t,e,n[0],i,o))return!1;if(1===n.length)return!0;for(let e=1,s=n.length;e<s;++e)if(wn(t,n[e-1],n[e],i,o)&&!Tn(t,n[e-1],n[e],i,o))return!1;return!0}(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);const n=function(t,e,n,i,o){o=o||[];let s=0;for(let r=0,a=n.length;r<a;++r){const a=gn(t,e,n[r],i);o[s++]=a,e=a}return o.length=s,o}(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=0===n.length?0:n[n.length-1],this.changed()}}const Ln=In;function Fn(t){if(yt(t))throw new Error("Cannot create polygon from empty extent");const e=t[0],n=t[1],i=t[2],o=t[3],s=[e,n,e,o,i,o,i,n,e,n];return new In(s,"XY",[s.length])}function An(t,e){setTimeout((function(){t(e)}),0)}function kn(t){return!(t.sourceCenter&&t.targetCenter&&!Ce(t.sourceCenter,t.targetCenter))&&t.sourceResolution===t.targetResolution&&t.sourceRotation===t.targetRotation}function zn(t,e,n,i,o){const s=Math.cos(-o);let r=Math.sin(-o),a=t[0]*s-t[1]*r,l=t[1]*s+t[0]*r;return a+=(e[0]/2-n[0])*i,l+=(n[1]-e[1]/2)*i,r=-r,[a*s-l*r,l*s+a*r]}const Dn=class extends P{constructor(t){super(),this.on,this.once,this.un,t=Object.assign({},t),this.hints_=[0,0],this.animations_=[],this.updateAnimationKey_,this.projection_=ze(t.projection,"EPSG:3857"),this.viewportSize_=[100,100],this.targetCenter_=null,this.targetResolution_,this.targetRotation_,this.nextCenter_=null,this.nextResolution_,this.nextRotation_,this.cancelAnchor_=void 0,t.projection&&function(t){Pe=!(void 0===t||t)}(),t.center&&(t.center=Ue(t.center,this.projection_)),t.extent&&(t.extent=Xe(t.extent,this.projection_)),this.applyOptions_(t)}applyOptions_(t){const e=Object.assign({},t);for(const t in ne)delete e[t];this.setProperties(e,!0);const n=function(t){let e,n,i;let o=void 0!==t.minZoom?t.minZoom:0,r=void 0!==t.maxZoom?t.maxZoom:28;const a=void 0!==t.zoomFactor?t.zoomFactor:2,l=void 0!==t.multiWorld&&t.multiWorld,h=void 0===t.smoothResolutionConstraint||t.smoothResolutionConstraint,c=void 0!==t.showFullExtent&&t.showFullExtent,u=ze(t.projection,"EPSG:3857"),d=u.getExtent();let g=t.constrainOnlyCenter,p=t.extent;if(l||p||!u.isGlobal()||(g=!1,p=d),void 0!==t.resolutions){const a=t.resolutions;n=a[o],i=void 0!==a[r]?a[r]:a[a.length-1],e=t.constrainResolution?function(t,e,n,i){return e=void 0===e||e,function(o,r,a,l){if(void 0!==o){const h=t[0],c=t[t.length-1],u=n?He(h,n,a,i):h;if(l)return e?Qe(o,u,c):Mt(o,c,u);const d=Math.min(u,o),g=Math.floor(s(t,d,r));return t[g]>u&&g<t.length-1?t[g+1]:t[g]}}}(a,h,!g&&p,c):$e(n,i,h,!g&&p,c)}else{const s=(d?Math.max(ft(d),gt(d)):360*se.degrees/u.getMetersPerUnit())/oe/Math.pow(2,0),l=s/Math.pow(2,28);n=t.maxResolution,void 0!==n?o=0:n=s/Math.pow(a,o),i=t.minResolution,void 0===i&&(i=void 0!==t.maxZoom?void 0!==t.maxResolution?n/Math.pow(a,r):s/Math.pow(a,r):l),r=o+Math.floor(Math.log(n/i)/Math.log(a)),i=n/Math.pow(a,r-o),e=t.constrainResolution?function(t,e,n,i,o,s){return i=void 0===i||i,n=void 0!==n?n:0,function(r,a,l,h){if(void 0!==r){const c=o?He(e,o,l,s):e;if(h)return i?Qe(r,c,n):Mt(r,n,c);const u=1e-9,d=Math.ceil(Math.log(e/c)/Math.log(t)-u),g=-a*(.5-u)+.5,p=Math.min(c,r),m=Math.floor(Math.log(e/p)/Math.log(t)+g),_=Math.max(d,m);return Mt(e/Math.pow(t,_),n,c)}}}(a,n,i,h,!g&&p,c):$e(n,i,h,!g&&p,c)}return{constraint:e,maxResolution:n,minResolution:i,minZoom:o,zoomFactor:a}}(t);this.maxResolution_=n.maxResolution,this.minResolution_=n.minResolution,this.zoomFactor_=n.zoomFactor,this.resolutions_=t.resolutions,this.padding_=t.padding,this.minZoom_=n.minZoom;const i=function(t){if(void 0!==t.extent){const e=void 0===t.smoothExtentConstraint||t.smoothExtentConstraint;return Ye(t.extent,t.constrainOnlyCenter,e)}const e=ze(t.projection,"EPSG:3857");if(!0!==t.multiWorld&&e.isGlobal()){const t=e.getExtent().slice();return t[0]=-1/0,t[2]=1/0,Ye(t,!1,!1)}return Be}(t),o=n.constraint,r=function(t){if(void 0===t.enableRotation||t.enableRotation){const e=t.constrainRotation;return void 0===e||!0===e?function(t){const e=Ft(5);return function(t,n){return n||void 0===t?t:Math.abs(t)<=e?0:t}}():!1===e?tn:"number"==typeof e?function(t){const e=2*Math.PI/t;return function(t,n){return n?t:void 0!==t?t=Math.floor(t/e+.5)*e:void 0}}(e):tn}return Je}(t);this.constraints_={center:i,resolution:o,rotation:r},this.setRotation(void 0!==t.rotation?t.rotation:0),this.setCenterInternal(void 0!==t.center?t.center:null),void 0!==t.resolution?this.setResolution(t.resolution):void 0!==t.zoom&&this.setZoom(t.zoom)}get padding(){return this.padding_}set padding(t){let e=this.padding_;this.padding_=t;const n=this.getCenterInternal();if(n){const i=t||[0,0,0,0];e=e||[0,0,0,0];const o=this.getResolution(),s=o/2*(i[3]-e[3]+e[1]-i[1]),r=o/2*(i[0]-e[0]+e[2]-i[2]);this.setCenterInternal([n[0]+s,n[1]-r])}}getUpdatedOptions_(t){const e=this.getProperties();return void 0!==e.resolution?e.resolution=this.getResolution():e.zoom=this.getZoom(),e.center=this.getCenterInternal(),e.rotation=this.getRotation(),Object.assign({},e,t)}animate(t){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);const e=new Array(arguments.length);for(let t=0;t<e.length;++t){let n=arguments[t];n.center&&(n=Object.assign({},n),n.center=Ue(n.center,this.getProjection())),n.anchor&&(n=Object.assign({},n),n.anchor=Ue(n.anchor,this.getProjection())),e[t]=n}this.animateInternal.apply(this,e)}animateInternal(t){let e,n=arguments.length;n>1&&"function"==typeof arguments[n-1]&&(e=arguments[n-1],--n);let i=0;for(;i<n&&!this.isDef();++i){const t=arguments[i];t.center&&this.setCenterInternal(t.center),void 0!==t.zoom?this.setZoom(t.zoom):t.resolution&&this.setResolution(t.resolution),void 0!==t.rotation&&this.setRotation(t.rotation)}if(i===n)return void(e&&An(e,!0));let o=Date.now(),s=this.targetCenter_.slice(),r=this.targetResolution_,a=this.targetRotation_;const l=[];for(;i<n;++i){const t=arguments[i],n={start:o,complete:!1,anchor:t.anchor,duration:void 0!==t.duration?t.duration:1e3,easing:t.easing||on,callback:e};if(t.center&&(n.sourceCenter=s,n.targetCenter=t.center.slice(),s=n.targetCenter),void 0!==t.zoom?(n.sourceResolution=r,n.targetResolution=this.getResolutionForZoom(t.zoom),r=n.targetResolution):t.resolution&&(n.sourceResolution=r,n.targetResolution=t.resolution,r=n.targetResolution),void 0!==t.rotation){n.sourceRotation=a;const e=At(t.rotation-a+Math.PI,2*Math.PI)-Math.PI;n.targetRotation=a+e,a=n.targetRotation}kn(n)?n.complete=!0:o+=n.duration,l.push(n)}this.animations_.push(l),this.setHint(0,1),this.updateAnimations_()}getAnimating(){return this.hints_[0]>0}getInteracting(){return this.hints_[1]>0}cancelAnimations(){let t;this.setHint(0,-this.hints_[0]);for(let e=0,n=this.animations_.length;e<n;++e){const n=this.animations_[e];if(n[0].callback&&An(n[0].callback,!1),!t)for(let e=0,i=n.length;e<i;++e){const i=n[e];if(!i.complete){t=i.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=t,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN}updateAnimations_(){if(void 0!==this.updateAnimationKey_&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),!this.getAnimating())return;const t=Date.now();let e=!1;for(let n=this.animations_.length-1;n>=0;--n){const i=this.animations_[n];let o=!0;for(let n=0,s=i.length;n<s;++n){const s=i[n];if(s.complete)continue;const r=t-s.start;let a=s.duration>0?r/s.duration:1;a>=1?(s.complete=!0,a=1):o=!1;const l=s.easing(a);if(s.sourceCenter){const t=s.sourceCenter[0],e=s.sourceCenter[1],n=s.targetCenter[0],i=s.targetCenter[1];this.nextCenter_=s.targetCenter;const o=t+l*(n-t),r=e+l*(i-e);this.targetCenter_=[o,r]}if(s.sourceResolution&&s.targetResolution){const t=1===l?s.targetResolution:s.sourceResolution+l*(s.targetResolution-s.sourceResolution);if(s.anchor){const e=this.getViewportSize_(this.getRotation()),n=this.constraints_.resolution(t,0,e,!0);this.targetCenter_=this.calculateCenterZoom(n,s.anchor)}this.nextResolution_=s.targetResolution,this.targetResolution_=t,this.applyTargetState_(!0)}if(void 0!==s.sourceRotation&&void 0!==s.targetRotation){const t=1===l?At(s.targetRotation+Math.PI,2*Math.PI)-Math.PI:s.sourceRotation+l*(s.targetRotation-s.sourceRotation);if(s.anchor){const e=this.constraints_.rotation(t,!0);this.targetCenter_=this.calculateCenterRotate(e,s.anchor)}this.nextRotation_=s.targetRotation,this.targetRotation_=t}if(this.applyTargetState_(!0),e=!0,!s.complete)break}if(o){this.animations_[n]=null,this.setHint(0,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;const t=i[0].callback;t&&An(t,!0)}}this.animations_=this.animations_.filter(Boolean),e&&void 0===this.updateAnimationKey_&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}calculateCenterRotate(t,e){let n;const i=this.getCenterInternal();var o,s;return void 0!==i&&(n=[i[0]-e[0],i[1]-e[1]],we(n,t-this.getRotation()),s=e,(o=n)[0]+=+s[0],o[1]+=+s[1]),n}calculateCenterZoom(t,e){let n;const i=this.getCenterInternal(),o=this.getResolution();return void 0!==i&&void 0!==o&&(n=[e[0]-t*(e[0]-i[0])/o,e[1]-t*(e[1]-i[1])/o]),n}getViewportSize_(t){const e=this.viewportSize_;if(t){const n=e[0],i=e[1];return[Math.abs(n*Math.cos(t))+Math.abs(i*Math.sin(t)),Math.abs(n*Math.sin(t))+Math.abs(i*Math.cos(t))]}return e}setViewportSize(t){this.viewportSize_=Array.isArray(t)?t.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)}getCenter(){const t=this.getCenterInternal();return t?Ge(t,this.getProjection()):t}getCenterInternal(){return this.get(ne.CENTER)}getConstraints(){return this.constraints_}getConstrainResolution(){return this.get("constrainResolution")}getHints(t){return void 0!==t?(t[0]=this.hints_[0],t[1]=this.hints_[1],t):this.hints_.slice()}calculateExtent(t){return e=this.calculateExtentInternal(t),this.getProjection(),e;var e}calculateExtentInternal(t){t=t||this.getViewportSizeMinusPadding_();const e=this.getCenterInternal();G(e,"The view center is not defined");const n=this.getResolution();G(void 0!==n,"The view resolution is not defined");const i=this.getRotation();return G(void 0!==i,"The view rotation is not defined"),ut(e,n,i,t)}getMaxResolution(){return this.maxResolution_}getMinResolution(){return this.minResolution_}getMaxZoom(){return this.getZoomForResolution(this.minResolution_)}setMaxZoom(t){this.applyOptions_(this.getUpdatedOptions_({maxZoom:t}))}getMinZoom(){return this.getZoomForResolution(this.maxResolution_)}setMinZoom(t){this.applyOptions_(this.getUpdatedOptions_({minZoom:t}))}setConstrainResolution(t){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:t}))}getProjection(){return this.projection_}getResolution(){return this.get(ne.RESOLUTION)}getResolutions(){return this.resolutions_}getResolutionForExtent(t,e){return this.getResolutionForExtentInternal(Xe(t,this.getProjection()),e)}getResolutionForExtentInternal(t,e){e=e||this.getViewportSizeMinusPadding_();const n=ft(t)/e[0],i=gt(t)/e[1];return Math.max(n,i)}getResolutionForValueFunction(t){t=t||2;const e=this.getConstrainedResolution(this.maxResolution_),n=this.minResolution_,i=Math.log(e/n)/Math.log(t);return function(n){return e/Math.pow(t,n*i)}}getRotation(){return this.get(ne.ROTATION)}getValueForResolutionFunction(t){const e=Math.log(t||2),n=this.getConstrainedResolution(this.maxResolution_),i=this.minResolution_,o=Math.log(n/i)/e;return function(t){return Math.log(n/t)/e/o}}getViewportSizeMinusPadding_(t){let e=this.getViewportSize_(t);const n=this.padding_;return n&&(e=[e[0]-n[1]-n[3],e[1]-n[0]-n[2]]),e}getState(){const t=this.getProjection(),e=this.getResolution(),n=this.getRotation();let i=this.getCenterInternal();const o=this.padding_;if(o){const t=this.getViewportSizeMinusPadding_();i=zn(i,this.getViewportSize_(),[t[0]/2+o[3],t[1]/2+o[0]],e,n)}return{center:i.slice(0),projection:void 0!==t?t:null,resolution:e,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:n,zoom:this.getZoom()}}getViewStateAndExtent(){return{viewState:this.getState(),extent:this.calculateExtent()}}getZoom(){let t;const e=this.getResolution();return void 0!==e&&(t=this.getZoomForResolution(e)),t}getZoomForResolution(t){let e,n,i=this.minZoom_||0;if(this.resolutions_){const o=s(this.resolutions_,t,1);i=o,e=this.resolutions_[o],n=o==this.resolutions_.length-1?2:e/this.resolutions_[o+1]}else e=this.maxResolution_,n=this.zoomFactor_;return i+Math.log(e/t)/Math.log(n)}getResolutionForZoom(t){if(this.resolutions_){if(this.resolutions_.length<=1)return 0;const e=Mt(Math.floor(t),0,this.resolutions_.length-2),n=this.resolutions_[e]/this.resolutions_[e+1];return this.resolutions_[e]/Math.pow(n,Mt(t-e,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,t-this.minZoom_)}fit(t,e){let n;if(G(Array.isArray(t)||"function"==typeof t.getSimplifiedGeometry,"Invalid extent or geometry provided as `geometry`"),Array.isArray(t))G(!yt(t),"Cannot fit empty extent provided as `geometry`"),n=Fn(Xe(t,this.getProjection()));else if("Circle"===t.getType()){const e=Xe(t.getExtent(),this.getProjection());n=Fn(e),n.rotate(this.getRotation(),ht(e))}else{const e=Ke();n=e?t.clone().transform(e,this.getProjection()):t}this.fitInternal(n,e)}rotatedExtentForGeometry(t){const e=this.getRotation(),n=Math.cos(e),i=Math.sin(-e),o=t.getFlatCoordinates(),s=t.getStride();let r=1/0,a=1/0,l=-1/0,h=-1/0;for(let t=0,e=o.length;t<e;t+=s){const e=o[t]*n-o[t+1]*i,s=o[t]*i+o[t+1]*n;r=Math.min(r,e),a=Math.min(a,s),l=Math.max(l,e),h=Math.max(h,s)}return[r,a,l,h]}fitInternal(t,e){let n=(e=e||{}).size;n||(n=this.getViewportSizeMinusPadding_());const i=void 0!==e.padding?e.padding:[0,0,0,0],o=void 0!==e.nearest&&e.nearest;let s;s=void 0!==e.minResolution?e.minResolution:void 0!==e.maxZoom?this.getResolutionForZoom(e.maxZoom):0;const r=this.rotatedExtentForGeometry(t);let a=this.getResolutionForExtentInternal(r,[n[0]-i[1]-i[3],n[1]-i[0]-i[2]]);a=isNaN(a)?s:Math.max(a,s),a=this.getConstrainedResolution(a,o?0:1);const l=this.getRotation(),c=Math.sin(l),u=Math.cos(l),d=ht(r);d[0]+=(i[1]-i[3])/2*a,d[1]+=(i[0]-i[2])/2*a;const g=d[0]*u-d[1]*c,p=d[1]*u+d[0]*c,m=this.getConstrainedCenter([g,p],a),_=e.callback?e.callback:h;void 0!==e.duration?this.animateInternal({resolution:a,center:m,duration:e.duration,easing:e.easing},_):(this.targetResolution_=a,this.targetCenter_=m,this.applyTargetState_(!1,!0),An(_,!0))}centerOn(t,e,n){this.centerOnInternal(Ue(t,this.getProjection()),e,n)}centerOnInternal(t,e,n){this.setCenterInternal(zn(t,e,n,this.getResolution(),this.getRotation()))}calculateCenterShift(t,e,n,i){let o;const s=this.padding_;if(s&&t){const r=this.getViewportSizeMinusPadding_(-n),a=zn(t,i,[r[0]/2+s[3],r[1]/2+s[0]],e,n);o=[t[0]-a[0],t[1]-a[1]]}return o}isDef(){return!!this.getCenterInternal()&&void 0!==this.getResolution()}adjustCenter(t){const e=Ge(this.targetCenter_,this.getProjection());this.setCenter([e[0]+t[0],e[1]+t[1]])}adjustCenterInternal(t){const e=this.targetCenter_;this.setCenterInternal([e[0]+t[0],e[1]+t[1]])}adjustResolution(t,e){e=e&&Ue(e,this.getProjection()),this.adjustResolutionInternal(t,e)}adjustResolutionInternal(t,e){const n=this.getAnimating()||this.getInteracting(),i=this.getViewportSize_(this.getRotation()),o=this.constraints_.resolution(this.targetResolution_*t,0,i,n);e&&(this.targetCenter_=this.calculateCenterZoom(o,e)),this.targetResolution_*=t,this.applyTargetState_()}adjustZoom(t,e){this.adjustResolution(Math.pow(this.zoomFactor_,-t),e)}adjustRotation(t,e){e&&(e=Ue(e,this.getProjection())),this.adjustRotationInternal(t,e)}adjustRotationInternal(t,e){const n=this.getAnimating()||this.getInteracting(),i=this.constraints_.rotation(this.targetRotation_+t,n);e&&(this.targetCenter_=this.calculateCenterRotate(i,e)),this.targetRotation_+=t,this.applyTargetState_()}setCenter(t){this.setCenterInternal(t?Ue(t,this.getProjection()):t)}setCenterInternal(t){this.targetCenter_=t,this.applyTargetState_()}setHint(t,e){return this.hints_[t]+=e,this.changed(),this.hints_[t]}setResolution(t){this.targetResolution_=t,this.applyTargetState_()}setRotation(t){this.targetRotation_=t,this.applyTargetState_()}setZoom(t){this.setResolution(this.getResolutionForZoom(t))}applyTargetState_(t,e){const n=this.getAnimating()||this.getInteracting()||e,i=this.constraints_.rotation(this.targetRotation_,n),o=this.getViewportSize_(i),s=this.constraints_.resolution(this.targetResolution_,0,o,n),r=this.constraints_.center(this.targetCenter_,s,o,n,this.calculateCenterShift(this.targetCenter_,s,i,o));this.get(ne.ROTATION)!==i&&this.set(ne.ROTATION,i),this.get(ne.RESOLUTION)!==s&&(this.set(ne.RESOLUTION,s),this.set("zoom",this.getZoom(),!0)),r&&this.get(ne.CENTER)&&Ce(this.get(ne.CENTER),r)||this.set(ne.CENTER,r),this.getAnimating()&&!t&&this.cancelAnimations(),this.cancelAnchor_=void 0}resolveConstraints(t,e,n){t=void 0!==t?t:200;const i=e||0,o=this.constraints_.rotation(this.targetRotation_),s=this.getViewportSize_(o),r=this.constraints_.resolution(this.targetResolution_,i,s),a=this.constraints_.center(this.targetCenter_,r,s,!1,this.calculateCenterShift(this.targetCenter_,r,o,s));if(0===t&&!this.cancelAnchor_)return this.targetResolution_=r,this.targetRotation_=o,this.targetCenter_=a,void this.applyTargetState_();n=n||(0===t?this.cancelAnchor_:void 0),this.cancelAnchor_=void 0,this.getResolution()===r&&this.getRotation()===o&&this.getCenterInternal()&&Ce(this.getCenterInternal(),a)||(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:o,center:a,resolution:r,duration:t,easing:nn,anchor:n}))}beginInteraction(){this.resolveConstraints(0),this.setHint(1,1)}endInteraction(t,e,n){n=n&&Ue(n,this.getProjection()),this.endInteractionInternal(t,e,n)}endInteractionInternal(t,e,n){this.getInteracting()&&(this.setHint(1,-1),this.resolveConstraints(t,e,n))}getConstrainedCenter(t,e){const n=this.getViewportSize_(this.getRotation());return this.constraints_.center(t,e||this.getResolution(),n)}getConstrainedZoom(t,e){const n=this.getResolutionForZoom(t);return this.getZoomForResolution(this.getConstrainedResolution(n,e))}getConstrainedResolution(t,e){e=e||0;const n=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(t,e,n)}};function On(t,e){if(!t.visible)return!1;const n=e.resolution;if(n<t.minResolution||n>=t.maxResolution)return!1;const i=e.zoom;return i>t.minZoom&&i<=t.maxZoom}const Nn=class extends Jt{constructor(t){const e=Object.assign({},t);delete e.source,super(e),this.on,this.once,this.un,this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,this.renderer_=null,this.sourceReady_=!1,this.rendered=!1,t.render&&(this.render=t.render),t.map&&this.setMap(t.map),this.addChangeListener($t,this.handleSourcePropertyChange_);const n=t.source?t.source:null;this.setSource(n)}getLayersArray(t){return(t=t||[]).push(this),t}getLayerStatesArray(t){return(t=t||[]).push(this.getLayerState()),t}getSource(){return this.get($t)||null}getRenderSource(){return this.getSource()}getSourceState(){const t=this.getSource();return t?t.getState():"undefined"}handleSourceChange_(){this.changed(),this.sourceReady_||"ready"!==this.getSource().getState()||(this.sourceReady_=!0,this.dispatchEvent("sourceready"))}handleSourcePropertyChange_(){this.sourceChangeKey_&&(C(this.sourceChangeKey_),this.sourceChangeKey_=null),this.sourceReady_=!1;const t=this.getSource();t&&(this.sourceChangeKey_=y(t,d,this.handleSourceChange_,this),"ready"===t.getState()&&(this.sourceReady_=!0,setTimeout((()=>{this.dispatchEvent("sourceready")}),0))),this.changed()}getFeatures(t){return this.renderer_?this.renderer_.getFeatures(t):Promise.resolve([])}getData(t){return this.renderer_&&this.rendered?this.renderer_.getData(t):null}isVisible(t){let e;const n=this.getMapInternal();let i;!t&&n&&(t=n.getView()),e=t instanceof Dn?{viewState:t.getState(),extent:t.calculateExtent()}:t,!e.layerStatesArray&&n&&(e.layerStatesArray=n.getLayerGroup().getLayerStatesArray()),i=e.layerStatesArray?e.layerStatesArray.find((t=>t.layer===this)):this.getLayerState();const o=this.getExtent();return On(i,e.viewState)&&(!o||vt(o,e.extent))}getAttributions(t){if(!this.isVisible(t))return[];let e;const n=this.getSource();if(n&&(e=n.getAttributions()),!e)return[];let i=e(t instanceof Dn?t.getViewStateAndExtent():t);return Array.isArray(i)||(i=[i]),i}render(t,e){const n=this.getRenderer();return n.prepareFrame(t)?(this.rendered=!0,n.renderFrame(t,e)):null}unrender(){this.rendered=!1}setMapInternal(t){t||this.unrender(),this.set("map",t)}getMapInternal(){return this.get("map")}setMap(t){this.mapPrecomposeKey_&&(C(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),t||this.changed(),this.mapRenderKey_&&(C(this.mapRenderKey_),this.mapRenderKey_=null),t&&(this.mapPrecomposeKey_=y(t,te,(function(t){const e=t.frameState.layerStatesArray,n=this.getLayerState(!1);G(!e.some((function(t){return t.layer===n.layer})),"A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both."),e.push(n)}),this),this.mapRenderKey_=y(this,d,t.render,t),this.changed())}setSource(t){this.set($t,t)}getRenderer(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_}hasRenderer(){return!!this.renderer_}createRenderer(){return null}disposeInternal(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_),this.setSource(null),super.disposeInternal()}};function jn(t,e){Ut.expire()}const Zn=class extends i{constructor(t){super(),this.map_=t}dispatchRenderEvent(t,e){E()}calculateMatrices2D(t){const e=t.viewState,n=t.coordinateToPixelTransform,i=t.pixelToCoordinateTransform;X(n,t.size[0]/2,t.size[1]/2,1/e.resolution,-1/e.resolution,-e.rotation,-e.center[0],-e.center[1]),V(i,n)}forEachFeatureAtCoordinate(t,e,n,i,o,s,r,a){let l;const h=e.viewState;function c(t,e,n,i){return o.call(s,e,t?n:null,i)}const u=h.projection,d=function(t,e){if(e.canWrapX()){const n=ft(e.getExtent()),i=function(t,e,n){const i=e.getExtent();let o=0;return e.canWrapX()&&(t[0]<i[0]||t[0]>i[2])&&(n=n||ft(i),o=Math.floor((t[0]-i[0])/n)),o}(t,e,n);i&&(t[0]-=i*n)}return t}(t.slice(),u),g=[[0,0]];if(u.canWrapX()&&i){const t=ft(u.getExtent());g.push([-t,0],[t,0])}const p=e.layerStatesArray,m=p.length,_=[],f=[];for(let i=0;i<g.length;i++)for(let o=m-1;o>=0;--o){const s=p[o],u=s.layer;if(u.hasRenderer()&&On(s,h)&&r.call(a,u)){const o=u.getRenderer(),r=u.getSource();if(o&&r){const a=r.getWrapX()?d:t,h=c.bind(null,s.managed);f[0]=a[0]+g[i][0],f[1]=a[1]+g[i][1],l=o.forEachFeatureAtCoordinate(f,e,n,h,_)}if(l)return l}}if(0===_.length)return;const v=1/_.length;return _.forEach(((t,e)=>t.distanceSq+=e*v)),_.sort(((t,e)=>t.distanceSq-e.distanceSq)),_.some((t=>l=t.callback(t.feature,t.layer,t.geometry))),l}hasFeatureAtCoordinate(t,e,n,i,o,s){return void 0!==this.forEachFeatureAtCoordinate(t,e,n,i,a,this,o,s)}getMap(){return this.map_}renderFrame(t){E()}flushDeclutterItems(t){}scheduleExpireIconCache(t){Ut.canExpireCache()&&t.postRenderFunctions.push(jn)}},Kn=class extends t{constructor(t,e,n,i){super(t),this.inversePixelTransform=e,this.frameState=n,this.context=i}},Gn="ol-hidden",Un="ol-unselectable",Xn="ol-control",Vn="ol-collapsed";new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))","?\\s*([-,\\\"\\'\\sa-z]+?)\\s*$"].join(""),"i");function qn(t,e,n,i){let o;return o=n&&n.length?n.shift():j?new OffscreenCanvas(t||300,e||300):document.createElement("canvas"),t&&(o.width=t),e&&(o.height=e),o.getContext("2d",i)}function Wn(t){const e=t.canvas;e.width=1,e.height=1,t.clearRect(0,0,1,1)}function Yn(t,e){const n=e.parentNode;n&&n.replaceChild(t,e)}function Bn(t){return t&&t.parentNode?t.parentNode.removeChild(t):null}const Hn=new P;!function(){const t=["monospace","serif"];t.length}();const Qn=class extends Zn{constructor(t){super(t),this.fontChangeListenerKey_=y(Hn,e,t.redrawText.bind(t)),this.element_=document.createElement("div");const n=this.element_.style;n.position="absolute",n.width="100%",n.height="100%",n.zIndex="0",this.element_.className=Un+" ol-layers";const i=t.getViewport();i.insertBefore(this.element_,i.firstChild||null),this.children_=[],this.renderedVisible_=!0,this.declutterLayers_=[]}dispatchRenderEvent(t,e){const n=this.getMap();if(n.hasListener(t)){const i=new Kn(t,void 0,e);n.dispatchEvent(i)}}disposeInternal(){C(this.fontChangeListenerKey_),this.element_.parentNode.removeChild(this.element_),super.disposeInternal()}renderFrame(t){if(!t)return void(this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1));this.calculateMatrices2D(t),this.dispatchRenderEvent(te,t);const e=t.layerStatesArray.sort((function(t,e){return t.zIndex-e.zIndex})),n=t.viewState;this.children_.length=0;const i=this.declutterLayers_;i.length=0;let o=null;for(let s=0,r=e.length;s<r;++s){const r=e[s];t.layerIndex=s;const a=r.layer,l=a.getSourceState();if(!On(r,n)||"ready"!=l&&"undefined"!=l){a.unrender();continue}const h=a.render(t,o);h&&(h!==o&&(this.children_.push(h),o=h),"getDeclutter"in a&&i.push(a))}this.flushDeclutterItems(t),function(t,e){const n=t.childNodes;for(let i=0;;++i){const o=n[i],s=e[i];if(!o&&!s)break;o!==s&&(o?s?t.insertBefore(s,o):(t.removeChild(o),--i):t.appendChild(s))}}(this.element_,this.children_),this.dispatchRenderEvent("postcompose",t),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(t)}flushDeclutterItems(t){const e=this.declutterLayers_;for(let n=e.length-1;n>=0;--n)e[n].renderDeclutter(t);e.length=0}};class $n extends t{constructor(t,e){super(t),this.layer=e}}const Jn="layers";class ti extends Jt{constructor(t){t=t||{};const e=Object.assign({},t);delete e.layers;let n=t.layers;super(e),this.on,this.once,this.un,this.layersListenerKeys_=[],this.listenerKeys_={},this.addChangeListener(Jn,this.handleLayersChanged_),n?Array.isArray(n)?n=new A(n.slice(),{unique:!0}):G("function"==typeof n.getArray,"Expected `layers` to be an array or a `Collection`"):n=new A(void 0,{unique:!0}),this.setLayers(n)}handleLayerChange_(){this.changed()}handleLayersChanged_(){this.layersListenerKeys_.forEach(C),this.layersListenerKeys_.length=0;const t=this.getLayers();this.layersListenerKeys_.push(y(t,M,this.handleLayersAdd_,this),y(t,I,this.handleLayersRemove_,this));for(const t in this.listenerKeys_)this.listenerKeys_[t].forEach(C);c(this.listenerKeys_);const e=t.getArray();for(let t=0,n=e.length;t<n;t++){const n=e[t];this.registerLayerListeners_(n),this.dispatchEvent(new $n("addlayer",n))}this.changed()}registerLayerListeners_(t){const n=[y(t,e,this.handleLayerChange_,this),y(t,d,this.handleLayerChange_,this)];t instanceof ti&&n.push(y(t,"addlayer",this.handleLayerGroupAdd_,this),y(t,"removelayer",this.handleLayerGroupRemove_,this)),this.listenerKeys_[R(t)]=n}handleLayerGroupAdd_(t){this.dispatchEvent(new $n("addlayer",t.layer))}handleLayerGroupRemove_(t){this.dispatchEvent(new $n("removelayer",t.layer))}handleLayersAdd_(t){const e=t.element;this.registerLayerListeners_(e),this.dispatchEvent(new $n("addlayer",e)),this.changed()}handleLayersRemove_(t){const e=t.element,n=R(e);this.listenerKeys_[n].forEach(C),delete this.listenerKeys_[n],this.dispatchEvent(new $n("removelayer",e)),this.changed()}getLayers(){return this.get(Jn)}setLayers(t){const e=this.getLayers();if(e){const t=e.getArray();for(let e=0,n=t.length;e<n;++e)this.dispatchEvent(new $n("removelayer",t[e]))}this.set(Jn,t)}getLayersArray(t){return t=void 0!==t?t:[],this.getLayers().forEach((function(e){e.getLayersArray(t)})),t}getLayerStatesArray(t){const e=void 0!==t?t:[],n=e.length;this.getLayers().forEach((function(t){t.getLayerStatesArray(e)}));const i=this.getLayerState();let o=i.zIndex;t||void 0!==i.zIndex||(o=0);for(let t=n,s=e.length;t<s;t++){const n=e[t];n.opacity*=i.opacity,n.visible=n.visible&&i.visible,n.maxResolution=Math.min(n.maxResolution,i.maxResolution),n.minResolution=Math.max(n.minResolution,i.minResolution),n.minZoom=Math.max(n.minZoom,i.minZoom),n.maxZoom=Math.min(n.maxZoom,i.maxZoom),void 0!==i.extent&&(void 0!==n.extent?n.extent=pt(n.extent,i.extent):n.extent=i.extent),void 0===n.zIndex&&(n.zIndex=o)}return e}getSourceState(){return"ready"}}const ei=ti,ni=class extends t{constructor(t,e,n){super(t),this.map=e,this.frameState=void 0!==n?n:null}},ii=class extends ni{constructor(t,e,n,i,o,s){super(t,e,o),this.originalEvent=n,this.pixel_=null,this.coordinate_=null,this.dragging=void 0!==i&&i,this.activePointers=s}get pixel(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_}set pixel(t){this.pixel_=t}get coordinate(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_}set coordinate(t){this.coordinate_=t}preventDefault(){super.preventDefault(),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()}stopPropagation(){super.stopPropagation(),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()}},oi={SINGLECLICK:"singleclick",CLICK:p,DBLCLICK:"dblclick",POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},si="pointerdown",ri=class extends u{constructor(t,e){super(t),this.map_=t,this.clickTimeoutId_,this.emulateClicks_=!1,this.dragging_=!1,this.dragListenerKeys_=[],this.moveTolerance_=void 0===e?1:e,this.down_=null;const n=this.map_.getViewport();this.activePointers_=[],this.trackedTouches_={},this.element_=n,this.pointerdownListenerKey_=y(n,si,this.handlePointerDown_,this),this.originalPointerMoveEvent_,this.relayedListenerKey_=y(n,"pointermove",this.relayMoveEvent_,this),this.boundHandleTouchMove_=this.handleTouchMove_.bind(this),this.element_.addEventListener(f,this.boundHandleTouchMove_,!!K&&{passive:!1})}emulateClick_(t){let e=new ii(oi.CLICK,this.map_,t);this.dispatchEvent(e),void 0!==this.clickTimeoutId_?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,e=new ii(oi.DBLCLICK,this.map_,t),this.dispatchEvent(e)):this.clickTimeoutId_=setTimeout((()=>{this.clickTimeoutId_=void 0;const e=new ii(oi.SINGLECLICK,this.map_,t);this.dispatchEvent(e)}),250)}updateActivePointers_(t){const e=t,n=e.pointerId;if(e.type==oi.POINTERUP||e.type==oi.POINTERCANCEL){delete this.trackedTouches_[n];for(const t in this.trackedTouches_)if(this.trackedTouches_[t].target!==e.target){delete this.trackedTouches_[t];break}}else e.type!=oi.POINTERDOWN&&e.type!=oi.POINTERMOVE||(this.trackedTouches_[n]=e);this.activePointers_=Object.values(this.trackedTouches_)}handlePointerUp_(t){this.updateActivePointers_(t);const e=new ii(oi.POINTERUP,this.map_,t,void 0,void 0,this.activePointers_);this.dispatchEvent(e),this.emulateClicks_&&!e.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(t)&&this.emulateClick_(this.down_),0===this.activePointers_.length&&(this.dragListenerKeys_.forEach(C),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)}isMouseActionButton_(t){return 0===t.button}handlePointerDown_(t){this.emulateClicks_=0===this.activePointers_.length,this.updateActivePointers_(t);const e=new ii(oi.POINTERDOWN,this.map_,t,void 0,void 0,this.activePointers_);if(this.dispatchEvent(e),this.down_=new PointerEvent(t.type,t),Object.defineProperty(this.down_,"target",{writable:!1,value:t.target}),0===this.dragListenerKeys_.length){const t=this.map_.getOwnerDocument();this.dragListenerKeys_.push(y(t,oi.POINTERMOVE,this.handlePointerMove_,this),y(t,oi.POINTERUP,this.handlePointerUp_,this),y(this.element_,oi.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==t&&this.dragListenerKeys_.push(y(this.element_.getRootNode(),oi.POINTERUP,this.handlePointerUp_,this))}}handlePointerMove_(t){if(this.isMoving_(t)){this.updateActivePointers_(t),this.dragging_=!0;const e=new ii(oi.POINTERDRAG,this.map_,t,this.dragging_,void 0,this.activePointers_);this.dispatchEvent(e)}}relayMoveEvent_(t){this.originalPointerMoveEvent_=t;const e=!(!this.down_||!this.isMoving_(t));this.dispatchEvent(new ii(oi.POINTERMOVE,this.map_,t,e))}handleTouchMove_(t){const e=this.originalPointerMoveEvent_;e&&!e.defaultPrevented||"boolean"==typeof t.cancelable&&!0!==t.cancelable||t.preventDefault()}isMoving_(t){return this.dragging_||Math.abs(t.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(t.clientY-this.down_.clientY)>this.moveTolerance_}disposeInternal(){this.relayedListenerKey_&&(C(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(f,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(C(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(C),this.dragListenerKeys_.length=0,this.element_=null,super.disposeInternal()}},ai="postrender",li="loadstart",hi="loadend",ci="layergroup",ui="size",di="target",gi="view",pi=1/0,mi=class{constructor(t,e){this.priorityFunction_=t,this.keyFunction_=e,this.elements_=[],this.priorities_=[],this.queuedElements_={}}clear(){this.elements_.length=0,this.priorities_.length=0,c(this.queuedElements_)}dequeue(){const t=this.elements_,e=this.priorities_,n=t[0];1==t.length?(t.length=0,e.length=0):(t[0]=t.pop(),e[0]=e.pop(),this.siftUp_(0));const i=this.keyFunction_(n);return delete this.queuedElements_[i],n}enqueue(t){G(!(this.keyFunction_(t)in this.queuedElements_),"Tried to enqueue an `element` that was already added to the queue");const e=this.priorityFunction_(t);return e!=pi&&(this.elements_.push(t),this.priorities_.push(e),this.queuedElements_[this.keyFunction_(t)]=!0,this.siftDown_(0,this.elements_.length-1),!0)}getCount(){return this.elements_.length}getLeftChildIndex_(t){return 2*t+1}getRightChildIndex_(t){return 2*t+2}getParentIndex_(t){return t-1>>1}heapify_(){let t;for(t=(this.elements_.length>>1)-1;t>=0;t--)this.siftUp_(t)}isEmpty(){return 0===this.elements_.length}isKeyQueued(t){return t in this.queuedElements_}isQueued(t){return this.isKeyQueued(this.keyFunction_(t))}siftUp_(t){const e=this.elements_,n=this.priorities_,i=e.length,o=e[t],s=n[t],r=t;for(;t<i>>1;){const o=this.getLeftChildIndex_(t),s=this.getRightChildIndex_(t),r=s<i&&n[s]<n[o]?s:o;e[t]=e[r],n[t]=n[r],t=r}e[t]=o,n[t]=s,this.siftDown_(r,t)}siftDown_(t,e){const n=this.elements_,i=this.priorities_,o=n[e],s=i[e];for(;e>t;){const t=this.getParentIndex_(e);if(!(i[t]>s))break;n[e]=n[t],i[e]=i[t],e=t}n[e]=o,i[e]=s}reprioritize(){const t=this.priorityFunction_,e=this.elements_,n=this.priorities_;let i=0;const o=e.length;let s,r,a;for(r=0;r<o;++r)s=e[r],a=t(s),a==pi?delete this.queuedElements_[this.keyFunction_(s)]:(n[i]=a,e[i++]=s);e.length=i,n.length=i,this.heapify_()}},_i=class extends mi{constructor(t,e){super((function(e){return t.apply(null,e)}),(function(t){return t[0].getKey()})),this.boundHandleTileChange_=this.handleTileChange.bind(this),this.tileChangeCallback_=e,this.tilesLoading_=0,this.tilesLoadingKeys_={}}enqueue(t){const e=super.enqueue(t);return e&&t[0].addEventListener(d,this.boundHandleTileChange_),e}getTilesLoading(){return this.tilesLoading_}handleTileChange(t){const e=t.target,n=e.getState();if(2===n||3===n||4===n){3!==n&&e.removeEventListener(d,this.boundHandleTileChange_);const t=e.getKey();t in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[t],--this.tilesLoading_),this.tileChangeCallback_()}}loadMoreTiles(t,e){let n,i,o,s=0;for(;this.tilesLoading_<t&&s<e&&this.getCount()>0;)i=this.dequeue()[0],o=i.getKey(),n=i.getState(),0!==n||o in this.tilesLoadingKeys_||(this.tilesLoadingKeys_[o]=!0,++this.tilesLoading_,++s,i.load())}},fi=class extends P{constructor(t){super();const e=t.element;!e||t.target||e.style.pointerEvents||(e.style.pointerEvents="auto"),this.element=e||null,this.target_=null,this.map_=null,this.listenerKeys=[],t.render&&(this.render=t.render),t.target&&this.setTarget(t.target)}disposeInternal(){Bn(this.element),super.disposeInternal()}getMap(){return this.map_}setMap(t){this.map_&&Bn(this.element);for(let t=0,e=this.listenerKeys.length;t<e;++t)C(this.listenerKeys[t]);this.listenerKeys.length=0,this.map_=t,t&&((this.target_?this.target_:t.getOverlayContainerStopEvent()).appendChild(this.element),this.render!==h&&this.listenerKeys.push(y(t,ai,this.render,this)),t.render())}render(t){}setTarget(t){this.target_="string"==typeof t?document.getElementById(t):t}},vi=class extends fi{constructor(t){t=t||{},super({element:document.createElement("div"),render:t.render,target:t.target}),this.ulElement_=document.createElement("ul"),this.collapsed_=void 0===t.collapsed||t.collapsed,this.userCollapsed_=this.collapsed_,this.overrideCollapsible_=void 0!==t.collapsible,this.collapsible_=void 0===t.collapsible||t.collapsible,this.collapsible_||(this.collapsed_=!1);const e=void 0!==t.className?t.className:"ol-attribution",n=void 0!==t.tipLabel?t.tipLabel:"Attributions",i=void 0!==t.expandClassName?t.expandClassName:e+"-expand",o=void 0!==t.collapseLabel?t.collapseLabel:"›",s=void 0!==t.collapseClassName?t.collapseClassName:e+"-collapse";"string"==typeof o?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=o,this.collapseLabel_.className=s):this.collapseLabel_=o;const r=void 0!==t.label?t.label:"i";"string"==typeof r?(this.label_=document.createElement("span"),this.label_.textContent=r,this.label_.className=i):this.label_=r;const a=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_;this.toggleButton_=document.createElement("button"),this.toggleButton_.setAttribute("type","button"),this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_)),this.toggleButton_.title=n,this.toggleButton_.appendChild(a),this.toggleButton_.addEventListener(p,this.handleClick_.bind(this),!1);const l=e+" "+Un+" "+Xn+(this.collapsed_&&this.collapsible_?" "+Vn:"")+(this.collapsible_?"":" ol-uncollapsible"),h=this.element;h.className=l,h.appendChild(this.toggleButton_),h.appendChild(this.ulElement_),this.renderedAttributions_=[],this.renderedVisible_=!0}collectSourceAttributions_(t){const e=Array.from(new Set(this.getMap().getAllLayers().flatMap((e=>e.getAttributions(t))))),n=!this.getMap().getAllLayers().some((t=>t.getSource()&&!1===t.getSource().getAttributionsCollapsible()));return this.overrideCollapsible_||this.setCollapsible(n),e}updateElement_(t){if(!t)return void(this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1));const e=this.collectSourceAttributions_(t),n=e.length>0;if(this.renderedVisible_!=n&&(this.element.style.display=n?"":"none",this.renderedVisible_=n),!r(e,this.renderedAttributions_)){!function(t){for(;t.lastChild;)t.removeChild(t.lastChild)}(this.ulElement_);for(let t=0,n=e.length;t<n;++t){const n=document.createElement("li");n.innerHTML=e[t],this.ulElement_.appendChild(n)}this.renderedAttributions_=e}}handleClick_(t){t.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_}handleToggle_(){this.element.classList.toggle(Vn),this.collapsed_?Yn(this.collapseLabel_,this.label_):Yn(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))}getCollapsible(){return this.collapsible_}setCollapsible(t){this.collapsible_!==t&&(this.collapsible_=t,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_())}setCollapsed(t){this.userCollapsed_=t,this.collapsible_&&this.collapsed_!==t&&this.handleToggle_()}getCollapsed(){return this.collapsed_}render(t){this.updateElement_(t.frameState)}},yi=class extends fi{constructor(t){t=t||{},super({element:document.createElement("div"),render:t.render,target:t.target});const e=void 0!==t.className?t.className:"ol-rotate",n=void 0!==t.label?t.label:"⇧",i=void 0!==t.compassClassName?t.compassClassName:"ol-compass";this.label_=null,"string"==typeof n?(this.label_=document.createElement("span"),this.label_.className=i,this.label_.textContent=n):(this.label_=n,this.label_.classList.add(i));const o=t.tipLabel?t.tipLabel:"Reset rotation",s=document.createElement("button");s.className=e+"-reset",s.setAttribute("type","button"),s.title=o,s.appendChild(this.label_),s.addEventListener(p,this.handleClick_.bind(this),!1);const r=e+" "+Un+" "+Xn,a=this.element;a.className=r,a.appendChild(s),this.callResetNorth_=t.resetNorth?t.resetNorth:void 0,this.duration_=void 0!==t.duration?t.duration:250,this.autoHide_=void 0===t.autoHide||t.autoHide,this.rotation_=void 0,this.autoHide_&&this.element.classList.add(Gn)}handleClick_(t){t.preventDefault(),void 0!==this.callResetNorth_?this.callResetNorth_():this.resetNorth_()}resetNorth_(){const t=this.getMap().getView();if(!t)return;const e=t.getRotation();void 0!==e&&(this.duration_>0&&e%(2*Math.PI)!=0?t.animate({rotation:0,duration:this.duration_,easing:nn}):t.setRotation(0))}render(t){const e=t.frameState;if(!e)return;const n=e.viewState.rotation;if(n!=this.rotation_){const t="rotate("+n+"rad)";if(this.autoHide_){const t=this.element.classList.contains(Gn);t||0!==n?t&&0!==n&&this.element.classList.remove(Gn):this.element.classList.add(Gn)}this.label_.style.transform=t}this.rotation_=n}},xi=class extends fi{constructor(t){t=t||{},super({element:document.createElement("div"),target:t.target});const e=void 0!==t.className?t.className:"ol-zoom",n=void 0!==t.delta?t.delta:1,i=void 0!==t.zoomInClassName?t.zoomInClassName:e+"-in",o=void 0!==t.zoomOutClassName?t.zoomOutClassName:e+"-out",s=void 0!==t.zoomInLabel?t.zoomInLabel:"+",r=void 0!==t.zoomOutLabel?t.zoomOutLabel:"–",a=void 0!==t.zoomInTipLabel?t.zoomInTipLabel:"Zoom in",l=void 0!==t.zoomOutTipLabel?t.zoomOutTipLabel:"Zoom out",h=document.createElement("button");h.className=i,h.setAttribute("type","button"),h.title=a,h.appendChild("string"==typeof s?document.createTextNode(s):s),h.addEventListener(p,this.handleClick_.bind(this,n),!1);const c=document.createElement("button");c.className=o,c.setAttribute("type","button"),c.title=l,c.appendChild("string"==typeof r?document.createTextNode(r):r),c.addEventListener(p,this.handleClick_.bind(this,-n),!1);const u=e+" "+Un+" "+Xn,d=this.element;d.className=u,d.appendChild(h),d.appendChild(c),this.duration_=void 0!==t.duration?t.duration:250}handleClick_(t,e){e.preventDefault(),this.zoomByDelta_(t)}zoomByDelta_(t){const e=this.getMap().getView();if(!e)return;const n=e.getZoom();if(void 0!==n){const i=e.getConstrainedZoom(n+t);this.duration_>0?(e.getAnimating()&&e.cancelAnimations(),e.animate({zoom:i,duration:this.duration_,easing:nn})):e.setZoom(i)}}},Ci="active";function wi(t,e,n,i){const o=t.getZoom();if(void 0===o)return;const s=t.getConstrainedZoom(o+e),r=t.getResolutionForZoom(s);t.getAnimating()&&t.cancelAnimations(),t.animate({resolution:r,anchor:n,duration:void 0!==i?i:250,easing:nn})}const bi=class extends P{constructor(t){super(),this.on,this.once,this.un,t&&t.handleEvent&&(this.handleEvent=t.handleEvent),this.map_=null,this.setActive(!0)}getActive(){return this.get(Ci)}getMap(){return this.map_}handleEvent(t){return!0}setActive(t){this.set(Ci,t)}setMap(t){this.map_=t}},Ei=class extends bi{constructor(t){super(),t=t||{},this.delta_=t.delta?t.delta:1,this.duration_=void 0!==t.duration?t.duration:250}handleEvent(t){let e=!1;if(t.type==oi.DBLCLICK){const n=t.originalEvent,i=t.map,o=t.coordinate,s=n.shiftKey?-this.delta_:this.delta_;wi(i.getView(),s,o,this.duration_),n.preventDefault(),e=!0}return!e}};function Ti(t){const e=t.length;let n=0,i=0;for(let o=0;o<e;o++)n+=t[o].clientX,i+=t[o].clientY;return{clientX:n/e,clientY:i/e}}const Ri=class extends bi{constructor(t){super(t=t||{}),t.handleDownEvent&&(this.handleDownEvent=t.handleDownEvent),t.handleDragEvent&&(this.handleDragEvent=t.handleDragEvent),t.handleMoveEvent&&(this.handleMoveEvent=t.handleMoveEvent),t.handleUpEvent&&(this.handleUpEvent=t.handleUpEvent),t.stopDown&&(this.stopDown=t.stopDown),this.handlingDownUpSequence=!1,this.targetPointers=[]}getPointerCount(){return this.targetPointers.length}handleDownEvent(t){return!1}handleDragEvent(t){}handleEvent(t){if(!t.originalEvent)return!0;let e=!1;if(this.updateTrackedPointers_(t),this.handlingDownUpSequence){if(t.type==oi.POINTERDRAG)this.handleDragEvent(t),t.originalEvent.preventDefault();else if(t.type==oi.POINTERUP){const e=this.handleUpEvent(t);this.handlingDownUpSequence=e&&this.targetPointers.length>0}}else if(t.type==oi.POINTERDOWN){const n=this.handleDownEvent(t);this.handlingDownUpSequence=n,e=this.stopDown(n)}else t.type==oi.POINTERMOVE&&this.handleMoveEvent(t);return!e}handleMoveEvent(t){}handleUpEvent(t){return!1}stopDown(t){return t}updateTrackedPointers_(t){t.activePointers&&(this.targetPointers=t.activePointers)}};function Si(t){const e=arguments;return function(t){let n=!0;for(let i=0,o=e.length;i<o&&(n=n&&e[i](t),n);++i);return n}}const Pi=function(t){const e=t.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},Mi=function(t){return!t.map.getTargetElement().hasAttribute("tabindex")||function(t){const e=t.map.getTargetElement(),n=t.map.getOwnerDocument().activeElement;return e.contains(n)}(t)},Ii=a,Li=function(t){const e=t.originalEvent;return 0==e.button&&!(D&&O&&e.ctrlKey)},Fi=function(t){const e=t.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},Ai=function(t){const e=t.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},ki=function(t){const e=t.originalEvent,n=e.target.tagName;return"INPUT"!==n&&"SELECT"!==n&&"TEXTAREA"!==n&&!e.target.isContentEditable},zi=function(t){const e=t.originalEvent;return G(void 0!==e,"mapBrowserEvent must originate from a pointer event"),"mouse"==e.pointerType},Di=function(t){const e=t.originalEvent;return G(void 0!==e,"mapBrowserEvent must originate from a pointer event"),e.isPrimary&&0===e.button},Oi=class extends Ri{constructor(t){super({stopDown:l}),t=t||{},this.kinetic_=t.kinetic,this.lastCentroid=null,this.lastPointersCount_,this.panning_=!1;const e=t.condition?t.condition:Si(Fi,Di);this.condition_=t.onFocusOnly?Si(Mi,e):e,this.noKinetic_=!1}handleDragEvent(t){const e=t.map;this.panning_||(this.panning_=!0,e.getView().beginInteraction());const n=this.targetPointers,i=e.getEventPixel(Ti(n));if(n.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(i[0],i[1]),this.lastCentroid){const e=[this.lastCentroid[0]-i[0],i[1]-this.lastCentroid[1]],n=t.map.getView();o=e,s=n.getResolution(),o[0]*=s,o[1]*=s,we(e,n.getRotation()),n.adjustCenterInternal(e)}}else this.kinetic_&&this.kinetic_.begin();var o,s;this.lastCentroid=i,this.lastPointersCount_=n.length,t.originalEvent.preventDefault()}handleUpEvent(t){const e=t.map,n=e.getView();if(0===this.targetPointers.length){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){const t=this.kinetic_.getDistance(),i=this.kinetic_.getAngle(),o=n.getCenterInternal(),s=e.getPixelFromCoordinateInternal(o),r=e.getCoordinateFromPixelInternal([s[0]-t*Math.cos(i),s[1]-t*Math.sin(i)]);n.animateInternal({center:n.getConstrainedCenter(r),duration:500,easing:nn})}return this.panning_&&(this.panning_=!1,n.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0}handleDownEvent(t){if(this.targetPointers.length>0&&this.condition_(t)){const e=t.map.getView();return this.lastCentroid=null,e.getAnimating()&&e.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1}},Ni=class extends Ri{constructor(t){t=t||{},super({stopDown:l}),this.condition_=t.condition?t.condition:Pi,this.lastAngle_=void 0,this.duration_=void 0!==t.duration?t.duration:250}handleDragEvent(t){if(!zi(t))return;const e=t.map,n=e.getView();if(n.getConstraints().rotation===Je)return;const i=e.getSize(),o=t.pixel,s=Math.atan2(i[1]/2-o[1],o[0]-i[0]/2);if(void 0!==this.lastAngle_){const t=s-this.lastAngle_;n.adjustRotationInternal(-t)}this.lastAngle_=s}handleUpEvent(t){return!zi(t)||(t.map.getView().endInteraction(this.duration_),!1)}handleDownEvent(t){return!!zi(t)&&(!(!Li(t)||!this.condition_(t))&&(t.map.getView().beginInteraction(),this.lastAngle_=void 0,!0))}},ji=class extends i{constructor(t){super(),this.geometry_=null,this.element_=document.createElement("div"),this.element_.style.position="absolute",this.element_.style.pointerEvents="auto",this.element_.className="ol-box "+t,this.map_=null,this.startPixel_=null,this.endPixel_=null}disposeInternal(){this.setMap(null)}render_(){const t=this.startPixel_,e=this.endPixel_,n="px",i=this.element_.style;i.left=Math.min(t[0],e[0])+n,i.top=Math.min(t[1],e[1])+n,i.width=Math.abs(e[0]-t[0])+n,i.height=Math.abs(e[1]-t[1])+n}setMap(t){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);const t=this.element_.style;t.left="inherit",t.top="inherit",t.width="inherit",t.height="inherit"}this.map_=t,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)}setPixels(t,e){this.startPixel_=t,this.endPixel_=e,this.createOrUpdateGeometry(),this.render_()}createOrUpdateGeometry(){const t=this.startPixel_,e=this.endPixel_,n=[t,[t[0],e[1]],e,[e[0],t[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);n[4]=n[0].slice(),this.geometry_?this.geometry_.setCoordinates([n]):this.geometry_=new Ln([n])}getGeometry(){return this.geometry_}};class Zi extends t{constructor(t,e,n){super(t),this.coordinate=e,this.mapBrowserEvent=n}}const Ki=class extends Ri{constructor(t){super(),this.on,this.once,this.un,t=t||{},this.box_=new ji(t.className||"ol-dragbox"),this.minArea_=void 0!==t.minArea?t.minArea:64,t.onBoxEnd&&(this.onBoxEnd=t.onBoxEnd),this.startPixel_=null,this.condition_=t.condition?t.condition:Li,this.boxEndCondition_=t.boxEndCondition?t.boxEndCondition:this.defaultBoxEndCondition}defaultBoxEndCondition(t,e,n){const i=n[0]-e[0],o=n[1]-e[1];return i*i+o*o>=this.minArea_}getGeometry(){return this.box_.getGeometry()}handleDragEvent(t){this.box_.setPixels(this.startPixel_,t.pixel),this.dispatchEvent(new Zi("boxdrag",t.coordinate,t))}handleUpEvent(t){this.box_.setMap(null);const e=this.boxEndCondition_(t,this.startPixel_,t.pixel);return e&&this.onBoxEnd(t),this.dispatchEvent(new Zi(e?"boxend":"boxcancel",t.coordinate,t)),!1}handleDownEvent(t){return!!this.condition_(t)&&(this.startPixel_=t.pixel,this.box_.setMap(t.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new Zi("boxstart",t.coordinate,t)),!0)}onBoxEnd(t){}},Gi=class extends Ki{constructor(t){super({condition:(t=t||{}).condition?t.condition:Ai,className:t.className||"ol-dragzoom",minArea:t.minArea}),this.duration_=void 0!==t.duration?t.duration:200,this.out_=void 0!==t.out&&t.out}onBoxEnd(t){const e=this.getMap().getView();let n=this.getGeometry();if(this.out_){const t=e.rotatedExtentForGeometry(n),i=e.getResolutionForExtentInternal(t),o=e.getResolution()/i;n=n.clone(),n.scale(o*o)}e.fitInternal(n,{duration:this.duration_,easing:nn})}},Ui="ArrowLeft",Xi="ArrowRight",Vi="ArrowDown",qi=class extends bi{constructor(t){super(),t=t||{},this.defaultCondition_=function(t){return Fi(t)&&ki(t)},this.condition_=void 0!==t.condition?t.condition:this.defaultCondition_,this.duration_=void 0!==t.duration?t.duration:100,this.pixelDelta_=void 0!==t.pixelDelta?t.pixelDelta:128}handleEvent(t){let e=!1;if(t.type==m){const n=t.originalEvent,i=n.key;if(this.condition_(t)&&(i==Vi||i==Ui||i==Xi||"ArrowUp"==i)){const o=t.map.getView(),s=o.getResolution()*this.pixelDelta_;let r=0,a=0;i==Vi?a=-s:i==Ui?r=-s:i==Xi?r=s:a=s;const l=[r,a];we(l,o.getRotation()),function(t,e,n){const i=t.getCenterInternal();if(i){const o=[i[0]+e[0],i[1]+e[1]];t.animateInternal({duration:void 0!==n?n:250,easing:sn,center:t.getConstrainedCenter(o)})}}(o,l,this.duration_),n.preventDefault(),e=!0}}return!e}},Wi=class extends bi{constructor(t){super(),t=t||{},this.condition_=t.condition?t.condition:function(t){return!function(t){const e=t.originalEvent;return O?e.metaKey:e.ctrlKey}(t)&&ki(t)},this.delta_=t.delta?t.delta:1,this.duration_=void 0!==t.duration?t.duration:100}handleEvent(t){let e=!1;if(t.type==m||t.type==_){const n=t.originalEvent,i=n.key;if(this.condition_(t)&&("+"===i||"-"===i)){const o=t.map,s="+"===i?this.delta_:-this.delta_;wi(o.getView(),s,void 0,this.duration_),n.preventDefault(),e=!0}}return!e}},Yi=class{constructor(t,e,n){this.decay_=t,this.minVelocity_=e,this.delay_=n,this.points_=[],this.angle_=0,this.initialVelocity_=0}begin(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0}update(t,e){this.points_.push(t,e,Date.now())}end(){if(this.points_.length<6)return!1;const t=Date.now()-this.delay_,e=this.points_.length-3;if(this.points_[e+2]<t)return!1;let n=e-3;for(;n>0&&this.points_[n+2]>t;)n-=3;const i=this.points_[e+2]-this.points_[n+2];if(i<1e3/60)return!1;const o=this.points_[e]-this.points_[n],s=this.points_[e+1]-this.points_[n+1];return this.angle_=Math.atan2(s,o),this.initialVelocity_=Math.sqrt(o*o+s*s)/i,this.initialVelocity_>this.minVelocity_}getDistance(){return(this.minVelocity_-this.initialVelocity_)/this.decay_}getAngle(){return this.angle_}},Bi=class extends bi{constructor(t){super(t=t||{}),this.totalDelta_=0,this.lastDelta_=0,this.maxDelta_=void 0!==t.maxDelta?t.maxDelta:1,this.duration_=void 0!==t.duration?t.duration:250,this.timeout_=void 0!==t.timeout?t.timeout:80,this.useAnchor_=void 0===t.useAnchor||t.useAnchor,this.constrainResolution_=void 0!==t.constrainResolution&&t.constrainResolution;const e=t.condition?t.condition:Ii;this.condition_=t.onFocusOnly?Si(Mi,e):e,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_,this.mode_=void 0,this.trackpadEventGap_=400,this.trackpadTimeoutId_,this.deltaPerZoom_=300}endInteraction_(){this.trackpadTimeoutId_=void 0;const t=this.getMap();t&&t.getView().endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_)}handleEvent(t){if(!this.condition_(t))return!0;if(t.type!==v)return!0;const e=t.map,n=t.originalEvent;let i;if(n.preventDefault(),this.useAnchor_&&(this.lastAnchor_=t.coordinate),t.type==v&&(i=n.deltaY,z&&n.deltaMode===WheelEvent.DOM_DELTA_PIXEL&&(i/=N),n.deltaMode===WheelEvent.DOM_DELTA_LINE&&(i*=40)),0===i)return!1;this.lastDelta_=i;const o=Date.now();void 0===this.startTime_&&(this.startTime_=o),(!this.mode_||o-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(i)<4?"trackpad":"wheel");const s=e.getView();if("trackpad"===this.mode_&&!s.getConstrainResolution()&&!this.constrainResolution_)return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(s.getAnimating()&&s.cancelAnimations(),s.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),s.adjustZoom(-i/this.deltaPerZoom_,this.lastAnchor_),this.startTime_=o,!1;this.totalDelta_+=i;const r=Math.max(this.timeout_-(o-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,e),r),!1}handleWheelZoom_(t){const e=t.getView();e.getAnimating()&&e.cancelAnimations();let n=-Mt(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(e.getConstrainResolution()||this.constrainResolution_)&&(n=n?n>0?1:-1:0),wi(e,n,this.lastAnchor_,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0}setMouseAnchor(t){this.useAnchor_=t,t||(this.lastAnchor_=null)}},Hi=class extends Ri{constructor(t){const e=t=t||{};e.stopDown||(e.stopDown=l),super(e),this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.threshold_=void 0!==t.threshold?t.threshold:.3,this.duration_=void 0!==t.duration?t.duration:250}handleDragEvent(t){let e=0;const n=this.targetPointers[0],i=this.targetPointers[1],o=Math.atan2(i.clientY-n.clientY,i.clientX-n.clientX);if(void 0!==this.lastAngle_){const t=o-this.lastAngle_;this.rotationDelta_+=t,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),e=t}this.lastAngle_=o;const s=t.map,r=s.getView();r.getConstraints().rotation!==Je&&(this.anchor_=s.getCoordinateFromPixelInternal(s.getEventPixel(Ti(this.targetPointers))),this.rotating_&&(s.render(),r.adjustRotationInternal(e,this.anchor_)))}handleUpEvent(t){return!(this.targetPointers.length<2)||(t.map.getView().endInteraction(this.duration_),!1)}handleDownEvent(t){if(this.targetPointers.length>=2){const e=t.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||e.getView().beginInteraction(),!0}return!1}},Qi=class extends Ri{constructor(t){const e=t=t||{};e.stopDown||(e.stopDown=l),super(e),this.anchor_=null,this.duration_=void 0!==t.duration?t.duration:400,this.lastDistance_=void 0,this.lastScaleDelta_=1}handleDragEvent(t){let e=1;const n=this.targetPointers[0],i=this.targetPointers[1],o=n.clientX-i.clientX,s=n.clientY-i.clientY,r=Math.sqrt(o*o+s*s);void 0!==this.lastDistance_&&(e=this.lastDistance_/r),this.lastDistance_=r;const a=t.map,l=a.getView();1!=e&&(this.lastScaleDelta_=e),this.anchor_=a.getCoordinateFromPixelInternal(a.getEventPixel(Ti(this.targetPointers))),a.render(),l.adjustResolutionInternal(e,this.anchor_)}handleUpEvent(t){if(this.targetPointers.length<2){const e=t.map.getView(),n=this.lastScaleDelta_>1?1:-1;return e.endInteraction(this.duration_,n),!1}return!0}handleDownEvent(t){if(this.targetPointers.length>=2){const e=t.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||e.getView().beginInteraction(),!0}return!1}};function $i(t){return t[0]>0&&t[1]>0}function Ji(t,e){return Array.isArray(t)?t:(void 0===e?e=[t,t]:(e[0]=t,e[1]=t),e)}function to(t){t instanceof Nn?t.setMapInternal(null):t instanceof ei&&t.getLayers().forEach(to)}function eo(t,e){if(t instanceof Nn)t.setMapInternal(e);else if(t instanceof ei){const n=t.getLayers().getArray();for(let t=0,i=n.length;t<i;++t)eo(n[t],e)}}const no=class extends P{constructor(t){super(),t=t||{},this.on,this.once,this.un;const e=function(t){let e=null;void 0!==t.keyboardEventTarget&&(e="string"==typeof t.keyboardEventTarget?document.getElementById(t.keyboardEventTarget):t.keyboardEventTarget);const n={},i=t.layers&&"function"==typeof t.layers.getLayers?t.layers:new ei({layers:t.layers});let o,s,r;return n[ci]=i,n[di]=t.target,n[gi]=t.view instanceof Dn?t.view:new Dn,void 0!==t.controls&&(Array.isArray(t.controls)?o=new A(t.controls.slice()):(G("function"==typeof t.controls.getArray,"Expected `controls` to be an array or an `ol/Collection.js`"),o=t.controls)),void 0!==t.interactions&&(Array.isArray(t.interactions)?s=new A(t.interactions.slice()):(G("function"==typeof t.interactions.getArray,"Expected `interactions` to be an array or an `ol/Collection.js`"),s=t.interactions)),void 0!==t.overlays?Array.isArray(t.overlays)?r=new A(t.overlays.slice()):(G("function"==typeof t.overlays.getArray,"Expected `overlays` to be an array or an `ol/Collection.js`"),r=t.overlays):r=new A,{controls:o,interactions:s,keyboardEventTarget:e,overlays:r,values:n}}(t);this.renderComplete_,this.loaded_=!0,this.boundHandleBrowserEvent_=this.handleBrowserEvent.bind(this),this.maxTilesLoading_=void 0!==t.maxTilesLoading?t.maxTilesLoading:16,this.pixelRatio_=void 0!==t.pixelRatio?t.pixelRatio:N,this.postRenderTimeoutHandle_,this.animationDelayKey_,this.animationDelay_=this.animationDelay_.bind(this),this.coordinateToPixelTransform_=[1,0,0,1,0,0],this.pixelToCoordinateTransform_=[1,0,0,1,0,0],this.frameIndex_=0,this.frameState_=null,this.previousExtent_=null,this.viewPropertyListenerKey_=null,this.viewChangeListenerKey_=null,this.layerGroupPropertyListenerKeys_=null,this.viewport_=document.createElement("div"),this.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),this.viewport_.style.position="relative",this.viewport_.style.overflow="hidden",this.viewport_.style.width="100%",this.viewport_.style.height="100%",this.overlayContainer_=document.createElement("div"),this.overlayContainer_.style.position="absolute",this.overlayContainer_.style.zIndex="0",this.overlayContainer_.style.width="100%",this.overlayContainer_.style.height="100%",this.overlayContainer_.style.pointerEvents="none",this.overlayContainer_.className="ol-overlaycontainer",this.viewport_.appendChild(this.overlayContainer_),this.overlayContainerStopEvent_=document.createElement("div"),this.overlayContainerStopEvent_.style.position="absolute",this.overlayContainerStopEvent_.style.zIndex="0",this.overlayContainerStopEvent_.style.width="100%",this.overlayContainerStopEvent_.style.height="100%",this.overlayContainerStopEvent_.style.pointerEvents="none",this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",this.viewport_.appendChild(this.overlayContainerStopEvent_),this.mapBrowserEventHandler_=null,this.moveTolerance_=t.moveTolerance,this.keyboardEventTarget_=e.keyboardEventTarget,this.targetChangeHandlerKeys_=null,this.targetElement_=null,this.resizeObserver_=new ResizeObserver((()=>this.updateSize())),this.controls=e.controls||function(t){t=t||{};const e=new A;return(void 0===t.zoom||t.zoom)&&e.push(new xi(t.zoomOptions)),(void 0===t.rotate||t.rotate)&&e.push(new yi(t.rotateOptions)),(void 0===t.attribution||t.attribution)&&e.push(new vi(t.attributionOptions)),e}(),this.interactions=e.interactions||function(t){t=t||{};const e=new A,n=new Yi(-.005,.05,100);return(void 0===t.altShiftDragRotate||t.altShiftDragRotate)&&e.push(new Ni),(void 0===t.doubleClickZoom||t.doubleClickZoom)&&e.push(new Ei({delta:t.zoomDelta,duration:t.zoomDuration})),(void 0===t.dragPan||t.dragPan)&&e.push(new Oi({onFocusOnly:t.onFocusOnly,kinetic:n})),(void 0===t.pinchRotate||t.pinchRotate)&&e.push(new Hi),(void 0===t.pinchZoom||t.pinchZoom)&&e.push(new Qi({duration:t.zoomDuration})),(void 0===t.keyboard||t.keyboard)&&(e.push(new qi),e.push(new Wi({delta:t.zoomDelta,duration:t.zoomDuration}))),(void 0===t.mouseWheelZoom||t.mouseWheelZoom)&&e.push(new Bi({onFocusOnly:t.onFocusOnly,duration:t.zoomDuration})),(void 0===t.shiftDragZoom||t.shiftDragZoom)&&e.push(new Gi({duration:t.zoomDuration})),e}({onFocusOnly:!0}),this.overlays_=e.overlays,this.overlayIdIndex_={},this.renderer_=null,this.postRenderFunctions_=[],this.tileQueue_=new _i(this.getTilePriority.bind(this),this.handleTileChange_.bind(this)),this.addChangeListener(ci,this.handleLayerGroupChanged_),this.addChangeListener(gi,this.handleViewChanged_),this.addChangeListener(ui,this.handleSizeChanged_),this.addChangeListener(di,this.handleTargetChanged_),this.setProperties(e.values);const n=this;!t.view||t.view instanceof Dn||t.view.then((function(t){n.setView(new Dn(t))})),this.controls.addEventListener(M,(t=>{t.element.setMap(this)})),this.controls.addEventListener(I,(t=>{t.element.setMap(null)})),this.interactions.addEventListener(M,(t=>{t.element.setMap(this)})),this.interactions.addEventListener(I,(t=>{t.element.setMap(null)})),this.overlays_.addEventListener(M,(t=>{this.addOverlayInternal_(t.element)})),this.overlays_.addEventListener(I,(t=>{const e=t.element.getId();void 0!==e&&delete this.overlayIdIndex_[e.toString()],t.element.setMap(null)})),this.controls.forEach((t=>{t.setMap(this)})),this.interactions.forEach((t=>{t.setMap(this)})),this.overlays_.forEach(this.addOverlayInternal_.bind(this))}addControl(t){this.getControls().push(t)}addInteraction(t){this.getInteractions().push(t)}addLayer(t){this.getLayerGroup().getLayers().push(t)}handleLayerAdd_(t){eo(t.layer,this)}addOverlay(t){this.getOverlays().push(t)}addOverlayInternal_(t){const e=t.getId();void 0!==e&&(this.overlayIdIndex_[e.toString()]=t),t.setMap(this)}disposeInternal(){this.controls.clear(),this.interactions.clear(),this.overlays_.clear(),this.resizeObserver_.disconnect(),this.setTarget(null),super.disposeInternal()}forEachFeatureAtPixel(t,e,n){if(!this.frameState_||!this.renderer_)return;const i=this.getCoordinateFromPixelInternal(t),o=void 0!==(n=void 0!==n?n:{}).hitTolerance?n.hitTolerance:0,s=void 0!==n.layerFilter?n.layerFilter:a,r=!1!==n.checkWrapped;return this.renderer_.forEachFeatureAtCoordinate(i,this.frameState_,o,r,e,null,s,null)}getFeaturesAtPixel(t,e){const n=[];return this.forEachFeatureAtPixel(t,(function(t){n.push(t)}),e),n}getAllLayers(){const t=[];return function e(n){n.forEach((function(n){n instanceof ei?e(n.getLayers()):t.push(n)}))}(this.getLayers()),t}hasFeatureAtPixel(t,e){if(!this.frameState_||!this.renderer_)return!1;const n=this.getCoordinateFromPixelInternal(t),i=void 0!==(e=void 0!==e?e:{}).layerFilter?e.layerFilter:a,o=void 0!==e.hitTolerance?e.hitTolerance:0,s=!1!==e.checkWrapped;return this.renderer_.hasFeatureAtCoordinate(n,this.frameState_,o,s,i,null)}getEventCoordinate(t){return this.getCoordinateFromPixel(this.getEventPixel(t))}getEventCoordinateInternal(t){return this.getCoordinateFromPixelInternal(this.getEventPixel(t))}getEventPixel(t){const e=this.viewport_.getBoundingClientRect(),n=this.getSize(),i=e.width/n[0],o=e.height/n[1],s="changedTouches"in t?t.changedTouches[0]:t;return[(s.clientX-e.left)/i,(s.clientY-e.top)/o]}getTarget(){return this.get(di)}getTargetElement(){return this.targetElement_}getCoordinateFromPixel(t){return Ge(this.getCoordinateFromPixelInternal(t),this.getView().getProjection())}getCoordinateFromPixelInternal(t){const e=this.frameState_;return e?U(e.pixelToCoordinateTransform,t.slice()):null}getControls(){return this.controls}getOverlays(){return this.overlays_}getOverlayById(t){const e=this.overlayIdIndex_[t.toString()];return void 0!==e?e:null}getInteractions(){return this.interactions}getLayerGroup(){return this.get(ci)}setLayers(t){const e=this.getLayerGroup();if(t instanceof A)return void e.setLayers(t);const n=e.getLayers();n.clear(),n.extend(t)}getLayers(){return this.getLayerGroup().getLayers()}getLoadingOrNotReady(){const t=this.getLayerGroup().getLayerStatesArray();for(let e=0,n=t.length;e<n;++e){const n=t[e];if(!n.visible)continue;const i=n.layer.getRenderer();if(i&&!i.ready)return!0;const o=n.layer.getSource();if(o&&o.loading)return!0}return!1}getPixelFromCoordinate(t){const e=Ue(t,this.getView().getProjection());return this.getPixelFromCoordinateInternal(e)}getPixelFromCoordinateInternal(t){const e=this.frameState_;return e?U(e.coordinateToPixelTransform,t.slice(0,2)):null}getRenderer(){return this.renderer_}getSize(){return this.get(ui)}getView(){return this.get(gi)}getViewport(){return this.viewport_}getOverlayContainer(){return this.overlayContainer_}getOverlayContainerStopEvent(){return this.overlayContainerStopEvent_}getOwnerDocument(){const t=this.getTargetElement();return t?t.ownerDocument:document}getTilePriority(t,e,n,i){return function(t,e,n,i,o){if(!t||!(n in t.wantedTiles))return pi;if(!t.wantedTiles[n][e.getKey()])return pi;const s=t.viewState.center,r=i[0]-s[0],a=i[1]-s[1];return 65536*Math.log(o)+Math.sqrt(r*r+a*a)/o}(this.frameState_,t,e,n,i)}handleBrowserEvent(t,e){e=e||t.type;const n=new ii(e,this,t);this.handleMapBrowserEvent(n)}handleMapBrowserEvent(t){if(!this.frameState_)return;const e=t.originalEvent,n=e.type;if(n===si||n===v||n===m){const t=this.getOwnerDocument(),n=this.viewport_.getRootNode?this.viewport_.getRootNode():t,i=e.target;if(this.overlayContainerStopEvent_.contains(i)||!(n===t?t.documentElement:n).contains(i))return}if(t.frameState=this.frameState_,!1!==this.dispatchEvent(t)){const e=this.getInteractions().getArray().slice();for(let n=e.length-1;n>=0;n--){const i=e[n];if(i.getMap()===this&&i.getActive()&&this.getTargetElement()&&(!i.handleEvent(t)||t.propagationStopped))break}}}handlePostRender(){const t=this.frameState_,e=this.tileQueue_;if(!e.isEmpty()){let n=this.maxTilesLoading_,i=n;if(t){const e=t.viewHints;if(e[0]||e[1]){const e=Date.now()-t.time>8;n=e?0:8,i=e?0:2}}e.getTilesLoading()<n&&(e.reprioritize(),e.loadMoreTiles(n,i))}t&&this.renderer_&&!t.animate&&(!0===this.renderComplete_?(this.hasListener(ee)&&this.renderer_.dispatchRenderEvent(ee,t),!1===this.loaded_&&(this.loaded_=!0,this.dispatchEvent(new ni(hi,this,t)))):!0===this.loaded_&&(this.loaded_=!1,this.dispatchEvent(new ni(li,this,t))));const n=this.postRenderFunctions_;for(let e=0,i=n.length;e<i;++e)n[e](this,t);n.length=0}handleSizeChanged_(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()}handleTargetChanged_(){if(this.mapBrowserEventHandler_){for(let t=0,e=this.targetChangeHandlerKeys_.length;t<e;++t)C(this.targetChangeHandlerKeys_[t]);this.targetChangeHandlerKeys_=null,this.viewport_.removeEventListener(g,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(v,this.boundHandleBrowserEvent_),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,Bn(this.viewport_)}if(this.targetElement_){this.resizeObserver_.unobserve(this.targetElement_);const t=this.targetElement_.getRootNode();t instanceof ShadowRoot&&this.resizeObserver_.unobserve(t.host),this.setSize(void 0)}const t=this.getTarget(),e="string"==typeof t?document.getElementById(t):t;if(this.targetElement_=e,e){e.appendChild(this.viewport_),this.renderer_||(this.renderer_=new Qn(this)),this.mapBrowserEventHandler_=new ri(this,this.moveTolerance_);for(const t in oi)this.mapBrowserEventHandler_.addEventListener(oi[t],this.handleMapBrowserEvent.bind(this));this.viewport_.addEventListener(g,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(v,this.boundHandleBrowserEvent_,!!K&&{passive:!1});const t=this.keyboardEventTarget_?this.keyboardEventTarget_:e;this.targetChangeHandlerKeys_=[y(t,m,this.handleBrowserEvent,this),y(t,_,this.handleBrowserEvent,this)];const n=e.getRootNode();n instanceof ShadowRoot&&this.resizeObserver_.observe(n.host),this.resizeObserver_.observe(e)}else this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);this.updateSize()}handleTileChange_(){this.render()}handleViewPropertyChanged_(){this.render()}handleViewChanged_(){this.viewPropertyListenerKey_&&(C(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(C(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);const t=this.getView();t&&(this.updateViewportSize_(this.getSize()),this.viewPropertyListenerKey_=y(t,e,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=y(t,d,this.handleViewPropertyChanged_,this),t.resolveConstraints(0)),this.render()}handleLayerGroupChanged_(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(C),this.layerGroupPropertyListenerKeys_=null);const t=this.getLayerGroup();t&&(this.handleLayerAdd_(new $n("addlayer",t)),this.layerGroupPropertyListenerKeys_=[y(t,e,this.render,this),y(t,d,this.render,this),y(t,"addlayer",this.handleLayerAdd_,this),y(t,"removelayer",this.handleLayerRemove_,this)]),this.render()}isRendered(){return!!this.frameState_}animationDelay_(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}renderSync(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()}redrawText(){const t=this.getLayerGroup().getLayerStatesArray();for(let e=0,n=t.length;e<n;++e){const n=t[e].layer;n.hasRenderer()&&n.getRenderer().handleFontsChanged()}}render(){this.renderer_&&void 0===this.animationDelayKey_&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))}flushDeclutterItems(){const t=this.frameState_;t&&this.renderer_.flushDeclutterItems(t)}removeControl(t){return this.getControls().remove(t)}removeInteraction(t){return this.getInteractions().remove(t)}removeLayer(t){return this.getLayerGroup().getLayers().remove(t)}handleLayerRemove_(t){to(t.layer)}removeOverlay(t){return this.getOverlays().remove(t)}renderFrame_(t){const e=this.getSize(),n=this.getView(),i=this.frameState_;let o=null;if(void 0!==e&&$i(e)&&n&&n.isDef()){const i=n.getHints(this.frameState_?this.frameState_.viewHints:void 0),s=n.getState();if(o={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutterTree:null,extent:ut(s.center,s.resolution,s.rotation,e),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:e,tileQueue:this.tileQueue_,time:t,usedTiles:{},viewState:s,viewHints:i,wantedTiles:{},mapId:R(this),renderTargets:{}},s.nextCenter&&s.nextResolution){const t=isNaN(s.nextRotation)?s.rotation:s.nextRotation;o.nextExtent=ut(s.nextCenter,s.nextResolution,t,e)}}var s,r;this.frameState_=o,this.renderer_.renderFrame(o),o&&(o.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,o.postRenderFunctions),i&&(!this.previousExtent_||!yt(this.previousExtent_)&&!et(o.extent,this.previousExtent_))&&(this.dispatchEvent(new ni("movestart",this,i)),this.previousExtent_=tt(this.previousExtent_)),this.previousExtent_&&!o.viewHints[0]&&!o.viewHints[1]&&!et(o.extent,this.previousExtent_)&&(this.dispatchEvent(new ni("moveend",this,o)),s=o.extent,(r=this.previousExtent_)?(r[0]=s[0],r[1]=s[1],r[2]=s[2],r[3]=s[3]):s.slice())),this.dispatchEvent(new ni(ai,this,o)),this.renderComplete_=this.hasListener(li)||this.hasListener(hi)||this.hasListener(ee)?!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoadingOrNotReady():void 0,this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout((()=>{this.postRenderTimeoutHandle_=void 0,this.handlePostRender()}),0))}setLayerGroup(t){const e=this.getLayerGroup();e&&this.handleLayerRemove_(new $n("removelayer",e)),this.set(ci,t)}setSize(t){this.set(ui,t)}setTarget(t){this.set(di,t)}setView(t){if(!t||t instanceof Dn)return void this.set(gi,t);this.set(gi,new Dn);const e=this;t.then((function(t){e.setView(new Dn(t))}))}updateSize(){const t=this.getTargetElement();let e;if(t){const n=getComputedStyle(t),i=t.offsetWidth-parseFloat(n.borderLeftWidth)-parseFloat(n.paddingLeft)-parseFloat(n.paddingRight)-parseFloat(n.borderRightWidth),o=t.offsetHeight-parseFloat(n.borderTopWidth)-parseFloat(n.paddingTop)-parseFloat(n.paddingBottom)-parseFloat(n.borderBottomWidth);isNaN(i)||isNaN(o)||(e=[i,o],!$i(e)&&(t.offsetWidth||t.offsetHeight||t.getClientRects().length)&&Se("No map visible because the map container's width or height are 0."))}const n=this.getSize();!e||n&&r(e,n)||(this.setSize(e),this.updateViewportSize_(e))}updateViewportSize_(t){const e=this.getView();e&&e.setViewportSize(t)}},io=class extends u{constructor(t,e,n){super(),n=n||{},this.tileCoord=t,this.state=e,this.interimTile=null,this.key="",this.transition_=void 0===n.transition?250:n.transition,this.transitionStarts_={},this.interpolate=!!n.interpolate}changed(){this.dispatchEvent(d)}release(){3===this.state&&this.setState(4)}getKey(){return this.key+"/"+this.tileCoord}getInterimTile(){let t=this.interimTile;if(!t)return this;do{if(2==t.getState())return this.transition_=0,t;t=t.interimTile}while(t);return this}refreshInterimChain(){let t=this.interimTile;if(!t)return;let e=this;do{if(2==t.getState()){t.interimTile=null;break}1==t.getState()?e=t:0==t.getState()?e.interimTile=t.interimTile:e=t,t=e.interimTile}while(t)}getTileCoord(){return this.tileCoord}getState(){return this.state}setState(t){if(3!==this.state&&this.state>t)throw new Error("Tile load sequence violation");this.state=t,this.changed()}load(){E()}getAlpha(t,e){if(!this.transition_)return 1;let n=this.transitionStarts_[t];if(n){if(-1===n)return 1}else n=e,this.transitionStarts_[t]=n;const i=e-n+1e3/60;return i>=this.transition_?1:en(i/this.transition_)}inTransition(t){return!!this.transition_&&-1!==this.transitionStarts_[t]}endTransition(t){this.transition_&&(this.transitionStarts_[t]=-1)}},oo=class extends io{constructor(t,e,n,i,o,s){super(t,e,s),this.crossOrigin_=i,this.src_=n,this.key=n,this.image_=new Image,null!==i&&(this.image_.crossOrigin=i),this.unlisten_=null,this.tileLoadFunction_=o}getImage(){return this.image_}setImage(t){this.image_=t,this.state=2,this.unlistenImage_(),this.changed()}handleImageError_(){this.state=3,this.unlistenImage_(),this.image_=function(){const t=qn(1,1);return t.fillStyle="rgba(0,0,0,0)",t.fillRect(0,0,1,1),t.canvas}(),this.changed()}handleImageLoad_(){const t=this.image_;t.naturalWidth&&t.naturalHeight?this.state=2:this.state=4,this.unlistenImage_(),this.changed()}load(){3==this.state&&(this.state=0,this.image_=new Image,null!==this.crossOrigin_&&(this.image_.crossOrigin=this.crossOrigin_)),0==this.state&&(this.state=1,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=function(t,e,n){const i=t;let o=!0,s=!1,r=!1;const a=[x(i,"load",(function(){r=!0,s||e()}))];return i.src&&Z?(s=!0,i.decode().then((function(){o&&e()})).catch((function(t){o&&(r?e():n())}))):a.push(x(i,"error",n)),function(){o=!1,a.forEach(C)}}(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}},so=class{constructor(t,e,n,i,o,s){this.sourceProj_=t,this.targetProj_=e;let r={};const a=Ne(this.targetProj_,this.sourceProj_);this.transformInv_=function(t){const e=t[0]+"/"+t[1];return r[e]||(r[e]=a(t)),r[e]},this.maxSourceExtent_=i,this.errorThresholdSquared_=o*o,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!i&&!!this.sourceProj_.getExtent()&&ft(i)>=ft(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?ft(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?ft(this.targetProj_.getExtent()):null;const l=mt(n),h=_t(n),c=lt(n),u=at(n),d=this.transformInv_(l),g=this.transformInv_(h),p=this.transformInv_(c),m=this.transformInv_(u),_=10+(s?Math.max(0,Math.ceil(Math.log2(rt(n)/(s*s*256*256)))):0);if(this.addQuad_(l,h,c,u,d,g,p,m,_),this.wrapsXInSource_){let t=1/0;this.triangles_.forEach((function(e,n,i){t=Math.min(t,e.source[0][0],e.source[1][0],e.source[2][0])})),this.triangles_.forEach((e=>{if(Math.max(e.source[0][0],e.source[1][0],e.source[2][0])-t>this.sourceWorldWidth_/2){const n=[[e.source[0][0],e.source[0][1]],[e.source[1][0],e.source[1][1]],[e.source[2][0],e.source[2][1]]];n[0][0]-t>this.sourceWorldWidth_/2&&(n[0][0]-=this.sourceWorldWidth_),n[1][0]-t>this.sourceWorldWidth_/2&&(n[1][0]-=this.sourceWorldWidth_),n[2][0]-t>this.sourceWorldWidth_/2&&(n[2][0]-=this.sourceWorldWidth_);const i=Math.min(n[0][0],n[1][0],n[2][0]);Math.max(n[0][0],n[1][0],n[2][0])-i<this.sourceWorldWidth_/2&&(e.source=n)}}))}r={}}addTriangle_(t,e,n,i,o,s){this.triangles_.push({source:[i,o,s],target:[t,e,n]})}addQuad_(t,e,n,i,o,s,r,a,l){const h=Y([o,s,r,a]),c=this.sourceWorldWidth_?ft(h)/this.sourceWorldWidth_:null,u=this.sourceWorldWidth_,d=this.sourceProj_.canWrapX()&&c>.5&&c<1;let g=!1;if(l>0&&(this.targetProj_.isGlobal()&&this.targetWorldWidth_&&(g=ft(Y([t,e,n,i]))/this.targetWorldWidth_>.25||g),!d&&this.sourceProj_.isGlobal()&&c&&(g=c>.25||g)),!g&&this.maxSourceExtent_&&isFinite(h[0])&&isFinite(h[1])&&isFinite(h[2])&&isFinite(h[3])&&!vt(h,this.maxSourceExtent_))return;let p=0;if(!(g||isFinite(o[0])&&isFinite(o[1])&&isFinite(s[0])&&isFinite(s[1])&&isFinite(r[0])&&isFinite(r[1])&&isFinite(a[0])&&isFinite(a[1])))if(l>0)g=!0;else if(p=(isFinite(o[0])&&isFinite(o[1])?0:8)+(isFinite(s[0])&&isFinite(s[1])?0:4)+(isFinite(r[0])&&isFinite(r[1])?0:2)+(isFinite(a[0])&&isFinite(a[1])?0:1),1!=p&&2!=p&&4!=p&&8!=p)return;if(l>0){if(!g){const e=[(t[0]+n[0])/2,(t[1]+n[1])/2],i=this.transformInv_(e);let s;s=d?(At(o[0],u)+At(r[0],u))/2-At(i[0],u):(o[0]+r[0])/2-i[0];const a=(o[1]+r[1])/2-i[1];g=s*s+a*a>this.errorThresholdSquared_}if(g){if(Math.abs(t[0]-n[0])<=Math.abs(t[1]-n[1])){const h=[(e[0]+n[0])/2,(e[1]+n[1])/2],c=this.transformInv_(h),u=[(i[0]+t[0])/2,(i[1]+t[1])/2],d=this.transformInv_(u);this.addQuad_(t,e,h,u,o,s,c,d,l-1),this.addQuad_(u,h,n,i,d,c,r,a,l-1)}else{const h=[(t[0]+e[0])/2,(t[1]+e[1])/2],c=this.transformInv_(h),u=[(n[0]+i[0])/2,(n[1]+i[1])/2],d=this.transformInv_(u);this.addQuad_(t,h,u,i,o,c,d,a,l-1),this.addQuad_(h,e,n,u,c,s,r,d,l-1)}return}}if(d){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}0==(11&p)&&this.addTriangle_(t,n,i,o,r,a),0==(14&p)&&this.addTriangle_(t,n,e,o,r,s),p&&(0==(13&p)&&this.addTriangle_(e,i,t,s,a,o),0==(7&p)&&this.addTriangle_(e,i,n,s,a,r))}calculateSourceExtent(){const t=[1/0,1/0,-1/0,-1/0];return this.triangles_.forEach((function(e,n,i){const o=e.source;nt(t,o[0]),nt(t,o[1]),nt(t,o[2])})),t}getTriangles(){return this.triangles_}};let ro;const ao=[];function lo(t,e,n,i,o){t.beginPath(),t.moveTo(0,0),t.lineTo(e,n),t.lineTo(i,o),t.closePath(),t.save(),t.clip(),t.fillRect(0,0,Math.max(e,i)+1,Math.max(n,o)),t.restore()}function ho(t,e){return Math.abs(t[4*e]-210)>2||Math.abs(t[4*e+3]-191.25)>2}function co(t,e,n,i){const o=je(n,e,t);let s=Ae(e,i,n);const r=e.getMetersPerUnit();void 0!==r&&(s*=r);const a=t.getMetersPerUnit();void 0!==a&&(s/=a);const l=t.getExtent();if(!l||H(l,o)){const e=Ae(t,s,o)/s;isFinite(e)&&e>0&&(s/=e)}return s}const uo=class extends io{constructor(t,e,n,i,o,s,r,a,l,h,c,u){super(o,0,u),this.renderEdges_=void 0!==c&&c,this.pixelRatio_=r,this.gutter_=a,this.canvas_=null,this.sourceTileGrid_=e,this.targetTileGrid_=i,this.wrappedTileCoord_=s||o,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0;const d=i.getTileCoordExtent(this.wrappedTileCoord_),g=this.targetTileGrid_.getExtent();let p=this.sourceTileGrid_.getExtent();const m=g?pt(d,g):d;if(0===rt(m))return void(this.state=4);const _=t.getExtent();_&&(p=p?pt(p,_):_);const f=i.getResolution(this.wrappedTileCoord_[0]),v=function(t,e,n,i){const o=ht(n);let s=co(t,e,o,i);return(!isFinite(s)||s<=0)&&st(n,(function(n){return s=co(t,e,n,i),isFinite(s)&&s>0})),s}(t,n,m,f);if(!isFinite(v)||v<=0)return void(this.state=4);const y=void 0!==h?h:.5;if(this.triangulation_=new so(t,n,m,p,v*y,f),0===this.triangulation_.getTriangles().length)return void(this.state=4);this.sourceZ_=e.getZForResolution(v);let x=this.triangulation_.calculateSourceExtent();if(p&&(t.canWrapX()?(x[1]=Mt(x[1],p[1],p[3]),x[3]=Mt(x[3],p[1],p[3])):x=pt(x,p)),rt(x)){const t=e.getTileRangeForExtentAndZ(x,this.sourceZ_);for(let e=t.minX;e<=t.maxX;e++)for(let n=t.minY;n<=t.maxY;n++){const t=l(this.sourceZ_,e,n,r);t&&this.sourceTiles_.push(t)}0===this.sourceTiles_.length&&(this.state=4)}else this.state=4}getImage(){return this.canvas_}reproject_(){const t=[];if(this.sourceTiles_.forEach((e=>{e&&2==e.getState()&&t.push({extent:this.sourceTileGrid_.getTileCoordExtent(e.tileCoord),image:e.getImage()})})),this.sourceTiles_.length=0,0===t.length)this.state=3;else{const e=this.wrappedTileCoord_[0],n=this.targetTileGrid_.getTileSize(e),i="number"==typeof n?n:n[0],o="number"==typeof n?n:n[1],s=this.targetTileGrid_.getResolution(e),r=this.sourceTileGrid_.getResolution(this.sourceZ_),a=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=function(t,e,n,i,o,s,r,a,l,h,c,u,d){const g=qn(Math.round(n*t),Math.round(n*e),ao);if(u||(g.imageSmoothingEnabled=!1),0===l.length)return g.canvas;function p(t){return Math.round(t*n)/n}g.scale(n,n),g.globalCompositeOperation="lighter";const m=[1/0,1/0,-1/0,-1/0];let _;if(l.forEach((function(t,e,n){var i,o;i=m,(o=t.extent)[0]<i[0]&&(i[0]=o[0]),o[2]>i[2]&&(i[2]=o[2]),o[1]<i[1]&&(i[1]=o[1]),o[3]>i[3]&&(i[3]=o[3])})),!d||1!==l.length||0!==h){const t=ft(m),e=gt(m);_=qn(Math.round(n*t/i),Math.round(n*e/i),ao),u||(_.imageSmoothingEnabled=!1);const o=n/i;l.forEach((function(t,e,n){const i=t.extent[0]-m[0],s=-(t.extent[3]-m[3]),r=ft(t.extent),a=gt(t.extent);t.image.width>0&&t.image.height>0&&_.drawImage(t.image,h,h,t.image.width-2*h,t.image.height-2*h,i*o,s*o,r*o,a*o)}))}const f=mt(r);return a.getTriangles().forEach((function(t,e,o){const r=t.source,a=t.target;let h=r[0][0],c=r[0][1],d=r[1][0],v=r[1][1],y=r[2][0],x=r[2][1];const C=p((a[0][0]-f[0])/s),w=p(-(a[0][1]-f[1])/s),b=p((a[1][0]-f[0])/s),E=p(-(a[1][1]-f[1])/s),T=p((a[2][0]-f[0])/s),R=p(-(a[2][1]-f[1])/s),S=h,P=c;h=0,c=0,d-=S,v-=P,y-=S,x-=P;const M=function(t){const e=t.length;for(let n=0;n<e;n++){let i=n,o=Math.abs(t[n][n]);for(let s=n+1;s<e;s++){const e=Math.abs(t[s][n]);e>o&&(o=e,i=s)}if(0===o)return null;const s=t[i];t[i]=t[n],t[n]=s;for(let i=n+1;i<e;i++){const o=-t[i][n]/t[n][n];for(let s=n;s<e+1;s++)n==s?t[i][s]=0:t[i][s]+=o*t[n][s]}}const n=new Array(e);for(let i=e-1;i>=0;i--){n[i]=t[i][e]/t[i][i];for(let o=i-1;o>=0;o--)t[o][e]-=t[o][i]*n[i]}return n}([[d,v,0,0,b-C],[y,x,0,0,T-C],[0,0,d,v,E-w],[0,0,y,x,R-w]]);if(!M)return;if(g.save(),g.beginPath(),function(){if(void 0===ro){const t=qn(6,6,ao);t.globalCompositeOperation="lighter",t.fillStyle="rgba(210, 0, 0, 0.75)",lo(t,4,5,4,0),lo(t,4,5,0,5);const e=t.getImageData(0,0,3,3).data;ro=ho(e,0)||ho(e,4)||ho(e,8),Wn(t),ao.push(t.canvas)}return ro}()||!u){g.moveTo(b,E);const t=4,e=C-b,n=w-E;for(let i=0;i<t;i++)g.lineTo(b+p((i+1)*e/t),E+p(i*n/(t-1))),i!=t-1&&g.lineTo(b+p((i+1)*e/t),E+p((i+1)*n/(t-1)));g.lineTo(T,R)}else g.moveTo(b,E),g.lineTo(C,w),g.lineTo(T,R);let I;if(g.clip(),g.transform(M[0],M[2],M[1],M[3],C,w),g.translate(m[0]-S,m[3]-P),_)I=_.canvas,g.scale(i/n,-i/n);else{const t=l[0],e=t.extent;I=t.image,g.scale(ft(e)/I.width,-gt(e)/I.height)}g.drawImage(I,0,0),g.restore()})),_&&(Wn(_),ao.push(_.canvas)),c&&(g.save(),g.globalCompositeOperation="source-over",g.strokeStyle="black",g.lineWidth=1,a.getTriangles().forEach((function(t,e,n){const i=t.target,o=(i[0][0]-f[0])/s,r=-(i[0][1]-f[1])/s,a=(i[1][0]-f[0])/s,l=-(i[1][1]-f[1])/s,h=(i[2][0]-f[0])/s,c=-(i[2][1]-f[1])/s;g.beginPath(),g.moveTo(a,l),g.lineTo(o,r),g.lineTo(h,c),g.closePath(),g.stroke()})),g.restore()),g.canvas}(i,o,this.pixelRatio_,r,this.sourceTileGrid_.getExtent(),s,a,this.triangulation_,t,this.gutter_,this.renderEdges_,this.interpolate),this.state=2}this.changed()}load(){if(0==this.state){this.state=1,this.changed();let t=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach((e=>{const n=e.getState();if(0==n||1==n){t++;const n=y(e,d,(function(i){const o=e.getState();2!=o&&3!=o&&4!=o||(C(n),t--,0===t&&(this.unlistenSources_(),this.reproject_()))}),this);this.sourcesListenerKeys_.push(n)}})),0===t?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach((function(t,e,n){0==t.getState()&&t.load()}))}}unlistenSources_(){this.sourcesListenerKeys_.forEach(C),this.sourcesListenerKeys_=null}release(){this.canvas_&&(Wn(this.canvas_.getContext("2d")),ao.push(this.canvas_),this.canvas_=null),super.release()}},go=class{constructor(t){this.highWaterMark=void 0!==t?t:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}canExpireCache(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark}expireCache(t){for(;this.canExpireCache();)this.pop()}clear(){this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}containsKey(t){return this.entries_.hasOwnProperty(t)}forEach(t){let e=this.oldest_;for(;e;)t(e.value_,e.key_,this),e=e.newer}get(t,e){const n=this.entries_[t];return G(void 0!==n,"Tried to get a value for a key that does not exist in the cache"),n===this.newest_||(n===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(n.newer.older=n.older,n.older.newer=n.newer),n.newer=null,n.older=this.newest_,this.newest_.newer=n,this.newest_=n),n.value_}remove(t){const e=this.entries_[t];return G(void 0!==e,"Tried to get a value for a key that does not exist in the cache"),e===this.newest_?(this.newest_=e.older,this.newest_&&(this.newest_.newer=null)):e===this.oldest_?(this.oldest_=e.newer,this.oldest_&&(this.oldest_.older=null)):(e.newer.older=e.older,e.older.newer=e.newer),delete this.entries_[t],--this.count_,e.value_}getCount(){return this.count_}getKeys(){const t=new Array(this.count_);let e,n=0;for(e=this.newest_;e;e=e.older)t[n++]=e.key_;return t}getValues(){const t=new Array(this.count_);let e,n=0;for(e=this.newest_;e;e=e.older)t[n++]=e.value_;return t}peekLast(){return this.oldest_.value_}peekLastKey(){return this.oldest_.key_}peekFirstKey(){return this.newest_.key_}peek(t){return this.entries_[t]?.value_}pop(){const t=this.oldest_;return delete this.entries_[t.key_],t.newer&&(t.newer.older=null),this.oldest_=t.newer,this.oldest_||(this.newest_=null),--this.count_,t.value_}replace(t,e){this.get(t),this.entries_[t].value_=e}set(t,e){G(!(t in this.entries_),"Tried to set a value for a key that is used already");const n={key_:t,newer:null,older:this.newest_,value_:e};this.newest_?this.newest_.newer=n:this.oldest_=n,this.newest_=n,this.entries_[t]=n,++this.count_}setSize(t){this.highWaterMark=t}};function po(t,e,n,i){return void 0!==i?(i[0]=t,i[1]=e,i[2]=n,i):[t,e,n]}function mo(t,e,n){return t+"/"+e+"/"+n}function _o(t){return mo(t[0],t[1],t[2])}const fo=class extends go{clear(){for(;this.getCount()>0;)this.pop().release();super.clear()}expireCache(t){for(;this.canExpireCache()&&!(this.peekLast().getKey()in t);)this.pop().release()}pruneExceptNewestZ(){if(0===this.getCount())return;const t=this.peekFirstKey().split("/").map(Number)[0];this.forEach((e=>{e.tileCoord[0]!==t&&(this.remove(_o(e.tileCoord)),e.release())}))}};function vo(t){return t?Array.isArray(t)?function(e){return t}:"function"==typeof t?t:function(e){return[t]}:null}const yo=class extends P{constructor(t){super(),this.projection=Fe(t.projection),this.attributions_=vo(t.attributions),this.attributionsCollapsible_=void 0===t.attributionsCollapsible||t.attributionsCollapsible,this.loading=!1,this.state_=void 0!==t.state?t.state:"ready",this.wrapX_=void 0!==t.wrapX&&t.wrapX,this.interpolate_=!!t.interpolate,this.viewResolver=null,this.viewRejector=null;const e=this;this.viewPromise_=new Promise((function(t,n){e.viewResolver=t,e.viewRejector=n}))}getAttributions(){return this.attributions_}getAttributionsCollapsible(){return this.attributionsCollapsible_}getProjection(){return this.projection}getResolutions(t){return null}getView(){return this.viewPromise_}getState(){return this.state_}getWrapX(){return this.wrapX_}getInterpolate(){return this.interpolate_}refresh(){this.changed()}setAttributions(t){this.attributions_=vo(t),this.changed()}setState(t){this.state_=t,this.changed()}};class xo{constructor(t,e,n,i){this.minX=t,this.maxX=e,this.minY=n,this.maxY=i}contains(t){return this.containsXY(t[1],t[2])}containsTileRange(t){return this.minX<=t.minX&&t.maxX<=this.maxX&&this.minY<=t.minY&&t.maxY<=this.maxY}containsXY(t,e){return this.minX<=t&&t<=this.maxX&&this.minY<=e&&e<=this.maxY}equals(t){return this.minX==t.minX&&this.minY==t.minY&&this.maxX==t.maxX&&this.maxY==t.maxY}extend(t){t.minX<this.minX&&(this.minX=t.minX),t.maxX>this.maxX&&(this.maxX=t.maxX),t.minY<this.minY&&(this.minY=t.minY),t.maxY>this.maxY&&(this.maxY=t.maxY)}getHeight(){return this.maxY-this.minY+1}getSize(){return[this.getWidth(),this.getHeight()]}getWidth(){return this.maxX-this.minX+1}intersects(t){return this.minX<=t.maxX&&this.maxX>=t.minX&&this.minY<=t.maxY&&this.maxY>=t.minY}}function Co(t,e,n,i,o){return void 0!==o?(o.minX=t,o.maxX=e,o.minY=n,o.maxY=i,o):new xo(t,e,n,i)}const wo=xo,bo=[0,0,0],Eo=class{constructor(t){let e;if(this.minZoom=void 0!==t.minZoom?t.minZoom:0,this.resolutions_=t.resolutions,G(function(t,e,n){const i=((t,e)=>e-t)||o;return t.every((function(e,n){if(0===n)return!0;const o=i(t[n-1],e);return!(o>0||0===o)}))}(this.resolutions_),"`resolutions` must be sorted in descending order"),!t.origins)for(let t=0,n=this.resolutions_.length-1;t<n;++t)if(e){if(this.resolutions_[t]/this.resolutions_[t+1]!==e){e=void 0;break}}else e=this.resolutions_[t]/this.resolutions_[t+1];this.zoomFactor_=e,this.maxZoom=this.resolutions_.length-1,this.origin_=void 0!==t.origin?t.origin:null,this.origins_=null,void 0!==t.origins&&(this.origins_=t.origins,G(this.origins_.length==this.resolutions_.length,"Number of `origins` and `resolutions` must be equal"));const n=t.extent;void 0===n||this.origin_||this.origins_||(this.origin_=mt(n)),G(!this.origin_&&this.origins_||this.origin_&&!this.origins_,"Either `origin` or `origins` must be configured, never both"),this.tileSizes_=null,void 0!==t.tileSizes&&(this.tileSizes_=t.tileSizes,G(this.tileSizes_.length==this.resolutions_.length,"Number of `tileSizes` and `resolutions` must be equal")),this.tileSize_=void 0!==t.tileSize?t.tileSize:this.tileSizes_?null:oe,G(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,"Either `tileSize` or `tileSizes` must be configured, never both"),this.extent_=void 0!==n?n:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],void 0!==t.sizes?this.fullTileRanges_=t.sizes.map(((t,e)=>{const i=new wo(Math.min(0,t[0]),Math.max(t[0]-1,-1),Math.min(0,t[1]),Math.max(t[1]-1,-1));if(n){const t=this.getTileRangeForExtentAndZ(n,e);i.minX=Math.max(t.minX,i.minX),i.maxX=Math.min(t.maxX,i.maxX),i.minY=Math.max(t.minY,i.minY),i.maxY=Math.min(t.maxY,i.maxY)}return i})):n&&this.calculateTileRanges_(n)}forEachTileCoord(t,e,n){const i=this.getTileRangeForExtentAndZ(t,e);for(let t=i.minX,o=i.maxX;t<=o;++t)for(let o=i.minY,s=i.maxY;o<=s;++o)n([e,t,o])}forEachTileCoordParentTileRange(t,e,n,i){let o,s,r,a=null,l=t[0]-1;for(2===this.zoomFactor_?(s=t[1],r=t[2]):a=this.getTileCoordExtent(t,i);l>=this.minZoom;){if(void 0!==s&&void 0!==r?(s=Math.floor(s/2),r=Math.floor(r/2),o=Co(s,s,r,r,n)):o=this.getTileRangeForExtentAndZ(a,l,n),e(l,o))return!0;--l}return!1}getExtent(){return this.extent_}getMaxZoom(){return this.maxZoom}getMinZoom(){return this.minZoom}getOrigin(t){return this.origin_?this.origin_:this.origins_[t]}getResolution(t){return this.resolutions_[t]}getResolutions(){return this.resolutions_}getTileCoordChildTileRange(t,e,n){if(t[0]<this.maxZoom){if(2===this.zoomFactor_){const n=2*t[1],i=2*t[2];return Co(n,n+1,i,i+1,e)}const i=this.getTileCoordExtent(t,n||this.tmpExtent_);return this.getTileRangeForExtentAndZ(i,t[0]+1,e)}return null}getTileRangeForTileCoordAndZ(t,e,n){if(e>this.maxZoom||e<this.minZoom)return null;const i=t[0],o=t[1],s=t[2];if(e===i)return Co(o,s,o,s,n);if(this.zoomFactor_){const t=Math.pow(this.zoomFactor_,e-i),r=Math.floor(o*t),a=Math.floor(s*t);return e<i?Co(r,r,a,a,n):Co(r,Math.floor(t*(o+1))-1,a,Math.floor(t*(s+1))-1,n)}const r=this.getTileCoordExtent(t,this.tmpExtent_);return this.getTileRangeForExtentAndZ(r,e,n)}getTileRangeForExtentAndZ(t,e,n){this.getTileCoordForXYAndZ_(t[0],t[3],e,!1,bo);const i=bo[1],o=bo[2];return this.getTileCoordForXYAndZ_(t[2],t[1],e,!0,bo),Co(i,bo[1],o,bo[2],n)}getTileCoordCenter(t){const e=this.getOrigin(t[0]),n=this.getResolution(t[0]),i=Ji(this.getTileSize(t[0]),this.tmpSize_);return[e[0]+(t[1]+.5)*i[0]*n,e[1]-(t[2]+.5)*i[1]*n]}getTileCoordExtent(t,e){const n=this.getOrigin(t[0]),i=this.getResolution(t[0]),o=Ji(this.getTileSize(t[0]),this.tmpSize_),s=n[0]+t[1]*o[0]*i,r=n[1]-(t[2]+1)*o[1]*i;return J(s,r,s+o[0]*i,r+o[1]*i,e)}getTileCoordForCoordAndResolution(t,e,n){return this.getTileCoordForXYAndResolution_(t[0],t[1],e,!1,n)}getTileCoordForXYAndResolution_(t,e,n,i,o){const s=this.getZForResolution(n),r=n/this.getResolution(s),a=this.getOrigin(s),l=Ji(this.getTileSize(s),this.tmpSize_);let h=r*(t-a[0])/n/l[0],c=r*(a[1]-e)/n/l[1];return i?(h=Ot(h,5)-1,c=Ot(c,5)-1):(h=Dt(h,5),c=Dt(c,5)),po(s,h,c,o)}getTileCoordForXYAndZ_(t,e,n,i,o){const s=this.getOrigin(n),r=this.getResolution(n),a=Ji(this.getTileSize(n),this.tmpSize_);let l=(t-s[0])/r/a[0],h=(s[1]-e)/r/a[1];return i?(l=Ot(l,5)-1,h=Ot(h,5)-1):(l=Dt(l,5),h=Dt(h,5)),po(n,l,h,o)}getTileCoordForCoordAndZ(t,e,n){return this.getTileCoordForXYAndZ_(t[0],t[1],e,!1,n)}getTileCoordResolution(t){return this.resolutions_[t[0]]}getTileSize(t){return this.tileSize_?this.tileSize_:this.tileSizes_[t]}getFullTileRange(t){return this.fullTileRanges_?this.fullTileRanges_[t]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,t):null}getZForResolution(t,e){return Mt(s(this.resolutions_,t,e||0),this.minZoom,this.maxZoom)}tileCoordIntersectsViewport(t,e){return Rn(e,0,e.length,2,this.getTileCoordExtent(t))}calculateTileRanges_(t){const e=this.resolutions_.length,n=new Array(e);for(let i=this.minZoom;i<e;++i)n[i]=this.getTileRangeForExtentAndZ(t,i);this.fullTileRanges_=n}};function To(t){let e=t.getDefaultTileGrid();return e||(e=function(t,e,n,i){return function(t,e,n,i){i=void 0!==i?i:"top-left";const o=So(t,undefined,n);return new Eo({extent:t,origin:ct(t,i),resolutions:o,tileSize:n})}(Po(t),0,void 0,void 0)}(t),t.setDefaultTileGrid(e)),e}function Ro(t){const e=t||{},n=e.extent||Fe("EPSG:3857").getExtent(),i={extent:n,minZoom:e.minZoom,tileSize:e.tileSize,resolutions:So(n,e.maxZoom,e.tileSize,e.maxResolution)};return new Eo(i)}function So(t,e,n,i){e=void 0!==e?e:ie,n=Ji(void 0!==n?n:oe);const o=gt(t),s=ft(t);i=i>0?i:Math.max(s/n[0],o/n[1]);const r=e+1,a=new Array(r);for(let t=0;t<r;++t)a[t]=i/Math.pow(2,t);return a}function Po(t){let e=(t=Fe(t)).getExtent();if(!e){const n=180*se.degrees/t.getMetersPerUnit();e=J(-n,-n,n,n)}return e}class Mo extends t{constructor(t,e){super(t),this.tile=e}}const Io=class extends yo{constructor(t){super({attributions:t.attributions,attributionsCollapsible:t.attributionsCollapsible,projection:t.projection,state:t.state,wrapX:t.wrapX,interpolate:t.interpolate}),this.on,this.once,this.un,this.opaque_=void 0!==t.opaque&&t.opaque,this.tilePixelRatio_=void 0!==t.tilePixelRatio?t.tilePixelRatio:1,this.tileGrid=void 0!==t.tileGrid?t.tileGrid:null;this.tileGrid&&Ji(this.tileGrid.getTileSize(this.tileGrid.getMinZoom()),[256,256]),this.tileCache=new fo(t.cacheSize||0),this.tmpSize=[0,0],this.key_=t.key||"",this.tileOptions={transition:t.transition,interpolate:t.interpolate},this.zDirection=t.zDirection?t.zDirection:0}canExpireCache(){return this.tileCache.canExpireCache()}expireCache(t,e){const n=this.getTileCacheForProjection(t);n&&n.expireCache(e)}forEachLoadedTile(t,e,n,i){const o=this.getTileCacheForProjection(t);if(!o)return!1;let s,r,a,l=!0;for(let t=n.minX;t<=n.maxX;++t)for(let h=n.minY;h<=n.maxY;++h)r=mo(e,t,h),a=!1,o.containsKey(r)&&(s=o.get(r),a=2===s.getState(),a&&(a=!1!==i(s))),a||(l=!1);return l}getGutterForProjection(t){return 0}getKey(){return this.key_}setKey(t){this.key_!==t&&(this.key_=t,this.changed())}getOpaque(t){return this.opaque_}getResolutions(t){const e=t?this.getTileGridForProjection(t):this.tileGrid;return e?e.getResolutions():null}getTile(t,e,n,i,o){return E()}getTileGrid(){return this.tileGrid}getTileGridForProjection(t){return this.tileGrid?this.tileGrid:To(t)}getTileCacheForProjection(t){const e=this.getProjection();return G(null===e||De(e,t),"A VectorTile source can only be rendered if it has a projection compatible with the view projection."),this.tileCache}getTilePixelRatio(t){return this.tilePixelRatio_}getTilePixelSize(t,e,n){const i=this.getTileGridForProjection(n),o=this.getTilePixelRatio(e),s=Ji(i.getTileSize(t),this.tmpSize);return 1==o?s:(r=s,a=o,void 0===(l=this.tmpSize)&&(l=[0,0]),l[0]=r[0]*a+.5|0,l[1]=r[1]*a+.5|0,l);var r,a,l}getTileCoordForTileUrlFunction(t,e){e=void 0!==e?e:this.getProjection();const n=this.getTileGridForProjection(e);return this.getWrapX()&&e.isGlobal()&&(t=function(t,e,n){const i=e[0],o=t.getTileCoordCenter(e),s=Po(n);if(!H(s,o)){const e=ft(s),n=Math.ceil((s[0]-o[0])/e);return o[0]+=e*n,t.getTileCoordForCoordAndZ(o,i)}return e}(n,t,e)),function(t,e){const n=t[0],i=t[1],o=t[2];if(e.getMinZoom()>n||n>e.getMaxZoom())return!1;const s=e.getFullTileRange(n);return!s||s.containsXY(i,o)}(t,n)?t:null}clear(){this.tileCache.clear()}refresh(){this.clear(),super.refresh()}updateCacheSize(t,e){const n=this.getTileCacheForProjection(e);t>n.highWaterMark&&(n.highWaterMark=t)}useTile(t,e,n,i){}};function Lo(t,e){const n=/\{z\}/g,i=/\{x\}/g,o=/\{y\}/g,s=/\{-y\}/g;return function(r,a,l){if(r)return t.replace(n,r[0].toString()).replace(i,r[1].toString()).replace(o,r[2].toString()).replace(s,(function(){const t=r[0],n=e.getFullTileRange(t);if(!n)throw new Error("The {-y} placeholder requires a tile grid with extent");return(n.getHeight()-r[2]-1).toString()}))}}function Fo(t){return 1===t.length?t[0]:function(e,n,i){if(!e)return;const o=function(t){return(t[1]<<t[0])+t[2]}(e),s=At(o,t.length);return t[s](e,n,i)}}class Ao extends Io{constructor(t){super({attributions:t.attributions,cacheSize:t.cacheSize,opaque:t.opaque,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tilePixelRatio:t.tilePixelRatio,wrapX:t.wrapX,transition:t.transition,interpolate:t.interpolate,key:t.key,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection}),this.generateTileUrlFunction_=this.tileUrlFunction===Ao.prototype.tileUrlFunction,this.tileLoadFunction=t.tileLoadFunction,t.tileUrlFunction&&(this.tileUrlFunction=t.tileUrlFunction),this.urls=null,t.urls?this.setUrls(t.urls):t.url&&this.setUrl(t.url),this.tileLoadingKeys_={}}getTileLoadFunction(){return this.tileLoadFunction}getTileUrlFunction(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction}getUrls(){return this.urls}handleTileChange(t){const e=t.target,n=R(e),i=e.getState();let o;1==i?(this.tileLoadingKeys_[n]=!0,o="tileloadstart"):n in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[n],o=3==i?"tileloaderror":2==i?"tileloadend":void 0),null!=o&&this.dispatchEvent(new Mo(o,e))}setTileLoadFunction(t){this.tileCache.clear(),this.tileLoadFunction=t,this.changed()}setTileUrlFunction(t,e){this.tileUrlFunction=t,this.tileCache.pruneExceptNewestZ(),void 0!==e?this.setKey(e):this.changed()}setUrl(t){const e=function(t){const e=[];let n=/\{([a-z])-([a-z])\}/.exec(t);if(n){const i=n[1].charCodeAt(0),o=n[2].charCodeAt(0);let s;for(s=i;s<=o;++s)e.push(t.replace(n[0],String.fromCharCode(s)));return e}if(n=/\{(\d+)-(\d+)\}/.exec(t),n){const i=parseInt(n[2],10);for(let o=parseInt(n[1],10);o<=i;o++)e.push(t.replace(n[0],o.toString()));return e}return e.push(t),e}(t);this.urls=e,this.setUrls(e)}setUrls(t){this.urls=t;const e=t.join("\n");this.generateTileUrlFunction_?this.setTileUrlFunction(function(t,e){const n=t.length,i=new Array(n);for(let o=0;o<n;++o)i[o]=Lo(t[o],e);return Fo(i)}(t,this.tileGrid),e):this.setKey(e)}tileUrlFunction(t,e,n){}useTile(t,e,n){const i=mo(t,e,n);this.tileCache.containsKey(i)&&this.tileCache.get(i)}}const ko=Ao;function zo(t,e){t.getImage().src=e}const Do=class extends ko{constructor(t){super({attributions:t.attributions,cacheSize:t.cacheSize,opaque:t.opaque,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tileLoadFunction:t.tileLoadFunction?t.tileLoadFunction:zo,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:t.wrapX,transition:t.transition,interpolate:void 0===t.interpolate||t.interpolate,key:t.key,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection}),this.crossOrigin=void 0!==t.crossOrigin?t.crossOrigin:null,this.tileClass=void 0!==t.tileClass?t.tileClass:oo,this.tileCacheForProjection={},this.tileGridForProjection={},this.reprojectionErrorThreshold_=t.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1}canExpireCache(){if(this.tileCache.canExpireCache())return!0;for(const t in this.tileCacheForProjection)if(this.tileCacheForProjection[t].canExpireCache())return!0;return!1}expireCache(t,e){const n=this.getTileCacheForProjection(t);this.tileCache.expireCache(this.tileCache==n?e:{});for(const t in this.tileCacheForProjection){const i=this.tileCacheForProjection[t];i.expireCache(i==n?e:{})}}getGutterForProjection(t){return this.getProjection()&&t&&!De(this.getProjection(),t)?0:this.getGutter()}getGutter(){return 0}getKey(){let t=super.getKey();return this.getInterpolate()||(t+=":disable-interpolation"),t}getOpaque(t){return!(this.getProjection()&&t&&!De(this.getProjection(),t))&&super.getOpaque(t)}getTileGridForProjection(t){const e=this.getProjection();if(this.tileGrid&&(!e||De(e,t)))return this.tileGrid;const n=R(t);return n in this.tileGridForProjection||(this.tileGridForProjection[n]=To(t)),this.tileGridForProjection[n]}getTileCacheForProjection(t){const e=this.getProjection();if(!e||De(e,t))return this.tileCache;const n=R(t);return n in this.tileCacheForProjection||(this.tileCacheForProjection[n]=new fo(this.tileCache.highWaterMark)),this.tileCacheForProjection[n]}createTile_(t,e,n,i,o,s){const r=[t,e,n],a=this.getTileCoordForTileUrlFunction(r,o),l=a?this.tileUrlFunction(a,i,o):void 0,h=new this.tileClass(r,void 0!==l?0:4,void 0!==l?l:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return h.key=s,h.addEventListener(d,this.handleTileChange.bind(this)),h}getTile(t,e,n,i,o){const s=this.getProjection();if(!s||!o||De(s,o))return this.getTileInternal(t,e,n,i,s||o);const r=this.getTileCacheForProjection(o),a=[t,e,n];let l;const h=_o(a);r.containsKey(h)&&(l=r.get(h));const c=this.getKey();if(l&&l.key==c)return l;const u=this.getTileGridForProjection(s),d=this.getTileGridForProjection(o),g=this.getTileCoordForTileUrlFunction(a,o),p=new uo(s,u,o,d,a,g,this.getTilePixelRatio(i),this.getGutter(),((t,e,n,i)=>this.getTileInternal(t,e,n,i,s)),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.tileOptions);return p.key=c,l?(p.interimTile=l,p.refreshInterimChain(),r.replace(h,p)):r.set(h,p),p}getTileInternal(t,e,n,i,o){let s=null;const r=mo(t,e,n),a=this.getKey();if(this.tileCache.containsKey(r)){if(s=this.tileCache.get(r),s.key!=a){const l=s;s=this.createTile_(t,e,n,i,o,a),0==l.getState()?s.interimTile=l.interimTile:s.interimTile=l,s.refreshInterimChain(),this.tileCache.replace(r,s)}}else s=this.createTile_(t,e,n,i,o,a),this.tileCache.set(r,s);return s}setRenderReprojectionEdges(t){if(this.renderReprojectionEdges_!=t){this.renderReprojectionEdges_=t;for(const t in this.tileCacheForProjection)this.tileCacheForProjection[t].clear();this.changed()}}setTileGridForProjection(t,e){const n=Fe(t);if(n){const t=R(n);t in this.tileGridForProjection||(this.tileGridForProjection[t]=e)}}clear(){super.clear();for(const t in this.tileCacheForProjection)this.tileCacheForProjection[t].clear()}},Oo=class extends Do{constructor(t){const e=void 0!==(t=t||{}).projection?t.projection:"EPSG:3857",n=void 0!==t.tileGrid?t.tileGrid:Ro({extent:Po(e),maxResolution:t.maxResolution,maxZoom:t.maxZoom,minZoom:t.minZoom,tileSize:t.tileSize});super({attributions:t.attributions,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,interpolate:t.interpolate,opaque:t.opaque,projection:e,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileGrid:n,tileLoadFunction:t.tileLoadFunction,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:void 0===t.wrapX||t.wrapX,transition:t.transition,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection}),this.gutter_=void 0!==t.gutter?t.gutter:0}getGutter(){return this.gutter_}},No=class extends Oo{constructor(t){let e;e=void 0!==(t=t||{}).attributions?t.attributions:['&#169; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors.'];const n=void 0!==t.crossOrigin?t.crossOrigin:"anonymous",i=void 0!==t.url?t.url:"https://tile.openstreetmap.org/{z}/{x}/{y}.png";super({attributions:e,attributionsCollapsible:!1,cacheSize:t.cacheSize,crossOrigin:n,interpolate:t.interpolate,maxZoom:void 0!==t.maxZoom?t.maxZoom:19,opaque:void 0===t.opaque||t.opaque,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileLoadFunction:t.tileLoadFunction,transition:t.transition,url:i,wrapX:t.wrapX,zDirection:t.zDirection})}},jo=class extends Do{constructor(t){const e=void 0!==t.hidpi&&t.hidpi;super({cacheSize:t.cacheSize,crossOrigin:"anonymous",interpolate:t.interpolate,opaque:!0,projection:Fe("EPSG:3857"),reprojectionErrorThreshold:t.reprojectionErrorThreshold,state:"loading",tileLoadFunction:t.tileLoadFunction,tilePixelRatio:e?2:1,wrapX:void 0===t.wrapX||t.wrapX,transition:t.transition,zDirection:t.zDirection}),this.hidpi_=e,this.culture_=void 0!==t.culture?t.culture:"en-us",this.maxZoom_=void 0!==t.maxZoom?t.maxZoom:-1,this.apiKey_=t.key,this.imagerySet_=t.imagerySet,this.placeholderTiles_=t.placeholderTiles;const n="https://dev.virtualearth.net/REST/v1/Imagery/Metadata/"+this.imagerySet_+"?uriScheme=https&include=ImageryProviders&key="+this.apiKey_+"&c="+this.culture_;fetch(n).then((t=>t.json())).then((t=>this.handleImageryMetadataResponse(t)))}getApiKey(){return this.apiKey_}getImagerySet(){return this.imagerySet_}handleImageryMetadataResponse(t){if(200!=t.statusCode||"OK"!=t.statusDescription||"ValidCredentials"!=t.authenticationResultCode||1!=t.resourceSets.length||1!=t.resourceSets[0].resources.length)return void this.setState("error");const e=t.resourceSets[0].resources[0],n=-1==this.maxZoom_?e.zoomMax:this.maxZoom_,i=Po(this.getProjection()),o=this.hidpi_?2:1,s=e.imageWidth==e.imageHeight?e.imageWidth/o:[e.imageWidth/o,e.imageHeight/o],r=Ro({extent:i,minZoom:e.zoomMin,maxZoom:n,tileSize:s});this.tileGrid=r;const a=this.culture_,l=this.hidpi_,h=this.placeholderTiles_;if(this.tileUrlFunction=Fo(e.imageUrlSubdomains.map((function(t){const n=[0,0,0],i=e.imageUrl.replace("{subdomain}",t).replace("{culture}",a);return function(t,e,o){if(!t)return;po(t[0],t[1],t[2],n);const s=new URL(i.replace("{quadkey}",function(t){const e=t[0],n=new Array(e);let i,o,s=1<<e-1;for(i=0;i<e;++i)o=48,t[1]&s&&(o+=1),t[2]&s&&(o+=2),n[i]=String.fromCharCode(o),s>>=1;return n.join("")}(n))),r=s.searchParams;return l&&(r.set("dpi","d1"),r.set("device","mobile")),!0===h?r.delete("n"):!1===h&&r.set("n","z"),s.toString()}}))),e.imageryProviders){const t=Oe(Fe("EPSG:4326"),this.getProjection());this.setAttributions((n=>{const i=[],o=n.viewState,s=this.getTileGrid(),r=s.getZForResolution(o.resolution,this.zDirection),a=s.getTileCoordForCoordAndZ(o.center,r)[0];return e.imageryProviders.map((function(e){let o=!1;const s=e.coverageAreas;for(let e=0,i=s.length;e<i;++e){const i=s[e];if(a>=i.zoomMin&&a<=i.zoomMax){const e=i.bbox;if(vt(xt([e[1],e[0],e[3],e[2]],t),n.extent)){o=!0;break}}}o&&i.push(e.attribution)})),i.push('<a class="ol-attribution-bing-tos" href="https://www.microsoft.com/maps/product/terms.html" target="_blank">Terms of Use</a>'),i}))}this.setState("ready")}},Zo="preload",Ko="useInterimTilesOnError",Go=class extends Nn{constructor(t){t=t||{};const e=Object.assign({},t);delete e.preload,delete e.useInterimTilesOnError,super(e),this.on,this.once,this.un,this.setPreload(void 0!==t.preload?t.preload:0),this.setUseInterimTilesOnError(void 0===t.useInterimTilesOnError||t.useInterimTilesOnError)}getPreload(){return this.get(Zo)}setPreload(t){this.set(Zo,t)}getUseInterimTilesOnError(){return this.get(Ko)}setUseInterimTilesOnError(t){this.set(Ko,t)}getData(t){return super.getData(t)}},Uo=class extends b{constructor(t){super(),this.ready=!0,this.boundHandleImageChange_=this.handleImageChange_.bind(this),this.layer_=t,this.declutterExecutorGroup=null}getFeatures(t){return E()}getData(t){return null}prepareFrame(t){return E()}renderFrame(t,e){return E()}loadedTileCallback(t,e,n){t[e]||(t[e]={}),t[e][n.tileCoord.toString()]=n}createLoadedTileFinder(t,e,n){return(i,o)=>{const s=this.loadedTileCallback.bind(this,n,i);return t.forEachLoadedTile(e,i,o,s)}}forEachFeatureAtCoordinate(t,e,n,i,o){}getLayer(){return this.layer_}handleFontsChanged(){}handleImageChange_(t){const e=t.target;2!==e.getState()&&3!==e.getState()||this.renderIfReadyAndVisible()}loadImage(t){let e=t.getState();return 2!=e&&3!=e&&t.addEventListener(d,this.boundHandleImageChange_),0==e&&(t.load(),e=t.getState()),2==e}renderIfReadyAndVisible(){const t=this.getLayer();t&&t.getVisible()&&"ready"===t.getSourceState()&&t.changed()}disposeInternal(){delete this.layer_,super.disposeInternal()}};let Xo=null;const Vo=class extends Uo{constructor(t){super(t),this.container=null,this.renderedResolution,this.tempTransform=[1,0,0,1,0,0],this.pixelTransform=[1,0,0,1,0,0],this.inversePixelTransform=[1,0,0,1,0,0],this.context=null,this.containerReused=!1,this.pixelContext_=null,this.frameState=null}getImageData(t,e,n){let i;Xo||(Xo=qn(1,1,void 0,{willReadFrequently:!0})),Xo.clearRect(0,0,1,1);try{Xo.drawImage(t,e,n,1,1,0,0,1,1),i=Xo.getImageData(0,0,1,1).data}catch(t){return Xo=null,null}return i}getBackground(t){let e=this.getLayer().getBackground();return"function"==typeof e&&(e=e(t.viewState.resolution)),e||void 0}useContainer(t,e,n){const i=this.getLayer().getClassName();let o,s;if(t&&t.className===i&&(!n||t&&t.style.backgroundColor&&r(Kt(t.style.backgroundColor),Kt(n)))){const e=t.firstElementChild;e instanceof HTMLCanvasElement&&(s=e.getContext("2d"))}if(s&&s.canvas.style.transform===e?(this.container=t,this.context=s,this.containerReused=!0):this.containerReused?(this.container=null,this.context=null,this.containerReused=!1):this.container&&(this.container.style.backgroundColor=null),!this.container){o=document.createElement("div"),o.className=i;let t=o.style;t.position="absolute",t.width="100%",t.height="100%",s=qn();const e=s.canvas;o.appendChild(e),t=e.style,t.position="absolute",t.left="0",t.transformOrigin="top left",this.container=o,this.context=s}this.containerReused||!n||this.container.style.backgroundColor||(this.container.style.backgroundColor=n)}clipUnrotated(t,e,n){const i=mt(n),o=_t(n),s=lt(n),r=at(n);U(e.coordinateToPixelTransform,i),U(e.coordinateToPixelTransform,o),U(e.coordinateToPixelTransform,s),U(e.coordinateToPixelTransform,r);const a=this.inversePixelTransform;U(a,i),U(a,o),U(a,s),U(a,r),t.save(),t.beginPath(),t.moveTo(Math.round(i[0]),Math.round(i[1])),t.lineTo(Math.round(o[0]),Math.round(o[1])),t.lineTo(Math.round(s[0]),Math.round(s[1])),t.lineTo(Math.round(r[0]),Math.round(r[1])),t.clip()}dispatchRenderEvent_(t,e,n){const i=this.getLayer();if(i.hasListener(t)){const o=new Kn(t,this.inversePixelTransform,n,e);i.dispatchEvent(o)}}preRender(t,e){this.frameState=e,this.dispatchRenderEvent_("prerender",t,e)}postRender(t,e){this.dispatchRenderEvent_("postrender",t,e)}getRenderTransform(t,e,n,i,o,s,r){const a=o/2,l=s/2,h=i/e,c=-h,u=-t[0]+r,d=-t[1];return X(this.tempTransform,a,l,h,c,-n,u,d)}disposeInternal(){delete this.frameState,super.disposeInternal()}},qo=class extends Vo{constructor(t){super(t),this.extentChanged=!0,this.renderedExtent_=null,this.renderedPixelRatio,this.renderedProjection=null,this.renderedRevision,this.renderedTiles=[],this.newTiles_=!1,this.tmpExtent=[1/0,1/0,-1/0,-1/0],this.tmpTileRange_=new wo(0,0,0,0)}isDrawableTile(t){const e=this.getLayer(),n=t.getState(),i=e.getUseInterimTilesOnError();return 2==n||4==n||3==n&&!i}getTile(t,e,n,i){const o=i.pixelRatio,s=i.viewState.projection,r=this.getLayer();let a=r.getSource().getTile(t,e,n,o,s);return 3==a.getState()&&r.getUseInterimTilesOnError()&&r.getPreload()>0&&(this.newTiles_=!0),this.isDrawableTile(a)||(a=a.getInterimTile()),a}getData(t){const e=this.frameState;if(!e)return null;const n=this.getLayer(),i=U(e.pixelToCoordinateTransform,t.slice()),o=n.getExtent();if(o&&!H(o,i))return null;const s=e.pixelRatio,r=e.viewState.projection,a=e.viewState,l=n.getRenderSource(),h=l.getTileGridForProjection(a.projection),c=l.getTilePixelRatio(e.pixelRatio);for(let t=h.getZForResolution(a.resolution);t>=h.getMinZoom();--t){const e=h.getTileCoordForCoordAndZ(i,t),n=l.getTile(t,e[1],e[2],s,r);if(!(n instanceof oo||n instanceof uo)||n instanceof uo&&4===n.getState())return null;if(2!==n.getState())continue;const o=h.getOrigin(t),u=Ji(h.getTileSize(t)),d=h.getResolution(t),g=Math.floor(c*((i[0]-o[0])/d-e[1]*u[0])),p=Math.floor(c*((o[1]-i[1])/d-e[2]*u[1])),m=Math.round(c*l.getGutterForProjection(a.projection));return this.getImageData(n.getImage(),g+m,p+m)}return null}loadedTileCallback(t,e,n){return!!this.isDrawableTile(n)&&super.loadedTileCallback(t,e,n)}prepareFrame(t){return!!this.getLayer().getSource()}renderFrame(t,e){const n=t.layerStatesArray[t.layerIndex],i=t.viewState,s=i.projection,r=i.resolution,a=i.center,l=i.rotation,h=t.pixelRatio,c=this.getLayer(),u=c.getSource(),d=u.getRevision(),g=u.getTileGridForProjection(s),p=g.getZForResolution(r,u.zDirection),m=g.getResolution(p);let _=t.extent;const f=t.viewState.resolution,v=u.getTilePixelRatio(h),y=Math.round(ft(_)/f*h),x=Math.round(gt(_)/f*h),C=n.extent&&Xe(n.extent);C&&(_=pt(_,Xe(n.extent)));const w=m*y/2/v,b=m*x/2/v,E=[a[0]-w,a[1]-b,a[0]+w,a[1]+b],T=g.getTileRangeForExtentAndZ(_,p),S={};S[p]={};const P=this.createLoadedTileFinder(u,s,S),M=this.tmpExtent,I=this.tmpTileRange_;this.newTiles_=!1;const L=l?dt(i.center,f,l,t.size):void 0;for(let e=T.minX;e<=T.maxX;++e)for(let i=T.minY;i<=T.maxY;++i){if(l&&!g.tileCoordIntersectsViewport([p,e,i],L))continue;const o=this.getTile(p,e,i,t);if(this.isDrawableTile(o)){const e=R(this);if(2==o.getState()){S[p][o.tileCoord.toString()]=o;let t=o.inTransition(e);t&&1!==n.opacity&&(o.endTransition(e),t=!1),this.newTiles_||!t&&this.renderedTiles.includes(o)||(this.newTiles_=!0)}if(1===o.getAlpha(e,t.time))continue}const s=g.getTileCoordChildTileRange(o.tileCoord,I,M);let r=!1;s&&(r=P(p+1,s)),r||g.forEachTileCoordParentTileRange(o.tileCoord,P,I,M)}const F=m/r*h/v;X(this.pixelTransform,t.size[0]/2,t.size[1]/2,1/h,1/h,l,-y/2,-x/2);const A=function(t){const e="matrix("+t.join(", ")+")";if(j)return e;const n=q||(q=document.createElement("div"));return n.style.transform=e,n.style.transform}(this.pixelTransform);this.useContainer(e,A,this.getBackground(t));const k=this.context,z=k.canvas;V(this.inversePixelTransform,this.pixelTransform),X(this.tempTransform,y/2,x/2,F,F,0,-y/2,-x/2),z.width!=y||z.height!=x?(z.width=y,z.height=x):this.containerReused||k.clearRect(0,0,y,x),C&&this.clipUnrotated(k,t,C),u.getInterpolate()||(k.imageSmoothingEnabled=!1),this.preRender(k,t),this.renderedTiles.length=0;let D,O,N,Z=Object.keys(S).map(Number);Z.sort(o),1!==n.opacity||this.containerReused&&!u.getOpaque(t.viewState.projection)?(D=[],O=[]):Z=Z.reverse();for(let e=Z.length-1;e>=0;--e){const n=Z[e],i=u.getTilePixelSize(n,h,s),o=g.getResolution(n)/m,r=i[0]*o*F,a=i[1]*o*F,l=g.getTileCoordForCoordAndZ(mt(E),n),c=g.getTileCoordExtent(l),d=U(this.tempTransform,[v*(c[0]-E[0])/m,v*(E[3]-c[3])/m]),_=v*u.getGutterForProjection(s),f=S[n];for(const e in f){const i=f[e],o=i.tileCoord,s=l[1]-o[1],h=Math.round(d[0]-(s-1)*r),c=l[2]-o[2],g=Math.round(d[1]-(c-1)*a),m=Math.round(d[0]-s*r),v=Math.round(d[1]-c*a),y=h-m,x=g-v,C=p===n,w=C&&1!==i.getAlpha(R(this),t.time);let b=!1;if(!w)if(D){N=[m,v,m+y,v,m+y,v+x,m,v+x];for(let t=0,e=D.length;t<e;++t)if(p!==n&&n<O[t]){const e=D[t];vt([m,v,m+y,v+x],[e[0],e[3],e[4],e[7]])&&(b||(k.save(),b=!0),k.beginPath(),k.moveTo(N[0],N[1]),k.lineTo(N[2],N[3]),k.lineTo(N[4],N[5]),k.lineTo(N[6],N[7]),k.moveTo(e[6],e[7]),k.lineTo(e[4],e[5]),k.lineTo(e[2],e[3]),k.lineTo(e[0],e[1]),k.clip())}D.push(N),O.push(n)}else k.clearRect(m,v,y,x);this.drawTileImage(i,t,m,v,y,x,_,C),D&&!w?(b&&k.restore(),this.renderedTiles.unshift(i)):this.renderedTiles.push(i),this.updateUsedTiles(t.usedTiles,u,i)}}return this.renderedRevision=d,this.renderedResolution=m,this.extentChanged=!this.renderedExtent_||!et(this.renderedExtent_,E),this.renderedExtent_=E,this.renderedPixelRatio=h,this.renderedProjection=s,this.manageTilePyramid(t,u,g,h,s,_,p,c.getPreload()),this.scheduleExpireCache(t,u),this.postRender(k,t),n.extent&&k.restore(),k.imageSmoothingEnabled=!0,A!==z.style.transform&&(z.style.transform=A),this.container}drawTileImage(t,e,n,i,o,s,r,a){const l=this.getTileImage(t);if(!l)return;const h=R(this),c=e.layerStatesArray[e.layerIndex],u=c.opacity*(a?t.getAlpha(h,e.time):1),d=u!==this.context.globalAlpha;d&&(this.context.save(),this.context.globalAlpha=u),this.context.drawImage(l,r,r,l.width-2*r,l.height-2*r,n,i,o,s),d&&this.context.restore(),u!==c.opacity?e.animate=!0:a&&t.endTransition(h)}getImage(){const t=this.context;return t?t.canvas:null}getTileImage(t){return t.getImage()}scheduleExpireCache(t,e){if(e.canExpireCache()){const n=function(t,e,n){const i=R(t);i in n.usedTiles&&t.expireCache(n.viewState.projection,n.usedTiles[i])}.bind(null,e);t.postRenderFunctions.push(n)}}updateUsedTiles(t,e,n){const i=R(e);i in t||(t[i]={}),t[i][n.getKey()]=!0}manageTilePyramid(t,e,n,i,o,s,r,a,l){const h=R(e);h in t.wantedTiles||(t.wantedTiles[h]={});const c=t.wantedTiles[h],u=t.tileQueue,d=n.getMinZoom(),g=t.viewState.rotation,p=g?dt(t.viewState.center,t.viewState.resolution,g,t.size):void 0;let m,_,f,v,y,x,C=0;for(x=d;x<=r;++x)for(_=n.getTileRangeForExtentAndZ(s,x,_),f=n.getResolution(x),v=_.minX;v<=_.maxX;++v)for(y=_.minY;y<=_.maxY;++y)g&&!n.tileCoordIntersectsViewport([x,v,y],p)||(r-x<=a?(++C,m=e.getTile(x,v,y,i,o),0==m.getState()&&(c[m.getKey()]=!0,u.isKeyQueued(m.getKey())||u.enqueue([m,h,n.getTileCoordCenter(m.tileCoord),f])),void 0!==l&&l(m)):e.useTile(x,v,y,o));e.updateCacheSize(C,o)}},Wo=class extends Go{constructor(t){super(t)}createRenderer(){return new qo(this)}};var Yo=n(379),Bo=n.n(Yo),Ho=n(795),Qo=n.n(Ho),$o=n(569),Jo=n.n($o),ts=n(565),es=n.n(ts),ns=n(216),is=n.n(ns),os=n(589),ss=n.n(os),rs=n(828),as={};as.styleTagTransform=ss(),as.setAttributes=es(),as.insert=Jo().bind(null,"head"),as.domAPI=Qo(),as.insertStyleElement=is(),Bo()(rs.Z,as),rs.Z&&rs.Z.locals&&rs.Z.locals;var ls=n(788),hs={};function cs(t,e){let n=cv.matFromImageData(t);console.log(n);let i=cv.Mat.zeros(n.rows,n.cols,cv.CV_8UC3);console.log(i),cv.cvtColor(n,n,cv.COLOR_RGBA2GRAY,0);let o=new cv.Size(3,3),s=new cv.Point(-1,-1);cv.blur(n,n,o,s,cv.BORDER_DEFAULT),cv.Canny(n,i,50,100,3,!1),cv.imshow(e,i),n.delete(),i.delete()}hs.styleTagTransform=ss(),hs.setAttributes=es(),hs.insert=Jo().bind(null,"head"),hs.domAPI=Qo(),hs.insertStyleElement=is(),Bo()(ls.Z,hs),ls.Z&&ls.Z.locals&&ls.Z.locals;var us=n(148);let ds=(new class{constructor(){this.apikeys={BingMapKey:"AoTrgwP6rdBDsqtY-wq-Z5aA31YHoSzOyKStmu8t0-ZLUbO2LS4PbYoNYNe2SPSx"}}getKeys(){return this.apikeys}}).getKeys().BingMapKey;const gs=document.getElementById("imgCanvas1"),ps=document.getElementById("imgCanvas2"),ms=gs.getContext("2d"),_s=ps.getContext("2d");var fs=document.createElement("canvas"),vs=document.createElement("canvas");let ys,xs;async function Cs(t,e,n){t.once("rendercomplete",(function(){const i=t.getSize();e.width=i[0],e.height=i[1];const o=n;Array.prototype.forEach.call(t.getViewport().querySelectorAll(".ol-layer canvas, canvas.ol-layer"),(function(t){if(t.width>0){const e=t.parentNode.style.opacity||t.style.opacity;let n;o.globalAlpha=""===e?1:Number(e);const i=t.style.transform;n=i?i.match(/^matrix\(([^\(]*)\)$/)[1].split(",").map(Number):[parseFloat(t.style.width)/t.width,0,0,parseFloat(t.style.height)/t.height,0,0],CanvasRenderingContext2D.prototype.setTransform.apply(o,n);const s=t.parentNode.style.backgroundColor;s&&(o.fillStyle=s,o.fillRect(0,0,t.width,t.height)),o.drawImage(t,0,0)}})),o.globalAlpha=1,o.setTransform(1,0,0,1,0,0)})),t.renderSync()}fs.getContext("2d"),vs.getContext("2d"),new Image,new Image,document.getElementById("mapToCanvasBtn").addEventListener("click",(()=>{let t=ms.getImageData(0,0,gs.width,gs.height);cs(t,gs),_s.getImageData(0,0,ps.width,ps.height);var e=function(t,e,n){let i=new ImageData(e,n);for(let t=0;t<i.data.length;t++)i.data[t]=255;console.log(i,"refdata");let o=new ImageData(e,n);return us(t.data,i.data,o.data,e,n,{threshold:.075,includeAA:!0,aaColor:[255,0,0],diffColor:[0,255,0]}),o}(t,ps.width,ps.height);console.log(e,"op"),cs(e,ps)})),function(){const t=new Dn({center:[8687373.06,3544749.53],zoom:13});ys=new no({layers:[new Wo({source:new No})],view:t,target:"map1"}),xs=new no({layers:[new Wo({source:new jo({key:ds,imagerySet:"RoadOnDemand"})})],view:t,target:"map2"}),ys.on("moveend",(t=>{Cs(ys,gs,ms)})),xs.on("moveend",(t=>{Cs(xs,ps,_s)})),ys.on("click",(t=>{let e=ms.getImageData(0,0,gs.width,gs.height);var n;console.log((n=t.pixel,300,function(t){let e=[];for(let n=0;n<t.length;n+=4){let i=t[n],o=t[n+1],s=t[n+2];t[n+4],e.push([i,o,s])}return e}(e.data)[300*n[1]+n[0]]))}))}()})()})();