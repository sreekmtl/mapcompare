(()=>{var __webpack_modules__={8874:t=>{"use strict";t.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},1788:(t,e,i)=>{"use strict";i.d(e,{Z:()=>a});var r=i(8081),n=i.n(r),s=i(3645),o=i.n(s)()(n());o.push([t.id,':root,\n:host {\n  --ol-background-color: white;\n  --ol-accent-background-color: #F5F5F5;\n  --ol-subtle-background-color: rgba(128, 128, 128, 0.25);\n  --ol-partial-background-color: rgba(255, 255, 255, 0.75);\n  --ol-foreground-color: #333333;\n  --ol-subtle-foreground-color: #666666;\n  --ol-brand-color: #00AAFF;\n}\n\n.ol-box {\n  box-sizing: border-box;\n  border-radius: 2px;\n  border: 1.5px solid var(--ol-background-color);\n  background-color: var(--ol-partial-background-color);\n}\n\n.ol-mouse-position {\n  top: 8px;\n  right: 8px;\n  position: absolute;\n}\n\n.ol-scale-line {\n  background: var(--ol-partial-background-color);\n  border-radius: 4px;\n  bottom: 8px;\n  left: 8px;\n  padding: 2px;\n  position: absolute;\n}\n\n.ol-scale-line-inner {\n  border: 1px solid var(--ol-subtle-foreground-color);\n  border-top: none;\n  color: var(--ol-foreground-color);\n  font-size: 10px;\n  text-align: center;\n  margin: 1px;\n  will-change: contents, width;\n  transition: all 0.25s;\n}\n\n.ol-scale-bar {\n  position: absolute;\n  bottom: 8px;\n  left: 8px;\n}\n\n.ol-scale-bar-inner {\n  display: flex;\n}\n\n.ol-scale-step-marker {\n  width: 1px;\n  height: 15px;\n  background-color: var(--ol-foreground-color);\n  float: right;\n  z-index: 10;\n}\n\n.ol-scale-step-text {\n  position: absolute;\n  bottom: -5px;\n  font-size: 10px;\n  z-index: 11;\n  color: var(--ol-foreground-color);\n  text-shadow: -1.5px 0 var(--ol-partial-background-color), 0 1.5px var(--ol-partial-background-color), 1.5px 0 var(--ol-partial-background-color), 0 -1.5px var(--ol-partial-background-color);\n}\n\n.ol-scale-text {\n  position: absolute;\n  font-size: 12px;\n  text-align: center;\n  bottom: 25px;\n  color: var(--ol-foreground-color);\n  text-shadow: -1.5px 0 var(--ol-partial-background-color), 0 1.5px var(--ol-partial-background-color), 1.5px 0 var(--ol-partial-background-color), 0 -1.5px var(--ol-partial-background-color);\n}\n\n.ol-scale-singlebar {\n  position: relative;\n  height: 10px;\n  z-index: 9;\n  box-sizing: border-box;\n  border: 1px solid var(--ol-foreground-color);\n}\n\n.ol-scale-singlebar-even {\n  background-color: var(--ol-subtle-foreground-color);\n}\n\n.ol-scale-singlebar-odd {\n  background-color: var(--ol-background-color);\n}\n\n.ol-unsupported {\n  display: none;\n}\n\n.ol-viewport,\n.ol-unselectable {\n  -webkit-touch-callout: none;\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  user-select: none;\n  -webkit-tap-highlight-color: transparent;\n}\n\n.ol-viewport canvas {\n  all: unset;\n  overflow: hidden;\n}\n\n.ol-viewport {\n  touch-action: pan-x pan-y;\n}\n\n.ol-selectable {\n  -webkit-touch-callout: default;\n  -webkit-user-select: text;\n  -moz-user-select: text;\n  user-select: text;\n}\n\n.ol-grabbing {\n  cursor: -webkit-grabbing;\n  cursor: -moz-grabbing;\n  cursor: grabbing;\n}\n\n.ol-grab {\n  cursor: move;\n  cursor: -webkit-grab;\n  cursor: -moz-grab;\n  cursor: grab;\n}\n\n.ol-control {\n  position: absolute;\n  background-color: var(--ol-subtle-background-color);\n  border-radius: 4px;\n}\n\n.ol-zoom {\n  top: .5em;\n  left: .5em;\n}\n\n.ol-rotate {\n  top: .5em;\n  right: .5em;\n  transition: opacity .25s linear, visibility 0s linear;\n}\n\n.ol-rotate.ol-hidden {\n  opacity: 0;\n  visibility: hidden;\n  transition: opacity .25s linear, visibility 0s linear .25s;\n}\n\n.ol-zoom-extent {\n  top: 4.643em;\n  left: .5em;\n}\n\n.ol-full-screen {\n  right: .5em;\n  top: .5em;\n}\n\n.ol-control button {\n  display: block;\n  margin: 1px;\n  padding: 0;\n  color: var(--ol-subtle-foreground-color);\n  font-weight: bold;\n  text-decoration: none;\n  font-size: inherit;\n  text-align: center;\n  height: 1.375em;\n  width: 1.375em;\n  line-height: .4em;\n  background-color: var(--ol-background-color);\n  border: none;\n  border-radius: 2px;\n}\n\n.ol-control button::-moz-focus-inner {\n  border: none;\n  padding: 0;\n}\n\n.ol-zoom-extent button {\n  line-height: 1.4em;\n}\n\n.ol-compass {\n  display: block;\n  font-weight: normal;\n  will-change: transform;\n}\n\n.ol-touch .ol-control button {\n  font-size: 1.5em;\n}\n\n.ol-touch .ol-zoom-extent {\n  top: 5.5em;\n}\n\n.ol-control button:hover,\n.ol-control button:focus {\n  text-decoration: none;\n  outline: 1px solid var(--ol-subtle-foreground-color);\n  color: var(--ol-foreground-color);\n}\n\n.ol-zoom .ol-zoom-in {\n  border-radius: 2px 2px 0 0;\n}\n\n.ol-zoom .ol-zoom-out {\n  border-radius: 0 0 2px 2px;\n}\n\n.ol-attribution {\n  text-align: right;\n  bottom: .5em;\n  right: .5em;\n  max-width: calc(100% - 1.3em);\n  display: flex;\n  flex-flow: row-reverse;\n  align-items: center;\n}\n\n.ol-attribution a {\n  color: var(--ol-subtle-foreground-color);\n  text-decoration: none;\n}\n\n.ol-attribution ul {\n  margin: 0;\n  padding: 1px .5em;\n  color: var(--ol-foreground-color);\n  text-shadow: 0 0 2px var(--ol-background-color);\n  font-size: 12px;\n}\n\n.ol-attribution li {\n  display: inline;\n  list-style: none;\n}\n\n.ol-attribution li:not(:last-child):after {\n  content: " ";\n}\n\n.ol-attribution img {\n  max-height: 2em;\n  max-width: inherit;\n  vertical-align: middle;\n}\n\n.ol-attribution button {\n  flex-shrink: 0;\n}\n\n.ol-attribution.ol-collapsed ul {\n  display: none;\n}\n\n.ol-attribution:not(.ol-collapsed) {\n  background: var(--ol-partial-background-color);\n}\n\n.ol-attribution.ol-uncollapsible {\n  bottom: 0;\n  right: 0;\n  border-radius: 4px 0 0;\n}\n\n.ol-attribution.ol-uncollapsible img {\n  margin-top: -.2em;\n  max-height: 1.6em;\n}\n\n.ol-attribution.ol-uncollapsible button {\n  display: none;\n}\n\n.ol-zoomslider {\n  top: 4.5em;\n  left: .5em;\n  height: 200px;\n}\n\n.ol-zoomslider button {\n  position: relative;\n  height: 10px;\n}\n\n.ol-touch .ol-zoomslider {\n  top: 5.5em;\n}\n\n.ol-overviewmap {\n  left: 0.5em;\n  bottom: 0.5em;\n}\n\n.ol-overviewmap.ol-uncollapsible {\n  bottom: 0;\n  left: 0;\n  border-radius: 0 4px 0 0;\n}\n\n.ol-overviewmap .ol-overviewmap-map,\n.ol-overviewmap button {\n  display: block;\n}\n\n.ol-overviewmap .ol-overviewmap-map {\n  border: 1px solid var(--ol-subtle-foreground-color);\n  height: 150px;\n  width: 150px;\n}\n\n.ol-overviewmap:not(.ol-collapsed) button {\n  bottom: 0;\n  left: 0;\n  position: absolute;\n}\n\n.ol-overviewmap.ol-collapsed .ol-overviewmap-map,\n.ol-overviewmap.ol-uncollapsible button {\n  display: none;\n}\n\n.ol-overviewmap:not(.ol-collapsed) {\n  background: var(--ol-subtle-background-color);\n}\n\n.ol-overviewmap-box {\n  border: 1.5px dotted var(--ol-subtle-foreground-color);\n}\n\n.ol-overviewmap .ol-overviewmap-box:hover {\n  cursor: move;\n}\n',""]);const a=o},1828:(t,e,i)=>{"use strict";i.d(e,{Z:()=>a});var r=i(8081),n=i.n(r),s=i(3645),o=i.n(s)()(n());o.push([t.id,'* {\n    box-sizing: border-box;\n  }\n.column {\n    float: left;\n    width: 50%;\n    padding: 10px;\n    height: 640px; /* Should be removed. Only for demonstration */\n  }\n  \n  /* Clear floats after the columns */\n  .row:after {\n    content: "";\n    display: table;\n    clear: both;\n  }\n\n.button {\n    background-color: #4CAF50; /* Green */\n    width: 50px;\n    height: 20px;\n    border: none;\n    color: white;\n    padding: 10px 16px;\n    text-align: center;\n    text-decoration: none;\n    display: inline-block;\n    font-size: 12px;\n  }',""]);const a=o},3645:t=>{"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var i="",r=void 0!==e[5];return e[4]&&(i+="@supports (".concat(e[4],") {")),e[2]&&(i+="@media ".concat(e[2]," {")),r&&(i+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),i+=t(e),r&&(i+="}"),e[2]&&(i+="}"),e[4]&&(i+="}"),i})).join("")},e.i=function(t,i,r,n,s){"string"==typeof t&&(t=[[null,t,void 0]]);var o={};if(r)for(var a=0;a<this.length;a++){var h=this[a][0];null!=h&&(o[h]=!0)}for(var l=0;l<t.length;l++){var u=[].concat(t[l]);r&&o[u[0]]||(void 0!==s&&(void 0===u[5]||(u[1]="@layer".concat(u[5].length>0?" ".concat(u[5]):""," {").concat(u[1],"}")),u[5]=s),i&&(u[2]?(u[1]="@media ".concat(u[2]," {").concat(u[1],"}"),u[2]=i):u[2]=i),n&&(u[4]?(u[1]="@supports (".concat(u[4],") {").concat(u[1],"}"),u[4]=n):u[4]="".concat(n)),e.push(u))}},e}},8081:t=>{"use strict";t.exports=function(t){return t[1]}},7060:(t,e,i)=>{"use strict";const{IOBuffer:r}=i(2155),n=i(5578),s=[];for(let t=0;t<=8;t++)s.push(255<<t);t.exports=class extends r{constructor(t){if(1!==t.bitDepth)throw new Error("Only bitDepth of 1 is supported");if(!t.height||!t.width)throw new Error("ImageData width and height are required");super(t.data),this.width=t.width,this.height=t.height,this.bitDepth=t.bitDepth,this.channels=t.channels,this.components=t.components}encode(){this.encoded=new r,this.encoded.skip(14),this.writeBitmapV5Header(),this.writeColorTable();const t=this.encoded.offset;return this.writePixelArray(),this.encoded.rewind(),this.writeBitmapFileHeader(t),this.encoded.toArray()}writePixelArray(){let t=this.encoded;const e=4*Math.floor((this.bitDepth*this.width+31)/32),i=Math.ceil(this.bitDepth*this.width/8),r=e-i,n=this.bitDepth*this.width%8,o=0===n?0:8-n,a=e*this.height;let h,l,u=0,c=0,d=8;t.mark(),l=this.readUint8();for(let a=this.height-1;a>=0;a--){const f=0===a;t.reset(),t.skip(a*e);for(let e=0;e<i;e++){const a=e===i-1;c<=o&&a?(t.writeByte(l<<c),0!==o&&o!==c||f||(h=l,l=this.readByte())):0===c?(h=l,l=this.readUint8(),t.writeByte(h)):(h=l,l=this.readUint8(),t.writeByte(h<<c&s[c]|l>>d)),a&&(u+=n||0,t.skip(r),c=u%8,d=8-c)}}e>i&&(t.reset(),t.skip(a-1),t.writeUint8(0))}writeColorTable(){this.encoded.writeUint32(0).writeUint32(16777215)}writeBitmapFileHeader(t){this.encoded.writeChars("BM").writeInt32(this.encoded.lastWrittenByte).writeUint16(0).writeUint16(0).writeUint32(t)}writeBitmapV5Header(){const t=4*Math.floor((this.bitDepth*this.width+31)/32)*this.height;this.encoded.writeUint32(124).writeInt32(this.width).writeInt32(this.height).writeUint16(1).writeUint16(this.bitDepth).writeUint32(n.BITMAPV5HEADER.Compression.BI_RGB).writeUint32(t).writeInt32(0).writeInt32(0).writeUint32(Math.pow(2,this.bitDepth)).writeUint32(Math.pow(2,this.bitDepth)).writeUint32(4278190080).writeUint32(16711680).writeUint32(65280).writeUint32(255).writeUint32(n.BITMAPV5HEADER.LogicalColorSpace.LCS_sRGB).skip(36).skip(12).writeUint32(n.BITMAPV5HEADER.GamutMappingIntent.LCS_GM_IMAGES).skip(12)}}},5578:t=>{"use strict";t.exports={BITMAPV5HEADER:{LogicalColorSpace:{LCS_CALIBRATED_RGB:0,LCS_sRGB:1934772034,LCS_WINDOWS_COLOR_SPACE:1466527264},Compression:{BI_RGB:0,BI_RLE8:1,BI_RLE4:2,BI_BITFIELDS:3,BI_JPEG:4,BI_PNG:5,BI_CMYK:11,BI_CMYKRLE8:12,BI_CMYKRLE4:13},GamutMappingIntent:{LCS_GM_ABS_COLORIMETRIC:8,LCS_GM_BUSINESS:1,LCS_GM_GRAPHICS:2,LCS_GM_IMAGES:4}}}},4665:(t,e,i)=>{"use strict";const r=i(7060);e.c=function(t){return new r(t).encode()}},7909:t=>{"use strict";const e=[];t.exports=class{constructor(t,e){e=e||{},void 0===t&&(t=8192),"number"==typeof t&&(t=new ArrayBuffer(t));let i=t.byteLength;const r=e.offset?e.offset>>>0:0;t.buffer&&(i=t.byteLength-r,t=t.byteLength!==t.buffer.byteLength?t.buffer.slice(t.byteOffset+r,t.byteOffset+t.byteLength):r?t.buffer.slice(r):t.buffer),this.buffer=t,this.length=i,this.byteLength=i,this.byteOffset=0,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer),this._increment=i||8192,this._mark=0}available(t){return void 0===t&&(t=1),this.offset+t<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){this.littleEndian=!0}isBigEndian(){return!this.littleEndian}setBigEndian(){this.littleEndian=!1}skip(t){void 0===t&&(t=1),this.offset+=t}seek(t){this.offset=t}mark(){this._mark=this.offset}reset(){this.offset=this._mark}rewind(){this.offset=0}ensureAvailable(t){if(void 0===t&&(t=1),!this.available(t)){const t=this._increment+this._increment;this._increment=t;const e=this.length+t,i=new Uint8Array(e);i.set(new Uint8Array(this.buffer)),this.buffer=i.buffer,this.length=e,this._data=new DataView(this.buffer)}}readBoolean(){return 0!==this.readUint8()}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(t){void 0===t&&(t=1);for(var e=new Uint8Array(t),i=0;i<t;i++)e[i]=this.readByte();return e}readInt16(){var t=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,t}readUint16(){var t=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,t}readInt32(){var t=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,t}readUint32(){var t=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat32(){var t=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat64(){var t=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,t}readChar(){return String.fromCharCode(this.readInt8())}readChars(t){void 0===t&&(t=1),e.length=t;for(var i=0;i<t;i++)e[i]=this.readChar();return e.join("")}writeBoolean(t){this.writeUint8(t?255:0)}writeInt8(t){this.ensureAvailable(1),this._data.setInt8(this.offset++,t)}writeUint8(t){this.ensureAvailable(1),this._data.setUint8(this.offset++,t)}writeByte(t){this.writeUint8(t)}writeBytes(t){this.ensureAvailable(t.length);for(var e=0;e<t.length;e++)this._data.setUint8(this.offset++,t[e])}writeInt16(t){this.ensureAvailable(2),this._data.setInt16(this.offset,t,this.littleEndian),this.offset+=2}writeUint16(t){this.ensureAvailable(2),this._data.setUint16(this.offset,t,this.littleEndian),this.offset+=2}writeInt32(t){this.ensureAvailable(4),this._data.setInt32(this.offset,t,this.littleEndian),this.offset+=4}writeUint32(t){this.ensureAvailable(4),this._data.setUint32(this.offset,t,this.littleEndian),this.offset+=4}writeFloat32(t){this.ensureAvailable(4),this._data.setFloat32(this.offset,t,this.littleEndian),this.offset+=4}writeFloat64(t){this.ensureAvailable(8),this._data.setFloat64(this.offset,t,this.littleEndian),this.offset+=8}writeChar(t){this.writeUint8(t.charCodeAt(0))}writeChars(t){for(var e=0;e<t.length;e++)this.writeUint8(t.charCodeAt(e))}toArray(){return new Uint8Array(this.buffer,0,this.offset)}}},3311:(t,e,i)=>{"use strict";const r=i(6752);t.exports=function(t,e){return new r(t,e).decode(e)}},8029:(t,e,i)=>{"use strict";const r={standard:i(4263),exif:i(9640),gps:i(5367)};t.exports=class{constructor(t){if(!t)throw new Error("missing kind");this.data=null,this.fields=new Map,this.kind=t,this._map=null}get(t){if("number"==typeof t)return this.fields.get(t);if("string"==typeof t)return this.fields.get(r[this.kind].tagsByName[t]);throw new Error("expected a number or string")}get map(){if(!this._map){this._map={};const e=r[this.kind].tagsById;for(var t of this.fields.keys())e[t]&&(this._map[e[t]]=this.fields.get(t))}return this._map}}},6486:(t,e)=>{"use strict";var i=new Map([[1,[1,r]],[2,[1,function(t,e){for(var i=[],r="",n=0;n<e;n++){var s=String.fromCharCode(t.readUint8());"\0"===s?(i.push(r),r=""):r+=s}return 1===i.length?i[0]:i}]],[3,[2,function(t,e){if(1===e)return t.readUint16();for(var i=new Uint16Array(e),r=0;r<e;r++)i[r]=t.readUint16();return i}]],[4,[4,function(t,e){if(1===e)return t.readUint32();for(var i=new Uint32Array(e),r=0;r<e;r++)i[r]=t.readUint32();return i}]],[5,[8,function(t,e){if(1===e)return t.readUint32()/t.readUint32();for(var i=new Array(e),r=0;r<e;r++)i[r]=t.readUint32()/t.readUint32();return i}]],[6,[1,function(t,e){if(1===e)return t.readInt8();for(var i=new Int8Array(e),r=0;r<e;r++)i[r]=t.readInt8();return i}]],[7,[1,r]],[8,[2,function(t,e){if(1===e)return t.readInt16();for(var i=new Int16Array(e),r=0;r<e;r++)i[r]=t.readInt16();return i}]],[9,[4,function(t,e){if(1===e)return t.readInt32();for(var i=new Int32Array(e),r=0;r<e;r++)i[r]=t.readInt32();return i}]],[10,[8,function(t,e){if(1===e)return t.readInt32()/t.readInt32();for(var i=new Array(e),r=0;r<e;r++)i[r]=t.readInt32()/t.readInt32();return i}]],[11,[4,function(t,e){if(1===e)return t.readFloat32();for(var i=new Float32Array(e),r=0;r<e;r++)i[r]=t.readFloat32();return i}]],[12,[8,function(t,e){if(1===e)return t.readFloat64();for(var i=new Float64Array(e),r=0;r<e;r++)i[r]=t.readFloat64();return i}]]]);function r(t,e){if(1===e)return t.readUint8();for(var i=new Uint8Array(e),r=0;r<e;r++)i[r]=t.readUint8();return i}e.getByteLength=function(t,e){return i.get(t)[0]*e},e.readData=function(t,e,r){return i.get(e)[1](t,r)}},9469:(t,e,i)=>{"use strict";e.decode=i(3311)},9640:t=>{"use strict";const e={33434:"ExposureTime",33437:"FNumber",34850:"ExposureProgram",34852:"SpectralSensitivity",34855:"ISOSpeedRatings",34856:"OECF",34864:"SensitivityType",34865:"StandardOutputSensitivity",34866:"RecommendedExposureIndex",34867:"ISOSpeed",34868:"ISOSpeedLatitudeyyy",34869:"ISOSpeedLatitudezzz",36864:"ExifVersion",36867:"DateTimeOriginal",36868:"DateTimeDigitized",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureBiasValue",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37386:"FocalLength",37396:"SubjectArea",37500:"MakerNote",37510:"UserComment",37520:"SubsecTime",37521:"SubsecTimeOriginal",37522:"SubsecTimeDigitized",40960:"FlashpixVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",40964:"RelatedSoundFile",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41492:"SubjectLocation",41493:"ExposureIndex",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRatio",41989:"FocalLengthIn35mmFilm",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",42016:"ImageUniqueID",42032:"CameraOwnerName",42033:"BodySerialNumber",42034:"LensSpecification",42035:"LensMake",42036:"LensModel",42037:"LensSerialNumber",42240:"Gamma"},i={};for(var r in e)i[e[r]]=r;t.exports={tagsById:e,tagsByName:i}},5367:t=>{"use strict";const e={0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential",31:"GPSHPositioningError"},i={};for(var r in e)i[e[r]]=r;t.exports={tagsById:e,tagsByName:i}},4263:t=>{"use strict";const e={254:"NewSubfileType",255:"SubfileType",256:"ImageWidth",257:"ImageLength",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",263:"Threshholding",264:"CellWidth",265:"CellLength",266:"FillOrder",270:"ImageDescription",271:"Make",272:"Model",273:"StripOffsets",274:"Orientation",277:"SamplesPerPixel",278:"RowsPerStrip",279:"StripByteCounts",280:"MinSampleValue",281:"MaxSampleValue",282:"XResolution",283:"YResolution",284:"PlanarConfiguration",288:"FreeOffsets",289:"FreeByteCounts",290:"GrayResponseUnit",291:"GrayResponseCurve",296:"ResolutionUnit",305:"Software",306:"DateTime",315:"Artist",316:"HostComputer",320:"ColorMap",338:"ExtraSamples",33432:"Copyright",269:"DocumentName",285:"PageName",286:"XPosition",287:"YPosition",292:"T4Options",293:"T6Options",297:"PageNumber",301:"TransferFunction",317:"Predictor",318:"WhitePoint",319:"PrimaryChromaticities",321:"HalftoneHints",322:"TileWidth",323:"TileLength",324:"TileOffsets",325:"TileByteCounts",326:"BadFaxLines",327:"CleanFaxData",328:"ConsecutiveBadFaxLines",330:"SubIFDs",332:"InkSet",333:"InkNames",334:"NumberOfInks",336:"DotRange",337:"TargetPrinter",339:"SampleFormat",340:"SMinSampleValue",341:"SMaxSampleValue",342:"TransferRange",343:"ClipPath",344:"XClipPathUnits",345:"YClipPathUnits",346:"Indexed",347:"JPEGTables",351:"OPIProxy",400:"GlobalParametersIFD",401:"ProfileType",402:"FaxProfile",403:"CodingMethods",404:"VersionYear",405:"ModeNumber",433:"Decode",434:"DefaultImageColor",512:"JPEGProc",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",515:"JPEGRestartInterval",517:"JPEGLosslessPredictors",518:"JPEGPointTransforms",519:"JPEGQTables",520:"JPEGDCTables",521:"JPEGACTables",529:"YCbCrCoefficients",530:"YCbCrSubSampling",531:"YCbCrPositioning",532:"ReferenceBlackWhite",559:"StripRowCounts",700:"XMP",32781:"ImageID",34732:"ImageLayer",32932:"WangAnnotatio",33445:"MDFileTag",33446:"MDScalePixel",33447:"MDColorTable",33448:"MDLabName",33449:"MDSampleInfo",33450:"MDPrepDate",33451:"MDPrepTime",33452:"MDFileUnits",33550:"ModelPixelScaleTag",33723:"IPTC",33918:"INGRPacketDataTag",33919:"INGRFlagRegisters",33920:"IrasBTransformationMatrix",33922:"ModelTiepointTag",34264:"ModelTransformationTag",34377:"Photoshop",34665:"ExifIFD",34675:"ICCProfile",34735:"GeoKeyDirectoryTag",34736:"GeoDoubleParamsTag",34737:"GeoAsciiParamsTag",34853:"GPSIFD",34908:"HylaFAXFaxRecvParams",34909:"HylaFAXFaxSubAddress",34910:"HylaFAXFaxRecvTime",37724:"ImageSourceData",40965:"InteroperabilityIFD",42112:"GDAL_METADATA",42113:"GDAL_NODATA",50215:"OceScanjobDescription",50216:"OceApplicationSelector",50217:"OceIdentificationNumber",50218:"OceImageLogicCharacteristics",50706:"DNGVersion",50707:"DNGBackwardVersion",50708:"UniqueCameraModel",50709:"LocalizedCameraModel",50710:"CFAPlaneColor",50711:"CFALayout",50712:"LinearizationTable",50713:"BlackLevelRepeatDim",50714:"BlackLevel",50715:"BlackLevelDeltaH",50716:"BlackLevelDeltaV",50717:"WhiteLevel",50718:"DefaultScale",50719:"DefaultCropOrigin",50720:"DefaultCropSize",50721:"ColorMatrix1",50722:"ColorMatrix2",50723:"CameraCalibration1",50724:"CameraCalibration2",50725:"ReductionMatrix1",50726:"ReductionMatrix2",50727:"AnalogBalance",50728:"AsShotNeutral",50729:"AsShotWhiteXY",50730:"BaselineExposure",50731:"BaselineNoise",50732:"BaselineSharpness",50733:"BayerGreenSplit",50734:"LinearResponseLimit",50735:"CameraSerialNumber",50736:"LensInfo",50737:"ChromaBlurRadius",50738:"AntiAliasStrength",50740:"DNGPrivateData",50741:"MakerNoteSafety",50778:"CalibrationIlluminant1",50779:"CalibrationIlluminant2",50780:"BestQualityScale",50784:"AliasLayerMetadata"},i={};for(var r in e)i[e[r]]=r;t.exports={tagsById:e,tagsByName:i}},6752:(t,e,i)=>{"use strict";const r=i(7909),n=i(8029),s=i(8353),o=i(6486),a={ignoreImageData:!1,onlyFirst:!1};function h(t,e,i,r){for(var n=0;n<r;n++)t[i++]=e.getUint8(n);return i}function l(t,e,i,r,n){for(var s=0;s<2*r;s+=2)t[i++]=e.getUint16(s,n);return i}function u(t,e,i,r,n){for(var s=0;s<4*r;s+=4)t[i++]=e.getFloat32(s,n);return i}function c(t,e){throw new Error("Unsupported "+t+": "+e)}t.exports=class extends r{constructor(t,e){super(t,e),this._nextIFD=0}decode(t){t=Object.assign({},a,t);const e=[];for(this.decodeHeader();this._nextIFD;)if(e.push(this.decodeIFD(t)),t.onlyFirst)return e[0];return e}decodeHeader(){let t=this.readUint16();if(18761===t)this.setLittleEndian();else{if(19789!==t)throw new Error("invalid byte order: 0x"+t.toString(16));this.setBigEndian()}if(t=this.readUint16(),42!==t)throw new Error("not a TIFF file");this._nextIFD=this.readUint32()}decodeIFD(t){var e;this.seek(this._nextIFD),e=t.kind?new n(t.kind):new s;const i=this.readUint16();for(var r=0;r<i;r++)this.decodeIFDEntry(e);return t.ignoreImageData||this.decodeImageData(e),this._nextIFD=this.readUint32(),e}decodeIFDEntry(t){const e=this.offset,i=this.readUint16(),r=this.readUint16(),n=this.readUint32();if(r<1||r>12)return void this.skip(4);o.getByteLength(r,n)>4&&this.seek(this.readUint32());const s=o.readData(this,r,n);if(t.fields.set(i,s),34665===i||34853===i){let e,r=this.offset;34665===i?e="exif":34853===i&&(e="gps"),this._nextIFD=s,t[e]=this.decodeIFD({kind:e,ignoreImageData:!0}),this.offset=r}this.seek(e),this.skip(12)}decodeImageData(t){const e=t.orientation;switch(e&&1!==e&&c("orientation",e),t.type){case 1:case 2:this.readStripData(t);break;default:c("image type",t.type)}}readStripData(t){const e=t.width,i=t.height,r=function(t){if(t.length){const i=t;t=i[0];for(var e=0;e<i.length;e++)i[e]!==t&&c("bit depth",i)}return t}(t.bitsPerSample),n=t.sampleFormat;let s=e*i;const o=function(t,e,i,r){return 8===i?new Uint8Array(1*t):16===i?new Uint16Array(1*t):32===i&&3===r?new Float32Array(1*t):c("bit depth / sample format",i+" / "+r)}(s,0,r,n),a=t.compression,d=t.rowsPerStrip*e,f=t.stripOffsets,g=t.stripByteCounts;for(var m=0,p=0;p<f.length;p++){var w=this.getStripData(a,f[p],g[p]),_=s>d?d:s;s-=_,8===r?m=h(o,w,m,_):16===r?m=l(o,w,m,_,this.isLittleEndian()):32===r&&3===n?m=u(o,w,m,_,this.isLittleEndian()):c("bitDepth",r)}t.data=o}getStripData(t,e,i){switch(t){case 1:return new DataView(this.buffer,e,i);case 2:case 32773:return c("Compression",t);default:throw new Error("invalid compression: "+t)}}}},8353:(t,e,i)=>{"use strict";const r=i(8029),n=/^(\d{4}):(\d{2}):(\d{2}) (\d{2}):(\d{2}):(\d{2})$/;function s(t){return"number"==typeof t?[t]:t}t.exports=class extends r{constructor(){super("standard")}get size(){return this.width*this.height}get width(){return this.imageWidth}get height(){return this.imageLength}get components(){return this.samplesPerPixel}get date(){var t=new Date,e=n.exec(this.dateTime);return t.setFullYear(e[1],e[2]-1,e[3]),t.setHours(e[4],e[5],e[6]),t}get newSubfileType(){return this.get(254)}get imageWidth(){return this.get(256)}get imageLength(){return this.get(257)}get bitsPerSample(){return this.get(258)}get compression(){return this.get(259)||1}get type(){return this.get(262)}get fillOrder(){return this.get(266)||1}get documentName(){return this.get(269)}get imageDescription(){return this.get(270)}get stripOffsets(){return s(this.get(273))}get orientation(){return this.get(274)}get samplesPerPixel(){return this.get(277)}get rowsPerStrip(){return this.get(278)}get stripByteCounts(){return s(this.get(279))}get minSampleValue(){return this.get(280)||0}get maxSampleValue(){return this.get(281)||Math.pow(2,this.bitsPerSample)-1}get xResolution(){return this.get(282)}get yResolution(){return this.get(283)}get planarConfiguration(){return this.get(284)||1}get resolutionUnit(){return this.get(296)||2}get dateTime(){return this.get(306)}get predictor(){return this.get(317)||1}get sampleFormat(){return this.get(339)||1}get sMinSampleValue(){return this.get(340)||this.minSampleValue}get sMaxSampleValue(){return this.get(341)||this.maxSampleValue}}},9698:(t,e,i)=>{"use strict";const r=i(7909),n=i(9469);t.exports=function(t){const e=new r(t),i={};if(e.setBigEndian(),65496!==e.readUint16())throw new Error("SOI marker not found. Not a valid JPEG file");if(65505===e.readUint16()){e.readUint16();const t=e.readBytes(6);if(69===t[0]&&120===t[1]&&105===t[2]&&102===t[3]&&0===t[4]&&0===t[5]){const t=n.decode(e,{onlyFirst:!0,ignoreImageData:!0,offset:e.offset});i.exif=t}}return i}},9464:(t,e,i)=>{"use strict";e.decode=i(9698)},8737:t=>{!function(){function e(t,e,i){this.next=i,i&&(i.prev=this),this.prev=e,e&&(e.next=this),this.data=t}function i(){if(!(this instanceof i))return new i;this._head=null,this._tail=null,this.length=0}i.prototype={push:function(t){this._tail=new e(t,this._tail,null),this._head||(this._head=this._tail),this.length++},pop:function(){if(0!==this.length){var t=this._tail;return this._tail=t.prev,t.prev&&(t.prev=this._tail.next=null),this.length--,1===this.length?this._head=this._tail:0===this.length&&(this._head=this._tail=null),t.data}},unshift:function(t){this._head=new e(t,null,this._head),this._tail||(this._tail=this._head),this.length++},shift:function(){if(0!==this.length){var t=this._head;return this._head=t.next,t.next&&(t.next=this._head.prev=null),this.length--,1===this.length?this._tail=this._head:0===this.length&&(this._head=this._tail=null),t.data}},item:function(t){t<0&&(t=this.length+t);for(var e=this._head;t-- >0&&e;)e=e.next;return e?e.data:void 0},slice:function(t,e){if(t||(t=0),e||(e=this.length),e<0&&(e=this.length+e),t<0&&(t=this.length+t),e===t)return[];if(e<t)throw new Error("invalid offset: "+t+","+e+" (length="+this.length+")");for(var i=e-t,r=new Array(i),n=0,s=this._head;t-- >0&&s;)s=s.next;for(;n<i&&s;)r[n++]=s.data,s=s.next;return r},drop:function(){i.call(this)},forEach:function(t,e){for(var i=this._head,r=0,n=this.length;r<n&&i;)t.call(e||this,i.data,r,this),i=i.next,r++},map:function(t,e){var r=new i;return this.forEach((function(i,n,s){r.push(t.call(e||s,i,n,s))})),r},filter:function(t,e){var r=new i;return this.forEach((function(i,n,s){t.call(e||s,i,n,s)&&r.push(i)})),r},reduce:function(t,e,i){var r=0,n=this._head,s=this.length;for(e||(r=1,e=n&&n.data,n=n&&n.next);r<s&&n;)e=t.call(i||this,e,n.data,this),r++,n=n.next;return e}},t.exports=i}()},9645:t=>{"use strict";function e(t){if(this.size=0|t,this.size<=1||0!=(this.size&this.size-1))throw new Error("FFT size must be a power of two and bigger than 1");this._csize=t<<1;for(var e=new Array(2*this.size),i=0;i<e.length;i+=2){const t=Math.PI*i/this.size;e[i]=Math.cos(t),e[i+1]=-Math.sin(t)}this.table=e;for(var r=0,n=1;this.size>n;n<<=1)r++;this._width=r%2==0?r-1:r,this._bitrev=new Array(1<<this._width);for(var s=0;s<this._bitrev.length;s++){this._bitrev[s]=0;for(var o=0;o<this._width;o+=2){var a=this._width-o-2;this._bitrev[s]|=(s>>>o&3)<<a}}this._out=null,this._data=null,this._inv=0}t.exports=e,e.prototype.fromComplexArray=function(t,e){for(var i=e||new Array(t.length>>>1),r=0;r<t.length;r+=2)i[r>>>1]=t[r];return i},e.prototype.createComplexArray=function(){const t=new Array(this._csize);for(var e=0;e<t.length;e++)t[e]=0;return t},e.prototype.toComplexArray=function(t,e){for(var i=e||this.createComplexArray(),r=0;r<i.length;r+=2)i[r]=t[r>>>1],i[r+1]=0;return i},e.prototype.completeSpectrum=function(t){for(var e=this._csize,i=e>>>1,r=2;r<i;r+=2)t[e-r]=t[r],t[e-r+1]=-t[r+1]},e.prototype.transform=function(t,e){if(t===e)throw new Error("Input and output buffers must be different");this._out=t,this._data=e,this._inv=0,this._transform4(),this._out=null,this._data=null},e.prototype.realTransform=function(t,e){if(t===e)throw new Error("Input and output buffers must be different");this._out=t,this._data=e,this._inv=0,this._realTransform4(),this._out=null,this._data=null},e.prototype.inverseTransform=function(t,e){if(t===e)throw new Error("Input and output buffers must be different");this._out=t,this._data=e,this._inv=1,this._transform4();for(var i=0;i<t.length;i++)t[i]/=this.size;this._out=null,this._data=null},e.prototype._transform4=function(){var t,e,i=this._out,r=this._csize,n=1<<this._width,s=r/n<<1,o=this._bitrev;if(4===s)for(t=0,e=0;t<r;t+=s,e++){const i=o[e];this._singleTransform2(t,i,n)}else for(t=0,e=0;t<r;t+=s,e++){const i=o[e];this._singleTransform4(t,i,n)}var a=this._inv?-1:1,h=this.table;for(n>>=2;n>=2;n>>=2){var l=(s=r/n<<1)>>>2;for(t=0;t<r;t+=s)for(var u=t+l,c=t,d=0;c<u;c+=2,d+=n){const t=c,e=t+l,r=e+l,n=r+l,s=i[t],o=i[t+1],u=i[e],f=i[e+1],g=i[r],m=i[r+1],p=i[n],w=i[n+1],_=s,b=o,y=h[d],v=a*h[d+1],x=u*y-f*v,M=u*v+f*y,k=h[2*d],E=a*h[2*d+1],C=g*k-m*E,S=g*E+m*k,A=h[3*d],T=a*h[3*d+1],R=p*A-w*T,P=p*T+w*A,I=_+C,D=b+S,L=_-C,F=b-S,z=x+R,B=M+P,N=a*(x-R),O=a*(M-P),U=I+z,V=D+B,Y=I-z,X=D-B,j=L+O,G=F-N,q=L-O,Z=F+N;i[t]=U,i[t+1]=V,i[e]=j,i[e+1]=G,i[r]=Y,i[r+1]=X,i[n]=q,i[n+1]=Z}}},e.prototype._singleTransform2=function(t,e,i){const r=this._out,n=this._data,s=n[e],o=n[e+1],a=n[e+i],h=n[e+i+1],l=s+a,u=o+h,c=s-a,d=o-h;r[t]=l,r[t+1]=u,r[t+2]=c,r[t+3]=d},e.prototype._singleTransform4=function(t,e,i){const r=this._out,n=this._data,s=this._inv?-1:1,o=2*i,a=3*i,h=n[e],l=n[e+1],u=n[e+i],c=n[e+i+1],d=n[e+o],f=n[e+o+1],g=n[e+a],m=n[e+a+1],p=h+d,w=l+f,_=h-d,b=l-f,y=u+g,v=c+m,x=s*(u-g),M=s*(c-m),k=p+y,E=w+v,C=_+M,S=b-x,A=p-y,T=w-v,R=_-M,P=b+x;r[t]=k,r[t+1]=E,r[t+2]=C,r[t+3]=S,r[t+4]=A,r[t+5]=T,r[t+6]=R,r[t+7]=P},e.prototype._realTransform4=function(){var t,e,i=this._out,r=this._csize,n=1<<this._width,s=r/n<<1,o=this._bitrev;if(4===s)for(t=0,e=0;t<r;t+=s,e++){const i=o[e];this._singleRealTransform2(t,i>>>1,n>>>1)}else for(t=0,e=0;t<r;t+=s,e++){const i=o[e];this._singleRealTransform4(t,i>>>1,n>>>1)}var a=this._inv?-1:1,h=this.table;for(n>>=2;n>=2;n>>=2){var l=(s=r/n<<1)>>>1,u=l>>>1,c=u>>>1;for(t=0;t<r;t+=s)for(var d=0,f=0;d<=c;d+=2,f+=n){var g=t+d,m=g+u,p=m+u,w=p+u,_=i[g],b=i[g+1],y=i[m],v=i[m+1],x=i[p],M=i[p+1],k=i[w],E=i[w+1],C=_,S=b,A=h[f],T=a*h[f+1],R=y*A-v*T,P=y*T+v*A,I=h[2*f],D=a*h[2*f+1],L=x*I-M*D,F=x*D+M*I,z=h[3*f],B=a*h[3*f+1],N=k*z-E*B,O=k*B+E*z,U=C+L,V=S+F,Y=C-L,X=S-F,j=R+N,G=P+O,q=a*(R-N),Z=a*(P-O),K=U+j,H=V+G,W=Y+Z,$=X-q;if(i[g]=K,i[g+1]=H,i[m]=W,i[m+1]=$,0!==d){if(d!==c){var Q=Y+-a*Z,J=-a*q-X,tt=U+-a*j,et=-V- -a*G,it=t+u-d,rt=t+l-d;i[it]=Q,i[it+1]=J,i[rt]=tt,i[rt+1]=et}}else{var nt=U-j,st=V-G;i[p]=nt,i[p+1]=st}}}},e.prototype._singleRealTransform2=function(t,e,i){const r=this._out,n=this._data,s=n[e],o=n[e+i],a=s+o,h=s-o;r[t]=a,r[t+1]=0,r[t+2]=h,r[t+3]=0},e.prototype._singleRealTransform4=function(t,e,i){const r=this._out,n=this._data,s=this._inv?-1:1,o=2*i,a=3*i,h=n[e],l=n[e+i],u=n[e+o],c=n[e+a],d=h+u,f=h-u,g=l+c,m=s*(l-c),p=d+g,w=f,_=-m,b=d-g,y=f,v=m;r[t]=p,r[t+1]=0,r[t+2]=w,r[t+3]=_,r[t+4]=b,r[t+5]=0,r[t+6]=y,r[t+7]=v}},7769:module=>{"use strict";const toBytes=t=>[...t].map((t=>t.charCodeAt(0))),xpiZipFilename=toBytes("META-INF/mozilla.rsa"),oxmlContentTypes=toBytes("[Content_Types].xml"),oxmlRels=toBytes("_rels/.rels");function readUInt64LE(t,e=0){let i=t[e],r=1,n=0;for(;++n<8;)r*=256,i+=t[e+n]*r;return i}const fileType=t=>{if(!(t instanceof Uint8Array||t instanceof ArrayBuffer||Buffer.isBuffer(t)))throw new TypeError(`Expected the \`input\` argument to be of type \`Uint8Array\` or \`Buffer\` or \`ArrayBuffer\`, got \`${typeof t}\``);const e=t instanceof Uint8Array?t:new Uint8Array(t);if(!(e&&e.length>1))return null;const i=(t,i)=>{i=Object.assign({offset:0},i);for(let r=0;r<t.length;r++)if(i.mask){if(t[r]!==(i.mask[r]&e[r+i.offset]))return!1}else if(t[r]!==e[r+i.offset])return!1;return!0},r=(t,e)=>i(toBytes(t),e);if(i([255,216,255]))return{ext:"jpg",mime:"image/jpeg"};if(i([137,80,78,71,13,10,26,10]))return{ext:"png",mime:"image/png"};if(i([71,73,70]))return{ext:"gif",mime:"image/gif"};if(i([87,69,66,80],{offset:8}))return{ext:"webp",mime:"image/webp"};if(i([70,76,73,70]))return{ext:"flif",mime:"image/flif"};if((i([73,73,42,0])||i([77,77,0,42]))&&i([67,82],{offset:8}))return{ext:"cr2",mime:"image/x-canon-cr2"};if(i([73,73,42,0])||i([77,77,0,42]))return{ext:"tif",mime:"image/tiff"};if(i([66,77]))return{ext:"bmp",mime:"image/bmp"};if(i([73,73,188]))return{ext:"jxr",mime:"image/vnd.ms-photo"};if(i([56,66,80,83]))return{ext:"psd",mime:"image/vnd.adobe.photoshop"};if(i([80,75,3,4])){if(i([109,105,109,101,116,121,112,101,97,112,112,108,105,99,97,116,105,111,110,47,101,112,117,98,43,122,105,112],{offset:30}))return{ext:"epub",mime:"application/epub+zip"};if(i(xpiZipFilename,{offset:30}))return{ext:"xpi",mime:"application/x-xpinstall"};if(r("mimetypeapplication/vnd.oasis.opendocument.text",{offset:30}))return{ext:"odt",mime:"application/vnd.oasis.opendocument.text"};if(r("mimetypeapplication/vnd.oasis.opendocument.spreadsheet",{offset:30}))return{ext:"ods",mime:"application/vnd.oasis.opendocument.spreadsheet"};if(r("mimetypeapplication/vnd.oasis.opendocument.presentation",{offset:30}))return{ext:"odp",mime:"application/vnd.oasis.opendocument.presentation"};const t=(t,e=0)=>t.findIndex(((t,i,r)=>i>=e&&80===r[i]&&75===r[i+1]&&3===r[i+2]&&4===r[i+3]));let n=0,s=!1,o=null;do{const a=n+30;if(s||(s=i(oxmlContentTypes,{offset:a})||i(oxmlRels,{offset:a})),o||(r("word/",{offset:a})?o={ext:"docx",mime:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"}:r("ppt/",{offset:a})?o={ext:"pptx",mime:"application/vnd.openxmlformats-officedocument.presentationml.presentation"}:r("xl/",{offset:a})&&(o={ext:"xlsx",mime:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"})),s&&o)return o;n=t(e,a)}while(n>=0);if(o)return o}if(i([80,75])&&(3===e[2]||5===e[2]||7===e[2])&&(4===e[3]||6===e[3]||8===e[3]))return{ext:"zip",mime:"application/zip"};if(i([117,115,116,97,114],{offset:257}))return{ext:"tar",mime:"application/x-tar"};if(i([82,97,114,33,26,7])&&(0===e[6]||1===e[6]))return{ext:"rar",mime:"application/x-rar-compressed"};if(i([31,139,8]))return{ext:"gz",mime:"application/gzip"};if(i([66,90,104]))return{ext:"bz2",mime:"application/x-bzip2"};if(i([55,122,188,175,39,28]))return{ext:"7z",mime:"application/x-7z-compressed"};if(i([120,1]))return{ext:"dmg",mime:"application/x-apple-diskimage"};if(i([51,103,112,53])||i([0,0,0])&&i([102,116,121,112],{offset:4})&&(i([109,112,52,49],{offset:8})||i([109,112,52,50],{offset:8})||i([105,115,111,109],{offset:8})||i([105,115,111,50],{offset:8})||i([109,109,112,52],{offset:8})||i([77,52,86],{offset:8})||i([100,97,115,104],{offset:8})))return{ext:"mp4",mime:"video/mp4"};if(i([77,84,104,100]))return{ext:"mid",mime:"audio/midi"};if(i([26,69,223,163])){const t=e.subarray(4,4100),i=t.findIndex(((t,e,i)=>66===i[e]&&130===i[e+1]));if(-1!==i){const e=i+3,r=i=>[...i].every(((i,r)=>t[e+r]===i.charCodeAt(0)));if(r("matroska"))return{ext:"mkv",mime:"video/x-matroska"};if(r("webm"))return{ext:"webm",mime:"video/webm"}}}if(i([0,0,0,20,102,116,121,112,113,116,32,32])||i([102,114,101,101],{offset:4})||i([102,116,121,112,113,116,32,32],{offset:4})||i([109,100,97,116],{offset:4})||i([109,111,111,118],{offset:4})||i([119,105,100,101],{offset:4}))return{ext:"mov",mime:"video/quicktime"};if(i([82,73,70,70])){if(i([65,86,73],{offset:8}))return{ext:"avi",mime:"video/vnd.avi"};if(i([87,65,86,69],{offset:8}))return{ext:"wav",mime:"audio/vnd.wave"};if(i([81,76,67,77],{offset:8}))return{ext:"qcp",mime:"audio/qcelp"}}if(i([48,38,178,117,142,102,207,17,166,217])){let t=30;do{const r=readUInt64LE(e,t+16);if(i([145,7,220,183,183,169,207,17,142,230,0,192,12,32,83,101],{offset:t})){if(i([64,158,105,248,77,91,207,17,168,253,0,128,95,92,68,43],{offset:t+24}))return{ext:"wma",mime:"audio/x-ms-wma"};if(i([192,239,25,188,77,91,207,17,168,253,0,128,95,92,68,43],{offset:t+24}))return{ext:"wmv",mime:"video/x-ms-asf"};break}t+=r}while(t+24<=e.length);return{ext:"asf",mime:"application/vnd.ms-asf"}}if(i([0,0,1,186])||i([0,0,1,179]))return{ext:"mpg",mime:"video/mpeg"};if(i([102,116,121,112,51,103],{offset:4}))return{ext:"3gp",mime:"video/3gpp"};for(let t=0;t<2&&t<e.length-16;t++){if(i([73,68,51],{offset:t})||i([255,226],{offset:t,mask:[255,226]}))return{ext:"mp3",mime:"audio/mpeg"};if(i([255,228],{offset:t,mask:[255,228]}))return{ext:"mp2",mime:"audio/mpeg"};if(i([255,248],{offset:t,mask:[255,252]}))return{ext:"mp2",mime:"audio/mpeg"};if(i([255,240],{offset:t,mask:[255,252]}))return{ext:"mp4",mime:"audio/mpeg"}}if(i([102,116,121,112,77,52,65],{offset:4}))return{ext:"m4a",mime:"audio/mp4"};if(i([79,112,117,115,72,101,97,100],{offset:28}))return{ext:"opus",mime:"audio/opus"};if(i([79,103,103,83]))return i([128,116,104,101,111,114,97],{offset:28})?{ext:"ogv",mime:"video/ogg"}:i([1,118,105,100,101,111,0],{offset:28})?{ext:"ogm",mime:"video/ogg"}:i([127,70,76,65,67],{offset:28})?{ext:"oga",mime:"audio/ogg"}:i([83,112,101,101,120,32,32],{offset:28})?{ext:"spx",mime:"audio/ogg"}:i([1,118,111,114,98,105,115],{offset:28})?{ext:"ogg",mime:"audio/ogg"}:{ext:"ogx",mime:"application/ogg"};if(i([102,76,97,67]))return{ext:"flac",mime:"audio/x-flac"};if(i([77,65,67,32]))return{ext:"ape",mime:"audio/ape"};if(i([119,118,112,107]))return{ext:"wv",mime:"audio/wavpack"};if(i([35,33,65,77,82,10]))return{ext:"amr",mime:"audio/amr"};if(i([37,80,68,70]))return{ext:"pdf",mime:"application/pdf"};if(i([77,90]))return{ext:"exe",mime:"application/x-msdownload"};if((67===e[0]||70===e[0])&&i([87,83],{offset:1}))return{ext:"swf",mime:"application/x-shockwave-flash"};if(i([123,92,114,116,102]))return{ext:"rtf",mime:"application/rtf"};if(i([0,97,115,109]))return{ext:"wasm",mime:"application/wasm"};if(i([119,79,70,70])&&(i([0,1,0,0],{offset:4})||i([79,84,84,79],{offset:4})))return{ext:"woff",mime:"font/woff"};if(i([119,79,70,50])&&(i([0,1,0,0],{offset:4})||i([79,84,84,79],{offset:4})))return{ext:"woff2",mime:"font/woff2"};if(i([76,80],{offset:34})&&(i([0,0,1],{offset:8})||i([1,0,2],{offset:8})||i([2,0,2],{offset:8})))return{ext:"eot",mime:"application/vnd.ms-fontobject"};if(i([0,1,0,0,0]))return{ext:"ttf",mime:"font/ttf"};if(i([79,84,84,79,0]))return{ext:"otf",mime:"font/otf"};if(i([0,0,1,0]))return{ext:"ico",mime:"image/x-icon"};if(i([0,0,2,0]))return{ext:"cur",mime:"image/x-icon"};if(i([70,76,86,1]))return{ext:"flv",mime:"video/x-flv"};if(i([37,33]))return{ext:"ps",mime:"application/postscript"};if(i([253,55,122,88,90,0]))return{ext:"xz",mime:"application/x-xz"};if(i([83,81,76,105]))return{ext:"sqlite",mime:"application/x-sqlite3"};if(i([78,69,83,26]))return{ext:"nes",mime:"application/x-nintendo-nes-rom"};if(i([67,114,50,52]))return{ext:"crx",mime:"application/x-google-chrome-extension"};if(i([77,83,67,70])||i([73,83,99,40]))return{ext:"cab",mime:"application/vnd.ms-cab-compressed"};if(i([33,60,97,114,99,104,62,10,100,101,98,105,97,110,45,98,105,110,97,114,121]))return{ext:"deb",mime:"application/x-deb"};if(i([33,60,97,114,99,104,62]))return{ext:"ar",mime:"application/x-unix-archive"};if(i([237,171,238,219]))return{ext:"rpm",mime:"application/x-rpm"};if(i([31,160])||i([31,157]))return{ext:"Z",mime:"application/x-compress"};if(i([76,90,73,80]))return{ext:"lz",mime:"application/x-lzip"};if(i([208,207,17,224,161,177,26,225]))return{ext:"msi",mime:"application/x-msi"};if(i([6,14,43,52,2,5,1,1,13,1,2,1,1,2]))return{ext:"mxf",mime:"application/mxf"};if(i([71],{offset:4})&&(i([71],{offset:192})||i([71],{offset:196})))return{ext:"mts",mime:"video/mp2t"};if(i([66,76,69,78,68,69,82]))return{ext:"blend",mime:"application/x-blender"};if(i([66,80,71,251]))return{ext:"bpg",mime:"image/bpg"};if(i([0,0,0,12,106,80,32,32,13,10,135,10])){if(i([106,112,50,32],{offset:20}))return{ext:"jp2",mime:"image/jp2"};if(i([106,112,120,32],{offset:20}))return{ext:"jpx",mime:"image/jpx"};if(i([106,112,109,32],{offset:20}))return{ext:"jpm",mime:"image/jpm"};if(i([109,106,112,50],{offset:20}))return{ext:"mj2",mime:"image/mj2"}}if(i([70,79,82,77]))return{ext:"aif",mime:"audio/aiff"};if(r("<?xml "))return{ext:"xml",mime:"application/xml"};if(i([66,79,79,75,77,79,66,73],{offset:60}))return{ext:"mobi",mime:"application/x-mobipocket-ebook"};if(i([102,116,121,112],{offset:4})){if(i([109,105,102,49],{offset:8}))return{ext:"heic",mime:"image/heif"};if(i([109,115,102,49],{offset:8}))return{ext:"heic",mime:"image/heif-sequence"};if(i([104,101,105,99],{offset:8})||i([104,101,105,120],{offset:8}))return{ext:"heic",mime:"image/heic"};if(i([104,101,118,99],{offset:8})||i([104,101,118,120],{offset:8}))return{ext:"heic",mime:"image/heic-sequence"}}return i([171,75,84,88,32,49,49,187,13,10,26,10])?{ext:"ktx",mime:"image/ktx"}:i([68,73,67,77],{offset:128})?{ext:"dcm",mime:"application/dicom"}:i([77,80,43])||i([77,80,67,75])?{ext:"mpc",mime:"audio/x-musepack"}:i([66,69,71,73,78,58])?{ext:"ics",mime:"text/calendar"}:i([103,108,84,70,2,0,0,0])?{ext:"glb",mime:"model/gltf-binary"}:i([212,195,178,161])||i([161,178,195,212])?{ext:"pcap",mime:"application/vnd.tcpdump.pcap"}:null};module.exports=fileType,module.exports.default=fileType,Object.defineProperty(fileType,"minimumBytes",{value:4100}),module.exports.stream=readableStream=>new Promise(((resolve,reject)=>{const stream=eval("require")("stream");readableStream.once("readable",(()=>{const t=new stream.PassThrough,e=readableStream.read(module.exports.minimumBytes)||readableStream.read();try{t.fileType=fileType(e)}catch(t){reject(t)}readableStream.unshift(e),stream.pipeline?resolve(stream.pipeline(readableStream,t,(()=>{}))):resolve(readableStream.pipe(t))}))}))},2251:(t,e,i)=>{var r=Object.prototype.hasOwnProperty;t.exports=e=function(t,e){return r.call(e,t)},e.version=i(2898).version},9184:(t,e,i)=>{"use strict";const r=i(7769),n=new Set(["jpg","png","gif","webp","flif","cr2","tif","bmp","jxr","psd","ico","bpg","jp2","jpm","jpx","heic","cur","dcm"]),s=t=>{const e=r(t);return n.has(e&&e.ext)?e:null};t.exports=s,t.exports.default=s,Object.defineProperty(s,"minimumBytes",{value:r.minimumBytes})},2155:(t,e,i)=>{"use strict";function r(t,e="utf8"){return new TextDecoder(e).decode(t)}i.r(e),i.d(e,{IOBuffer:()=>a}),i(7396);const n=new TextEncoder,s=(()=>{const t=new Uint8Array(4);return!((new Uint32Array(t.buffer)[0]=1)&t[0])})(),o={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class a{constructor(t=8192,e={}){let i=!1;"number"==typeof t?t=new ArrayBuffer(t):(i=!0,this.lastWrittenByte=t.byteLength);const r=e.offset?e.offset>>>0:0,n=t.byteLength-r;let s=r;(ArrayBuffer.isView(t)||t instanceof a)&&(t.byteLength!==t.buffer.byteLength&&(s=t.byteOffset+r),t=t.buffer),this.lastWrittenByte=i?n:0,this.buffer=t,this.length=n,this.byteLength=n,this.byteOffset=s,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,s,n),this._mark=0,this._marks=[]}available(t=1){return this.offset+t<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(t=1){return this.offset+=t,this}back(t=1){return this.offset-=t,this}seek(t){return this.offset=t,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const t=this._marks.pop();if(void 0===t)throw new Error("Mark stack empty");return this.seek(t),this}rewind(){return this.offset=0,this}ensureAvailable(t=1){if(!this.available(t)){const e=2*(this.offset+t),i=new Uint8Array(e);i.set(new Uint8Array(this.buffer)),this.buffer=i.buffer,this.length=this.byteLength=e,this._data=new DataView(this.buffer)}return this}readBoolean(){return 0!==this.readUint8()}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(t=1){return this.readArray(t,"uint8")}readArray(t,e){const i=o[e].BYTES_PER_ELEMENT*t,r=this.byteOffset+this.offset,n=this.buffer.slice(r,r+i);if(this.littleEndian===s&&"uint8"!==e&&"int8"!==e){const t=new Uint8Array(this.buffer.slice(r,r+i));t.reverse();const n=new o[e](t.buffer);return this.offset+=i,n.reverse(),n}const a=new o[e](n);return this.offset+=i,a}readInt16(){const t=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,t}readUint16(){const t=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,t}readInt32(){const t=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,t}readUint32(){const t=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat32(){const t=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat64(){const t=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,t}readBigInt64(){const t=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,t}readBigUint64(){const t=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,t}readChar(){return String.fromCharCode(this.readInt8())}readChars(t=1){let e="";for(let i=0;i<t;i++)e+=this.readChar();return e}readUtf8(t=1){return r(this.readBytes(t))}decodeText(t=1,e="utf-8"){return r(this.readBytes(t),e)}writeBoolean(t){return this.writeUint8(t?255:0),this}writeInt8(t){return this.ensureAvailable(1),this._data.setInt8(this.offset++,t),this._updateLastWrittenByte(),this}writeUint8(t){return this.ensureAvailable(1),this._data.setUint8(this.offset++,t),this._updateLastWrittenByte(),this}writeByte(t){return this.writeUint8(t)}writeBytes(t){this.ensureAvailable(t.length);for(let e=0;e<t.length;e++)this._data.setUint8(this.offset++,t[e]);return this._updateLastWrittenByte(),this}writeInt16(t){return this.ensureAvailable(2),this._data.setInt16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(t){return this.ensureAvailable(2),this._data.setUint16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(t){return this.ensureAvailable(4),this._data.setInt32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(t){return this.ensureAvailable(4),this._data.setUint32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(t){return this.ensureAvailable(4),this._data.setFloat32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(t){return this.ensureAvailable(8),this._data.setFloat64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(t){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(t){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(t){return this.writeUint8(t.charCodeAt(0))}writeChars(t){for(let e=0;e<t.length;e++)this.writeUint8(t.charCodeAt(e));return this}writeUtf8(t){return this.writeBytes(function(t){return n.encode(t)}(t))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}},7396:function(){"use strict";!function(t){if(t.TextEncoder&&t.TextDecoder)return!1;function e(t="utf-8"){if("utf-8"!==t)throw new RangeError(`Failed to construct 'TextEncoder': The encoding label provided ('${t}') is invalid.`)}function i(t="utf-8",e={fatal:!1}){if("utf-8"!==t)throw new RangeError(`Failed to construct 'TextDecoder': The encoding label provided ('${t}') is invalid.`);if(e.fatal)throw new Error("Failed to construct 'TextDecoder': the 'fatal' option is unsupported.")}Object.defineProperty(e.prototype,"encoding",{value:"utf-8"}),e.prototype.encode=function(t,e={stream:!1}){if(e.stream)throw new Error("Failed to encode: the 'stream' option is unsupported.");let i=0;const r=t.length;let n=0,s=Math.max(32,r+(r>>1)+7),o=new Uint8Array(s>>3<<3);for(;i<r;){let e=t.charCodeAt(i++);if(e>=55296&&e<=56319){if(i<r){const r=t.charCodeAt(i);56320==(64512&r)&&(++i,e=((1023&e)<<10)+(1023&r)+65536)}if(e>=55296&&e<=56319)continue}if(n+4>o.length){s+=8,s*=1+i/t.length*2,s=s>>3<<3;const e=new Uint8Array(s);e.set(o),o=e}if(0!=(4294967168&e)){if(0==(4294965248&e))o[n++]=e>>6&31|192;else if(0==(4294901760&e))o[n++]=e>>12&15|224,o[n++]=e>>6&63|128;else{if(0!=(4292870144&e))continue;o[n++]=e>>18&7|240,o[n++]=e>>12&63|128,o[n++]=e>>6&63|128}o[n++]=63&e|128}else o[n++]=e}return o.slice(0,n)},Object.defineProperty(i.prototype,"encoding",{value:"utf-8"}),Object.defineProperty(i.prototype,"fatal",{value:!1}),Object.defineProperty(i.prototype,"ignoreBOM",{value:!1}),i.prototype.decode=function(t,e={stream:!1}){if(e.stream)throw new Error("Failed to decode: the 'stream' option is unsupported.");const i=new Uint8Array(t);let r=0;const n=i.length,s=[];for(;r<n;){const t=i[r++];if(0===t)break;if(0==(128&t))s.push(t);else if(192==(224&t)){const e=63&i[r++];s.push((31&t)<<6|e)}else if(224==(240&t)){const e=63&i[r++],n=63&i[r++];s.push((31&t)<<12|e<<6|n)}else if(240==(248&t)){let e=(7&t)<<18|(63&i[r++])<<12|(63&i[r++])<<6|63&i[r++];e>65535&&(e-=65536,s.push(e>>>10&1023|55296),e=56320|1023&e),s.push(e)}}return String.fromCharCode.apply(null,s)},t.TextEncoder=e,t.TextDecoder=i}("undefined"!=typeof window?window:"undefined"!=typeof self?self:this)},4091:(t,e,i)=>{"use strict";i.r(e),i.d(e,{isAnyArray:()=>n});const r=Object.prototype.toString;function n(t){const e=r.call(t);return e.endsWith("Array]")&&!e.includes("Big")}},7811:t=>{"use strict";var e=Object.prototype.toString;t.exports=function(t){return"Array"===e.call(t).substr(-6,5)}},1867:t=>{"use strict";t.exports=Number.isFinite||function(t){return!("number"!=typeof t||t!=t||t===1/0||t===-1/0)}},8336:(t,e,i)=>{var r=i(1867);t.exports=Number.isInteger||function(t){return"number"==typeof t&&r(t)&&Math.floor(t)===t}},7870:(t,e,i)=>{var r=i(587),n=i(914);t.exports={encode:r,decode:n}},914:t=>{var e=function(){"use strict";var t=new Int32Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]),e=4017,i=799,r=3406,n=2276,s=1567,o=3784,a=5793,h=2896;function l(){}function u(t,e){for(var i,r,n=0,s=[],o=16;o>0&&!t[o-1];)o--;s.push({children:[],index:0});var a,h=s[0];for(i=0;i<o;i++){for(r=0;r<t[i];r++){for((h=s.pop()).children[h.index]=e[n];h.index>0;){if(0===s.length)throw new Error("Could not recreate Huffman Table");h=s.pop()}for(h.index++,s.push(h);s.length<=i;)s.push(a={children:[],index:0}),h.children[h.index]=a.children,h=a;n++}i+1<o&&(s.push(a={children:[],index:0}),h.children[h.index]=a.children,h=a)}return s[0].children}function c(e,i,r,n,s,o,a,h,l,u){r.precision,r.samplesPerLine,r.scanLines;var c=r.mcusPerLine,d=r.progressive,f=(r.maxH,r.maxV,i),g=0,m=0;function p(){if(m>0)return m--,g>>m&1;if(255==(g=e[i++])){var t=e[i++];if(t)throw new Error("unexpected marker: "+(g<<8|t).toString(16))}return m=7,g>>>7}function w(t){for(var e,i=t;null!==(e=p());){if("number"==typeof(i=i[e]))return i;if("object"!=typeof i)throw new Error("invalid huffman sequence")}return null}function _(t){for(var e=0;t>0;){var i=p();if(null===i)return;e=e<<1|i,t--}return e}function b(t){var e=_(t);return e>=1<<t-1?e:e+(-1<<t)+1}var y,v=0,x=0;function M(t,e,i,r,n){var s=i%c,o=(i/c|0)*t.v+r,a=s*t.h+n;void 0===t.blocks[o]&&u.tolerantDecoding||e(t,t.blocks[o][a])}function k(t,e,i){var r=i/t.blocksPerLine|0,n=i%t.blocksPerLine;void 0===t.blocks[r]&&u.tolerantDecoding||e(t,t.blocks[r][n])}var E,C,S,A,T,R,P=n.length;R=d?0===o?0===h?function(t,e){var i=w(t.huffmanTableDC),r=0===i?0:b(i)<<l;e[0]=t.pred+=r}:function(t,e){e[0]|=p()<<l}:0===h?function(e,i){if(v>0)v--;else for(var r=o,n=a;r<=n;){var s=w(e.huffmanTableAC),h=15&s,u=s>>4;if(0!==h)i[t[r+=u]]=b(h)*(1<<l),r++;else{if(u<15){v=_(u)+(1<<u)-1;break}r+=16}}}:function(e,i){for(var r=o,n=a,s=0;r<=n;){var h=t[r],u=i[h]<0?-1:1;switch(x){case 0:var c=w(e.huffmanTableAC),d=15&c;if(s=c>>4,0===d)s<15?(v=_(s)+(1<<s),x=4):(s=16,x=1);else{if(1!==d)throw new Error("invalid ACn encoding");y=b(d),x=s?2:3}continue;case 1:case 2:i[h]?i[h]+=(p()<<l)*u:0==--s&&(x=2==x?3:0);break;case 3:i[h]?i[h]+=(p()<<l)*u:(i[h]=y<<l,x=0);break;case 4:i[h]&&(i[h]+=(p()<<l)*u)}r++}4===x&&0==--v&&(x=0)}:function(e,i){var r=w(e.huffmanTableDC),n=0===r?0:b(r);i[0]=e.pred+=n;for(var s=1;s<64;){var o=w(e.huffmanTableAC),a=15&o,h=o>>4;if(0!==a)i[t[s+=h]]=b(a),s++;else{if(h<15)break;s+=16}}};var I,D,L,F,z=0;for(D=1==P?n[0].blocksPerLine*n[0].blocksPerColumn:c*r.mcusPerColumn,s||(s=D);z<D;){for(C=0;C<P;C++)n[C].pred=0;if(v=0,1==P)for(E=n[0],T=0;T<s;T++)k(E,R,z),z++;else for(T=0;T<s;T++){for(C=0;C<P;C++)for(L=(E=n[C]).h,F=E.v,S=0;S<F;S++)for(A=0;A<L;A++)M(E,R,z,S,A);if(++z===D)break}if(z===D)do{if(255===e[i]&&0!==e[i+1])break;i+=1}while(i<e.length-2);if(m=0,(I=e[i]<<8|e[i+1])<65280)throw new Error("marker was not found");if(!(I>=65488&&I<=65495))break;i+=2}return i-f}function d(t,l){var u,c,d=[],f=l.blocksPerLine,g=l.blocksPerColumn,m=f<<3,w=new Int32Array(64),_=new Uint8Array(64);function b(t,u,c){var d,f,g,m,p,w,_,b,y,v,x=l.quantizationTable,M=c;for(v=0;v<64;v++)M[v]=t[v]*x[v];for(v=0;v<8;++v){var k=8*v;0!=M[1+k]||0!=M[2+k]||0!=M[3+k]||0!=M[4+k]||0!=M[5+k]||0!=M[6+k]||0!=M[7+k]?(d=a*M[0+k]+128>>8,f=a*M[4+k]+128>>8,g=M[2+k],m=M[6+k],p=h*(M[1+k]-M[7+k])+128>>8,b=h*(M[1+k]+M[7+k])+128>>8,w=M[3+k]<<4,_=M[5+k]<<4,y=d-f+1>>1,d=d+f+1>>1,f=y,y=g*o+m*s+128>>8,g=g*s-m*o+128>>8,m=y,y=p-_+1>>1,p=p+_+1>>1,_=y,y=b+w+1>>1,w=b-w+1>>1,b=y,y=d-m+1>>1,d=d+m+1>>1,m=y,y=f-g+1>>1,f=f+g+1>>1,g=y,y=p*n+b*r+2048>>12,p=p*r-b*n+2048>>12,b=y,y=w*i+_*e+2048>>12,w=w*e-_*i+2048>>12,_=y,M[0+k]=d+b,M[7+k]=d-b,M[1+k]=f+_,M[6+k]=f-_,M[2+k]=g+w,M[5+k]=g-w,M[3+k]=m+p,M[4+k]=m-p):(y=a*M[0+k]+512>>10,M[0+k]=y,M[1+k]=y,M[2+k]=y,M[3+k]=y,M[4+k]=y,M[5+k]=y,M[6+k]=y,M[7+k]=y)}for(v=0;v<8;++v){var E=v;0!=M[8+E]||0!=M[16+E]||0!=M[24+E]||0!=M[32+E]||0!=M[40+E]||0!=M[48+E]||0!=M[56+E]?(d=a*M[0+E]+2048>>12,f=a*M[32+E]+2048>>12,g=M[16+E],m=M[48+E],p=h*(M[8+E]-M[56+E])+2048>>12,b=h*(M[8+E]+M[56+E])+2048>>12,w=M[24+E],_=M[40+E],y=d-f+1>>1,d=d+f+1>>1,f=y,y=g*o+m*s+2048>>12,g=g*s-m*o+2048>>12,m=y,y=p-_+1>>1,p=p+_+1>>1,_=y,y=b+w+1>>1,w=b-w+1>>1,b=y,y=d-m+1>>1,d=d+m+1>>1,m=y,y=f-g+1>>1,f=f+g+1>>1,g=y,y=p*n+b*r+2048>>12,p=p*r-b*n+2048>>12,b=y,y=w*i+_*e+2048>>12,w=w*e-_*i+2048>>12,_=y,M[0+E]=d+b,M[56+E]=d-b,M[8+E]=f+_,M[48+E]=f-_,M[16+E]=g+w,M[40+E]=g-w,M[24+E]=m+p,M[32+E]=m-p):(y=a*c[v+0]+8192>>14,M[0+E]=y,M[8+E]=y,M[16+E]=y,M[24+E]=y,M[32+E]=y,M[40+E]=y,M[48+E]=y,M[56+E]=y)}for(v=0;v<64;++v){var C=128+(M[v]+8>>4);u[v]=C<0?0:C>255?255:C}}p(m*g*8);for(var y=0;y<g;y++){var v=y<<3;for(u=0;u<8;u++)d.push(new Uint8Array(m));for(var x=0;x<f;x++){b(l.blocks[y][x],_,w);var M=0,k=x<<3;for(c=0;c<8;c++){var E=d[v+c];for(u=0;u<8;u++)E[k+u]=_[M++]}}}return d}function f(t){return t<0?0:t>255?255:t}l.prototype={load:function(t){var e=new XMLHttpRequest;e.open("GET",t,!0),e.responseType="arraybuffer",e.onload=function(){var t=new Uint8Array(e.response||e.mozResponseArrayBuffer);this.parse(t),this.onload&&this.onload()}.bind(this),e.send(null)},parse:function(e){var i=1e3*this.opts.maxResolutionInMP*1e3,r=0;function n(){var t=e[r]<<8|e[r+1];return r+=2,t}function s(t){var e,i,r=1,n=1;for(i in t.components)t.components.hasOwnProperty(i)&&(r<(e=t.components[i]).h&&(r=e.h),n<e.v&&(n=e.v));var s=Math.ceil(t.samplesPerLine/8/r),o=Math.ceil(t.scanLines/8/n);for(i in t.components)if(t.components.hasOwnProperty(i)){e=t.components[i];var a=Math.ceil(Math.ceil(t.samplesPerLine/8)*e.h/r),h=Math.ceil(Math.ceil(t.scanLines/8)*e.v/n),l=s*e.h,u=o*e.v,c=[];p(u*l*256);for(var d=0;d<u;d++){for(var f=[],g=0;g<l;g++)f.push(new Int32Array(64));c.push(f)}e.blocksPerLine=a,e.blocksPerColumn=h,e.blocks=c}t.maxH=r,t.maxV=n,t.mcusPerLine=s,t.mcusPerColumn=o}e.length;var o,a,h,l,f=null,g=null,m=[],w=[],_=[],b=[],y=n(),v=-1;if(this.comments=[],65496!=y)throw new Error("SOI not found");for(y=n();65497!=y;){switch(y){case 65280:break;case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:var x=(h=void 0,l=void 0,h=n(),l=e.subarray(r,r+h-2),r+=l.length,l);if(65534===y){var M=String.fromCharCode.apply(null,x);this.comments.push(M)}65504===y&&74===x[0]&&70===x[1]&&73===x[2]&&70===x[3]&&0===x[4]&&(f={version:{major:x[5],minor:x[6]},densityUnits:x[7],xDensity:x[8]<<8|x[9],yDensity:x[10]<<8|x[11],thumbWidth:x[12],thumbHeight:x[13],thumbData:x.subarray(14,14+3*x[12]*x[13])}),65505===y&&69===x[0]&&120===x[1]&&105===x[2]&&102===x[3]&&0===x[4]&&(this.exifBuffer=x.subarray(5,x.length)),65518===y&&65===x[0]&&100===x[1]&&111===x[2]&&98===x[3]&&101===x[4]&&0===x[5]&&(g={version:x[6],flags0:x[7]<<8|x[8],flags1:x[9]<<8|x[10],transformCode:x[11]});break;case 65499:for(var k=n()+r-2;r<k;){var E=e[r++];p(256);var C=new Int32Array(64);if(E>>4==0)for(K=0;K<64;K++)C[t[K]]=e[r++];else{if(E>>4!=1)throw new Error("DQT: invalid table spec");for(K=0;K<64;K++)C[t[K]]=n()}m[15&E]=C}break;case 65472:case 65473:case 65474:n(),(o={}).extended=65473===y,o.progressive=65474===y,o.precision=e[r++],o.scanLines=n(),o.samplesPerLine=n(),o.components={},o.componentsOrder=[];var S=o.scanLines*o.samplesPerLine;if(S>i){var A=Math.ceil((S-i)/1e6);throw new Error(`maxResolutionInMP limit exceeded by ${A}MP`)}var T,R=e[r++];for(q=0;q<R;q++){T=e[r];var P=e[r+1]>>4,I=15&e[r+1],D=e[r+2];if(P<=0||I<=0)throw new Error("Invalid sampling factor, expected values above 0");o.componentsOrder.push(T),o.components[T]={h:P,v:I,quantizationIdx:D},r+=3}s(o),w.push(o);break;case 65476:var L=n();for(q=2;q<L;){var F=e[r++],z=new Uint8Array(16),B=0;for(K=0;K<16;K++,r++)B+=z[K]=e[r];p(16+B);var N=new Uint8Array(B);for(K=0;K<B;K++,r++)N[K]=e[r];q+=17+B,(F>>4==0?b:_)[15&F]=u(z,N)}break;case 65501:n(),a=n();break;case 65500:n(),n();break;case 65498:n();var O=e[r++],U=[];for(q=0;q<O;q++){H=o.components[e[r++]];var V=e[r++];H.huffmanTableDC=b[V>>4],H.huffmanTableAC=_[15&V],U.push(H)}var Y=e[r++],X=e[r++],j=e[r++],G=c(e,r,o,U,a,Y,X,j>>4,15&j,this.opts);r+=G;break;case 65535:255!==e[r]&&r--;break;default:if(255==e[r-3]&&e[r-2]>=192&&e[r-2]<=254){r-=3;break}if(224===y||225==y){if(-1!==v)throw new Error(`first unknown JPEG marker at offset ${v.toString(16)}, second unknown JPEG marker ${y.toString(16)} at offset ${(r-1).toString(16)}`);v=r-1;const t=n();if(255===e[r+t-2]){r+=t-2;break}}throw new Error("unknown JPEG marker "+y.toString(16))}y=n()}if(1!=w.length)throw new Error("only single frame JPEGs supported");for(var q=0;q<w.length;q++){var Z=w[q].components;for(var K in Z)Z[K].quantizationTable=m[Z[K].quantizationIdx],delete Z[K].quantizationIdx}for(this.width=o.samplesPerLine,this.height=o.scanLines,this.jfif=f,this.adobe=g,this.components=[],q=0;q<o.componentsOrder.length;q++){var H=o.components[o.componentsOrder[q]];this.components.push({lines:d(0,H),scaleX:H.h/o.maxH,scaleY:H.v/o.maxV})}},getData:function(t,e){var i,r,n,s,o,a,h,l,u,c,d,g,m,w,_,b,y,v,x,M,k,E=this.width/t,C=this.height/e,S=0,A=t*e*this.components.length;p(A);var T=new Uint8Array(A);switch(this.components.length){case 1:for(i=this.components[0],c=0;c<e;c++)for(o=i.lines[0|c*i.scaleY*C],u=0;u<t;u++)d=o[0|u*i.scaleX*E],T[S++]=d;break;case 2:for(i=this.components[0],r=this.components[1],c=0;c<e;c++)for(o=i.lines[0|c*i.scaleY*C],a=r.lines[0|c*r.scaleY*C],u=0;u<t;u++)d=o[0|u*i.scaleX*E],T[S++]=d,d=a[0|u*r.scaleX*E],T[S++]=d;break;case 3:for(k=!0,this.adobe&&this.adobe.transformCode?k=!0:void 0!==this.opts.colorTransform&&(k=!!this.opts.colorTransform),i=this.components[0],r=this.components[1],n=this.components[2],c=0;c<e;c++)for(o=i.lines[0|c*i.scaleY*C],a=r.lines[0|c*r.scaleY*C],h=n.lines[0|c*n.scaleY*C],u=0;u<t;u++)k?(d=o[0|u*i.scaleX*E],g=a[0|u*r.scaleX*E],v=f(d+1.402*((m=h[0|u*n.scaleX*E])-128)),x=f(d-.3441363*(g-128)-.71413636*(m-128)),M=f(d+1.772*(g-128))):(v=o[0|u*i.scaleX*E],x=a[0|u*r.scaleX*E],M=h[0|u*n.scaleX*E]),T[S++]=v,T[S++]=x,T[S++]=M;break;case 4:if(!this.adobe)throw new Error("Unsupported color mode (4 components)");for(k=!1,this.adobe&&this.adobe.transformCode?k=!0:void 0!==this.opts.colorTransform&&(k=!!this.opts.colorTransform),i=this.components[0],r=this.components[1],n=this.components[2],s=this.components[3],c=0;c<e;c++)for(o=i.lines[0|c*i.scaleY*C],a=r.lines[0|c*r.scaleY*C],h=n.lines[0|c*n.scaleY*C],l=s.lines[0|c*s.scaleY*C],u=0;u<t;u++)k?(d=o[0|u*i.scaleX*E],g=a[0|u*r.scaleX*E],m=h[0|u*n.scaleX*E],w=l[0|u*s.scaleX*E],_=255-f(d+1.402*(m-128)),b=255-f(d-.3441363*(g-128)-.71413636*(m-128)),y=255-f(d+1.772*(g-128))):(_=o[0|u*i.scaleX*E],b=a[0|u*r.scaleX*E],y=h[0|u*n.scaleX*E],w=l[0|u*s.scaleX*E]),T[S++]=255-_,T[S++]=255-b,T[S++]=255-y,T[S++]=255-w;break;default:throw new Error("Unsupported color mode")}return T},copyToImageData:function(t,e){var i,r,n,s,o,a,h,l,u,c=t.width,d=t.height,g=t.data,m=this.getData(c,d),p=0,w=0;switch(this.components.length){case 1:for(r=0;r<d;r++)for(i=0;i<c;i++)n=m[p++],g[w++]=n,g[w++]=n,g[w++]=n,e&&(g[w++]=255);break;case 3:for(r=0;r<d;r++)for(i=0;i<c;i++)h=m[p++],l=m[p++],u=m[p++],g[w++]=h,g[w++]=l,g[w++]=u,e&&(g[w++]=255);break;case 4:for(r=0;r<d;r++)for(i=0;i<c;i++)o=m[p++],a=m[p++],n=m[p++],h=255-f(o*(1-(s=m[p++])/255)+s),l=255-f(a*(1-s/255)+s),u=255-f(n*(1-s/255)+s),g[w++]=h,g[w++]=l,g[w++]=u,e&&(g[w++]=255);break;default:throw new Error("Unsupported color mode")}}};var g=0,m=0;function p(t=0){var e=g+t;if(e>m){var i=Math.ceil((e-m)/1024/1024);throw new Error(`maxMemoryUsageInMB limit exceeded by at least ${i}MB`)}g=e}return l.resetMaxMemoryUsage=function(t){g=0,m=t},l.getBytesAllocated=function(){return g},l.requestMemoryAllocation=p,l}();t.exports=function(t,i={}){var r={colorTransform:void 0,useTArray:!1,formatAsRGBA:!0,tolerantDecoding:!0,maxResolutionInMP:100,maxMemoryUsageInMB:512,...i},n=new Uint8Array(t),s=new e;s.opts=r,e.resetMaxMemoryUsage(1024*r.maxMemoryUsageInMB*1024),s.parse(n);var o=r.formatAsRGBA?4:3,a=s.width*s.height*o;try{e.requestMemoryAllocation(a);var h={width:s.width,height:s.height,exifBuffer:s.exifBuffer,data:r.useTArray?new Uint8Array(a):Buffer.alloc(a)};s.comments.length>0&&(h.comments=s.comments)}catch(t){if(t instanceof RangeError)throw new Error("Could not allocate enough memory for the image. Required: "+a);if(t instanceof ReferenceError&&"Buffer is not defined"===t.message)throw new Error("Buffer is not globally defined in this environment. Consider setting useTArray to true");throw t}return s.copyToImageData(h,r.formatAsRGBA),h}},587:t=>{function e(t){Math.round;var e,i,r,n,s,o=Math.floor,a=new Array(64),h=new Array(64),l=new Array(64),u=new Array(64),c=new Array(65535),d=new Array(65535),f=new Array(64),g=new Array(64),m=[],p=0,w=7,_=new Array(64),b=new Array(64),y=new Array(64),v=new Array(256),x=new Array(2048),M=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],k=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],E=[0,1,2,3,4,5,6,7,8,9,10,11],C=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],S=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],A=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],T=[0,1,2,3,4,5,6,7,8,9,10,11],R=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],P=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function I(t,e){for(var i=0,r=0,n=new Array,s=1;s<=16;s++){for(var o=1;o<=t[s];o++)n[e[r]]=[],n[e[r]][0]=i,n[e[r]][1]=s,r++,i++;i*=2}return n}function D(t){for(var e=t[0],i=t[1]-1;i>=0;)e&1<<i&&(p|=1<<w),i--,--w<0&&(255==p?(L(255),L(0)):L(p),w=7,p=0)}function L(t){m.push(t)}function F(t){L(t>>8&255),L(255&t)}function z(t,e,i,r,n){for(var s,o=n[0],a=n[240],h=function(t,e){var i,r,n,s,o,a,h,l,u,c,d=0;for(u=0;u<8;++u){i=t[d],r=t[d+1],n=t[d+2],s=t[d+3],o=t[d+4],a=t[d+5],h=t[d+6];var g=i+(l=t[d+7]),m=i-l,p=r+h,w=r-h,_=n+a,b=n-a,y=s+o,v=s-o,x=g+y,M=g-y,k=p+_,E=p-_;t[d]=x+k,t[d+4]=x-k;var C=.707106781*(E+M);t[d+2]=M+C,t[d+6]=M-C;var S=.382683433*((x=v+b)-(E=w+m)),A=.5411961*x+S,T=1.306562965*E+S,R=.707106781*(k=b+w),P=m+R,I=m-R;t[d+5]=I+A,t[d+3]=I-A,t[d+1]=P+T,t[d+7]=P-T,d+=8}for(d=0,u=0;u<8;++u){i=t[d],r=t[d+8],n=t[d+16],s=t[d+24],o=t[d+32],a=t[d+40],h=t[d+48];var D=i+(l=t[d+56]),L=i-l,F=r+h,z=r-h,B=n+a,N=n-a,O=s+o,U=s-o,V=D+O,Y=D-O,X=F+B,j=F-B;t[d]=V+X,t[d+32]=V-X;var G=.707106781*(j+Y);t[d+16]=Y+G,t[d+48]=Y-G;var q=.382683433*((V=U+N)-(j=z+L)),Z=.5411961*V+q,K=1.306562965*j+q,H=.707106781*(X=N+z),W=L+H,$=L-H;t[d+40]=$+Z,t[d+24]=$-Z,t[d+8]=W+K,t[d+56]=W-K,d++}for(u=0;u<64;++u)c=t[u]*e[u],f[u]=c>0?c+.5|0:c-.5|0;return f}(t,e),l=0;l<64;++l)g[M[l]]=h[l];var u=g[0]-i;i=g[0],0==u?D(r[0]):(D(r[d[s=32767+u]]),D(c[s]));for(var m=63;m>0&&0==g[m];m--);if(0==m)return D(o),i;for(var p,w=1;w<=m;){for(var _=w;0==g[w]&&w<=m;++w);var b=w-_;if(b>=16){p=b>>4;for(var y=1;y<=p;++y)D(a);b&=15}s=32767+g[w],D(n[(b<<4)+d[s]]),D(c[s]),w++}return 63!=m&&D(o),i}function B(t){t<=0&&(t=1),t>100&&(t=100),s!=t&&(function(t){for(var e=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],i=0;i<64;i++){var r=o((e[i]*t+50)/100);r<1?r=1:r>255&&(r=255),a[M[i]]=r}for(var n=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],s=0;s<64;s++){var c=o((n[s]*t+50)/100);c<1?c=1:c>255&&(c=255),h[M[s]]=c}for(var d=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],f=0,g=0;g<8;g++)for(var m=0;m<8;m++)l[f]=1/(a[M[f]]*d[g]*d[m]*8),u[f]=1/(h[M[f]]*d[g]*d[m]*8),f++}(t<50?Math.floor(5e3/t):Math.floor(200-2*t)),s=t)}this.encode=function(t,s){var o;(new Date).getTime(),s&&B(s),m=new Array,p=0,w=7,F(65496),F(65504),F(16),L(74),L(70),L(73),L(70),L(0),L(1),L(1),L(0),F(1),F(1),L(0),L(0),void 0!==(o=t.comments)&&o.constructor===Array&&o.forEach((t=>{if("string"==typeof t){F(65534);var e,i=t.length;for(F(i+2),e=0;e<i;e++)L(t.charCodeAt(e))}})),function(t){if(t){F(65505),69===t[0]&&120===t[1]&&105===t[2]&&102===t[3]?F(t.length+2):(F(t.length+5+2),L(69),L(120),L(105),L(102),L(0));for(var e=0;e<t.length;e++)L(t[e])}}(t.exifBuffer),function(){F(65499),F(132),L(0);for(var t=0;t<64;t++)L(a[t]);L(1);for(var e=0;e<64;e++)L(h[e])}(),function(t,e){F(65472),F(17),L(8),F(e),F(t),L(3),L(1),L(17),L(0),L(2),L(17),L(1),L(3),L(17),L(1)}(t.width,t.height),function(){F(65476),F(418),L(0);for(var t=0;t<16;t++)L(k[t+1]);for(var e=0;e<=11;e++)L(E[e]);L(16);for(var i=0;i<16;i++)L(C[i+1]);for(var r=0;r<=161;r++)L(S[r]);L(1);for(var n=0;n<16;n++)L(A[n+1]);for(var s=0;s<=11;s++)L(T[s]);L(17);for(var o=0;o<16;o++)L(R[o+1]);for(var a=0;a<=161;a++)L(P[a])}(),F(65498),F(12),L(3),L(1),L(0),L(2),L(17),L(3),L(17),L(0),L(63),L(0);var c=0,d=0,f=0;p=0,w=7,this.encode.displayName="_encode_";for(var g,v,M,I,N,O,U,V,Y,X=t.data,j=t.width,G=t.height,q=4*j,Z=0;Z<G;){for(g=0;g<q;){for(O=N=q*Z+g,U=-1,V=0,Y=0;Y<64;Y++)O=N+(V=Y>>3)*q+(U=4*(7&Y)),Z+V>=G&&(O-=q*(Z+1+V-G)),g+U>=q&&(O-=g+U-q+4),v=X[O++],M=X[O++],I=X[O++],_[Y]=(x[v]+x[M+256>>0]+x[I+512>>0]>>16)-128,b[Y]=(x[v+768>>0]+x[M+1024>>0]+x[I+1280>>0]>>16)-128,y[Y]=(x[v+1280>>0]+x[M+1536>>0]+x[I+1792>>0]>>16)-128;c=z(_,l,c,e,r),d=z(b,u,d,i,n),f=z(y,u,f,i,n),g+=32}Z+=8}if(w>=0){var K=[];K[1]=w+1,K[0]=(1<<w+1)-1,D(K)}return F(65497),Buffer.from(m)},(new Date).getTime(),t||(t=50),function(){for(var t=String.fromCharCode,e=0;e<256;e++)v[e]=t(e)}(),e=I(k,E),i=I(A,T),r=I(C,S),n=I(R,P),function(){for(var t=1,e=2,i=1;i<=15;i++){for(var r=t;r<e;r++)d[32767+r]=i,c[32767+r]=[],c[32767+r][1]=i,c[32767+r][0]=r;for(var n=-(e-1);n<=-t;n++)d[32767+n]=i,c[32767+n]=[],c[32767+n][1]=i,c[32767+n][0]=e-1+n;t<<=1,e<<=1}}(),function(){for(var t=0;t<256;t++)x[t]=19595*t,x[t+256>>0]=38470*t,x[t+512>>0]=7471*t+32768,x[t+768>>0]=-11059*t,x[t+1024>>0]=-21709*t,x[t+1280>>0]=32768*t+8421375,x[t+1536>>0]=-27439*t,x[t+1792>>0]=-5329*t}(),B(t),(new Date).getTime()}t.exports=function(t,i){return void 0===i&&(i=50),{data:new e(i).encode(t,i),width:t.width,height:t.height}}},5307:t=>{t.exports=function t(e,i,r){function n(o,a){if(!i[o]){if(!e[o]){if(s)return s(o,!0);var h=new Error("Cannot find module '"+o+"'");throw h.code="MODULE_NOT_FOUND",h}var l=i[o]={exports:{}};e[o][0].call(l.exports,(function(t){return n(e[o][1][t]||t)}),l,l.exports,t,e,i,r)}return i[o].exports}for(var s=void 0,o=0;o<r.length;o++)n(r[o]);return n}({1:[function(t,e,i){var r,n,s,o,a,h={}.hasOwnProperty;r=t("./PriorityQueue/AbstractPriorityQueue"),n=t("./PriorityQueue/ArrayStrategy"),o=t("./PriorityQueue/BinaryHeapStrategy"),s=t("./PriorityQueue/BHeapStrategy"),(a=function(t){function e(t){t||(t={}),t.strategy||(t.strategy=o),t.comparator||(t.comparator=function(t,e){return(t||0)-(e||0)}),e.__super__.constructor.call(this,t)}return function(t,e){for(var i in e)h.call(e,i)&&(t[i]=e[i]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(e,t),e}(r)).ArrayStrategy=n,a.BinaryHeapStrategy=o,a.BHeapStrategy=s,e.exports=a},{"./PriorityQueue/AbstractPriorityQueue":2,"./PriorityQueue/ArrayStrategy":3,"./PriorityQueue/BHeapStrategy":4,"./PriorityQueue/BinaryHeapStrategy":5}],2:[function(t,e,i){e.exports=function(){function t(t){var e;if(null==(null!=t?t.strategy:void 0))throw"Must pass options.strategy, a strategy";if(null==(null!=t?t.comparator:void 0))throw"Must pass options.comparator, a comparator";this.priv=new t.strategy(t),this.length=(null!=t&&null!=(e=t.initialValues)?e.length:void 0)||0}return t.prototype.queue=function(t){this.length++,this.priv.queue(t)},t.prototype.dequeue=function(t){if(!this.length)throw"Empty queue";return this.length--,this.priv.dequeue()},t.prototype.peek=function(t){if(!this.length)throw"Empty queue";return this.priv.peek()},t.prototype.clear=function(){return this.length=0,this.priv.clear()},t}()},{}],3:[function(t,e,i){var r;r=function(t,e,i){var r,n,s;for(n=0,r=t.length;n<r;)i(t[s=n+r>>>1],e)>=0?n=s+1:r=s;return n},e.exports=function(){function t(t){var e;this.options=t,this.comparator=this.options.comparator,this.data=(null!=(e=this.options.initialValues)?e.slice(0):void 0)||[],this.data.sort(this.comparator).reverse()}return t.prototype.queue=function(t){var e;e=r(this.data,t,this.comparator),this.data.splice(e,0,t)},t.prototype.dequeue=function(){return this.data.pop()},t.prototype.peek=function(){return this.data[this.data.length-1]},t.prototype.clear=function(){this.data.length=0},t}()},{}],4:[function(t,e,i){e.exports=function(){function t(t){var e,i,r,n,s,o,a,h;for(this.comparator=(null!=t?t.comparator:void 0)||function(t,e){return t-e},this.pageSize=(null!=t?t.pageSize:void 0)||512,this.length=0,a=0;1<<a<this.pageSize;)a+=1;if(1<<a!==this.pageSize)throw"pageSize must be a power of two";for(this._shift=a,this._emptyMemoryPageTemplate=e=[],i=0,s=this.pageSize;0<=s?i<s:i>s;0<=s?++i:--i)e.push(null);if(this._memory=[],this._mask=this.pageSize-1,t.initialValues)for(r=0,n=(o=t.initialValues).length;r<n;r++)h=o[r],this.queue(h)}return t.prototype.queue=function(t){this.length+=1,this._write(this.length,t),this._bubbleUp(this.length,t)},t.prototype.dequeue=function(){var t,e;return t=this._read(1),e=this._read(this.length),this.length-=1,this.length>0&&(this._write(1,e),this._bubbleDown(1,e)),t},t.prototype.peek=function(){return this._read(1)},t.prototype.clear=function(){this.length=0,this._memory.length=0},t.prototype._write=function(t,e){var i;for(i=t>>this._shift;i>=this._memory.length;)this._memory.push(this._emptyMemoryPageTemplate.slice(0));return this._memory[i][t&this._mask]=e},t.prototype._read=function(t){return this._memory[t>>this._shift][t&this._mask]},t.prototype._bubbleUp=function(t,e){var i,r,n,s;for(i=this.comparator;t>1&&(r=t&this._mask,t<this.pageSize||r>3?n=t&~this._mask|r>>1:r<2?(n=t-this.pageSize>>this._shift,n+=n&~(this._mask>>1),n|=this.pageSize>>1):n=t-2,!(i(s=this._read(n),e)<0));)this._write(n,e),this._write(t,s),t=n},t.prototype._bubbleDown=function(t,e){var i,r,n,s,o;for(o=this.comparator;t<this.length;)if(t>this._mask&&!(t&this._mask-1)?i=r=t+2:t&this.pageSize>>1?(i=(t&~this._mask)>>1,r=1+(i=1+(i|=t&this._mask>>1)<<this._shift)):r=(i=t+(t&this._mask))+1,i!==r&&r<=this.length)if(n=this._read(i),s=this._read(r),o(n,e)<0&&o(n,s)<=0)this._write(i,e),this._write(t,n),t=i;else{if(!(o(s,e)<0))break;this._write(r,e),this._write(t,s),t=r}else{if(!(i<=this.length))break;if(!(o(n=this._read(i),e)<0))break;this._write(i,e),this._write(t,n),t=i}},t}()},{}],5:[function(t,e,i){e.exports=function(){function t(t){var e;this.comparator=(null!=t?t.comparator:void 0)||function(t,e){return t-e},this.length=0,this.data=(null!=(e=t.initialValues)?e.slice(0):void 0)||[],this._heapify()}return t.prototype._heapify=function(){var t,e,i;if(this.data.length>0)for(t=e=1,i=this.data.length;1<=i?e<i:e>i;t=1<=i?++e:--e)this._bubbleUp(t)},t.prototype.queue=function(t){this.data.push(t),this._bubbleUp(this.data.length-1)},t.prototype.dequeue=function(){var t,e;return e=this.data[0],t=this.data.pop(),this.data.length>0&&(this.data[0]=t,this._bubbleDown(0)),e},t.prototype.peek=function(){return this.data[0]},t.prototype.clear=function(){this.length=0,this.data.length=0},t.prototype._bubbleUp=function(t){for(var e,i;t>0&&(e=t-1>>>1,this.comparator(this.data[t],this.data[e])<0);)i=this.data[e],this.data[e]=this.data[t],this.data[t]=i,t=e},t.prototype._bubbleDown=function(t){var e,i,r,n,s;for(e=this.data.length-1;n=1+(i=1+(t<<1)),r=t,i<=e&&this.comparator(this.data[i],this.data[r])<0&&(r=i),n<=e&&this.comparator(this.data[n],this.data[r])<0&&(r=n),r!==t;)s=this.data[r],this.data[r]=this.data[t],this.data[t]=s,t=r},t}()},{}]},{},[1])(1)},2229:function(t){t.exports=function(){"use strict";function t(t){return"string"==typeof t||t instanceof String}var e=Number.isFinite||window.isFinite;function i(t){return e(t)}function r(t){return t}function n(t,e){if(e.length!==t.length)return!1;for(var i=0;i<t.length;i++){if(e[i].compareArray&&!e[i].compareArray(t[i]))return!1;if(e[i]!==t[i])return!1}return!0}function s(t,e){Object.keys(e).forEach((function(i){t[i]=e[i]}))}function o(){for(var t=1,e=0,i=0;i<arguments.length;i++){var r=arguments[i];e+=l(r),t*=r}return 0!==e?h(t,e):t}function a(t,e){if(0===e)throw new Error("Divide by zero");var i=Math.pow(10,l(e));return o(t,i/(i*e))}function h(t,e){return Math.round(t*Math.pow(10,e))/Math.pow(10,e)}function l(t){if(!isFinite(t))return 0;for(var e=0;t%1!=0;)t*=10,e++;return e}function u(){var t;if(!this)return t=Object.create(u.prototype),u.apply(t,arguments),t;t=Error.apply(this,arguments),this.name="QtyError",this.message=t.message,this.stack=t.stack}function c(t,e){throw new u("Incompatible units: "+t+" and "+e)}u.prototype=Object.create(Error.prototype,{constructor:{value:u}});var d={"<googol>":[["googol"],1e100,"prefix"],"<kibi>":[["Ki","Kibi","kibi"],Math.pow(2,10),"prefix"],"<mebi>":[["Mi","Mebi","mebi"],Math.pow(2,20),"prefix"],"<gibi>":[["Gi","Gibi","gibi"],Math.pow(2,30),"prefix"],"<tebi>":[["Ti","Tebi","tebi"],Math.pow(2,40),"prefix"],"<pebi>":[["Pi","Pebi","pebi"],Math.pow(2,50),"prefix"],"<exi>":[["Ei","Exi","exi"],Math.pow(2,60),"prefix"],"<zebi>":[["Zi","Zebi","zebi"],Math.pow(2,70),"prefix"],"<yebi>":[["Yi","Yebi","yebi"],Math.pow(2,80),"prefix"],"<yotta>":[["Y","Yotta","yotta"],1e24,"prefix"],"<zetta>":[["Z","Zetta","zetta"],1e21,"prefix"],"<exa>":[["E","Exa","exa"],1e18,"prefix"],"<peta>":[["P","Peta","peta"],1e15,"prefix"],"<tera>":[["T","Tera","tera"],1e12,"prefix"],"<giga>":[["G","Giga","giga"],1e9,"prefix"],"<mega>":[["M","Mega","mega"],1e6,"prefix"],"<kilo>":[["k","kilo"],1e3,"prefix"],"<hecto>":[["h","Hecto","hecto"],100,"prefix"],"<deca>":[["da","Deca","deca","deka"],10,"prefix"],"<deci>":[["d","Deci","deci"],.1,"prefix"],"<centi>":[["c","Centi","centi"],.01,"prefix"],"<milli>":[["m","Milli","milli"],.001,"prefix"],"<micro>":[["u","","","Micro","mc","micro"],1e-6,"prefix"],"<nano>":[["n","Nano","nano"],1e-9,"prefix"],"<pico>":[["p","Pico","pico"],1e-12,"prefix"],"<femto>":[["f","Femto","femto"],1e-15,"prefix"],"<atto>":[["a","Atto","atto"],1e-18,"prefix"],"<zepto>":[["z","Zepto","zepto"],1e-21,"prefix"],"<yocto>":[["y","Yocto","yocto"],1e-24,"prefix"],"<1>":[["1","<1>"],1,""],"<meter>":[["m","meter","meters","metre","metres"],1,"length",["<meter>"]],"<inch>":[["in","inch","inches",'"'],.0254,"length",["<meter>"]],"<foot>":[["ft","foot","feet","'"],.3048,"length",["<meter>"]],"<yard>":[["yd","yard","yards"],.9144,"length",["<meter>"]],"<mile>":[["mi","mile","miles"],1609.344,"length",["<meter>"]],"<naut-mile>":[["nmi","naut-mile"],1852,"length",["<meter>"]],"<league>":[["league","leagues"],4828,"length",["<meter>"]],"<furlong>":[["furlong","furlongs"],201.2,"length",["<meter>"]],"<rod>":[["rd","rod","rods"],5.029,"length",["<meter>"]],"<mil>":[["mil","mils"],254e-7,"length",["<meter>"]],"<angstrom>":[["ang","angstrom","angstroms"],1e-10,"length",["<meter>"]],"<fathom>":[["fathom","fathoms"],1.829,"length",["<meter>"]],"<pica>":[["pica","picas"],.00423333333,"length",["<meter>"]],"<point>":[["pt","point","points"],.000352777778,"length",["<meter>"]],"<redshift>":[["z","red-shift","redshift"],1302773e20,"length",["<meter>"]],"<AU>":[["AU","astronomical-unit"],1495979e5,"length",["<meter>"]],"<light-second>":[["ls","light-second"],299792500,"length",["<meter>"]],"<light-minute>":[["lmin","light-minute"],1798755e4,"length",["<meter>"]],"<light-year>":[["ly","light-year"],9460528e9,"length",["<meter>"]],"<parsec>":[["pc","parsec","parsecs"],3085678e10,"length",["<meter>"]],"<datamile>":[["DM","datamile"],1828.8,"length",["<meter>"]],"<kilogram>":[["kg","kilogram","kilograms"],1,"mass",["<kilogram>"]],"<AMU>":[["u","AMU","amu"],1660538921e-36,"mass",["<kilogram>"]],"<dalton>":[["Da","Dalton","Daltons","dalton","daltons"],1660538921e-36,"mass",["<kilogram>"]],"<slug>":[["slug","slugs"],14.5939029,"mass",["<kilogram>"]],"<short-ton>":[["tn","ton","short-ton"],907.18474,"mass",["<kilogram>"]],"<metric-ton>":[["t","tonne","metric-ton"],1e3,"mass",["<kilogram>"]],"<carat>":[["ct","carat","carats"],2e-4,"mass",["<kilogram>"]],"<pound>":[["lbs","lb","pound","pounds","#"],.45359237,"mass",["<kilogram>"]],"<ounce>":[["oz","ounce","ounces"],.0283495231,"mass",["<kilogram>"]],"<gram>":[["g","gram","grams","gramme","grammes"],.001,"mass",["<kilogram>"]],"<grain>":[["grain","grains","gr"],6479891e-11,"mass",["<kilogram>"]],"<dram>":[["dram","drams","dr"],.0017718452,"mass",["<kilogram>"]],"<stone>":[["stone","stones","st"],6.35029318,"mass",["<kilogram>"]],"<hectare>":[["hectare"],1e4,"area",["<meter>","<meter>"]],"<acre>":[["acre","acres"],4046.85642,"area",["<meter>","<meter>"]],"<sqft>":[["sqft"],1,"area",["<foot>","<foot>"]],"<liter>":[["l","L","liter","liters","litre","litres"],.001,"volume",["<meter>","<meter>","<meter>"]],"<gallon>":[["gal","gallon","gallons"],.0037854118,"volume",["<meter>","<meter>","<meter>"]],"<gallon-imp>":[["galimp","gallon-imp","gallons-imp"],.00454609,"volume",["<meter>","<meter>","<meter>"]],"<quart>":[["qt","quart","quarts"],.00094635295,"volume",["<meter>","<meter>","<meter>"]],"<pint>":[["pt","pint","pints"],.000473176475,"volume",["<meter>","<meter>","<meter>"]],"<pint-imp>":[["ptimp","pint-imp","pints-imp"],.00056826125,"volume",["<meter>","<meter>","<meter>"]],"<cup>":[["cu","cup","cups"],.000236588238,"volume",["<meter>","<meter>","<meter>"]],"<fluid-ounce>":[["floz","fluid-ounce","fluid-ounces"],295735297e-13,"volume",["<meter>","<meter>","<meter>"]],"<fluid-ounce-imp>":[["flozimp","floz-imp","fluid-ounce-imp","fluid-ounces-imp"],284130625e-13,"volume",["<meter>","<meter>","<meter>"]],"<tablespoon>":[["tb","tbsp","tbs","tablespoon","tablespoons"],147867648e-13,"volume",["<meter>","<meter>","<meter>"]],"<teaspoon>":[["tsp","teaspoon","teaspoons"],492892161e-14,"volume",["<meter>","<meter>","<meter>"]],"<bushel>":[["bu","bsh","bushel","bushels"],.035239072,"volume",["<meter>","<meter>","<meter>"]],"<oilbarrel>":[["bbl","oilbarrel","oilbarrels","oil-barrel","oil-barrels"],.158987294928,"volume",["<meter>","<meter>","<meter>"]],"<beerbarrel>":[["bl","bl-us","beerbarrel","beerbarrels","beer-barrel","beer-barrels"],.1173477658,"volume",["<meter>","<meter>","<meter>"]],"<beerbarrel-imp>":[["blimp","bl-imp","beerbarrel-imp","beerbarrels-imp","beer-barrel-imp","beer-barrels-imp"],.16365924,"volume",["<meter>","<meter>","<meter>"]],"<kph>":[["kph"],.277777778,"speed",["<meter>"],["<second>"]],"<mph>":[["mph"],.44704,"speed",["<meter>"],["<second>"]],"<knot>":[["kt","kn","kts","knot","knots"],.514444444,"speed",["<meter>"],["<second>"]],"<fps>":[["fps"],.3048,"speed",["<meter>"],["<second>"]],"<gee>":[["gee"],9.80665,"acceleration",["<meter>"],["<second>","<second>"]],"<Gal>":[["Gal"],.01,"acceleration",["<meter>"],["<second>","<second>"]],"<kelvin>":[["degK","kelvin"],1,"temperature",["<kelvin>"]],"<celsius>":[["degC","celsius","celsius","centigrade"],1,"temperature",["<kelvin>"]],"<fahrenheit>":[["degF","fahrenheit"],5/9,"temperature",["<kelvin>"]],"<rankine>":[["degR","rankine"],5/9,"temperature",["<kelvin>"]],"<temp-K>":[["tempK","temp-K"],1,"temperature",["<temp-K>"]],"<temp-C>":[["tempC","temp-C"],1,"temperature",["<temp-K>"]],"<temp-F>":[["tempF","temp-F"],5/9,"temperature",["<temp-K>"]],"<temp-R>":[["tempR","temp-R"],5/9,"temperature",["<temp-K>"]],"<second>":[["s","sec","secs","second","seconds"],1,"time",["<second>"]],"<minute>":[["min","mins","minute","minutes"],60,"time",["<second>"]],"<hour>":[["h","hr","hrs","hour","hours"],3600,"time",["<second>"]],"<day>":[["d","day","days"],86400,"time",["<second>"]],"<week>":[["wk","week","weeks"],604800,"time",["<second>"]],"<fortnight>":[["fortnight","fortnights"],1209600,"time",["<second>"]],"<year>":[["y","yr","year","years","annum"],31556926,"time",["<second>"]],"<decade>":[["decade","decades"],315569260,"time",["<second>"]],"<century>":[["century","centuries"],3155692600,"time",["<second>"]],"<pascal>":[["Pa","pascal","Pascal"],1,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<bar>":[["bar","bars"],1e5,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<mmHg>":[["mmHg"],133.322368,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<inHg>":[["inHg"],3386.3881472,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<torr>":[["torr"],133.322368,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<atm>":[["atm","ATM","atmosphere","atmospheres"],101325,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<psi>":[["psi"],6894.76,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<cmh2o>":[["cmH2O","cmh2o"],98.0638,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<inh2o>":[["inH2O","inh2o"],249.082052,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<poise>":[["P","poise"],.1,"viscosity",["<kilogram>"],["<meter>","<second>"]],"<stokes>":[["St","stokes"],1e-4,"viscosity",["<meter>","<meter>"],["<second>"]],"<mole>":[["mol","mole"],1,"substance",["<mole>"]],"<molar>":[["M","molar"],1e3,"molar_concentration",["<mole>"],["<meter>","<meter>","<meter>"]],"<wtpercent>":[["wt%","wtpercent"],10,"molar_concentration",["<kilogram>"],["<meter>","<meter>","<meter>"]],"<katal>":[["kat","katal","Katal"],1,"activity",["<mole>"],["<second>"]],"<unit>":[["U","enzUnit","unit"],16667e-19,"activity",["<mole>"],["<second>"]],"<farad>":[["F","farad","Farad"],1,"capacitance",["<second>","<second>","<second>","<second>","<ampere>","<ampere>"],["<meter>","<meter>","<kilogram>"]],"<coulomb>":[["C","coulomb","Coulomb"],1,"charge",["<ampere>","<second>"]],"<Ah>":[["Ah"],3600,"charge",["<ampere>","<second>"]],"<ampere>":[["A","Ampere","ampere","amp","amps"],1,"current",["<ampere>"]],"<siemens>":[["S","Siemens","siemens"],1,"conductance",["<second>","<second>","<second>","<ampere>","<ampere>"],["<kilogram>","<meter>","<meter>"]],"<henry>":[["H","Henry","henry"],1,"inductance",["<meter>","<meter>","<kilogram>"],["<second>","<second>","<ampere>","<ampere>"]],"<volt>":[["V","Volt","volt","volts"],1,"potential",["<meter>","<meter>","<kilogram>"],["<second>","<second>","<second>","<ampere>"]],"<ohm>":[["Ohm","ohm","",""],1,"resistance",["<meter>","<meter>","<kilogram>"],["<second>","<second>","<second>","<ampere>","<ampere>"]],"<weber>":[["Wb","weber","webers"],1,"magnetism",["<meter>","<meter>","<kilogram>"],["<second>","<second>","<ampere>"]],"<tesla>":[["T","tesla","teslas"],1,"magnetism",["<kilogram>"],["<second>","<second>","<ampere>"]],"<gauss>":[["G","gauss"],1e-4,"magnetism",["<kilogram>"],["<second>","<second>","<ampere>"]],"<maxwell>":[["Mx","maxwell","maxwells"],1e-8,"magnetism",["<meter>","<meter>","<kilogram>"],["<second>","<second>","<ampere>"]],"<oersted>":[["Oe","oersted","oersteds"],250/Math.PI,"magnetism",["<ampere>"],["<meter>"]],"<joule>":[["J","joule","Joule","joules","Joules"],1,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<erg>":[["erg","ergs"],1e-7,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<btu>":[["BTU","btu","BTUs"],1055.056,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<calorie>":[["cal","calorie","calories"],4.184,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<Calorie>":[["Cal","Calorie","Calories"],4184,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<therm-US>":[["th","therm","therms","Therm","therm-US"],105480400,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<Wh>":[["Wh"],3600,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<electronvolt>":[["eV","electronvolt","electronvolts"],1602176634e-28,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<newton>":[["N","Newton","newton"],1,"force",["<kilogram>","<meter>"],["<second>","<second>"]],"<dyne>":[["dyn","dyne"],1e-5,"force",["<kilogram>","<meter>"],["<second>","<second>"]],"<pound-force>":[["lbf","pound-force"],4.448222,"force",["<kilogram>","<meter>"],["<second>","<second>"]],"<hertz>":[["Hz","hertz","Hertz"],1,"frequency",["<1>"],["<second>"]],"<radian>":[["rad","radian","radians"],1,"angle",["<radian>"]],"<degree>":[["deg","degree","degrees"],Math.PI/180,"angle",["<radian>"]],"<arcminute>":[["arcmin","arcminute","arcminutes"],Math.PI/10800,"angle",["<radian>"]],"<arcsecond>":[["arcsec","arcsecond","arcseconds"],Math.PI/648e3,"angle",["<radian>"]],"<gradian>":[["gon","grad","gradian","grads"],Math.PI/200,"angle",["<radian>"]],"<steradian>":[["sr","steradian","steradians"],1,"solid_angle",["<steradian>"]],"<rotation>":[["rotation"],2*Math.PI,"angle",["<radian>"]],"<rpm>":[["rpm"],2*Math.PI/60,"angular_velocity",["<radian>"],["<second>"]],"<byte>":[["B","byte","bytes"],1,"information",["<byte>"]],"<bit>":[["b","bit","bits"],.125,"information",["<byte>"]],"<Bps>":[["Bps"],1,"information_rate",["<byte>"],["<second>"]],"<bps>":[["bps"],.125,"information_rate",["<byte>"],["<second>"]],"<dollar>":[["USD","dollar"],1,"currency",["<dollar>"]],"<cents>":[["cents"],.01,"currency",["<dollar>"]],"<candela>":[["cd","candela"],1,"luminosity",["<candela>"]],"<lumen>":[["lm","lumen"],1,"luminous_power",["<candela>","<steradian>"]],"<lux>":[["lux"],1,"illuminance",["<candela>","<steradian>"],["<meter>","<meter>"]],"<watt>":[["W","watt","watts"],1,"power",["<kilogram>","<meter>","<meter>"],["<second>","<second>","<second>"]],"<volt-ampere>":[["VA","volt-ampere"],1,"power",["<kilogram>","<meter>","<meter>"],["<second>","<second>","<second>"]],"<volt-ampere-reactive>":[["var","Var","VAr","VAR","volt-ampere-reactive"],1,"power",["<kilogram>","<meter>","<meter>"],["<second>","<second>","<second>"]],"<horsepower>":[["hp","horsepower"],745.699872,"power",["<kilogram>","<meter>","<meter>"],["<second>","<second>","<second>"]],"<gray>":[["Gy","gray","grays"],1,"radiation",["<meter>","<meter>"],["<second>","<second>"]],"<roentgen>":[["R","roentgen"],.00933,"radiation",["<meter>","<meter>"],["<second>","<second>"]],"<sievert>":[["Sv","sievert","sieverts"],1,"radiation",["<meter>","<meter>"],["<second>","<second>"]],"<becquerel>":[["Bq","becquerel","becquerels"],1,"radiation",["<1>"],["<second>"]],"<curie>":[["Ci","curie","curies"],37e9,"radiation",["<1>"],["<second>"]],"<cpm>":[["cpm"],1/60,"rate",["<count>"],["<second>"]],"<dpm>":[["dpm"],1/60,"rate",["<count>"],["<second>"]],"<bpm>":[["bpm"],1/60,"rate",["<count>"],["<second>"]],"<dot>":[["dot","dots"],1,"resolution",["<each>"]],"<pixel>":[["pixel","px"],1,"resolution",["<each>"]],"<ppi>":[["ppi"],1,"resolution",["<pixel>"],["<inch>"]],"<dpi>":[["dpi"],1,"typography",["<dot>"],["<inch>"]],"<cell>":[["cells","cell"],1,"counting",["<each>"]],"<each>":[["each"],1,"counting",["<each>"]],"<count>":[["count"],1,"counting",["<each>"]],"<base-pair>":[["bp","base-pair"],1,"counting",["<each>"]],"<nucleotide>":[["nt","nucleotide"],1,"counting",["<each>"]],"<molecule>":[["molecule","molecules"],1,"counting",["<1>"]],"<dozen>":[["doz","dz","dozen"],12,"prefix_only",["<each>"]],"<percent>":[["%","percent"],.01,"prefix_only",["<1>"]],"<ppm>":[["ppm"],1e-6,"prefix_only",["<1>"]],"<ppb>":[["ppb"],1e-9,"prefix_only",["<1>"]],"<ppt>":[["ppt"],1e-12,"prefix_only",["<1>"]],"<ppq>":[["ppq"],1e-15,"prefix_only",["<1>"]],"<gross>":[["gr","gross"],144,"prefix_only",["<dozen>","<dozen>"]],"<decibel>":[["dB","decibel","decibels"],1,"logarithmic",["<decibel>"]]},f=["<meter>","<kilogram>","<second>","<mole>","<ampere>","<radian>","<kelvin>","<temp-K>","<byte>","<dollar>","<candela>","<each>","<steradian>","<decibel>"],g="<1>",m=[g];function p(t,e){var r=e[1],n=e[3]||[],s=e[4]||[];if(!i(r))throw new u(t+": Invalid unit definition. 'scalar' must be a number");n.forEach((function(e){if(void 0===d[e])throw new u(t+": Invalid unit definition. Unit "+e+" in 'numerator' is not recognized")})),s.forEach((function(e){if(void 0===d[e])throw new u(t+": Invalid unit definition. Unit "+e+" in 'denominator' is not recognized")}))}var w={},_={},b={},y={},v={};for(var x in d)if(d.hasOwnProperty(x)){var M=d[x];if("prefix"===M[2]){w[x]=M[1];for(var k=0;k<M[0].length;k++)_[M[0][k]]=x}else{p(x,M),b[x]={scalar:M[1],numerator:M[3],denominator:M[4]};for(var E=0;E<M[0].length;E++)y[M[0][E]]=x}v[x]=M[0][0]}var C=["length","time","temperature","mass","current","substance","luminosity","currency","information","angle"];function S(){if(this.signature)return this.signature;for(var t=A.call(this),e=0;e<t.length;e++)t[e]*=Math.pow(20,e);return t.reduce((function(t,e){return t+e}),0)}function A(){if(!this.isBase())return A.call(this.toBase());for(var t,e,i=new Array(C.length),r=0;r<i.length;r++)i[r]=0;for(var n=0;n<this.numerator.length;n++)(t=d[this.numerator[n]])&&(e=C.indexOf(t[2]))>=0&&(i[e]=i[e]+1);for(var s=0;s<this.denominator.length;s++)(t=d[this.denominator[s]])&&(e=C.indexOf(t[2]))>=0&&(i[e]=i[e]-1);return i}var T=new RegExp("^([+-]?\\s*(?:(?:\\d+(?:\\.\\d+)?)|(?:\\.\\d+))(?:[Ee][+-]?\\d+)?)?\\s*([^/]*)(?:/(.+))?$"),R="\\^|\\*{2}",P="[01234]",I=new RegExp("([^ \\*\\d]+?)(?:"+R+")?(-?"+P+"(?![a-zA-Z]))"),D=new RegExp("([^ \\*\\d]+?)(?:"+R+")?("+P+"(?![a-zA-Z]))");function L(e){t(e)||(e=e.toString()),e=e.trim();var i=T.exec(e);if(!i)throw new u(e+": Quantity not recognized");var r=i[1];r?(r=r.replace(/\s/g,""),this.scalar=parseFloat(r)):this.scalar=1;for(var n,s,o,a=i[2],h=i[3];i=I.exec(a);){if(n=parseFloat(i[2]),isNaN(n))throw new u("Unit exponent is not a number");if(0===n&&!z.test(i[1]))throw new u("Unit not recognized");s=i[1]+" ",o="";for(var l=0;l<Math.abs(n);l++)o+=s;n>=0?a=a.replace(i[0],o):(h=h?h+o:o,a=a.replace(i[0],""))}for(;i=D.exec(h);){if(n=parseFloat(i[2]),isNaN(n))throw new u("Unit exponent is not a number");if(0===n&&!z.test(i[1]))throw new u("Unit not recognized");s=i[1]+" ",o="";for(var c=0;c<n;c++)o+=s;h=h.replace(i[0],o)}a&&(this.numerator=O(a.trim())),h&&(this.denominator=O(h.trim()))}var F="("+Object.keys(_).sort((function(t,e){return e.length-t.length})).join("|")+")??("+Object.keys(y).sort((function(t,e){return e.length-t.length})).join("|")+")(?:\\b|$)",z=new RegExp("^\\s*("+F+"[\\s\\*]*)+$"),B=new RegExp(F,"g"),N={};function O(t){var e=N[t];if(e)return e;var i,r=[];if(!z.test(t))throw new u("Unit not recognized");for(;i=B.exec(t);)r.push(i.slice(1));return r=(r=(r=r.map((function(t){return _[t[0]]?[_[t[0]],y[t[1]]]:[y[t[1]]]}))).reduce((function(t,e){return t.concat(e)}),[])).filter((function(t){return t})),N[t]=r,r}function U(t){return t instanceof V}function V(t,e){if(Y.apply(null,arguments),!U(this))return new V(t,e);if(this.scalar=null,this.baseScalar=null,this.signature=null,this._conversionCache={},this.numerator=m,this.denominator=m,X(t)?(this.scalar=t.scalar,this.numerator=t.numerator&&0!==t.numerator.length?t.numerator:m,this.denominator=t.denominator&&0!==t.denominator.length?t.denominator:m):e?(L.call(this,e),this.scalar=t):L.call(this,t),this.denominator.join("*").indexOf("temp")>=0)throw new u("Cannot divide with temperatures");if(this.numerator.join("*").indexOf("temp")>=0){if(this.numerator.length>1)throw new u("Cannot multiply by temperatures");if(!n(this.denominator,m))throw new u("Cannot divide with temperatures")}if(this.initValue=t,j.call(this),this.isTemperature()&&this.baseScalar<0)throw new u("Temperatures must not be less than absolute zero")}function Y(e,r){if(r){if(!i(e)||!t(r))throw new u("Only number accepted as initialization value when units are explicitly provided")}else if(!(t(e)||i(e)||U(e)||X(e)))throw new u("Only string, number or quantity accepted as single initialization value")}function X(t){return t&&"object"==typeof t&&t.hasOwnProperty("scalar")}function j(){if(this.baseScalar)return this.baseScalar;if(this.isBase())this.baseScalar=this.scalar,this.signature=S.call(this);else{var t=this.toBase();this.baseScalar=t.scalar,this.signature=t.signature}}V.prototype={constructor:V};var G={"-312078":"elastance","-312058":"resistance","-312038":"inductance","-152058":"potential","-152040":"magnetism","-152038":"magnetism","-7997":"specific_volume","-79":"snap","-59":"jolt","-39":"acceleration","-38":"radiation","-20":"frequency","-19":"speed","-18":"viscosity","-17":"volumetric_flow","-1":"wavenumber",0:"unitless",1:"length",2:"area",3:"volume",20:"time",400:"temperature",7941:"yank",7942:"power",7959:"pressure",7961:"force",7962:"energy",7979:"viscosity",7981:"momentum",7982:"angular_momentum",7997:"density",7998:"area_density",8e3:"mass",152020:"radiation_exposure",159999:"magnetism",16e4:"current",160020:"charge",312058:"conductance",312078:"capacitance",3199980:"activity",3199997:"molar_concentration",32e5:"substance",63999998:"illuminance",64e6:"luminous_power",128e7:"currency",25599999980:"information_rate",256e8:"information",511999999980:"angular_velocity",512e9:"angle"};function q(t,e){var i=e.to(Z(t.units()));return V({scalar:t.scalar+i.scalar,numerator:t.numerator,denominator:t.denominator})}function Z(t){if("tempK"===t)return"degK";if("tempC"===t)return"degC";if("tempF"===t)return"degF";if("tempR"===t)return"degR";throw new u("Unknown type for temp conversion from: "+t)}function K(t,e){var i,r=function(t){var e,i=t.units();if(i.match(/(deg)[CFRK]/))e=t.baseScalar;else if("tempK"===i)e=t.scalar;else if("tempC"===i)e=t.scalar;else if("tempF"===i)e=5*t.scalar/9;else{if("tempR"!==i)throw new u("Unknown type for temp conversion from: "+i);e=5*t.scalar/9}return V({scalar:e,numerator:["<kelvin>"],denominator:m})}(t),n=e.units();if("degK"===n)i=r.scalar;else if("degC"===n)i=r.scalar;else if("degF"===n)i=9*r.scalar/5;else{if("degR"!==n)throw new u("Unknown type for degree conversion to: "+n);i=9*r.scalar/5}return V({scalar:i,numerator:e.numerator,denominator:e.denominator})}V.prototype.kind=function(){return G[this.signature.toString()]},s(V.prototype,{isDegrees:function(){return(null===this.signature||400===this.signature)&&1===this.numerator.length&&n(this.denominator,m)&&(this.numerator[0].match(/<temp-[CFRK]>/)||this.numerator[0].match(/<(kelvin|celsius|rankine|fahrenheit)>/))},isTemperature:function(){return this.isDegrees()&&this.numerator[0].match(/<temp-[CFRK]>/)}}),s(V.prototype,{to:function(e){var i,r;return null==e?this:t(e)?(i=this._conversionCache[e])?i:(r=V(e)).units()===this.units()?this:(this.isCompatible(r)?r=r.isTemperature()?function(t,e){var i,r=e.units();if("tempK"===r)i=t.baseScalar;else if("tempC"===r)i=t.baseScalar-273.15;else if("tempF"===r)i=9*t.baseScalar/5-459.67;else{if("tempR"!==r)throw new u("Unknown type for temp conversion to: "+r);i=9*t.baseScalar/5}return V({scalar:i,numerator:e.numerator,denominator:e.denominator})}(this,r):r.isDegrees()?K(this,r):V({scalar:a(this.baseScalar,r.baseScalar),numerator:r.numerator,denominator:r.denominator}):this.isInverse(r)?r=this.inverse().to(e):c(this.units(),r.units()),this._conversionCache[e]=r,r):this.to(e.units())},toBase:function(){if(this.isBase())return this;if(this.isTemperature())return function(t){var e,i=t.units();if(i.match(/(deg)[CFRK]/))e=t.baseScalar;else if("tempK"===i)e=t.scalar;else if("tempC"===i)e=t.scalar+273.15;else if("tempF"===i)e=5*(t.scalar+459.67)/9;else{if("tempR"!==i)throw new u("Unknown type for temp conversion from: "+i);e=5*t.scalar/9}return V({scalar:e,numerator:["<temp-K>"],denominator:m})}(this);var t=H[this.units()];return t||(t=function(t,e){for(var i,r=[],n=[],s=1,a=0;a<t.length;a++)i=t[a],w[i]?s=o(s,w[i]):b[i]&&(s*=b[i].scalar,b[i].numerator&&r.push(b[i].numerator),b[i].denominator&&n.push(b[i].denominator));for(var h=0;h<e.length;h++)i=e[h],w[i]?s/=w[i]:b[i]&&(s/=b[i].scalar,b[i].numerator&&n.push(b[i].numerator),b[i].denominator&&r.push(b[i].denominator));return V({scalar:s,numerator:r=r.reduce((function(t,e){return t.concat(e)}),[]),denominator:n=n.reduce((function(t,e){return t.concat(e)}),[])})}(this.numerator,this.denominator),H[this.units()]=t),t.mul(this.scalar)},toFloat:function(){if(this.isUnitless())return this.scalar;throw new u("Can't convert to Float unless unitless.  Use Unit#scalar")},toPrec:function(e){if(t(e)&&(e=V(e)),i(e)&&(e=V(e+" "+this.units())),this.isUnitless()?e.isUnitless()||c(this.units(),e.units()):e=e.to(this.units()),0===e.scalar)throw new u("Divide by zero");return V(o(Math.round(this.scalar/e.scalar),e.scalar)+this.units())}});var H={};function W(t,e,i,r){function n(t){return t!==g}t=t.filter(n),i=i.filter(n),e=e.filter(n),r=r.filter(n);var s={};function o(t,e){for(var i,r,n,o=0;o<t.length;o++)if(w[t[o]]?(i=t[o+1],r=t[o],n=w[r],o++):(i=t[o],r=null,n=1),i&&i!==g)if(s[i]){s[i][0]+=e;var h=s[i][2]?w[s[i][2]]:1;s[i][1===e?3:4]*=a(n,h)}else s[i]=[e,i,r,1,1]}o(t,1),o(e,-1),o(i,1),o(r,-1);var h=[],l=[],u=1;for(var c in s)if(s.hasOwnProperty(c)){var d,f=s[c];if(f[0]>0)for(d=0;d<f[0];d++)h.push(null===f[2]?f[1]:[f[2],f[1]]);else if(f[0]<0)for(d=0;d<-f[0];d++)l.push(null===f[2]?f[1]:[f[2],f[1]]);u*=a(f[3],f[4])}return 0===h.length&&(h=m),0===l.length&&(l=m),[h=h.reduce((function(t,e){return t.concat(e)}),[]),l=l.reduce((function(t,e){return t.concat(e)}),[]),u]}function $(){}V.parse=function(e){if(!t(e))throw new u("Argument should be a string");try{return this(e)}catch(t){return null}},V.getUnits=function(t){var e,i=[],r=Object.keys(d);if(void 0===t)for(e=0;e<r.length;e++)-1===["","prefix"].indexOf(d[r[e]][2])&&i.push(r[e].substr(1,r[e].length-2));else{if(-1===this.getKinds().indexOf(t))throw new u("Kind not recognized");for(e=0;e<r.length;e++)d[r[e]][2]===t&&i.push(r[e].substr(1,r[e].length-2))}return i.sort((function(t,e){return t.toLowerCase()<e.toLowerCase()?-1:t.toLowerCase()>e.toLowerCase()?1:0}))},V.getAliases=function(t){if(!y[t])throw new u("Unit not recognized");return d[y[t]][0]},V.mulSafe=o,V.divSafe=a,V.getKinds=function(){return t=Object.keys(G).map((function(t){return G[t]})),e={},t.filter((function(t){return!e.hasOwnProperty(t)&&(e[t]=!0)}));var t,e},V.swiftConverter=function(t,e){var i,n=V(t),s=V(e);return n.eq(s)?r:(i=n.isTemperature()?function(t){return n.mul(t).to(s).scalar}:function(t){return t*n.baseScalar/s.baseScalar},function(t){var e,r,n;if(Array.isArray(t)){for(r=t.length,n=[],e=0;e<r;e++)n.push(i(t[e]));return n}return i(t)})},V.Error=u,s(V.prototype,{add:function(e){if(t(e)&&(e=V(e)),this.isCompatible(e)||c(this.units(),e.units()),this.isTemperature()&&e.isTemperature())throw new u("Cannot add two temperatures");return this.isTemperature()?q(this,e):e.isTemperature()?q(e,this):V({scalar:this.scalar+e.to(this).scalar,numerator:this.numerator,denominator:this.denominator})},sub:function(e){if(t(e)&&(e=V(e)),this.isCompatible(e)||c(this.units(),e.units()),this.isTemperature()&&e.isTemperature())return r=e,n=(i=this).units(),s=r.to(n),o=V(Z(n)),V({scalar:i.scalar-s.scalar,numerator:o.numerator,denominator:o.denominator});var i,r,n,s,o,a,h;if(this.isTemperature())return a=this,h=e.to(Z(a.units())),V({scalar:a.scalar-h.scalar,numerator:a.numerator,denominator:a.denominator});if(e.isTemperature())throw new u("Cannot subtract a temperature from a differential degree unit");return V({scalar:this.scalar-e.to(this).scalar,numerator:this.numerator,denominator:this.denominator})},mul:function(e){if(i(e))return V({scalar:o(this.scalar,e),numerator:this.numerator,denominator:this.denominator});if(t(e)&&(e=V(e)),(this.isTemperature()||e.isTemperature())&&!this.isUnitless()&&!e.isUnitless())throw new u("Cannot multiply by temperatures");var r=this,n=e;r.isCompatible(n)&&400!==r.signature&&(n=n.to(r));var s=W(r.numerator,r.denominator,n.numerator,n.denominator);return V({scalar:o(r.scalar,n.scalar,s[2]),numerator:s[0],denominator:s[1]})},div:function(e){if(i(e)){if(0===e)throw new u("Divide by zero");return V({scalar:this.scalar/e,numerator:this.numerator,denominator:this.denominator})}if(t(e)&&(e=V(e)),0===e.scalar)throw new u("Divide by zero");if(e.isTemperature())throw new u("Cannot divide with temperatures");if(this.isTemperature()&&!e.isUnitless())throw new u("Cannot divide with temperatures");var r=this,n=e;r.isCompatible(n)&&400!==r.signature&&(n=n.to(r));var s=W(r.numerator,r.denominator,n.denominator,n.numerator);return V({scalar:o(r.scalar,s[2])/n.scalar,numerator:s[0],denominator:s[1]})},inverse:function(){if(this.isTemperature())throw new u("Cannot divide with temperatures");if(0===this.scalar)throw new u("Divide by zero");return V({scalar:1/this.scalar,numerator:this.denominator,denominator:this.numerator})}}),s(V.prototype,{eq:function(t){return 0===this.compareTo(t)},lt:function(t){return-1===this.compareTo(t)},lte:function(t){return this.eq(t)||this.lt(t)},gt:function(t){return 1===this.compareTo(t)},gte:function(t){return this.eq(t)||this.gt(t)},compareTo:function(e){return t(e)?this.compareTo(V(e)):(this.isCompatible(e)||c(this.units(),e.units()),this.baseScalar<e.baseScalar?-1:this.baseScalar===e.baseScalar?0:this.baseScalar>e.baseScalar?1:void 0)},same:function(t){return this.scalar===t.scalar&&this.units()===t.units()}}),s(V.prototype,{isUnitless:function(){return[this.numerator,this.denominator].every((function(t){return n(t,m)}))},isCompatible:function(e){return t(e)?this.isCompatible(V(e)):!!U(e)&&void 0!==e.signature&&this.signature===e.signature},isInverse:function(t){return this.inverse().isCompatible(t)},isBase:function(){return void 0!==this._isBase?this._isBase:this.isDegrees()&&this.numerator[0].match(/<(kelvin|temp-K)>/)?(this._isBase=!0,this._isBase):(this.numerator.concat(this.denominator).forEach((function(t){t!==g&&-1===f.indexOf(t)&&(this._isBase=!1)}),this),!1===this._isBase||(this._isBase=!0),this._isBase)}}),$.prototype.get=function(t){return arguments.length>1&&(t=Array.apply(null,arguments)),t.reduce((function(e,i,r){if(e){var n=e[i];return r===t.length-1?n?n.data:void 0:n}}),this)},$.prototype.set=function(t,e){return arguments.length>2&&(t=Array.prototype.slice.call(arguments,0,-1),e=arguments[arguments.length-1]),t.reduce((function(i,r,n){var s=i[r];return void 0===s&&(s=i[r]={}),n===t.length-1?(s.data=e,e):s}),this)},V.formatter=function(t,e){return(t+" "+e).trim()},s(V.prototype,{units:function(){if(void 0!==this._units)return this._units;var t=n(this.numerator,m),e=n(this.denominator,m);if(t&&e)return this._units="",this._units;var i=J(this.numerator),r=J(this.denominator);return this._units=i+(e?"":"/"+r),this._units},toString:function(e,r){var n;if(i(e))n=this.units(),r=e;else if(t(e))n=e;else if(U(e))return this.toPrec(e).toString(r);var s=this.to(n);return((void 0!==r?h(s.scalar,r):s.scalar)+" "+s.units()).trim()},format:function(t,e){1===arguments.length&&"function"==typeof t&&(e=t,t=void 0),e=e||V.formatter;var i=this.to(t);return e.call(this,i.scalar,i.units())}});var Q=new $;function J(t){var e=Q.get(t);return e||(e=n(t,m)?"1":function(t){return t.reduce((function(t,e){var i=t[e];return i||t.push(i=t[e]=[e,0]),i[1]++,t}),[]).map((function(t){return t[0]+(t[1]>1?t[1]:"")}))}(function(t){for(var e,i,r=[],n=0;n<t.length;n++)e=t[n],i=t[n+1],w[e]?(r.push(v[e]+v[i]),n++):r.push(v[e]);return r}(t)).join("*"),Q.set(t,e),e)}return V.version="1.8.0",V}()},5520:t=>{!function(){function e(t){for(var e=0,n=t.length-1,s=void 0,o=void 0,a=void 0,h=r(e,n);;){if(n<=e)return t[h];if(n==e+1)return t[e]>t[n]&&i(t,e,n),t[h];for(t[s=r(e,n)]>t[n]&&i(t,s,n),t[e]>t[n]&&i(t,e,n),t[s]>t[e]&&i(t,s,e),i(t,s,e+1),o=e+1,a=n;;){do{o++}while(t[e]>t[o]);do{a--}while(t[a]>t[e]);if(a<o)break;i(t,o,a)}i(t,e,a),a<=h&&(e=o),a>=h&&(n=a-1)}}var i=function(t,e,i){var r;return r=[t[i],t[e]],t[e]=r[0],t[i]=r[1],r},r=function(t,e){return~~((t+e)/2)};t.exports?t.exports=e:window.median=e}()},4805:(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>n});var r=i(4091);function n(t){var e,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!(0,r.isAnyArray)(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");if(void 0!==i.output){if(!(0,r.isAnyArray)(i.output))throw new TypeError("output option must be an array if specified");e=i.output}else e=new Array(t.length);var n=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!(0,r.isAnyArray)(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");var i=e.fromIndex,n=void 0===i?0:i,s=e.toIndex,o=void 0===s?t.length:s;if(n<0||n>=t.length||!Number.isInteger(n))throw new Error("fromIndex must be a positive integer smaller than length");if(o<=n||o>t.length||!Number.isInteger(o))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var a=t[n],h=n+1;h<o;h++)t[h]<a&&(a=t[h]);return a}(t),s=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!(0,r.isAnyArray)(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");var i=e.fromIndex,n=void 0===i?0:i,s=e.toIndex,o=void 0===s?t.length:s;if(n<0||n>=t.length||!Number.isInteger(n))throw new Error("fromIndex must be a positive integer smaller than length");if(o<=n||o>t.length||!Number.isInteger(o))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var a=t[n],h=n+1;h<o;h++)t[h]>a&&(a=t[h]);return a}(t);if(n===s)throw new RangeError("minimum and maximum input values are equal. Cannot rescale a constant array");var o=i.min,a=void 0===o?i.autoMinMax?n:0:o,h=i.max,l=void 0===h?i.autoMinMax?s:1:h;if(a>=l)throw new RangeError("min option must be smaller than max option");for(var u=(l-a)/(s-n),c=0;c<t.length;c++)e[c]=(t[c]-n)*u+a;return e}},530:t=>{"use strict";function e(t){this.value=t,this.parent=null,this.rank=0}t.exports=class{constructor(){this.nodes=new Map}add(t){var i=this.nodes.get(t);return i||(i=new e(t),this.nodes.set(t,i)),i}union(t,e){const i=this.find(t),r=this.find(e);i!==r&&(i.rank<r.rank?i.parent=r:i.rank>r.rank?r.parent=i:(r.parent=i,i.rank++))}find(t){for(var e=t;null!==e.parent;)e=e.parent;for(var i=t;null!==i.parent;){var r=i;i=i.parent,r.parent=e}return e}connected(t,e){return this.find(t)===this.find(e)}}},4953:(t,e,i)=>{"use strict";function r(t,e){let i=0;for(let r=0;r<t.length;r++)i+=(t[r]-e[r])*(t[r]-e[r]);return i}function n(t,e){return Math.sqrt(r(t,e))}i.r(e),i.d(e,{euclidean:()=>n,squaredEuclidean:()=>r})},7345:(t,e,i)=>{"use strict";var r=i(5571),n={DEBUG:!1,ifft2DArray:function(t,e,i){var n=new Array(e*i),s=e/2,o=2*(i-1);r.init(s);for(var a={re:new Array(s),im:new Array(s)},h=0;h<i;h++){for(var l=s-1;l>=0;l--)a.re[l]=t[2*l*i+h],a.im[l]=t[(2*l+1)*i+h];for(r.bt(a.re,a.im),l=s-1;l>=0;l--)n[2*l*i+h]=a.re[l],n[(2*l+1)*i+h]=a.im[l]}var u=new Array(s*o);r.init(o);var c={re:new Array(o),im:new Array(o)},d=o*s;for(l=0;l<e;l+=2){for(c.re[0]=n[l*i],c.im[0]=n[(l+1)*i],h=1;h<i;h++)c.re[h]=n[l*i+h],c.im[h]=n[(l+1)*i+h],c.re[o-h]=n[l*i+h],c.im[o-h]=-n[(l+1)*i+h];r.bt(c.re,c.im);var f=l/2*o;for(h=o-1;h>=0;h--)u[f+h]=c.re[h]/d}return u},fft2DArray:function(t,e,i,n){Object.assign({},{inplace:!0});var s=i/2+1,o=2*e,a=new Array(o*s);r.init(i);for(var h,l,u,c,d,f={re:new Array(i),im:new Array(i)},g={re:new Array(i),im:new Array(i)},m={re:new Array(i),im:new Array(i)},p=0;p<e/2;p++){h=2*p*i,f.re=t.slice(h,h+i),h=(2*p+1)*i,f.im=t.slice(h,h+i),r.fft1d(f.re,f.im),this.reconstructTwoRealFFT(f,g,m),l=4*p*s,u=(4*p+1)*s,c=(4*p+2)*s,d=(4*p+3)*s;for(var w=s-1;w>=0;w--)a[l+w]=g.re[w],a[u+w]=g.im[w],a[c+w]=m.re[w],a[d+w]=m.im[w]}g=null,m=null;var _=new Array(o*s);r.init(e);for(var b={re:new Array(e),im:new Array(e)},y=s-1;y>=0;y--){for(p=e-1;p>=0;p--)b.re[p]=a[2*p*s+y],b.im[p]=a[(2*p+1)*s+y],isNaN(b.re[p])&&(b.re[p]=0),isNaN(b.im[p])&&(b.im[p]=0);for(r.fft1d(b.re,b.im),p=e-1;p>=0;p--)_[2*p*s+y]=b.re[p],_[(2*p+1)*s+y]=b.im[p]}return _},reconstructTwoRealFFT:function(t,e,i){var r,n,s,o,a,h=t.re.length;e.re[0]=t.re[0],e.im[0]=0,i.re[0]=t.im[0],i.im[0]=0;for(var l=h/2;l>0;l--)a=h-l,r=.5*(t.re[l]-t.re[a]),n=.5*(t.re[l]+t.re[a]),s=.5*(t.im[l]-t.im[a]),o=.5*(t.im[l]+t.im[a]),e.re[l]=n,e.im[l]=s,e.re[a]=n,e.im[a]=-s,i.re[l]=o,i.im[l]=-r,i.re[a]=o,i.im[a]=r},convolute2DI:function(t,e,i,r){for(var n,s,o=0;o<i/2;o++)for(var a=0;a<r;a++)n=t[2*o*r+a]*e[2*o*r+a]-t[(2*o+1)*r+a]*e[(2*o+1)*r+a],s=t[2*o*r+a]*e[(2*o+1)*r+a]+t[(2*o+1)*r+a]*e[2*o*r+a],t[2*o*r+a]=n,t[(2*o+1)*r+a]=s},convolute:function(t,e,i,r,n){for(var s=new Array(r*i),o=0;o<i*r;o++)s[o]=t[o];s=this.fft2DArray(s,i,r);var a,h=e.length,l=e[0].length,u=new Array(r*i);for(o=0;o<r*i;o++)u[o]=0;for(var c=Math.floor((h-1)/2),d=Math.floor((l-1)/2),f=0;f<h;f++){a=(f-c+i)%i;for(var g=0;g<l;g++)u[a*r+(g-d+r)%r]=e[f][g]}u=this.fft2DArray(u,i,r);var m=2*i,p=r/2+1;return this.convolute2DI(s,u,m,p),this.ifft2DArray(s,m,p)},toRadix2:function(t,e,i){var r,n,s,o,a=i,h=e;if(0===i||0!=(i&i-1)){for(a=0;i>>++a!=0;);a=1<<a}if(0===e||0!=(e&e-1)){for(h=0;e>>++h!=0;);h=1<<h}if(h==e&&a==i)return{data:t,rows:e,cols:i};var l=new Array(h*a),u=Math.floor((h-e)/2)-e,c=Math.floor((a-i)/2)-i;for(r=0;r<h;r++)for(s=r*a,o=(r-u)%e*i,n=0;n<a;n++)l[s+n]=t[o+(n-c)%i];return{data:l,rows:h,cols:a}},crop:function(t,e,i,r,n,s){if(e==r&&i==n)return t;Object.assign({},s);var o,a,h,l,u=new Array(n*r),c=Math.floor((e-r)/2),d=Math.floor((i-n)/2);for(h=0;h<r;h++)for(o=h*n,a=(h+c)*i,l=0;l<n;l++)u[o+l]=t[a+(l+d)];return u}};t.exports=n},5571:function(t,e){(function(){var t;(t=e).toString=function(){return"version 0.3.0, released 2013-03"};for(var i=0,r=null,n=null,s={init:function(t){if(0===t||0!=(t&t-1))throw new Error("init: radix-2 required");i=t,s._initArray(),s._makeBitReversalTable(),s._makeCosSinTable()},fft1d:function(t,e){s.fft(t,e,1)},ifft1d:function(t,e){var r=1/i;s.fft(t,e,-1);for(var n=0;n<i;n++)t[n]*=r,e[n]*=r},bt1d:function(t,e){s.fft(t,e,-1)},fft2d:function(t,e){for(var r=[],n=[],o=0,a=0;a<i;a++){o=a*i;for(var h=0;h<i;h++)r[h]=t[h+o],n[h]=e[h+o];s.fft1d(r,n);for(var l=0;l<i;l++)t[l+o]=r[l],e[l+o]=n[l]}for(var u=0;u<i;u++){for(var c=0;c<i;c++)o=u+c*i,r[c]=t[o],n[c]=e[o];s.fft1d(r,n);for(var d=0;d<i;d++)t[o=u+d*i]=r[d],e[o]=n[d]}},ifft2d:function(t,e){for(var r=[],n=[],o=0,a=0;a<i;a++){o=a*i;for(var h=0;h<i;h++)r[h]=t[h+o],n[h]=e[h+o];s.ifft1d(r,n);for(var l=0;l<i;l++)t[l+o]=r[l],e[l+o]=n[l]}for(var u=0;u<i;u++){for(var c=0;c<i;c++)o=u+c*i,r[c]=t[o],n[c]=e[o];s.ifft1d(r,n);for(var d=0;d<i;d++)t[o=u+d*i]=r[d],e[o]=n[d]}},fft:function(t,e,s){for(var o,a,h,l,u,c,d,f,g,m=i>>2,p=0;p<i;p++)p<(l=r[p])&&(u=t[p],t[p]=t[l],t[l]=u,u=e[p],e[p]=e[l],e[l]=u);for(var w=1;w<i;w<<=1){a=0,o=i/(w<<1);for(var _=0;_<w;_++){c=n[a+m],d=s*n[a];for(var b=_;b<i;b+=w<<1)f=c*t[h=b+w]+d*e[h],g=c*e[h]-d*t[h],t[h]=t[b]-f,t[b]+=f,e[h]=e[b]-g,e[b]+=g;a+=o}}},_initArray:function(){r="undefined"!=typeof Uint32Array?new Uint32Array(i):[],n="undefined"!=typeof Float64Array?new Float64Array(1.25*i):[]},_paddingZero:function(){},_makeBitReversalTable:function(){var t=0,e=0,n=0;for(r[0]=0;++t<i;){for(n=i>>1;n<=e;)e-=n,n>>=1;e+=n,r[t]=e}},_makeCosSinTable:function(){var t=i>>1,e=i>>2,r=i>>3,s=t+e,o=Math.sin(Math.PI/i),a=2*o*o,h=Math.sqrt(a*(2-a)),l=n[e]=1,u=n[0]=0;o=2*a;for(var c=1;c<r;c++)a+=o*(l-=a),h-=o*(u+=h),n[c]=u,n[e-c]=l;0!==r&&(n[r]=Math.sqrt(.5));for(var d=0;d<e;d++)n[t-d]=n[d];for(var f=0;f<s;f++)n[f+t]=-n[f]}},o=["init","fft1d","ifft1d","fft2d","ifft2d"],a=0;a<o.length;a++)t[o[a]]=s[o[a]];return t.bt=s.bt1d,t.fft=s.fft1d,t.ifft=s.ifft1d,t}).call(this)},3910:(t,e,i)=>{"use strict";e.FFTUtils=i(7345),i(5571)},8881:(t,e,i)=>{"use strict";const{squaredEuclidean:r}=i(4953),n={sigma:1};t.exports=class{constructor(t){t=Object.assign({},n,t),this.sigma=t.sigma,this.divisor=2*t.sigma*t.sigma}compute(t,e){const i=r(t,e);return Math.exp(-i/this.divisor)}}},4229:t=>{"use strict";const e={degree:1,constant:1,scale:1};t.exports=class{constructor(t){t=Object.assign({},e,t),this.degree=t.degree,this.constant=t.constant,this.scale=t.scale}compute(t,e){for(var i=0,r=0;r<t.length;r++)i+=t[r]*e[r];return Math.pow(this.scale*i+this.constant,this.degree)}}},7613:t=>{"use strict";const e={alpha:.01,constant:-Math.E};t.exports=class{constructor(t){t=Object.assign({},e,t),this.alpha=t.alpha,this.constant=t.constant}compute(t,e){for(var i=0,r=0;r<t.length;r++)i+=t[r]*e[r];return Math.tanh(this.alpha*i+this.constant)}}},6952:(t,e,i)=>{"use strict";const{Matrix:r,MatrixTransposeView:n}=i(8406),s=i(8881),o=i(4229),a=i(7613),h=i(8541),l=i(9176),u=i(3316),c=i(1960),d={gaussian:s,rbf:s,polynomial:o,poly:o,anova:h,cauchy:l,exponential:u,histogram:c,min:c,laplacian:i(8557),multiquadratic:i(8609),rational:i(3029),sigmoid:a,mlp:a};t.exports=class{constructor(t,e){if(this.kernelType=t,"linear"!==t)if("string"==typeof t){t=t.toLowerCase();var i=d[t];if(!i)throw new Error(`unsupported kernel type: ${t}`);this.kernelFunction=new i(e)}else{if("object"!=typeof t||"function"!=typeof t.compute)throw new TypeError("first argument must be a valid kernel type or instance");this.kernelFunction=t}}compute(t,e){if(t=r.checkMatrix(t),e=void 0===e?t:r.checkMatrix(e),"linear"===this.kernelType)return t.mmul(new n(e));const i=new r(t.rows,e.rows);if(t===e)for(let e=0;e<t.rows;e++)for(let r=e;r<t.rows;r++){const n=this.kernelFunction.compute(t.getRow(e),t.getRow(r));i.set(e,r,n),i.set(r,e,n)}else for(let r=0;r<t.rows;r++)for(let n=0;n<e.rows;n++)i.set(r,n,this.kernelFunction.compute(t.getRow(r),e.getRow(n)));return i}}},8541:t=>{"use strict";const e={sigma:1,degree:1};t.exports=class{constructor(t){t=Object.assign({},e,t),this.sigma=t.sigma,this.degree=t.degree}compute(t,e){for(var i=0,r=Math.min(t.length,e.length),n=1;n<=r;++n)i+=Math.pow(Math.exp(-this.sigma*Math.pow(Math.pow(t[n-1],n)-Math.pow(e[n-1],n),2)),this.degree);return i}}},9176:(t,e,i)=>{"use strict";const{squaredEuclidean:r}=i(4953),n={sigma:1};t.exports=class{constructor(t){t=Object.assign({},n,t),this.sigma=t.sigma}compute(t,e){return 1/(1+r(t,e)/(this.sigma*this.sigma))}}},3316:(t,e,i)=>{"use strict";const{euclidean:r}=i(4953),n={sigma:1};t.exports=class{constructor(t){t=Object.assign({},n,t),this.sigma=t.sigma,this.divisor=2*t.sigma*t.sigma}compute(t,e){const i=r(t,e);return Math.exp(-i/this.divisor)}}},1960:t=>{"use strict";t.exports=class{compute(t,e){for(var i=Math.min(t.length,e.length),r=0,n=0;n<i;++n)r+=Math.min(t[n],e[n]);return r}}},8557:(t,e,i)=>{"use strict";const{euclidean:r}=i(4953),n={sigma:1};t.exports=class{constructor(t){t=Object.assign({},n,t),this.sigma=t.sigma}compute(t,e){const i=r(t,e);return Math.exp(-i/this.sigma)}}},8609:(t,e,i)=>{"use strict";const{squaredEuclidean:r}=i(4953),n={constant:1};t.exports=class{constructor(t){t=Object.assign({},n,t),this.constant=t.constant}compute(t,e){return Math.sqrt(r(t,e)+this.constant*this.constant)}}},3029:(t,e,i)=>{"use strict";const{squaredEuclidean:r}=i(4953),n={constant:1};t.exports=class{constructor(t){t=Object.assign({},n,t),this.constant=t.constant}compute(t,e){const i=r(t,e);return 1-i/(i+this.constant)}}},414:(t,e,i)=>{var r=i(3910).FFTUtils;function n(t){var e,i,r=t;if("number"!=typeof t[0]){e=t.length,i=t[0].length,r=new Array(e*i);for(var n=0;n<e;n++)for(var s=0;s<i;s++)r[n*i+s]=t[n][s]}else{var o=Math.sqrt(t.length);Number.isInteger(o)&&(e=o,i=o)}return{data:r,rows:e,cols:i}}t.exports={fft:function(t,e,i){var s,o,a=n(t),h=a.data,l=Object.assign({normalize:!1,divisor:1,rows:a.rows,cols:a.cols},i);if(!l.rows||!l.cols)throw new Error("Invalid number of rows or columns "+s+" "+o);s=l.rows,o=l.cols;var u,c,d=l.divisor,f=e.length,g=e[0].length;if(l.normalize)for(d=0,u=0;u<f;u++)for(c=0;c<g;c++)d+=e[u][c];if(0===d)throw new RangeError("convolution: The divisor is equal to zero");var m=r.toRadix2(h,s,o),p=r.convolute(m.data,e,m.rows,m.cols);if(p=r.crop(p,m.rows,m.cols,s,o),0!=d&&1!=d)for(u=0;u<p.length;u++)p[u]/=d;return p},direct:function(t,e,i){var r,s,o=n(t),a=o.data,h=Object.assign({normalize:!1,divisor:1,rows:o.rows,cols:o.cols},i);if(!h.rows||!h.cols)throw new Error("Invalid number of rows or columns "+r+" "+s);r=h.rows,s=h.cols;var l,u,c,d,f,g,m=h.divisor,p=e.length,w=e[0].length;if(h.normalize)for(m=0,l=0;l<p;l++)for(u=0;u<w;u++)m+=e[l][u];if(0===m)throw new RangeError("convolution: The divisor is equal to zero");var _=new Array(r*s),b=Math.floor(p/2),y=Math.floor(w/2);for(d=0;d<r;d++)for(c=0;c<s;c++){for(f=0,u=0;u<p;u++)for(l=0;l<w;l++)g=e[p-u-1][w-l-1],f+=a[(d+u-b+r)%r*s+(c+l-y+s)%s]*g;_[d*s+c]=f/m}return _},kernelFactory:{LoG:function(t,e,i){var r=1e3;i&&i.factor&&(r=i.factor);var n,s,o,a,h=new Array(e);r*=-1;var l=(e-1)/2,u=2*t*t;for(n=0;n<e;n++)for(h[n]=new Array(e),a=(n-l)*(n-l),s=0;s<e;s++)o=-((s-l)*(s-l)+a)/u,h[n][s]=Math.round(r*(1+o)*Math.exp(o));return h}},matrix2Array:n}},8406:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(4091),n=i(4805);const s=" ".repeat(2),o=" ".repeat(4);function a(t,e={}){const{maxRows:i=15,maxColumns:r=10,maxNumSize:n=8,padMinus:a="auto"}=e;return`${t.constructor.name} {\n${s}[\n${o}${function(t,e,i,r,n){const{rows:s,columns:a}=t,l=Math.min(s,e),u=Math.min(a,i),c=[];if("auto"===n){n=!1;t:for(let e=0;e<l;e++)for(let i=0;i<u;i++)if(t.get(e,i)<0){n=!0;break t}}for(let e=0;e<l;e++){let i=[];for(let s=0;s<u;s++)i.push(h(t.get(e,s),r,n));c.push(`${i.join(" ")}`)}return u!==a&&(c[c.length-1]+=` ... ${a-i} more columns`),l!==s&&c.push(`... ${s-e} more rows`),c.join(`\n${o}`)}(t,i,r,n,a)}\n${s}]\n${s}rows: ${t.rows}\n${s}columns: ${t.columns}\n}`}function h(t,e,i){return(t>=0&&i?` ${l(t,e-1)}`:l(t,e)).padEnd(e)}function l(t,e){let i=t.toString();if(i.length<=e)return i;let r=t.toFixed(e);if(r.length>e&&(r=t.toFixed(Math.max(0,e-(r.length-e)))),r.length<=e&&!r.startsWith("0.000")&&!r.startsWith("-0.000"))return r;let n=t.toExponential(e);return n.length>e&&(n=t.toExponential(Math.max(0,e-(n.length-e)))),n.slice(0)}function u(t,e,i){let r=i?t.rows:t.rows-1;if(e<0||e>r)throw new RangeError("Row index out of range")}function c(t,e,i){let r=i?t.columns:t.columns-1;if(e<0||e>r)throw new RangeError("Column index out of range")}function d(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.columns)throw new RangeError("vector size must be the same as the number of columns");return e}function f(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.rows)throw new RangeError("vector size must be the same as the number of rows");return e}function g(t,e){if(!r.isAnyArray(e))throw new TypeError("row indices must be an array");for(let i=0;i<e.length;i++)if(e[i]<0||e[i]>=t.rows)throw new RangeError("row indices are out of range")}function m(t,e){if(!r.isAnyArray(e))throw new TypeError("column indices must be an array");for(let i=0;i<e.length;i++)if(e[i]<0||e[i]>=t.columns)throw new RangeError("column indices are out of range")}function p(t,e,i,r,n){if(5!==arguments.length)throw new RangeError("expected 4 arguments");if(_("startRow",e),_("endRow",i),_("startColumn",r),_("endColumn",n),e>i||r>n||e<0||e>=t.rows||i<0||i>=t.rows||r<0||r>=t.columns||n<0||n>=t.columns)throw new RangeError("Submatrix indices are out of range")}function w(t,e=0){let i=[];for(let r=0;r<t;r++)i.push(e);return i}function _(t,e){if("number"!=typeof e)throw new TypeError(`${t} must be a number`)}function b(t){if(t.isEmpty())throw new Error("Empty matrix has no elements to index")}class y{static from1DArray(t,e,i){if(t*e!==i.length)throw new RangeError("data length does not match given dimensions");let r=new x(t,e);for(let n=0;n<t;n++)for(let t=0;t<e;t++)r.set(n,t,i[n*e+t]);return r}static rowVector(t){let e=new x(1,t.length);for(let i=0;i<t.length;i++)e.set(0,i,t[i]);return e}static columnVector(t){let e=new x(t.length,1);for(let i=0;i<t.length;i++)e.set(i,0,t[i]);return e}static zeros(t,e){return new x(t,e)}static ones(t,e){return new x(t,e).fill(1)}static rand(t,e,i={}){if("object"!=typeof i)throw new TypeError("options must be an object");const{random:r=Math.random}=i;let n=new x(t,e);for(let i=0;i<t;i++)for(let t=0;t<e;t++)n.set(i,t,r());return n}static randInt(t,e,i={}){if("object"!=typeof i)throw new TypeError("options must be an object");const{min:r=0,max:n=1e3,random:s=Math.random}=i;if(!Number.isInteger(r))throw new TypeError("min must be an integer");if(!Number.isInteger(n))throw new TypeError("max must be an integer");if(r>=n)throw new RangeError("min must be smaller than max");let o=n-r,a=new x(t,e);for(let i=0;i<t;i++)for(let t=0;t<e;t++){let e=r+Math.round(s()*o);a.set(i,t,e)}return a}static eye(t,e,i){void 0===e&&(e=t),void 0===i&&(i=1);let r=Math.min(t,e),n=this.zeros(t,e);for(let t=0;t<r;t++)n.set(t,t,i);return n}static diag(t,e,i){let r=t.length;void 0===e&&(e=r),void 0===i&&(i=e);let n=Math.min(r,e,i),s=this.zeros(e,i);for(let e=0;e<n;e++)s.set(e,e,t[e]);return s}static min(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);let i=t.rows,r=t.columns,n=new x(i,r);for(let s=0;s<i;s++)for(let i=0;i<r;i++)n.set(s,i,Math.min(t.get(s,i),e.get(s,i)));return n}static max(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);let i=t.rows,r=t.columns,n=new this(i,r);for(let s=0;s<i;s++)for(let i=0;i<r;i++)n.set(s,i,Math.max(t.get(s,i),e.get(s,i)));return n}static checkMatrix(t){return y.isMatrix(t)?t:new x(t)}static isMatrix(t){return null!=t&&"Matrix"===t.klass}get size(){return this.rows*this.columns}apply(t){if("function"!=typeof t)throw new TypeError("callback must be a function");for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)t.call(this,e,i);return this}to1DArray(){let t=[];for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)t.push(this.get(e,i));return t}to2DArray(){let t=[];for(let e=0;e<this.rows;e++){t.push([]);for(let i=0;i<this.columns;i++)t[e].push(this.get(e,i))}return t}toJSON(){return this.to2DArray()}isRowVector(){return 1===this.rows}isColumnVector(){return 1===this.columns}isVector(){return 1===this.rows||1===this.columns}isSquare(){return this.rows===this.columns}isEmpty(){return 0===this.rows||0===this.columns}isSymmetric(){if(this.isSquare()){for(let t=0;t<this.rows;t++)for(let e=0;e<=t;e++)if(this.get(t,e)!==this.get(e,t))return!1;return!0}return!1}isDistance(){if(!this.isSymmetric())return!1;for(let t=0;t<this.rows;t++)if(0!==this.get(t,t))return!1;return!0}isEchelonForm(){let t=0,e=0,i=-1,r=!0,n=!1;for(;t<this.rows&&r;){for(e=0,n=!1;e<this.columns&&!1===n;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>i?(n=!0,i=e):(r=!1,n=!0);t++}return r}isReducedEchelonForm(){let t=0,e=0,i=-1,r=!0,n=!1;for(;t<this.rows&&r;){for(e=0,n=!1;e<this.columns&&!1===n;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>i?(n=!0,i=e):(r=!1,n=!0);for(let i=e+1;i<this.rows;i++)0!==this.get(t,i)&&(r=!1);t++}return r}echelonForm(){let t=this.clone(),e=0,i=0;for(;e<t.rows&&i<t.columns;){let r=e;for(let n=e;n<t.rows;n++)t.get(n,i)>t.get(r,i)&&(r=n);if(0===t.get(r,i))i++;else{t.swapRows(e,r);let n=t.get(e,i);for(let r=i;r<t.columns;r++)t.set(e,r,t.get(e,r)/n);for(let r=e+1;r<t.rows;r++){let n=t.get(r,i)/t.get(e,i);t.set(r,i,0);for(let s=i+1;s<t.columns;s++)t.set(r,s,t.get(r,s)-t.get(e,s)*n)}e++,i++}}return t}reducedEchelonForm(){let t=this.echelonForm(),e=t.columns,i=t.rows,r=i-1;for(;r>=0;)if(0===t.maxRow(r))r--;else{let n=0,s=!1;for(;n<i&&!1===s;)1===t.get(r,n)?s=!0:n++;for(let i=0;i<r;i++){let s=t.get(i,n);for(let o=n;o<e;o++){let e=t.get(i,o)-s*t.get(r,o);t.set(i,o,e)}}r--}return t}set(){throw new Error("set method is unimplemented")}get(){throw new Error("get method is unimplemented")}repeat(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{rows:e=1,columns:i=1}=t;if(!Number.isInteger(e)||e<=0)throw new TypeError("rows must be a positive integer");if(!Number.isInteger(i)||i<=0)throw new TypeError("columns must be a positive integer");let r=new x(this.rows*e,this.columns*i);for(let t=0;t<e;t++)for(let e=0;e<i;e++)r.setSubMatrix(this,this.rows*t,this.columns*e);return r}fill(t){for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.set(e,i,t);return this}neg(){return this.mulS(-1)}getRow(t){u(this,t);let e=[];for(let i=0;i<this.columns;i++)e.push(this.get(t,i));return e}getRowVector(t){return x.rowVector(this.getRow(t))}setRow(t,e){u(this,t),e=d(this,e);for(let i=0;i<this.columns;i++)this.set(t,i,e[i]);return this}swapRows(t,e){u(this,t),u(this,e);for(let i=0;i<this.columns;i++){let r=this.get(t,i);this.set(t,i,this.get(e,i)),this.set(e,i,r)}return this}getColumn(t){c(this,t);let e=[];for(let i=0;i<this.rows;i++)e.push(this.get(i,t));return e}getColumnVector(t){return x.columnVector(this.getColumn(t))}setColumn(t,e){c(this,t),e=f(this,e);for(let i=0;i<this.rows;i++)this.set(i,t,e[i]);return this}swapColumns(t,e){c(this,t),c(this,e);for(let i=0;i<this.rows;i++){let r=this.get(i,t);this.set(i,t,this.get(i,e)),this.set(i,e,r)}return this}addRowVector(t){t=d(this,t);for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.set(e,i,this.get(e,i)+t[i]);return this}subRowVector(t){t=d(this,t);for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.set(e,i,this.get(e,i)-t[i]);return this}mulRowVector(t){t=d(this,t);for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.set(e,i,this.get(e,i)*t[i]);return this}divRowVector(t){t=d(this,t);for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.set(e,i,this.get(e,i)/t[i]);return this}addColumnVector(t){t=f(this,t);for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.set(e,i,this.get(e,i)+t[e]);return this}subColumnVector(t){t=f(this,t);for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.set(e,i,this.get(e,i)-t[e]);return this}mulColumnVector(t){t=f(this,t);for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.set(e,i,this.get(e,i)*t[e]);return this}divColumnVector(t){t=f(this,t);for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.set(e,i,this.get(e,i)/t[e]);return this}mulRow(t,e){u(this,t);for(let i=0;i<this.columns;i++)this.set(t,i,this.get(t,i)*e);return this}mulColumn(t,e){c(this,t);for(let i=0;i<this.rows;i++)this.set(i,t,this.get(i,t)*e);return this}max(t){if(this.isEmpty())return NaN;switch(t){case"row":{const t=new Array(this.rows).fill(Number.NEGATIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.get(e,i)>t[e]&&(t[e]=this.get(e,i));return t}case"column":{const t=new Array(this.columns).fill(Number.NEGATIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.get(e,i)>t[i]&&(t[i]=this.get(e,i));return t}case void 0:{let t=this.get(0,0);for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.get(e,i)>t&&(t=this.get(e,i));return t}default:throw new Error(`invalid option: ${t}`)}}maxIndex(){b(this);let t=this.get(0,0),e=[0,0];for(let i=0;i<this.rows;i++)for(let r=0;r<this.columns;r++)this.get(i,r)>t&&(t=this.get(i,r),e[0]=i,e[1]=r);return e}min(t){if(this.isEmpty())return NaN;switch(t){case"row":{const t=new Array(this.rows).fill(Number.POSITIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.get(e,i)<t[e]&&(t[e]=this.get(e,i));return t}case"column":{const t=new Array(this.columns).fill(Number.POSITIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.get(e,i)<t[i]&&(t[i]=this.get(e,i));return t}case void 0:{let t=this.get(0,0);for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.get(e,i)<t&&(t=this.get(e,i));return t}default:throw new Error(`invalid option: ${t}`)}}minIndex(){b(this);let t=this.get(0,0),e=[0,0];for(let i=0;i<this.rows;i++)for(let r=0;r<this.columns;r++)this.get(i,r)<t&&(t=this.get(i,r),e[0]=i,e[1]=r);return e}maxRow(t){if(u(this,t),this.isEmpty())return NaN;let e=this.get(t,0);for(let i=1;i<this.columns;i++)this.get(t,i)>e&&(e=this.get(t,i));return e}maxRowIndex(t){u(this,t),b(this);let e=this.get(t,0),i=[t,0];for(let r=1;r<this.columns;r++)this.get(t,r)>e&&(e=this.get(t,r),i[1]=r);return i}minRow(t){if(u(this,t),this.isEmpty())return NaN;let e=this.get(t,0);for(let i=1;i<this.columns;i++)this.get(t,i)<e&&(e=this.get(t,i));return e}minRowIndex(t){u(this,t),b(this);let e=this.get(t,0),i=[t,0];for(let r=1;r<this.columns;r++)this.get(t,r)<e&&(e=this.get(t,r),i[1]=r);return i}maxColumn(t){if(c(this,t),this.isEmpty())return NaN;let e=this.get(0,t);for(let i=1;i<this.rows;i++)this.get(i,t)>e&&(e=this.get(i,t));return e}maxColumnIndex(t){c(this,t),b(this);let e=this.get(0,t),i=[0,t];for(let r=1;r<this.rows;r++)this.get(r,t)>e&&(e=this.get(r,t),i[0]=r);return i}minColumn(t){if(c(this,t),this.isEmpty())return NaN;let e=this.get(0,t);for(let i=1;i<this.rows;i++)this.get(i,t)<e&&(e=this.get(i,t));return e}minColumnIndex(t){c(this,t),b(this);let e=this.get(0,t),i=[0,t];for(let r=1;r<this.rows;r++)this.get(r,t)<e&&(e=this.get(r,t),i[0]=r);return i}diag(){let t=Math.min(this.rows,this.columns),e=[];for(let i=0;i<t;i++)e.push(this.get(i,i));return e}norm(t="frobenius"){switch(t){case"max":return this.max();case"frobenius":return Math.sqrt(this.dot(this));default:throw new RangeError(`unknown norm type: ${t}`)}}cumulativeSum(){let t=0;for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)t+=this.get(e,i),this.set(e,i,t);return this}dot(t){y.isMatrix(t)&&(t=t.to1DArray());let e=this.to1DArray();if(e.length!==t.length)throw new RangeError("vectors do not have the same size");let i=0;for(let r=0;r<e.length;r++)i+=e[r]*t[r];return i}mmul(t){t=x.checkMatrix(t);let e=this.rows,i=this.columns,r=t.columns,n=new x(e,r),s=new Float64Array(i);for(let o=0;o<r;o++){for(let e=0;e<i;e++)s[e]=t.get(e,o);for(let t=0;t<e;t++){let e=0;for(let r=0;r<i;r++)e+=this.get(t,r)*s[r];n.set(t,o,e)}}return n}strassen2x2(t){t=x.checkMatrix(t);let e=new x(2,2);const i=this.get(0,0),r=t.get(0,0),n=this.get(0,1),s=t.get(0,1),o=this.get(1,0),a=t.get(1,0),h=this.get(1,1),l=t.get(1,1),u=(i+h)*(r+l),c=(o+h)*r,d=i*(s-l),f=h*(a-r),g=(i+n)*l,m=u+f-g+(n-h)*(a+l),p=d+g,w=c+f,_=u-c+d+(o-i)*(r+s);return e.set(0,0,m),e.set(0,1,p),e.set(1,0,w),e.set(1,1,_),e}strassen3x3(t){t=x.checkMatrix(t);let e=new x(3,3);const i=this.get(0,0),r=this.get(0,1),n=this.get(0,2),s=this.get(1,0),o=this.get(1,1),a=this.get(1,2),h=this.get(2,0),l=this.get(2,1),u=this.get(2,2),c=t.get(0,0),d=t.get(0,1),f=t.get(0,2),g=t.get(1,0),m=t.get(1,1),p=t.get(1,2),w=t.get(2,0),_=t.get(2,1),b=t.get(2,2),y=(i-s)*(-d+m),v=(-i+s+o)*(c-d+m),M=(s+o)*(-c+d),k=i*c,E=(-i+h+l)*(c-f+p),C=(-i+h)*(f-p),S=(h+l)*(-c+f),A=(-n+l+u)*(m+w-_),T=(n-u)*(m-_),R=n*w,P=(l+u)*(-w+_),I=(-n+o+a)*(p+w-b),D=(n-a)*(p-b),L=(o+a)*(-w+b),F=k+R+r*g,z=(i+r+n-s-o-l-u)*m+v+M+k+A+R+P,B=k+E+S+(i+r+n-o-a-h-l)*p+R+I+L,N=y+o*(-c+d+g-m-p-w+b)+v+k+R+I+D,O=y+v+M+k+a*_,U=R+I+D+L+s*f,V=k+E+C+l*(-c+f+g-m-p-w+_)+A+T+R,Y=A+T+R+P+h*d,X=k+E+C+S+u*b;return e.set(0,0,F),e.set(0,1,z),e.set(0,2,B),e.set(1,0,N),e.set(1,1,O),e.set(1,2,U),e.set(2,0,V),e.set(2,1,Y),e.set(2,2,X),e}mmulStrassen(t){t=x.checkMatrix(t);let e=this.clone(),i=e.rows,r=e.columns,n=t.rows,s=t.columns;function o(t,e,i){let r=t.rows,n=t.columns;if(r===e&&n===i)return t;{let r=y.zeros(e,i);return r=r.setSubMatrix(t,0,0),r}}r!==n&&console.warn(`Multiplying ${i} x ${r} and ${n} x ${s} matrix: dimensions do not match.`);let a=Math.max(i,n),h=Math.max(r,s);return e=o(e,a,h),function t(e,i,r,n){if(r<=512||n<=512)return e.mmul(i);r%2==1&&n%2==1?(e=o(e,r+1,n+1),i=o(i,r+1,n+1)):r%2==1?(e=o(e,r+1,n),i=o(i,r+1,n)):n%2==1&&(e=o(e,r,n+1),i=o(i,r,n+1));let s=parseInt(e.rows/2,10),a=parseInt(e.columns/2,10),h=e.subMatrix(0,s-1,0,a-1),l=i.subMatrix(0,s-1,0,a-1),u=e.subMatrix(0,s-1,a,e.columns-1),c=i.subMatrix(0,s-1,a,i.columns-1),d=e.subMatrix(s,e.rows-1,0,a-1),f=i.subMatrix(s,i.rows-1,0,a-1),g=e.subMatrix(s,e.rows-1,a,e.columns-1),m=i.subMatrix(s,i.rows-1,a,i.columns-1),p=t(y.add(h,g),y.add(l,m),s,a),w=t(y.add(d,g),l,s,a),_=t(h,y.sub(c,m),s,a),b=t(g,y.sub(f,l),s,a),v=t(y.add(h,u),m,s,a),x=t(y.sub(d,h),y.add(l,c),s,a),M=t(y.sub(u,g),y.add(f,m),s,a),k=y.add(p,b);k.sub(v),k.add(M);let E=y.add(_,v),C=y.add(w,b),S=y.sub(p,w);S.add(_),S.add(x);let A=y.zeros(2*k.rows,2*k.columns);return A=A.setSubMatrix(k,0,0),A=A.setSubMatrix(E,k.rows,0),A=A.setSubMatrix(C,0,k.columns),A=A.setSubMatrix(S,k.rows,k.columns),A.subMatrix(0,r-1,0,n-1)}(e,t=o(t,a,h),a,h)}scaleRows(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{min:e=0,max:i=1}=t;if(!Number.isFinite(e))throw new TypeError("min must be a number");if(!Number.isFinite(i))throw new TypeError("max must be a number");if(e>=i)throw new RangeError("min must be smaller than max");let r=new x(this.rows,this.columns);for(let t=0;t<this.rows;t++){const s=this.getRow(t);s.length>0&&n(s,{min:e,max:i,output:s}),r.setRow(t,s)}return r}scaleColumns(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{min:e=0,max:i=1}=t;if(!Number.isFinite(e))throw new TypeError("min must be a number");if(!Number.isFinite(i))throw new TypeError("max must be a number");if(e>=i)throw new RangeError("min must be smaller than max");let r=new x(this.rows,this.columns);for(let t=0;t<this.columns;t++){const s=this.getColumn(t);s.length&&n(s,{min:e,max:i,output:s}),r.setColumn(t,s)}return r}flipRows(){const t=Math.ceil(this.columns/2);for(let e=0;e<this.rows;e++)for(let i=0;i<t;i++){let t=this.get(e,i),r=this.get(e,this.columns-1-i);this.set(e,i,r),this.set(e,this.columns-1-i,t)}return this}flipColumns(){const t=Math.ceil(this.rows/2);for(let e=0;e<this.columns;e++)for(let i=0;i<t;i++){let t=this.get(i,e),r=this.get(this.rows-1-i,e);this.set(i,e,r),this.set(this.rows-1-i,e,t)}return this}kroneckerProduct(t){t=x.checkMatrix(t);let e=this.rows,i=this.columns,r=t.rows,n=t.columns,s=new x(e*r,i*n);for(let o=0;o<e;o++)for(let e=0;e<i;e++)for(let i=0;i<r;i++)for(let a=0;a<n;a++)s.set(r*o+i,n*e+a,this.get(o,e)*t.get(i,a));return s}kroneckerSum(t){if(t=x.checkMatrix(t),!this.isSquare()||!t.isSquare())throw new Error("Kronecker Sum needs two Square Matrices");let e=this.rows,i=t.rows,r=this.kroneckerProduct(x.eye(i,i)),n=x.eye(e,e).kroneckerProduct(t);return r.add(n)}transpose(){let t=new x(this.columns,this.rows);for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)t.set(i,e,this.get(e,i));return t}sortRows(t=v){for(let e=0;e<this.rows;e++)this.setRow(e,this.getRow(e).sort(t));return this}sortColumns(t=v){for(let e=0;e<this.columns;e++)this.setColumn(e,this.getColumn(e).sort(t));return this}subMatrix(t,e,i,r){p(this,t,e,i,r);let n=new x(e-t+1,r-i+1);for(let s=t;s<=e;s++)for(let e=i;e<=r;e++)n.set(s-t,e-i,this.get(s,e));return n}subMatrixRow(t,e,i){if(void 0===e&&(e=0),void 0===i&&(i=this.columns-1),e>i||e<0||e>=this.columns||i<0||i>=this.columns)throw new RangeError("Argument out of range");let r=new x(t.length,i-e+1);for(let n=0;n<t.length;n++)for(let s=e;s<=i;s++){if(t[n]<0||t[n]>=this.rows)throw new RangeError(`Row index out of range: ${t[n]}`);r.set(n,s-e,this.get(t[n],s))}return r}subMatrixColumn(t,e,i){if(void 0===e&&(e=0),void 0===i&&(i=this.rows-1),e>i||e<0||e>=this.rows||i<0||i>=this.rows)throw new RangeError("Argument out of range");let r=new x(i-e+1,t.length);for(let n=0;n<t.length;n++)for(let s=e;s<=i;s++){if(t[n]<0||t[n]>=this.columns)throw new RangeError(`Column index out of range: ${t[n]}`);r.set(s-e,n,this.get(s,t[n]))}return r}setSubMatrix(t,e,i){if((t=x.checkMatrix(t)).isEmpty())return this;p(this,e,e+t.rows-1,i,i+t.columns-1);for(let r=0;r<t.rows;r++)for(let n=0;n<t.columns;n++)this.set(e+r,i+n,t.get(r,n));return this}selection(t,e){g(this,t),m(this,e);let i=new x(t.length,e.length);for(let r=0;r<t.length;r++){let n=t[r];for(let t=0;t<e.length;t++){let s=e[t];i.set(r,t,this.get(n,s))}}return i}trace(){let t=Math.min(this.rows,this.columns),e=0;for(let i=0;i<t;i++)e+=this.get(i,i);return e}clone(){return this.constructor.copy(this,new x(this.rows,this.columns))}static copy(t,e){for(const[i,r,n]of t.entries())e.set(i,r,n);return e}sum(t){switch(t){case"row":return function(t){let e=w(t.rows);for(let i=0;i<t.rows;++i)for(let r=0;r<t.columns;++r)e[i]+=t.get(i,r);return e}(this);case"column":return function(t){let e=w(t.columns);for(let i=0;i<t.rows;++i)for(let r=0;r<t.columns;++r)e[r]+=t.get(i,r);return e}(this);case void 0:return function(t){let e=0;for(let i=0;i<t.rows;i++)for(let r=0;r<t.columns;r++)e+=t.get(i,r);return e}(this);default:throw new Error(`invalid option: ${t}`)}}product(t){switch(t){case"row":return function(t){let e=w(t.rows,1);for(let i=0;i<t.rows;++i)for(let r=0;r<t.columns;++r)e[i]*=t.get(i,r);return e}(this);case"column":return function(t){let e=w(t.columns,1);for(let i=0;i<t.rows;++i)for(let r=0;r<t.columns;++r)e[r]*=t.get(i,r);return e}(this);case void 0:return function(t){let e=1;for(let i=0;i<t.rows;i++)for(let r=0;r<t.columns;r++)e*=t.get(i,r);return e}(this);default:throw new Error(`invalid option: ${t}`)}}mean(t){const e=this.sum(t);switch(t){case"row":for(let t=0;t<this.rows;t++)e[t]/=this.columns;return e;case"column":for(let t=0;t<this.columns;t++)e[t]/=this.rows;return e;case void 0:return e/this.size;default:throw new Error(`invalid option: ${t}`)}}variance(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw new TypeError("options must be an object");const{unbiased:i=!0,mean:n=this.mean(t)}=e;if("boolean"!=typeof i)throw new TypeError("unbiased must be a boolean");switch(t){case"row":if(!r.isAnyArray(n))throw new TypeError("mean must be an array");return function(t,e,i){const r=t.rows,n=t.columns,s=[];for(let o=0;o<r;o++){let r=0,a=0,h=0;for(let e=0;e<n;e++)h=t.get(o,e)-i[o],r+=h,a+=h*h;e?s.push((a-r*r/n)/(n-1)):s.push((a-r*r/n)/n)}return s}(this,i,n);case"column":if(!r.isAnyArray(n))throw new TypeError("mean must be an array");return function(t,e,i){const r=t.rows,n=t.columns,s=[];for(let o=0;o<n;o++){let n=0,a=0,h=0;for(let e=0;e<r;e++)h=t.get(e,o)-i[o],n+=h,a+=h*h;e?s.push((a-n*n/r)/(r-1)):s.push((a-n*n/r)/r)}return s}(this,i,n);case void 0:if("number"!=typeof n)throw new TypeError("mean must be a number");return function(t,e,i){const r=t.rows,n=t.columns,s=r*n;let o=0,a=0,h=0;for(let e=0;e<r;e++)for(let r=0;r<n;r++)h=t.get(e,r)-i,o+=h,a+=h*h;return e?(a-o*o/s)/(s-1):(a-o*o/s)/s}(this,i,n);default:throw new Error(`invalid option: ${t}`)}}standardDeviation(t,e){"object"==typeof t&&(e=t,t=void 0);const i=this.variance(t,e);if(void 0===t)return Math.sqrt(i);for(let t=0;t<i.length;t++)i[t]=Math.sqrt(i[t]);return i}center(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw new TypeError("options must be an object");const{center:i=this.mean(t)}=e;switch(t){case"row":if(!r.isAnyArray(i))throw new TypeError("center must be an array");return function(t,e){for(let i=0;i<t.rows;i++)for(let r=0;r<t.columns;r++)t.set(i,r,t.get(i,r)-e[i])}(this,i),this;case"column":if(!r.isAnyArray(i))throw new TypeError("center must be an array");return function(t,e){for(let i=0;i<t.rows;i++)for(let r=0;r<t.columns;r++)t.set(i,r,t.get(i,r)-e[r])}(this,i),this;case void 0:if("number"!=typeof i)throw new TypeError("center must be a number");return function(t,e){for(let i=0;i<t.rows;i++)for(let r=0;r<t.columns;r++)t.set(i,r,t.get(i,r)-e)}(this,i),this;default:throw new Error(`invalid option: ${t}`)}}scale(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw new TypeError("options must be an object");let i=e.scale;switch(t){case"row":if(void 0===i)i=function(t){const e=[];for(let i=0;i<t.rows;i++){let r=0;for(let e=0;e<t.columns;e++)r+=Math.pow(t.get(i,e),2)/(t.columns-1);e.push(Math.sqrt(r))}return e}(this);else if(!r.isAnyArray(i))throw new TypeError("scale must be an array");return function(t,e){for(let i=0;i<t.rows;i++)for(let r=0;r<t.columns;r++)t.set(i,r,t.get(i,r)/e[i])}(this,i),this;case"column":if(void 0===i)i=function(t){const e=[];for(let i=0;i<t.columns;i++){let r=0;for(let e=0;e<t.rows;e++)r+=Math.pow(t.get(e,i),2)/(t.rows-1);e.push(Math.sqrt(r))}return e}(this);else if(!r.isAnyArray(i))throw new TypeError("scale must be an array");return function(t,e){for(let i=0;i<t.rows;i++)for(let r=0;r<t.columns;r++)t.set(i,r,t.get(i,r)/e[r])}(this,i),this;case void 0:if(void 0===i)i=function(t){const e=t.size-1;let i=0;for(let r=0;r<t.columns;r++)for(let n=0;n<t.rows;n++)i+=Math.pow(t.get(n,r),2)/e;return Math.sqrt(i)}(this);else if("number"!=typeof i)throw new TypeError("scale must be a number");return function(t,e){for(let i=0;i<t.rows;i++)for(let r=0;r<t.columns;r++)t.set(i,r,t.get(i,r)/e)}(this,i),this;default:throw new Error(`invalid option: ${t}`)}}toString(t){return a(this,t)}[Symbol.iterator](){return this.entries()}*entries(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)yield[t,e,this.get(t,e)]}*values(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)yield this.get(t,e)}}function v(t,e){return t-e}y.prototype.klass="Matrix","undefined"!=typeof Symbol&&(y.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return a(this)}),y.random=y.rand,y.randomInt=y.randInt,y.diagonal=y.diag,y.prototype.diagonal=y.prototype.diag,y.identity=y.eye,y.prototype.negate=y.prototype.neg,y.prototype.tensorProduct=y.prototype.kroneckerProduct;class x extends y{data;#t(t,e){if(this.data=[],!(Number.isInteger(e)&&e>=0))throw new TypeError("nColumns must be a positive integer");for(let i=0;i<t;i++)this.data.push(new Float64Array(e));this.rows=t,this.columns=e}constructor(t,e){if(super(),x.isMatrix(t))this.#t(t.rows,t.columns),x.copy(t,this);else if(Number.isInteger(t)&&t>=0)this.#t(t,e);else{if(!r.isAnyArray(t))throw new TypeError("First argument must be a positive number or an array");{const i=t;if("number"!=typeof(e=(t=i.length)?i[0].length:0))throw new TypeError("Data must be a 2D array with at least one element");this.data=[];for(let r=0;r<t;r++){if(i[r].length!==e)throw new RangeError("Inconsistent array dimensions");if(!i[r].every((t=>"number"==typeof t)))throw new TypeError("Input data contains non-numeric values");this.data.push(Float64Array.from(i[r]))}this.rows=t,this.columns=e}}}set(t,e,i){return this.data[t][e]=i,this}get(t,e){return this.data[t][e]}removeRow(t){return u(this,t),this.data.splice(t,1),this.rows-=1,this}addRow(t,e){return void 0===e&&(e=t,t=this.rows),u(this,t,!0),e=Float64Array.from(d(this,e)),this.data.splice(t,0,e),this.rows+=1,this}removeColumn(t){c(this,t);for(let e=0;e<this.rows;e++){const i=new Float64Array(this.columns-1);for(let r=0;r<t;r++)i[r]=this.data[e][r];for(let r=t+1;r<this.columns;r++)i[r-1]=this.data[e][r];this.data[e]=i}return this.columns-=1,this}addColumn(t,e){void 0===e&&(e=t,t=this.columns),c(this,t,!0),e=f(this,e);for(let i=0;i<this.rows;i++){const r=new Float64Array(this.columns+1);let n=0;for(;n<t;n++)r[n]=this.data[i][n];for(r[n++]=e[i];n<this.columns+1;n++)r[n]=this.data[i][n-1];this.data[i]=r}return this.columns+=1,this}}!function(t,e){t.prototype.add=function(t){return"number"==typeof t?this.addS(t):this.addM(t)},t.prototype.addS=function(t){for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.set(e,i,this.get(e,i)+t);return this},t.prototype.addM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.set(e,i,this.get(e,i)+t.get(e,i));return this},t.add=function(t,i){return new e(t).add(i)},t.prototype.sub=function(t){return"number"==typeof t?this.subS(t):this.subM(t)},t.prototype.subS=function(t){for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.set(e,i,this.get(e,i)-t);return this},t.prototype.subM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.set(e,i,this.get(e,i)-t.get(e,i));return this},t.sub=function(t,i){return new e(t).sub(i)},t.prototype.subtract=t.prototype.sub,t.prototype.subtractS=t.prototype.subS,t.prototype.subtractM=t.prototype.subM,t.subtract=t.sub,t.prototype.mul=function(t){return"number"==typeof t?this.mulS(t):this.mulM(t)},t.prototype.mulS=function(t){for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.set(e,i,this.get(e,i)*t);return this},t.prototype.mulM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.set(e,i,this.get(e,i)*t.get(e,i));return this},t.mul=function(t,i){return new e(t).mul(i)},t.prototype.multiply=t.prototype.mul,t.prototype.multiplyS=t.prototype.mulS,t.prototype.multiplyM=t.prototype.mulM,t.multiply=t.mul,t.prototype.div=function(t){return"number"==typeof t?this.divS(t):this.divM(t)},t.prototype.divS=function(t){for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.set(e,i,this.get(e,i)/t);return this},t.prototype.divM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.set(e,i,this.get(e,i)/t.get(e,i));return this},t.div=function(t,i){return new e(t).div(i)},t.prototype.divide=t.prototype.div,t.prototype.divideS=t.prototype.divS,t.prototype.divideM=t.prototype.divM,t.divide=t.div,t.prototype.mod=function(t){return"number"==typeof t?this.modS(t):this.modM(t)},t.prototype.modS=function(t){for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.set(e,i,this.get(e,i)%t);return this},t.prototype.modM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.set(e,i,this.get(e,i)%t.get(e,i));return this},t.mod=function(t,i){return new e(t).mod(i)},t.prototype.modulus=t.prototype.mod,t.prototype.modulusS=t.prototype.modS,t.prototype.modulusM=t.prototype.modM,t.modulus=t.mod,t.prototype.and=function(t){return"number"==typeof t?this.andS(t):this.andM(t)},t.prototype.andS=function(t){for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.set(e,i,this.get(e,i)&t);return this},t.prototype.andM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.set(e,i,this.get(e,i)&t.get(e,i));return this},t.and=function(t,i){return new e(t).and(i)},t.prototype.or=function(t){return"number"==typeof t?this.orS(t):this.orM(t)},t.prototype.orS=function(t){for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.set(e,i,this.get(e,i)|t);return this},t.prototype.orM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.set(e,i,this.get(e,i)|t.get(e,i));return this},t.or=function(t,i){return new e(t).or(i)},t.prototype.xor=function(t){return"number"==typeof t?this.xorS(t):this.xorM(t)},t.prototype.xorS=function(t){for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.set(e,i,this.get(e,i)^t);return this},t.prototype.xorM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.set(e,i,this.get(e,i)^t.get(e,i));return this},t.xor=function(t,i){return new e(t).xor(i)},t.prototype.leftShift=function(t){return"number"==typeof t?this.leftShiftS(t):this.leftShiftM(t)},t.prototype.leftShiftS=function(t){for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.set(e,i,this.get(e,i)<<t);return this},t.prototype.leftShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.set(e,i,this.get(e,i)<<t.get(e,i));return this},t.leftShift=function(t,i){return new e(t).leftShift(i)},t.prototype.signPropagatingRightShift=function(t){return"number"==typeof t?this.signPropagatingRightShiftS(t):this.signPropagatingRightShiftM(t)},t.prototype.signPropagatingRightShiftS=function(t){for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.set(e,i,this.get(e,i)>>t);return this},t.prototype.signPropagatingRightShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.set(e,i,this.get(e,i)>>t.get(e,i));return this},t.signPropagatingRightShift=function(t,i){return new e(t).signPropagatingRightShift(i)},t.prototype.rightShift=function(t){return"number"==typeof t?this.rightShiftS(t):this.rightShiftM(t)},t.prototype.rightShiftS=function(t){for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.set(e,i,this.get(e,i)>>>t);return this},t.prototype.rightShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.set(e,i,this.get(e,i)>>>t.get(e,i));return this},t.rightShift=function(t,i){return new e(t).rightShift(i)},t.prototype.zeroFillRightShift=t.prototype.rightShift,t.prototype.zeroFillRightShiftS=t.prototype.rightShiftS,t.prototype.zeroFillRightShiftM=t.prototype.rightShiftM,t.zeroFillRightShift=t.rightShift,t.prototype.not=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,~this.get(t,e));return this},t.not=function(t){return new e(t).not()},t.prototype.abs=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.abs(this.get(t,e)));return this},t.abs=function(t){return new e(t).abs()},t.prototype.acos=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.acos(this.get(t,e)));return this},t.acos=function(t){return new e(t).acos()},t.prototype.acosh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.acosh(this.get(t,e)));return this},t.acosh=function(t){return new e(t).acosh()},t.prototype.asin=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.asin(this.get(t,e)));return this},t.asin=function(t){return new e(t).asin()},t.prototype.asinh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.asinh(this.get(t,e)));return this},t.asinh=function(t){return new e(t).asinh()},t.prototype.atan=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.atan(this.get(t,e)));return this},t.atan=function(t){return new e(t).atan()},t.prototype.atanh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.atanh(this.get(t,e)));return this},t.atanh=function(t){return new e(t).atanh()},t.prototype.cbrt=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cbrt(this.get(t,e)));return this},t.cbrt=function(t){return new e(t).cbrt()},t.prototype.ceil=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.ceil(this.get(t,e)));return this},t.ceil=function(t){return new e(t).ceil()},t.prototype.clz32=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.clz32(this.get(t,e)));return this},t.clz32=function(t){return new e(t).clz32()},t.prototype.cos=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cos(this.get(t,e)));return this},t.cos=function(t){return new e(t).cos()},t.prototype.cosh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cosh(this.get(t,e)));return this},t.cosh=function(t){return new e(t).cosh()},t.prototype.exp=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.exp(this.get(t,e)));return this},t.exp=function(t){return new e(t).exp()},t.prototype.expm1=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.expm1(this.get(t,e)));return this},t.expm1=function(t){return new e(t).expm1()},t.prototype.floor=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.floor(this.get(t,e)));return this},t.floor=function(t){return new e(t).floor()},t.prototype.fround=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.fround(this.get(t,e)));return this},t.fround=function(t){return new e(t).fround()},t.prototype.log=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log(this.get(t,e)));return this},t.log=function(t){return new e(t).log()},t.prototype.log1p=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log1p(this.get(t,e)));return this},t.log1p=function(t){return new e(t).log1p()},t.prototype.log10=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log10(this.get(t,e)));return this},t.log10=function(t){return new e(t).log10()},t.prototype.log2=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log2(this.get(t,e)));return this},t.log2=function(t){return new e(t).log2()},t.prototype.round=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.round(this.get(t,e)));return this},t.round=function(t){return new e(t).round()},t.prototype.sign=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sign(this.get(t,e)));return this},t.sign=function(t){return new e(t).sign()},t.prototype.sin=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sin(this.get(t,e)));return this},t.sin=function(t){return new e(t).sin()},t.prototype.sinh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sinh(this.get(t,e)));return this},t.sinh=function(t){return new e(t).sinh()},t.prototype.sqrt=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sqrt(this.get(t,e)));return this},t.sqrt=function(t){return new e(t).sqrt()},t.prototype.tan=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.tan(this.get(t,e)));return this},t.tan=function(t){return new e(t).tan()},t.prototype.tanh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.tanh(this.get(t,e)));return this},t.tanh=function(t){return new e(t).tanh()},t.prototype.trunc=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.trunc(this.get(t,e)));return this},t.trunc=function(t){return new e(t).trunc()},t.pow=function(t,i){return new e(t).pow(i)},t.prototype.pow=function(t){return"number"==typeof t?this.powS(t):this.powM(t)},t.prototype.powS=function(t){for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.set(e,i,Math.pow(this.get(e,i),t));return this},t.prototype.powM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.set(e,i,Math.pow(this.get(e,i),t.get(e,i)));return this}}(y,x);class M extends y{#e;get size(){return this.#e.size}get rows(){return this.#e.rows}get columns(){return this.#e.columns}get diagonalSize(){return this.rows}static isSymmetricMatrix(t){return x.isMatrix(t)&&"SymmetricMatrix"===t.klassType}static zeros(t){return new this(t)}static ones(t){return new this(t).fill(1)}constructor(t){if(super(),x.isMatrix(t)){if(!t.isSymmetric())throw new TypeError("not symmetric data");this.#e=x.copy(t,new x(t.rows,t.rows))}else if(Number.isInteger(t)&&t>=0)this.#e=new x(t,t);else if(this.#e=new x(t),!this.isSymmetric())throw new TypeError("not symmetric data")}clone(){const t=new M(this.diagonalSize);for(const[e,i,r]of this.upperRightEntries())t.set(e,i,r);return t}toMatrix(){return new x(this)}get(t,e){return this.#e.get(t,e)}set(t,e,i){return this.#e.set(t,e,i),this.#e.set(e,t,i),this}removeCross(t){return this.#e.removeRow(t),this.#e.removeColumn(t),this}addCross(t,e){void 0===e&&(e=t,t=this.diagonalSize);const i=e.slice();return i.splice(t,1),this.#e.addRow(t,i),this.#e.addColumn(t,e),this}applyMask(t){if(t.length!==this.diagonalSize)throw new RangeError("Mask size do not match with matrix size");const e=[];for(const[i,r]of t.entries())r||e.push(i);e.reverse();for(const t of e)this.removeCross(t);return this}toCompact(){const{diagonalSize:t}=this,e=new Array(t*(t+1)/2);for(let i=0,r=0,n=0;n<e.length;n++)e[n]=this.get(r,i),++i>=t&&(i=++r);return e}static fromCompact(t){const e=t.length,i=(Math.sqrt(8*e+1)-1)/2;if(!Number.isInteger(i))throw new TypeError(`This array is not a compact representation of a Symmetric Matrix, ${JSON.stringify(t)}`);const r=new M(i);for(let n=0,s=0,o=0;o<e;o++)r.set(n,s,t[o]),++n>=i&&(n=++s);return r}*upperRightEntries(){for(let t=0,e=0;t<this.diagonalSize;void 0){const i=this.get(t,e);yield[t,e,i],++e>=this.diagonalSize&&(e=++t)}}*upperRightValues(){for(let t=0,e=0;t<this.diagonalSize;void 0){const i=this.get(t,e);yield i,++e>=this.diagonalSize&&(e=++t)}}}M.prototype.klassType="SymmetricMatrix";class k extends M{static isDistanceMatrix(t){return M.isSymmetricMatrix(t)&&"DistanceMatrix"===t.klassSubType}constructor(t){if(super(t),!this.isDistance())throw new TypeError("Provided arguments do no produce a distance matrix")}set(t,e,i){return t===e&&(i=0),super.set(t,e,i)}addCross(t,e){return void 0===e&&(e=t,t=this.diagonalSize),(e=e.slice())[t]=0,super.addCross(t,e)}toSymmetricMatrix(){return new M(this)}clone(){const t=new k(this.diagonalSize);for(const[e,i,r]of this.upperRightEntries())e!==i&&t.set(e,i,r);return t}toCompact(){const{diagonalSize:t}=this,e=new Array((t-1)*t/2);for(let i=1,r=0,n=0;n<e.length;n++)e[n]=this.get(r,i),++i>=t&&(i=1+ ++r);return e}static fromCompact(t){const e=t.length,i=(Math.sqrt(8*e+1)+1)/2;if(!Number.isInteger(i))throw new TypeError(`This array is not a compact representation of a DistanceMatrix, ${JSON.stringify(t)}`);const r=new this(i);for(let n=1,s=0,o=0;o<e;o++)r.set(n,s,t[o]),++n>=i&&(n=1+ ++s);return r}}k.prototype.klassSubType="DistanceMatrix";class E extends y{constructor(t,e,i){super(),this.matrix=t,this.rows=e,this.columns=i}}class C extends E{constructor(t,e,i){g(t,e),m(t,i),super(t,e.length,i.length),this.rowIndices=e,this.columnIndices=i}set(t,e,i){return this.matrix.set(this.rowIndices[t],this.columnIndices[e],i),this}get(t,e){return this.matrix.get(this.rowIndices[t],this.columnIndices[e])}}class S extends y{constructor(t,e={}){const{rows:i=1}=e;if(t.length%i!=0)throw new Error("the data length is not divisible by the number of rows");super(),this.rows=i,this.columns=t.length/i,this.data=t}set(t,e,i){let r=this._calculateIndex(t,e);return this.data[r]=i,this}get(t,e){let i=this._calculateIndex(t,e);return this.data[i]}_calculateIndex(t,e){return t*this.columns+e}}class A extends y{constructor(t){super(),this.data=t,this.rows=t.length,this.columns=t[0].length}set(t,e,i){return this.data[t][e]=i,this}get(t,e){return this.data[t][e]}}class T{constructor(t){let e,i,r,n,s,o,a,h,l,u=(t=A.checkMatrix(t)).clone(),c=u.rows,d=u.columns,f=new Float64Array(c),g=1;for(e=0;e<c;e++)f[e]=e;for(h=new Float64Array(c),i=0;i<d;i++){for(e=0;e<c;e++)h[e]=u.get(e,i);for(e=0;e<c;e++){for(l=Math.min(e,i),s=0,r=0;r<l;r++)s+=u.get(e,r)*h[r];h[e]-=s,u.set(e,i,h[e])}for(n=i,e=i+1;e<c;e++)Math.abs(h[e])>Math.abs(h[n])&&(n=e);if(n!==i){for(r=0;r<d;r++)o=u.get(n,r),u.set(n,r,u.get(i,r)),u.set(i,r,o);a=f[n],f[n]=f[i],f[i]=a,g=-g}if(i<c&&0!==u.get(i,i))for(e=i+1;e<c;e++)u.set(e,i,u.get(e,i)/u.get(i,i))}this.LU=u,this.pivotVector=f,this.pivotSign=g}isSingular(){let t=this.LU,e=t.columns;for(let i=0;i<e;i++)if(0===t.get(i,i))return!0;return!1}solve(t){t=x.checkMatrix(t);let e=this.LU;if(e.rows!==t.rows)throw new Error("Invalid matrix dimensions");if(this.isSingular())throw new Error("LU matrix is singular");let i,r,n,s=t.columns,o=t.subMatrixRow(this.pivotVector,0,s-1),a=e.columns;for(n=0;n<a;n++)for(i=n+1;i<a;i++)for(r=0;r<s;r++)o.set(i,r,o.get(i,r)-o.get(n,r)*e.get(i,n));for(n=a-1;n>=0;n--){for(r=0;r<s;r++)o.set(n,r,o.get(n,r)/e.get(n,n));for(i=0;i<n;i++)for(r=0;r<s;r++)o.set(i,r,o.get(i,r)-o.get(n,r)*e.get(i,n))}return o}get determinant(){let t=this.LU;if(!t.isSquare())throw new Error("Matrix must be square");let e=this.pivotSign,i=t.columns;for(let r=0;r<i;r++)e*=t.get(r,r);return e}get lowerTriangularMatrix(){let t=this.LU,e=t.rows,i=t.columns,r=new x(e,i);for(let n=0;n<e;n++)for(let e=0;e<i;e++)n>e?r.set(n,e,t.get(n,e)):n===e?r.set(n,e,1):r.set(n,e,0);return r}get upperTriangularMatrix(){let t=this.LU,e=t.rows,i=t.columns,r=new x(e,i);for(let n=0;n<e;n++)for(let e=0;e<i;e++)n<=e?r.set(n,e,t.get(n,e)):r.set(n,e,0);return r}get pivotPermutationVector(){return Array.from(this.pivotVector)}}function R(t,e){let i=0;return Math.abs(t)>Math.abs(e)?(i=e/t,Math.abs(t)*Math.sqrt(1+i*i)):0!==e?(i=t/e,Math.abs(e)*Math.sqrt(1+i*i)):0}class P{constructor(t){let e,i,r,n,s=(t=A.checkMatrix(t)).clone(),o=t.rows,a=t.columns,h=new Float64Array(a);for(r=0;r<a;r++){let t=0;for(e=r;e<o;e++)t=R(t,s.get(e,r));if(0!==t){for(s.get(r,r)<0&&(t=-t),e=r;e<o;e++)s.set(e,r,s.get(e,r)/t);for(s.set(r,r,s.get(r,r)+1),i=r+1;i<a;i++){for(n=0,e=r;e<o;e++)n+=s.get(e,r)*s.get(e,i);for(n=-n/s.get(r,r),e=r;e<o;e++)s.set(e,i,s.get(e,i)+n*s.get(e,r))}}h[r]=-t}this.QR=s,this.Rdiag=h}solve(t){t=x.checkMatrix(t);let e=this.QR,i=e.rows;if(t.rows!==i)throw new Error("Matrix row dimensions must agree");if(!this.isFullRank())throw new Error("Matrix is rank deficient");let r,n,s,o,a=t.columns,h=t.clone(),l=e.columns;for(s=0;s<l;s++)for(n=0;n<a;n++){for(o=0,r=s;r<i;r++)o+=e.get(r,s)*h.get(r,n);for(o=-o/e.get(s,s),r=s;r<i;r++)h.set(r,n,h.get(r,n)+o*e.get(r,s))}for(s=l-1;s>=0;s--){for(n=0;n<a;n++)h.set(s,n,h.get(s,n)/this.Rdiag[s]);for(r=0;r<s;r++)for(n=0;n<a;n++)h.set(r,n,h.get(r,n)-h.get(s,n)*e.get(r,s))}return h.subMatrix(0,l-1,0,a-1)}isFullRank(){let t=this.QR.columns;for(let e=0;e<t;e++)if(0===this.Rdiag[e])return!1;return!0}get upperTriangularMatrix(){let t,e,i=this.QR,r=i.columns,n=new x(r,r);for(t=0;t<r;t++)for(e=0;e<r;e++)t<e?n.set(t,e,i.get(t,e)):t===e?n.set(t,e,this.Rdiag[t]):n.set(t,e,0);return n}get orthogonalMatrix(){let t,e,i,r,n=this.QR,s=n.rows,o=n.columns,a=new x(s,o);for(i=o-1;i>=0;i--){for(t=0;t<s;t++)a.set(t,i,0);for(a.set(i,i,1),e=i;e<o;e++)if(0!==n.get(i,i)){for(r=0,t=i;t<s;t++)r+=n.get(t,i)*a.get(t,e);for(r=-r/n.get(i,i),t=i;t<s;t++)a.set(t,e,a.get(t,e)+r*n.get(t,i))}}return a}}class I{constructor(t,e={}){if((t=A.checkMatrix(t)).isEmpty())throw new Error("Matrix must be non-empty");let i=t.rows,r=t.columns;const{computeLeftSingularVectors:n=!0,computeRightSingularVectors:s=!0,autoTranspose:o=!1}=e;let a,h=Boolean(n),l=Boolean(s),u=!1;if(i<r)if(o){a=t.transpose(),i=a.rows,r=a.columns,u=!0;let e=h;h=l,l=e}else a=t.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else a=t.clone();let c=Math.min(i,r),d=Math.min(i+1,r),f=new Float64Array(d),g=new x(i,c),m=new x(r,r),p=new Float64Array(r),w=new Float64Array(i),_=new Float64Array(d);for(let t=0;t<d;t++)_[t]=t;let b=Math.min(i-1,r),y=Math.max(0,Math.min(r-2,i)),v=Math.max(b,y);for(let t=0;t<v;t++){if(t<b){f[t]=0;for(let e=t;e<i;e++)f[t]=R(f[t],a.get(e,t));if(0!==f[t]){a.get(t,t)<0&&(f[t]=-f[t]);for(let e=t;e<i;e++)a.set(e,t,a.get(e,t)/f[t]);a.set(t,t,a.get(t,t)+1)}f[t]=-f[t]}for(let e=t+1;e<r;e++){if(t<b&&0!==f[t]){let r=0;for(let n=t;n<i;n++)r+=a.get(n,t)*a.get(n,e);r=-r/a.get(t,t);for(let n=t;n<i;n++)a.set(n,e,a.get(n,e)+r*a.get(n,t))}p[e]=a.get(t,e)}if(h&&t<b)for(let e=t;e<i;e++)g.set(e,t,a.get(e,t));if(t<y){p[t]=0;for(let e=t+1;e<r;e++)p[t]=R(p[t],p[e]);if(0!==p[t]){p[t+1]<0&&(p[t]=0-p[t]);for(let e=t+1;e<r;e++)p[e]/=p[t];p[t+1]+=1}if(p[t]=-p[t],t+1<i&&0!==p[t]){for(let e=t+1;e<i;e++)w[e]=0;for(let e=t+1;e<i;e++)for(let i=t+1;i<r;i++)w[e]+=p[i]*a.get(e,i);for(let e=t+1;e<r;e++){let r=-p[e]/p[t+1];for(let n=t+1;n<i;n++)a.set(n,e,a.get(n,e)+r*w[n])}}if(l)for(let e=t+1;e<r;e++)m.set(e,t,p[e])}}let M=Math.min(r,i+1);if(b<r&&(f[b]=a.get(b,b)),i<M&&(f[M-1]=0),y+1<M&&(p[y]=a.get(y,M-1)),p[M-1]=0,h){for(let t=b;t<c;t++){for(let e=0;e<i;e++)g.set(e,t,0);g.set(t,t,1)}for(let t=b-1;t>=0;t--)if(0!==f[t]){for(let e=t+1;e<c;e++){let r=0;for(let n=t;n<i;n++)r+=g.get(n,t)*g.get(n,e);r=-r/g.get(t,t);for(let n=t;n<i;n++)g.set(n,e,g.get(n,e)+r*g.get(n,t))}for(let e=t;e<i;e++)g.set(e,t,-g.get(e,t));g.set(t,t,1+g.get(t,t));for(let e=0;e<t-1;e++)g.set(e,t,0)}else{for(let e=0;e<i;e++)g.set(e,t,0);g.set(t,t,1)}}if(l)for(let t=r-1;t>=0;t--){if(t<y&&0!==p[t])for(let e=t+1;e<r;e++){let i=0;for(let n=t+1;n<r;n++)i+=m.get(n,t)*m.get(n,e);i=-i/m.get(t+1,t);for(let n=t+1;n<r;n++)m.set(n,e,m.get(n,e)+i*m.get(n,t))}for(let e=0;e<r;e++)m.set(e,t,0);m.set(t,t,1)}let k=M-1,E=Number.EPSILON;for(;M>0;){let t,e;for(t=M-2;t>=-1&&-1!==t;t--){const e=Number.MIN_VALUE+E*Math.abs(f[t]+Math.abs(f[t+1]));if(Math.abs(p[t])<=e||Number.isNaN(p[t])){p[t]=0;break}}if(t===M-2)e=4;else{let i;for(i=M-1;i>=t&&i!==t;i--){let e=(i!==M?Math.abs(p[i]):0)+(i!==t+1?Math.abs(p[i-1]):0);if(Math.abs(f[i])<=E*e){f[i]=0;break}}i===t?e=3:i===M-1?e=1:(e=2,t=i)}switch(t++,e){case 1:{let e=p[M-2];p[M-2]=0;for(let i=M-2;i>=t;i--){let n=R(f[i],e),s=f[i]/n,o=e/n;if(f[i]=n,i!==t&&(e=-o*p[i-1],p[i-1]=s*p[i-1]),l)for(let t=0;t<r;t++)n=s*m.get(t,i)+o*m.get(t,M-1),m.set(t,M-1,-o*m.get(t,i)+s*m.get(t,M-1)),m.set(t,i,n)}break}case 2:{let e=p[t-1];p[t-1]=0;for(let r=t;r<M;r++){let n=R(f[r],e),s=f[r]/n,o=e/n;if(f[r]=n,e=-o*p[r],p[r]=s*p[r],h)for(let e=0;e<i;e++)n=s*g.get(e,r)+o*g.get(e,t-1),g.set(e,t-1,-o*g.get(e,r)+s*g.get(e,t-1)),g.set(e,r,n)}break}case 3:{const e=Math.max(Math.abs(f[M-1]),Math.abs(f[M-2]),Math.abs(p[M-2]),Math.abs(f[t]),Math.abs(p[t])),n=f[M-1]/e,s=f[M-2]/e,o=p[M-2]/e,a=f[t]/e,u=p[t]/e,c=((s+n)*(s-n)+o*o)/2,d=n*o*(n*o);let w=0;0===c&&0===d||(w=c<0?0-Math.sqrt(c*c+d):Math.sqrt(c*c+d),w=d/(c+w));let _=(a+n)*(a-n)+w,b=a*u;for(let e=t;e<M-1;e++){let n=R(_,b);0===n&&(n=Number.MIN_VALUE);let s=_/n,o=b/n;if(e!==t&&(p[e-1]=n),_=s*f[e]+o*p[e],p[e]=s*p[e]-o*f[e],b=o*f[e+1],f[e+1]=s*f[e+1],l)for(let t=0;t<r;t++)n=s*m.get(t,e)+o*m.get(t,e+1),m.set(t,e+1,-o*m.get(t,e)+s*m.get(t,e+1)),m.set(t,e,n);if(n=R(_,b),0===n&&(n=Number.MIN_VALUE),s=_/n,o=b/n,f[e]=n,_=s*p[e]+o*f[e+1],f[e+1]=-o*p[e]+s*f[e+1],b=o*p[e+1],p[e+1]=s*p[e+1],h&&e<i-1)for(let t=0;t<i;t++)n=s*g.get(t,e)+o*g.get(t,e+1),g.set(t,e+1,-o*g.get(t,e)+s*g.get(t,e+1)),g.set(t,e,n)}p[M-2]=_;break}case 4:if(f[t]<=0&&(f[t]=f[t]<0?-f[t]:0,l))for(let e=0;e<=k;e++)m.set(e,t,-m.get(e,t));for(;t<k&&!(f[t]>=f[t+1]);){let e=f[t];if(f[t]=f[t+1],f[t+1]=e,l&&t<r-1)for(let i=0;i<r;i++)e=m.get(i,t+1),m.set(i,t+1,m.get(i,t)),m.set(i,t,e);if(h&&t<i-1)for(let r=0;r<i;r++)e=g.get(r,t+1),g.set(r,t+1,g.get(r,t)),g.set(r,t,e);t++}M--}}if(u){let t=m;m=g,g=t}this.m=i,this.n=r,this.s=f,this.U=g,this.V=m}solve(t){let e=t,i=this.threshold,r=this.s.length,n=x.zeros(r,r);for(let t=0;t<r;t++)Math.abs(this.s[t])<=i?n.set(t,t,0):n.set(t,t,1/this.s[t]);let s=this.U,o=this.rightSingularVectors,a=o.mmul(n),h=o.rows,l=s.rows,u=x.zeros(h,l);for(let t=0;t<h;t++)for(let e=0;e<l;e++){let i=0;for(let n=0;n<r;n++)i+=a.get(t,n)*s.get(e,n);u.set(t,e,i)}return u.mmul(e)}solveForDiagonal(t){return this.solve(x.diag(t))}inverse(){let t=this.V,e=this.threshold,i=t.rows,r=t.columns,n=new x(i,this.s.length);for(let s=0;s<i;s++)for(let i=0;i<r;i++)Math.abs(this.s[i])>e&&n.set(s,i,t.get(s,i)/this.s[i]);let s=this.U,o=s.rows,a=s.columns,h=new x(i,o);for(let t=0;t<i;t++)for(let e=0;e<o;e++){let i=0;for(let r=0;r<a;r++)i+=n.get(t,r)*s.get(e,r);h.set(t,e,i)}return h}get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]}get norm2(){return this.s[0]}get rank(){let t=Math.max(this.m,this.n)*this.s[0]*Number.EPSILON,e=0,i=this.s;for(let r=0,n=i.length;r<n;r++)i[r]>t&&e++;return e}get diagonal(){return Array.from(this.s)}get threshold(){return Number.EPSILON/2*Math.max(this.m,this.n)*this.s[0]}get leftSingularVectors(){return this.U}get rightSingularVectors(){return this.V}get diagonalMatrix(){return x.diag(this.s)}}function D(t,e,i=!1){return t=A.checkMatrix(t),e=A.checkMatrix(e),i?new I(t).solve(e):t.isSquare()?new T(t).solve(e):new P(t).solve(e)}function L(t,e){let i=[];for(let r=0;r<t;r++)r!==e&&i.push(r);return i}function F(t,e,i,r=1e-9,n=1e-9){if(t>n)return new Array(e.rows+1).fill(0);{let t=e.addRow(i,[0]);for(let e=0;e<t.rows;e++)Math.abs(t.get(e,0))<r&&t.set(e,0,0);return t.to1DArray()}}class z{constructor(t,e={}){const{assumeSymmetric:i=!1}=e;if(!(t=A.checkMatrix(t)).isSquare())throw new Error("Matrix is not a square matrix");if(t.isEmpty())throw new Error("Matrix must be non-empty");let r,n,s=t.columns,o=new x(s,s),a=new Float64Array(s),h=new Float64Array(s),l=t,u=!1;if(u=!!i||t.isSymmetric(),u){for(r=0;r<s;r++)for(n=0;n<s;n++)o.set(r,n,l.get(r,n));!function(t,e,i,r){let n,s,o,a,h,l,u,c;for(h=0;h<t;h++)i[h]=r.get(t-1,h);for(a=t-1;a>0;a--){for(c=0,o=0,l=0;l<a;l++)c+=Math.abs(i[l]);if(0===c)for(e[a]=i[a-1],h=0;h<a;h++)i[h]=r.get(a-1,h),r.set(a,h,0),r.set(h,a,0);else{for(l=0;l<a;l++)i[l]/=c,o+=i[l]*i[l];for(n=i[a-1],s=Math.sqrt(o),n>0&&(s=-s),e[a]=c*s,o-=n*s,i[a-1]=n-s,h=0;h<a;h++)e[h]=0;for(h=0;h<a;h++){for(n=i[h],r.set(h,a,n),s=e[h]+r.get(h,h)*n,l=h+1;l<=a-1;l++)s+=r.get(l,h)*i[l],e[l]+=r.get(l,h)*n;e[h]=s}for(n=0,h=0;h<a;h++)e[h]/=o,n+=e[h]*i[h];for(u=n/(o+o),h=0;h<a;h++)e[h]-=u*i[h];for(h=0;h<a;h++){for(n=i[h],s=e[h],l=h;l<=a-1;l++)r.set(l,h,r.get(l,h)-(n*e[l]+s*i[l]));i[h]=r.get(a-1,h),r.set(a,h,0)}}i[a]=o}for(a=0;a<t-1;a++){if(r.set(t-1,a,r.get(a,a)),r.set(a,a,1),o=i[a+1],0!==o){for(l=0;l<=a;l++)i[l]=r.get(l,a+1)/o;for(h=0;h<=a;h++){for(s=0,l=0;l<=a;l++)s+=r.get(l,a+1)*r.get(l,h);for(l=0;l<=a;l++)r.set(l,h,r.get(l,h)-s*i[l])}}for(l=0;l<=a;l++)r.set(l,a+1,0)}for(h=0;h<t;h++)i[h]=r.get(t-1,h),r.set(t-1,h,0);r.set(t-1,t-1,1),e[0]=0}(s,h,a,o),function(t,e,i,r){let n,s,o,a,h,l,u,c,d,f,g,m,p,w,_,b;for(o=1;o<t;o++)e[o-1]=e[o];e[t-1]=0;let y=0,v=0,x=Number.EPSILON;for(l=0;l<t;l++){for(v=Math.max(v,Math.abs(i[l])+Math.abs(e[l])),u=l;u<t&&!(Math.abs(e[u])<=x*v);)u++;if(u>l)do{for(n=i[l],c=(i[l+1]-n)/(2*e[l]),d=R(c,1),c<0&&(d=-d),i[l]=e[l]/(c+d),i[l+1]=e[l]*(c+d),f=i[l+1],s=n-i[l],o=l+2;o<t;o++)i[o]-=s;for(y+=s,c=i[u],g=1,m=g,p=g,w=e[l+1],_=0,b=0,o=u-1;o>=l;o--)for(p=m,m=g,b=_,n=g*e[o],s=g*c,d=R(c,e[o]),e[o+1]=_*d,_=e[o]/d,g=c/d,c=g*i[o]-_*n,i[o+1]=s+_*(g*n+_*i[o]),h=0;h<t;h++)s=r.get(h,o+1),r.set(h,o+1,_*r.get(h,o)+g*s),r.set(h,o,g*r.get(h,o)-_*s);c=-_*b*p*w*e[l]/f,e[l]=_*c,i[l]=g*c}while(Math.abs(e[l])>x*v);i[l]=i[l]+y,e[l]=0}for(o=0;o<t-1;o++){for(h=o,c=i[o],a=o+1;a<t;a++)i[a]<c&&(h=a,c=i[a]);if(h!==o)for(i[h]=i[o],i[o]=c,a=0;a<t;a++)c=r.get(a,o),r.set(a,o,r.get(a,h)),r.set(a,h,c)}}(s,h,a,o)}else{let t=new x(s,s),e=new Float64Array(s);for(n=0;n<s;n++)for(r=0;r<s;r++)t.set(r,n,l.get(r,n));!function(t,e,i,r){let n,s,o,a,h,l,u,c=t-1;for(l=1;l<=c-1;l++){for(u=0,a=l;a<=c;a++)u+=Math.abs(e.get(a,l-1));if(0!==u){for(o=0,a=c;a>=l;a--)i[a]=e.get(a,l-1)/u,o+=i[a]*i[a];for(s=Math.sqrt(o),i[l]>0&&(s=-s),o-=i[l]*s,i[l]=i[l]-s,h=l;h<t;h++){for(n=0,a=c;a>=l;a--)n+=i[a]*e.get(a,h);for(n/=o,a=l;a<=c;a++)e.set(a,h,e.get(a,h)-n*i[a])}for(a=0;a<=c;a++){for(n=0,h=c;h>=l;h--)n+=i[h]*e.get(a,h);for(n/=o,h=l;h<=c;h++)e.set(a,h,e.get(a,h)-n*i[h])}i[l]=u*i[l],e.set(l,l-1,u*s)}}for(a=0;a<t;a++)for(h=0;h<t;h++)r.set(a,h,a===h?1:0);for(l=c-1;l>=1;l--)if(0!==e.get(l,l-1)){for(a=l+1;a<=c;a++)i[a]=e.get(a,l-1);for(h=l;h<=c;h++){for(s=0,a=l;a<=c;a++)s+=i[a]*r.get(a,h);for(s=s/i[l]/e.get(l,l-1),a=l;a<=c;a++)r.set(a,h,r.get(a,h)+s*i[a])}}}(s,t,e,o),function(t,e,i,r,n){let s,o,a,h,l,u,c,d,f,g,m,p,w,_,b,y=t-1,v=t-1,x=Number.EPSILON,M=0,k=0,E=0,C=0,S=0,A=0,T=0,R=0;for(s=0;s<t;s++)for((s<0||s>v)&&(i[s]=n.get(s,s),e[s]=0),o=Math.max(s-1,0);o<t;o++)k+=Math.abs(n.get(s,o));for(;y>=0;){for(h=y;h>0&&(A=Math.abs(n.get(h-1,h-1))+Math.abs(n.get(h,h)),0===A&&(A=k),!(Math.abs(n.get(h,h-1))<x*A));)h--;if(h===y)n.set(y,y,n.get(y,y)+M),i[y]=n.get(y,y),e[y]=0,y--,R=0;else if(h===y-1){if(c=n.get(y,y-1)*n.get(y-1,y),E=(n.get(y-1,y-1)-n.get(y,y))/2,C=E*E+c,T=Math.sqrt(Math.abs(C)),n.set(y,y,n.get(y,y)+M),n.set(y-1,y-1,n.get(y-1,y-1)+M),d=n.get(y,y),C>=0){for(T=E>=0?E+T:E-T,i[y-1]=d+T,i[y]=i[y-1],0!==T&&(i[y]=d-c/T),e[y-1]=0,e[y]=0,d=n.get(y,y-1),A=Math.abs(d)+Math.abs(T),E=d/A,C=T/A,S=Math.sqrt(E*E+C*C),E/=S,C/=S,o=y-1;o<t;o++)T=n.get(y-1,o),n.set(y-1,o,C*T+E*n.get(y,o)),n.set(y,o,C*n.get(y,o)-E*T);for(s=0;s<=y;s++)T=n.get(s,y-1),n.set(s,y-1,C*T+E*n.get(s,y)),n.set(s,y,C*n.get(s,y)-E*T);for(s=0;s<=v;s++)T=r.get(s,y-1),r.set(s,y-1,C*T+E*r.get(s,y)),r.set(s,y,C*r.get(s,y)-E*T)}else i[y-1]=d+E,i[y]=d+E,e[y-1]=T,e[y]=-T;y-=2,R=0}else{if(d=n.get(y,y),f=0,c=0,h<y&&(f=n.get(y-1,y-1),c=n.get(y,y-1)*n.get(y-1,y)),10===R){for(M+=d,s=0;s<=y;s++)n.set(s,s,n.get(s,s)-d);A=Math.abs(n.get(y,y-1))+Math.abs(n.get(y-1,y-2)),d=f=.75*A,c=-.4375*A*A}if(30===R&&(A=(f-d)/2,A=A*A+c,A>0)){for(A=Math.sqrt(A),f<d&&(A=-A),A=d-c/((f-d)/2+A),s=0;s<=y;s++)n.set(s,s,n.get(s,s)-A);M+=A,d=f=c=.964}for(R+=1,l=y-2;l>=h&&(T=n.get(l,l),S=d-T,A=f-T,E=(S*A-c)/n.get(l+1,l)+n.get(l,l+1),C=n.get(l+1,l+1)-T-S-A,S=n.get(l+2,l+1),A=Math.abs(E)+Math.abs(C)+Math.abs(S),E/=A,C/=A,S/=A,l!==h)&&!(Math.abs(n.get(l,l-1))*(Math.abs(C)+Math.abs(S))<x*(Math.abs(E)*(Math.abs(n.get(l-1,l-1))+Math.abs(T)+Math.abs(n.get(l+1,l+1)))));)l--;for(s=l+2;s<=y;s++)n.set(s,s-2,0),s>l+2&&n.set(s,s-3,0);for(a=l;a<=y-1&&(_=a!==y-1,a!==l&&(E=n.get(a,a-1),C=n.get(a+1,a-1),S=_?n.get(a+2,a-1):0,d=Math.abs(E)+Math.abs(C)+Math.abs(S),0!==d&&(E/=d,C/=d,S/=d)),0!==d);a++)if(A=Math.sqrt(E*E+C*C+S*S),E<0&&(A=-A),0!==A){for(a!==l?n.set(a,a-1,-A*d):h!==l&&n.set(a,a-1,-n.get(a,a-1)),E+=A,d=E/A,f=C/A,T=S/A,C/=E,S/=E,o=a;o<t;o++)E=n.get(a,o)+C*n.get(a+1,o),_&&(E+=S*n.get(a+2,o),n.set(a+2,o,n.get(a+2,o)-E*T)),n.set(a,o,n.get(a,o)-E*d),n.set(a+1,o,n.get(a+1,o)-E*f);for(s=0;s<=Math.min(y,a+3);s++)E=d*n.get(s,a)+f*n.get(s,a+1),_&&(E+=T*n.get(s,a+2),n.set(s,a+2,n.get(s,a+2)-E*S)),n.set(s,a,n.get(s,a)-E),n.set(s,a+1,n.get(s,a+1)-E*C);for(s=0;s<=v;s++)E=d*r.get(s,a)+f*r.get(s,a+1),_&&(E+=T*r.get(s,a+2),r.set(s,a+2,r.get(s,a+2)-E*S)),r.set(s,a,r.get(s,a)-E),r.set(s,a+1,r.get(s,a+1)-E*C)}}}if(0!==k){for(y=t-1;y>=0;y--)if(E=i[y],C=e[y],0===C)for(h=y,n.set(y,y,1),s=y-1;s>=0;s--){for(c=n.get(s,s)-E,S=0,o=h;o<=y;o++)S+=n.get(s,o)*n.get(o,y);if(e[s]<0)T=c,A=S;else if(h=s,0===e[s]?n.set(s,y,0!==c?-S/c:-S/(x*k)):(d=n.get(s,s+1),f=n.get(s+1,s),C=(i[s]-E)*(i[s]-E)+e[s]*e[s],u=(d*A-T*S)/C,n.set(s,y,u),n.set(s+1,y,Math.abs(d)>Math.abs(T)?(-S-c*u)/d:(-A-f*u)/T)),u=Math.abs(n.get(s,y)),x*u*u>1)for(o=s;o<=y;o++)n.set(o,y,n.get(o,y)/u)}else if(C<0)for(h=y-1,Math.abs(n.get(y,y-1))>Math.abs(n.get(y-1,y))?(n.set(y-1,y-1,C/n.get(y,y-1)),n.set(y-1,y,-(n.get(y,y)-E)/n.get(y,y-1))):(b=B(0,-n.get(y-1,y),n.get(y-1,y-1)-E,C),n.set(y-1,y-1,b[0]),n.set(y-1,y,b[1])),n.set(y,y-1,0),n.set(y,y,1),s=y-2;s>=0;s--){for(g=0,m=0,o=h;o<=y;o++)g+=n.get(s,o)*n.get(o,y-1),m+=n.get(s,o)*n.get(o,y);if(c=n.get(s,s)-E,e[s]<0)T=c,S=g,A=m;else if(h=s,0===e[s]?(b=B(-g,-m,c,C),n.set(s,y-1,b[0]),n.set(s,y,b[1])):(d=n.get(s,s+1),f=n.get(s+1,s),p=(i[s]-E)*(i[s]-E)+e[s]*e[s]-C*C,w=2*(i[s]-E)*C,0===p&&0===w&&(p=x*k*(Math.abs(c)+Math.abs(C)+Math.abs(d)+Math.abs(f)+Math.abs(T))),b=B(d*S-T*g+C*m,d*A-T*m-C*g,p,w),n.set(s,y-1,b[0]),n.set(s,y,b[1]),Math.abs(d)>Math.abs(T)+Math.abs(C)?(n.set(s+1,y-1,(-g-c*n.get(s,y-1)+C*n.get(s,y))/d),n.set(s+1,y,(-m-c*n.get(s,y)-C*n.get(s,y-1))/d)):(b=B(-S-f*n.get(s,y-1),-A-f*n.get(s,y),T,C),n.set(s+1,y-1,b[0]),n.set(s+1,y,b[1]))),u=Math.max(Math.abs(n.get(s,y-1)),Math.abs(n.get(s,y))),x*u*u>1)for(o=s;o<=y;o++)n.set(o,y-1,n.get(o,y-1)/u),n.set(o,y,n.get(o,y)/u)}for(s=0;s<t;s++)if(s<0||s>v)for(o=s;o<t;o++)r.set(s,o,n.get(s,o));for(o=t-1;o>=0;o--)for(s=0;s<=v;s++){for(T=0,a=0;a<=Math.min(o,v);a++)T+=r.get(s,a)*n.get(a,o);r.set(s,o,T)}}}(s,h,a,o,t)}this.n=s,this.e=h,this.d=a,this.V=o}get realEigenvalues(){return Array.from(this.d)}get imaginaryEigenvalues(){return Array.from(this.e)}get eigenvectorMatrix(){return this.V}get diagonalMatrix(){let t,e,i=this.n,r=this.e,n=this.d,s=new x(i,i);for(t=0;t<i;t++){for(e=0;e<i;e++)s.set(t,e,0);s.set(t,t,n[t]),r[t]>0?s.set(t,t+1,r[t]):r[t]<0&&s.set(t,t-1,r[t])}return s}}function B(t,e,i,r){let n,s;return Math.abs(i)>Math.abs(r)?(n=r/i,s=i+n*r,[(t+n*e)/s,(e-n*t)/s]):(n=i/r,s=r+n*i,[(n*t+e)/s,(n*e-t)/s])}class N{constructor(t){if(!(t=A.checkMatrix(t)).isSymmetric())throw new Error("Matrix is not symmetric");let e,i,r,n=t,s=n.rows,o=new x(s,s),a=!0;for(i=0;i<s;i++){let t=0;for(r=0;r<i;r++){let s=0;for(e=0;e<r;e++)s+=o.get(r,e)*o.get(i,e);s=(n.get(i,r)-s)/o.get(r,r),o.set(i,r,s),t+=s*s}for(t=n.get(i,i)-t,a&=t>0,o.set(i,i,Math.sqrt(Math.max(t,0))),r=i+1;r<s;r++)o.set(i,r,0)}this.L=o,this.positiveDefinite=Boolean(a)}isPositiveDefinite(){return this.positiveDefinite}solve(t){t=A.checkMatrix(t);let e=this.L,i=e.rows;if(t.rows!==i)throw new Error("Matrix dimensions do not match");if(!1===this.isPositiveDefinite())throw new Error("Matrix is not positive definite");let r,n,s,o=t.columns,a=t.clone();for(s=0;s<i;s++)for(n=0;n<o;n++){for(r=0;r<s;r++)a.set(s,n,a.get(s,n)-a.get(r,n)*e.get(s,r));a.set(s,n,a.get(s,n)/e.get(s,s))}for(s=i-1;s>=0;s--)for(n=0;n<o;n++){for(r=s+1;r<i;r++)a.set(s,n,a.get(s,n)-a.get(r,n)*e.get(r,s));a.set(s,n,a.get(s,n)/e.get(s,s))}return a}get lowerTriangularMatrix(){return this.L}}class O{constructor(t,e={}){t=A.checkMatrix(t);let{Y:i}=e;const{scaleScores:n=!1,maxIterations:s=1e3,terminationCriteria:o=1e-10}=e;let a;if(i){if(i=r.isAnyArray(i)&&"number"==typeof i[0]?x.columnVector(i):A.checkMatrix(i),i.rows!==t.rows)throw new Error("Y should have the same number of rows as X");a=i.getColumnVector(0)}else a=t.getColumnVector(0);let h,l,u,c,d=1;for(let e=0;e<s&&d>o;e++)u=t.transpose().mmul(a).div(a.transpose().mmul(a).get(0,0)),u=u.div(u.norm()),h=t.mmul(u).div(u.transpose().mmul(u).get(0,0)),e>0&&(d=h.clone().sub(c).pow(2).sum()),c=h.clone(),i?(l=i.transpose().mmul(h).div(h.transpose().mmul(h).get(0,0)),l=l.div(l.norm()),a=i.mmul(l).div(l.transpose().mmul(l).get(0,0))):a=h;if(i){let e=t.transpose().mmul(h).div(h.transpose().mmul(h).get(0,0));e=e.div(e.norm());let r=t.clone().sub(h.clone().mmul(e.transpose())),n=a.transpose().mmul(h).div(h.transpose().mmul(h).get(0,0)),s=i.clone().sub(h.clone().mulS(n.get(0,0)).mmul(l.transpose()));this.t=h,this.p=e.transpose(),this.w=u.transpose(),this.q=l,this.u=a,this.s=h.transpose().mmul(h),this.xResidual=r,this.yResidual=s,this.betas=n}else this.w=u.transpose(),this.s=h.transpose().mmul(h).sqrt(),this.t=n?h.clone().div(this.s.get(0,0)):h,this.xResidual=t.sub(h.mmul(u.transpose()))}}e.AbstractMatrix=y,e.CHO=N,e.CholeskyDecomposition=N,e.DistanceMatrix=k,e.EVD=z,e.EigenvalueDecomposition=z,e.LU=T,e.LuDecomposition=T,e.Matrix=x,e.MatrixColumnSelectionView=class extends E{constructor(t,e){m(t,e),super(t,t.rows,e.length),this.columnIndices=e}set(t,e,i){return this.matrix.set(t,this.columnIndices[e],i),this}get(t,e){return this.matrix.get(t,this.columnIndices[e])}},e.MatrixColumnView=class extends E{constructor(t,e){c(t,e),super(t,t.rows,1),this.column=e}set(t,e,i){return this.matrix.set(t,this.column,i),this}get(t){return this.matrix.get(t,this.column)}},e.MatrixFlipColumnView=class extends E{constructor(t){super(t,t.rows,t.columns)}set(t,e,i){return this.matrix.set(t,this.columns-e-1,i),this}get(t,e){return this.matrix.get(t,this.columns-e-1)}},e.MatrixFlipRowView=class extends E{constructor(t){super(t,t.rows,t.columns)}set(t,e,i){return this.matrix.set(this.rows-t-1,e,i),this}get(t,e){return this.matrix.get(this.rows-t-1,e)}},e.MatrixRowSelectionView=class extends E{constructor(t,e){g(t,e),super(t,e.length,t.columns),this.rowIndices=e}set(t,e,i){return this.matrix.set(this.rowIndices[t],e,i),this}get(t,e){return this.matrix.get(this.rowIndices[t],e)}},e.MatrixRowView=class extends E{constructor(t,e){u(t,e),super(t,1,t.columns),this.row=e}set(t,e,i){return this.matrix.set(this.row,e,i),this}get(t,e){return this.matrix.get(this.row,e)}},e.MatrixSelectionView=C,e.MatrixSubView=class extends E{constructor(t,e,i,r,n){p(t,e,i,r,n),super(t,i-e+1,n-r+1),this.startRow=e,this.startColumn=r}set(t,e,i){return this.matrix.set(this.startRow+t,this.startColumn+e,i),this}get(t,e){return this.matrix.get(this.startRow+t,this.startColumn+e)}},e.MatrixTransposeView=class extends E{constructor(t){super(t,t.columns,t.rows)}set(t,e,i){return this.matrix.set(e,t,i),this}get(t,e){return this.matrix.get(e,t)}},e.NIPALS=O,e.Nipals=O,e.QR=P,e.QrDecomposition=P,e.SVD=I,e.SingularValueDecomposition=I,e.SymmetricMatrix=M,e.WrapperMatrix1D=S,e.WrapperMatrix2D=A,e.correlation=function(t,e=t,i={}){t=new x(t);let n=!1;if("object"!=typeof e||x.isMatrix(e)||r.isAnyArray(e)?e=new x(e):(i=e,e=t,n=!0),t.rows!==e.rows)throw new TypeError("Both matrices must have the same number of rows");const{center:s=!0,scale:o=!0}=i;s&&(t.center("column"),n||e.center("column")),o&&(t.scale("column"),n||e.scale("column"));const a=t.standardDeviation("column",{unbiased:!0}),h=n?a:e.standardDeviation("column",{unbiased:!0}),l=t.transpose().mmul(e);for(let e=0;e<l.rows;e++)for(let i=0;i<l.columns;i++)l.set(e,i,l.get(e,i)*(1/(a[e]*h[i]))*(1/(t.rows-1)));return l},e.covariance=function(t,e=t,i={}){t=new x(t);let n=!1;if("object"!=typeof e||x.isMatrix(e)||r.isAnyArray(e)?e=new x(e):(i=e,e=t,n=!0),t.rows!==e.rows)throw new TypeError("Both matrices must have the same number of rows");const{center:s=!0}=i;s&&(t=t.center("column"),n||(e=e.center("column")));const o=t.transpose().mmul(e);for(let e=0;e<o.rows;e++)for(let i=0;i<o.columns;i++)o.set(e,i,o.get(e,i)*(1/(t.rows-1)));return o},e.default=x,e.determinant=function t(e){if((e=x.checkMatrix(e)).isSquare()){if(0===e.columns)return 1;let i,r,n,s;if(2===e.columns)return i=e.get(0,0),r=e.get(0,1),n=e.get(1,0),s=e.get(1,1),i*s-r*n;if(3===e.columns){let s,o,a;return s=new C(e,[1,2],[1,2]),o=new C(e,[1,2],[0,2]),a=new C(e,[1,2],[0,1]),i=e.get(0,0),r=e.get(0,1),n=e.get(0,2),i*t(s)-r*t(o)+n*t(a)}return new T(e).determinant}throw Error("determinant can only be calculated for a square matrix")},e.inverse=function(t,e=!1){return t=A.checkMatrix(t),e?new I(t).inverse():D(t,x.eye(t.rows))},e.linearDependencies=function(t,e={}){const{thresholdValue:i=1e-9,thresholdError:r=1e-9}=e;let n=(t=x.checkMatrix(t)).rows,s=new x(n,n);for(let e=0;e<n;e++){let o=x.columnVector(t.getRow(e)),a=t.subMatrixRow(L(n,e)).transpose(),h=new I(a).solve(o),l=x.sub(o,a.mmul(h)).abs().max();s.setRow(e,F(l,h,e,i,r))}return s},e.pseudoInverse=function(t,e=Number.EPSILON){if((t=x.checkMatrix(t)).isEmpty())return t.transpose();let i=new I(t,{autoTranspose:!0}),r=i.leftSingularVectors,n=i.rightSingularVectors,s=i.diagonal;for(let t=0;t<s.length;t++)Math.abs(s[t])>e?s[t]=1/s[t]:s[t]=0;return n.mmul(x.diag(s).mmul(r.transpose()))},e.solve=D,e.wrap=function(t,e){if(r.isAnyArray(t))return t[0]&&r.isAnyArray(t[0])?new A(t):new S(t,e);throw new Error("the argument is not an array")}},2664:t=>{t.exports=function(t,e){t=t||0;for(var i=new Array(t),r=0;r<t;r++)i[r]=e;return i}},995:t=>{t.exports=function(t){return 0===t?1:(t--,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,1+(t|=t>>16))}},148:t=>{"use strict";t.exports=function(t,n,o,a,h,l){if(!i(t)||!i(n)||o&&!i(o))throw new Error("Image data: Uint8Array, Uint8ClampedArray or Buffer expected.");if(t.length!==n.length||o&&o.length!==t.length)throw new Error("Image sizes do not match.");if(t.length!==a*h*4)throw new Error("Image data size does not match width/height.");l=Object.assign({},e,l);const d=a*h,f=new Uint32Array(t.buffer,t.byteOffset,d),g=new Uint32Array(n.buffer,n.byteOffset,d);let m=!0;for(let t=0;t<d;t++)if(f[t]!==g[t]){m=!1;break}if(m){if(o&&!l.diffMask)for(let e=0;e<d;e++)c(t,4*e,l.alpha,o);return 0}const p=35215*l.threshold*l.threshold;let w=0;for(let e=0;e<h;e++)for(let i=0;i<a;i++){const d=4*(e*a+i),f=s(t,n,d,d);Math.abs(f)>p?l.includeAA||!r(t,i,e,a,h,n)&&!r(n,i,e,a,h,t)?(o&&u(o,d,...f<0&&l.diffColorAlt||l.diffColor),w++):o&&!l.diffMask&&u(o,d,...l.aaColor):o&&(l.diffMask||c(t,d,l.alpha,o))}return w};const e={threshold:.1,includeAA:!1,alpha:.1,aaColor:[255,255,0],diffColor:[255,0,0],diffColorAlt:null,diffMask:!1};function i(t){return ArrayBuffer.isView(t)&&1===t.constructor.BYTES_PER_ELEMENT}function r(t,e,i,r,o,a){const h=Math.max(e-1,0),l=Math.max(i-1,0),u=Math.min(e+1,r-1),c=Math.min(i+1,o-1),d=4*(i*r+e);let f,g,m,p,w=e===h||e===u||i===l||i===c?1:0,_=0,b=0;for(let n=h;n<=u;n++)for(let o=l;o<=c;o++){if(n===e&&o===i)continue;const a=s(t,t,d,4*(o*r+n),!0);if(0===a){if(w++,w>2)return!1}else a<_?(_=a,f=n,g=o):a>b&&(b=a,m=n,p=o)}return 0!==_&&0!==b&&(n(t,f,g,r,o)&&n(a,f,g,r,o)||n(t,m,p,r,o)&&n(a,m,p,r,o))}function n(t,e,i,r,n){const s=Math.max(e-1,0),o=Math.max(i-1,0),a=Math.min(e+1,r-1),h=Math.min(i+1,n-1),l=4*(i*r+e);let u=e===s||e===a||i===o||i===h?1:0;for(let n=s;n<=a;n++)for(let s=o;s<=h;s++){if(n===e&&s===i)continue;const o=4*(s*r+n);if(t[l]===t[o]&&t[l+1]===t[o+1]&&t[l+2]===t[o+2]&&t[l+3]===t[o+3]&&u++,u>2)return!0}return!1}function s(t,e,i,r,n){let s=t[i+0],u=t[i+1],c=t[i+2],d=t[i+3],f=e[r+0],g=e[r+1],m=e[r+2],p=e[r+3];if(d===p&&s===f&&u===g&&c===m)return 0;d<255&&(d/=255,s=l(s,d),u=l(u,d),c=l(c,d)),p<255&&(p/=255,f=l(f,p),g=l(g,p),m=l(m,p));const w=o(s,u,c),_=o(f,g,m),b=w-_;if(n)return b;const y=a(s,u,c)-a(f,g,m),v=h(s,u,c)-h(f,g,m),x=.5053*b*b+.299*y*y+.1957*v*v;return w>_?-x:x}function o(t,e,i){return.29889531*t+.58662247*e+.11448223*i}function a(t,e,i){return.59597799*t-.2741761*e-.32180189*i}function h(t,e,i){return.21147017*t-.52261711*e+.31114694*i}function l(t,e){return 255+(t-255)*e}function u(t,e,i,r,n){t[e+0]=i,t[e+1]=r,t[e+2]=n,t[e+3]=255}function c(t,e,i,r){const n=l(o(t[e+0],t[e+1],t[e+2]),i*t[e+3]/255);u(r,e,n,n,n)}},146:(t,e,i)=>{"use strict";var r=i(8005),n=i(6740),s=i(5442),o=i(7972);function a(t,e,i,r){return function(i,n,s){var o=t(t(e(n[1],s[0]),e(-s[1],n[0])),t(e(i[1],n[0]),e(-n[1],i[0]))),a=t(e(i[1],s[0]),e(-s[1],i[0])),h=r(o,a);return h[h.length-1]}}function h(t,e,i,r){return function(n,s,o,a){var h=t(t(i(t(e(o[1],a[0]),e(-a[1],o[0])),s[2]),t(i(t(e(s[1],a[0]),e(-a[1],s[0])),-o[2]),i(t(e(s[1],o[0]),e(-o[1],s[0])),a[2]))),t(i(t(e(s[1],a[0]),e(-a[1],s[0])),n[2]),t(i(t(e(n[1],a[0]),e(-a[1],n[0])),-s[2]),i(t(e(n[1],s[0]),e(-s[1],n[0])),a[2])))),l=t(t(i(t(e(o[1],a[0]),e(-a[1],o[0])),n[2]),t(i(t(e(n[1],a[0]),e(-a[1],n[0])),-o[2]),i(t(e(n[1],o[0]),e(-o[1],n[0])),a[2]))),t(i(t(e(s[1],o[0]),e(-o[1],s[0])),n[2]),t(i(t(e(n[1],o[0]),e(-o[1],n[0])),-s[2]),i(t(e(n[1],s[0]),e(-s[1],n[0])),o[2])))),u=r(h,l);return u[u.length-1]}}function l(t,e,i,r){return function(n,s,o,a,h){var l=t(t(t(i(t(i(t(e(a[1],h[0]),e(-h[1],a[0])),o[2]),t(i(t(e(o[1],h[0]),e(-h[1],o[0])),-a[2]),i(t(e(o[1],a[0]),e(-a[1],o[0])),h[2]))),s[3]),t(i(t(i(t(e(a[1],h[0]),e(-h[1],a[0])),s[2]),t(i(t(e(s[1],h[0]),e(-h[1],s[0])),-a[2]),i(t(e(s[1],a[0]),e(-a[1],s[0])),h[2]))),-o[3]),i(t(i(t(e(o[1],h[0]),e(-h[1],o[0])),s[2]),t(i(t(e(s[1],h[0]),e(-h[1],s[0])),-o[2]),i(t(e(s[1],o[0]),e(-o[1],s[0])),h[2]))),a[3]))),t(i(t(i(t(e(o[1],a[0]),e(-a[1],o[0])),s[2]),t(i(t(e(s[1],a[0]),e(-a[1],s[0])),-o[2]),i(t(e(s[1],o[0]),e(-o[1],s[0])),a[2]))),-h[3]),t(i(t(i(t(e(a[1],h[0]),e(-h[1],a[0])),s[2]),t(i(t(e(s[1],h[0]),e(-h[1],s[0])),-a[2]),i(t(e(s[1],a[0]),e(-a[1],s[0])),h[2]))),n[3]),i(t(i(t(e(a[1],h[0]),e(-h[1],a[0])),n[2]),t(i(t(e(n[1],h[0]),e(-h[1],n[0])),-a[2]),i(t(e(n[1],a[0]),e(-a[1],n[0])),h[2]))),-s[3])))),t(t(i(t(i(t(e(s[1],h[0]),e(-h[1],s[0])),n[2]),t(i(t(e(n[1],h[0]),e(-h[1],n[0])),-s[2]),i(t(e(n[1],s[0]),e(-s[1],n[0])),h[2]))),a[3]),t(i(t(i(t(e(s[1],a[0]),e(-a[1],s[0])),n[2]),t(i(t(e(n[1],a[0]),e(-a[1],n[0])),-s[2]),i(t(e(n[1],s[0]),e(-s[1],n[0])),a[2]))),-h[3]),i(t(i(t(e(o[1],a[0]),e(-a[1],o[0])),s[2]),t(i(t(e(s[1],a[0]),e(-a[1],s[0])),-o[2]),i(t(e(s[1],o[0]),e(-o[1],s[0])),a[2]))),n[3]))),t(i(t(i(t(e(o[1],a[0]),e(-a[1],o[0])),n[2]),t(i(t(e(n[1],a[0]),e(-a[1],n[0])),-o[2]),i(t(e(n[1],o[0]),e(-o[1],n[0])),a[2]))),-s[3]),t(i(t(i(t(e(s[1],a[0]),e(-a[1],s[0])),n[2]),t(i(t(e(n[1],a[0]),e(-a[1],n[0])),-s[2]),i(t(e(n[1],s[0]),e(-s[1],n[0])),a[2]))),o[3]),i(t(i(t(e(s[1],o[0]),e(-o[1],s[0])),n[2]),t(i(t(e(n[1],o[0]),e(-o[1],n[0])),-s[2]),i(t(e(n[1],s[0]),e(-s[1],n[0])),o[2]))),-a[3]))))),u=t(t(t(i(t(i(t(e(a[1],h[0]),e(-h[1],a[0])),o[2]),t(i(t(e(o[1],h[0]),e(-h[1],o[0])),-a[2]),i(t(e(o[1],a[0]),e(-a[1],o[0])),h[2]))),n[3]),i(t(i(t(e(a[1],h[0]),e(-h[1],a[0])),n[2]),t(i(t(e(n[1],h[0]),e(-h[1],n[0])),-a[2]),i(t(e(n[1],a[0]),e(-a[1],n[0])),h[2]))),-o[3])),t(i(t(i(t(e(o[1],h[0]),e(-h[1],o[0])),n[2]),t(i(t(e(n[1],h[0]),e(-h[1],n[0])),-o[2]),i(t(e(n[1],o[0]),e(-o[1],n[0])),h[2]))),a[3]),i(t(i(t(e(o[1],a[0]),e(-a[1],o[0])),n[2]),t(i(t(e(n[1],a[0]),e(-a[1],n[0])),-o[2]),i(t(e(n[1],o[0]),e(-o[1],n[0])),a[2]))),-h[3]))),t(t(i(t(i(t(e(o[1],h[0]),e(-h[1],o[0])),s[2]),t(i(t(e(s[1],h[0]),e(-h[1],s[0])),-o[2]),i(t(e(s[1],o[0]),e(-o[1],s[0])),h[2]))),n[3]),i(t(i(t(e(o[1],h[0]),e(-h[1],o[0])),n[2]),t(i(t(e(n[1],h[0]),e(-h[1],n[0])),-o[2]),i(t(e(n[1],o[0]),e(-o[1],n[0])),h[2]))),-s[3])),t(i(t(i(t(e(s[1],h[0]),e(-h[1],s[0])),n[2]),t(i(t(e(n[1],h[0]),e(-h[1],n[0])),-s[2]),i(t(e(n[1],s[0]),e(-s[1],n[0])),h[2]))),o[3]),i(t(i(t(e(s[1],o[0]),e(-o[1],s[0])),n[2]),t(i(t(e(n[1],o[0]),e(-o[1],n[0])),-s[2]),i(t(e(n[1],s[0]),e(-s[1],n[0])),o[2]))),-h[3])))),c=r(l,u);return c[c.length-1]}}function u(t){return(3===t?a:4===t?h:l)(n,r,s,o)}var c=u(3),d=u(4),f=[function(){return 0},function(){return 0},function(t,e){return e[0]-t[0]},function(t,e,i){var r,n=(t[1]-i[1])*(e[0]-i[0]),s=(t[0]-i[0])*(e[1]-i[1]),o=n-s;if(n>0){if(s<=0)return o;r=n+s}else{if(!(n<0))return o;if(s>=0)return o;r=-(n+s)}var a=33306690738754716e-32*r;return o>=a||o<=-a?o:c(t,e,i)},function(t,e,i,r){var n=t[0]-r[0],s=e[0]-r[0],o=i[0]-r[0],a=t[1]-r[1],h=e[1]-r[1],l=i[1]-r[1],u=t[2]-r[2],c=e[2]-r[2],f=i[2]-r[2],g=s*l,m=o*h,p=o*a,w=n*l,_=n*h,b=s*a,y=u*(g-m)+c*(p-w)+f*(_-b),v=7771561172376103e-31*((Math.abs(g)+Math.abs(m))*Math.abs(u)+(Math.abs(p)+Math.abs(w))*Math.abs(c)+(Math.abs(_)+Math.abs(b))*Math.abs(f));return y>v||-y>v?y:d(t,e,i,r)}];function g(t){var e=f[t.length];return e||(e=f[t.length]=u(t.length)),e.apply(void 0,t)}function m(t,e,i,r,n,s,o){return function(e,i,a,h,l){switch(arguments.length){case 0:case 1:return 0;case 2:return r(e,i);case 3:return n(e,i,a);case 4:return s(e,i,a,h);case 5:return o(e,i,a,h,l)}for(var u=new Array(arguments.length),c=0;c<arguments.length;++c)u[c]=arguments[c];return t(u)}}!function(){for(;f.length<=5;)f.push(u(f.length));t.exports=m.apply(void 0,[g].concat(f));for(var e=0;e<=5;++e)t.exports[e]=f[e]}()},4707:(t,e,i)=>{t.exports=function(t,e){for(var i=e[0],n=e[1],s=t.length,o=1,a=s,h=0,l=s-1;h<a;l=h++){var u=t[h],c=t[l],d=u[1],f=c[1];if(f<d){if(f<n&&n<d){if(0===(g=r(u,c,e)))return 0;o^=0<g|0}else if(n===d&&d<t[(h+1)%s][1]){if(0===(g=r(u,c,e)))return 0;o^=0<g|0}}else if(d<f){if(d<n&&n<f){if(0===(g=r(u,c,e)))return 0;o^=g<0|0}else if(n===d&&t[(h+1)%s][1]<d){var g;if(0===(g=r(u,c,e)))return 0;o^=g<0|0}}else if(n===d){var m=Math.min(u[0],c[0]),p=Math.max(u[0],c[0]);if(0===h){for(;l>0;){var w=(l+s-1)%s;if((y=t[w])[1]!==n)break;var _=y[0];m=Math.min(m,_),p=Math.max(p,_),l=w}if(0===l)return m<=i&&i<=p?0:1;a=l+1}for(var b=t[(l+s-1)%s][1];h+1<a;){var y;if((y=t[h+1])[1]!==n)break;_=y[0],m=Math.min(m,_),p=Math.max(p,_),h+=1}if(m<=i&&i<=p)return 0;var v=t[(h+1)%s][1];i<m&&b<n!=v<n&&(o^=1)}}return 2*o-1};var r=i(146)},5442:(t,e,i)=>{"use strict";var r=i(8005),n=i(6359);t.exports=function(t,e){var i=t.length;if(1===i){var s=r(t[0],e);return s[0]?s:[s[1]]}var o=new Array(2*i),a=[.1,.1],h=[.1,.1],l=0;r(t[0],e,a),a[0]&&(o[l++]=a[0]);for(var u=1;u<i;++u){r(t[u],e,h);var c=a[1];n(c,h[0],a),a[0]&&(o[l++]=a[0]);var d=h[1],f=a[1],g=d+f,m=f-(g-d);a[1]=g,m&&(o[l++]=m)}return a[1]&&(o[l++]=a[1]),0===l&&(o[l++]=0),o.length=l,o}},7972:t=>{"use strict";t.exports=function(t,e){var i=0|t.length,r=0|e.length;if(1===i&&1===r)return function(t,e){var i=t+e,r=i-t,n=t-(i-r)+(e-r);return n?[n,i]:[i]}(t[0],-e[0]);var n,s,o=new Array(i+r),a=0,h=0,l=0,u=Math.abs,c=t[h],d=u(c),f=-e[l],g=u(f);d<g?(s=c,(h+=1)<i&&(d=u(c=t[h]))):(s=f,(l+=1)<r&&(g=u(f=-e[l]))),h<i&&d<g||l>=r?(n=c,(h+=1)<i&&(d=u(c=t[h]))):(n=f,(l+=1)<r&&(g=u(f=-e[l])));for(var m,p,w=n+s,_=w-n,b=s-_,y=b,v=w;h<i&&l<r;)d<g?(n=c,(h+=1)<i&&(d=u(c=t[h]))):(n=f,(l+=1)<r&&(g=u(f=-e[l]))),(b=(s=y)-(_=(w=n+s)-n))&&(o[a++]=b),y=v-((m=v+w)-(p=m-v))+(w-p),v=m;for(;h<i;)(b=(s=y)-(_=(w=(n=c)+s)-n))&&(o[a++]=b),y=v-((m=v+w)-(p=m-v))+(w-p),v=m,(h+=1)<i&&(c=t[h]);for(;l<r;)(b=(s=y)-(_=(w=(n=f)+s)-n))&&(o[a++]=b),y=v-((m=v+w)-(p=m-v))+(w-p),v=m,(l+=1)<r&&(f=-e[l]);return y&&(o[a++]=y),v&&(o[a++]=v),a||(o[a++]=0),o.length=a,o}},6740:t=>{"use strict";t.exports=function(t,e){var i=0|t.length,r=0|e.length;if(1===i&&1===r)return function(t,e){var i=t+e,r=i-t,n=t-(i-r)+(e-r);return n?[n,i]:[i]}(t[0],e[0]);var n,s,o=new Array(i+r),a=0,h=0,l=0,u=Math.abs,c=t[h],d=u(c),f=e[l],g=u(f);d<g?(s=c,(h+=1)<i&&(d=u(c=t[h]))):(s=f,(l+=1)<r&&(g=u(f=e[l]))),h<i&&d<g||l>=r?(n=c,(h+=1)<i&&(d=u(c=t[h]))):(n=f,(l+=1)<r&&(g=u(f=e[l])));for(var m,p,w=n+s,_=w-n,b=s-_,y=b,v=w;h<i&&l<r;)d<g?(n=c,(h+=1)<i&&(d=u(c=t[h]))):(n=f,(l+=1)<r&&(g=u(f=e[l]))),(b=(s=y)-(_=(w=n+s)-n))&&(o[a++]=b),y=v-((m=v+w)-(p=m-v))+(w-p),v=m;for(;h<i;)(b=(s=y)-(_=(w=(n=c)+s)-n))&&(o[a++]=b),y=v-((m=v+w)-(p=m-v))+(w-p),v=m,(h+=1)<i&&(c=t[h]);for(;l<r;)(b=(s=y)-(_=(w=(n=f)+s)-n))&&(o[a++]=b),y=v-((m=v+w)-(p=m-v))+(w-p),v=m,(l+=1)<r&&(f=e[l]);return y&&(o[a++]=y),v&&(o[a++]=v),a||(o[a++]=0),o.length=a,o}},3379:t=>{"use strict";var e=[];function i(t){for(var i=-1,r=0;r<e.length;r++)if(e[r].identifier===t){i=r;break}return i}function r(t,r){for(var s={},o=[],a=0;a<t.length;a++){var h=t[a],l=r.base?h[0]+r.base:h[0],u=s[l]||0,c="".concat(l," ").concat(u);s[l]=u+1;var d=i(c),f={css:h[1],media:h[2],sourceMap:h[3],supports:h[4],layer:h[5]};if(-1!==d)e[d].references++,e[d].updater(f);else{var g=n(f,r);r.byIndex=a,e.splice(a,0,{identifier:c,updater:g,references:1})}o.push(c)}return o}function n(t,e){var i=e.domAPI(e);return i.update(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap&&e.supports===t.supports&&e.layer===t.layer)return;i.update(t=e)}else i.remove()}}t.exports=function(t,n){var s=r(t=t||[],n=n||{});return function(t){t=t||[];for(var o=0;o<s.length;o++){var a=i(s[o]);e[a].references--}for(var h=r(t,n),l=0;l<s.length;l++){var u=i(s[l]);0===e[u].references&&(e[u].updater(),e.splice(u,1))}s=h}}},569:t=>{"use strict";var e={};t.exports=function(t,i){var r=function(t){if(void 0===e[t]){var i=document.querySelector(t);if(window.HTMLIFrameElement&&i instanceof window.HTMLIFrameElement)try{i=i.contentDocument.head}catch(t){i=null}e[t]=i}return e[t]}(t);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(i)}},9216:t=>{"use strict";t.exports=function(t){var e=document.createElement("style");return t.setAttributes(e,t.attributes),t.insert(e,t.options),e}},3565:(t,e,i)=>{"use strict";t.exports=function(t){var e=i.nc;e&&t.setAttribute("nonce",e)}},7795:t=>{"use strict";t.exports=function(t){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var e=t.insertStyleElement(t);return{update:function(i){!function(t,e,i){var r="";i.supports&&(r+="@supports (".concat(i.supports,") {")),i.media&&(r+="@media ".concat(i.media," {"));var n=void 0!==i.layer;n&&(r+="@layer".concat(i.layer.length>0?" ".concat(i.layer):""," {")),r+=i.css,n&&(r+="}"),i.media&&(r+="}"),i.supports&&(r+="}");var s=i.sourceMap;s&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(s))))," */")),e.styleTagTransform(r,t,e.options)}(e,t,i)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)}}}},4589:t=>{"use strict";t.exports=function(t,e){if(e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}},8005:t=>{"use strict";t.exports=function(t,i,r){var n=t*i,s=e*t,o=s-(s-t),a=t-o,h=e*i,l=h-(h-i),u=i-l,c=a*u-(n-o*l-a*l-o*u);return r?(r[0]=c,r[1]=n,r):[c,n]};var e=+(Math.pow(2,27)+1)},6359:t=>{"use strict";t.exports=function(t,e,i){var r=t+e,n=r-t,s=e-n,o=t-(r-n);return i?(i[0]=o+s,i[1]=r,i):[o+s,r]}},6732:(t,e,i)=>{"use strict";var r=i(7963),n=navigator.hardwareConcurrency||1;function s(t,e){if("string"!=typeof t&&"function"!=typeof t)throw new TypeError("func argument must be a function");if(void 0===e&&(e={}),"object"!=typeof e||null===e)throw new TypeError("options argument must be an object");this._workerCode=t.toString(),void 0===e.maxWorkers||"auto"===e.maxWorkers?this._numWorkers=Math.min(n-1,1):e.maxWorkers>0?this._numWorkers=Math.min(e.maxWorkers,n):this._numWorkers=n,this._workers=new Map,this._timeout=e.timeout||0,this._terminateOnError=!!e.terminateOnError;var i=e.deps;"string"==typeof i&&(i=[i]),Array.isArray(i)||(i=void 0),this._id=0,this._terminated=!1,this._working=0,this._waiting=[],this._init(i)}Function.prototype,s.prototype._init=function(t){for(var e=r.newWorkerURL(this._workerCode,t),i=0;i<this._numWorkers;i++){var n=new Worker(e);n.onmessage=this._onmessage.bind(this,n),n.onerror=this._onerror.bind(this,n),n.running=!1,n.id=i,this._workers.set(n,null)}URL.revokeObjectURL(e)},s.prototype._onerror=function(t,e){if(!this._terminated){this._working--,t.running=!1;var i=this._workers.get(t);i&&i[1](e.message),this._workers.set(t,null),this._terminateOnError?this.terminate():this._exec()}},s.prototype._onmessage=function(t,e){if(!this._terminated){this._working--,t.running=!1;var i=this._workers.get(t);i&&i[0](e.data.data),this._workers.set(t,null),this._exec()}},s.prototype._exec=function(){for(var t of this._workers.keys()){if(this._working===this._numWorkers||0===this._waiting.length)return;if(!t.running)for(var e=0;e<this._waiting.length;e++){var i=this._waiting[e];if("number"!=typeof i[4]||i[4]===t.id){this._waiting.splice(e,1),t.postMessage({action:"exec",event:i[0],args:i[1]},i[2]),t.running=!0,t.time=Date.now(),this._workers.set(t,i[3]),this._working++;break}}}},s.prototype.terminate=function(){if(!this._terminated){for(var t of this._workers)t[0].terminate(),t[1]&&t[1][1](new Error("Terminated"));this._workers.clear(),this._waiting=[],this._working=0,this._terminated=!0}},s.prototype.postAll=function(t,e){if(this._terminated)throw new Error("Cannot post (terminated)");var i=[];for(var r of this._workers.keys())i.push(this.post(t,e,[],r.id));return Promise.all(i)},s.prototype.post=function(t,e,i,r){void 0===e&&(e=[]),void 0===i&&(i=[]),Array.isArray(e)||(e=[e]),Array.isArray(i)||(i=[i]);var n=this;return new Promise((function(s,o){if(n._terminated)throw new Error("Cannot post (terminated)");n._waiting.push([t,e,i,[s,o],r]),n._exec()}))},t.exports=s},7963:(t,e)=>{"use strict";var i=function(){function t(){this._listeners={}}self.window=self,t.prototype.on=function(t,e){if(this._listeners[t])throw new RangeError("there is already a listener for "+t);if("function"!=typeof e)throw new TypeError("callback argument must be a function");this._listeners[t]=e},t.prototype._send=function(t,e,i){void 0===i?i=[]:Array.isArray(i)||(i=[i]),self.postMessage({id:t,data:e},i)},t.prototype._trigger=function(t,e){if(!this._listeners[t])throw new Error("event "+t+" is not defined");this._listeners[t].apply(null,e)};var e=new t;self.onmessage=function(t){switch(t.data.action){case"exec":t.data.args.unshift((function(i,r){e._send(t.data.id,i,r)})),e._trigger(t.data.event,t.data.args);break;case"ping":e._send(t.data.id,"pong");break;default:throw new Error("unexpected action: "+t.data.action)}}}.toString().split('"CODE";');e.newWorkerURL=function(t,e){var r=new Blob(["(",i[0],"importScripts.apply(self, "+JSON.stringify(e)+");\n","(",t,")();",i[1],")();"],{type:"application/javascript"});return URL.createObjectURL(r)}},2898:t=>{"use strict";t.exports={version:"1.0.1"}}},__webpack_module_cache__={};function __webpack_require__(t){var e=__webpack_module_cache__[t];if(void 0!==e)return e.exports;var i=__webpack_module_cache__[t]={id:t,exports:{}};return __webpack_modules__[t].call(i.exports,i,i.exports,__webpack_require__),i.exports}__webpack_require__.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return __webpack_require__.d(e,{a:e}),e},__webpack_require__.d=(t,e)=>{for(var i in e)__webpack_require__.o(e,i)&&!__webpack_require__.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},__webpack_require__.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),__webpack_require__.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},__webpack_require__.nc=void 0;var __webpack_exports__={};(()=>{"use strict";var t={};__webpack_require__.r(t),__webpack_require__.d(t,{CMYK:()=>bl,GREY:()=>ml,HSL:()=>wl,HSV:()=>_l,RGB:()=>pl});var e={};__webpack_require__.r(e),__webpack_require__.d(e,{tagsById:()=>Sl,tagsByName:()=>Al});var i={};__webpack_require__.r(i),__webpack_require__.d(i,{tagsById:()=>Tl,tagsByName:()=>Rl});var r={};__webpack_require__.r(r),__webpack_require__.d(r,{tagsById:()=>Pl,tagsByName:()=>Il});const n=class{constructor(t){this.propagationStopped,this.defaultPrevented,this.type=t,this.target=null}preventDefault(){this.defaultPrevented=!0}stopPropagation(){this.propagationStopped=!0}},s="propertychange",o=class{constructor(){this.disposed=!1}dispose(){this.disposed||(this.disposed=!0,this.disposeInternal())}disposeInternal(){}};function a(t,e){return t>e?1:t<e?-1:0}function h(t,e,i){if(t[0]<=e)return 0;const r=t.length;if(e<=t[r-1])return r-1;if("function"==typeof i){for(let n=1;n<r;++n){const r=t[n];if(r===e)return n;if(r<e)return i(e,t[n-1],r)>0?n-1:n}return r-1}if(i>0){for(let i=1;i<r;++i)if(t[i]<e)return i-1;return r-1}if(i<0){for(let i=1;i<r;++i)if(t[i]<=e)return i;return r-1}for(let i=1;i<r;++i){if(t[i]==e)return i;if(t[i]<e)return t[i-1]-e<e-t[i]?i-1:i}return r-1}function l(t,e){const i=t.length;if(i!==e.length)return!1;for(let r=0;r<i;r++)if(t[r]!==e[r])return!1;return!0}function u(){return!0}function c(){return!1}function d(){}function f(t){for(const e in t)delete t[e]}const g=class extends o{constructor(t){super(),this.eventTarget_=t,this.pendingRemovals_=null,this.dispatching_=null,this.listeners_=null}addEventListener(t,e){if(!t||!e)return;const i=this.listeners_||(this.listeners_={}),r=i[t]||(i[t]=[]);r.includes(e)||r.push(e)}dispatchEvent(t){const e="string"==typeof t,i=e?t:t.type,r=this.listeners_&&this.listeners_[i];if(!r)return;const s=e?new n(t):t;s.target||(s.target=this.eventTarget_||this);const o=this.dispatching_||(this.dispatching_={}),a=this.pendingRemovals_||(this.pendingRemovals_={});let h;i in o||(o[i]=0,a[i]=0),++o[i];for(let t=0,e=r.length;t<e;++t)if(h="handleEvent"in r[t]?r[t].handleEvent(s):r[t].call(this,s),!1===h||s.propagationStopped){h=!1;break}if(0==--o[i]){let t=a[i];for(delete a[i];t--;)this.removeEventListener(i,d);delete o[i]}return h}disposeInternal(){this.listeners_&&f(this.listeners_)}getListeners(t){return this.listeners_&&this.listeners_[t]||void 0}hasListener(t){return!!this.listeners_&&(t?t in this.listeners_:Object.keys(this.listeners_).length>0)}removeEventListener(t,e){if(!this.listeners_)return;const i=this.listeners_[t];if(!i)return;const r=i.indexOf(e);-1!==r&&(this.pendingRemovals_&&t in this.pendingRemovals_?(i[r]=d,++this.pendingRemovals_[t]):(i.splice(r,1),0===i.length&&delete this.listeners_[t]))}},m="change",p="contextmenu",w="click",_="keydown",b="keypress",y="touchmove",v="wheel";function x(t,e,i,r,n){if(r&&r!==t&&(i=i.bind(r)),n){const r=i;i=function(){t.removeEventListener(e,i),r.apply(this,arguments)}}const s={target:t,type:e,listener:i};return t.addEventListener(e,i),s}function M(t,e,i,r){return x(t,e,i,r,!0)}function k(t){t&&t.target&&(t.target.removeEventListener(t.type,t.listener),f(t))}class E extends g{constructor(){super(),this.on=this.onInternal,this.once=this.onceInternal,this.un=this.unInternal,this.revision_=0}changed(){++this.revision_,this.dispatchEvent(m)}getRevision(){return this.revision_}onInternal(t,e){if(Array.isArray(t)){const i=t.length,r=new Array(i);for(let n=0;n<i;++n)r[n]=x(this,t[n],e);return r}return x(this,t,e)}onceInternal(t,e){let i;if(Array.isArray(t)){const r=t.length;i=new Array(r);for(let n=0;n<r;++n)i[n]=M(this,t[n],e)}else i=M(this,t,e);return e.ol_key=i,i}unInternal(t,e){const i=e.ol_key;if(i)!function(t){if(Array.isArray(t))for(let e=0,i=t.length;e<i;++e)k(t[e]);else k(t)}(i);else if(Array.isArray(t))for(let i=0,r=t.length;i<r;++i)this.removeEventListener(t[i],e);else this.removeEventListener(t,e)}}E.prototype.on,E.prototype.once,E.prototype.un;const C=E;function S(){throw new Error("Unimplemented abstract method.")}let A=0;function T(t){return t.ol_uid||(t.ol_uid=String(++A))}class R extends n{constructor(t,e,i){super(t),this.key=e,this.oldValue=i}}const P=class extends C{constructor(t){super(),this.on,this.once,this.un,T(this),this.values_=null,void 0!==t&&this.setProperties(t)}get(t){let e;return this.values_&&this.values_.hasOwnProperty(t)&&(e=this.values_[t]),e}getKeys(){return this.values_&&Object.keys(this.values_)||[]}getProperties(){return this.values_&&Object.assign({},this.values_)||{}}getPropertiesInternal(){return this.values_}hasProperties(){return!!this.values_}notify(t,e){let i;i=`change:${t}`,this.hasListener(i)&&this.dispatchEvent(new R(i,t,e)),i=s,this.hasListener(i)&&this.dispatchEvent(new R(i,t,e))}addChangeListener(t,e){this.addEventListener(`change:${t}`,e)}removeChangeListener(t,e){this.removeEventListener(`change:${t}`,e)}set(t,e,i){const r=this.values_||(this.values_={});if(i)r[t]=e;else{const i=r[t];r[t]=e,i!==e&&this.notify(t,i)}}setProperties(t,e){for(const i in t)this.set(i,t[i],e)}applyProperties(t){t.values_&&Object.assign(this.values_||(this.values_={}),t.values_)}unset(t,e){if(this.values_&&t in this.values_){const i=this.values_[t];delete this.values_[t],function(t){let e;for(e in t)return!1;return!e}(this.values_)&&(this.values_=null),e||this.notify(t,i)}}},I="add",D="remove",L="length";class F extends n{constructor(t,e,i){super(t),this.element=e,this.index=i}}const z=class extends P{constructor(t,e){if(super(),this.on,this.once,this.un,e=e||{},this.unique_=!!e.unique,this.array_=t||[],this.unique_)for(let t=0,e=this.array_.length;t<e;++t)this.assertUnique_(this.array_[t],t);this.updateLength_()}clear(){for(;this.getLength()>0;)this.pop()}extend(t){for(let e=0,i=t.length;e<i;++e)this.push(t[e]);return this}forEach(t){const e=this.array_;for(let i=0,r=e.length;i<r;++i)t(e[i],i,e)}getArray(){return this.array_}item(t){return this.array_[t]}getLength(){return this.get(L)}insertAt(t,e){if(t<0||t>this.getLength())throw new Error("Index out of bounds: "+t);this.unique_&&this.assertUnique_(e),this.array_.splice(t,0,e),this.updateLength_(),this.dispatchEvent(new F(I,e,t))}pop(){return this.removeAt(this.getLength()-1)}push(t){this.unique_&&this.assertUnique_(t);const e=this.getLength();return this.insertAt(e,t),this.getLength()}remove(t){const e=this.array_;for(let i=0,r=e.length;i<r;++i)if(e[i]===t)return this.removeAt(i)}removeAt(t){if(t<0||t>=this.getLength())return;const e=this.array_[t];return this.array_.splice(t,1),this.updateLength_(),this.dispatchEvent(new F(D,e,t)),e}setAt(t,e){if(t>=this.getLength())return void this.insertAt(t,e);if(t<0)throw new Error("Index out of bounds: "+t);this.unique_&&this.assertUnique_(e,t);const i=this.array_[t];this.array_[t]=e,this.dispatchEvent(new F(D,i,t)),this.dispatchEvent(new F(I,e,t))}updateLength_(){this.set(L,this.array_.length)}assertUnique_(t,e){for(let i=0,r=this.array_.length;i<r;++i)if(this.array_[i]===t&&i!==e)throw new Error("Duplicate item added to a unique collection")}},B="undefined"!=typeof navigator&&void 0!==navigator.userAgent?navigator.userAgent.toLowerCase():"",N=B.includes("firefox"),O=(B.includes("safari")&&!B.includes("chrom")&&(B.includes("version/15.4")||/cpu (os|iphone os) 15_4 like mac os x/.test(B)),B.includes("webkit")&&!B.includes("edge")),U=B.includes("macintosh"),V="undefined"!=typeof devicePixelRatio?devicePixelRatio:1,Y="undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof OffscreenCanvas&&self instanceof WorkerGlobalScope,X="undefined"!=typeof Image&&Image.prototype.decode,j=function(){let t=!1;try{const e=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("_",null,e),window.removeEventListener("_",null,e)}catch(t){}return t}();function G(t,e){if(!t)throw new Error(e)}function q(t,e){const i=e[0],r=e[1];return e[0]=t[0]*i+t[2]*r+t[4],e[1]=t[1]*i+t[3]*r+t[5],e}function Z(t,e,i,r,n,s,o,a){const h=Math.sin(s),l=Math.cos(s);return t[0]=r*l,t[1]=n*h,t[2]=-r*h,t[3]=n*l,t[4]=o*r*l-a*r*h+e,t[5]=o*n*h+a*n*l+i,t}function K(t,e){const i=(r=e)[0]*r[3]-r[1]*r[2];var r;G(0!==i,"Transformation matrix cannot be inverted");const n=e[0],s=e[1],o=e[2],a=e[3],h=e[4],l=e[5];return t[0]=a/i,t[1]=-s/i,t[2]=-o/i,t[3]=n/i,t[4]=(o*l-a*h)/i,t[5]=-(n*l-s*h)/i,t}let H;new Array(6);const W={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};function $(t){const e=[1/0,1/0,-1/0,-1/0];for(let i=0,r=t.length;i<r;++i)st(e,t[i]);return e}function Q(t,e,i){let r,n;return r=e<t[0]?t[0]-e:t[2]<e?e-t[2]:0,n=i<t[1]?t[1]-i:t[3]<i?i-t[3]:0,r*r+n*n}function J(t,e){return tt(t,e[0],e[1])}function tt(t,e,i){return t[0]<=e&&e<=t[2]&&t[1]<=i&&i<=t[3]}function et(t,e){const i=t[0],r=t[1],n=t[2],s=t[3],o=e[0],a=e[1];let h=W.UNKNOWN;return o<i?h|=W.LEFT:o>n&&(h|=W.RIGHT),a<r?h|=W.BELOW:a>s&&(h|=W.ABOVE),h===W.UNKNOWN&&(h=W.INTERSECTING),h}function it(t,e,i,r,n){return n?(n[0]=t,n[1]=e,n[2]=i,n[3]=r,n):[t,e,i,r]}function rt(t){return it(1/0,1/0,-1/0,-1/0,t)}function nt(t,e){return t[0]==e[0]&&t[2]==e[2]&&t[1]==e[1]&&t[3]==e[3]}function st(t,e){e[0]<t[0]&&(t[0]=e[0]),e[0]>t[2]&&(t[2]=e[0]),e[1]<t[1]&&(t[1]=e[1]),e[1]>t[3]&&(t[3]=e[1])}function ot(t,e,i,r,n){for(;i<r;i+=n)at(t,e[i],e[i+1]);return t}function at(t,e,i){t[0]=Math.min(t[0],e),t[1]=Math.min(t[1],i),t[2]=Math.max(t[2],e),t[3]=Math.max(t[3],i)}function ht(t,e){let i;return i=e(ut(t)),i||(i=e(ct(t)),i||(i=e(bt(t)),i||(i=e(_t(t)),i||!1)))}function lt(t){let e=0;return xt(t)||(e=yt(t)*pt(t)),e}function ut(t){return[t[0],t[1]]}function ct(t){return[t[2],t[1]]}function dt(t){return[(t[0]+t[2])/2,(t[1]+t[3])/2]}function ft(t,e){let i;if("bottom-left"===e)i=ut(t);else if("bottom-right"===e)i=ct(t);else if("top-left"===e)i=_t(t);else{if("top-right"!==e)throw new Error("Invalid corner");i=bt(t)}return i}function gt(t,e,i,r,n){const[s,o,a,h,l,u,c,d]=mt(t,e,i,r);return it(Math.min(s,a,l,c),Math.min(o,h,u,d),Math.max(s,a,l,c),Math.max(o,h,u,d),n)}function mt(t,e,i,r){const n=e*r[0]/2,s=e*r[1]/2,o=Math.cos(i),a=Math.sin(i),h=n*o,l=n*a,u=s*o,c=s*a,d=t[0],f=t[1];return[d-h+c,f-l-u,d-h-c,f-l+u,d+h-c,f+l+u,d+h+c,f+l-u,d-h+c,f-l-u]}function pt(t){return t[3]-t[1]}function wt(t,e,i){const r=i||[1/0,1/0,-1/0,-1/0];return vt(t,e)?(t[0]>e[0]?r[0]=t[0]:r[0]=e[0],t[1]>e[1]?r[1]=t[1]:r[1]=e[1],t[2]<e[2]?r[2]=t[2]:r[2]=e[2],t[3]<e[3]?r[3]=t[3]:r[3]=e[3]):rt(r),r}function _t(t){return[t[0],t[3]]}function bt(t){return[t[2],t[3]]}function yt(t){return t[2]-t[0]}function vt(t,e){return t[0]<=e[2]&&t[2]>=e[0]&&t[1]<=e[3]&&t[3]>=e[1]}function xt(t){return t[2]<t[0]||t[3]<t[1]}function Mt(t,e,i,r){if(xt(t))return rt(i);let n=[];if(r>1){const e=t[2]-t[0],i=t[3]-t[1];for(let s=0;s<r;++s)n.push(t[0]+e*s/r,t[1],t[2],t[1]+i*s/r,t[2]-e*s/r,t[3],t[0],t[3]-i*s/r)}else n=[t[0],t[1],t[2],t[1],t[2],t[3],t[0],t[3]];e(n,n,2);const s=[],o=[];for(let t=0,e=n.length;t<e;t+=2)s.push(n[t]),o.push(n[t+1]);return function(t,e,i){return it(Math.min.apply(null,t),Math.min.apply(null,e),Math.max.apply(null,t),Math.max.apply(null,e),i)}(s,o,i)}const kt={name:"rgb",min:[0,0,0],max:[255,255,255],channel:["red","green","blue"],alias:["RGB"]};var Et={name:"xyz",min:[0,0,0],channel:["X","Y","Z"],alias:["XYZ","ciexyz","cie1931"],whitepoint:{2:{A:[109.85,100,35.585],C:[98.074,100,118.232],D50:[96.422,100,82.521],D55:[95.682,100,92.149],D65:[95.045592705167,100,108.9057750759878],D75:[94.972,100,122.638],F2:[99.187,100,67.395],F7:[95.044,100,108.755],F11:[100.966,100,64.37],E:[100,100,100]},10:{A:[111.144,100,35.2],C:[97.285,100,116.145],D50:[96.72,100,81.427],D55:[95.799,100,90.926],D65:[94.811,100,107.304],D75:[94.416,100,120.641],F2:[103.28,100,69.026],F7:[95.792,100,107.687],F11:[103.866,100,65.627],E:[100,100,100]}}};Et.max=Et.whitepoint[2].D65,Et.rgb=function(t,e){e=e||Et.whitepoint[2].E;var i,r,n,s=t[0]/e[0],o=t[1]/e[1],a=t[2]/e[2];return r=-.96924363628087*s+1.87596750150772*o+.041555057407175*a,n=.055630079696993*s+-.20397695888897*o+1.056971514242878*a,i=(i=3.240969941904521*s+-1.537383177570093*o+-.498610760293*a)>.0031308?1.055*Math.pow(i,1/2.4)-.055:i*=12.92,r=r>.0031308?1.055*Math.pow(r,1/2.4)-.055:r*=12.92,n=n>.0031308?1.055*Math.pow(n,1/2.4)-.055:n*=12.92,[255*(i=Math.min(Math.max(0,i),1)),255*(r=Math.min(Math.max(0,r),1)),255*(n=Math.min(Math.max(0,n),1))]},kt.xyz=function(t,e){var i=t[0]/255,r=t[1]/255,n=t[2]/255,s=.21263900587151*(i=i>.04045?Math.pow((i+.055)/1.055,2.4):i/12.92)+.71516867876775*(r=r>.04045?Math.pow((r+.055)/1.055,2.4):r/12.92)+.072192315360733*(n=n>.04045?Math.pow((n+.055)/1.055,2.4):n/12.92),o=.019330818715591*i+.11919477979462*r+.95053215224966*n;return[(.41239079926595*i+.35758433938387*r+.18048078840183*n)*(e=e||Et.whitepoint[2].E)[0],s*e[1],o*e[2]]};const Ct=Et,St={name:"luv",min:[0,-134,-140],max:[100,224,122],channel:["lightness","u","v"],alias:["LUV","cieluv","cie1976"],xyz:function(t,e,i){var r,n,s,o,a,h,l,u,c;return s=t[0],o=t[1],a=t[2],0===s?[0,0,0]:(e=e||"D65",i=i||2,r=o/(13*s)+4*(l=Ct.whitepoint[i][e][0])/(l+15*(u=Ct.whitepoint[i][e][1])+3*(c=Ct.whitepoint[i][e][2]))||0,n=a/(13*s)+9*u/(l+15*u+3*c)||0,[9*(h=s>8?u*Math.pow((s+16)/116,3):u*s*.0011070564598794539)*r/(4*n)||0,h,h*(12-3*r-20*n)/(4*n)||0])}};Ct.luv=function(t,e,i){var r,n,s,o,a,h,l,u,c,d,f;e=e||"D65",i=i||2,d=4*(l=Ct.whitepoint[i][e][0])/(l+15*(u=Ct.whitepoint[i][e][1])+3*(c=Ct.whitepoint[i][e][2])),f=9*u/(l+15*u+3*c),r=4*(o=t[0])/(o+15*(a=t[1])+3*(h=t[2]))||0,n=9*a/(o+15*a+3*h)||0;var g=a/u;return[s=g<=.008856451679035631?903.2962962962961*g:116*Math.pow(g,1/3)-16,13*s*(r-d),13*s*(n-f)]},St.lchuv=function(t){var e=t[0],i=t[1],r=t[2],n=Math.sqrt(i*i+r*r),s=360*Math.atan2(r,i)/2/Math.PI;return s<0&&(s+=360),[e,n,s]},Ct.lchuv=function(t){return St.lchuv(Ct.luv(t))};var At=__webpack_require__(8874);const Tt=function(t){var e,i,r=[],n=1;if("number"==typeof t)return{space:"rgb",values:[t>>>16,(65280&t)>>>8,255&t],alpha:1};if("number"==typeof t)return{space:"rgb",values:[t>>>16,(65280&t)>>>8,255&t],alpha:1};if(t=String(t).toLowerCase(),At[t])r=At[t].slice(),i="rgb";else if("transparent"===t)n=0,i="rgb",r=[0,0,0];else if("#"===t[0]){var s=t.slice(1),o=s.length;n=1,o<=4?(r=[parseInt(s[0]+s[0],16),parseInt(s[1]+s[1],16),parseInt(s[2]+s[2],16)],4===o&&(n=parseInt(s[3]+s[3],16)/255)):(r=[parseInt(s[0]+s[1],16),parseInt(s[2]+s[3],16),parseInt(s[4]+s[5],16)],8===o&&(n=parseInt(s[6]+s[7],16)/255)),r[0]||(r[0]=0),r[1]||(r[1]=0),r[2]||(r[2]=0),i="rgb"}else if(e=/^((?:rgba?|hs[lvb]a?|hwba?|cmyk?|xy[zy]|gray|lab|lchu?v?|[ly]uv|lms|oklch|oklab|color))\s*\(([^\)]*)\)/.exec(t)){var a=e[1],h="cmyk"===(i=a.replace(/a$/,""))?4:"gray"===i?1:3;r=e[2].trim().split(/\s*[,\/]\s*|\s+/),"color"===i&&(i=r.shift()),n=(r=r.map((function(t,e){if("%"===t[t.length-1])return t=parseFloat(t)/100,3===e?t:"rgb"===i?255*t:"h"===i[0]?100*t:"l"!==i[0]||e?"lab"===i?125*t:"lch"===i?e<2?150*t:360*t:"o"!==i[0]||e?"oklab"===i?.4*t:"oklch"===i?e<2?.4*t:360*t:t:t:100*t;if("h"===i[e]||2===e&&"h"===i[i.length-1]){if(void 0!==Rt[t])return Rt[t];if(t.endsWith("deg"))return parseFloat(t);if(t.endsWith("turn"))return 360*parseFloat(t);if(t.endsWith("grad"))return 360*parseFloat(t)/400;if(t.endsWith("rad"))return 180*parseFloat(t)/Math.PI}return"none"===t?0:parseFloat(t)}))).length>h?r.pop():1}else/[0-9](?:\s|\/|,)/.test(t)&&(r=t.match(/([0-9]+)/g).map((function(t){return parseFloat(t)})),i=t.match(/([a-z])/gi)?.join("")?.toLowerCase()||"rgb");return{space:i,values:r,alpha:n}};var Rt={red:0,orange:60,yellow:120,green:180,blue:240,purple:300};const Pt={name:"hsl",min:[0,0,0],max:[360,100,100],channel:["hue","saturation","lightness"],alias:["HSL"],rgb:function(t){var e,i,r,n,s,o=t[0]/360,a=t[1]/100,h=t[2]/100,l=0;if(0===a)return[s=255*h,s,s];for(e=2*h-(i=h<.5?h*(1+a):h+a-h*a),n=[0,0,0];l<3;)(r=o+1/3*-(l-1))<0?r++:r>1&&r--,s=6*r<1?e+6*(i-e)*r:2*r<1?i:3*r<2?e+(i-e)*(2/3-r)*6:e,n[l++]=255*s;return n}};function It(t,e,i){return Math.min(Math.max(t,e),i)}function Dt(t,e,i,r,n,s){const o=n-i,a=s-r;if(0!==o||0!==a){const h=((t-i)*o+(e-r)*a)/(o*o+a*a);h>1?(i=n,r=s):h>0&&(i+=o*h,r+=a*h)}return Lt(t,e,i,r)}function Lt(t,e,i,r){const n=i-t,s=r-e;return n*n+s*s}function Ft(t){return t*Math.PI/180}function zt(t,e){const i=t%e;return i*e<0?i+e:i}function Bt(t,e,i){return t+i*(e-t)}function Nt(t,e){const i=Math.pow(10,e);return Math.round(t*i)/i}function Ot(t,e){return Math.floor(Nt(t,e))}function Ut(t,e){return Math.ceil(Nt(t,e))}kt.hsl=function(t){var e,i,r=t[0]/255,n=t[1]/255,s=t[2]/255,o=Math.min(r,n,s),a=Math.max(r,n,s),h=a-o;return a===o?e=0:r===a?e=(n-s)/h:n===a?e=2+(s-r)/h:s===a&&(e=4+(r-n)/h),(e=Math.min(60*e,360))<0&&(e+=360),i=(o+a)/2,[e,100*(a===o?0:i<=.5?h/(a+o):h/(2-a-o)),100*i]};const Vt=1024,Yt={};let Xt=0;function jt(t){return Array.isArray(t)?t:function(t){if(Yt.hasOwnProperty(t))return Yt[t];if(Xt>=Vt){let t=0;for(const e in Yt)0==(3&t++)&&(delete Yt[e],--Xt)}const e=function(t){var e;Array.isArray(t)&&t.raw&&(t=String.raw(...arguments)),t instanceof Number&&(t=+t);var i=Tt(t);if(!i.space)return[];const r="h"===i.space[0]?Pt.min:kt.min,n="h"===i.space[0]?Pt.max:kt.max;return(e=Array(3))[0]=Math.min(Math.max(i.values[0],r[0]),n[0]),e[1]=Math.min(Math.max(i.values[1],r[1]),n[1]),e[2]=Math.min(Math.max(i.values[2],r[2]),n[2]),"h"===i.space[0]&&(e=Pt.rgb(e)),e.push(Math.min(Math.max(i.alpha,0),1)),e}(t);if(4!==e.length)throw new Error('Failed to parse "'+t+'" as color');for(const i of e)if(isNaN(i))throw new Error('Failed to parse "'+t+'" as color');return function(t){t[0]=It(t[0]+.5|0,0,255),t[1]=It(t[1]+.5|0,0,255),t[2]=It(t[2]+.5|0,0,255),t[3]=It(t[3],0,1)}(e),Yt[t]=e,++Xt,e}(t)}function Gt(t,e,i){return e+":"+t+":"+(i?function(t){return"string"==typeof t?t:function(t){let e=t[0];e!=(0|e)&&(e=e+.5|0);let i=t[1];i!=(0|i)&&(i=i+.5|0);let r=t[2];return r!=(0|r)&&(r=r+.5|0),"rgba("+e+","+i+","+r+","+(void 0===t[3]?1:Math.round(100*t[3])/100)+")"}(t)}(i):"null")}const qt=new class{constructor(){this.cache_={},this.cacheSize_=0,this.maxCacheSize_=32}clear(){this.cache_={},this.cacheSize_=0}canExpireCache(){return this.cacheSize_>this.maxCacheSize_}expire(){if(this.canExpireCache()){let t=0;for(const e in this.cache_){const i=this.cache_[e];0!=(3&t++)||i.hasListener()||(delete this.cache_[e],--this.cacheSize_)}}}get(t,e,i){const r=Gt(t,e,i);return r in this.cache_?this.cache_[r]:null}set(t,e,i,r){const n=Gt(t,e,i);this.cache_[n]=r,++this.cacheSize_}setSize(t){this.maxCacheSize_=t,this.expire()}},Zt="opacity",Kt="visible",Ht="extent",Wt="zIndex",$t="maxResolution",Qt="minResolution",Jt="maxZoom",te="minZoom",ee="source",ie=class extends P{constructor(t){super(),this.on,this.once,this.un,this.background_=t.background;const e=Object.assign({},t);"object"==typeof t.properties&&(delete e.properties,Object.assign(e,t.properties)),e[Zt]=void 0!==t.opacity?t.opacity:1,G("number"==typeof e[Zt],"Layer opacity must be a number"),e[Kt]=void 0===t.visible||t.visible,e[Wt]=t.zIndex,e[$t]=void 0!==t.maxResolution?t.maxResolution:1/0,e[Qt]=void 0!==t.minResolution?t.minResolution:0,e[te]=void 0!==t.minZoom?t.minZoom:-1/0,e[Jt]=void 0!==t.maxZoom?t.maxZoom:1/0,this.className_=void 0!==e.className?e.className:"ol-layer",delete e.className,this.setProperties(e),this.state_=null}getBackground(){return this.background_}getClassName(){return this.className_}getLayerState(t){const e=this.state_||{layer:this,managed:void 0===t||t},i=this.getZIndex();return e.opacity=It(Math.round(100*this.getOpacity())/100,0,1),e.visible=this.getVisible(),e.extent=this.getExtent(),e.zIndex=void 0!==i||e.managed?i:1/0,e.maxResolution=this.getMaxResolution(),e.minResolution=Math.max(this.getMinResolution(),0),e.minZoom=this.getMinZoom(),e.maxZoom=this.getMaxZoom(),this.state_=e,e}getLayersArray(t){return S()}getLayerStatesArray(t){return S()}getExtent(){return this.get(Ht)}getMaxResolution(){return this.get($t)}getMinResolution(){return this.get(Qt)}getMinZoom(){return this.get(te)}getMaxZoom(){return this.get(Jt)}getOpacity(){return this.get(Zt)}getSourceState(){return S()}getVisible(){return this.get(Kt)}getZIndex(){return this.get(Wt)}setBackground(t){this.background_=t,this.changed()}setExtent(t){this.set(Ht,t)}setMaxResolution(t){this.set($t,t)}setMinResolution(t){this.set(Qt,t)}setMaxZoom(t){this.set(Jt,t)}setMinZoom(t){this.set(te,t)}setOpacity(t){G("number"==typeof t,"Layer opacity must be a number"),this.set(Zt,t)}setVisible(t){this.set(Kt,t)}setZIndex(t){this.set(Wt,t)}disposeInternal(){this.state_&&(this.state_.layer=null,this.state_=null),super.disposeInternal()}},re="precompose",ne="rendercomplete",se={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"},oe=42,ae=256,he={radians:6370997/(2*Math.PI),degrees:2*Math.PI*6370997/360,ft:.3048,m:1,"us-ft":1200/3937},le=class{constructor(t){this.code_=t.code,this.units_=t.units,this.extent_=void 0!==t.extent?t.extent:null,this.worldExtent_=void 0!==t.worldExtent?t.worldExtent:null,this.axisOrientation_=void 0!==t.axisOrientation?t.axisOrientation:"enu",this.global_=void 0!==t.global&&t.global,this.canWrapX_=!(!this.global_||!this.extent_),this.getPointResolutionFunc_=t.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=t.metersPerUnit}canWrapX(){return this.canWrapX_}getCode(){return this.code_}getExtent(){return this.extent_}getUnits(){return this.units_}getMetersPerUnit(){return this.metersPerUnit_||he[this.units_]}getWorldExtent(){return this.worldExtent_}getAxisOrientation(){return this.axisOrientation_}isGlobal(){return this.global_}setGlobal(t){this.global_=t,this.canWrapX_=!(!t||!this.extent_)}getDefaultTileGrid(){return this.defaultTileGrid_}setDefaultTileGrid(t){this.defaultTileGrid_=t}setExtent(t){this.extent_=t,this.canWrapX_=!(!this.global_||!t)}setWorldExtent(t){this.worldExtent_=t}setGetPointResolution(t){this.getPointResolutionFunc_=t}getPointResolutionFunc(){return this.getPointResolutionFunc_}},ue=6378137,ce=Math.PI*ue,de=[-ce,-ce,ce,ce],fe=[-180,-85,180,85],ge=ue*Math.log(Math.tan(Math.PI/2));class me extends le{constructor(t){super({code:t,units:"m",extent:de,global:!0,worldExtent:fe,getPointResolution:function(t,e){return t/Math.cosh(e[1]/ue)}})}}const pe=[new me("EPSG:3857"),new me("EPSG:102100"),new me("EPSG:102113"),new me("EPSG:900913"),new me("http://www.opengis.net/def/crs/EPSG/0/3857"),new me("http://www.opengis.net/gml/srs/epsg.xml#3857")];const we=[-180,-90,180,90],_e=6378137*Math.PI/180;class be extends le{constructor(t,e){super({code:t,units:"degrees",extent:we,axisOrientation:e,global:!0,metersPerUnit:_e,worldExtent:we})}}const ye=[new be("CRS:84"),new be("EPSG:4326","neu"),new be("urn:ogc:def:crs:OGC:1.3:CRS84"),new be("urn:ogc:def:crs:OGC:2:84"),new be("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new be("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new be("http://www.opengis.net/def/crs/EPSG/0/4326","neu")];let ve={},xe={};function Me(t,e,i){const r=t.getCode(),n=e.getCode();r in xe||(xe[r]={}),xe[r][n]=i}function ke(t,e){let i=!0;for(let r=t.length-1;r>=0;--r)if(t[r]!=e[r]){i=!1;break}return i}function Ee(t,e){const i=Math.cos(e),r=Math.sin(e),n=t[0]*i-t[1]*r,s=t[1]*i+t[0]*r;return t[0]=n,t[1]=s,t}const Ce=6371008.8;function Se(t,e,i){i=i||Ce;const r=Ft(t[1]),n=Ft(e[1]),s=(n-r)/2,o=Ft(e[0]-t[0])/2,a=Math.sin(s)*Math.sin(s)+Math.sin(o)*Math.sin(o)*Math.cos(r)*Math.cos(n);return 2*i*Math.atan2(Math.sqrt(a),Math.sqrt(1-a))}const Ae={info:1,warn:2,error:3,none:4};let Te=Ae.info;function Re(...t){Te>Ae.warn||console.warn(...t)}let Pe=!0;function Ie(t,e){if(void 0!==e)for(let i=0,r=t.length;i<r;++i)e[i]=t[i];else e=t.slice();return e}function De(t,e){if(void 0!==e&&t!==e){for(let i=0,r=t.length;i<r;++i)e[i]=t[i];t=e}return t}function Le(t){!function(t,e){ve[t]=e}(t.getCode(),t),Me(t,t,Ie)}function Fe(t){return"string"==typeof t?ve[e=t]||ve[e.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null:t||null;var e}function ze(t,e,i,r){let n;const s=(t=Fe(t)).getPointResolutionFunc();if(s){if(n=s(e,i),r&&r!==t.getUnits()){const e=t.getMetersPerUnit();e&&(n=n*e/he[r])}}else{const s=t.getUnits();if("degrees"==s&&!r||"degrees"==r)n=e;else{const o=Ue(t,Fe("EPSG:4326"));if(o===De&&"degrees"!==s)n=e*t.getMetersPerUnit();else{let t=[i[0]-e/2,i[1],i[0]+e/2,i[1],i[0],i[1]-e/2,i[0],i[1]+e/2];t=o(t,t,2),n=(Se(t.slice(0,2),t.slice(2,4))+Se(t.slice(4,6),t.slice(6,8)))/2}const a=r?he[r]:t.getMetersPerUnit();void 0!==a&&(n/=a)}}return n}function Be(t){!function(t){t.forEach(Le)}(t),t.forEach((function(e){t.forEach((function(t){e!==t&&Me(e,t,Ie)}))}))}function Ne(t,e){return t?"string"==typeof t?Fe(t):t:Fe(e)}function Oe(t,e){if(t===e)return!0;const i=t.getUnits()===e.getUnits();return(t.getCode()===e.getCode()||Ue(t,e)===Ie)&&i}function Ue(t,e){let i=function(t,e){let i;return t in xe&&e in xe[t]&&(i=xe[t][e]),i}(t.getCode(),e.getCode());return i||(i=De),i}function Ve(t,e){return Ue(Fe(t),Fe(e))}function Ye(t,e,i){return Ve(e,i)(t,void 0,t.length)}let Xe=null;function je(){return Xe}function Ge(t,e){return t}function qe(t,e){return Pe&&!ke(t,[0,0])&&t[0]>=-180&&t[0]<=180&&t[1]>=-90&&t[1]<=90&&(Pe=!1,Re("Call useGeographic() from ol/proj once to work with [longitude, latitude] coordinates.")),t}function Ze(t,e){return t}var Ke,He,We;function $e(t,e,i){return function(r,n,s,o,a){if(!r)return;if(!n&&!e)return r;const h=e?0:s[0]*n,l=e?0:s[1]*n,u=a?a[0]:0,c=a?a[1]:0;let d=t[0]+h/2+u,f=t[2]-h/2+u,g=t[1]+l/2+c,m=t[3]-l/2+c;d>f&&(d=(f+d)/2,f=d),g>m&&(g=(m+g)/2,m=g);let p=It(r[0],d,f),w=It(r[1],g,m);if(o&&i&&n){const t=30*n;p+=-t*Math.log(1+Math.max(0,d-r[0])/t)+t*Math.log(1+Math.max(0,r[0]-f)/t),w+=-t*Math.log(1+Math.max(0,g-r[1])/t)+t*Math.log(1+Math.max(0,r[1]-m)/t)}return[p,w]}}function Qe(t){return t}function Je(t,e,i,r){const n=yt(e)/i[0],s=pt(e)/i[1];return r?Math.min(t,Math.max(n,s)):Math.min(t,Math.min(n,s))}function ti(t,e,i){let r=Math.min(t,e);return r*=Math.log(1+50*Math.max(0,t/e-1))/50+1,i&&(r=Math.max(r,i),r/=Math.log(1+50*Math.max(0,i/t-1))/50+1),It(r,i/2,2*e)}function ei(t,e,i,r,n){return i=void 0===i||i,function(s,o,a,h){if(void 0!==s){const o=r?Je(t,r,a,n):t;return i&&h?ti(s,o,e):It(s,e,o)}}}function ii(t){if(void 0!==t)return 0}function ri(t){if(void 0!==t)return t}function ni(t){return Math.pow(t,3)}function si(t){return 1-ni(1-t)}function oi(t){return 3*t*t-2*t*t*t}function ai(t){return t}Be(pe),Be(ye),Ke=pe,He=function(t,e,i){const r=t.length;i=i>1?i:2,void 0===e&&(e=i>2?t.slice():new Array(r));for(let n=0;n<r;n+=i){e[n]=ce*t[n]/180;let i=ue*Math.log(Math.tan(Math.PI*(+t[n+1]+90)/360));i>ge?i=ge:i<-ge&&(i=-ge),e[n+1]=i}return e},We=function(t,e,i){const r=t.length;i=i>1?i:2,void 0===e&&(e=i>2?t.slice():new Array(r));for(let n=0;n<r;n+=i)e[n]=180*t[n]/ce,e[n+1]=360*Math.atan(Math.exp(t[n+1]/ue))/Math.PI-90;return e},ye.forEach((function(t){Ke.forEach((function(e){Me(t,e,He),Me(e,t,We)}))}));const hi=[1,0,0,1,0,0],li=class extends P{constructor(){super(),this.extent_=[1/0,1/0,-1/0,-1/0],this.extentRevision_=-1,this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0,this.simplifyTransformedInternal=function(t){let e,i,r,n=!1;return function(){const s=Array.prototype.slice.call(arguments);return n&&this===r&&l(s,i)||(n=!0,r=this,i=s,e=t.apply(this,arguments)),e}}(((t,e,i)=>{if(!i)return this.getSimplifiedGeometry(e);const r=this.clone();return r.applyTransform(i),r.getSimplifiedGeometry(e)}))}simplifyTransformed(t,e){return this.simplifyTransformedInternal(this.getRevision(),t,e)}clone(){return S()}closestPointXY(t,e,i,r){return S()}containsXY(t,e){const i=this.getClosestPoint([t,e]);return i[0]===t&&i[1]===e}getClosestPoint(t,e){return e=e||[NaN,NaN],this.closestPointXY(t[0],t[1],e,1/0),e}intersectsCoordinate(t){return this.containsXY(t[0],t[1])}computeExtent(t){return S()}getExtent(t){if(this.extentRevision_!=this.getRevision()){const t=this.computeExtent(this.extent_);(isNaN(t[0])||isNaN(t[1]))&&rt(t),this.extentRevision_=this.getRevision()}return function(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t}(this.extent_,t)}rotate(t,e){S()}scale(t,e,i){S()}simplify(t){return this.getSimplifiedGeometry(t*t)}getSimplifiedGeometry(t){return S()}getType(){return S()}applyTransform(t){S()}intersectsExtent(t){return S()}translate(t,e){S()}transform(t,e){const i=Fe(t),r="tile-pixels"==i.getUnits()?function(t,r,n){const s=i.getExtent(),o=i.getWorldExtent(),a=pt(o)/pt(s);return Z(hi,o[0],o[3],a,-a,0,0,0),function(t,e,i,r,n,s){s=s||[];let o=0;for(let e=0;e<i;e+=r){const i=t[e],r=t[e+1];s[o++]=n[0]*i+n[2]*r+n[4],s[o++]=n[1]*i+n[3]*r+n[5]}s&&s.length!=o&&(s.length=o)}(t,0,t.length,n,hi,r),Ve(i,e)(t,r,n)}:Ve(i,e);return this.applyTransform(r),this}};function ui(t){let e;return"XY"==t?e=2:"XYZ"==t||"XYM"==t?e=3:"XYZM"==t&&(e=4),e}const ci=class extends li{constructor(){super(),this.layout="XY",this.stride=2,this.flatCoordinates}computeExtent(t){return e=this.flatCoordinates,i=this.flatCoordinates.length,r=this.stride,ot(rt(t),e,0,i,r);var e,i,r}getCoordinates(){return S()}getFirstCoordinate(){return this.flatCoordinates.slice(0,this.stride)}getFlatCoordinates(){return this.flatCoordinates}getLastCoordinate(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}getLayout(){return this.layout}getSimplifiedGeometry(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&t<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;const e=this.getSimplifiedGeometryInternal(t);return e.getFlatCoordinates().length<this.flatCoordinates.length?e:(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)}getSimplifiedGeometryInternal(t){return this}getStride(){return this.stride}setFlatCoordinates(t,e){this.stride=ui(t),this.layout=t,this.flatCoordinates=e}setCoordinates(t,e){S()}setLayout(t,e,i){let r;if(t)r=ui(t);else{for(let t=0;t<i;++t){if(0===e.length)return this.layout="XY",void(this.stride=2);e=e[0]}r=e.length,t=function(t){let e;return 2==t?e="XY":3==t?e="XYZ":4==t&&(e="XYZM"),e}(r)}this.layout=t,this.stride=r}applyTransform(t){this.flatCoordinates&&(t(this.flatCoordinates,this.flatCoordinates,this.stride),this.changed())}rotate(t,e){const i=this.getFlatCoordinates();if(i){const r=this.getStride();!function(t,e,i,r,n,s,o){o=o||[];const a=Math.cos(n),h=Math.sin(n),l=s[0],u=s[1];let c=0;for(let e=0;e<i;e+=r){const i=t[e]-l,n=t[e+1]-u;o[c++]=l+i*a-n*h,o[c++]=u+i*h+n*a;for(let i=e+2;i<e+r;++i)o[c++]=t[i]}o&&o.length!=c&&(o.length=c)}(i,0,i.length,r,t,e,i),this.changed()}}scale(t,e,i){void 0===e&&(e=t),i||(i=dt(this.getExtent()));const r=this.getFlatCoordinates();if(r){const n=this.getStride();!function(t,e,i,r,n,s,o,a){a=a||[];const h=o[0],l=o[1];let u=0;for(let e=0;e<i;e+=r){const i=t[e]-h,o=t[e+1]-l;a[u++]=h+n*i,a[u++]=l+s*o;for(let i=e+2;i<e+r;++i)a[u++]=t[i]}a&&a.length!=u&&(a.length=u)}(r,0,r.length,n,t,e,i,r),this.changed()}}translate(t,e){const i=this.getFlatCoordinates();if(i){const r=this.getStride();!function(t,e,i,r,n,s,o){o=o||[];let a=0;for(let e=0;e<i;e+=r){o[a++]=t[e]+n,o[a++]=t[e+1]+s;for(let i=e+2;i<e+r;++i)o[a++]=t[i]}o&&o.length!=a&&(o.length=a)}(i,0,i.length,r,t,e,i),this.changed()}}};function di(t,e,i,r,n,s,o){const a=t[e],h=t[e+1],l=t[i]-a,u=t[i+1]-h;let c;if(0===l&&0===u)c=e;else{const d=((n-a)*l+(s-h)*u)/(l*l+u*u);if(d>1)c=i;else{if(d>0){for(let n=0;n<r;++n)o[n]=Bt(t[e+n],t[i+n],d);return void(o.length=r)}c=e}}for(let e=0;e<r;++e)o[e]=t[c+e];o.length=r}function fi(t,e,i,r,n){let s=t[e],o=t[e+1];for(e+=r;e<i;e+=r){const i=t[e],r=t[e+1],a=Lt(s,o,i,r);a>n&&(n=a),s=i,o=r}return n}function gi(t,e,i,r,n,s,o,a,h,l,u){if(e==i)return l;let c,d;if(0===n){if(d=Lt(o,a,t[e],t[e+1]),d<l){for(c=0;c<r;++c)h[c]=t[e+c];return h.length=r,d}return l}u=u||[NaN,NaN];let f=e+r;for(;f<i;)if(di(t,f-r,f,r,o,a,u),d=Lt(o,a,u[0],u[1]),d<l){for(l=d,c=0;c<r;++c)h[c]=u[c];h.length=r,f+=r}else f+=r*Math.max((Math.sqrt(d)-Math.sqrt(l))/n|0,1);if(s&&(di(t,i-r,e,r,o,a,u),d=Lt(o,a,u[0],u[1]),d<l)){for(l=d,c=0;c<r;++c)h[c]=u[c];h.length=r}return l}function mi(t,e,i,r){for(let n=0,s=i.length;n<s;++n){const s=i[n];for(let i=0;i<r;++i)t[e++]=s[i]}return e}function pi(t,e){return e*Math.round(t/e)}function wi(t,e,i,r,n,s,o){if(e==i)return o;let a,h,l=pi(t[e],n),u=pi(t[e+1],n);e+=r,s[o++]=l,s[o++]=u;do{if(a=pi(t[e],n),h=pi(t[e+1],n),(e+=r)==i)return s[o++]=a,s[o++]=h,o}while(a==l&&h==u);for(;e<i;){const i=pi(t[e],n),c=pi(t[e+1],n);if(e+=r,i==a&&c==h)continue;const d=a-l,f=h-u,g=i-l,m=c-u;d*m==f*g&&(d<0&&g<d||d==g||d>0&&g>d)&&(f<0&&m<f||f==m||f>0&&m>f)?(a=i,h=c):(s[o++]=a,s[o++]=h,l=a,u=h,a=i,h=c)}return s[o++]=a,s[o++]=h,o}function _i(t,e,i,r,n){n=void 0!==n?n:[];let s=0;for(let o=e;o<i;o+=r)n[s++]=t.slice(o,o+r);return n.length=s,n}function bi(t,e,i,r){let n=0,s=t[i-r],o=t[i-r+1];for(;e<i;e+=r){const i=t[e],r=t[e+1];n+=o*i-s*r,s=i,o=r}return n/2}class yi extends ci{constructor(t,e){super(),this.maxDelta_=-1,this.maxDeltaRevision_=-1,void 0===e||Array.isArray(t[0])?this.setCoordinates(t,e):this.setFlatCoordinates(e,t)}clone(){return new yi(this.flatCoordinates.slice(),this.layout)}closestPointXY(t,e,i,r){return r<Q(this.getExtent(),t,e)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(fi(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),gi(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,t,e,i,r))}getArea(){return bi(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinates(){return _i(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getSimplifiedGeometryInternal(t){const e=[];return e.length=function(t,e,i,r,n,s,o){const a=(i-e)/r;if(a<3){for(;e<i;e+=r)s[o++]=t[e],s[o++]=t[e+1];return o}const h=new Array(a);h[0]=1,h[a-1]=1;const l=[e,i-r];let u=0;for(;l.length>0;){const i=l.pop(),s=l.pop();let o=0;const a=t[s],c=t[s+1],d=t[i],f=t[i+1];for(let e=s+r;e<i;e+=r){const i=Dt(t[e],t[e+1],a,c,d,f);i>o&&(u=e,o=i)}o>n&&(h[(u-e)/r]=1,s+r<u&&l.push(s,u),u+r<i&&l.push(u,i))}for(let i=0;i<a;++i)h[i]&&(s[o++]=t[e+i*r],s[o++]=t[e+i*r+1]);return o}(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,0),new yi(e,"XY")}getType(){return"LinearRing"}intersectsExtent(t){return!1}setCoordinates(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=mi(this.flatCoordinates,0,t,this.stride),this.changed()}}const vi=yi;class xi extends ci{constructor(t,e){super(),this.setCoordinates(t,e)}clone(){const t=new xi(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(t,e,i,r){const n=this.flatCoordinates,s=Lt(t,e,n[0],n[1]);if(s<r){const t=this.stride;for(let e=0;e<t;++e)i[e]=n[e];return i.length=t,s}return r}getCoordinates(){return this.flatCoordinates.slice()}computeExtent(t){return function(t,e){const i=t[0],r=t[1];return it(i,r,i,r,e)}(this.flatCoordinates,t)}getType(){return"Point"}intersectsExtent(t){return tt(t,this.flatCoordinates[0],this.flatCoordinates[1])}setCoordinates(t,e){this.setLayout(e,t,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=function(t,e,i,r){for(let r=0,n=i.length;r<n;++r)t[e++]=i[r];return e}(this.flatCoordinates,0,t,this.stride),this.changed()}}const Mi=xi;function ki(t,e,i,r,n){return!ht(n,(function(n){return!Ei(t,e,i,r,n[0],n[1])}))}function Ei(t,e,i,r,n,s){let o=0,a=t[i-r],h=t[i-r+1];for(;e<i;e+=r){const i=t[e],r=t[e+1];h<=s?r>s&&(i-a)*(s-h)-(n-a)*(r-h)>0&&o++:r<=s&&(i-a)*(s-h)-(n-a)*(r-h)<0&&o--,a=i,h=r}return 0!==o}function Ci(t,e,i,r,n,s){if(0===i.length)return!1;if(!Ei(t,e,i[0],r,n,s))return!1;for(let e=1,o=i.length;e<o;++e)if(Ei(t,i[e-1],i[e],r,n,s))return!1;return!0}function Si(t,e,i,r,n){const s=ot([1/0,1/0,-1/0,-1/0],t,e,i,r);return!!vt(n,s)&&(a=s,(o=n)[0]<=a[0]&&a[2]<=o[2]&&o[1]<=a[1]&&a[3]<=o[3]||s[0]>=n[0]&&s[2]<=n[2]||s[1]>=n[1]&&s[3]<=n[3]||function(t,e,i,r,s){let o;for(e+=r;e<i;e+=r)if(a=t.slice(e-r,e),h=t.slice(e,e+r),o=function(t,e,i){let r=!1;const n=et(t,e),s=et(t,i);if(n===W.INTERSECTING||s===W.INTERSECTING)r=!0;else{const o=t[0],a=t[1],h=t[2],l=t[3],u=e[0],c=e[1],d=i[0],f=i[1],g=(f-c)/(d-u);let m,p;s&W.ABOVE&&!(n&W.ABOVE)&&(m=d-(f-l)/g,r=m>=o&&m<=h),r||!(s&W.RIGHT)||n&W.RIGHT||(p=f-(d-h)*g,r=p>=a&&p<=l),r||!(s&W.BELOW)||n&W.BELOW||(m=d-(f-a)/g,r=m>=o&&m<=h),r||!(s&W.LEFT)||n&W.LEFT||(p=f-(d-o)*g,r=p>=a&&p<=l)}return r}(n,a,h),o)return o;var a,h;return!1}(t,e,i,r));var o,a}function Ai(t,e,i,r,n){return!!(Si(t,e,i,r,n)||Ei(t,e,i,r,n[0],n[1])||Ei(t,e,i,r,n[0],n[3])||Ei(t,e,i,r,n[2],n[1])||Ei(t,e,i,r,n[2],n[3]))}function Ti(t,e,i,r){for(;e<i-r;){for(let n=0;n<r;++n){const s=t[e+n];t[e+n]=t[i-r+n],t[i-r+n]=s}e+=r,i-=r}}function Ri(t,e,i,r){let n=0,s=t[i-r],o=t[i-r+1];for(;e<i;e+=r){const i=t[e],r=t[e+1];n+=(i-s)*(r+o),s=i,o=r}return 0===n?void 0:n>0}function Pi(t,e,i,r,n){n=void 0!==n&&n;for(let s=0,o=i.length;s<o;++s){const o=i[s],a=Ri(t,e,o,r);(0===s?n&&a||!n&&!a:n&&!a||!n&&a)&&Ti(t,e,o,r),e=o}return e}class Ii extends ci{constructor(t,e,i){super(),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,void 0!==e&&i?(this.setFlatCoordinates(e,t),this.ends_=i):this.setCoordinates(t,e)}appendLinearRing(t){this.flatCoordinates?function(t,e){const i=Array.isArray(e)?e:[e],r=i.length;for(let e=0;e<r;e++)t[t.length]=i[e]}(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const t=new Ii(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return t.applyProperties(this),t}closestPointXY(t,e,i,r){return r<Q(this.getExtent(),t,e)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(function(t,e,i,r,n){for(let s=0,o=i.length;s<o;++s){const o=i[s];n=fi(t,e,o,r,n),e=o}return n}(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),function(t,e,i,r,n,s,o,a,h,l,u){u=u||[NaN,NaN];for(let c=0,d=i.length;c<d;++c){const d=i[c];l=gi(t,e,d,r,n,s,o,a,h,l,u),e=d}return l}(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,t,e,i,r))}containsXY(t,e){return Ci(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,e)}getArea(){return function(t,e,i,r){let n=0;for(let s=0,o=i.length;s<o;++s){const o=i[s];n+=bi(t,e,o,r),e=o}return n}(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)}getCoordinates(t){let e;return void 0!==t?(e=this.getOrientedFlatCoordinates().slice(),Pi(e,0,this.ends_,this.stride,t)):e=this.flatCoordinates,function(t,e,i,r,n){n=void 0!==n?n:[];let s=0;for(let o=0,a=i.length;o<a;++o){const a=i[o];n[s++]=_i(t,e,a,r,n[s]),e=a}return n.length=s,n}(e,0,this.ends_,this.stride)}getEnds(){return this.ends_}getFlatInteriorPoint(){if(this.flatInteriorPointRevision_!=this.getRevision()){const t=dt(this.getExtent());this.flatInteriorPoint_=function(t,e,i,r,n,s,o){let h,l,u,c,d,f,g;const m=n[s+1],p=[];for(let n=0,s=i.length;n<s;++n){const s=i[n];for(c=t[s-r],f=t[s-r+1],h=e;h<s;h+=r)d=t[h],g=t[h+1],(m<=f&&g<=m||f<=m&&m<=g)&&(u=(m-f)/(g-f)*(d-c)+c,p.push(u)),c=d,f=g}let w=NaN,_=-1/0;for(p.sort(a),c=p[0],h=1,l=p.length;h<l;++h){d=p[h];const n=Math.abs(d-c);n>_&&(u=(c+d)/2,Ci(t,e,i,r,u,m)&&(w=u,_=n)),c=d}return isNaN(w)&&(w=n[s]),o?(o.push(w,m,_),o):[w,m,_]}(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_}getInteriorPoint(){return new Mi(this.getFlatInteriorPoint(),"XYM")}getLinearRingCount(){return this.ends_.length}getLinearRing(t){return t<0||this.ends_.length<=t?null:new vi(this.flatCoordinates.slice(0===t?0:this.ends_[t-1],this.ends_[t]),this.layout)}getLinearRings(){const t=this.layout,e=this.flatCoordinates,i=this.ends_,r=[];let n=0;for(let s=0,o=i.length;s<o;++s){const o=i[s],a=new vi(e.slice(n,o),t);r.push(a),n=o}return r}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const t=this.flatCoordinates;!function(t,e,i,r,n){n=void 0!==n&&n;for(let s=0,o=i.length;s<o;++s){const o=i[s],a=Ri(t,e,o,r);if(0===s){if(n&&a||!n&&!a)return!1}else if(n&&!a||!n&&a)return!1;e=o}return!0}(t,0,this.ends_,this.stride)?(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=Pi(this.orientedFlatCoordinates_,0,this.ends_,this.stride)):this.orientedFlatCoordinates_=t,this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(t){const e=[],i=[];return e.length=function(t,e,i,r,n,s,o,a){for(let h=0,l=i.length;h<l;++h){const l=i[h];o=wi(t,e,l,r,n,s,o),a.push(o),e=l}return o}(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(t),e,0,i),new Ii(e,"XY",i)}getType(){return"Polygon"}intersectsExtent(t){return function(t,e,i,r,n){if(!Ai(t,e,i[0],r,n))return!1;if(1===i.length)return!0;for(let e=1,s=i.length;e<s;++e)if(ki(t,i[e-1],i[e],r,n)&&!Si(t,i[e-1],i[e],r,n))return!1;return!0}(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);const i=function(t,e,i,r,n){n=n||[];let s=0;for(let o=0,a=i.length;o<a;++o){const a=mi(t,e,i[o],r);n[s++]=a,e=a}return n.length=s,n}(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=0===i.length?0:i[i.length-1],this.changed()}}const Di=Ii;function Li(t){if(xt(t))throw new Error("Cannot create polygon from empty extent");const e=t[0],i=t[1],r=t[2],n=t[3],s=[e,i,e,n,r,n,r,i,e,i];return new Ii(s,"XY",[s.length])}function Fi(t,e){setTimeout((function(){t(e)}),0)}function zi(t){return!(t.sourceCenter&&t.targetCenter&&!ke(t.sourceCenter,t.targetCenter))&&t.sourceResolution===t.targetResolution&&t.sourceRotation===t.targetRotation}function Bi(t,e,i,r,n){const s=Math.cos(-n);let o=Math.sin(-n),a=t[0]*s-t[1]*o,h=t[1]*s+t[0]*o;return a+=(e[0]/2-i[0])*r,h+=(i[1]-e[1]/2)*r,o=-o,[a*s-h*o,h*s+a*o]}const Ni=class extends P{constructor(t){super(),this.on,this.once,this.un,t=Object.assign({},t),this.hints_=[0,0],this.animations_=[],this.updateAnimationKey_,this.projection_=Ne(t.projection,"EPSG:3857"),this.viewportSize_=[100,100],this.targetCenter_=null,this.targetResolution_,this.targetRotation_,this.nextCenter_=null,this.nextResolution_,this.nextRotation_,this.cancelAnchor_=void 0,t.projection&&function(t){Pe=!(void 0===t||t)}(),t.center&&(t.center=qe(t.center,this.projection_)),t.extent&&(t.extent=Ze(t.extent,this.projection_)),this.applyOptions_(t)}applyOptions_(t){const e=Object.assign({},t);for(const t in se)delete e[t];this.setProperties(e,!0);const i=function(t){let e,i,r;let n=void 0!==t.minZoom?t.minZoom:0,s=void 0!==t.maxZoom?t.maxZoom:28;const o=void 0!==t.zoomFactor?t.zoomFactor:2,a=void 0!==t.multiWorld&&t.multiWorld,l=void 0===t.smoothResolutionConstraint||t.smoothResolutionConstraint,u=void 0!==t.showFullExtent&&t.showFullExtent,c=Ne(t.projection,"EPSG:3857"),d=c.getExtent();let f=t.constrainOnlyCenter,g=t.extent;if(a||g||!c.isGlobal()||(f=!1,g=d),void 0!==t.resolutions){const o=t.resolutions;i=o[n],r=void 0!==o[s]?o[s]:o[o.length-1],e=t.constrainResolution?function(t,e,i,r){return e=void 0===e||e,function(n,s,o,a){if(void 0!==n){const l=t[0],u=t[t.length-1],c=i?Je(l,i,o,r):l;if(a)return e?ti(n,c,u):It(n,u,c);const d=Math.min(c,n),f=Math.floor(h(t,d,s));return t[f]>c&&f<t.length-1?t[f+1]:t[f]}}}(o,l,!f&&g,u):ei(i,r,l,!f&&g,u)}else{const a=(d?Math.max(yt(d),pt(d)):360*he.degrees/c.getMetersPerUnit())/ae/Math.pow(2,0),h=a/Math.pow(2,28);i=t.maxResolution,void 0!==i?n=0:i=a/Math.pow(o,n),r=t.minResolution,void 0===r&&(r=void 0!==t.maxZoom?void 0!==t.maxResolution?i/Math.pow(o,s):a/Math.pow(o,s):h),s=n+Math.floor(Math.log(i/r)/Math.log(o)),r=i/Math.pow(o,s-n),e=t.constrainResolution?function(t,e,i,r,n,s){return r=void 0===r||r,i=void 0!==i?i:0,function(o,a,h,l){if(void 0!==o){const u=n?Je(e,n,h,s):e;if(l)return r?ti(o,u,i):It(o,i,u);const c=1e-9,d=Math.ceil(Math.log(e/u)/Math.log(t)-c),f=-a*(.5-c)+.5,g=Math.min(u,o),m=Math.floor(Math.log(e/g)/Math.log(t)+f),p=Math.max(d,m);return It(e/Math.pow(t,p),i,u)}}}(o,i,r,l,!f&&g,u):ei(i,r,l,!f&&g,u)}return{constraint:e,maxResolution:i,minResolution:r,minZoom:n,zoomFactor:o}}(t);this.maxResolution_=i.maxResolution,this.minResolution_=i.minResolution,this.zoomFactor_=i.zoomFactor,this.resolutions_=t.resolutions,this.padding_=t.padding,this.minZoom_=i.minZoom;const r=function(t){if(void 0!==t.extent){const e=void 0===t.smoothExtentConstraint||t.smoothExtentConstraint;return $e(t.extent,t.constrainOnlyCenter,e)}const e=Ne(t.projection,"EPSG:3857");if(!0!==t.multiWorld&&e.isGlobal()){const t=e.getExtent().slice();return t[0]=-1/0,t[2]=1/0,$e(t,!1,!1)}return Qe}(t),n=i.constraint,s=function(t){if(void 0===t.enableRotation||t.enableRotation){const e=t.constrainRotation;return void 0===e||!0===e?function(t){const e=Ft(5);return function(t,i){return i||void 0===t?t:Math.abs(t)<=e?0:t}}():!1===e?ri:"number"==typeof e?function(t){const e=2*Math.PI/t;return function(t,i){return i?t:void 0!==t?t=Math.floor(t/e+.5)*e:void 0}}(e):ri}return ii}(t);this.constraints_={center:r,resolution:n,rotation:s},this.setRotation(void 0!==t.rotation?t.rotation:0),this.setCenterInternal(void 0!==t.center?t.center:null),void 0!==t.resolution?this.setResolution(t.resolution):void 0!==t.zoom&&this.setZoom(t.zoom)}get padding(){return this.padding_}set padding(t){let e=this.padding_;this.padding_=t;const i=this.getCenterInternal();if(i){const r=t||[0,0,0,0];e=e||[0,0,0,0];const n=this.getResolution(),s=n/2*(r[3]-e[3]+e[1]-r[1]),o=n/2*(r[0]-e[0]+e[2]-r[2]);this.setCenterInternal([i[0]+s,i[1]-o])}}getUpdatedOptions_(t){const e=this.getProperties();return void 0!==e.resolution?e.resolution=this.getResolution():e.zoom=this.getZoom(),e.center=this.getCenterInternal(),e.rotation=this.getRotation(),Object.assign({},e,t)}animate(t){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);const e=new Array(arguments.length);for(let t=0;t<e.length;++t){let i=arguments[t];i.center&&(i=Object.assign({},i),i.center=qe(i.center,this.getProjection())),i.anchor&&(i=Object.assign({},i),i.anchor=qe(i.anchor,this.getProjection())),e[t]=i}this.animateInternal.apply(this,e)}animateInternal(t){let e,i=arguments.length;i>1&&"function"==typeof arguments[i-1]&&(e=arguments[i-1],--i);let r=0;for(;r<i&&!this.isDef();++r){const t=arguments[r];t.center&&this.setCenterInternal(t.center),void 0!==t.zoom?this.setZoom(t.zoom):t.resolution&&this.setResolution(t.resolution),void 0!==t.rotation&&this.setRotation(t.rotation)}if(r===i)return void(e&&Fi(e,!0));let n=Date.now(),s=this.targetCenter_.slice(),o=this.targetResolution_,a=this.targetRotation_;const h=[];for(;r<i;++r){const t=arguments[r],i={start:n,complete:!1,anchor:t.anchor,duration:void 0!==t.duration?t.duration:1e3,easing:t.easing||oi,callback:e};if(t.center&&(i.sourceCenter=s,i.targetCenter=t.center.slice(),s=i.targetCenter),void 0!==t.zoom?(i.sourceResolution=o,i.targetResolution=this.getResolutionForZoom(t.zoom),o=i.targetResolution):t.resolution&&(i.sourceResolution=o,i.targetResolution=t.resolution,o=i.targetResolution),void 0!==t.rotation){i.sourceRotation=a;const e=zt(t.rotation-a+Math.PI,2*Math.PI)-Math.PI;i.targetRotation=a+e,a=i.targetRotation}zi(i)?i.complete=!0:n+=i.duration,h.push(i)}this.animations_.push(h),this.setHint(0,1),this.updateAnimations_()}getAnimating(){return this.hints_[0]>0}getInteracting(){return this.hints_[1]>0}cancelAnimations(){let t;this.setHint(0,-this.hints_[0]);for(let e=0,i=this.animations_.length;e<i;++e){const i=this.animations_[e];if(i[0].callback&&Fi(i[0].callback,!1),!t)for(let e=0,r=i.length;e<r;++e){const r=i[e];if(!r.complete){t=r.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=t,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN}updateAnimations_(){if(void 0!==this.updateAnimationKey_&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),!this.getAnimating())return;const t=Date.now();let e=!1;for(let i=this.animations_.length-1;i>=0;--i){const r=this.animations_[i];let n=!0;for(let i=0,s=r.length;i<s;++i){const s=r[i];if(s.complete)continue;const o=t-s.start;let a=s.duration>0?o/s.duration:1;a>=1?(s.complete=!0,a=1):n=!1;const h=s.easing(a);if(s.sourceCenter){const t=s.sourceCenter[0],e=s.sourceCenter[1],i=s.targetCenter[0],r=s.targetCenter[1];this.nextCenter_=s.targetCenter;const n=t+h*(i-t),o=e+h*(r-e);this.targetCenter_=[n,o]}if(s.sourceResolution&&s.targetResolution){const t=1===h?s.targetResolution:s.sourceResolution+h*(s.targetResolution-s.sourceResolution);if(s.anchor){const e=this.getViewportSize_(this.getRotation()),i=this.constraints_.resolution(t,0,e,!0);this.targetCenter_=this.calculateCenterZoom(i,s.anchor)}this.nextResolution_=s.targetResolution,this.targetResolution_=t,this.applyTargetState_(!0)}if(void 0!==s.sourceRotation&&void 0!==s.targetRotation){const t=1===h?zt(s.targetRotation+Math.PI,2*Math.PI)-Math.PI:s.sourceRotation+h*(s.targetRotation-s.sourceRotation);if(s.anchor){const e=this.constraints_.rotation(t,!0);this.targetCenter_=this.calculateCenterRotate(e,s.anchor)}this.nextRotation_=s.targetRotation,this.targetRotation_=t}if(this.applyTargetState_(!0),e=!0,!s.complete)break}if(n){this.animations_[i]=null,this.setHint(0,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;const t=r[0].callback;t&&Fi(t,!0)}}this.animations_=this.animations_.filter(Boolean),e&&void 0===this.updateAnimationKey_&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}calculateCenterRotate(t,e){let i;const r=this.getCenterInternal();var n,s;return void 0!==r&&(i=[r[0]-e[0],r[1]-e[1]],Ee(i,t-this.getRotation()),s=e,(n=i)[0]+=+s[0],n[1]+=+s[1]),i}calculateCenterZoom(t,e){let i;const r=this.getCenterInternal(),n=this.getResolution();return void 0!==r&&void 0!==n&&(i=[e[0]-t*(e[0]-r[0])/n,e[1]-t*(e[1]-r[1])/n]),i}getViewportSize_(t){const e=this.viewportSize_;if(t){const i=e[0],r=e[1];return[Math.abs(i*Math.cos(t))+Math.abs(r*Math.sin(t)),Math.abs(i*Math.sin(t))+Math.abs(r*Math.cos(t))]}return e}setViewportSize(t){this.viewportSize_=Array.isArray(t)?t.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)}getCenter(){const t=this.getCenterInternal();return t?Ge(t,this.getProjection()):t}getCenterInternal(){return this.get(se.CENTER)}getConstraints(){return this.constraints_}getConstrainResolution(){return this.get("constrainResolution")}getHints(t){return void 0!==t?(t[0]=this.hints_[0],t[1]=this.hints_[1],t):this.hints_.slice()}calculateExtent(t){return e=this.calculateExtentInternal(t),this.getProjection(),e;var e}calculateExtentInternal(t){t=t||this.getViewportSizeMinusPadding_();const e=this.getCenterInternal();G(e,"The view center is not defined");const i=this.getResolution();G(void 0!==i,"The view resolution is not defined");const r=this.getRotation();return G(void 0!==r,"The view rotation is not defined"),gt(e,i,r,t)}getMaxResolution(){return this.maxResolution_}getMinResolution(){return this.minResolution_}getMaxZoom(){return this.getZoomForResolution(this.minResolution_)}setMaxZoom(t){this.applyOptions_(this.getUpdatedOptions_({maxZoom:t}))}getMinZoom(){return this.getZoomForResolution(this.maxResolution_)}setMinZoom(t){this.applyOptions_(this.getUpdatedOptions_({minZoom:t}))}setConstrainResolution(t){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:t}))}getProjection(){return this.projection_}getResolution(){return this.get(se.RESOLUTION)}getResolutions(){return this.resolutions_}getResolutionForExtent(t,e){return this.getResolutionForExtentInternal(Ze(t,this.getProjection()),e)}getResolutionForExtentInternal(t,e){e=e||this.getViewportSizeMinusPadding_();const i=yt(t)/e[0],r=pt(t)/e[1];return Math.max(i,r)}getResolutionForValueFunction(t){t=t||2;const e=this.getConstrainedResolution(this.maxResolution_),i=this.minResolution_,r=Math.log(e/i)/Math.log(t);return function(i){return e/Math.pow(t,i*r)}}getRotation(){return this.get(se.ROTATION)}getValueForResolutionFunction(t){const e=Math.log(t||2),i=this.getConstrainedResolution(this.maxResolution_),r=this.minResolution_,n=Math.log(i/r)/e;return function(t){return Math.log(i/t)/e/n}}getViewportSizeMinusPadding_(t){let e=this.getViewportSize_(t);const i=this.padding_;return i&&(e=[e[0]-i[1]-i[3],e[1]-i[0]-i[2]]),e}getState(){const t=this.getProjection(),e=this.getResolution(),i=this.getRotation();let r=this.getCenterInternal();const n=this.padding_;if(n){const t=this.getViewportSizeMinusPadding_();r=Bi(r,this.getViewportSize_(),[t[0]/2+n[3],t[1]/2+n[0]],e,i)}return{center:r.slice(0),projection:void 0!==t?t:null,resolution:e,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:i,zoom:this.getZoom()}}getViewStateAndExtent(){return{viewState:this.getState(),extent:this.calculateExtent()}}getZoom(){let t;const e=this.getResolution();return void 0!==e&&(t=this.getZoomForResolution(e)),t}getZoomForResolution(t){let e,i,r=this.minZoom_||0;if(this.resolutions_){const n=h(this.resolutions_,t,1);r=n,e=this.resolutions_[n],i=n==this.resolutions_.length-1?2:e/this.resolutions_[n+1]}else e=this.maxResolution_,i=this.zoomFactor_;return r+Math.log(e/t)/Math.log(i)}getResolutionForZoom(t){if(this.resolutions_){if(this.resolutions_.length<=1)return 0;const e=It(Math.floor(t),0,this.resolutions_.length-2),i=this.resolutions_[e]/this.resolutions_[e+1];return this.resolutions_[e]/Math.pow(i,It(t-e,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,t-this.minZoom_)}fit(t,e){let i;if(G(Array.isArray(t)||"function"==typeof t.getSimplifiedGeometry,"Invalid extent or geometry provided as `geometry`"),Array.isArray(t))G(!xt(t),"Cannot fit empty extent provided as `geometry`"),i=Li(Ze(t,this.getProjection()));else if("Circle"===t.getType()){const e=Ze(t.getExtent(),this.getProjection());i=Li(e),i.rotate(this.getRotation(),dt(e))}else{const e=je();i=e?t.clone().transform(e,this.getProjection()):t}this.fitInternal(i,e)}rotatedExtentForGeometry(t){const e=this.getRotation(),i=Math.cos(e),r=Math.sin(-e),n=t.getFlatCoordinates(),s=t.getStride();let o=1/0,a=1/0,h=-1/0,l=-1/0;for(let t=0,e=n.length;t<e;t+=s){const e=n[t]*i-n[t+1]*r,s=n[t]*r+n[t+1]*i;o=Math.min(o,e),a=Math.min(a,s),h=Math.max(h,e),l=Math.max(l,s)}return[o,a,h,l]}fitInternal(t,e){let i=(e=e||{}).size;i||(i=this.getViewportSizeMinusPadding_());const r=void 0!==e.padding?e.padding:[0,0,0,0],n=void 0!==e.nearest&&e.nearest;let s;s=void 0!==e.minResolution?e.minResolution:void 0!==e.maxZoom?this.getResolutionForZoom(e.maxZoom):0;const o=this.rotatedExtentForGeometry(t);let a=this.getResolutionForExtentInternal(o,[i[0]-r[1]-r[3],i[1]-r[0]-r[2]]);a=isNaN(a)?s:Math.max(a,s),a=this.getConstrainedResolution(a,n?0:1);const h=this.getRotation(),l=Math.sin(h),u=Math.cos(h),c=dt(o);c[0]+=(r[1]-r[3])/2*a,c[1]+=(r[0]-r[2])/2*a;const f=c[0]*u-c[1]*l,g=c[1]*u+c[0]*l,m=this.getConstrainedCenter([f,g],a),p=e.callback?e.callback:d;void 0!==e.duration?this.animateInternal({resolution:a,center:m,duration:e.duration,easing:e.easing},p):(this.targetResolution_=a,this.targetCenter_=m,this.applyTargetState_(!1,!0),Fi(p,!0))}centerOn(t,e,i){this.centerOnInternal(qe(t,this.getProjection()),e,i)}centerOnInternal(t,e,i){this.setCenterInternal(Bi(t,e,i,this.getResolution(),this.getRotation()))}calculateCenterShift(t,e,i,r){let n;const s=this.padding_;if(s&&t){const o=this.getViewportSizeMinusPadding_(-i),a=Bi(t,r,[o[0]/2+s[3],o[1]/2+s[0]],e,i);n=[t[0]-a[0],t[1]-a[1]]}return n}isDef(){return!!this.getCenterInternal()&&void 0!==this.getResolution()}adjustCenter(t){const e=Ge(this.targetCenter_,this.getProjection());this.setCenter([e[0]+t[0],e[1]+t[1]])}adjustCenterInternal(t){const e=this.targetCenter_;this.setCenterInternal([e[0]+t[0],e[1]+t[1]])}adjustResolution(t,e){e=e&&qe(e,this.getProjection()),this.adjustResolutionInternal(t,e)}adjustResolutionInternal(t,e){const i=this.getAnimating()||this.getInteracting(),r=this.getViewportSize_(this.getRotation()),n=this.constraints_.resolution(this.targetResolution_*t,0,r,i);e&&(this.targetCenter_=this.calculateCenterZoom(n,e)),this.targetResolution_*=t,this.applyTargetState_()}adjustZoom(t,e){this.adjustResolution(Math.pow(this.zoomFactor_,-t),e)}adjustRotation(t,e){e&&(e=qe(e,this.getProjection())),this.adjustRotationInternal(t,e)}adjustRotationInternal(t,e){const i=this.getAnimating()||this.getInteracting(),r=this.constraints_.rotation(this.targetRotation_+t,i);e&&(this.targetCenter_=this.calculateCenterRotate(r,e)),this.targetRotation_+=t,this.applyTargetState_()}setCenter(t){this.setCenterInternal(t?qe(t,this.getProjection()):t)}setCenterInternal(t){this.targetCenter_=t,this.applyTargetState_()}setHint(t,e){return this.hints_[t]+=e,this.changed(),this.hints_[t]}setResolution(t){this.targetResolution_=t,this.applyTargetState_()}setRotation(t){this.targetRotation_=t,this.applyTargetState_()}setZoom(t){this.setResolution(this.getResolutionForZoom(t))}applyTargetState_(t,e){const i=this.getAnimating()||this.getInteracting()||e,r=this.constraints_.rotation(this.targetRotation_,i),n=this.getViewportSize_(r),s=this.constraints_.resolution(this.targetResolution_,0,n,i),o=this.constraints_.center(this.targetCenter_,s,n,i,this.calculateCenterShift(this.targetCenter_,s,r,n));this.get(se.ROTATION)!==r&&this.set(se.ROTATION,r),this.get(se.RESOLUTION)!==s&&(this.set(se.RESOLUTION,s),this.set("zoom",this.getZoom(),!0)),o&&this.get(se.CENTER)&&ke(this.get(se.CENTER),o)||this.set(se.CENTER,o),this.getAnimating()&&!t&&this.cancelAnimations(),this.cancelAnchor_=void 0}resolveConstraints(t,e,i){t=void 0!==t?t:200;const r=e||0,n=this.constraints_.rotation(this.targetRotation_),s=this.getViewportSize_(n),o=this.constraints_.resolution(this.targetResolution_,r,s),a=this.constraints_.center(this.targetCenter_,o,s,!1,this.calculateCenterShift(this.targetCenter_,o,n,s));if(0===t&&!this.cancelAnchor_)return this.targetResolution_=o,this.targetRotation_=n,this.targetCenter_=a,void this.applyTargetState_();i=i||(0===t?this.cancelAnchor_:void 0),this.cancelAnchor_=void 0,this.getResolution()===o&&this.getRotation()===n&&this.getCenterInternal()&&ke(this.getCenterInternal(),a)||(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:n,center:a,resolution:o,duration:t,easing:si,anchor:i}))}beginInteraction(){this.resolveConstraints(0),this.setHint(1,1)}endInteraction(t,e,i){i=i&&qe(i,this.getProjection()),this.endInteractionInternal(t,e,i)}endInteractionInternal(t,e,i){this.getInteracting()&&(this.setHint(1,-1),this.resolveConstraints(t,e,i))}getConstrainedCenter(t,e){const i=this.getViewportSize_(this.getRotation());return this.constraints_.center(t,e||this.getResolution(),i)}getConstrainedZoom(t,e){const i=this.getResolutionForZoom(t);return this.getZoomForResolution(this.getConstrainedResolution(i,e))}getConstrainedResolution(t,e){e=e||0;const i=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(t,e,i)}};function Oi(t,e){if(!t.visible)return!1;const i=e.resolution;if(i<t.minResolution||i>=t.maxResolution)return!1;const r=e.zoom;return r>t.minZoom&&r<=t.maxZoom}const Ui=class extends ie{constructor(t){const e=Object.assign({},t);delete e.source,super(e),this.on,this.once,this.un,this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,this.renderer_=null,this.sourceReady_=!1,this.rendered=!1,t.render&&(this.render=t.render),t.map&&this.setMap(t.map),this.addChangeListener(ee,this.handleSourcePropertyChange_);const i=t.source?t.source:null;this.setSource(i)}getLayersArray(t){return(t=t||[]).push(this),t}getLayerStatesArray(t){return(t=t||[]).push(this.getLayerState()),t}getSource(){return this.get(ee)||null}getRenderSource(){return this.getSource()}getSourceState(){const t=this.getSource();return t?t.getState():"undefined"}handleSourceChange_(){this.changed(),this.sourceReady_||"ready"!==this.getSource().getState()||(this.sourceReady_=!0,this.dispatchEvent("sourceready"))}handleSourcePropertyChange_(){this.sourceChangeKey_&&(k(this.sourceChangeKey_),this.sourceChangeKey_=null),this.sourceReady_=!1;const t=this.getSource();t&&(this.sourceChangeKey_=x(t,m,this.handleSourceChange_,this),"ready"===t.getState()&&(this.sourceReady_=!0,setTimeout((()=>{this.dispatchEvent("sourceready")}),0))),this.changed()}getFeatures(t){return this.renderer_?this.renderer_.getFeatures(t):Promise.resolve([])}getData(t){return this.renderer_&&this.rendered?this.renderer_.getData(t):null}isVisible(t){let e;const i=this.getMapInternal();let r;!t&&i&&(t=i.getView()),e=t instanceof Ni?{viewState:t.getState(),extent:t.calculateExtent()}:t,!e.layerStatesArray&&i&&(e.layerStatesArray=i.getLayerGroup().getLayerStatesArray()),r=e.layerStatesArray?e.layerStatesArray.find((t=>t.layer===this)):this.getLayerState();const n=this.getExtent();return Oi(r,e.viewState)&&(!n||vt(n,e.extent))}getAttributions(t){if(!this.isVisible(t))return[];let e;const i=this.getSource();if(i&&(e=i.getAttributions()),!e)return[];let r=e(t instanceof Ni?t.getViewStateAndExtent():t);return Array.isArray(r)||(r=[r]),r}render(t,e){const i=this.getRenderer();return i.prepareFrame(t)?(this.rendered=!0,i.renderFrame(t,e)):null}unrender(){this.rendered=!1}setMapInternal(t){t||this.unrender(),this.set("map",t)}getMapInternal(){return this.get("map")}setMap(t){this.mapPrecomposeKey_&&(k(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),t||this.changed(),this.mapRenderKey_&&(k(this.mapRenderKey_),this.mapRenderKey_=null),t&&(this.mapPrecomposeKey_=x(t,re,(function(t){const e=t.frameState.layerStatesArray,i=this.getLayerState(!1);G(!e.some((function(t){return t.layer===i.layer})),"A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both."),e.push(i)}),this),this.mapRenderKey_=x(this,m,t.render,t),this.changed())}setSource(t){this.set(ee,t)}getRenderer(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_}hasRenderer(){return!!this.renderer_}createRenderer(){return null}disposeInternal(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_),this.setSource(null),super.disposeInternal()}};function Vi(t,e){qt.expire()}const Yi=class extends o{constructor(t){super(),this.map_=t}dispatchRenderEvent(t,e){S()}calculateMatrices2D(t){const e=t.viewState,i=t.coordinateToPixelTransform,r=t.pixelToCoordinateTransform;Z(i,t.size[0]/2,t.size[1]/2,1/e.resolution,-1/e.resolution,-e.rotation,-e.center[0],-e.center[1]),K(r,i)}forEachFeatureAtCoordinate(t,e,i,r,n,s,o,a){let h;const l=e.viewState;function u(t,e,i,r){return n.call(s,e,t?i:null,r)}const c=l.projection,d=function(t,e){if(e.canWrapX()){const i=yt(e.getExtent()),r=function(t,e,i){const r=e.getExtent();let n=0;return e.canWrapX()&&(t[0]<r[0]||t[0]>r[2])&&(i=i||yt(r),n=Math.floor((t[0]-r[0])/i)),n}(t,e,i);r&&(t[0]-=r*i)}return t}(t.slice(),c),f=[[0,0]];if(c.canWrapX()&&r){const t=yt(c.getExtent());f.push([-t,0],[t,0])}const g=e.layerStatesArray,m=g.length,p=[],w=[];for(let r=0;r<f.length;r++)for(let n=m-1;n>=0;--n){const s=g[n],c=s.layer;if(c.hasRenderer()&&Oi(s,l)&&o.call(a,c)){const n=c.getRenderer(),o=c.getSource();if(n&&o){const a=o.getWrapX()?d:t,l=u.bind(null,s.managed);w[0]=a[0]+f[r][0],w[1]=a[1]+f[r][1],h=n.forEachFeatureAtCoordinate(w,e,i,l,p)}if(h)return h}}if(0===p.length)return;const _=1/p.length;return p.forEach(((t,e)=>t.distanceSq+=e*_)),p.sort(((t,e)=>t.distanceSq-e.distanceSq)),p.some((t=>h=t.callback(t.feature,t.layer,t.geometry))),h}hasFeatureAtCoordinate(t,e,i,r,n,s){return void 0!==this.forEachFeatureAtCoordinate(t,e,i,r,u,this,n,s)}getMap(){return this.map_}renderFrame(t){S()}flushDeclutterItems(t){}scheduleExpireIconCache(t){qt.canExpireCache()&&t.postRenderFunctions.push(Vi)}},Xi=class extends n{constructor(t,e,i,r){super(t),this.inversePixelTransform=e,this.frameState=i,this.context=r}},ji="ol-hidden",Gi="ol-unselectable",qi="ol-control",Zi="ol-collapsed";new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))","?\\s*([-,\\\"\\'\\sa-z]+?)\\s*$"].join(""),"i");function Ki(t,e,i,r){let n;return n=i&&i.length?i.shift():Y?new OffscreenCanvas(t||300,e||300):document.createElement("canvas"),t&&(n.width=t),e&&(n.height=e),n.getContext("2d",r)}function Hi(t){const e=t.canvas;e.width=1,e.height=1,t.clearRect(0,0,1,1)}function Wi(t,e){const i=e.parentNode;i&&i.replaceChild(t,e)}function $i(t){return t&&t.parentNode?t.parentNode.removeChild(t):null}const Qi=new P;!function(){const t=["monospace","serif"];t.length}();const Ji=class extends Yi{constructor(t){super(t),this.fontChangeListenerKey_=x(Qi,s,t.redrawText.bind(t)),this.element_=document.createElement("div");const e=this.element_.style;e.position="absolute",e.width="100%",e.height="100%",e.zIndex="0",this.element_.className=Gi+" ol-layers";const i=t.getViewport();i.insertBefore(this.element_,i.firstChild||null),this.children_=[],this.renderedVisible_=!0,this.declutterLayers_=[]}dispatchRenderEvent(t,e){const i=this.getMap();if(i.hasListener(t)){const r=new Xi(t,void 0,e);i.dispatchEvent(r)}}disposeInternal(){k(this.fontChangeListenerKey_),this.element_.parentNode.removeChild(this.element_),super.disposeInternal()}renderFrame(t){if(!t)return void(this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1));this.calculateMatrices2D(t),this.dispatchRenderEvent(re,t);const e=t.layerStatesArray.sort((function(t,e){return t.zIndex-e.zIndex})),i=t.viewState;this.children_.length=0;const r=this.declutterLayers_;r.length=0;let n=null;for(let s=0,o=e.length;s<o;++s){const o=e[s];t.layerIndex=s;const a=o.layer,h=a.getSourceState();if(!Oi(o,i)||"ready"!=h&&"undefined"!=h){a.unrender();continue}const l=a.render(t,n);l&&(l!==n&&(this.children_.push(l),n=l),"getDeclutter"in a&&r.push(a))}this.flushDeclutterItems(t),function(t,e){const i=t.childNodes;for(let r=0;;++r){const n=i[r],s=e[r];if(!n&&!s)break;n!==s&&(n?s?t.insertBefore(s,n):(t.removeChild(n),--r):t.appendChild(s))}}(this.element_,this.children_),this.dispatchRenderEvent("postcompose",t),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(t)}flushDeclutterItems(t){const e=this.declutterLayers_;for(let i=e.length-1;i>=0;--i)e[i].renderDeclutter(t);e.length=0}};class tr extends n{constructor(t,e){super(t),this.layer=e}}const er="layers";class ir extends ie{constructor(t){t=t||{};const e=Object.assign({},t);delete e.layers;let i=t.layers;super(e),this.on,this.once,this.un,this.layersListenerKeys_=[],this.listenerKeys_={},this.addChangeListener(er,this.handleLayersChanged_),i?Array.isArray(i)?i=new z(i.slice(),{unique:!0}):G("function"==typeof i.getArray,"Expected `layers` to be an array or a `Collection`"):i=new z(void 0,{unique:!0}),this.setLayers(i)}handleLayerChange_(){this.changed()}handleLayersChanged_(){this.layersListenerKeys_.forEach(k),this.layersListenerKeys_.length=0;const t=this.getLayers();this.layersListenerKeys_.push(x(t,I,this.handleLayersAdd_,this),x(t,D,this.handleLayersRemove_,this));for(const t in this.listenerKeys_)this.listenerKeys_[t].forEach(k);f(this.listenerKeys_);const e=t.getArray();for(let t=0,i=e.length;t<i;t++){const i=e[t];this.registerLayerListeners_(i),this.dispatchEvent(new tr("addlayer",i))}this.changed()}registerLayerListeners_(t){const e=[x(t,s,this.handleLayerChange_,this),x(t,m,this.handleLayerChange_,this)];t instanceof ir&&e.push(x(t,"addlayer",this.handleLayerGroupAdd_,this),x(t,"removelayer",this.handleLayerGroupRemove_,this)),this.listenerKeys_[T(t)]=e}handleLayerGroupAdd_(t){this.dispatchEvent(new tr("addlayer",t.layer))}handleLayerGroupRemove_(t){this.dispatchEvent(new tr("removelayer",t.layer))}handleLayersAdd_(t){const e=t.element;this.registerLayerListeners_(e),this.dispatchEvent(new tr("addlayer",e)),this.changed()}handleLayersRemove_(t){const e=t.element,i=T(e);this.listenerKeys_[i].forEach(k),delete this.listenerKeys_[i],this.dispatchEvent(new tr("removelayer",e)),this.changed()}getLayers(){return this.get(er)}setLayers(t){const e=this.getLayers();if(e){const t=e.getArray();for(let e=0,i=t.length;e<i;++e)this.dispatchEvent(new tr("removelayer",t[e]))}this.set(er,t)}getLayersArray(t){return t=void 0!==t?t:[],this.getLayers().forEach((function(e){e.getLayersArray(t)})),t}getLayerStatesArray(t){const e=void 0!==t?t:[],i=e.length;this.getLayers().forEach((function(t){t.getLayerStatesArray(e)}));const r=this.getLayerState();let n=r.zIndex;t||void 0!==r.zIndex||(n=0);for(let t=i,s=e.length;t<s;t++){const i=e[t];i.opacity*=r.opacity,i.visible=i.visible&&r.visible,i.maxResolution=Math.min(i.maxResolution,r.maxResolution),i.minResolution=Math.max(i.minResolution,r.minResolution),i.minZoom=Math.max(i.minZoom,r.minZoom),i.maxZoom=Math.min(i.maxZoom,r.maxZoom),void 0!==r.extent&&(void 0!==i.extent?i.extent=wt(i.extent,r.extent):i.extent=r.extent),void 0===i.zIndex&&(i.zIndex=n)}return e}getSourceState(){return"ready"}}const rr=ir,nr=class extends n{constructor(t,e,i){super(t),this.map=e,this.frameState=void 0!==i?i:null}},sr=class extends nr{constructor(t,e,i,r,n,s){super(t,e,n),this.originalEvent=i,this.pixel_=null,this.coordinate_=null,this.dragging=void 0!==r&&r,this.activePointers=s}get pixel(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_}set pixel(t){this.pixel_=t}get coordinate(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_}set coordinate(t){this.coordinate_=t}preventDefault(){super.preventDefault(),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()}stopPropagation(){super.stopPropagation(),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()}},or={SINGLECLICK:"singleclick",CLICK:w,DBLCLICK:"dblclick",POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},ar="pointerdown",hr=class extends g{constructor(t,e){super(t),this.map_=t,this.clickTimeoutId_,this.emulateClicks_=!1,this.dragging_=!1,this.dragListenerKeys_=[],this.moveTolerance_=void 0===e?1:e,this.down_=null;const i=this.map_.getViewport();this.activePointers_=[],this.trackedTouches_={},this.element_=i,this.pointerdownListenerKey_=x(i,ar,this.handlePointerDown_,this),this.originalPointerMoveEvent_,this.relayedListenerKey_=x(i,"pointermove",this.relayMoveEvent_,this),this.boundHandleTouchMove_=this.handleTouchMove_.bind(this),this.element_.addEventListener(y,this.boundHandleTouchMove_,!!j&&{passive:!1})}emulateClick_(t){let e=new sr(or.CLICK,this.map_,t);this.dispatchEvent(e),void 0!==this.clickTimeoutId_?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,e=new sr(or.DBLCLICK,this.map_,t),this.dispatchEvent(e)):this.clickTimeoutId_=setTimeout((()=>{this.clickTimeoutId_=void 0;const e=new sr(or.SINGLECLICK,this.map_,t);this.dispatchEvent(e)}),250)}updateActivePointers_(t){const e=t,i=e.pointerId;if(e.type==or.POINTERUP||e.type==or.POINTERCANCEL){delete this.trackedTouches_[i];for(const t in this.trackedTouches_)if(this.trackedTouches_[t].target!==e.target){delete this.trackedTouches_[t];break}}else e.type!=or.POINTERDOWN&&e.type!=or.POINTERMOVE||(this.trackedTouches_[i]=e);this.activePointers_=Object.values(this.trackedTouches_)}handlePointerUp_(t){this.updateActivePointers_(t);const e=new sr(or.POINTERUP,this.map_,t,void 0,void 0,this.activePointers_);this.dispatchEvent(e),this.emulateClicks_&&!e.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(t)&&this.emulateClick_(this.down_),0===this.activePointers_.length&&(this.dragListenerKeys_.forEach(k),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)}isMouseActionButton_(t){return 0===t.button}handlePointerDown_(t){this.emulateClicks_=0===this.activePointers_.length,this.updateActivePointers_(t);const e=new sr(or.POINTERDOWN,this.map_,t,void 0,void 0,this.activePointers_);if(this.dispatchEvent(e),this.down_=new PointerEvent(t.type,t),Object.defineProperty(this.down_,"target",{writable:!1,value:t.target}),0===this.dragListenerKeys_.length){const t=this.map_.getOwnerDocument();this.dragListenerKeys_.push(x(t,or.POINTERMOVE,this.handlePointerMove_,this),x(t,or.POINTERUP,this.handlePointerUp_,this),x(this.element_,or.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==t&&this.dragListenerKeys_.push(x(this.element_.getRootNode(),or.POINTERUP,this.handlePointerUp_,this))}}handlePointerMove_(t){if(this.isMoving_(t)){this.updateActivePointers_(t),this.dragging_=!0;const e=new sr(or.POINTERDRAG,this.map_,t,this.dragging_,void 0,this.activePointers_);this.dispatchEvent(e)}}relayMoveEvent_(t){this.originalPointerMoveEvent_=t;const e=!(!this.down_||!this.isMoving_(t));this.dispatchEvent(new sr(or.POINTERMOVE,this.map_,t,e))}handleTouchMove_(t){const e=this.originalPointerMoveEvent_;e&&!e.defaultPrevented||"boolean"==typeof t.cancelable&&!0!==t.cancelable||t.preventDefault()}isMoving_(t){return this.dragging_||Math.abs(t.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(t.clientY-this.down_.clientY)>this.moveTolerance_}disposeInternal(){this.relayedListenerKey_&&(k(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(y,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(k(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(k),this.dragListenerKeys_.length=0,this.element_=null,super.disposeInternal()}},lr="postrender",ur="loadstart",cr="loadend",dr="layergroup",fr="size",gr="target",mr="view",pr=1/0,wr=class{constructor(t,e){this.priorityFunction_=t,this.keyFunction_=e,this.elements_=[],this.priorities_=[],this.queuedElements_={}}clear(){this.elements_.length=0,this.priorities_.length=0,f(this.queuedElements_)}dequeue(){const t=this.elements_,e=this.priorities_,i=t[0];1==t.length?(t.length=0,e.length=0):(t[0]=t.pop(),e[0]=e.pop(),this.siftUp_(0));const r=this.keyFunction_(i);return delete this.queuedElements_[r],i}enqueue(t){G(!(this.keyFunction_(t)in this.queuedElements_),"Tried to enqueue an `element` that was already added to the queue");const e=this.priorityFunction_(t);return e!=pr&&(this.elements_.push(t),this.priorities_.push(e),this.queuedElements_[this.keyFunction_(t)]=!0,this.siftDown_(0,this.elements_.length-1),!0)}getCount(){return this.elements_.length}getLeftChildIndex_(t){return 2*t+1}getRightChildIndex_(t){return 2*t+2}getParentIndex_(t){return t-1>>1}heapify_(){let t;for(t=(this.elements_.length>>1)-1;t>=0;t--)this.siftUp_(t)}isEmpty(){return 0===this.elements_.length}isKeyQueued(t){return t in this.queuedElements_}isQueued(t){return this.isKeyQueued(this.keyFunction_(t))}siftUp_(t){const e=this.elements_,i=this.priorities_,r=e.length,n=e[t],s=i[t],o=t;for(;t<r>>1;){const n=this.getLeftChildIndex_(t),s=this.getRightChildIndex_(t),o=s<r&&i[s]<i[n]?s:n;e[t]=e[o],i[t]=i[o],t=o}e[t]=n,i[t]=s,this.siftDown_(o,t)}siftDown_(t,e){const i=this.elements_,r=this.priorities_,n=i[e],s=r[e];for(;e>t;){const t=this.getParentIndex_(e);if(!(r[t]>s))break;i[e]=i[t],r[e]=r[t],e=t}i[e]=n,r[e]=s}reprioritize(){const t=this.priorityFunction_,e=this.elements_,i=this.priorities_;let r=0;const n=e.length;let s,o,a;for(o=0;o<n;++o)s=e[o],a=t(s),a==pr?delete this.queuedElements_[this.keyFunction_(s)]:(i[r]=a,e[r++]=s);e.length=r,i.length=r,this.heapify_()}},_r=class extends wr{constructor(t,e){super((function(e){return t.apply(null,e)}),(function(t){return t[0].getKey()})),this.boundHandleTileChange_=this.handleTileChange.bind(this),this.tileChangeCallback_=e,this.tilesLoading_=0,this.tilesLoadingKeys_={}}enqueue(t){const e=super.enqueue(t);return e&&t[0].addEventListener(m,this.boundHandleTileChange_),e}getTilesLoading(){return this.tilesLoading_}handleTileChange(t){const e=t.target,i=e.getState();if(2===i||3===i||4===i){3!==i&&e.removeEventListener(m,this.boundHandleTileChange_);const t=e.getKey();t in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[t],--this.tilesLoading_),this.tileChangeCallback_()}}loadMoreTiles(t,e){let i,r,n,s=0;for(;this.tilesLoading_<t&&s<e&&this.getCount()>0;)r=this.dequeue()[0],n=r.getKey(),i=r.getState(),0!==i||n in this.tilesLoadingKeys_||(this.tilesLoadingKeys_[n]=!0,++this.tilesLoading_,++s,r.load())}},br=class extends P{constructor(t){super();const e=t.element;!e||t.target||e.style.pointerEvents||(e.style.pointerEvents="auto"),this.element=e||null,this.target_=null,this.map_=null,this.listenerKeys=[],t.render&&(this.render=t.render),t.target&&this.setTarget(t.target)}disposeInternal(){$i(this.element),super.disposeInternal()}getMap(){return this.map_}setMap(t){this.map_&&$i(this.element);for(let t=0,e=this.listenerKeys.length;t<e;++t)k(this.listenerKeys[t]);this.listenerKeys.length=0,this.map_=t,t&&((this.target_?this.target_:t.getOverlayContainerStopEvent()).appendChild(this.element),this.render!==d&&this.listenerKeys.push(x(t,lr,this.render,this)),t.render())}render(t){}setTarget(t){this.target_="string"==typeof t?document.getElementById(t):t}},yr=class extends br{constructor(t){t=t||{},super({element:document.createElement("div"),render:t.render,target:t.target}),this.ulElement_=document.createElement("ul"),this.collapsed_=void 0===t.collapsed||t.collapsed,this.userCollapsed_=this.collapsed_,this.overrideCollapsible_=void 0!==t.collapsible,this.collapsible_=void 0===t.collapsible||t.collapsible,this.collapsible_||(this.collapsed_=!1);const e=void 0!==t.className?t.className:"ol-attribution",i=void 0!==t.tipLabel?t.tipLabel:"Attributions",r=void 0!==t.expandClassName?t.expandClassName:e+"-expand",n=void 0!==t.collapseLabel?t.collapseLabel:"",s=void 0!==t.collapseClassName?t.collapseClassName:e+"-collapse";"string"==typeof n?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=n,this.collapseLabel_.className=s):this.collapseLabel_=n;const o=void 0!==t.label?t.label:"i";"string"==typeof o?(this.label_=document.createElement("span"),this.label_.textContent=o,this.label_.className=r):this.label_=o;const a=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_;this.toggleButton_=document.createElement("button"),this.toggleButton_.setAttribute("type","button"),this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_)),this.toggleButton_.title=i,this.toggleButton_.appendChild(a),this.toggleButton_.addEventListener(w,this.handleClick_.bind(this),!1);const h=e+" "+Gi+" "+qi+(this.collapsed_&&this.collapsible_?" "+Zi:"")+(this.collapsible_?"":" ol-uncollapsible"),l=this.element;l.className=h,l.appendChild(this.toggleButton_),l.appendChild(this.ulElement_),this.renderedAttributions_=[],this.renderedVisible_=!0}collectSourceAttributions_(t){const e=Array.from(new Set(this.getMap().getAllLayers().flatMap((e=>e.getAttributions(t))))),i=!this.getMap().getAllLayers().some((t=>t.getSource()&&!1===t.getSource().getAttributionsCollapsible()));return this.overrideCollapsible_||this.setCollapsible(i),e}updateElement_(t){if(!t)return void(this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1));const e=this.collectSourceAttributions_(t),i=e.length>0;if(this.renderedVisible_!=i&&(this.element.style.display=i?"":"none",this.renderedVisible_=i),!l(e,this.renderedAttributions_)){!function(t){for(;t.lastChild;)t.removeChild(t.lastChild)}(this.ulElement_);for(let t=0,i=e.length;t<i;++t){const i=document.createElement("li");i.innerHTML=e[t],this.ulElement_.appendChild(i)}this.renderedAttributions_=e}}handleClick_(t){t.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_}handleToggle_(){this.element.classList.toggle(Zi),this.collapsed_?Wi(this.collapseLabel_,this.label_):Wi(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))}getCollapsible(){return this.collapsible_}setCollapsible(t){this.collapsible_!==t&&(this.collapsible_=t,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_())}setCollapsed(t){this.userCollapsed_=t,this.collapsible_&&this.collapsed_!==t&&this.handleToggle_()}getCollapsed(){return this.collapsed_}render(t){this.updateElement_(t.frameState)}},vr=class extends br{constructor(t){t=t||{},super({element:document.createElement("div"),render:t.render,target:t.target});const e=void 0!==t.className?t.className:"ol-rotate",i=void 0!==t.label?t.label:"",r=void 0!==t.compassClassName?t.compassClassName:"ol-compass";this.label_=null,"string"==typeof i?(this.label_=document.createElement("span"),this.label_.className=r,this.label_.textContent=i):(this.label_=i,this.label_.classList.add(r));const n=t.tipLabel?t.tipLabel:"Reset rotation",s=document.createElement("button");s.className=e+"-reset",s.setAttribute("type","button"),s.title=n,s.appendChild(this.label_),s.addEventListener(w,this.handleClick_.bind(this),!1);const o=e+" "+Gi+" "+qi,a=this.element;a.className=o,a.appendChild(s),this.callResetNorth_=t.resetNorth?t.resetNorth:void 0,this.duration_=void 0!==t.duration?t.duration:250,this.autoHide_=void 0===t.autoHide||t.autoHide,this.rotation_=void 0,this.autoHide_&&this.element.classList.add(ji)}handleClick_(t){t.preventDefault(),void 0!==this.callResetNorth_?this.callResetNorth_():this.resetNorth_()}resetNorth_(){const t=this.getMap().getView();if(!t)return;const e=t.getRotation();void 0!==e&&(this.duration_>0&&e%(2*Math.PI)!=0?t.animate({rotation:0,duration:this.duration_,easing:si}):t.setRotation(0))}render(t){const e=t.frameState;if(!e)return;const i=e.viewState.rotation;if(i!=this.rotation_){const t="rotate("+i+"rad)";if(this.autoHide_){const t=this.element.classList.contains(ji);t||0!==i?t&&0!==i&&this.element.classList.remove(ji):this.element.classList.add(ji)}this.label_.style.transform=t}this.rotation_=i}},xr=class extends br{constructor(t){t=t||{},super({element:document.createElement("div"),target:t.target});const e=void 0!==t.className?t.className:"ol-zoom",i=void 0!==t.delta?t.delta:1,r=void 0!==t.zoomInClassName?t.zoomInClassName:e+"-in",n=void 0!==t.zoomOutClassName?t.zoomOutClassName:e+"-out",s=void 0!==t.zoomInLabel?t.zoomInLabel:"+",o=void 0!==t.zoomOutLabel?t.zoomOutLabel:"",a=void 0!==t.zoomInTipLabel?t.zoomInTipLabel:"Zoom in",h=void 0!==t.zoomOutTipLabel?t.zoomOutTipLabel:"Zoom out",l=document.createElement("button");l.className=r,l.setAttribute("type","button"),l.title=a,l.appendChild("string"==typeof s?document.createTextNode(s):s),l.addEventListener(w,this.handleClick_.bind(this,i),!1);const u=document.createElement("button");u.className=n,u.setAttribute("type","button"),u.title=h,u.appendChild("string"==typeof o?document.createTextNode(o):o),u.addEventListener(w,this.handleClick_.bind(this,-i),!1);const c=e+" "+Gi+" "+qi,d=this.element;d.className=c,d.appendChild(l),d.appendChild(u),this.duration_=void 0!==t.duration?t.duration:250}handleClick_(t,e){e.preventDefault(),this.zoomByDelta_(t)}zoomByDelta_(t){const e=this.getMap().getView();if(!e)return;const i=e.getZoom();if(void 0!==i){const r=e.getConstrainedZoom(i+t);this.duration_>0?(e.getAnimating()&&e.cancelAnimations(),e.animate({zoom:r,duration:this.duration_,easing:si})):e.setZoom(r)}}},Mr="active";function kr(t,e,i,r){const n=t.getZoom();if(void 0===n)return;const s=t.getConstrainedZoom(n+e),o=t.getResolutionForZoom(s);t.getAnimating()&&t.cancelAnimations(),t.animate({resolution:o,anchor:i,duration:void 0!==r?r:250,easing:si})}const Er=class extends P{constructor(t){super(),this.on,this.once,this.un,t&&t.handleEvent&&(this.handleEvent=t.handleEvent),this.map_=null,this.setActive(!0)}getActive(){return this.get(Mr)}getMap(){return this.map_}handleEvent(t){return!0}setActive(t){this.set(Mr,t)}setMap(t){this.map_=t}},Cr=class extends Er{constructor(t){super(),t=t||{},this.delta_=t.delta?t.delta:1,this.duration_=void 0!==t.duration?t.duration:250}handleEvent(t){let e=!1;if(t.type==or.DBLCLICK){const i=t.originalEvent,r=t.map,n=t.coordinate,s=i.shiftKey?-this.delta_:this.delta_;kr(r.getView(),s,n,this.duration_),i.preventDefault(),e=!0}return!e}};function Sr(t){const e=t.length;let i=0,r=0;for(let n=0;n<e;n++)i+=t[n].clientX,r+=t[n].clientY;return{clientX:i/e,clientY:r/e}}const Ar=class extends Er{constructor(t){super(t=t||{}),t.handleDownEvent&&(this.handleDownEvent=t.handleDownEvent),t.handleDragEvent&&(this.handleDragEvent=t.handleDragEvent),t.handleMoveEvent&&(this.handleMoveEvent=t.handleMoveEvent),t.handleUpEvent&&(this.handleUpEvent=t.handleUpEvent),t.stopDown&&(this.stopDown=t.stopDown),this.handlingDownUpSequence=!1,this.targetPointers=[]}getPointerCount(){return this.targetPointers.length}handleDownEvent(t){return!1}handleDragEvent(t){}handleEvent(t){if(!t.originalEvent)return!0;let e=!1;if(this.updateTrackedPointers_(t),this.handlingDownUpSequence){if(t.type==or.POINTERDRAG)this.handleDragEvent(t),t.originalEvent.preventDefault();else if(t.type==or.POINTERUP){const e=this.handleUpEvent(t);this.handlingDownUpSequence=e&&this.targetPointers.length>0}}else if(t.type==or.POINTERDOWN){const i=this.handleDownEvent(t);this.handlingDownUpSequence=i,e=this.stopDown(i)}else t.type==or.POINTERMOVE&&this.handleMoveEvent(t);return!e}handleMoveEvent(t){}handleUpEvent(t){return!1}stopDown(t){return t}updateTrackedPointers_(t){t.activePointers&&(this.targetPointers=t.activePointers)}};function Tr(t){const e=arguments;return function(t){let i=!0;for(let r=0,n=e.length;r<n&&(i=i&&e[r](t),i);++r);return i}}const Rr=function(t){const e=t.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},Pr=function(t){return!t.map.getTargetElement().hasAttribute("tabindex")||function(t){const e=t.map.getTargetElement(),i=t.map.getOwnerDocument().activeElement;return e.contains(i)}(t)},Ir=u,Dr=function(t){const e=t.originalEvent;return 0==e.button&&!(O&&U&&e.ctrlKey)},Lr=function(t){const e=t.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},Fr=function(t){const e=t.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},zr=function(t){const e=t.originalEvent,i=e.target.tagName;return"INPUT"!==i&&"SELECT"!==i&&"TEXTAREA"!==i&&!e.target.isContentEditable},Br=function(t){const e=t.originalEvent;return G(void 0!==e,"mapBrowserEvent must originate from a pointer event"),"mouse"==e.pointerType},Nr=function(t){const e=t.originalEvent;return G(void 0!==e,"mapBrowserEvent must originate from a pointer event"),e.isPrimary&&0===e.button},Or=class extends Ar{constructor(t){super({stopDown:c}),t=t||{},this.kinetic_=t.kinetic,this.lastCentroid=null,this.lastPointersCount_,this.panning_=!1;const e=t.condition?t.condition:Tr(Lr,Nr);this.condition_=t.onFocusOnly?Tr(Pr,e):e,this.noKinetic_=!1}handleDragEvent(t){const e=t.map;this.panning_||(this.panning_=!0,e.getView().beginInteraction());const i=this.targetPointers,r=e.getEventPixel(Sr(i));if(i.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(r[0],r[1]),this.lastCentroid){const e=[this.lastCentroid[0]-r[0],r[1]-this.lastCentroid[1]],i=t.map.getView();n=e,s=i.getResolution(),n[0]*=s,n[1]*=s,Ee(e,i.getRotation()),i.adjustCenterInternal(e)}}else this.kinetic_&&this.kinetic_.begin();var n,s;this.lastCentroid=r,this.lastPointersCount_=i.length,t.originalEvent.preventDefault()}handleUpEvent(t){const e=t.map,i=e.getView();if(0===this.targetPointers.length){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){const t=this.kinetic_.getDistance(),r=this.kinetic_.getAngle(),n=i.getCenterInternal(),s=e.getPixelFromCoordinateInternal(n),o=e.getCoordinateFromPixelInternal([s[0]-t*Math.cos(r),s[1]-t*Math.sin(r)]);i.animateInternal({center:i.getConstrainedCenter(o),duration:500,easing:si})}return this.panning_&&(this.panning_=!1,i.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0}handleDownEvent(t){if(this.targetPointers.length>0&&this.condition_(t)){const e=t.map.getView();return this.lastCentroid=null,e.getAnimating()&&e.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1}},Ur=class extends Ar{constructor(t){t=t||{},super({stopDown:c}),this.condition_=t.condition?t.condition:Rr,this.lastAngle_=void 0,this.duration_=void 0!==t.duration?t.duration:250}handleDragEvent(t){if(!Br(t))return;const e=t.map,i=e.getView();if(i.getConstraints().rotation===ii)return;const r=e.getSize(),n=t.pixel,s=Math.atan2(r[1]/2-n[1],n[0]-r[0]/2);if(void 0!==this.lastAngle_){const t=s-this.lastAngle_;i.adjustRotationInternal(-t)}this.lastAngle_=s}handleUpEvent(t){return!Br(t)||(t.map.getView().endInteraction(this.duration_),!1)}handleDownEvent(t){return!!Br(t)&&(!(!Dr(t)||!this.condition_(t))&&(t.map.getView().beginInteraction(),this.lastAngle_=void 0,!0))}},Vr=class extends o{constructor(t){super(),this.geometry_=null,this.element_=document.createElement("div"),this.element_.style.position="absolute",this.element_.style.pointerEvents="auto",this.element_.className="ol-box "+t,this.map_=null,this.startPixel_=null,this.endPixel_=null}disposeInternal(){this.setMap(null)}render_(){const t=this.startPixel_,e=this.endPixel_,i="px",r=this.element_.style;r.left=Math.min(t[0],e[0])+i,r.top=Math.min(t[1],e[1])+i,r.width=Math.abs(e[0]-t[0])+i,r.height=Math.abs(e[1]-t[1])+i}setMap(t){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);const t=this.element_.style;t.left="inherit",t.top="inherit",t.width="inherit",t.height="inherit"}this.map_=t,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)}setPixels(t,e){this.startPixel_=t,this.endPixel_=e,this.createOrUpdateGeometry(),this.render_()}createOrUpdateGeometry(){const t=this.startPixel_,e=this.endPixel_,i=[t,[t[0],e[1]],e,[e[0],t[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);i[4]=i[0].slice(),this.geometry_?this.geometry_.setCoordinates([i]):this.geometry_=new Di([i])}getGeometry(){return this.geometry_}};class Yr extends n{constructor(t,e,i){super(t),this.coordinate=e,this.mapBrowserEvent=i}}const Xr=class extends Ar{constructor(t){super(),this.on,this.once,this.un,t=t||{},this.box_=new Vr(t.className||"ol-dragbox"),this.minArea_=void 0!==t.minArea?t.minArea:64,t.onBoxEnd&&(this.onBoxEnd=t.onBoxEnd),this.startPixel_=null,this.condition_=t.condition?t.condition:Dr,this.boxEndCondition_=t.boxEndCondition?t.boxEndCondition:this.defaultBoxEndCondition}defaultBoxEndCondition(t,e,i){const r=i[0]-e[0],n=i[1]-e[1];return r*r+n*n>=this.minArea_}getGeometry(){return this.box_.getGeometry()}handleDragEvent(t){this.box_.setPixels(this.startPixel_,t.pixel),this.dispatchEvent(new Yr("boxdrag",t.coordinate,t))}handleUpEvent(t){this.box_.setMap(null);const e=this.boxEndCondition_(t,this.startPixel_,t.pixel);return e&&this.onBoxEnd(t),this.dispatchEvent(new Yr(e?"boxend":"boxcancel",t.coordinate,t)),!1}handleDownEvent(t){return!!this.condition_(t)&&(this.startPixel_=t.pixel,this.box_.setMap(t.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new Yr("boxstart",t.coordinate,t)),!0)}onBoxEnd(t){}},jr=class extends Xr{constructor(t){super({condition:(t=t||{}).condition?t.condition:Fr,className:t.className||"ol-dragzoom",minArea:t.minArea}),this.duration_=void 0!==t.duration?t.duration:200,this.out_=void 0!==t.out&&t.out}onBoxEnd(t){const e=this.getMap().getView();let i=this.getGeometry();if(this.out_){const t=e.rotatedExtentForGeometry(i),r=e.getResolutionForExtentInternal(t),n=e.getResolution()/r;i=i.clone(),i.scale(n*n)}e.fitInternal(i,{duration:this.duration_,easing:si})}},Gr="ArrowLeft",qr="ArrowRight",Zr="ArrowDown",Kr=class extends Er{constructor(t){super(),t=t||{},this.defaultCondition_=function(t){return Lr(t)&&zr(t)},this.condition_=void 0!==t.condition?t.condition:this.defaultCondition_,this.duration_=void 0!==t.duration?t.duration:100,this.pixelDelta_=void 0!==t.pixelDelta?t.pixelDelta:128}handleEvent(t){let e=!1;if(t.type==_){const i=t.originalEvent,r=i.key;if(this.condition_(t)&&(r==Zr||r==Gr||r==qr||"ArrowUp"==r)){const n=t.map.getView(),s=n.getResolution()*this.pixelDelta_;let o=0,a=0;r==Zr?a=-s:r==Gr?o=-s:r==qr?o=s:a=s;const h=[o,a];Ee(h,n.getRotation()),function(t,e,i){const r=t.getCenterInternal();if(r){const n=[r[0]+e[0],r[1]+e[1]];t.animateInternal({duration:void 0!==i?i:250,easing:ai,center:t.getConstrainedCenter(n)})}}(n,h,this.duration_),i.preventDefault(),e=!0}}return!e}},Hr=class extends Er{constructor(t){super(),t=t||{},this.condition_=t.condition?t.condition:function(t){return!function(t){const e=t.originalEvent;return U?e.metaKey:e.ctrlKey}(t)&&zr(t)},this.delta_=t.delta?t.delta:1,this.duration_=void 0!==t.duration?t.duration:100}handleEvent(t){let e=!1;if(t.type==_||t.type==b){const i=t.originalEvent,r=i.key;if(this.condition_(t)&&("+"===r||"-"===r)){const n=t.map,s="+"===r?this.delta_:-this.delta_;kr(n.getView(),s,void 0,this.duration_),i.preventDefault(),e=!0}}return!e}},Wr=class{constructor(t,e,i){this.decay_=t,this.minVelocity_=e,this.delay_=i,this.points_=[],this.angle_=0,this.initialVelocity_=0}begin(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0}update(t,e){this.points_.push(t,e,Date.now())}end(){if(this.points_.length<6)return!1;const t=Date.now()-this.delay_,e=this.points_.length-3;if(this.points_[e+2]<t)return!1;let i=e-3;for(;i>0&&this.points_[i+2]>t;)i-=3;const r=this.points_[e+2]-this.points_[i+2];if(r<1e3/60)return!1;const n=this.points_[e]-this.points_[i],s=this.points_[e+1]-this.points_[i+1];return this.angle_=Math.atan2(s,n),this.initialVelocity_=Math.sqrt(n*n+s*s)/r,this.initialVelocity_>this.minVelocity_}getDistance(){return(this.minVelocity_-this.initialVelocity_)/this.decay_}getAngle(){return this.angle_}},$r=class extends Er{constructor(t){super(t=t||{}),this.totalDelta_=0,this.lastDelta_=0,this.maxDelta_=void 0!==t.maxDelta?t.maxDelta:1,this.duration_=void 0!==t.duration?t.duration:250,this.timeout_=void 0!==t.timeout?t.timeout:80,this.useAnchor_=void 0===t.useAnchor||t.useAnchor,this.constrainResolution_=void 0!==t.constrainResolution&&t.constrainResolution;const e=t.condition?t.condition:Ir;this.condition_=t.onFocusOnly?Tr(Pr,e):e,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_,this.mode_=void 0,this.trackpadEventGap_=400,this.trackpadTimeoutId_,this.deltaPerZoom_=300}endInteraction_(){this.trackpadTimeoutId_=void 0;const t=this.getMap();t&&t.getView().endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_)}handleEvent(t){if(!this.condition_(t))return!0;if(t.type!==v)return!0;const e=t.map,i=t.originalEvent;let r;if(i.preventDefault(),this.useAnchor_&&(this.lastAnchor_=t.coordinate),t.type==v&&(r=i.deltaY,N&&i.deltaMode===WheelEvent.DOM_DELTA_PIXEL&&(r/=V),i.deltaMode===WheelEvent.DOM_DELTA_LINE&&(r*=40)),0===r)return!1;this.lastDelta_=r;const n=Date.now();void 0===this.startTime_&&(this.startTime_=n),(!this.mode_||n-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(r)<4?"trackpad":"wheel");const s=e.getView();if("trackpad"===this.mode_&&!s.getConstrainResolution()&&!this.constrainResolution_)return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(s.getAnimating()&&s.cancelAnimations(),s.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),s.adjustZoom(-r/this.deltaPerZoom_,this.lastAnchor_),this.startTime_=n,!1;this.totalDelta_+=r;const o=Math.max(this.timeout_-(n-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,e),o),!1}handleWheelZoom_(t){const e=t.getView();e.getAnimating()&&e.cancelAnimations();let i=-It(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(e.getConstrainResolution()||this.constrainResolution_)&&(i=i?i>0?1:-1:0),kr(e,i,this.lastAnchor_,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0}setMouseAnchor(t){this.useAnchor_=t,t||(this.lastAnchor_=null)}},Qr=class extends Ar{constructor(t){const e=t=t||{};e.stopDown||(e.stopDown=c),super(e),this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.threshold_=void 0!==t.threshold?t.threshold:.3,this.duration_=void 0!==t.duration?t.duration:250}handleDragEvent(t){let e=0;const i=this.targetPointers[0],r=this.targetPointers[1],n=Math.atan2(r.clientY-i.clientY,r.clientX-i.clientX);if(void 0!==this.lastAngle_){const t=n-this.lastAngle_;this.rotationDelta_+=t,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),e=t}this.lastAngle_=n;const s=t.map,o=s.getView();o.getConstraints().rotation!==ii&&(this.anchor_=s.getCoordinateFromPixelInternal(s.getEventPixel(Sr(this.targetPointers))),this.rotating_&&(s.render(),o.adjustRotationInternal(e,this.anchor_)))}handleUpEvent(t){return!(this.targetPointers.length<2)||(t.map.getView().endInteraction(this.duration_),!1)}handleDownEvent(t){if(this.targetPointers.length>=2){const e=t.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||e.getView().beginInteraction(),!0}return!1}},Jr=class extends Ar{constructor(t){const e=t=t||{};e.stopDown||(e.stopDown=c),super(e),this.anchor_=null,this.duration_=void 0!==t.duration?t.duration:400,this.lastDistance_=void 0,this.lastScaleDelta_=1}handleDragEvent(t){let e=1;const i=this.targetPointers[0],r=this.targetPointers[1],n=i.clientX-r.clientX,s=i.clientY-r.clientY,o=Math.sqrt(n*n+s*s);void 0!==this.lastDistance_&&(e=this.lastDistance_/o),this.lastDistance_=o;const a=t.map,h=a.getView();1!=e&&(this.lastScaleDelta_=e),this.anchor_=a.getCoordinateFromPixelInternal(a.getEventPixel(Sr(this.targetPointers))),a.render(),h.adjustResolutionInternal(e,this.anchor_)}handleUpEvent(t){if(this.targetPointers.length<2){const e=t.map.getView(),i=this.lastScaleDelta_>1?1:-1;return e.endInteraction(this.duration_,i),!1}return!0}handleDownEvent(t){if(this.targetPointers.length>=2){const e=t.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||e.getView().beginInteraction(),!0}return!1}};function tn(t){return t[0]>0&&t[1]>0}function en(t,e){return Array.isArray(t)?t:(void 0===e?e=[t,t]:(e[0]=t,e[1]=t),e)}function rn(t){t instanceof Ui?t.setMapInternal(null):t instanceof rr&&t.getLayers().forEach(rn)}function nn(t,e){if(t instanceof Ui)t.setMapInternal(e);else if(t instanceof rr){const i=t.getLayers().getArray();for(let t=0,r=i.length;t<r;++t)nn(i[t],e)}}const sn=class extends P{constructor(t){super(),t=t||{},this.on,this.once,this.un;const e=function(t){let e=null;void 0!==t.keyboardEventTarget&&(e="string"==typeof t.keyboardEventTarget?document.getElementById(t.keyboardEventTarget):t.keyboardEventTarget);const i={},r=t.layers&&"function"==typeof t.layers.getLayers?t.layers:new rr({layers:t.layers});let n,s,o;return i[dr]=r,i[gr]=t.target,i[mr]=t.view instanceof Ni?t.view:new Ni,void 0!==t.controls&&(Array.isArray(t.controls)?n=new z(t.controls.slice()):(G("function"==typeof t.controls.getArray,"Expected `controls` to be an array or an `ol/Collection.js`"),n=t.controls)),void 0!==t.interactions&&(Array.isArray(t.interactions)?s=new z(t.interactions.slice()):(G("function"==typeof t.interactions.getArray,"Expected `interactions` to be an array or an `ol/Collection.js`"),s=t.interactions)),void 0!==t.overlays?Array.isArray(t.overlays)?o=new z(t.overlays.slice()):(G("function"==typeof t.overlays.getArray,"Expected `overlays` to be an array or an `ol/Collection.js`"),o=t.overlays):o=new z,{controls:n,interactions:s,keyboardEventTarget:e,overlays:o,values:i}}(t);this.renderComplete_,this.loaded_=!0,this.boundHandleBrowserEvent_=this.handleBrowserEvent.bind(this),this.maxTilesLoading_=void 0!==t.maxTilesLoading?t.maxTilesLoading:16,this.pixelRatio_=void 0!==t.pixelRatio?t.pixelRatio:V,this.postRenderTimeoutHandle_,this.animationDelayKey_,this.animationDelay_=this.animationDelay_.bind(this),this.coordinateToPixelTransform_=[1,0,0,1,0,0],this.pixelToCoordinateTransform_=[1,0,0,1,0,0],this.frameIndex_=0,this.frameState_=null,this.previousExtent_=null,this.viewPropertyListenerKey_=null,this.viewChangeListenerKey_=null,this.layerGroupPropertyListenerKeys_=null,this.viewport_=document.createElement("div"),this.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),this.viewport_.style.position="relative",this.viewport_.style.overflow="hidden",this.viewport_.style.width="100%",this.viewport_.style.height="100%",this.overlayContainer_=document.createElement("div"),this.overlayContainer_.style.position="absolute",this.overlayContainer_.style.zIndex="0",this.overlayContainer_.style.width="100%",this.overlayContainer_.style.height="100%",this.overlayContainer_.style.pointerEvents="none",this.overlayContainer_.className="ol-overlaycontainer",this.viewport_.appendChild(this.overlayContainer_),this.overlayContainerStopEvent_=document.createElement("div"),this.overlayContainerStopEvent_.style.position="absolute",this.overlayContainerStopEvent_.style.zIndex="0",this.overlayContainerStopEvent_.style.width="100%",this.overlayContainerStopEvent_.style.height="100%",this.overlayContainerStopEvent_.style.pointerEvents="none",this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",this.viewport_.appendChild(this.overlayContainerStopEvent_),this.mapBrowserEventHandler_=null,this.moveTolerance_=t.moveTolerance,this.keyboardEventTarget_=e.keyboardEventTarget,this.targetChangeHandlerKeys_=null,this.targetElement_=null,this.resizeObserver_=new ResizeObserver((()=>this.updateSize())),this.controls=e.controls||function(t){t=t||{};const e=new z;return(void 0===t.zoom||t.zoom)&&e.push(new xr(t.zoomOptions)),(void 0===t.rotate||t.rotate)&&e.push(new vr(t.rotateOptions)),(void 0===t.attribution||t.attribution)&&e.push(new yr(t.attributionOptions)),e}(),this.interactions=e.interactions||function(t){t=t||{};const e=new z,i=new Wr(-.005,.05,100);return(void 0===t.altShiftDragRotate||t.altShiftDragRotate)&&e.push(new Ur),(void 0===t.doubleClickZoom||t.doubleClickZoom)&&e.push(new Cr({delta:t.zoomDelta,duration:t.zoomDuration})),(void 0===t.dragPan||t.dragPan)&&e.push(new Or({onFocusOnly:t.onFocusOnly,kinetic:i})),(void 0===t.pinchRotate||t.pinchRotate)&&e.push(new Qr),(void 0===t.pinchZoom||t.pinchZoom)&&e.push(new Jr({duration:t.zoomDuration})),(void 0===t.keyboard||t.keyboard)&&(e.push(new Kr),e.push(new Hr({delta:t.zoomDelta,duration:t.zoomDuration}))),(void 0===t.mouseWheelZoom||t.mouseWheelZoom)&&e.push(new $r({onFocusOnly:t.onFocusOnly,duration:t.zoomDuration})),(void 0===t.shiftDragZoom||t.shiftDragZoom)&&e.push(new jr({duration:t.zoomDuration})),e}({onFocusOnly:!0}),this.overlays_=e.overlays,this.overlayIdIndex_={},this.renderer_=null,this.postRenderFunctions_=[],this.tileQueue_=new _r(this.getTilePriority.bind(this),this.handleTileChange_.bind(this)),this.addChangeListener(dr,this.handleLayerGroupChanged_),this.addChangeListener(mr,this.handleViewChanged_),this.addChangeListener(fr,this.handleSizeChanged_),this.addChangeListener(gr,this.handleTargetChanged_),this.setProperties(e.values);const i=this;!t.view||t.view instanceof Ni||t.view.then((function(t){i.setView(new Ni(t))})),this.controls.addEventListener(I,(t=>{t.element.setMap(this)})),this.controls.addEventListener(D,(t=>{t.element.setMap(null)})),this.interactions.addEventListener(I,(t=>{t.element.setMap(this)})),this.interactions.addEventListener(D,(t=>{t.element.setMap(null)})),this.overlays_.addEventListener(I,(t=>{this.addOverlayInternal_(t.element)})),this.overlays_.addEventListener(D,(t=>{const e=t.element.getId();void 0!==e&&delete this.overlayIdIndex_[e.toString()],t.element.setMap(null)})),this.controls.forEach((t=>{t.setMap(this)})),this.interactions.forEach((t=>{t.setMap(this)})),this.overlays_.forEach(this.addOverlayInternal_.bind(this))}addControl(t){this.getControls().push(t)}addInteraction(t){this.getInteractions().push(t)}addLayer(t){this.getLayerGroup().getLayers().push(t)}handleLayerAdd_(t){nn(t.layer,this)}addOverlay(t){this.getOverlays().push(t)}addOverlayInternal_(t){const e=t.getId();void 0!==e&&(this.overlayIdIndex_[e.toString()]=t),t.setMap(this)}disposeInternal(){this.controls.clear(),this.interactions.clear(),this.overlays_.clear(),this.resizeObserver_.disconnect(),this.setTarget(null),super.disposeInternal()}forEachFeatureAtPixel(t,e,i){if(!this.frameState_||!this.renderer_)return;const r=this.getCoordinateFromPixelInternal(t),n=void 0!==(i=void 0!==i?i:{}).hitTolerance?i.hitTolerance:0,s=void 0!==i.layerFilter?i.layerFilter:u,o=!1!==i.checkWrapped;return this.renderer_.forEachFeatureAtCoordinate(r,this.frameState_,n,o,e,null,s,null)}getFeaturesAtPixel(t,e){const i=[];return this.forEachFeatureAtPixel(t,(function(t){i.push(t)}),e),i}getAllLayers(){const t=[];return function e(i){i.forEach((function(i){i instanceof rr?e(i.getLayers()):t.push(i)}))}(this.getLayers()),t}hasFeatureAtPixel(t,e){if(!this.frameState_||!this.renderer_)return!1;const i=this.getCoordinateFromPixelInternal(t),r=void 0!==(e=void 0!==e?e:{}).layerFilter?e.layerFilter:u,n=void 0!==e.hitTolerance?e.hitTolerance:0,s=!1!==e.checkWrapped;return this.renderer_.hasFeatureAtCoordinate(i,this.frameState_,n,s,r,null)}getEventCoordinate(t){return this.getCoordinateFromPixel(this.getEventPixel(t))}getEventCoordinateInternal(t){return this.getCoordinateFromPixelInternal(this.getEventPixel(t))}getEventPixel(t){const e=this.viewport_.getBoundingClientRect(),i=this.getSize(),r=e.width/i[0],n=e.height/i[1],s="changedTouches"in t?t.changedTouches[0]:t;return[(s.clientX-e.left)/r,(s.clientY-e.top)/n]}getTarget(){return this.get(gr)}getTargetElement(){return this.targetElement_}getCoordinateFromPixel(t){return Ge(this.getCoordinateFromPixelInternal(t),this.getView().getProjection())}getCoordinateFromPixelInternal(t){const e=this.frameState_;return e?q(e.pixelToCoordinateTransform,t.slice()):null}getControls(){return this.controls}getOverlays(){return this.overlays_}getOverlayById(t){const e=this.overlayIdIndex_[t.toString()];return void 0!==e?e:null}getInteractions(){return this.interactions}getLayerGroup(){return this.get(dr)}setLayers(t){const e=this.getLayerGroup();if(t instanceof z)return void e.setLayers(t);const i=e.getLayers();i.clear(),i.extend(t)}getLayers(){return this.getLayerGroup().getLayers()}getLoadingOrNotReady(){const t=this.getLayerGroup().getLayerStatesArray();for(let e=0,i=t.length;e<i;++e){const i=t[e];if(!i.visible)continue;const r=i.layer.getRenderer();if(r&&!r.ready)return!0;const n=i.layer.getSource();if(n&&n.loading)return!0}return!1}getPixelFromCoordinate(t){const e=qe(t,this.getView().getProjection());return this.getPixelFromCoordinateInternal(e)}getPixelFromCoordinateInternal(t){const e=this.frameState_;return e?q(e.coordinateToPixelTransform,t.slice(0,2)):null}getRenderer(){return this.renderer_}getSize(){return this.get(fr)}getView(){return this.get(mr)}getViewport(){return this.viewport_}getOverlayContainer(){return this.overlayContainer_}getOverlayContainerStopEvent(){return this.overlayContainerStopEvent_}getOwnerDocument(){const t=this.getTargetElement();return t?t.ownerDocument:document}getTilePriority(t,e,i,r){return function(t,e,i,r,n){if(!t||!(i in t.wantedTiles))return pr;if(!t.wantedTiles[i][e.getKey()])return pr;const s=t.viewState.center,o=r[0]-s[0],a=r[1]-s[1];return 65536*Math.log(n)+Math.sqrt(o*o+a*a)/n}(this.frameState_,t,e,i,r)}handleBrowserEvent(t,e){e=e||t.type;const i=new sr(e,this,t);this.handleMapBrowserEvent(i)}handleMapBrowserEvent(t){if(!this.frameState_)return;const e=t.originalEvent,i=e.type;if(i===ar||i===v||i===_){const t=this.getOwnerDocument(),i=this.viewport_.getRootNode?this.viewport_.getRootNode():t,r=e.target;if(this.overlayContainerStopEvent_.contains(r)||!(i===t?t.documentElement:i).contains(r))return}if(t.frameState=this.frameState_,!1!==this.dispatchEvent(t)){const e=this.getInteractions().getArray().slice();for(let i=e.length-1;i>=0;i--){const r=e[i];if(r.getMap()===this&&r.getActive()&&this.getTargetElement()&&(!r.handleEvent(t)||t.propagationStopped))break}}}handlePostRender(){const t=this.frameState_,e=this.tileQueue_;if(!e.isEmpty()){let i=this.maxTilesLoading_,r=i;if(t){const e=t.viewHints;if(e[0]||e[1]){const e=Date.now()-t.time>8;i=e?0:8,r=e?0:2}}e.getTilesLoading()<i&&(e.reprioritize(),e.loadMoreTiles(i,r))}t&&this.renderer_&&!t.animate&&(!0===this.renderComplete_?(this.hasListener(ne)&&this.renderer_.dispatchRenderEvent(ne,t),!1===this.loaded_&&(this.loaded_=!0,this.dispatchEvent(new nr(cr,this,t)))):!0===this.loaded_&&(this.loaded_=!1,this.dispatchEvent(new nr(ur,this,t))));const i=this.postRenderFunctions_;for(let e=0,r=i.length;e<r;++e)i[e](this,t);i.length=0}handleSizeChanged_(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()}handleTargetChanged_(){if(this.mapBrowserEventHandler_){for(let t=0,e=this.targetChangeHandlerKeys_.length;t<e;++t)k(this.targetChangeHandlerKeys_[t]);this.targetChangeHandlerKeys_=null,this.viewport_.removeEventListener(p,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(v,this.boundHandleBrowserEvent_),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,$i(this.viewport_)}if(this.targetElement_){this.resizeObserver_.unobserve(this.targetElement_);const t=this.targetElement_.getRootNode();t instanceof ShadowRoot&&this.resizeObserver_.unobserve(t.host),this.setSize(void 0)}const t=this.getTarget(),e="string"==typeof t?document.getElementById(t):t;if(this.targetElement_=e,e){e.appendChild(this.viewport_),this.renderer_||(this.renderer_=new Ji(this)),this.mapBrowserEventHandler_=new hr(this,this.moveTolerance_);for(const t in or)this.mapBrowserEventHandler_.addEventListener(or[t],this.handleMapBrowserEvent.bind(this));this.viewport_.addEventListener(p,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(v,this.boundHandleBrowserEvent_,!!j&&{passive:!1});const t=this.keyboardEventTarget_?this.keyboardEventTarget_:e;this.targetChangeHandlerKeys_=[x(t,_,this.handleBrowserEvent,this),x(t,b,this.handleBrowserEvent,this)];const i=e.getRootNode();i instanceof ShadowRoot&&this.resizeObserver_.observe(i.host),this.resizeObserver_.observe(e)}else this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);this.updateSize()}handleTileChange_(){this.render()}handleViewPropertyChanged_(){this.render()}handleViewChanged_(){this.viewPropertyListenerKey_&&(k(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(k(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);const t=this.getView();t&&(this.updateViewportSize_(this.getSize()),this.viewPropertyListenerKey_=x(t,s,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=x(t,m,this.handleViewPropertyChanged_,this),t.resolveConstraints(0)),this.render()}handleLayerGroupChanged_(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(k),this.layerGroupPropertyListenerKeys_=null);const t=this.getLayerGroup();t&&(this.handleLayerAdd_(new tr("addlayer",t)),this.layerGroupPropertyListenerKeys_=[x(t,s,this.render,this),x(t,m,this.render,this),x(t,"addlayer",this.handleLayerAdd_,this),x(t,"removelayer",this.handleLayerRemove_,this)]),this.render()}isRendered(){return!!this.frameState_}animationDelay_(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}renderSync(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()}redrawText(){const t=this.getLayerGroup().getLayerStatesArray();for(let e=0,i=t.length;e<i;++e){const i=t[e].layer;i.hasRenderer()&&i.getRenderer().handleFontsChanged()}}render(){this.renderer_&&void 0===this.animationDelayKey_&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))}flushDeclutterItems(){const t=this.frameState_;t&&this.renderer_.flushDeclutterItems(t)}removeControl(t){return this.getControls().remove(t)}removeInteraction(t){return this.getInteractions().remove(t)}removeLayer(t){return this.getLayerGroup().getLayers().remove(t)}handleLayerRemove_(t){rn(t.layer)}removeOverlay(t){return this.getOverlays().remove(t)}renderFrame_(t){const e=this.getSize(),i=this.getView(),r=this.frameState_;let n=null;if(void 0!==e&&tn(e)&&i&&i.isDef()){const r=i.getHints(this.frameState_?this.frameState_.viewHints:void 0),s=i.getState();if(n={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutterTree:null,extent:gt(s.center,s.resolution,s.rotation,e),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:e,tileQueue:this.tileQueue_,time:t,usedTiles:{},viewState:s,viewHints:r,wantedTiles:{},mapId:T(this),renderTargets:{}},s.nextCenter&&s.nextResolution){const t=isNaN(s.nextRotation)?s.rotation:s.nextRotation;n.nextExtent=gt(s.nextCenter,s.nextResolution,t,e)}}var s,o;this.frameState_=n,this.renderer_.renderFrame(n),n&&(n.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,n.postRenderFunctions),r&&(!this.previousExtent_||!xt(this.previousExtent_)&&!nt(n.extent,this.previousExtent_))&&(this.dispatchEvent(new nr("movestart",this,r)),this.previousExtent_=rt(this.previousExtent_)),this.previousExtent_&&!n.viewHints[0]&&!n.viewHints[1]&&!nt(n.extent,this.previousExtent_)&&(this.dispatchEvent(new nr("moveend",this,n)),s=n.extent,(o=this.previousExtent_)?(o[0]=s[0],o[1]=s[1],o[2]=s[2],o[3]=s[3]):s.slice())),this.dispatchEvent(new nr(lr,this,n)),this.renderComplete_=this.hasListener(ur)||this.hasListener(cr)||this.hasListener(ne)?!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoadingOrNotReady():void 0,this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout((()=>{this.postRenderTimeoutHandle_=void 0,this.handlePostRender()}),0))}setLayerGroup(t){const e=this.getLayerGroup();e&&this.handleLayerRemove_(new tr("removelayer",e)),this.set(dr,t)}setSize(t){this.set(fr,t)}setTarget(t){this.set(gr,t)}setView(t){if(!t||t instanceof Ni)return void this.set(mr,t);this.set(mr,new Ni);const e=this;t.then((function(t){e.setView(new Ni(t))}))}updateSize(){const t=this.getTargetElement();let e;if(t){const i=getComputedStyle(t),r=t.offsetWidth-parseFloat(i.borderLeftWidth)-parseFloat(i.paddingLeft)-parseFloat(i.paddingRight)-parseFloat(i.borderRightWidth),n=t.offsetHeight-parseFloat(i.borderTopWidth)-parseFloat(i.paddingTop)-parseFloat(i.paddingBottom)-parseFloat(i.borderBottomWidth);isNaN(r)||isNaN(n)||(e=[r,n],!tn(e)&&(t.offsetWidth||t.offsetHeight||t.getClientRects().length)&&Re("No map visible because the map container's width or height are 0."))}const i=this.getSize();!e||i&&l(e,i)||(this.setSize(e),this.updateViewportSize_(e))}updateViewportSize_(t){const e=this.getView();e&&e.setViewportSize(t)}},on=class extends g{constructor(t,e,i){super(),i=i||{},this.tileCoord=t,this.state=e,this.interimTile=null,this.key="",this.transition_=void 0===i.transition?250:i.transition,this.transitionStarts_={},this.interpolate=!!i.interpolate}changed(){this.dispatchEvent(m)}release(){3===this.state&&this.setState(4)}getKey(){return this.key+"/"+this.tileCoord}getInterimTile(){let t=this.interimTile;if(!t)return this;do{if(2==t.getState())return this.transition_=0,t;t=t.interimTile}while(t);return this}refreshInterimChain(){let t=this.interimTile;if(!t)return;let e=this;do{if(2==t.getState()){t.interimTile=null;break}1==t.getState()?e=t:0==t.getState()?e.interimTile=t.interimTile:e=t,t=e.interimTile}while(t)}getTileCoord(){return this.tileCoord}getState(){return this.state}setState(t){if(3!==this.state&&this.state>t)throw new Error("Tile load sequence violation");this.state=t,this.changed()}load(){S()}getAlpha(t,e){if(!this.transition_)return 1;let i=this.transitionStarts_[t];if(i){if(-1===i)return 1}else i=e,this.transitionStarts_[t]=i;const r=e-i+1e3/60;return r>=this.transition_?1:ni(r/this.transition_)}inTransition(t){return!!this.transition_&&-1!==this.transitionStarts_[t]}endTransition(t){this.transition_&&(this.transitionStarts_[t]=-1)}},an=class extends on{constructor(t,e,i,r,n,s){super(t,e,s),this.crossOrigin_=r,this.src_=i,this.key=i,this.image_=new Image,null!==r&&(this.image_.crossOrigin=r),this.unlisten_=null,this.tileLoadFunction_=n}getImage(){return this.image_}setImage(t){this.image_=t,this.state=2,this.unlistenImage_(),this.changed()}handleImageError_(){this.state=3,this.unlistenImage_(),this.image_=function(){const t=Ki(1,1);return t.fillStyle="rgba(0,0,0,0)",t.fillRect(0,0,1,1),t.canvas}(),this.changed()}handleImageLoad_(){const t=this.image_;t.naturalWidth&&t.naturalHeight?this.state=2:this.state=4,this.unlistenImage_(),this.changed()}load(){3==this.state&&(this.state=0,this.image_=new Image,null!==this.crossOrigin_&&(this.image_.crossOrigin=this.crossOrigin_)),0==this.state&&(this.state=1,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=function(t,e,i){const r=t;let n=!0,s=!1,o=!1;const a=[M(r,"load",(function(){o=!0,s||e()}))];return r.src&&X?(s=!0,r.decode().then((function(){n&&e()})).catch((function(t){n&&(o?e():i())}))):a.push(M(r,"error",i)),function(){n=!1,a.forEach(k)}}(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}},hn=class{constructor(t,e,i,r,n,s){this.sourceProj_=t,this.targetProj_=e;let o={};const a=Ve(this.targetProj_,this.sourceProj_);this.transformInv_=function(t){const e=t[0]+"/"+t[1];return o[e]||(o[e]=a(t)),o[e]},this.maxSourceExtent_=r,this.errorThresholdSquared_=n*n,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!r&&!!this.sourceProj_.getExtent()&&yt(r)>=yt(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?yt(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?yt(this.targetProj_.getExtent()):null;const h=_t(i),l=bt(i),u=ct(i),c=ut(i),d=this.transformInv_(h),f=this.transformInv_(l),g=this.transformInv_(u),m=this.transformInv_(c),p=10+(s?Math.max(0,Math.ceil(Math.log2(lt(i)/(s*s*256*256)))):0);if(this.addQuad_(h,l,u,c,d,f,g,m,p),this.wrapsXInSource_){let t=1/0;this.triangles_.forEach((function(e,i,r){t=Math.min(t,e.source[0][0],e.source[1][0],e.source[2][0])})),this.triangles_.forEach((e=>{if(Math.max(e.source[0][0],e.source[1][0],e.source[2][0])-t>this.sourceWorldWidth_/2){const i=[[e.source[0][0],e.source[0][1]],[e.source[1][0],e.source[1][1]],[e.source[2][0],e.source[2][1]]];i[0][0]-t>this.sourceWorldWidth_/2&&(i[0][0]-=this.sourceWorldWidth_),i[1][0]-t>this.sourceWorldWidth_/2&&(i[1][0]-=this.sourceWorldWidth_),i[2][0]-t>this.sourceWorldWidth_/2&&(i[2][0]-=this.sourceWorldWidth_);const r=Math.min(i[0][0],i[1][0],i[2][0]);Math.max(i[0][0],i[1][0],i[2][0])-r<this.sourceWorldWidth_/2&&(e.source=i)}}))}o={}}addTriangle_(t,e,i,r,n,s){this.triangles_.push({source:[r,n,s],target:[t,e,i]})}addQuad_(t,e,i,r,n,s,o,a,h){const l=$([n,s,o,a]),u=this.sourceWorldWidth_?yt(l)/this.sourceWorldWidth_:null,c=this.sourceWorldWidth_,d=this.sourceProj_.canWrapX()&&u>.5&&u<1;let f=!1;if(h>0&&(this.targetProj_.isGlobal()&&this.targetWorldWidth_&&(f=yt($([t,e,i,r]))/this.targetWorldWidth_>.25||f),!d&&this.sourceProj_.isGlobal()&&u&&(f=u>.25||f)),!f&&this.maxSourceExtent_&&isFinite(l[0])&&isFinite(l[1])&&isFinite(l[2])&&isFinite(l[3])&&!vt(l,this.maxSourceExtent_))return;let g=0;if(!(f||isFinite(n[0])&&isFinite(n[1])&&isFinite(s[0])&&isFinite(s[1])&&isFinite(o[0])&&isFinite(o[1])&&isFinite(a[0])&&isFinite(a[1])))if(h>0)f=!0;else if(g=(isFinite(n[0])&&isFinite(n[1])?0:8)+(isFinite(s[0])&&isFinite(s[1])?0:4)+(isFinite(o[0])&&isFinite(o[1])?0:2)+(isFinite(a[0])&&isFinite(a[1])?0:1),1!=g&&2!=g&&4!=g&&8!=g)return;if(h>0){if(!f){const e=[(t[0]+i[0])/2,(t[1]+i[1])/2],r=this.transformInv_(e);let s;s=d?(zt(n[0],c)+zt(o[0],c))/2-zt(r[0],c):(n[0]+o[0])/2-r[0];const a=(n[1]+o[1])/2-r[1];f=s*s+a*a>this.errorThresholdSquared_}if(f){if(Math.abs(t[0]-i[0])<=Math.abs(t[1]-i[1])){const l=[(e[0]+i[0])/2,(e[1]+i[1])/2],u=this.transformInv_(l),c=[(r[0]+t[0])/2,(r[1]+t[1])/2],d=this.transformInv_(c);this.addQuad_(t,e,l,c,n,s,u,d,h-1),this.addQuad_(c,l,i,r,d,u,o,a,h-1)}else{const l=[(t[0]+e[0])/2,(t[1]+e[1])/2],u=this.transformInv_(l),c=[(i[0]+r[0])/2,(i[1]+r[1])/2],d=this.transformInv_(c);this.addQuad_(t,l,c,r,n,u,d,a,h-1),this.addQuad_(l,e,i,c,u,s,o,d,h-1)}return}}if(d){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}0==(11&g)&&this.addTriangle_(t,i,r,n,o,a),0==(14&g)&&this.addTriangle_(t,i,e,n,o,s),g&&(0==(13&g)&&this.addTriangle_(e,r,t,s,a,n),0==(7&g)&&this.addTriangle_(e,r,i,s,a,o))}calculateSourceExtent(){const t=[1/0,1/0,-1/0,-1/0];return this.triangles_.forEach((function(e,i,r){const n=e.source;st(t,n[0]),st(t,n[1]),st(t,n[2])})),t}getTriangles(){return this.triangles_}};let ln;const un=[];function cn(t,e,i,r,n){t.beginPath(),t.moveTo(0,0),t.lineTo(e,i),t.lineTo(r,n),t.closePath(),t.save(),t.clip(),t.fillRect(0,0,Math.max(e,r)+1,Math.max(i,n)),t.restore()}function dn(t,e){return Math.abs(t[4*e]-210)>2||Math.abs(t[4*e+3]-191.25)>2}function fn(t,e,i,r){const n=Ye(i,e,t);let s=ze(e,r,i);const o=e.getMetersPerUnit();void 0!==o&&(s*=o);const a=t.getMetersPerUnit();void 0!==a&&(s/=a);const h=t.getExtent();if(!h||J(h,n)){const e=ze(t,s,n)/s;isFinite(e)&&e>0&&(s/=e)}return s}const gn=class extends on{constructor(t,e,i,r,n,s,o,a,h,l,u,c){super(n,0,c),this.renderEdges_=void 0!==u&&u,this.pixelRatio_=o,this.gutter_=a,this.canvas_=null,this.sourceTileGrid_=e,this.targetTileGrid_=r,this.wrappedTileCoord_=s||n,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0;const d=r.getTileCoordExtent(this.wrappedTileCoord_),f=this.targetTileGrid_.getExtent();let g=this.sourceTileGrid_.getExtent();const m=f?wt(d,f):d;if(0===lt(m))return void(this.state=4);const p=t.getExtent();p&&(g=g?wt(g,p):p);const w=r.getResolution(this.wrappedTileCoord_[0]),_=function(t,e,i,r){const n=dt(i);let s=fn(t,e,n,r);return(!isFinite(s)||s<=0)&&ht(i,(function(i){return s=fn(t,e,i,r),isFinite(s)&&s>0})),s}(t,i,m,w);if(!isFinite(_)||_<=0)return void(this.state=4);const b=void 0!==l?l:.5;if(this.triangulation_=new hn(t,i,m,g,_*b,w),0===this.triangulation_.getTriangles().length)return void(this.state=4);this.sourceZ_=e.getZForResolution(_);let y=this.triangulation_.calculateSourceExtent();if(g&&(t.canWrapX()?(y[1]=It(y[1],g[1],g[3]),y[3]=It(y[3],g[1],g[3])):y=wt(y,g)),lt(y)){const t=e.getTileRangeForExtentAndZ(y,this.sourceZ_);for(let e=t.minX;e<=t.maxX;e++)for(let i=t.minY;i<=t.maxY;i++){const t=h(this.sourceZ_,e,i,o);t&&this.sourceTiles_.push(t)}0===this.sourceTiles_.length&&(this.state=4)}else this.state=4}getImage(){return this.canvas_}reproject_(){const t=[];if(this.sourceTiles_.forEach((e=>{e&&2==e.getState()&&t.push({extent:this.sourceTileGrid_.getTileCoordExtent(e.tileCoord),image:e.getImage()})})),this.sourceTiles_.length=0,0===t.length)this.state=3;else{const e=this.wrappedTileCoord_[0],i=this.targetTileGrid_.getTileSize(e),r="number"==typeof i?i:i[0],n="number"==typeof i?i:i[1],s=this.targetTileGrid_.getResolution(e),o=this.sourceTileGrid_.getResolution(this.sourceZ_),a=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=function(t,e,i,r,n,s,o,a,h,l,u,c,d){const f=Ki(Math.round(i*t),Math.round(i*e),un);if(c||(f.imageSmoothingEnabled=!1),0===h.length)return f.canvas;function g(t){return Math.round(t*i)/i}f.scale(i,i),f.globalCompositeOperation="lighter";const m=[1/0,1/0,-1/0,-1/0];let p;if(h.forEach((function(t,e,i){var r,n;r=m,(n=t.extent)[0]<r[0]&&(r[0]=n[0]),n[2]>r[2]&&(r[2]=n[2]),n[1]<r[1]&&(r[1]=n[1]),n[3]>r[3]&&(r[3]=n[3])})),!d||1!==h.length||0!==l){const t=yt(m),e=pt(m);p=Ki(Math.round(i*t/r),Math.round(i*e/r),un),c||(p.imageSmoothingEnabled=!1);const n=i/r;h.forEach((function(t,e,i){const r=t.extent[0]-m[0],s=-(t.extent[3]-m[3]),o=yt(t.extent),a=pt(t.extent);t.image.width>0&&t.image.height>0&&p.drawImage(t.image,l,l,t.image.width-2*l,t.image.height-2*l,r*n,s*n,o*n,a*n)}))}const w=_t(o);return a.getTriangles().forEach((function(t,e,n){const o=t.source,a=t.target;let l=o[0][0],u=o[0][1],d=o[1][0],_=o[1][1],b=o[2][0],y=o[2][1];const v=g((a[0][0]-w[0])/s),x=g(-(a[0][1]-w[1])/s),M=g((a[1][0]-w[0])/s),k=g(-(a[1][1]-w[1])/s),E=g((a[2][0]-w[0])/s),C=g(-(a[2][1]-w[1])/s),S=l,A=u;l=0,u=0,d-=S,_-=A,b-=S,y-=A;const T=function(t){const e=t.length;for(let i=0;i<e;i++){let r=i,n=Math.abs(t[i][i]);for(let s=i+1;s<e;s++){const e=Math.abs(t[s][i]);e>n&&(n=e,r=s)}if(0===n)return null;const s=t[r];t[r]=t[i],t[i]=s;for(let r=i+1;r<e;r++){const n=-t[r][i]/t[i][i];for(let s=i;s<e+1;s++)i==s?t[r][s]=0:t[r][s]+=n*t[i][s]}}const i=new Array(e);for(let r=e-1;r>=0;r--){i[r]=t[r][e]/t[r][r];for(let n=r-1;n>=0;n--)t[n][e]-=t[n][r]*i[r]}return i}([[d,_,0,0,M-v],[b,y,0,0,E-v],[0,0,d,_,k-x],[0,0,b,y,C-x]]);if(!T)return;if(f.save(),f.beginPath(),function(){if(void 0===ln){const t=Ki(6,6,un);t.globalCompositeOperation="lighter",t.fillStyle="rgba(210, 0, 0, 0.75)",cn(t,4,5,4,0),cn(t,4,5,0,5);const e=t.getImageData(0,0,3,3).data;ln=dn(e,0)||dn(e,4)||dn(e,8),Hi(t),un.push(t.canvas)}return ln}()||!c){f.moveTo(M,k);const t=4,e=v-M,i=x-k;for(let r=0;r<t;r++)f.lineTo(M+g((r+1)*e/t),k+g(r*i/(t-1))),r!=t-1&&f.lineTo(M+g((r+1)*e/t),k+g((r+1)*i/(t-1)));f.lineTo(E,C)}else f.moveTo(M,k),f.lineTo(v,x),f.lineTo(E,C);let R;if(f.clip(),f.transform(T[0],T[2],T[1],T[3],v,x),f.translate(m[0]-S,m[3]-A),p)R=p.canvas,f.scale(r/i,-r/i);else{const t=h[0],e=t.extent;R=t.image,f.scale(yt(e)/R.width,-pt(e)/R.height)}f.drawImage(R,0,0),f.restore()})),p&&(Hi(p),un.push(p.canvas)),u&&(f.save(),f.globalCompositeOperation="source-over",f.strokeStyle="black",f.lineWidth=1,a.getTriangles().forEach((function(t,e,i){const r=t.target,n=(r[0][0]-w[0])/s,o=-(r[0][1]-w[1])/s,a=(r[1][0]-w[0])/s,h=-(r[1][1]-w[1])/s,l=(r[2][0]-w[0])/s,u=-(r[2][1]-w[1])/s;f.beginPath(),f.moveTo(a,h),f.lineTo(n,o),f.lineTo(l,u),f.closePath(),f.stroke()})),f.restore()),f.canvas}(r,n,this.pixelRatio_,o,this.sourceTileGrid_.getExtent(),s,a,this.triangulation_,t,this.gutter_,this.renderEdges_,this.interpolate),this.state=2}this.changed()}load(){if(0==this.state){this.state=1,this.changed();let t=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach((e=>{const i=e.getState();if(0==i||1==i){t++;const i=x(e,m,(function(r){const n=e.getState();2!=n&&3!=n&&4!=n||(k(i),t--,0===t&&(this.unlistenSources_(),this.reproject_()))}),this);this.sourcesListenerKeys_.push(i)}})),0===t?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach((function(t,e,i){0==t.getState()&&t.load()}))}}unlistenSources_(){this.sourcesListenerKeys_.forEach(k),this.sourcesListenerKeys_=null}release(){this.canvas_&&(Hi(this.canvas_.getContext("2d")),un.push(this.canvas_),this.canvas_=null),super.release()}},mn=class{constructor(t){this.highWaterMark=void 0!==t?t:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}canExpireCache(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark}expireCache(t){for(;this.canExpireCache();)this.pop()}clear(){this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}containsKey(t){return this.entries_.hasOwnProperty(t)}forEach(t){let e=this.oldest_;for(;e;)t(e.value_,e.key_,this),e=e.newer}get(t,e){const i=this.entries_[t];return G(void 0!==i,"Tried to get a value for a key that does not exist in the cache"),i===this.newest_||(i===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(i.newer.older=i.older,i.older.newer=i.newer),i.newer=null,i.older=this.newest_,this.newest_.newer=i,this.newest_=i),i.value_}remove(t){const e=this.entries_[t];return G(void 0!==e,"Tried to get a value for a key that does not exist in the cache"),e===this.newest_?(this.newest_=e.older,this.newest_&&(this.newest_.newer=null)):e===this.oldest_?(this.oldest_=e.newer,this.oldest_&&(this.oldest_.older=null)):(e.newer.older=e.older,e.older.newer=e.newer),delete this.entries_[t],--this.count_,e.value_}getCount(){return this.count_}getKeys(){const t=new Array(this.count_);let e,i=0;for(e=this.newest_;e;e=e.older)t[i++]=e.key_;return t}getValues(){const t=new Array(this.count_);let e,i=0;for(e=this.newest_;e;e=e.older)t[i++]=e.value_;return t}peekLast(){return this.oldest_.value_}peekLastKey(){return this.oldest_.key_}peekFirstKey(){return this.newest_.key_}peek(t){return this.entries_[t]?.value_}pop(){const t=this.oldest_;return delete this.entries_[t.key_],t.newer&&(t.newer.older=null),this.oldest_=t.newer,this.oldest_||(this.newest_=null),--this.count_,t.value_}replace(t,e){this.get(t),this.entries_[t].value_=e}set(t,e){G(!(t in this.entries_),"Tried to set a value for a key that is used already");const i={key_:t,newer:null,older:this.newest_,value_:e};this.newest_?this.newest_.newer=i:this.oldest_=i,this.newest_=i,this.entries_[t]=i,++this.count_}setSize(t){this.highWaterMark=t}};function pn(t,e,i,r){return void 0!==r?(r[0]=t,r[1]=e,r[2]=i,r):[t,e,i]}function wn(t,e,i){return t+"/"+e+"/"+i}function _n(t){return wn(t[0],t[1],t[2])}const bn=class extends mn{clear(){for(;this.getCount()>0;)this.pop().release();super.clear()}expireCache(t){for(;this.canExpireCache()&&!(this.peekLast().getKey()in t);)this.pop().release()}pruneExceptNewestZ(){if(0===this.getCount())return;const t=this.peekFirstKey().split("/").map(Number)[0];this.forEach((e=>{e.tileCoord[0]!==t&&(this.remove(_n(e.tileCoord)),e.release())}))}};function yn(t){return t?Array.isArray(t)?function(e){return t}:"function"==typeof t?t:function(e){return[t]}:null}const vn=class extends P{constructor(t){super(),this.projection=Fe(t.projection),this.attributions_=yn(t.attributions),this.attributionsCollapsible_=void 0===t.attributionsCollapsible||t.attributionsCollapsible,this.loading=!1,this.state_=void 0!==t.state?t.state:"ready",this.wrapX_=void 0!==t.wrapX&&t.wrapX,this.interpolate_=!!t.interpolate,this.viewResolver=null,this.viewRejector=null;const e=this;this.viewPromise_=new Promise((function(t,i){e.viewResolver=t,e.viewRejector=i}))}getAttributions(){return this.attributions_}getAttributionsCollapsible(){return this.attributionsCollapsible_}getProjection(){return this.projection}getResolutions(t){return null}getView(){return this.viewPromise_}getState(){return this.state_}getWrapX(){return this.wrapX_}getInterpolate(){return this.interpolate_}refresh(){this.changed()}setAttributions(t){this.attributions_=yn(t),this.changed()}setState(t){this.state_=t,this.changed()}};class xn{constructor(t,e,i,r){this.minX=t,this.maxX=e,this.minY=i,this.maxY=r}contains(t){return this.containsXY(t[1],t[2])}containsTileRange(t){return this.minX<=t.minX&&t.maxX<=this.maxX&&this.minY<=t.minY&&t.maxY<=this.maxY}containsXY(t,e){return this.minX<=t&&t<=this.maxX&&this.minY<=e&&e<=this.maxY}equals(t){return this.minX==t.minX&&this.minY==t.minY&&this.maxX==t.maxX&&this.maxY==t.maxY}extend(t){t.minX<this.minX&&(this.minX=t.minX),t.maxX>this.maxX&&(this.maxX=t.maxX),t.minY<this.minY&&(this.minY=t.minY),t.maxY>this.maxY&&(this.maxY=t.maxY)}getHeight(){return this.maxY-this.minY+1}getSize(){return[this.getWidth(),this.getHeight()]}getWidth(){return this.maxX-this.minX+1}intersects(t){return this.minX<=t.maxX&&this.maxX>=t.minX&&this.minY<=t.maxY&&this.maxY>=t.minY}}function Mn(t,e,i,r,n){return void 0!==n?(n.minX=t,n.maxX=e,n.minY=i,n.maxY=r,n):new xn(t,e,i,r)}const kn=xn,En=[0,0,0],Cn=class{constructor(t){let e;if(this.minZoom=void 0!==t.minZoom?t.minZoom:0,this.resolutions_=t.resolutions,G(function(t,e,i){const r=((t,e)=>e-t)||a;return t.every((function(e,i){if(0===i)return!0;const n=r(t[i-1],e);return!(n>0||0===n)}))}(this.resolutions_),"`resolutions` must be sorted in descending order"),!t.origins)for(let t=0,i=this.resolutions_.length-1;t<i;++t)if(e){if(this.resolutions_[t]/this.resolutions_[t+1]!==e){e=void 0;break}}else e=this.resolutions_[t]/this.resolutions_[t+1];this.zoomFactor_=e,this.maxZoom=this.resolutions_.length-1,this.origin_=void 0!==t.origin?t.origin:null,this.origins_=null,void 0!==t.origins&&(this.origins_=t.origins,G(this.origins_.length==this.resolutions_.length,"Number of `origins` and `resolutions` must be equal"));const i=t.extent;void 0===i||this.origin_||this.origins_||(this.origin_=_t(i)),G(!this.origin_&&this.origins_||this.origin_&&!this.origins_,"Either `origin` or `origins` must be configured, never both"),this.tileSizes_=null,void 0!==t.tileSizes&&(this.tileSizes_=t.tileSizes,G(this.tileSizes_.length==this.resolutions_.length,"Number of `tileSizes` and `resolutions` must be equal")),this.tileSize_=void 0!==t.tileSize?t.tileSize:this.tileSizes_?null:ae,G(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,"Either `tileSize` or `tileSizes` must be configured, never both"),this.extent_=void 0!==i?i:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],void 0!==t.sizes?this.fullTileRanges_=t.sizes.map(((t,e)=>{const r=new kn(Math.min(0,t[0]),Math.max(t[0]-1,-1),Math.min(0,t[1]),Math.max(t[1]-1,-1));if(i){const t=this.getTileRangeForExtentAndZ(i,e);r.minX=Math.max(t.minX,r.minX),r.maxX=Math.min(t.maxX,r.maxX),r.minY=Math.max(t.minY,r.minY),r.maxY=Math.min(t.maxY,r.maxY)}return r})):i&&this.calculateTileRanges_(i)}forEachTileCoord(t,e,i){const r=this.getTileRangeForExtentAndZ(t,e);for(let t=r.minX,n=r.maxX;t<=n;++t)for(let n=r.minY,s=r.maxY;n<=s;++n)i([e,t,n])}forEachTileCoordParentTileRange(t,e,i,r){let n,s,o,a=null,h=t[0]-1;for(2===this.zoomFactor_?(s=t[1],o=t[2]):a=this.getTileCoordExtent(t,r);h>=this.minZoom;){if(void 0!==s&&void 0!==o?(s=Math.floor(s/2),o=Math.floor(o/2),n=Mn(s,s,o,o,i)):n=this.getTileRangeForExtentAndZ(a,h,i),e(h,n))return!0;--h}return!1}getExtent(){return this.extent_}getMaxZoom(){return this.maxZoom}getMinZoom(){return this.minZoom}getOrigin(t){return this.origin_?this.origin_:this.origins_[t]}getResolution(t){return this.resolutions_[t]}getResolutions(){return this.resolutions_}getTileCoordChildTileRange(t,e,i){if(t[0]<this.maxZoom){if(2===this.zoomFactor_){const i=2*t[1],r=2*t[2];return Mn(i,i+1,r,r+1,e)}const r=this.getTileCoordExtent(t,i||this.tmpExtent_);return this.getTileRangeForExtentAndZ(r,t[0]+1,e)}return null}getTileRangeForTileCoordAndZ(t,e,i){if(e>this.maxZoom||e<this.minZoom)return null;const r=t[0],n=t[1],s=t[2];if(e===r)return Mn(n,s,n,s,i);if(this.zoomFactor_){const t=Math.pow(this.zoomFactor_,e-r),o=Math.floor(n*t),a=Math.floor(s*t);return e<r?Mn(o,o,a,a,i):Mn(o,Math.floor(t*(n+1))-1,a,Math.floor(t*(s+1))-1,i)}const o=this.getTileCoordExtent(t,this.tmpExtent_);return this.getTileRangeForExtentAndZ(o,e,i)}getTileRangeForExtentAndZ(t,e,i){this.getTileCoordForXYAndZ_(t[0],t[3],e,!1,En);const r=En[1],n=En[2];return this.getTileCoordForXYAndZ_(t[2],t[1],e,!0,En),Mn(r,En[1],n,En[2],i)}getTileCoordCenter(t){const e=this.getOrigin(t[0]),i=this.getResolution(t[0]),r=en(this.getTileSize(t[0]),this.tmpSize_);return[e[0]+(t[1]+.5)*r[0]*i,e[1]-(t[2]+.5)*r[1]*i]}getTileCoordExtent(t,e){const i=this.getOrigin(t[0]),r=this.getResolution(t[0]),n=en(this.getTileSize(t[0]),this.tmpSize_),s=i[0]+t[1]*n[0]*r,o=i[1]-(t[2]+1)*n[1]*r;return it(s,o,s+n[0]*r,o+n[1]*r,e)}getTileCoordForCoordAndResolution(t,e,i){return this.getTileCoordForXYAndResolution_(t[0],t[1],e,!1,i)}getTileCoordForXYAndResolution_(t,e,i,r,n){const s=this.getZForResolution(i),o=i/this.getResolution(s),a=this.getOrigin(s),h=en(this.getTileSize(s),this.tmpSize_);let l=o*(t-a[0])/i/h[0],u=o*(a[1]-e)/i/h[1];return r?(l=Ut(l,5)-1,u=Ut(u,5)-1):(l=Ot(l,5),u=Ot(u,5)),pn(s,l,u,n)}getTileCoordForXYAndZ_(t,e,i,r,n){const s=this.getOrigin(i),o=this.getResolution(i),a=en(this.getTileSize(i),this.tmpSize_);let h=(t-s[0])/o/a[0],l=(s[1]-e)/o/a[1];return r?(h=Ut(h,5)-1,l=Ut(l,5)-1):(h=Ot(h,5),l=Ot(l,5)),pn(i,h,l,n)}getTileCoordForCoordAndZ(t,e,i){return this.getTileCoordForXYAndZ_(t[0],t[1],e,!1,i)}getTileCoordResolution(t){return this.resolutions_[t[0]]}getTileSize(t){return this.tileSize_?this.tileSize_:this.tileSizes_[t]}getFullTileRange(t){return this.fullTileRanges_?this.fullTileRanges_[t]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,t):null}getZForResolution(t,e){return It(h(this.resolutions_,t,e||0),this.minZoom,this.maxZoom)}tileCoordIntersectsViewport(t,e){return Ai(e,0,e.length,2,this.getTileCoordExtent(t))}calculateTileRanges_(t){const e=this.resolutions_.length,i=new Array(e);for(let r=this.minZoom;r<e;++r)i[r]=this.getTileRangeForExtentAndZ(t,r);this.fullTileRanges_=i}};function Sn(t){let e=t.getDefaultTileGrid();return e||(e=function(t,e,i,r){return function(t,e,i,r){r=void 0!==r?r:"top-left";const n=Tn(t,undefined,i);return new Cn({extent:t,origin:ft(t,r),resolutions:n,tileSize:i})}(Rn(t),0,void 0,void 0)}(t),t.setDefaultTileGrid(e)),e}function An(t){const e=t||{},i=e.extent||Fe("EPSG:3857").getExtent(),r={extent:i,minZoom:e.minZoom,tileSize:e.tileSize,resolutions:Tn(i,e.maxZoom,e.tileSize,e.maxResolution)};return new Cn(r)}function Tn(t,e,i,r){e=void 0!==e?e:oe,i=en(void 0!==i?i:ae);const n=pt(t),s=yt(t);r=r>0?r:Math.max(s/i[0],n/i[1]);const o=e+1,a=new Array(o);for(let t=0;t<o;++t)a[t]=r/Math.pow(2,t);return a}function Rn(t){let e=(t=Fe(t)).getExtent();if(!e){const i=180*he.degrees/t.getMetersPerUnit();e=it(-i,-i,i,i)}return e}class Pn extends n{constructor(t,e){super(t),this.tile=e}}const In=class extends vn{constructor(t){super({attributions:t.attributions,attributionsCollapsible:t.attributionsCollapsible,projection:t.projection,state:t.state,wrapX:t.wrapX,interpolate:t.interpolate}),this.on,this.once,this.un,this.opaque_=void 0!==t.opaque&&t.opaque,this.tilePixelRatio_=void 0!==t.tilePixelRatio?t.tilePixelRatio:1,this.tileGrid=void 0!==t.tileGrid?t.tileGrid:null;this.tileGrid&&en(this.tileGrid.getTileSize(this.tileGrid.getMinZoom()),[256,256]),this.tileCache=new bn(t.cacheSize||0),this.tmpSize=[0,0],this.key_=t.key||"",this.tileOptions={transition:t.transition,interpolate:t.interpolate},this.zDirection=t.zDirection?t.zDirection:0}canExpireCache(){return this.tileCache.canExpireCache()}expireCache(t,e){const i=this.getTileCacheForProjection(t);i&&i.expireCache(e)}forEachLoadedTile(t,e,i,r){const n=this.getTileCacheForProjection(t);if(!n)return!1;let s,o,a,h=!0;for(let t=i.minX;t<=i.maxX;++t)for(let l=i.minY;l<=i.maxY;++l)o=wn(e,t,l),a=!1,n.containsKey(o)&&(s=n.get(o),a=2===s.getState(),a&&(a=!1!==r(s))),a||(h=!1);return h}getGutterForProjection(t){return 0}getKey(){return this.key_}setKey(t){this.key_!==t&&(this.key_=t,this.changed())}getOpaque(t){return this.opaque_}getResolutions(t){const e=t?this.getTileGridForProjection(t):this.tileGrid;return e?e.getResolutions():null}getTile(t,e,i,r,n){return S()}getTileGrid(){return this.tileGrid}getTileGridForProjection(t){return this.tileGrid?this.tileGrid:Sn(t)}getTileCacheForProjection(t){const e=this.getProjection();return G(null===e||Oe(e,t),"A VectorTile source can only be rendered if it has a projection compatible with the view projection."),this.tileCache}getTilePixelRatio(t){return this.tilePixelRatio_}getTilePixelSize(t,e,i){const r=this.getTileGridForProjection(i),n=this.getTilePixelRatio(e),s=en(r.getTileSize(t),this.tmpSize);return 1==n?s:(o=s,a=n,void 0===(h=this.tmpSize)&&(h=[0,0]),h[0]=o[0]*a+.5|0,h[1]=o[1]*a+.5|0,h);var o,a,h}getTileCoordForTileUrlFunction(t,e){e=void 0!==e?e:this.getProjection();const i=this.getTileGridForProjection(e);return this.getWrapX()&&e.isGlobal()&&(t=function(t,e,i){const r=e[0],n=t.getTileCoordCenter(e),s=Rn(i);if(!J(s,n)){const e=yt(s),i=Math.ceil((s[0]-n[0])/e);return n[0]+=e*i,t.getTileCoordForCoordAndZ(n,r)}return e}(i,t,e)),function(t,e){const i=t[0],r=t[1],n=t[2];if(e.getMinZoom()>i||i>e.getMaxZoom())return!1;const s=e.getFullTileRange(i);return!s||s.containsXY(r,n)}(t,i)?t:null}clear(){this.tileCache.clear()}refresh(){this.clear(),super.refresh()}updateCacheSize(t,e){const i=this.getTileCacheForProjection(e);t>i.highWaterMark&&(i.highWaterMark=t)}useTile(t,e,i,r){}};function Dn(t,e){const i=/\{z\}/g,r=/\{x\}/g,n=/\{y\}/g,s=/\{-y\}/g;return function(o,a,h){if(o)return t.replace(i,o[0].toString()).replace(r,o[1].toString()).replace(n,o[2].toString()).replace(s,(function(){const t=o[0],i=e.getFullTileRange(t);if(!i)throw new Error("The {-y} placeholder requires a tile grid with extent");return(i.getHeight()-o[2]-1).toString()}))}}function Ln(t){return 1===t.length?t[0]:function(e,i,r){if(!e)return;const n=function(t){return(t[1]<<t[0])+t[2]}(e),s=zt(n,t.length);return t[s](e,i,r)}}class Fn extends In{constructor(t){super({attributions:t.attributions,cacheSize:t.cacheSize,opaque:t.opaque,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tilePixelRatio:t.tilePixelRatio,wrapX:t.wrapX,transition:t.transition,interpolate:t.interpolate,key:t.key,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection}),this.generateTileUrlFunction_=this.tileUrlFunction===Fn.prototype.tileUrlFunction,this.tileLoadFunction=t.tileLoadFunction,t.tileUrlFunction&&(this.tileUrlFunction=t.tileUrlFunction),this.urls=null,t.urls?this.setUrls(t.urls):t.url&&this.setUrl(t.url),this.tileLoadingKeys_={}}getTileLoadFunction(){return this.tileLoadFunction}getTileUrlFunction(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction}getUrls(){return this.urls}handleTileChange(t){const e=t.target,i=T(e),r=e.getState();let n;1==r?(this.tileLoadingKeys_[i]=!0,n="tileloadstart"):i in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[i],n=3==r?"tileloaderror":2==r?"tileloadend":void 0),null!=n&&this.dispatchEvent(new Pn(n,e))}setTileLoadFunction(t){this.tileCache.clear(),this.tileLoadFunction=t,this.changed()}setTileUrlFunction(t,e){this.tileUrlFunction=t,this.tileCache.pruneExceptNewestZ(),void 0!==e?this.setKey(e):this.changed()}setUrl(t){const e=function(t){const e=[];let i=/\{([a-z])-([a-z])\}/.exec(t);if(i){const r=i[1].charCodeAt(0),n=i[2].charCodeAt(0);let s;for(s=r;s<=n;++s)e.push(t.replace(i[0],String.fromCharCode(s)));return e}if(i=/\{(\d+)-(\d+)\}/.exec(t),i){const r=parseInt(i[2],10);for(let n=parseInt(i[1],10);n<=r;n++)e.push(t.replace(i[0],n.toString()));return e}return e.push(t),e}(t);this.urls=e,this.setUrls(e)}setUrls(t){this.urls=t;const e=t.join("\n");this.generateTileUrlFunction_?this.setTileUrlFunction(function(t,e){const i=t.length,r=new Array(i);for(let n=0;n<i;++n)r[n]=Dn(t[n],e);return Ln(r)}(t,this.tileGrid),e):this.setKey(e)}tileUrlFunction(t,e,i){}useTile(t,e,i){const r=wn(t,e,i);this.tileCache.containsKey(r)&&this.tileCache.get(r)}}const zn=Fn;function Bn(t,e){t.getImage().src=e}const Nn=class extends zn{constructor(t){super({attributions:t.attributions,cacheSize:t.cacheSize,opaque:t.opaque,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tileLoadFunction:t.tileLoadFunction?t.tileLoadFunction:Bn,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:t.wrapX,transition:t.transition,interpolate:void 0===t.interpolate||t.interpolate,key:t.key,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection}),this.crossOrigin=void 0!==t.crossOrigin?t.crossOrigin:null,this.tileClass=void 0!==t.tileClass?t.tileClass:an,this.tileCacheForProjection={},this.tileGridForProjection={},this.reprojectionErrorThreshold_=t.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1}canExpireCache(){if(this.tileCache.canExpireCache())return!0;for(const t in this.tileCacheForProjection)if(this.tileCacheForProjection[t].canExpireCache())return!0;return!1}expireCache(t,e){const i=this.getTileCacheForProjection(t);this.tileCache.expireCache(this.tileCache==i?e:{});for(const t in this.tileCacheForProjection){const r=this.tileCacheForProjection[t];r.expireCache(r==i?e:{})}}getGutterForProjection(t){return this.getProjection()&&t&&!Oe(this.getProjection(),t)?0:this.getGutter()}getGutter(){return 0}getKey(){let t=super.getKey();return this.getInterpolate()||(t+=":disable-interpolation"),t}getOpaque(t){return!(this.getProjection()&&t&&!Oe(this.getProjection(),t))&&super.getOpaque(t)}getTileGridForProjection(t){const e=this.getProjection();if(this.tileGrid&&(!e||Oe(e,t)))return this.tileGrid;const i=T(t);return i in this.tileGridForProjection||(this.tileGridForProjection[i]=Sn(t)),this.tileGridForProjection[i]}getTileCacheForProjection(t){const e=this.getProjection();if(!e||Oe(e,t))return this.tileCache;const i=T(t);return i in this.tileCacheForProjection||(this.tileCacheForProjection[i]=new bn(this.tileCache.highWaterMark)),this.tileCacheForProjection[i]}createTile_(t,e,i,r,n,s){const o=[t,e,i],a=this.getTileCoordForTileUrlFunction(o,n),h=a?this.tileUrlFunction(a,r,n):void 0,l=new this.tileClass(o,void 0!==h?0:4,void 0!==h?h:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return l.key=s,l.addEventListener(m,this.handleTileChange.bind(this)),l}getTile(t,e,i,r,n){const s=this.getProjection();if(!s||!n||Oe(s,n))return this.getTileInternal(t,e,i,r,s||n);const o=this.getTileCacheForProjection(n),a=[t,e,i];let h;const l=_n(a);o.containsKey(l)&&(h=o.get(l));const u=this.getKey();if(h&&h.key==u)return h;const c=this.getTileGridForProjection(s),d=this.getTileGridForProjection(n),f=this.getTileCoordForTileUrlFunction(a,n),g=new gn(s,c,n,d,a,f,this.getTilePixelRatio(r),this.getGutter(),((t,e,i,r)=>this.getTileInternal(t,e,i,r,s)),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.tileOptions);return g.key=u,h?(g.interimTile=h,g.refreshInterimChain(),o.replace(l,g)):o.set(l,g),g}getTileInternal(t,e,i,r,n){let s=null;const o=wn(t,e,i),a=this.getKey();if(this.tileCache.containsKey(o)){if(s=this.tileCache.get(o),s.key!=a){const h=s;s=this.createTile_(t,e,i,r,n,a),0==h.getState()?s.interimTile=h.interimTile:s.interimTile=h,s.refreshInterimChain(),this.tileCache.replace(o,s)}}else s=this.createTile_(t,e,i,r,n,a),this.tileCache.set(o,s);return s}setRenderReprojectionEdges(t){if(this.renderReprojectionEdges_!=t){this.renderReprojectionEdges_=t;for(const t in this.tileCacheForProjection)this.tileCacheForProjection[t].clear();this.changed()}}setTileGridForProjection(t,e){const i=Fe(t);if(i){const t=T(i);t in this.tileGridForProjection||(this.tileGridForProjection[t]=e)}}clear(){super.clear();for(const t in this.tileCacheForProjection)this.tileCacheForProjection[t].clear()}},On=class extends Nn{constructor(t){const e=void 0!==(t=t||{}).projection?t.projection:"EPSG:3857",i=void 0!==t.tileGrid?t.tileGrid:An({extent:Rn(e),maxResolution:t.maxResolution,maxZoom:t.maxZoom,minZoom:t.minZoom,tileSize:t.tileSize});super({attributions:t.attributions,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,interpolate:t.interpolate,opaque:t.opaque,projection:e,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileGrid:i,tileLoadFunction:t.tileLoadFunction,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:void 0===t.wrapX||t.wrapX,transition:t.transition,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection}),this.gutter_=void 0!==t.gutter?t.gutter:0}getGutter(){return this.gutter_}},Un=class extends On{constructor(t){let e;e=void 0!==(t=t||{}).attributions?t.attributions:['&#169; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors.'];const i=void 0!==t.crossOrigin?t.crossOrigin:"anonymous",r=void 0!==t.url?t.url:"https://tile.openstreetmap.org/{z}/{x}/{y}.png";super({attributions:e,attributionsCollapsible:!1,cacheSize:t.cacheSize,crossOrigin:i,interpolate:t.interpolate,maxZoom:void 0!==t.maxZoom?t.maxZoom:19,opaque:void 0===t.opaque||t.opaque,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileLoadFunction:t.tileLoadFunction,transition:t.transition,url:r,wrapX:t.wrapX,zDirection:t.zDirection})}},Vn=class extends Nn{constructor(t){const e=void 0!==t.hidpi&&t.hidpi;super({cacheSize:t.cacheSize,crossOrigin:"anonymous",interpolate:t.interpolate,opaque:!0,projection:Fe("EPSG:3857"),reprojectionErrorThreshold:t.reprojectionErrorThreshold,state:"loading",tileLoadFunction:t.tileLoadFunction,tilePixelRatio:e?2:1,wrapX:void 0===t.wrapX||t.wrapX,transition:t.transition,zDirection:t.zDirection}),this.hidpi_=e,this.culture_=void 0!==t.culture?t.culture:"en-us",this.maxZoom_=void 0!==t.maxZoom?t.maxZoom:-1,this.apiKey_=t.key,this.imagerySet_=t.imagerySet,this.placeholderTiles_=t.placeholderTiles;const i="https://dev.virtualearth.net/REST/v1/Imagery/Metadata/"+this.imagerySet_+"?uriScheme=https&include=ImageryProviders&key="+this.apiKey_+"&c="+this.culture_;fetch(i).then((t=>t.json())).then((t=>this.handleImageryMetadataResponse(t)))}getApiKey(){return this.apiKey_}getImagerySet(){return this.imagerySet_}handleImageryMetadataResponse(t){if(200!=t.statusCode||"OK"!=t.statusDescription||"ValidCredentials"!=t.authenticationResultCode||1!=t.resourceSets.length||1!=t.resourceSets[0].resources.length)return void this.setState("error");const e=t.resourceSets[0].resources[0],i=-1==this.maxZoom_?e.zoomMax:this.maxZoom_,r=Rn(this.getProjection()),n=this.hidpi_?2:1,s=e.imageWidth==e.imageHeight?e.imageWidth/n:[e.imageWidth/n,e.imageHeight/n],o=An({extent:r,minZoom:e.zoomMin,maxZoom:i,tileSize:s});this.tileGrid=o;const a=this.culture_,h=this.hidpi_,l=this.placeholderTiles_;if(this.tileUrlFunction=Ln(e.imageUrlSubdomains.map((function(t){const i=[0,0,0],r=e.imageUrl.replace("{subdomain}",t).replace("{culture}",a);return function(t,e,n){if(!t)return;pn(t[0],t[1],t[2],i);const s=new URL(r.replace("{quadkey}",function(t){const e=t[0],i=new Array(e);let r,n,s=1<<e-1;for(r=0;r<e;++r)n=48,t[1]&s&&(n+=1),t[2]&s&&(n+=2),i[r]=String.fromCharCode(n),s>>=1;return i.join("")}(i))),o=s.searchParams;return h&&(o.set("dpi","d1"),o.set("device","mobile")),!0===l?o.delete("n"):!1===l&&o.set("n","z"),s.toString()}}))),e.imageryProviders){const t=Ue(Fe("EPSG:4326"),this.getProjection());this.setAttributions((i=>{const r=[],n=i.viewState,s=this.getTileGrid(),o=s.getZForResolution(n.resolution,this.zDirection),a=s.getTileCoordForCoordAndZ(n.center,o)[0];return e.imageryProviders.map((function(e){let n=!1;const s=e.coverageAreas;for(let e=0,r=s.length;e<r;++e){const r=s[e];if(a>=r.zoomMin&&a<=r.zoomMax){const e=r.bbox;if(vt(Mt([e[1],e[0],e[3],e[2]],t),i.extent)){n=!0;break}}}n&&r.push(e.attribution)})),r.push('<a class="ol-attribution-bing-tos" href="https://www.microsoft.com/maps/product/terms.html" target="_blank">Terms of Use</a>'),r}))}this.setState("ready")}},Yn="preload",Xn="useInterimTilesOnError",jn=class extends Ui{constructor(t){t=t||{};const e=Object.assign({},t);delete e.preload,delete e.useInterimTilesOnError,super(e),this.on,this.once,this.un,this.setPreload(void 0!==t.preload?t.preload:0),this.setUseInterimTilesOnError(void 0===t.useInterimTilesOnError||t.useInterimTilesOnError)}getPreload(){return this.get(Yn)}setPreload(t){this.set(Yn,t)}getUseInterimTilesOnError(){return this.get(Xn)}setUseInterimTilesOnError(t){this.set(Xn,t)}getData(t){return super.getData(t)}},Gn=class extends C{constructor(t){super(),this.ready=!0,this.boundHandleImageChange_=this.handleImageChange_.bind(this),this.layer_=t,this.declutterExecutorGroup=null}getFeatures(t){return S()}getData(t){return null}prepareFrame(t){return S()}renderFrame(t,e){return S()}loadedTileCallback(t,e,i){t[e]||(t[e]={}),t[e][i.tileCoord.toString()]=i}createLoadedTileFinder(t,e,i){return(r,n)=>{const s=this.loadedTileCallback.bind(this,i,r);return t.forEachLoadedTile(e,r,n,s)}}forEachFeatureAtCoordinate(t,e,i,r,n){}getLayer(){return this.layer_}handleFontsChanged(){}handleImageChange_(t){const e=t.target;2!==e.getState()&&3!==e.getState()||this.renderIfReadyAndVisible()}loadImage(t){let e=t.getState();return 2!=e&&3!=e&&t.addEventListener(m,this.boundHandleImageChange_),0==e&&(t.load(),e=t.getState()),2==e}renderIfReadyAndVisible(){const t=this.getLayer();t&&t.getVisible()&&"ready"===t.getSourceState()&&t.changed()}disposeInternal(){delete this.layer_,super.disposeInternal()}};let qn=null;const Zn=class extends Gn{constructor(t){super(t),this.container=null,this.renderedResolution,this.tempTransform=[1,0,0,1,0,0],this.pixelTransform=[1,0,0,1,0,0],this.inversePixelTransform=[1,0,0,1,0,0],this.context=null,this.containerReused=!1,this.pixelContext_=null,this.frameState=null}getImageData(t,e,i){let r;qn||(qn=Ki(1,1,void 0,{willReadFrequently:!0})),qn.clearRect(0,0,1,1);try{qn.drawImage(t,e,i,1,1,0,0,1,1),r=qn.getImageData(0,0,1,1).data}catch(t){return qn=null,null}return r}getBackground(t){let e=this.getLayer().getBackground();return"function"==typeof e&&(e=e(t.viewState.resolution)),e||void 0}useContainer(t,e,i){const r=this.getLayer().getClassName();let n,s;if(t&&t.className===r&&(!i||t&&t.style.backgroundColor&&l(jt(t.style.backgroundColor),jt(i)))){const e=t.firstElementChild;e instanceof HTMLCanvasElement&&(s=e.getContext("2d"))}if(s&&s.canvas.style.transform===e?(this.container=t,this.context=s,this.containerReused=!0):this.containerReused?(this.container=null,this.context=null,this.containerReused=!1):this.container&&(this.container.style.backgroundColor=null),!this.container){n=document.createElement("div"),n.className=r;let t=n.style;t.position="absolute",t.width="100%",t.height="100%",s=Ki();const e=s.canvas;n.appendChild(e),t=e.style,t.position="absolute",t.left="0",t.transformOrigin="top left",this.container=n,this.context=s}this.containerReused||!i||this.container.style.backgroundColor||(this.container.style.backgroundColor=i)}clipUnrotated(t,e,i){const r=_t(i),n=bt(i),s=ct(i),o=ut(i);q(e.coordinateToPixelTransform,r),q(e.coordinateToPixelTransform,n),q(e.coordinateToPixelTransform,s),q(e.coordinateToPixelTransform,o);const a=this.inversePixelTransform;q(a,r),q(a,n),q(a,s),q(a,o),t.save(),t.beginPath(),t.moveTo(Math.round(r[0]),Math.round(r[1])),t.lineTo(Math.round(n[0]),Math.round(n[1])),t.lineTo(Math.round(s[0]),Math.round(s[1])),t.lineTo(Math.round(o[0]),Math.round(o[1])),t.clip()}dispatchRenderEvent_(t,e,i){const r=this.getLayer();if(r.hasListener(t)){const n=new Xi(t,this.inversePixelTransform,i,e);r.dispatchEvent(n)}}preRender(t,e){this.frameState=e,this.dispatchRenderEvent_("prerender",t,e)}postRender(t,e){this.dispatchRenderEvent_("postrender",t,e)}getRenderTransform(t,e,i,r,n,s,o){const a=n/2,h=s/2,l=r/e,u=-l,c=-t[0]+o,d=-t[1];return Z(this.tempTransform,a,h,l,u,-i,c,d)}disposeInternal(){delete this.frameState,super.disposeInternal()}},Kn=class extends Zn{constructor(t){super(t),this.extentChanged=!0,this.renderedExtent_=null,this.renderedPixelRatio,this.renderedProjection=null,this.renderedRevision,this.renderedTiles=[],this.newTiles_=!1,this.tmpExtent=[1/0,1/0,-1/0,-1/0],this.tmpTileRange_=new kn(0,0,0,0)}isDrawableTile(t){const e=this.getLayer(),i=t.getState(),r=e.getUseInterimTilesOnError();return 2==i||4==i||3==i&&!r}getTile(t,e,i,r){const n=r.pixelRatio,s=r.viewState.projection,o=this.getLayer();let a=o.getSource().getTile(t,e,i,n,s);return 3==a.getState()&&o.getUseInterimTilesOnError()&&o.getPreload()>0&&(this.newTiles_=!0),this.isDrawableTile(a)||(a=a.getInterimTile()),a}getData(t){const e=this.frameState;if(!e)return null;const i=this.getLayer(),r=q(e.pixelToCoordinateTransform,t.slice()),n=i.getExtent();if(n&&!J(n,r))return null;const s=e.pixelRatio,o=e.viewState.projection,a=e.viewState,h=i.getRenderSource(),l=h.getTileGridForProjection(a.projection),u=h.getTilePixelRatio(e.pixelRatio);for(let t=l.getZForResolution(a.resolution);t>=l.getMinZoom();--t){const e=l.getTileCoordForCoordAndZ(r,t),i=h.getTile(t,e[1],e[2],s,o);if(!(i instanceof an||i instanceof gn)||i instanceof gn&&4===i.getState())return null;if(2!==i.getState())continue;const n=l.getOrigin(t),c=en(l.getTileSize(t)),d=l.getResolution(t),f=Math.floor(u*((r[0]-n[0])/d-e[1]*c[0])),g=Math.floor(u*((n[1]-r[1])/d-e[2]*c[1])),m=Math.round(u*h.getGutterForProjection(a.projection));return this.getImageData(i.getImage(),f+m,g+m)}return null}loadedTileCallback(t,e,i){return!!this.isDrawableTile(i)&&super.loadedTileCallback(t,e,i)}prepareFrame(t){return!!this.getLayer().getSource()}renderFrame(t,e){const i=t.layerStatesArray[t.layerIndex],r=t.viewState,n=r.projection,s=r.resolution,o=r.center,h=r.rotation,l=t.pixelRatio,u=this.getLayer(),c=u.getSource(),d=c.getRevision(),f=c.getTileGridForProjection(n),g=f.getZForResolution(s,c.zDirection),m=f.getResolution(g);let p=t.extent;const w=t.viewState.resolution,_=c.getTilePixelRatio(l),b=Math.round(yt(p)/w*l),y=Math.round(pt(p)/w*l),v=i.extent&&Ze(i.extent);v&&(p=wt(p,Ze(i.extent)));const x=m*b/2/_,M=m*y/2/_,k=[o[0]-x,o[1]-M,o[0]+x,o[1]+M],E=f.getTileRangeForExtentAndZ(p,g),C={};C[g]={};const S=this.createLoadedTileFinder(c,n,C),A=this.tmpExtent,R=this.tmpTileRange_;this.newTiles_=!1;const P=h?mt(r.center,w,h,t.size):void 0;for(let e=E.minX;e<=E.maxX;++e)for(let r=E.minY;r<=E.maxY;++r){if(h&&!f.tileCoordIntersectsViewport([g,e,r],P))continue;const n=this.getTile(g,e,r,t);if(this.isDrawableTile(n)){const e=T(this);if(2==n.getState()){C[g][n.tileCoord.toString()]=n;let t=n.inTransition(e);t&&1!==i.opacity&&(n.endTransition(e),t=!1),this.newTiles_||!t&&this.renderedTiles.includes(n)||(this.newTiles_=!0)}if(1===n.getAlpha(e,t.time))continue}const s=f.getTileCoordChildTileRange(n.tileCoord,R,A);let o=!1;s&&(o=S(g+1,s)),o||f.forEachTileCoordParentTileRange(n.tileCoord,S,R,A)}const I=m/s*l/_;Z(this.pixelTransform,t.size[0]/2,t.size[1]/2,1/l,1/l,h,-b/2,-y/2);const D=function(t){const e="matrix("+t.join(", ")+")";if(Y)return e;const i=H||(H=document.createElement("div"));return i.style.transform=e,i.style.transform}(this.pixelTransform);this.useContainer(e,D,this.getBackground(t));const L=this.context,F=L.canvas;K(this.inversePixelTransform,this.pixelTransform),Z(this.tempTransform,b/2,y/2,I,I,0,-b/2,-y/2),F.width!=b||F.height!=y?(F.width=b,F.height=y):this.containerReused||L.clearRect(0,0,b,y),v&&this.clipUnrotated(L,t,v),c.getInterpolate()||(L.imageSmoothingEnabled=!1),this.preRender(L,t),this.renderedTiles.length=0;let z,B,N,O=Object.keys(C).map(Number);O.sort(a),1!==i.opacity||this.containerReused&&!c.getOpaque(t.viewState.projection)?(z=[],B=[]):O=O.reverse();for(let e=O.length-1;e>=0;--e){const i=O[e],r=c.getTilePixelSize(i,l,n),s=f.getResolution(i)/m,o=r[0]*s*I,a=r[1]*s*I,h=f.getTileCoordForCoordAndZ(_t(k),i),u=f.getTileCoordExtent(h),d=q(this.tempTransform,[_*(u[0]-k[0])/m,_*(k[3]-u[3])/m]),p=_*c.getGutterForProjection(n),w=C[i];for(const e in w){const r=w[e],n=r.tileCoord,s=h[1]-n[1],l=Math.round(d[0]-(s-1)*o),u=h[2]-n[2],f=Math.round(d[1]-(u-1)*a),m=Math.round(d[0]-s*o),_=Math.round(d[1]-u*a),b=l-m,y=f-_,v=g===i,x=v&&1!==r.getAlpha(T(this),t.time);let M=!1;if(!x)if(z){N=[m,_,m+b,_,m+b,_+y,m,_+y];for(let t=0,e=z.length;t<e;++t)if(g!==i&&i<B[t]){const e=z[t];vt([m,_,m+b,_+y],[e[0],e[3],e[4],e[7]])&&(M||(L.save(),M=!0),L.beginPath(),L.moveTo(N[0],N[1]),L.lineTo(N[2],N[3]),L.lineTo(N[4],N[5]),L.lineTo(N[6],N[7]),L.moveTo(e[6],e[7]),L.lineTo(e[4],e[5]),L.lineTo(e[2],e[3]),L.lineTo(e[0],e[1]),L.clip())}z.push(N),B.push(i)}else L.clearRect(m,_,b,y);this.drawTileImage(r,t,m,_,b,y,p,v),z&&!x?(M&&L.restore(),this.renderedTiles.unshift(r)):this.renderedTiles.push(r),this.updateUsedTiles(t.usedTiles,c,r)}}return this.renderedRevision=d,this.renderedResolution=m,this.extentChanged=!this.renderedExtent_||!nt(this.renderedExtent_,k),this.renderedExtent_=k,this.renderedPixelRatio=l,this.renderedProjection=n,this.manageTilePyramid(t,c,f,l,n,p,g,u.getPreload()),this.scheduleExpireCache(t,c),this.postRender(L,t),i.extent&&L.restore(),L.imageSmoothingEnabled=!0,D!==F.style.transform&&(F.style.transform=D),this.container}drawTileImage(t,e,i,r,n,s,o,a){const h=this.getTileImage(t);if(!h)return;const l=T(this),u=e.layerStatesArray[e.layerIndex],c=u.opacity*(a?t.getAlpha(l,e.time):1),d=c!==this.context.globalAlpha;d&&(this.context.save(),this.context.globalAlpha=c),this.context.drawImage(h,o,o,h.width-2*o,h.height-2*o,i,r,n,s),d&&this.context.restore(),c!==u.opacity?e.animate=!0:a&&t.endTransition(l)}getImage(){const t=this.context;return t?t.canvas:null}getTileImage(t){return t.getImage()}scheduleExpireCache(t,e){if(e.canExpireCache()){const i=function(t,e,i){const r=T(t);r in i.usedTiles&&t.expireCache(i.viewState.projection,i.usedTiles[r])}.bind(null,e);t.postRenderFunctions.push(i)}}updateUsedTiles(t,e,i){const r=T(e);r in t||(t[r]={}),t[r][i.getKey()]=!0}manageTilePyramid(t,e,i,r,n,s,o,a,h){const l=T(e);l in t.wantedTiles||(t.wantedTiles[l]={});const u=t.wantedTiles[l],c=t.tileQueue,d=i.getMinZoom(),f=t.viewState.rotation,g=f?mt(t.viewState.center,t.viewState.resolution,f,t.size):void 0;let m,p,w,_,b,y,v=0;for(y=d;y<=o;++y)for(p=i.getTileRangeForExtentAndZ(s,y,p),w=i.getResolution(y),_=p.minX;_<=p.maxX;++_)for(b=p.minY;b<=p.maxY;++b)f&&!i.tileCoordIntersectsViewport([y,_,b],g)||(o-y<=a?(++v,m=e.getTile(y,_,b,r,n),0==m.getState()&&(u[m.getKey()]=!0,c.isKeyQueued(m.getKey())||c.enqueue([m,l,i.getTileCoordCenter(m.tileCoord),w])),void 0!==h&&h(m)):e.useTile(y,_,b,n));e.updateCacheSize(v,n)}},Hn=class extends jn{constructor(t){super(t)}createRenderer(){return new Kn(this)}};var Wn=__webpack_require__(3379),$n=__webpack_require__.n(Wn),Qn=__webpack_require__(7795),Jn=__webpack_require__.n(Qn),ts=__webpack_require__(569),es=__webpack_require__.n(ts),is=__webpack_require__(3565),rs=__webpack_require__.n(is),ns=__webpack_require__(9216),ss=__webpack_require__.n(ns),os=__webpack_require__(4589),as=__webpack_require__.n(os),hs=__webpack_require__(1828),ls={};ls.styleTagTransform=as(),ls.setAttributes=rs(),ls.insert=es().bind(null,"head"),ls.domAPI=Jn(),ls.insertStyleElement=ss(),$n()(hs.Z,ls),hs.Z&&hs.Z.locals&&hs.Z.locals;var us=__webpack_require__(1788),cs={};function ds(t,e,i,r){let n=function(t){let e=[];for(let i=0;i<t.length;i+=4){let r=t[i],n=t[i+1],s=t[i+2];t[i+3],e.push([r,n,s])}return e}(e);return n[t[1]*i+t[0]]}function fs(t){let e={},i=0;for(let r=0;r<t.length;r++)t[r].toString()in e?(e[t[r].toString()]+=1,e[t[r].toString()]>i&&(i=t[r])):e[t[r].toString()]=1;return i}cs.styleTagTransform=as(),cs.setAttributes=rs(),cs.insert=es().bind(null,"head"),cs.domAPI=Jn(),cs.insertStyleElement=ss(),$n()(us.Z,cs),us.Z&&us.Z.locals&&us.Z.locals,__webpack_require__(148);const gs={getBit(t){return this.data[ms(t)]&1<<ps(t)?1:0},setBit(t){this.data[ms(t)]|=1<<ps(t)},clearBit(t){this.data[ms(t)]&=~(1<<ps(t))},toggleBit(t){this.data[ms(t)]^=1<<ps(t)},getBitXY(t,e){return t>=this.width||e>=this.height?0:this.getBit(e*this.width+t)},setBitXY(t,e){this.setBit(e*this.width+t)},clearBitXY(t,e){this.clearBit(e*this.width+t)},toggleBitXY(t,e){this.toggleBit(e*this.width+t)}};function ms(t){return t>>3}function ps(t){return 7-(7&t)}function ws(t,e,i){return"function"==typeof t.toBlob?new Promise((function(r){t.toBlob(r,e,i)})):Promise.resolve(function(t){var e=t.match(/data:([^;]+)/)[1],i=t.replace(/^[^,]+,/,"");return function(t,e){t=t||[],"string"==typeof(e=e||{})&&(e={type:e});try{return new Blob(t,e)}catch(n){if("TypeError"!==n.name)throw n;for(var i=new("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),r=0;r<t.length;r+=1)i.append(t[r]);return i.getBlob(e.type)}}([_s(atob(i))],{type:e})}(t.toDataURL(e,i)))}function _s(t){for(var e=t.length,i=new ArrayBuffer(e),r=new Uint8Array(i),n=-1;++n<e;)r[n]=t.charCodeAt(n);return i}var bs=__webpack_require__(4665),ys=__webpack_require__(2155);function vs(t){let e=t.length;for(;--e>=0;)t[e]=0}const xs=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),Ms=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),ks=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),Es=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Cs=new Array(576);vs(Cs);const Ss=new Array(60);vs(Ss);const As=new Array(512);vs(As);const Ts=new Array(256);vs(Ts);const Rs=new Array(29);vs(Rs);const Ps=new Array(30);function Is(t,e,i,r,n){this.static_tree=t,this.extra_bits=e,this.extra_base=i,this.elems=r,this.max_length=n,this.has_stree=t&&t.length}let Ds,Ls,Fs;function zs(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e}vs(Ps);const Bs=t=>t<256?As[t]:As[256+(t>>>7)],Ns=(t,e)=>{t.pending_buf[t.pending++]=255&e,t.pending_buf[t.pending++]=e>>>8&255},Os=(t,e,i)=>{t.bi_valid>16-i?(t.bi_buf|=e<<t.bi_valid&65535,Ns(t,t.bi_buf),t.bi_buf=e>>16-t.bi_valid,t.bi_valid+=i-16):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=i)},Us=(t,e,i)=>{Os(t,i[2*e],i[2*e+1])},Vs=(t,e)=>{let i=0;do{i|=1&t,t>>>=1,i<<=1}while(--e>0);return i>>>1},Ys=(t,e,i)=>{const r=new Array(16);let n,s,o=0;for(n=1;n<=15;n++)o=o+i[n-1]<<1,r[n]=o;for(s=0;s<=e;s++){let e=t[2*s+1];0!==e&&(t[2*s]=Vs(r[e]++,e))}},Xs=t=>{let e;for(e=0;e<286;e++)t.dyn_ltree[2*e]=0;for(e=0;e<30;e++)t.dyn_dtree[2*e]=0;for(e=0;e<19;e++)t.bl_tree[2*e]=0;t.dyn_ltree[512]=1,t.opt_len=t.static_len=0,t.sym_next=t.matches=0},js=t=>{t.bi_valid>8?Ns(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0},Gs=(t,e,i,r)=>{const n=2*e,s=2*i;return t[n]<t[s]||t[n]===t[s]&&r[e]<=r[i]},qs=(t,e,i)=>{const r=t.heap[i];let n=i<<1;for(;n<=t.heap_len&&(n<t.heap_len&&Gs(e,t.heap[n+1],t.heap[n],t.depth)&&n++,!Gs(e,r,t.heap[n],t.depth));)t.heap[i]=t.heap[n],i=n,n<<=1;t.heap[i]=r},Zs=(t,e,i)=>{let r,n,s,o,a=0;if(0!==t.sym_next)do{r=255&t.pending_buf[t.sym_buf+a++],r+=(255&t.pending_buf[t.sym_buf+a++])<<8,n=t.pending_buf[t.sym_buf+a++],0===r?Us(t,n,e):(s=Ts[n],Us(t,s+256+1,e),o=xs[s],0!==o&&(n-=Rs[s],Os(t,n,o)),r--,s=Bs(r),Us(t,s,i),o=Ms[s],0!==o&&(r-=Ps[s],Os(t,r,o)))}while(a<t.sym_next);Us(t,256,e)},Ks=(t,e)=>{const i=e.dyn_tree,r=e.stat_desc.static_tree,n=e.stat_desc.has_stree,s=e.stat_desc.elems;let o,a,h,l=-1;for(t.heap_len=0,t.heap_max=573,o=0;o<s;o++)0!==i[2*o]?(t.heap[++t.heap_len]=l=o,t.depth[o]=0):i[2*o+1]=0;for(;t.heap_len<2;)h=t.heap[++t.heap_len]=l<2?++l:0,i[2*h]=1,t.depth[h]=0,t.opt_len--,n&&(t.static_len-=r[2*h+1]);for(e.max_code=l,o=t.heap_len>>1;o>=1;o--)qs(t,i,o);h=s;do{o=t.heap[1],t.heap[1]=t.heap[t.heap_len--],qs(t,i,1),a=t.heap[1],t.heap[--t.heap_max]=o,t.heap[--t.heap_max]=a,i[2*h]=i[2*o]+i[2*a],t.depth[h]=(t.depth[o]>=t.depth[a]?t.depth[o]:t.depth[a])+1,i[2*o+1]=i[2*a+1]=h,t.heap[1]=h++,qs(t,i,1)}while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],((t,e)=>{const i=e.dyn_tree,r=e.max_code,n=e.stat_desc.static_tree,s=e.stat_desc.has_stree,o=e.stat_desc.extra_bits,a=e.stat_desc.extra_base,h=e.stat_desc.max_length;let l,u,c,d,f,g,m=0;for(d=0;d<=15;d++)t.bl_count[d]=0;for(i[2*t.heap[t.heap_max]+1]=0,l=t.heap_max+1;l<573;l++)u=t.heap[l],d=i[2*i[2*u+1]+1]+1,d>h&&(d=h,m++),i[2*u+1]=d,u>r||(t.bl_count[d]++,f=0,u>=a&&(f=o[u-a]),g=i[2*u],t.opt_len+=g*(d+f),s&&(t.static_len+=g*(n[2*u+1]+f)));if(0!==m){do{for(d=h-1;0===t.bl_count[d];)d--;t.bl_count[d]--,t.bl_count[d+1]+=2,t.bl_count[h]--,m-=2}while(m>0);for(d=h;0!==d;d--)for(u=t.bl_count[d];0!==u;)c=t.heap[--l],c>r||(i[2*c+1]!==d&&(t.opt_len+=(d-i[2*c+1])*i[2*c],i[2*c+1]=d),u--)}})(t,e),Ys(i,l,t.bl_count)},Hs=(t,e,i)=>{let r,n,s=-1,o=e[1],a=0,h=7,l=4;for(0===o&&(h=138,l=3),e[2*(i+1)+1]=65535,r=0;r<=i;r++)n=o,o=e[2*(r+1)+1],++a<h&&n===o||(a<l?t.bl_tree[2*n]+=a:0!==n?(n!==s&&t.bl_tree[2*n]++,t.bl_tree[32]++):a<=10?t.bl_tree[34]++:t.bl_tree[36]++,a=0,s=n,0===o?(h=138,l=3):n===o?(h=6,l=3):(h=7,l=4))},Ws=(t,e,i)=>{let r,n,s=-1,o=e[1],a=0,h=7,l=4;for(0===o&&(h=138,l=3),r=0;r<=i;r++)if(n=o,o=e[2*(r+1)+1],!(++a<h&&n===o)){if(a<l)do{Us(t,n,t.bl_tree)}while(0!=--a);else 0!==n?(n!==s&&(Us(t,n,t.bl_tree),a--),Us(t,16,t.bl_tree),Os(t,a-3,2)):a<=10?(Us(t,17,t.bl_tree),Os(t,a-3,3)):(Us(t,18,t.bl_tree),Os(t,a-11,7));a=0,s=n,0===o?(h=138,l=3):n===o?(h=6,l=3):(h=7,l=4)}};let $s=!1;const Qs=(t,e,i,r)=>{Os(t,0+(r?1:0),3),js(t),Ns(t,i),Ns(t,~i),i&&t.pending_buf.set(t.window.subarray(e,e+i),t.pending),t.pending+=i};var Js={_tr_init:t=>{$s||((()=>{let t,e,i,r,n;const s=new Array(16);for(i=0,r=0;r<28;r++)for(Rs[r]=i,t=0;t<1<<xs[r];t++)Ts[i++]=r;for(Ts[i-1]=r,n=0,r=0;r<16;r++)for(Ps[r]=n,t=0;t<1<<Ms[r];t++)As[n++]=r;for(n>>=7;r<30;r++)for(Ps[r]=n<<7,t=0;t<1<<Ms[r]-7;t++)As[256+n++]=r;for(e=0;e<=15;e++)s[e]=0;for(t=0;t<=143;)Cs[2*t+1]=8,t++,s[8]++;for(;t<=255;)Cs[2*t+1]=9,t++,s[9]++;for(;t<=279;)Cs[2*t+1]=7,t++,s[7]++;for(;t<=287;)Cs[2*t+1]=8,t++,s[8]++;for(Ys(Cs,287,s),t=0;t<30;t++)Ss[2*t+1]=5,Ss[2*t]=Vs(t,5);Ds=new Is(Cs,xs,257,286,15),Ls=new Is(Ss,Ms,0,30,15),Fs=new Is(new Array(0),ks,0,19,7)})(),$s=!0),t.l_desc=new zs(t.dyn_ltree,Ds),t.d_desc=new zs(t.dyn_dtree,Ls),t.bl_desc=new zs(t.bl_tree,Fs),t.bi_buf=0,t.bi_valid=0,Xs(t)},_tr_stored_block:Qs,_tr_flush_block:(t,e,i,r)=>{let n,s,o=0;t.level>0?(2===t.strm.data_type&&(t.strm.data_type=(t=>{let e,i=4093624447;for(e=0;e<=31;e++,i>>>=1)if(1&i&&0!==t.dyn_ltree[2*e])return 0;if(0!==t.dyn_ltree[18]||0!==t.dyn_ltree[20]||0!==t.dyn_ltree[26])return 1;for(e=32;e<256;e++)if(0!==t.dyn_ltree[2*e])return 1;return 0})(t)),Ks(t,t.l_desc),Ks(t,t.d_desc),o=(t=>{let e;for(Hs(t,t.dyn_ltree,t.l_desc.max_code),Hs(t,t.dyn_dtree,t.d_desc.max_code),Ks(t,t.bl_desc),e=18;e>=3&&0===t.bl_tree[2*Es[e]+1];e--);return t.opt_len+=3*(e+1)+5+5+4,e})(t),n=t.opt_len+3+7>>>3,s=t.static_len+3+7>>>3,s<=n&&(n=s)):n=s=i+5,i+4<=n&&-1!==e?Qs(t,e,i,r):4===t.strategy||s===n?(Os(t,2+(r?1:0),3),Zs(t,Cs,Ss)):(Os(t,4+(r?1:0),3),((t,e,i,r)=>{let n;for(Os(t,e-257,5),Os(t,i-1,5),Os(t,r-4,4),n=0;n<r;n++)Os(t,t.bl_tree[2*Es[n]+1],3);Ws(t,t.dyn_ltree,e-1),Ws(t,t.dyn_dtree,i-1)})(t,t.l_desc.max_code+1,t.d_desc.max_code+1,o+1),Zs(t,t.dyn_ltree,t.dyn_dtree)),Xs(t),r&&js(t)},_tr_tally:(t,e,i)=>(t.pending_buf[t.sym_buf+t.sym_next++]=e,t.pending_buf[t.sym_buf+t.sym_next++]=e>>8,t.pending_buf[t.sym_buf+t.sym_next++]=i,0===e?t.dyn_ltree[2*i]++:(t.matches++,e--,t.dyn_ltree[2*(Ts[i]+256+1)]++,t.dyn_dtree[2*Bs(e)]++),t.sym_next===t.sym_end),_tr_align:t=>{Os(t,2,3),Us(t,256,Cs),(t=>{16===t.bi_valid?(Ns(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)})(t)}},to=(t,e,i,r)=>{let n=65535&t|0,s=t>>>16&65535|0,o=0;for(;0!==i;){o=i>2e3?2e3:i,i-=o;do{n=n+e[r++]|0,s=s+n|0}while(--o);n%=65521,s%=65521}return n|s<<16|0};const eo=new Uint32Array((()=>{let t,e=[];for(var i=0;i<256;i++){t=i;for(var r=0;r<8;r++)t=1&t?3988292384^t>>>1:t>>>1;e[i]=t}return e})());var io=(t,e,i,r)=>{const n=eo,s=r+i;t^=-1;for(let i=r;i<s;i++)t=t>>>8^n[255&(t^e[i])];return-1^t},ro={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},no={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:so,_tr_stored_block:oo,_tr_flush_block:ao,_tr_tally:ho,_tr_align:lo}=Js,{Z_NO_FLUSH:uo,Z_PARTIAL_FLUSH:co,Z_FULL_FLUSH:fo,Z_FINISH:go,Z_BLOCK:mo,Z_OK:po,Z_STREAM_END:wo,Z_STREAM_ERROR:_o,Z_DATA_ERROR:bo,Z_BUF_ERROR:yo,Z_DEFAULT_COMPRESSION:vo,Z_FILTERED:xo,Z_HUFFMAN_ONLY:Mo,Z_RLE:ko,Z_FIXED:Eo,Z_DEFAULT_STRATEGY:Co,Z_UNKNOWN:So,Z_DEFLATED:Ao}=no,To=258,Ro=262,Po=42,Io=113,Do=666,Lo=(t,e)=>(t.msg=ro[e],e),Fo=t=>2*t-(t>4?9:0),zo=t=>{let e=t.length;for(;--e>=0;)t[e]=0},Bo=t=>{let e,i,r,n=t.w_size;e=t.hash_size,r=e;do{i=t.head[--r],t.head[r]=i>=n?i-n:0}while(--e);e=n,r=e;do{i=t.prev[--r],t.prev[r]=i>=n?i-n:0}while(--e)};let No=(t,e,i)=>(e<<t.hash_shift^i)&t.hash_mask;const Oo=t=>{const e=t.state;let i=e.pending;i>t.avail_out&&(i=t.avail_out),0!==i&&(t.output.set(e.pending_buf.subarray(e.pending_out,e.pending_out+i),t.next_out),t.next_out+=i,e.pending_out+=i,t.total_out+=i,t.avail_out-=i,e.pending-=i,0===e.pending&&(e.pending_out=0))},Uo=(t,e)=>{ao(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,Oo(t.strm)},Vo=(t,e)=>{t.pending_buf[t.pending++]=e},Yo=(t,e)=>{t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=255&e},Xo=(t,e,i,r)=>{let n=t.avail_in;return n>r&&(n=r),0===n?0:(t.avail_in-=n,e.set(t.input.subarray(t.next_in,t.next_in+n),i),1===t.state.wrap?t.adler=to(t.adler,e,n,i):2===t.state.wrap&&(t.adler=io(t.adler,e,n,i)),t.next_in+=n,t.total_in+=n,n)},jo=(t,e)=>{let i,r,n=t.max_chain_length,s=t.strstart,o=t.prev_length,a=t.nice_match;const h=t.strstart>t.w_size-Ro?t.strstart-(t.w_size-Ro):0,l=t.window,u=t.w_mask,c=t.prev,d=t.strstart+To;let f=l[s+o-1],g=l[s+o];t.prev_length>=t.good_match&&(n>>=2),a>t.lookahead&&(a=t.lookahead);do{if(i=e,l[i+o]===g&&l[i+o-1]===f&&l[i]===l[s]&&l[++i]===l[s+1]){s+=2,i++;do{}while(l[++s]===l[++i]&&l[++s]===l[++i]&&l[++s]===l[++i]&&l[++s]===l[++i]&&l[++s]===l[++i]&&l[++s]===l[++i]&&l[++s]===l[++i]&&l[++s]===l[++i]&&s<d);if(r=To-(d-s),s=d-To,r>o){if(t.match_start=e,o=r,r>=a)break;f=l[s+o-1],g=l[s+o]}}}while((e=c[e&u])>h&&0!=--n);return o<=t.lookahead?o:t.lookahead},Go=t=>{const e=t.w_size;let i,r,n;do{if(r=t.window_size-t.lookahead-t.strstart,t.strstart>=e+(e-Ro)&&(t.window.set(t.window.subarray(e,e+e-r),0),t.match_start-=e,t.strstart-=e,t.block_start-=e,t.insert>t.strstart&&(t.insert=t.strstart),Bo(t),r+=e),0===t.strm.avail_in)break;if(i=Xo(t.strm,t.window,t.strstart+t.lookahead,r),t.lookahead+=i,t.lookahead+t.insert>=3)for(n=t.strstart-t.insert,t.ins_h=t.window[n],t.ins_h=No(t,t.ins_h,t.window[n+1]);t.insert&&(t.ins_h=No(t,t.ins_h,t.window[n+3-1]),t.prev[n&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=n,n++,t.insert--,!(t.lookahead+t.insert<3)););}while(t.lookahead<Ro&&0!==t.strm.avail_in)},qo=(t,e)=>{let i,r,n,s=t.pending_buf_size-5>t.w_size?t.w_size:t.pending_buf_size-5,o=0,a=t.strm.avail_in;do{if(i=65535,n=t.bi_valid+42>>3,t.strm.avail_out<n)break;if(n=t.strm.avail_out-n,r=t.strstart-t.block_start,i>r+t.strm.avail_in&&(i=r+t.strm.avail_in),i>n&&(i=n),i<s&&(0===i&&e!==go||e===uo||i!==r+t.strm.avail_in))break;o=e===go&&i===r+t.strm.avail_in?1:0,oo(t,0,0,o),t.pending_buf[t.pending-4]=i,t.pending_buf[t.pending-3]=i>>8,t.pending_buf[t.pending-2]=~i,t.pending_buf[t.pending-1]=~i>>8,Oo(t.strm),r&&(r>i&&(r=i),t.strm.output.set(t.window.subarray(t.block_start,t.block_start+r),t.strm.next_out),t.strm.next_out+=r,t.strm.avail_out-=r,t.strm.total_out+=r,t.block_start+=r,i-=r),i&&(Xo(t.strm,t.strm.output,t.strm.next_out,i),t.strm.next_out+=i,t.strm.avail_out-=i,t.strm.total_out+=i)}while(0===o);return a-=t.strm.avail_in,a&&(a>=t.w_size?(t.matches=2,t.window.set(t.strm.input.subarray(t.strm.next_in-t.w_size,t.strm.next_in),0),t.strstart=t.w_size,t.insert=t.strstart):(t.window_size-t.strstart<=a&&(t.strstart-=t.w_size,t.window.set(t.window.subarray(t.w_size,t.w_size+t.strstart),0),t.matches<2&&t.matches++,t.insert>t.strstart&&(t.insert=t.strstart)),t.window.set(t.strm.input.subarray(t.strm.next_in-a,t.strm.next_in),t.strstart),t.strstart+=a,t.insert+=a>t.w_size-t.insert?t.w_size-t.insert:a),t.block_start=t.strstart),t.high_water<t.strstart&&(t.high_water=t.strstart),o?4:e!==uo&&e!==go&&0===t.strm.avail_in&&t.strstart===t.block_start?2:(n=t.window_size-t.strstart,t.strm.avail_in>n&&t.block_start>=t.w_size&&(t.block_start-=t.w_size,t.strstart-=t.w_size,t.window.set(t.window.subarray(t.w_size,t.w_size+t.strstart),0),t.matches<2&&t.matches++,n+=t.w_size,t.insert>t.strstart&&(t.insert=t.strstart)),n>t.strm.avail_in&&(n=t.strm.avail_in),n&&(Xo(t.strm,t.window,t.strstart,n),t.strstart+=n,t.insert+=n>t.w_size-t.insert?t.w_size-t.insert:n),t.high_water<t.strstart&&(t.high_water=t.strstart),n=t.bi_valid+42>>3,n=t.pending_buf_size-n>65535?65535:t.pending_buf_size-n,s=n>t.w_size?t.w_size:n,r=t.strstart-t.block_start,(r>=s||(r||e===go)&&e!==uo&&0===t.strm.avail_in&&r<=n)&&(i=r>n?n:r,o=e===go&&0===t.strm.avail_in&&i===r?1:0,oo(t,t.block_start,i,o),t.block_start+=i,Oo(t.strm)),o?3:1)},Zo=(t,e)=>{let i,r;for(;;){if(t.lookahead<Ro){if(Go(t),t.lookahead<Ro&&e===uo)return 1;if(0===t.lookahead)break}if(i=0,t.lookahead>=3&&(t.ins_h=No(t,t.ins_h,t.window[t.strstart+3-1]),i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!==i&&t.strstart-i<=t.w_size-Ro&&(t.match_length=jo(t,i)),t.match_length>=3)if(r=ho(t,t.strstart-t.match_start,t.match_length-3),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=3){t.match_length--;do{t.strstart++,t.ins_h=No(t,t.ins_h,t.window[t.strstart+3-1]),i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart}while(0!=--t.match_length);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=No(t,t.ins_h,t.window[t.strstart+1]);else r=ho(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(r&&(Uo(t,!1),0===t.strm.avail_out))return 1}return t.insert=t.strstart<2?t.strstart:2,e===go?(Uo(t,!0),0===t.strm.avail_out?3:4):t.sym_next&&(Uo(t,!1),0===t.strm.avail_out)?1:2},Ko=(t,e)=>{let i,r,n;for(;;){if(t.lookahead<Ro){if(Go(t),t.lookahead<Ro&&e===uo)return 1;if(0===t.lookahead)break}if(i=0,t.lookahead>=3&&(t.ins_h=No(t,t.ins_h,t.window[t.strstart+3-1]),i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=2,0!==i&&t.prev_length<t.max_lazy_match&&t.strstart-i<=t.w_size-Ro&&(t.match_length=jo(t,i),t.match_length<=5&&(t.strategy===xo||3===t.match_length&&t.strstart-t.match_start>4096)&&(t.match_length=2)),t.prev_length>=3&&t.match_length<=t.prev_length){n=t.strstart+t.lookahead-3,r=ho(t,t.strstart-1-t.prev_match,t.prev_length-3),t.lookahead-=t.prev_length-1,t.prev_length-=2;do{++t.strstart<=n&&(t.ins_h=No(t,t.ins_h,t.window[t.strstart+3-1]),i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart)}while(0!=--t.prev_length);if(t.match_available=0,t.match_length=2,t.strstart++,r&&(Uo(t,!1),0===t.strm.avail_out))return 1}else if(t.match_available){if(r=ho(t,0,t.window[t.strstart-1]),r&&Uo(t,!1),t.strstart++,t.lookahead--,0===t.strm.avail_out)return 1}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(r=ho(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<2?t.strstart:2,e===go?(Uo(t,!0),0===t.strm.avail_out?3:4):t.sym_next&&(Uo(t,!1),0===t.strm.avail_out)?1:2};function Ho(t,e,i,r,n){this.good_length=t,this.max_lazy=e,this.nice_length=i,this.max_chain=r,this.func=n}const Wo=[new Ho(0,0,0,0,qo),new Ho(4,4,8,4,Zo),new Ho(4,5,16,8,Zo),new Ho(4,6,32,32,Zo),new Ho(4,4,16,16,Ko),new Ho(8,16,32,32,Ko),new Ho(8,16,128,128,Ko),new Ho(8,32,128,256,Ko),new Ho(32,128,258,1024,Ko),new Ho(32,258,258,4096,Ko)];function $o(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Ao,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),zo(this.dyn_ltree),zo(this.dyn_dtree),zo(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),zo(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),zo(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const Qo=t=>{if(!t)return 1;const e=t.state;return!e||e.strm!==t||e.status!==Po&&57!==e.status&&69!==e.status&&73!==e.status&&91!==e.status&&103!==e.status&&e.status!==Io&&e.status!==Do?1:0},Jo=t=>{if(Qo(t))return Lo(t,_o);t.total_in=t.total_out=0,t.data_type=So;const e=t.state;return e.pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=2===e.wrap?57:e.wrap?Po:Io,t.adler=2===e.wrap?0:1,e.last_flush=-2,so(e),po},ta=t=>{const e=Jo(t);var i;return e===po&&((i=t.state).window_size=2*i.w_size,zo(i.head),i.max_lazy_match=Wo[i.level].max_lazy,i.good_match=Wo[i.level].good_length,i.nice_match=Wo[i.level].nice_length,i.max_chain_length=Wo[i.level].max_chain,i.strstart=0,i.block_start=0,i.lookahead=0,i.insert=0,i.match_length=i.prev_length=2,i.match_available=0,i.ins_h=0),e},ea=(t,e,i,r,n,s)=>{if(!t)return _o;let o=1;if(e===vo&&(e=6),r<0?(o=0,r=-r):r>15&&(o=2,r-=16),n<1||n>9||i!==Ao||r<8||r>15||e<0||e>9||s<0||s>Eo||8===r&&1!==o)return Lo(t,_o);8===r&&(r=9);const a=new $o;return t.state=a,a.strm=t,a.status=Po,a.wrap=o,a.gzhead=null,a.w_bits=r,a.w_size=1<<a.w_bits,a.w_mask=a.w_size-1,a.hash_bits=n+7,a.hash_size=1<<a.hash_bits,a.hash_mask=a.hash_size-1,a.hash_shift=~~((a.hash_bits+3-1)/3),a.window=new Uint8Array(2*a.w_size),a.head=new Uint16Array(a.hash_size),a.prev=new Uint16Array(a.w_size),a.lit_bufsize=1<<n+6,a.pending_buf_size=4*a.lit_bufsize,a.pending_buf=new Uint8Array(a.pending_buf_size),a.sym_buf=a.lit_bufsize,a.sym_end=3*(a.lit_bufsize-1),a.level=e,a.strategy=s,a.method=i,ta(t)};var ia={deflateInit:(t,e)=>ea(t,e,Ao,15,8,Co),deflateInit2:ea,deflateReset:ta,deflateResetKeep:Jo,deflateSetHeader:(t,e)=>Qo(t)||2!==t.state.wrap?_o:(t.state.gzhead=e,po),deflate:(t,e)=>{if(Qo(t)||e>mo||e<0)return t?Lo(t,_o):_o;const i=t.state;if(!t.output||0!==t.avail_in&&!t.input||i.status===Do&&e!==go)return Lo(t,0===t.avail_out?yo:_o);const r=i.last_flush;if(i.last_flush=e,0!==i.pending){if(Oo(t),0===t.avail_out)return i.last_flush=-1,po}else if(0===t.avail_in&&Fo(e)<=Fo(r)&&e!==go)return Lo(t,yo);if(i.status===Do&&0!==t.avail_in)return Lo(t,yo);if(i.status===Po&&0===i.wrap&&(i.status=Io),i.status===Po){let e=Ao+(i.w_bits-8<<4)<<8,r=-1;if(r=i.strategy>=Mo||i.level<2?0:i.level<6?1:6===i.level?2:3,e|=r<<6,0!==i.strstart&&(e|=32),e+=31-e%31,Yo(i,e),0!==i.strstart&&(Yo(i,t.adler>>>16),Yo(i,65535&t.adler)),t.adler=1,i.status=Io,Oo(t),0!==i.pending)return i.last_flush=-1,po}if(57===i.status)if(t.adler=0,Vo(i,31),Vo(i,139),Vo(i,8),i.gzhead)Vo(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),Vo(i,255&i.gzhead.time),Vo(i,i.gzhead.time>>8&255),Vo(i,i.gzhead.time>>16&255),Vo(i,i.gzhead.time>>24&255),Vo(i,9===i.level?2:i.strategy>=Mo||i.level<2?4:0),Vo(i,255&i.gzhead.os),i.gzhead.extra&&i.gzhead.extra.length&&(Vo(i,255&i.gzhead.extra.length),Vo(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(t.adler=io(t.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=69;else if(Vo(i,0),Vo(i,0),Vo(i,0),Vo(i,0),Vo(i,0),Vo(i,9===i.level?2:i.strategy>=Mo||i.level<2?4:0),Vo(i,3),i.status=Io,Oo(t),0!==i.pending)return i.last_flush=-1,po;if(69===i.status){if(i.gzhead.extra){let e=i.pending,r=(65535&i.gzhead.extra.length)-i.gzindex;for(;i.pending+r>i.pending_buf_size;){let n=i.pending_buf_size-i.pending;if(i.pending_buf.set(i.gzhead.extra.subarray(i.gzindex,i.gzindex+n),i.pending),i.pending=i.pending_buf_size,i.gzhead.hcrc&&i.pending>e&&(t.adler=io(t.adler,i.pending_buf,i.pending-e,e)),i.gzindex+=n,Oo(t),0!==i.pending)return i.last_flush=-1,po;e=0,r-=n}let n=new Uint8Array(i.gzhead.extra);i.pending_buf.set(n.subarray(i.gzindex,i.gzindex+r),i.pending),i.pending+=r,i.gzhead.hcrc&&i.pending>e&&(t.adler=io(t.adler,i.pending_buf,i.pending-e,e)),i.gzindex=0}i.status=73}if(73===i.status){if(i.gzhead.name){let e,r=i.pending;do{if(i.pending===i.pending_buf_size){if(i.gzhead.hcrc&&i.pending>r&&(t.adler=io(t.adler,i.pending_buf,i.pending-r,r)),Oo(t),0!==i.pending)return i.last_flush=-1,po;r=0}e=i.gzindex<i.gzhead.name.length?255&i.gzhead.name.charCodeAt(i.gzindex++):0,Vo(i,e)}while(0!==e);i.gzhead.hcrc&&i.pending>r&&(t.adler=io(t.adler,i.pending_buf,i.pending-r,r)),i.gzindex=0}i.status=91}if(91===i.status){if(i.gzhead.comment){let e,r=i.pending;do{if(i.pending===i.pending_buf_size){if(i.gzhead.hcrc&&i.pending>r&&(t.adler=io(t.adler,i.pending_buf,i.pending-r,r)),Oo(t),0!==i.pending)return i.last_flush=-1,po;r=0}e=i.gzindex<i.gzhead.comment.length?255&i.gzhead.comment.charCodeAt(i.gzindex++):0,Vo(i,e)}while(0!==e);i.gzhead.hcrc&&i.pending>r&&(t.adler=io(t.adler,i.pending_buf,i.pending-r,r))}i.status=103}if(103===i.status){if(i.gzhead.hcrc){if(i.pending+2>i.pending_buf_size&&(Oo(t),0!==i.pending))return i.last_flush=-1,po;Vo(i,255&t.adler),Vo(i,t.adler>>8&255),t.adler=0}if(i.status=Io,Oo(t),0!==i.pending)return i.last_flush=-1,po}if(0!==t.avail_in||0!==i.lookahead||e!==uo&&i.status!==Do){let r=0===i.level?qo(i,e):i.strategy===Mo?((t,e)=>{let i;for(;;){if(0===t.lookahead&&(Go(t),0===t.lookahead)){if(e===uo)return 1;break}if(t.match_length=0,i=ho(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,i&&(Uo(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,e===go?(Uo(t,!0),0===t.strm.avail_out?3:4):t.sym_next&&(Uo(t,!1),0===t.strm.avail_out)?1:2})(i,e):i.strategy===ko?((t,e)=>{let i,r,n,s;const o=t.window;for(;;){if(t.lookahead<=To){if(Go(t),t.lookahead<=To&&e===uo)return 1;if(0===t.lookahead)break}if(t.match_length=0,t.lookahead>=3&&t.strstart>0&&(n=t.strstart-1,r=o[n],r===o[++n]&&r===o[++n]&&r===o[++n])){s=t.strstart+To;do{}while(r===o[++n]&&r===o[++n]&&r===o[++n]&&r===o[++n]&&r===o[++n]&&r===o[++n]&&r===o[++n]&&r===o[++n]&&n<s);t.match_length=To-(s-n),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=3?(i=ho(t,1,t.match_length-3),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(i=ho(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),i&&(Uo(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,e===go?(Uo(t,!0),0===t.strm.avail_out?3:4):t.sym_next&&(Uo(t,!1),0===t.strm.avail_out)?1:2})(i,e):Wo[i.level].func(i,e);if(3!==r&&4!==r||(i.status=Do),1===r||3===r)return 0===t.avail_out&&(i.last_flush=-1),po;if(2===r&&(e===co?lo(i):e!==mo&&(oo(i,0,0,!1),e===fo&&(zo(i.head),0===i.lookahead&&(i.strstart=0,i.block_start=0,i.insert=0))),Oo(t),0===t.avail_out))return i.last_flush=-1,po}return e!==go?po:i.wrap<=0?wo:(2===i.wrap?(Vo(i,255&t.adler),Vo(i,t.adler>>8&255),Vo(i,t.adler>>16&255),Vo(i,t.adler>>24&255),Vo(i,255&t.total_in),Vo(i,t.total_in>>8&255),Vo(i,t.total_in>>16&255),Vo(i,t.total_in>>24&255)):(Yo(i,t.adler>>>16),Yo(i,65535&t.adler)),Oo(t),i.wrap>0&&(i.wrap=-i.wrap),0!==i.pending?po:wo)},deflateEnd:t=>{if(Qo(t))return _o;const e=t.state.status;return t.state=null,e===Io?Lo(t,bo):po},deflateSetDictionary:(t,e)=>{let i=e.length;if(Qo(t))return _o;const r=t.state,n=r.wrap;if(2===n||1===n&&r.status!==Po||r.lookahead)return _o;if(1===n&&(t.adler=to(t.adler,e,i,0)),r.wrap=0,i>=r.w_size){0===n&&(zo(r.head),r.strstart=0,r.block_start=0,r.insert=0);let t=new Uint8Array(r.w_size);t.set(e.subarray(i-r.w_size,i),0),e=t,i=r.w_size}const s=t.avail_in,o=t.next_in,a=t.input;for(t.avail_in=i,t.next_in=0,t.input=e,Go(r);r.lookahead>=3;){let t=r.strstart,e=r.lookahead-2;do{r.ins_h=No(r,r.ins_h,r.window[t+3-1]),r.prev[t&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=t,t++}while(--e);r.strstart=t,r.lookahead=2,Go(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=2,r.match_available=0,t.next_in=o,t.input=a,t.avail_in=s,r.wrap=n,po},deflateInfo:"pako deflate (from Nodeca project)"};const ra=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var na={assign:function(t){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const i=e.shift();if(i){if("object"!=typeof i)throw new TypeError(i+"must be non-object");for(const e in i)ra(i,e)&&(t[e]=i[e])}}return t},flattenChunks:t=>{let e=0;for(let i=0,r=t.length;i<r;i++)e+=t[i].length;const i=new Uint8Array(e);for(let e=0,r=0,n=t.length;e<n;e++){let n=t[e];i.set(n,r),r+=n.length}return i}};let sa=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(t){sa=!1}const oa=new Uint8Array(256);for(let t=0;t<256;t++)oa[t]=t>=252?6:t>=248?5:t>=240?4:t>=224?3:t>=192?2:1;oa[254]=oa[254]=1;var aa={string2buf:t=>{if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(t);let e,i,r,n,s,o=t.length,a=0;for(n=0;n<o;n++)i=t.charCodeAt(n),55296==(64512&i)&&n+1<o&&(r=t.charCodeAt(n+1),56320==(64512&r)&&(i=65536+(i-55296<<10)+(r-56320),n++)),a+=i<128?1:i<2048?2:i<65536?3:4;for(e=new Uint8Array(a),s=0,n=0;s<a;n++)i=t.charCodeAt(n),55296==(64512&i)&&n+1<o&&(r=t.charCodeAt(n+1),56320==(64512&r)&&(i=65536+(i-55296<<10)+(r-56320),n++)),i<128?e[s++]=i:i<2048?(e[s++]=192|i>>>6,e[s++]=128|63&i):i<65536?(e[s++]=224|i>>>12,e[s++]=128|i>>>6&63,e[s++]=128|63&i):(e[s++]=240|i>>>18,e[s++]=128|i>>>12&63,e[s++]=128|i>>>6&63,e[s++]=128|63&i);return e},buf2string:(t,e)=>{const i=e||t.length;if("function"==typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(t.subarray(0,e));let r,n;const s=new Array(2*i);for(n=0,r=0;r<i;){let e=t[r++];if(e<128){s[n++]=e;continue}let o=oa[e];if(o>4)s[n++]=65533,r+=o-1;else{for(e&=2===o?31:3===o?15:7;o>1&&r<i;)e=e<<6|63&t[r++],o--;o>1?s[n++]=65533:e<65536?s[n++]=e:(e-=65536,s[n++]=55296|e>>10&1023,s[n++]=56320|1023&e)}}return((t,e)=>{if(e<65534&&t.subarray&&sa)return String.fromCharCode.apply(null,t.length===e?t:t.subarray(0,e));let i="";for(let r=0;r<e;r++)i+=String.fromCharCode(t[r]);return i})(s,n)},utf8border:(t,e)=>{(e=e||t.length)>t.length&&(e=t.length);let i=e-1;for(;i>=0&&128==(192&t[i]);)i--;return i<0||0===i?e:i+oa[t[i]]>e?i:e}},ha=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};const la=Object.prototype.toString,{Z_NO_FLUSH:ua,Z_SYNC_FLUSH:ca,Z_FULL_FLUSH:da,Z_FINISH:fa,Z_OK:ga,Z_STREAM_END:ma,Z_DEFAULT_COMPRESSION:pa,Z_DEFAULT_STRATEGY:wa,Z_DEFLATED:_a}=no;function ba(t){this.options=na.assign({level:pa,method:_a,chunkSize:16384,windowBits:15,memLevel:8,strategy:wa},t||{});let e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new ha,this.strm.avail_out=0;let i=ia.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(i!==ga)throw new Error(ro[i]);if(e.header&&ia.deflateSetHeader(this.strm,e.header),e.dictionary){let t;if(t="string"==typeof e.dictionary?aa.string2buf(e.dictionary):"[object ArrayBuffer]"===la.call(e.dictionary)?new Uint8Array(e.dictionary):e.dictionary,i=ia.deflateSetDictionary(this.strm,t),i!==ga)throw new Error(ro[i]);this._dict_set=!0}}function ya(t,e){const i=new ba(e);if(i.push(t,!0),i.err)throw i.msg||ro[i.err];return i.result}ba.prototype.push=function(t,e){const i=this.strm,r=this.options.chunkSize;let n,s;if(this.ended)return!1;for(s=e===~~e?e:!0===e?fa:ua,"string"==typeof t?i.input=aa.string2buf(t):"[object ArrayBuffer]"===la.call(t)?i.input=new Uint8Array(t):i.input=t,i.next_in=0,i.avail_in=i.input.length;;)if(0===i.avail_out&&(i.output=new Uint8Array(r),i.next_out=0,i.avail_out=r),(s===ca||s===da)&&i.avail_out<=6)this.onData(i.output.subarray(0,i.next_out)),i.avail_out=0;else{if(n=ia.deflate(i,s),n===ma)return i.next_out>0&&this.onData(i.output.subarray(0,i.next_out)),n=ia.deflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===ga;if(0!==i.avail_out){if(s>0&&i.next_out>0)this.onData(i.output.subarray(0,i.next_out)),i.avail_out=0;else if(0===i.avail_in)break}else this.onData(i.output)}return!0},ba.prototype.onData=function(t){this.chunks.push(t)},ba.prototype.onEnd=function(t){t===ga&&(this.result=na.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};var va={Deflate:ba,deflate:ya,deflateRaw:function(t,e){return(e=e||{}).raw=!0,ya(t,e)},gzip:function(t,e){return(e=e||{}).gzip=!0,ya(t,e)},constants:no};const xa=16209;var Ma=function(t,e){let i,r,n,s,o,a,h,l,u,c,d,f,g,m,p,w,_,b,y,v,x,M,k,E;const C=t.state;i=t.next_in,k=t.input,r=i+(t.avail_in-5),n=t.next_out,E=t.output,s=n-(e-t.avail_out),o=n+(t.avail_out-257),a=C.dmax,h=C.wsize,l=C.whave,u=C.wnext,c=C.window,d=C.hold,f=C.bits,g=C.lencode,m=C.distcode,p=(1<<C.lenbits)-1,w=(1<<C.distbits)-1;t:do{f<15&&(d+=k[i++]<<f,f+=8,d+=k[i++]<<f,f+=8),_=g[d&p];e:for(;;){if(b=_>>>24,d>>>=b,f-=b,b=_>>>16&255,0===b)E[n++]=65535&_;else{if(!(16&b)){if(0==(64&b)){_=g[(65535&_)+(d&(1<<b)-1)];continue e}if(32&b){C.mode=16191;break t}t.msg="invalid literal/length code",C.mode=xa;break t}y=65535&_,b&=15,b&&(f<b&&(d+=k[i++]<<f,f+=8),y+=d&(1<<b)-1,d>>>=b,f-=b),f<15&&(d+=k[i++]<<f,f+=8,d+=k[i++]<<f,f+=8),_=m[d&w];i:for(;;){if(b=_>>>24,d>>>=b,f-=b,b=_>>>16&255,!(16&b)){if(0==(64&b)){_=m[(65535&_)+(d&(1<<b)-1)];continue i}t.msg="invalid distance code",C.mode=xa;break t}if(v=65535&_,b&=15,f<b&&(d+=k[i++]<<f,f+=8,f<b&&(d+=k[i++]<<f,f+=8)),v+=d&(1<<b)-1,v>a){t.msg="invalid distance too far back",C.mode=xa;break t}if(d>>>=b,f-=b,b=n-s,v>b){if(b=v-b,b>l&&C.sane){t.msg="invalid distance too far back",C.mode=xa;break t}if(x=0,M=c,0===u){if(x+=h-b,b<y){y-=b;do{E[n++]=c[x++]}while(--b);x=n-v,M=E}}else if(u<b){if(x+=h+u-b,b-=u,b<y){y-=b;do{E[n++]=c[x++]}while(--b);if(x=0,u<y){b=u,y-=b;do{E[n++]=c[x++]}while(--b);x=n-v,M=E}}}else if(x+=u-b,b<y){y-=b;do{E[n++]=c[x++]}while(--b);x=n-v,M=E}for(;y>2;)E[n++]=M[x++],E[n++]=M[x++],E[n++]=M[x++],y-=3;y&&(E[n++]=M[x++],y>1&&(E[n++]=M[x++]))}else{x=n-v;do{E[n++]=E[x++],E[n++]=E[x++],E[n++]=E[x++],y-=3}while(y>2);y&&(E[n++]=E[x++],y>1&&(E[n++]=E[x++]))}break}}break}}while(i<r&&n<o);y=f>>3,i-=y,f-=y<<3,d&=(1<<f)-1,t.next_in=i,t.next_out=n,t.avail_in=i<r?r-i+5:5-(i-r),t.avail_out=n<o?o-n+257:257-(n-o),C.hold=d,C.bits=f};const ka=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),Ea=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),Ca=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),Sa=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var Aa=(t,e,i,r,n,s,o,a)=>{const h=a.bits;let l,u,c,d,f,g,m=0,p=0,w=0,_=0,b=0,y=0,v=0,x=0,M=0,k=0,E=null;const C=new Uint16Array(16),S=new Uint16Array(16);let A,T,R,P=null;for(m=0;m<=15;m++)C[m]=0;for(p=0;p<r;p++)C[e[i+p]]++;for(b=h,_=15;_>=1&&0===C[_];_--);if(b>_&&(b=_),0===_)return n[s++]=20971520,n[s++]=20971520,a.bits=1,0;for(w=1;w<_&&0===C[w];w++);for(b<w&&(b=w),x=1,m=1;m<=15;m++)if(x<<=1,x-=C[m],x<0)return-1;if(x>0&&(0===t||1!==_))return-1;for(S[1]=0,m=1;m<15;m++)S[m+1]=S[m]+C[m];for(p=0;p<r;p++)0!==e[i+p]&&(o[S[e[i+p]]++]=p);if(0===t?(E=P=o,g=20):1===t?(E=ka,P=Ea,g=257):(E=Ca,P=Sa,g=0),k=0,p=0,m=w,f=s,y=b,v=0,c=-1,M=1<<b,d=M-1,1===t&&M>852||2===t&&M>592)return 1;for(;;){A=m-v,o[p]+1<g?(T=0,R=o[p]):o[p]>=g?(T=P[o[p]-g],R=E[o[p]-g]):(T=96,R=0),l=1<<m-v,u=1<<y,w=u;do{u-=l,n[f+(k>>v)+u]=A<<24|T<<16|R|0}while(0!==u);for(l=1<<m-1;k&l;)l>>=1;if(0!==l?(k&=l-1,k+=l):k=0,p++,0==--C[m]){if(m===_)break;m=e[i+o[p]]}if(m>b&&(k&d)!==c){for(0===v&&(v=b),f+=w,y=m-v,x=1<<y;y+v<_&&(x-=C[y+v],!(x<=0));)y++,x<<=1;if(M+=1<<y,1===t&&M>852||2===t&&M>592)return 1;c=k&d,n[c]=b<<24|y<<16|f-s|0}}return 0!==k&&(n[f+k]=m-v<<24|64<<16|0),a.bits=b,0};const{Z_FINISH:Ta,Z_BLOCK:Ra,Z_TREES:Pa,Z_OK:Ia,Z_STREAM_END:Da,Z_NEED_DICT:La,Z_STREAM_ERROR:Fa,Z_DATA_ERROR:za,Z_MEM_ERROR:Ba,Z_BUF_ERROR:Na,Z_DEFLATED:Oa}=no,Ua=16180,Va=16190,Ya=16191,Xa=16192,ja=16194,Ga=16199,qa=16200,Za=16206,Ka=16209,Ha=t=>(t>>>24&255)+(t>>>8&65280)+((65280&t)<<8)+((255&t)<<24);function Wa(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const $a=t=>{if(!t)return 1;const e=t.state;return!e||e.strm!==t||e.mode<Ua||e.mode>16211?1:0},Qa=t=>{if($a(t))return Fa;const e=t.state;return t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=1&e.wrap),e.mode=Ua,e.last=0,e.havedict=0,e.flags=-1,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(852),e.distcode=e.distdyn=new Int32Array(592),e.sane=1,e.back=-1,Ia},Ja=t=>{if($a(t))return Fa;const e=t.state;return e.wsize=0,e.whave=0,e.wnext=0,Qa(t)},th=(t,e)=>{let i;if($a(t))return Fa;const r=t.state;return e<0?(i=0,e=-e):(i=5+(e>>4),e<48&&(e&=15)),e&&(e<8||e>15)?Fa:(null!==r.window&&r.wbits!==e&&(r.window=null),r.wrap=i,r.wbits=e,Ja(t))},eh=(t,e)=>{if(!t)return Fa;const i=new Wa;t.state=i,i.strm=t,i.window=null,i.mode=Ua;const r=th(t,e);return r!==Ia&&(t.state=null),r};let ih,rh,nh=!0;const sh=t=>{if(nh){ih=new Int32Array(512),rh=new Int32Array(32);let e=0;for(;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(Aa(1,t.lens,0,288,ih,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;Aa(2,t.lens,0,32,rh,0,t.work,{bits:5}),nh=!1}t.lencode=ih,t.lenbits=9,t.distcode=rh,t.distbits=5},oh=(t,e,i,r)=>{let n;const s=t.state;return null===s.window&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new Uint8Array(s.wsize)),r>=s.wsize?(s.window.set(e.subarray(i-s.wsize,i),0),s.wnext=0,s.whave=s.wsize):(n=s.wsize-s.wnext,n>r&&(n=r),s.window.set(e.subarray(i-r,i-r+n),s.wnext),(r-=n)?(s.window.set(e.subarray(i-r,i),0),s.wnext=r,s.whave=s.wsize):(s.wnext+=n,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=n))),0};var ah={inflateReset:Ja,inflateReset2:th,inflateResetKeep:Qa,inflateInit:t=>eh(t,15),inflateInit2:eh,inflate:(t,e)=>{let i,r,n,s,o,a,h,l,u,c,d,f,g,m,p,w,_,b,y,v,x,M,k=0;const E=new Uint8Array(4);let C,S;const A=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if($a(t)||!t.output||!t.input&&0!==t.avail_in)return Fa;i=t.state,i.mode===Ya&&(i.mode=Xa),o=t.next_out,n=t.output,h=t.avail_out,s=t.next_in,r=t.input,a=t.avail_in,l=i.hold,u=i.bits,c=a,d=h,M=Ia;t:for(;;)switch(i.mode){case Ua:if(0===i.wrap){i.mode=Xa;break}for(;u<16;){if(0===a)break t;a--,l+=r[s++]<<u,u+=8}if(2&i.wrap&&35615===l){0===i.wbits&&(i.wbits=15),i.check=0,E[0]=255&l,E[1]=l>>>8&255,i.check=io(i.check,E,2,0),l=0,u=0,i.mode=16181;break}if(i.head&&(i.head.done=!1),!(1&i.wrap)||(((255&l)<<8)+(l>>8))%31){t.msg="incorrect header check",i.mode=Ka;break}if((15&l)!==Oa){t.msg="unknown compression method",i.mode=Ka;break}if(l>>>=4,u-=4,x=8+(15&l),0===i.wbits&&(i.wbits=x),x>15||x>i.wbits){t.msg="invalid window size",i.mode=Ka;break}i.dmax=1<<i.wbits,i.flags=0,t.adler=i.check=1,i.mode=512&l?16189:Ya,l=0,u=0;break;case 16181:for(;u<16;){if(0===a)break t;a--,l+=r[s++]<<u,u+=8}if(i.flags=l,(255&i.flags)!==Oa){t.msg="unknown compression method",i.mode=Ka;break}if(57344&i.flags){t.msg="unknown header flags set",i.mode=Ka;break}i.head&&(i.head.text=l>>8&1),512&i.flags&&4&i.wrap&&(E[0]=255&l,E[1]=l>>>8&255,i.check=io(i.check,E,2,0)),l=0,u=0,i.mode=16182;case 16182:for(;u<32;){if(0===a)break t;a--,l+=r[s++]<<u,u+=8}i.head&&(i.head.time=l),512&i.flags&&4&i.wrap&&(E[0]=255&l,E[1]=l>>>8&255,E[2]=l>>>16&255,E[3]=l>>>24&255,i.check=io(i.check,E,4,0)),l=0,u=0,i.mode=16183;case 16183:for(;u<16;){if(0===a)break t;a--,l+=r[s++]<<u,u+=8}i.head&&(i.head.xflags=255&l,i.head.os=l>>8),512&i.flags&&4&i.wrap&&(E[0]=255&l,E[1]=l>>>8&255,i.check=io(i.check,E,2,0)),l=0,u=0,i.mode=16184;case 16184:if(1024&i.flags){for(;u<16;){if(0===a)break t;a--,l+=r[s++]<<u,u+=8}i.length=l,i.head&&(i.head.extra_len=l),512&i.flags&&4&i.wrap&&(E[0]=255&l,E[1]=l>>>8&255,i.check=io(i.check,E,2,0)),l=0,u=0}else i.head&&(i.head.extra=null);i.mode=16185;case 16185:if(1024&i.flags&&(f=i.length,f>a&&(f=a),f&&(i.head&&(x=i.head.extra_len-i.length,i.head.extra||(i.head.extra=new Uint8Array(i.head.extra_len)),i.head.extra.set(r.subarray(s,s+f),x)),512&i.flags&&4&i.wrap&&(i.check=io(i.check,r,f,s)),a-=f,s+=f,i.length-=f),i.length))break t;i.length=0,i.mode=16186;case 16186:if(2048&i.flags){if(0===a)break t;f=0;do{x=r[s+f++],i.head&&x&&i.length<65536&&(i.head.name+=String.fromCharCode(x))}while(x&&f<a);if(512&i.flags&&4&i.wrap&&(i.check=io(i.check,r,f,s)),a-=f,s+=f,x)break t}else i.head&&(i.head.name=null);i.length=0,i.mode=16187;case 16187:if(4096&i.flags){if(0===a)break t;f=0;do{x=r[s+f++],i.head&&x&&i.length<65536&&(i.head.comment+=String.fromCharCode(x))}while(x&&f<a);if(512&i.flags&&4&i.wrap&&(i.check=io(i.check,r,f,s)),a-=f,s+=f,x)break t}else i.head&&(i.head.comment=null);i.mode=16188;case 16188:if(512&i.flags){for(;u<16;){if(0===a)break t;a--,l+=r[s++]<<u,u+=8}if(4&i.wrap&&l!==(65535&i.check)){t.msg="header crc mismatch",i.mode=Ka;break}l=0,u=0}i.head&&(i.head.hcrc=i.flags>>9&1,i.head.done=!0),t.adler=i.check=0,i.mode=Ya;break;case 16189:for(;u<32;){if(0===a)break t;a--,l+=r[s++]<<u,u+=8}t.adler=i.check=Ha(l),l=0,u=0,i.mode=Va;case Va:if(0===i.havedict)return t.next_out=o,t.avail_out=h,t.next_in=s,t.avail_in=a,i.hold=l,i.bits=u,La;t.adler=i.check=1,i.mode=Ya;case Ya:if(e===Ra||e===Pa)break t;case Xa:if(i.last){l>>>=7&u,u-=7&u,i.mode=Za;break}for(;u<3;){if(0===a)break t;a--,l+=r[s++]<<u,u+=8}switch(i.last=1&l,l>>>=1,u-=1,3&l){case 0:i.mode=16193;break;case 1:if(sh(i),i.mode=Ga,e===Pa){l>>>=2,u-=2;break t}break;case 2:i.mode=16196;break;case 3:t.msg="invalid block type",i.mode=Ka}l>>>=2,u-=2;break;case 16193:for(l>>>=7&u,u-=7&u;u<32;){if(0===a)break t;a--,l+=r[s++]<<u,u+=8}if((65535&l)!=(l>>>16^65535)){t.msg="invalid stored block lengths",i.mode=Ka;break}if(i.length=65535&l,l=0,u=0,i.mode=ja,e===Pa)break t;case ja:i.mode=16195;case 16195:if(f=i.length,f){if(f>a&&(f=a),f>h&&(f=h),0===f)break t;n.set(r.subarray(s,s+f),o),a-=f,s+=f,h-=f,o+=f,i.length-=f;break}i.mode=Ya;break;case 16196:for(;u<14;){if(0===a)break t;a--,l+=r[s++]<<u,u+=8}if(i.nlen=257+(31&l),l>>>=5,u-=5,i.ndist=1+(31&l),l>>>=5,u-=5,i.ncode=4+(15&l),l>>>=4,u-=4,i.nlen>286||i.ndist>30){t.msg="too many length or distance symbols",i.mode=Ka;break}i.have=0,i.mode=16197;case 16197:for(;i.have<i.ncode;){for(;u<3;){if(0===a)break t;a--,l+=r[s++]<<u,u+=8}i.lens[A[i.have++]]=7&l,l>>>=3,u-=3}for(;i.have<19;)i.lens[A[i.have++]]=0;if(i.lencode=i.lendyn,i.lenbits=7,C={bits:i.lenbits},M=Aa(0,i.lens,0,19,i.lencode,0,i.work,C),i.lenbits=C.bits,M){t.msg="invalid code lengths set",i.mode=Ka;break}i.have=0,i.mode=16198;case 16198:for(;i.have<i.nlen+i.ndist;){for(;k=i.lencode[l&(1<<i.lenbits)-1],p=k>>>24,w=k>>>16&255,_=65535&k,!(p<=u);){if(0===a)break t;a--,l+=r[s++]<<u,u+=8}if(_<16)l>>>=p,u-=p,i.lens[i.have++]=_;else{if(16===_){for(S=p+2;u<S;){if(0===a)break t;a--,l+=r[s++]<<u,u+=8}if(l>>>=p,u-=p,0===i.have){t.msg="invalid bit length repeat",i.mode=Ka;break}x=i.lens[i.have-1],f=3+(3&l),l>>>=2,u-=2}else if(17===_){for(S=p+3;u<S;){if(0===a)break t;a--,l+=r[s++]<<u,u+=8}l>>>=p,u-=p,x=0,f=3+(7&l),l>>>=3,u-=3}else{for(S=p+7;u<S;){if(0===a)break t;a--,l+=r[s++]<<u,u+=8}l>>>=p,u-=p,x=0,f=11+(127&l),l>>>=7,u-=7}if(i.have+f>i.nlen+i.ndist){t.msg="invalid bit length repeat",i.mode=Ka;break}for(;f--;)i.lens[i.have++]=x}}if(i.mode===Ka)break;if(0===i.lens[256]){t.msg="invalid code -- missing end-of-block",i.mode=Ka;break}if(i.lenbits=9,C={bits:i.lenbits},M=Aa(1,i.lens,0,i.nlen,i.lencode,0,i.work,C),i.lenbits=C.bits,M){t.msg="invalid literal/lengths set",i.mode=Ka;break}if(i.distbits=6,i.distcode=i.distdyn,C={bits:i.distbits},M=Aa(2,i.lens,i.nlen,i.ndist,i.distcode,0,i.work,C),i.distbits=C.bits,M){t.msg="invalid distances set",i.mode=Ka;break}if(i.mode=Ga,e===Pa)break t;case Ga:i.mode=qa;case qa:if(a>=6&&h>=258){t.next_out=o,t.avail_out=h,t.next_in=s,t.avail_in=a,i.hold=l,i.bits=u,Ma(t,d),o=t.next_out,n=t.output,h=t.avail_out,s=t.next_in,r=t.input,a=t.avail_in,l=i.hold,u=i.bits,i.mode===Ya&&(i.back=-1);break}for(i.back=0;k=i.lencode[l&(1<<i.lenbits)-1],p=k>>>24,w=k>>>16&255,_=65535&k,!(p<=u);){if(0===a)break t;a--,l+=r[s++]<<u,u+=8}if(w&&0==(240&w)){for(b=p,y=w,v=_;k=i.lencode[v+((l&(1<<b+y)-1)>>b)],p=k>>>24,w=k>>>16&255,_=65535&k,!(b+p<=u);){if(0===a)break t;a--,l+=r[s++]<<u,u+=8}l>>>=b,u-=b,i.back+=b}if(l>>>=p,u-=p,i.back+=p,i.length=_,0===w){i.mode=16205;break}if(32&w){i.back=-1,i.mode=Ya;break}if(64&w){t.msg="invalid literal/length code",i.mode=Ka;break}i.extra=15&w,i.mode=16201;case 16201:if(i.extra){for(S=i.extra;u<S;){if(0===a)break t;a--,l+=r[s++]<<u,u+=8}i.length+=l&(1<<i.extra)-1,l>>>=i.extra,u-=i.extra,i.back+=i.extra}i.was=i.length,i.mode=16202;case 16202:for(;k=i.distcode[l&(1<<i.distbits)-1],p=k>>>24,w=k>>>16&255,_=65535&k,!(p<=u);){if(0===a)break t;a--,l+=r[s++]<<u,u+=8}if(0==(240&w)){for(b=p,y=w,v=_;k=i.distcode[v+((l&(1<<b+y)-1)>>b)],p=k>>>24,w=k>>>16&255,_=65535&k,!(b+p<=u);){if(0===a)break t;a--,l+=r[s++]<<u,u+=8}l>>>=b,u-=b,i.back+=b}if(l>>>=p,u-=p,i.back+=p,64&w){t.msg="invalid distance code",i.mode=Ka;break}i.offset=_,i.extra=15&w,i.mode=16203;case 16203:if(i.extra){for(S=i.extra;u<S;){if(0===a)break t;a--,l+=r[s++]<<u,u+=8}i.offset+=l&(1<<i.extra)-1,l>>>=i.extra,u-=i.extra,i.back+=i.extra}if(i.offset>i.dmax){t.msg="invalid distance too far back",i.mode=Ka;break}i.mode=16204;case 16204:if(0===h)break t;if(f=d-h,i.offset>f){if(f=i.offset-f,f>i.whave&&i.sane){t.msg="invalid distance too far back",i.mode=Ka;break}f>i.wnext?(f-=i.wnext,g=i.wsize-f):g=i.wnext-f,f>i.length&&(f=i.length),m=i.window}else m=n,g=o-i.offset,f=i.length;f>h&&(f=h),h-=f,i.length-=f;do{n[o++]=m[g++]}while(--f);0===i.length&&(i.mode=qa);break;case 16205:if(0===h)break t;n[o++]=i.length,h--,i.mode=qa;break;case Za:if(i.wrap){for(;u<32;){if(0===a)break t;a--,l|=r[s++]<<u,u+=8}if(d-=h,t.total_out+=d,i.total+=d,4&i.wrap&&d&&(t.adler=i.check=i.flags?io(i.check,n,d,o-d):to(i.check,n,d,o-d)),d=h,4&i.wrap&&(i.flags?l:Ha(l))!==i.check){t.msg="incorrect data check",i.mode=Ka;break}l=0,u=0}i.mode=16207;case 16207:if(i.wrap&&i.flags){for(;u<32;){if(0===a)break t;a--,l+=r[s++]<<u,u+=8}if(4&i.wrap&&l!==(4294967295&i.total)){t.msg="incorrect length check",i.mode=Ka;break}l=0,u=0}i.mode=16208;case 16208:M=Da;break t;case Ka:M=za;break t;case 16210:return Ba;default:return Fa}return t.next_out=o,t.avail_out=h,t.next_in=s,t.avail_in=a,i.hold=l,i.bits=u,(i.wsize||d!==t.avail_out&&i.mode<Ka&&(i.mode<Za||e!==Ta))&&oh(t,t.output,t.next_out,d-t.avail_out),c-=t.avail_in,d-=t.avail_out,t.total_in+=c,t.total_out+=d,i.total+=d,4&i.wrap&&d&&(t.adler=i.check=i.flags?io(i.check,n,d,t.next_out-d):to(i.check,n,d,t.next_out-d)),t.data_type=i.bits+(i.last?64:0)+(i.mode===Ya?128:0)+(i.mode===Ga||i.mode===ja?256:0),(0===c&&0===d||e===Ta)&&M===Ia&&(M=Na),M},inflateEnd:t=>{if($a(t))return Fa;let e=t.state;return e.window&&(e.window=null),t.state=null,Ia},inflateGetHeader:(t,e)=>{if($a(t))return Fa;const i=t.state;return 0==(2&i.wrap)?Fa:(i.head=e,e.done=!1,Ia)},inflateSetDictionary:(t,e)=>{const i=e.length;let r,n,s;return $a(t)?Fa:(r=t.state,0!==r.wrap&&r.mode!==Va?Fa:r.mode===Va&&(n=1,n=to(n,e,i,0),n!==r.check)?za:(s=oh(t,e,i,i),s?(r.mode=16210,Ba):(r.havedict=1,Ia)))},inflateInfo:"pako inflate (from Nodeca project)"},hh=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};const lh=Object.prototype.toString,{Z_NO_FLUSH:uh,Z_FINISH:ch,Z_OK:dh,Z_STREAM_END:fh,Z_NEED_DICT:gh,Z_STREAM_ERROR:mh,Z_DATA_ERROR:ph,Z_MEM_ERROR:wh}=no;function _h(t){this.options=na.assign({chunkSize:65536,windowBits:15,to:""},t||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,0===e.windowBits&&(e.windowBits=-15)),!(e.windowBits>=0&&e.windowBits<16)||t&&t.windowBits||(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&0==(15&e.windowBits)&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new ha,this.strm.avail_out=0;let i=ah.inflateInit2(this.strm,e.windowBits);if(i!==dh)throw new Error(ro[i]);if(this.header=new hh,ah.inflateGetHeader(this.strm,this.header),e.dictionary&&("string"==typeof e.dictionary?e.dictionary=aa.string2buf(e.dictionary):"[object ArrayBuffer]"===lh.call(e.dictionary)&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(i=ah.inflateSetDictionary(this.strm,e.dictionary),i!==dh)))throw new Error(ro[i])}function bh(t,e){const i=new _h(e);if(i.push(t),i.err)throw i.msg||ro[i.err];return i.result}_h.prototype.push=function(t,e){const i=this.strm,r=this.options.chunkSize,n=this.options.dictionary;let s,o,a;if(this.ended)return!1;for(o=e===~~e?e:!0===e?ch:uh,"[object ArrayBuffer]"===lh.call(t)?i.input=new Uint8Array(t):i.input=t,i.next_in=0,i.avail_in=i.input.length;;){for(0===i.avail_out&&(i.output=new Uint8Array(r),i.next_out=0,i.avail_out=r),s=ah.inflate(i,o),s===gh&&n&&(s=ah.inflateSetDictionary(i,n),s===dh?s=ah.inflate(i,o):s===ph&&(s=gh));i.avail_in>0&&s===fh&&i.state.wrap>0&&0!==t[i.next_in];)ah.inflateReset(i),s=ah.inflate(i,o);switch(s){case mh:case ph:case gh:case wh:return this.onEnd(s),this.ended=!0,!1}if(a=i.avail_out,i.next_out&&(0===i.avail_out||s===fh))if("string"===this.options.to){let t=aa.utf8border(i.output,i.next_out),e=i.next_out-t,n=aa.buf2string(i.output,t);i.next_out=e,i.avail_out=r-e,e&&i.output.set(i.output.subarray(t,t+e),0),this.onData(n)}else this.onData(i.output.length===i.next_out?i.output:i.output.subarray(0,i.next_out));if(s!==dh||0!==a){if(s===fh)return s=ah.inflateEnd(this.strm),this.onEnd(s),this.ended=!0,!0;if(0===i.avail_in)break}}return!0},_h.prototype.onData=function(t){this.chunks.push(t)},_h.prototype.onEnd=function(t){t===dh&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=na.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};var yh={Inflate:_h,inflate:bh,inflateRaw:function(t,e){return(e=e||{}).raw=!0,bh(t,e)},ungzip:bh,constants:no};const{Deflate:vh,deflate:xh,deflateRaw:Mh,gzip:kh}=va,{Inflate:Eh,inflate:Ch,inflateRaw:Sh,ungzip:Ah}=yh;var Th=xh,Rh=Eh,Ph=Ch;const Ih=[137,80,78,71,13,10,26,10],Dh=[];for(let t=0;t<256;t++){let e=t;for(let t=0;t<8;t++)1&e?e=3988292384^e>>>1:e>>>=1;Dh[t]=e}const Lh=4294967295;function Fh(t,e){return(function(t,e,i){let r=4294967295;for(let t=0;t<i;t++)r=Dh[255&(r^e[t])]^r>>>8;return r}(0,t,e)^Lh)>>>0}var zh,Bh,Nh,Oh;!function(t){t[t.UNKNOWN=-1]="UNKNOWN",t[t.GREYSCALE=0]="GREYSCALE",t[t.TRUECOLOUR=2]="TRUECOLOUR",t[t.INDEXED_COLOUR=3]="INDEXED_COLOUR",t[t.GREYSCALE_ALPHA=4]="GREYSCALE_ALPHA",t[t.TRUECOLOUR_ALPHA=6]="TRUECOLOUR_ALPHA"}(zh||(zh={})),function(t){t[t.UNKNOWN=-1]="UNKNOWN",t[t.DEFLATE=0]="DEFLATE"}(Bh||(Bh={})),function(t){t[t.UNKNOWN=-1]="UNKNOWN",t[t.ADAPTIVE=0]="ADAPTIVE"}(Nh||(Nh={})),function(t){t[t.UNKNOWN=-1]="UNKNOWN",t[t.NO_INTERLACE=0]="NO_INTERLACE",t[t.ADAM7=1]="ADAM7"}(Oh||(Oh={}));const Uh=new Uint8Array(0),Vh=new Uint16Array([255]),Yh=255===new Uint8Array(Vh.buffer)[0];class Xh extends ys.IOBuffer{constructor(t,e={}){super(t);const{checkCrc:i=!1}=e;this._checkCrc=i,this._inflator=new Rh,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=Bh.UNKNOWN,this._filterMethod=Nh.UNKNOWN,this._interlaceMethod=Oh.UNKNOWN,this._colorType=zh.UNKNOWN,this.setBigEndian()}decode(){for(this.decodeSignature();!this._end;)this.decodeChunk();return this.decodeImage(),this._png}decodeSignature(){for(let t=0;t<Ih.length;t++)if(this.readUint8()!==Ih[t])throw new Error(`wrong PNG signature. Byte at ${t} should be ${Ih[t]}.`)}decodeChunk(){const t=this.readUint32(),e=this.readChars(4),i=this.offset;switch(e){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(t);break;case"IDAT":this.decodeIDAT(t);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(t);break;case"iCCP":this.decodeiCCP(t);break;case"tEXt":this.decodetEXt(t);break;case"pHYs":this.decodepHYs();break;default:this.skip(t)}if(this.offset-i!==t)throw new Error(`Length mismatch while decoding chunk ${e}`);if(this._checkCrc){const i=this.readUint32(),r=t+4,n=Fh(new Uint8Array(this.buffer,this.byteOffset+this.offset-r-4,r),r);if(n!==i)throw new Error(`CRC mismatch for chunk ${e}. Expected ${i}, found ${n}`)}else this.skip(4)}decodeIHDR(){const t=this._png;t.width=this.readUint32(),t.height=this.readUint32(),t.depth=function(t){if(1!==t&&2!==t&&4!==t&&8!==t&&16!==t)throw new Error(`invalid bit depth: ${t}`);return t}(this.readUint8());const e=this.readUint8();let i;switch(this._colorType=e,e){case zh.GREYSCALE:i=1;break;case zh.TRUECOLOUR:i=3;break;case zh.INDEXED_COLOUR:i=1;break;case zh.GREYSCALE_ALPHA:i=2;break;case zh.TRUECOLOUR_ALPHA:i=4;break;default:throw new Error(`Unknown color type: ${e}`)}if(this._png.channels=i,this._compressionMethod=this.readUint8(),this._compressionMethod!==Bh.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodePLTE(t){if(t%3!=0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${t}`);const e=t/3;this._hasPalette=!0;const i=[];this._palette=i;for(let t=0;t<e;t++)i.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(t){this._inflator.push(new Uint8Array(this.buffer,this.offset+this.byteOffset,t)),this.skip(t)}decodetRNS(t){switch(this._colorType){case zh.GREYSCALE:case zh.TRUECOLOUR:if(t%2!=0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${t}`);if(t/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${t/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(t/2);for(let e=0;e<t/2;e++)this._transparency[e]=this.readUint16();break;case zh.INDEXED_COLOUR:{if(t>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${t} vs ${this._palette.length})`);let e=0;for(;e<t;e++){const t=this.readByte();this._palette[e].push(t)}for(;e<this._palette.length;e++)this._palette[e].push(255);break}default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(t){let e,i="";for(;"\0"!==(e=this.readChar());)i+=e;const r=this.readUint8();if(r!==Bh.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${r}`);const n=this.readBytes(t-i.length-2);this._png.iccEmbeddedProfile={name:i,profile:Ph(n)}}decodetEXt(t){let e,i="";for(;"\0"!==(e=this.readChar());)i+=e;this._png.text[i]=this.readChars(t-i.length-1)}decodepHYs(){const t=this.readUint32(),e=this.readUint32(),i=this.readByte();this._png.resolution={x:t,y:e,unit:i}}decodeImage(){if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const t=this._inflator.result;if(this._filterMethod!==Nh.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod!==Oh.NO_INTERLACE)throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this.decodeInterlaceNull(t)}decodeInterlaceNull(t){const e=this._png.height,i=this._png.channels*this._png.depth/8,r=this._png.width*i,n=new Uint8Array(this._png.height*r);let s,o,a=Uh,h=0;for(let l=0;l<e;l++){switch(s=t.subarray(h+1,h+1+r),o=n.subarray(l*r,(l+1)*r),t[h]){case 0:jh(s,o,r);break;case 1:Gh(s,o,r,i);break;case 2:qh(s,o,a,r);break;case 3:Zh(s,o,a,r,i);break;case 4:Kh(s,o,a,r,i);break;default:throw new Error(`Unsupported filter: ${t[h]}`)}a=o,h+=r+1}if(this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency),16===this._png.depth){const t=new Uint16Array(n.buffer);if(Yh)for(let e=0;e<t.length;e++)t[e]=(255&(l=t[e]))<<8|l>>8&255;this._png.data=t}else this._png.data=n;var l}}function jh(t,e,i){for(let r=0;r<i;r++)e[r]=t[r]}function Gh(t,e,i,r){let n=0;for(;n<r;n++)e[n]=t[n];for(;n<i;n++)e[n]=t[n]+e[n-r]&255}function qh(t,e,i,r){let n=0;if(0===i.length)for(;n<r;n++)e[n]=t[n];else for(;n<r;n++)e[n]=t[n]+i[n]&255}function Zh(t,e,i,r,n){let s=0;if(0===i.length){for(;s<n;s++)e[s]=t[s];for(;s<r;s++)e[s]=t[s]+(e[s-n]>>1)&255}else{for(;s<n;s++)e[s]=t[s]+(i[s]>>1)&255;for(;s<r;s++)e[s]=t[s]+(e[s-n]+i[s]>>1)&255}}function Kh(t,e,i,r,n){let s=0;if(0===i.length){for(;s<n;s++)e[s]=t[s];for(;s<r;s++)e[s]=t[s]+e[s-n]&255}else{for(;s<n;s++)e[s]=t[s]+i[s]&255;for(;s<r;s++)e[s]=t[s]+Hh(e[s-n],i[s],i[s-n])&255}}function Hh(t,e,i){const r=t+e-i,n=Math.abs(r-t),s=Math.abs(r-e),o=Math.abs(r-i);return n<=s&&n<=o?t:s<=o?e:i}const Wh={level:3};class $h extends ys.IOBuffer{constructor(t,e={}){super(),this._colorType=zh.UNKNOWN,this._zlibOptions={...Wh,...e.zlib},this._png=this._checkData(t),this.setBigEndian()}encode(){return this.encodeSignature(),this.encodeIHDR(),this.encodeData(),this.encodeIEND(),this.toArray()}encodeSignature(){this.writeBytes(Ih)}encodeIHDR(){this.writeUint32(13),this.writeChars("IHDR"),this.writeUint32(this._png.width),this.writeUint32(this._png.height),this.writeByte(this._png.depth),this.writeByte(this._colorType),this.writeByte(Bh.DEFLATE),this.writeByte(Nh.ADAPTIVE),this.writeByte(Oh.NO_INTERLACE),this.writeCrc(17)}encodeIEND(){this.writeUint32(0),this.writeChars("IEND"),this.writeCrc(4)}encodeIDAT(t){this.writeUint32(t.length),this.writeChars("IDAT"),this.writeBytes(t),this.writeCrc(t.length+4)}encodeData(){const{width:t,height:e,channels:i,depth:r,data:n}=this._png,s=i*t,o=(new ys.IOBuffer).setBigEndian();let a=0;for(let t=0;t<e;t++)if(o.writeByte(0),8===r)a=Jh(n,o,s,a);else{if(16!==r)throw new Error("unreachable");a=tl(n,o,s,a)}const h=o.toArray(),l=Th(h,this._zlibOptions);this.encodeIDAT(l)}_checkData(t){const{colorType:e,channels:i,depth:r}=function(t){const{channels:e=4,depth:i=8}=t;if(4!==e&&3!==e&&2!==e&&1!==e)throw new RangeError(`unsupported number of channels: ${e}`);if(8!==i&&16!==i)throw new RangeError(`unsupported bit depth: ${i}`);const r={channels:e,depth:i,colorType:zh.UNKNOWN};switch(e){case 4:r.colorType=zh.TRUECOLOUR_ALPHA;break;case 3:r.colorType=zh.TRUECOLOUR;break;case 1:r.colorType=zh.GREYSCALE;break;case 2:r.colorType=zh.GREYSCALE_ALPHA;break;default:throw new Error("unsupported number of channels")}return r}(t),n={width:Qh(t.width,"width"),height:Qh(t.height,"height"),channels:i,data:t.data,depth:r,text:{}};this._colorType=e;const s=n.width*n.height*i;if(n.data.length!==s)throw new RangeError(`wrong data size. Found ${n.data.length}, expected ${s}`);return n}writeCrc(t){this.writeUint32(Fh(new Uint8Array(this.buffer,this.byteOffset+this.offset-t,t),t))}}function Qh(t,e){if(Number.isInteger(t)&&t>0)return t;throw new TypeError(`${e} must be a positive integer`)}function Jh(t,e,i,r){for(let n=0;n<i;n++)e.writeByte(t[r++]);return r}function tl(t,e,i,r){for(let n=0;n<i;n++)e.writeUint16(t[r++]);return r}var el;!function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.METRE=1]="METRE"}(el||(el={}));var il=__webpack_require__(7870);let rl="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",nl=new Uint8Array(256);for(let t=0;t<rl.length;t++)nl[rl.charCodeAt(t)]=t;function sl(t,e){return`data:${e};base64,${function(t){let e,i=t.length,r="";for(e=0;e<i;e+=3)r+=rl[t[e]>>2],r+=rl[(3&t[e])<<4|t[e+1]>>4],r+=rl[(15&t[e+1])<<2|t[e+2]>>6],r+=rl[63&t[e+2]];return i%3==2?r=`${r.substring(0,r.length-1)}=`:i%3==1&&(r=`${r.substring(0,r.length-2)}==`),r}(t)}`}const ol=self.ImageData,al=self.Image;function hl(t,e){let i=self.document.createElement("canvas");return i.width=t,i.height=e,i}function ll(t,e={}){const i={width:t.width,height:t.height,data:t.getRGBAData()};return(0,il.encode)(i,e.quality).data}function ul(t,e){const i={width:t.width,height:t.height,channels:t.channels,depth:t.bitDepth,data:t.data};return 1!==i.depth&&32!==i.depth||(i.depth=8,i.channels=4,i.data=t.getRGBAData()),function(t,e){return new $h(t,e).encode()}(i,e)}const cl={save(t,e={}){const{useCanvas:i=!1,encoder:r}=e;let{format:n}=e;if(!n){const e=/\.(?<format>[a-zA-Z]+)$/.exec(t);e&&(n=e.groups.format.toLowerCase())}if(!n)throw new Error("file format not provided");return new Promise(((t,e)=>{let s,o;switch(n.toLowerCase()){case"png":i?s=this.getCanvas().pngStream():o=ul(this,r);break;case"jpg":case"jpeg":i?s=this.getCanvas().jpegStream():o=ll(this,r);break;case"bmp":o=(0,bs.c)(this,r);break;default:throw new RangeError(`invalid output format: ${n}`)}if(s){let i=function(){throw new Error("createWriteStream does not exist in the browser")}();i.on("finish",t),i.on("error",e),s.pipe(i)}else o&&function(){throw new Error("writeFile does not exist in the browser")}()}))},toDataURL(t="image/png",e={}){"object"==typeof t&&(e=t,t="image/png");const{useCanvas:i=!1,encoder:r}=e;function n(e,i){return sl(e(i,r),t)}return"image/bmp"===(t=function(t){return t.includes("/")||(t=`image/${t}`),t}(t))?n(bs.c,this):"image/png"!==t||i?"image/jpeg"!==t||i?this.getCanvas().toDataURL(t):n(ll,this):n(ul,this)},toBuffer(t={}){const{format:e="png",encoder:i}=t;switch(e.toLowerCase()){case"png":return ul(this,i);case"jpeg":case"jpg":return ll(this,i);case"bmp":return(0,bs.c)(this,i);default:throw new RangeError(`invalid output format: ${e}`)}},toBase64(t="image/png",e={}){if(e.async)return this.toDataURL(t,e).then((function(t){return t.substring(t.indexOf(",")+1)}));{const i=this.toDataURL(t,e);return i.substring(i.indexOf(",")+1)}},toBlob(t="image/png",e=.8){return ws(this.getCanvas(),t,e)},getCanvas(){const t=new ol(this.getRGBAData({clamped:!0}),this.width,this.height);let e=hl(this.width,this.height);return e.getContext("2d").putImageData(t,0,0),e}};var dl=__webpack_require__(2251),fl=__webpack_require__.n(dl);let gl={configurable:!0,enumerable:!1,get:void 0};const ml="GREY",pl="RGB",wl="HSL",_l="HSV",bl="CMYK",yl="BINARY",vl="RGBA",xl={};xl[yl]={components:1,alpha:0,bitDepth:1,colorModel:ml},xl.GREYA={components:1,alpha:1,bitDepth:8,colorModel:ml},xl.GREY={components:1,alpha:0,bitDepth:8,colorModel:ml},xl[vl]={components:3,alpha:1,bitDepth:8,colorModel:pl},xl.RGB={components:3,alpha:0,bitDepth:8,colorModel:pl},xl.CMYK={components:4,alpha:0,bitDepth:8,colorModel:bl},xl.CMYKA={components:4,alpha:1,bitDepth:8,colorModel:bl};const Ml=[1,8,16,32];var kl=__webpack_require__(9464),El=__webpack_require__(9184),Cl=__webpack_require__.n(El);const Sl={33434:"ExposureTime",33437:"FNumber",34850:"ExposureProgram",34852:"SpectralSensitivity",34855:"ISOSpeedRatings",34856:"OECF",34864:"SensitivityType",34865:"StandardOutputSensitivity",34866:"RecommendedExposureIndex",34867:"ISOSpeed",34868:"ISOSpeedLatitudeyyy",34869:"ISOSpeedLatitudezzz",36864:"ExifVersion",36867:"DateTimeOriginal",36868:"DateTimeDigitized",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureBiasValue",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37386:"FocalLength",37396:"SubjectArea",37500:"MakerNote",37510:"UserComment",37520:"SubsecTime",37521:"SubsecTimeOriginal",37522:"SubsecTimeDigitized",40960:"FlashpixVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",40964:"RelatedSoundFile",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41492:"SubjectLocation",41493:"ExposureIndex",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRatio",41989:"FocalLengthIn35mmFilm",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",42016:"ImageUniqueID",42032:"CameraOwnerName",42033:"BodySerialNumber",42034:"LensSpecification",42035:"LensMake",42036:"LensModel",42037:"LensSerialNumber",42240:"Gamma"},Al={};for(let t in Sl)Al[Sl[t]]=Number(t);const Tl={0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential",31:"GPSHPositioningError"},Rl={};for(let t in Tl)Rl[Tl[t]]=Number(t);const Pl={254:"NewSubfileType",255:"SubfileType",256:"ImageWidth",257:"ImageLength",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",263:"Threshholding",264:"CellWidth",265:"CellLength",266:"FillOrder",270:"ImageDescription",271:"Make",272:"Model",273:"StripOffsets",274:"Orientation",277:"SamplesPerPixel",278:"RowsPerStrip",279:"StripByteCounts",280:"MinSampleValue",281:"MaxSampleValue",282:"XResolution",283:"YResolution",284:"PlanarConfiguration",288:"FreeOffsets",289:"FreeByteCounts",290:"GrayResponseUnit",291:"GrayResponseCurve",296:"ResolutionUnit",305:"Software",306:"DateTime",315:"Artist",316:"HostComputer",320:"ColorMap",338:"ExtraSamples",33432:"Copyright",269:"DocumentName",285:"PageName",286:"XPosition",287:"YPosition",292:"T4Options",293:"T6Options",297:"PageNumber",301:"TransferFunction",317:"Predictor",318:"WhitePoint",319:"PrimaryChromaticities",321:"HalftoneHints",322:"TileWidth",323:"TileLength",324:"TileOffsets",325:"TileByteCounts",326:"BadFaxLines",327:"CleanFaxData",328:"ConsecutiveBadFaxLines",330:"SubIFDs",332:"InkSet",333:"InkNames",334:"NumberOfInks",336:"DotRange",337:"TargetPrinter",339:"SampleFormat",340:"SMinSampleValue",341:"SMaxSampleValue",342:"TransferRange",343:"ClipPath",344:"XClipPathUnits",345:"YClipPathUnits",346:"Indexed",347:"JPEGTables",351:"OPIProxy",400:"GlobalParametersIFD",401:"ProfileType",402:"FaxProfile",403:"CodingMethods",404:"VersionYear",405:"ModeNumber",433:"Decode",434:"DefaultImageColor",512:"JPEGProc",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",515:"JPEGRestartInterval",517:"JPEGLosslessPredictors",518:"JPEGPointTransforms",519:"JPEGQTables",520:"JPEGDCTables",521:"JPEGACTables",529:"YCbCrCoefficients",530:"YCbCrSubSampling",531:"YCbCrPositioning",532:"ReferenceBlackWhite",559:"StripRowCounts",700:"XMP",32781:"ImageID",34732:"ImageLayer",32932:"WangAnnotatio",33445:"MDFileTag",33446:"MDScalePixel",33447:"MDColorTable",33448:"MDLabName",33449:"MDSampleInfo",33450:"MDPrepDate",33451:"MDPrepTime",33452:"MDFileUnits",33550:"ModelPixelScaleTag",33723:"IPTC",33918:"INGRPacketDataTag",33919:"INGRFlagRegisters",33920:"IrasBTransformationMatrix",33922:"ModelTiepointTag",34264:"ModelTransformationTag",34377:"Photoshop",34665:"ExifIFD",34675:"ICCProfile",34735:"GeoKeyDirectoryTag",34736:"GeoDoubleParamsTag",34737:"GeoAsciiParamsTag",34853:"GPSIFD",34908:"HylaFAXFaxRecvParams",34909:"HylaFAXFaxSubAddress",34910:"HylaFAXFaxRecvTime",37724:"ImageSourceData",40965:"InteroperabilityIFD",42112:"GDAL_METADATA",42113:"GDAL_NODATA",50215:"OceScanjobDescription",50216:"OceApplicationSelector",50217:"OceIdentificationNumber",50218:"OceImageLogicCharacteristics",50706:"DNGVersion",50707:"DNGBackwardVersion",50708:"UniqueCameraModel",50709:"LocalizedCameraModel",50710:"CFAPlaneColor",50711:"CFALayout",50712:"LinearizationTable",50713:"BlackLevelRepeatDim",50714:"BlackLevel",50715:"BlackLevelDeltaH",50716:"BlackLevelDeltaV",50717:"WhiteLevel",50718:"DefaultScale",50719:"DefaultCropOrigin",50720:"DefaultCropSize",50721:"ColorMatrix1",50722:"ColorMatrix2",50723:"CameraCalibration1",50724:"CameraCalibration2",50725:"ReductionMatrix1",50726:"ReductionMatrix2",50727:"AnalogBalance",50728:"AsShotNeutral",50729:"AsShotWhiteXY",50730:"BaselineExposure",50731:"BaselineNoise",50732:"BaselineSharpness",50733:"BayerGreenSplit",50734:"LinearResponseLimit",50735:"CameraSerialNumber",50736:"LensInfo",50737:"ChromaBlurRadius",50738:"AntiAliasStrength",50740:"DNGPrivateData",50741:"MakerNoteSafety",50778:"CalibrationIlluminant1",50779:"CalibrationIlluminant2",50780:"BestQualityScale",50784:"AliasLayerMetadata"},Il={};for(let t in Pl)Il[Pl[t]]=Number(t);const Dl={standard:r,exif:e,gps:i};class Ll{constructor(t){if(!t)throw new Error("missing kind");this.data=new Uint8Array,this.fields=new Map,this.kind=t,this._hasMap=!1,this._map={}}get(t){if("number"==typeof t)return this.fields.get(t);if("string"==typeof t)return this.fields.get(Dl[this.kind].tagsByName[t]);throw new Error("expected a number or string")}get map(){if(!this._hasMap){const t=Dl[this.kind].tagsById;for(let e of this.fields.keys())t[e]&&(this._map[t[e]]=this.fields.get(e));this._hasMap=!0}return this._map}}let Fl=new Map([[1,[1,zl]],[2,[1,function(t,e){let i=[],r="";for(let n=0;n<e;n++){let e=String.fromCharCode(t.readUint8());"\0"===e?(i.push(r),r=""):r+=e}return 1===i.length?i[0]:i}]],[3,[2,function(t,e){if(1===e)return t.readUint16();let i=new Uint16Array(e);for(let r=0;r<e;r++)i[r]=t.readUint16();return i}]],[4,[4,function(t,e){if(1===e)return t.readUint32();let i=new Uint32Array(e);for(let r=0;r<e;r++)i[r]=t.readUint32();return i}]],[5,[8,function(t,e){if(1===e)return t.readUint32()/t.readUint32();let i=new Array(e);for(let r=0;r<e;r++)i[r]=t.readUint32()/t.readUint32();return i}]],[6,[1,function(t,e){if(1===e)return t.readInt8();let i=new Int8Array(e);for(let r=0;r<e;r++)i[r]=t.readInt8();return i}]],[7,[1,zl]],[8,[2,function(t,e){if(1===e)return t.readInt16();let i=new Int16Array(e);for(let r=0;r<e;r++)i[r]=t.readInt16();return i}]],[9,[4,function(t,e){if(1===e)return t.readInt32();let i=new Int32Array(e);for(let r=0;r<e;r++)i[r]=t.readInt32();return i}]],[10,[8,function(t,e){if(1===e)return t.readInt32()/t.readInt32();let i=new Array(e);for(let r=0;r<e;r++)i[r]=t.readInt32()/t.readInt32();return i}]],[11,[4,function(t,e){if(1===e)return t.readFloat32();let i=new Float32Array(e);for(let r=0;r<e;r++)i[r]=t.readFloat32();return i}]],[12,[8,function(t,e){if(1===e)return t.readFloat64();let i=new Float64Array(e);for(let r=0;r<e;r++)i[r]=t.readFloat64();return i}]]]);function zl(t,e){if(1===e)return t.readUint8();let i=new Uint8Array(e);for(let r=0;r<e;r++)i[r]=t.readUint8();return i}let Bl=[];const Nl=[511,1023,2047,4095],Ol=[0,0,0,0,0,0,0,0,0,511,1023,2047,4095];class Ul{constructor(t){this.nextData=0,this.nextBits=0,this.bytePointer=0,this.tableLength=258,this.currentBitLength=9,this.stripArray=new Uint8Array(t.buffer,t.byteOffset,t.byteLength),this.outData=new ys.IOBuffer(t.byteLength),this.initializeTable()}decode(){let t=0,e=0;for(;257!==(t=this.getNextCode());)if(256===t){if(this.initializeTable(),t=this.getNextCode(),257===t)break;this.writeString(this.stringFromCode(t)),e=t}else if(this.isInTable(t))this.writeString(this.stringFromCode(t)),this.addStringToTable(this.stringFromCode(e).concat(this.stringFromCode(t)[0])),e=t;else{const i=this.stringFromCode(e).concat(this.stringFromCode(e)[0]);this.writeString(i),this.addStringToTable(i),e=t}const i=this.outData.toArray();return new DataView(i.buffer,i.byteOffset,i.byteLength)}initializeTable(){!function(){if(0===Bl.length){for(let t=0;t<256;t++)Bl.push([t]);const t=[];for(let e=256;e<4096;e++)Bl.push(t)}}(),this.tableLength=258,this.currentBitLength=9}writeString(t){this.outData.writeBytes(t)}stringFromCode(t){return Bl[t]}isInTable(t){return t<this.tableLength}addStringToTable(t){if(Bl[this.tableLength++]=t,Bl.length>4096)throw Bl=[],new Error("LZW decoding error. Please open an issue at https://github.com/image-js/tiff/issues/new/choose (include a test image).");this.tableLength===Ol[this.currentBitLength]&&this.currentBitLength++}getNextCode(){this.nextData=this.nextData<<8|255&this.stripArray[this.bytePointer++],this.nextBits+=8,this.nextBits<this.currentBitLength&&(this.nextData=this.nextData<<8|255&this.stripArray[this.bytePointer++],this.nextBits+=8);const t=this.nextData>>this.nextBits-this.currentBitLength&Nl[this.currentBitLength-9];return this.nextBits-=this.currentBitLength,this.bytePointer>this.stripArray.length?257:t}}function Vl(t){return new Ul(t).decode()}const Yl=/^(\d{4}):(\d{2}):(\d{2}) (\d{2}):(\d{2}):(\d{2})$/;class Xl extends Ll{constructor(){super("standard")}get size(){return this.width*this.height}get width(){return this.imageWidth}get height(){return this.imageLength}get components(){return this.samplesPerPixel}get date(){let t=new Date,e=Yl.exec(this.dateTime);if(null===e)throw new Error(`invalid dateTime: ${this.dateTime}`);return t.setFullYear(Number(e[1]),Number(e[2])-1,Number(e[3])),t.setHours(Number(e[4]),Number(e[5]),Number(e[6])),t}get newSubfileType(){return this.get("NewSubfileType")}get imageWidth(){return this.get("ImageWidth")}get imageLength(){return this.get("ImageLength")}get bitsPerSample(){const t=this.get("BitsPerSample");return t&&"number"!=typeof t?t[0]:t}get alpha(){const t=this.extraSamples;return!!t&&0!==t[0]}get associatedAlpha(){const t=this.extraSamples;return!!t&&1===t[0]}get extraSamples(){return jl(this.get("ExtraSamples"))}get compression(){return this.get("Compression")||1}get type(){return this.get("PhotometricInterpretation")}get fillOrder(){return this.get("FillOrder")||1}get documentName(){return this.get("DocumentName")}get imageDescription(){return this.get("ImageDescription")}get stripOffsets(){return jl(this.get("StripOffsets"))}get orientation(){return this.get("Orientation")}get samplesPerPixel(){return this.get("SamplesPerPixel")||1}get rowsPerStrip(){return this.get("RowsPerStrip")}get stripByteCounts(){return jl(this.get("StripByteCounts"))}get minSampleValue(){return this.get("MinSampleValue")||0}get maxSampleValue(){return this.get("MaxSampleValue")||Math.pow(2,this.bitsPerSample)-1}get xResolution(){return this.get("XResolution")}get yResolution(){return this.get("YResolution")}get planarConfiguration(){return this.get("PlanarConfiguration")||1}get resolutionUnit(){return this.get("ResolutionUnit")||2}get dateTime(){return this.get("DateTime")}get predictor(){return this.get("Predictor")||1}get sampleFormat(){return this.get("SampleFormat")||1}get sMinSampleValue(){return this.get("SMinSampleValue")||this.minSampleValue}get sMaxSampleValue(){return this.get("SMaxSampleValue")||this.maxSampleValue}get palette(){const t=2**this.bitsPerSample,e=this.get("ColorMap");if(!e)return;if(e.length!==3*t)throw new Error(`ColorMap size must be ${t}`);const i=[];for(let r=0;r<t;r++)i.push([e[r],e[r+t],e[r+2*t]]);return i}}function jl(t){return"number"==typeof t?[t]:t}function Gl(t){const e=new Uint8Array(t.buffer,t.byteOffset,t.byteLength),i=Ph(e);return new DataView(i.buffer,i.byteOffset,i.byteLength)}const ql={ignoreImageData:!1,onlyFirst:!1};class Zl extends ys.IOBuffer{constructor(t){super(t),this._nextIFD=0}get isMultiPage(){let t=0;for(this.decodeHeader();this._nextIFD;)if(t++,this.decodeIFD({ignoreImageData:!0},!0),2===t)return!0;if(1===t)return!1;throw Kl("ifdCount",t)}get pageCount(){let t=0;for(this.decodeHeader();this._nextIFD;)t++,this.decodeIFD({ignoreImageData:!0},!0);if(t>0)return t;throw Kl("ifdCount",t)}decode(t={}){t=Object.assign({},ql,t);const e=[];for(this.decodeHeader();this._nextIFD;)if(e.push(this.decodeIFD(t,!0)),t.onlyFirst)return[e[0]];return e}decodeHeader(){const t=this.readUint16();if(18761===t)this.setLittleEndian();else{if(19789!==t)throw new Error(`invalid byte order: 0x${t.toString(16)}`);this.setBigEndian()}if(42!==this.readUint16())throw new Error("not a TIFF file");this._nextIFD=this.readUint32()}decodeIFD(t,e){let i;if(this.seek(this._nextIFD),e)i=new Xl;else{if(!t.kind)throw new Error("kind is missing");i=new Ll(t.kind)}const r=this.readUint16();for(let t=0;t<r;t++)this.decodeIFDEntry(i);if(!t.ignoreImageData){if(!(i instanceof Xl))throw new Error("must be a tiff ifd");this.decodeImageData(i)}return this._nextIFD=this.readUint32(),i}decodeIFDEntry(t){const e=this.offset,i=this.readUint16(),r=this.readUint16(),n=this.readUint32();if(r<1||r>12)return void this.skip(4);const s=function(t,e){const i=Fl.get(t);if(!i)throw new Error(`type not found: ${t}`);return i[0]*e}(r,n);s>4&&this.seek(this.readUint32());const o=function(t,e,i){const r=Fl.get(e);if(!r)throw new Error(`type not found: ${e}`);return r[1](t,i)}(this,r,n);if(t.fields.set(i,o),34665===i||34853===i){let e=this.offset,r="exif";34665===i?r="exif":34853===i&&(r="gps"),this._nextIFD=o,t[r]=this.decodeIFD({kind:r,ignoreImageData:!0},!1),this.offset=e}this.seek(e),this.skip(12)}decodeImageData(t){const e=t.orientation;if(e&&1!==e)throw Kl("orientation",e);switch(t.type){case 0:case 1:case 2:case 3:this.readStripData(t);break;default:throw Kl("image type",t.type)}if(this.applyPredictor(t),this.convertAlpha(t),0===t.type){const e=t.bitsPerSample,i=Math.pow(2,e)-1;for(let e=0;e<t.data.length;e++)t.data[e]=i-t.data[e]}}readStripData(t){const e=t.width,i=t.height,r=t.bitsPerSample,n=t.sampleFormat,s=e*i*t.samplesPerPixel,o=function(t,e,i){if(8===e)return new Uint8Array(t);if(16===e)return new Uint16Array(t);if(32===e&&3===i)return new Float32Array(t);throw Kl("bit depth / sample format",`${e} / ${i}`)}(s,r,n),a=t.rowsPerStrip*e*t.samplesPerPixel,h=t.stripOffsets,l=t.stripByteCounts||function(t){if(1!==t.compression)throw new Error("missing mandatory StripByteCounts field in compressed image");const e=t.rowsPerStrip*t.width*t.samplesPerPixel*(t.bitsPerSample/8);return new Array(t.stripOffsets.length).fill(e)}(t);let u=s,c=0;for(let e=0;e<h.length;e++){let i=new DataView(this.buffer,this.byteOffset+h[e],l[e]),s=u>a?a:u;u-=s;let d=i;switch(t.compression){case 1:break;case 5:d=Vl(i);break;case 8:d=Gl(i);break;case 2:throw Kl("Compression","CCITT Group 3");case 32773:throw Kl("Compression","PackBits");default:throw Kl("Compression",t.compression)}c=this.fillUncompressed(r,n,o,d,c,s)}t.data=o}fillUncompressed(t,e,i,r,n,s){if(8===t)return function(t,e,i,r){for(let n=0;n<r;n++)t[i++]=e.getUint8(n);return i}(i,r,n,s);if(16===t)return function(t,e,i,r,n){for(let s=0;s<2*r;s+=2)t[i++]=e.getUint16(s,n);return i}(i,r,n,s,this.isLittleEndian());if(32===t&&3===e)return function(t,e,i,r,n){for(let s=0;s<4*r;s+=4)t[i++]=e.getFloat32(s,n);return i}(i,r,n,s,this.isLittleEndian());throw Kl("bitDepth",t)}applyPredictor(t){const e=t.bitsPerSample;switch(t.predictor){case 1:break;case 2:if(8===e)!function(t,e,i){let r=0;for(;r<t.length;){for(let n=i;n<e*i;n+=i)for(let e=0;e<i;e++)t[r+n+e]=t[r+n+e]+t[r+n-(i-e)]&255;r+=e*i}}(t.data,t.width,t.components);else{if(16!==e)throw new Error(`Horizontal differencing is only supported for images with a bit depth of ${e}`);!function(t,e,i){let r=0;for(;r<t.length;){for(let n=i;n<e*i;n+=i)for(let e=0;e<i;e++)t[r+n+e]=t[r+n+e]+t[r+n-(i-e)]&65535;r+=e*i}}(t.data,t.width,t.components)}break;default:throw new Error(`invalid predictor: ${t.predictor}`)}}convertAlpha(t){if(t.alpha&&t.associatedAlpha){const{data:e,components:i,maxSampleValue:r}=t;for(let t=0;t<e.length;t+=i){const n=e[t+i-1];for(let s=0;s<i-1;s++)e[t+s]=Math.round(e[t+s]*r/n)}}}}function Kl(t,e){return new Error(`Unsupported ${t}: ${e}`)}function Hl(t={}){let{algorithm:e="matchToPrevious",ignoreBorder:i=[0,0]}=t;this.checkProcessable("matchAndCrop",{bitDepth:[8,16]});let r="matchToPrevious"===e,n=this[0],s=[];s[0]={position:[0,0],image:this[0]};let o=[0,0];for(let t=1;t<this.length;t++){let e=n.getBestMatch(this[t],{border:i});s[t]={position:[e[0]+o[0],e[1]+o[1]],image:this[t]},r&&(o[0]+=e[0],o[1]+=e[1],n=this[t])}let a=0,h=0,l=0,u=0;for(let t=0;t<s.length;t++){let e=s[t];e.position[0]>a&&(a=e.position[0]),e.position[0]<h&&(h=e.position[0]),e.position[1]>l&&(l=e.position[1]),e.position[1]<u&&(u=e.position[1])}h=0-h,u=0-u;for(let t=0;t<s.length;t++){let e=s[t];e.crop=e.image.crop({x:a-e.position[0],y:l-e.position[1],width:n.width-h-a,height:n.height-u-l})}let c=[];for(let t=0;t<s.length;t++)c[t]=s[t].crop;return new au(c)}function Wl(){this.checkProcessable("min",{bitDepth:[8,16]});let t=this[0].min;for(let e=1;e<this.length;e++)for(let i=0;i<t.length;i++)t[i]=Math.min(t[i],this[e].min[i]);return t}function $l(){this.checkProcessable("min",{bitDepth:[8,16]});let t=this[0].max;for(let e=1;e<this.length;e++)for(let i=0;i<t.length;i++)t[i]=Math.max(t[i],this[e].max[i]);return t}function Ql(t){let e=t.reduce(((t,e)=>t+e));if(0===e)throw new Error("unreachable");let i,r=0,n=0,s=e/2;for(;;){if(t[r]>0){if(void 0!==i)return(i+r)/2;if(n+=t[r],n>s)return r;n===s&&(i=r)}r++}}function Jl(t){let e=0,i=0;for(let r=0;r<t.length;r++)e+=t[r],i+=t[r]*r;return 0===e?0:i/e}function tu(){this.checkProcessable("median",{bitDepth:[8,16]});let t=this.getHistograms({maxSlots:this[0].maxValue+1}),e=new Array(t.length);for(let i=0;i<t.length;i++){let r=t[i];e[i]=Ql(r)}return e}function eu(t){this.checkProcessable("min",{bitDepth:[8,16]});let e=this[0].getHistogram(t);for(let i=1;i<this.length;i++){let r=this[i].getHistogram(t);for(let t=0;t<e.length;t++)e[t]+=r[t]}return e}function iu(t){this.checkProcessable("min",{bitDepth:[8,16]});let e=this[0].getHistograms(t),i=e[0].length;for(let r=1;r<this.length;r++){let n=this[r].getHistograms(t);for(let t=0;t<e.length;t++)for(let r=0;r<i;r++)e[t][r]+=n[t][r]}return e}function ru(){this.checkProcessable("averageImage",{bitDepth:[8,16]});let t=new Uint32Array(this[0].data.length);for(let e=0;e<this.length;e++){let i=this[e];for(let e=0;e<this[0].data.length;e++)t[e]+=i.data[e]}let e=dg.createFrom(this[0]),i=e.data;for(let e=0;e<this[0].data.length;e++)i[e]=t[e]/this.length;return e}function nu(){this.checkProcessable("max",{bitDepth:[8,16]});let t=dg.createFrom(this[0]);t.data.fill(0);for(const e of this)for(let i=0;i<t.data.length;i++)t.data[i]=Math.max(e.data[i],t.data[i]);return t}function su(){this.checkProcessable("max",{bitDepth:[8,16]});let t=dg.createFrom(this[0]);t.data.fill(t.maxValue);for(const e of this)for(let i=0;i<t.data.length;i++)t.data[i]=Math.min(e.data[i],t.data[i]);return t}let ou={configurable:!0,enumerable:!1,get:void 0};class au extends Array{constructor(t){if(Array.isArray(t)){super(t.length);for(let e=0;e<t.length;e++)this[e]=t[e]}else"number"==typeof t?super(t):super();this.computed=null}static load(t){return Promise.all(t.map(dg.load)).then((t=>new au(t)))}static extendMethod(t,e,i={}){let{inPlace:r=!1,returnThis:n=!0,partialArgs:s=[]}=i;return au.prototype[t]=r?function(...t){this.computed=null;let i=e.apply(this,[...s,...t]);return n?this:i}:function(...t){return e.apply(this,[...s,...t])},au}static extendProperty(t,e,i={}){let{partialArgs:r=[]}=i;return ou.get=function(){if(null===this.computed)this.computed={};else if(fl()(t,this.computed))return this.computed[t];let i=e.apply(this,r);return this.computed[t]=i,i},Object.defineProperty(au.prototype,t,ou),au}checkProcessable(t,e={}){if("string"!=typeof t)throw new TypeError("checkProcessable requires as first parameter the processName (a string)");if(0===this.size)throw new TypeError(`The process: ${t} can not be applied on an empty stack`);this[0].checkProcessable(t,e);for(let i=1;i<this.length;i++){if((void 0===e.sameSize||e.sameSize)&&this[0].width!==this[i].width)throw new TypeError(`The process: ${t} can not be applied if width is not identical in all images`);if((void 0===e.sameSize||e.sameSize)&&this[0].height!==this[i].height)throw new TypeError(`The process: ${t} can not be applied if height is not identical in all images`);if((void 0===e.sameAlpha||e.sameAlpha)&&this[0].alpha!==this[i].alpha)throw new TypeError(`The process: ${t} can not be applied if alpha is not identical in all images`);if((void 0===e.sameBitDepth||e.sameBitDepth)&&this[0].bitDepth!==this[i].bitDepth)throw new TypeError(`The process: ${t} can not be applied if bitDepth is not identical in all images`);if((void 0===e.sameColorModel||e.sameColorModel)&&this[0].colorModel!==this[i].colorModel)throw new TypeError(`The process: ${t} can not be applied if colorModel is not identical in all images`);if((void 0===e.sameNumberChannels||e.sameNumberChannels)&&this[0].channels!==this[i].channels)throw new TypeError(`The process: ${t} can not be applied if channels is not identical in all images`)}}}Array[Symbol.species]||(au.prototype.map=function(t,e){if("function"!=typeof t)throw new TypeError(`${t} is not a function`);let i=new au(this.length);for(let r=0;r<this.length;r++)i[r]=t.call(e,this[r],r,this);return i}),function(t){t.extendMethod("matchAndCrop",Hl),t.extendMethod("getMin",Wl),t.extendMethod("getMax",$l),t.extendMethod("getMedian",tu),t.extendMethod("getHistogram",eu),t.extendMethod("getHistograms",iu),t.extendMethod("getAverage",ru),t.extendMethod("getAverageImage",ru),t.extendMethod("getMaxImage",nu),t.extendMethod("getMinImage",su)}(au);const hu=/^data:[a-z]+\/(?:[a-z]+);base64,/;function lu(t,e,i){const r=Cl()(t);if(r)switch(r.mime){case"image/png":return function(t){const e=function(t,e){return new Xh(t,void 0).decode()}(t);let i,r=e.channels,n=0;return 2===r||4===r?(i=r-1,n=1):i=r,e.palette?function(t){const e=t.width*t.height,i=t.palette[0].length,r=new Uint8Array(e*i),n=8/t.depth,s=t.depth<8?n:1,o=parseInt("1".repeat(t.depth),2),a=4===i;let h=0;for(let i=0;i<e;i++){const e=Math.floor(i/s);let l=t.data[e];t.depth<8&&(l=l>>>t.depth*(n-1-i%n)&o);const u=t.palette[l];r[h++]=u[0],r[h++]=u[1],r[h++]=u[2],a&&(r[h++]=u[3])}return new dg(t.width,t.height,r,{components:3,alpha:a,bitDepth:8})}(e):new dg(e.width,e.height,e.data,{components:i,alpha:n,bitDepth:e.depth})}(t);case"image/jpeg":return function(t){const e=(0,kl.decode)(t);let i;e.exif&&(i=uu(e.exif));const r=(0,il.decode)(t,{useTArray:!0,maxMemoryUsageInMB:1024});let n=new dg(r.width,r.height,r.data,{meta:i});if(i&&i.tiff.tags.Orientation){const t=i.tiff.tags.Orientation;t>2&&(n=n.rotate({3:180,4:180,5:90,6:90,7:270,8:270}[t])),[2,4,5,7].includes(t)&&(n=n.flipX())}return n}(t);case"image/tiff":return function(t,e){let i=function(t,e){return new Zl(t).decode(void 0)}(t);return 1===i.length?cu(i[0],e):new au(i.map((function(t){return cu(t,e)})))}(t,i);default:return du(n(r.mime))}return du(n("application/octet-stream"));function n(i){return e||sl(t,i)}}function uu(t){const e={tiff:{fields:t.fields,tags:t.map}};return t.exif&&(e.exif=t.exif),t.gps&&(e.gps=t.gps),e}function cu(t,e){if(e||3!==t.type)return new dg(t.width,t.height,t.data,{components:2===t.type?3:1,alpha:t.alpha,colorModel:2===t.type?pl:ml,bitDepth:t.bitsPerSample.length?t.bitsPerSample[0]:t.bitsPerSample,meta:uu(t)});{const e=new Uint16Array(3*t.width*t.height),i=t.palette;let r=0;for(let n=0;n<t.data.length;n++){const s=i[t.data[n]];e[r++]=s[0],e[r++]=s[1],e[r++]=s[2]}return new dg(t.width,t.height,e,{components:3,alpha:t.alpha,colorModel:pl,bitDepth:16,meta:uu(t)})}}function du(t,e){return e=e||{},new Promise((function(i,r){let n=new al;n.onload=function(){let t=n.width,r=n.height,s=hl(t,r).getContext("2d");s.drawImage(n,0,0,t,r);let o=s.getImageData(0,0,t,r).data;i(new dg(t,r,o,e))},n.onerror=function(){r(new Error(`Could not load ${t}`))},n.src=t}))}const fu={getValueXY(t,e,i){return this.data[(e*this.width+t)*this.channels+i]},setValueXY(t,e,i,r){return this.data[(e*this.width+t)*this.channels+i]=r,this.computed=null,this},getValue(t,e){return this.data[t*this.channels+e]},setValue(t,e,i){return this.data[t*this.channels+e]=i,this.computed=null,this},getPixelXY(t,e){return this.getPixel(e*this.width+t)},setPixelXY(t,e,i){return this.setPixel(e*this.width+t,i)},getPixel(t){const e=new Array(this.channels),i=t*this.channels;for(let t=0;t<this.channels;t++)e[t]=this.data[i+t];return e},setPixel(t,e){const i=t*this.channels;for(let t=0;t<e.length;t++)this.data[i+t]=e[t];return this.computed=null,this}};function gu(t){return{width:t.width,height:t.height,components:t.components,alpha:t.alpha,colorModel:t.colorModel,bitDepth:t.bitDepth}}function mu(t,e,i,r={}){const{out:n}=e;if(void 0===n)return r.copy?t.clone():dg.createFrom(t,i);{if(!dg.isImage(n))throw new TypeError("out must be an Image object");const e=Object.assign(gu(t),i);for(const t in e)if(n[t]!==e[t])throw new RangeError(`cannot use out. Its ${t} must be "${e[t]}" (found "${n[t]}")`);return n}}function pu(t,e,i){if(void 0!==e.inPlace&&"boolean"!=typeof e.inPlace)throw new TypeError("inPlace option must be a boolean");if(e.inPlace){if(void 0!==e.out)throw new TypeError("out option must not be set if inPlace option is true");return t}return mu(t,e,null,i)}function wu(t={}){this.checkProcessable("abs",{bitDepth:[32]});const e=pu(this,t);return function(t,e){for(let i=0;i<t.data.length;i++)e.data[i]=Math.abs(t.data[i])}(this,e),e}function _u(t={}){this.checkProcessable("invert",{bitDepth:[1,8,16]});const e=pu(this,t);return 1===this.bitDepth?function(t,e){for(let i=0;i<t.data.length;i++)e.data[i]=~t.data[i]}(this,e):(function(t,e){for(let i=0;i<t.data.length;i+=t.channels)for(let r=0;r<t.components;r++)e.data[i+r]=t.maxValue-t.data[i+r]}(this,e),this!==e&&function(t,e){if(1===t.alpha&&1===e.alpha)for(let i=0;i<t.size;i++)e.data[i*e.channels+e.components]=t.data[i*t.channels+t.components]}(this,e)),e}function bu(){this.checkProcessable("flipX",{bitDepth:[8,16]});for(let t=0;t<this.height;t++){let e=t*this.width*this.channels;for(let t=0;t<Math.floor(this.width/2);t++){let i=t*this.channels+e,r=(this.width-t-1)*this.channels+e;for(let t=0;t<this.channels;t++){let e=this.data[i+t];this.data[i+t]=this.data[r+t],this.data[r+t]=e}}}return this}function yu(){this.checkProcessable("flipY",{bitDepth:[8,16]});for(let t=0;t<Math.floor(this.height/2);t++)for(let e=0;e<this.width;e++){let i=e*this.channels+t*this.width*this.channels,r=e*this.channels+(this.height-1-t)*this.channels*this.width;for(let t=0;t<this.channels;t++){let e=this.data[i+t];this.data[i+t]=this.data[r+t],this.data[r+t]=e}}return this}function vu(t={}){const{radius:e=1}=t;if(e<1)throw new Error("radius must be greater than 1");const i=2*e+1,r=new Array(i);for(let t=0;t<i;t++){r[t]=new Array(i);for(let e=0;e<i;e++)r[t][e]=1/(i*i)}return this.convolution(r)}var xu=__webpack_require__(5520),Mu=__webpack_require__.n(xu);function ku(t,e={}){let{channels:i,allowAlpha:r,defaultAlpha:n}=e;return"boolean"!=typeof r&&(r=!0),void 0===i?function(t,e){let i=e?t.channels:t.components,r=new Array(i);for(let t=0;t<i;t++)r[t]=t;return r}(t,n):function(t,e,i){Array.isArray(e)||(e=[e]);for(let r=0;r<e.length;r++)e[r]=Eu(t,e[r],i);return e}(t,i,r)}function Eu(t,e,i=!0){if(void 0===e)throw new RangeError(`validateChannel : the channel has to be >=0 and <${t.channels}`);if("string"==typeof e){switch(t.colorModel){case ml:break;case pl:if("rgb".includes(e))switch(e){case"r":e=0;break;case"g":e=1;break;case"b":e=2}break;case wl:if("hsl".includes(e))switch(e){case"h":e=0;break;case"s":e=1;break;case"l":e=2}break;case _l:if("hsv".includes(e))switch(e){case"h":e=0;break;case"s":e=1;break;case"v":e=2}break;case bl:if("cmyk".includes(e))switch(e){case"c":e=0;break;case"m":e=1;break;case"y":e=2;break;case"k":e=3}break;default:throw new Error(`Unexpected color model: ${t.colorModel}`)}if("a"===e){if(!t.alpha)throw new Error("validateChannel : the image does not contain alpha channel");e=t.components}if("string"==typeof e)throw new Error(`validateChannel : undefined channel: ${e}`)}if(e>=t.channels)throw new RangeError(`validateChannel : the channel has to be >=0 and <${t.channels}`);if(!i&&e>=t.components)throw new RangeError("validateChannel : alpha channel may not be selected");return e}function Cu(t={}){let{radius:e=1,border:i="copy",channels:r}=t;if(this.checkProcessable("medianFilter",{bitDepth:[8,16]}),e<1)throw new Error("radius must be greater than 0");r=ku(this,r);let n=e,s=e,o=dg.createFrom(this),a=new Array((2*n+1)*(2*s+1));for(let t=0;t<r.length;t++){let e=r[t];for(let t=s;t<this.height-s;t++)for(let i=n;i<this.width-n;i++){let r=0;for(let o=-s;o<=s;o++)for(let s=-n;s<=n;s++){let n=((t+o)*this.width+i+s)*this.channels+e;a[r++]=this.data[n]}let h=(t*this.width+i)*this.channels+e;o.data[h]=Mu()(a)}}if(this.alpha&&!r.includes(this.channels))for(let t=this.components;t<this.data.length;t+=this.channels)o.data[t]=this.data[t];return o.setBorder({size:[n,s],algorithm:i}),o}function Su(t={}){let{radius:e=1,sigma:i,channels:r,border:n="copy"}=t;this.checkProcessable("gaussian",{bitDepth:[8,16]});const s=function(t,e){const i=2*t+1,r=new Array(i),n=e||.3*(.5*(i-1)-1)+.8,s=-.5/(n*n);let o=0;for(let e=0;e<i;e++){const i=e-t,n=Math.exp(s*i*i);r[e]=n,o+=n}for(let t=0;t<i;t++)r[t]/=o;return r}(e,i);return this.convolution([s,s],{border:n,channels:r,algorithm:"separable"})}const Au=[[-1,0,1],[-2,0,2],[-1,0,1]],Tu=[[-1,-2,-1],[0,0,0],[1,2,1]],Ru=[[3,0,-3],[10,0,-10],[3,0,-3]],Pu=[[3,10,3],[0,0,0],[-3,-10,-3]];var Iu=__webpack_require__(414),Du=__webpack_require__(8336),Lu=__webpack_require__.n(Du);function Fu(t,e){return Math.round(Math.min(Math.max(t,0),e.maxValue))}function zu(t,e,i){if(void 0===i){const r=t.length+e.length-1;i=new Array(r)}!function(t){for(var e=0;e<t.length;e++)t[e]=0}(i);for(var r=0;r<t.length;r++)for(var n=0;n<e.length;n++)i[r+n]+=t[r]*e[n];return i}function Bu(t,e,i,r){const n=new Array(t.length);let s,o,a,h;h=e[1],a=(h.length-1)/2,o=new Array(i+h.length-1),s=new Array(i);for(let e=0;e<r;e++){for(let r=0;r<i;r++)s[r]=t[e*i+r];zu(s,h,o);for(let t=0;t<i;t++)n[e*i+t]=o[a+t]}h=e[0],a=(h.length-1)/2,o=new Array(r+h.length-1),s=new Array(r);for(let t=0;t<i;t++){for(let e=0;e<r;e++)s[e]=n[e*i+t];zu(s,h,o);for(let e=0;e<r;e++)n[e*i+t]=o[a+e]}return n}__webpack_require__(9645),__webpack_require__(995);var Nu=__webpack_require__(8406);Nu.AbstractMatrix,Nu.CHO,Nu.CholeskyDecomposition,Nu.DistanceMatrix,Nu.EVD,Nu.EigenvalueDecomposition,Nu.LU,Nu.LuDecomposition;const Ou=Nu.Matrix,Uu=(Nu.MatrixColumnSelectionView,Nu.MatrixColumnView,Nu.MatrixFlipColumnView,Nu.MatrixFlipRowView,Nu.MatrixRowSelectionView,Nu.MatrixRowView,Nu.MatrixSelectionView,Nu.MatrixSubView,Nu.MatrixTransposeView,Nu.NIPALS,Nu.Nipals,Nu.QR,Nu.QrDecomposition,Nu.SVD),Vu=Nu.SingularValueDecomposition,Yu=(Nu.SymmetricMatrix,Nu.WrapperMatrix1D,Nu.WrapperMatrix2D,Nu.correlation,Nu.covariance,Nu.Matrix,Nu.Matrix,Nu.determinant,Nu.inverse),Xu=(Nu.linearDependencies,Nu.pseudoInverse,Nu.solve);function ju(t,e={}){let{channels:i,bitDepth:r,normalize:n=!1,divisor:s=1,border:o="copy",algorithm:a="auto"}=e,h={};r&&(h.bitDepth=r);let l,u,c=dg.createFrom(this,h);if(i=ku(this,i),"separable"!==a)({kernel:t}=function(t){let e,i;if(!Array.isArray(t))throw new Error(`validateKernel: Invalid Kernel: ${t}`);if(Array.isArray(t[0])){if(0==(1&t.length)||0==(1&t[0].length))throw new RangeError("validateKernel: Kernel rows and columns should be odd numbers");e=Math.floor(t.length/2),i=Math.floor(t[0].length/2)}else{let r=Math.sqrt(t.length);if(!Lu()(r))throw new RangeError("validateKernel: Kernel array should be a square");i=e=Math.floor(Math.sqrt(t.length)/2);let n=new Array(r);for(let e=0;e<r;e++){n[e]=new Array(r);for(let i=0;i<r;i++)n[e][i]=t[e*r+i]}t=n}return{kernel:t,kWidth:i,kHeight:e}}(t));else if(!Array.isArray(t)||2!==t.length)throw new RangeError("separable convolution requires two arrays of numbers to represent the kernel");if("auto"===a){let e=function(t){const e=new Uu(t,{autoTranspose:!0});if(1!==e.rank)return null;const i=Math.sqrt(e.s[0]);return[e.U.to2DArray().map((t=>t[0]*i)),e.V.to2DArray().map((t=>t[0]*i))]}(t);null!==e?(a="separable",t=e):a=(t.length>9||t[0].length>9)&&this.width<=4096&&this.height<=4096?"fft":"direct"}"separable"===a?(l=Math.floor(t[0].length/2),u=Math.floor(t[1].length/2)):(l=Math.floor(t.length/2),u=Math.floor(t[0].length/2));let d,f,g,m,p,w,_=c.isClamped,b=new Array(this.height*this.width);for(m=0;m<i.length;m++){for(p=i[m],g=0;g<this.height;g++)for(f=0;f<this.width;f++)d=g*this.width+f,b[d]=this.data[d*this.channels+p];if("direct"===a)w=(0,Iu.direct)(b,t,{rows:this.height,cols:this.width,normalize:n,divisor:s});else if("separable"===a){if(w=Bu(b,t,this.width,this.height),n){s=0;for(let e=0;e<t[0].length;e++)for(let i=0;i<t[1].length;i++)s+=t[0][e]*t[1][i]}if(1!==s)for(let t=0;t<w.length;t++)w[t]/=s}else w=(0,Iu.fft)(b,t,{rows:this.height,cols:this.width,normalize:n,divisor:s});for(g=0;g<this.height;g++)for(f=0;f<this.width;f++)d=g*this.width+f,c.data[d*this.channels+p]=_?Fu(w[d],c):w[d]}if(this.alpha&&!i.includes(this.channels))for(f=this.components;f<this.data.length;f+=this.channels)c.data[f]=this.data[f];return"periodic"!==o&&c.setBorder({size:[u,l],algorithm:o}),c}function Gu(t={}){let{direction:e="xy",border:i="copy",kernelX:r,kernelY:n,channels:s,bitDepth:o=this.bitDepth}=t;switch(this.checkProcessable("gradientFilter",{bitDepth:[8,16]}),e){case"x":if(!r)throw new Error("kernelX option is missing");return ju.call(this,r,{channels:s,border:i,bitDepth:o});case"y":if(!n)throw new Error("kernelY option is missing");return ju.call(this,n,{channels:s,border:i,bitDepth:o});case"xy":{if(!r)throw new Error("kernelX option is missing");if(!n)throw new Error("kernelY option is missing");const t=ju.call(this,r,{channels:s,border:i,bitDepth:32}),e=ju.call(this,n,{channels:s,border:i,bitDepth:32});return t.hypotenuse(e,{bitDepth:o,channels:s})}default:throw new Error(`Unknown parameter direction: ${e}`)}}function qu(t){return Gu.call(this,Object.assign({},t,{kernelX:Au,kernelY:Tu}))}function Zu(t){return Gu.call(this,Object.assign({},t,{kernelX:Ru,kernelY:Pu}))}Nu.wrap;var Ku=__webpack_require__(2664),Hu=__webpack_require__.n(Ku);function Wu(t={}){let{algorithm:e="range",channels:i,min:r=this.min,max:n=this.max}=t;if(this.checkProcessable("level",{bitDepth:[8,16,32]}),i=ku(this,{channels:i}),i.length!==this.channel&&(Array.isArray(r)&&r.length===this.channels&&(r=r.filter(((t,e)=>i.includes(e)))),Array.isArray(n)&&n.length===this.channels&&(n=n.filter(((t,e)=>i.includes(e))))),"range"!==e)throw new Error(`level: algorithm not implement: ${e}`);return r<0&&(r=0),n>this.maxValue&&(n=this.maxValue),Array.isArray(r)||(r=Hu()(i.length,r)),Array.isArray(n)||(n=Hu()(i.length,n)),function(t,e,i,r){let n=1e-5,s=new Array(r.length);for(let o=0;o<r.length;o++)0===e[o]&&i[o]===t.maxValue||i[o]===e[o]?s[o]=0:s[o]=(t.maxValue+1-n)/(i[o]-e[o]),e[o]+=.499995/s[o];for(let i=0;i<r.length;i++){let n=r[i];if(0!==s[i])for(let r=0;r<t.data.length;r+=t.channels)t.data[r+n]=Math.min(Math.max(0,(t.data[r+n]-e[i])*s[i]+.5|0),t.maxValue)}}(this,r,n,i),this}var $u=__webpack_require__(7811),Qu=__webpack_require__.n($u);function Ju(t){if(isNaN(t)){if(t instanceof dg)return t.data;if(!Qu()(t))throw new Error("checkNumberArray: the value should be either a number, array or Image");return t}if(t<=0)throw new Error("checkNumberArray: the value must be greater than 0");return t}function tc(t,e={}){let{channels:i}=e;if(this.checkProcessable("add",{bitDepth:[8,16]}),i=ku(this,{channels:i}),t=Ju(t),isNaN(t)){if(this.data.length!==t.length)throw new Error("add: the data size is different");for(let e=0;e<i.length;e++){let r=i[e];for(let e=0;e<this.data.length;e+=this.channels)this.data[e+r]=Math.max(0,Math.min(this.maxValue,this.data[e+r]+t[e+r]>>0))}}else for(let e=0;e<i.length;e++){let r=i[e];for(let e=0;e<this.data.length;e+=this.channels)this.data[e+r]=Math.min(this.maxValue,this.data[e+r]+t>>0)}return this}function ec(t,e={}){let{channels:i}=e;if(this.checkProcessable("subtract",{bitDepth:[8,16]}),i=ku(this,{channels:i}),t=Ju(t),isNaN(t)){if(this.data.length!==t.length)throw new Error("subtract: the data size is different");for(let e=0;e<i.length;e++){let r=i[e];for(let e=0;e<this.data.length;e+=this.channels)this.data[e+r]=Math.max(0,Math.min(this.maxValue,this.data[e+r]-t[e+r]>>0))}}else for(let e=0;e<i.length;e++){let r=i[e];for(let e=0;e<this.data.length;e+=this.channels)this.data[e+r]=Math.max(0,this.data[e+r]-t>>0)}return this}function ic(t,e={}){let{channels:i,absolute:r=!1}=e;if(this.checkProcessable("subtractImage",{bitDepth:[8,16]}),this.width!==t.width||this.height!==t.height)throw new Error("subtractImage: both images must have the same size");if(this.alpha!==t.alpha||this.bitDepth!==t.bitDepth)throw new Error("subtractImage: both images must have the same alpha and bitDepth");if(this.channels!==t.channels)throw new Error("subtractImage: both images must have the same number of channels");let n=this.clone();i=ku(this,{channels:i});for(let e=0;e<i.length;e++)for(let s=i[e];s<this.data.length;s+=this.channels){let e=this.data[s]-t.data[s];n.data[s]=r?Math.abs(e):Math.max(e,0)}return n}function rc(t,e={}){let{bitDepth:i=this.bitDepth,channels:r}=e;if(this.checkProcessable("hypotenuse",{bitDepth:[8,16,32]}),this.width!==t.width||this.height!==t.height)throw new Error("hypotenuse: both images must have the same size");if(this.alpha!==t.alpha||this.bitDepth!==t.bitDepth)throw new Error("hypotenuse: both images must have the same alpha and bitDepth");if(this.channels!==t.channels)throw new Error("hypotenuse: both images must have the same number of channels");let n=dg.createFrom(this,{bitDepth:i});r=ku(this,{channels:r});let s=n.isClamped;for(let e=0;e<r.length;e++)for(let i=r[e];i<this.data.length;i+=this.channels){let e=Math.hypot(this.data[i],t.data[i]);n.data[i]=s?Math.min(Math.max(Math.round(e),0),n.maxValue):e}return n}function nc(t,e={}){let{channels:i}=e;if(this.checkProcessable("multiply",{bitDepth:[8,16]}),t<=0)throw new Error("multiply: the value must be greater than 0");if(i=ku(this,{channels:i}),t=Ju(t),isNaN(t)){if(this.data.length!==t.length)throw new Error("multiply: the data size is different");for(let e=0;e<i.length;e++){let r=i[e];for(let e=0;e<this.data.length;e+=this.channels)this.data[e+r]=Math.max(0,Math.min(this.maxValue,this.data[e+r]*t[e+r]>>0))}}else for(let e=0;e<i.length;e++){let r=i[e];for(let e=0;e<this.data.length;e+=this.channels)this.data[e+r]=Math.min(this.maxValue,this.data[e+r]*t>>0)}return this}function sc(t,e={}){let{channels:i}=e;if(this.checkProcessable("divide",{bitDepth:[8,16]}),i=ku(this,{channels:i}),t=Ju(t),isNaN(t)){if(this.data.length!==t.length)throw new Error("divide: the: the data size is different");for(let e=0;e<i.length;e++){let r=i[e];for(let e=0;e<this.data.length;e+=this.channels)this.data[e+r]=Math.max(0,Math.min(this.maxValue,this.data[e+r]/t[e+r]>>0))}}else for(let e=0;e<i.length;e++){let r=i[e];for(let e=0;e<this.data.length;e+=this.channels)this.data[e+r]=Math.min(this.maxValue,this.data[e+r]/t>>0)}return this}var oc=__webpack_require__(4091);class ac{constructor(){if(new.target===ac)throw new Error("BaseRegression must be subclassed")}predict(t){if("number"==typeof t)return this._predict(t);if((0,oc.isAnyArray)(t)){const e=[];for(let i=0;i<t.length;i++)e.push(this._predict(t[i]));return e}throw new TypeError("x must be a number or array")}_predict(){throw new Error("_predict must be implemented")}train(){}toString(){return""}toLaTeX(){return""}score(t,e){if(!(0,oc.isAnyArray)(t)||!(0,oc.isAnyArray)(e)||t.length!==e.length)throw new Error("x and y must be arrays of the same length");const i=t.length,r=new Array(i);for(let e=0;e<i;e++)r[e]=this._predict(t[e]);let n=0,s=0,o=0,a=0,h=0,l=0,u=0;for(let t=0;t<i;t++)n+=r[t],s+=e[t],h+=r[t]*r[t],l+=e[t]*e[t],u+=r[t]*e[t],0!==e[t]&&(o+=(e[t]-r[t])*(e[t]-r[t])/e[t]),a+=(e[t]-r[t])*(e[t]-r[t]);const c=(i*u-n*s)/Math.sqrt((i*h-n*n)*(i*l-s*s));return{r:c,r2:c*c,chi2:o,rmsd:Math.sqrt(a/i)}}}var hc=__webpack_require__(6952),lc=__webpack_require__.n(hc);const uc={lambda:.1,kernelType:"gaussian",kernelOptions:{},computeCoefficient:!1};class cc extends ac{constructor(t,e,i){if(super(),!0===t)this.alpha=e.alpha,this.inputs=e.inputs,this.kernelType=e.kernelType,this.kernelOptions=e.kernelOptions,this.kernel=new(lc())(e.kernelType,e.kernelOptions);else{t=Ou.checkMatrix(t),i=Object.assign({},uc,i);const r=new(lc())(i.kernelType,i.kernelOptions),n=r.compute(t),s=t.rows;n.add(Ou.eye(s,s).mul(i.lambda)),this.alpha=Xu(n,e),this.inputs=t,this.kernelType=i.kernelType,this.kernelOptions=i.kernelOptions,this.kernel=r}}_predict(t){return this.kernel.compute([t],this.inputs).mmul(this.alpha).getRow(0)}toJSON(){return{name:"kernelRidgeRegression",alpha:this.alpha,inputs:this.inputs,kernelType:this.kernelType,kernelOptions:this.kernelOptions}}static load(t){if("kernelRidgeRegression"!==t.name)throw new TypeError("not a KRR model");return new cc(!0,t)}}function dc(t,e,i){const r=new cc(t,e,i),n=new Array(this.size);for(let t=0;t<this.width;t++)for(let e=0;e<this.height;e++)n[e*this.width+t]=[t,e];const s=r.predict(n),o=dg.createFrom(this);for(let t=0;t<this.size;t++)o.data[t]=Math.min(this.maxValue,Math.max(0,s[t][0]));return o}function fc(t={}){let{kernel:e=[[1,1,1],[1,1,1],[1,1,1]],iterations:i=1}=t;if(this.checkProcessable("dilate",{bitDepth:[1,8,16],components:1,alpha:0}),e.columns%2==0||e.rows%2==0)throw new TypeError("dilate: The number of rows and columns of the kernel must be odd");let r=!0;t:for(const t of e)for(const e of t)if(1!==e){r=!1;break t}let n=this;for(let t=0;t<i;t++)if(1===this.bitDepth)if(r){const t=n.clone();n=wc(n,t,e.length,e[0].length)}else n=pc(n,dg.createFrom(n),e);else n=r?mc(n,dg.createFrom(n),e.length,e[0].length):gc(n,dg.createFrom(n),e);return n}function gc(t,e,i){const r=i.length,n=i[0].length;let s=(r-1)/2,o=(n-1)/2;for(let a=0;a<t.height;a++)for(let h=0;h<t.width;h++){let l=0;for(let e=0;e<n;e++)for(let n=0;n<r;n++){if(1!==i[n][e])continue;let r=n-s+h,u=e-o+a;if(r<0||u<0||r>=t.width||u>=t.height)continue;const c=t.getValueXY(r,u,0);c>l&&(l=c)}e.setValueXY(h,a,0,l)}return e}function mc(t,e,i,r){const n=(i-1)/2,s=(r-1)/2,o=[];for(let e=0;e<t.width;e++)o.push(0);for(let i=0;i<t.height;i++){for(let e=0;e<t.width;e++){let r=0;for(let n=Math.max(0,i-s);n<Math.min(t.height,i+s+1);n++){const i=t.getValueXY(e,n,0);i>r&&(r=i)}o[e]=r}for(let r=0;r<t.width;r++){let s=0;for(let e=Math.max(0,r-n);e<Math.min(t.width,r+n+1);e++)o[e]>s&&(s=o[e]);e.setValueXY(r,i,0,s)}}return e}function pc(t,e,i){const r=i.length,n=i[0].length;let s=(r-1)/2,o=(n-1)/2;for(let a=0;a<t.height;a++)for(let h=0;h<t.width;h++){let l=0;t:for(let e=0;e<n;e++)for(let n=0;n<r;n++){if(1!==i[n][e])continue;let r=n-s+h,u=e-o+a;if(!(u<0||r<0||r>=t.width||u>=t.height)&&1===t.getBitXY(r,u)){l=1;break t}}1===l&&e.setBitXY(h,a)}return e}function wc(t,e,i,r){const n=(i-1)/2,s=(r-1)/2,o=[];for(let e=0;e<t.width;e++)o.push(1);for(let i=0;i<t.height;i++){for(let e=0;e<t.width;e++){o[e]=0;for(let r=Math.max(0,i-s);r<Math.min(t.height,i+s+1);r++)if(1===t.getBitXY(e,r)){o[e]=1;break}}for(let r=0;r<t.width;r++)if(1!==e.getBitXY(r,i))for(let s=Math.max(0,r-n);s<Math.min(t.width,r+n+1);s++)if(1===o[s]){e.setBitXY(r,i);break}}return e}function _c(t={}){let{kernel:e=[[1,1,1],[1,1,1],[1,1,1]],iterations:i=1}=t;if(this.checkProcessable("erode",{bitDepth:[1,8,16],components:1,alpha:0}),e.columns%2==0||e.rows%2==0)throw new TypeError("erode: The number of rows and columns of the kernel must be odd");let r=!0;t:for(const t of e)for(const e of t)if(1!==e){r=!1;break t}let n=this;for(let t=0;t<i;t++)if(1===this.bitDepth)if(r){const t=n.clone();n=xc(n,t,e.length,e[0].length)}else n=vc(n,dg.createFrom(n),e);else n=r?yc(n,dg.createFrom(n),e.length,e[0].length):bc(n,dg.createFrom(n),e);return n}function bc(t,e,i){const r=i.length,n=i[0].length;let s=(r-1)/2,o=(n-1)/2;for(let a=0;a<t.height;a++)for(let h=0;h<t.width;h++){let l=t.maxValue;for(let e=0;e<n;e++)for(let n=0;n<r;n++){if(1!==i[n][e])continue;let r=n-s+h,u=e-o+a;if(r<0||u<0||r>=t.width||u>=t.height)continue;const c=t.getValueXY(r,u,0);c<l&&(l=c)}e.setValueXY(h,a,0,l)}return e}function yc(t,e,i,r){const n=(i-1)/2,s=(r-1)/2,o=[];for(let e=0;e<t.width;e++)o.push(0);for(let i=0;i<t.height;i++){for(let e=0;e<t.width;e++){let r=t.maxValue;for(let n=Math.max(0,i-s);n<Math.min(t.height,i+s+1);n++){const i=t.getValueXY(e,n,0);i<r&&(r=i)}o[e]=r}for(let r=0;r<t.width;r++){let s=t.maxValue;for(let e=Math.max(0,r-n);e<Math.min(t.width,r+n+1);e++)o[e]<s&&(s=o[e]);e.setValueXY(r,i,0,s)}}return e}function vc(t,e,i){const r=i.length,n=i[0].length;let s=(r-1)/2,o=(n-1)/2;for(let a=0;a<t.height;a++)for(let h=0;h<t.width;h++){let l=1;t:for(let e=0;e<n;e++)for(let n=0;n<r;n++){if(1!==i[n][e])continue;let r=n-s+h,u=e-o+a;if(!(u<0||r<0||r>=t.width||u>=t.height)&&0===t.getBitXY(r,u)){l=0;break t}}1===l&&e.setBitXY(h,a)}return e}function xc(t,e,i,r){const n=(i-1)/2,s=(r-1)/2,o=[];for(let e=0;e<t.width;e++)o.push(0);for(let i=0;i<t.height;i++){for(let e=0;e<t.width;e++){o[e]=1;for(let r=Math.max(0,i-s);r<Math.min(t.height,i+s+1);r++)if(0===t.getBitXY(e,r)){o[e]=0;break}}for(let r=0;r<t.width;r++)if(0!==e.getBitXY(r,i))for(let s=Math.max(0,r-n);s<Math.min(t.width,r+n+1);s++)if(0===o[s]){e.clearBitXY(r,i);break}}return e}function Mc(t={}){let{kernel:e=[[1,1,1],[1,1,1],[1,1,1]],iterations:i=1}=t;if(this.checkProcessable("open",{bitDepth:[8,16],components:1,alpha:0}),e.columns%2==0||e.rows%2==0)throw new TypeError("open: The number of rows and columns of the kernel must be odd");let r=this;for(let t=0;t<i;t++)r=r.erode({kernel:e}),r=r.dilate({kernel:e});return r}function kc(t={}){let{kernel:e=[[1,1,1],[1,1,1],[1,1,1]],iterations:i=1}=t;if(this.checkProcessable("close",{bitDepth:[1,8,16],components:1,alpha:0}),e.columns%2==0||e.rows%2==0)throw new TypeError("close: The number of rows and columns of the kernel must be odd");let r=this;for(let t=0;t<i;t++)r=r.dilate({kernel:e}).erode({kernel:e});return r}function Ec(t={}){let{kernel:e=[[1,1,1],[1,1,1],[1,1,1]],iterations:i=1}=t;if(this.checkProcessable("topHat",{bitDepth:[8,16],components:1,alpha:0}),e.length%2==0||e[0].length%2==0)throw new TypeError("topHat: The number of rows and columns of the kernel must be odd");let r=this;for(let t=0;t<i;t++){let t=r.open({kernel:e});r=t.subtractImage(r,{absolute:!0})}return r}function Cc(t={}){let{kernel:e=[[1,1,1],[1,1,1],[1,1,1]],iterations:i=1}=t;if(this.checkProcessable("blackHat",{bitDepth:[8,16],components:1,alpha:0}),e.columns%2==0||e.rows%2==0)throw new TypeError("blackHat: The number of rows and columns of the kernel must be odd");let r=this;for(let t=0;t<i;t++){const t=r.close({kernel:e});r=t.subtractImage(r,{absolute:!0})}return r}function Sc(t={}){let{kernel:e=[[1,1,1],[1,1,1],[1,1,1]],iterations:i=1}=t;if(this.checkProcessable("morphologicalGradient",{bitDepth:[8,16],components:1,alpha:0}),e.columns%2==0||e.rows%2==0)throw new TypeError("morphologicalGradient: The number of rows and columns of the kernel must be odd");let r=this;for(let t=0;t<i;t++){let t=r.dilate({kernel:e}),i=r.erode({kernel:e});r=t.subtractImage(i,{absolute:!0})}return r}function Ac(t,e){return Math.sqrt(Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2))}function Tc(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function Rc(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Pc(t,e,i,r,n,s,o,a,h,l,u,c){let[d,f]=[(i*t+r*e+n)/(h*t+l*e+1),(s*t+o*e+a)/(h*t+l*e+1)];return u.getValueXY(Math.floor(d),Math.floor(f),c)}function Ic(t,e={}){let{calculateRatio:i=!0}=e;if(4!==t.length)throw new Error(`The array pts must have four elements, which are the four corners. Currently, pts have ${t.length} elements`);let r,n,[s,o,a,h]=t,l=[s,o,a,h],[u,c,d,f]=function(t){let e=0,i=0,r=0,n=0,s=t[0][0],o=0;for(let e=1;e<t.length;e++)t[e][0]<s&&(s=t[e][0],o=e);let a=t[(o+1)%t.length][0],h=(o+1)%t.length;for(let e=1;e<t.length;e++)t[e][0]<a&&e!==o&&(a=t[e][0],h=e);return t[h][1]<t[o][1]?(e=t[h],n=t[o],o!==(h+1)%4?(i=t[(h+1)%4],r=t[(h+2)%4]):(i=t[(h+2)%4],r=t[(h+3)%4])):(n=t[h],e=t[o],h!==(o+1)%4?(i=t[(o+1)%4],r=t[(o+2)%4]):(i=t[(o+2)%4],r=t[(o+3)%4])),[e,i,r,n]}(l);i?[r,n]=function(t,e,i,r,n,s){let o=Math.max(Ac(t,e),Ac(r,i)),a=Math.max(Ac(t,r),Ac(e,i)),h=0,l=0,u=Math.ceil(n/2),c=Math.ceil(s/2),d=o/a,f=[t[0],t[1],1],g=[e[0],e[1],1],m=[r[0],r[1],1],p=[i[0],i[1],1],w=Rc(Tc(f,p),m)/Rc(Tc(g,p),m),_=Rc(Tc(f,p),g)/Rc(Tc(m,p),g),b=[w*g[0]-f[0],w*g[1]-f[1],w*g[2]-f[2]],y=[_*m[0]-f[0],_*m[1]-f[1],_*m[2]-f[2]],v=b[0],x=b[1],M=b[2],k=y[0],E=y[1],C=y[2],S=1/(M*C)*(v*k-(v*C+M*k)*u+M*C*u*u+(x*E-(x*C+M*E)*c+M*C*c*c));S=S>=0?Math.sqrt(S):Math.sqrt(-S);let A=new Ou([[S,0,u],[0,S,c],[0,0,1]]),T=A.transpose(),R=Yu(T),P=Yu(A),I=Ou.rowVector(b),D=Ou.rowVector(y),L=Math.sqrt(Rc(I.mmul(R).mmul(P).to1DArray(),b)/Rc(D.mmul(R).mmul(P).to1DArray(),y));return 0===L||0===d?(h=Math.ceil(o),l=Math.ceil(a)):L<d?(h=Math.ceil(o),l=Math.ceil(h/L)):(l=Math.ceil(a),h=Math.ceil(L*l)),[h,l]}(u,c,d,f,this.width,this.height):(r=Math.ceil(Math.max(Ac(u,c),Ac(f,d))),n=Math.ceil(Math.max(Ac(u,f),Ac(c,d))));let g=dg.createFrom(this,{width:r,height:n}),[m,p]=u,[w,_]=c,[b,y]=d,[v,x]=f,[M,k]=[0,0],[E,C]=[0,r-1],[S,A]=[n-1,r-1],[T,R]=[n-1,0],P=new Ou([[M,k,1,0,0,0,-M*m,-k*m],[E,C,1,0,0,0,-E*w,-C*w],[S,A,1,0,0,0,-S*b,-k*b],[T,R,1,0,0,0,-T*v,-R*v],[0,0,0,M,k,1,-M*p,-k*p],[0,0,0,E,C,1,-E*_,-C*_],[0,0,0,S,A,1,-S*y,-A*y],[0,0,0,T,R,1,-T*x,-R*x]]),I=Ou.columnVector([m,w,b,v,p,_,y,x]),D=new Vu(P).solve(I),[L,F,z,B,N,O,U,V]=D.to1DArray(),Y=new Ou(n,r);for(let t=0;t<this.channels;t++){for(let e=0;e<n;e++)for(let i=0;i<r;i++)Y.set(e,i,Pc(e,i,L,F,z,B,N,O,U,V,this,t));g.setMatrix(Y,{channel:t})}return g}function Dc(t={}){let{x:e=0,y:i=0,width:r=this.width-e,height:n=this.height-i}=t;if(this.checkProcessable("crop",{bitDepth:[1,8,16]}),e=Math.round(e),i=Math.round(i),r=Math.round(r),n=Math.round(n),e>this.width-1||i>this.height-1)throw new RangeError(`crop: origin (x:${e}, y:${i}) out of range (${this.width-1}; ${this.height-1})`);if(r<=0||n<=0)throw new RangeError(`crop: width and height (width:${r}; height:${n}) must be positive numbers`);if(e<0||i<0)throw new RangeError(`crop: x and y (x:${e}, y:${i}) must be positive numbers`);if(r>this.width-e||n>this.height-i)throw new RangeError(`crop: (x: ${e}, y:${i}, width:${r}, height:${n}) size is out of range`);let s=this;return s=1===this.bitDepth?function(t,e,i,r,n,s){let o=n*t.channels,a=r+s,h=0,l=i*t.channels;for(let i=r;i<a;i++){let r=i*t.width*t.channels+l,n=r+o;for(;r<n;r++)t.getBit(r)&&e.setBit(h),++h}return e}(this,new dg(r,n,{kind:"BINARY",parent:this}),e,i,r,n):function(t,e,i,r,n,s){let o=n*t.channels,a=r+s,h=0,l=i*t.channels;for(let i=r;i<a;i++){let r=i*t.width*t.channels+l,n=r+o;for(;r<n;r++)e.data[h++]=t.data[r]}return e}(this,dg.createFrom(this,{width:r,height:n,position:[e,i]}),e,i,r,n),s}function Lc(t={}){this.checkProcessable("cropAlpha",{alpha:1});const{threshold:e=this.maxValue}=t;let i=function(t,e,i){for(let r=0;r<t.width;r++)for(let n=0;n<t.height;n++)if(t.getValueXY(r,n,i)>=e)return r;return-1}(this,e,this.components);if(-1===i)throw new Error("Could not find new dimensions. Threshold may be too high.");let r=function(t,e,i,r){for(let n=0;n<t.height;n++)for(let s=r;s<t.width;s++)if(t.getValueXY(s,n,i)>=e)return n;return-1}(this,e,this.components,i),n=function(t,e,i,r){for(let n=t.height-1;n>=0;n--)for(let s=r;s<t.width;s++)if(t.getValueXY(s,n,i)>=e)return n;return-1}(this,e,this.components,i),s=function(t,e,i,r,n,s){for(let o=t.width-1;o>=r;o--)for(let r=n;r<=s;r++)if(t.getValueXY(o,r,i)>=e)return o;return-1}(this,e,this.components,i,r,n);return this.crop({x:i,y:r,width:s-i+1,height:n-r+1})}function Fc(t,e){if(e<0||e>=t.channels)throw new RangeError(`channel must be included between 0 and ${t.channels-1}. Current value: ${e}`)}const zc={nearestneighbor:"nearestNeighbor",nearestneighbour:"nearestNeighbor",bilinear:"bilinear"};function Bc(t){if("string"!=typeof t)throw new TypeError("interpolation must be a string");if(t=t.toLowerCase(),!zc[t])throw new RangeError(`invalid interpolation algorithm: ${t}`);return zc[t]}function Nc(t,e,i){const r=this.width/e,n=this.height/i;if(this.bitDepth>1)for(let s=0;s<e;s++){const e=Math.floor((s+.5)*r);for(let r=0;r<i;r++){const i=Math.floor((r+.5)*n);for(let n=0;n<this.channels;n++)t.setValueXY(s,r,n,this.getValueXY(e,i,n))}}else for(let s=0;s<e;s++){const e=Math.floor((s+.5)*r);for(let r=0;r<i;r++){const i=Math.floor((r+.5)*n);this.getBitXY(e,i)&&t.setBitXY(s,r)}}}function Oc(t={}){const{factor:e=1,interpolation:i=zc.nearestneighbor,preserveAspectRatio:r=!0}=t,n=Bc(i);let s=t.width,o=t.height;if(s||(s=o&&r?Math.round(o*(this.width/this.height)):this.width),o||(o=r?Math.round(s*(this.height/this.width)):this.height),({width:s,height:o}=function(t,e,i){t=function(t){if("string"==typeof t){const e=t[t.length-1];t=parseFloat(t),"%"===e&&(t/=100)}return t}(t);let r=Math.round(t*e),n=Math.round(t*i);return r<=0&&(r=1),n<=0&&(n=1),{width:r,height:n}}(e,s,o)),s===this.width&&o===this.height){const t=this.clone();return t.position=[0,0],t}let a=Math.round((this.width-s)/2),h=Math.round((this.height-o)/2);const l=dg.createFrom(this,{width:s,height:o,position:[a,h]});if(n!==zc.nearestneighbor)throw new Error(`unsupported resize interpolation: ${n}`);return Nc.call(this,l,s,o),l}function Uc(){this.checkProcessable("hsv",{bitDepth:[8,16],alpha:[0,1],colorModel:[pl]});let t=dg.createFrom(this,{colorModel:_l}),e=0,i=this.data;for(let r=0;r<i.length;r+=this.channels){let n=i[r],s=i[r+1],o=i[r+2],a=Math.min(n,s,o),h=Math.max(n,s,o),l=h-a,u=0,c=0===h?0:l/h,d=h;if(h!==a){switch(h){case n:u=(s-o)/l+(s<o?6:0);break;case s:u=(o-n)/l+2;break;case o:u=(n-s)/l+4;break;default:throw new Error("unreachable")}u/=6}t.data[e++]=u*this.maxValue,t.data[e++]=c*this.maxValue,t.data[e++]=d,this.alpha&&(t.data[e++]=i[r+3])}return t}function Vc(){this.checkProcessable("hsl",{bitDepth:[8,16],alpha:[0,1],colorModel:[pl]});let t=dg.createFrom(this,{colorModel:wl}),e=Math.floor(this.maxValue/2),i=0,r=this.data;for(let n=0;n<r.length;n+=this.channels){let s=r[n],o=r[n+1],a=r[n+2],h=Math.max(s,o,a),l=Math.min(s,o,a),u=0,c=0,d=(h+l)/2;if(h!==l){let t=h-l;switch(c=d>e?t/(2-h-l):t/(h+l),h){case s:u=(o-a)/t+(o<a?6:0);break;case o:u=(a-s)/t+2;break;case a:u=(s-o)/t+4;break;default:throw new Error("unreachable")}u/=6}t.data[i++]=u*this.maxValue,t.data[i++]=c*this.maxValue,t.data[i++]=d,this.alpha&&(t.data[i++]=r[n+3])}return t}function Yc(){this.checkProcessable("cmyk",{bitDepth:[8,16],alpha:[0,1],colorModel:[pl]});let t=dg.createFrom(this,{components:4,colorModel:bl}),e=0,i=this.data;for(let r=0;r<i.length;r+=this.channels){let n=i[r],s=i[r+1],o=i[r+2],a=Math.min(this.maxValue-n,this.maxValue-s,this.maxValue-o),h=(this.maxValue-n-a)/(1-a/this.maxValue),l=(this.maxValue-s-a)/(1-a/this.maxValue),u=(this.maxValue-o-a)/(1-a/this.maxValue);t.data[e++]=Math.round(h),t.data[e++]=Math.round(l),t.data[e++]=Math.round(u),t.data[e++]=Math.round(a),this.alpha&&(t.data[e++]=i[r+3])}return t}function Xc(){return new dg(this.width,this.height,this.getRGBAData(),{kind:"RGBA",parent:this})}const jc={luma709:(t,e,i)=>6966*t+23436*e+2366*i>>15,luma601:(t,e,i)=>9798*t+19235*e+3735*i>>15,maximum:(t,e,i)=>Math.max(t,e,i),minimum:(t,e,i)=>Math.min(t,e,i),average:(t,e,i)=>(t+e+i)/3>>0,minmax:(t,e,i)=>(Math.max(t,e,i)+Math.min(t,e,i))/2,red:t=>t,green:(t,e)=>e,blue:(t,e,i)=>i,cyan(t,e,i,r){let n=jc.black(t,e,i,r);return(r.maxValue-t-n)/(1-n/r.maxValue)>>0},magenta(t,e,i,r){let n=jc.black(t,e,i,r);return(r.maxValue-e-n)/(1-n/r.maxValue)>>0},yellow(t,e,i,r){let n=jc.black(t,e,i,r);return(r.maxValue-i-n)/(1-n/r.maxValue)>>0},black:(t,e,i,r)=>Math.min(r.maxValue-t,r.maxValue-e,r.maxValue-i),hue(t,e,i,r){let n=jc.min(t,e,i),s=jc.max(t,e,i);if(s===n)return 0;let o=0,a=s-n;switch(s){case t:o=(e-i)/a+(e<i?6:0);break;case e:o=(i-t)/a+2;break;case i:o=(t-e)/a+4;break;default:throw new Error("unreachable")}return o/6*r.maxValue>>0},saturation(t,e,i,r){let n=jc.min(t,e,i),s=jc.max(t,e,i);return 0===s?0:(s-n)/s*r.maxValue},lightness(t,e,i){let r=jc.min(t,e,i);return(jc.max(t,e,i)+r)/2}};Object.defineProperty(jc,"luminosity",{enumerable:!1,value:jc.lightness}),Object.defineProperty(jc,"luminance",{enumerable:!1,value:jc.lightness}),Object.defineProperty(jc,"min",{enumerable:!1,value:jc.minimum}),Object.defineProperty(jc,"max",{enumerable:!1,value:jc.maximum}),Object.defineProperty(jc,"brightness",{enumerable:!1,value:jc.maximum});const Gc={};function qc(t={}){let{algorithm:e="luma709",keepAlpha:i=!1,mergeAlpha:r=!0}=t;if("string"!=typeof e&&"function"!=typeof e)throw new TypeError("algorithm must be a string or a function");this.checkProcessable("grey",{bitDepth:[8,16],alpha:[0,1]}),1===this.components&&(e="red"),i&=this.alpha,r&=this.alpha,i&&(r=!1);let n,s=mu(this,t,{components:1,alpha:i,colorModel:ml});if("function"==typeof e)n=e;else if(n=jc[e.toLowerCase()],!n)throw new Error(`unsupported grey algorithm: ${e}`);let o=0;for(let t=0;t<this.data.length;t+=this.channels)r?s.data[o++]=Fu(n(this.data[t],this.data[t+1],this.data[t+2],this)*this.data[t+this.components]/this.maxValue,this):(s.data[o++]=Fu(n(this.data[t],this.data[t+1],this.data[t+2],this),this),s.alpha&&(s.data[o++]=this.data[t+this.components]));return s}function Zc(t){let e=!1,i=0;for(let e=1;e<t.length-1;e++)if(t[e-1]<t[e]&&t[e+1]<t[e]&&(i++,i>2))return!1;return 2===i&&(e=!0),e}function Kc(t,e){let i=0;for(let r=0;r<=e;r++)i+=t[r];return i}function Hc(t,e){let i=0;for(let r=0;r<=e;r++)i+=r*t[r];return i}function Wc(t,e){let i=0;for(let r=0;r<=e;r++)i+=r*r*t[r];return i}function $c(t){let e=new Array(t.length);for(let i=1;i<t.length-1;i++)e[i]=(t[i-1]+t[i]+t[i+1])/3;return e[0]=(t[0]+t[1])/3,e[t.length-1]=(t[t.length-2]+t[t.length-1])/3,e}function Qc(t){let e=t.length,i=!1,r=0;for(let i=1;i<e-1;i++)if(t[i-1]<t[i]&&t[i+1]<t[i]&&(r++,r>2))return!1;return 2===r&&(i=!0),i}function Jc(t,e){let i=0;for(let r=0;r<=e;r++)i+=t[r];return i}Object.keys(jc).forEach((t=>{Gc[t]=t}));const td={huang:function(t){let e=0;for(let i=0;i<t.length;i++)if(0!==t[i]){e=i;break}let i=t.length-1;for(let r=t.length-1;r>=e;r--)if(0!==t[r]){i=r;break}let r=1/(i-e),n=new Array(t.length),s=0,o=0;for(let i=e;i<t.length;i++)s+=i*t[i],o+=t[i],n[i]=s/o;let a=new Array(t.length);s=o=0;for(let e=i;e>0;e--)s+=e*t[e],o+=t[e],a[e-1]=s/o;let h=-1,l=Number.MAX_VALUE;for(let e=0;e<t.length;e++){let i,s=0;for(let o=0;o<=e;o++)i=1/(1+r*Math.abs(o-n[e])),i<1e-6||i>.999999||(s+=t[o]*(-i*Math.log(i)-(1-i)*Math.log(1-i)));for(let n=e+1;n<t.length;n++)i=1/(1+r*Math.abs(n-a[e])),i<1e-6||i>.999999||(s+=t[n]*(-i*Math.log(i)-(1-i)*Math.log(1-i)));s<l&&(l=s,h=e)}return h},intermodes:function(t){let e=t.slice(),i=0;for(;!Zc(e);){let r=0,n=0,s=e[0];for(let i=0;i<t.length-1;i++)r=n,n=s,s=e[i+1],e[i]=(r+n+s)/3;if(e[t.length-1]=(n+s)/3,i++,i>1e4)throw new Error("Intermodes Threshold not found after 10000 iterations")}let r=0;for(let i=1;i<t.length-1;i++)e[i-1]<e[i]&&e[i+1]<e[i]&&(r+=i);return Math.floor(r/2)},isodata:function(t){let e,i,r,n,s=0;for(let e=1;e<t.length;e++)if(t[e]>0){s=e+1;break}for(;;){e=0,r=0;for(let i=0;i<s;i++)r+=t[i],e+=t[i]*i;n=0,i=0;for(let e=s+1;e<t.length;e++)i+=t[e],n+=t[e]*e;if(r>0&&i>0&&(e/=r,n/=i,s===Math.round((e+n)/2)))break;if(s++,s>t.length-2)throw new Error("Threshold not found")}return s},li:function(t,e){let i,r,n,s,o,a,h,l,u,c,d,f;d=.5,c=0;for(let e=0;e<t.length;e++)c+=e*t[e];c/=e,h=c;do{a=h,i=a+.5|0,r=0,s=0;for(let e=0;e<=i;e++)r+=e*t[e],s+=t[e];l=0===s?0:r/s,n=0,o=0;for(let e=i+1;e<t.length;e++)n+=e*t[e],o+=t[e];u=0===o?0:n/o,f=(l-u)/(Math.log(l)-Math.log(u)),h=f<-Number.EPSILON?f-.5|0:f+.5|0}while(Math.abs(h-a)>.5);return i},maxentropy:function(t,e){let i=new Array(t.length);for(let r=0;r<t.length;r++)i[r]=t[r]/e;let r=new Array(t.length),n=new Array(t.length);r[0]=i[0],n[0]=1-r[0];for(let e=1;e<t.length;e++)r[e]=r[e-1]+i[e],n[e]=1-r[e];let s=0;for(let e=0;e<t.length;e++)if(Math.abs(r[e])>=Number.EPSILON){s=e;break}let o=t.length-1;for(let e=t.length-1;e>=s;e--)if(Math.abs(n[e])>=Number.EPSILON){o=e;break}let a,h,l,u=-1,c=Number.MIN_VALUE;for(let e=s;e<=o;e++){h=0;for(let n=0;n<=e;n++)0!==t[n]&&(h-=i[n]/r[e]*Math.log(i[n]/r[e]));l=0;for(let r=e+1;r<t.length;r++)0!==t[r]&&(l-=i[r]/n[e]*Math.log(i[r]/n[e]));a=h+l,c<a&&(c=a,u=e)}return u},mean:function(t,e){let i=0;for(let e=0;e<t.length;e++)i+=e*t[e];return Math.floor(i/e)},minerror:function(t,e){let i,r,n,s,o,a,h,l,u,c,d,f,g=-2,m=0;for(let e=0;e<t.length;e++)m+=e*t[e];for(m/=e,i=m;i!==g;){let e=Kc(t,i),m=Kc(t,t.length-1),p=Hc(t,i),w=Hc(t,t.length-1),_=Wc(t,i);if(r=p/e,n=(w-p)/(m-e),s=e/m,o=(m-e)/m,a=_/e-r*r,h=(Wc(t,t.length-1)-_)/(m-e)-n*n,l=1/a-1/h,u=r/a-n/h,c=r*r/a-n*n/h+Math.log10(a*(o*o)/(h*(s*s))),d=u*u-l*c,d<0)return i;g=i,f=(u+Math.sqrt(d))/l,i=isNaN(f)?g:Math.floor(f)}return i},minimum:function(t){if(t.length<2)return 0;let e=0,i=-1,r=-1,n=new Array(t.length);for(let e=0;e<t.length;e++)n[e]=t[e],t[e]>0&&(r=e);for(;!Qc(n);)if(n=$c(n),e++,e>1e4)return i;return i=function(t,e){let i;for(let r=1;r<e;r++)if(t[r-1]>t[r]&&t[r+1]>=t[r]){i=r;break}return i}(n,r),i},moments:function(t,e){let i,r,n,s,o,a,h=0,l=0,u=0,c=0,d=-1,f=t.length,g=new Array(f);for(let i=0;i<f;i++)g[i]=t[i]/e;for(let t=0;t<f;t++)h+=t*g[t],l+=t*t*g[t],u+=t*t*t*g[t];r=1*l-h*h,n=(-l*l+h*u)/r,s=(1*-u+l*h)/r,o=.5*(-s-Math.sqrt(s*s-4*n)),a=.5*(-s+Math.sqrt(s*s-4*n)),i=(a-h)/(a-o);for(let t=0;t<f;t++)if(c+=g[t],c>i){d=t;break}return d},otsu:function(t,e){let i=0,r=0,n=0,s=0,o=0;for(let e=0;e<t.length;e++)o+=e*t[e];for(let a=0;a<t.length;a++){r+=t[a];const h=e-r;if(0===r||0===h)continue;i+=a*t[a];const l=(o-i)/h,u=r*h*(i/r-l)*(i/r-l);u>=n&&(s=a,n=u)}return s},percentile:function(t){let e=-1,i=new Array(t.length),r=Jc(t,t.length-1),n=1;for(let s=0;s<t.length;s++)i[s]=Math.abs(Jc(t,s)/r-.5),i[s]<n&&(n=i[s],e=s);return e},renyientropy:function(t,e){let i,r,n,s=new Array(t.length),o=new Array(t.length),a=new Array(t.length),h=0,l=0,u=0,c=0,d=0,f=0;for(let i=0;i<t.length;i++)s[i]=t[i]/e;o[0]=s[0],a[0]=1-o[0];for(let e=1;e<t.length;e++)o[e]=o[e-1]+s[e],a[e]=1-o[e];r=0;for(let e=0;e<t.length;e++)if(Math.abs(o[e])>=Number.EPSILON){r=e;break}n=t.length-1;for(let e=t.length-1;e>=r;e--)if(Math.abs(a[e])>=Number.EPSILON){n=e;break}for(let e=r;e<=n;e++){let i=0,r=0,n=0;for(let a=0;a<=e;a++)0!==t[a]&&(i-=s[a]/o[e]*Math.log(s[a]/o[e])),r+=Math.sqrt(s[a]/o[e]),n+=s[a]*s[a]/(o[e]*o[e]);let g=0,m=0,p=0;for(let i=e+1;i<t.length;i++)0!==t[i]&&(g-=s[i]/a[e]*Math.log(s[i]/a[e])),m+=Math.sqrt(s[i]/a[e]),p+=s[i]*s[i]/(a[e]*a[e]);let w=i+g,_=2*(r*m>0?Math.log(r*m):0),b=-1*(n*p>0?Math.log(n*p):0);w>c&&(c=w,h=e),_>d&&(d=_,l=e),b>f&&(f=b,u=e)}let g,m=[h,l,u];m.sort(((t,e)=>t-e)),g=Math.abs(m[0]-m[1])<=5?Math.abs(m[1]-m[2])<=5?[1,2,1]:[0,1,3]:Math.abs(m[1]-m[2])<=5?[3,1,0]:[1,2,1];let p=o[m[2]]-o[m[0]];return i=Math.round(m[0]*(o[m[0]]+.25*p*g[0])+.25*m[1]*p*g[1]+m[2]*(a[m[2]]+.25*p*g[2])),i},shanbhag:function(t,e){let i=new Array(t.length);for(let r=0;r<t.length;r++)i[r]=t[r]/e;let r=new Array(t.length),n=new Array(t.length);r[0]=i[0],n[0]=1-r[0];for(let e=1;e<t.length;e++)r[e]=r[e-1]+i[e],n[e]=1-r[e];let s=0;for(let e=0;e<t.length;e++)if(Math.abs(r[e])>=Number.EPSILON){s=e;break}let o=t.length-1;for(let e=t.length-1;e>=s;e--)if(Math.abs(n[e])>=Number.EPSILON){o=e;break}let a,h,l,u,c=-1,d=Number.MAX_VALUE;for(let e=s;e<=o;e++){l=0,a=.5/r[e];for(let t=1;t<=e;t++)l-=i[t]*Math.log(1-a*r[t-1]);l*=a,u=0,a=.5/n[e];for(let r=e+1;r<t.length;r++)u-=i[r]*Math.log(1-a*n[r]);u*=a,h=Math.abs(l-u),h<d&&(d=h,c=e)}return c},triangle:function(t){let e=0,i=0,r=0,n=0;for(let i=0;i<t.length;i++)if(t[i]>0){e=i;break}e>0&&e--;for(let e=t.length-1;e>0;e--)if(t[e]>0){n=e;break}n<t.length-1&&n++;for(let e=0;e<t.length;e++)t[e]>i&&(r=e,i=t[e]);let s,o,a,h=!1;if(r-e<n-r){h=!0;let i=0,s=t.length-1;for(;i<s;){let e=t[i];t[i]=t[s],t[s]=e,i++,s--}e=t.length-1-n,r=t.length-1-r}if(e===r)return e;s=t[r],o=e-r,a=Math.sqrt(s*s+o*o),s/=a,o/=a,a=s*e+o*t[e];let l=e,u=0;for(let i=e+1;i<=r;i++){let e=s*i+o*t[i]-a;e>u&&(l=i,u=e)}if(l--,h){let e=0,i=t.length-1;for(;e<i;){let r=t[e];t[e]=t[i],t[i]=r,e++,i--}return t.length-1-l}return l},yen:function(t,e){let i=new Array(t.length);for(let r=0;r<t.length;r++)i[r]=t[r]/e;let r=new Array(t.length);r[0]=i[0];for(let e=1;e<t.length;e++)r[e]=r[e-1]+i[e];let n=new Array(t.length);n[0]=i[0]*i[0];for(let e=1;e<t.length;e++)n[e]=n[e-1]+i[e]*i[e];let s=new Array(t.length);s[t.length-1]=0;for(let e=t.length-2;e>=0;e--)s[e]=s[e+1]+i[e+1]*i[e+1];let o,a=-1,h=Number.MIN_VALUE;for(let e=0;e<t.length;e++)o=-1*(n[e]*s[e]>0?Math.log(n[e]*s[e]):0)+2*(r[e]*(1-r[e])>0?Math.log(r[e]*(1-r[e])):0),o>h&&(h=o,a=e);return a}},ed={};function id(t={}){let{algorithm:e=ed.otsu}=t;this.checkProcessable("getThreshold",{components:1,bitDepth:[8,16]});let i=td[e.toLowerCase()];if(i)return i(this.getHistogram(),this.size);throw new Error(`unknown thresholding algorithm: ${e}`)}Object.keys(td).forEach((t=>{ed[t]=t}));const rd="threshold";function nd(t={}){let{algorithm:e=rd,threshold:i=.5,useAlpha:r=!0,invert:n=!1}=t;this.checkProcessable("mask",{components:1,bitDepth:[8,16]}),i=e===rd?function(t,e){if(!e)throw Error("getThreshold : the maxValue should be specified");if("string"==typeof t){if("%"!==t[t.length-1])throw Error("getThreshold : if the value is a string it must finish by %");return parseFloat(t)/100*e}if("number"==typeof t)return t<1?t*e:t;throw Error("getThreshold : the value is not valid")}(i,this.maxValue):id.call(this,t);let s=new dg(this.width,this.height,{kind:"BINARY",parent:this}),o=0;if(this.alpha&&r)for(let t=0;t<this.data.length;t+=this.channels){let e=this.data[t]+(this.maxValue-this.data[t])*(this.maxValue-this.data[t+1])/this.maxValue;(n&&e<=i||!n&&e>=i)&&s.setBit(o),o++}else for(let t=0;t<this.data.length;t+=this.channels)(n&&this.data[t]<=i||!n&&this.data[t]>=i)&&s.setBit(o),o++;return s}function sd(t={}){let{size:e=0,algorithm:i="copy",color:r}=t;if(this.checkProcessable("pad",{bitDepth:[8,16]}),"set"===i){if(r.length!==this.channels)throw new Error(`pad: the color array must have the same length as the number of channels. Here: ${this.channels}`);for(let t=0;t<r.length;t++)0===r[t]&&(r[t]=.001)}else r=Hu()(this.channels,null);Array.isArray(e)||(e=[e,e]);let n=this.width+2*e[0],s=this.height+2*e[1],o=this.channels,a=dg.createFrom(this,{width:n,height:s});!function(t,e,i,r){let n=t.width,s=t.height,o=e.width,a=t.channels;for(let h=0;h<n;h++)for(let l=0;l<s;l++)for(let s=0;s<a;s++){let u=(l*n+h)*a+s,c=((r+l)*o+i+h)*a+s;e.data[c]=t.data[u]}}(this,a,e[0],e[1]);for(let t=e[0];t<n-e[0];t++)for(let i=0;i<o;i++){let h=r[i]||a.data[(e[1]*n+t)*o+i];for(let r=0;r<e[1];r++)a.data[(r*n+t)*o+i]=h;h=r[i]||a.data[((s-e[1]-1)*n+t)*o+i];for(let r=s-e[1];r<s;r++)a.data[(r*n+t)*o+i]=h}for(let t=0;t<s;t++)for(let i=0;i<o;i++){let s=r[i]||a.data[(t*n+e[0])*o+i];for(let r=0;r<e[0];r++)a.data[(t*n+r)*o+i]=s;s=r[i]||a.data[(t*n+n-e[0]-1)*o+i];for(let r=n-e[0];r<n;r++)a.data[(t*n+r)*o+i]=s}return a}function od(t=8){if(this.checkProcessable("colorDepth",{bitDepth:[1,8,16]}),![8,16].includes(t))throw Error("You need to specify the new colorDepth as 8 or 16");if(this.bitDepth===t)return this.clone();let e=dg.createFrom(this,{bitDepth:t});switch(t){case 8:if(1===this.bitDepth)for(let t=0;t<this.size;t++)this.getBit(t)&&(e.data[t]=255);else for(let t=0;t<this.data.length;t++)e.data[t]=this.data[t]>>8;break;case 16:if(1===this.bitDepth)for(let t=0;t<this.size;t++)this.getBit(t)&&(e.data[t]=65535);else for(let t=0;t<this.data.length;t++)e.data[t]=this.data[t]<<8|this.data[t];break;default:throw new Error("colorDepth conversion unexpected case")}return e}function ad(t,e={}){const{interpolation:i=zc.nearestneighbor,width:r=this.width,height:n=this.height}=e;if("number"!=typeof t)throw new TypeError("degrees must be a number");const s=Bc(i),o=t*Math.PI/180,a=Math.floor(Math.abs(r*Math.cos(o))+Math.abs(n*Math.sin(o))),h=Math.floor(Math.abs(n*Math.cos(o))+Math.abs(r*Math.sin(o))),l=Math.cos(-o),u=Math.sin(-o);let c=a/2,d=h/2;a%2==0?(c-=.5,h%2==0?d-=.5:d=Math.floor(d)):(c=Math.floor(c),h%2==0?d-=.5:d=Math.floor(d));const f=Math.floor(r/2-c),g=Math.floor(n/2-d);if(1===this.bitDepth){const t=new dg(a,h,{kind:"BINARY",parent:this});switch(s){case zc.nearestneighbor:return function(t,e,i,r,n,s,o,a){for(let h=0;h<e.width;h+=1)for(let l=0;l<e.height;l+=1){let u=Math.round((h-n)*o-(l-s)*a+n)+i,c=Math.round((l-s)*o+(h-n)*a+s)+r;(u<0||u>=t.width||c<0||c>=t.height||t.getBitXY(u,c))&&e.setBitXY(h,l)}return e}(this,t,f,g,c,d,l,u);case zc.bilinear:return function(t,e,i,r,n,s,o,a){let h=t.width;for(let l=0;l<e.height;l++)for(let u=0;u<e.width;u++){let c=(u-n)*o-(l-s)*a+n+i,d=(l-s)*o+(u-n)*a+s+r,f=0|c,g=0|d,m=c-f,p=d-g;if(c<0||c>=t.width||d<0||d>=t.height)e.setBitXY(u,l);else{let i=g*t.width+f,r=t.getBit(i),n=t.getBit(i+1),s=t.getBit(i+h);(r|m&n-r|p&s-r|m&p&r-n-s+t.getBit(i+1+h))>0&&e.setBitXY(u,l)}}return e}(this,t,f,g,c,d,l,u);default:throw new Error(`unsupported rotate interpolation: ${s}`)}}else{const t=dg.createFrom(this,{width:a,height:h});switch(s){case zc.nearestneighbor:return function(t,e,i,r,n,s,o,a){for(let h=0;h<e.width;h+=1)for(let l=0;l<e.height;l+=1)for(let u=0;u<t.channels;u++){let c=Math.round((h-n)*o-(l-s)*a+n)+i,d=Math.round((l-s)*o+(h-n)*a+s)+r;c<0||c>=t.width||d<0||d>=t.height?1===t.alpha&&u===t.channels-1?e.setValueXY(h,l,u,0):e.setValueXY(h,l,u,t.maxValue):e.setValueXY(h,l,u,t.getValueXY(c,d,u))}return e}(this,t,f,g,c,d,l,u);case zc.bilinear:return function(t,e,i,r,n,s,o,a){let h=t.width*t.channels;for(let l=0;l<e.height;l++)for(let u=0;u<e.width;u++){let c=(u-n)*o-(l-s)*a+n+i,d=(l-s)*o+(u-n)*a+s+r,f=0|c,g=0|d,m=c-f,p=d-g;for(let i=0;i<t.channels;i++)if(c<0||c>=t.width||d<0||d>=t.height)1===t.alpha&&i===t.channels-1?e.setValueXY(u,l,i,0):e.setValueXY(u,l,i,t.maxValue);else{let r=(g*t.width+f)*t.channels+i,n=t.data[r],s=t.data[r+t.channels],o=t.data[r+h],a=n+m*(s-n)+p*(o-n)+m*p*(n-s-o+t.data[r+h+t.channels])|0;e.setValueXY(u,l,i,a)}}return e}(this,t,f,g,c,d,l,u);default:throw new Error(`unsupported rotate interpolation: ${s}`)}}}function hd(t,e){if(this.checkProcessable("rotate",{bitDepth:[1,8,16]}),"number"!=typeof t)throw new TypeError("angle must be a number");switch(t<0&&(t=360*Math.ceil(-t/360)+t),t%360){case 0:return this.clone();case 90:return ud.call(this);case 180:return cd.call(this);case 270:return ld.call(this);default:return ad.call(this,t,e)}}function ld(){if(1===this.bitDepth){const t=new dg(this.height,this.width,{kind:"BINARY",parent:this}),e=t.height-1;for(let i=0;i<this.height;i++)for(let r=0;r<this.width;r++)this.getBitXY(r,i)&&t.setBitXY(i,e-r);return t}{const t=dg.createFrom(this,{width:this.height,height:this.width}),e=t.height-1;for(let i=0;i<this.height;i++)for(let r=0;r<this.width;r++)for(let n=0;n<this.channels;n++)t.setValueXY(i,e-r,n,this.getValueXY(r,i,n));return t}}function ud(){if(1===this.bitDepth){const t=new dg(this.height,this.width,{kind:"BINARY",parent:this}),e=t.width-1;for(let i=0;i<this.height;i++)for(let r=0;r<this.width;r++)this.getBitXY(r,i)&&t.setBitXY(e-i,r);return t}{const t=dg.createFrom(this,{width:this.height,height:this.width}),e=t.width-1;for(let i=0;i<this.height;i++)for(let r=0;r<this.width;r++)for(let n=0;n<this.channels;n++)t.setValueXY(e-i,r,n,this.getValueXY(r,i,n));return t}}function cd(){if(1===this.bitDepth){const t=new dg(this.width,this.height,{kind:"BINARY",parent:this}),e=t.width-1,i=t.height-1;for(let r=0;r<this.height;r++)for(let n=0;n<this.width;n++)this.getBitXY(n,r)&&t.setBitXY(e-n,i-r);return t}{const t=dg.createFrom(this),e=t.width-1,i=t.height-1;for(let r=0;r<this.height;r++)for(let n=0;n<this.width;n++)for(let s=0;s<this.channels;s++)t.setValueXY(e-n,i-r,s,this.getValueXY(n,r,s));return t}}function dd(t,e={}){const i=gu(t);this.checkProcessable("insert",i);let{x:r=0,y:n=0}=e;const s=pu(this,e,{copy:!0}),o=Math.min(s.height,n+t.height),a=Math.min(s.width,r+t.width);if(1===s.bitDepth)for(let e=n;e<o;e++)for(let i=r;i<a;i++)t.getBitXY(i-r,e-n)?s.setBitXY(i,e):s.clearBitXY(i,e);else for(let e=n;e<o;e++)for(let i=r;i<a;i++)s.setPixelXY(i,e,t.getPixelXY(i-r,e-n));return s}function fd(t={}){let{size:e=0,algorithm:i="copy",color:r}=t;if(this.checkProcessable("setBorder",{bitDepth:[8,16,32,64]}),"set"===i){if(r.length!==this.channels)throw new Error(`setBorder: the color array must have the same length as the number of channels. Here: ${this.channels}`);for(let t=0;t<r.length;t++)0===r[t]&&(r[t]=.001)}else r=Hu()(this.channels,null);Array.isArray(e)||(e=[e,e]);let n=e[0],s=e[1],o=this.channels;for(let t=n;t<this.width-n;t++)for(let e=0;e<o;e++){let i=r[e]||this.data[(t+this.width*s)*o+e];for(let r=0;r<s;r++)this.data[(r*this.width+t)*o+e]=i;i=r[e]||this.data[(t+this.width*(this.height-s-1))*o+e];for(let r=this.height-s;r<this.height;r++)this.data[(r*this.width+t)*o+e]=i}for(let t=0;t<this.height;t++)for(let e=0;e<o;e++){let i=r[e]||this.data[(t*this.width+n)*o+e];for(let r=0;r<n;r++)this.data[(t*this.width+r)*o+e]=i;i=r[e]||this.data[(t*this.width+this.width-n-1)*o+e];for(let r=this.width-n;r<this.width;r++)this.data[(t*this.width+r)*o+e]=i}return this}function gd(t={}){let{preserveAlpha:e=!0}=t;if(this.checkProcessable("split",{bitDepth:[8,16]}),1===this.components)return new au([this.clone()]);let i=new au,r=this.data;if(this.alpha&&e)for(let t=0;t<this.components;t++){let e=dg.createFrom(this,{components:1,alpha:!0,colorModel:ml}),n=0;for(let i=0;i<r.length;i+=this.channels)e.data[n++]=r[i+t],e.data[n++]=r[i+this.components];i.push(e)}else for(let t=0;t<this.channels;t++){let e=dg.createFrom(this,{components:1,alpha:!1,colorModel:ml}),n=0;for(let i=0;i<r.length;i+=this.channels)e.data[n++]=r[i+t];i.push(e)}return i}function md(t,e={}){let{keepAlpha:i=!1,mergeAlpha:r=!1}=e;i&=this.alpha,r&=this.alpha,this.checkProcessable("getChannel",{bitDepth:[8,16]}),t=Eu(this,t);let n=dg.createFrom(this,{components:1,alpha:i,colorModel:ml}),s=0;for(let e=0;e<this.data.length;e+=this.channels)r?n.data[s++]=this.data[e+t]*this.data[e+this.components]/this.maxValue:(n.data[s++]=this.data[e+t],i&&(n.data[s++]=this.data[e+this.components]));return n}function pd(t=wd,e={}){let{mergeAlpha:i=!1,keepAlpha:r=!1}=e;i&=this.alpha,r&=this.alpha,this.checkProcessable("combineChannels",{bitDepth:[8,16]});let n=dg.createFrom(this,{components:1,alpha:r,colorModel:ml}),s=0;for(let e=0;e<this.size;e++){let o=t(this.getPixel(e));i?n.data[s++]=o*this.data[e*this.channels+this.components]/this.maxValue:(n.data[s++]=o,r&&(n.data[s++]=this.data[e*this.channels+this.components]))}return n}function wd(t){return(t[0]+t[1]+t[2])/3}function _d(t,e){if(this.checkProcessable("setChannel",{bitDepth:[8,16]}),e.checkProcessable("setChannel (image parameter check)",{bitDepth:[this.bitDepth],alpha:[0],components:[1]}),e.width!==this.width||e.height!==this.height)throw new Error("Images must have exactly the same width and height");let i=t=Eu(this,t);for(let t=0;t<e.data.length;t++)this.data[i]=e.data[t],i+=this.channels;return this}function bd(t,e={}){let{shift:i=[0,0],average:r,channels:n,defaultAlpha:s,normalize:o,border:a=[0,0]}=e;if(this.checkProcessable("getSimilarity",{bitDepth:[8,16]}),Array.isArray(a)||(a=[a,a]),n=ku(this,{channels:n,defaultAlpha:s}),this.bitDepth!==t.bitDepth)throw new Error("Both images must have the same bitDepth");if(this.channels!==t.channels)throw new Error("Both images must have the same number of channels");if(this.colorModel!==t.colorModel)throw new Error("Both images must have the same colorModel");void 0===r&&(r=!0);let h=Math.max(a[0],-i[0]),l=Math.min(this.width-a[0],this.width-i[0]),u=Math.max(a[1],-i[1]),c=Math.min(this.height-a[1],this.height-i[1]),d=Hu()(n.length,0);for(let e=0;e<n.length;e++){let r=n[e],s=o?this.sum[r]:Math.max(this.sum[r],t.sum[r]),a=o?t.sum[r]:Math.max(this.sum[r],t.sum[r]);if(0!==s&&0!==a)for(let n=h;n<l;n++)for(let o=u;o<c;o++){let h=n*this.multiplierX+o*this.multiplierY+r,l=h+i[0]*this.multiplierX+i[1]*this.multiplierY;d[e]+=Math.min(this.data[h]/s,t.data[l]/a)}}return r?d.reduce(((t,e)=>t+e))/d.length:d}function yd(t={}){let{sampling:e=[10,10],painted:i=!1,mask:r}=t;this.checkProcessable("getPixelsGrid",{bitDepth:[8,16],channels:1}),Array.isArray(e)||(e=[e,e]);const n=e[0],s=e[1],o=[],a=[],h=this.width/n,l=this.height/s;let u=Math.floor(h/2);for(let t=0;t<n;t++){let t=Math.floor(l/2);for(let e=0;e<s;e++){let e=Math.round(u),i=Math.round(t);r&&!r.getBitXY(e,i)||(o.push([e,i]),a.push(this.getPixelXY(e,i))),t+=l}u+=h}const c={xyS:o,zS:a};return i&&(c.painted=this.rgba8().paintPoints(o)),c}function vd(t,e,i){const r=new Array(t);for(let i=0;i<t;i++)r[i]=new Array(e);if(i)for(let n=0;n<t;n++)for(let t=0;t<e;t++)r[n][t]=i;return r.width=t,r.height=e,Object.setPrototypeOf(r,vd.prototype),r}function xd(t,e={}){let{border:i}=e;if(this.checkProcessable("getChannel",{bitDepth:[8,16]}),this.bitDepth!==t.bitDepth)throw new Error("Both images must have the same bitDepth");if(this.channels!==t.channels)throw new Error("Both images must have the same number of channels");if(this.colorModel!==t.colorModel)throw new Error("Both images must have the same colorModel");let r=new vd(t.width,t.height,-1/0),n=Math.floor(t.width/2),s=Math.floor(t.height/2),o=n,a=s,h=!1;for(;!h;){let e=r.localSearch(n,s,-1/0);for(let n=0;n<e.length;n++){let s=e[n],h=this.getSimilarity(t,{border:i,shift:[o-s[0],a-s[1]]});r[s[0]][s[1]]=h}let l=r.localMax(n,s);l.position[0]!==n||l.position[1]!==s?(n=l.position[0],s=l.position[1]):h=!0}return[n-o,s-a]}function Md(t,e=0){this.checkProcessable("getRow",{bitDepth:[8,16]}),function(t,e){if(e<0||e>=t.height)throw new RangeError(`row must be included between 0 and ${t.height-1}. Current value: ${e}`)}(this,t),Fc(this,e);let i=new Array(this.width),r=0,n=t*this.width*this.channels+e,s=n+this.width*this.channels;for(let t=n;t<s;t+=this.channels)i[r++]=this.data[t];return i}function kd(t,e=0){this.checkProcessable("getColumn",{bitDepth:[8,16]}),function(t,e){if(e<0||e>=t.width)throw new RangeError(`column must be included between 0 and ${t.width-1}. Current value: ${e}`)}(this,t),Fc(this,e);let i=new Array(this.height),r=0,n=this.width*this.channels;for(let s=e+t*this.channels;s<this.data.length;s+=n)i[r++]=this.data[s];return i}function Ed(t={}){let{channel:e}=t;if(this.checkProcessable("getMatrix",{bitDepth:[8,16]}),void 0===e){if(this.components>1)throw new RangeError("You need to define the channel for an image that contains more than one channel");e=0}let i=new Ou(this.height,this.width);for(let t=0;t<this.height;t++)for(let r=0;r<this.width;r++)i.set(t,r,this.getValueXY(r,t,e));return i}function Cd(t,e={}){t=new Ou(t);let{channel:i}=e;if(this.checkProcessable("getMatrix",{bitDepth:[8,16]}),void 0===i){if(this.components>1)throw new RangeError("You need to define the channel for an image that contains more than one channel");i=0}if(this.width!==t.columns||this.height!==t.rows)throw new RangeError("The size of the matrix must be equal to the size of the image");for(let e=0;e<this.height;e++)for(let r=0;r<this.width;r++)this.setValueXY(r,e,i,t.get(e,r));return this}function Sd(){this.checkProcessable("getPixelsArray",{bitDepth:[8,16,32]});let t=new Array(this.size),e=0;for(let i=0;i<this.data.length;i+=this.channels){let r=new Array(this.components);for(let t=0;t<this.components;t++)r[t]=this.data[i+t];t[e++]=r}return t}function Ad(t){let e=this,i=e.getClosestCommonParent(t),r=e.getRelativePosition(i,{defaultFurther:!0}),n=Td(e,r),s=t.getRelativePosition(i,{defaultFurther:!0}),o=Td(t,s),a=function(t,e){let i=0,r=0,n=[];for(;i<t.length&&r<e.length;)t[i][0]===e[r][0]&&t[i][1]===e[r][1]?(n.push(t[i]),i++,r++):t[i][0]<e[r][0]||t[i][0]===e[r][0]&&t[i][1]<e[r][1]?i++:r++;return n}(n,o),h={whitePixelsMask1:[],whitePixelsMask2:[],commonWhitePixels:[]};for(let i=0;i<a.length;i++){let n=a[i],o=[n[0]-r[0],n[1]-r[1]],l=[n[0]-s[0],n[1]-s[1]],u=e.getBitXY(o[0],o[1]),c=t.getBitXY(l[0],l[1]);1===u&&1===c&&h.commonWhitePixels.push(n)}for(let t=0;t<n.length;t++){let i,r;0!==t&&(i=Math.floor(t/e.width),r=t%e.width),1===e.getBitXY(i,r)&&h.whitePixelsMask1.push(n[t])}for(let e=0;e<o.length;e++){let i=0,r=0;0!==e&&(i=Math.floor(e/t.width),r=e%t.width),1===t.getBitXY(i,r)&&h.whitePixelsMask2.push(o[e])}return h}function Td(t,e){let i=[];for(let r=0;r<t.height;r++)for(let n=0;n<t.width;n++){let t=[r,n];i.push([t[0]+e[0],t[1]+e[1]])}return i}function Rd(t){let e,i=Pd(this),r=Pd(t);if(e=i>=r?Id(this,i):Id(t,r),0===i||0===r)return e;let n=this,s=t;for(;i!==r;)if(i>r){if(n=n.parent,null===n)return e;i-=1}else{if(s=s.parent,null===s)return e;r-=1}for(;n!==s&&null!==n&&null!==s;)if(n=n.parent,s=s.parent,null===n||null===s)return e;return n!==s?e:n}function Pd(t){let e=0,i=t;for(;null!=i.parent;)i=i.parent,e++;return e}function Id(t,e){let i=t;for(;e>0;)i=i.parent,e-=1;return i}vd.prototype.localMin=function(t,e){let i=this[t][e],r=[t,e];for(let n=Math.max(0,t-1);n<Math.min(this.length,t+2);n++)for(let t=Math.max(0,e-1);t<Math.min(this[0].length,e+2);t++)this[n][t]<i&&(i=this[n][t],r=[n,t]);return{position:r,value:i}},vd.prototype.localMax=function(t,e){let i=this[t][e],r=[t,e];for(let n=Math.max(0,t-1);n<Math.min(this.length,t+2);n++)for(let t=Math.max(0,e-1);t<Math.min(this[0].length,e+2);t++)this[n][t]>i&&(i=this[n][t],r=[n,t]);return{position:r,value:i}},vd.prototype.localSearch=function(t,e,i){let r=[];for(let n=Math.max(0,t-1);n<Math.min(this.length,t+2);n++)for(let t=Math.max(0,e-1);t<Math.min(this[0].length,e+2);t++)this[n][t]===i&&r.push([n,t]);return r};const Dd={lowThreshold:10,highThreshold:30,gaussianBlur:1.1},Ld=[[-1,0,1],[-2,0,2],[-1,0,1]],Fd=[[-1,-2,-1],[0,0,0],[1,2,1]],zd={bitDepth:32,mode:"periodic"};function Bd(t){return function(t,e){t.checkProcessable("Canny edge detector",{bitDepth:8,channels:1,components:1}),e=Object.assign({},Dd,e);const i=t.width,r=t.height,n=t.maxValue,s={sigma:e.gaussianBlur,radius:3},o=t.gaussianFilter(s),a=o.convolution(Fd,zd),h=o.convolution(Ld,zd),l=h.hypotenuse(a),u=t.constructor,c=new u(i,r,{kind:"GREY",bitDepth:32}),d=new u(i,r,{kind:"GREY",bitDepth:32}),f=new u(i,r,{kind:"GREY"});for(var g=1;g<i-1;g++)for(var m=1;m<r-1;m++){var p=(Math.round(Math.atan2(h.getValueXY(g,m,0),a.getValueXY(g,m,0))*(5/Math.PI))+5)%5;0===p&&(l.getValueXY(g,m,0)<=l.getValueXY(g,m-1,0)||l.getValueXY(g,m,0)<=l.getValueXY(g,m+1,0))||1===p&&(l.getValueXY(g,m,0)<=l.getValueXY(g-1,m+1,0)||l.getValueXY(g,m,0)<=l.getValueXY(g+1,m-1,0))||2===p&&(l.getValueXY(g,m,0)<=l.getValueXY(g-1,m,0)||l.getValueXY(g,m,0)<=l.getValueXY(g+1,m,0))||3===p&&(l.getValueXY(g,m,0)<=l.getValueXY(g-1,m-1,0)||l.getValueXY(g,m,0)<=l.getValueXY(g+1,m+1,0))||c.setValueXY(g,m,0,l.getValueXY(g,m,0))}for(g=0;g<i*r;++g){var w=c.data[g],_=0;w>e.highThreshold&&(_++,f.data[g]=n),w>e.lowThreshold&&_++,d.data[g]=_}var b=[];for(g=1;g<i-1;++g)for(m=1;m<r-1;++m)if(1===d.getValueXY(g,m,0))t:for(var y=g-1;y<g+2;++y)for(var v=m-1;v<m+2;++v)if(2===d.getValueXY(y,v,0)){b.push([g,m]),f.setValueXY(g,m,0,n);break t}for(;b.length>0;){var x=[];for(g=0;g<b.length;++g)for(m=-1;m<2;++m)for(y=-1;y<2;++y)if(0!==m||0!==y){var M=b[g][0]+m,k=b[g][1]+y;1===d.getValueXY(M,k,0)&&0===f.getValueXY(M,k,0)&&(x.push([M,k]),f.setValueXY(M,k,0,n))}b=x}return f}(this,t)}function Nd(t,e={}){let{position:i}=e;if(this.checkProcessable("extract",{bitDepth:[1,8,16]}),!i&&(i=t.getRelativePosition(this),!i))throw new Error("extract : can not extract an image because the relative position can not be determined, try to specify manually the position as an array of 2 elements [x,y].");if(this.bitDepth>1){let e=dg.createFrom(this,{width:t.width,height:t.height,alpha:1,position:i,parent:this});for(let r=0;r<t.width;r++)for(let n=0;n<t.height;n++){for(let t=0;t<this.channels;t++){let s=this.getValueXY(r+i[0],n+i[1],t);e.setValueXY(r,n,t,s)}t.getBitXY(r,n)||e.setValueXY(r,n,this.components,0)}return e}{let e=dg.createFrom(this,{width:t.width,height:t.height,position:i,parent:this});for(let r=0;r<t.height;r++)for(let n=0;n<t.width;n++)t.getBitXY(n,r)&&this.getBitXY(n+i[0],r+i[1])&&e.setBitXY(n,r);return e}}var Od=__webpack_require__(8737),Ud=__webpack_require__.n(Od);function Vd(t={}){const{x:e=0,y:i=0,inPlace:r=!0}=t,n=r?this:dg.createFrom(this);if(this.checkProcessable("floodFill",{bitDepth:1}),this.getBitXY(e,i))return n;const s=new(Ud());for(s.push(new Yd(e,i));s.length>0;){const t=s.shift();n.setBitXY(t.x,t.y);for(let e=t.x+1;e<this.width&&!n.getBitXY(e,t.y)&&!this.getBitXY(e,t.y);e++)n.setBitXY(e,t.y),t.y+1<this.height&&!this.getBitXY(e,t.y+1)&&s.push(new Yd(e,t.y+1)),t.y-1>=0&&!this.getBitXY(e,t.y-1)&&s.push(new Yd(e,t.y-1));for(let e=t.x-1;e>=0&&!n.getBitXY(e,t.y)&&!this.getBitXY(e,t.y);e++)n.setBitXY(e,t.y),t.y+1<this.height&&!this.getBitXY(e,t.y+1)&&s.push(new Yd(e,t.y+1)),t.y-1>=0&&!this.getBitXY(e,t.y-1)&&s.push(new Yd(e,t.y-1))}return n}function Yd(t,e){this.x=t,this.y=e}function Xd(){return Xd=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])}return t},Xd.apply(this,arguments)}function jd(t,e,i){var r=function(t,e,i){return{h:t,s:2*(e*=(i<50?i:100-i)/100)/(i+e)*100,v:i+e}}(t,e,i);return function(t,e,i){var r,n=(i/=100)*(e/=100),s=t/60,o=n*(1-Math.abs(s%2-1)),a=i-n;return r=s>=0&&s<1?[n,o,0]:s>=1&&s<2?[o,n,0]:s>=2&&s<3?[0,n,o]:t>=3&&s<4?[0,o,n]:t>=4&&s<5?[o,0,n]:t>=5&&s<=6?[n,0,o]:[0,0,0],{r:Math.round(255*(r[0]+a)),g:Math.round(255*(r[1]+a)),b:Math.round(255*(r[2]+a))}}(r.h,r.s,r.v)}var Gd={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]};function qd(t){let e=function(t){var e=Gd[t.toLowerCase()];if(e)return{r:e[0],g:e[1],b:e[2],a:100}}(i=t)||function(t){if("#"===t[0]&&4===t.length)return{r:parseInt(t[1]+t[1],16),g:parseInt(t[2]+t[2],16),b:parseInt(t[3]+t[3],16),a:100}}(i)||function(t){if("#"===t[0]&&7===t.length)return{r:parseInt(t.slice(1,3),16),g:parseInt(t.slice(3,5),16),b:parseInt(t.slice(5,7),16),a:100}}(i)||function(t){var e=t.match(/rgb\(([^)]+)\)/);if(e){var i=e[1].split(/ *, */).map(Number);return{r:i[0],g:i[1],b:i[2],a:100}}}(i)||function(t){var e=t.match(/rgba\(([^)]+)\)/);if(e){var i=e[1].split(/ *, */).map(Number);return{r:i[0],g:i[1],b:i[2],a:100*i[3]}}}(i)||function(t){var e=t.match(/hsl\(([^)]+)\)/);if(e){var i=e[1].split(/ *, */);return Xd({},jd(parseInt(i[0],10),parseInt(i[1],10),parseInt(i[2],10)),{a:100})}}(i)||function(t){var e=t.match(/hsla\(([^)]+)\)/);if(e){var i=e[1].split(/ *, */),r=parseInt(i[0],10),n=parseInt(i[1],10),s=parseInt(i[2],10),o=parseInt(100*parseFloat(i[3]),10);return Xd({},jd(r,n,s),{a:o})}}(i);var i;return[e.r,e.g,e.b,Math.round(255*e.a/100)]}function Zd(t,e,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?t+6*(e-t)*i:i<.5?e:i<2/3?t+(e-t)*(2/3-i)*6:t}function Kd(t,e,i){let r,n,s,o,a,h;return i/=100,0==(e/=100)?o=a=h=255*i:(n=i<=.5?i*(e+1):i+e-i*e,r=2*i-n,s=t/360,o=Zd(r,n,s+1/3),a=Zd(r,n,s),h=Zd(r,n,s-1/3)),{r:o,g:a,b:h}}function Hd(t){let{color:e,colors:i,randomColors:r,numberColors:n=50}=t;if(e&&!Array.isArray(e)&&(e=qd(e)),e)return[e];if(i)return i=i.map((function(t){return Array.isArray(t)?t:qd(t)})),i;if(r){i=new Array(n);for(let t=0;t<n;t++)i[t]=[Math.floor(256*Math.random()),Math.floor(256*Math.random()),Math.floor(256*Math.random())]}return function(t){let e=new Array(t),i=0;for(let r=0;r<360;r+=360/t){i++;let t=Kd(r,100,30+i%4*15);e[i-1]=[Math.round(255*t.r),Math.round(255*t.g),Math.round(255*t.b)]}return e}(n)}function Wd(t,e,i={}){let{color:r="blue",colors:n,font:s="12px Helvetica",rotate:o=0}=i;if(this.checkProcessable("paintMasks",{channels:[3,4],bitDepth:[8,16],colorModel:pl}),!Array.isArray(t))throw Error("paintLabels: labels must be an array");if(!Array.isArray(e))throw Error("paintLabels: positions must be an array");if(r&&!Array.isArray(r)&&(r=qd(r)),n=n?n.map((function(t){return Array.isArray(t)?t:qd(t)})):[r],t.length!==e.length)throw Error("paintLabels: positions and labels must be arrays from the same size");Array.isArray(s)||(s=[s]),Array.isArray(o)||(o=[o]);let a=this.getCanvas().getContext("2d");for(let i=0;i<t.length;i++){a.save();let r=n[i%n.length];a.fillStyle=`rgba(${r[0]},${r[1]},${r[2]},${r[3]/this.maxValue})`,a.font=s[i%s.length];let h=e[i];a.translate(h[0],h[1]),a.rotate(o[i%o.length]/180*Math.PI),a.fillText(t[i],0,0),a.restore()}return this.data=Uint8Array.from(a.getImageData(0,0,this.width,this.height).data),this}function $d(t,e={}){let{alpha:i=255,labels:r=[],labelsPosition:n=[],labelColor:s="blue",labelFont:o="12px Helvetica"}=e;this.checkProcessable("paintMasks",{channels:[3,4],bitDepth:[8,16],colorModel:pl});let a=Hd(Object.assign({},e,{numberColors:t.length}));Array.isArray(t)||(t=[t]);for(let e=0;e<t.length;e++){let r=t[e],n=a[e%a.length];for(let t=0;t<r.width;t++)for(let e=0;e<r.height;e++)if(r.getBitXY(t,e))for(let s=0;s<Math.min(this.components,n.length);s++)if(255===i)this.setValueXY(t+r.position[0],e+r.position[1],s,n[s]);else{let o=this.getValueXY(t+r.position[0],e+r.position[1],s);o=Math.round((o*(255-i)+n[s]*i)/255),this.setValueXY(t+r.position[0],e+r.position[1],s,o)}}if(Array.isArray(r)&&r.length>0){let e=this.getCanvas().getContext("2d");e.fillStyle=s,e.font=o;for(let i=0;i<Math.min(t.length,r.length);i++){let s=n[i]?n[i]:t[i].position;e.fillText(r[i],s[0],s[1])}this.data=Uint8Array.from(e.getImageData(0,0,this.width,this.height).data)}return this}function Qd(t,e){let i=new Array(t);for(let r=0;r<t;r++)i[r]=new Array(e).fill(0);return i}const Jd=[[0,0,1,0,0],[0,0,1,0,0],[1,1,1,1,1],[0,0,1,0,0],[0,0,1,0,0]],tf=[[0,1,0],[1,1,1],[0,1,0]];class ef{constructor(t={}){let{kind:e="cross",shape:i,size:r,width:n,height:s,filled:o=!0}=t;if(r&&(n=r,s=r),i)switch(i.toLowerCase()){case"square":case"rectangle":this.matrix=function(t,e,i){const r=Qd(e,t);if(i.filled)for(let i=0;i<e;i++)for(let e=0;e<t;e++)r[i][e]=1;else{for(let i of[0,e-1])for(let e=0;e<t;e++)r[i][e]=1;for(let i=0;i<e;i++)for(let e of[0,t-1])r[i][e]=1}return r}(n,s,{filled:o});break;case"circle":case"ellipse":this.matrix=function(t,e,i){const r=Qd(e,t);let n=1-e%2,s=1-t%2,o=Math.floor((t-1)/2),a=Math.floor((e-1)/2),h=o*o,l=a*a;if(i.filled)for(let e=0;e<=a;e++)for(let i=o-Math.floor(Math.sqrt(h-h*e*e/l));i<=o;i++)r[a-e][i]=1,r[a+e+n][i]=1,r[a-e][t-i-1]=1,r[a+e+n][t-i-1]=1;else{for(let e=0;e<=a;e++){let i=o-Math.floor(Math.sqrt(h-h*e*e/l));r[a-e][i]=1,r[a+e+n][i]=1,r[a-e][t-i-1]=1,r[a+e+n][t-i-1]=1}for(let t=0;t<=o;t++){let i=a-Math.floor(Math.sqrt(l-l*t*t/h));r[i][o-t]=1,r[i][o+t+s]=1,r[e-i-1][o-t]=1,r[e-i-1][o+t+s]=1}}return r}(n,s,{filled:o});break;case"triangle":this.matrix=function(t,e,i){if(!i.filled)throw new Error("Non filled triangle is not implemented");const r=Qd(e,t);for(let i=0;i<e;i++){let n=Math.floor((1-i/e)*t/2);for(let e=n;e<t-n;e++)r[i][e]=1}return r}(n,s,{filled:o});break;default:throw new Error(`Shape: unexpected shape: ${i}`)}else{if(!e)throw new Error("Shape: expected a kind or a shape option");switch(e.toLowerCase()){case"cross":this.matrix=Jd;break;case"smallcross":this.matrix=tf;break;default:throw new Error(`Shape: unexpected kind: ${e}`)}}this.height=this.matrix.length,this.width=this.matrix[0].length,this.halfHeight=this.height/2>>0,this.halfWidth=this.width/2>>0}getPoints(){let t=this.matrix,e=[];for(let i=0;i<t.length;i++)for(let r=0;r<t[0].length;r++)t[i][r]&&e.push([r-this.halfWidth,i-this.halfHeight]);return e}getMask(){let t=new dg(this.width,this.height,{kind:yl});for(let e=0;e<this.matrix.length;e++)for(let i=0;i<this.matrix[0].length;i++)this.matrix[e][i]&&t.setBitXY(i,e);return t}}function rf(t,e={}){let{shape:i}=e;this.checkProcessable("paintPoints",{bitDepth:[8,16]});let r=Hd(Object.assign({},e,{numberColors:t.length})),n=new ef(i).getPoints(),s=Math.min(this.channels,r[0].length);for(let e=0;e<t.length;e++){let i=r[e%r.length],o=t[e][0],a=t[e][1];for(let t=0;t<n.length;t++){let e=n[t][0],r=n[t][1];if(o+e>=0&&a+r>=0&&o+e<this.width&&a+r<this.height){let t=(o+e+(a+r)*this.width)*this.channels;for(let e=0;e<s;e++)this.data[t+e]=i[e]}}}return this}function nf(t,e={}){let{color:i=[this.maxValue,0,0],closed:r=!1}=e;this.checkProcessable("paintPoints",{bitDepth:[1,8,16]});let n=Math.min(this.channels,i.length);for(let e=0;e<t.length-1+r;e++){let r=t[e],s=t[(e+1)%t.length],o=s[0]-r[0],a=s[1]-r[1],h=Math.max(Math.abs(o),Math.abs(a)),l=o/h,u=a/h,c=r[0],d=r[1];for(let t=0;t<=h;t++){let t=Math.round(c),e=Math.round(d);if(t>=0&&e>=0&&t<this.width&&e<this.height)if(1===this.bitDepth)this.setBitXY(t,e);else{let r=(t+e*this.width)*this.channels;for(let t=0;t<n;t++)this.data[r+t]=i[t]}c+=l,d+=u}}return this}function sf(t,e={}){let i=Object.assign({},e);this.checkProcessable("paintPolylines",{bitDepth:[8,16]});let r=Hd(Object.assign({},e,{numberColors:t.length}));for(let e=0;e<t.length;e++)i.color=r[e%r.length],this.paintPolyline(t[e],i);return this}function of(t,e={}){let{color:i=[this.maxValue,0,0],filled:r=!1}=e;this.checkProcessable("paintPoints",{bitDepth:[1,8,16]}),e.closed=!0;let n=function(t){let e=[];for(let i=0;i<t.length;i++)t[i][0]===t[(i+1)%t.length][0]&&t[i][1]===t[(i+1)%t.length][1]||t[i][0]===t[(i-1+t.length)%t.length][0]&&t[i][1]===t[(i-1+t.length)%t.length][1]||t[(i+1)%t.length][0]===t[(i-1+t.length)%t.length][0]&&t[(i-1+t.length)%t.length][1]===t[(i+1)%t.length][1]||e.push(t[i]);return e}(t);if(!1===r)return this.paintPolyline(t,e);{let r=Array(this.height);for(let t=0;t<this.height;t++){r[t]=[];for(let e=0;e<this.width;e++)r[t].push(0)}for(let t=0;t<n.length;t++){const e=af(n[t],n[(t+1)%n.length]);for(let t=0;t<this.height;t++)for(let i=0;i<this.width;i++)hf(i,t,e,this.height)&&(r[t][i]=0===r[t][i]?1:0)}for(let t=0;t<this.height;t++)for(let e=0;e<this.width;e++)if(1===r[t][e])if(1===this.bitDepth)this.setBitXY(e,t);else{let r=Math.min(this.channels,i.length),n=(e+t*this.width)*this.channels;for(let t=0;t<r;t++)this.data[n+t]=i[t]}return this.paintPolyline(t,e)}}function af(t,e){if(t[0]===e[0])return{a:0,b:t[0],vertical:!0};{const i=(e[1]-t[1])/(e[0]-t[0]);return{a:i,b:t[1]-i*t[0],vertical:!1}}}function hf(t,e,i,r){if(!0===i.vertical)return i.b<=t;if(0===i.a)return!1;{const n=(e-i.b)/i.a;return n<t&&n>=0&&n<=r}}function lf(t,e={}){let i=Object.assign({},e);this.checkProcessable("paintPolygons",{bitDepth:[8,16]});let r=Hd(Object.assign({},e,{numberColors:t.length}));for(let e=0;e<t.length;e++)i.color=r[e%r.length],this.paintPolygon(t[e],i);return this}function uf(t={}){let{maxSlots:e=256,channel:i,useAlpha:r=!0}=t;if(this.checkProcessable("getHistogram",{bitDepth:[1,8,16]}),void 0===i){if(this.components>1)throw new RangeError("You need to define the channel for an image that contains more than one channel");i=0}return df.call(this,i,{useAlpha:r,maxSlots:e})}function cf(t={}){const{maxSlots:e=256,useAlpha:i=!0}=t;this.checkProcessable("getHistograms",{bitDepth:[8,16]});let r=new Array(i?this.components:this.channels);for(let t=0;t<r.length;t++)r[t]=df.call(this,t,{useAlpha:i,maxSlots:e});return r}function df(t,e){let{useAlpha:i,maxSlots:r}=e;if(1===this.bitDepth){let t=[0,0];for(let e=0;e<this.height;e++)for(let i=0;i<this.width;i++){let r=this.getBitXY(e,i);0===r?t[0]+=1:1===r&&(t[1]+=1)}return t}let n=Math.log2(r);if(!Lu()(n))throw new RangeError("maxSlots must be a power of 2, for example: 64, 256, 1024");let s=0;this.bitDepth>n&&(s=this.bitDepth-n);let o=this.data,a=Hu()(Math.pow(2,Math.min(this.bitDepth,n)),0);if(i&&this.alpha){let e=this.channels-t-1;for(let i=t;i<o.length;i+=this.channels)a[o[i]>>s]+=o[i+e]/this.maxValue}else for(let e=t;e<o.length;e+=this.channels)a[o[e]>>s]++;return a}function ff(t={}){let{useAlpha:e=!0,nbSlots:i=512}=t;this.checkProcessable("getColorHistogram",{bitDepth:[8,16],components:[3]});let r=Math.log(i)/Math.log(8);if(r!==Math.floor(r))throw new RangeError("nbSlots must be a power of 8. Usually 8, 64, 512 or 4096");let n=this.bitDepth-r,s=this.data,o=Hu()(Math.pow(8,r),0),a=Math.pow(2,2*r),h=Math.pow(2,r);for(let t=0;t<s.length;t+=this.channels){let i=(s[t]>>n)*a+(s[t+1]>>n)*h+(s[t+2]>>n);e&&this.alpha?o[i]+=s[t+this.channels-1]/this.maxValue:o[i]++}return o}function gf(){this.checkProcessable("min",{bitDepth:[8,16,32]});let t=Hu()(this.channels,1/0);for(let e=0;e<this.data.length;e+=this.channels)for(let i=0;i<this.channels;i++)this.data[e+i]<t[i]&&(t[i]=this.data[e+i]);return t}function mf(){this.checkProcessable("max",{bitDepth:[8,16,32]});let t=Hu()(this.channels,-1/0);for(let e=0;e<this.data.length;e+=this.channels)for(let i=0;i<this.channels;i++)this.data[e+i]>t[i]&&(t[i]=this.data[e+i]);return t}function pf(){this.checkProcessable("sum",{bitDepth:[8,16]});let t=Hu()(this.channels,0);for(let e=0;e<this.data.length;e+=this.channels)for(let i=0;i<this.channels;i++)t[i]+=this.data[e+i];return t}function wf(t=0,e=0){this.checkProcessable("getMoment",{bitDepth:[1]});let i=0;for(let r=0;r<this.width;r++)for(let n=0;n<this.height;n++)1===this.getBitXY(r,n)&&(i+=r**t*n**e);return i}function _f(t={}){let{mask:e,region:i=3,removeClosePoints:r=0,invert:n=!1,maxEquals:s=2}=t,o=this;this.checkProcessable("localMaxima",{bitDepth:[8,16],components:1}),i*=4;let a=n?0:1,h=[1,0,-1,0,1,1,-1,-1,2,0,-2,0,2,2,-2,-2],l=[0,1,0,-1,1,-1,1,-1,0,2,0,-2,2,-2,2,-2],u=i<=8?1:2,c=[];for(let t=u;t<o.height-u;t++)for(let r=u;r<o.width-u;r++){if(e&&e.getBitXY(r,t)!==a)continue;let u=0,d=0,f=o.data[r+t*o.width];for(let e=0;e<i;e++)n?o.data[r+h[e]+(t+l[e])*o.width]>f&&u++:o.data[r+h[e]+(t+l[e])*o.width]<f&&u++,o.data[r+h[e]+(t+l[e])*o.width]===f&&d++;u+d===i&&d<=s&&c.push([r,t])}if(r>0)for(let t=0;t<c.length;t++)for(let e=t+1;e<c.length;e++)Math.sqrt(Math.pow(c[t][0]-c[e][0],2)+Math.pow(c[t][1]-c[e][1],2))<r&&(c[t][0]=c[t][0]+c[e][0]>>1,c[t][1]=c[t][1]+c[e][1]>>1,c.splice(e,1),e--);return c}function bf(){let t=this.getHistograms({maxSlots:this.maxValue+1}),e=new Array(t.length);for(let i=0;i<t.length;i++){let r=t[i];e[i]=Jl(r)}return e}function yf(){let t=this.getHistograms({maxSlots:this.maxValue+1}),e=new Array(t.length);for(let i=0;i<t.length;i++){let r=t[i];e[i]=Ql(r)}return e}function vf(){this.checkProcessable("points",{bitDepth:[1]});const t=[];for(let e=0;e<this.width;e++)for(let i=0;i<this.height;i++)1===this.getBitXY(e,i)&&t.push([e,i]);return t}function xf(){this.checkProcessable("extendedPoints",{bitDepth:[1]});const t=[];for(let e=0;e<this.height;e++)for(let i=0;i<this.width;i++)if(1===this.getBitXY(i,e))for(t.push([i,e]),1!==this.getBitXY(i+1,e)?(t.push([i+1,e]),t.push([i+1,e+1]),1!==this.getBitXY(i,e+1)&&t.push([i,e+1])):1!==this.getBitXY(i,e+1)&&(t.push([i,e+1]),t.push([i+1,e+1]));i<this.width-2&&1===this.getBitXY(i+1,e)&&1===this.getBitXY(i+2,e);)i++;return t}function Mf(t,e={}){if(this===t)return[0,0];let i=[0,0],r=this;for(;r;){if(r===t)return i;r.position&&(i[0]+=r.position[0],i[1]+=r.position[1]),r=r.parent}return!!e.defaultFurther&&i}function kf(t={}){let{alpha:e=1}=t;this.checkProcessable("countAlphaPixels",{bitDepth:[8,16],alpha:1});let i=0;if(void 0!==e){for(let t=this.components;t<this.data.length;t+=this.channels)this.data[t]===e&&i++;return i}return this.size}function Ef(t,e={}){const{sorted:i}=e;i||(t=t.slice().sort(Sf));const r=t.length,n=new Array(2*r);let s=0;for(let e=0;e<r;e++){const i=t[e];for(;s>=2&&Cf(n[s-2],n[s-1],i)<=0;)s--;n[s++]=i}const o=s+1;for(let e=r-2;e>=0;e--){const i=t[e];for(;s>=o&&Cf(n[s-2],n[s-1],i)<=0;)s--;n[s++]=i}return n.slice(0,s-1)}function Cf(t,e,i){return(e[1]-t[1])*(i[0]-t[0])-(e[0]-t[0])*(i[1]-t[1])}function Sf(t,e){return t[0]===e[0]?t[1]-e[1]:t[0]-e[0]}function Af(){return Ef(this.extendedPoints,{sorted:!1})}function Tf(t,e){return[t[0]-e[0],t[1]-e[1]]}function Rf(t){let e=Math.sqrt(t[0]**2+t[1]**2);return[t[0]/e,t[1]/e]}function Pf(t,e,i){void 0===i&&(i=new Array(e.length));let r=Math.cos(t),n=Math.sin(t);for(let t=0;t<i.length;++t)i[t]=[r*e[t][0]-n*e[t][1],n*e[t][0]+r*e[t][1]];return i}function If(t){let e=0;for(let i=0;i<t.length;i++){let r=t[i][0],n=t[i][1],s=t[i===t.length-1?0:i+1][0],o=t[i===t.length-1?0:i+1][1];e+=Math.sqrt((s-r)**2+(o-n)**2)}return e}function Df(t){let e=0;for(let i=0;i<t.length;i++)e+=t[i][0]*t[i===t.length-1?0:i+1][1]*.5,e-=t[i===t.length-1?0:i+1][0]*t[i][1]*.5;return Math.abs(e)}function Lf(t){let e=1/0,i=1/0,r=-1/0,n=-1/0;for(let s=0;s<t.length;s++)t[s][0]<e&&(e=t[s][0]),t[s][0]>r&&(r=t[s][0]),t[s][1]<i&&(i=t[s][1]),t[s][1]>n&&(n=t[s][1]);return[[e,i],[r,n]]}function Ff(t={}){const{originalPoints:e=Af.call(this)}=t;if(0===e.length)return[];if(1===e.length)return[e[0],e[0],e[0],e[0]];const i=new Array(e.length);let r,n=1/0,s=0;for(let t=0;t<i.length;t++){let o=zf(e[t],e[(t+1)%i.length]);Pf(-o,e,i);let a=i[t][0],h=i[t][1],l=i[(t+1)%i.length][0],u=i[(t+1)%i.length][1],c=!0,d=0,f=0,g=0;for(let t=0;t<i.length;t++){let e=(i[t][0]-a)/(l-a);!0===c?(c=!1,d=e,f=e):(e<d&&(d=e),e>f&&(f=e));let r=(-(l-a)*i[t][1]+l*h-u*a)/(l-a);Math.abs(r)>Math.abs(g)&&(g=r)}let m=[a+d*(l-a),h],p=[a+f*(l-a),h],w=Math.abs(g*(d-f)*(l-a));w<n&&(s=o,n=w,r=[m,p,[p[0],p[1]-g],[m[0],m[1]-g]])}return Pf(s,r,r),r}function zf(t,e){let i=Rf(Tf(e,t)),r=Math.acos(i[0]);return i[1]<0?-r:r}var Bf=__webpack_require__(2229),Nf=__webpack_require__.n(Bf),Of=__webpack_require__(4707),Uf=__webpack_require__.n(Of);function Vf(t,e){let i=Rf(Tf(e,t)),r=Math.acos(i[0]);return i[1]<0?-r:r}class Yf{constructor(t,e){this.map=t,this.id=e,this.minX=Number.POSITIVE_INFINITY,this.maxX=Number.NEGATIVE_INFINITY,this.minY=Number.POSITIVE_INFINITY,this.maxY=Number.NEGATIVE_INFINITY,this.meanX=0,this.meanY=0,this.surface=0,this.computed={}}getMask(t={}){const{scale:e=1,kind:i=""}=t;let r;switch(i){case"contour":r=this.contourMask;break;case"box":r=this.boxMask;break;case"filled":r=this.filledMask;break;case"center":r=this.centerMask;break;case"mbr":r=this.mbrFilledMask;break;case"hull":r=this.convexHullFilledMask;break;case"hullContour":r=this.convexHullMask;break;case"mbrContour":r=this.mbrMask;break;case"feret":r=this.feretMask;break;default:r=this.mask}return e<1&&(r=r.resize({factor:e}),r.parent=this.mask.parent,r.position[0]+=this.minX,r.position[1]+=this.minY),r}get mean(){throw new Error("Roi mean not implemented yet")}get center(){return this.computed.center||(this.computed.center=[this.width/2>>0,this.height/2>>0]),this.computed.center}get ratio(){return this.width/this.height}get width(){return this.maxX-this.minX+1}get height(){return this.maxY-this.minY+1}_computExternalIDs(){let t=this.borderIDs,e=this.borderLengths;this.computed.externalIDs=[],this.computed.externalLengths=[];let i=this.internalIDs;for(let r=0;r<t.length;r++)i.includes(t[r])||(this.computed.externalIDs.push(t[r]),this.computed.externalLengths.push(e[r]))}get externalIDs(){return this.computed.externalIDs||this._computExternalIDs(),this.computed.externalIDs}get externalLengths(){return this.computed.externalLengths||this._computExternalIDs(),this.computed.externalLengths}_computeBorderIDs(){let t=function(t){let e=t.map,i=e.data,r=new Set,n=new Map,s=new Set,o=[1,0,-1,0],a=[0,1,0,-1];for(let h=t.minX;h<=t.maxX;h++)for(let l=t.minY;l<=t.maxY;l++)if(i[h+l*e.width]===t.id)for(let u=0;u<4;u++){let c=h+o[u],d=l+a[u];if(c>=0&&d>=0&&c<e.width&&d<e.height){let o=c+d*e.width;if(i[o]!==t.id&&!s.has(o)){s.add(o),r.add(i[o]);let t=n.get(i[o]);t?n.set(i[o],++t):n.set(i[o],1)}}}let h=Array.from(r),l=h.map((function(t){return n.get(t)}));return{ids:h,lengths:l}}(this);this.computed.borderIDs=t.ids,this.computed.borderLengths=t.lengths}get borderIDs(){return this.computed.borderIDs||this._computeBorderIDs(),this.computed.borderIDs}get borderLengths(){return this.computed.borderLengths||this._computeBorderIDs(),this.computed.borderLengths}get boxIDs(){return this.computed.boxIDs||(this.computed.boxIDs=function(t){let e=new Set,i=t.map,r=i.data;for(let n of[0,t.height-1])for(let s=0;s<t.width;s++){let o=(n+t.minY)*i.width+s+t.minX;if(s-t.minX>0&&r[o]===t.id&&r[o-1]!==t.id){let t=r[o-1];e.add(t)}if(i.width-s-t.minX>1&&r[o]===t.id&&r[o+1]!==t.id){let t=r[o+1];e.add(t)}}for(let n of[0,t.width-1])for(let s=0;s<t.height;s++){let o=(s+t.minY)*i.width+n+t.minX;if(s-t.minY>0&&r[o]===t.id&&r[o-i.width]!==t.id){let t=r[o-i.width];e.add(t)}if(i.height-s-t.minY>1&&r[o]===t.id&&r[o+i.width]!==t.id){let t=r[o+i.width];e.add(t)}}return Array.from(e)}(this)),this.computed.boxIDs}get internalIDs(){return this.computed.internalIDs||(this.computed.internalIDs=function(t){let e=[t.id],i=t.map,r=i.data;if(t.height>2)for(let n=0;n<t.width;n++){let s=t.minY*i.width+n+t.minX;if(e.includes(r[s])){let n=r[s+i.width];e.includes(n)||t.boxIDs.includes(n)||e.push(n)}}let n=new Array(4);for(let s=1;s<t.width-1;s++)for(let o=1;o<t.height-1;o++){let a=(o+t.minY)*i.width+s+t.minX;if(e.includes(r[a])){n[0]=r[a-1],n[1]=r[a+1],n[2]=r[a-i.width],n[3]=r[a+i.width];for(let i=0;i<4;i++){let r=n[i];e.includes(r)||t.boxIDs.includes(r)||e.push(r)}}}return e}(this)),this.computed.internalIDs}get box(){return this.computed.box||(this.computed.box=function(t){let e=0,i=t.map,r=i.data,n=[0];t.height>1&&(n[1]=t.height-1);for(let s of n)for(let n=1;n<t.width-1;n++)r[(s+t.minY)*i.width+n+t.minX]===t.id&&e++;let s=[0];t.width>1&&(s[1]=t.width-1);for(let n of s)for(let s=0;s<t.height;s++)r[(s+t.minY)*i.width+n+t.minX]===t.id&&e++;return e}(this)),this.computed.box}get external(){return this.computed.external||(this.computed.external=function(t){let e=0,i=t.map,r=i.data;for(let n=1;n<t.width-1;n++)for(let s=1;s<t.height-1;s++){let o=(s+t.minY)*i.width+n+t.minX;r[o]===t.id&&(t.externalIDs.includes(r[o-1])||t.externalIDs.includes(r[o+1])||t.externalIDs.includes(r[o-i.width])||t.externalIDs.includes(r[o+i.width]))&&e++}return e+t.box}(this)),this.computed.external}get holesInfo(){return this.computed.holesInfo||(this.computed.holesInfo=function(t){let e=0,i=t.map.width,r=t.map.data;for(let n=1;n<t.width-1;n++)for(let s=1;s<t.height-1;s++){let o=(s+t.minY)*i+n+t.minX;t.internalIDs.includes(r[o])&&r[o]!==t.id&&e++}return{number:t.internalIDs.length-1,surface:e}}(this)),this.computed.holesInfo}get border(){return this.computed.border||(this.computed.border=function(t){let e=0,i=t.map,r=i.data;for(let n=1;n<t.width-1;n++)for(let s=1;s<t.height-1;s++){let o=(s+t.minY)*i.width+n+t.minX;r[o]===t.id&&(r[o-1]===t.id&&r[o+1]===t.id&&r[o-i.width]===t.id&&r[o+i.width]===t.id||e++)}return e+t.box}(this)),this.computed.border}get contourMask(){if(!this.computed.contourMask){let t=new dg(this.width,this.height,{kind:yl,position:[this.minX,this.minY],parent:this.map.parent});for(let e=0;e<this.width;e++)for(let i=0;i<this.height;i++)this.map.data[e+this.minX+(i+this.minY)*this.map.width]===this.id&&(e>0&&e<this.width-1&&i>0&&i<this.height-1&&this.map.data[e-1+this.minX+(i+this.minY)*this.map.width]===this.id&&this.map.data[e+1+this.minX+(i+this.minY)*this.map.width]===this.id&&this.map.data[e+this.minX+(i-1+this.minY)*this.map.width]===this.id&&this.map.data[e+this.minX+(i+1+this.minY)*this.map.width]===this.id||t.setBitXY(e,i));this.computed.contourMask=t}return this.computed.contourMask}get boxMask(){if(!this.computed.boxMask){let t=new dg(this.width,this.height,{kind:yl,position:[this.minX,this.minY],parent:this.map.parent});for(let e=0;e<this.width;e++)t.setBitXY(e,0),t.setBitXY(e,this.height-1);for(let e=0;e<this.height;e++)t.setBitXY(0,e),t.setBitXY(this.width-1,e);this.computed.boxMask=t}return this.computed.boxMask}get mask(){if(!this.computed.mask){let t=new dg(this.width,this.height,{kind:yl,position:[this.minX,this.minY],parent:this.map.parent});for(let e=0;e<this.width;e++)for(let i=0;i<this.height;i++)this.map.data[e+this.minX+(i+this.minY)*this.map.width]===this.id&&t.setBitXY(e,i);this.computed.mask=t}return this.computed.mask}get filledMask(){if(!this.computed.filledMask){let t=new dg(this.width,this.height,{kind:yl,position:[this.minX,this.minY],parent:this.map.parent});for(let e=0;e<this.width;e++)for(let i=0;i<this.height;i++){let r=e+this.minX+(i+this.minY)*this.map.width;this.internalIDs.includes(this.map.data[r])&&t.setBitXY(e,i)}this.computed.filledMask=t}return this.computed.filledMask}get centerMask(){if(!this.computed.centerMask){let t=new ef({kind:"smallCross"}).getMask();t.parent=this.map.parent,t.position=[this.minX+this.center[0]-1,this.minY+this.center[1]-1],this.computed.centerMask=t}return this.computed.centerMask}get convexHull(){if(!this.computed.convexHull){const t=[];for(let e=0;e<this.width;e++)for(let i=0;i<this.height;i++)this.map.data[e+this.minX+(i+this.minY)*this.map.width]===this.id&&(e>0&&e<this.width-1&&i>0&&i<this.height-1&&this.map.data[e-1+this.minX+(i+this.minY)*this.map.width]===this.id&&this.map.data[e+1+this.minX+(i+this.minY)*this.map.width]===this.id&&this.map.data[e+this.minX+(i-1+this.minY)*this.map.width]===this.id&&this.map.data[e+this.minX+(i+1+this.minY)*this.map.width]===this.id||(t.push([e,i]),t.push([e+1,i]),t.push([e,i+1]),t.push([e+1,i+1])));const e=Ef(t);this.computed.convexHull={polyline:e,surface:Df(e),perimeter:If(e)}}return this.computed.convexHull}get convexHullMask(){if(!this.computed.convexHullMask){const t=this.convexHull,e=new dg(this.width+1,this.height+1,{kind:yl,position:[this.minX,this.minY],parent:this.map.parent});e.paintPolyline(t.polyline,{closed:!0}),this.computed.convexHullMask=e}return this.computed.convexHullMask}get convexHullFilledMask(){if(!this.computed.convexHullFilledMask){const t=this.convexHull,e=new dg(this.width,this.height,{kind:yl,position:[this.minX,this.minY],parent:this.map.parent});for(let i=0;i<this.width;i++)for(let r=0;r<this.height;r++)1!==Uf()(t.polyline,[i,r])&&e.setBitXY(i,r);this.computed.convexHullFilledMask=e}return this.computed.convexHullFilledMask}get mbr(){if(!this.computed.mbr){let t=Ff({originalPoints:this.convexHull.polyline});if(0===t.length)this.computed.mbr={width:0,height:0,surface:0,perimeter:0,rectangle:t};else{let e=t[0],i=t[1],r=t[2],n=Math.sqrt((e[0]-i[0])**2+(e[1]-i[1])**2),s=Math.sqrt((r[0]-i[0])**2+(r[1]-i[1])**2);this.computed.mbr={width:n,height:s,elongation:1-n/s,aspectRatio:n/s,surface:n*s,perimeter:2*(n+s),rectangle:t}}}return this.computed.mbr}get fillRatio(){return this.surface/(this.surface+this.holesInfo.surface)}get feretDiameters(){return this.computed.feretDiameters||(this.computed.feretDiameters=function(t={}){const{originalPoints:e=Af.call(this)}=t;if(0===e.length)return{min:0,max:0,minLine:[],maxLine:[],aspectRatio:1};if(1===e.length)return{min:1,max:1,minLine:[e[0],e[0]],maxLine:[e[0],e[0]],aspectRatio:1};const i=new Array(e.length);let r=1/0,n=0,s=[];for(let t=0;t<e.length;t++){let o=Vf(e[t],e[(t+1)%e.length]);Pf(-o,e,i);let a=0,h=[];for(let r=0;r<e.length;r++){let e=Math.abs(i[t][1]-i[r][1]);e>a&&(a=e,h=[],h.push([i[r][0],i[t][1]],[i[r][0],i[r][1]]))}a<r&&(r=a,n=o,s=h)}Pf(n,s,s);let o=0,a=[],h=0;for(let t=0;t<e.length-1;t++)for(let i=t+1;i<e.length;i++){let r=(e[t][0]-e[i][0])**2+(e[t][1]-e[i][1])**2;r>h&&(h=r,o=Math.sqrt(r),a=[e[t],e[i]])}return{min:r,minLine:s,max:o,maxLine:a,aspectRatio:r/o}}({originalPoints:this.convexHull.polyline})),this.computed.feretDiameters}get eqpc(){return this.computed.eqpc||(this.computed.eqpc=2*Math.sqrt(this.surface/Math.PI)),this.computed.eqpc}get perimeterInfo(){return this.computed.perimeterInfo||(this.computed.perimeterInfo=function(t){let e=t.map,i=e.data,r=0,n=0,s=0,o=0;for(let a=0;a<t.width;a++)for(let h=0;h<t.height;h++){let l=(h+t.minY)*e.width+a+t.minX;if(i[l]===t.id){let u=0;switch((0===a||t.externalIDs.includes(i[l-1]))&&u++,(a===t.width-1||t.externalIDs.includes(i[l+1]))&&u++,(0===h||t.externalIDs.includes(i[l-e.width]))&&u++,(h===t.height-1||t.externalIDs.includes(i[l+e.width]))&&u++,u){case 1:r++;break;case 2:n++;break;case 3:s++;break;case 4:o++}}}return{one:r,two:n,three:s,four:o}}(this)),this.computed.perimeterInfo}get perimeter(){let t=this.perimeterInfo,e=2-Math.sqrt(2);return t.one+2*t.two+3*t.three+4*t.four-e*(t.two+2*t.three+t.four)}get ped(){return this.computed.ped||(this.computed.ped=this.perimeter/Math.PI),this.computed.ped}get feretMask(){if(!this.computed.feretMask){const t=new dg(this.width+1,this.height+1,{kind:yl,position:[this.minX,this.minY],parent:this.map.parent});t.paintPolyline(this.feretDiameters.minLine),t.paintPolyline(this.feretDiameters.maxLine),this.computed.feretMask=t}return this.computed.feretMask}get mbrMask(){if(!this.computed.mbrMask){let t=function(t){for(let e=0;e<t.length;e++)t[e][0]=Math.round(t[e][0]),t[e][1]=Math.round(t[e][1]);return t}(this.mbr.rectangle);if(t.length>0){const e=Lf(t),i=new dg(e[1][0]-e[0][0]+1,e[1][1]-e[0][1]+1,{kind:yl,position:[this.minX+e[0][0],this.minY+e[0][1]],parent:this.map.parent});t=function(t,e){void 0===e&&(e=new Array(t.length).fill(0).map((()=>[])));let i=Lf(t),r=i[0][0],n=i[0][1];for(let i=0;i<t.length;i++)e[i][0]=t[i][0]-r,e[i][1]=t[i][1]-n;return e}(t),i.paintPolyline(t,{closed:!0}),this.computed.mbrMask=i}else this.computed.mbrMask=new dg(1,1,{kind:yl,position:[this.minX,this.minY],parent:this.map.parent})}return this.computed.mbrMask}get mbrFilledMask(){if(!this.computed.mbrFilledMask){const t=new dg(this.width,this.height,{kind:yl,position:[this.minX,this.minY],parent:this.map.parent}),e=this.mask.minimalBoundingRectangle();for(let i=0;i<this.width;i++)for(let r=0;r<this.height;r++)1!==Uf()(e,[i,r])&&t.setBitXY(i,r);this.computed.mbrFilledMask=t}return this.computed.mbrFilledMask}get points(){if(!this.computed.points){let t=[];for(let e=0;e<this.height;e++)for(let i=0;i<this.width;i++){let r=(e+this.minY)*this.map.width+i+this.minX;this.map.data[r]===this.id&&t.push([i,e])}this.computed.points=t}return this.computed.points}get maxLengthPoints(){if(!this.computed.maxLengthPoints){let t,e=0;const i=this.points;for(let r=0;r<i.length;r++)for(let n=r+1;n<i.length;n++){let s=Math.pow(i[r][0]-i[n][0],2)+Math.pow(i[r][1]-i[n][1],2);s>=e&&(e=s,t=[i[r],i[n]])}this.computed.maxLengthPoints=t}return this.computed.maxLengthPoints}get maxLength(){if(!this.computed.maxLength){let t=Math.sqrt(Math.pow(this.maxLengthPoints[0][0]-this.maxLengthPoints[1][0],2)+Math.pow(this.maxLengthPoints[0][1]-this.maxLengthPoints[1][1],2));this.computed.maxLength=t}return this.computed.maxLength}get roundness(){return 4*this.surface/(Math.PI*this.feretDiameters.max**2)}get sphericity(){return 2*Math.sqrt(this.surface*Math.PI)/this.perimeter}get solidity(){return this.surface/this.convexHull.surface}get angle(){if(!this.computed.angle){let t=this.maxLengthPoints,e=180*-Math.atan2(t[0][1]-t[1][1],t[0][0]-t[1][0])/Math.PI;this.computed.angle=e}return this.computed.angle}toJSON(){return{id:this.id,minX:this.minX,maxX:this.maxX,minY:this.minY,maxY:this.maxY,meanX:this.meanX,meanY:this.meanY,height:this.height,width:this.width,surface:this.surface,mbrWidth:this.mbr.width,mbrHeight:this.mbr.height,mbrSurface:this.mbr.surface,eqpc:this.eqpc,ped:this.ped,feretDiameterMin:this.feretDiameters.min,feretDiameterMax:this.feretDiameters.max,aspectRatio:this.feretDiameters.aspectRatio,fillRatio:this.fillRatio,sphericity:this.sphericity,roundness:this.roundness,solidity:this.solidity,perimeter:this.perimeter}}}class Xf{constructor(t,e){this.roiMap=t,this.options=e,this.roi=this.createRoi()}createRoi(){let t=this.roiMap.data,e={};this.roiMap.positive=0,this.roiMap.negative=0;for(let i=0;i<t.length;i++)t[i]&&!e[t[i]]&&(e[t[i]]=!0,t[i]>0?this.roiMap.positive++:this.roiMap.negative++);let i={};for(let t in e)i[t]=new Yf(this.roiMap,1*t);let r=this.roiMap.width,n=this.roiMap.height;for(let e=0;e<n;e++)for(let n=0;n<r;n++){let s=e*r+n;if(0!==t[s]){const r=i[t[s]];n<r.minX&&(r.minX=n),n>r.maxX&&(r.maxX=n),e<r.minY&&(r.minY=e),e>r.maxY&&(r.maxY=e),r.meanX+=n,r.meanY+=e,r.surface++}}let s=[];for(let t in e)i[t].meanX/=i[t].surface,i[t].meanY/=i[t].surface,s.push(i[t]);return s}}function jf(t={}){const{algorithm:e="commonBorderLength",minCommonBorderLength:i=5,maxCommonBorderLength:r=100,minCommonBorderRatio:n=.3,maxCommonBorderRatio:s=1}=t;let o=function(t,e,n){return t[n]>=i&&t[n]<=r};"function"==typeof e&&(o=e),"commonborderratio"===e.toLowerCase()&&(o=function(t,e,i){let r=Math.min(t[i]/t[e],1);return r>=n&&r<=s});const a=this,h=a.commonBorderLength;let l={},u={};for(let t of Object.keys(h)){let e=h[t],i=Object.keys(e);for(let r of i)if(r!==t&&o(e,t,r)){let e=r;u[r]&&(e=u[r]);let i=t;if(u[t]&&(i=u[t]),Number(e)!==i){let t=Math.min(e,i),r=Math.max(e,i);if(l[t]||(l[t]={}),l[t][r]=!0,u[r]=t,l[r]){for(let e of Object.keys(l[r]))l[t][e]=!0,u[e]=t;delete l[r]}}}}let c=a.minMax,d=-c.min,f=c.max+d,g=new Array(f+1).fill(0);for(let t of Object.keys(u))g[Number(t)+d]=u[t];let m=a.data;for(let t=0;t<m.length;t++){let e=m[t];if(0!==e){let i=g[e+d];0!==i&&(m[t]=i)}}return a.computed={},a}class Gf{constructor(t,e){this.parent=t,this.width=t.width,this.height=t.height,this.data=e,this.negative=0,this.positive=0}get total(){return this.negative+this.positive}get minMax(){let t=Number.MAX_SAFE_INTEGER,e=Number.MIN_SAFE_INTEGER;for(let i=0;i<this.data.length;i++)this.data[i]<t&&(t=this.data[i]),this.data[i]>e&&(e=this.data[i]);return{min:t,max:e}}get commonBorderLength(){return function(t){let e=t.data,i=[1,0,-1,0],r=[0,1,0,-1],n=t.minMax,s=-n.min,o=n.max+s,a=[];for(let t=0;t<=o;t++)a.push(Object.create(null));for(let n=0;n<t.width;n++)for(let o=0;o<t.height;o++){let h=e[n+o*t.width];if(0!==h){let l=Object.create(null),u=!1;for(let c=0;c<4;c++){let d=n+i[c],f=o+r[c];if(d>=0&&f>=0&&d<t.width&&f<t.height){let i=e[d+f*t.width];h!==i&&(u=!0,0!==i&&void 0===l[i]&&(l[i]=!0,a[i+s][h]?a[i+s][h]++:a[i+s][h]=1))}else u=!0}u&&(a[h+s][h]?a[h+s][h]++:a[h+s][h]=1)}}let h={};for(let t=0;t<a.length;t++)Object.keys(a[t]).length>0&&(h[t-s]=a[t]);return h}(this)}mergeRoi(t={}){return jf.call(this,t)}mergeRois(t){const e=t[0],i=t.slice(1);for(let t=0;t<this.data.length;t++)i.includes(this.data[t])&&(this.data[t]=e)}rowsInfo(){let t=new Array(this.height),e=0;for(let i=0;i<this.data.length;i+=this.width){let r={row:e,positivePixel:0,negativePixel:0,zeroPixel:0,positiveRoi:0,negativeRoi:0,medianChange:0};t[e++]=r;let n={},s={},o=[],a=this.data[i],h=0;for(let t=i;t<i+this.width;t++){let e=this.data[t];a!==e&&(a=e,o.push(h),h=0),h++,e>0?(r.positivePixel++,n[e]||(n[e]=!0)):e<0?(r.negativePixel++,s[e]||(s[e]=!0)):r.zeroPixel++}o.push(h),r.medianChange=o.sort(((t,e)=>t-e))[Math.floor(o.length/2)],r.positiveRoiIDs=Object.keys(n),r.negativeRoiIDs=Object.keys(s),r.positiveRoi=r.positiveRoiIDs.length,r.negativeRoi=r.negativeRoiIDs.length}return t}colsInfo(){let t=new Array(this.width),e=0;for(let i=0;i<this.width;i++){let r={col:e,positivePixel:0,negativePixel:0,zeroPixel:0,positiveRoi:0,negativeRoi:0,medianChange:0};t[e++]=r;let n={},s={},o=[],a=this.data[i],h=0;for(let t=i;t<i+this.data.length;t+=this.width){let e=this.data[t];a!==e&&(a=e,o.push(h),h=0),h++,e>0?(r.positivePixel++,n[e]||(n[e]=!0)):e<0?(r.negativePixel++,s[e]||(s[e]=!0)):r.zeroPixel++}o.push(h),r.medianChange=o.sort(((t,e)=>t-e))[Math.floor(o.length/2)],r.positiveRoiIDs=Object.keys(n),r.negativeRoiIDs=Object.keys(s),r.positiveRoi=r.positiveRoiIDs.length,r.negativeRoi=r.negativeRoiIDs.length}return t}}function qf(t,e={}){const{allowCorners:i=!1}=e,r=65535;let n=new Int16Array(t.size),s=0,o=0,a=new Uint16Array(65536),h=new Uint16Array(65536);for(let e=0;e<t.width;e++)for(let i=0;i<t.height;i++)0===n[i*t.width+e]&&l(e,i);function l(e,l){let u=0,c=0,d=t.getBitXY(e,l),f=d?++s:--o;if(s>32767||o<-32768)throw new Error("Too many regions of interest");for(a[0]=e,h[0]=l;u<=c;){let e=a[u&r],s=h[u&r];if(n[s*t.width+e]=f,e>0&&0===n[s*t.width+e-1]&&t.getBitXY(e-1,s)===d&&(c++,a[c&r]=e-1,h[c&r]=s,n[s*t.width+e-1]=-32768),s>0&&0===n[(s-1)*t.width+e]&&t.getBitXY(e,s-1)===d&&(c++,a[c&r]=e,h[c&r]=s-1,n[(s-1)*t.width+e]=-32768),e<t.width-1&&0===n[s*t.width+e+1]&&t.getBitXY(e+1,s)===d&&(c++,a[c&r]=e+1,h[c&r]=s,n[s*t.width+e+1]=-32768),s<t.height-1&&0===n[(s+1)*t.width+e]&&t.getBitXY(e,s+1)===d&&(c++,a[c&r]=e,h[c&r]=s+1,n[(s+1)*t.width+e]=-32768),i&&(e>0&&s>0&&0===n[(s-1)*t.width+e-1]&&t.getBitXY(e-1,s-1)===d&&(c++,a[c&r]=e-1,h[c&r]=s-1,n[(s-1)*t.width+e-1]=-32768),e<t.width-1&&s>0&&0===n[(s-1)*t.width+e+1]&&t.getBitXY(e+1,s-1)===d&&(c++,a[c&r]=e+1,h[c&r]=s-1,n[(s-1)*t.width+e+1]=-32768),e>0&&s<t.height-1&&0===n[(s+1)*t.width+e-1]&&t.getBitXY(e-1,s+1)===d&&(c++,a[c&r]=e-1,h[c&r]=s+1,n[(s+1)*t.width+e-1]=-32768),e<t.width-1&&s<t.height-1&&0===n[(s+1)*t.width+e+1]&&t.getBitXY(e+1,s+1)===d&&(c++,a[c&r]=e+1,h[c&r]=s+1,n[(s+1)*t.width+e+1]=-32768)),u++,c-u>r)throw new Error("analyseMask can not finish, the array to manage internal data is not big enough.You could improve mask by changing MAX_ARRAY")}}return new Gf(t,n)}var Zf=__webpack_require__(530),Kf=__webpack_require__.n(Zf);const Hf=[-1,0],Wf=[0,-1],$f=[null,null],Qf=[-1,-1,0,1],Jf=[0,-1,-1,-1],tg=[null,null,null,null];function eg(t,e={}){const{allowCorners:i=!1}=e;let r,n,s,o=4;if(i&&(o=8),8===o)r=Qf,n=Jf,s=tg;else{if(4!==o)throw new RangeError(`unsupported neighbours count: ${o}`);r=Hf,n=Wf,s=$f}const a=t.size,h=t.width,l=t.height,u=new Array(a),c=new Uint32Array(a),d=new(Kf());let f=1;for(let e=0;e<l;e++)for(let i=0;i<h;i++){const o=i+e*h;if(t.getBit(o)){let t=null;for(let o=0;o<s.length;o++){const a=i+r[o],c=e+n[o];if(a>=0&&c>=0&&a<h&&c<l){let e=u[a+c*h];e?(s[o]=e,(!t||s[o].value<t.value)&&(t=s[o])):s[o]=null}}if(t){u[o]=t;for(let e=0;e<s.length;e++)s[e]&&s[e]!==t&&d.union(t,s[e])}else u[o]=d.add(f++)}}for(let e=0;e<l;e++)for(let i=0;i<h;i++){const r=i+e*h;t.getBit(r)&&(c[r]=d.find(u[r]).value)}return new Gf(t,c)}function ig(t={}){let{allowCorner:e=!0,onlyTop:i=!1,invert:r=!1}=t,n=this;n.checkProcessable("fromMaxima",{components:[1]});const s=1,o=2;let a=0,h=0,l=new Int16Array(n.size),u=new Int8Array(n.size),c=new Float32Array(n.size),d=1048575,f=new Uint16Array(d+1),g=new Uint16Array(d+1),m=0,p=0,w=new Uint16Array(d+1),_=new Uint16Array(d+1),b=0,y=0;for(function({maxima:t=!0}){for(let i=1;i<n.height-1;i++)for(let r=1;r<n.width-1;r++){let s=r+i*n.width;if(0===u[s]){let o=t?n.data[s]:-n.data[r+i*n.width];if(n.data[i*n.width+r-1]>o)continue;if(n.data[i*n.width+r+1]>o)continue;if(n.data[(i-1)*n.width+r]>o)continue;if(n.data[(i+1)*n.width+r]>o)continue;if(e){if(n.data[(i-1)*n.width+r-1]>o)continue;if(n.data[(i-1)*n.width+r+1]>o)continue;if(n.data[(i+1)*n.width+r-1]>o)continue;if(n.data[(i+1)*n.width+r+1]>o)continue}l[s]=t?++a:--h,v(r,i)||(t?--a:++h)}}}(n);m<p;)x(f[m&d],g[m&d],o),m++;return new Gf(n,l);function v(t,e){let i=p;b=0,y=1,w[0]=t,_[0]=e;let r=!0;for(;b<y;)r&=x(w[b&d],_[b&d],s),b++;if(!r){for(let t=0;t<y;t++){let e=w[t&d],i=_[t&d]*n.width+e;l[i]=0}p=i}return r}function x(t,e,r){let a=l[e*n.width+t],h=n.data[e*n.width+t];for(let m=e-1;m<=e+1;m++)for(let e=t-1;e<=t+1;e++){let t=m*n.width+e;if(0===u[t])switch(u[t]=1,c[t]=n.data[t]-h,r){case s:if(0===c[t]){if(0===e||0===m||e===n.width-1||m===n.height-1)return!1;l[t]=a,w[y&d]=e,_[y&d]=m,y++}else{if(c[t]>0)return!1;i||(l[t]=a,f[p&d]=e,g[p&d]=m,p++)}break;case o:c[t]<=0&&(l[t]=a,f[p&d]=e,g[p&d]=m,p++);break;default:throw new Error("unreachable")}}return!0}}function rg(t,e={}){let i=new ef(e),r=new Int16Array(this.size),n=0,s=i.getPoints();for(let e=0;e<t.length;e++){n++;let i=t[e][0],o=t[e][1];for(let t=0;t<s.length;t++){let e=s[t][0],a=s[t][1];i+e>=0&&o+a>=0&&i+e<this.width&&o+a<this.height&&(r[i+e+(o+a)*this.width]=n)}}return new Gf(this,r)}var ng=__webpack_require__(5307),sg=__webpack_require__.n(ng);const og=[1,0,-1,0,1,1,-1,-1],ag=[0,1,0,-1,1,-1,1,-1];function hg(t={}){let{points:e,mask:i,image:r,fillMaxValue:n=this.maxValue,invert:s=!1}=t,o=r||this;o.checkProcessable("fromWaterShed",{bitDepth:[8,16],components:1}),s=!s,e||(e=o.getLocalMaxima({invert:s,mask:i}));let a=s?0:1,h=new Int16Array(o.size),l=o.width,u=o.height,c=new(sg())({comparator:(t,e)=>t[2]-e[2],strategy:sg().BinaryHeapStrategy});for(let t=0;t<e.length;t++){let i=e[t][0]+e[t][1]*l;h[i]=t+1;let r=o.data[i];(s&&r<=n||!s&&r>=n)&&c.queue([e[t][0],e[t][1],r])}for(;c.length>0;){let t=c.dequeue(),e=t[0]+t[1]*l;for(let r=0;r<4;r++){let d=t[0]+og[r],f=t[1]+ag[r];if(d>=0&&f>=0&&d<l&&f<u){let u=d+f*l;if(!i||i.getBit(u)===a){let i=o.data[u];(s&&i<=n||!s&&i>=n)&&0===h[u]&&(h[u]=h[e],c.queue([t[0]+og[r],t[1]+ag[r],i]))}}}}return new Gf(o,h)}class lg{constructor(t,e={}){this._image=t,this._options=e,this._options.label||(this._options.label="default"),this._layers={},this._painted=null}fromMaxima(t={}){let e=Object.assign({},this._options,t),i=ig.call(this._image,t);this._layers[e.label]=new Xf(i,e)}fromPoints(t,e={}){let i=Object.assign({},this._options,e),r=rg.call(this._image,t,e);return this._layers[i.label]=new Xf(r,i),this}putMap(t,e={}){let i=new Gf(this._image,t),r=Object.assign({},this._options,e);return this._layers[r.label]=new Xf(i,r),this}fromWaterShed(t={}){let e=Object.assign({},this._options,t),i=hg.call(this._image,t);this._layers[e.label]=new Xf(i,e)}fromMask(t,e={}){let i=Object.assign({},this._options,e),r=qf.call(this._image,t,e);return this._layers[i.label]=new Xf(r,i),this}fromMaskConnectedComponentLabelingAlgorithm(t,e={}){let i=Object.assign({},this._options,e),r=eg.call(this._image,t,e);return this._layers[i.label]=new Xf(r,i),this}getMap(t={}){let e=Object.assign({},this._options,t);return this._assertLayerWithLabel(e.label),this._layers[e.label].roiMap}rowsInfo(t={}){return this.getMap(t).rowsInfo()}colsInfo(t={}){return this.getMap(t).rowsInfo()}getRoiIds(t={}){let e=this.getRois(t);if(e){let t=new Array(e.length);for(let i=0;i<e.length;i++)t[i]=e[i].id;return t}throw new Error("ROIs not found")}getRois(t={}){let{label:e=this._options.label,positive:i=!0,negative:r=!0,minSurface:n=0,maxSurface:s=Number.POSITIVE_INFINITY,minWidth:o=0,maxWidth:a=Number.POSITIVE_INFINITY,minHeight:h=0,maxHeight:l=Number.POSITIVE_INFINITY,minRatio:u=0,maxRatio:c=Number.POSITIVE_INFINITY}=t;if(!this._layers[e])throw new Error(`this Roi layer (${e}) does not exist`);const d=this._layers[e].roi,f=[];for(const t of d)(t.id<0&&r||t.id>0&&i)&&t.surface>=n&&t.surface<=s&&t.width>=o&&t.width<=a&&t.height>=h&&t.height<=l&&t.ratio>=u&&t.ratio<=c&&f.push(t);return f}getRoi(t,e={}){const{label:i=this._options.label}=e;if(!this._layers[i])throw new Error(`this Roi layer (${i}) does not exist`);const r=this._layers[i].roi.find((e=>e.id===t));if(!r)throw new Error(`found no Roi with id ${t}`);return r}getMasks(t={}){let e=this.getRois(t),i=new Array(e.length);for(let r=0;r<e.length;r++)i[r]=e[r].getMask(t);return i}getAnalysisMasks(t={}){const{analysisProperty:e}=t;let i=`${e}Mask`,r=this.getRois(t);return 0!==r.length&&r[0][i]?r.map((t=>t[i])):[]}getData(t={}){let e=Object.assign({},this._options,t);return this._assertLayerWithLabel(e.label),this._layers[e.label].roiMap.data}paint(t={}){let{labelProperty:e,analysisProperty:i}=t;this._painted||(this._painted=this._image.rgba8());let r=this.getMasks(t);if(e){const i=this.getRois(t);t.labels=i.map((t=>function(t,e=""){let i=e.split(".");for(let e of i){if(void 0===t[e])return;t=t[e]}return t}(t,e)));const r=Math.max(...t.labels);let n=!1,s=!1;if(e.includes("surface")?n=!0:/(?:perimeter|min|max|external|width|height|length)/.test(e)&&(s=!0),isFinite(r)){let e="";if("pixel"!==t.unit&&t.pixelSize&&(s||n)){e=n?`${t.unit}^2`:t.unit;let i=n?"m^2":"m",r=n?t.pixelSize**2:t.pixelSize;const s=Nf().swiftConverter(i,e);t.labels=t.labels.map((t=>s(r*t)))}t.labels=r>50?t.labels.map((t=>Math.round(t)+e)):r>10?t.labels.map((t=>t.toFixed(1)+e)):t.labels.map((t=>t.toFixed(2)+e))}t.labelsPosition=i.map((t=>[t.meanX,t.meanY]))}if(this._painted.paintMasks(r,t),i){let e=this.getAnalysisMasks(t);this._painted.paintMasks(e,{color:t.analysisColor,alpha:t.analysisAlpha})}return this._painted}getMask(t={}){let e=new dg(this._image.width,this._image.height,{kind:"BINARY"}),i=this.getMasks(t);for(let t=0;t<i.length;t++){let r=i[t];for(let t=0;t<r.width;t++)for(let i=0;i<r.height;i++)r.getBitXY(t,i)&&e.setBitXY(t+r.position[0],i+r.position[1])}return e}resetPainted(t={}){const{image:e}=t;this._painted=e?this.image.rgba8():this._image.rgba8()}mergeRoi(t={}){const e=this.getMap(t);return e.mergeRoi(t),this.putMap(e.data,t),this}mergeRois(t,e={}){if(!Array.isArray(t)||t.some((t=>!Number.isInteger(t))))throw new Error("Roi ids must be an array of integers");if(t.length<2)throw new Error("Roi ids must have at least two elements");if(new Set(t).size!==t.length)throw new Error("Roi ids must be all different");t.forEach((t=>this.getRoi(t)));const i=this.getMap(e);return i.mergeRois(t),this.putMap(i.data,e),this}findCorrespondingRoi(t,e={}){let i=this.getRois(e),r=[];for(let e=0;e<i.length;e++){let n=i[e],s=ug(n.minX,n.minY,n.points,t,Math.sign(n.id));r.push(s)}return r}_assertLayerWithLabel(t){if(!this._layers[t])throw new Error(`no layer with label ${t}`)}}function ug(t,e,i,r,n){let s={id:[],surface:[],roiSurfaceCovered:[],same:0,opposite:0,total:0};for(let n=0;n<i.length;n++){let o=i[n],a=o[0]+t+(o[1]+e)*r.width,h=r.data[a];(h>0||h<0)&&(s.id.includes(h)?s.surface[s.id.indexOf(h)]+=1:(s.id.push(h),s.surface.push(1)))}for(let t=0;t<s.id.length;t++)Math.sign(s.id[t])===n?s.same+=s.surface[t]:s.opposite+=s.surface[t],s.roiSurfaceCovered[t]=s.surface[t]/i.length;return s.total=s.opposite+s.same,s}const cg=Object.prototype.toString;class dg{constructor(e,i,r,n){if(1===arguments.length?(n=e,({width:e,height:i,data:r}=n)):r&&!r.length&&(n=r,({data:r}=n)),void 0===e&&(e=1),void 0===i&&(i=1),void 0===n&&(n={}),"object"!=typeof n||null===n)throw new TypeError("options must be an object");if(!Number.isInteger(e)||e<=0)throw new RangeError("width must be a positive integer");if(!Number.isInteger(i)||i<=0)throw new RangeError("height must be a positive integer");const{kind:s=vl}=n;if("string"!=typeof s)throw new TypeError("kind must be a string");const o=function(t){const e=xl[t];if(!e)throw new RangeError(`invalid image kind: ${t}`);return e}(s),a=Object.assign({},n);for(const t in o)void 0===a[t]&&(a[t]=o[t]);!function(e){const{components:i,alpha:r,bitDepth:n,colorModel:s}=e;if(!Number.isInteger(i)||i<=0)throw new RangeError(`invalid components: ${i}. Must be a positive integer`);if(0!==r&&1!==r&&"boolean"!=typeof r)throw new TypeError(`invalid alpha: ${r}: must be a boolean, 0 or 1`);if(!Ml.includes(n))throw new RangeError(`invalid bitDepth: ${n}. Must be one of ${Ml.join(", ")}`);if(!t[s])throw new RangeError(`invalid colorModel: ${s}. Must be one of ${Object.keys(t).join(", ")}`)}(a);const{components:h,bitDepth:l,colorModel:u}=a,c=a.alpha+0,d=e*i,f=h+c,g=32===l?Number.MAX_VALUE:2**l-1;if(void 0===r)r=function(t,e,i,r,n,s){const o=r*t;let a;switch(n){case 1:a=new Uint8Array(Math.ceil(o/8));break;case 8:a=new Uint8Array(o);break;case 16:a=new Uint16Array(o);break;case 32:a=new Float32Array(o);break;default:throw new Error(`Cannot create pixel array for bit depth ${n}`)}if(i)for(let t=e;t<a.length;t+=r)a[t]=s;return a}(d,h,c,f,l,g);else{const t=function(t,e,i){let r=e*t;return 1===i&&(r=Math.ceil(r/8)),r}(d,f,l);if(r.length!==t)throw new RangeError(`incorrect data size: ${r.length}. Should be ${t}`)}this.width=e,this.height=i,this.data=r,this.size=d,this.components=h,this.alpha=c,this.bitDepth=l,this.maxValue=g,this.colorModel=u,this.channels=f,this.meta=n.meta||{},Object.defineProperty(this,"parent",{enumerable:!1,writable:!0,configurable:!0,value:n.parent||null}),this.position=n.position||[0,0],this.computed=null,this.sizes=[this.width,this.height],this.multiplierX=this.channels,this.multiplierY=this.channels*this.width,this.isClamped=this.bitDepth<32,this.borderSizes=[0,0]}get[Symbol.toStringTag](){return"IJSImage"}static isImage(t){return"[object IJSImage]"===cg.call(t)}static fromCanvas(t){const e=t.getContext("2d").getImageData(0,0,t.width,t.height);return new dg(e.width,e.height,e.data)}static createFrom(t,e){const i=gu(t);return Object.assign(i,{parent:t,position:[0,0]},e),new dg(i)}getRoiManager(t){return new lg(this,t)}clone(){const t=this.data.slice();return new dg(this.width,this.height,t,this)}apply(t){for(let e=0;e<this.height;e++)for(let i=0;i<this.width;i++){let r=(e*this.width+i)*this.channels;t.call(this,r)}}}!function(t){for(const e in fu)t.prototype[e]=fu[e]}(dg),function(t){for(const e in gs)t.prototype[e]=gs[e]}(dg),function(t){for(const e in cl)t.prototype[e]=cl[e]}(dg),dg.prototype.checkProcessable=function(t,e={}){let{bitDepth:i,alpha:r,colorModel:n,components:s,channels:o}=e;if("string"!=typeof t||0===t.length)throw new TypeError("processName must be a string");if(i&&(Array.isArray(i)||(i=[i]),!i.includes(this.bitDepth)))throw new TypeError(`The process: ${t} can only be applied if bit depth is in: ${i}`);if(r&&(Array.isArray(r)||(r=[r]),!r.includes(this.alpha)))throw new TypeError(`The process: ${t} can only be applied if alpha is in: ${r}`);if(n&&(Array.isArray(n)||(n=[n]),!n.includes(this.colorModel)))throw new TypeError(`The process: ${t} can only be applied if color model is in: ${n}`);if(s&&(Array.isArray(s)||(s=[s]),!s.includes(this.components))){let e=`The process: ${t} can only be applied if the number of components is in: ${s}`;throw 1===s.length&&1===s[0]?new TypeError(`${e}.\rYou should transform your image using "image.grey()" before applying the algorithm.`):new TypeError(e)}if(o&&(Array.isArray(o)||(o=[o]),!o.includes(this.channels)))throw new TypeError(`The process: ${t} can only be applied if the number of channels is in: ${o}`)},dg.prototype.getRGBAData=function(t={}){const{clamped:e}=t;this.checkProcessable("getRGBAData",{components:[1,3],bitDepth:[1,8,16,32]});const i=this.width*this.height*4;let r=e?new Uint8ClampedArray(i):new Uint8Array(i);return 1===this.bitDepth?function(t,e){for(let i=0;i<t.size;i++){const r=t.getBit(i);e[4*i]=255*r,e[4*i+1]=255*r,e[4*i+2]=255*r}}(this,r):32===this.bitDepth?(this.checkProcessable("getRGBAData",{alpha:0}),1===this.components?function(t,e){const i=t.min[0],r=t.max[0]-i;for(let n=0;n<t.size;n++){const s=Math.floor(255*(t.data[n]-i)/r);e[4*n]=s,e[4*n+1]=s,e[4*n+2]=s}}(this,r):3===this.components&&(this.checkProcessable("getRGBAData",{colorModel:[pl]}),function(t,e){const i=Math.min(...t.min),r=Math.max(...t.max)-i;for(let n=0;n<t.size;n++){const s=Math.floor(255*(t.data[3*n]-i)/r),o=Math.floor(255*(t.data[3*n+1]-i)/r),a=Math.floor(255*(t.data[3*n+2]-i)/r);e[4*n]=s,e[4*n+1]=o,e[4*n+2]=a}}(this,r))):1===this.components?function(t,e){for(let i=0;i<t.size;i++)e[4*i]=t.data[i*t.channels]>>>t.bitDepth-8,e[4*i+1]=t.data[i*t.channels]>>>t.bitDepth-8,e[4*i+2]=t.data[i*t.channels]>>>t.bitDepth-8}(this,r):3===this.components&&(this.checkProcessable("getRGBAData",{colorModel:[pl]}),function(t,e){for(let i=0;i<t.size;i++)e[4*i]=t.data[i*t.channels]>>>t.bitDepth-8,e[4*i+1]=t.data[i*t.channels+1]>>>t.bitDepth-8,e[4*i+2]=t.data[i*t.channels+2]>>>t.bitDepth-8}(this,r)),1===this.alpha?(this.checkProcessable("getRGBAData",{bitDepth:[8,16]}),function(t,e){for(let i=0;i<t.size;i++)e[4*i+3]=t.data[i*t.channels+t.components]>>t.bitDepth-8}(this,r)):function(t,e){for(let i=0;i<t.size;i++)e[4*i+3]=255}(this,r),r},dg.load=function(t,e){if("string"==typeof t)return function(t,e){const i=t.slice(0,64).match(hu);let r;return r=null!==i?Promise.resolve(function(t){let e,i,r,n,s=.75*t.length,o=t.length,a=0;"="===t[t.length-1]&&(s--,"="===t[t.length-2]&&s--);const h=new Uint8Array(s);for(let s=0;s<o;s+=4)e=nl[t.charCodeAt(s)],i=nl[t.charCodeAt(s+1)],r=nl[t.charCodeAt(s+2)],n=nl[t.charCodeAt(s+3)],h[a++]=e<<2|i>>4,h[a++]=(15&i)<<4|r>>2,h[a++]=(3&r)<<6|63&n;return h}(t.slice(i[0].length))):function(t,{withCredentials:e=!1}={}){return new Promise((function(i,r){let n=new self.XMLHttpRequest;n.open("GET",t,!0),n.responseType="arraybuffer",n.withCredentials=e,n.onload=function(t){200!==this.status?r(t):i(this.response)},n.onerror=r,n.send()}))}(t,e),r.then((r=>lu(new Uint8Array(r),i?t:void 0,e&&e.ignorePalette)))}(t,e);if(t instanceof ArrayBuffer)return Promise.resolve(lu(new Uint8Array(t),void 0,e&&e.ignorePalette));if(t.buffer)return Promise.resolve(lu(t,void 0,e&&e.ignorePalette));throw new Error('argument to "load" must be a string or buffer.')},dg.extendMethod=function(t,e,i={}){let{inPlace:r=!1,returnThis:n=!0,partialArgs:s=[]}=i;return dg.prototype[t]=r?function(...t){this.computed=null;let i=e.apply(this,[...s,...t]);return n?this:i}:function(...t){return e.apply(this,[...s,...t])},dg},dg.extendProperty=function(t,e,i={}){let{partialArgs:r=[]}=i;return gl.get=function(){if(null===this.computed)this.computed={};else if(fl()(t,this.computed))return this.computed[t];let i=e.apply(this,r);return this.computed[t]=i,i},Object.defineProperty(dg.prototype,t,gl),dg},function(t){let e={inPlace:!0};t.extendMethod("invert",_u),t.extendMethod("abs",wu),t.extendMethod("level",Wu,e),t.extendMethod("add",tc,e),t.extendMethod("subtract",ec,e),t.extendMethod("subtractImage",ic),t.extendMethod("multiply",nc,e),t.extendMethod("divide",sc,e),t.extendMethod("hypotenuse",rc),t.extendMethod("background",dc),t.extendMethod("flipX",bu),t.extendMethod("flipY",yu),t.extendMethod("blurFilter",vu),t.extendMethod("medianFilter",Cu),t.extendMethod("gaussianFilter",Su),t.extendMethod("sobelFilter",qu),t.extendMethod("gradientFilter",Gu),t.extendMethod("scharrFilter",Zu),t.extendMethod("dilate",fc),t.extendMethod("erode",_c),t.extendMethod("open",Mc),t.extendMethod("close",kc),t.extendMethod("topHat",Ec),t.extendMethod("blackHat",Cc),t.extendMethod("morphologicalGradient",Sc),t.extendMethod("warpingFourPoints",Ic),t.extendMethod("crop",Dc),t.extendMethod("cropAlpha",Lc),t.extendMethod("resize",Oc).extendMethod("scale",Oc),t.extendMethod("hsv",Uc),t.extendMethod("hsl",Vc),t.extendMethod("cmyk",Yc),t.extendMethod("rgba8",Xc),t.extendMethod("grey",qc).extendMethod("gray",qc),t.extendMethod("mask",nd),t.extendMethod("pad",sd),t.extendMethod("colorDepth",od),t.extendMethod("setBorder",fd,e),t.extendMethod("rotate",hd),t.extendMethod("rotateLeft",ld),t.extendMethod("rotateRight",ud),t.extendMethod("insert",dd),t.extendMethod("getRow",Md),t.extendMethod("getColumn",kd),t.extendMethod("getMatrix",Ed),t.extendMethod("setMatrix",Cd),t.extendMethod("getPixelsArray",Sd),t.extendMethod("getIntersection",Ad),t.extendMethod("getClosestCommonParent",Rd),t.extendMethod("getThreshold",id),t.extendMethod("split",gd),t.extendMethod("getChannel",md),t.extendMethod("combineChannels",pd),t.extendMethod("setChannel",_d),t.extendMethod("getSimilarity",bd),t.extendMethod("getPixelsGrid",yd),t.extendMethod("getBestMatch",xd),t.extendMethod("cannyEdge",Bd),t.extendMethod("convolution",ju),t.extendMethod("extract",Nd),t.extendMethod("floodFill",Vd),t.extendMethod("paintLabels",Wd,e),t.extendMethod("paintMasks",$d,e),t.extendMethod("paintPoints",rf,e),t.extendMethod("paintPolyline",nf,e),t.extendMethod("paintPolylines",sf,e),t.extendMethod("paintPolygon",of,e),t.extendMethod("paintPolygons",lf,e),t.extendMethod("countAlphaPixels",kf),t.extendMethod("monotoneChainConvexHull",Af),t.extendMethod("minimalBoundingRectangle",Ff),t.extendMethod("getHistogram",uf).extendProperty("histogram",uf),t.extendMethod("getHistograms",cf).extendProperty("histograms",cf),t.extendMethod("getColorHistogram",ff).extendProperty("colorHistogram",ff),t.extendMethod("getMin",gf).extendProperty("min",gf),t.extendMethod("getMax",mf).extendProperty("max",mf),t.extendMethod("getSum",pf).extendProperty("sum",pf),t.extendMethod("getMoment",wf).extendProperty("moment",wf),t.extendMethod("getLocalMaxima",_f),t.extendMethod("getMedian",yf).extendProperty("median",yf),t.extendMethod("getMean",bf).extendProperty("mean",bf),t.extendMethod("getPoints",vf).extendProperty("points",vf),t.extendMethod("getExtendedPoints",xf).extendProperty("extendedPoints",xf),t.extendMethod("getRelativePosition",Mf)}(dg);var fg=__webpack_require__(6732),gg=__webpack_require__.n(fg);const mg={regression:{kernelType:"polynomial",kernelOptions:{degree:2,constant:1}},threshold:.02,roi:{minSurface:100,positive:!1},sampling:20,include:[]};function pg(t,e,i){return t.post("data",[e,i]).then((function(t){for(let e in t)t[e]=new dg(t[e]);return t}))}const wg={run:function(t,e,i){e=Object.assign({},mg,e);const r=this.manager;return Array.isArray(t)?Promise.all(t.map((function(t){const n=pg(r,t,e);return"function"==typeof i&&n.then(i),n}))):pg(r,t,e)},work:function(){worker.on("data",(function(t,e,i){e=new IJS(e);const r={},n=[],s=e.grey(),o=s.sobelFilter();f("sobel",o);const a=o.level().mask({threshold:i.threshold});f("mask",a);const h=o.getRoiManager();h.fromMask(a);const l=h.getMask(i.roi);f("realMask",l);const u=s.getPixelsGrid({sampling:i.sampling,mask:l}),c=e.getBackground(u.xyS,u.zS,i.regression);f("background",c);const d=e.subtract(c);function f(t,e){i.include.includes(t)&&(r[t]=e,n.push(e.data.buffer))}r.result=d,n.push(d.data.buffer),t(r,n)}))}},_g=wg;class bg{constructor(){this._url=null,this._deps=[null]}checkUrl(){if(null===this._url)throw new Error("image worker must be initialized with an URL")}get url(){return this._url}set url(t){if("string"!=typeof t)throw new TypeError("worker URL must be a string");this._url=t,this._deps[0]=t}static extendMethod(t,e){let i,r,n={};function s(...t){return i||(this.checkUrl(),r=this.url,i=new(gg())(e.work,{deps:r}),n.manager=i),e.run.call(n,...t)}s.reset=function(){i&&(i.terminate(),i=new(gg())(e.work,{deps:r}),n.manager=i)},bg.prototype[t]=s}}function yg(t,e,i){return.29889531*t+.58662247*e+.11448223*i}function vg(t,e,i){return.59597799*t-.2741761*e-.32180189*i}function xg(t,e,i){return.21147017*t-.52261711*e+.31114694*i}function Mg(t){let e=t.slice(),i=[],r=e[0];i.push(r),e[0]=[NaN,NaN],console.log(e,"pos");let n=0,s=e.length-1,o=0;function a(t){return[[t[0]-1,t[1]-1],[t[0],t[1]-1],[t[0]+1,t[1]-1],[t[0]-1,t[1]],t,[t[0]+1,t[1]],[t[0]-1,t[1]+1],[t[0],t[1]+1],[t[0]+1,t[1]+1]]}for(let r=0;r<=i.length;r++){o++;let h=i.length,l=a(i[r]);t:for(let r=0;r<l.length;r++)for(let n=1;n<e.length&&4!==r;n++)if(l[r][0]===e[n][0]&&l[r][1]===e[n][1]&&NaN!=e[n][0]&&NaN!=e[n][1]){i.push(t[n]),e[n]=[NaN,NaN],s-=1;break t}if(i.length-h==0&&(i.pop(),r-=2,n+=1),o===e.length-1){console.log("breaked");break}}return console.log(s,"subf"),console.log(n,"if"),console.log(o,"ii"),i}!function(t){t.extendMethod("background",_g)}(bg),new bg;let kg=(new class{constructor(){this.apikeys={BingMapKey:"AoTrgwP6rdBDsqtY-wq-Z5aA31YHoSzOyKStmu8t0-ZLUbO2LS4PbYoNYNe2SPSx"}}getKeys(){return this.apikeys}}).getKeys().BingMapKey;const Eg=document.getElementById("imgCanvas1"),Cg=document.getElementById("imgCanvas2"),Sg=Eg.getContext("2d",{willReadFrequently:!0}),Ag=Cg.getContext("2d",{willReadFrequently:!0});var Tg=document.createElement("canvas"),Rg=document.createElement("canvas");Tg.getContext("2d"),Rg.getContext("2d"),new dg,new dg;const Pg=document.getElementById("mapToCanvasBtn");let Ig,Dg,Lg,Fg=!1;async function zg(t,e,i){t.once("rendercomplete",(function(){const r=t.getSize();e.width=r[0],e.height=r[1];const n=i;Array.prototype.forEach.call(t.getViewport().querySelectorAll(".ol-layer canvas, canvas.ol-layer"),(function(t){if(t.width>0){const e=t.parentNode.style.opacity||t.style.opacity;let i;n.globalAlpha=""===e?1:Number(e);const r=t.style.transform;i=r?r.match(/^matrix\(([^\(]*)\)$/)[1].split(",").map(Number):[parseFloat(t.style.width)/t.width,0,0,parseFloat(t.style.height)/t.height,0,0],CanvasRenderingContext2D.prototype.setTransform.apply(n,i);const s=t.parentNode.style.backgroundColor;s&&(n.fillStyle=s,n.fillRect(0,0,t.width,t.height)),n.drawImage(t,0,0)}})),n.globalAlpha=1,n.setTransform(1,0,0,1,0,0)})),t.renderSync()}Pg.addEventListener("click",(()=>{let t=Sg.getImageData(0,0,Eg.width,Eg.height),e=Dg.getView().calculateExtent(Dg.getSize());console.log(e,"extent"),Ig=function(t,e){let i=[],r=[],n=cv.matFromImageData(t);console.log(n);let s=cv.Mat.zeros(n.rows,n.cols,cv.CV_8UC3);console.log(s),cv.cvtColor(n,n,cv.COLOR_RGBA2GRAY,0),cv.threshold(n,n,0,255,cv.THRESH_BINARY);let o=new cv.MatVector,a=new cv.Mat;cv.findContours(n,o,a,cv.RETR_CCOMP,cv.CHAIN_APPROX_SIMPLE);for(let t=0;t<o.size();++t){let e=new cv.Scalar(Math.round(255*Math.random()),Math.round(255*Math.random()),Math.round(255*Math.random()));cv.drawContours(s,o,t,e,1,cv.LINE_8,a,10),r.push([e[0],e[1],e[2]])}return i=s,cv.imshow(e,s),n.delete(),{contour:i.data,color:r}}(t,Eg),function(t,e,i,r){let n=t.contour,s=t.color,o={};r[2],r[0],r[3],r[1];for(let t=0;t<n.length;t+=3){let e=n[t],i=n[t+1],r=n[t+2],s=[e,i,r];0===e&&0===i&&0===r||(s.toString()in o?o[s.toString()].push(t/3):o[s.toString()]=[t/3])}console.log(o,"featurePixel"),console.log(s);for(const t in o){let i=[];for(let n=0;n<o[t].length;n++){let s=o[t][n]%e,a=Math.floor(o[t][n]/e);r[0],r[1],i.push([s,a])}console.log(i,"temparr"),console.log(Mg(i),"sortedarr")}[].push({type:"Feature",geometry:{type:"Polygon",coordinates:[]},proprties:{prop:""}})}(Ig,Eg.width,Eg.height,e);let i=dg.fromCanvas(Cg);console.log(i);let r=function(t,e={}){let{radius:i=1,border:r="copy",channels:n}=e;if(t.checkProcessable("medianFilter",{bitDepth:[8,16]}),i<1)throw new Error("radius must be greater than 0");n=ku(t,n);let s=i,o=i,a=dg.createFrom(t),h=new Array((2*s+1)*(2*o+1));for(let e=0;e<n.length;e++){let i=n[e];for(let e=o;e<t.height-o;e++)for(let r=s;r<t.width-s;r++){let n=0;for(let a=-o;a<=o;a++)for(let o=-s;o<=s;o++){let s=((e+a)*t.width+r+o)*t.channels+i;h[n++]=t.data[s]}let l=(e*t.width+r)*t.channels+i;a.data[l]=fs(h)}}if(t.alpha&&!n.includes(t.channels))for(let e=t.components;e<t.data.length;e+=t.channels)a.data[e]=t.data[e];return a.setBorder({size:[s,o],algorithm:r}),a}(i,{channels:3,radius:2,border:"copy"}),n=new ImageData(Cg.width,Cg.height);for(let t=0;t<r.data.length;t+=4)n.data[t]=r.data[t],n.data[t+1]=r.data[t+1],n.data[t+2]=r.data[t+2],n.data[t+3]=r.data[t+3];Ag.putImageData(n,0,0)})),function(){const t=new Ni({center:[8687373.06,3544749.53],zoom:13});Dg=new sn({layers:[new Hn({source:new Un})],view:t,target:"map1"}),Lg=new sn({layers:[new Hn({source:new Vn({key:kg,imagerySet:"RoadOnDemand"})})],view:t,target:"map2"}),Dg.on("moveend",(t=>{zg(Dg,Eg,Sg)})),Lg.on("moveend",(t=>{zg(Lg,Cg,Ag)})),Dg.on("click",(t=>{let e=Sg.getImageData(0,0,Eg.width,Eg.height);console.log(ds(t.pixel,e.data,300));let i=function(t,e,i){let r=[],n=new ImageData(t.width,t.height),s=[yg(e[0],e[1],e[2]),vg(e[0],e[1],e[2]),xg(e[0],e[1],e[2])];console.log(s,"inYIQ");for(let e=0;e<t.data.length;e+=4){let i=t.data[e],o=t.data[e+1],a=t.data[e+2],h=[yg(i,o,a),vg(i,o,a),xg(i,o,a)],l=Math.sqrt(.5053*Math.pow(h[0]-s[0],2)+.299*Math.pow(h[1]-s[1],2)+.1957*Math.pow(h[2]-s[2],2));r.push(l),0===Math.abs(l)&&(n.data[e]=255,n.data[e+3]=255)}return console.log("original YIQ distance",r),n}(e,ds(t.pixel,e.data,300));Sg.putImageData(i,0,0),Fg=!0}))}()})()})();