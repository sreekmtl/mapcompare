/*! For license information please see index.js.LICENSE.txt */
(()=>{var __webpack_modules__={9705:(t,e,n)=>{"use strict";var i=n(1540);function r(t){var e=[1/0,1/0,-1/0,-1/0];return i.coordEach(t,(function(t){e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]<t[0]&&(e[2]=t[0]),e[3]<t[1]&&(e[3]=t[1])})),e}r.default=r,e.Z=r},4102:(t,e)=>{"use strict";function n(t,e,n){void 0===n&&(n={});var i={type:"Feature"};return(0===n.id||n.id)&&(i.id=n.id),n.bbox&&(i.bbox=n.bbox),i.properties=e||{},i.geometry=t,i}function i(t,e,i){if(void 0===i&&(i={}),!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!d(t[0])||!d(t[1]))throw new Error("coordinates must contain numbers");return n({type:"Point",coordinates:t},e,i)}function r(t,e,i){void 0===i&&(i={});for(var r=0,s=t;r<s.length;r++){var o=s[r];if(o.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var a=0;a<o[o.length-1].length;a++)if(o[o.length-1][a]!==o[0][a])throw new Error("First and last Position are not equivalent.")}return n({type:"Polygon",coordinates:t},e,i)}function s(t,e,i){if(void 0===i&&(i={}),t.length<2)throw new Error("coordinates must be an array of two or more positions");return n({type:"LineString",coordinates:t},e,i)}function o(t,e){void 0===e&&(e={});var n={type:"FeatureCollection"};return e.id&&(n.id=e.id),e.bbox&&(n.bbox=e.bbox),n.features=t,n}function a(t,e,i){return void 0===i&&(i={}),n({type:"MultiLineString",coordinates:t},e,i)}function l(t,e,i){return void 0===i&&(i={}),n({type:"MultiPoint",coordinates:t},e,i)}function h(t,e,i){return void 0===i&&(i={}),n({type:"MultiPolygon",coordinates:t},e,i)}function u(t,n){void 0===n&&(n="kilometers");var i=e.factors[n];if(!i)throw new Error(n+" units is invalid");return t*i}function c(t,n){void 0===n&&(n="kilometers");var i=e.factors[n];if(!i)throw new Error(n+" units is invalid");return t/i}function f(t){return t%(2*Math.PI)*180/Math.PI}function d(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.earthRadius=6371008.8,e.factors={centimeters:100*e.earthRadius,centimetres:100*e.earthRadius,degrees:e.earthRadius/111325,feet:3.28084*e.earthRadius,inches:39.37*e.earthRadius,kilometers:e.earthRadius/1e3,kilometres:e.earthRadius/1e3,meters:e.earthRadius,metres:e.earthRadius,miles:e.earthRadius/1609.344,millimeters:1e3*e.earthRadius,millimetres:1e3*e.earthRadius,nauticalmiles:e.earthRadius/1852,radians:1,yards:1.0936*e.earthRadius},e.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/e.earthRadius,yards:1.0936133},e.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046},e.feature=n,e.geometry=function(t,e,n){switch(void 0===n&&(n={}),t){case"Point":return i(e).geometry;case"LineString":return s(e).geometry;case"Polygon":return r(e).geometry;case"MultiPoint":return l(e).geometry;case"MultiLineString":return a(e).geometry;case"MultiPolygon":return h(e).geometry;default:throw new Error(t+" is invalid")}},e.point=i,e.points=function(t,e,n){return void 0===n&&(n={}),o(t.map((function(t){return i(t,e)})),n)},e.polygon=r,e.polygons=function(t,e,n){return void 0===n&&(n={}),o(t.map((function(t){return r(t,e)})),n)},e.lineString=s,e.lineStrings=function(t,e,n){return void 0===n&&(n={}),o(t.map((function(t){return s(t,e)})),n)},e.featureCollection=o,e.multiLineString=a,e.multiPoint=l,e.multiPolygon=h,e.geometryCollection=function(t,e,i){return void 0===i&&(i={}),n({type:"GeometryCollection",geometries:t},e,i)},e.round=function(t,e){if(void 0===e&&(e=0),e&&!(e>=0))throw new Error("precision must be a positive number");var n=Math.pow(10,e||0);return Math.round(t*n)/n},e.radiansToLength=u,e.lengthToRadians=c,e.lengthToDegrees=function(t,e){return f(c(t,e))},e.bearingToAzimuth=function(t){var e=t%360;return e<0&&(e+=360),e},e.radiansToDegrees=f,e.degreesToRadians=function(t){return t%360*Math.PI/180},e.convertLength=function(t,e,n){if(void 0===e&&(e="kilometers"),void 0===n&&(n="kilometers"),!(t>=0))throw new Error("length must be a positive number");return u(c(t,e),n)},e.convertArea=function(t,n,i){if(void 0===n&&(n="meters"),void 0===i&&(i="kilometers"),!(t>=0))throw new Error("area must be a positive number");var r=e.areaFactors[n];if(!r)throw new Error("invalid original units");var s=e.areaFactors[i];if(!s)throw new Error("invalid final units");return t/r*s},e.isNumber=d,e.isObject=function(t){return!!t&&t.constructor===Object},e.validateBBox=function(t){if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be an Array");if(4!==t.length&&6!==t.length)throw new Error("bbox must be an Array of 4 or 6 numbers");t.forEach((function(t){if(!d(t))throw new Error("bbox must only contain numbers")}))},e.validateId=function(t){if(!t)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof t))throw new Error("id must be a number or a string")}},1540:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(4102);function r(t,e,n){if(null!==t)for(var i,s,o,a,l,h,u,c,f=0,d=0,g=t.type,p="FeatureCollection"===g,m="Feature"===g,y=p?t.features.length:1,v=0;v<y;v++){l=(c=!!(u=p?t.features[v].geometry:m?t.geometry:t)&&"GeometryCollection"===u.type)?u.geometries.length:1;for(var w=0;w<l;w++){var x=0,_=0;if(null!==(a=c?u.geometries[w]:u)){h=a.coordinates;var b=a.type;switch(f=!n||"Polygon"!==b&&"MultiPolygon"!==b?0:1,b){case null:break;case"Point":if(!1===e(h,d,v,x,_))return!1;d++,x++;break;case"LineString":case"MultiPoint":for(i=0;i<h.length;i++){if(!1===e(h[i],d,v,x,_))return!1;d++,"MultiPoint"===b&&x++}"LineString"===b&&x++;break;case"Polygon":case"MultiLineString":for(i=0;i<h.length;i++){for(s=0;s<h[i].length-f;s++){if(!1===e(h[i][s],d,v,x,_))return!1;d++}"MultiLineString"===b&&x++,"Polygon"===b&&_++}"Polygon"===b&&x++;break;case"MultiPolygon":for(i=0;i<h.length;i++){for(_=0,s=0;s<h[i].length;s++){for(o=0;o<h[i][s].length-f;o++){if(!1===e(h[i][s][o],d,v,x,_))return!1;d++}_++}x++}break;case"GeometryCollection":for(i=0;i<a.geometries.length;i++)if(!1===r(a.geometries[i],e,n))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function s(t,e){var n;switch(t.type){case"FeatureCollection":for(n=0;n<t.features.length&&!1!==e(t.features[n].properties,n);n++);break;case"Feature":e(t.properties,0)}}function o(t,e){if("Feature"===t.type)e(t,0);else if("FeatureCollection"===t.type)for(var n=0;n<t.features.length&&!1!==e(t.features[n],n);n++);}function a(t,e){var n,i,r,s,o,a,l,h,u,c,f=0,d="FeatureCollection"===t.type,g="Feature"===t.type,p=d?t.features.length:1;for(n=0;n<p;n++){for(a=d?t.features[n].geometry:g?t.geometry:t,h=d?t.features[n].properties:g?t.properties:{},u=d?t.features[n].bbox:g?t.bbox:void 0,c=d?t.features[n].id:g?t.id:void 0,o=(l=!!a&&"GeometryCollection"===a.type)?a.geometries.length:1,r=0;r<o;r++)if(null!==(s=l?a.geometries[r]:a))switch(s.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===e(s,f,h,u,c))return!1;break;case"GeometryCollection":for(i=0;i<s.geometries.length;i++)if(!1===e(s.geometries[i],f,h,u,c))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===e(null,f,h,u,c))return!1;f++}}function l(t,e){a(t,(function(t,n,r,s,o){var a,l=null===t?null:t.type;switch(l){case null:case"Point":case"LineString":case"Polygon":return!1!==e(i.feature(t,r,{bbox:s,id:o}),n,0)&&void 0}switch(l){case"MultiPoint":a="Point";break;case"MultiLineString":a="LineString";break;case"MultiPolygon":a="Polygon"}for(var h=0;h<t.coordinates.length;h++){var u={type:a,coordinates:t.coordinates[h]};if(!1===e(i.feature(u,r),n,h))return!1}}))}function h(t,e){l(t,(function(t,n,s){var o=0;if(t.geometry){var a=t.geometry.type;if("Point"!==a&&"MultiPoint"!==a){var l,h=0,u=0,c=0;return!1!==r(t,(function(r,a,f,d,g){if(void 0===l||n>h||d>u||g>c)return l=r,h=n,u=d,c=g,void(o=0);var p=i.lineString([l,r],t.properties);if(!1===e(p,n,s,g,o))return!1;o++,l=r}))&&void 0}}}))}function u(t,e){if(!t)throw new Error("geojson is required");l(t,(function(t,n,r){if(null!==t.geometry){var s=t.geometry.type,o=t.geometry.coordinates;switch(s){case"LineString":if(!1===e(t,n,r,0,0))return!1;break;case"Polygon":for(var a=0;a<o.length;a++)if(!1===e(i.lineString(o[a],t.properties),n,r,a))return!1}}}))}e.coordAll=function(t){var e=[];return r(t,(function(t){e.push(t)})),e},e.coordEach=r,e.coordReduce=function(t,e,n,i){var s=n;return r(t,(function(t,i,r,o,a){s=0===i&&void 0===n?t:e(s,t,i,r,o,a)}),i),s},e.featureEach=o,e.featureReduce=function(t,e,n){var i=n;return o(t,(function(t,r){i=0===r&&void 0===n?t:e(i,t,r)})),i},e.findPoint=function(t,e){if(e=e||{},!i.isObject(e))throw new Error("options is invalid");var n,r=e.featureIndex||0,s=e.multiFeatureIndex||0,o=e.geometryIndex||0,a=e.coordIndex||0,l=e.properties;switch(t.type){case"FeatureCollection":r<0&&(r=t.features.length+r),l=l||t.features[r].properties,n=t.features[r].geometry;break;case"Feature":l=l||t.properties,n=t.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":n=t;break;default:throw new Error("geojson is invalid")}if(null===n)return null;var h=n.coordinates;switch(n.type){case"Point":return i.point(h,l,e);case"MultiPoint":return s<0&&(s=h.length+s),i.point(h[s],l,e);case"LineString":return a<0&&(a=h.length+a),i.point(h[a],l,e);case"Polygon":return o<0&&(o=h.length+o),a<0&&(a=h[o].length+a),i.point(h[o][a],l,e);case"MultiLineString":return s<0&&(s=h.length+s),a<0&&(a=h[s].length+a),i.point(h[s][a],l,e);case"MultiPolygon":return s<0&&(s=h.length+s),o<0&&(o=h[s].length+o),a<0&&(a=h[s][o].length-a),i.point(h[s][o][a],l,e)}throw new Error("geojson is invalid")},e.findSegment=function(t,e){if(e=e||{},!i.isObject(e))throw new Error("options is invalid");var n,r=e.featureIndex||0,s=e.multiFeatureIndex||0,o=e.geometryIndex||0,a=e.segmentIndex||0,l=e.properties;switch(t.type){case"FeatureCollection":r<0&&(r=t.features.length+r),l=l||t.features[r].properties,n=t.features[r].geometry;break;case"Feature":l=l||t.properties,n=t.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":n=t;break;default:throw new Error("geojson is invalid")}if(null===n)return null;var h=n.coordinates;switch(n.type){case"Point":case"MultiPoint":return null;case"LineString":return a<0&&(a=h.length+a-1),i.lineString([h[a],h[a+1]],l,e);case"Polygon":return o<0&&(o=h.length+o),a<0&&(a=h[o].length+a-1),i.lineString([h[o][a],h[o][a+1]],l,e);case"MultiLineString":return s<0&&(s=h.length+s),a<0&&(a=h[s].length+a-1),i.lineString([h[s][a],h[s][a+1]],l,e);case"MultiPolygon":return s<0&&(s=h.length+s),o<0&&(o=h[s].length+o),a<0&&(a=h[s][o].length-a-1),i.lineString([h[s][o][a],h[s][o][a+1]],l,e)}throw new Error("geojson is invalid")},e.flattenEach=l,e.flattenReduce=function(t,e,n){var i=n;return l(t,(function(t,r,s){i=0===r&&0===s&&void 0===n?t:e(i,t,r,s)})),i},e.geomEach=a,e.geomReduce=function(t,e,n){var i=n;return a(t,(function(t,r,s,o,a){i=0===r&&void 0===n?t:e(i,t,r,s,o,a)})),i},e.lineEach=u,e.lineReduce=function(t,e,n){var i=n;return u(t,(function(t,r,s,o){i=0===r&&void 0===n?t:e(i,t,r,s,o)})),i},e.propEach=s,e.propReduce=function(t,e,n){var i=n;return s(t,(function(t,r){i=0===r&&void 0===n?t:e(i,t,r)})),i},e.segmentEach=h,e.segmentReduce=function(t,e,n){var i=n,r=!1;return h(t,(function(t,s,o,a,l){i=!1===r&&void 0===n?t:e(i,t,s,o,a,l),r=!0})),i}},9538:function(t){t.exports=function(){"use strict";function t(n,i,r,s,o){for(;s>r;){if(s-r>600){var a=s-r+1,l=i-r+1,h=Math.log(a),u=.5*Math.exp(2*h/3),c=.5*Math.sqrt(h*u*(a-u)/a)*(l-a/2<0?-1:1);t(n,i,Math.max(r,Math.floor(i-l*u/a+c)),Math.min(s,Math.floor(i+(a-l)*u/a+c)),o)}var f=n[i],d=r,g=s;for(e(n,r,i),o(n[s],f)>0&&e(n,r,s);d<g;){for(e(n,d,g),d++,g--;o(n[d],f)<0;)d++;for(;o(n[g],f)>0;)g--}0===o(n[r],f)?e(n,r,g):e(n,++g,s),g<=i&&(r=g+1),i<=g&&(s=g-1)}}function e(t,e,n){var i=t[e];t[e]=t[n],t[n]=i}function n(t,e){return t<e?-1:t>e?1:0}return function(e,i,r,s,o){t(e,i,r||0,s||e.length-1,o||n)}}()},4860:(t,e,n)=>{"use strict";t.exports=r,t.exports.default=r;var i=n(9538);function r(t,e){if(!(this instanceof r))return new r(t,e);this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),e&&this._initFormat(e),this.clear()}function s(t,e,n){if(!n)return e.indexOf(t);for(var i=0;i<e.length;i++)if(n(t,e[i]))return i;return-1}function o(t,e){a(t,0,t.children.length,e,t)}function a(t,e,n,i,r){r||(r=p(null)),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(var s,o=e;o<n;o++)s=t.children[o],l(r,t.leaf?i(s):s);return r}function l(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function h(t,e){return t.minX-e.minX}function u(t,e){return t.minY-e.minY}function c(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function f(t){return t.maxX-t.minX+(t.maxY-t.minY)}function d(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function g(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function p(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function m(t,e,n,r,s){for(var o,a=[e,n];a.length;)(n=a.pop())-(e=a.pop())<=r||(o=e+Math.ceil((n-e)/r/2)*r,i(t,o,e,n,s),a.push(e,o,o,n))}r.prototype={all:function(){return this._all(this.data,[])},search:function(t){var e=this.data,n=[],i=this.toBBox;if(!g(t,e))return n;for(var r,s,o,a,l=[];e;){for(r=0,s=e.children.length;r<s;r++)o=e.children[r],g(t,a=e.leaf?i(o):o)&&(e.leaf?n.push(o):d(t,a)?this._all(o,n):l.push(o));e=l.pop()}return n},collides:function(t){var e=this.data,n=this.toBBox;if(!g(t,e))return!1;for(var i,r,s,o,a=[];e;){for(i=0,r=e.children.length;i<r;i++)if(s=e.children[i],g(t,o=e.leaf?n(s):s)){if(e.leaf||d(t,o))return!0;a.push(s)}e=a.pop()}return!1},load:function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0,n=t.length;e<n;e++)this.insert(t[e]);return this}var i=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===i.height)this._splitRoot(this.data,i);else{if(this.data.height<i.height){var r=this.data;this.data=i,i=r}this._insert(i,this.data.height-i.height-1,!0)}else this.data=i;return this},insert:function(t){return t&&this._insert(t,this.data.height-1),this},clear:function(){return this.data=p([]),this},remove:function(t,e){if(!t)return this;for(var n,i,r,o,a=this.data,l=this.toBBox(t),h=[],u=[];a||h.length;){if(a||(a=h.pop(),i=h[h.length-1],n=u.pop(),o=!0),a.leaf&&-1!==(r=s(t,a.children,e)))return a.children.splice(r,1),h.push(a),this._condense(h),this;o||a.leaf||!d(a,l)?i?(n++,a=i.children[n],o=!1):a=null:(h.push(a),u.push(n),n=0,i=a,a=a.children[0])}return this},toBBox:function(t){return t},compareMinX:h,compareMinY:u,toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},_all:function(t,e){for(var n=[];t;)t.leaf?e.push.apply(e,t.children):n.push.apply(n,t.children),t=n.pop();return e},_build:function(t,e,n,i){var r,s=n-e+1,a=this._maxEntries;if(s<=a)return o(r=p(t.slice(e,n+1)),this.toBBox),r;i||(i=Math.ceil(Math.log(s)/Math.log(a)),a=Math.ceil(s/Math.pow(a,i-1))),(r=p([])).leaf=!1,r.height=i;var l,h,u,c,f=Math.ceil(s/a),d=f*Math.ceil(Math.sqrt(a));for(m(t,e,n,d,this.compareMinX),l=e;l<=n;l+=d)for(m(t,l,u=Math.min(l+d-1,n),f,this.compareMinY),h=l;h<=u;h+=f)c=Math.min(h+f-1,u),r.children.push(this._build(t,h,c,i-1));return o(r,this.toBBox),r},_chooseSubtree:function(t,e,n,i){for(var r,s,o,a,l,h,u,f,d,g;i.push(e),!e.leaf&&i.length-1!==n;){for(u=f=1/0,r=0,s=e.children.length;r<s;r++)l=c(o=e.children[r]),d=t,g=o,(h=(Math.max(g.maxX,d.maxX)-Math.min(g.minX,d.minX))*(Math.max(g.maxY,d.maxY)-Math.min(g.minY,d.minY))-l)<f?(f=h,u=l<u?l:u,a=o):h===f&&l<u&&(u=l,a=o);e=a||e.children[0]}return e},_insert:function(t,e,n){var i=this.toBBox,r=n?t:i(t),s=[],o=this._chooseSubtree(r,this.data,e,s);for(o.children.push(t),l(o,r);e>=0&&s[e].children.length>this._maxEntries;)this._split(s,e),e--;this._adjustParentBBoxes(r,s,e)},_split:function(t,e){var n=t[e],i=n.children.length,r=this._minEntries;this._chooseSplitAxis(n,r,i);var s=this._chooseSplitIndex(n,r,i),a=p(n.children.splice(s,n.children.length-s));a.height=n.height,a.leaf=n.leaf,o(n,this.toBBox),o(a,this.toBBox),e?t[e-1].children.push(a):this._splitRoot(n,a)},_splitRoot:function(t,e){this.data=p([t,e]),this.data.height=t.height+1,this.data.leaf=!1,o(this.data,this.toBBox)},_chooseSplitIndex:function(t,e,n){var i,r,s,o,l,h,u,f,d,g,p,m,y,v;for(h=u=1/0,i=e;i<=n-e;i++)d=r=a(t,0,i,this.toBBox),g=s=a(t,i,n,this.toBBox),void 0,void 0,void 0,void 0,p=Math.max(d.minX,g.minX),m=Math.max(d.minY,g.minY),y=Math.min(d.maxX,g.maxX),v=Math.min(d.maxY,g.maxY),o=Math.max(0,y-p)*Math.max(0,v-m),l=c(r)+c(s),o<h?(h=o,f=i,u=l<u?l:u):o===h&&l<u&&(u=l,f=i);return f},_chooseSplitAxis:function(t,e,n){var i=t.leaf?this.compareMinX:h,r=t.leaf?this.compareMinY:u;this._allDistMargin(t,e,n,i)<this._allDistMargin(t,e,n,r)&&t.children.sort(i)},_allDistMargin:function(t,e,n,i){t.children.sort(i);var r,s,o=this.toBBox,h=a(t,0,e,o),u=a(t,n-e,n,o),c=f(h)+f(u);for(r=e;r<n-e;r++)s=t.children[r],l(h,t.leaf?o(s):s),c+=f(h);for(r=n-e-1;r>=e;r--)s=t.children[r],l(u,t.leaf?o(s):s),c+=f(u);return c},_adjustParentBBoxes:function(t,e,n){for(var i=n;i>=0;i--)l(e[i],t)},_condense:function(t){for(var e,n=t.length-1;n>=0;n--)0===t[n].children.length?n>0?(e=t[n-1].children).splice(e.indexOf(t[n]),1):this.clear():o(t[n],this.toBBox)},_initFormat:function(t){var e=["return a"," - b",";"];this.compareMinX=new Function("a","b",e.join(t[0])),this.compareMinY=new Function("a","b",e.join(t[1])),this.toBBox=new Function("a","return {minX: a"+t[0]+", minY: a"+t[1]+", maxX: a"+t[2]+", maxY: a"+t[3]+"};")}}},5228:(t,e,n)=>{"use strict";t.exports=function(t){var e=t.length;if(0===e)return[];if(1===e)return[0];for(var n=t[0].length,i=[t[0]],s=[0],o=1;o<e;++o)if(i.push(t[o]),r(i,n)){if(s.push(o),s.length===n+1)return s}else i.pop();return s};var i=n(146);function r(t,e){for(var n=new Array(e+1),r=0;r<t.length;++r)n[r]=t[r];for(r=0;r<=t.length;++r){for(var s=t.length;s<=e;++s){for(var o=new Array(e),a=0;a<e;++a)o[a]=Math.pow(s+1-r,a);n[s]=o}if(i.apply(void 0,n))return!0}return!1}},746:(t,e)=>{"use strict";function n(t){var e=32;return(t&=-t)&&e--,65535&t&&(e-=16),16711935&t&&(e-=8),252645135&t&&(e-=4),858993459&t&&(e-=2),1431655765&t&&(e-=1),e}e.INT_BITS=32,e.INT_MAX=2147483647,e.INT_MIN=-1<<31,e.sign=function(t){return(t>0)-(t<0)},e.abs=function(t){var e=t>>31;return(t^e)-e},e.min=function(t,e){return e^(t^e)&-(t<e)},e.max=function(t,e){return t^(t^e)&-(t<e)},e.isPow2=function(t){return!(t&t-1||!t)},e.log2=function(t){var e,n;return e=(t>65535)<<4,e|=n=((t>>>=e)>255)<<3,e|=n=((t>>>=n)>15)<<2,(e|=n=((t>>>=n)>3)<<1)|(t>>>=n)>>1},e.log10=function(t){return t>=1e9?9:t>=1e8?8:t>=1e7?7:t>=1e6?6:t>=1e5?5:t>=1e4?4:t>=1e3?3:t>=100?2:t>=10?1:0},e.popCount=function(t){return 16843009*((t=(858993459&(t-=t>>>1&1431655765))+(t>>>2&858993459))+(t>>>4)&252645135)>>>24},e.countTrailingZeros=n,e.nextPow2=function(t){return t+=0===t,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,1+(t|=t>>>16)},e.prevPow2=function(t){return t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,(t|=t>>>16)-(t>>>1)},e.parity=function(t){return t^=t>>>16,t^=t>>>8,t^=t>>>4,27030>>>(t&=15)&1};var i=new Array(256);!function(t){for(var e=0;e<256;++e){var n=e,i=e,r=7;for(n>>>=1;n;n>>>=1)i<<=1,i|=1&n,--r;t[e]=i<<r&255}}(i),e.reverse=function(t){return i[255&t]<<24|i[t>>>8&255]<<16|i[t>>>16&255]<<8|i[t>>>24&255]},e.interleave2=function(t,e){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t&=65535)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e&=65535)|e<<8))|e<<4))|e<<2))|e<<1))<<1},e.deinterleave2=function(t,e){return(t=65535&((t=16711935&((t=252645135&((t=858993459&((t=t>>>e&1431655765)|t>>>1))|t>>>2))|t>>>4))|t>>>16))<<16>>16},e.interleave3=function(t,e,n){return t=1227133513&((t=3272356035&((t=251719695&((t=4278190335&((t&=1023)|t<<16))|t<<8))|t<<4))|t<<2),(t|=(e=1227133513&((e=3272356035&((e=251719695&((e=4278190335&((e&=1023)|e<<16))|e<<8))|e<<4))|e<<2))<<1)|(n=1227133513&((n=3272356035&((n=251719695&((n=4278190335&((n&=1023)|n<<16))|n<<8))|n<<4))|n<<2))<<2},e.deinterleave3=function(t,e){return(t=1023&((t=4278190335&((t=251719695&((t=3272356035&((t=t>>>e&1227133513)|t>>>2))|t>>>4))|t>>>8))|t>>>16))<<22>>22},e.nextCombination=function(t){var e=t|t-1;return e+1|(~e&-~e)-1>>>n(t)+1}},1924:(t,e,n)=>{"use strict";var i=n(210),r=n(5559),s=r(i("String.prototype.indexOf"));t.exports=function(t,e){var n=i(t,!!e);return"function"==typeof n&&s(t,".prototype.")>-1?r(n):n}},5559:(t,e,n)=>{"use strict";var i=n(8612),r=n(210),s=n(7771),o=n(4453),a=r("%Function.prototype.apply%"),l=r("%Function.prototype.call%"),h=r("%Reflect.apply%",!0)||i.call(l,a),u=n(4429),c=r("%Math.max%");t.exports=function(t){if("function"!=typeof t)throw new o("a function is required");var e=h(i,l,arguments);return s(e,1+c(0,t.length-(arguments.length-1)),!0)};var f=function(){return h(i,a,arguments)};u?u(t.exports,"apply",{value:f}):t.exports.apply=f},8874:t=>{"use strict";t.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},9894:(t,e,n)=>{"use strict";var i=n(2721),r=n(8718),s=n(5153);t.exports=function(t){var e=t.length;if(0===e)return[];if(1===e)return[[0]];var n=t[0].length;return 0===n?[]:1===n?i(t):2===n?r(t):s(t,n)}},2721:t=>{"use strict";t.exports=function(t){for(var e=0,n=0,i=1;i<t.length;++i)t[i][0]<t[e][0]&&(e=i),t[i][0]>t[n][0]&&(n=i);return e<n?[[e],[n]]:e>n?[[n],[e]]:[[e]]}},8718:(t,e,n)=>{"use strict";t.exports=function(t){var e=i(t),n=e.length;if(n<=2)return[];for(var r=new Array(n),s=e[n-1],o=0;o<n;++o){var a=e[o];r[o]=[s,a],s=a}return r};var i=n(4529)},5153:(t,e,n)=>{"use strict";t.exports=function(t,e){try{return i(t,!0)}catch(o){var n=r(t);if(n.length<=e)return[];var s=function(t,e){for(var n=t.length,i=new Array(n),r=0;r<e.length;++r)i[r]=t[e[r]];var s=e.length;for(r=0;r<n;++r)e.indexOf(r)<0&&(i[s++]=t[r]);return i}(t,n);return function(t,e){for(var n=t.length,i=e.length,r=0;r<n;++r)for(var s=t[r],o=0;o<s.length;++o){var a=s[o];if(a<i)s[o]=e[a];else{a-=i;for(var l=0;l<i;++l)a>=e[l]&&(a+=1);s[o]=a}}return t}(i(s,!0),n)}};var i=n(1293),r=n(5228)},1788:(t,e,n)=>{"use strict";n.d(e,{Z:()=>a});var i=n(8081),r=n.n(i),s=n(3645),o=n.n(s)()(r());o.push([t.id,':root,\n:host {\n  --ol-background-color: white;\n  --ol-accent-background-color: #F5F5F5;\n  --ol-subtle-background-color: rgba(128, 128, 128, 0.25);\n  --ol-partial-background-color: rgba(255, 255, 255, 0.75);\n  --ol-foreground-color: #333333;\n  --ol-subtle-foreground-color: #666666;\n  --ol-brand-color: #00AAFF;\n}\n\n.ol-box {\n  box-sizing: border-box;\n  border-radius: 2px;\n  border: 1.5px solid var(--ol-background-color);\n  background-color: var(--ol-partial-background-color);\n}\n\n.ol-mouse-position {\n  top: 8px;\n  right: 8px;\n  position: absolute;\n}\n\n.ol-scale-line {\n  background: var(--ol-partial-background-color);\n  border-radius: 4px;\n  bottom: 8px;\n  left: 8px;\n  padding: 2px;\n  position: absolute;\n}\n\n.ol-scale-line-inner {\n  border: 1px solid var(--ol-subtle-foreground-color);\n  border-top: none;\n  color: var(--ol-foreground-color);\n  font-size: 10px;\n  text-align: center;\n  margin: 1px;\n  will-change: contents, width;\n  transition: all 0.25s;\n}\n\n.ol-scale-bar {\n  position: absolute;\n  bottom: 8px;\n  left: 8px;\n}\n\n.ol-scale-bar-inner {\n  display: flex;\n}\n\n.ol-scale-step-marker {\n  width: 1px;\n  height: 15px;\n  background-color: var(--ol-foreground-color);\n  float: right;\n  z-index: 10;\n}\n\n.ol-scale-step-text {\n  position: absolute;\n  bottom: -5px;\n  font-size: 10px;\n  z-index: 11;\n  color: var(--ol-foreground-color);\n  text-shadow: -1.5px 0 var(--ol-partial-background-color), 0 1.5px var(--ol-partial-background-color), 1.5px 0 var(--ol-partial-background-color), 0 -1.5px var(--ol-partial-background-color);\n}\n\n.ol-scale-text {\n  position: absolute;\n  font-size: 12px;\n  text-align: center;\n  bottom: 25px;\n  color: var(--ol-foreground-color);\n  text-shadow: -1.5px 0 var(--ol-partial-background-color), 0 1.5px var(--ol-partial-background-color), 1.5px 0 var(--ol-partial-background-color), 0 -1.5px var(--ol-partial-background-color);\n}\n\n.ol-scale-singlebar {\n  position: relative;\n  height: 10px;\n  z-index: 9;\n  box-sizing: border-box;\n  border: 1px solid var(--ol-foreground-color);\n}\n\n.ol-scale-singlebar-even {\n  background-color: var(--ol-subtle-foreground-color);\n}\n\n.ol-scale-singlebar-odd {\n  background-color: var(--ol-background-color);\n}\n\n.ol-unsupported {\n  display: none;\n}\n\n.ol-viewport,\n.ol-unselectable {\n  -webkit-touch-callout: none;\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  user-select: none;\n  -webkit-tap-highlight-color: transparent;\n}\n\n.ol-viewport canvas {\n  all: unset;\n  overflow: hidden;\n}\n\n.ol-viewport {\n  touch-action: pan-x pan-y;\n}\n\n.ol-selectable {\n  -webkit-touch-callout: default;\n  -webkit-user-select: text;\n  -moz-user-select: text;\n  user-select: text;\n}\n\n.ol-grabbing {\n  cursor: -webkit-grabbing;\n  cursor: -moz-grabbing;\n  cursor: grabbing;\n}\n\n.ol-grab {\n  cursor: move;\n  cursor: -webkit-grab;\n  cursor: -moz-grab;\n  cursor: grab;\n}\n\n.ol-control {\n  position: absolute;\n  background-color: var(--ol-subtle-background-color);\n  border-radius: 4px;\n}\n\n.ol-zoom {\n  top: .5em;\n  left: .5em;\n}\n\n.ol-rotate {\n  top: .5em;\n  right: .5em;\n  transition: opacity .25s linear, visibility 0s linear;\n}\n\n.ol-rotate.ol-hidden {\n  opacity: 0;\n  visibility: hidden;\n  transition: opacity .25s linear, visibility 0s linear .25s;\n}\n\n.ol-zoom-extent {\n  top: 4.643em;\n  left: .5em;\n}\n\n.ol-full-screen {\n  right: .5em;\n  top: .5em;\n}\n\n.ol-control button {\n  display: block;\n  margin: 1px;\n  padding: 0;\n  color: var(--ol-subtle-foreground-color);\n  font-weight: bold;\n  text-decoration: none;\n  font-size: inherit;\n  text-align: center;\n  height: 1.375em;\n  width: 1.375em;\n  line-height: .4em;\n  background-color: var(--ol-background-color);\n  border: none;\n  border-radius: 2px;\n}\n\n.ol-control button::-moz-focus-inner {\n  border: none;\n  padding: 0;\n}\n\n.ol-zoom-extent button {\n  line-height: 1.4em;\n}\n\n.ol-compass {\n  display: block;\n  font-weight: normal;\n  will-change: transform;\n}\n\n.ol-touch .ol-control button {\n  font-size: 1.5em;\n}\n\n.ol-touch .ol-zoom-extent {\n  top: 5.5em;\n}\n\n.ol-control button:hover,\n.ol-control button:focus {\n  text-decoration: none;\n  outline: 1px solid var(--ol-subtle-foreground-color);\n  color: var(--ol-foreground-color);\n}\n\n.ol-zoom .ol-zoom-in {\n  border-radius: 2px 2px 0 0;\n}\n\n.ol-zoom .ol-zoom-out {\n  border-radius: 0 0 2px 2px;\n}\n\n.ol-attribution {\n  text-align: right;\n  bottom: .5em;\n  right: .5em;\n  max-width: calc(100% - 1.3em);\n  display: flex;\n  flex-flow: row-reverse;\n  align-items: center;\n}\n\n.ol-attribution a {\n  color: var(--ol-subtle-foreground-color);\n  text-decoration: none;\n}\n\n.ol-attribution ul {\n  margin: 0;\n  padding: 1px .5em;\n  color: var(--ol-foreground-color);\n  text-shadow: 0 0 2px var(--ol-background-color);\n  font-size: 12px;\n}\n\n.ol-attribution li {\n  display: inline;\n  list-style: none;\n}\n\n.ol-attribution li:not(:last-child):after {\n  content: " ";\n}\n\n.ol-attribution img {\n  max-height: 2em;\n  max-width: inherit;\n  vertical-align: middle;\n}\n\n.ol-attribution button {\n  flex-shrink: 0;\n}\n\n.ol-attribution.ol-collapsed ul {\n  display: none;\n}\n\n.ol-attribution:not(.ol-collapsed) {\n  background: var(--ol-partial-background-color);\n}\n\n.ol-attribution.ol-uncollapsible {\n  bottom: 0;\n  right: 0;\n  border-radius: 4px 0 0;\n}\n\n.ol-attribution.ol-uncollapsible img {\n  margin-top: -.2em;\n  max-height: 1.6em;\n}\n\n.ol-attribution.ol-uncollapsible button {\n  display: none;\n}\n\n.ol-zoomslider {\n  top: 4.5em;\n  left: .5em;\n  height: 200px;\n}\n\n.ol-zoomslider button {\n  position: relative;\n  height: 10px;\n}\n\n.ol-touch .ol-zoomslider {\n  top: 5.5em;\n}\n\n.ol-overviewmap {\n  left: 0.5em;\n  bottom: 0.5em;\n}\n\n.ol-overviewmap.ol-uncollapsible {\n  bottom: 0;\n  left: 0;\n  border-radius: 0 4px 0 0;\n}\n\n.ol-overviewmap .ol-overviewmap-map,\n.ol-overviewmap button {\n  display: block;\n}\n\n.ol-overviewmap .ol-overviewmap-map {\n  border: 1px solid var(--ol-subtle-foreground-color);\n  height: 150px;\n  width: 150px;\n}\n\n.ol-overviewmap:not(.ol-collapsed) button {\n  bottom: 0;\n  left: 0;\n  position: absolute;\n}\n\n.ol-overviewmap.ol-collapsed .ol-overviewmap-map,\n.ol-overviewmap.ol-uncollapsible button {\n  display: none;\n}\n\n.ol-overviewmap:not(.ol-collapsed) {\n  background: var(--ol-subtle-background-color);\n}\n\n.ol-overviewmap-box {\n  border: 1.5px dotted var(--ol-subtle-foreground-color);\n}\n\n.ol-overviewmap .ol-overviewmap-box:hover {\n  cursor: move;\n}\n',""]);const a=o},1828:(t,e,n)=>{"use strict";n.d(e,{Z:()=>a});var i=n(8081),r=n.n(i),s=n(3645),o=n.n(s)()(r());o.push([t.id,'* {\n    box-sizing: border-box;\n  }\n.column {\n    float: left;\n    width: 30%;\n    height: 680px; /* Should be removed. Only for demonstration */\n}\n  \n  /* Clear floats after the columns */\n  .row:after {\n    content: "";\n    display: table;\n    clear: both;\n}\n\n\n\np{\n    color: #000000;\n    font-family: monospace;\n    font-size: medium;\n    padding-left: 10px;\n  \n}\n\nh3{\n\n    color: #000000;\n    font-family: monospace;\n    font-size: large;\n    font-weight: bold;\n    padding-left: 10px;\n\n}\n\n\ninput[type="text"] {\n  width:500px;\n  color: #000000;\n  font-family: monospace;\n  font-size: large;\n  padding-left: 20px;\n}\n\nbutton{\n  font-family:monospace;\n  font-size: 12px;\n}\n\nlabel{\n  font-family:monospace;\n}\n\nselect{\n  font-family:monospace;\n}\n\n.article{\n  color: white;\n}',""]);const a=o},3645:t=>{"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n="",i=void 0!==e[5];return e[4]&&(n+="@supports (".concat(e[4],") {")),e[2]&&(n+="@media ".concat(e[2]," {")),i&&(n+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),n+=t(e),i&&(n+="}"),e[2]&&(n+="}"),e[4]&&(n+="}"),n})).join("")},e.i=function(t,n,i,r,s){"string"==typeof t&&(t=[[null,t,void 0]]);var o={};if(i)for(var a=0;a<this.length;a++){var l=this[a][0];null!=l&&(o[l]=!0)}for(var h=0;h<t.length;h++){var u=[].concat(t[h]);i&&o[u[0]]||(void 0!==s&&(void 0===u[5]||(u[1]="@layer".concat(u[5].length>0?" ".concat(u[5]):""," {").concat(u[1],"}")),u[5]=s),n&&(u[2]?(u[1]="@media ".concat(u[2]," {").concat(u[1],"}"),u[2]=n):u[2]=n),r&&(u[4]?(u[1]="@supports (".concat(u[4],") {").concat(u[1],"}"),u[4]=r):u[4]="".concat(r)),e.push(u))}},e}},8081:t=>{"use strict";t.exports=function(t){return t[1]}},251:(t,e,n)=>{var i=n(2215),r=n(2584),s=n(609),o=n(8420),a=n(2847),l=n(8923),h=Date.prototype.getTime;function u(t){return null==t}function c(t){return!(!t||"object"!=typeof t||"number"!=typeof t.length||"function"!=typeof t.copy||"function"!=typeof t.slice||t.length>0&&"number"!=typeof t[0])}t.exports=function t(e,n,f){var d=f||{};return!!(d.strict?s(e,n):e===n)||(!e||!n||"object"!=typeof e&&"object"!=typeof n?d.strict?s(e,n):e==n:function(e,n,s){var f,d;if(typeof e!=typeof n)return!1;if(u(e)||u(n))return!1;if(e.prototype!==n.prototype)return!1;if(r(e)!==r(n))return!1;var g=o(e),p=o(n);if(g!==p)return!1;if(g||p)return e.source===n.source&&a(e)===a(n);if(l(e)&&l(n))return h.call(e)===h.call(n);var m=c(e),y=c(n);if(m!==y)return!1;if(m||y){if(e.length!==n.length)return!1;for(f=0;f<e.length;f++)if(e[f]!==n[f])return!1;return!0}if(typeof e!=typeof n)return!1;try{var v=i(e),w=i(n)}catch(t){return!1}if(v.length!==w.length)return!1;for(v.sort(),w.sort(),f=v.length-1;f>=0;f--)if(v[f]!=w[f])return!1;for(f=v.length-1;f>=0;f--)if(!t(e[d=v[f]],n[d],s))return!1;return!0}(e,n,d))}},2296:(t,e,n)=>{"use strict";var i=n(4429),r=n(9748),s=n(4453),o=n(7296);t.exports=function(t,e,n){if(!t||"object"!=typeof t&&"function"!=typeof t)throw new s("`obj` must be an object or a function`");if("string"!=typeof e&&"symbol"!=typeof e)throw new s("`property` must be a string or a symbol`");if(arguments.length>3&&"boolean"!=typeof arguments[3]&&null!==arguments[3])throw new s("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&"boolean"!=typeof arguments[4]&&null!==arguments[4])throw new s("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&"boolean"!=typeof arguments[5]&&null!==arguments[5])throw new s("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&"boolean"!=typeof arguments[6])throw new s("`loose`, if provided, must be a boolean");var a=arguments.length>3?arguments[3]:null,l=arguments.length>4?arguments[4]:null,h=arguments.length>5?arguments[5]:null,u=arguments.length>6&&arguments[6],c=!!o&&o(t,e);if(i)i(t,e,{configurable:null===h&&c?c.configurable:!h,enumerable:null===a&&c?c.enumerable:!a,value:n,writable:null===l&&c?c.writable:!l});else{if(!u&&(a||l||h))throw new r("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.");t[e]=n}}},4289:(t,e,n)=>{"use strict";var i=n(2215),r="function"==typeof Symbol&&"symbol"==typeof Symbol("foo"),s=Object.prototype.toString,o=Array.prototype.concat,a=n(2296),l=n(1044)(),h=function(t,e,n,i){if(e in t)if(!0===i){if(t[e]===n)return}else if("function"!=typeof(r=i)||"[object Function]"!==s.call(r)||!i())return;var r;l?a(t,e,n,!0):a(t,e,n)},u=function(t,e){var n=arguments.length>2?arguments[2]:{},s=i(e);r&&(s=o.call(s,Object.getOwnPropertySymbols(e)));for(var a=0;a<s.length;a+=1)h(t,s[a],e[s[a]],n[s[a]])};u.supportsDescriptors=!!l,t.exports=u},9187:t=>{"use strict";function e(t,e,i){i=i||2;var s,o,a,l,c,f,g,p=e&&e.length,m=p?e[0]*i:t.length,y=n(t,0,m,i,!0),v=[];if(!y||y.next===y.prev)return v;if(p&&(y=function(t,e,i,r){var s,o,a,l=[];for(s=0,o=e.length;s<o;s++)(a=n(t,e[s]*r,s<o-1?e[s+1]*r:t.length,r,!1))===a.next&&(a.steiner=!0),l.push(d(a));for(l.sort(h),s=0;s<l.length;s++)i=u(l[s],i);return i}(t,e,y,i)),t.length>80*i){s=a=t[0],o=l=t[1];for(var w=i;w<m;w+=i)(c=t[w])<s&&(s=c),(f=t[w+1])<o&&(o=f),c>a&&(a=c),f>l&&(l=f);g=0!==(g=Math.max(a-s,l-o))?32767/g:0}return r(y,v,i,s,o,g,0),v}function n(t,e,n,i,r){var s,o;if(r===C(t,e,n,i)>0)for(s=e;s<n;s+=i)o=E(s,t[s],t[s+1],o);else for(s=n-i;s>=e;s-=i)o=E(s,t[s],t[s+1],o);return o&&y(o,o.next)&&(S(o),o=o.next),o}function i(t,e){if(!t)return t;e||(e=t);var n,i=t;do{if(n=!1,i.steiner||!y(i,i.next)&&0!==m(i.prev,i,i.next))i=i.next;else{if(S(i),(i=e=i.prev)===i.next)break;n=!0}}while(n||i!==e);return e}function r(t,e,n,h,u,c,d){if(t){!d&&c&&function(t,e,n,i){var r=t;do{0===r.z&&(r.z=f(r.x,r.y,e,n,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,function(t){var e,n,i,r,s,o,a,l,h=1;do{for(n=t,t=null,s=null,o=0;n;){for(o++,i=n,a=0,e=0;e<h&&(a++,i=i.nextZ);e++);for(l=h;a>0||l>0&&i;)0!==a&&(0===l||!i||n.z<=i.z)?(r=n,n=n.nextZ,a--):(r=i,i=i.nextZ,l--),s?s.nextZ=r:t=r,r.prevZ=s,s=r;n=i}s.nextZ=null,h*=2}while(o>1)}(r)}(t,h,u,c);for(var g,p,m=t;t.prev!==t.next;)if(g=t.prev,p=t.next,c?o(t,h,u,c):s(t))e.push(g.i/n|0),e.push(t.i/n|0),e.push(p.i/n|0),S(t),t=p.next,m=p.next;else if((t=p)===m){d?1===d?r(t=a(i(t),e,n),e,n,h,u,c,2):2===d&&l(t,e,n,h,u,c):r(i(t),e,n,h,u,c,1);break}}}function s(t){var e=t.prev,n=t,i=t.next;if(m(e,n,i)>=0)return!1;for(var r=e.x,s=n.x,o=i.x,a=e.y,l=n.y,h=i.y,u=r<s?r<o?r:o:s<o?s:o,c=a<l?a<h?a:h:l<h?l:h,f=r>s?r>o?r:o:s>o?s:o,d=a>l?a>h?a:h:l>h?l:h,p=i.next;p!==e;){if(p.x>=u&&p.x<=f&&p.y>=c&&p.y<=d&&g(r,a,s,l,o,h,p.x,p.y)&&m(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function o(t,e,n,i){var r=t.prev,s=t,o=t.next;if(m(r,s,o)>=0)return!1;for(var a=r.x,l=s.x,h=o.x,u=r.y,c=s.y,d=o.y,p=a<l?a<h?a:h:l<h?l:h,y=u<c?u<d?u:d:c<d?c:d,v=a>l?a>h?a:h:l>h?l:h,w=u>c?u>d?u:d:c>d?c:d,x=f(p,y,e,n,i),_=f(v,w,e,n,i),b=t.prevZ,E=t.nextZ;b&&b.z>=x&&E&&E.z<=_;){if(b.x>=p&&b.x<=v&&b.y>=y&&b.y<=w&&b!==r&&b!==o&&g(a,u,l,c,h,d,b.x,b.y)&&m(b.prev,b,b.next)>=0)return!1;if(b=b.prevZ,E.x>=p&&E.x<=v&&E.y>=y&&E.y<=w&&E!==r&&E!==o&&g(a,u,l,c,h,d,E.x,E.y)&&m(E.prev,E,E.next)>=0)return!1;E=E.nextZ}for(;b&&b.z>=x;){if(b.x>=p&&b.x<=v&&b.y>=y&&b.y<=w&&b!==r&&b!==o&&g(a,u,l,c,h,d,b.x,b.y)&&m(b.prev,b,b.next)>=0)return!1;b=b.prevZ}for(;E&&E.z<=_;){if(E.x>=p&&E.x<=v&&E.y>=y&&E.y<=w&&E!==r&&E!==o&&g(a,u,l,c,h,d,E.x,E.y)&&m(E.prev,E,E.next)>=0)return!1;E=E.nextZ}return!0}function a(t,e,n){var r=t;do{var s=r.prev,o=r.next.next;!y(s,o)&&v(s,r,r.next,o)&&_(s,o)&&_(o,s)&&(e.push(s.i/n|0),e.push(r.i/n|0),e.push(o.i/n|0),S(r),S(r.next),r=t=o),r=r.next}while(r!==t);return i(r)}function l(t,e,n,s,o,a){var l=t;do{for(var h=l.next.next;h!==l.prev;){if(l.i!==h.i&&p(l,h)){var u=b(l,h);return l=i(l,l.next),u=i(u,u.next),r(l,e,n,s,o,a,0),void r(u,e,n,s,o,a,0)}h=h.next}l=l.next}while(l!==t)}function h(t,e){return t.x-e.x}function u(t,e){var n=function(t,e){var n,i=e,r=t.x,s=t.y,o=-1/0;do{if(s<=i.y&&s>=i.next.y&&i.next.y!==i.y){var a=i.x+(s-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(a<=r&&a>o&&(o=a,n=i.x<i.next.x?i:i.next,a===r))return n}i=i.next}while(i!==e);if(!n)return null;var l,h=n,u=n.x,f=n.y,d=1/0;i=n;do{r>=i.x&&i.x>=u&&r!==i.x&&g(s<f?r:o,s,u,f,s<f?o:r,s,i.x,i.y)&&(l=Math.abs(s-i.y)/(r-i.x),_(i,t)&&(l<d||l===d&&(i.x>n.x||i.x===n.x&&c(n,i)))&&(n=i,d=l)),i=i.next}while(i!==h);return n}(t,e);if(!n)return e;var r=b(n,t);return i(r,r.next),i(n,n.next)}function c(t,e){return m(t.prev,t,e.prev)<0&&m(e.next,t,t.next)<0}function f(t,e,n,i,r){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-n)*r|0)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-i)*r|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function d(t){var e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function g(t,e,n,i,r,s,o,a){return(r-o)*(e-a)>=(t-o)*(s-a)&&(t-o)*(i-a)>=(n-o)*(e-a)&&(n-o)*(s-a)>=(r-o)*(i-a)}function p(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&v(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&(_(t,e)&&_(e,t)&&function(t,e){var n=t,i=!1,r=(t.x+e.x)/2,s=(t.y+e.y)/2;do{n.y>s!=n.next.y>s&&n.next.y!==n.y&&r<(n.next.x-n.x)*(s-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next}while(n!==t);return i}(t,e)&&(m(t.prev,t,e.prev)||m(t,e.prev,e))||y(t,e)&&m(t.prev,t,t.next)>0&&m(e.prev,e,e.next)>0)}function m(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function y(t,e){return t.x===e.x&&t.y===e.y}function v(t,e,n,i){var r=x(m(t,e,n)),s=x(m(t,e,i)),o=x(m(n,i,t)),a=x(m(n,i,e));return r!==s&&o!==a||!(0!==r||!w(t,n,e))||!(0!==s||!w(t,i,e))||!(0!==o||!w(n,t,i))||!(0!==a||!w(n,e,i))}function w(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function x(t){return t>0?1:t<0?-1:0}function _(t,e){return m(t.prev,t,t.next)<0?m(t,e,t.next)>=0&&m(t,t.prev,e)>=0:m(t,e,t.prev)<0||m(t,t.next,e)<0}function b(t,e){var n=new I(t.i,t.x,t.y),i=new I(e.i,e.x,e.y),r=t.next,s=e.prev;return t.next=e,e.prev=t,n.next=r,r.prev=n,i.next=n,n.prev=i,s.next=i,i.prev=s,i}function E(t,e,n,i){var r=new I(t,e,n);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function S(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function I(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function C(t,e,n,i){for(var r=0,s=e,o=n-i;s<n;s+=i)r+=(t[o]-t[s])*(t[s+1]+t[o+1]),o=s;return r}t.exports=e,t.exports.default=e,e.deviation=function(t,e,n,i){var r=e&&e.length,s=r?e[0]*n:t.length,o=Math.abs(C(t,0,s,n));if(r)for(var a=0,l=e.length;a<l;a++){var h=e[a]*n,u=a<l-1?e[a+1]*n:t.length;o-=Math.abs(C(t,h,u,n))}var c=0;for(a=0;a<i.length;a+=3){var f=i[a]*n,d=i[a+1]*n,g=i[a+2]*n;c+=Math.abs((t[f]-t[g])*(t[d+1]-t[f+1])-(t[f]-t[d])*(t[g+1]-t[f+1]))}return 0===o&&0===c?0:Math.abs((c-o)/o)},e.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},i=0,r=0;r<t.length;r++){for(var s=0;s<t[r].length;s++)for(var o=0;o<e;o++)n.vertices.push(t[r][s][o]);r>0&&(i+=t[r-1].length,n.holes.push(i))}return n}},4429:(t,e,n)=>{"use strict";var i=n(210)("%Object.defineProperty%",!0)||!1;if(i)try{i({},"a",{value:1})}catch(t){i=!1}t.exports=i},3981:t=>{"use strict";t.exports=EvalError},1648:t=>{"use strict";t.exports=Error},4726:t=>{"use strict";t.exports=RangeError},6712:t=>{"use strict";t.exports=ReferenceError},9748:t=>{"use strict";t.exports=SyntaxError},4453:t=>{"use strict";t.exports=TypeError},3915:t=>{"use strict";t.exports=URIError},7060:(t,e,n)=>{"use strict";const{IOBuffer:i}=n(2155),r=n(5578),s=[];for(let t=0;t<=8;t++)s.push(255<<t);t.exports=class extends i{constructor(t){if(1!==t.bitDepth)throw new Error("Only bitDepth of 1 is supported");if(!t.height||!t.width)throw new Error("ImageData width and height are required");super(t.data),this.width=t.width,this.height=t.height,this.bitDepth=t.bitDepth,this.channels=t.channels,this.components=t.components}encode(){this.encoded=new i,this.encoded.skip(14),this.writeBitmapV5Header(),this.writeColorTable();const t=this.encoded.offset;return this.writePixelArray(),this.encoded.rewind(),this.writeBitmapFileHeader(t),this.encoded.toArray()}writePixelArray(){let t=this.encoded;const e=4*Math.floor((this.bitDepth*this.width+31)/32),n=Math.ceil(this.bitDepth*this.width/8),i=e-n,r=this.bitDepth*this.width%8,o=0===r?0:8-r,a=e*this.height;let l,h,u=0,c=0,f=8;t.mark(),h=this.readUint8();for(let a=this.height-1;a>=0;a--){const d=0===a;t.reset(),t.skip(a*e);for(let e=0;e<n;e++){const a=e===n-1;c<=o&&a?(t.writeByte(h<<c),0!==o&&o!==c||d||(l=h,h=this.readByte())):0===c?(l=h,h=this.readUint8(),t.writeByte(l)):(l=h,h=this.readUint8(),t.writeByte(l<<c&s[c]|h>>f)),a&&(u+=r||0,t.skip(i),c=u%8,f=8-c)}}e>n&&(t.reset(),t.skip(a-1),t.writeUint8(0))}writeColorTable(){this.encoded.writeUint32(0).writeUint32(16777215)}writeBitmapFileHeader(t){this.encoded.writeChars("BM").writeInt32(this.encoded.lastWrittenByte).writeUint16(0).writeUint16(0).writeUint32(t)}writeBitmapV5Header(){const t=4*Math.floor((this.bitDepth*this.width+31)/32)*this.height;this.encoded.writeUint32(124).writeInt32(this.width).writeInt32(this.height).writeUint16(1).writeUint16(this.bitDepth).writeUint32(r.BITMAPV5HEADER.Compression.BI_RGB).writeUint32(t).writeInt32(0).writeInt32(0).writeUint32(Math.pow(2,this.bitDepth)).writeUint32(Math.pow(2,this.bitDepth)).writeUint32(4278190080).writeUint32(16711680).writeUint32(65280).writeUint32(255).writeUint32(r.BITMAPV5HEADER.LogicalColorSpace.LCS_sRGB).skip(36).skip(12).writeUint32(r.BITMAPV5HEADER.GamutMappingIntent.LCS_GM_IMAGES).skip(12)}}},5578:t=>{"use strict";t.exports={BITMAPV5HEADER:{LogicalColorSpace:{LCS_CALIBRATED_RGB:0,LCS_sRGB:1934772034,LCS_WINDOWS_COLOR_SPACE:1466527264},Compression:{BI_RGB:0,BI_RLE8:1,BI_RLE4:2,BI_BITFIELDS:3,BI_JPEG:4,BI_PNG:5,BI_CMYK:11,BI_CMYKRLE8:12,BI_CMYKRLE4:13},GamutMappingIntent:{LCS_GM_ABS_COLORIMETRIC:8,LCS_GM_BUSINESS:1,LCS_GM_GRAPHICS:2,LCS_GM_IMAGES:4}}}},4665:(t,e,n)=>{"use strict";const i=n(7060);e.c=function(t){return new i(t).encode()}},7909:t=>{"use strict";const e=[];t.exports=class{constructor(t,e){e=e||{},void 0===t&&(t=8192),"number"==typeof t&&(t=new ArrayBuffer(t));let n=t.byteLength;const i=e.offset?e.offset>>>0:0;t.buffer&&(n=t.byteLength-i,t=t.byteLength!==t.buffer.byteLength?t.buffer.slice(t.byteOffset+i,t.byteOffset+t.byteLength):i?t.buffer.slice(i):t.buffer),this.buffer=t,this.length=n,this.byteLength=n,this.byteOffset=0,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer),this._increment=n||8192,this._mark=0}available(t){return void 0===t&&(t=1),this.offset+t<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){this.littleEndian=!0}isBigEndian(){return!this.littleEndian}setBigEndian(){this.littleEndian=!1}skip(t){void 0===t&&(t=1),this.offset+=t}seek(t){this.offset=t}mark(){this._mark=this.offset}reset(){this.offset=this._mark}rewind(){this.offset=0}ensureAvailable(t){if(void 0===t&&(t=1),!this.available(t)){const t=this._increment+this._increment;this._increment=t;const e=this.length+t,n=new Uint8Array(e);n.set(new Uint8Array(this.buffer)),this.buffer=n.buffer,this.length=e,this._data=new DataView(this.buffer)}}readBoolean(){return 0!==this.readUint8()}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(t){void 0===t&&(t=1);for(var e=new Uint8Array(t),n=0;n<t;n++)e[n]=this.readByte();return e}readInt16(){var t=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,t}readUint16(){var t=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,t}readInt32(){var t=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,t}readUint32(){var t=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat32(){var t=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat64(){var t=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,t}readChar(){return String.fromCharCode(this.readInt8())}readChars(t){void 0===t&&(t=1),e.length=t;for(var n=0;n<t;n++)e[n]=this.readChar();return e.join("")}writeBoolean(t){this.writeUint8(t?255:0)}writeInt8(t){this.ensureAvailable(1),this._data.setInt8(this.offset++,t)}writeUint8(t){this.ensureAvailable(1),this._data.setUint8(this.offset++,t)}writeByte(t){this.writeUint8(t)}writeBytes(t){this.ensureAvailable(t.length);for(var e=0;e<t.length;e++)this._data.setUint8(this.offset++,t[e])}writeInt16(t){this.ensureAvailable(2),this._data.setInt16(this.offset,t,this.littleEndian),this.offset+=2}writeUint16(t){this.ensureAvailable(2),this._data.setUint16(this.offset,t,this.littleEndian),this.offset+=2}writeInt32(t){this.ensureAvailable(4),this._data.setInt32(this.offset,t,this.littleEndian),this.offset+=4}writeUint32(t){this.ensureAvailable(4),this._data.setUint32(this.offset,t,this.littleEndian),this.offset+=4}writeFloat32(t){this.ensureAvailable(4),this._data.setFloat32(this.offset,t,this.littleEndian),this.offset+=4}writeFloat64(t){this.ensureAvailable(8),this._data.setFloat64(this.offset,t,this.littleEndian),this.offset+=8}writeChar(t){this.writeUint8(t.charCodeAt(0))}writeChars(t){for(var e=0;e<t.length;e++)this.writeUint8(t.charCodeAt(e))}toArray(){return new Uint8Array(this.buffer,0,this.offset)}}},3311:(t,e,n)=>{"use strict";const i=n(6752);t.exports=function(t,e){return new i(t,e).decode(e)}},8029:(t,e,n)=>{"use strict";const i={standard:n(4263),exif:n(9640),gps:n(5367)};t.exports=class{constructor(t){if(!t)throw new Error("missing kind");this.data=null,this.fields=new Map,this.kind=t,this._map=null}get(t){if("number"==typeof t)return this.fields.get(t);if("string"==typeof t)return this.fields.get(i[this.kind].tagsByName[t]);throw new Error("expected a number or string")}get map(){if(!this._map){this._map={};const e=i[this.kind].tagsById;for(var t of this.fields.keys())e[t]&&(this._map[e[t]]=this.fields.get(t))}return this._map}}},6486:(t,e)=>{"use strict";var n=new Map([[1,[1,i]],[2,[1,function(t,e){for(var n=[],i="",r=0;r<e;r++){var s=String.fromCharCode(t.readUint8());"\0"===s?(n.push(i),i=""):i+=s}return 1===n.length?n[0]:n}]],[3,[2,function(t,e){if(1===e)return t.readUint16();for(var n=new Uint16Array(e),i=0;i<e;i++)n[i]=t.readUint16();return n}]],[4,[4,function(t,e){if(1===e)return t.readUint32();for(var n=new Uint32Array(e),i=0;i<e;i++)n[i]=t.readUint32();return n}]],[5,[8,function(t,e){if(1===e)return t.readUint32()/t.readUint32();for(var n=new Array(e),i=0;i<e;i++)n[i]=t.readUint32()/t.readUint32();return n}]],[6,[1,function(t,e){if(1===e)return t.readInt8();for(var n=new Int8Array(e),i=0;i<e;i++)n[i]=t.readInt8();return n}]],[7,[1,i]],[8,[2,function(t,e){if(1===e)return t.readInt16();for(var n=new Int16Array(e),i=0;i<e;i++)n[i]=t.readInt16();return n}]],[9,[4,function(t,e){if(1===e)return t.readInt32();for(var n=new Int32Array(e),i=0;i<e;i++)n[i]=t.readInt32();return n}]],[10,[8,function(t,e){if(1===e)return t.readInt32()/t.readInt32();for(var n=new Array(e),i=0;i<e;i++)n[i]=t.readInt32()/t.readInt32();return n}]],[11,[4,function(t,e){if(1===e)return t.readFloat32();for(var n=new Float32Array(e),i=0;i<e;i++)n[i]=t.readFloat32();return n}]],[12,[8,function(t,e){if(1===e)return t.readFloat64();for(var n=new Float64Array(e),i=0;i<e;i++)n[i]=t.readFloat64();return n}]]]);function i(t,e){if(1===e)return t.readUint8();for(var n=new Uint8Array(e),i=0;i<e;i++)n[i]=t.readUint8();return n}e.getByteLength=function(t,e){return n.get(t)[0]*e},e.readData=function(t,e,i){return n.get(e)[1](t,i)}},9469:(t,e,n)=>{"use strict";e.decode=n(3311)},9640:t=>{"use strict";const e={33434:"ExposureTime",33437:"FNumber",34850:"ExposureProgram",34852:"SpectralSensitivity",34855:"ISOSpeedRatings",34856:"OECF",34864:"SensitivityType",34865:"StandardOutputSensitivity",34866:"RecommendedExposureIndex",34867:"ISOSpeed",34868:"ISOSpeedLatitudeyyy",34869:"ISOSpeedLatitudezzz",36864:"ExifVersion",36867:"DateTimeOriginal",36868:"DateTimeDigitized",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureBiasValue",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37386:"FocalLength",37396:"SubjectArea",37500:"MakerNote",37510:"UserComment",37520:"SubsecTime",37521:"SubsecTimeOriginal",37522:"SubsecTimeDigitized",40960:"FlashpixVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",40964:"RelatedSoundFile",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41492:"SubjectLocation",41493:"ExposureIndex",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRatio",41989:"FocalLengthIn35mmFilm",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",42016:"ImageUniqueID",42032:"CameraOwnerName",42033:"BodySerialNumber",42034:"LensSpecification",42035:"LensMake",42036:"LensModel",42037:"LensSerialNumber",42240:"Gamma"},n={};for(var i in e)n[e[i]]=i;t.exports={tagsById:e,tagsByName:n}},5367:t=>{"use strict";const e={0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential",31:"GPSHPositioningError"},n={};for(var i in e)n[e[i]]=i;t.exports={tagsById:e,tagsByName:n}},4263:t=>{"use strict";const e={254:"NewSubfileType",255:"SubfileType",256:"ImageWidth",257:"ImageLength",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",263:"Threshholding",264:"CellWidth",265:"CellLength",266:"FillOrder",270:"ImageDescription",271:"Make",272:"Model",273:"StripOffsets",274:"Orientation",277:"SamplesPerPixel",278:"RowsPerStrip",279:"StripByteCounts",280:"MinSampleValue",281:"MaxSampleValue",282:"XResolution",283:"YResolution",284:"PlanarConfiguration",288:"FreeOffsets",289:"FreeByteCounts",290:"GrayResponseUnit",291:"GrayResponseCurve",296:"ResolutionUnit",305:"Software",306:"DateTime",315:"Artist",316:"HostComputer",320:"ColorMap",338:"ExtraSamples",33432:"Copyright",269:"DocumentName",285:"PageName",286:"XPosition",287:"YPosition",292:"T4Options",293:"T6Options",297:"PageNumber",301:"TransferFunction",317:"Predictor",318:"WhitePoint",319:"PrimaryChromaticities",321:"HalftoneHints",322:"TileWidth",323:"TileLength",324:"TileOffsets",325:"TileByteCounts",326:"BadFaxLines",327:"CleanFaxData",328:"ConsecutiveBadFaxLines",330:"SubIFDs",332:"InkSet",333:"InkNames",334:"NumberOfInks",336:"DotRange",337:"TargetPrinter",339:"SampleFormat",340:"SMinSampleValue",341:"SMaxSampleValue",342:"TransferRange",343:"ClipPath",344:"XClipPathUnits",345:"YClipPathUnits",346:"Indexed",347:"JPEGTables",351:"OPIProxy",400:"GlobalParametersIFD",401:"ProfileType",402:"FaxProfile",403:"CodingMethods",404:"VersionYear",405:"ModeNumber",433:"Decode",434:"DefaultImageColor",512:"JPEGProc",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",515:"JPEGRestartInterval",517:"JPEGLosslessPredictors",518:"JPEGPointTransforms",519:"JPEGQTables",520:"JPEGDCTables",521:"JPEGACTables",529:"YCbCrCoefficients",530:"YCbCrSubSampling",531:"YCbCrPositioning",532:"ReferenceBlackWhite",559:"StripRowCounts",700:"XMP",32781:"ImageID",34732:"ImageLayer",32932:"WangAnnotatio",33445:"MDFileTag",33446:"MDScalePixel",33447:"MDColorTable",33448:"MDLabName",33449:"MDSampleInfo",33450:"MDPrepDate",33451:"MDPrepTime",33452:"MDFileUnits",33550:"ModelPixelScaleTag",33723:"IPTC",33918:"INGRPacketDataTag",33919:"INGRFlagRegisters",33920:"IrasBTransformationMatrix",33922:"ModelTiepointTag",34264:"ModelTransformationTag",34377:"Photoshop",34665:"ExifIFD",34675:"ICCProfile",34735:"GeoKeyDirectoryTag",34736:"GeoDoubleParamsTag",34737:"GeoAsciiParamsTag",34853:"GPSIFD",34908:"HylaFAXFaxRecvParams",34909:"HylaFAXFaxSubAddress",34910:"HylaFAXFaxRecvTime",37724:"ImageSourceData",40965:"InteroperabilityIFD",42112:"GDAL_METADATA",42113:"GDAL_NODATA",50215:"OceScanjobDescription",50216:"OceApplicationSelector",50217:"OceIdentificationNumber",50218:"OceImageLogicCharacteristics",50706:"DNGVersion",50707:"DNGBackwardVersion",50708:"UniqueCameraModel",50709:"LocalizedCameraModel",50710:"CFAPlaneColor",50711:"CFALayout",50712:"LinearizationTable",50713:"BlackLevelRepeatDim",50714:"BlackLevel",50715:"BlackLevelDeltaH",50716:"BlackLevelDeltaV",50717:"WhiteLevel",50718:"DefaultScale",50719:"DefaultCropOrigin",50720:"DefaultCropSize",50721:"ColorMatrix1",50722:"ColorMatrix2",50723:"CameraCalibration1",50724:"CameraCalibration2",50725:"ReductionMatrix1",50726:"ReductionMatrix2",50727:"AnalogBalance",50728:"AsShotNeutral",50729:"AsShotWhiteXY",50730:"BaselineExposure",50731:"BaselineNoise",50732:"BaselineSharpness",50733:"BayerGreenSplit",50734:"LinearResponseLimit",50735:"CameraSerialNumber",50736:"LensInfo",50737:"ChromaBlurRadius",50738:"AntiAliasStrength",50740:"DNGPrivateData",50741:"MakerNoteSafety",50778:"CalibrationIlluminant1",50779:"CalibrationIlluminant2",50780:"BestQualityScale",50784:"AliasLayerMetadata"},n={};for(var i in e)n[e[i]]=i;t.exports={tagsById:e,tagsByName:n}},6752:(t,e,n)=>{"use strict";const i=n(7909),r=n(8029),s=n(8353),o=n(6486),a={ignoreImageData:!1,onlyFirst:!1};function l(t,e,n,i){for(var r=0;r<i;r++)t[n++]=e.getUint8(r);return n}function h(t,e,n,i,r){for(var s=0;s<2*i;s+=2)t[n++]=e.getUint16(s,r);return n}function u(t,e,n,i,r){for(var s=0;s<4*i;s+=4)t[n++]=e.getFloat32(s,r);return n}function c(t,e){throw new Error("Unsupported "+t+": "+e)}t.exports=class extends i{constructor(t,e){super(t,e),this._nextIFD=0}decode(t){t=Object.assign({},a,t);const e=[];for(this.decodeHeader();this._nextIFD;)if(e.push(this.decodeIFD(t)),t.onlyFirst)return e[0];return e}decodeHeader(){let t=this.readUint16();if(18761===t)this.setLittleEndian();else{if(19789!==t)throw new Error("invalid byte order: 0x"+t.toString(16));this.setBigEndian()}if(t=this.readUint16(),42!==t)throw new Error("not a TIFF file");this._nextIFD=this.readUint32()}decodeIFD(t){var e;this.seek(this._nextIFD),e=t.kind?new r(t.kind):new s;const n=this.readUint16();for(var i=0;i<n;i++)this.decodeIFDEntry(e);return t.ignoreImageData||this.decodeImageData(e),this._nextIFD=this.readUint32(),e}decodeIFDEntry(t){const e=this.offset,n=this.readUint16(),i=this.readUint16(),r=this.readUint32();if(i<1||i>12)return void this.skip(4);o.getByteLength(i,r)>4&&this.seek(this.readUint32());const s=o.readData(this,i,r);if(t.fields.set(n,s),34665===n||34853===n){let e,i=this.offset;34665===n?e="exif":34853===n&&(e="gps"),this._nextIFD=s,t[e]=this.decodeIFD({kind:e,ignoreImageData:!0}),this.offset=i}this.seek(e),this.skip(12)}decodeImageData(t){const e=t.orientation;switch(e&&1!==e&&c("orientation",e),t.type){case 1:case 2:this.readStripData(t);break;default:c("image type",t.type)}}readStripData(t){const e=t.width,n=t.height,i=function(t){if(t.length){const n=t;t=n[0];for(var e=0;e<n.length;e++)n[e]!==t&&c("bit depth",n)}return t}(t.bitsPerSample),r=t.sampleFormat;let s=e*n;const o=function(t,e,n,i){return 8===n?new Uint8Array(1*t):16===n?new Uint16Array(1*t):32===n&&3===i?new Float32Array(1*t):c("bit depth / sample format",n+" / "+i)}(s,0,i,r),a=t.compression,f=t.rowsPerStrip*e,d=t.stripOffsets,g=t.stripByteCounts;for(var p=0,m=0;m<d.length;m++){var y=this.getStripData(a,d[m],g[m]),v=s>f?f:s;s-=v,8===i?p=l(o,y,p,v):16===i?p=h(o,y,p,v,this.isLittleEndian()):32===i&&3===r?p=u(o,y,p,v,this.isLittleEndian()):c("bitDepth",i)}t.data=o}getStripData(t,e,n){switch(t){case 1:return new DataView(this.buffer,e,n);case 2:case 32773:return c("Compression",t);default:throw new Error("invalid compression: "+t)}}}},8353:(t,e,n)=>{"use strict";const i=n(8029),r=/^(\d{4}):(\d{2}):(\d{2}) (\d{2}):(\d{2}):(\d{2})$/;function s(t){return"number"==typeof t?[t]:t}t.exports=class extends i{constructor(){super("standard")}get size(){return this.width*this.height}get width(){return this.imageWidth}get height(){return this.imageLength}get components(){return this.samplesPerPixel}get date(){var t=new Date,e=r.exec(this.dateTime);return t.setFullYear(e[1],e[2]-1,e[3]),t.setHours(e[4],e[5],e[6]),t}get newSubfileType(){return this.get(254)}get imageWidth(){return this.get(256)}get imageLength(){return this.get(257)}get bitsPerSample(){return this.get(258)}get compression(){return this.get(259)||1}get type(){return this.get(262)}get fillOrder(){return this.get(266)||1}get documentName(){return this.get(269)}get imageDescription(){return this.get(270)}get stripOffsets(){return s(this.get(273))}get orientation(){return this.get(274)}get samplesPerPixel(){return this.get(277)}get rowsPerStrip(){return this.get(278)}get stripByteCounts(){return s(this.get(279))}get minSampleValue(){return this.get(280)||0}get maxSampleValue(){return this.get(281)||Math.pow(2,this.bitsPerSample)-1}get xResolution(){return this.get(282)}get yResolution(){return this.get(283)}get planarConfiguration(){return this.get(284)||1}get resolutionUnit(){return this.get(296)||2}get dateTime(){return this.get(306)}get predictor(){return this.get(317)||1}get sampleFormat(){return this.get(339)||1}get sMinSampleValue(){return this.get(340)||this.minSampleValue}get sMaxSampleValue(){return this.get(341)||this.maxSampleValue}}},9698:(t,e,n)=>{"use strict";const i=n(7909),r=n(9469);t.exports=function(t){const e=new i(t),n={};if(e.setBigEndian(),65496!==e.readUint16())throw new Error("SOI marker not found. Not a valid JPEG file");if(65505===e.readUint16()){e.readUint16();const t=e.readBytes(6);if(69===t[0]&&120===t[1]&&105===t[2]&&102===t[3]&&0===t[4]&&0===t[5]){const t=r.decode(e,{onlyFirst:!0,ignoreImageData:!0,offset:e.offset});n.exif=t}}return n}},9464:(t,e,n)=>{"use strict";e.decode=n(9698)},8737:t=>{!function(){function e(t,e,n){this.next=n,n&&(n.prev=this),this.prev=e,e&&(e.next=this),this.data=t}function n(){if(!(this instanceof n))return new n;this._head=null,this._tail=null,this.length=0}n.prototype={push:function(t){this._tail=new e(t,this._tail,null),this._head||(this._head=this._tail),this.length++},pop:function(){if(0!==this.length){var t=this._tail;return this._tail=t.prev,t.prev&&(t.prev=this._tail.next=null),this.length--,1===this.length?this._head=this._tail:0===this.length&&(this._head=this._tail=null),t.data}},unshift:function(t){this._head=new e(t,null,this._head),this._tail||(this._tail=this._head),this.length++},shift:function(){if(0!==this.length){var t=this._head;return this._head=t.next,t.next&&(t.next=this._head.prev=null),this.length--,1===this.length?this._tail=this._head:0===this.length&&(this._head=this._tail=null),t.data}},item:function(t){t<0&&(t=this.length+t);for(var e=this._head;t-- >0&&e;)e=e.next;return e?e.data:void 0},slice:function(t,e){if(t||(t=0),e||(e=this.length),e<0&&(e=this.length+e),t<0&&(t=this.length+t),e===t)return[];if(e<t)throw new Error("invalid offset: "+t+","+e+" (length="+this.length+")");for(var n=e-t,i=new Array(n),r=0,s=this._head;t-- >0&&s;)s=s.next;for(;r<n&&s;)i[r++]=s.data,s=s.next;return i},drop:function(){n.call(this)},forEach:function(t,e){for(var n=this._head,i=0,r=this.length;i<r&&n;)t.call(e||this,n.data,i,this),n=n.next,i++},map:function(t,e){var i=new n;return this.forEach((function(n,r,s){i.push(t.call(e||s,n,r,s))})),i},filter:function(t,e){var i=new n;return this.forEach((function(n,r,s){t.call(e||s,n,r,s)&&i.push(n)})),i},reduce:function(t,e,n){var i=0,r=this._head,s=this.length;for(e||(i=1,e=r&&r.data,r=r&&r.next);i<s&&r;)e=t.call(n||this,e,r.data,this),i++,r=r.next;return e}},t.exports=n}()},9645:t=>{"use strict";function e(t){if(this.size=0|t,this.size<=1||0!=(this.size&this.size-1))throw new Error("FFT size must be a power of two and bigger than 1");this._csize=t<<1;for(var e=new Array(2*this.size),n=0;n<e.length;n+=2){const t=Math.PI*n/this.size;e[n]=Math.cos(t),e[n+1]=-Math.sin(t)}this.table=e;for(var i=0,r=1;this.size>r;r<<=1)i++;this._width=i%2==0?i-1:i,this._bitrev=new Array(1<<this._width);for(var s=0;s<this._bitrev.length;s++){this._bitrev[s]=0;for(var o=0;o<this._width;o+=2){var a=this._width-o-2;this._bitrev[s]|=(s>>>o&3)<<a}}this._out=null,this._data=null,this._inv=0}t.exports=e,e.prototype.fromComplexArray=function(t,e){for(var n=e||new Array(t.length>>>1),i=0;i<t.length;i+=2)n[i>>>1]=t[i];return n},e.prototype.createComplexArray=function(){const t=new Array(this._csize);for(var e=0;e<t.length;e++)t[e]=0;return t},e.prototype.toComplexArray=function(t,e){for(var n=e||this.createComplexArray(),i=0;i<n.length;i+=2)n[i]=t[i>>>1],n[i+1]=0;return n},e.prototype.completeSpectrum=function(t){for(var e=this._csize,n=e>>>1,i=2;i<n;i+=2)t[e-i]=t[i],t[e-i+1]=-t[i+1]},e.prototype.transform=function(t,e){if(t===e)throw new Error("Input and output buffers must be different");this._out=t,this._data=e,this._inv=0,this._transform4(),this._out=null,this._data=null},e.prototype.realTransform=function(t,e){if(t===e)throw new Error("Input and output buffers must be different");this._out=t,this._data=e,this._inv=0,this._realTransform4(),this._out=null,this._data=null},e.prototype.inverseTransform=function(t,e){if(t===e)throw new Error("Input and output buffers must be different");this._out=t,this._data=e,this._inv=1,this._transform4();for(var n=0;n<t.length;n++)t[n]/=this.size;this._out=null,this._data=null},e.prototype._transform4=function(){var t,e,n=this._out,i=this._csize,r=1<<this._width,s=i/r<<1,o=this._bitrev;if(4===s)for(t=0,e=0;t<i;t+=s,e++){const n=o[e];this._singleTransform2(t,n,r)}else for(t=0,e=0;t<i;t+=s,e++){const n=o[e];this._singleTransform4(t,n,r)}var a=this._inv?-1:1,l=this.table;for(r>>=2;r>=2;r>>=2){var h=(s=i/r<<1)>>>2;for(t=0;t<i;t+=s)for(var u=t+h,c=t,f=0;c<u;c+=2,f+=r){const t=c,e=t+h,i=e+h,r=i+h,s=n[t],o=n[t+1],u=n[e],d=n[e+1],g=n[i],p=n[i+1],m=n[r],y=n[r+1],v=s,w=o,x=l[f],_=a*l[f+1],b=u*x-d*_,E=u*_+d*x,S=l[2*f],I=a*l[2*f+1],C=g*S-p*I,M=g*I+p*S,R=l[3*f],P=a*l[3*f+1],T=m*R-y*P,N=m*P+y*R,A=v+C,k=w+M,L=v-C,O=w-M,D=b+T,F=E+N,z=a*(b-T),G=a*(E-N),B=A+D,U=k+F,q=A-D,V=k-F,Y=L+G,X=O-z,j=L-G,W=O+z;n[t]=B,n[t+1]=U,n[e]=Y,n[e+1]=X,n[i]=q,n[i+1]=V,n[r]=j,n[r+1]=W}}},e.prototype._singleTransform2=function(t,e,n){const i=this._out,r=this._data,s=r[e],o=r[e+1],a=r[e+n],l=r[e+n+1],h=s+a,u=o+l,c=s-a,f=o-l;i[t]=h,i[t+1]=u,i[t+2]=c,i[t+3]=f},e.prototype._singleTransform4=function(t,e,n){const i=this._out,r=this._data,s=this._inv?-1:1,o=2*n,a=3*n,l=r[e],h=r[e+1],u=r[e+n],c=r[e+n+1],f=r[e+o],d=r[e+o+1],g=r[e+a],p=r[e+a+1],m=l+f,y=h+d,v=l-f,w=h-d,x=u+g,_=c+p,b=s*(u-g),E=s*(c-p),S=m+x,I=y+_,C=v+E,M=w-b,R=m-x,P=y-_,T=v-E,N=w+b;i[t]=S,i[t+1]=I,i[t+2]=C,i[t+3]=M,i[t+4]=R,i[t+5]=P,i[t+6]=T,i[t+7]=N},e.prototype._realTransform4=function(){var t,e,n=this._out,i=this._csize,r=1<<this._width,s=i/r<<1,o=this._bitrev;if(4===s)for(t=0,e=0;t<i;t+=s,e++){const n=o[e];this._singleRealTransform2(t,n>>>1,r>>>1)}else for(t=0,e=0;t<i;t+=s,e++){const n=o[e];this._singleRealTransform4(t,n>>>1,r>>>1)}var a=this._inv?-1:1,l=this.table;for(r>>=2;r>=2;r>>=2){var h=(s=i/r<<1)>>>1,u=h>>>1,c=u>>>1;for(t=0;t<i;t+=s)for(var f=0,d=0;f<=c;f+=2,d+=r){var g=t+f,p=g+u,m=p+u,y=m+u,v=n[g],w=n[g+1],x=n[p],_=n[p+1],b=n[m],E=n[m+1],S=n[y],I=n[y+1],C=v,M=w,R=l[d],P=a*l[d+1],T=x*R-_*P,N=x*P+_*R,A=l[2*d],k=a*l[2*d+1],L=b*A-E*k,O=b*k+E*A,D=l[3*d],F=a*l[3*d+1],z=S*D-I*F,G=S*F+I*D,B=C+L,U=M+O,q=C-L,V=M-O,Y=T+z,X=N+G,j=a*(T-z),W=a*(N-G),H=B+Y,$=U+X,Z=q+W,K=V-j;if(n[g]=H,n[g+1]=$,n[p]=Z,n[p+1]=K,0!==f){if(f!==c){var J=q+-a*W,Q=-a*j-V,tt=B+-a*Y,et=-U- -a*X,nt=t+u-f,it=t+h-f;n[nt]=J,n[nt+1]=Q,n[it]=tt,n[it+1]=et}}else{var rt=B-Y,st=U-X;n[m]=rt,n[m+1]=st}}}},e.prototype._singleRealTransform2=function(t,e,n){const i=this._out,r=this._data,s=r[e],o=r[e+n],a=s+o,l=s-o;i[t]=a,i[t+1]=0,i[t+2]=l,i[t+3]=0},e.prototype._singleRealTransform4=function(t,e,n){const i=this._out,r=this._data,s=this._inv?-1:1,o=2*n,a=3*n,l=r[e],h=r[e+n],u=r[e+o],c=r[e+a],f=l+u,d=l-u,g=h+c,p=s*(h-c),m=f+g,y=d,v=-p,w=f-g,x=d,_=p;i[t]=m,i[t+1]=0,i[t+2]=y,i[t+3]=v,i[t+4]=w,i[t+5]=0,i[t+6]=x,i[t+7]=_}},7769:module=>{"use strict";const toBytes=t=>[...t].map((t=>t.charCodeAt(0))),xpiZipFilename=toBytes("META-INF/mozilla.rsa"),oxmlContentTypes=toBytes("[Content_Types].xml"),oxmlRels=toBytes("_rels/.rels");function readUInt64LE(t,e=0){let n=t[e],i=1,r=0;for(;++r<8;)i*=256,n+=t[e+r]*i;return n}const fileType=t=>{if(!(t instanceof Uint8Array||t instanceof ArrayBuffer||Buffer.isBuffer(t)))throw new TypeError(`Expected the \`input\` argument to be of type \`Uint8Array\` or \`Buffer\` or \`ArrayBuffer\`, got \`${typeof t}\``);const e=t instanceof Uint8Array?t:new Uint8Array(t);if(!(e&&e.length>1))return null;const n=(t,n)=>{n=Object.assign({offset:0},n);for(let i=0;i<t.length;i++)if(n.mask){if(t[i]!==(n.mask[i]&e[i+n.offset]))return!1}else if(t[i]!==e[i+n.offset])return!1;return!0},i=(t,e)=>n(toBytes(t),e);if(n([255,216,255]))return{ext:"jpg",mime:"image/jpeg"};if(n([137,80,78,71,13,10,26,10]))return{ext:"png",mime:"image/png"};if(n([71,73,70]))return{ext:"gif",mime:"image/gif"};if(n([87,69,66,80],{offset:8}))return{ext:"webp",mime:"image/webp"};if(n([70,76,73,70]))return{ext:"flif",mime:"image/flif"};if((n([73,73,42,0])||n([77,77,0,42]))&&n([67,82],{offset:8}))return{ext:"cr2",mime:"image/x-canon-cr2"};if(n([73,73,42,0])||n([77,77,0,42]))return{ext:"tif",mime:"image/tiff"};if(n([66,77]))return{ext:"bmp",mime:"image/bmp"};if(n([73,73,188]))return{ext:"jxr",mime:"image/vnd.ms-photo"};if(n([56,66,80,83]))return{ext:"psd",mime:"image/vnd.adobe.photoshop"};if(n([80,75,3,4])){if(n([109,105,109,101,116,121,112,101,97,112,112,108,105,99,97,116,105,111,110,47,101,112,117,98,43,122,105,112],{offset:30}))return{ext:"epub",mime:"application/epub+zip"};if(n(xpiZipFilename,{offset:30}))return{ext:"xpi",mime:"application/x-xpinstall"};if(i("mimetypeapplication/vnd.oasis.opendocument.text",{offset:30}))return{ext:"odt",mime:"application/vnd.oasis.opendocument.text"};if(i("mimetypeapplication/vnd.oasis.opendocument.spreadsheet",{offset:30}))return{ext:"ods",mime:"application/vnd.oasis.opendocument.spreadsheet"};if(i("mimetypeapplication/vnd.oasis.opendocument.presentation",{offset:30}))return{ext:"odp",mime:"application/vnd.oasis.opendocument.presentation"};const t=(t,e=0)=>t.findIndex(((t,n,i)=>n>=e&&80===i[n]&&75===i[n+1]&&3===i[n+2]&&4===i[n+3]));let r=0,s=!1,o=null;do{const a=r+30;if(s||(s=n(oxmlContentTypes,{offset:a})||n(oxmlRels,{offset:a})),o||(i("word/",{offset:a})?o={ext:"docx",mime:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"}:i("ppt/",{offset:a})?o={ext:"pptx",mime:"application/vnd.openxmlformats-officedocument.presentationml.presentation"}:i("xl/",{offset:a})&&(o={ext:"xlsx",mime:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"})),s&&o)return o;r=t(e,a)}while(r>=0);if(o)return o}if(n([80,75])&&(3===e[2]||5===e[2]||7===e[2])&&(4===e[3]||6===e[3]||8===e[3]))return{ext:"zip",mime:"application/zip"};if(n([117,115,116,97,114],{offset:257}))return{ext:"tar",mime:"application/x-tar"};if(n([82,97,114,33,26,7])&&(0===e[6]||1===e[6]))return{ext:"rar",mime:"application/x-rar-compressed"};if(n([31,139,8]))return{ext:"gz",mime:"application/gzip"};if(n([66,90,104]))return{ext:"bz2",mime:"application/x-bzip2"};if(n([55,122,188,175,39,28]))return{ext:"7z",mime:"application/x-7z-compressed"};if(n([120,1]))return{ext:"dmg",mime:"application/x-apple-diskimage"};if(n([51,103,112,53])||n([0,0,0])&&n([102,116,121,112],{offset:4})&&(n([109,112,52,49],{offset:8})||n([109,112,52,50],{offset:8})||n([105,115,111,109],{offset:8})||n([105,115,111,50],{offset:8})||n([109,109,112,52],{offset:8})||n([77,52,86],{offset:8})||n([100,97,115,104],{offset:8})))return{ext:"mp4",mime:"video/mp4"};if(n([77,84,104,100]))return{ext:"mid",mime:"audio/midi"};if(n([26,69,223,163])){const t=e.subarray(4,4100),n=t.findIndex(((t,e,n)=>66===n[e]&&130===n[e+1]));if(-1!==n){const e=n+3,i=n=>[...n].every(((n,i)=>t[e+i]===n.charCodeAt(0)));if(i("matroska"))return{ext:"mkv",mime:"video/x-matroska"};if(i("webm"))return{ext:"webm",mime:"video/webm"}}}if(n([0,0,0,20,102,116,121,112,113,116,32,32])||n([102,114,101,101],{offset:4})||n([102,116,121,112,113,116,32,32],{offset:4})||n([109,100,97,116],{offset:4})||n([109,111,111,118],{offset:4})||n([119,105,100,101],{offset:4}))return{ext:"mov",mime:"video/quicktime"};if(n([82,73,70,70])){if(n([65,86,73],{offset:8}))return{ext:"avi",mime:"video/vnd.avi"};if(n([87,65,86,69],{offset:8}))return{ext:"wav",mime:"audio/vnd.wave"};if(n([81,76,67,77],{offset:8}))return{ext:"qcp",mime:"audio/qcelp"}}if(n([48,38,178,117,142,102,207,17,166,217])){let t=30;do{const i=readUInt64LE(e,t+16);if(n([145,7,220,183,183,169,207,17,142,230,0,192,12,32,83,101],{offset:t})){if(n([64,158,105,248,77,91,207,17,168,253,0,128,95,92,68,43],{offset:t+24}))return{ext:"wma",mime:"audio/x-ms-wma"};if(n([192,239,25,188,77,91,207,17,168,253,0,128,95,92,68,43],{offset:t+24}))return{ext:"wmv",mime:"video/x-ms-asf"};break}t+=i}while(t+24<=e.length);return{ext:"asf",mime:"application/vnd.ms-asf"}}if(n([0,0,1,186])||n([0,0,1,179]))return{ext:"mpg",mime:"video/mpeg"};if(n([102,116,121,112,51,103],{offset:4}))return{ext:"3gp",mime:"video/3gpp"};for(let t=0;t<2&&t<e.length-16;t++){if(n([73,68,51],{offset:t})||n([255,226],{offset:t,mask:[255,226]}))return{ext:"mp3",mime:"audio/mpeg"};if(n([255,228],{offset:t,mask:[255,228]}))return{ext:"mp2",mime:"audio/mpeg"};if(n([255,248],{offset:t,mask:[255,252]}))return{ext:"mp2",mime:"audio/mpeg"};if(n([255,240],{offset:t,mask:[255,252]}))return{ext:"mp4",mime:"audio/mpeg"}}if(n([102,116,121,112,77,52,65],{offset:4}))return{ext:"m4a",mime:"audio/mp4"};if(n([79,112,117,115,72,101,97,100],{offset:28}))return{ext:"opus",mime:"audio/opus"};if(n([79,103,103,83]))return n([128,116,104,101,111,114,97],{offset:28})?{ext:"ogv",mime:"video/ogg"}:n([1,118,105,100,101,111,0],{offset:28})?{ext:"ogm",mime:"video/ogg"}:n([127,70,76,65,67],{offset:28})?{ext:"oga",mime:"audio/ogg"}:n([83,112,101,101,120,32,32],{offset:28})?{ext:"spx",mime:"audio/ogg"}:n([1,118,111,114,98,105,115],{offset:28})?{ext:"ogg",mime:"audio/ogg"}:{ext:"ogx",mime:"application/ogg"};if(n([102,76,97,67]))return{ext:"flac",mime:"audio/x-flac"};if(n([77,65,67,32]))return{ext:"ape",mime:"audio/ape"};if(n([119,118,112,107]))return{ext:"wv",mime:"audio/wavpack"};if(n([35,33,65,77,82,10]))return{ext:"amr",mime:"audio/amr"};if(n([37,80,68,70]))return{ext:"pdf",mime:"application/pdf"};if(n([77,90]))return{ext:"exe",mime:"application/x-msdownload"};if((67===e[0]||70===e[0])&&n([87,83],{offset:1}))return{ext:"swf",mime:"application/x-shockwave-flash"};if(n([123,92,114,116,102]))return{ext:"rtf",mime:"application/rtf"};if(n([0,97,115,109]))return{ext:"wasm",mime:"application/wasm"};if(n([119,79,70,70])&&(n([0,1,0,0],{offset:4})||n([79,84,84,79],{offset:4})))return{ext:"woff",mime:"font/woff"};if(n([119,79,70,50])&&(n([0,1,0,0],{offset:4})||n([79,84,84,79],{offset:4})))return{ext:"woff2",mime:"font/woff2"};if(n([76,80],{offset:34})&&(n([0,0,1],{offset:8})||n([1,0,2],{offset:8})||n([2,0,2],{offset:8})))return{ext:"eot",mime:"application/vnd.ms-fontobject"};if(n([0,1,0,0,0]))return{ext:"ttf",mime:"font/ttf"};if(n([79,84,84,79,0]))return{ext:"otf",mime:"font/otf"};if(n([0,0,1,0]))return{ext:"ico",mime:"image/x-icon"};if(n([0,0,2,0]))return{ext:"cur",mime:"image/x-icon"};if(n([70,76,86,1]))return{ext:"flv",mime:"video/x-flv"};if(n([37,33]))return{ext:"ps",mime:"application/postscript"};if(n([253,55,122,88,90,0]))return{ext:"xz",mime:"application/x-xz"};if(n([83,81,76,105]))return{ext:"sqlite",mime:"application/x-sqlite3"};if(n([78,69,83,26]))return{ext:"nes",mime:"application/x-nintendo-nes-rom"};if(n([67,114,50,52]))return{ext:"crx",mime:"application/x-google-chrome-extension"};if(n([77,83,67,70])||n([73,83,99,40]))return{ext:"cab",mime:"application/vnd.ms-cab-compressed"};if(n([33,60,97,114,99,104,62,10,100,101,98,105,97,110,45,98,105,110,97,114,121]))return{ext:"deb",mime:"application/x-deb"};if(n([33,60,97,114,99,104,62]))return{ext:"ar",mime:"application/x-unix-archive"};if(n([237,171,238,219]))return{ext:"rpm",mime:"application/x-rpm"};if(n([31,160])||n([31,157]))return{ext:"Z",mime:"application/x-compress"};if(n([76,90,73,80]))return{ext:"lz",mime:"application/x-lzip"};if(n([208,207,17,224,161,177,26,225]))return{ext:"msi",mime:"application/x-msi"};if(n([6,14,43,52,2,5,1,1,13,1,2,1,1,2]))return{ext:"mxf",mime:"application/mxf"};if(n([71],{offset:4})&&(n([71],{offset:192})||n([71],{offset:196})))return{ext:"mts",mime:"video/mp2t"};if(n([66,76,69,78,68,69,82]))return{ext:"blend",mime:"application/x-blender"};if(n([66,80,71,251]))return{ext:"bpg",mime:"image/bpg"};if(n([0,0,0,12,106,80,32,32,13,10,135,10])){if(n([106,112,50,32],{offset:20}))return{ext:"jp2",mime:"image/jp2"};if(n([106,112,120,32],{offset:20}))return{ext:"jpx",mime:"image/jpx"};if(n([106,112,109,32],{offset:20}))return{ext:"jpm",mime:"image/jpm"};if(n([109,106,112,50],{offset:20}))return{ext:"mj2",mime:"image/mj2"}}if(n([70,79,82,77]))return{ext:"aif",mime:"audio/aiff"};if(i("<?xml "))return{ext:"xml",mime:"application/xml"};if(n([66,79,79,75,77,79,66,73],{offset:60}))return{ext:"mobi",mime:"application/x-mobipocket-ebook"};if(n([102,116,121,112],{offset:4})){if(n([109,105,102,49],{offset:8}))return{ext:"heic",mime:"image/heif"};if(n([109,115,102,49],{offset:8}))return{ext:"heic",mime:"image/heif-sequence"};if(n([104,101,105,99],{offset:8})||n([104,101,105,120],{offset:8}))return{ext:"heic",mime:"image/heic"};if(n([104,101,118,99],{offset:8})||n([104,101,118,120],{offset:8}))return{ext:"heic",mime:"image/heic-sequence"}}return n([171,75,84,88,32,49,49,187,13,10,26,10])?{ext:"ktx",mime:"image/ktx"}:n([68,73,67,77],{offset:128})?{ext:"dcm",mime:"application/dicom"}:n([77,80,43])||n([77,80,67,75])?{ext:"mpc",mime:"audio/x-musepack"}:n([66,69,71,73,78,58])?{ext:"ics",mime:"text/calendar"}:n([103,108,84,70,2,0,0,0])?{ext:"glb",mime:"model/gltf-binary"}:n([212,195,178,161])||n([161,178,195,212])?{ext:"pcap",mime:"application/vnd.tcpdump.pcap"}:null};module.exports=fileType,module.exports.default=fileType,Object.defineProperty(fileType,"minimumBytes",{value:4100}),module.exports.stream=readableStream=>new Promise(((resolve,reject)=>{const stream=eval("require")("stream");readableStream.once("readable",(()=>{const t=new stream.PassThrough,e=readableStream.read(module.exports.minimumBytes)||readableStream.read();try{t.fileType=fileType(e)}catch(t){reject(t)}readableStream.unshift(e),stream.pipeline?resolve(stream.pipeline(readableStream,t,(()=>{}))):resolve(readableStream.pipe(t))}))}))},7648:t=>{"use strict";var e=Object.prototype.toString,n=Math.max,i=function(t,e){for(var n=[],i=0;i<t.length;i+=1)n[i]=t[i];for(var r=0;r<e.length;r+=1)n[r+t.length]=e[r];return n};t.exports=function(t){var r=this;if("function"!=typeof r||"[object Function]"!==e.apply(r))throw new TypeError("Function.prototype.bind called on incompatible "+r);for(var s,o=function(t,e){for(var n=[],i=1,r=0;i<t.length;i+=1,r+=1)n[r]=t[i];return n}(arguments),a=n(0,r.length-o.length),l=[],h=0;h<a;h++)l[h]="$"+h;if(s=Function("binder","return function ("+function(t,e){for(var n="",i=0;i<t.length;i+=1)n+=t[i],i+1<t.length&&(n+=",");return n}(l)+"){ return binder.apply(this,arguments); }")((function(){if(this instanceof s){var e=r.apply(this,i(o,arguments));return Object(e)===e?e:this}return r.apply(t,i(o,arguments))})),r.prototype){var u=function(){};u.prototype=r.prototype,s.prototype=new u,u.prototype=null}return s}},8612:(t,e,n)=>{"use strict";var i=n(7648);t.exports=Function.prototype.bind||i},5972:t=>{"use strict";var e=function(){return"string"==typeof function(){}.name},n=Object.getOwnPropertyDescriptor;if(n)try{n([],"length")}catch(t){n=null}e.functionsHaveConfigurableNames=function(){if(!e()||!n)return!1;var t=n((function(){}),"name");return!!t&&!!t.configurable};var i=Function.prototype.bind;e.boundFunctionsHaveNames=function(){return e()&&"function"==typeof i&&""!==function(){}.bind().name},t.exports=e},5575:(t,e,n)=>{var r=n(5752);function s(t){var e=0;if(t&&t.length>0){e+=Math.abs(o(t[0]));for(var n=1;n<t.length;n++)e-=Math.abs(o(t[n]))}return e}function o(t){var e,n,s,o,l,h=0,u=t.length;if(u>2){for(i=0;i<u;i++)i===u-2?(s=u-2,o=u-1,l=0):i===u-1?(s=u-1,o=0,l=1):(s=i,o=i+1,l=i+2),e=t[s],n=t[o],h+=(a(t[l][0])-a(e[0]))*Math.sin(a(n[1]));h=h*r.RADIUS*r.RADIUS/2}return h}function a(t){return t*Math.PI/180}t.exports.Q=function t(e){var n,i=0;switch(e.type){case"Polygon":return s(e.coordinates);case"MultiPolygon":for(n=0;n<e.coordinates.length;n++)i+=s(e.coordinates[n]);return i;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;case"GeometryCollection":for(n=0;n<e.geometries.length;n++)i+=t(e.geometries[n]);return i}}},4625:t=>{t.exports=function(t){if(!t||!t.type)return null;var n=e[t.type];return n?"geometry"===n?{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:t}]}:"feature"===n?{type:"FeatureCollection",features:[t]}:"featurecollection"===n?t:void 0:null};var e={Point:"geometry",MultiPoint:"geometry",LineString:"geometry",MultiLineString:"geometry",Polygon:"geometry",MultiPolygon:"geometry",GeometryCollection:"geometry",Feature:"feature",FeatureCollection:"featurecollection"}},6498:t=>{function e(t){return t?function(t){return[Math.random()*(t[2]-t[0])+t[0],Math.random()*(t[3]-t[1])+t[1]]}(t):[s(),o()]}function n(t){return function(e,n){return[e[0]+t[0],e[1]+t[1]]}}function r(){return Math.random()-.5}function s(){return 360*r()}function o(){return 180*r()}function a(t){return{type:"Point",coordinates:t||[s(),o()]}}function l(t){return{type:"Feature",geometry:t,properties:{}}}function h(t){return{type:"FeatureCollection",features:t}}t.exports=function(){throw new Error("call .point() or .polygon() instead")},t.exports.position=e,t.exports.point=function(t,n){var r=[];for(i=0;i<t;i++)r.push(l(n?a(e(n)):a()));return h(r)},t.exports.polygon=function(t,r,s,o){"number"!=typeof r&&(r=10),"number"!=typeof s&&(s=10);var a=[];for(i=0;i<t;i++){var u=[],c=Array.apply(null,new Array(r+1)).map(Math.random);c.forEach(f),c.forEach(d),u[u.length-1]=u[0],u=u.map(n(e(o))),a.push(l({type:"Polygon",coordinates:[u]}))}function f(t,e,n){n[e]=e>0?t+n[e-1]:t}function d(t,e){t=2*t*Math.PI/c[c.length-1];var n=Math.random();u.push([n*s*Math.sin(t),n*s*Math.cos(t)])}return h(a)}},1787:(t,e,n)=>{var i=n(2582),r=n(4102),s=n(1540),o=n(9705).Z,a=s.featureEach,l=(s.coordEach,r.polygon,r.featureCollection);function h(t){var e=new i(t);return e.insert=function(t){if("Feature"!==t.type)throw new Error("invalid feature");return t.bbox=t.bbox?t.bbox:o(t),i.prototype.insert.call(this,t)},e.load=function(t){var e=[];return Array.isArray(t)?t.forEach((function(t){if("Feature"!==t.type)throw new Error("invalid features");t.bbox=t.bbox?t.bbox:o(t),e.push(t)})):a(t,(function(t){if("Feature"!==t.type)throw new Error("invalid features");t.bbox=t.bbox?t.bbox:o(t),e.push(t)})),i.prototype.load.call(this,e)},e.remove=function(t,e){if("Feature"!==t.type)throw new Error("invalid feature");return t.bbox=t.bbox?t.bbox:o(t),i.prototype.remove.call(this,t,e)},e.clear=function(){return i.prototype.clear.call(this)},e.search=function(t){var e=i.prototype.search.call(this,this.toBBox(t));return l(e)},e.collides=function(t){return i.prototype.collides.call(this,this.toBBox(t))},e.all=function(){var t=i.prototype.all.call(this);return l(t)},e.toJSON=function(){return i.prototype.toJSON.call(this)},e.fromJSON=function(t){return i.prototype.fromJSON.call(this,t)},e.toBBox=function(t){var e;if(t.bbox)e=t.bbox;else if(Array.isArray(t)&&4===t.length)e=t;else if(Array.isArray(t)&&6===t.length)e=[t[0],t[1],t[3],t[4]];else if("Feature"===t.type)e=o(t);else{if("FeatureCollection"!==t.type)throw new Error("invalid geojson");e=o(t)}return{minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]}},e}t.exports=h,t.exports.default=h},210:(t,e,n)=>{"use strict";var i,r=n(1648),s=n(3981),o=n(4726),a=n(6712),l=n(9748),h=n(4453),u=n(3915),c=Function,f=function(t){try{return c('"use strict"; return ('+t+").constructor;")()}catch(t){}},d=Object.getOwnPropertyDescriptor;if(d)try{d({},"")}catch(t){d=null}var g=function(){throw new h},p=d?function(){try{return g}catch(t){try{return d(arguments,"callee").get}catch(t){return g}}}():g,m=n(1405)(),y=n(8185)(),v=Object.getPrototypeOf||(y?function(t){return t.__proto__}:null),w={},x="undefined"!=typeof Uint8Array&&v?v(Uint8Array):i,_={__proto__:null,"%AggregateError%":"undefined"==typeof AggregateError?i:AggregateError,"%Array%":Array,"%ArrayBuffer%":"undefined"==typeof ArrayBuffer?i:ArrayBuffer,"%ArrayIteratorPrototype%":m&&v?v([][Symbol.iterator]()):i,"%AsyncFromSyncIteratorPrototype%":i,"%AsyncFunction%":w,"%AsyncGenerator%":w,"%AsyncGeneratorFunction%":w,"%AsyncIteratorPrototype%":w,"%Atomics%":"undefined"==typeof Atomics?i:Atomics,"%BigInt%":"undefined"==typeof BigInt?i:BigInt,"%BigInt64Array%":"undefined"==typeof BigInt64Array?i:BigInt64Array,"%BigUint64Array%":"undefined"==typeof BigUint64Array?i:BigUint64Array,"%Boolean%":Boolean,"%DataView%":"undefined"==typeof DataView?i:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":r,"%eval%":eval,"%EvalError%":s,"%Float32Array%":"undefined"==typeof Float32Array?i:Float32Array,"%Float64Array%":"undefined"==typeof Float64Array?i:Float64Array,"%FinalizationRegistry%":"undefined"==typeof FinalizationRegistry?i:FinalizationRegistry,"%Function%":c,"%GeneratorFunction%":w,"%Int8Array%":"undefined"==typeof Int8Array?i:Int8Array,"%Int16Array%":"undefined"==typeof Int16Array?i:Int16Array,"%Int32Array%":"undefined"==typeof Int32Array?i:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":m&&v?v(v([][Symbol.iterator]())):i,"%JSON%":"object"==typeof JSON?JSON:i,"%Map%":"undefined"==typeof Map?i:Map,"%MapIteratorPrototype%":"undefined"!=typeof Map&&m&&v?v((new Map)[Symbol.iterator]()):i,"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":"undefined"==typeof Promise?i:Promise,"%Proxy%":"undefined"==typeof Proxy?i:Proxy,"%RangeError%":o,"%ReferenceError%":a,"%Reflect%":"undefined"==typeof Reflect?i:Reflect,"%RegExp%":RegExp,"%Set%":"undefined"==typeof Set?i:Set,"%SetIteratorPrototype%":"undefined"!=typeof Set&&m&&v?v((new Set)[Symbol.iterator]()):i,"%SharedArrayBuffer%":"undefined"==typeof SharedArrayBuffer?i:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":m&&v?v(""[Symbol.iterator]()):i,"%Symbol%":m?Symbol:i,"%SyntaxError%":l,"%ThrowTypeError%":p,"%TypedArray%":x,"%TypeError%":h,"%Uint8Array%":"undefined"==typeof Uint8Array?i:Uint8Array,"%Uint8ClampedArray%":"undefined"==typeof Uint8ClampedArray?i:Uint8ClampedArray,"%Uint16Array%":"undefined"==typeof Uint16Array?i:Uint16Array,"%Uint32Array%":"undefined"==typeof Uint32Array?i:Uint32Array,"%URIError%":u,"%WeakMap%":"undefined"==typeof WeakMap?i:WeakMap,"%WeakRef%":"undefined"==typeof WeakRef?i:WeakRef,"%WeakSet%":"undefined"==typeof WeakSet?i:WeakSet};if(v)try{null.error}catch(t){var b=v(v(t));_["%Error.prototype%"]=b}var E=function t(e){var n;if("%AsyncFunction%"===e)n=f("async function () {}");else if("%GeneratorFunction%"===e)n=f("function* () {}");else if("%AsyncGeneratorFunction%"===e)n=f("async function* () {}");else if("%AsyncGenerator%"===e){var i=t("%AsyncGeneratorFunction%");i&&(n=i.prototype)}else if("%AsyncIteratorPrototype%"===e){var r=t("%AsyncGenerator%");r&&v&&(n=v(r.prototype))}return _[e]=n,n},S={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},I=n(8612),C=n(8824),M=I.call(Function.call,Array.prototype.concat),R=I.call(Function.apply,Array.prototype.splice),P=I.call(Function.call,String.prototype.replace),T=I.call(Function.call,String.prototype.slice),N=I.call(Function.call,RegExp.prototype.exec),A=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,k=/\\(\\)?/g,L=function(t,e){var n,i=t;if(C(S,i)&&(i="%"+(n=S[i])[0]+"%"),C(_,i)){var r=_[i];if(r===w&&(r=E(i)),void 0===r&&!e)throw new h("intrinsic "+t+" exists, but is not available. Please file an issue!");return{alias:n,name:i,value:r}}throw new l("intrinsic "+t+" does not exist!")};t.exports=function(t,e){if("string"!=typeof t||0===t.length)throw new h("intrinsic name must be a non-empty string");if(arguments.length>1&&"boolean"!=typeof e)throw new h('"allowMissing" argument must be a boolean');if(null===N(/^%?[^%]*%?$/,t))throw new l("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var n=function(t){var e=T(t,0,1),n=T(t,-1);if("%"===e&&"%"!==n)throw new l("invalid intrinsic syntax, expected closing `%`");if("%"===n&&"%"!==e)throw new l("invalid intrinsic syntax, expected opening `%`");var i=[];return P(t,A,(function(t,e,n,r){i[i.length]=n?P(r,k,"$1"):e||t})),i}(t),i=n.length>0?n[0]:"",r=L("%"+i+"%",e),s=r.name,o=r.value,a=!1,u=r.alias;u&&(i=u[0],R(n,M([0,1],u)));for(var c=1,f=!0;c<n.length;c+=1){var g=n[c],p=T(g,0,1),m=T(g,-1);if(('"'===p||"'"===p||"`"===p||'"'===m||"'"===m||"`"===m)&&p!==m)throw new l("property names with quotes must have matching quotes");if("constructor"!==g&&f||(a=!0),C(_,s="%"+(i+="."+g)+"%"))o=_[s];else if(null!=o){if(!(g in o)){if(!e)throw new h("base intrinsic for "+t+" exists, but the property is not available.");return}if(d&&c+1>=n.length){var y=d(o,g);o=(f=!!y)&&"get"in y&&!("originalValue"in y.get)?y.get:o[g]}else f=C(o,g),o=o[g];f&&!a&&(_[s]=o)}}return o}},7296:(t,e,n)=>{"use strict";var i=n(210)("%Object.getOwnPropertyDescriptor%",!0);if(i)try{i([],"length")}catch(t){i=null}t.exports=i},2251:(t,e,n)=>{var i=Object.prototype.hasOwnProperty;t.exports=e=function(t,e){return i.call(e,t)},e.version=n(2898).version},1044:(t,e,n)=>{"use strict";var i=n(4429),r=function(){return!!i};r.hasArrayLengthDefineBug=function(){if(!i)return null;try{return 1!==i([],"length",{value:1}).length}catch(t){return!0}},t.exports=r},8185:t=>{"use strict";var e={foo:{}},n=Object;t.exports=function(){return{__proto__:e}.foo===e.foo&&!({__proto__:null}instanceof n)}},1405:(t,e,n)=>{"use strict";var i="undefined"!=typeof Symbol&&Symbol,r=n(5419);t.exports=function(){return"function"==typeof i&&"function"==typeof Symbol&&"symbol"==typeof i("foo")&&"symbol"==typeof Symbol("bar")&&r()}},5419:t=>{"use strict";t.exports=function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"==typeof Symbol.iterator)return!0;var t={},e=Symbol("test"),n=Object(e);if("string"==typeof e)return!1;if("[object Symbol]"!==Object.prototype.toString.call(e))return!1;if("[object Symbol]"!==Object.prototype.toString.call(n))return!1;for(e in t[e]=42,t)return!1;if("function"==typeof Object.keys&&0!==Object.keys(t).length)return!1;if("function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(t).length)return!1;var i=Object.getOwnPropertySymbols(t);if(1!==i.length||i[0]!==e)return!1;if(!Object.prototype.propertyIsEnumerable.call(t,e))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){var r=Object.getOwnPropertyDescriptor(t,e);if(42!==r.value||!0!==r.enumerable)return!1}return!0}},6410:(t,e,n)=>{"use strict";var i=n(5419);t.exports=function(){return i()&&!!Symbol.toStringTag}},8824:(t,e,n)=>{"use strict";var i=Function.prototype.call,r=Object.prototype.hasOwnProperty,s=n(8612);t.exports=s.call(i,r)},645:(t,e)=>{e.read=function(t,e,n,i,r){var s,o,a=8*r-i-1,l=(1<<a)-1,h=l>>1,u=-7,c=n?r-1:0,f=n?-1:1,d=t[e+c];for(c+=f,s=d&(1<<-u)-1,d>>=-u,u+=a;u>0;s=256*s+t[e+c],c+=f,u-=8);for(o=s&(1<<-u)-1,s>>=-u,u+=i;u>0;o=256*o+t[e+c],c+=f,u-=8);if(0===s)s=1-h;else{if(s===l)return o?NaN:1/0*(d?-1:1);o+=Math.pow(2,i),s-=h}return(d?-1:1)*o*Math.pow(2,s-i)},e.write=function(t,e,n,i,r,s){var o,a,l,h=8*s-r-1,u=(1<<h)-1,c=u>>1,f=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,d=i?0:s-1,g=i?1:-1,p=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,o=u):(o=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-o))<1&&(o--,l*=2),(e+=o+c>=1?f/l:f*Math.pow(2,1-c))*l>=2&&(o++,l/=2),o+c>=u?(a=0,o=u):o+c>=1?(a=(e*l-1)*Math.pow(2,r),o+=c):(a=e*Math.pow(2,c-1)*Math.pow(2,r),o=0));r>=8;t[n+d]=255&a,d+=g,a/=256,r-=8);for(o=o<<r|a,h+=r;h>0;t[n+d]=255&o,d+=g,o/=256,h-=8);t[n+d-g]|=128*p}},9184:(t,e,n)=>{"use strict";const i=n(7769),r=new Set(["jpg","png","gif","webp","flif","cr2","tif","bmp","jxr","psd","ico","bpg","jp2","jpm","jpx","heic","cur","dcm"]),s=t=>{const e=i(t);return r.has(e&&e.ext)?e:null};t.exports=s,t.exports.default=s,Object.defineProperty(s,"minimumBytes",{value:i.minimumBytes})},1293:(t,e,n)=>{"use strict";t.exports=function(t,e){var n=t.length;if(0===n)throw new Error("Must have at least d+1 points");var r=t[0].length;if(n<=r)throw new Error("Must input at least d+1 points");var o=t.slice(0,r+1),a=i.apply(void 0,o);if(0===a)throw new Error("Input not in general position");for(var l=new Array(r+1),u=0;u<=r;++u)l[u]=u;a<0&&(l[0]=1,l[1]=0);var c=new s(l,new Array(r+1),!1),f=c.adjacent,d=new Array(r+2);for(u=0;u<=r;++u){for(var g=l.slice(),p=0;p<=r;++p)p===u&&(g[p]=-1);var m=g[0];g[0]=g[1],g[1]=m;var y=new s(g,new Array(r+1),!0);f[u]=y,d[u]=y}for(d[r+1]=c,u=0;u<=r;++u){g=f[u].vertices;var v=f[u].adjacent;for(p=0;p<=r;++p){var w=g[p];if(w<0)v[p]=c;else for(var x=0;x<=r;++x)f[x].vertices.indexOf(w)<0&&(v[p]=f[x])}}var _=new h(r,o,d),b=!!e;for(u=r+1;u<n;++u)_.insert(t[u],b);return _.boundary()};var i=n(146),r=n(4572).H;function s(t,e,n){this.vertices=t,this.adjacent=e,this.boundary=n,this.lastVisited=-1}function o(t,e,n){this.vertices=t,this.cell=e,this.index=n}function a(t,e){return r(t.vertices,e.vertices)}s.prototype.flip=function(){var t=this.vertices[0];this.vertices[0]=this.vertices[1],this.vertices[1]=t;var e=this.adjacent[0];this.adjacent[0]=this.adjacent[1],this.adjacent[1]=e};var l=[];function h(t,e,n){this.dimension=t,this.vertices=e,this.simplices=n,this.interior=n.filter((function(t){return!t.boundary})),this.tuple=new Array(t+1);for(var r=0;r<=t;++r)this.tuple[r]=this.vertices[r];var s=l[t];s||(s=l[t]=function(t){for(var e=["function orient(){var tuple=this.tuple;return test("],n=0;n<=t;++n)n>0&&e.push(","),e.push("tuple[",n,"]");e.push(")}return orient");var r=new Function("test",e.join("")),s=i[t+1];return s||(s=i),r(s)}(t)),this.orient=s}var u=h.prototype;u.handleBoundaryDegeneracy=function(t,e){var n=this.dimension,i=this.vertices.length-1,r=this.tuple,s=this.vertices,o=[t];for(t.lastVisited=-i;o.length>0;){(t=o.pop()).vertices;for(var a=t.adjacent,l=0;l<=n;++l){var h=a[l];if(h.boundary&&!(h.lastVisited<=-i)){for(var u=h.vertices,c=0;c<=n;++c){var f=u[c];r[c]=f<0?e:s[f]}var d=this.orient();if(d>0)return h;h.lastVisited=-i,0===d&&o.push(h)}}}return null},u.walk=function(t,e){var n=this.vertices.length-1,i=this.dimension,r=this.vertices,s=this.tuple,o=e?this.interior.length*Math.random()|0:this.interior.length-1,a=this.interior[o];t:for(;!a.boundary;){for(var l=a.vertices,h=a.adjacent,u=0;u<=i;++u)s[u]=r[l[u]];for(a.lastVisited=n,u=0;u<=i;++u){var c=h[u];if(!(c.lastVisited>=n)){var f=s[u];s[u]=t;var d=this.orient();if(s[u]=f,d<0){a=c;continue t}c.boundary?c.lastVisited=-n:c.lastVisited=n}}return}return a},u.addPeaks=function(t,e){var n=this.vertices.length-1,i=this.dimension,r=this.vertices,l=this.tuple,h=this.interior,u=this.simplices,c=[e];e.lastVisited=n,e.vertices[e.vertices.indexOf(-1)]=n,e.boundary=!1,h.push(e);for(var f=[];c.length>0;){var d=(e=c.pop()).vertices,g=e.adjacent,p=d.indexOf(n);if(!(p<0))for(var m=0;m<=i;++m)if(m!==p){var y=g[m];if(y.boundary&&!(y.lastVisited>=n)){var v=y.vertices;if(y.lastVisited!==-n){for(var w=0,x=0;x<=i;++x)v[x]<0?(w=x,l[x]=t):l[x]=r[v[x]];if(this.orient()>0){v[w]=n,y.boundary=!1,h.push(y),c.push(y),y.lastVisited=n;continue}y.lastVisited=-n}var _=y.adjacent,b=d.slice(),E=g.slice(),S=new s(b,E,!0);u.push(S);var I=_.indexOf(e);if(!(I<0))for(_[I]=S,E[p]=y,b[m]=-1,E[m]=e,g[m]=S,S.flip(),x=0;x<=i;++x){var C=b[x];if(!(C<0||C===n)){for(var M=new Array(i-1),R=0,P=0;P<=i;++P){var T=b[P];T<0||P===x||(M[R++]=T)}f.push(new o(M,S,x))}}}}}for(f.sort(a),m=0;m+1<f.length;m+=2){var N=f[m],A=f[m+1],k=N.index,L=A.index;k<0||L<0||(N.cell.adjacent[N.index]=A.cell,A.cell.adjacent[A.index]=N.cell)}},u.insert=function(t,e){var n=this.vertices;n.push(t);var i=this.walk(t,e);if(i){for(var r=this.dimension,s=this.tuple,o=0;o<=r;++o){var a=i.vertices[o];s[o]=a<0?t:n[a]}var l=this.orient(s);l<0||(0!==l||(i=this.handleBoundaryDegeneracy(i,t)))&&this.addPeaks(t,i)}},u.boundary=function(){for(var t=this.dimension,e=[],n=this.simplices,i=n.length,r=0;r<i;++r){var s=n[r];if(s.boundary){for(var o=new Array(t),a=s.vertices,l=0,h=0,u=0;u<=t;++u)a[u]>=0?o[l++]=a[u]:h=1&u;if(h===(1&t)){var c=o[0];o[0]=o[1],o[1]=c}e.push(o)}}return e}},2155:(t,e,n)=>{"use strict";function i(t,e="utf8"){return new TextDecoder(e).decode(t)}n.r(e),n.d(e,{IOBuffer:()=>a}),n(7396);const r=new TextEncoder,s=(()=>{const t=new Uint8Array(4);return!((new Uint32Array(t.buffer)[0]=1)&t[0])})(),o={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class a{constructor(t=8192,e={}){let n=!1;"number"==typeof t?t=new ArrayBuffer(t):(n=!0,this.lastWrittenByte=t.byteLength);const i=e.offset?e.offset>>>0:0,r=t.byteLength-i;let s=i;(ArrayBuffer.isView(t)||t instanceof a)&&(t.byteLength!==t.buffer.byteLength&&(s=t.byteOffset+i),t=t.buffer),this.lastWrittenByte=n?r:0,this.buffer=t,this.length=r,this.byteLength=r,this.byteOffset=s,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,s,r),this._mark=0,this._marks=[]}available(t=1){return this.offset+t<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(t=1){return this.offset+=t,this}back(t=1){return this.offset-=t,this}seek(t){return this.offset=t,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const t=this._marks.pop();if(void 0===t)throw new Error("Mark stack empty");return this.seek(t),this}rewind(){return this.offset=0,this}ensureAvailable(t=1){if(!this.available(t)){const e=2*(this.offset+t),n=new Uint8Array(e);n.set(new Uint8Array(this.buffer)),this.buffer=n.buffer,this.length=this.byteLength=e,this._data=new DataView(this.buffer)}return this}readBoolean(){return 0!==this.readUint8()}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(t=1){return this.readArray(t,"uint8")}readArray(t,e){const n=o[e].BYTES_PER_ELEMENT*t,i=this.byteOffset+this.offset,r=this.buffer.slice(i,i+n);if(this.littleEndian===s&&"uint8"!==e&&"int8"!==e){const t=new Uint8Array(this.buffer.slice(i,i+n));t.reverse();const r=new o[e](t.buffer);return this.offset+=n,r.reverse(),r}const a=new o[e](r);return this.offset+=n,a}readInt16(){const t=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,t}readUint16(){const t=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,t}readInt32(){const t=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,t}readUint32(){const t=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat32(){const t=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat64(){const t=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,t}readBigInt64(){const t=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,t}readBigUint64(){const t=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,t}readChar(){return String.fromCharCode(this.readInt8())}readChars(t=1){let e="";for(let n=0;n<t;n++)e+=this.readChar();return e}readUtf8(t=1){return i(this.readBytes(t))}decodeText(t=1,e="utf-8"){return i(this.readBytes(t),e)}writeBoolean(t){return this.writeUint8(t?255:0),this}writeInt8(t){return this.ensureAvailable(1),this._data.setInt8(this.offset++,t),this._updateLastWrittenByte(),this}writeUint8(t){return this.ensureAvailable(1),this._data.setUint8(this.offset++,t),this._updateLastWrittenByte(),this}writeByte(t){return this.writeUint8(t)}writeBytes(t){this.ensureAvailable(t.length);for(let e=0;e<t.length;e++)this._data.setUint8(this.offset++,t[e]);return this._updateLastWrittenByte(),this}writeInt16(t){return this.ensureAvailable(2),this._data.setInt16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(t){return this.ensureAvailable(2),this._data.setUint16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(t){return this.ensureAvailable(4),this._data.setInt32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(t){return this.ensureAvailable(4),this._data.setUint32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(t){return this.ensureAvailable(4),this._data.setFloat32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(t){return this.ensureAvailable(8),this._data.setFloat64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(t){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(t){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(t){return this.writeUint8(t.charCodeAt(0))}writeChars(t){for(let e=0;e<t.length;e++)this.writeUint8(t.charCodeAt(e));return this}writeUtf8(t){return this.writeBytes(function(t){return r.encode(t)}(t))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}},7396:function(){"use strict";!function(t){if(t.TextEncoder&&t.TextDecoder)return!1;function e(t="utf-8"){if("utf-8"!==t)throw new RangeError(`Failed to construct 'TextEncoder': The encoding label provided ('${t}') is invalid.`)}function n(t="utf-8",e={fatal:!1}){if("utf-8"!==t)throw new RangeError(`Failed to construct 'TextDecoder': The encoding label provided ('${t}') is invalid.`);if(e.fatal)throw new Error("Failed to construct 'TextDecoder': the 'fatal' option is unsupported.")}Object.defineProperty(e.prototype,"encoding",{value:"utf-8"}),e.prototype.encode=function(t,e={stream:!1}){if(e.stream)throw new Error("Failed to encode: the 'stream' option is unsupported.");let n=0;const i=t.length;let r=0,s=Math.max(32,i+(i>>1)+7),o=new Uint8Array(s>>3<<3);for(;n<i;){let e=t.charCodeAt(n++);if(e>=55296&&e<=56319){if(n<i){const i=t.charCodeAt(n);56320==(64512&i)&&(++n,e=((1023&e)<<10)+(1023&i)+65536)}if(e>=55296&&e<=56319)continue}if(r+4>o.length){s+=8,s*=1+n/t.length*2,s=s>>3<<3;const e=new Uint8Array(s);e.set(o),o=e}if(0!=(4294967168&e)){if(0==(4294965248&e))o[r++]=e>>6&31|192;else if(0==(4294901760&e))o[r++]=e>>12&15|224,o[r++]=e>>6&63|128;else{if(0!=(4292870144&e))continue;o[r++]=e>>18&7|240,o[r++]=e>>12&63|128,o[r++]=e>>6&63|128}o[r++]=63&e|128}else o[r++]=e}return o.slice(0,r)},Object.defineProperty(n.prototype,"encoding",{value:"utf-8"}),Object.defineProperty(n.prototype,"fatal",{value:!1}),Object.defineProperty(n.prototype,"ignoreBOM",{value:!1}),n.prototype.decode=function(t,e={stream:!1}){if(e.stream)throw new Error("Failed to decode: the 'stream' option is unsupported.");const n=new Uint8Array(t);let i=0;const r=n.length,s=[];for(;i<r;){const t=n[i++];if(0===t)break;if(0==(128&t))s.push(t);else if(192==(224&t)){const e=63&n[i++];s.push((31&t)<<6|e)}else if(224==(240&t)){const e=63&n[i++],r=63&n[i++];s.push((31&t)<<12|e<<6|r)}else if(240==(248&t)){let e=(7&t)<<18|(63&n[i++])<<12|(63&n[i++])<<6|63&n[i++];e>65535&&(e-=65536,s.push(e>>>10&1023|55296),e=56320|1023&e),s.push(e)}}return String.fromCharCode.apply(null,s)},t.TextEncoder=e,t.TextDecoder=n}("undefined"!=typeof window?window:"undefined"!=typeof self?self:this)},4091:(t,e,n)=>{"use strict";n.r(e),n.d(e,{isAnyArray:()=>r});const i=Object.prototype.toString;function r(t){const e=i.call(t);return e.endsWith("Array]")&&!e.includes("Big")}},2584:(t,e,n)=>{"use strict";var i=n(6410)(),r=n(1924)("Object.prototype.toString"),s=function(t){return!(i&&t&&"object"==typeof t&&Symbol.toStringTag in t)&&"[object Arguments]"===r(t)},o=function(t){return!!s(t)||null!==t&&"object"==typeof t&&"number"==typeof t.length&&t.length>=0&&"[object Array]"!==r(t)&&"[object Function]"===r(t.callee)},a=function(){return s(arguments)}();s.isLegacyArguments=o,t.exports=a?s:o},7811:t=>{"use strict";var e=Object.prototype.toString;t.exports=function(t){return"Array"===e.call(t).substr(-6,5)}},8923:(t,e,n)=>{"use strict";var i=Date.prototype.getDay,r=Object.prototype.toString,s=n(6410)();t.exports=function(t){return"object"==typeof t&&null!==t&&(s?function(t){try{return i.call(t),!0}catch(t){return!1}}(t):"[object Date]"===r.call(t))}},1867:t=>{"use strict";t.exports=Number.isFinite||function(t){return!("number"!=typeof t||t!=t||t===1/0||t===-1/0)}},8336:(t,e,n)=>{var i=n(1867);t.exports=Number.isInteger||function(t){return"number"==typeof t&&i(t)&&Math.floor(t)===t}},8420:(t,e,n)=>{"use strict";var i,r,s,o,a=n(1924),l=n(6410)();if(l){i=a("Object.prototype.hasOwnProperty"),r=a("RegExp.prototype.exec"),s={};var h=function(){throw s};o={toString:h,valueOf:h},"symbol"==typeof Symbol.toPrimitive&&(o[Symbol.toPrimitive]=h)}var u=a("Object.prototype.toString"),c=Object.getOwnPropertyDescriptor;t.exports=l?function(t){if(!t||"object"!=typeof t)return!1;var e=c(t,"lastIndex");if(!e||!i(e,"value"))return!1;try{r(t,o)}catch(t){return t===s}}:function(t){return!(!t||"object"!=typeof t&&"function"!=typeof t)&&"[object RegExp]"===u(t)}},7870:(t,e,n)=>{var i=n(587),r=n(914);t.exports={encode:i,decode:r}},914:t=>{var e=function(){"use strict";var t=new Int32Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]),e=4017,n=799,i=3406,r=2276,s=1567,o=3784,a=5793,l=2896;function h(){}function u(t,e){for(var n,i,r=0,s=[],o=16;o>0&&!t[o-1];)o--;s.push({children:[],index:0});var a,l=s[0];for(n=0;n<o;n++){for(i=0;i<t[n];i++){for((l=s.pop()).children[l.index]=e[r];l.index>0;){if(0===s.length)throw new Error("Could not recreate Huffman Table");l=s.pop()}for(l.index++,s.push(l);s.length<=n;)s.push(a={children:[],index:0}),l.children[l.index]=a.children,l=a;r++}n+1<o&&(s.push(a={children:[],index:0}),l.children[l.index]=a.children,l=a)}return s[0].children}function c(e,n,i,r,s,o,a,l,h,u){i.precision,i.samplesPerLine,i.scanLines;var c=i.mcusPerLine,f=i.progressive,d=(i.maxH,i.maxV,n),g=0,p=0;function m(){if(p>0)return p--,g>>p&1;if(255==(g=e[n++])){var t=e[n++];if(t)throw new Error("unexpected marker: "+(g<<8|t).toString(16))}return p=7,g>>>7}function y(t){for(var e,n=t;null!==(e=m());){if("number"==typeof(n=n[e]))return n;if("object"!=typeof n)throw new Error("invalid huffman sequence")}return null}function v(t){for(var e=0;t>0;){var n=m();if(null===n)return;e=e<<1|n,t--}return e}function w(t){var e=v(t);return e>=1<<t-1?e:e+(-1<<t)+1}var x,_=0,b=0;function E(t,e,n,i,r){var s=n%c,o=(n/c|0)*t.v+i,a=s*t.h+r;void 0===t.blocks[o]&&u.tolerantDecoding||e(t,t.blocks[o][a])}function S(t,e,n){var i=n/t.blocksPerLine|0,r=n%t.blocksPerLine;void 0===t.blocks[i]&&u.tolerantDecoding||e(t,t.blocks[i][r])}var I,C,M,R,P,T,N=r.length;T=f?0===o?0===l?function(t,e){var n=y(t.huffmanTableDC),i=0===n?0:w(n)<<h;e[0]=t.pred+=i}:function(t,e){e[0]|=m()<<h}:0===l?function(e,n){if(_>0)_--;else for(var i=o,r=a;i<=r;){var s=y(e.huffmanTableAC),l=15&s,u=s>>4;if(0!==l)n[t[i+=u]]=w(l)*(1<<h),i++;else{if(u<15){_=v(u)+(1<<u)-1;break}i+=16}}}:function(e,n){for(var i=o,r=a,s=0;i<=r;){var l=t[i],u=n[l]<0?-1:1;switch(b){case 0:var c=y(e.huffmanTableAC),f=15&c;if(s=c>>4,0===f)s<15?(_=v(s)+(1<<s),b=4):(s=16,b=1);else{if(1!==f)throw new Error("invalid ACn encoding");x=w(f),b=s?2:3}continue;case 1:case 2:n[l]?n[l]+=(m()<<h)*u:0==--s&&(b=2==b?3:0);break;case 3:n[l]?n[l]+=(m()<<h)*u:(n[l]=x<<h,b=0);break;case 4:n[l]&&(n[l]+=(m()<<h)*u)}i++}4===b&&0==--_&&(b=0)}:function(e,n){var i=y(e.huffmanTableDC),r=0===i?0:w(i);n[0]=e.pred+=r;for(var s=1;s<64;){var o=y(e.huffmanTableAC),a=15&o,l=o>>4;if(0!==a)n[t[s+=l]]=w(a),s++;else{if(l<15)break;s+=16}}};var A,k,L,O,D=0;for(k=1==N?r[0].blocksPerLine*r[0].blocksPerColumn:c*i.mcusPerColumn,s||(s=k);D<k;){for(C=0;C<N;C++)r[C].pred=0;if(_=0,1==N)for(I=r[0],P=0;P<s;P++)S(I,T,D),D++;else for(P=0;P<s;P++){for(C=0;C<N;C++)for(L=(I=r[C]).h,O=I.v,M=0;M<O;M++)for(R=0;R<L;R++)E(I,T,D,M,R);if(++D===k)break}if(D===k)do{if(255===e[n]&&0!==e[n+1])break;n+=1}while(n<e.length-2);if(p=0,(A=e[n]<<8|e[n+1])<65280)throw new Error("marker was not found");if(!(A>=65488&&A<=65495))break;n+=2}return n-d}function f(t,h){var u,c,f=[],d=h.blocksPerLine,g=h.blocksPerColumn,p=d<<3,y=new Int32Array(64),v=new Uint8Array(64);function w(t,u,c){var f,d,g,p,m,y,v,w,x,_,b=h.quantizationTable,E=c;for(_=0;_<64;_++)E[_]=t[_]*b[_];for(_=0;_<8;++_){var S=8*_;0!=E[1+S]||0!=E[2+S]||0!=E[3+S]||0!=E[4+S]||0!=E[5+S]||0!=E[6+S]||0!=E[7+S]?(f=a*E[0+S]+128>>8,d=a*E[4+S]+128>>8,g=E[2+S],p=E[6+S],m=l*(E[1+S]-E[7+S])+128>>8,w=l*(E[1+S]+E[7+S])+128>>8,y=E[3+S]<<4,v=E[5+S]<<4,x=f-d+1>>1,f=f+d+1>>1,d=x,x=g*o+p*s+128>>8,g=g*s-p*o+128>>8,p=x,x=m-v+1>>1,m=m+v+1>>1,v=x,x=w+y+1>>1,y=w-y+1>>1,w=x,x=f-p+1>>1,f=f+p+1>>1,p=x,x=d-g+1>>1,d=d+g+1>>1,g=x,x=m*r+w*i+2048>>12,m=m*i-w*r+2048>>12,w=x,x=y*n+v*e+2048>>12,y=y*e-v*n+2048>>12,v=x,E[0+S]=f+w,E[7+S]=f-w,E[1+S]=d+v,E[6+S]=d-v,E[2+S]=g+y,E[5+S]=g-y,E[3+S]=p+m,E[4+S]=p-m):(x=a*E[0+S]+512>>10,E[0+S]=x,E[1+S]=x,E[2+S]=x,E[3+S]=x,E[4+S]=x,E[5+S]=x,E[6+S]=x,E[7+S]=x)}for(_=0;_<8;++_){var I=_;0!=E[8+I]||0!=E[16+I]||0!=E[24+I]||0!=E[32+I]||0!=E[40+I]||0!=E[48+I]||0!=E[56+I]?(f=a*E[0+I]+2048>>12,d=a*E[32+I]+2048>>12,g=E[16+I],p=E[48+I],m=l*(E[8+I]-E[56+I])+2048>>12,w=l*(E[8+I]+E[56+I])+2048>>12,y=E[24+I],v=E[40+I],x=f-d+1>>1,f=f+d+1>>1,d=x,x=g*o+p*s+2048>>12,g=g*s-p*o+2048>>12,p=x,x=m-v+1>>1,m=m+v+1>>1,v=x,x=w+y+1>>1,y=w-y+1>>1,w=x,x=f-p+1>>1,f=f+p+1>>1,p=x,x=d-g+1>>1,d=d+g+1>>1,g=x,x=m*r+w*i+2048>>12,m=m*i-w*r+2048>>12,w=x,x=y*n+v*e+2048>>12,y=y*e-v*n+2048>>12,v=x,E[0+I]=f+w,E[56+I]=f-w,E[8+I]=d+v,E[48+I]=d-v,E[16+I]=g+y,E[40+I]=g-y,E[24+I]=p+m,E[32+I]=p-m):(x=a*c[_+0]+8192>>14,E[0+I]=x,E[8+I]=x,E[16+I]=x,E[24+I]=x,E[32+I]=x,E[40+I]=x,E[48+I]=x,E[56+I]=x)}for(_=0;_<64;++_){var C=128+(E[_]+8>>4);u[_]=C<0?0:C>255?255:C}}m(p*g*8);for(var x=0;x<g;x++){var _=x<<3;for(u=0;u<8;u++)f.push(new Uint8Array(p));for(var b=0;b<d;b++){w(h.blocks[x][b],v,y);var E=0,S=b<<3;for(c=0;c<8;c++){var I=f[_+c];for(u=0;u<8;u++)I[S+u]=v[E++]}}}return f}function d(t){return t<0?0:t>255?255:t}h.prototype={load:function(t){var e=new XMLHttpRequest;e.open("GET",t,!0),e.responseType="arraybuffer",e.onload=function(){var t=new Uint8Array(e.response||e.mozResponseArrayBuffer);this.parse(t),this.onload&&this.onload()}.bind(this),e.send(null)},parse:function(e){var n=1e3*this.opts.maxResolutionInMP*1e3,i=0;function r(){var t=e[i]<<8|e[i+1];return i+=2,t}function s(t){var e,n,i=1,r=1;for(n in t.components)t.components.hasOwnProperty(n)&&(i<(e=t.components[n]).h&&(i=e.h),r<e.v&&(r=e.v));var s=Math.ceil(t.samplesPerLine/8/i),o=Math.ceil(t.scanLines/8/r);for(n in t.components)if(t.components.hasOwnProperty(n)){e=t.components[n];var a=Math.ceil(Math.ceil(t.samplesPerLine/8)*e.h/i),l=Math.ceil(Math.ceil(t.scanLines/8)*e.v/r),h=s*e.h,u=o*e.v,c=[];m(u*h*256);for(var f=0;f<u;f++){for(var d=[],g=0;g<h;g++)d.push(new Int32Array(64));c.push(d)}e.blocksPerLine=a,e.blocksPerColumn=l,e.blocks=c}t.maxH=i,t.maxV=r,t.mcusPerLine=s,t.mcusPerColumn=o}e.length;var o,a,l,h,d=null,g=null,p=[],y=[],v=[],w=[],x=r(),_=-1;if(this.comments=[],65496!=x)throw new Error("SOI not found");for(x=r();65497!=x;){switch(x){case 65280:break;case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:var b=(l=void 0,h=void 0,l=r(),h=e.subarray(i,i+l-2),i+=h.length,h);if(65534===x){var E=String.fromCharCode.apply(null,b);this.comments.push(E)}65504===x&&74===b[0]&&70===b[1]&&73===b[2]&&70===b[3]&&0===b[4]&&(d={version:{major:b[5],minor:b[6]},densityUnits:b[7],xDensity:b[8]<<8|b[9],yDensity:b[10]<<8|b[11],thumbWidth:b[12],thumbHeight:b[13],thumbData:b.subarray(14,14+3*b[12]*b[13])}),65505===x&&69===b[0]&&120===b[1]&&105===b[2]&&102===b[3]&&0===b[4]&&(this.exifBuffer=b.subarray(5,b.length)),65518===x&&65===b[0]&&100===b[1]&&111===b[2]&&98===b[3]&&101===b[4]&&0===b[5]&&(g={version:b[6],flags0:b[7]<<8|b[8],flags1:b[9]<<8|b[10],transformCode:b[11]});break;case 65499:for(var S=r()+i-2;i<S;){var I=e[i++];m(256);var C=new Int32Array(64);if(I>>4==0)for(H=0;H<64;H++)C[t[H]]=e[i++];else{if(I>>4!=1)throw new Error("DQT: invalid table spec");for(H=0;H<64;H++)C[t[H]]=r()}p[15&I]=C}break;case 65472:case 65473:case 65474:r(),(o={}).extended=65473===x,o.progressive=65474===x,o.precision=e[i++],o.scanLines=r(),o.samplesPerLine=r(),o.components={},o.componentsOrder=[];var M=o.scanLines*o.samplesPerLine;if(M>n){var R=Math.ceil((M-n)/1e6);throw new Error(`maxResolutionInMP limit exceeded by ${R}MP`)}var P,T=e[i++];for(j=0;j<T;j++){P=e[i];var N=e[i+1]>>4,A=15&e[i+1],k=e[i+2];if(N<=0||A<=0)throw new Error("Invalid sampling factor, expected values above 0");o.componentsOrder.push(P),o.components[P]={h:N,v:A,quantizationIdx:k},i+=3}s(o),y.push(o);break;case 65476:var L=r();for(j=2;j<L;){var O=e[i++],D=new Uint8Array(16),F=0;for(H=0;H<16;H++,i++)F+=D[H]=e[i];m(16+F);var z=new Uint8Array(F);for(H=0;H<F;H++,i++)z[H]=e[i];j+=17+F,(O>>4==0?w:v)[15&O]=u(D,z)}break;case 65501:r(),a=r();break;case 65500:r(),r();break;case 65498:r();var G=e[i++],B=[];for(j=0;j<G;j++){$=o.components[e[i++]];var U=e[i++];$.huffmanTableDC=w[U>>4],$.huffmanTableAC=v[15&U],B.push($)}var q=e[i++],V=e[i++],Y=e[i++],X=c(e,i,o,B,a,q,V,Y>>4,15&Y,this.opts);i+=X;break;case 65535:255!==e[i]&&i--;break;default:if(255==e[i-3]&&e[i-2]>=192&&e[i-2]<=254){i-=3;break}if(224===x||225==x){if(-1!==_)throw new Error(`first unknown JPEG marker at offset ${_.toString(16)}, second unknown JPEG marker ${x.toString(16)} at offset ${(i-1).toString(16)}`);_=i-1;const t=r();if(255===e[i+t-2]){i+=t-2;break}}throw new Error("unknown JPEG marker "+x.toString(16))}x=r()}if(1!=y.length)throw new Error("only single frame JPEGs supported");for(var j=0;j<y.length;j++){var W=y[j].components;for(var H in W)W[H].quantizationTable=p[W[H].quantizationIdx],delete W[H].quantizationIdx}for(this.width=o.samplesPerLine,this.height=o.scanLines,this.jfif=d,this.adobe=g,this.components=[],j=0;j<o.componentsOrder.length;j++){var $=o.components[o.componentsOrder[j]];this.components.push({lines:f(0,$),scaleX:$.h/o.maxH,scaleY:$.v/o.maxV})}},getData:function(t,e){var n,i,r,s,o,a,l,h,u,c,f,g,p,y,v,w,x,_,b,E,S,I=this.width/t,C=this.height/e,M=0,R=t*e*this.components.length;m(R);var P=new Uint8Array(R);switch(this.components.length){case 1:for(n=this.components[0],c=0;c<e;c++)for(o=n.lines[0|c*n.scaleY*C],u=0;u<t;u++)f=o[0|u*n.scaleX*I],P[M++]=f;break;case 2:for(n=this.components[0],i=this.components[1],c=0;c<e;c++)for(o=n.lines[0|c*n.scaleY*C],a=i.lines[0|c*i.scaleY*C],u=0;u<t;u++)f=o[0|u*n.scaleX*I],P[M++]=f,f=a[0|u*i.scaleX*I],P[M++]=f;break;case 3:for(S=!0,this.adobe&&this.adobe.transformCode?S=!0:void 0!==this.opts.colorTransform&&(S=!!this.opts.colorTransform),n=this.components[0],i=this.components[1],r=this.components[2],c=0;c<e;c++)for(o=n.lines[0|c*n.scaleY*C],a=i.lines[0|c*i.scaleY*C],l=r.lines[0|c*r.scaleY*C],u=0;u<t;u++)S?(f=o[0|u*n.scaleX*I],g=a[0|u*i.scaleX*I],_=d(f+1.402*((p=l[0|u*r.scaleX*I])-128)),b=d(f-.3441363*(g-128)-.71413636*(p-128)),E=d(f+1.772*(g-128))):(_=o[0|u*n.scaleX*I],b=a[0|u*i.scaleX*I],E=l[0|u*r.scaleX*I]),P[M++]=_,P[M++]=b,P[M++]=E;break;case 4:if(!this.adobe)throw new Error("Unsupported color mode (4 components)");for(S=!1,this.adobe&&this.adobe.transformCode?S=!0:void 0!==this.opts.colorTransform&&(S=!!this.opts.colorTransform),n=this.components[0],i=this.components[1],r=this.components[2],s=this.components[3],c=0;c<e;c++)for(o=n.lines[0|c*n.scaleY*C],a=i.lines[0|c*i.scaleY*C],l=r.lines[0|c*r.scaleY*C],h=s.lines[0|c*s.scaleY*C],u=0;u<t;u++)S?(f=o[0|u*n.scaleX*I],g=a[0|u*i.scaleX*I],p=l[0|u*r.scaleX*I],y=h[0|u*s.scaleX*I],v=255-d(f+1.402*(p-128)),w=255-d(f-.3441363*(g-128)-.71413636*(p-128)),x=255-d(f+1.772*(g-128))):(v=o[0|u*n.scaleX*I],w=a[0|u*i.scaleX*I],x=l[0|u*r.scaleX*I],y=h[0|u*s.scaleX*I]),P[M++]=255-v,P[M++]=255-w,P[M++]=255-x,P[M++]=255-y;break;default:throw new Error("Unsupported color mode")}return P},copyToImageData:function(t,e){var n,i,r,s,o,a,l,h,u,c=t.width,f=t.height,g=t.data,p=this.getData(c,f),m=0,y=0;switch(this.components.length){case 1:for(i=0;i<f;i++)for(n=0;n<c;n++)r=p[m++],g[y++]=r,g[y++]=r,g[y++]=r,e&&(g[y++]=255);break;case 3:for(i=0;i<f;i++)for(n=0;n<c;n++)l=p[m++],h=p[m++],u=p[m++],g[y++]=l,g[y++]=h,g[y++]=u,e&&(g[y++]=255);break;case 4:for(i=0;i<f;i++)for(n=0;n<c;n++)o=p[m++],a=p[m++],r=p[m++],l=255-d(o*(1-(s=p[m++])/255)+s),h=255-d(a*(1-s/255)+s),u=255-d(r*(1-s/255)+s),g[y++]=l,g[y++]=h,g[y++]=u,e&&(g[y++]=255);break;default:throw new Error("Unsupported color mode")}}};var g=0,p=0;function m(t=0){var e=g+t;if(e>p){var n=Math.ceil((e-p)/1024/1024);throw new Error(`maxMemoryUsageInMB limit exceeded by at least ${n}MB`)}g=e}return h.resetMaxMemoryUsage=function(t){g=0,p=t},h.getBytesAllocated=function(){return g},h.requestMemoryAllocation=m,h}();t.exports=function(t,n={}){var i={colorTransform:void 0,useTArray:!1,formatAsRGBA:!0,tolerantDecoding:!0,maxResolutionInMP:100,maxMemoryUsageInMB:512,...n},r=new Uint8Array(t),s=new e;s.opts=i,e.resetMaxMemoryUsage(1024*i.maxMemoryUsageInMB*1024),s.parse(r);var o=i.formatAsRGBA?4:3,a=s.width*s.height*o;try{e.requestMemoryAllocation(a);var l={width:s.width,height:s.height,exifBuffer:s.exifBuffer,data:i.useTArray?new Uint8Array(a):Buffer.alloc(a)};s.comments.length>0&&(l.comments=s.comments)}catch(t){if(t instanceof RangeError)throw new Error("Could not allocate enough memory for the image. Required: "+a);if(t instanceof ReferenceError&&"Buffer is not defined"===t.message)throw new Error("Buffer is not globally defined in this environment. Consider setting useTArray to true");throw t}return s.copyToImageData(l,i.formatAsRGBA),l}},587:t=>{function e(t){Math.round;var e,n,i,r,s,o=Math.floor,a=new Array(64),l=new Array(64),h=new Array(64),u=new Array(64),c=new Array(65535),f=new Array(65535),d=new Array(64),g=new Array(64),p=[],m=0,y=7,v=new Array(64),w=new Array(64),x=new Array(64),_=new Array(256),b=new Array(2048),E=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],S=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],I=[0,1,2,3,4,5,6,7,8,9,10,11],C=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],M=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],R=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],P=[0,1,2,3,4,5,6,7,8,9,10,11],T=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],N=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function A(t,e){for(var n=0,i=0,r=new Array,s=1;s<=16;s++){for(var o=1;o<=t[s];o++)r[e[i]]=[],r[e[i]][0]=n,r[e[i]][1]=s,i++,n++;n*=2}return r}function k(t){for(var e=t[0],n=t[1]-1;n>=0;)e&1<<n&&(m|=1<<y),n--,--y<0&&(255==m?(L(255),L(0)):L(m),y=7,m=0)}function L(t){p.push(t)}function O(t){L(t>>8&255),L(255&t)}function D(t,e,n,i,r){for(var s,o=r[0],a=r[240],l=function(t,e){var n,i,r,s,o,a,l,h,u,c,f=0;for(u=0;u<8;++u){n=t[f],i=t[f+1],r=t[f+2],s=t[f+3],o=t[f+4],a=t[f+5],l=t[f+6];var g=n+(h=t[f+7]),p=n-h,m=i+l,y=i-l,v=r+a,w=r-a,x=s+o,_=s-o,b=g+x,E=g-x,S=m+v,I=m-v;t[f]=b+S,t[f+4]=b-S;var C=.707106781*(I+E);t[f+2]=E+C,t[f+6]=E-C;var M=.382683433*((b=_+w)-(I=y+p)),R=.5411961*b+M,P=1.306562965*I+M,T=.707106781*(S=w+y),N=p+T,A=p-T;t[f+5]=A+R,t[f+3]=A-R,t[f+1]=N+P,t[f+7]=N-P,f+=8}for(f=0,u=0;u<8;++u){n=t[f],i=t[f+8],r=t[f+16],s=t[f+24],o=t[f+32],a=t[f+40],l=t[f+48];var k=n+(h=t[f+56]),L=n-h,O=i+l,D=i-l,F=r+a,z=r-a,G=s+o,B=s-o,U=k+G,q=k-G,V=O+F,Y=O-F;t[f]=U+V,t[f+32]=U-V;var X=.707106781*(Y+q);t[f+16]=q+X,t[f+48]=q-X;var j=.382683433*((U=B+z)-(Y=D+L)),W=.5411961*U+j,H=1.306562965*Y+j,$=.707106781*(V=z+D),Z=L+$,K=L-$;t[f+40]=K+W,t[f+24]=K-W,t[f+8]=Z+H,t[f+56]=Z-H,f++}for(u=0;u<64;++u)c=t[u]*e[u],d[u]=c>0?c+.5|0:c-.5|0;return d}(t,e),h=0;h<64;++h)g[E[h]]=l[h];var u=g[0]-n;n=g[0],0==u?k(i[0]):(k(i[f[s=32767+u]]),k(c[s]));for(var p=63;p>0&&0==g[p];p--);if(0==p)return k(o),n;for(var m,y=1;y<=p;){for(var v=y;0==g[y]&&y<=p;++y);var w=y-v;if(w>=16){m=w>>4;for(var x=1;x<=m;++x)k(a);w&=15}s=32767+g[y],k(r[(w<<4)+f[s]]),k(c[s]),y++}return 63!=p&&k(o),n}function F(t){t<=0&&(t=1),t>100&&(t=100),s!=t&&(function(t){for(var e=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],n=0;n<64;n++){var i=o((e[n]*t+50)/100);i<1?i=1:i>255&&(i=255),a[E[n]]=i}for(var r=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],s=0;s<64;s++){var c=o((r[s]*t+50)/100);c<1?c=1:c>255&&(c=255),l[E[s]]=c}for(var f=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],d=0,g=0;g<8;g++)for(var p=0;p<8;p++)h[d]=1/(a[E[d]]*f[g]*f[p]*8),u[d]=1/(l[E[d]]*f[g]*f[p]*8),d++}(t<50?Math.floor(5e3/t):Math.floor(200-2*t)),s=t)}this.encode=function(t,s){var o;(new Date).getTime(),s&&F(s),p=new Array,m=0,y=7,O(65496),O(65504),O(16),L(74),L(70),L(73),L(70),L(0),L(1),L(1),L(0),O(1),O(1),L(0),L(0),void 0!==(o=t.comments)&&o.constructor===Array&&o.forEach((t=>{if("string"==typeof t){O(65534);var e,n=t.length;for(O(n+2),e=0;e<n;e++)L(t.charCodeAt(e))}})),function(t){if(t){O(65505),69===t[0]&&120===t[1]&&105===t[2]&&102===t[3]?O(t.length+2):(O(t.length+5+2),L(69),L(120),L(105),L(102),L(0));for(var e=0;e<t.length;e++)L(t[e])}}(t.exifBuffer),function(){O(65499),O(132),L(0);for(var t=0;t<64;t++)L(a[t]);L(1);for(var e=0;e<64;e++)L(l[e])}(),function(t,e){O(65472),O(17),L(8),O(e),O(t),L(3),L(1),L(17),L(0),L(2),L(17),L(1),L(3),L(17),L(1)}(t.width,t.height),function(){O(65476),O(418),L(0);for(var t=0;t<16;t++)L(S[t+1]);for(var e=0;e<=11;e++)L(I[e]);L(16);for(var n=0;n<16;n++)L(C[n+1]);for(var i=0;i<=161;i++)L(M[i]);L(1);for(var r=0;r<16;r++)L(R[r+1]);for(var s=0;s<=11;s++)L(P[s]);L(17);for(var o=0;o<16;o++)L(T[o+1]);for(var a=0;a<=161;a++)L(N[a])}(),O(65498),O(12),L(3),L(1),L(0),L(2),L(17),L(3),L(17),L(0),L(63),L(0);var c=0,f=0,d=0;m=0,y=7,this.encode.displayName="_encode_";for(var g,_,E,A,z,G,B,U,q,V=t.data,Y=t.width,X=t.height,j=4*Y,W=0;W<X;){for(g=0;g<j;){for(G=z=j*W+g,B=-1,U=0,q=0;q<64;q++)G=z+(U=q>>3)*j+(B=4*(7&q)),W+U>=X&&(G-=j*(W+1+U-X)),g+B>=j&&(G-=g+B-j+4),_=V[G++],E=V[G++],A=V[G++],v[q]=(b[_]+b[E+256>>0]+b[A+512>>0]>>16)-128,w[q]=(b[_+768>>0]+b[E+1024>>0]+b[A+1280>>0]>>16)-128,x[q]=(b[_+1280>>0]+b[E+1536>>0]+b[A+1792>>0]>>16)-128;c=D(v,h,c,e,i),f=D(w,u,f,n,r),d=D(x,u,d,n,r),g+=32}W+=8}if(y>=0){var H=[];H[1]=y+1,H[0]=(1<<y+1)-1,k(H)}return O(65497),Buffer.from(p)},(new Date).getTime(),t||(t=50),function(){for(var t=String.fromCharCode,e=0;e<256;e++)_[e]=t(e)}(),e=A(S,I),n=A(R,P),i=A(C,M),r=A(T,N),function(){for(var t=1,e=2,n=1;n<=15;n++){for(var i=t;i<e;i++)f[32767+i]=n,c[32767+i]=[],c[32767+i][1]=n,c[32767+i][0]=i;for(var r=-(e-1);r<=-t;r++)f[32767+r]=n,c[32767+r]=[],c[32767+r][1]=n,c[32767+r][0]=e-1+r;t<<=1,e<<=1}}(),function(){for(var t=0;t<256;t++)b[t]=19595*t,b[t+256>>0]=38470*t,b[t+512>>0]=7471*t+32768,b[t+768>>0]=-11059*t,b[t+1024>>0]=-21709*t,b[t+1280>>0]=32768*t+8421375,b[t+1536>>0]=-27439*t,b[t+1792>>0]=-5329*t}(),F(t),(new Date).getTime()}t.exports=function(t,n){return void 0===n&&(n=50),{data:new e(n).encode(t,n),width:t.width,height:t.height}}},5307:t=>{t.exports=function t(e,n,i){function r(o,a){if(!n[o]){if(!e[o]){if(s)return s(o,!0);var l=new Error("Cannot find module '"+o+"'");throw l.code="MODULE_NOT_FOUND",l}var h=n[o]={exports:{}};e[o][0].call(h.exports,(function(t){return r(e[o][1][t]||t)}),h,h.exports,t,e,n,i)}return n[o].exports}for(var s=void 0,o=0;o<i.length;o++)r(i[o]);return r}({1:[function(t,e,n){var i,r,s,o,a,l={}.hasOwnProperty;i=t("./PriorityQueue/AbstractPriorityQueue"),r=t("./PriorityQueue/ArrayStrategy"),o=t("./PriorityQueue/BinaryHeapStrategy"),s=t("./PriorityQueue/BHeapStrategy"),(a=function(t){function e(t){t||(t={}),t.strategy||(t.strategy=o),t.comparator||(t.comparator=function(t,e){return(t||0)-(e||0)}),e.__super__.constructor.call(this,t)}return function(t,e){for(var n in e)l.call(e,n)&&(t[n]=e[n]);function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype}(e,t),e}(i)).ArrayStrategy=r,a.BinaryHeapStrategy=o,a.BHeapStrategy=s,e.exports=a},{"./PriorityQueue/AbstractPriorityQueue":2,"./PriorityQueue/ArrayStrategy":3,"./PriorityQueue/BHeapStrategy":4,"./PriorityQueue/BinaryHeapStrategy":5}],2:[function(t,e,n){e.exports=function(){function t(t){var e;if(null==(null!=t?t.strategy:void 0))throw"Must pass options.strategy, a strategy";if(null==(null!=t?t.comparator:void 0))throw"Must pass options.comparator, a comparator";this.priv=new t.strategy(t),this.length=(null!=t&&null!=(e=t.initialValues)?e.length:void 0)||0}return t.prototype.queue=function(t){this.length++,this.priv.queue(t)},t.prototype.dequeue=function(t){if(!this.length)throw"Empty queue";return this.length--,this.priv.dequeue()},t.prototype.peek=function(t){if(!this.length)throw"Empty queue";return this.priv.peek()},t.prototype.clear=function(){return this.length=0,this.priv.clear()},t}()},{}],3:[function(t,e,n){var i;i=function(t,e,n){var i,r,s;for(r=0,i=t.length;r<i;)n(t[s=r+i>>>1],e)>=0?r=s+1:i=s;return r},e.exports=function(){function t(t){var e;this.options=t,this.comparator=this.options.comparator,this.data=(null!=(e=this.options.initialValues)?e.slice(0):void 0)||[],this.data.sort(this.comparator).reverse()}return t.prototype.queue=function(t){var e;e=i(this.data,t,this.comparator),this.data.splice(e,0,t)},t.prototype.dequeue=function(){return this.data.pop()},t.prototype.peek=function(){return this.data[this.data.length-1]},t.prototype.clear=function(){this.data.length=0},t}()},{}],4:[function(t,e,n){e.exports=function(){function t(t){var e,n,i,r,s,o,a,l;for(this.comparator=(null!=t?t.comparator:void 0)||function(t,e){return t-e},this.pageSize=(null!=t?t.pageSize:void 0)||512,this.length=0,a=0;1<<a<this.pageSize;)a+=1;if(1<<a!==this.pageSize)throw"pageSize must be a power of two";for(this._shift=a,this._emptyMemoryPageTemplate=e=[],n=0,s=this.pageSize;0<=s?n<s:n>s;0<=s?++n:--n)e.push(null);if(this._memory=[],this._mask=this.pageSize-1,t.initialValues)for(i=0,r=(o=t.initialValues).length;i<r;i++)l=o[i],this.queue(l)}return t.prototype.queue=function(t){this.length+=1,this._write(this.length,t),this._bubbleUp(this.length,t)},t.prototype.dequeue=function(){var t,e;return t=this._read(1),e=this._read(this.length),this.length-=1,this.length>0&&(this._write(1,e),this._bubbleDown(1,e)),t},t.prototype.peek=function(){return this._read(1)},t.prototype.clear=function(){this.length=0,this._memory.length=0},t.prototype._write=function(t,e){var n;for(n=t>>this._shift;n>=this._memory.length;)this._memory.push(this._emptyMemoryPageTemplate.slice(0));return this._memory[n][t&this._mask]=e},t.prototype._read=function(t){return this._memory[t>>this._shift][t&this._mask]},t.prototype._bubbleUp=function(t,e){var n,i,r,s;for(n=this.comparator;t>1&&(i=t&this._mask,t<this.pageSize||i>3?r=t&~this._mask|i>>1:i<2?(r=t-this.pageSize>>this._shift,r+=r&~(this._mask>>1),r|=this.pageSize>>1):r=t-2,!(n(s=this._read(r),e)<0));)this._write(r,e),this._write(t,s),t=r},t.prototype._bubbleDown=function(t,e){var n,i,r,s,o;for(o=this.comparator;t<this.length;)if(t>this._mask&&!(t&this._mask-1)?n=i=t+2:t&this.pageSize>>1?(n=(t&~this._mask)>>1,i=1+(n=1+(n|=t&this._mask>>1)<<this._shift)):i=(n=t+(t&this._mask))+1,n!==i&&i<=this.length)if(r=this._read(n),s=this._read(i),o(r,e)<0&&o(r,s)<=0)this._write(n,e),this._write(t,r),t=n;else{if(!(o(s,e)<0))break;this._write(i,e),this._write(t,s),t=i}else{if(!(n<=this.length))break;if(!(o(r=this._read(n),e)<0))break;this._write(n,e),this._write(t,r),t=n}},t}()},{}],5:[function(t,e,n){e.exports=function(){function t(t){var e;this.comparator=(null!=t?t.comparator:void 0)||function(t,e){return t-e},this.length=0,this.data=(null!=(e=t.initialValues)?e.slice(0):void 0)||[],this._heapify()}return t.prototype._heapify=function(){var t,e,n;if(this.data.length>0)for(t=e=1,n=this.data.length;1<=n?e<n:e>n;t=1<=n?++e:--e)this._bubbleUp(t)},t.prototype.queue=function(t){this.data.push(t),this._bubbleUp(this.data.length-1)},t.prototype.dequeue=function(){var t,e;return e=this.data[0],t=this.data.pop(),this.data.length>0&&(this.data[0]=t,this._bubbleDown(0)),e},t.prototype.peek=function(){return this.data[0]},t.prototype.clear=function(){this.length=0,this.data.length=0},t.prototype._bubbleUp=function(t){for(var e,n;t>0&&(e=t-1>>>1,this.comparator(this.data[t],this.data[e])<0);)n=this.data[e],this.data[e]=this.data[t],this.data[t]=n,t=e},t.prototype._bubbleDown=function(t){var e,n,i,r,s;for(e=this.data.length-1;r=1+(n=1+(t<<1)),i=t,n<=e&&this.comparator(this.data[n],this.data[i])<0&&(i=n),r<=e&&this.comparator(this.data[r],this.data[i])<0&&(i=r),i!==t;)s=this.data[i],this.data[i]=this.data[t],this.data[t]=s,t=i},t}()},{}]},{},[1])(1)},2229:function(t){t.exports=function(){"use strict";function t(t){return"string"==typeof t||t instanceof String}var e=Number.isFinite||window.isFinite;function n(t){return e(t)}function i(t){return t}function r(t,e){if(e.length!==t.length)return!1;for(var n=0;n<t.length;n++){if(e[n].compareArray&&!e[n].compareArray(t[n]))return!1;if(e[n]!==t[n])return!1}return!0}function s(t,e){Object.keys(e).forEach((function(n){t[n]=e[n]}))}function o(){for(var t=1,e=0,n=0;n<arguments.length;n++){var i=arguments[n];e+=h(i),t*=i}return 0!==e?l(t,e):t}function a(t,e){if(0===e)throw new Error("Divide by zero");var n=Math.pow(10,h(e));return o(t,n/(n*e))}function l(t,e){return Math.round(t*Math.pow(10,e))/Math.pow(10,e)}function h(t){if(!isFinite(t))return 0;for(var e=0;t%1!=0;)t*=10,e++;return e}function u(){var t;if(!this)return t=Object.create(u.prototype),u.apply(t,arguments),t;t=Error.apply(this,arguments),this.name="QtyError",this.message=t.message,this.stack=t.stack}function c(t,e){throw new u("Incompatible units: "+t+" and "+e)}u.prototype=Object.create(Error.prototype,{constructor:{value:u}});var f={"<googol>":[["googol"],1e100,"prefix"],"<kibi>":[["Ki","Kibi","kibi"],Math.pow(2,10),"prefix"],"<mebi>":[["Mi","Mebi","mebi"],Math.pow(2,20),"prefix"],"<gibi>":[["Gi","Gibi","gibi"],Math.pow(2,30),"prefix"],"<tebi>":[["Ti","Tebi","tebi"],Math.pow(2,40),"prefix"],"<pebi>":[["Pi","Pebi","pebi"],Math.pow(2,50),"prefix"],"<exi>":[["Ei","Exi","exi"],Math.pow(2,60),"prefix"],"<zebi>":[["Zi","Zebi","zebi"],Math.pow(2,70),"prefix"],"<yebi>":[["Yi","Yebi","yebi"],Math.pow(2,80),"prefix"],"<yotta>":[["Y","Yotta","yotta"],1e24,"prefix"],"<zetta>":[["Z","Zetta","zetta"],1e21,"prefix"],"<exa>":[["E","Exa","exa"],1e18,"prefix"],"<peta>":[["P","Peta","peta"],1e15,"prefix"],"<tera>":[["T","Tera","tera"],1e12,"prefix"],"<giga>":[["G","Giga","giga"],1e9,"prefix"],"<mega>":[["M","Mega","mega"],1e6,"prefix"],"<kilo>":[["k","kilo"],1e3,"prefix"],"<hecto>":[["h","Hecto","hecto"],100,"prefix"],"<deca>":[["da","Deca","deca","deka"],10,"prefix"],"<deci>":[["d","Deci","deci"],.1,"prefix"],"<centi>":[["c","Centi","centi"],.01,"prefix"],"<milli>":[["m","Milli","milli"],.001,"prefix"],"<micro>":[["u","","","Micro","mc","micro"],1e-6,"prefix"],"<nano>":[["n","Nano","nano"],1e-9,"prefix"],"<pico>":[["p","Pico","pico"],1e-12,"prefix"],"<femto>":[["f","Femto","femto"],1e-15,"prefix"],"<atto>":[["a","Atto","atto"],1e-18,"prefix"],"<zepto>":[["z","Zepto","zepto"],1e-21,"prefix"],"<yocto>":[["y","Yocto","yocto"],1e-24,"prefix"],"<1>":[["1","<1>"],1,""],"<meter>":[["m","meter","meters","metre","metres"],1,"length",["<meter>"]],"<inch>":[["in","inch","inches",'"'],.0254,"length",["<meter>"]],"<foot>":[["ft","foot","feet","'"],.3048,"length",["<meter>"]],"<yard>":[["yd","yard","yards"],.9144,"length",["<meter>"]],"<mile>":[["mi","mile","miles"],1609.344,"length",["<meter>"]],"<naut-mile>":[["nmi","naut-mile"],1852,"length",["<meter>"]],"<league>":[["league","leagues"],4828,"length",["<meter>"]],"<furlong>":[["furlong","furlongs"],201.2,"length",["<meter>"]],"<rod>":[["rd","rod","rods"],5.029,"length",["<meter>"]],"<mil>":[["mil","mils"],254e-7,"length",["<meter>"]],"<angstrom>":[["ang","angstrom","angstroms"],1e-10,"length",["<meter>"]],"<fathom>":[["fathom","fathoms"],1.829,"length",["<meter>"]],"<pica>":[["pica","picas"],.00423333333,"length",["<meter>"]],"<point>":[["pt","point","points"],.000352777778,"length",["<meter>"]],"<redshift>":[["z","red-shift","redshift"],1302773e20,"length",["<meter>"]],"<AU>":[["AU","astronomical-unit"],1495979e5,"length",["<meter>"]],"<light-second>":[["ls","light-second"],299792500,"length",["<meter>"]],"<light-minute>":[["lmin","light-minute"],1798755e4,"length",["<meter>"]],"<light-year>":[["ly","light-year"],9460528e9,"length",["<meter>"]],"<parsec>":[["pc","parsec","parsecs"],3085678e10,"length",["<meter>"]],"<datamile>":[["DM","datamile"],1828.8,"length",["<meter>"]],"<kilogram>":[["kg","kilogram","kilograms"],1,"mass",["<kilogram>"]],"<AMU>":[["u","AMU","amu"],1660538921e-36,"mass",["<kilogram>"]],"<dalton>":[["Da","Dalton","Daltons","dalton","daltons"],1660538921e-36,"mass",["<kilogram>"]],"<slug>":[["slug","slugs"],14.5939029,"mass",["<kilogram>"]],"<short-ton>":[["tn","ton","short-ton"],907.18474,"mass",["<kilogram>"]],"<metric-ton>":[["t","tonne","metric-ton"],1e3,"mass",["<kilogram>"]],"<carat>":[["ct","carat","carats"],2e-4,"mass",["<kilogram>"]],"<pound>":[["lbs","lb","pound","pounds","#"],.45359237,"mass",["<kilogram>"]],"<ounce>":[["oz","ounce","ounces"],.0283495231,"mass",["<kilogram>"]],"<gram>":[["g","gram","grams","gramme","grammes"],.001,"mass",["<kilogram>"]],"<grain>":[["grain","grains","gr"],6479891e-11,"mass",["<kilogram>"]],"<dram>":[["dram","drams","dr"],.0017718452,"mass",["<kilogram>"]],"<stone>":[["stone","stones","st"],6.35029318,"mass",["<kilogram>"]],"<hectare>":[["hectare"],1e4,"area",["<meter>","<meter>"]],"<acre>":[["acre","acres"],4046.85642,"area",["<meter>","<meter>"]],"<sqft>":[["sqft"],1,"area",["<foot>","<foot>"]],"<liter>":[["l","L","liter","liters","litre","litres"],.001,"volume",["<meter>","<meter>","<meter>"]],"<gallon>":[["gal","gallon","gallons"],.0037854118,"volume",["<meter>","<meter>","<meter>"]],"<gallon-imp>":[["galimp","gallon-imp","gallons-imp"],.00454609,"volume",["<meter>","<meter>","<meter>"]],"<quart>":[["qt","quart","quarts"],.00094635295,"volume",["<meter>","<meter>","<meter>"]],"<pint>":[["pt","pint","pints"],.000473176475,"volume",["<meter>","<meter>","<meter>"]],"<pint-imp>":[["ptimp","pint-imp","pints-imp"],.00056826125,"volume",["<meter>","<meter>","<meter>"]],"<cup>":[["cu","cup","cups"],.000236588238,"volume",["<meter>","<meter>","<meter>"]],"<fluid-ounce>":[["floz","fluid-ounce","fluid-ounces"],295735297e-13,"volume",["<meter>","<meter>","<meter>"]],"<fluid-ounce-imp>":[["flozimp","floz-imp","fluid-ounce-imp","fluid-ounces-imp"],284130625e-13,"volume",["<meter>","<meter>","<meter>"]],"<tablespoon>":[["tb","tbsp","tbs","tablespoon","tablespoons"],147867648e-13,"volume",["<meter>","<meter>","<meter>"]],"<teaspoon>":[["tsp","teaspoon","teaspoons"],492892161e-14,"volume",["<meter>","<meter>","<meter>"]],"<bushel>":[["bu","bsh","bushel","bushels"],.035239072,"volume",["<meter>","<meter>","<meter>"]],"<oilbarrel>":[["bbl","oilbarrel","oilbarrels","oil-barrel","oil-barrels"],.158987294928,"volume",["<meter>","<meter>","<meter>"]],"<beerbarrel>":[["bl","bl-us","beerbarrel","beerbarrels","beer-barrel","beer-barrels"],.1173477658,"volume",["<meter>","<meter>","<meter>"]],"<beerbarrel-imp>":[["blimp","bl-imp","beerbarrel-imp","beerbarrels-imp","beer-barrel-imp","beer-barrels-imp"],.16365924,"volume",["<meter>","<meter>","<meter>"]],"<kph>":[["kph"],.277777778,"speed",["<meter>"],["<second>"]],"<mph>":[["mph"],.44704,"speed",["<meter>"],["<second>"]],"<knot>":[["kt","kn","kts","knot","knots"],.514444444,"speed",["<meter>"],["<second>"]],"<fps>":[["fps"],.3048,"speed",["<meter>"],["<second>"]],"<gee>":[["gee"],9.80665,"acceleration",["<meter>"],["<second>","<second>"]],"<Gal>":[["Gal"],.01,"acceleration",["<meter>"],["<second>","<second>"]],"<kelvin>":[["degK","kelvin"],1,"temperature",["<kelvin>"]],"<celsius>":[["degC","celsius","celsius","centigrade"],1,"temperature",["<kelvin>"]],"<fahrenheit>":[["degF","fahrenheit"],5/9,"temperature",["<kelvin>"]],"<rankine>":[["degR","rankine"],5/9,"temperature",["<kelvin>"]],"<temp-K>":[["tempK","temp-K"],1,"temperature",["<temp-K>"]],"<temp-C>":[["tempC","temp-C"],1,"temperature",["<temp-K>"]],"<temp-F>":[["tempF","temp-F"],5/9,"temperature",["<temp-K>"]],"<temp-R>":[["tempR","temp-R"],5/9,"temperature",["<temp-K>"]],"<second>":[["s","sec","secs","second","seconds"],1,"time",["<second>"]],"<minute>":[["min","mins","minute","minutes"],60,"time",["<second>"]],"<hour>":[["h","hr","hrs","hour","hours"],3600,"time",["<second>"]],"<day>":[["d","day","days"],86400,"time",["<second>"]],"<week>":[["wk","week","weeks"],604800,"time",["<second>"]],"<fortnight>":[["fortnight","fortnights"],1209600,"time",["<second>"]],"<year>":[["y","yr","year","years","annum"],31556926,"time",["<second>"]],"<decade>":[["decade","decades"],315569260,"time",["<second>"]],"<century>":[["century","centuries"],3155692600,"time",["<second>"]],"<pascal>":[["Pa","pascal","Pascal"],1,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<bar>":[["bar","bars"],1e5,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<mmHg>":[["mmHg"],133.322368,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<inHg>":[["inHg"],3386.3881472,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<torr>":[["torr"],133.322368,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<atm>":[["atm","ATM","atmosphere","atmospheres"],101325,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<psi>":[["psi"],6894.76,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<cmh2o>":[["cmH2O","cmh2o"],98.0638,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<inh2o>":[["inH2O","inh2o"],249.082052,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<poise>":[["P","poise"],.1,"viscosity",["<kilogram>"],["<meter>","<second>"]],"<stokes>":[["St","stokes"],1e-4,"viscosity",["<meter>","<meter>"],["<second>"]],"<mole>":[["mol","mole"],1,"substance",["<mole>"]],"<molar>":[["M","molar"],1e3,"molar_concentration",["<mole>"],["<meter>","<meter>","<meter>"]],"<wtpercent>":[["wt%","wtpercent"],10,"molar_concentration",["<kilogram>"],["<meter>","<meter>","<meter>"]],"<katal>":[["kat","katal","Katal"],1,"activity",["<mole>"],["<second>"]],"<unit>":[["U","enzUnit","unit"],16667e-19,"activity",["<mole>"],["<second>"]],"<farad>":[["F","farad","Farad"],1,"capacitance",["<second>","<second>","<second>","<second>","<ampere>","<ampere>"],["<meter>","<meter>","<kilogram>"]],"<coulomb>":[["C","coulomb","Coulomb"],1,"charge",["<ampere>","<second>"]],"<Ah>":[["Ah"],3600,"charge",["<ampere>","<second>"]],"<ampere>":[["A","Ampere","ampere","amp","amps"],1,"current",["<ampere>"]],"<siemens>":[["S","Siemens","siemens"],1,"conductance",["<second>","<second>","<second>","<ampere>","<ampere>"],["<kilogram>","<meter>","<meter>"]],"<henry>":[["H","Henry","henry"],1,"inductance",["<meter>","<meter>","<kilogram>"],["<second>","<second>","<ampere>","<ampere>"]],"<volt>":[["V","Volt","volt","volts"],1,"potential",["<meter>","<meter>","<kilogram>"],["<second>","<second>","<second>","<ampere>"]],"<ohm>":[["Ohm","ohm","",""],1,"resistance",["<meter>","<meter>","<kilogram>"],["<second>","<second>","<second>","<ampere>","<ampere>"]],"<weber>":[["Wb","weber","webers"],1,"magnetism",["<meter>","<meter>","<kilogram>"],["<second>","<second>","<ampere>"]],"<tesla>":[["T","tesla","teslas"],1,"magnetism",["<kilogram>"],["<second>","<second>","<ampere>"]],"<gauss>":[["G","gauss"],1e-4,"magnetism",["<kilogram>"],["<second>","<second>","<ampere>"]],"<maxwell>":[["Mx","maxwell","maxwells"],1e-8,"magnetism",["<meter>","<meter>","<kilogram>"],["<second>","<second>","<ampere>"]],"<oersted>":[["Oe","oersted","oersteds"],250/Math.PI,"magnetism",["<ampere>"],["<meter>"]],"<joule>":[["J","joule","Joule","joules","Joules"],1,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<erg>":[["erg","ergs"],1e-7,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<btu>":[["BTU","btu","BTUs"],1055.056,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<calorie>":[["cal","calorie","calories"],4.184,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<Calorie>":[["Cal","Calorie","Calories"],4184,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<therm-US>":[["th","therm","therms","Therm","therm-US"],105480400,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<Wh>":[["Wh"],3600,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<electronvolt>":[["eV","electronvolt","electronvolts"],1602176634e-28,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<newton>":[["N","Newton","newton"],1,"force",["<kilogram>","<meter>"],["<second>","<second>"]],"<dyne>":[["dyn","dyne"],1e-5,"force",["<kilogram>","<meter>"],["<second>","<second>"]],"<pound-force>":[["lbf","pound-force"],4.448222,"force",["<kilogram>","<meter>"],["<second>","<second>"]],"<hertz>":[["Hz","hertz","Hertz"],1,"frequency",["<1>"],["<second>"]],"<radian>":[["rad","radian","radians"],1,"angle",["<radian>"]],"<degree>":[["deg","degree","degrees"],Math.PI/180,"angle",["<radian>"]],"<arcminute>":[["arcmin","arcminute","arcminutes"],Math.PI/10800,"angle",["<radian>"]],"<arcsecond>":[["arcsec","arcsecond","arcseconds"],Math.PI/648e3,"angle",["<radian>"]],"<gradian>":[["gon","grad","gradian","grads"],Math.PI/200,"angle",["<radian>"]],"<steradian>":[["sr","steradian","steradians"],1,"solid_angle",["<steradian>"]],"<rotation>":[["rotation"],2*Math.PI,"angle",["<radian>"]],"<rpm>":[["rpm"],2*Math.PI/60,"angular_velocity",["<radian>"],["<second>"]],"<byte>":[["B","byte","bytes"],1,"information",["<byte>"]],"<bit>":[["b","bit","bits"],.125,"information",["<byte>"]],"<Bps>":[["Bps"],1,"information_rate",["<byte>"],["<second>"]],"<bps>":[["bps"],.125,"information_rate",["<byte>"],["<second>"]],"<dollar>":[["USD","dollar"],1,"currency",["<dollar>"]],"<cents>":[["cents"],.01,"currency",["<dollar>"]],"<candela>":[["cd","candela"],1,"luminosity",["<candela>"]],"<lumen>":[["lm","lumen"],1,"luminous_power",["<candela>","<steradian>"]],"<lux>":[["lux"],1,"illuminance",["<candela>","<steradian>"],["<meter>","<meter>"]],"<watt>":[["W","watt","watts"],1,"power",["<kilogram>","<meter>","<meter>"],["<second>","<second>","<second>"]],"<volt-ampere>":[["VA","volt-ampere"],1,"power",["<kilogram>","<meter>","<meter>"],["<second>","<second>","<second>"]],"<volt-ampere-reactive>":[["var","Var","VAr","VAR","volt-ampere-reactive"],1,"power",["<kilogram>","<meter>","<meter>"],["<second>","<second>","<second>"]],"<horsepower>":[["hp","horsepower"],745.699872,"power",["<kilogram>","<meter>","<meter>"],["<second>","<second>","<second>"]],"<gray>":[["Gy","gray","grays"],1,"radiation",["<meter>","<meter>"],["<second>","<second>"]],"<roentgen>":[["R","roentgen"],.00933,"radiation",["<meter>","<meter>"],["<second>","<second>"]],"<sievert>":[["Sv","sievert","sieverts"],1,"radiation",["<meter>","<meter>"],["<second>","<second>"]],"<becquerel>":[["Bq","becquerel","becquerels"],1,"radiation",["<1>"],["<second>"]],"<curie>":[["Ci","curie","curies"],37e9,"radiation",["<1>"],["<second>"]],"<cpm>":[["cpm"],1/60,"rate",["<count>"],["<second>"]],"<dpm>":[["dpm"],1/60,"rate",["<count>"],["<second>"]],"<bpm>":[["bpm"],1/60,"rate",["<count>"],["<second>"]],"<dot>":[["dot","dots"],1,"resolution",["<each>"]],"<pixel>":[["pixel","px"],1,"resolution",["<each>"]],"<ppi>":[["ppi"],1,"resolution",["<pixel>"],["<inch>"]],"<dpi>":[["dpi"],1,"typography",["<dot>"],["<inch>"]],"<cell>":[["cells","cell"],1,"counting",["<each>"]],"<each>":[["each"],1,"counting",["<each>"]],"<count>":[["count"],1,"counting",["<each>"]],"<base-pair>":[["bp","base-pair"],1,"counting",["<each>"]],"<nucleotide>":[["nt","nucleotide"],1,"counting",["<each>"]],"<molecule>":[["molecule","molecules"],1,"counting",["<1>"]],"<dozen>":[["doz","dz","dozen"],12,"prefix_only",["<each>"]],"<percent>":[["%","percent"],.01,"prefix_only",["<1>"]],"<ppm>":[["ppm"],1e-6,"prefix_only",["<1>"]],"<ppb>":[["ppb"],1e-9,"prefix_only",["<1>"]],"<ppt>":[["ppt"],1e-12,"prefix_only",["<1>"]],"<ppq>":[["ppq"],1e-15,"prefix_only",["<1>"]],"<gross>":[["gr","gross"],144,"prefix_only",["<dozen>","<dozen>"]],"<decibel>":[["dB","decibel","decibels"],1,"logarithmic",["<decibel>"]]},d=["<meter>","<kilogram>","<second>","<mole>","<ampere>","<radian>","<kelvin>","<temp-K>","<byte>","<dollar>","<candela>","<each>","<steradian>","<decibel>"],g="<1>",p=[g];function m(t,e){var i=e[1],r=e[3]||[],s=e[4]||[];if(!n(i))throw new u(t+": Invalid unit definition. 'scalar' must be a number");r.forEach((function(e){if(void 0===f[e])throw new u(t+": Invalid unit definition. Unit "+e+" in 'numerator' is not recognized")})),s.forEach((function(e){if(void 0===f[e])throw new u(t+": Invalid unit definition. Unit "+e+" in 'denominator' is not recognized")}))}var y={},v={},w={},x={},_={};for(var b in f)if(f.hasOwnProperty(b)){var E=f[b];if("prefix"===E[2]){y[b]=E[1];for(var S=0;S<E[0].length;S++)v[E[0][S]]=b}else{m(b,E),w[b]={scalar:E[1],numerator:E[3],denominator:E[4]};for(var I=0;I<E[0].length;I++)x[E[0][I]]=b}_[b]=E[0][0]}var C=["length","time","temperature","mass","current","substance","luminosity","currency","information","angle"];function M(){if(this.signature)return this.signature;for(var t=R.call(this),e=0;e<t.length;e++)t[e]*=Math.pow(20,e);return t.reduce((function(t,e){return t+e}),0)}function R(){if(!this.isBase())return R.call(this.toBase());for(var t,e,n=new Array(C.length),i=0;i<n.length;i++)n[i]=0;for(var r=0;r<this.numerator.length;r++)(t=f[this.numerator[r]])&&(e=C.indexOf(t[2]))>=0&&(n[e]=n[e]+1);for(var s=0;s<this.denominator.length;s++)(t=f[this.denominator[s]])&&(e=C.indexOf(t[2]))>=0&&(n[e]=n[e]-1);return n}var P=new RegExp("^([+-]?\\s*(?:(?:\\d+(?:\\.\\d+)?)|(?:\\.\\d+))(?:[Ee][+-]?\\d+)?)?\\s*([^/]*)(?:/(.+))?$"),T="\\^|\\*{2}",N="[01234]",A=new RegExp("([^ \\*\\d]+?)(?:"+T+")?(-?"+N+"(?![a-zA-Z]))"),k=new RegExp("([^ \\*\\d]+?)(?:"+T+")?("+N+"(?![a-zA-Z]))");function L(e){t(e)||(e=e.toString()),e=e.trim();var n=P.exec(e);if(!n)throw new u(e+": Quantity not recognized");var i=n[1];i?(i=i.replace(/\s/g,""),this.scalar=parseFloat(i)):this.scalar=1;for(var r,s,o,a=n[2],l=n[3];n=A.exec(a);){if(r=parseFloat(n[2]),isNaN(r))throw new u("Unit exponent is not a number");if(0===r&&!D.test(n[1]))throw new u("Unit not recognized");s=n[1]+" ",o="";for(var h=0;h<Math.abs(r);h++)o+=s;r>=0?a=a.replace(n[0],o):(l=l?l+o:o,a=a.replace(n[0],""))}for(;n=k.exec(l);){if(r=parseFloat(n[2]),isNaN(r))throw new u("Unit exponent is not a number");if(0===r&&!D.test(n[1]))throw new u("Unit not recognized");s=n[1]+" ",o="";for(var c=0;c<r;c++)o+=s;l=l.replace(n[0],o)}a&&(this.numerator=G(a.trim())),l&&(this.denominator=G(l.trim()))}var O="("+Object.keys(v).sort((function(t,e){return e.length-t.length})).join("|")+")??("+Object.keys(x).sort((function(t,e){return e.length-t.length})).join("|")+")(?:\\b|$)",D=new RegExp("^\\s*("+O+"[\\s\\*]*)+$"),F=new RegExp(O,"g"),z={};function G(t){var e=z[t];if(e)return e;var n,i=[];if(!D.test(t))throw new u("Unit not recognized");for(;n=F.exec(t);)i.push(n.slice(1));return i=(i=(i=i.map((function(t){return v[t[0]]?[v[t[0]],x[t[1]]]:[x[t[1]]]}))).reduce((function(t,e){return t.concat(e)}),[])).filter((function(t){return t})),z[t]=i,i}function B(t){return t instanceof U}function U(t,e){if(q.apply(null,arguments),!B(this))return new U(t,e);if(this.scalar=null,this.baseScalar=null,this.signature=null,this._conversionCache={},this.numerator=p,this.denominator=p,V(t)?(this.scalar=t.scalar,this.numerator=t.numerator&&0!==t.numerator.length?t.numerator:p,this.denominator=t.denominator&&0!==t.denominator.length?t.denominator:p):e?(L.call(this,e),this.scalar=t):L.call(this,t),this.denominator.join("*").indexOf("temp")>=0)throw new u("Cannot divide with temperatures");if(this.numerator.join("*").indexOf("temp")>=0){if(this.numerator.length>1)throw new u("Cannot multiply by temperatures");if(!r(this.denominator,p))throw new u("Cannot divide with temperatures")}if(this.initValue=t,Y.call(this),this.isTemperature()&&this.baseScalar<0)throw new u("Temperatures must not be less than absolute zero")}function q(e,i){if(i){if(!n(e)||!t(i))throw new u("Only number accepted as initialization value when units are explicitly provided")}else if(!(t(e)||n(e)||B(e)||V(e)))throw new u("Only string, number or quantity accepted as single initialization value")}function V(t){return t&&"object"==typeof t&&t.hasOwnProperty("scalar")}function Y(){if(this.baseScalar)return this.baseScalar;if(this.isBase())this.baseScalar=this.scalar,this.signature=M.call(this);else{var t=this.toBase();this.baseScalar=t.scalar,this.signature=t.signature}}U.prototype={constructor:U};var X={"-312078":"elastance","-312058":"resistance","-312038":"inductance","-152058":"potential","-152040":"magnetism","-152038":"magnetism","-7997":"specific_volume","-79":"snap","-59":"jolt","-39":"acceleration","-38":"radiation","-20":"frequency","-19":"speed","-18":"viscosity","-17":"volumetric_flow","-1":"wavenumber",0:"unitless",1:"length",2:"area",3:"volume",20:"time",400:"temperature",7941:"yank",7942:"power",7959:"pressure",7961:"force",7962:"energy",7979:"viscosity",7981:"momentum",7982:"angular_momentum",7997:"density",7998:"area_density",8e3:"mass",152020:"radiation_exposure",159999:"magnetism",16e4:"current",160020:"charge",312058:"conductance",312078:"capacitance",3199980:"activity",3199997:"molar_concentration",32e5:"substance",63999998:"illuminance",64e6:"luminous_power",128e7:"currency",25599999980:"information_rate",256e8:"information",511999999980:"angular_velocity",512e9:"angle"};function j(t,e){var n=e.to(W(t.units()));return U({scalar:t.scalar+n.scalar,numerator:t.numerator,denominator:t.denominator})}function W(t){if("tempK"===t)return"degK";if("tempC"===t)return"degC";if("tempF"===t)return"degF";if("tempR"===t)return"degR";throw new u("Unknown type for temp conversion from: "+t)}function H(t,e){var n,i=function(t){var e,n=t.units();if(n.match(/(deg)[CFRK]/))e=t.baseScalar;else if("tempK"===n)e=t.scalar;else if("tempC"===n)e=t.scalar;else if("tempF"===n)e=5*t.scalar/9;else{if("tempR"!==n)throw new u("Unknown type for temp conversion from: "+n);e=5*t.scalar/9}return U({scalar:e,numerator:["<kelvin>"],denominator:p})}(t),r=e.units();if("degK"===r)n=i.scalar;else if("degC"===r)n=i.scalar;else if("degF"===r)n=9*i.scalar/5;else{if("degR"!==r)throw new u("Unknown type for degree conversion to: "+r);n=9*i.scalar/5}return U({scalar:n,numerator:e.numerator,denominator:e.denominator})}U.prototype.kind=function(){return X[this.signature.toString()]},s(U.prototype,{isDegrees:function(){return(null===this.signature||400===this.signature)&&1===this.numerator.length&&r(this.denominator,p)&&(this.numerator[0].match(/<temp-[CFRK]>/)||this.numerator[0].match(/<(kelvin|celsius|rankine|fahrenheit)>/))},isTemperature:function(){return this.isDegrees()&&this.numerator[0].match(/<temp-[CFRK]>/)}}),s(U.prototype,{to:function(e){var n,i;return null==e?this:t(e)?(n=this._conversionCache[e])?n:(i=U(e)).units()===this.units()?this:(this.isCompatible(i)?i=i.isTemperature()?function(t,e){var n,i=e.units();if("tempK"===i)n=t.baseScalar;else if("tempC"===i)n=t.baseScalar-273.15;else if("tempF"===i)n=9*t.baseScalar/5-459.67;else{if("tempR"!==i)throw new u("Unknown type for temp conversion to: "+i);n=9*t.baseScalar/5}return U({scalar:n,numerator:e.numerator,denominator:e.denominator})}(this,i):i.isDegrees()?H(this,i):U({scalar:a(this.baseScalar,i.baseScalar),numerator:i.numerator,denominator:i.denominator}):this.isInverse(i)?i=this.inverse().to(e):c(this.units(),i.units()),this._conversionCache[e]=i,i):this.to(e.units())},toBase:function(){if(this.isBase())return this;if(this.isTemperature())return function(t){var e,n=t.units();if(n.match(/(deg)[CFRK]/))e=t.baseScalar;else if("tempK"===n)e=t.scalar;else if("tempC"===n)e=t.scalar+273.15;else if("tempF"===n)e=5*(t.scalar+459.67)/9;else{if("tempR"!==n)throw new u("Unknown type for temp conversion from: "+n);e=5*t.scalar/9}return U({scalar:e,numerator:["<temp-K>"],denominator:p})}(this);var t=$[this.units()];return t||(t=function(t,e){for(var n,i=[],r=[],s=1,a=0;a<t.length;a++)n=t[a],y[n]?s=o(s,y[n]):w[n]&&(s*=w[n].scalar,w[n].numerator&&i.push(w[n].numerator),w[n].denominator&&r.push(w[n].denominator));for(var l=0;l<e.length;l++)n=e[l],y[n]?s/=y[n]:w[n]&&(s/=w[n].scalar,w[n].numerator&&r.push(w[n].numerator),w[n].denominator&&i.push(w[n].denominator));return U({scalar:s,numerator:i=i.reduce((function(t,e){return t.concat(e)}),[]),denominator:r=r.reduce((function(t,e){return t.concat(e)}),[])})}(this.numerator,this.denominator),$[this.units()]=t),t.mul(this.scalar)},toFloat:function(){if(this.isUnitless())return this.scalar;throw new u("Can't convert to Float unless unitless.  Use Unit#scalar")},toPrec:function(e){if(t(e)&&(e=U(e)),n(e)&&(e=U(e+" "+this.units())),this.isUnitless()?e.isUnitless()||c(this.units(),e.units()):e=e.to(this.units()),0===e.scalar)throw new u("Divide by zero");return U(o(Math.round(this.scalar/e.scalar),e.scalar)+this.units())}});var $={};function Z(t,e,n,i){function r(t){return t!==g}t=t.filter(r),n=n.filter(r),e=e.filter(r),i=i.filter(r);var s={};function o(t,e){for(var n,i,r,o=0;o<t.length;o++)if(y[t[o]]?(n=t[o+1],i=t[o],r=y[i],o++):(n=t[o],i=null,r=1),n&&n!==g)if(s[n]){s[n][0]+=e;var l=s[n][2]?y[s[n][2]]:1;s[n][1===e?3:4]*=a(r,l)}else s[n]=[e,n,i,1,1]}o(t,1),o(e,-1),o(n,1),o(i,-1);var l=[],h=[],u=1;for(var c in s)if(s.hasOwnProperty(c)){var f,d=s[c];if(d[0]>0)for(f=0;f<d[0];f++)l.push(null===d[2]?d[1]:[d[2],d[1]]);else if(d[0]<0)for(f=0;f<-d[0];f++)h.push(null===d[2]?d[1]:[d[2],d[1]]);u*=a(d[3],d[4])}return 0===l.length&&(l=p),0===h.length&&(h=p),[l=l.reduce((function(t,e){return t.concat(e)}),[]),h=h.reduce((function(t,e){return t.concat(e)}),[]),u]}function K(){}U.parse=function(e){if(!t(e))throw new u("Argument should be a string");try{return this(e)}catch(t){return null}},U.getUnits=function(t){var e,n=[],i=Object.keys(f);if(void 0===t)for(e=0;e<i.length;e++)-1===["","prefix"].indexOf(f[i[e]][2])&&n.push(i[e].substr(1,i[e].length-2));else{if(-1===this.getKinds().indexOf(t))throw new u("Kind not recognized");for(e=0;e<i.length;e++)f[i[e]][2]===t&&n.push(i[e].substr(1,i[e].length-2))}return n.sort((function(t,e){return t.toLowerCase()<e.toLowerCase()?-1:t.toLowerCase()>e.toLowerCase()?1:0}))},U.getAliases=function(t){if(!x[t])throw new u("Unit not recognized");return f[x[t]][0]},U.mulSafe=o,U.divSafe=a,U.getKinds=function(){return t=Object.keys(X).map((function(t){return X[t]})),e={},t.filter((function(t){return!e.hasOwnProperty(t)&&(e[t]=!0)}));var t,e},U.swiftConverter=function(t,e){var n,r=U(t),s=U(e);return r.eq(s)?i:(n=r.isTemperature()?function(t){return r.mul(t).to(s).scalar}:function(t){return t*r.baseScalar/s.baseScalar},function(t){var e,i,r;if(Array.isArray(t)){for(i=t.length,r=[],e=0;e<i;e++)r.push(n(t[e]));return r}return n(t)})},U.Error=u,s(U.prototype,{add:function(e){if(t(e)&&(e=U(e)),this.isCompatible(e)||c(this.units(),e.units()),this.isTemperature()&&e.isTemperature())throw new u("Cannot add two temperatures");return this.isTemperature()?j(this,e):e.isTemperature()?j(e,this):U({scalar:this.scalar+e.to(this).scalar,numerator:this.numerator,denominator:this.denominator})},sub:function(e){if(t(e)&&(e=U(e)),this.isCompatible(e)||c(this.units(),e.units()),this.isTemperature()&&e.isTemperature())return i=e,r=(n=this).units(),s=i.to(r),o=U(W(r)),U({scalar:n.scalar-s.scalar,numerator:o.numerator,denominator:o.denominator});var n,i,r,s,o,a,l;if(this.isTemperature())return a=this,l=e.to(W(a.units())),U({scalar:a.scalar-l.scalar,numerator:a.numerator,denominator:a.denominator});if(e.isTemperature())throw new u("Cannot subtract a temperature from a differential degree unit");return U({scalar:this.scalar-e.to(this).scalar,numerator:this.numerator,denominator:this.denominator})},mul:function(e){if(n(e))return U({scalar:o(this.scalar,e),numerator:this.numerator,denominator:this.denominator});if(t(e)&&(e=U(e)),(this.isTemperature()||e.isTemperature())&&!this.isUnitless()&&!e.isUnitless())throw new u("Cannot multiply by temperatures");var i=this,r=e;i.isCompatible(r)&&400!==i.signature&&(r=r.to(i));var s=Z(i.numerator,i.denominator,r.numerator,r.denominator);return U({scalar:o(i.scalar,r.scalar,s[2]),numerator:s[0],denominator:s[1]})},div:function(e){if(n(e)){if(0===e)throw new u("Divide by zero");return U({scalar:this.scalar/e,numerator:this.numerator,denominator:this.denominator})}if(t(e)&&(e=U(e)),0===e.scalar)throw new u("Divide by zero");if(e.isTemperature())throw new u("Cannot divide with temperatures");if(this.isTemperature()&&!e.isUnitless())throw new u("Cannot divide with temperatures");var i=this,r=e;i.isCompatible(r)&&400!==i.signature&&(r=r.to(i));var s=Z(i.numerator,i.denominator,r.denominator,r.numerator);return U({scalar:o(i.scalar,s[2])/r.scalar,numerator:s[0],denominator:s[1]})},inverse:function(){if(this.isTemperature())throw new u("Cannot divide with temperatures");if(0===this.scalar)throw new u("Divide by zero");return U({scalar:1/this.scalar,numerator:this.denominator,denominator:this.numerator})}}),s(U.prototype,{eq:function(t){return 0===this.compareTo(t)},lt:function(t){return-1===this.compareTo(t)},lte:function(t){return this.eq(t)||this.lt(t)},gt:function(t){return 1===this.compareTo(t)},gte:function(t){return this.eq(t)||this.gt(t)},compareTo:function(e){return t(e)?this.compareTo(U(e)):(this.isCompatible(e)||c(this.units(),e.units()),this.baseScalar<e.baseScalar?-1:this.baseScalar===e.baseScalar?0:this.baseScalar>e.baseScalar?1:void 0)},same:function(t){return this.scalar===t.scalar&&this.units()===t.units()}}),s(U.prototype,{isUnitless:function(){return[this.numerator,this.denominator].every((function(t){return r(t,p)}))},isCompatible:function(e){return t(e)?this.isCompatible(U(e)):!!B(e)&&void 0!==e.signature&&this.signature===e.signature},isInverse:function(t){return this.inverse().isCompatible(t)},isBase:function(){return void 0!==this._isBase?this._isBase:this.isDegrees()&&this.numerator[0].match(/<(kelvin|temp-K)>/)?(this._isBase=!0,this._isBase):(this.numerator.concat(this.denominator).forEach((function(t){t!==g&&-1===d.indexOf(t)&&(this._isBase=!1)}),this),!1===this._isBase||(this._isBase=!0),this._isBase)}}),K.prototype.get=function(t){return arguments.length>1&&(t=Array.apply(null,arguments)),t.reduce((function(e,n,i){if(e){var r=e[n];return i===t.length-1?r?r.data:void 0:r}}),this)},K.prototype.set=function(t,e){return arguments.length>2&&(t=Array.prototype.slice.call(arguments,0,-1),e=arguments[arguments.length-1]),t.reduce((function(n,i,r){var s=n[i];return void 0===s&&(s=n[i]={}),r===t.length-1?(s.data=e,e):s}),this)},U.formatter=function(t,e){return(t+" "+e).trim()},s(U.prototype,{units:function(){if(void 0!==this._units)return this._units;var t=r(this.numerator,p),e=r(this.denominator,p);if(t&&e)return this._units="",this._units;var n=Q(this.numerator),i=Q(this.denominator);return this._units=n+(e?"":"/"+i),this._units},toString:function(e,i){var r;if(n(e))r=this.units(),i=e;else if(t(e))r=e;else if(B(e))return this.toPrec(e).toString(i);var s=this.to(r);return((void 0!==i?l(s.scalar,i):s.scalar)+" "+s.units()).trim()},format:function(t,e){1===arguments.length&&"function"==typeof t&&(e=t,t=void 0),e=e||U.formatter;var n=this.to(t);return e.call(this,n.scalar,n.units())}});var J=new K;function Q(t){var e=J.get(t);return e||(e=r(t,p)?"1":function(t){return t.reduce((function(t,e){var n=t[e];return n||t.push(n=t[e]=[e,0]),n[1]++,t}),[]).map((function(t){return t[0]+(t[1]>1?t[1]:"")}))}(function(t){for(var e,n,i=[],r=0;r<t.length;r++)e=t[r],n=t[r+1],y[e]?(i.push(_[e]+_[n]),r++):i.push(_[e]);return i}(t)).join("*"),J.set(t,e),e)}return U.version="1.8.0",U}()},8098:function(t,e){!function(t){"use strict";function e(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}function n(){}function i(){}function r(){}function s(){}function o(){}function a(){}function l(){}function h(t){this.message=t}function u(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t}function c(){if(0===arguments.length)h.call(this);else if(1===arguments.length){var t=arguments[0];h.call(this,t)}}function f(){}function d(){if(this.x=null,this.y=null,this.z=null,0===arguments.length)d.call(this,0,0);else if(1===arguments.length){var t=arguments[0];d.call(this,t.x,t.y,t.z)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];d.call(this,e,n,d.NULL_ORDINATE)}else if(3===arguments.length){var i=arguments[0],r=arguments[1],s=arguments[2];this.x=i,this.y=r,this.z=s}}function g(){if(this.dimensionsToTest=2,0===arguments.length)g.call(this,2);else if(1===arguments.length){var t=arguments[0];if(2!==t&&3!==t)throw new i("only 2 or 3 dimensions may be specified");this.dimensionsToTest=t}}function p(){}function m(){}function y(t){this.message=t||""}function v(){}function w(t){this.message=t||""}function x(t){this.message=t||""}function _(){this.array_=[],arguments[0]instanceof m&&this.addAll(arguments[0])}function b(){if(_.apply(this),0===arguments.length);else if(1===arguments.length){var t=arguments[0];this.ensureCapacity(t.length),this.add(t,!0)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.ensureCapacity(e.length),this.add(e,n)}}function E(){if(this.minx=null,this.maxx=null,this.miny=null,this.maxy=null,0===arguments.length)this.init();else if(1===arguments.length){if(arguments[0]instanceof d){var t=arguments[0];this.init(t.x,t.x,t.y,t.y)}else if(arguments[0]instanceof E){var e=arguments[0];this.init(e)}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];this.init(n.x,i.x,n.y,i.y)}else if(4===arguments.length){var r=arguments[0],s=arguments[1],o=arguments[2],a=arguments[3];this.init(r,s,o,a)}}function S(){}function I(){S.call(this,"Projective point not representable on the Cartesian plane.")}function C(){}function M(t,e){return t.interfaces_&&t.interfaces_().indexOf(e)>-1}function R(){}function P(t){this.str=t}function T(t){this.value=t}function N(){}function A(){if(this.hi=0,this.lo=0,0===arguments.length)this.init(0);else if(1===arguments.length){if("number"==typeof arguments[0]){var t=arguments[0];this.init(t)}else if(arguments[0]instanceof A){var e=arguments[0];this.init(e)}else if("string"==typeof arguments[0]){var n=arguments[0];A.call(this,A.parse(n))}}else if(2===arguments.length){var i=arguments[0],r=arguments[1];this.init(i,r)}}function k(){}function L(){}function O(){}function D(){if(this.x=null,this.y=null,this.w=null,0===arguments.length)this.x=0,this.y=0,this.w=1;else if(1===arguments.length){var t=arguments[0];this.x=t.x,this.y=t.y,this.w=1}else if(2===arguments.length){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var e=arguments[0],n=arguments[1];this.x=e,this.y=n,this.w=1}else if(arguments[0]instanceof D&&arguments[1]instanceof D){var i=arguments[0],r=arguments[1];this.x=i.y*r.w-r.y*i.w,this.y=r.x*i.w-i.x*r.w,this.w=i.x*r.y-r.x*i.y}else if(arguments[0]instanceof d&&arguments[1]instanceof d){var s=arguments[0],o=arguments[1];this.x=s.y-o.y,this.y=o.x-s.x,this.w=s.x*o.y-o.x*s.y}}else if(3===arguments.length){var a=arguments[0],l=arguments[1],h=arguments[2];this.x=a,this.y=l,this.w=h}else if(4===arguments.length){var u=arguments[0],c=arguments[1],f=arguments[2],g=arguments[3],p=u.y-c.y,m=c.x-u.x,y=u.x*c.y-c.x*u.y,v=f.y-g.y,w=g.x-f.x,x=f.x*g.y-g.x*f.y;this.x=m*x-w*y,this.y=v*y-p*x,this.w=p*w-v*m}}function F(){}function z(){}function G(){this.envelope=null,this.factory=null,this.SRID=null,this.userData=null;var t=arguments[0];this.factory=t,this.SRID=t.getSRID()}function B(){}function U(){}function q(){}function V(){}function Y(){}function X(){}function j(){}function W(){}function H(){}function $(){}function Z(){}function K(){}function J(){this.array_=[],arguments[0]instanceof m&&this.addAll(arguments[0])}function Q(t){return null==t?Bs:t.color}function tt(t){return null==t?null:t.parent}function et(t,e){null!==t&&(t.color=e)}function nt(t){return null==t?null:t.left}function it(t){return null==t?null:t.right}function rt(){this.root_=null,this.size_=0}function st(){}function ot(){}function at(){this.array_=[],arguments[0]instanceof m&&this.addAll(arguments[0])}function lt(){}function ht(){}function ut(){}function ct(){}function ft(){this.geometries=null;var t=arguments[0],e=arguments[1];if(G.call(this,e),null===t&&(t=[]),G.hasNullElements(t))throw new i("geometries must not contain null elements");this.geometries=t}function dt(){var t=arguments[0],e=arguments[1];ft.call(this,t,e)}function gt(){if(this.geom=null,this.geomFact=null,this.bnRule=null,this.endpointMap=null,1===arguments.length){var t=arguments[0];gt.call(this,t,U.MOD2_BOUNDARY_RULE)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.geom=e,this.geomFact=e.getFactory(),this.bnRule=n}}function pt(){this.count=null}function mt(){}function yt(){}function vt(){}function wt(){}function xt(){}function _t(){}function bt(){}function Et(){this.points=null;var t=arguments[0],e=arguments[1];G.call(this,e),this.init(t)}function St(){}function It(){this.coordinates=null;var t=arguments[0],e=arguments[1];G.call(this,e),this.init(t)}function Ct(){}function Mt(){this.shell=null,this.holes=null;var t=arguments[0],e=arguments[1],n=arguments[2];if(G.call(this,n),null===t&&(t=this.getFactory().createLinearRing()),null===e&&(e=[]),G.hasNullElements(e))throw new i("holes must not contain null elements");if(t.isEmpty()&&G.hasNonEmptyElements(e))throw new i("shell is empty but holes are not");this.shell=t,this.holes=e}function Rt(){var t=arguments[0],e=arguments[1];ft.call(this,t,e)}function Pt(){if(arguments[0]instanceof d&&arguments[1]instanceof jt){var t=arguments[0],e=arguments[1];Pt.call(this,e.getCoordinateSequenceFactory().create(t),e)}else if(M(arguments[0],L)&&arguments[1]instanceof jt){var n=arguments[0],i=arguments[1];Et.call(this,n,i),this.validateConstruction()}}function Tt(){var t=arguments[0],e=arguments[1];ft.call(this,t,e)}function Nt(){if(this.factory=null,this.isUserDataCopied=!1,0===arguments.length);else if(1===arguments.length){var t=arguments[0];this.factory=t}}function At(){}function kt(){}function Lt(){}function Ot(){}function Dt(){if(this.dimension=3,this.coordinates=null,1===arguments.length){if(arguments[0]instanceof Array){var t=arguments[0];Dt.call(this,t,3)}else if(Number.isInteger(arguments[0])){var e=arguments[0];this.coordinates=new Array(e).fill(null);for(var n=0;e>n;n++)this.coordinates[n]=new d}else if(M(arguments[0],L)){var i=arguments[0];if(null===i)return this.coordinates=new Array(0).fill(null),null;for(this.dimension=i.getDimension(),this.coordinates=new Array(i.size()).fill(null),n=0;n<this.coordinates.length;n++)this.coordinates[n]=i.getCoordinateCopy(n)}}else if(2===arguments.length)if(arguments[0]instanceof Array&&Number.isInteger(arguments[1])){var r=arguments[0],s=arguments[1];this.coordinates=r,this.dimension=s,null===r&&(this.coordinates=new Array(0).fill(null))}else if(Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var o=arguments[0],a=arguments[1];for(this.coordinates=new Array(o).fill(null),this.dimension=a,n=0;o>n;n++)this.coordinates[n]=new d}}function Ft(){}function zt(t,e){return t===e||t!=t&&e!=e}function Gt(t){this.add?t.forEach(this.add,this):t.forEach((function(t){this.set(t[0],t[1])}),this)}function Bt(t,e){if(this.objectOnly&&e!==Object(e))throw new TypeError("Invalid value used as weak collection key");if(e!=e||0===e)for(qs=t.length;qs--&&!zt(t[qs],e););else qs=t.indexOf(e);return qs>-1}function Ut(t,e,n){var i=[0],r=!1;return t.push(i),{next:function(){var s,o=i[0];return!r&&o<e.length?(s=n?[e[o],n[o]]:e[o],i[0]++):(r=!0,t.splice(t.indexOf(i),1)),{done:r,value:s}}}}function qt(){return this._values.length}function Vt(){this.map_=new Xs}function Yt(){if(this.modelType=null,this.scale=null,0===arguments.length)this.modelType=Yt.FLOATING;else if(1===arguments.length)if(arguments[0]instanceof Xt){var t=arguments[0];this.modelType=t,t===Yt.FIXED&&this.setScale(1)}else if("number"==typeof arguments[0]){var e=arguments[0];this.modelType=Yt.FIXED,this.setScale(e)}else if(arguments[0]instanceof Yt){var n=arguments[0];this.modelType=n.modelType,this.scale=n.scale}}function Xt(){this.name=null;var t=arguments[0];this.name=t,Xt.nameToTypeMap.put(t,this)}function jt(){if(this.precisionModel=null,this.coordinateSequenceFactory=null,this.SRID=null,0===arguments.length)jt.call(this,new Yt,0);else if(1===arguments.length){if(M(arguments[0],F)){var t=arguments[0];jt.call(this,new Yt,0,t)}else if(arguments[0]instanceof Yt){var e=arguments[0];jt.call(this,e,0,jt.getDefaultCoordinateSequenceFactory())}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];jt.call(this,n,i,jt.getDefaultCoordinateSequenceFactory())}else if(3===arguments.length){var r=arguments[0],s=arguments[1],o=arguments[2];this.precisionModel=r,this.coordinateSequenceFactory=o,this.SRID=s}}function Wt(t){this.geometryFactory=t||new jt}function Ht(t){this.parser=new Wt(t)}function $t(){this.result=null,this.inputLines=Array(2).fill().map((function(){return Array(2)})),this.intPt=new Array(2).fill(null),this.intLineIndex=null,this._isProper=null,this.pa=null,this.pb=null,this.precisionModel=null,this.intPt[0]=new d,this.intPt[1]=new d,this.pa=this.intPt[0],this.pb=this.intPt[1],this.result=0}function Zt(){$t.apply(this)}function Kt(){}function Jt(){this.p=null,this.crossingCount=0,this.isPointOnSegment=!1;var t=arguments[0];this.p=t}function Qt(){}function te(){if(this.p0=null,this.p1=null,0===arguments.length)te.call(this,new d,new d);else if(1===arguments.length){var t=arguments[0];te.call(this,t.p0,t.p1)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.p0=e,this.p1=n}else if(4===arguments.length){var i=arguments[0],r=arguments[1],s=arguments[2],o=arguments[3];te.call(this,new d(i,r),new d(s,o))}}function ee(){if(this.matrix=null,0===arguments.length)this.matrix=Array(3).fill().map((function(){return Array(3)})),this.setAll(ht.FALSE);else if(1===arguments.length)if("string"==typeof arguments[0]){var t=arguments[0];ee.call(this),this.set(t)}else if(arguments[0]instanceof ee){var e=arguments[0];ee.call(this),this.matrix[C.INTERIOR][C.INTERIOR]=e.matrix[C.INTERIOR][C.INTERIOR],this.matrix[C.INTERIOR][C.BOUNDARY]=e.matrix[C.INTERIOR][C.BOUNDARY],this.matrix[C.INTERIOR][C.EXTERIOR]=e.matrix[C.INTERIOR][C.EXTERIOR],this.matrix[C.BOUNDARY][C.INTERIOR]=e.matrix[C.BOUNDARY][C.INTERIOR],this.matrix[C.BOUNDARY][C.BOUNDARY]=e.matrix[C.BOUNDARY][C.BOUNDARY],this.matrix[C.BOUNDARY][C.EXTERIOR]=e.matrix[C.BOUNDARY][C.EXTERIOR],this.matrix[C.EXTERIOR][C.INTERIOR]=e.matrix[C.EXTERIOR][C.INTERIOR],this.matrix[C.EXTERIOR][C.BOUNDARY]=e.matrix[C.EXTERIOR][C.BOUNDARY],this.matrix[C.EXTERIOR][C.EXTERIOR]=e.matrix[C.EXTERIOR][C.EXTERIOR]}}function ne(){this.areaBasePt=null,this.triangleCent3=new d,this.areasum2=0,this.cg3=new d,this.lineCentSum=new d,this.totalLength=0,this.ptCount=0,this.ptCentSum=new d;var t=arguments[0];this.areaBasePt=null,this.add(t)}function ie(t){this.message=t||""}function re(){this.array_=[]}function se(){this.treeSet=new at,this.list=new _}function oe(){if(this.geomFactory=null,this.inputPts=null,1===arguments.length){var t=arguments[0];oe.call(this,oe.extractCoordinates(t),t.getFactory())}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.inputPts=se.filterCoordinates(e),this.geomFactory=n}}function ae(){this.origin=null;var t=arguments[0];this.origin=t}function le(){this.inputGeom=null,this.factory=null,this.pruneEmptyGeometry=!0,this.preserveGeometryCollectionType=!0,this.preserveCollections=!1,this.preserveType=!1}function he(){if(this.snapTolerance=0,this.srcPts=null,this.seg=new te,this.allowSnappingToSourceVertices=!1,this._isClosed=!1,arguments[0]instanceof Et&&"number"==typeof arguments[1]){var t=arguments[0],e=arguments[1];he.call(this,t.getCoordinates(),e)}else if(arguments[0]instanceof Array&&"number"==typeof arguments[1]){var n=arguments[0],i=arguments[1];this.srcPts=n,this._isClosed=he.isClosed(n),this.snapTolerance=i}}function ue(){this.srcGeom=null;var t=arguments[0];this.srcGeom=t}function ce(){if(le.apply(this),this.snapTolerance=null,this.snapPts=null,this.isSelfSnap=!1,2===arguments.length){var t=arguments[0],e=arguments[1];this.snapTolerance=t,this.snapPts=e}else if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];this.snapTolerance=n,this.snapPts=i,this.isSelfSnap=r}}function fe(){this.isFirst=!0,this.commonMantissaBitsCount=53,this.commonBits=0,this.commonSignExp=null}function de(){this.commonCoord=null,this.ccFilter=new ge}function ge(){this.commonBitsX=new fe,this.commonBitsY=new fe}function pe(){this.trans=null;var t=arguments[0];this.trans=t}function me(){this.parent=null,this.atStart=null,this.max=null,this.index=null,this.subcollectionIterator=null;var t=arguments[0];this.parent=t,this.atStart=!0,this.index=0,this.max=t.getNumGeometries()}function ye(){if(this.boundaryRule=U.OGC_SFS_BOUNDARY_RULE,this.isIn=null,this.numBoundaries=null,0===arguments.length);else if(1===arguments.length){var t=arguments[0];if(null===t)throw new i("Rule must be non-null");this.boundaryRule=t}}function ve(){}function we(){}function xe(){this.pts=null,this.data=null;var t=arguments[0],e=arguments[1];this.pts=t,this.data=e}function _e(){}function be(){this.bounds=null,this.item=null;var t=arguments[0],e=arguments[1];this.bounds=t,this.item=e}function Ee(){this._size=null,this.items=null,this._size=0,this.items=new _,this.items.add(null)}function Se(){}function Ie(){}function Ce(){if(this.childBoundables=new _,this.bounds=null,this.level=null,0===arguments.length);else if(1===arguments.length){var t=arguments[0];this.level=t}}function Me(){this.boundable1=null,this.boundable2=null,this._distance=null,this.itemDistance=null;var t=arguments[0],e=arguments[1],n=arguments[2];this.boundable1=t,this.boundable2=e,this.itemDistance=n,this._distance=this.distance()}function Re(){if(this.root=null,this.built=!1,this.itemBoundables=new _,this.nodeCapacity=null,0===arguments.length)Re.call(this,Re.DEFAULT_NODE_CAPACITY);else if(1===arguments.length){var t=arguments[0];f.isTrue(t>1,"Node capacity must be greater than 1"),this.nodeCapacity=t}}function Pe(){}function Te(){if(0===arguments.length)Te.call(this,Te.DEFAULT_NODE_CAPACITY);else if(1===arguments.length){var t=arguments[0];Re.call(this,t)}}function Ne(){var t=arguments[0];Ce.call(this,t)}function Ae(){}function ke(){this.segString=null,this.coord=null,this.segmentIndex=null,this.segmentOctant=null,this._isInterior=null;var t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];this.segString=t,this.coord=new d(e),this.segmentIndex=n,this.segmentOctant=i,this._isInterior=!e.equals2D(t.getCoordinate(n))}function Le(){this.nodeMap=new rt,this.edge=null;var t=arguments[0];this.edge=t}function Oe(){this.nodeList=null,this.edge=null,this.nodeIt=null,this.currNode=null,this.nextNode=null,this.currSegIndex=0;var t=arguments[0];this.nodeList=t,this.edge=t.getEdge(),this.nodeIt=t.iterator(),this.readNextNode()}function De(){}function Fe(){this.nodeList=new Le(this),this.pts=null,this.data=null;var t=arguments[0],e=arguments[1];this.pts=t,this.data=e}function ze(){this.tempEnv1=new E,this.tempEnv2=new E,this.overlapSeg1=new te,this.overlapSeg2=new te}function Ge(){this.pts=null,this.start=null,this.end=null,this.env=null,this.context=null,this.id=null;var t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];this.pts=t,this.start=e,this.end=n,this.context=i}function Be(){}function Ue(){}function qe(){}function Ve(){if(this.segInt=null,0===arguments.length);else if(1===arguments.length){var t=arguments[0];this.setSegmentIntersector(t)}}function Ye(){if(this.monoChains=new _,this.index=new Te,this.idCounter=0,this.nodedSegStrings=null,this.nOverlaps=0,0===arguments.length);else if(1===arguments.length){var t=arguments[0];Ve.call(this,t)}}function Xe(){ze.apply(this),this.si=null;var t=arguments[0];this.si=t}function je(){if(this.pt=null,1===arguments.length){var t=arguments[0];h.call(this,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];h.call(this,je.msgWithCoord(e,n)),this.pt=new d(n)}}function We(){}function He(){this.findAllIntersections=!1,this.isCheckEndSegmentsOnly=!1,this.li=null,this.interiorIntersection=null,this.intSegments=null,this.intersections=new _,this.intersectionCount=0,this.keepIntersections=!0;var t=arguments[0];this.li=t,this.interiorIntersection=null}function $e(){this.li=new Zt,this.segStrings=null,this.findAllIntersections=!1,this.segInt=null,this._isValid=!0;var t=arguments[0];this.segStrings=t}function Ze(){this.nv=null;var t=arguments[0];this.nv=new $e(Ze.toSegmentStrings(t))}function Ke(){this.mapOp=null;var t=arguments[0];this.mapOp=t}function Je(){}function Qe(){if(this.location=null,1===arguments.length){if(arguments[0]instanceof Array){var t=arguments[0];this.init(t.length)}else if(Number.isInteger(arguments[0])){var e=arguments[0];this.init(1),this.location[Je.ON]=e}else if(arguments[0]instanceof Qe){var n=arguments[0];if(this.init(n.location.length),null!==n)for(var i=0;i<this.location.length;i++)this.location[i]=n.location[i]}}else if(3===arguments.length){var r=arguments[0],s=arguments[1],o=arguments[2];this.init(3),this.location[Je.ON]=r,this.location[Je.LEFT]=s,this.location[Je.RIGHT]=o}}function tn(){if(this.elt=new Array(2).fill(null),1===arguments.length){if(Number.isInteger(arguments[0])){var t=arguments[0];this.elt[0]=new Qe(t),this.elt[1]=new Qe(t)}else if(arguments[0]instanceof tn){var e=arguments[0];this.elt[0]=new Qe(e.elt[0]),this.elt[1]=new Qe(e.elt[1])}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];this.elt[0]=new Qe(C.NONE),this.elt[1]=new Qe(C.NONE),this.elt[n].setLocation(i)}else if(3===arguments.length){var r=arguments[0],s=arguments[1],o=arguments[2];this.elt[0]=new Qe(r,s,o),this.elt[1]=new Qe(r,s,o)}else if(4===arguments.length){var a=arguments[0],l=arguments[1],h=arguments[2],u=arguments[3];this.elt[0]=new Qe(C.NONE,C.NONE,C.NONE),this.elt[1]=new Qe(C.NONE,C.NONE,C.NONE),this.elt[a].setLocations(l,h,u)}}function en(){this.startDe=null,this.maxNodeDegree=-1,this.edges=new _,this.pts=new _,this.label=new tn(C.NONE),this.ring=null,this._isHole=null,this.shell=null,this.holes=new _,this.geometryFactory=null;var t=arguments[0],e=arguments[1];this.geometryFactory=e,this.computePoints(t),this.computeRing()}function nn(){var t=arguments[0],e=arguments[1];en.call(this,t,e)}function rn(){var t=arguments[0],e=arguments[1];en.call(this,t,e)}function sn(){if(this.label=null,this._isInResult=!1,this._isCovered=!1,this._isCoveredSet=!1,this._isVisited=!1,0===arguments.length);else if(1===arguments.length){var t=arguments[0];this.label=t}}function on(){sn.apply(this),this.coord=null,this.edges=null;var t=arguments[0],e=arguments[1];this.coord=t,this.edges=e,this.label=new tn(0,C.NONE)}function an(){this.nodeMap=new rt,this.nodeFact=null;var t=arguments[0];this.nodeFact=t}function ln(){if(this.edge=null,this.label=null,this.node=null,this.p0=null,this.p1=null,this.dx=null,this.dy=null,this.quadrant=null,1===arguments.length){var t=arguments[0];this.edge=t}else if(3===arguments.length){var e=arguments[0],n=arguments[1],i=arguments[2];ln.call(this,e,n,i,null)}else if(4===arguments.length){var r=arguments[0],s=arguments[1],o=arguments[2],a=arguments[3];ln.call(this,r),this.init(s,o),this.label=a}}function hn(){this._isForward=null,this._isInResult=!1,this._isVisited=!1,this.sym=null,this.next=null,this.nextMin=null,this.edgeRing=null,this.minEdgeRing=null,this.depth=[0,-999,-999];var t=arguments[0],e=arguments[1];if(ln.call(this,t),this._isForward=e,e)this.init(t.getCoordinate(0),t.getCoordinate(1));else{var n=t.getNumPoints()-1;this.init(t.getCoordinate(n),t.getCoordinate(n-1))}this.computeDirectedLabel()}function un(){}function cn(){if(this.edges=new _,this.nodes=null,this.edgeEndList=new _,0===arguments.length)this.nodes=new an(new un);else if(1===arguments.length){var t=arguments[0];this.nodes=new an(t)}}function fn(){this.geometryFactory=null,this.shellList=new _;var t=arguments[0];this.geometryFactory=t}function dn(){this.op=null,this.geometryFactory=null,this.ptLocator=null,this.lineEdgesList=new _,this.resultLineList=new _;var t=arguments[0],e=arguments[1],n=arguments[2];this.op=t,this.geometryFactory=e,this.ptLocator=n}function gn(){this.op=null,this.geometryFactory=null,this.resultPointList=new _;var t=arguments[0],e=arguments[1];this.op=t,this.geometryFactory=e}function pn(){}function mn(){this.geom=null;var t=arguments[0];this.geom=t}function yn(){this.edgeMap=new rt,this.edgeList=null,this.ptInAreaLocation=[C.NONE,C.NONE]}function vn(){yn.apply(this),this.resultAreaEdgeList=null,this.label=null,this.SCANNING_FOR_INCOMING=1,this.LINKING_TO_OUTGOING=2}function wn(){un.apply(this)}function xn(){this.mce=null,this.chainIndex=null;var t=arguments[0],e=arguments[1];this.mce=t,this.chainIndex=e}function _n(){if(this.label=null,this.xValue=null,this.eventType=null,this.insertEvent=null,this.deleteEventIndex=null,this.obj=null,2===arguments.length){var t=arguments[0],e=arguments[1];this.eventType=_n.DELETE,this.xValue=t,this.insertEvent=e}else if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];this.eventType=_n.INSERT,this.label=n,this.xValue=i,this.obj=r}}function bn(){}function En(){this._hasIntersection=!1,this.hasProper=!1,this.hasProperInterior=!1,this.properIntersectionPoint=null,this.li=null,this.includeProper=null,this.recordIsolated=null,this.isSelfIntersection=null,this.numIntersections=0,this.numTests=0,this.bdyNodes=null,this._isDone=!1,this.isDoneWhenProperInt=!1;var t=arguments[0],e=arguments[1],n=arguments[2];this.li=t,this.includeProper=e,this.recordIsolated=n}function Sn(){bn.apply(this),this.events=new _,this.nOverlaps=null}function In(){this.min=r.POSITIVE_INFINITY,this.max=r.NEGATIVE_INFINITY}function Cn(){}function Mn(){In.apply(this),this.item=null;var t=arguments[0],e=arguments[1],n=arguments[2];this.min=t,this.max=e,this.item=n}function Rn(){In.apply(this),this.node1=null,this.node2=null;var t=arguments[0],e=arguments[1];this.node1=t,this.node2=e,this.buildExtent(this.node1,this.node2)}function Pn(){this.leaves=new _,this.root=null,this.level=0}function Tn(){if(this.lines=null,this.isForcedToLineString=!1,1===arguments.length){var t=arguments[0];this.lines=t}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.lines=e,this.isForcedToLineString=n}}function Nn(){this.items=new _}function An(){this.index=null;var t=arguments[0];if(!M(t,Ct))throw new i("Argument must be Polygonal");this.index=new Ln(t)}function kn(){this.counter=null;var t=arguments[0];this.counter=t}function Ln(){this.index=new Pn;var t=arguments[0];this.init(t)}function On(){this.coord=null,this.segmentIndex=null,this.dist=null;var t=arguments[0],e=arguments[1],n=arguments[2];this.coord=new d(t),this.segmentIndex=e,this.dist=n}function Dn(){this.nodeMap=new rt,this.edge=null;var t=arguments[0];this.edge=t}function Fn(){}function zn(){this.e=null,this.pts=null,this.startIndex=null,this.env1=new E,this.env2=new E;var t=arguments[0];this.e=t,this.pts=t.getCoordinates();var e=new Fn;this.startIndex=e.getChainStartIndices(this.pts)}function Gn(){this.depth=Array(2).fill().map((function(){return Array(3)}));for(var t=0;2>t;t++)for(var e=0;3>e;e++)this.depth[t][e]=Gn.NULL_VALUE}function Bn(){if(sn.apply(this),this.pts=null,this.env=null,this.eiList=new Dn(this),this.name=null,this.mce=null,this._isIsolated=!0,this.depth=new Gn,this.depthDelta=0,1===arguments.length){var t=arguments[0];Bn.call(this,t,null)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.pts=e,this.label=n}}function Un(){if(cn.apply(this),this.parentGeom=null,this.lineEdgeMap=new Vt,this.boundaryNodeRule=null,this.useBoundaryDeterminationRule=!0,this.argIndex=null,this.boundaryNodes=null,this._hasTooFewPoints=!1,this.invalidPoint=null,this.areaPtLocator=null,this.ptLocator=new ye,2===arguments.length){var t=arguments[0],e=arguments[1];Un.call(this,t,e,U.OGC_SFS_BOUNDARY_RULE)}else if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];this.argIndex=n,this.parentGeom=i,this.boundaryNodeRule=r,null!==i&&this.add(i)}}function qn(){if(this.li=new Zt,this.resultPrecisionModel=null,this.arg=null,1===arguments.length){var t=arguments[0];this.setComputationPrecision(t.getPrecisionModel()),this.arg=new Array(1).fill(null),this.arg[0]=new Un(0,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];qn.call(this,e,n,U.OGC_SFS_BOUNDARY_RULE)}else if(3===arguments.length){var i=arguments[0],r=arguments[1],s=arguments[2];i.getPrecisionModel().compareTo(r.getPrecisionModel())>=0?this.setComputationPrecision(i.getPrecisionModel()):this.setComputationPrecision(r.getPrecisionModel()),this.arg=new Array(2).fill(null),this.arg[0]=new Un(0,i,s),this.arg[1]=new Un(1,r,s)}}function Vn(){this.pts=null,this._orientation=null;var t=arguments[0];this.pts=t,this._orientation=Vn.orientation(t)}function Yn(){this.edges=new _,this.ocaMap=new rt}function Xn(){this.ptLocator=new ye,this.geomFact=null,this.resultGeom=null,this.graph=null,this.edgeList=new Yn,this.resultPolyList=new _,this.resultLineList=new _,this.resultPointList=new _;var t=arguments[0],e=arguments[1];qn.call(this,t,e),this.graph=new cn(new wn),this.geomFact=t.getFactory()}function jn(){this.geom=new Array(2).fill(null),this.snapTolerance=null,this.cbr=null;var t=arguments[0],e=arguments[1];this.geom[0]=t,this.geom[1]=e,this.computeSnapTolerance()}function Wn(){this.geom=new Array(2).fill(null);var t=arguments[0],e=arguments[1];this.geom[0]=t,this.geom[1]=e}function Hn(){this.factory=null,this.interiorPoint=null,this.maxWidth=0;var t=arguments[0];this.factory=t.getFactory(),this.add(t)}function $n(){this.poly=null,this.centreY=null,this.hiY=r.MAX_VALUE,this.loY=-r.MAX_VALUE;var t=arguments[0];this.poly=t,this.hiY=t.getEnvelopeInternal().getMaxY(),this.loY=t.getEnvelopeInternal().getMinY(),this.centreY=Hn.avg(this.loY,this.hiY)}function Zn(){this.centroid=null,this.minDistance=r.MAX_VALUE,this.interiorPoint=null;var t=arguments[0];this.centroid=t.getCentroid().getCoordinate(),this.addInterior(t),null===this.interiorPoint&&this.addEndpoints(t)}function Kn(){this.centroid=null,this.minDistance=r.MAX_VALUE,this.interiorPoint=null;var t=arguments[0];this.centroid=t.getCentroid().getCoordinate(),this.add(t)}function Jn(){}function Qn(){this.p0=null,this.p1=null,this.p2=null;var t=arguments[0],e=arguments[1],n=arguments[2];this.p0=t,this.p1=e,this.p2=n}function ti(){this.input=null,this.extremalPts=null,this.centre=null,this.radius=0;var t=arguments[0];this.input=t}function ei(){if(this.inputGeom=null,this.isConvex=null,this.convexHullPts=null,this.minBaseSeg=new te,this.minWidthPt=null,this.minPtIndex=null,this.minWidth=0,1===arguments.length){var t=arguments[0];ei.call(this,t,!1)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.inputGeom=e,this.isConvex=n}}function ni(){this.inputGeom=null,this.distanceTolerance=null;var t=arguments[0];this.inputGeom=t}function ii(){le.apply(this),this.distanceTolerance=null;var t=arguments[0];this.distanceTolerance=t}function ri(){this._orig=null,this._sym=null,this._next=null;var t=arguments[0];this._orig=t}function si(){this._isMarked=!1;var t=arguments[0];ri.call(this,t)}function oi(){this.vertexMap=new Vt}function ai(){this._isStart=!1;var t=arguments[0];si.call(this,t)}function li(){oi.apply(this)}function hi(){this.result=null,this.factory=null,this.graph=null,this.lines=new _,this.nodeEdgeStack=new re,this.ringStartEdge=null,this.graph=new li}function ui(){this.items=new _,this.subnode=new Array(4).fill(null)}function ci(){}function fi(){this.pt=new d,this.level=0,this.env=null;var t=arguments[0];this.computeKey(t)}function di(){ui.apply(this),this.env=null,this.centrex=null,this.centrey=null,this.level=null;var t=arguments[0],e=arguments[1];this.env=t,this.level=e,this.centrex=(t.getMinX()+t.getMaxX())/2,this.centrey=(t.getMinY()+t.getMaxY())/2}function gi(){}function pi(){ui.apply(this)}function mi(){this.root=null,this.minExtent=1,this.root=new pi}function yi(t){this.geometryFactory=t||new jt}function vi(t){this.geometryFactory=t||new jt,this.precisionModel=this.geometryFactory.getPrecisionModel(),this.parser=new yi(this.geometryFactory)}function wi(){this.parser=new yi(this.geometryFactory)}function xi(t){this.geometryFactory=t||new jt,this.precisionModel=this.geometryFactory.getPrecisionModel(),this.parser=new Wt(this.geometryFactory)}function _i(t){return[t.x,t.y]}function bi(t){this.geometryFactory=t||new jt}function Ei(){if(this.noder=null,this.scaleFactor=null,this.offsetX=null,this.offsetY=null,this.isScaled=!1,2===arguments.length){var t=arguments[0],e=arguments[1];Ei.call(this,t,e,0,0)}else if(4===arguments.length){var n=arguments[0],i=arguments[1];this.noder=n,this.scaleFactor=i,this.isScaled=!this.isIntegerPrecision()}}function Si(){if(this.inputGeom=null,this.isClosedEndpointsInInterior=!0,this.nonSimpleLocation=null,1===arguments.length){var t=arguments[0];this.inputGeom=t}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.inputGeom=e,this.isClosedEndpointsInInterior=!n.isInBoundary(2)}}function Ii(){this.pt=null,this.isClosed=null,this.degree=null;var t=arguments[0];this.pt=t,this.isClosed=!1,this.degree=0}function Ci(){if(this.quadrantSegments=Ci.DEFAULT_QUADRANT_SEGMENTS,this.endCapStyle=Ci.CAP_ROUND,this.joinStyle=Ci.JOIN_ROUND,this.mitreLimit=Ci.DEFAULT_MITRE_LIMIT,this._isSingleSided=!1,this.simplifyFactor=Ci.DEFAULT_SIMPLIFY_FACTOR,0===arguments.length);else if(1===arguments.length){var t=arguments[0];this.setQuadrantSegments(t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.setQuadrantSegments(e),this.setEndCapStyle(n)}else if(4===arguments.length){var i=arguments[0],r=arguments[1],s=arguments[2],o=arguments[3];this.setQuadrantSegments(i),this.setEndCapStyle(r),this.setJoinStyle(s),this.setMitreLimit(o)}}function Mi(){this.minIndex=-1,this.minCoord=null,this.minDe=null,this.orientedDe=null}function Ri(){this.array_=[]}function Pi(){this.finder=null,this.dirEdgeList=new _,this.nodes=new _,this.rightMostCoord=null,this.env=null,this.finder=new Mi}function Ti(){this.inputLine=null,this.distanceTol=null,this.isDeleted=null,this.angleOrientation=Qt.COUNTERCLOCKWISE;var t=arguments[0];this.inputLine=t}function Ni(){this.ptList=null,this.precisionModel=null,this.minimimVertexDistance=0,this.ptList=new _}function Ai(){this.maxCurveSegmentError=0,this.filletAngleQuantum=null,this.closingSegLengthFactor=1,this.segList=null,this.distance=0,this.precisionModel=null,this.bufParams=null,this.li=null,this.s0=null,this.s1=null,this.s2=null,this.seg0=new te,this.seg1=new te,this.offset0=new te,this.offset1=new te,this.side=0,this._hasNarrowConcaveAngle=!1;var t=arguments[0],e=arguments[1],n=arguments[2];this.precisionModel=t,this.bufParams=e,this.li=new Zt,this.filletAngleQuantum=Math.PI/2/e.getQuadrantSegments(),e.getQuadrantSegments()>=8&&e.getJoinStyle()===Ci.JOIN_ROUND&&(this.closingSegLengthFactor=Ai.MAX_CLOSING_SEG_LEN_FACTOR),this.init(n)}function ki(){this.distance=0,this.precisionModel=null,this.bufParams=null;var t=arguments[0],e=arguments[1];this.precisionModel=t,this.bufParams=e}function Li(){this.subgraphs=null,this.seg=new te,this.cga=new Qt;var t=arguments[0];this.subgraphs=t}function Oi(){this.upwardSeg=null,this.leftDepth=null;var t=arguments[0],e=arguments[1];this.upwardSeg=new te(t),this.leftDepth=e}function Di(){this.inputGeom=null,this.distance=null,this.curveBuilder=null,this.curveList=new _;var t=arguments[0],e=arguments[1],n=arguments[2];this.inputGeom=t,this.distance=e,this.curveBuilder=n}function Fi(){this._hasIntersection=!1,this.hasProper=!1,this.hasProperInterior=!1,this.hasInterior=!1,this.properIntersectionPoint=null,this.li=null,this.isSelfIntersection=null,this.numIntersections=0,this.numInteriorIntersections=0,this.numProperIntersections=0,this.numTests=0;var t=arguments[0];this.li=t}function zi(){this.bufParams=null,this.workingPrecisionModel=null,this.workingNoder=null,this.geomFact=null,this.graph=null,this.edgeList=new Yn;var t=arguments[0];this.bufParams=t}function Gi(){this.li=new Zt,this.segStrings=null;var t=arguments[0];this.segStrings=t}function Bi(){this.li=null,this.pt=null,this.originalPt=null,this.ptScaled=null,this.p0Scaled=null,this.p1Scaled=null,this.scaleFactor=null,this.minx=null,this.maxx=null,this.miny=null,this.maxy=null,this.corner=new Array(4).fill(null),this.safeEnv=null;var t=arguments[0],e=arguments[1],n=arguments[2];if(this.originalPt=t,this.pt=t,this.scaleFactor=e,this.li=n,0>=e)throw new i("Scale factor must be non-zero");1!==e&&(this.pt=new d(this.scale(t.x),this.scale(t.y)),this.p0Scaled=new d,this.p1Scaled=new d),this.initCorners(this.pt)}function Ui(){this.tempEnv1=new E,this.selectedSegment=new te}function qi(){this.index=null;var t=arguments[0];this.index=t}function Vi(){Ui.apply(this),this.hotPixel=null,this.parentEdge=null,this.hotPixelVertexIndex=null,this._isNodeAdded=!1;var t=arguments[0],e=arguments[1],n=arguments[2];this.hotPixel=t,this.parentEdge=e,this.hotPixelVertexIndex=n}function Yi(){this.li=null,this.interiorIntersections=null;var t=arguments[0];this.li=t,this.interiorIntersections=new _}function Xi(){this.pm=null,this.li=null,this.scaleFactor=null,this.noder=null,this.pointSnapper=null,this.nodedSegStrings=null;var t=arguments[0];this.pm=t,this.li=new Zt,this.li.setPrecisionModel(t),this.scaleFactor=t.getScale()}function ji(){if(this.argGeom=null,this.distance=null,this.bufParams=new Ci,this.resultGeometry=null,this.saveException=null,1===arguments.length){var t=arguments[0];this.argGeom=t}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.argGeom=e,this.bufParams=n}}function Wi(){this.comps=null;var t=arguments[0];this.comps=t}function Hi(){if(this.component=null,this.segIndex=null,this.pt=null,2===arguments.length){var t=arguments[0],e=arguments[1];Hi.call(this,t,Hi.INSIDE_AREA,e)}else if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];this.component=n,this.segIndex=i,this.pt=r}}function $i(){this.pts=null;var t=arguments[0];this.pts=t}function Zi(){this.locations=null;var t=arguments[0];this.locations=t}function Ki(){if(this.geom=null,this.terminateDistance=0,this.ptLocator=new ye,this.minDistanceLocation=null,this.minDistance=r.MAX_VALUE,2===arguments.length){var t=arguments[0],e=arguments[1];Ki.call(this,t,e,0)}else if(3===arguments.length){var n=arguments[0],i=arguments[1],s=arguments[2];this.geom=new Array(2).fill(null),this.geom[0]=n,this.geom[1]=i,this.terminateDistance=s}}function Ji(){this.factory=null,this.directedEdges=new _,this.coordinates=null;var t=arguments[0];this.factory=t}function Qi(){this._isMarked=!1,this._isVisited=!1,this.data=null}function tr(){Qi.apply(this),this.parentEdge=null,this.from=null,this.to=null,this.p0=null,this.p1=null,this.sym=null,this.edgeDirection=null,this.quadrant=null,this.angle=null;var t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];this.from=t,this.to=e,this.edgeDirection=i,this.p0=t.getCoordinate(),this.p1=n;var r=this.p1.x-this.p0.x,s=this.p1.y-this.p0.y;this.quadrant=Be.quadrant(r,s),this.angle=Math.atan2(s,r)}function er(){var t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];tr.call(this,t,e,n,i)}function nr(){if(Qi.apply(this),this.dirEdge=null,0===arguments.length);else if(2===arguments.length){var t=arguments[0],e=arguments[1];this.setDirectedEdges(t,e)}}function ir(){this.outEdges=new _,this.sorted=!1}function rr(){if(Qi.apply(this),this.pt=null,this.deStar=null,1===arguments.length){var t=arguments[0];rr.call(this,t,new ir)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.pt=e,this.deStar=n}}function sr(){nr.apply(this),this.line=null;var t=arguments[0];this.line=t}function or(){this.nodeMap=new rt}function ar(){this.edges=new J,this.dirEdges=new J,this.nodeMap=new or}function lr(){ar.apply(this)}function hr(){this.graph=new lr,this.mergedLineStrings=null,this.factory=null,this.edgeStrings=null}function ur(){this.edgeRing=null,this.next=null,this.label=-1;var t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];tr.call(this,t,e,n,i)}function cr(){nr.apply(this),this.line=null;var t=arguments[0];this.line=t}function fr(){this.factory=null,this.deList=new _,this.lowestEdge=null,this.ring=null,this.ringPts=null,this.holes=null,this.shell=null,this._isHole=null,this._isProcessed=!1,this._isIncludedSet=!1,this._isIncluded=!1;var t=arguments[0];this.factory=t}function dr(){}function gr(){ar.apply(this),this.factory=null;var t=arguments[0];this.factory=t}function pr(){if(this.lineStringAdder=new mr(this),this.graph=null,this.dangles=new _,this.cutEdges=new _,this.invalidRingLines=new _,this.holeList=null,this.shellList=null,this.polyList=null,this.isCheckingRingsValid=!0,this.extractOnlyPolygonal=null,this.geomFactory=null,0===arguments.length)pr.call(this,!1);else if(1===arguments.length){var t=arguments[0];this.extractOnlyPolygonal=t}}function mr(){this.p=null;var t=arguments[0];this.p=t}function yr(){}function vr(){if(this.edgeEnds=new _,1===arguments.length){var t=arguments[0];vr.call(this,null,t)}else if(2===arguments.length){var e=arguments[1];ln.call(this,e.getEdge(),e.getCoordinate(),e.getDirectedCoordinate(),new tn(e.getLabel())),this.insert(e)}}function wr(){yn.apply(this)}function xr(){var t=arguments[0],e=arguments[1];on.call(this,t,e)}function _r(){un.apply(this)}function br(){this.li=new Zt,this.ptLocator=new ye,this.arg=null,this.nodes=new an(new _r),this.im=null,this.isolatedEdges=new _,this.invalidPoint=null;var t=arguments[0];this.arg=t}function Er(){this.rectEnv=null;var t=arguments[0];this.rectEnv=t.getEnvelopeInternal()}function Sr(){this.li=new Zt,this.rectEnv=null,this.diagUp0=null,this.diagUp1=null,this.diagDown0=null,this.diagDown1=null;var t=arguments[0];this.rectEnv=t,this.diagUp0=new d(t.getMinX(),t.getMinY()),this.diagUp1=new d(t.getMaxX(),t.getMaxY()),this.diagDown0=new d(t.getMinX(),t.getMaxY()),this.diagDown1=new d(t.getMaxX(),t.getMinY())}function Ir(){this._isDone=!1}function Cr(){this.rectangle=null,this.rectEnv=null;var t=arguments[0];this.rectangle=t,this.rectEnv=t.getEnvelopeInternal()}function Mr(){Ir.apply(this),this.rectEnv=null,this._intersects=!1;var t=arguments[0];this.rectEnv=t}function Rr(){Ir.apply(this),this.rectSeq=null,this.rectEnv=null,this._containsPoint=!1;var t=arguments[0];this.rectSeq=t.getExteriorRing().getCoordinateSequence(),this.rectEnv=t.getEnvelopeInternal()}function Pr(){Ir.apply(this),this.rectEnv=null,this.rectIntersector=null,this.hasIntersection=!1,this.p0=new d,this.p1=new d;var t=arguments[0];this.rectEnv=t.getEnvelopeInternal(),this.rectIntersector=new Sr(this.rectEnv)}function Tr(){if(this._relate=null,2===arguments.length){var t=arguments[0],e=arguments[1];qn.call(this,t,e),this._relate=new br(this.arg)}else if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];qn.call(this,n,i,r),this._relate=new br(this.arg)}}function Nr(){this.geomFactory=null,this.skipEmpty=!1,this.inputGeoms=null;var t=arguments[0];this.geomFactory=Nr.extractFactory(t),this.inputGeoms=t}function Ar(){this.pointGeom=null,this.otherGeom=null,this.geomFact=null;var t=arguments[0],e=arguments[1];this.pointGeom=t,this.otherGeom=e,this.geomFact=e.getFactory()}function kr(){this.sortIndex=-1,this.comps=null;var t=arguments[0],e=arguments[1];this.sortIndex=t,this.comps=e}function Lr(){this.inputPolys=null,this.geomFactory=null;var t=arguments[0];this.inputPolys=t,null===this.inputPolys&&(this.inputPolys=new _)}function Or(){if(this.polygons=new _,this.lines=new _,this.points=new _,this.geomFact=null,1===arguments.length){if(M(arguments[0],m)){var t=arguments[0];this.extract(t)}else if(arguments[0]instanceof G){var e=arguments[0];this.extract(e)}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];this.geomFact=i,this.extract(n)}}function Dr(){this.geometryFactory=new jt,this.geomGraph=null,this.disconnectedRingcoord=null;var t=arguments[0];this.geomGraph=t}function Fr(){this.items=new _,this.subnode=[null,null]}function zr(){if(this.min=null,this.max=null,0===arguments.length)this.min=0,this.max=0;else if(1===arguments.length){var t=arguments[0];this.init(t.min,t.max)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.init(e,n)}}function Gr(){this.pt=0,this.level=0,this.interval=null;var t=arguments[0];this.computeKey(t)}function Br(){Fr.apply(this),this.interval=null,this.centre=null,this.level=null;var t=arguments[0],e=arguments[1];this.interval=t,this.level=e,this.centre=(t.getMin()+t.getMax())/2}function Ur(){Fr.apply(this)}function qr(){this.root=null,this.minExtent=1,this.root=new Ur}function Vr(){}function Yr(){this.ring=null,this.tree=null,this.crossings=0,this.interval=new zr;var t=arguments[0];this.ring=t,this.buildIndex()}function Xr(){Ui.apply(this),this.mcp=null,this.p=null;var t=arguments[0],e=arguments[1];this.mcp=t,this.p=e}function jr(){this.nodes=new an(new _r)}function Wr(){this.li=new Zt,this.geomGraph=null,this.nodeGraph=new jr,this.invalidPoint=null;var t=arguments[0];this.geomGraph=t}function Hr(){this.graph=null,this.rings=new _,this.totalEnv=new E,this.index=null,this.nestedPt=null;var t=arguments[0];this.graph=t}function $r(){if(this.errorType=null,this.pt=null,1===arguments.length){var t=arguments[0];$r.call(this,t,null)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.errorType=e,null!==n&&(this.pt=n.copy())}}function Zr(){this.parentGeometry=null,this.isSelfTouchingRingFormingHoleValid=!1,this.validErr=null;var t=arguments[0];this.parentGeometry=t}function Kr(){Nt.CoordinateOperation.apply(this),this.targetPM=null,this.removeCollapsed=!0;var t=arguments[0],e=arguments[1];this.targetPM=t,this.removeCollapsed=e}function Jr(){this.targetPM=null,this.removeCollapsed=!0,this.changePrecisionModel=!1,this.isPointwise=!1;var t=arguments[0];this.targetPM=t}function Qr(){this.pts=null,this.usePt=null,this.distanceTolerance=null,this.seg=new te;var t=arguments[0];this.pts=t}function ts(){this.inputGeom=null,this.distanceTolerance=null,this.isEnsureValidTopology=!0;var t=arguments[0];this.inputGeom=t}function es(){le.apply(this),this.isEnsureValidTopology=!0,this.distanceTolerance=null;var t=arguments[0],e=arguments[1];this.isEnsureValidTopology=t,this.distanceTolerance=e}function ns(){if(this.parent=null,this.index=null,2===arguments.length){var t=arguments[0],e=arguments[1];ns.call(this,t,e,null,-1)}else if(4===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2],s=arguments[3];te.call(this,n,i),this.parent=r,this.index=s}}function is(){if(this.parentLine=null,this.segs=null,this.resultSegs=new _,this.minimumSize=null,1===arguments.length){var t=arguments[0];is.call(this,t,2)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.parentLine=e,this.minimumSize=n,this.init()}}function rs(){this.index=new mi}function ss(){this.querySeg=null,this.items=new _;var t=arguments[0];this.querySeg=t}function os(){this.li=new Zt,this.inputIndex=new rs,this.outputIndex=new rs,this.line=null,this.linePts=null,this.distanceTolerance=0;var t=arguments[0],e=arguments[1];this.inputIndex=t,this.outputIndex=e}function as(){this.inputIndex=new rs,this.outputIndex=new rs,this.distanceTolerance=0}function ls(){this.inputGeom=null,this.lineSimplifier=new as,this.linestringMap=null;var t=arguments[0];this.inputGeom=t}function hs(){le.apply(this),this.linestringMap=null;var t=arguments[0];this.linestringMap=t}function us(){this.tps=null;var t=arguments[0];this.tps=t}function cs(){this.seg=null,this.segLen=null,this.splitPt=null,this.minimumLen=0;var t=arguments[0];this.seg=t,this.segLen=t.getLength()}function fs(){}function ds(){}function gs(){}function ps(){if(this.p=null,1===arguments.length){var t=arguments[0];this.p=new d(t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.p=new d(e,n)}else if(3===arguments.length){var i=arguments[0],r=arguments[1],s=arguments[2];this.p=new d(i,r,s)}}function ms(){this._isOnConstraint=null,this.constraint=null;var t=arguments[0];ps.call(this,t)}function ys(){this._rot=null,this.vertex=null,this.next=null,this.data=null}function vs(){this.subdiv=null,this.isUsingTolerance=!1;var t=arguments[0];this.subdiv=t,this.isUsingTolerance=t.getTolerance()>0}function ws(){}function xs(){this.subdiv=null,this.lastEdge=null;var t=arguments[0];this.subdiv=t,this.init()}function _s(){if(this.seg=null,1===arguments.length){if("string"==typeof arguments[0]){var t=arguments[0];h.call(this,t)}else if(arguments[0]instanceof te){var e=arguments[0];h.call(this,"Locate failed to converge (at edge: "+e+").  Possible causes include invalid Subdivision topology or very close sites"),this.seg=new te(e)}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];h.call(this,_s.msgWithSpatial(n,i)),this.seg=new te(i)}}function bs(){}function Es(){this.visitedKey=0,this.quadEdges=new _,this.startingEdge=null,this.tolerance=null,this.edgeCoincidenceTolerance=null,this.frameVertex=new Array(3).fill(null),this.frameEnv=null,this.locator=null,this.seg=new te,this.triEdges=new Array(3).fill(null);var t=arguments[0],e=arguments[1];this.tolerance=e,this.edgeCoincidenceTolerance=e/Es.EDGE_COINCIDENCE_TOL_FACTOR,this.createFrame(t),this.startingEdge=this.initSubdiv(),this.locator=new xs(this)}function Ss(){}function Is(){this.triList=new _}function Cs(){this.triList=new _}function Ms(){this.coordList=new b,this.triCoords=new _}function Rs(){if(this.ls=null,this.data=null,2===arguments.length){var t=arguments[0],e=arguments[1];this.ls=new te(t,e)}else if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];this.ls=new te(n,i),this.data=r}else if(6===arguments.length){var s=arguments[0],o=arguments[1],a=arguments[2],l=arguments[3],h=arguments[4],u=arguments[5];Rs.call(this,new d(s,o,a),new d(l,h,u))}else if(7===arguments.length){var c=arguments[0],f=arguments[1],g=arguments[2],p=arguments[3],m=arguments[4],y=arguments[5],v=arguments[6];Rs.call(this,new d(c,f,g),new d(p,m,y),v)}}function Ps(){}function Ts(){if(this.p=null,this.data=null,this.left=null,this.right=null,this.count=null,2===arguments.length){var t=arguments[0],e=arguments[1];this.p=new d(t),this.left=null,this.right=null,this.count=1,this.data=e}else if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];this.p=new d(n,i),this.left=null,this.right=null,this.count=1,this.data=r}}function Ns(){if(this.root=null,this.numberOfNodes=null,this.tolerance=null,0===arguments.length)Ns.call(this,0);else if(1===arguments.length){var t=arguments[0];this.tolerance=t}}function As(){this.tolerance=null,this.matchNode=null,this.matchDist=0,this.p=null;var t=arguments[0],e=arguments[1];this.p=t,this.tolerance=e}function ks(){this.initialVertices=null,this.segVertices=null,this.segments=new _,this.subdiv=null,this.incDel=null,this.convexHull=null,this.splitFinder=new ds,this.kdt=null,this.vertexFactory=null,this.computeAreaEnv=null,this.splitPt=null,this.tolerance=null;var t=arguments[0],e=arguments[1];this.initialVertices=new _(t),this.tolerance=e,this.kdt=new Ns(e)}function Ls(){this.siteCoords=null,this.tolerance=0,this.subdiv=null}function Os(){this.siteCoords=null,this.constraintLines=null,this.tolerance=0,this.subdiv=null,this.constraintVertexMap=new rt}function Ds(){this.siteCoords=null,this.tolerance=0,this.subdiv=null,this.clipEnv=null,this.diagramEnv=null}function Fs(){}Array.prototype.fill||(Array.prototype.fill=function(t){for(var e=Object(this),n=parseInt(e.length,10),i=parseInt(arguments[1],10)||0,r=0>i?Math.max(n+i,0):Math.min(i,n),s=arguments[2],o=void 0===s?n:parseInt(s,10)||0,a=0>o?Math.max(n+o,0):Math.min(o,n);a>r;r++)e[r]=t;return e}),Number.isFinite=Number.isFinite||function(t){return"number"==typeof t&&isFinite(t)},Number.isInteger=Number.isInteger||function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t},Number.parseFloat=Number.parseFloat||parseFloat,Number.isNaN=Number.isNaN||function(t){return t!=t},Math.trunc=Math.trunc||function(t){return 0>t?Math.ceil(t):Math.floor(t)},e(n.prototype,{interfaces_:function(){return[]},getClass:function(){return n}}),n.equalsWithTolerance=function(t,e,n){return Math.abs(t-e)<=n},r.isNaN=function(t){return Number.isNaN(t)},r.doubleToLongBits=function(t){return t},r.longBitsToDouble=function(t){return t},r.isInfinite=function(t){return!Number.isFinite(t)},r.MAX_VALUE=Number.MAX_VALUE,u(c,h),e(c.prototype,{interfaces_:function(){return[]},getClass:function(){return c}}),e(f.prototype,{interfaces_:function(){return[]},getClass:function(){return f}}),f.shouldNeverReachHere=function(){if(0===arguments.length)f.shouldNeverReachHere(null);else if(1===arguments.length){var t=arguments[0];throw new c("Should never reach here"+(null!==t?": "+t:""))}},f.isTrue=function(){if(1===arguments.length){var t=arguments[0];f.isTrue(t,null)}else if(2===arguments.length){var e=arguments[1];if(!arguments[0])throw null===e?new c:new c(e)}},f.equals=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];f.equals(t,e,null)}else if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];if(!i.equals(n))throw new c("Expected "+n+" but encountered "+i+(null!==r?": "+r:""))}},e(d.prototype,{setOrdinate:function(t,e){switch(t){case d.X:this.x=e;break;case d.Y:this.y=e;break;case d.Z:this.z=e;break;default:throw new i("Invalid ordinate index: "+t)}},equals2D:function(){if(1===arguments.length){var t=arguments[0];return this.x===t.x&&this.y===t.y}if(2===arguments.length){var e=arguments[0],i=arguments[1];return!!n.equalsWithTolerance(this.x,e.x,i)&&!!n.equalsWithTolerance(this.y,e.y,i)}},getOrdinate:function(t){switch(t){case d.X:return this.x;case d.Y:return this.y;case d.Z:return this.z}throw new i("Invalid ordinate index: "+t)},equals3D:function(t){return this.x===t.x&&this.y===t.y&&(this.z===t.z||r.isNaN(this.z)&&r.isNaN(t.z))},equals:function(t){return t instanceof d&&this.equals2D(t)},equalInZ:function(t,e){return n.equalsWithTolerance(this.z,t.z,e)},compareTo:function(t){var e=t;return this.x<e.x?-1:this.x>e.x?1:this.y<e.y?-1:this.y>e.y?1:0},clone:function(){try{var t;return null}catch(t){if(t instanceof CloneNotSupportedException)return f.shouldNeverReachHere("this shouldn't happen because this class is Cloneable"),null;throw t}},copy:function(){return new d(this)},toString:function(){return"("+this.x+", "+this.y+", "+this.z+")"},distance3D:function(t){var e=this.x-t.x,n=this.y-t.y,i=this.z-t.z;return Math.sqrt(e*e+n*n+i*i)},distance:function(t){var e=this.x-t.x,n=this.y-t.y;return Math.sqrt(e*e+n*n)},hashCode:function(){var t=17;return 37*(t=37*t+d.hashCode(this.x))+d.hashCode(this.y)},setCoordinate:function(t){this.x=t.x,this.y=t.y,this.z=t.z},interfaces_:function(){return[s,o,l]},getClass:function(){return d}}),d.hashCode=function(){if(1===arguments.length){var t=arguments[0],e=r.doubleToLongBits(t);return Math.trunc(e^e>>>32)}},e(g.prototype,{compare:function(t,e){var n=t,i=e,r=g.compare(n.x,i.x);if(0!==r)return r;var s=g.compare(n.y,i.y);return 0!==s?s:this.dimensionsToTest<=2?0:g.compare(n.z,i.z)},interfaces_:function(){return[a]},getClass:function(){return g}}),g.compare=function(t,e){return e>t?-1:t>e?1:r.isNaN(t)?r.isNaN(e)?0:-1:r.isNaN(e)?1:0},d.DimensionalComparator=g,d.serialVersionUID=0x5cbf2c235c7e5800,d.NULL_ORDINATE=r.NaN,d.X=0,d.Y=1,d.Z=2,p.prototype.hasNext=function(){},p.prototype.next=function(){},p.prototype.remove=function(){},m.prototype.add=function(){},m.prototype.addAll=function(){},m.prototype.isEmpty=function(){},m.prototype.iterator=function(){},m.prototype.size=function(){},m.prototype.toArray=function(){},m.prototype.remove=function(){},y.prototype=new Error,y.prototype.name="IndexOutOfBoundsException",v.prototype=Object.create(m.prototype),v.prototype.constructor=v,v.prototype.get=function(){},v.prototype.set=function(){},v.prototype.isEmpty=function(){},w.prototype=new Error,w.prototype.name="NoSuchElementException",x.prototype=new Error,x.prototype.name="OperationNotSupported",_.prototype=Object.create(v.prototype),_.prototype.constructor=_,_.prototype.ensureCapacity=function(){},_.prototype.interfaces_=function(){return[v,m]},_.prototype.add=function(t){return this.array_.push(t),!0},_.prototype.clear=function(){this.array_=[]},_.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next());return!0},_.prototype.set=function(t,e){var n=this.array_[t];return this.array_[t]=e,n},_.prototype.iterator=function(){return new zs(this)},_.prototype.get=function(t){if(0>t||t>=this.size())throw new y;return this.array_[t]},_.prototype.isEmpty=function(){return 0===this.array_.length},_.prototype.size=function(){return this.array_.length},_.prototype.toArray=function(){for(var t=[],e=0,n=this.array_.length;n>e;e++)t.push(this.array_[e]);return t},_.prototype.remove=function(t){for(var e=!1,n=0,i=this.array_.length;i>n;n++)if(this.array_[n]===t){this.array_.splice(n,1),e=!0;break}return e};var zs=function(t){this.arrayList_=t,this.position_=0};zs.prototype.next=function(){if(this.position_===this.arrayList_.size())throw new w;return this.arrayList_.get(this.position_++)},zs.prototype.hasNext=function(){return this.position_<this.arrayList_.size()},zs.prototype.set=function(t){return this.arrayList_.set(this.position_-1,t)},zs.prototype.remove=function(){throw new x},u(b,_),e(b.prototype,{getCoordinate:function(t){return this.get(t)},addAll:function(){if(2===arguments.length){for(var t=arguments[1],e=!1,n=arguments[0].iterator();n.hasNext();)this.add(n.next(),t),e=!0;return e}return _.prototype.addAll.apply(this,arguments)},clone:function(){for(var t=_.prototype.clone.call(this),e=0;e<this.size();e++)t.add(e,this.get(e).copy());return t},toCoordinateArray:function(){return this.toArray(b.coordArrayType)},add:function(){if(1===arguments.length){var t=arguments[0];_.prototype.add.call(this,t)}else if(2===arguments.length){if(arguments[0]instanceof Array&&"boolean"==typeof arguments[1]){var e=arguments[0],n=arguments[1];return this.add(e,n,!0),!0}if(arguments[0]instanceof d&&"boolean"==typeof arguments[1]){var i=arguments[0];if(!arguments[1]&&this.size()>=1&&this.get(this.size()-1).equals2D(i))return null;_.prototype.add.call(this,i)}else if(arguments[0]instanceof Object&&"boolean"==typeof arguments[1]){var r=arguments[0],s=arguments[1];return this.add(r,s),!0}}else if(3===arguments.length){if("boolean"==typeof arguments[2]&&arguments[0]instanceof Array&&"boolean"==typeof arguments[1]){var o=arguments[0],a=arguments[1];if(arguments[2])for(var l=0;l<o.length;l++)this.add(o[l],a);else for(l=o.length-1;l>=0;l--)this.add(o[l],a);return!0}if("boolean"==typeof arguments[2]&&Number.isInteger(arguments[0])&&arguments[1]instanceof d){var h=arguments[0],u=arguments[1];if(!arguments[2]){var c=this.size();if(c>0){if(h>0&&this.get(h-1).equals2D(u))return null;if(c>h&&this.get(h).equals2D(u))return null}}_.prototype.add.call(this,h,u)}}else if(4===arguments.length){var f=arguments[0],g=arguments[1],p=arguments[2],m=arguments[3],y=1;for(p>m&&(y=-1),l=p;l!==m;l+=y)this.add(f[l],g);return!0}},closeRing:function(){this.size()>0&&this.add(new d(this.get(0)),!1)},interfaces_:function(){return[]},getClass:function(){return b}}),b.coordArrayType=new Array(0).fill(null),e(E.prototype,{getArea:function(){return this.getWidth()*this.getHeight()},equals:function(t){if(!(t instanceof E))return!1;var e=t;return this.isNull()?e.isNull():this.maxx===e.getMaxX()&&this.maxy===e.getMaxY()&&this.minx===e.getMinX()&&this.miny===e.getMinY()},intersection:function(t){if(this.isNull()||t.isNull()||!this.intersects(t))return new E;var e=this.minx>t.minx?this.minx:t.minx,n=this.miny>t.miny?this.miny:t.miny;return new E(e,this.maxx<t.maxx?this.maxx:t.maxx,n,this.maxy<t.maxy?this.maxy:t.maxy)},isNull:function(){return this.maxx<this.minx},getMaxX:function(){return this.maxx},covers:function(){if(1===arguments.length){if(arguments[0]instanceof d){var t=arguments[0];return this.covers(t.x,t.y)}if(arguments[0]instanceof E){var e=arguments[0];return!this.isNull()&&!e.isNull()&&e.getMinX()>=this.minx&&e.getMaxX()<=this.maxx&&e.getMinY()>=this.miny&&e.getMaxY()<=this.maxy}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];return!this.isNull()&&n>=this.minx&&n<=this.maxx&&i>=this.miny&&i<=this.maxy}},intersects:function(){if(1===arguments.length){if(arguments[0]instanceof E){var t=arguments[0];return!this.isNull()&&!t.isNull()&&!(t.minx>this.maxx||t.maxx<this.minx||t.miny>this.maxy||t.maxy<this.miny)}if(arguments[0]instanceof d){var e=arguments[0];return this.intersects(e.x,e.y)}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];return!this.isNull()&&!(n>this.maxx||n<this.minx||i>this.maxy||i<this.miny)}},getMinY:function(){return this.miny},getMinX:function(){return this.minx},expandToInclude:function(){if(1===arguments.length){if(arguments[0]instanceof d){var t=arguments[0];this.expandToInclude(t.x,t.y)}else if(arguments[0]instanceof E){var e=arguments[0];if(e.isNull())return null;this.isNull()?(this.minx=e.getMinX(),this.maxx=e.getMaxX(),this.miny=e.getMinY(),this.maxy=e.getMaxY()):(e.minx<this.minx&&(this.minx=e.minx),e.maxx>this.maxx&&(this.maxx=e.maxx),e.miny<this.miny&&(this.miny=e.miny),e.maxy>this.maxy&&(this.maxy=e.maxy))}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];this.isNull()?(this.minx=n,this.maxx=n,this.miny=i,this.maxy=i):(n<this.minx&&(this.minx=n),n>this.maxx&&(this.maxx=n),i<this.miny&&(this.miny=i),i>this.maxy&&(this.maxy=i))}},minExtent:function(){if(this.isNull())return 0;var t=this.getWidth(),e=this.getHeight();return e>t?t:e},getWidth:function(){return this.isNull()?0:this.maxx-this.minx},compareTo:function(t){var e=t;return this.isNull()?e.isNull()?0:-1:e.isNull()?1:this.minx<e.minx?-1:this.minx>e.minx?1:this.miny<e.miny?-1:this.miny>e.miny?1:this.maxx<e.maxx?-1:this.maxx>e.maxx?1:this.maxy<e.maxy?-1:this.maxy>e.maxy?1:0},translate:function(t,e){return this.isNull()?null:void this.init(this.getMinX()+t,this.getMaxX()+t,this.getMinY()+e,this.getMaxY()+e)},toString:function(){return"Env["+this.minx+" : "+this.maxx+", "+this.miny+" : "+this.maxy+"]"},setToNull:function(){this.minx=0,this.maxx=-1,this.miny=0,this.maxy=-1},getHeight:function(){return this.isNull()?0:this.maxy-this.miny},maxExtent:function(){if(this.isNull())return 0;var t=this.getWidth(),e=this.getHeight();return t>e?t:e},expandBy:function(){if(1===arguments.length){var t=arguments[0];this.expandBy(t,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(this.isNull())return null;this.minx-=e,this.maxx+=e,this.miny-=n,this.maxy+=n,(this.minx>this.maxx||this.miny>this.maxy)&&this.setToNull()}},contains:function(){if(1===arguments.length){if(arguments[0]instanceof E){var t=arguments[0];return this.covers(t)}if(arguments[0]instanceof d){var e=arguments[0];return this.covers(e)}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];return this.covers(n,i)}},centre:function(){return this.isNull()?null:new d((this.getMinX()+this.getMaxX())/2,(this.getMinY()+this.getMaxY())/2)},init:function(){if(0===arguments.length)this.setToNull();else if(1===arguments.length){if(arguments[0]instanceof d){var t=arguments[0];this.init(t.x,t.x,t.y,t.y)}else if(arguments[0]instanceof E){var e=arguments[0];this.minx=e.minx,this.maxx=e.maxx,this.miny=e.miny,this.maxy=e.maxy}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];this.init(n.x,i.x,n.y,i.y)}else if(4===arguments.length){var r=arguments[0],s=arguments[1],o=arguments[2],a=arguments[3];s>r?(this.minx=r,this.maxx=s):(this.minx=s,this.maxx=r),a>o?(this.miny=o,this.maxy=a):(this.miny=a,this.maxy=o)}},getMaxY:function(){return this.maxy},distance:function(t){if(this.intersects(t))return 0;var e=0;this.maxx<t.minx?e=t.minx-this.maxx:this.minx>t.maxx&&(e=this.minx-t.maxx);var n=0;return this.maxy<t.miny?n=t.miny-this.maxy:this.miny>t.maxy&&(n=this.miny-t.maxy),0===e?n:0===n?e:Math.sqrt(e*e+n*n)},hashCode:function(){var t=17;return 37*(t=37*(t=37*(t=37*t+d.hashCode(this.minx))+d.hashCode(this.maxx))+d.hashCode(this.miny))+d.hashCode(this.maxy)},interfaces_:function(){return[s,l]},getClass:function(){return E}}),E.intersects=function(){if(3===arguments.length){var t=arguments[0],e=arguments[1],n=arguments[2];return n.x>=(t.x<e.x?t.x:e.x)&&n.x<=(t.x>e.x?t.x:e.x)&&n.y>=(t.y<e.y?t.y:e.y)&&n.y<=(t.y>e.y?t.y:e.y)}if(4===arguments.length){var i=arguments[0],r=arguments[1],s=arguments[2],o=arguments[3],a=Math.min(s.x,o.x),l=Math.max(s.x,o.x),h=Math.min(i.x,r.x),u=Math.max(i.x,r.x);return!(h>l||a>u||(a=Math.min(s.y,o.y),l=Math.max(s.y,o.y),h=Math.min(i.y,r.y),u=Math.max(i.y,r.y),h>l||a>u))}},E.serialVersionUID=0x51845cd552189800,u(I,S),e(I.prototype,{interfaces_:function(){return[]},getClass:function(){return I}}),e(C.prototype,{interfaces_:function(){return[]},getClass:function(){return C}}),C.toLocationSymbol=function(t){switch(t){case C.EXTERIOR:return"e";case C.BOUNDARY:return"b";case C.INTERIOR:return"i";case C.NONE:return"-"}throw new i("Unknown location value: "+t)},C.INTERIOR=0,C.BOUNDARY=1,C.EXTERIOR=2,C.NONE=-1,e(R.prototype,{interfaces_:function(){return[]},getClass:function(){return R}}),R.log10=function(t){var e=Math.log(t);return r.isInfinite(e)||r.isNaN(e)?e:e/R.LOG_10},R.min=function(t,e,n,i){var r=t;return r>e&&(r=e),r>n&&(r=n),r>i&&(r=i),r},R.clamp=function(){if("number"==typeof arguments[2]&&"number"==typeof arguments[0]&&"number"==typeof arguments[1]){var t=arguments[0],e=arguments[1],n=arguments[2];return e>t?e:t>n?n:t}if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var i=arguments[0],r=arguments[1],s=arguments[2];return r>i?r:i>s?s:i}},R.wrap=function(t,e){return 0>t?e- -t%e:t%e},R.max=function(){if(3===arguments.length){var t=arguments[1],e=arguments[2];return t>(n=arguments[0])&&(n=t),e>n&&(n=e),n}if(4===arguments.length){var n,i=arguments[1],r=arguments[2],s=arguments[3];return i>(n=arguments[0])&&(n=i),r>n&&(n=r),s>n&&(n=s),n}},R.average=function(t,e){return(t+e)/2},R.LOG_10=Math.log(10),P.prototype.append=function(t){this.str+=t},P.prototype.setCharAt=function(t,e){return this.str.substr(0,t)+e+this.str.substr(t+1)},P.prototype.toString=function(t){return this.str},T.prototype.intValue=function(){return this.value},T.prototype.compareTo=function(t){return this.value<t?-1:this.value>t?1:0},T.isNaN=function(t){return Number.isNaN(t)},N.isWhitespace=function(t){return 32>=t&&t>=0||127==t},N.toUpperCase=function(t){return t.toUpperCase()},e(A.prototype,{le:function(t){return this.hi<t.hi||this.hi===t.hi&&this.lo<=t.lo},extractSignificantDigits:function(t,e){var n=this.abs(),i=A.magnitude(n.hi),r=A.TEN.pow(i);(n=n.divide(r)).gt(A.TEN)?(n=n.divide(A.TEN),i+=1):n.lt(A.ONE)&&(n=n.multiply(A.TEN),i-=1);for(var s=i+1,o=new P,a=A.MAX_PRINT_DIGITS-1,l=0;a>=l;l++){t&&l===s&&o.append(".");var h=Math.trunc(n.hi);if(0>h)break;var u=!1,c=0;h>9?(u=!0,c="9"):c="0"+h,o.append(c),n=n.subtract(A.valueOf(h)).multiply(A.TEN),u&&n.selfAdd(A.TEN);var f=!0,d=A.magnitude(n.hi);if(0>d&&Math.abs(d)>=a-l&&(f=!1),!f)break}return e[0]=i,o.toString()},sqr:function(){return this.multiply(this)},doubleValue:function(){return this.hi+this.lo},subtract:function(){if(arguments[0]instanceof A){var t=arguments[0];return this.add(t.negate())}if("number"==typeof arguments[0]){var e=arguments[0];return this.add(-e)}},equals:function(){if(1===arguments.length){var t=arguments[0];return this.hi===t.hi&&this.lo===t.lo}},isZero:function(){return 0===this.hi&&0===this.lo},selfSubtract:function(){if(arguments[0]instanceof A){var t=arguments[0];return this.isNaN()?this:this.selfAdd(-t.hi,-t.lo)}if("number"==typeof arguments[0]){var e=arguments[0];return this.isNaN()?this:this.selfAdd(-e,0)}},getSpecialNumberString:function(){return this.isZero()?"0.0":this.isNaN()?"NaN ":null},min:function(t){return this.le(t)?this:t},selfDivide:function(){if(1===arguments.length){if(arguments[0]instanceof A){var t=arguments[0];return this.selfDivide(t.hi,t.lo)}if("number"==typeof arguments[0]){var e=arguments[0];return this.selfDivide(e,0)}}else if(2===arguments.length){var n,i,r,s,o=arguments[0],a=arguments[1],l=null,h=null,u=null,c=null;return r=this.hi/o,c=(l=(u=A.SPLIT*r)-(l=u-r))*(h=(c=A.SPLIT*o)-(h=c-o))-(s=r*o)+l*(i=o-h)+(n=r-l)*h+n*i,c=r+(u=(this.hi-s-c+this.lo-r*a)/o),this.hi=c,this.lo=r-c+u,this}},dump:function(){return"DD<"+this.hi+", "+this.lo+">"},divide:function(){if(arguments[0]instanceof A){var t,e,n,i,s=arguments[0],o=null,a=null,l=null,h=null;return t=(n=this.hi/s.hi)-(o=(l=A.SPLIT*n)-(o=l-n)),h=o*(a=(h=A.SPLIT*s.hi)-(a=h-s.hi))-(i=n*s.hi)+o*(e=s.hi-a)+t*a+t*e,new A(h=n+(l=(this.hi-i-h+this.lo-n*s.lo)/s.hi),n-h+l)}if("number"==typeof arguments[0]){var u=arguments[0];return r.isNaN(u)?A.createNaN():A.copy(this).selfDivide(u,0)}},ge:function(t){return this.hi>t.hi||this.hi===t.hi&&this.lo>=t.lo},pow:function(t){if(0===t)return A.valueOf(1);var e=new A(this),n=A.valueOf(1),i=Math.abs(t);if(i>1)for(;i>0;)i%2==1&&n.selfMultiply(e),(i/=2)>0&&(e=e.sqr());else n=e;return 0>t?n.reciprocal():n},ceil:function(){if(this.isNaN())return A.NaN;var t=Math.ceil(this.hi),e=0;return t===this.hi&&(e=Math.ceil(this.lo)),new A(t,e)},compareTo:function(t){var e=t;return this.hi<e.hi?-1:this.hi>e.hi?1:this.lo<e.lo?-1:this.lo>e.lo?1:0},rint:function(){return this.isNaN()?this:this.add(.5).floor()},setValue:function(){if(arguments[0]instanceof A){var t=arguments[0];return this.init(t),this}if("number"==typeof arguments[0]){var e=arguments[0];return this.init(e),this}},max:function(t){return this.ge(t)?this:t},sqrt:function(){if(this.isZero())return A.valueOf(0);if(this.isNegative())return A.NaN;var t=1/Math.sqrt(this.hi),e=this.hi*t,n=A.valueOf(e),i=this.subtract(n.sqr()).hi*(.5*t);return n.add(i)},selfAdd:function(){if(1===arguments.length){if(arguments[0]instanceof A){var t=arguments[0];return this.selfAdd(t.hi,t.lo)}if("number"==typeof arguments[0]){var e=arguments[0],n=null,i=null,r=null,s=null,o=null,a=null;return s=(r=this.hi+e)-(o=r-this.hi),i=(a=(s=e-o+(this.hi-s))+this.lo)+(r-(n=r+a)),this.hi=n+i,this.lo=i+(n-this.hi),this}}else if(2===arguments.length){var l=arguments[0],h=arguments[1],u=(n=null,i=null),c=null;r=null,s=null,o=null,a=null,r=this.hi+l,u=this.lo+h,s=r-(o=r-this.hi),c=u-(a=u-this.lo);var f=(n=r+(o=(s=l-o+(this.hi-s))+u))+(o=(c=h-a+(this.lo-c))+(i=o+(r-n))),d=o+(n-f);return this.hi=f,this.lo=d,this}},selfMultiply:function(){if(1===arguments.length){if(arguments[0]instanceof A){var t=arguments[0];return this.selfMultiply(t.hi,t.lo)}if("number"==typeof arguments[0]){var e=arguments[0];return this.selfMultiply(e,0)}}else if(2===arguments.length){var n,i,r=arguments[0],s=arguments[1],o=null,a=null,l=null,h=null;o=(l=A.SPLIT*this.hi)-this.hi,h=A.SPLIT*r,o=l-o,n=this.hi-o,a=h-r;var u=(l=this.hi*r)+(h=o*(a=h-a)-l+o*(i=r-a)+n*a+n*i+(this.hi*s+this.lo*r)),c=h+(o=l-u);return this.hi=u,this.lo=c,this}},selfSqr:function(){return this.selfMultiply(this)},floor:function(){if(this.isNaN())return A.NaN;var t=Math.floor(this.hi),e=0;return t===this.hi&&(e=Math.floor(this.lo)),new A(t,e)},negate:function(){return this.isNaN()?this:new A(-this.hi,-this.lo)},clone:function(){try{return null}catch(t){if(t instanceof CloneNotSupportedException)return null;throw t}},multiply:function(){if(arguments[0]instanceof A){var t=arguments[0];return t.isNaN()?A.createNaN():A.copy(this).selfMultiply(t)}if("number"==typeof arguments[0]){var e=arguments[0];return r.isNaN(e)?A.createNaN():A.copy(this).selfMultiply(e,0)}},isNaN:function(){return r.isNaN(this.hi)},intValue:function(){return Math.trunc(this.hi)},toString:function(){var t=A.magnitude(this.hi);return t>=-3&&20>=t?this.toStandardNotation():this.toSciNotation()},toStandardNotation:function(){var t=this.getSpecialNumberString();if(null!==t)return t;var e=new Array(1).fill(null),n=this.extractSignificantDigits(!0,e),i=e[0]+1,r=n;if("."===n.charAt(0))r="0"+n;else if(0>i)r="0."+A.stringOfChar("0",-i)+n;else if(-1===n.indexOf(".")){var s=i-n.length;r=n+A.stringOfChar("0",s)+".0"}return this.isNegative()?"-"+r:r},reciprocal:function(){var t,e,n,i,r=null,s=null,o=null,a=null;t=(n=1/this.hi)-(r=(o=A.SPLIT*n)-(r=o-n)),s=(a=A.SPLIT*this.hi)-this.hi;var l=n+(o=(1-(i=n*this.hi)-(a=r*(s=a-s)-i+r*(e=this.hi-s)+t*s+t*e)-n*this.lo)/this.hi);return new A(l,n-l+o)},toSciNotation:function(){if(this.isZero())return A.SCI_NOT_ZERO;var t=this.getSpecialNumberString();if(null!==t)return t;var e=new Array(1).fill(null),n=this.extractSignificantDigits(!1,e),i=A.SCI_NOT_EXPONENT_CHAR+e[0];if("0"===n.charAt(0))throw new IllegalStateException("Found leading zero: "+n);var r="";n.length>1&&(r=n.substring(1));var s=n.charAt(0)+"."+r;return this.isNegative()?"-"+s+i:s+i},abs:function(){return this.isNaN()?A.NaN:this.isNegative()?this.negate():new A(this)},isPositive:function(){return this.hi>0||0===this.hi&&this.lo>0},lt:function(t){return this.hi<t.hi||this.hi===t.hi&&this.lo<t.lo},add:function(){if(arguments[0]instanceof A){var t=arguments[0];return A.copy(this).selfAdd(t)}if("number"==typeof arguments[0]){var e=arguments[0];return A.copy(this).selfAdd(e)}},init:function(){if(1===arguments.length){if("number"==typeof arguments[0]){var t=arguments[0];this.hi=t,this.lo=0}else if(arguments[0]instanceof A){var e=arguments[0];this.hi=e.hi,this.lo=e.lo}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];this.hi=n,this.lo=i}},gt:function(t){return this.hi>t.hi||this.hi===t.hi&&this.lo>t.lo},isNegative:function(){return this.hi<0||0===this.hi&&this.lo<0},trunc:function(){return this.isNaN()?A.NaN:this.isPositive()?this.floor():this.ceil()},signum:function(){return this.hi>0?1:this.hi<0?-1:this.lo>0?1:this.lo<0?-1:0},interfaces_:function(){return[l,s,o]},getClass:function(){return A}}),A.sqr=function(t){return A.valueOf(t).selfMultiply(t)},A.valueOf=function(){if("string"==typeof arguments[0]){var t=arguments[0];return A.parse(t)}if("number"==typeof arguments[0])return new A(arguments[0])},A.sqrt=function(t){return A.valueOf(t).sqrt()},A.parse=function(t){for(var e=0,n=t.length;N.isWhitespace(t.charAt(e));)e++;var i=!1;if(n>e){var r=t.charAt(e);"-"!==r&&"+"!==r||(e++,"-"===r&&(i=!0))}for(var s=new A,o=0,a=0,l=0;!(e>=n);){var h=t.charAt(e);if(e++,N.isDigit(h)){var u=h-"0";s.selfMultiply(A.TEN),s.selfAdd(u),o++}else{if("."!==h){if("e"===h||"E"===h){var c=t.substring(e);try{l=T.parseInt(c)}catch(e){throw e instanceof NumberFormatException?new NumberFormatException("Invalid exponent "+c+" in string "+t):e}break}throw new NumberFormatException("Unexpected character '"+h+"' at position "+e+" in string "+t)}a=o}}var f=s,d=o-a-l;if(0===d)f=s;else if(d>0){var g=A.TEN.pow(d);f=s.divide(g)}else 0>d&&(g=A.TEN.pow(-d),f=s.multiply(g));return i?f.negate():f},A.createNaN=function(){return new A(r.NaN,r.NaN)},A.copy=function(t){return new A(t)},A.magnitude=function(t){var e=Math.abs(t),n=Math.log(e)/Math.log(10),i=Math.trunc(Math.floor(n));return e>=10*Math.pow(10,i)&&(i+=1),i},A.stringOfChar=function(t,e){for(var n=new P,i=0;e>i;i++)n.append(t);return n.toString()},A.PI=new A(3.141592653589793,12246467991473532e-32),A.TWO_PI=new A(6.283185307179586,24492935982947064e-32),A.PI_2=new A(1.5707963267948966,6123233995736766e-32),A.E=new A(2.718281828459045,14456468917292502e-32),A.NaN=new A(r.NaN,r.NaN),A.EPS=123259516440783e-46,A.SPLIT=134217729,A.MAX_PRINT_DIGITS=32,A.TEN=A.valueOf(10),A.ONE=A.valueOf(1),A.SCI_NOT_EXPONENT_CHAR="E",A.SCI_NOT_ZERO="0.0E0",e(k.prototype,{interfaces_:function(){return[]},getClass:function(){return k}}),k.orientationIndex=function(t,e,n){var i=k.orientationIndexFilter(t,e,n);if(1>=i)return i;var r=A.valueOf(e.x).selfAdd(-t.x),s=A.valueOf(e.y).selfAdd(-t.y),o=A.valueOf(n.x).selfAdd(-e.x),a=A.valueOf(n.y).selfAdd(-e.y);return r.selfMultiply(a).selfSubtract(s.selfMultiply(o)).signum()},k.signOfDet2x2=function(t,e,n,i){return t.multiply(i).selfSubtract(e.multiply(n)).signum()},k.intersection=function(t,e,n,i){var r=A.valueOf(i.y).selfSubtract(n.y).selfMultiply(A.valueOf(e.x).selfSubtract(t.x)),s=A.valueOf(i.x).selfSubtract(n.x).selfMultiply(A.valueOf(e.y).selfSubtract(t.y)),o=r.subtract(s),a=A.valueOf(i.x).selfSubtract(n.x).selfMultiply(A.valueOf(t.y).selfSubtract(n.y)),l=A.valueOf(i.y).selfSubtract(n.y).selfMultiply(A.valueOf(t.x).selfSubtract(n.x)),h=a.subtract(l).selfDivide(o).doubleValue(),u=A.valueOf(t.x).selfAdd(A.valueOf(e.x).selfSubtract(t.x).selfMultiply(h)).doubleValue(),c=A.valueOf(e.x).selfSubtract(t.x).selfMultiply(A.valueOf(t.y).selfSubtract(n.y)),f=A.valueOf(e.y).selfSubtract(t.y).selfMultiply(A.valueOf(t.x).selfSubtract(n.x)),g=c.subtract(f).selfDivide(o).doubleValue();return new d(u,A.valueOf(n.y).selfAdd(A.valueOf(i.y).selfSubtract(n.y).selfMultiply(g)).doubleValue())},k.orientationIndexFilter=function(t,e,n){var i=null,r=(t.x-n.x)*(e.y-n.y),s=(t.y-n.y)*(e.x-n.x),o=r-s;if(r>0){if(0>=s)return k.signum(o);i=r+s}else{if(!(0>r))return k.signum(o);if(s>=0)return k.signum(o);i=-r-s}var a=k.DP_SAFE_EPSILON*i;return o>=a||-o>=a?k.signum(o):2},k.signum=function(t){return t>0?1:0>t?-1:0},k.DP_SAFE_EPSILON=1e-15,e(L.prototype,{setOrdinate:function(t,e,n){},size:function(){},getOrdinate:function(t,e){},getCoordinate:function(){},getCoordinateCopy:function(t){},getDimension:function(){},getX:function(t){},clone:function(){},expandEnvelope:function(t){},copy:function(){},getY:function(t){},toCoordinateArray:function(){},interfaces_:function(){return[o]},getClass:function(){return L}}),L.X=0,L.Y=1,L.Z=2,L.M=3,O.arraycopy=function(t,e,n,i,r){for(var s=0,o=e;e+r>o;o++)n[i+s]=t[o],s++},O.getProperty=function(t){return{"line.separator":"\n"}[t]},e(D.prototype,{getY:function(){var t=this.y/this.w;if(r.isNaN(t)||r.isInfinite(t))throw new I;return t},getX:function(){var t=this.x/this.w;if(r.isNaN(t)||r.isInfinite(t))throw new I;return t},getCoordinate:function(){var t=new d;return t.x=this.getX(),t.y=this.getY(),t},interfaces_:function(){return[]},getClass:function(){return D}}),D.intersection=function(t,e,n,i){var s=t.y-e.y,o=e.x-t.x,a=t.x*e.y-e.x*t.y,l=n.y-i.y,h=i.x-n.x,u=n.x*i.y-i.x*n.y,c=s*h-l*o,f=(o*u-h*a)/c,g=(l*a-s*u)/c;if(r.isNaN(f)||r.isInfinite(f)||r.isNaN(g)||r.isInfinite(g))throw new I;return new d(f,g)},e(F.prototype,{create:function(){1===arguments.length&&(arguments[0]instanceof Array||M(arguments[0],L))},interfaces_:function(){return[]},getClass:function(){return F}}),e(z.prototype,{filter:function(t){},interfaces_:function(){return[]},getClass:function(){return z}}),e(G.prototype,{isGeometryCollection:function(){return this.getSortIndex()===G.SORTINDEX_GEOMETRYCOLLECTION},getFactory:function(){return this.factory},getGeometryN:function(t){return this},getArea:function(){return 0},isRectangle:function(){return!1},equals:function(){if(1===arguments.length){if(arguments[0]instanceof G){var t=arguments[0];return null!==t&&this.equalsTopo(t)}if(arguments[0]instanceof Object){var e=arguments[0];if(!(e instanceof G))return!1;var n=e;return this.equalsExact(n)}}},equalsExact:function(t){return this===t||this.equalsExact(t,0)},geometryChanged:function(){this.apply(G.geometryChangedFilter)},geometryChangedAction:function(){this.envelope=null},equalsNorm:function(t){return null!==t&&this.norm().equalsExact(t.norm())},getLength:function(){return 0},getNumGeometries:function(){return 1},compareTo:function(){if(1===arguments.length){var t=arguments[0],e=t;return this.getSortIndex()!==e.getSortIndex()?this.getSortIndex()-e.getSortIndex():this.isEmpty()&&e.isEmpty()?0:this.isEmpty()?-1:e.isEmpty()?1:this.compareToSameClass(t)}if(2===arguments.length){var n=arguments[0],i=arguments[1];return e=n,this.getSortIndex()!==e.getSortIndex()?this.getSortIndex()-e.getSortIndex():this.isEmpty()&&e.isEmpty()?0:this.isEmpty()?-1:e.isEmpty()?1:this.compareToSameClass(n,i)}},getUserData:function(){return this.userData},getSRID:function(){return this.SRID},getEnvelope:function(){return this.getFactory().toGeometry(this.getEnvelopeInternal())},checkNotGeometryCollection:function(t){if(t.getSortIndex()===G.SORTINDEX_GEOMETRYCOLLECTION)throw new i("This method does not support GeometryCollection arguments")},equal:function(t,e,n){return 0===n?t.equals(e):t.distance(e)<=n},norm:function(){var t=this.copy();return t.normalize(),t},getPrecisionModel:function(){return this.factory.getPrecisionModel()},getEnvelopeInternal:function(){return null===this.envelope&&(this.envelope=this.computeEnvelopeInternal()),new E(this.envelope)},setSRID:function(t){this.SRID=t},setUserData:function(t){this.userData=t},compare:function(t,e){for(var n=t.iterator(),i=e.iterator();n.hasNext()&&i.hasNext();){var r=n.next(),s=i.next(),o=r.compareTo(s);if(0!==o)return o}return n.hasNext()?1:i.hasNext()?-1:0},hashCode:function(){return this.getEnvelopeInternal().hashCode()},isGeometryCollectionOrDerived:function(){return this.getSortIndex()===G.SORTINDEX_GEOMETRYCOLLECTION||this.getSortIndex()===G.SORTINDEX_MULTIPOINT||this.getSortIndex()===G.SORTINDEX_MULTILINESTRING||this.getSortIndex()===G.SORTINDEX_MULTIPOLYGON},interfaces_:function(){return[o,s,l]},getClass:function(){return G}}),G.hasNonEmptyElements=function(t){for(var e=0;e<t.length;e++)if(!t[e].isEmpty())return!0;return!1},G.hasNullElements=function(t){for(var e=0;e<t.length;e++)if(null===t[e])return!0;return!1},G.serialVersionUID=0x799ea46522854c00,G.SORTINDEX_POINT=0,G.SORTINDEX_MULTIPOINT=1,G.SORTINDEX_LINESTRING=2,G.SORTINDEX_LINEARRING=3,G.SORTINDEX_MULTILINESTRING=4,G.SORTINDEX_POLYGON=5,G.SORTINDEX_MULTIPOLYGON=6,G.SORTINDEX_GEOMETRYCOLLECTION=7,G.geometryChangedFilter={interfaces_:function(){return[z]},filter:function(t){t.geometryChangedAction()}},e(B.prototype,{filter:function(t){},interfaces_:function(){return[]},getClass:function(){return B}}),e(U.prototype,{isInBoundary:function(t){},interfaces_:function(){return[]},getClass:function(){return U}}),e(q.prototype,{isInBoundary:function(t){return t%2==1},interfaces_:function(){return[U]},getClass:function(){return q}}),e(V.prototype,{isInBoundary:function(t){return t>0},interfaces_:function(){return[U]},getClass:function(){return V}}),e(Y.prototype,{isInBoundary:function(t){return t>1},interfaces_:function(){return[U]},getClass:function(){return Y}}),e(X.prototype,{isInBoundary:function(t){return 1===t},interfaces_:function(){return[U]},getClass:function(){return X}}),U.Mod2BoundaryNodeRule=q,U.EndPointBoundaryNodeRule=V,U.MultiValentEndPointBoundaryNodeRule=Y,U.MonoValentEndPointBoundaryNodeRule=X,U.MOD2_BOUNDARY_RULE=new q,U.ENDPOINT_BOUNDARY_RULE=new V,U.MULTIVALENT_ENDPOINT_BOUNDARY_RULE=new Y,U.MONOVALENT_ENDPOINT_BOUNDARY_RULE=new X,U.OGC_SFS_BOUNDARY_RULE=U.MOD2_BOUNDARY_RULE,e(j.prototype,{interfaces_:function(){return[]},getClass:function(){return j}}),j.isRing=function(t){return!(t.length<4||!t[0].equals2D(t[t.length-1]))},j.ptNotInList=function(t,e){for(var n=0;n<t.length;n++){var i=t[n];if(j.indexOf(i,e)<0)return i}return null},j.scroll=function(t,e){var n=j.indexOf(e,t);if(0>n)return null;var i=new Array(t.length).fill(null);O.arraycopy(t,n,i,0,t.length-n),O.arraycopy(t,0,i,t.length-n,n),O.arraycopy(i,0,t,0,t.length)},j.equals=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];if(t===e)return!0;if(null===t||null===e)return!1;if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(!t[n].equals(e[n]))return!1;return!0}if(3===arguments.length){var i=arguments[0],r=arguments[1],s=arguments[2];if(i===r)return!0;if(null===i||null===r)return!1;if(i.length!==r.length)return!1;for(n=0;n<i.length;n++)if(0!==s.compare(i[n],r[n]))return!1;return!0}},j.intersection=function(t,e){for(var n=new b,i=0;i<t.length;i++)e.intersects(t[i])&&n.add(t[i],!0);return n.toCoordinateArray()},j.hasRepeatedPoints=function(t){for(var e=1;e<t.length;e++)if(t[e-1].equals(t[e]))return!0;return!1},j.removeRepeatedPoints=function(t){return j.hasRepeatedPoints(t)?new b(t,!1).toCoordinateArray():t},j.reverse=function(t){for(var e=t.length-1,n=Math.trunc(e/2),i=0;n>=i;i++){var r=t[i];t[i]=t[e-i],t[e-i]=r}},j.removeNull=function(t){for(var e=0,n=0;n<t.length;n++)null!==t[n]&&e++;var i=new Array(e).fill(null);if(0===e)return i;var r=0;for(n=0;n<t.length;n++)null!==t[n]&&(i[r++]=t[n]);return i},j.copyDeep=function(){if(1===arguments.length){for(var t=arguments[0],e=new Array(t.length).fill(null),n=0;n<t.length;n++)e[n]=new d(t[n]);return e}if(5===arguments.length){var i=arguments[0],r=arguments[1],s=arguments[2],o=arguments[3],a=arguments[4];for(n=0;a>n;n++)s[o+n]=new d(i[r+n])}},j.isEqualReversed=function(t,e){for(var n=0;n<t.length;n++){var i=t[n],r=e[t.length-n-1];if(0!==i.compareTo(r))return!1}return!0},j.envelope=function(t){for(var e=new E,n=0;n<t.length;n++)e.expandToInclude(t[n]);return e},j.toCoordinateArray=function(t){return t.toArray(j.coordArrayType)},j.atLeastNCoordinatesOrNothing=function(t,e){return e.length>=t?e:[]},j.indexOf=function(t,e){for(var n=0;n<e.length;n++)if(t.equals(e[n]))return n;return-1},j.increasingDirection=function(t){for(var e=0;e<Math.trunc(t.length/2);e++){var n=t.length-1-e,i=t[e].compareTo(t[n]);if(0!==i)return i}return 1},j.compare=function(t,e){for(var n=0;n<t.length&&n<e.length;){var i=t[n].compareTo(e[n]);if(0!==i)return i;n++}return n<e.length?-1:n<t.length?1:0},j.minCoordinate=function(t){for(var e=null,n=0;n<t.length;n++)(null===e||e.compareTo(t[n])>0)&&(e=t[n]);return e},j.extract=function(t,e,n){e=R.clamp(e,0,t.length);var i=(n=R.clamp(n,-1,t.length))-e+1;0>n&&(i=0),e>=t.length&&(i=0),e>n&&(i=0);var r=new Array(i).fill(null);if(0===i)return r;for(var s=0,o=e;n>=o;o++)r[s++]=t[o];return r},e(W.prototype,{compare:function(t,e){var n=t,i=e;return j.compare(n,i)},interfaces_:function(){return[a]},getClass:function(){return W}}),e(H.prototype,{compare:function(t,e){var n=t,i=e;if(n.length<i.length)return-1;if(n.length>i.length)return 1;if(0===n.length)return 0;var r=j.compare(n,i);return j.isEqualReversed(n,i)?0:r},OLDcompare:function(t,e){var n=t,i=e;if(n.length<i.length)return-1;if(n.length>i.length)return 1;if(0===n.length)return 0;for(var r=j.increasingDirection(n),s=j.increasingDirection(i),o=r>0?0:n.length-1,a=s>0?0:n.length-1,l=0;l<n.length;l++){var h=n[o].compareTo(i[a]);if(0!==h)return h;o+=r,a+=s}return 0},interfaces_:function(){return[a]},getClass:function(){return H}}),j.ForwardComparator=W,j.BidirectionalComparator=H,j.coordArrayType=new Array(0).fill(null),$.prototype.get=function(){},$.prototype.put=function(){},$.prototype.size=function(){},$.prototype.values=function(){},$.prototype.entrySet=function(){},Z.prototype=new $,K.prototype=new m,K.prototype.contains=function(){},J.prototype=new K,J.prototype.contains=function(t){for(var e=0,n=this.array_.length;n>e;e++)if(this.array_[e]===t)return!0;return!1},J.prototype.add=function(t){return!this.contains(t)&&(this.array_.push(t),!0)},J.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next());return!0},J.prototype.remove=function(t){throw new javascript.util.OperationNotSupported},J.prototype.size=function(){return this.array_.length},J.prototype.isEmpty=function(){return 0===this.array_.length},J.prototype.toArray=function(){for(var t=[],e=0,n=this.array_.length;n>e;e++)t.push(this.array_[e]);return t},J.prototype.iterator=function(){return new Gs(this)};var Gs=function(t){this.hashSet_=t,this.position_=0};Gs.prototype.next=function(){if(this.position_===this.hashSet_.size())throw new w;return this.hashSet_.array_[this.position_++]},Gs.prototype.hasNext=function(){return this.position_<this.hashSet_.size()},Gs.prototype.remove=function(){throw new x};var Bs=0;rt.prototype=new Z,rt.prototype.get=function(t){for(var e=this.root_;null!==e;){var n=t.compareTo(e.key);if(0>n)e=e.left;else{if(!(n>0))return e.value;e=e.right}}return null},rt.prototype.put=function(t,e){if(null===this.root_)return this.root_={key:t,value:e,left:null,right:null,parent:null,color:Bs,getValue:function(){return this.value},getKey:function(){return this.key}},this.size_=1,null;var n,i,r=this.root_;do{if(n=r,0>(i=t.compareTo(r.key)))r=r.left;else{if(!(i>0)){var s=r.value;return r.value=e,s}r=r.right}}while(null!==r);var o={key:t,left:null,right:null,value:e,parent:n,color:Bs,getValue:function(){return this.value},getKey:function(){return this.key}};return 0>i?n.left=o:n.right=o,this.fixAfterInsertion(o),this.size_++,null},rt.prototype.fixAfterInsertion=function(t){for(t.color=1;null!=t&&t!=this.root_&&1==t.parent.color;)if(tt(t)==nt(tt(tt(t))))1==Q(e=it(tt(tt(t))))?(et(tt(t),Bs),et(e,Bs),et(tt(tt(t)),1),t=tt(tt(t))):(t==it(tt(t))&&(t=tt(t),this.rotateLeft(t)),et(tt(t),Bs),et(tt(tt(t)),1),this.rotateRight(tt(tt(t))));else{var e;1==Q(e=nt(tt(tt(t))))?(et(tt(t),Bs),et(e,Bs),et(tt(tt(t)),1),t=tt(tt(t))):(t==nt(tt(t))&&(t=tt(t),this.rotateRight(t)),et(tt(t),Bs),et(tt(tt(t)),1),this.rotateLeft(tt(tt(t))))}this.root_.color=Bs},rt.prototype.values=function(){var t=new _,e=this.getFirstEntry();if(null!==e)for(t.add(e.value);null!==(e=rt.successor(e));)t.add(e.value);return t},rt.prototype.entrySet=function(){var t=new J,e=this.getFirstEntry();if(null!==e)for(t.add(e);null!==(e=rt.successor(e));)t.add(e);return t},rt.prototype.rotateLeft=function(t){if(null!=t){var e=t.right;t.right=e.left,null!=e.left&&(e.left.parent=t),e.parent=t.parent,null==t.parent?this.root_=e:t.parent.left==t?t.parent.left=e:t.parent.right=e,e.left=t,t.parent=e}},rt.prototype.rotateRight=function(t){if(null!=t){var e=t.left;t.left=e.right,null!=e.right&&(e.right.parent=t),e.parent=t.parent,null==t.parent?this.root_=e:t.parent.right==t?t.parent.right=e:t.parent.left=e,e.right=t,t.parent=e}},rt.prototype.getFirstEntry=function(){var t=this.root_;if(null!=t)for(;null!=t.left;)t=t.left;return t},rt.successor=function(t){if(null===t)return null;if(null!==t.right){for(var e=t.right;null!==e.left;)e=e.left;return e}e=t.parent;for(var n=t;null!==e&&n===e.right;)n=e,e=e.parent;return e},rt.prototype.size=function(){return this.size_},e(st.prototype,{interfaces_:function(){return[]},getClass:function(){return st}}),ot.prototype=new K,at.prototype=new ot,at.prototype.contains=function(t){for(var e=0,n=this.array_.length;n>e;e++)if(0===this.array_[e].compareTo(t))return!0;return!1},at.prototype.add=function(t){if(this.contains(t))return!1;for(var e=0,n=this.array_.length;n>e;e++)if(1===this.array_[e].compareTo(t))return this.array_.splice(e,0,t),!0;return this.array_.push(t),!0},at.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next());return!0},at.prototype.remove=function(t){throw new x},at.prototype.size=function(){return this.array_.length},at.prototype.isEmpty=function(){return 0===this.array_.length},at.prototype.toArray=function(){for(var t=[],e=0,n=this.array_.length;n>e;e++)t.push(this.array_[e]);return t},at.prototype.iterator=function(){return new Us(this)};var Us=function(t){this.treeSet_=t,this.position_=0};Us.prototype.next=function(){if(this.position_===this.treeSet_.size())throw new w;return this.treeSet_.array_[this.position_++]},Us.prototype.hasNext=function(){return this.position_<this.treeSet_.size()},Us.prototype.remove=function(){throw new x},lt.sort=function(){var t,e,n,i,r=arguments[0];if(1===arguments.length)return i=function(t,e){return t.compareTo(e)},void r.sort(i);if(2===arguments.length)n=arguments[1],i=function(t,e){return n.compare(t,e)},r.sort(i);else{if(3===arguments.length){(e=r.slice(arguments[1],arguments[2])).sort();var s=r.slice(0,arguments[1]).concat(e,r.slice(arguments[2],r.length));for(r.splice(0,r.length),t=0;t<s.length;t++)r.push(s[t]);return}if(4===arguments.length){for(e=r.slice(arguments[1],arguments[2]),n=arguments[3],i=function(t,e){return n.compare(t,e)},e.sort(i),s=r.slice(0,arguments[1]).concat(e,r.slice(arguments[2],r.length)),r.splice(0,r.length),t=0;t<s.length;t++)r.push(s[t]);return}}},lt.asList=function(t){for(var e=new _,n=0,i=t.length;i>n;n++)e.add(t[n]);return e},e(ht.prototype,{interfaces_:function(){return[]},getClass:function(){return ht}}),ht.toDimensionSymbol=function(t){switch(t){case ht.FALSE:return ht.SYM_FALSE;case ht.TRUE:return ht.SYM_TRUE;case ht.DONTCARE:return ht.SYM_DONTCARE;case ht.P:return ht.SYM_P;case ht.L:return ht.SYM_L;case ht.A:return ht.SYM_A}throw new i("Unknown dimension value: "+t)},ht.toDimensionValue=function(t){switch(N.toUpperCase(t)){case ht.SYM_FALSE:return ht.FALSE;case ht.SYM_TRUE:return ht.TRUE;case ht.SYM_DONTCARE:return ht.DONTCARE;case ht.SYM_P:return ht.P;case ht.SYM_L:return ht.L;case ht.SYM_A:return ht.A}throw new i("Unknown dimension symbol: "+t)},ht.P=0,ht.L=1,ht.A=2,ht.FALSE=-1,ht.TRUE=-2,ht.DONTCARE=-3,ht.SYM_FALSE="F",ht.SYM_TRUE="T",ht.SYM_DONTCARE="*",ht.SYM_P="0",ht.SYM_L="1",ht.SYM_A="2",e(ut.prototype,{filter:function(t){},interfaces_:function(){return[]},getClass:function(){return ut}}),e(ct.prototype,{filter:function(t,e){},isDone:function(){},isGeometryChanged:function(){},interfaces_:function(){return[]},getClass:function(){return ct}}),u(ft,G),e(ft.prototype,{computeEnvelopeInternal:function(){for(var t=new E,e=0;e<this.geometries.length;e++)t.expandToInclude(this.geometries[e].getEnvelopeInternal());return t},getGeometryN:function(t){return this.geometries[t]},getSortIndex:function(){return G.SORTINDEX_GEOMETRYCOLLECTION},getCoordinates:function(){for(var t=new Array(this.getNumPoints()).fill(null),e=-1,n=0;n<this.geometries.length;n++)for(var i=this.geometries[n].getCoordinates(),r=0;r<i.length;r++)t[++e]=i[r];return t},getArea:function(){for(var t=0,e=0;e<this.geometries.length;e++)t+=this.geometries[e].getArea();return t},equalsExact:function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];if(!this.isEquivalentClass(t))return!1;var n=t;if(this.geometries.length!==n.geometries.length)return!1;for(var i=0;i<this.geometries.length;i++)if(!this.geometries[i].equalsExact(n.geometries[i],e))return!1;return!0}return G.prototype.equalsExact.apply(this,arguments)},normalize:function(){for(var t=0;t<this.geometries.length;t++)this.geometries[t].normalize();lt.sort(this.geometries)},getCoordinate:function(){return this.isEmpty()?null:this.geometries[0].getCoordinate()},getBoundaryDimension:function(){for(var t=ht.FALSE,e=0;e<this.geometries.length;e++)t=Math.max(t,this.geometries[e].getBoundaryDimension());return t},getDimension:function(){for(var t=ht.FALSE,e=0;e<this.geometries.length;e++)t=Math.max(t,this.geometries[e].getDimension());return t},getLength:function(){for(var t=0,e=0;e<this.geometries.length;e++)t+=this.geometries[e].getLength();return t},getNumPoints:function(){for(var t=0,e=0;e<this.geometries.length;e++)t+=this.geometries[e].getNumPoints();return t},getNumGeometries:function(){return this.geometries.length},reverse:function(){for(var t=this.geometries.length,e=new Array(t).fill(null),n=0;n<this.geometries.length;n++)e[n]=this.geometries[n].reverse();return this.getFactory().createGeometryCollection(e)},compareToSameClass:function(){if(1===arguments.length){var t=arguments[0],e=new at(lt.asList(this.geometries)),n=new at(lt.asList(t.geometries));return this.compare(e,n)}if(2===arguments.length){for(var i=arguments[1],r=arguments[0],s=this.getNumGeometries(),o=r.getNumGeometries(),a=0;s>a&&o>a;){var l=this.getGeometryN(a),h=r.getGeometryN(a),u=l.compareToSameClass(h,i);if(0!==u)return u;a++}return s>a?1:o>a?-1:0}},apply:function(){if(M(arguments[0],B))for(var t=arguments[0],e=0;e<this.geometries.length;e++)this.geometries[e].apply(t);else if(M(arguments[0],ct)){var n=arguments[0];if(0===this.geometries.length)return null;for(e=0;e<this.geometries.length&&(this.geometries[e].apply(n),!n.isDone());e++);n.isGeometryChanged()&&this.geometryChanged()}else if(M(arguments[0],ut)){var i=arguments[0];for(i.filter(this),e=0;e<this.geometries.length;e++)this.geometries[e].apply(i)}else if(M(arguments[0],z)){var r=arguments[0];for(r.filter(this),e=0;e<this.geometries.length;e++)this.geometries[e].apply(r)}},getBoundary:function(){return this.checkNotGeometryCollection(this),f.shouldNeverReachHere(),null},clone:function(){var t=G.prototype.clone.call(this);t.geometries=new Array(this.geometries.length).fill(null);for(var e=0;e<this.geometries.length;e++)t.geometries[e]=this.geometries[e].clone();return t},getGeometryType:function(){return"GeometryCollection"},copy:function(){for(var t=new Array(this.geometries.length).fill(null),e=0;e<t.length;e++)t[e]=this.geometries[e].copy();return new ft(t,this.factory)},isEmpty:function(){for(var t=0;t<this.geometries.length;t++)if(!this.geometries[t].isEmpty())return!1;return!0},interfaces_:function(){return[]},getClass:function(){return ft}}),ft.serialVersionUID=-0x4f07bcb1f857d800,u(dt,ft),e(dt.prototype,{getSortIndex:function(){return G.SORTINDEX_MULTILINESTRING},equalsExact:function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return!!this.isEquivalentClass(t)&&ft.prototype.equalsExact.call(this,t,e)}return ft.prototype.equalsExact.apply(this,arguments)},getBoundaryDimension:function(){return this.isClosed()?ht.FALSE:0},isClosed:function(){if(this.isEmpty())return!1;for(var t=0;t<this.geometries.length;t++)if(!this.geometries[t].isClosed())return!1;return!0},getDimension:function(){return 1},reverse:function(){for(var t=this.geometries.length,e=new Array(t).fill(null),n=0;n<this.geometries.length;n++)e[t-1-n]=this.geometries[n].reverse();return this.getFactory().createMultiLineString(e)},getBoundary:function(){return new gt(this).getBoundary()},getGeometryType:function(){return"MultiLineString"},copy:function(){for(var t=new Array(this.geometries.length).fill(null),e=0;e<t.length;e++)t[e]=this.geometries[e].copy();return new dt(t,this.factory)},interfaces_:function(){return[st]},getClass:function(){return dt}}),dt.serialVersionUID=0x7155d2ab4afa8000,e(gt.prototype,{boundaryMultiLineString:function(t){if(this.geom.isEmpty())return this.getEmptyMultiPoint();var e=this.computeBoundaryCoordinates(t);return 1===e.length?this.geomFact.createPoint(e[0]):this.geomFact.createMultiPointFromCoords(e)},getBoundary:function(){return this.geom instanceof Et?this.boundaryLineString(this.geom):this.geom instanceof dt?this.boundaryMultiLineString(this.geom):this.geom.getBoundary()},boundaryLineString:function(t){return this.geom.isEmpty()?this.getEmptyMultiPoint():t.isClosed()?this.bnRule.isInBoundary(2)?t.getStartPoint():this.geomFact.createMultiPoint():this.geomFact.createMultiPoint([t.getStartPoint(),t.getEndPoint()])},getEmptyMultiPoint:function(){return this.geomFact.createMultiPoint()},computeBoundaryCoordinates:function(t){var e=new _;this.endpointMap=new rt;for(var n=0;n<t.getNumGeometries();n++){var i=t.getGeometryN(n);0!==i.getNumPoints()&&(this.addEndpoint(i.getCoordinateN(0)),this.addEndpoint(i.getCoordinateN(i.getNumPoints()-1)))}for(var r=this.endpointMap.entrySet().iterator();r.hasNext();){var s=r.next(),o=s.getValue().count;this.bnRule.isInBoundary(o)&&e.add(s.getKey())}return j.toCoordinateArray(e)},addEndpoint:function(t){var e=this.endpointMap.get(t);null===e&&(e=new pt,this.endpointMap.put(t,e)),e.count++},interfaces_:function(){return[]},getClass:function(){return gt}}),gt.getBoundary=function(){return 1===arguments.length?new gt(arguments[0]).getBoundary():2===arguments.length?new gt(arguments[0],arguments[1]).getBoundary():void 0},e(pt.prototype,{interfaces_:function(){return[]},getClass:function(){return pt}}),e(_t.prototype,{interfaces_:function(){return[]},getClass:function(){return _t}}),_t.chars=function(t,e){for(var n=new Array(e).fill(null),i=0;e>i;i++)n[i]=t;return new String(n)},_t.getStackTrace=function(){if(1===arguments.length){var t=arguments[0],e=new vt,n=new mt(e);return t.printStackTrace(n),e.toString()}if(2===arguments.length){for(var i=arguments[0],r=arguments[1],s="",o=new xt(new yt(_t.getStackTrace(i))),a=0;r>a;a++)try{s+=o.readLine()+_t.NEWLINE}catch(t){if(!(t instanceof wt))throw t;f.shouldNeverReachHere()}return s}},_t.split=function(t,e){for(var n=e.length,i=new _,r=""+t,s=r.indexOf(e);s>=0;){var o=r.substring(0,s);i.add(o),s=(r=r.substring(s+n)).indexOf(e)}r.length>0&&i.add(r);for(var a=new Array(i.size()).fill(null),l=0;l<a.length;l++)a[l]=i.get(l);return a},_t.toString=function(){if(1===arguments.length){var t=arguments[0];return _t.SIMPLE_ORDINATE_FORMAT.format(t)}},_t.spaces=function(t){return _t.chars(" ",t)},_t.NEWLINE=O.getProperty("line.separator"),_t.SIMPLE_ORDINATE_FORMAT=new function(){}("0.#"),e(bt.prototype,{interfaces_:function(){return[]},getClass:function(){return bt}}),bt.copyCoord=function(t,e,n,i){for(var r=Math.min(t.getDimension(),n.getDimension()),s=0;r>s;s++)n.setOrdinate(i,s,t.getOrdinate(e,s))},bt.isRing=function(t){var e=t.size();return 0===e||!(3>=e)&&t.getOrdinate(0,L.X)===t.getOrdinate(e-1,L.X)&&t.getOrdinate(0,L.Y)===t.getOrdinate(e-1,L.Y)},bt.isEqual=function(t,e){var n=t.size();if(n!==e.size())return!1;for(var i=Math.min(t.getDimension(),e.getDimension()),s=0;n>s;s++)for(var o=0;i>o;o++){var a=t.getOrdinate(s,o),l=e.getOrdinate(s,o);if(!(t.getOrdinate(s,o)===e.getOrdinate(s,o)||r.isNaN(a)&&r.isNaN(l)))return!1}return!0},bt.extend=function(t,e,n){var i=t.create(n,e.getDimension()),r=e.size();if(bt.copy(e,0,i,0,r),r>0)for(var s=r;n>s;s++)bt.copy(e,r-1,i,s,1);return i},bt.reverse=function(t){for(var e=t.size()-1,n=Math.trunc(e/2),i=0;n>=i;i++)bt.swap(t,i,e-i)},bt.swap=function(t,e,n){if(e===n)return null;for(var i=0;i<t.getDimension();i++){var r=t.getOrdinate(e,i);t.setOrdinate(e,i,t.getOrdinate(n,i)),t.setOrdinate(n,i,r)}},bt.copy=function(t,e,n,i,r){for(var s=0;r>s;s++)bt.copyCoord(t,e+s,n,i+s)},bt.toString=function(){if(1===arguments.length){var t=arguments[0],e=t.size();if(0===e)return"()";var n=t.getDimension(),i=new P;i.append("(");for(var r=0;e>r;r++){r>0&&i.append(" ");for(var s=0;n>s;s++)s>0&&i.append(","),i.append(_t.toString(t.getOrdinate(r,s)))}return i.append(")"),i.toString()}},bt.ensureValidRing=function(t,e){var n=e.size();return 0===n?e:3>=n?bt.createClosedRing(t,e,4):e.getOrdinate(0,L.X)===e.getOrdinate(n-1,L.X)&&e.getOrdinate(0,L.Y)===e.getOrdinate(n-1,L.Y)?e:bt.createClosedRing(t,e,n+1)},bt.createClosedRing=function(t,e,n){var i=t.create(n,e.getDimension()),r=e.size();bt.copy(e,0,i,0,r);for(var s=r;n>s;s++)bt.copy(e,0,i,s,1);return i},u(Et,G),e(Et.prototype,{computeEnvelopeInternal:function(){return this.isEmpty()?new E:this.points.expandEnvelope(new E)},isRing:function(){return this.isClosed()&&this.isSimple()},getSortIndex:function(){return G.SORTINDEX_LINESTRING},getCoordinates:function(){return this.points.toCoordinateArray()},equalsExact:function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];if(!this.isEquivalentClass(t))return!1;var n=t;if(this.points.size()!==n.points.size())return!1;for(var i=0;i<this.points.size();i++)if(!this.equal(this.points.getCoordinate(i),n.points.getCoordinate(i),e))return!1;return!0}return G.prototype.equalsExact.apply(this,arguments)},normalize:function(){for(var t=0;t<Math.trunc(this.points.size()/2);t++){var e=this.points.size()-1-t;if(!this.points.getCoordinate(t).equals(this.points.getCoordinate(e)))return this.points.getCoordinate(t).compareTo(this.points.getCoordinate(e))>0&&bt.reverse(this.points),null}},getCoordinate:function(){return this.isEmpty()?null:this.points.getCoordinate(0)},getBoundaryDimension:function(){return this.isClosed()?ht.FALSE:0},isClosed:function(){return!this.isEmpty()&&this.getCoordinateN(0).equals2D(this.getCoordinateN(this.getNumPoints()-1))},getEndPoint:function(){return this.isEmpty()?null:this.getPointN(this.getNumPoints()-1)},getDimension:function(){return 1},getLength:function(){return Qt.computeLength(this.points)},getNumPoints:function(){return this.points.size()},reverse:function(){var t=this.points.copy();return bt.reverse(t),this.getFactory().createLineString(t)},compareToSameClass:function(){if(1===arguments.length){for(var t=arguments[0],e=0,n=0;e<this.points.size()&&n<t.points.size();){var i=this.points.getCoordinate(e).compareTo(t.points.getCoordinate(n));if(0!==i)return i;e++,n++}return e<this.points.size()?1:n<t.points.size()?-1:0}if(2===arguments.length)return t=arguments[0],arguments[1].compare(this.points,t.points)},apply:function(){if(M(arguments[0],B))for(var t=arguments[0],e=0;e<this.points.size();e++)t.filter(this.points.getCoordinate(e));else if(M(arguments[0],ct)){var n=arguments[0];if(0===this.points.size())return null;for(e=0;e<this.points.size()&&(n.filter(this.points,e),!n.isDone());e++);n.isGeometryChanged()&&this.geometryChanged()}else(M(arguments[0],ut)||M(arguments[0],z))&&arguments[0].filter(this)},getBoundary:function(){return new gt(this).getBoundary()},isEquivalentClass:function(t){return t instanceof Et},clone:function(){var t=G.prototype.clone.call(this);return t.points=this.points.clone(),t},getCoordinateN:function(t){return this.points.getCoordinate(t)},getGeometryType:function(){return"LineString"},copy:function(){return new Et(this.points.copy(),this.factory)},getCoordinateSequence:function(){return this.points},isEmpty:function(){return 0===this.points.size()},init:function(t){if(null===t&&(t=this.getFactory().getCoordinateSequenceFactory().create([])),1===t.size())throw new i("Invalid number of points in LineString (found "+t.size()+" - must be 0 or >= 2)");this.points=t},isCoordinate:function(t){for(var e=0;e<this.points.size();e++)if(this.points.getCoordinate(e).equals(t))return!0;return!1},getStartPoint:function(){return this.isEmpty()?null:this.getPointN(0)},getPointN:function(t){return this.getFactory().createPoint(this.points.getCoordinate(t))},interfaces_:function(){return[st]},getClass:function(){return Et}}),Et.serialVersionUID=0x2b2b51ba435c8e00,e(St.prototype,{interfaces_:function(){return[]},getClass:function(){return St}}),u(It,G),e(It.prototype,{computeEnvelopeInternal:function(){if(this.isEmpty())return new E;var t=new E;return t.expandToInclude(this.coordinates.getX(0),this.coordinates.getY(0)),t},getSortIndex:function(){return G.SORTINDEX_POINT},getCoordinates:function(){return this.isEmpty()?[]:[this.getCoordinate()]},equalsExact:function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return!!this.isEquivalentClass(t)&&(!(!this.isEmpty()||!t.isEmpty())||this.isEmpty()===t.isEmpty()&&this.equal(t.getCoordinate(),this.getCoordinate(),e))}return G.prototype.equalsExact.apply(this,arguments)},normalize:function(){},getCoordinate:function(){return 0!==this.coordinates.size()?this.coordinates.getCoordinate(0):null},getBoundaryDimension:function(){return ht.FALSE},getDimension:function(){return 0},getNumPoints:function(){return this.isEmpty()?0:1},reverse:function(){return this.copy()},getX:function(){if(null===this.getCoordinate())throw new IllegalStateException("getX called on empty Point");return this.getCoordinate().x},compareToSameClass:function(){if(1===arguments.length){var t=arguments[0];return this.getCoordinate().compareTo(t.getCoordinate())}if(2===arguments.length)return t=arguments[0],arguments[1].compare(this.coordinates,t.coordinates)},apply:function(){if(M(arguments[0],B)){var t=arguments[0];if(this.isEmpty())return null;t.filter(this.getCoordinate())}else if(M(arguments[0],ct)){var e=arguments[0];if(this.isEmpty())return null;e.filter(this.coordinates,0),e.isGeometryChanged()&&this.geometryChanged()}else(M(arguments[0],ut)||M(arguments[0],z))&&arguments[0].filter(this)},getBoundary:function(){return this.getFactory().createGeometryCollection(null)},clone:function(){var t=G.prototype.clone.call(this);return t.coordinates=this.coordinates.clone(),t},getGeometryType:function(){return"Point"},copy:function(){return new It(this.coordinates.copy(),this.factory)},getCoordinateSequence:function(){return this.coordinates},getY:function(){if(null===this.getCoordinate())throw new IllegalStateException("getY called on empty Point");return this.getCoordinate().y},isEmpty:function(){return 0===this.coordinates.size()},init:function(t){null===t&&(t=this.getFactory().getCoordinateSequenceFactory().create([])),f.isTrue(t.size()<=1),this.coordinates=t},isSimple:function(){return!0},interfaces_:function(){return[St]},getClass:function(){return It}}),It.serialVersionUID=0x44077bad161cbc00,e(Ct.prototype,{interfaces_:function(){return[]},getClass:function(){return Ct}}),u(Mt,G),e(Mt.prototype,{computeEnvelopeInternal:function(){return this.shell.getEnvelopeInternal()},getSortIndex:function(){return G.SORTINDEX_POLYGON},getCoordinates:function(){if(this.isEmpty())return[];for(var t=new Array(this.getNumPoints()).fill(null),e=-1,n=this.shell.getCoordinates(),i=0;i<n.length;i++)t[++e]=n[i];for(var r=0;r<this.holes.length;r++)for(var s=this.holes[r].getCoordinates(),o=0;o<s.length;o++)t[++e]=s[o];return t},getArea:function(){var t=0;t+=Math.abs(Qt.signedArea(this.shell.getCoordinateSequence()));for(var e=0;e<this.holes.length;e++)t-=Math.abs(Qt.signedArea(this.holes[e].getCoordinateSequence()));return t},isRectangle:function(){if(0!==this.getNumInteriorRing())return!1;if(null===this.shell)return!1;if(5!==this.shell.getNumPoints())return!1;for(var t=this.shell.getCoordinateSequence(),e=this.getEnvelopeInternal(),n=0;5>n;n++){if((s=t.getX(n))!==e.getMinX()&&s!==e.getMaxX())return!1;if((o=t.getY(n))!==e.getMinY()&&o!==e.getMaxY())return!1}var i=t.getX(0),r=t.getY(0);for(n=1;4>=n;n++){var s,o;if((s=t.getX(n))!==i==((o=t.getY(n))!==r))return!1;i=s,r=o}return!0},equalsExact:function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];if(!this.isEquivalentClass(t))return!1;var n=t,i=this.shell,r=n.shell;if(!i.equalsExact(r,e))return!1;if(this.holes.length!==n.holes.length)return!1;for(var s=0;s<this.holes.length;s++)if(!this.holes[s].equalsExact(n.holes[s],e))return!1;return!0}return G.prototype.equalsExact.apply(this,arguments)},normalize:function(){if(0===arguments.length){this.normalize(this.shell,!0);for(var t=0;t<this.holes.length;t++)this.normalize(this.holes[t],!1);lt.sort(this.holes)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(e.isEmpty())return null;var i=new Array(e.getCoordinates().length-1).fill(null);O.arraycopy(e.getCoordinates(),0,i,0,i.length);var r=j.minCoordinate(e.getCoordinates());j.scroll(i,r),O.arraycopy(i,0,e.getCoordinates(),0,i.length),e.getCoordinates()[i.length]=i[0],Qt.isCCW(e.getCoordinates())===n&&j.reverse(e.getCoordinates())}},getCoordinate:function(){return this.shell.getCoordinate()},getNumInteriorRing:function(){return this.holes.length},getBoundaryDimension:function(){return 1},getDimension:function(){return 2},getLength:function(){var t=0;t+=this.shell.getLength();for(var e=0;e<this.holes.length;e++)t+=this.holes[e].getLength();return t},getNumPoints:function(){for(var t=this.shell.getNumPoints(),e=0;e<this.holes.length;e++)t+=this.holes[e].getNumPoints();return t},reverse:function(){var t=this.copy();t.shell=this.shell.copy().reverse(),t.holes=new Array(this.holes.length).fill(null);for(var e=0;e<this.holes.length;e++)t.holes[e]=this.holes[e].copy().reverse();return t},convexHull:function(){return this.getExteriorRing().convexHull()},compareToSameClass:function(){if(1===arguments.length){var t=arguments[0],e=this.shell,n=t.shell;return e.compareToSameClass(n)}if(2===arguments.length){var i=arguments[1],r=arguments[0],s=(e=this.shell,n=r.shell,e.compareToSameClass(n,i));if(0!==s)return s;for(var o=this.getNumInteriorRing(),a=r.getNumInteriorRing(),l=0;o>l&&a>l;){var h=this.getInteriorRingN(l),u=r.getInteriorRingN(l),c=h.compareToSameClass(u,i);if(0!==c)return c;l++}return o>l?1:a>l?-1:0}},apply:function(){if(M(arguments[0],B)){var t=arguments[0];this.shell.apply(t);for(var e=0;e<this.holes.length;e++)this.holes[e].apply(t)}else if(M(arguments[0],ct)){var n=arguments[0];if(this.shell.apply(n),!n.isDone())for(e=0;e<this.holes.length&&(this.holes[e].apply(n),!n.isDone());e++);n.isGeometryChanged()&&this.geometryChanged()}else if(M(arguments[0],ut))arguments[0].filter(this);else if(M(arguments[0],z)){var i=arguments[0];for(i.filter(this),this.shell.apply(i),e=0;e<this.holes.length;e++)this.holes[e].apply(i)}},getBoundary:function(){if(this.isEmpty())return this.getFactory().createMultiLineString();var t=new Array(this.holes.length+1).fill(null);t[0]=this.shell;for(var e=0;e<this.holes.length;e++)t[e+1]=this.holes[e];return t.length<=1?this.getFactory().createLinearRing(t[0].getCoordinateSequence()):this.getFactory().createMultiLineString(t)},clone:function(){var t=G.prototype.clone.call(this);t.shell=this.shell.clone(),t.holes=new Array(this.holes.length).fill(null);for(var e=0;e<this.holes.length;e++)t.holes[e]=this.holes[e].clone();return t},getGeometryType:function(){return"Polygon"},copy:function(){for(var t=this.shell.copy(),e=new Array(this.holes.length).fill(null),n=0;n<e.length;n++)e[n]=this.holes[n].copy();return new Mt(t,e,this.factory)},getExteriorRing:function(){return this.shell},isEmpty:function(){return this.shell.isEmpty()},getInteriorRingN:function(t){return this.holes[t]},interfaces_:function(){return[Ct]},getClass:function(){return Mt}}),Mt.serialVersionUID=-0x307ffefd8dc97200,u(Rt,ft),e(Rt.prototype,{getSortIndex:function(){return G.SORTINDEX_MULTIPOINT},isValid:function(){return!0},equalsExact:function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return!!this.isEquivalentClass(t)&&ft.prototype.equalsExact.call(this,t,e)}return ft.prototype.equalsExact.apply(this,arguments)},getCoordinate:function(){if(1===arguments.length){var t=arguments[0];return this.geometries[t].getCoordinate()}return ft.prototype.getCoordinate.apply(this,arguments)},getBoundaryDimension:function(){return ht.FALSE},getDimension:function(){return 0},getBoundary:function(){return this.getFactory().createGeometryCollection(null)},getGeometryType:function(){return"MultiPoint"},copy:function(){for(var t=new Array(this.geometries.length).fill(null),e=0;e<t.length;e++)t[e]=this.geometries[e].copy();return new Rt(t,this.factory)},interfaces_:function(){return[St]},getClass:function(){return Rt}}),Rt.serialVersionUID=-0x6fb1ed4162e0fc00,u(Pt,Et),e(Pt.prototype,{getSortIndex:function(){return G.SORTINDEX_LINEARRING},getBoundaryDimension:function(){return ht.FALSE},isClosed:function(){return!!this.isEmpty()||Et.prototype.isClosed.call(this)},reverse:function(){var t=this.points.copy();return bt.reverse(t),this.getFactory().createLinearRing(t)},validateConstruction:function(){if(!this.isEmpty()&&!Et.prototype.isClosed.call(this))throw new i("Points of LinearRing do not form a closed linestring");if(this.getCoordinateSequence().size()>=1&&this.getCoordinateSequence().size()<Pt.MINIMUM_VALID_SIZE)throw new i("Invalid number of points in LinearRing (found "+this.getCoordinateSequence().size()+" - must be 0 or >= 4)")},getGeometryType:function(){return"LinearRing"},copy:function(){return new Pt(this.points.copy(),this.factory)},interfaces_:function(){return[]},getClass:function(){return Pt}}),Pt.MINIMUM_VALID_SIZE=4,Pt.serialVersionUID=-0x3b229e262367a600,u(Tt,ft),e(Tt.prototype,{getSortIndex:function(){return G.SORTINDEX_MULTIPOLYGON},equalsExact:function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return!!this.isEquivalentClass(t)&&ft.prototype.equalsExact.call(this,t,e)}return ft.prototype.equalsExact.apply(this,arguments)},getBoundaryDimension:function(){return 1},getDimension:function(){return 2},reverse:function(){for(var t=this.geometries.length,e=new Array(t).fill(null),n=0;n<this.geometries.length;n++)e[n]=this.geometries[n].reverse();return this.getFactory().createMultiPolygon(e)},getBoundary:function(){if(this.isEmpty())return this.getFactory().createMultiLineString();for(var t=new _,e=0;e<this.geometries.length;e++)for(var n=this.geometries[e].getBoundary(),i=0;i<n.getNumGeometries();i++)t.add(n.getGeometryN(i));var r=new Array(t.size()).fill(null);return this.getFactory().createMultiLineString(t.toArray(r))},getGeometryType:function(){return"MultiPolygon"},copy:function(){for(var t=new Array(this.geometries.length).fill(null),e=0;e<t.length;e++)t[e]=this.geometries[e].copy();return new Tt(t,this.factory)},interfaces_:function(){return[Ct]},getClass:function(){return Tt}}),Tt.serialVersionUID=-0x7a5aa1369171980,e(Nt.prototype,{setCopyUserData:function(t){this.isUserDataCopied=t},edit:function(t,e){if(null===t)return null;var n=this.editInternal(t,e);return this.isUserDataCopied&&n.setUserData(t.getUserData()),n},editInternal:function(t,e){return null===this.factory&&(this.factory=t.getFactory()),t instanceof ft?this.editGeometryCollection(t,e):t instanceof Mt?this.editPolygon(t,e):t instanceof It||t instanceof Et?e.edit(t,this.factory):(f.shouldNeverReachHere("Unsupported Geometry class: "+t.getClass().getName()),null)},editGeometryCollection:function(t,e){for(var n=e.edit(t,this.factory),i=new _,r=0;r<n.getNumGeometries();r++){var s=this.edit(n.getGeometryN(r),e);null===s||s.isEmpty()||i.add(s)}return n.getClass()===Rt?this.factory.createMultiPoint(i.toArray([])):n.getClass()===dt?this.factory.createMultiLineString(i.toArray([])):n.getClass()===Tt?this.factory.createMultiPolygon(i.toArray([])):this.factory.createGeometryCollection(i.toArray([]))},editPolygon:function(t,e){var n=e.edit(t,this.factory);if(null===n&&(n=this.factory.createPolygon(null)),n.isEmpty())return n;var i=this.edit(n.getExteriorRing(),e);if(null===i||i.isEmpty())return this.factory.createPolygon();for(var r=new _,s=0;s<n.getNumInteriorRing();s++){var o=this.edit(n.getInteriorRingN(s),e);null===o||o.isEmpty()||r.add(o)}return this.factory.createPolygon(i,r.toArray([]))},interfaces_:function(){return[]},getClass:function(){return Nt}}),Nt.GeometryEditorOperation=At,e(kt.prototype,{edit:function(t,e){return t},interfaces_:function(){return[At]},getClass:function(){return kt}}),e(Lt.prototype,{edit:function(t,e){if(t instanceof Pt)return e.createLinearRing(this.editCoordinates(t.getCoordinates(),t));if(t instanceof Et)return e.createLineString(this.editCoordinates(t.getCoordinates(),t));if(t instanceof It){var n=this.editCoordinates(t.getCoordinates(),t);return n.length>0?e.createPoint(n[0]):e.createPoint()}return t},interfaces_:function(){return[At]},getClass:function(){return Lt}}),e(Ot.prototype,{edit:function(t,e){return t instanceof Pt?e.createLinearRing(this.edit(t.getCoordinateSequence(),t)):t instanceof Et?e.createLineString(this.edit(t.getCoordinateSequence(),t)):t instanceof It?e.createPoint(this.edit(t.getCoordinateSequence(),t)):t},interfaces_:function(){return[At]},getClass:function(){return Ot}}),Nt.NoOpGeometryOperation=kt,Nt.CoordinateOperation=Lt,Nt.CoordinateSequenceOperation=Ot,e(Dt.prototype,{setOrdinate:function(t,e,n){switch(e){case L.X:this.coordinates[t].x=n;break;case L.Y:this.coordinates[t].y=n;break;case L.Z:this.coordinates[t].z=n;break;default:throw new i("invalid ordinateIndex")}},size:function(){return this.coordinates.length},getOrdinate:function(t,e){switch(e){case L.X:return this.coordinates[t].x;case L.Y:return this.coordinates[t].y;case L.Z:return this.coordinates[t].z}return r.NaN},getCoordinate:function(){if(1===arguments.length){var t=arguments[0];return this.coordinates[t]}if(2===arguments.length){var e=arguments[0],n=arguments[1];n.x=this.coordinates[e].x,n.y=this.coordinates[e].y,n.z=this.coordinates[e].z}},getCoordinateCopy:function(t){return new d(this.coordinates[t])},getDimension:function(){return this.dimension},getX:function(t){return this.coordinates[t].x},clone:function(){for(var t=new Array(this.size()).fill(null),e=0;e<this.coordinates.length;e++)t[e]=this.coordinates[e].clone();return new Dt(t,this.dimension)},expandEnvelope:function(t){for(var e=0;e<this.coordinates.length;e++)t.expandToInclude(this.coordinates[e]);return t},copy:function(){for(var t=new Array(this.size()).fill(null),e=0;e<this.coordinates.length;e++)t[e]=this.coordinates[e].copy();return new Dt(t,this.dimension)},toString:function(){if(this.coordinates.length>0){var t=new P(17*this.coordinates.length);t.append("("),t.append(this.coordinates[0]);for(var e=1;e<this.coordinates.length;e++)t.append(", "),t.append(this.coordinates[e]);return t.append(")"),t.toString()}return"()"},getY:function(t){return this.coordinates[t].y},toCoordinateArray:function(){return this.coordinates},interfaces_:function(){return[L,l]},getClass:function(){return Dt}}),Dt.serialVersionUID=-0xcb44a778db18e00,e(Ft.prototype,{readResolve:function(){return Ft.instance()},create:function(){if(1===arguments.length){if(arguments[0]instanceof Array)return new Dt(arguments[0]);if(M(arguments[0],L))return new Dt(arguments[0])}else if(2===arguments.length){var t=arguments[0],e=arguments[1];return e>3&&(e=3),2>e?new Dt(t):new Dt(t,e)}},interfaces_:function(){return[F,l]},getClass:function(){return Ft}}),Ft.instance=function(){return Ft.instanceObject},Ft.serialVersionUID=-0x38e49fa6cf6f2e00,Ft.instanceObject=new Ft;var qs,Vs=Object.defineProperty,Ys=function(t,e){function n(t){return this&&this.constructor===n?(this._keys=[],this._values=[],this._itp=[],this.objectOnly=e,void(t&&Gt.call(this,t))):new n(t)}return e||Vs(t,"size",{get:qt}),t.constructor=n,n.prototype=t,n}({delete:function(t){return this.has(t)&&(this._keys.splice(qs,1),this._values.splice(qs,1),this._itp.forEach((function(t){qs<t[0]&&t[0]--}))),qs>-1},has:function(t){return Bt.call(this,this._keys,t)},get:function(t){return this.has(t)?this._values[qs]:void 0},set:function(t,e){return this.has(t)?this._values[qs]=e:this._values[this._keys.push(t)-1]=e,this},keys:function(){return Ut(this._itp,this._keys)},values:function(){return Ut(this._itp,this._values)},entries:function(){return Ut(this._itp,this._keys,this._values)},forEach:function(t,e){for(var n=this.entries();;){var i=n.next();if(i.done)break;t.call(e,i.value[1],i.value[0],this)}},clear:function(){(this._keys||0).length=this._values.length=0}}),Xs="undefined"!=typeof Map&&Map.prototype.values?Map:Ys;Vt.prototype=new $,Vt.prototype.get=function(t){return this.map_.get(t)||null},Vt.prototype.put=function(t,e){return this.map_.set(t,e),e},Vt.prototype.values=function(){for(var t=new _,e=this.map_.values(),n=e.next();!n.done;)t.add(n.value),n=e.next();return t},Vt.prototype.entrySet=function(){var t=new J;return this.map_.entries().forEach((function(e){return t.add(e)})),t},Vt.prototype.size=function(){return this.map_.size()},e(Yt.prototype,{equals:function(t){if(!(t instanceof Yt))return!1;var e=t;return this.modelType===e.modelType&&this.scale===e.scale},compareTo:function(t){var e=t,n=this.getMaximumSignificantDigits(),i=e.getMaximumSignificantDigits();return new T(n).compareTo(new T(i))},getScale:function(){return this.scale},isFloating:function(){return this.modelType===Yt.FLOATING||this.modelType===Yt.FLOATING_SINGLE},getType:function(){return this.modelType},toString:function(){var t="UNKNOWN";return this.modelType===Yt.FLOATING?t="Floating":this.modelType===Yt.FLOATING_SINGLE?t="Floating-Single":this.modelType===Yt.FIXED&&(t="Fixed (Scale="+this.getScale()+")"),t},makePrecise:function(){if("number"==typeof arguments[0]){var t=arguments[0];return r.isNaN(t)||this.modelType===Yt.FLOATING_SINGLE?t:this.modelType===Yt.FIXED?Math.round(t*this.scale)/this.scale:t}if(arguments[0]instanceof d){var e=arguments[0];if(this.modelType===Yt.FLOATING)return null;e.x=this.makePrecise(e.x),e.y=this.makePrecise(e.y)}},getMaximumSignificantDigits:function(){var t=16;return this.modelType===Yt.FLOATING?t=16:this.modelType===Yt.FLOATING_SINGLE?t=6:this.modelType===Yt.FIXED&&(t=1+Math.trunc(Math.ceil(Math.log(this.getScale())/Math.log(10)))),t},setScale:function(t){this.scale=Math.abs(t)},interfaces_:function(){return[l,s]},getClass:function(){return Yt}}),Yt.mostPrecise=function(t,e){return t.compareTo(e)>=0?t:e},e(Xt.prototype,{readResolve:function(){return Xt.nameToTypeMap.get(this.name)},toString:function(){return this.name},interfaces_:function(){return[l]},getClass:function(){return Xt}}),Xt.serialVersionUID=-552860263173159e4,Xt.nameToTypeMap=new Vt,Yt.Type=Xt,Yt.serialVersionUID=0x6bee6404e9a25c00,Yt.FIXED=new Xt("FIXED"),Yt.FLOATING=new Xt("FLOATING"),Yt.FLOATING_SINGLE=new Xt("FLOATING SINGLE"),Yt.maximumPreciseValue=9007199254740992,e(jt.prototype,{toGeometry:function(t){return t.isNull()?this.createPoint(null):t.getMinX()===t.getMaxX()&&t.getMinY()===t.getMaxY()?this.createPoint(new d(t.getMinX(),t.getMinY())):t.getMinX()===t.getMaxX()||t.getMinY()===t.getMaxY()?this.createLineString([new d(t.getMinX(),t.getMinY()),new d(t.getMaxX(),t.getMaxY())]):this.createPolygon(this.createLinearRing([new d(t.getMinX(),t.getMinY()),new d(t.getMinX(),t.getMaxY()),new d(t.getMaxX(),t.getMaxY()),new d(t.getMaxX(),t.getMinY()),new d(t.getMinX(),t.getMinY())]),null)},createLineString:function(){if(0===arguments.length)return this.createLineString(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof Array){var t=arguments[0];return this.createLineString(null!==t?this.getCoordinateSequenceFactory().create(t):null)}if(M(arguments[0],L))return new Et(arguments[0],this)}},createMultiLineString:function(){return 0===arguments.length?new dt(null,this):1===arguments.length?new dt(arguments[0],this):void 0},buildGeometry:function(t){for(var e=null,n=!1,i=!1,r=t.iterator();r.hasNext();){var s=r.next(),o=s.getClass();null===e&&(e=o),o!==e&&(n=!0),s.isGeometryCollectionOrDerived()&&(i=!0)}if(null===e)return this.createGeometryCollection();if(n||i)return this.createGeometryCollection(jt.toGeometryArray(t));var a=t.iterator().next();if(t.size()>1){if(a instanceof Mt)return this.createMultiPolygon(jt.toPolygonArray(t));if(a instanceof Et)return this.createMultiLineString(jt.toLineStringArray(t));if(a instanceof It)return this.createMultiPoint(jt.toPointArray(t));f.shouldNeverReachHere("Unhandled class: "+a.getClass().getName())}return a},createMultiPointFromCoords:function(t){return this.createMultiPoint(null!==t?this.getCoordinateSequenceFactory().create(t):null)},createPoint:function(){if(0===arguments.length)return this.createPoint(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof d){var t=arguments[0];return this.createPoint(null!==t?this.getCoordinateSequenceFactory().create([t]):null)}if(M(arguments[0],L))return new It(arguments[0],this)}},getCoordinateSequenceFactory:function(){return this.coordinateSequenceFactory},createPolygon:function(){if(0===arguments.length)return new Mt(null,null,this);if(1===arguments.length){if(M(arguments[0],L)){var t=arguments[0];return this.createPolygon(this.createLinearRing(t))}if(arguments[0]instanceof Array){var e=arguments[0];return this.createPolygon(this.createLinearRing(e))}if(arguments[0]instanceof Pt){var n=arguments[0];return this.createPolygon(n,null)}}else if(2===arguments.length)return new Mt(arguments[0],arguments[1],this)},getSRID:function(){return this.SRID},createGeometryCollection:function(){return 0===arguments.length?new ft(null,this):1===arguments.length?new ft(arguments[0],this):void 0},createGeometry:function(t){return new Nt(this).edit(t,{edit:function(){if(2===arguments.length){var t=arguments[0];return this.coordinateSequenceFactory.create(t)}}})},getPrecisionModel:function(){return this.precisionModel},createLinearRing:function(){if(0===arguments.length)return this.createLinearRing(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof Array){var t=arguments[0];return this.createLinearRing(null!==t?this.getCoordinateSequenceFactory().create(t):null)}if(M(arguments[0],L))return new Pt(arguments[0],this)}},createMultiPolygon:function(){return 0===arguments.length?new Tt(null,this):1===arguments.length?new Tt(arguments[0],this):void 0},createMultiPoint:function(){if(0===arguments.length)return new Rt(null,this);if(1===arguments.length){if(arguments[0]instanceof Array)return new Rt(arguments[0],this);if(arguments[0]instanceof Array){var t=arguments[0];return this.createMultiPoint(null!==t?this.getCoordinateSequenceFactory().create(t):null)}if(M(arguments[0],L)){var e=arguments[0];if(null===e)return this.createMultiPoint(new Array(0).fill(null));for(var n=new Array(e.size()).fill(null),i=0;i<e.size();i++){var r=this.getCoordinateSequenceFactory().create(1,e.getDimension());bt.copy(e,i,r,0,1),n[i]=this.createPoint(r)}return this.createMultiPoint(n)}}},interfaces_:function(){return[l]},getClass:function(){return jt}}),jt.toMultiPolygonArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},jt.toGeometryArray=function(t){if(null===t)return null;var e=new Array(t.size()).fill(null);return t.toArray(e)},jt.getDefaultCoordinateSequenceFactory=function(){return Ft.instance()},jt.toMultiLineStringArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},jt.toLineStringArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},jt.toMultiPointArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},jt.toLinearRingArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},jt.toPointArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},jt.toPolygonArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},jt.createPointFromInternalCoord=function(t,e){return e.getPrecisionModel().makePrecise(t),e.getFactory().createPoint(t)},jt.serialVersionUID=-0x5ea75f2051eeb400;var js={typeStr:/^\s*(\w+)\s*\(\s*(.*)\s*\)\s*$/,emptyTypeStr:/^\s*(\w+)\s*EMPTY\s*$/,spaces:/\s+/,parenComma:/\)\s*,\s*\(/,doubleParenComma:/\)\s*\)\s*,\s*\(\s*\(/,trimParens:/^\s*\(?(.*?)\)?\s*$/};e(Wt.prototype,{read:function(t){var e,n,i;t=t.replace(/[\n\r]/g," ");var r=js.typeStr.exec(t);if(-1!==t.search("EMPTY")&&((r=js.emptyTypeStr.exec(t))[2]=void 0),r&&(n=r[1].toLowerCase(),i=r[2],Hs[n]&&(e=Hs[n].apply(this,[i]))),void 0===e)throw new Error("Could not parse WKT "+t);return e},write:function(t){return this.extractGeometry(t)},extractGeometry:function(t){var e=t.getGeometryType().toLowerCase();if(!Ws[e])return null;var n=e.toUpperCase();return t.isEmpty()?n+" EMPTY":n+"("+Ws[e].apply(this,[t])+")"}});var Ws={coordinate:function(t){return t.x+" "+t.y},point:function(t){return Ws.coordinate.call(this,t.coordinates.coordinates[0])},multipoint:function(t){for(var e=[],n=0,i=t.geometries.length;i>n;++n)e.push("("+Ws.point.apply(this,[t.geometries[n]])+")");return e.join(",")},linestring:function(t){for(var e=[],n=0,i=t.points.coordinates.length;i>n;++n)e.push(Ws.coordinate.apply(this,[t.points.coordinates[n]]));return e.join(",")},linearring:function(t){for(var e=[],n=0,i=t.points.coordinates.length;i>n;++n)e.push(Ws.coordinate.apply(this,[t.points.coordinates[n]]));return e.join(",")},multilinestring:function(t){for(var e=[],n=0,i=t.geometries.length;i>n;++n)e.push("("+Ws.linestring.apply(this,[t.geometries[n]])+")");return e.join(",")},polygon:function(t){var e=[];e.push("("+Ws.linestring.apply(this,[t.shell])+")");for(var n=0,i=t.holes.length;i>n;++n)e.push("("+Ws.linestring.apply(this,[t.holes[n]])+")");return e.join(",")},multipolygon:function(t){for(var e=[],n=0,i=t.geometries.length;i>n;++n)e.push("("+Ws.polygon.apply(this,[t.geometries[n]])+")");return e.join(",")},geometrycollection:function(t){for(var e=[],n=0,i=t.geometries.length;i>n;++n)e.push(this.extractGeometry(t.geometries[n]));return e.join(",")}},Hs={point:function(t){if(void 0===t)return this.geometryFactory.createPoint();var e=t.trim().split(js.spaces);return this.geometryFactory.createPoint(new d(Number.parseFloat(e[0]),Number.parseFloat(e[1])))},multipoint:function(t){if(void 0===t)return this.geometryFactory.createMultiPoint();for(var e,n=t.trim().split(","),i=[],r=0,s=n.length;s>r;++r)e=n[r].replace(js.trimParens,"$1"),i.push(Hs.point.apply(this,[e]));return this.geometryFactory.createMultiPoint(i)},linestring:function(t){if(void 0===t)return this.geometryFactory.createLineString();for(var e,n=t.trim().split(","),i=[],r=0,s=n.length;s>r;++r)e=n[r].trim().split(js.spaces),i.push(new d(Number.parseFloat(e[0]),Number.parseFloat(e[1])));return this.geometryFactory.createLineString(i)},linearring:function(t){if(void 0===t)return this.geometryFactory.createLinearRing();for(var e,n=t.trim().split(","),i=[],r=0,s=n.length;s>r;++r)e=n[r].trim().split(js.spaces),i.push(new d(Number.parseFloat(e[0]),Number.parseFloat(e[1])));return this.geometryFactory.createLinearRing(i)},multilinestring:function(t){if(void 0===t)return this.geometryFactory.createMultiLineString();for(var e,n=t.trim().split(js.parenComma),i=[],r=0,s=n.length;s>r;++r)e=n[r].replace(js.trimParens,"$1"),i.push(Hs.linestring.apply(this,[e]));return this.geometryFactory.createMultiLineString(i)},polygon:function(t){if(void 0===t)return this.geometryFactory.createPolygon();for(var e,n,i,r,s=t.trim().split(js.parenComma),o=[],a=0,l=s.length;l>a;++a)e=s[a].replace(js.trimParens,"$1"),n=Hs.linestring.apply(this,[e]),i=this.geometryFactory.createLinearRing(n.points),0===a?r=i:o.push(i);return this.geometryFactory.createPolygon(r,o)},multipolygon:function(t){if(void 0===t)return this.geometryFactory.createMultiPolygon();for(var e,n=t.trim().split(js.doubleParenComma),i=[],r=0,s=n.length;s>r;++r)e=n[r].replace(js.trimParens,"$1"),i.push(Hs.polygon.apply(this,[e]));return this.geometryFactory.createMultiPolygon(i)},geometrycollection:function(t){if(void 0===t)return this.geometryFactory.createGeometryCollection();for(var e=(t=t.replace(/,\s*([A-Za-z])/g,"|$1")).trim().split("|"),n=[],i=0,r=e.length;r>i;++i)n.push(this.read(e[i]));return this.geometryFactory.createGeometryCollection(n)}};e(Ht.prototype,{write:function(t){return this.parser.write(t)}}),e(Ht,{toLineString:function(t,e){if(2!==arguments.length)throw new Error("Not implemented");return"LINESTRING ( "+t.x+" "+t.y+", "+e.x+" "+e.y+" )"}}),e($t.prototype,{getIndexAlongSegment:function(t,e){return this.computeIntLineIndex(),this.intLineIndex[t][e]},getTopologySummary:function(){var t=new P;return this.isEndPoint()&&t.append(" endpoint"),this._isProper&&t.append(" proper"),this.isCollinear()&&t.append(" collinear"),t.toString()},computeIntersection:function(t,e,n,i){this.inputLines[0][0]=t,this.inputLines[0][1]=e,this.inputLines[1][0]=n,this.inputLines[1][1]=i,this.result=this.computeIntersect(t,e,n,i)},getIntersectionNum:function(){return this.result},computeIntLineIndex:function(){if(0===arguments.length)null===this.intLineIndex&&(this.intLineIndex=Array(2).fill().map((function(){return Array(2)})),this.computeIntLineIndex(0),this.computeIntLineIndex(1));else if(1===arguments.length){var t=arguments[0];this.getEdgeDistance(t,0)>this.getEdgeDistance(t,1)?(this.intLineIndex[t][0]=0,this.intLineIndex[t][1]=1):(this.intLineIndex[t][0]=1,this.intLineIndex[t][1]=0)}},isProper:function(){return this.hasIntersection()&&this._isProper},setPrecisionModel:function(t){this.precisionModel=t},isInteriorIntersection:function(){if(0===arguments.length)return!!this.isInteriorIntersection(0)||!!this.isInteriorIntersection(1);if(1===arguments.length){for(var t=arguments[0],e=0;e<this.result;e++)if(!this.intPt[e].equals2D(this.inputLines[t][0])&&!this.intPt[e].equals2D(this.inputLines[t][1]))return!0;return!1}},getIntersection:function(t){return this.intPt[t]},isEndPoint:function(){return this.hasIntersection()&&!this._isProper},hasIntersection:function(){return this.result!==$t.NO_INTERSECTION},getEdgeDistance:function(t,e){return $t.computeEdgeDistance(this.intPt[e],this.inputLines[t][0],this.inputLines[t][1])},isCollinear:function(){return this.result===$t.COLLINEAR_INTERSECTION},toString:function(){return Ht.toLineString(this.inputLines[0][0],this.inputLines[0][1])+" - "+Ht.toLineString(this.inputLines[1][0],this.inputLines[1][1])+this.getTopologySummary()},getEndpoint:function(t,e){return this.inputLines[t][e]},isIntersection:function(t){for(var e=0;e<this.result;e++)if(this.intPt[e].equals2D(t))return!0;return!1},getIntersectionAlongSegment:function(t,e){return this.computeIntLineIndex(),this.intPt[this.intLineIndex[t][e]]},interfaces_:function(){return[]},getClass:function(){return $t}}),$t.computeEdgeDistance=function(t,e,n){var i=Math.abs(n.x-e.x),r=Math.abs(n.y-e.y),s=-1;if(t.equals(e))s=0;else if(t.equals(n))s=i>r?i:r;else{var o=Math.abs(t.x-e.x),a=Math.abs(t.y-e.y);0!==(s=i>r?o:a)||t.equals(e)||(s=Math.max(o,a))}return f.isTrue(!(0===s&&!t.equals(e)),"Bad distance calculation"),s},$t.nonRobustComputeEdgeDistance=function(t,e,n){var i=t.x-e.x,r=t.y-e.y,s=Math.sqrt(i*i+r*r);return f.isTrue(!(0===s&&!t.equals(e)),"Invalid distance calculation"),s},$t.DONT_INTERSECT=0,$t.DO_INTERSECT=1,$t.COLLINEAR=2,$t.NO_INTERSECTION=0,$t.POINT_INTERSECTION=1,$t.COLLINEAR_INTERSECTION=2,u(Zt,$t),e(Zt.prototype,{isInSegmentEnvelopes:function(t){var e=new E(this.inputLines[0][0],this.inputLines[0][1]),n=new E(this.inputLines[1][0],this.inputLines[1][1]);return e.contains(t)&&n.contains(t)},computeIntersection:function(){if(3!==arguments.length)return $t.prototype.computeIntersection.apply(this,arguments);var t=arguments[0],e=arguments[1],n=arguments[2];return this._isProper=!1,E.intersects(e,n,t)&&0===Qt.orientationIndex(e,n,t)&&0===Qt.orientationIndex(n,e,t)?(this._isProper=!0,(t.equals(e)||t.equals(n))&&(this._isProper=!1),this.result=$t.POINT_INTERSECTION,null):void(this.result=$t.NO_INTERSECTION)},normalizeToMinimum:function(t,e,n,i,r){r.x=this.smallestInAbsValue(t.x,e.x,n.x,i.x),r.y=this.smallestInAbsValue(t.y,e.y,n.y,i.y),t.x-=r.x,t.y-=r.y,e.x-=r.x,e.y-=r.y,n.x-=r.x,n.y-=r.y,i.x-=r.x,i.y-=r.y},safeHCoordinateIntersection:function(t,e,n,i){var r=null;try{r=D.intersection(t,e,n,i)}catch(s){if(!(s instanceof I))throw s;r=Zt.nearestEndpoint(t,e,n,i)}return r},intersection:function(t,e,n,i){var r=this.intersectionWithNormalization(t,e,n,i);return this.isInSegmentEnvelopes(r)||(r=new d(Zt.nearestEndpoint(t,e,n,i))),null!==this.precisionModel&&this.precisionModel.makePrecise(r),r},smallestInAbsValue:function(t,e,n,i){var r=t,s=Math.abs(r);return Math.abs(e)<s&&(r=e,s=Math.abs(e)),Math.abs(n)<s&&(r=n,s=Math.abs(n)),Math.abs(i)<s&&(r=i),r},checkDD:function(t,e,n,i,r){var s=k.intersection(t,e,n,i),o=this.isInSegmentEnvelopes(s);O.out.println("DD in env = "+o+"  --------------------- "+s),r.distance(s)>1e-4&&O.out.println("Distance = "+r.distance(s))},intersectionWithNormalization:function(t,e,n,i){var r=new d(t),s=new d(e),o=new d(n),a=new d(i),l=new d;this.normalizeToEnvCentre(r,s,o,a,l);var h=this.safeHCoordinateIntersection(r,s,o,a);return h.x+=l.x,h.y+=l.y,h},computeCollinearIntersection:function(t,e,n,i){var r=E.intersects(t,e,n),s=E.intersects(t,e,i),o=E.intersects(n,i,t),a=E.intersects(n,i,e);return r&&s?(this.intPt[0]=n,this.intPt[1]=i,$t.COLLINEAR_INTERSECTION):o&&a?(this.intPt[0]=t,this.intPt[1]=e,$t.COLLINEAR_INTERSECTION):r&&o?(this.intPt[0]=n,this.intPt[1]=t,!n.equals(t)||s||a?$t.COLLINEAR_INTERSECTION:$t.POINT_INTERSECTION):r&&a?(this.intPt[0]=n,this.intPt[1]=e,!n.equals(e)||s||o?$t.COLLINEAR_INTERSECTION:$t.POINT_INTERSECTION):s&&o?(this.intPt[0]=i,this.intPt[1]=t,!i.equals(t)||r||a?$t.COLLINEAR_INTERSECTION:$t.POINT_INTERSECTION):s&&a?(this.intPt[0]=i,this.intPt[1]=e,!i.equals(e)||r||o?$t.COLLINEAR_INTERSECTION:$t.POINT_INTERSECTION):$t.NO_INTERSECTION},normalizeToEnvCentre:function(t,e,n,i,r){var s=t.x<e.x?t.x:e.x,o=t.y<e.y?t.y:e.y,a=t.x>e.x?t.x:e.x,l=t.y>e.y?t.y:e.y,h=n.x<i.x?n.x:i.x,u=n.y<i.y?n.y:i.y,c=n.x>i.x?n.x:i.x,f=n.y>i.y?n.y:i.y,d=((s>h?s:h)+(c>a?a:c))/2,g=((o>u?o:u)+(f>l?l:f))/2;r.x=d,r.y=g,t.x-=r.x,t.y-=r.y,e.x-=r.x,e.y-=r.y,n.x-=r.x,n.y-=r.y,i.x-=r.x,i.y-=r.y},computeIntersect:function(t,e,n,i){if(this._isProper=!1,!E.intersects(t,e,n,i))return $t.NO_INTERSECTION;var r=Qt.orientationIndex(t,e,n),s=Qt.orientationIndex(t,e,i);if(r>0&&s>0||0>r&&0>s)return $t.NO_INTERSECTION;var o=Qt.orientationIndex(n,i,t),a=Qt.orientationIndex(n,i,e);return o>0&&a>0||0>o&&0>a?$t.NO_INTERSECTION:0===r&&0===s&&0===o&&0===a?this.computeCollinearIntersection(t,e,n,i):(0===r||0===s||0===o||0===a?(this._isProper=!1,t.equals2D(n)||t.equals2D(i)?this.intPt[0]=t:e.equals2D(n)||e.equals2D(i)?this.intPt[0]=e:0===r?this.intPt[0]=new d(n):0===s?this.intPt[0]=new d(i):0===o?this.intPt[0]=new d(t):0===a&&(this.intPt[0]=new d(e))):(this._isProper=!0,this.intPt[0]=this.intersection(t,e,n,i)),$t.POINT_INTERSECTION)},interfaces_:function(){return[]},getClass:function(){return Zt}}),Zt.nearestEndpoint=function(t,e,n,i){var r=t,s=Qt.distancePointLine(t,n,i),o=Qt.distancePointLine(e,n,i);return s>o&&(s=o,r=e),s>(o=Qt.distancePointLine(n,t,e))&&(s=o,r=n),s>(o=Qt.distancePointLine(i,t,e))&&(s=o,r=i),r},e(Kt.prototype,{interfaces_:function(){return[]},getClass:function(){return Kt}}),Kt.orientationIndex=function(t,e,n){var i=e.x-t.x,r=e.y-t.y,s=n.x-e.x,o=n.y-e.y;return Kt.signOfDet2x2(i,r,s,o)},Kt.signOfDet2x2=function(t,e,n,i){var r=null,s=null,o=null;if(r=1,0===t||0===i)return 0===e||0===n?0:e>0?n>0?-r:r:n>0?r:-r;if(0===e||0===n)return i>0?t>0?r:-r:t>0?-r:r;if(e>0?i>0?i>=e||(r=-r,s=t,t=n,n=s,s=e,e=i,i=s):-i>=e?(r=-r,n=-n,i=-i):(s=t,t=-n,n=s,s=e,e=-i,i=s):i>0?i>=-e?(r=-r,t=-t,e=-e):(s=-t,t=n,n=s,s=-e,e=i,i=s):e>=i?(t=-t,e=-e,n=-n,i=-i):(r=-r,s=-t,t=-n,n=s,s=-e,e=-i,i=s),t>0){if(!(n>0))return r;if(!(n>=t))return r}else{if(n>0)return-r;if(!(t>=n))return-r;r=-r,t=-t,n=-n}for(;;){if(0>(i-=(o=Math.floor(n/t))*e))return-r;if(i>e)return r;if(t>(n-=o*t)+n){if(i+i>e)return r}else{if(e>i+i)return-r;n=t-n,i=e-i,r=-r}if(0===i)return 0===n?0:-r;if(0===n)return r;if(0>(e-=(o=Math.floor(t/n))*i))return r;if(e>i)return-r;if(n>(t-=o*n)+t){if(e+e>i)return-r}else{if(i>e+e)return r;t=n-t,e=i-e,r=-r}if(0===e)return 0===t?0:r;if(0===t)return-r}},e(Jt.prototype,{countSegment:function(t,e){if(t.x<this.p.x&&e.x<this.p.x)return null;if(this.p.x===e.x&&this.p.y===e.y)return this.isPointOnSegment=!0,null;if(t.y===this.p.y&&e.y===this.p.y){var n=t.x,i=e.x;return n>i&&(n=e.x,i=t.x),this.p.x>=n&&this.p.x<=i&&(this.isPointOnSegment=!0),null}if(t.y>this.p.y&&e.y<=this.p.y||e.y>this.p.y&&t.y<=this.p.y){var r=t.x-this.p.x,s=t.y-this.p.y,o=e.x-this.p.x,a=e.y-this.p.y,l=Kt.signOfDet2x2(r,s,o,a);if(0===l)return this.isPointOnSegment=!0,null;s>a&&(l=-l),l>0&&this.crossingCount++}},isPointInPolygon:function(){return this.getLocation()!==C.EXTERIOR},getLocation:function(){return this.isPointOnSegment?C.BOUNDARY:this.crossingCount%2==1?C.INTERIOR:C.EXTERIOR},isOnSegment:function(){return this.isPointOnSegment},interfaces_:function(){return[]},getClass:function(){return Jt}}),Jt.locatePointInRing=function(){if(arguments[0]instanceof d&&M(arguments[1],L)){for(var t=arguments[1],e=new Jt(arguments[0]),n=new d,i=new d,r=1;r<t.size();r++)if(t.getCoordinate(r,n),t.getCoordinate(r-1,i),e.countSegment(n,i),e.isOnSegment())return e.getLocation();return e.getLocation()}if(arguments[0]instanceof d&&arguments[1]instanceof Array){var s=arguments[1];for(e=new Jt(arguments[0]),r=1;r<s.length;r++)if(n=s[r],i=s[r-1],e.countSegment(n,i),e.isOnSegment())return e.getLocation();return e.getLocation()}},e(Qt.prototype,{interfaces_:function(){return[]},getClass:function(){return Qt}}),Qt.orientationIndex=function(t,e,n){return k.orientationIndex(t,e,n)},Qt.signedArea=function(){if(arguments[0]instanceof Array){var t=arguments[0];if(t.length<3)return 0;for(var e=0,n=t[0].x,i=1;i<t.length-1;i++){var r=t[i].x-n,s=t[i+1].y;e+=r*(t[i-1].y-s)}return e/2}if(M(arguments[0],L)){var o=arguments[0],a=o.size();if(3>a)return 0;var l=new d,h=new d,u=new d;for(o.getCoordinate(0,h),o.getCoordinate(1,u),n=h.x,u.x-=n,e=0,i=1;a-1>i;i++)l.y=h.y,h.x=u.x,h.y=u.y,o.getCoordinate(i+1,u),u.x-=n,e+=h.x*(l.y-u.y);return e/2}},Qt.distanceLineLine=function(t,e,n,i){if(t.equals(e))return Qt.distancePointLine(t,n,i);if(n.equals(i))return Qt.distancePointLine(i,t,e);var r=!1;if(E.intersects(t,e,n,i)){var s=(e.x-t.x)*(i.y-n.y)-(e.y-t.y)*(i.x-n.x);if(0===s)r=!0;else{var o=(t.y-n.y)*(i.x-n.x)-(t.x-n.x)*(i.y-n.y),a=((t.y-n.y)*(e.x-t.x)-(t.x-n.x)*(e.y-t.y))/s,l=o/s;(0>l||l>1||0>a||a>1)&&(r=!0)}}else r=!0;return r?R.min(Qt.distancePointLine(t,n,i),Qt.distancePointLine(e,n,i),Qt.distancePointLine(n,t,e),Qt.distancePointLine(i,t,e)):0},Qt.isPointInRing=function(t,e){return Qt.locatePointInRing(t,e)!==C.EXTERIOR},Qt.computeLength=function(t){var e=t.size();if(1>=e)return 0;var n=0,i=new d;t.getCoordinate(0,i);for(var r=i.x,s=i.y,o=1;e>o;o++){t.getCoordinate(o,i);var a=i.x,l=i.y,h=a-r,u=l-s;n+=Math.sqrt(h*h+u*u),r=a,s=l}return n},Qt.isCCW=function(t){var e=t.length-1;if(3>e)throw new i("Ring has fewer than 4 points, so orientation cannot be determined");for(var n=t[0],r=0,s=1;e>=s;s++){var o=t[s];o.y>n.y&&(n=o,r=s)}var a=r;do{0>(a-=1)&&(a=e)}while(t[a].equals2D(n)&&a!==r);var l=r;do{l=(l+1)%e}while(t[l].equals2D(n)&&l!==r);var h=t[a],u=t[l];if(h.equals2D(n)||u.equals2D(n)||h.equals2D(u))return!1;var c=Qt.computeOrientation(h,n,u);return 0===c?h.x>u.x:c>0},Qt.locatePointInRing=function(t,e){return Jt.locatePointInRing(t,e)},Qt.distancePointLinePerpendicular=function(t,e,n){var i=(n.x-e.x)*(n.x-e.x)+(n.y-e.y)*(n.y-e.y),r=((e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y))/i;return Math.abs(r)*Math.sqrt(i)},Qt.computeOrientation=function(t,e,n){return Qt.orientationIndex(t,e,n)},Qt.distancePointLine=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];if(0===e.length)throw new i("Line array must contain at least one vertex");for(var n=t.distance(e[0]),r=0;r<e.length-1;r++){var s=Qt.distancePointLine(t,e[r],e[r+1]);n>s&&(n=s)}return n}if(3===arguments.length){var o=arguments[0],a=arguments[1],l=arguments[2];if(a.x===l.x&&a.y===l.y)return o.distance(a);var h=(l.x-a.x)*(l.x-a.x)+(l.y-a.y)*(l.y-a.y),u=((o.x-a.x)*(l.x-a.x)+(o.y-a.y)*(l.y-a.y))/h;if(0>=u)return o.distance(a);if(u>=1)return o.distance(l);var c=((a.y-o.y)*(l.x-a.x)-(a.x-o.x)*(l.y-a.y))/h;return Math.abs(c)*Math.sqrt(h)}},Qt.isOnLine=function(t,e){for(var n=new Zt,i=1;i<e.length;i++){var r=e[i-1],s=e[i];if(n.computeIntersection(t,r,s),n.hasIntersection())return!0}return!1},Qt.CLOCKWISE=-1,Qt.RIGHT=Qt.CLOCKWISE,Qt.COUNTERCLOCKWISE=1,Qt.LEFT=Qt.COUNTERCLOCKWISE,Qt.COLLINEAR=0,Qt.STRAIGHT=Qt.COLLINEAR,e(te.prototype,{minX:function(){return Math.min(this.p0.x,this.p1.x)},orientationIndex:function(){if(arguments[0]instanceof te){var t=arguments[0],e=Qt.orientationIndex(this.p0,this.p1,t.p0),n=Qt.orientationIndex(this.p0,this.p1,t.p1);return e>=0&&n>=0||0>=e&&0>=n?Math.max(e,n):0}if(arguments[0]instanceof d){var i=arguments[0];return Qt.orientationIndex(this.p0,this.p1,i)}},toGeometry:function(t){return t.createLineString([this.p0,this.p1])},isVertical:function(){return this.p0.x===this.p1.x},equals:function(t){if(!(t instanceof te))return!1;var e=t;return this.p0.equals(e.p0)&&this.p1.equals(e.p1)},intersection:function(t){var e=new Zt;return e.computeIntersection(this.p0,this.p1,t.p0,t.p1),e.hasIntersection()?e.getIntersection(0):null},project:function(){if(arguments[0]instanceof d){var t=arguments[0];if(t.equals(this.p0)||t.equals(this.p1))return new d(t);var e=this.projectionFactor(t),n=new d;return n.x=this.p0.x+e*(this.p1.x-this.p0.x),n.y=this.p0.y+e*(this.p1.y-this.p0.y),n}if(arguments[0]instanceof te){var i=arguments[0],r=this.projectionFactor(i.p0),s=this.projectionFactor(i.p1);if(r>=1&&s>=1)return null;if(0>=r&&0>=s)return null;var o=this.project(i.p0);0>r&&(o=this.p0),r>1&&(o=this.p1);var a=this.project(i.p1);return 0>s&&(a=this.p0),s>1&&(a=this.p1),new te(o,a)}},normalize:function(){this.p1.compareTo(this.p0)<0&&this.reverse()},angle:function(){return Math.atan2(this.p1.y-this.p0.y,this.p1.x-this.p0.x)},getCoordinate:function(t){return 0===t?this.p0:this.p1},distancePerpendicular:function(t){return Qt.distancePointLinePerpendicular(t,this.p0,this.p1)},minY:function(){return Math.min(this.p0.y,this.p1.y)},midPoint:function(){return te.midPoint(this.p0,this.p1)},projectionFactor:function(t){if(t.equals(this.p0))return 0;if(t.equals(this.p1))return 1;var e=this.p1.x-this.p0.x,n=this.p1.y-this.p0.y,i=e*e+n*n;return 0>=i?r.NaN:((t.x-this.p0.x)*e+(t.y-this.p0.y)*n)/i},closestPoints:function(t){var e=this.intersection(t);if(null!==e)return[e,e];var n=new Array(2).fill(null),i=r.MAX_VALUE,s=null,o=this.closestPoint(t.p0);i=o.distance(t.p0),n[0]=o,n[1]=t.p0;var a=this.closestPoint(t.p1);i>(s=a.distance(t.p1))&&(i=s,n[0]=a,n[1]=t.p1);var l=t.closestPoint(this.p0);i>(s=l.distance(this.p0))&&(i=s,n[0]=this.p0,n[1]=l);var h=t.closestPoint(this.p1);return i>(s=h.distance(this.p1))&&(i=s,n[0]=this.p1,n[1]=h),n},closestPoint:function(t){var e=this.projectionFactor(t);if(e>0&&1>e)return this.project(t);var n=this.p0.distance(t);return this.p1.distance(t)>n?this.p0:this.p1},maxX:function(){return Math.max(this.p0.x,this.p1.x)},getLength:function(){return this.p0.distance(this.p1)},compareTo:function(t){var e=t,n=this.p0.compareTo(e.p0);return 0!==n?n:this.p1.compareTo(e.p1)},reverse:function(){var t=this.p0;this.p0=this.p1,this.p1=t},equalsTopo:function(t){return this.p0.equals(t.p0)&&this.p1.equals(t.p1)||this.p0.equals(t.p1)&&this.p1.equals(t.p0)},lineIntersection:function(t){try{return D.intersection(this.p0,this.p1,t.p0,t.p1)}catch(t){if(!(t instanceof I))throw t}return null},maxY:function(){return Math.max(this.p0.y,this.p1.y)},pointAlongOffset:function(t,e){var n=this.p0.x+t*(this.p1.x-this.p0.x),i=this.p0.y+t*(this.p1.y-this.p0.y),r=this.p1.x-this.p0.x,s=this.p1.y-this.p0.y,o=Math.sqrt(r*r+s*s),a=0,l=0;if(0!==e){if(0>=o)throw new IllegalStateException("Cannot compute offset from zero-length line segment");a=e*r/o,l=e*s/o}return new d(n-l,i+a)},setCoordinates:function(){if(1===arguments.length){var t=arguments[0];this.setCoordinates(t.p0,t.p1)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.p0.x=e.x,this.p0.y=e.y,this.p1.x=n.x,this.p1.y=n.y}},segmentFraction:function(t){var e=this.projectionFactor(t);return 0>e?e=0:(e>1||r.isNaN(e))&&(e=1),e},toString:function(){return"LINESTRING( "+this.p0.x+" "+this.p0.y+", "+this.p1.x+" "+this.p1.y+")"},isHorizontal:function(){return this.p0.y===this.p1.y},distance:function(){if(arguments[0]instanceof te){var t=arguments[0];return Qt.distanceLineLine(this.p0,this.p1,t.p0,t.p1)}if(arguments[0]instanceof d){var e=arguments[0];return Qt.distancePointLine(e,this.p0,this.p1)}},pointAlong:function(t){var e=new d;return e.x=this.p0.x+t*(this.p1.x-this.p0.x),e.y=this.p0.y+t*(this.p1.y-this.p0.y),e},hashCode:function(){var t=java.lang.Double.doubleToLongBits(this.p0.x);t^=31*java.lang.Double.doubleToLongBits(this.p0.y);var e=Math.trunc(t)^Math.trunc(t>>32),n=java.lang.Double.doubleToLongBits(this.p1.x);return n^=31*java.lang.Double.doubleToLongBits(this.p1.y),e^Math.trunc(n)^Math.trunc(n>>32)},interfaces_:function(){return[s,l]},getClass:function(){return te}}),te.midPoint=function(t,e){return new d((t.x+e.x)/2,(t.y+e.y)/2)},te.serialVersionUID=0x2d2172135f411c00,e(ee.prototype,{isIntersects:function(){return!this.isDisjoint()},isCovers:function(){return(ee.isTrue(this.matrix[C.INTERIOR][C.INTERIOR])||ee.isTrue(this.matrix[C.INTERIOR][C.BOUNDARY])||ee.isTrue(this.matrix[C.BOUNDARY][C.INTERIOR])||ee.isTrue(this.matrix[C.BOUNDARY][C.BOUNDARY]))&&this.matrix[C.EXTERIOR][C.INTERIOR]===ht.FALSE&&this.matrix[C.EXTERIOR][C.BOUNDARY]===ht.FALSE},isCoveredBy:function(){return(ee.isTrue(this.matrix[C.INTERIOR][C.INTERIOR])||ee.isTrue(this.matrix[C.INTERIOR][C.BOUNDARY])||ee.isTrue(this.matrix[C.BOUNDARY][C.INTERIOR])||ee.isTrue(this.matrix[C.BOUNDARY][C.BOUNDARY]))&&this.matrix[C.INTERIOR][C.EXTERIOR]===ht.FALSE&&this.matrix[C.BOUNDARY][C.EXTERIOR]===ht.FALSE},set:function(){if(1===arguments.length)for(var t=arguments[0],e=0;e<t.length;e++){var n=Math.trunc(e/3),i=e%3;this.matrix[n][i]=ht.toDimensionValue(t.charAt(e))}else if(3===arguments.length){var r=arguments[0],s=arguments[1],o=arguments[2];this.matrix[r][s]=o}},isContains:function(){return ee.isTrue(this.matrix[C.INTERIOR][C.INTERIOR])&&this.matrix[C.EXTERIOR][C.INTERIOR]===ht.FALSE&&this.matrix[C.EXTERIOR][C.BOUNDARY]===ht.FALSE},setAtLeast:function(){if(1===arguments.length)for(var t=arguments[0],e=0;e<t.length;e++){var n=Math.trunc(e/3),i=e%3;this.setAtLeast(n,i,ht.toDimensionValue(t.charAt(e)))}else if(3===arguments.length){var r=arguments[0],s=arguments[1],o=arguments[2];this.matrix[r][s]<o&&(this.matrix[r][s]=o)}},setAtLeastIfValid:function(t,e,n){t>=0&&e>=0&&this.setAtLeast(t,e,n)},isWithin:function(){return ee.isTrue(this.matrix[C.INTERIOR][C.INTERIOR])&&this.matrix[C.INTERIOR][C.EXTERIOR]===ht.FALSE&&this.matrix[C.BOUNDARY][C.EXTERIOR]===ht.FALSE},isTouches:function(t,e){return t>e?this.isTouches(e,t):(t===ht.A&&e===ht.A||t===ht.L&&e===ht.L||t===ht.L&&e===ht.A||t===ht.P&&e===ht.A||t===ht.P&&e===ht.L)&&this.matrix[C.INTERIOR][C.INTERIOR]===ht.FALSE&&(ee.isTrue(this.matrix[C.INTERIOR][C.BOUNDARY])||ee.isTrue(this.matrix[C.BOUNDARY][C.INTERIOR])||ee.isTrue(this.matrix[C.BOUNDARY][C.BOUNDARY]))},isOverlaps:function(t,e){return t===ht.P&&e===ht.P||t===ht.A&&e===ht.A?ee.isTrue(this.matrix[C.INTERIOR][C.INTERIOR])&&ee.isTrue(this.matrix[C.INTERIOR][C.EXTERIOR])&&ee.isTrue(this.matrix[C.EXTERIOR][C.INTERIOR]):t===ht.L&&e===ht.L&&1===this.matrix[C.INTERIOR][C.INTERIOR]&&ee.isTrue(this.matrix[C.INTERIOR][C.EXTERIOR])&&ee.isTrue(this.matrix[C.EXTERIOR][C.INTERIOR])},isEquals:function(t,e){return t===e&&ee.isTrue(this.matrix[C.INTERIOR][C.INTERIOR])&&this.matrix[C.INTERIOR][C.EXTERIOR]===ht.FALSE&&this.matrix[C.BOUNDARY][C.EXTERIOR]===ht.FALSE&&this.matrix[C.EXTERIOR][C.INTERIOR]===ht.FALSE&&this.matrix[C.EXTERIOR][C.BOUNDARY]===ht.FALSE},toString:function(){for(var t=new P("123456789"),e=0;3>e;e++)for(var n=0;3>n;n++)t.setCharAt(3*e+n,ht.toDimensionSymbol(this.matrix[e][n]));return t.toString()},setAll:function(t){for(var e=0;3>e;e++)for(var n=0;3>n;n++)this.matrix[e][n]=t},get:function(t,e){return this.matrix[t][e]},transpose:function(){var t=this.matrix[1][0];return this.matrix[1][0]=this.matrix[0][1],this.matrix[0][1]=t,t=this.matrix[2][0],this.matrix[2][0]=this.matrix[0][2],this.matrix[0][2]=t,t=this.matrix[2][1],this.matrix[2][1]=this.matrix[1][2],this.matrix[1][2]=t,this},matches:function(t){if(9!==t.length)throw new i("Should be length 9: "+t);for(var e=0;3>e;e++)for(var n=0;3>n;n++)if(!ee.matches(this.matrix[e][n],t.charAt(3*e+n)))return!1;return!0},add:function(t){for(var e=0;3>e;e++)for(var n=0;3>n;n++)this.setAtLeast(e,n,t.get(e,n))},isDisjoint:function(){return this.matrix[C.INTERIOR][C.INTERIOR]===ht.FALSE&&this.matrix[C.INTERIOR][C.BOUNDARY]===ht.FALSE&&this.matrix[C.BOUNDARY][C.INTERIOR]===ht.FALSE&&this.matrix[C.BOUNDARY][C.BOUNDARY]===ht.FALSE},isCrosses:function(t,e){return t===ht.P&&e===ht.L||t===ht.P&&e===ht.A||t===ht.L&&e===ht.A?ee.isTrue(this.matrix[C.INTERIOR][C.INTERIOR])&&ee.isTrue(this.matrix[C.INTERIOR][C.EXTERIOR]):t===ht.L&&e===ht.P||t===ht.A&&e===ht.P||t===ht.A&&e===ht.L?ee.isTrue(this.matrix[C.INTERIOR][C.INTERIOR])&&ee.isTrue(this.matrix[C.EXTERIOR][C.INTERIOR]):t===ht.L&&e===ht.L&&0===this.matrix[C.INTERIOR][C.INTERIOR]},interfaces_:function(){return[o]},getClass:function(){return ee}}),ee.matches=function(){if(Number.isInteger(arguments[0])&&"string"==typeof arguments[1]){var t=arguments[0],e=arguments[1];return e===ht.SYM_DONTCARE||e===ht.SYM_TRUE&&(t>=0||t===ht.TRUE)||e===ht.SYM_FALSE&&t===ht.FALSE||e===ht.SYM_P&&t===ht.P||e===ht.SYM_L&&t===ht.L||e===ht.SYM_A&&t===ht.A}if("string"==typeof arguments[0]&&"string"==typeof arguments[1]){var n=arguments[1];return new ee(arguments[0]).matches(n)}},ee.isTrue=function(t){return t>=0||t===ht.TRUE};var $s=Object.freeze({Coordinate:d,CoordinateList:b,Envelope:E,LineSegment:te,GeometryFactory:jt,Geometry:G,Point:It,LineString:Et,LinearRing:Pt,Polygon:Mt,GeometryCollection:ft,MultiPoint:Rt,MultiLineString:dt,MultiPolygon:Tt,Dimension:ht,IntersectionMatrix:ee});e(ne.prototype,{addPoint:function(t){this.ptCount+=1,this.ptCentSum.x+=t.x,this.ptCentSum.y+=t.y},setBasePoint:function(t){null===this.areaBasePt&&(this.areaBasePt=t)},addLineSegments:function(t){for(var e=0,n=0;n<t.length-1;n++){var i=t[n].distance(t[n+1]);if(0!==i){e+=i;var r=(t[n].x+t[n+1].x)/2;this.lineCentSum.x+=i*r;var s=(t[n].y+t[n+1].y)/2;this.lineCentSum.y+=i*s}}this.totalLength+=e,0===e&&t.length>0&&this.addPoint(t[0])},addHole:function(t){for(var e=Qt.isCCW(t),n=0;n<t.length-1;n++)this.addTriangle(this.areaBasePt,t[n],t[n+1],e);this.addLineSegments(t)},getCentroid:function(){var t=new d;if(Math.abs(this.areasum2)>0)t.x=this.cg3.x/3/this.areasum2,t.y=this.cg3.y/3/this.areasum2;else if(this.totalLength>0)t.x=this.lineCentSum.x/this.totalLength,t.y=this.lineCentSum.y/this.totalLength;else{if(!(this.ptCount>0))return null;t.x=this.ptCentSum.x/this.ptCount,t.y=this.ptCentSum.y/this.ptCount}return t},addShell:function(t){t.length>0&&this.setBasePoint(t[0]);for(var e=!Qt.isCCW(t),n=0;n<t.length-1;n++)this.addTriangle(this.areaBasePt,t[n],t[n+1],e);this.addLineSegments(t)},addTriangle:function(t,e,n,i){var r=i?1:-1;ne.centroid3(t,e,n,this.triangleCent3);var s=ne.area2(t,e,n);this.cg3.x+=r*s*this.triangleCent3.x,this.cg3.y+=r*s*this.triangleCent3.y,this.areasum2+=r*s},add:function(){if(arguments[0]instanceof Mt){var t=arguments[0];this.addShell(t.getExteriorRing().getCoordinates());for(var e=0;e<t.getNumInteriorRing();e++)this.addHole(t.getInteriorRingN(e).getCoordinates())}else if(arguments[0]instanceof G){var n=arguments[0];if(n.isEmpty())return null;if(n instanceof It)this.addPoint(n.getCoordinate());else if(n instanceof Et)this.addLineSegments(n.getCoordinates());else if(n instanceof Mt){var i=n;this.add(i)}else if(n instanceof ft){var r=n;for(e=0;e<r.getNumGeometries();e++)this.add(r.getGeometryN(e))}}},interfaces_:function(){return[]},getClass:function(){return ne}}),ne.area2=function(t,e,n){return(e.x-t.x)*(n.y-t.y)-(n.x-t.x)*(e.y-t.y)},ne.centroid3=function(t,e,n,i){return i.x=t.x+e.x+n.x,i.y=t.y+e.y+n.y,null},ne.getCentroid=function(t){return new ne(t).getCentroid()},ie.prototype=new Error,ie.prototype.name="EmptyStackException",re.prototype=new v,re.prototype.add=function(t){return this.array_.push(t),!0},re.prototype.get=function(t){if(0>t||t>=this.size())throw new IndexOutOfBoundsException;return this.array_[t]},re.prototype.push=function(t){return this.array_.push(t),t},re.prototype.pop=function(t){if(0===this.array_.length)throw new ie;return this.array_.pop()},re.prototype.peek=function(){if(0===this.array_.length)throw new ie;return this.array_[this.array_.length-1]},re.prototype.empty=function(){return 0===this.array_.length},re.prototype.isEmpty=function(){return this.empty()},re.prototype.search=function(t){return this.array_.indexOf(t)},re.prototype.size=function(){return this.array_.length},re.prototype.toArray=function(){for(var t=[],e=0,n=this.array_.length;n>e;e++)t.push(this.array_[e]);return t},e(se.prototype,{filter:function(t){this.treeSet.contains(t)||(this.list.add(t),this.treeSet.add(t))},getCoordinates:function(){var t=new Array(this.list.size()).fill(null);return this.list.toArray(t)},interfaces_:function(){return[B]},getClass:function(){return se}}),se.filterCoordinates=function(t){for(var e=new se,n=0;n<t.length;n++)e.filter(t[n]);return e.getCoordinates()},e(oe.prototype,{preSort:function(t){for(var e=null,n=1;n<t.length;n++)(t[n].y<t[0].y||t[n].y===t[0].y&&t[n].x<t[0].x)&&(e=t[0],t[0]=t[n],t[n]=e);return lt.sort(t,1,t.length,new ae(t[0])),t},computeOctRing:function(t){var e=this.computeOctPts(t),n=new b;return n.add(e,!1),n.size()<3?null:(n.closeRing(),n.toCoordinateArray())},lineOrPolygon:function(t){if(3===(t=this.cleanRing(t)).length)return this.geomFactory.createLineString([t[0],t[1]]);var e=this.geomFactory.createLinearRing(t);return this.geomFactory.createPolygon(e,null)},cleanRing:function(t){f.equals(t[0],t[t.length-1]);for(var e=new _,n=null,i=0;i<=t.length-2;i++){var r=t[i],s=t[i+1];r.equals(s)||null!==n&&this.isBetween(n,r,s)||(e.add(r),n=r)}e.add(t[t.length-1]);var o=new Array(e.size()).fill(null);return e.toArray(o)},isBetween:function(t,e,n){if(0!==Qt.computeOrientation(t,e,n))return!1;if(t.x!==n.x){if(t.x<=e.x&&e.x<=n.x)return!0;if(n.x<=e.x&&e.x<=t.x)return!0}if(t.y!==n.y){if(t.y<=e.y&&e.y<=n.y)return!0;if(n.y<=e.y&&e.y<=t.y)return!0}return!1},reduce:function(t){var e=this.computeOctRing(t);if(null===e)return t;for(var n=new at,i=0;i<e.length;i++)n.add(e[i]);for(i=0;i<t.length;i++)Qt.isPointInRing(t[i],e)||n.add(t[i]);var r=j.toCoordinateArray(n);return r.length<3?this.padArray3(r):r},getConvexHull:function(){if(0===this.inputPts.length)return this.geomFactory.createGeometryCollection(null);if(1===this.inputPts.length)return this.geomFactory.createPoint(this.inputPts[0]);if(2===this.inputPts.length)return this.geomFactory.createLineString(this.inputPts);var t=this.inputPts;this.inputPts.length>50&&(t=this.reduce(this.inputPts));var e=this.preSort(t),n=this.grahamScan(e),i=this.toCoordinateArray(n);return this.lineOrPolygon(i)},padArray3:function(t){for(var e=new Array(3).fill(null),n=0;n<e.length;n++)n<t.length?e[n]=t[n]:e[n]=t[0];return e},computeOctPts:function(t){for(var e=new Array(8).fill(null),n=0;n<e.length;n++)e[n]=t[0];for(var i=1;i<t.length;i++)t[i].x<e[0].x&&(e[0]=t[i]),t[i].x-t[i].y<e[1].x-e[1].y&&(e[1]=t[i]),t[i].y>e[2].y&&(e[2]=t[i]),t[i].x+t[i].y>e[3].x+e[3].y&&(e[3]=t[i]),t[i].x>e[4].x&&(e[4]=t[i]),t[i].x-t[i].y>e[5].x-e[5].y&&(e[5]=t[i]),t[i].y<e[6].y&&(e[6]=t[i]),t[i].x+t[i].y<e[7].x+e[7].y&&(e[7]=t[i]);return e},toCoordinateArray:function(t){for(var e=new Array(t.size()).fill(null),n=0;n<t.size();n++){var i=t.get(n);e[n]=i}return e},grahamScan:function(t){var e=null,n=new re;e=n.push(t[0]),e=n.push(t[1]),e=n.push(t[2]);for(var i=3;i<t.length;i++){for(e=n.pop();!n.empty()&&Qt.computeOrientation(n.peek(),e,t[i])>0;)e=n.pop();e=n.push(e),e=n.push(t[i])}return e=n.push(t[0]),n},interfaces_:function(){return[]},getClass:function(){return oe}}),oe.extractCoordinates=function(t){var e=new se;return t.apply(e),e.getCoordinates()},e(ae.prototype,{compare:function(t,e){var n=t,i=e;return ae.polarCompare(this.origin,n,i)},interfaces_:function(){return[a]},getClass:function(){return ae}}),ae.polarCompare=function(t,e,n){var i=e.x-t.x,r=e.y-t.y,s=n.x-t.x,o=n.y-t.y,a=Qt.computeOrientation(t,e,n);if(a===Qt.COUNTERCLOCKWISE)return 1;if(a===Qt.CLOCKWISE)return-1;var l=i*i+r*r,h=s*s+o*o;return h>l?-1:l>h?1:0},oe.RadialComparator=ae,e(le.prototype,{transformPoint:function(t,e){return this.factory.createPoint(this.transformCoordinates(t.getCoordinateSequence(),t))},transformPolygon:function(t,e){var n=!0,i=this.transformLinearRing(t.getExteriorRing(),t);null!==i&&i instanceof Pt&&!i.isEmpty()||(n=!1);for(var r=new _,s=0;s<t.getNumInteriorRing();s++){var o=this.transformLinearRing(t.getInteriorRingN(s),t);null===o||o.isEmpty()||(o instanceof Pt||(n=!1),r.add(o))}if(n)return this.factory.createPolygon(i,r.toArray([]));var a=new _;return null!==i&&a.add(i),a.addAll(r),this.factory.buildGeometry(a)},createCoordinateSequence:function(t){return this.factory.getCoordinateSequenceFactory().create(t)},getInputGeometry:function(){return this.inputGeom},transformMultiLineString:function(t,e){for(var n=new _,i=0;i<t.getNumGeometries();i++){var r=this.transformLineString(t.getGeometryN(i),t);null!==r&&(r.isEmpty()||n.add(r))}return this.factory.buildGeometry(n)},transformCoordinates:function(t,e){return this.copy(t)},transformLineString:function(t,e){return this.factory.createLineString(this.transformCoordinates(t.getCoordinateSequence(),t))},transformMultiPoint:function(t,e){for(var n=new _,i=0;i<t.getNumGeometries();i++){var r=this.transformPoint(t.getGeometryN(i),t);null!==r&&(r.isEmpty()||n.add(r))}return this.factory.buildGeometry(n)},transformMultiPolygon:function(t,e){for(var n=new _,i=0;i<t.getNumGeometries();i++){var r=this.transformPolygon(t.getGeometryN(i),t);null!==r&&(r.isEmpty()||n.add(r))}return this.factory.buildGeometry(n)},copy:function(t){return t.copy()},transformGeometryCollection:function(t,e){for(var n=new _,i=0;i<t.getNumGeometries();i++){var r=this.transform(t.getGeometryN(i));null!==r&&(this.pruneEmptyGeometry&&r.isEmpty()||n.add(r))}return this.preserveGeometryCollectionType?this.factory.createGeometryCollection(jt.toGeometryArray(n)):this.factory.buildGeometry(n)},transform:function(t){if(this.inputGeom=t,this.factory=t.getFactory(),t instanceof It)return this.transformPoint(t,null);if(t instanceof Rt)return this.transformMultiPoint(t,null);if(t instanceof Pt)return this.transformLinearRing(t,null);if(t instanceof Et)return this.transformLineString(t,null);if(t instanceof dt)return this.transformMultiLineString(t,null);if(t instanceof Mt)return this.transformPolygon(t,null);if(t instanceof Tt)return this.transformMultiPolygon(t,null);if(t instanceof ft)return this.transformGeometryCollection(t,null);throw new i("Unknown Geometry subtype: "+t.getClass().getName())},transformLinearRing:function(t,e){var n=this.transformCoordinates(t.getCoordinateSequence(),t);if(null===n)return this.factory.createLinearRing(null);var i=n.size();return i>0&&4>i&&!this.preserveType?this.factory.createLineString(n):this.factory.createLinearRing(n)},interfaces_:function(){return[]},getClass:function(){return le}}),e(he.prototype,{snapVertices:function(t,e){for(var n=this._isClosed?t.size()-1:t.size(),i=0;n>i;i++){var r=t.get(i),s=this.findSnapForVertex(r,e);null!==s&&(t.set(i,new d(s)),0===i&&this._isClosed&&t.set(t.size()-1,new d(s)))}},findSnapForVertex:function(t,e){for(var n=0;n<e.length;n++){if(t.equals2D(e[n]))return null;if(t.distance(e[n])<this.snapTolerance)return e[n]}return null},snapTo:function(t){var e=new b(this.srcPts);return this.snapVertices(e,t),this.snapSegments(e,t),e.toCoordinateArray()},snapSegments:function(t,e){if(0===e.length)return null;var n=e.length;e[0].equals2D(e[e.length-1])&&(n=e.length-1);for(var i=0;n>i;i++){var r=e[i],s=this.findSegmentIndexToSnap(r,t);s>=0&&t.add(s+1,new d(r),!1)}},findSegmentIndexToSnap:function(t,e){for(var n=r.MAX_VALUE,i=-1,s=0;s<e.size()-1;s++){if(this.seg.p0=e.get(s),this.seg.p1=e.get(s+1),this.seg.p0.equals2D(t)||this.seg.p1.equals2D(t)){if(this.allowSnappingToSourceVertices)continue;return-1}var o=this.seg.distance(t);o<this.snapTolerance&&n>o&&(n=o,i=s)}return i},setAllowSnappingToSourceVertices:function(t){this.allowSnappingToSourceVertices=t},interfaces_:function(){return[]},getClass:function(){return he}}),he.isClosed=function(t){return!(t.length<=1)&&t[0].equals2D(t[t.length-1])},e(ue.prototype,{snapTo:function(t,e){return new ce(e,this.extractTargetCoordinates(t)).transform(this.srcGeom)},snapToSelf:function(t,e){var n=new ce(t,this.extractTargetCoordinates(this.srcGeom),!0).transform(this.srcGeom),i=n;return e&&M(i,Ct)&&(i=n.buffer(0)),i},computeSnapTolerance:function(t){return this.computeMinimumSegmentLength(t)/10},extractTargetCoordinates:function(t){for(var e=new at,n=t.getCoordinates(),i=0;i<n.length;i++)e.add(n[i]);return e.toArray(new Array(0).fill(null))},computeMinimumSegmentLength:function(t){for(var e=r.MAX_VALUE,n=0;n<t.length-1;n++){var i=t[n].distance(t[n+1]);e>i&&(e=i)}return e},interfaces_:function(){return[]},getClass:function(){return ue}}),ue.snap=function(t,e,n){var i=new Array(2).fill(null),r=new ue(t);i[0]=r.snapTo(e,n);var s=new ue(e);return i[1]=s.snapTo(i[0],n),i},ue.computeOverlaySnapTolerance=function(){if(1===arguments.length){var t=arguments[0],e=ue.computeSizeBasedSnapTolerance(t),n=t.getPrecisionModel();if(n.getType()===Yt.FIXED){var i=1/n.getScale()*2/1.415;i>e&&(e=i)}return e}if(2===arguments.length){var r=arguments[0],s=arguments[1];return Math.min(ue.computeOverlaySnapTolerance(r),ue.computeOverlaySnapTolerance(s))}},ue.computeSizeBasedSnapTolerance=function(t){var e=t.getEnvelopeInternal();return Math.min(e.getHeight(),e.getWidth())*ue.SNAP_PRECISION_FACTOR},ue.snapToSelf=function(t,e,n){return new ue(t).snapToSelf(e,n)},ue.SNAP_PRECISION_FACTOR=1e-9,u(ce,le),e(ce.prototype,{snapLine:function(t,e){var n=new he(t,this.snapTolerance);return n.setAllowSnappingToSourceVertices(this.isSelfSnap),n.snapTo(e)},transformCoordinates:function(t,e){var n=t.toCoordinateArray(),i=this.snapLine(n,this.snapPts);return this.factory.getCoordinateSequenceFactory().create(i)},interfaces_:function(){return[]},getClass:function(){return ce}}),e(fe.prototype,{getCommon:function(){return r.longBitsToDouble(this.commonBits)},add:function(t){var e=r.doubleToLongBits(t);return this.isFirst?(this.commonBits=e,this.commonSignExp=fe.signExpBits(this.commonBits),this.isFirst=!1,null):fe.signExpBits(e)!==this.commonSignExp?(this.commonBits=0,null):(this.commonMantissaBitsCount=fe.numCommonMostSigMantissaBits(this.commonBits,e),void(this.commonBits=fe.zeroLowerBits(this.commonBits,64-(12+this.commonMantissaBitsCount))))},toString:function(){if(1===arguments.length){var t=arguments[0],e=r.longBitsToDouble(t),n="0000000000000000000000000000000000000000000000000000000000000000"+Long.toBinaryString(t),i=n.substring(n.length-64);return i.substring(0,1)+"  "+i.substring(1,12)+"(exp) "+i.substring(12)+" [ "+e+" ]"}},interfaces_:function(){return[]},getClass:function(){return fe}}),fe.getBit=function(t,e){return 0!=(t&1<<e)?1:0},fe.signExpBits=function(t){return t>>52},fe.zeroLowerBits=function(t,e){return t&~((1<<e)-1)},fe.numCommonMostSigMantissaBits=function(t,e){for(var n=0,i=52;i>=0;i--){if(fe.getBit(t,i)!==fe.getBit(e,i))return n;n++}return 52},e(de.prototype,{addCommonBits:function(t){var e=new pe(this.commonCoord);t.apply(e),t.geometryChanged()},removeCommonBits:function(t){if(0===this.commonCoord.x&&0===this.commonCoord.y)return t;var e=new d(this.commonCoord);e.x=-e.x,e.y=-e.y;var n=new pe(e);return t.apply(n),t.geometryChanged(),t},getCommonCoordinate:function(){return this.commonCoord},add:function(t){t.apply(this.ccFilter),this.commonCoord=this.ccFilter.getCommonCoordinate()},interfaces_:function(){return[]},getClass:function(){return de}}),e(ge.prototype,{filter:function(t){this.commonBitsX.add(t.x),this.commonBitsY.add(t.y)},getCommonCoordinate:function(){return new d(this.commonBitsX.getCommon(),this.commonBitsY.getCommon())},interfaces_:function(){return[B]},getClass:function(){return ge}}),e(pe.prototype,{filter:function(t,e){var n=t.getOrdinate(e,0)+this.trans.x,i=t.getOrdinate(e,1)+this.trans.y;t.setOrdinate(e,0,n),t.setOrdinate(e,1,i)},isDone:function(){return!1},isGeometryChanged:function(){return!0},interfaces_:function(){return[ct]},getClass:function(){return pe}}),de.CommonCoordinateFilter=ge,de.Translater=pe,e(me.prototype,{next:function(){if(this.atStart)return this.atStart=!1,me.isAtomic(this.parent)&&this.index++,this.parent;if(null!==this.subcollectionIterator){if(this.subcollectionIterator.hasNext())return this.subcollectionIterator.next();this.subcollectionIterator=null}if(this.index>=this.max)throw new w;var t=this.parent.getGeometryN(this.index++);return t instanceof ft?(this.subcollectionIterator=new me(t),this.subcollectionIterator.next()):t},remove:function(){throw new UnsupportedOperationException(this.getClass().getName())},hasNext:function(){if(this.atStart)return!0;if(null!==this.subcollectionIterator){if(this.subcollectionIterator.hasNext())return!0;this.subcollectionIterator=null}return!(this.index>=this.max)},interfaces_:function(){return[p]},getClass:function(){return me}}),me.isAtomic=function(t){return!(t instanceof ft)},e(ye.prototype,{locateInternal:function(){if(arguments[0]instanceof d&&arguments[1]instanceof Mt){var t=arguments[0],e=arguments[1];if(e.isEmpty())return C.EXTERIOR;var n=e.getExteriorRing(),i=this.locateInPolygonRing(t,n);if(i===C.EXTERIOR)return C.EXTERIOR;if(i===C.BOUNDARY)return C.BOUNDARY;for(var r=0;r<e.getNumInteriorRing();r++){var s=e.getInteriorRingN(r),o=this.locateInPolygonRing(t,s);if(o===C.INTERIOR)return C.EXTERIOR;if(o===C.BOUNDARY)return C.BOUNDARY}return C.INTERIOR}if(arguments[0]instanceof d&&arguments[1]instanceof Et){var a=arguments[0],l=arguments[1];if(!l.getEnvelopeInternal().intersects(a))return C.EXTERIOR;var h=l.getCoordinates();return l.isClosed()||!a.equals(h[0])&&!a.equals(h[h.length-1])?Qt.isOnLine(a,h)?C.INTERIOR:C.EXTERIOR:C.BOUNDARY}if(arguments[0]instanceof d&&arguments[1]instanceof It){var u=arguments[0];return arguments[1].getCoordinate().equals2D(u)?C.INTERIOR:C.EXTERIOR}},locateInPolygonRing:function(t,e){return e.getEnvelopeInternal().intersects(t)?Qt.locatePointInRing(t,e.getCoordinates()):C.EXTERIOR},intersects:function(t,e){return this.locate(t,e)!==C.EXTERIOR},updateLocationInfo:function(t){t===C.INTERIOR&&(this.isIn=!0),t===C.BOUNDARY&&this.numBoundaries++},computeLocation:function(t,e){if(e instanceof It&&this.updateLocationInfo(this.locateInternal(t,e)),e instanceof Et)this.updateLocationInfo(this.locateInternal(t,e));else if(e instanceof Mt)this.updateLocationInfo(this.locateInternal(t,e));else if(e instanceof dt)for(var n=e,i=0;i<n.getNumGeometries();i++){var r=n.getGeometryN(i);this.updateLocationInfo(this.locateInternal(t,r))}else if(e instanceof Tt){var s=e;for(i=0;i<s.getNumGeometries();i++){var o=s.getGeometryN(i);this.updateLocationInfo(this.locateInternal(t,o))}}else if(e instanceof ft)for(var a=new me(e);a.hasNext();){var l=a.next();l!==e&&this.computeLocation(t,l)}},locate:function(t,e){return e.isEmpty()?C.EXTERIOR:e instanceof Et||e instanceof Mt?this.locateInternal(t,e):(this.isIn=!1,this.numBoundaries=0,this.computeLocation(t,e),this.boundaryRule.isInBoundary(this.numBoundaries)?C.BOUNDARY:this.numBoundaries>0||this.isIn?C.INTERIOR:C.EXTERIOR)},interfaces_:function(){return[]},getClass:function(){return ye}}),e(ve.prototype,{interfaces_:function(){return[]},getClass:function(){return ve}}),ve.octant=function(){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var t=arguments[0],e=arguments[1];if(0===t&&0===e)throw new i("Cannot compute the octant for point ( "+t+", "+e+" )");var n=Math.abs(t),r=Math.abs(e);return t>=0?e>=0?n>=r?0:1:n>=r?7:6:e>=0?n>=r?3:2:n>=r?4:5}if(arguments[0]instanceof d&&arguments[1]instanceof d){var s=arguments[0],o=arguments[1],a=o.x-s.x,l=o.y-s.y;if(0===a&&0===l)throw new i("Cannot compute the octant for two identical points "+s);return ve.octant(a,l)}},e(we.prototype,{getCoordinates:function(){},size:function(){},getCoordinate:function(t){},isClosed:function(){},setData:function(t){},getData:function(){},interfaces_:function(){return[]},getClass:function(){return we}}),e(xe.prototype,{getCoordinates:function(){return this.pts},size:function(){return this.pts.length},getCoordinate:function(t){return this.pts[t]},isClosed:function(){return this.pts[0].equals(this.pts[this.pts.length-1])},getSegmentOctant:function(t){return t===this.pts.length-1?-1:ve.octant(this.getCoordinate(t),this.getCoordinate(t+1))},setData:function(t){this.data=t},getData:function(){return this.data},toString:function(){return Ht.toLineString(new Dt(this.pts))},interfaces_:function(){return[we]},getClass:function(){return xe}}),e(_e.prototype,{getBounds:function(){},interfaces_:function(){return[]},getClass:function(){return _e}}),e(be.prototype,{getItem:function(){return this.item},getBounds:function(){return this.bounds},interfaces_:function(){return[_e,l]},getClass:function(){return be}}),e(Ee.prototype,{poll:function(){if(this.isEmpty())return null;var t=this.items.get(1);return this.items.set(1,this.items.get(this._size)),this._size-=1,this.reorder(1),t},size:function(){return this._size},reorder:function(t){for(var e=null,n=this.items.get(t);2*t<=this._size&&((e=2*t)!==this._size&&this.items.get(e+1).compareTo(this.items.get(e))<0&&e++,this.items.get(e).compareTo(n)<0);t=e)this.items.set(t,this.items.get(e));this.items.set(t,n)},clear:function(){this._size=0,this.items.clear()},isEmpty:function(){return 0===this._size},add:function(t){this.items.add(null),this._size+=1;var e=this._size;for(this.items.set(0,t);t.compareTo(this.items.get(Math.trunc(e/2)))<0;e/=2)this.items.set(e,this.items.get(Math.trunc(e/2)));this.items.set(e,t)},interfaces_:function(){return[]},getClass:function(){return Ee}}),e(Se.prototype,{visitItem:function(t){},interfaces_:function(){return[]},getClass:function(){return Se}}),e(Ie.prototype,{insert:function(t,e){},remove:function(t,e){},query:function(){},interfaces_:function(){return[]},getClass:function(){return Ie}}),e(Ce.prototype,{getLevel:function(){return this.level},size:function(){return this.childBoundables.size()},getChildBoundables:function(){return this.childBoundables},addChildBoundable:function(t){f.isTrue(null===this.bounds),this.childBoundables.add(t)},isEmpty:function(){return this.childBoundables.isEmpty()},getBounds:function(){return null===this.bounds&&(this.bounds=this.computeBounds()),this.bounds},interfaces_:function(){return[_e,l]},getClass:function(){return Ce}}),Ce.serialVersionUID=0x5a1e55ec41369800;var Zs={reverseOrder:function(){return{compare:function(t,e){return e.compareTo(t)}}},min:function(t){return Zs.sort(t),t.get(0)},sort:function(t,e){var n=t.toArray();e?lt.sort(n,e):lt.sort(n);for(var i=t.iterator(),r=0,s=n.length;s>r;r++)i.next(),i.set(n[r])},singletonList:function(t){var e=new _;return e.add(t),e}};e(Me.prototype,{expandToQueue:function(t,e){var n=Me.isComposite(this.boundable1),r=Me.isComposite(this.boundable2);if(n&&r)return Me.area(this.boundable1)>Me.area(this.boundable2)?(this.expand(this.boundable1,this.boundable2,t,e),null):(this.expand(this.boundable2,this.boundable1,t,e),null);if(n)return this.expand(this.boundable1,this.boundable2,t,e),null;if(r)return this.expand(this.boundable2,this.boundable1,t,e),null;throw new i("neither boundable is composite")},isLeaves:function(){return!(Me.isComposite(this.boundable1)||Me.isComposite(this.boundable2))},compareTo:function(t){var e=t;return this._distance<e._distance?-1:this._distance>e._distance?1:0},expand:function(t,e,n,i){for(var r=t.getChildBoundables().iterator();r.hasNext();){var s=new Me(r.next(),e,this.itemDistance);s.getDistance()<i&&n.add(s)}},getBoundable:function(t){return 0===t?this.boundable1:this.boundable2},getDistance:function(){return this._distance},distance:function(){return this.isLeaves()?this.itemDistance.distance(this.boundable1,this.boundable2):this.boundable1.getBounds().distance(this.boundable2.getBounds())},interfaces_:function(){return[s]},getClass:function(){return Me}}),Me.area=function(t){return t.getBounds().getArea()},Me.isComposite=function(t){return t instanceof Ce},e(Re.prototype,{getNodeCapacity:function(){return this.nodeCapacity},lastNode:function(t){return t.get(t.size()-1)},size:function(){if(0===arguments.length)return this.isEmpty()?0:(this.build(),this.size(this.root));if(1===arguments.length){for(var t=0,e=arguments[0].getChildBoundables().iterator();e.hasNext();){var n=e.next();n instanceof Ce?t+=this.size(n):n instanceof be&&(t+=1)}return t}},removeItem:function(t,e){for(var n=null,i=t.getChildBoundables().iterator();i.hasNext();){var r=i.next();r instanceof be&&r.getItem()===e&&(n=r)}return null!==n&&(t.getChildBoundables().remove(n),!0)},itemsTree:function(){if(0===arguments.length){this.build();var t=this.itemsTree(this.root);return null===t?new _:t}if(1===arguments.length){for(var e=arguments[0],n=new _,i=e.getChildBoundables().iterator();i.hasNext();){var r=i.next();if(r instanceof Ce){var s=this.itemsTree(r);null!==s&&n.add(s)}else r instanceof be?n.add(r.getItem()):f.shouldNeverReachHere()}return n.size()<=0?null:n}},insert:function(t,e){f.isTrue(!this.built,"Cannot insert items into an STR packed R-tree after it has been built."),this.itemBoundables.add(new be(t,e))},boundablesAtLevel:function(){if(1===arguments.length){var t=arguments[0],e=new _;return this.boundablesAtLevel(t,this.root,e),e}if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];if(f.isTrue(n>-2),i.getLevel()===n)return r.add(i),null;for(var s=i.getChildBoundables().iterator();s.hasNext();){var o=s.next();o instanceof Ce?this.boundablesAtLevel(n,o,r):(f.isTrue(o instanceof be),-1===n&&r.add(o))}return null}},query:function(){if(1===arguments.length){var t=arguments[0];this.build();var e=new _;return this.isEmpty()||this.getIntersectsOp().intersects(this.root.getBounds(),t)&&this.query(t,this.root,e),e}if(2===arguments.length){var n=arguments[0],i=arguments[1];if(this.build(),this.isEmpty())return null;this.getIntersectsOp().intersects(this.root.getBounds(),n)&&this.query(n,this.root,i)}else if(3===arguments.length)if(M(arguments[2],Se)&&arguments[0]instanceof Object&&arguments[1]instanceof Ce)for(var r=arguments[0],s=arguments[2],o=arguments[1].getChildBoundables(),a=0;a<o.size();a++){var l=o.get(a);this.getIntersectsOp().intersects(l.getBounds(),r)&&(l instanceof Ce?this.query(r,l,s):l instanceof be?s.visitItem(l.getItem()):f.shouldNeverReachHere())}else if(M(arguments[2],v)&&arguments[0]instanceof Object&&arguments[1]instanceof Ce){var h=arguments[0],u=arguments[2];for(o=arguments[1].getChildBoundables(),a=0;a<o.size();a++)l=o.get(a),this.getIntersectsOp().intersects(l.getBounds(),h)&&(l instanceof Ce?this.query(h,l,u):l instanceof be?u.add(l.getItem()):f.shouldNeverReachHere())}},build:function(){return this.built?null:(this.root=this.itemBoundables.isEmpty()?this.createNode(0):this.createHigherLevels(this.itemBoundables,-1),this.itemBoundables=null,void(this.built=!0))},getRoot:function(){return this.build(),this.root},remove:function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return this.build(),!!this.getIntersectsOp().intersects(this.root.getBounds(),t)&&this.remove(t,this.root,e)}if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2],s=this.removeItem(i,r);if(s)return!0;for(var o=null,a=i.getChildBoundables().iterator();a.hasNext();){var l=a.next();if(this.getIntersectsOp().intersects(l.getBounds(),n)&&l instanceof Ce&&(s=this.remove(n,l,r))){o=l;break}}return null!==o&&o.getChildBoundables().isEmpty()&&i.getChildBoundables().remove(o),s}},createHigherLevels:function(t,e){f.isTrue(!t.isEmpty());var n=this.createParentBoundables(t,e+1);return 1===n.size()?n.get(0):this.createHigherLevels(n,e+1)},depth:function(){if(0===arguments.length)return this.isEmpty()?0:(this.build(),this.depth(this.root));if(1===arguments.length){for(var t=0,e=arguments[0].getChildBoundables().iterator();e.hasNext();){var n=e.next();if(n instanceof Ce){var i=this.depth(n);i>t&&(t=i)}}return t+1}},createParentBoundables:function(t,e){f.isTrue(!t.isEmpty());var n=new _;n.add(this.createNode(e));var i=new _(t);Zs.sort(i,this.getComparator());for(var r=i.iterator();r.hasNext();){var s=r.next();this.lastNode(n).getChildBoundables().size()===this.getNodeCapacity()&&n.add(this.createNode(e)),this.lastNode(n).addChildBoundable(s)}return n},isEmpty:function(){return this.built?this.root.isEmpty():this.itemBoundables.isEmpty()},interfaces_:function(){return[l]},getClass:function(){return Re}}),Re.compareDoubles=function(t,e){return t>e?1:e>t?-1:0},Re.IntersectsOp=function(){},Re.serialVersionUID=-0x35ef64c82d4c5400,Re.DEFAULT_NODE_CAPACITY=10,e(Pe.prototype,{distance:function(t,e){},interfaces_:function(){return[]},getClass:function(){return Pe}}),u(Te,Re),e(Te.prototype,{createParentBoundablesFromVerticalSlices:function(t,e){f.isTrue(t.length>0);for(var n=new _,i=0;i<t.length;i++)n.addAll(this.createParentBoundablesFromVerticalSlice(t[i],e));return n},createNode:function(t){return new Ne(t)},size:function(){return 0===arguments.length?Re.prototype.size.call(this):Re.prototype.size.apply(this,arguments)},insert:function(){if(2!==arguments.length)return Re.prototype.insert.apply(this,arguments);var t=arguments[0],e=arguments[1];return t.isNull()?null:void Re.prototype.insert.call(this,t,e)},getIntersectsOp:function(){return Te.intersectsOp},verticalSlices:function(t,e){for(var n=Math.trunc(Math.ceil(t.size()/e)),i=new Array(e).fill(null),r=t.iterator(),s=0;e>s;s++){i[s]=new _;for(var o=0;r.hasNext()&&n>o;){var a=r.next();i[s].add(a),o++}}return i},query:function(){if(1===arguments.length){var t=arguments[0];return Re.prototype.query.call(this,t)}if(2===arguments.length){var e=arguments[0],n=arguments[1];Re.prototype.query.call(this,e,n)}else if(3===arguments.length)if(M(arguments[2],Se)&&arguments[0]instanceof Object&&arguments[1]instanceof Ce){var i=arguments[0],r=arguments[1],s=arguments[2];Re.prototype.query.call(this,i,r,s)}else if(M(arguments[2],v)&&arguments[0]instanceof Object&&arguments[1]instanceof Ce){var o=arguments[0],a=arguments[1],l=arguments[2];Re.prototype.query.call(this,o,a,l)}},getComparator:function(){return Te.yComparator},createParentBoundablesFromVerticalSlice:function(t,e){return Re.prototype.createParentBoundables.call(this,t,e)},remove:function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return Re.prototype.remove.call(this,t,e)}return Re.prototype.remove.apply(this,arguments)},depth:function(){return 0===arguments.length?Re.prototype.depth.call(this):Re.prototype.depth.apply(this,arguments)},createParentBoundables:function(t,e){f.isTrue(!t.isEmpty());var n=Math.trunc(Math.ceil(t.size()/this.getNodeCapacity())),i=new _(t);Zs.sort(i,Te.xComparator);var r=this.verticalSlices(i,Math.trunc(Math.ceil(Math.sqrt(n))));return this.createParentBoundablesFromVerticalSlices(r,e)},nearestNeighbour:function(){if(1===arguments.length){if(M(arguments[0],Pe)){var t=arguments[0],e=new Me(this.getRoot(),this.getRoot(),t);return this.nearestNeighbour(e)}if(arguments[0]instanceof Me){var n=arguments[0];return this.nearestNeighbour(n,r.POSITIVE_INFINITY)}}else if(2===arguments.length){if(arguments[0]instanceof Te&&M(arguments[1],Pe)){var i=arguments[0],s=arguments[1];return e=new Me(this.getRoot(),i.getRoot(),s),this.nearestNeighbour(e)}if(arguments[0]instanceof Me&&"number"==typeof arguments[1]){var o=arguments[0],a=arguments[1],l=null,h=new Ee;for(h.add(o);!h.isEmpty()&&a>0;){var u=h.poll(),c=u.getDistance();if(c>=a)break;u.isLeaves()?(a=c,l=u):u.expandToQueue(h,a)}return[l.getBoundable(0).getItem(),l.getBoundable(1).getItem()]}}else if(3===arguments.length){var f=arguments[2],d=new be(arguments[0],arguments[1]);return e=new Me(this.getRoot(),d,f),this.nearestNeighbour(e)[0]}},interfaces_:function(){return[Ie,l]},getClass:function(){return Te}}),Te.centreX=function(t){return Te.avg(t.getMinX(),t.getMaxX())},Te.avg=function(t,e){return(t+e)/2},Te.centreY=function(t){return Te.avg(t.getMinY(),t.getMaxY())},u(Ne,Ce),e(Ne.prototype,{computeBounds:function(){for(var t=null,e=this.getChildBoundables().iterator();e.hasNext();){var n=e.next();null===t?t=new E(n.getBounds()):t.expandToInclude(n.getBounds())}return t},interfaces_:function(){return[]},getClass:function(){return Ne}}),Te.STRtreeNode=Ne,Te.serialVersionUID=0x39920f7d5f261e0,Te.xComparator={interfaces_:function(){return[a]},compare:function(t,e){return Re.compareDoubles(Te.centreX(t.getBounds()),Te.centreX(e.getBounds()))}},Te.yComparator={interfaces_:function(){return[a]},compare:function(t,e){return Re.compareDoubles(Te.centreY(t.getBounds()),Te.centreY(e.getBounds()))}},Te.intersectsOp={interfaces_:function(){return[IntersectsOp]},intersects:function(t,e){return t.intersects(e)}},Te.DEFAULT_NODE_CAPACITY=10,e(Ae.prototype,{interfaces_:function(){return[]},getClass:function(){return Ae}}),Ae.relativeSign=function(t,e){return e>t?-1:t>e?1:0},Ae.compare=function(t,e,n){if(e.equals2D(n))return 0;var i=Ae.relativeSign(e.x,n.x),r=Ae.relativeSign(e.y,n.y);switch(t){case 0:return Ae.compareValue(i,r);case 1:return Ae.compareValue(r,i);case 2:return Ae.compareValue(r,-i);case 3:return Ae.compareValue(-i,r);case 4:return Ae.compareValue(-i,-r);case 5:return Ae.compareValue(-r,-i);case 6:return Ae.compareValue(-r,i);case 7:return Ae.compareValue(i,-r)}return f.shouldNeverReachHere("invalid octant value"),0},Ae.compareValue=function(t,e){return 0>t?-1:t>0?1:0>e?-1:e>0?1:0},e(ke.prototype,{getCoordinate:function(){return this.coord},print:function(t){t.print(this.coord),t.print(" seg # = "+this.segmentIndex)},compareTo:function(t){var e=t;return this.segmentIndex<e.segmentIndex?-1:this.segmentIndex>e.segmentIndex?1:this.coord.equals2D(e.coord)?0:Ae.compare(this.segmentOctant,this.coord,e.coord)},isEndPoint:function(t){return 0===this.segmentIndex&&!this._isInterior||this.segmentIndex===t},isInterior:function(){return this._isInterior},interfaces_:function(){return[s]},getClass:function(){return ke}}),e(Le.prototype,{getSplitCoordinates:function(){var t=new b;this.addEndpoints();for(var e=this.iterator(),n=e.next();e.hasNext();){var i=e.next();this.addEdgeCoordinates(n,i,t),n=i}return t.toCoordinateArray()},addCollapsedNodes:function(){var t=new _;this.findCollapsesFromInsertedNodes(t),this.findCollapsesFromExistingVertices(t);for(var e=t.iterator();e.hasNext();){var n=e.next().intValue();this.add(this.edge.getCoordinate(n),n)}},print:function(t){t.println("Intersections:");for(var e=this.iterator();e.hasNext();)e.next().print(t)},findCollapsesFromExistingVertices:function(t){for(var e=0;e<this.edge.size()-2;e++){var n=this.edge.getCoordinate(e),i=(this.edge.getCoordinate(e+1),this.edge.getCoordinate(e+2));n.equals2D(i)&&t.add(new T(e+1))}},addEdgeCoordinates:function(t,e,n){e.segmentIndex,t.segmentIndex;var i=this.edge.getCoordinate(e.segmentIndex),r=e.isInterior()||!e.coord.equals2D(i);n.add(new d(t.coord),!1);for(var s=t.segmentIndex+1;s<=e.segmentIndex;s++)n.add(this.edge.getCoordinate(s));r&&n.add(new d(e.coord))},iterator:function(){return this.nodeMap.values().iterator()},addSplitEdges:function(t){this.addEndpoints(),this.addCollapsedNodes();for(var e=this.iterator(),n=e.next();e.hasNext();){var i=e.next(),r=this.createSplitEdge(n,i);t.add(r),n=i}},findCollapseIndex:function(t,e,n){if(!t.coord.equals2D(e.coord))return!1;var i=e.segmentIndex-t.segmentIndex;return e.isInterior()||i--,1===i&&(n[0]=t.segmentIndex+1,!0)},findCollapsesFromInsertedNodes:function(t){for(var e=new Array(1).fill(null),n=this.iterator(),i=n.next();n.hasNext();){var r=n.next();this.findCollapseIndex(i,r,e)&&t.add(new T(e[0])),i=r}},getEdge:function(){return this.edge},addEndpoints:function(){var t=this.edge.size()-1;this.add(this.edge.getCoordinate(0),0),this.add(this.edge.getCoordinate(t),t)},createSplitEdge:function(t,e){var n=e.segmentIndex-t.segmentIndex+2,i=this.edge.getCoordinate(e.segmentIndex),r=e.isInterior()||!e.coord.equals2D(i);r||n--;var s=new Array(n).fill(null),o=0;s[o++]=new d(t.coord);for(var a=t.segmentIndex+1;a<=e.segmentIndex;a++)s[o++]=this.edge.getCoordinate(a);return r&&(s[o]=new d(e.coord)),new Fe(s,this.edge.getData())},add:function(t,e){var n=new ke(this.edge,t,e,this.edge.getSegmentOctant(e)),i=this.nodeMap.get(n);return null!==i?(f.isTrue(i.coord.equals2D(t),"Found equal nodes with different coordinates"),i):(this.nodeMap.put(n,n),n)},checkSplitEdgesCorrectness:function(t){var e=this.edge.getCoordinates(),n=t.get(0).getCoordinate(0);if(!n.equals2D(e[0]))throw new h("bad split edge start point at "+n);var i=t.get(t.size()-1).getCoordinates(),r=i[i.length-1];if(!r.equals2D(e[e.length-1]))throw new h("bad split edge end point at "+r)},interfaces_:function(){return[]},getClass:function(){return Le}}),e(Oe.prototype,{next:function(){return null===this.currNode?(this.currNode=this.nextNode,this.currSegIndex=this.currNode.segmentIndex,this.readNextNode(),this.currNode):null===this.nextNode?null:this.nextNode.segmentIndex===this.currNode.segmentIndex?(this.currNode=this.nextNode,this.currSegIndex=this.currNode.segmentIndex,this.readNextNode(),this.currNode):(this.nextNode.segmentIndex,this.currNode.segmentIndex,null)},remove:function(){throw new UnsupportedOperationException(this.getClass().getName())},hasNext:function(){return null!==this.nextNode},readNextNode:function(){this.nodeIt.hasNext()?this.nextNode=this.nodeIt.next():this.nextNode=null},interfaces_:function(){return[p]},getClass:function(){return Oe}}),e(De.prototype,{addIntersection:function(t,e){},interfaces_:function(){return[we]},getClass:function(){return De}}),e(Fe.prototype,{getCoordinates:function(){return this.pts},size:function(){return this.pts.length},getCoordinate:function(t){return this.pts[t]},isClosed:function(){return this.pts[0].equals(this.pts[this.pts.length-1])},getSegmentOctant:function(t){return t===this.pts.length-1?-1:this.safeOctant(this.getCoordinate(t),this.getCoordinate(t+1))},setData:function(t){this.data=t},safeOctant:function(t,e){return t.equals2D(e)?0:ve.octant(t,e)},getData:function(){return this.data},addIntersection:function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];this.addIntersectionNode(t,e)}else if(4===arguments.length){var n=arguments[1],i=arguments[3],r=new d(arguments[0].getIntersection(i));this.addIntersection(r,n)}},toString:function(){return Ht.toLineString(new Dt(this.pts))},getNodeList:function(){return this.nodeList},addIntersectionNode:function(t,e){var n=e,i=n+1;if(i<this.pts.length){var r=this.pts[i];t.equals2D(r)&&(n=i)}return this.nodeList.add(t,n)},addIntersections:function(t,e,n){for(var i=0;i<t.getIntersectionNum();i++)this.addIntersection(t,e,n,i)},interfaces_:function(){return[De]},getClass:function(){return Fe}}),Fe.getNodedSubstrings=function(){if(1===arguments.length){var t=arguments[0],e=new _;return Fe.getNodedSubstrings(t,e),e}if(2===arguments.length)for(var n=arguments[1],i=arguments[0].iterator();i.hasNext();)i.next().getNodeList().addSplitEdges(n)},e(ze.prototype,{overlap:function(){if(2===arguments.length);else if(4===arguments.length){var t=arguments[1],e=arguments[2],n=arguments[3];arguments[0].getLineSegment(t,this.overlapSeg1),e.getLineSegment(n,this.overlapSeg2),this.overlap(this.overlapSeg1,this.overlapSeg2)}},interfaces_:function(){return[]},getClass:function(){return ze}}),e(Ge.prototype,{getLineSegment:function(t,e){e.p0=this.pts[t],e.p1=this.pts[t+1]},computeSelect:function(t,e,n,i){var r=this.pts[e],s=this.pts[n];if(i.tempEnv1.init(r,s),n-e==1)return i.select(this,e),null;if(!t.intersects(i.tempEnv1))return null;var o=Math.trunc((e+n)/2);o>e&&this.computeSelect(t,e,o,i),n>o&&this.computeSelect(t,o,n,i)},getCoordinates:function(){for(var t=new Array(this.end-this.start+1).fill(null),e=0,n=this.start;n<=this.end;n++)t[e++]=this.pts[n];return t},computeOverlaps:function(t,e){this.computeOverlapsInternal(this.start,this.end,t,t.start,t.end,e)},setId:function(t){this.id=t},select:function(t,e){this.computeSelect(t,this.start,this.end,e)},getEnvelope:function(){if(null===this.env){var t=this.pts[this.start],e=this.pts[this.end];this.env=new E(t,e)}return this.env},getEndIndex:function(){return this.end},getStartIndex:function(){return this.start},getContext:function(){return this.context},getId:function(){return this.id},computeOverlapsInternal:function(t,e,n,i,r,s){var o=this.pts[t],a=this.pts[e],l=n.pts[i],h=n.pts[r];if(e-t==1&&r-i==1)return s.overlap(this,t,n,i),null;if(s.tempEnv1.init(o,a),s.tempEnv2.init(l,h),!s.tempEnv1.intersects(s.tempEnv2))return null;var u=Math.trunc((t+e)/2),c=Math.trunc((i+r)/2);u>t&&(c>i&&this.computeOverlapsInternal(t,u,n,i,c,s),r>c&&this.computeOverlapsInternal(t,u,n,c,r,s)),e>u&&(c>i&&this.computeOverlapsInternal(u,e,n,i,c,s),r>c&&this.computeOverlapsInternal(u,e,n,c,r,s))},interfaces_:function(){return[]},getClass:function(){return Ge}}),e(Be.prototype,{interfaces_:function(){return[]},getClass:function(){return Be}}),Be.isNorthern=function(t){return t===Be.NE||t===Be.NW},Be.isOpposite=function(t,e){return t!==e&&2==(t-e+4)%4},Be.commonHalfPlane=function(t,e){if(t===e)return t;if(2==(t-e+4)%4)return-1;var n=e>t?t:e;return 0===n&&3===(t>e?t:e)?3:n},Be.isInHalfPlane=function(t,e){return e===Be.SE?t===Be.SE||t===Be.SW:t===e||t===e+1},Be.quadrant=function(){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var t=arguments[0],e=arguments[1];if(0===t&&0===e)throw new i("Cannot compute the quadrant for point ( "+t+", "+e+" )");return t>=0?e>=0?Be.NE:Be.SE:e>=0?Be.NW:Be.SW}if(arguments[0]instanceof d&&arguments[1]instanceof d){var n=arguments[0],r=arguments[1];if(r.x===n.x&&r.y===n.y)throw new i("Cannot compute the quadrant for two identical points "+n);return r.x>=n.x?r.y>=n.y?Be.NE:Be.SE:r.y>=n.y?Be.NW:Be.SW}},Be.NE=0,Be.NW=1,Be.SW=2,Be.SE=3,e(Ue.prototype,{interfaces_:function(){return[]},getClass:function(){return Ue}}),Ue.getChainStartIndices=function(t){var e=0,n=new _;n.add(new T(e));do{var i=Ue.findChainEnd(t,e);n.add(new T(i)),e=i}while(e<t.length-1);return Ue.toIntArray(n)},Ue.findChainEnd=function(t,e){for(var n=e;n<t.length-1&&t[n].equals2D(t[n+1]);)n++;if(n>=t.length-1)return t.length-1;for(var i=Be.quadrant(t[n],t[n+1]),r=e+1;r<t.length&&(t[r-1].equals2D(t[r])||Be.quadrant(t[r-1],t[r])===i);)r++;return r-1},Ue.getChains=function(){if(1===arguments.length){var t=arguments[0];return Ue.getChains(t,null)}if(2===arguments.length){for(var e=arguments[0],n=arguments[1],i=new _,r=Ue.getChainStartIndices(e),s=0;s<r.length-1;s++){var o=new Ge(e,r[s],r[s+1],n);i.add(o)}return i}},Ue.toIntArray=function(t){for(var e=new Array(t.size()).fill(null),n=0;n<e.length;n++)e[n]=t.get(n).intValue();return e},e(qe.prototype,{computeNodes:function(t){},getNodedSubstrings:function(){},interfaces_:function(){return[]},getClass:function(){return qe}}),e(Ve.prototype,{setSegmentIntersector:function(t){this.segInt=t},interfaces_:function(){return[qe]},getClass:function(){return Ve}}),u(Ye,Ve),e(Ye.prototype,{getMonotoneChains:function(){return this.monoChains},getNodedSubstrings:function(){return Fe.getNodedSubstrings(this.nodedSegStrings)},getIndex:function(){return this.index},add:function(t){for(var e=Ue.getChains(t.getCoordinates(),t).iterator();e.hasNext();){var n=e.next();n.setId(this.idCounter++),this.index.insert(n.getEnvelope(),n),this.monoChains.add(n)}},computeNodes:function(t){this.nodedSegStrings=t;for(var e=t.iterator();e.hasNext();)this.add(e.next());this.intersectChains()},intersectChains:function(){for(var t=new Xe(this.segInt),e=this.monoChains.iterator();e.hasNext();)for(var n=e.next(),i=this.index.query(n.getEnvelope()).iterator();i.hasNext();){var r=i.next();if(r.getId()>n.getId()&&(n.computeOverlaps(r,t),this.nOverlaps++),this.segInt.isDone())return null}},interfaces_:function(){return[]},getClass:function(){return Ye}}),u(Xe,ze),e(Xe.prototype,{overlap:function(){if(4!==arguments.length)return ze.prototype.overlap.apply(this,arguments);var t=arguments[1],e=arguments[2],n=arguments[3],i=arguments[0].getContext(),r=e.getContext();this.si.processIntersections(i,t,r,n)},interfaces_:function(){return[]},getClass:function(){return Xe}}),Ye.SegmentOverlapAction=Xe,u(je,h),e(je.prototype,{getCoordinate:function(){return this.pt},interfaces_:function(){return[]},getClass:function(){return je}}),je.msgWithCoord=function(t,e){return null!==e?t+" [ "+e+" ]":t},e(We.prototype,{processIntersections:function(t,e,n,i){},isDone:function(){},interfaces_:function(){return[]},getClass:function(){return We}}),e(He.prototype,{getInteriorIntersection:function(){return this.interiorIntersection},setCheckEndSegmentsOnly:function(t){this.isCheckEndSegmentsOnly=t},getIntersectionSegments:function(){return this.intSegments},count:function(){return this.intersectionCount},getIntersections:function(){return this.intersections},setFindAllIntersections:function(t){this.findAllIntersections=t},setKeepIntersections:function(t){this.keepIntersections=t},processIntersections:function(t,e,n,i){if(!this.findAllIntersections&&this.hasIntersection())return null;if(t===n&&e===i)return null;if(this.isCheckEndSegmentsOnly&&!this.isEndSegment(t,e)&&!this.isEndSegment(n,i))return null;var r=t.getCoordinates()[e],s=t.getCoordinates()[e+1],o=n.getCoordinates()[i],a=n.getCoordinates()[i+1];this.li.computeIntersection(r,s,o,a),this.li.hasIntersection()&&this.li.isInteriorIntersection()&&(this.intSegments=new Array(4).fill(null),this.intSegments[0]=r,this.intSegments[1]=s,this.intSegments[2]=o,this.intSegments[3]=a,this.interiorIntersection=this.li.getIntersection(0),this.keepIntersections&&this.intersections.add(this.interiorIntersection),this.intersectionCount++)},isEndSegment:function(t,e){return 0===e||e>=t.size()-2},hasIntersection:function(){return null!==this.interiorIntersection},isDone:function(){return!this.findAllIntersections&&null!==this.interiorIntersection},interfaces_:function(){return[We]},getClass:function(){return He}}),He.createAllIntersectionsFinder=function(t){var e=new He(t);return e.setFindAllIntersections(!0),e},He.createAnyIntersectionFinder=function(t){return new He(t)},He.createIntersectionCounter=function(t){var e=new He(t);return e.setFindAllIntersections(!0),e.setKeepIntersections(!1),e},e($e.prototype,{execute:function(){return null!==this.segInt?null:void this.checkInteriorIntersections()},getIntersections:function(){return this.segInt.getIntersections()},isValid:function(){return this.execute(),this._isValid},setFindAllIntersections:function(t){this.findAllIntersections=t},checkInteriorIntersections:function(){this._isValid=!0,this.segInt=new He(this.li),this.segInt.setFindAllIntersections(this.findAllIntersections);var t=new Ye;return t.setSegmentIntersector(this.segInt),t.computeNodes(this.segStrings),this.segInt.hasIntersection()?(this._isValid=!1,null):void 0},checkValid:function(){if(this.execute(),!this._isValid)throw new je(this.getErrorMessage(),this.segInt.getInteriorIntersection())},getErrorMessage:function(){if(this._isValid)return"no intersections found";var t=this.segInt.getIntersectionSegments();return"found non-noded intersection between "+Ht.toLineString(t[0],t[1])+" and "+Ht.toLineString(t[2],t[3])},interfaces_:function(){return[]},getClass:function(){return $e}}),$e.computeIntersections=function(t){var e=new $e(t);return e.setFindAllIntersections(!0),e.isValid(),e.getIntersections()},e(Ze.prototype,{checkValid:function(){this.nv.checkValid()},interfaces_:function(){return[]},getClass:function(){return Ze}}),Ze.toSegmentStrings=function(t){for(var e=new _,n=t.iterator();n.hasNext();){var i=n.next();e.add(new xe(i.getCoordinates(),i))}return e},Ze.checkValid=function(t){new Ze(t).checkValid()},e(Ke.prototype,{map:function(t){for(var e=new _,n=0;n<t.getNumGeometries();n++){var i=this.mapOp.map(t.getGeometryN(n));i.isEmpty()||e.add(i)}return t.getFactory().createGeometryCollection(jt.toGeometryArray(e))},interfaces_:function(){return[]},getClass:function(){return Ke}}),Ke.map=function(t,e){return new Ke(e).map(t)},e(Je.prototype,{interfaces_:function(){return[]},getClass:function(){return Je}}),Je.opposite=function(t){return t===Je.LEFT?Je.RIGHT:t===Je.RIGHT?Je.LEFT:t},Je.ON=0,Je.LEFT=1,Je.RIGHT=2,e(Qe.prototype,{setAllLocations:function(t){for(var e=0;e<this.location.length;e++)this.location[e]=t},isNull:function(){for(var t=0;t<this.location.length;t++)if(this.location[t]!==C.NONE)return!1;return!0},setAllLocationsIfNull:function(t){for(var e=0;e<this.location.length;e++)this.location[e]===C.NONE&&(this.location[e]=t)},isLine:function(){return 1===this.location.length},merge:function(t){if(t.location.length>this.location.length){var e=new Array(3).fill(null);e[Je.ON]=this.location[Je.ON],e[Je.LEFT]=C.NONE,e[Je.RIGHT]=C.NONE,this.location=e}for(var n=0;n<this.location.length;n++)this.location[n]===C.NONE&&n<t.location.length&&(this.location[n]=t.location[n])},getLocations:function(){return this.location},flip:function(){if(this.location.length<=1)return null;var t=this.location[Je.LEFT];this.location[Je.LEFT]=this.location[Je.RIGHT],this.location[Je.RIGHT]=t},toString:function(){var t=new P;return this.location.length>1&&t.append(C.toLocationSymbol(this.location[Je.LEFT])),t.append(C.toLocationSymbol(this.location[Je.ON])),this.location.length>1&&t.append(C.toLocationSymbol(this.location[Je.RIGHT])),t.toString()},setLocations:function(t,e,n){this.location[Je.ON]=t,this.location[Je.LEFT]=e,this.location[Je.RIGHT]=n},get:function(t){return t<this.location.length?this.location[t]:C.NONE},isArea:function(){return this.location.length>1},isAnyNull:function(){for(var t=0;t<this.location.length;t++)if(this.location[t]===C.NONE)return!0;return!1},setLocation:function(){if(1===arguments.length){var t=arguments[0];this.setLocation(Je.ON,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.location[e]=n}},init:function(t){this.location=new Array(t).fill(null),this.setAllLocations(C.NONE)},isEqualOnSide:function(t,e){return this.location[e]===t.location[e]},allPositionsEqual:function(t){for(var e=0;e<this.location.length;e++)if(this.location[e]!==t)return!1;return!0},interfaces_:function(){return[]},getClass:function(){return Qe}}),e(tn.prototype,{getGeometryCount:function(){var t=0;return this.elt[0].isNull()||t++,this.elt[1].isNull()||t++,t},setAllLocations:function(t,e){this.elt[t].setAllLocations(e)},isNull:function(t){return this.elt[t].isNull()},setAllLocationsIfNull:function(){if(1===arguments.length){var t=arguments[0];this.setAllLocationsIfNull(0,t),this.setAllLocationsIfNull(1,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.elt[e].setAllLocationsIfNull(n)}},isLine:function(t){return this.elt[t].isLine()},merge:function(t){for(var e=0;2>e;e++)null===this.elt[e]&&null!==t.elt[e]?this.elt[e]=new Qe(t.elt[e]):this.elt[e].merge(t.elt[e])},flip:function(){this.elt[0].flip(),this.elt[1].flip()},getLocation:function(){if(1===arguments.length){var t=arguments[0];return this.elt[t].get(Je.ON)}if(2===arguments.length){var e=arguments[0],n=arguments[1];return this.elt[e].get(n)}},toString:function(){var t=new P;return null!==this.elt[0]&&(t.append("A:"),t.append(this.elt[0].toString())),null!==this.elt[1]&&(t.append(" B:"),t.append(this.elt[1].toString())),t.toString()},isArea:function(){if(0===arguments.length)return this.elt[0].isArea()||this.elt[1].isArea();if(1===arguments.length){var t=arguments[0];return this.elt[t].isArea()}},isAnyNull:function(t){return this.elt[t].isAnyNull()},setLocation:function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];this.elt[t].setLocation(Je.ON,e)}else if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];this.elt[n].setLocation(i,r)}},isEqualOnSide:function(t,e){return this.elt[0].isEqualOnSide(t.elt[0],e)&&this.elt[1].isEqualOnSide(t.elt[1],e)},allPositionsEqual:function(t,e){return this.elt[t].allPositionsEqual(e)},toLine:function(t){this.elt[t].isArea()&&(this.elt[t]=new Qe(this.elt[t].location[0]))},interfaces_:function(){return[]},getClass:function(){return tn}}),tn.toLineLabel=function(t){for(var e=new tn(C.NONE),n=0;2>n;n++)e.setLocation(n,t.getLocation(n));return e},e(en.prototype,{computeRing:function(){if(null!==this.ring)return null;for(var t=new Array(this.pts.size()).fill(null),e=0;e<this.pts.size();e++)t[e]=this.pts.get(e);this.ring=this.geometryFactory.createLinearRing(t),this._isHole=Qt.isCCW(this.ring.getCoordinates())},isIsolated:function(){return 1===this.label.getGeometryCount()},computePoints:function(t){this.startDe=t;var e=t,n=!0;do{if(null===e)throw new je("Found null DirectedEdge");if(e.getEdgeRing()===this)throw new je("Directed Edge visited twice during ring-building at "+e.getCoordinate());this.edges.add(e);var i=e.getLabel();f.isTrue(i.isArea()),this.mergeLabel(i),this.addPoints(e.getEdge(),e.isForward(),n),n=!1,this.setEdgeRing(e,this),e=this.getNext(e)}while(e!==this.startDe)},getLinearRing:function(){return this.ring},getCoordinate:function(t){return this.pts.get(t)},computeMaxNodeDegree:function(){this.maxNodeDegree=0;var t=this.startDe;do{var e=t.getNode().getEdges().getOutgoingDegree(this);e>this.maxNodeDegree&&(this.maxNodeDegree=e),t=this.getNext(t)}while(t!==this.startDe);this.maxNodeDegree*=2},addPoints:function(t,e,n){var i=t.getCoordinates();if(e){var r=1;n&&(r=0);for(var s=r;s<i.length;s++)this.pts.add(i[s])}else for(r=i.length-2,n&&(r=i.length-1),s=r;s>=0;s--)this.pts.add(i[s])},isHole:function(){return this._isHole},setInResult:function(){var t=this.startDe;do{t.getEdge().setInResult(!0),t=t.getNext()}while(t!==this.startDe)},containsPoint:function(t){var e=this.getLinearRing();if(!e.getEnvelopeInternal().contains(t))return!1;if(!Qt.isPointInRing(t,e.getCoordinates()))return!1;for(var n=this.holes.iterator();n.hasNext();)if(n.next().containsPoint(t))return!1;return!0},addHole:function(t){this.holes.add(t)},isShell:function(){return null===this.shell},getLabel:function(){return this.label},getEdges:function(){return this.edges},getMaxNodeDegree:function(){return this.maxNodeDegree<0&&this.computeMaxNodeDegree(),this.maxNodeDegree},getShell:function(){return this.shell},mergeLabel:function(){if(1===arguments.length){var t=arguments[0];this.mergeLabel(t,0),this.mergeLabel(t,1)}else if(2===arguments.length){var e=arguments[1],n=arguments[0].getLocation(e,Je.RIGHT);if(n===C.NONE)return null;if(this.label.getLocation(e)===C.NONE)return this.label.setLocation(e,n),null}},setShell:function(t){this.shell=t,null!==t&&t.addHole(this)},toPolygon:function(t){for(var e=new Array(this.holes.size()).fill(null),n=0;n<this.holes.size();n++)e[n]=this.holes.get(n).getLinearRing();return t.createPolygon(this.getLinearRing(),e)},interfaces_:function(){return[]},getClass:function(){return en}}),u(nn,en),e(nn.prototype,{setEdgeRing:function(t,e){t.setMinEdgeRing(e)},getNext:function(t){return t.getNextMin()},interfaces_:function(){return[]},getClass:function(){return nn}}),u(rn,en),e(rn.prototype,{buildMinimalRings:function(){var t=new _,e=this.startDe;do{if(null===e.getMinEdgeRing()){var n=new nn(e,this.geometryFactory);t.add(n)}e=e.getNext()}while(e!==this.startDe);return t},setEdgeRing:function(t,e){t.setEdgeRing(e)},linkDirectedEdgesForMinimalEdgeRings:function(){var t=this.startDe;do{t.getNode().getEdges().linkMinimalDirectedEdges(this),t=t.getNext()}while(t!==this.startDe)},getNext:function(t){return t.getNext()},interfaces_:function(){return[]},getClass:function(){return rn}}),e(sn.prototype,{setVisited:function(t){this._isVisited=t},setInResult:function(t){this._isInResult=t},isCovered:function(){return this._isCovered},isCoveredSet:function(){return this._isCoveredSet},setLabel:function(t){this.label=t},getLabel:function(){return this.label},setCovered:function(t){this._isCovered=t,this._isCoveredSet=!0},updateIM:function(t){f.isTrue(this.label.getGeometryCount()>=2,"found partial label"),this.computeIM(t)},isInResult:function(){return this._isInResult},isVisited:function(){return this._isVisited},interfaces_:function(){return[]},getClass:function(){return sn}}),u(on,sn),e(on.prototype,{isIncidentEdgeInResult:function(){for(var t=this.getEdges().getEdges().iterator();t.hasNext();)if(t.next().getEdge().isInResult())return!0;return!1},isIsolated:function(){return 1===this.label.getGeometryCount()},getCoordinate:function(){return this.coord},print:function(t){t.println("node "+this.coord+" lbl: "+this.label)},computeIM:function(t){},computeMergedLocation:function(t,e){var n=C.NONE;if(n=this.label.getLocation(e),!t.isNull(e)){var i=t.getLocation(e);n!==C.BOUNDARY&&(n=i)}return n},setLabel:function(){if(2!==arguments.length)return sn.prototype.setLabel.apply(this,arguments);var t=arguments[0],e=arguments[1];null===this.label?this.label=new tn(t,e):this.label.setLocation(t,e)},getEdges:function(){return this.edges},mergeLabel:function(){if(arguments[0]instanceof on){var t=arguments[0];this.mergeLabel(t.label)}else if(arguments[0]instanceof tn)for(var e=arguments[0],n=0;2>n;n++){var i=this.computeMergedLocation(e,n);this.label.getLocation(n)===C.NONE&&this.label.setLocation(n,i)}},add:function(t){this.edges.insert(t),t.setNode(this)},setLabelBoundary:function(t){if(null===this.label)return null;var e=C.NONE;null!==this.label&&(e=this.label.getLocation(t));var n=null;switch(e){case C.BOUNDARY:n=C.INTERIOR;break;case C.INTERIOR:default:n=C.BOUNDARY}this.label.setLocation(t,n)},interfaces_:function(){return[]},getClass:function(){return on}}),e(an.prototype,{find:function(t){return this.nodeMap.get(t)},addNode:function(){if(arguments[0]instanceof d){var t=arguments[0];return null===(e=this.nodeMap.get(t))&&(e=this.nodeFact.createNode(t),this.nodeMap.put(t,e)),e}if(arguments[0]instanceof on){var e,n=arguments[0];return null===(e=this.nodeMap.get(n.getCoordinate()))?(this.nodeMap.put(n.getCoordinate(),n),n):(e.mergeLabel(n),e)}},print:function(t){for(var e=this.iterator();e.hasNext();)e.next().print(t)},iterator:function(){return this.nodeMap.values().iterator()},values:function(){return this.nodeMap.values()},getBoundaryNodes:function(t){for(var e=new _,n=this.iterator();n.hasNext();){var i=n.next();i.getLabel().getLocation(t)===C.BOUNDARY&&e.add(i)}return e},add:function(t){var e=t.getCoordinate();this.addNode(e).add(t)},interfaces_:function(){return[]},getClass:function(){return an}}),e(ln.prototype,{compareDirection:function(t){return this.dx===t.dx&&this.dy===t.dy?0:this.quadrant>t.quadrant?1:this.quadrant<t.quadrant?-1:Qt.computeOrientation(t.p0,t.p1,this.p1)},getDy:function(){return this.dy},getCoordinate:function(){return this.p0},setNode:function(t){this.node=t},print:function(t){var e=Math.atan2(this.dy,this.dx),n=this.getClass().getName(),i=n.lastIndexOf("."),r=n.substring(i+1);t.print("  "+r+": "+this.p0+" - "+this.p1+" "+this.quadrant+":"+e+"   "+this.label)},compareTo:function(t){var e=t;return this.compareDirection(e)},getDirectedCoordinate:function(){return this.p1},getDx:function(){return this.dx},getLabel:function(){return this.label},getEdge:function(){return this.edge},getQuadrant:function(){return this.quadrant},getNode:function(){return this.node},toString:function(){var t=Math.atan2(this.dy,this.dx),e=this.getClass().getName(),n=e.lastIndexOf(".");return"  "+e.substring(n+1)+": "+this.p0+" - "+this.p1+" "+this.quadrant+":"+t+"   "+this.label},computeLabel:function(t){},init:function(t,e){this.p0=t,this.p1=e,this.dx=e.x-t.x,this.dy=e.y-t.y,this.quadrant=Be.quadrant(this.dx,this.dy),f.isTrue(!(0===this.dx&&0===this.dy),"EdgeEnd with identical endpoints found")},interfaces_:function(){return[s]},getClass:function(){return ln}}),u(hn,ln),e(hn.prototype,{getNextMin:function(){return this.nextMin},getDepth:function(t){return this.depth[t]},setVisited:function(t){this._isVisited=t},computeDirectedLabel:function(){this.label=new tn(this.edge.getLabel()),this._isForward||this.label.flip()},getNext:function(){return this.next},setDepth:function(t,e){if(-999!==this.depth[t]&&this.depth[t]!==e)throw new je("assigned depths do not match",this.getCoordinate());this.depth[t]=e},isInteriorAreaEdge:function(){for(var t=!0,e=0;2>e;e++)this.label.isArea(e)&&this.label.getLocation(e,Je.LEFT)===C.INTERIOR&&this.label.getLocation(e,Je.RIGHT)===C.INTERIOR||(t=!1);return t},setNextMin:function(t){this.nextMin=t},print:function(t){ln.prototype.print.call(this,t),t.print(" "+this.depth[Je.LEFT]+"/"+this.depth[Je.RIGHT]),t.print(" ("+this.getDepthDelta()+")"),this._isInResult&&t.print(" inResult")},setMinEdgeRing:function(t){this.minEdgeRing=t},isLineEdge:function(){var t=this.label.isLine(0)||this.label.isLine(1),e=!this.label.isArea(0)||this.label.allPositionsEqual(0,C.EXTERIOR),n=!this.label.isArea(1)||this.label.allPositionsEqual(1,C.EXTERIOR);return t&&e&&n},setEdgeRing:function(t){this.edgeRing=t},getMinEdgeRing:function(){return this.minEdgeRing},getDepthDelta:function(){var t=this.edge.getDepthDelta();return this._isForward||(t=-t),t},setInResult:function(t){this._isInResult=t},getSym:function(){return this.sym},isForward:function(){return this._isForward},getEdge:function(){return this.edge},printEdge:function(t){this.print(t),t.print(" "),this._isForward?this.edge.print(t):this.edge.printReverse(t)},setSym:function(t){this.sym=t},setVisitedEdge:function(t){this.setVisited(t),this.sym.setVisited(t)},setEdgeDepths:function(t,e){var n=this.getEdge().getDepthDelta();this._isForward||(n=-n);var i=1;t===Je.LEFT&&(i=-1);var r=Je.opposite(t),s=e+n*i;this.setDepth(t,e),this.setDepth(r,s)},getEdgeRing:function(){return this.edgeRing},isInResult:function(){return this._isInResult},setNext:function(t){this.next=t},isVisited:function(){return this._isVisited},interfaces_:function(){return[]},getClass:function(){return hn}}),hn.depthFactor=function(t,e){return t===C.EXTERIOR&&e===C.INTERIOR?1:t===C.INTERIOR&&e===C.EXTERIOR?-1:0},e(un.prototype,{createNode:function(t){return new on(t,null)},interfaces_:function(){return[]},getClass:function(){return un}}),e(cn.prototype,{printEdges:function(t){t.println("Edges:");for(var e=0;e<this.edges.size();e++){t.println("edge "+e+":");var n=this.edges.get(e);n.print(t),n.eiList.print(t)}},find:function(t){return this.nodes.find(t)},addNode:function(){if(arguments[0]instanceof on){var t=arguments[0];return this.nodes.addNode(t)}if(arguments[0]instanceof d){var e=arguments[0];return this.nodes.addNode(e)}},getNodeIterator:function(){return this.nodes.iterator()},linkResultDirectedEdges:function(){for(var t=this.nodes.iterator();t.hasNext();)t.next().getEdges().linkResultDirectedEdges()},debugPrintln:function(t){O.out.println(t)},isBoundaryNode:function(t,e){var n=this.nodes.find(e);if(null===n)return!1;var i=n.getLabel();return null!==i&&i.getLocation(t)===C.BOUNDARY},linkAllDirectedEdges:function(){for(var t=this.nodes.iterator();t.hasNext();)t.next().getEdges().linkAllDirectedEdges()},matchInSameDirection:function(t,e,n,i){return!!t.equals(n)&&Qt.computeOrientation(t,e,i)===Qt.COLLINEAR&&Be.quadrant(t,e)===Be.quadrant(n,i)},getEdgeEnds:function(){return this.edgeEndList},debugPrint:function(t){O.out.print(t)},getEdgeIterator:function(){return this.edges.iterator()},findEdgeInSameDirection:function(t,e){for(var n=0;n<this.edges.size();n++){var i=this.edges.get(n),r=i.getCoordinates();if(this.matchInSameDirection(t,e,r[0],r[1]))return i;if(this.matchInSameDirection(t,e,r[r.length-1],r[r.length-2]))return i}return null},insertEdge:function(t){this.edges.add(t)},findEdgeEnd:function(t){for(var e=this.getEdgeEnds().iterator();e.hasNext();){var n=e.next();if(n.getEdge()===t)return n}return null},addEdges:function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();this.edges.add(n);var i=new hn(n,!0),r=new hn(n,!1);i.setSym(r),r.setSym(i),this.add(i),this.add(r)}},add:function(t){this.nodes.add(t),this.edgeEndList.add(t)},getNodes:function(){return this.nodes.values()},findEdge:function(t,e){for(var n=0;n<this.edges.size();n++){var i=this.edges.get(n),r=i.getCoordinates();if(t.equals(r[0])&&e.equals(r[1]))return i}return null},interfaces_:function(){return[]},getClass:function(){return cn}}),cn.linkResultDirectedEdges=function(t){for(var e=t.iterator();e.hasNext();)e.next().getEdges().linkResultDirectedEdges()},e(fn.prototype,{sortShellsAndHoles:function(t,e,n){for(var i=t.iterator();i.hasNext();){var r=i.next();r.isHole()?n.add(r):e.add(r)}},computePolygons:function(t){for(var e=new _,n=t.iterator();n.hasNext();){var i=n.next().toPolygon(this.geometryFactory);e.add(i)}return e},placeFreeHoles:function(t,e){for(var n=e.iterator();n.hasNext();){var i=n.next();if(null===i.getShell()){var r=this.findEdgeRingContaining(i,t);if(null===r)throw new je("unable to assign hole to a shell",i.getCoordinate(0));i.setShell(r)}}},buildMinimalEdgeRings:function(t,e,n){for(var i=new _,r=t.iterator();r.hasNext();){var s=r.next();if(s.getMaxNodeDegree()>2){s.linkDirectedEdgesForMinimalEdgeRings();var o=s.buildMinimalRings(),a=this.findShell(o);null!==a?(this.placePolygonHoles(a,o),e.add(a)):n.addAll(o)}else i.add(s)}return i},containsPoint:function(t){for(var e=this.shellList.iterator();e.hasNext();)if(e.next().containsPoint(t))return!0;return!1},buildMaximalEdgeRings:function(t){for(var e=new _,n=t.iterator();n.hasNext();){var i=n.next();if(i.isInResult()&&i.getLabel().isArea()&&null===i.getEdgeRing()){var r=new rn(i,this.geometryFactory);e.add(r),r.setInResult()}}return e},placePolygonHoles:function(t,e){for(var n=e.iterator();n.hasNext();){var i=n.next();i.isHole()&&i.setShell(t)}},getPolygons:function(){return this.computePolygons(this.shellList)},findEdgeRingContaining:function(t,e){for(var n=t.getLinearRing(),i=n.getEnvelopeInternal(),r=n.getCoordinateN(0),s=null,o=null,a=e.iterator();a.hasNext();){var l=a.next(),h=l.getLinearRing(),u=h.getEnvelopeInternal();null!==s&&(o=s.getLinearRing().getEnvelopeInternal());var c=!1;u.contains(i)&&Qt.isPointInRing(r,h.getCoordinates())&&(c=!0),c&&(null===s||o.contains(u))&&(s=l)}return s},findShell:function(t){for(var e=0,n=null,i=t.iterator();i.hasNext();){var r=i.next();r.isHole()||(n=r,e++)}return f.isTrue(1>=e,"found two shells in MinimalEdgeRing list"),n},add:function(){if(1===arguments.length){var t=arguments[0];this.add(t.getEdgeEnds(),t.getNodes())}else if(2===arguments.length){var e=arguments[0],n=arguments[1];cn.linkResultDirectedEdges(n);var i=this.buildMaximalEdgeRings(e),r=new _,s=this.buildMinimalEdgeRings(i,this.shellList,r);this.sortShellsAndHoles(s,this.shellList,r),this.placeFreeHoles(this.shellList,r)}},interfaces_:function(){return[]},getClass:function(){return fn}}),e(dn.prototype,{collectLines:function(t){for(var e=this.op.getGraph().getEdgeEnds().iterator();e.hasNext();){var n=e.next();this.collectLineEdge(n,t,this.lineEdgesList),this.collectBoundaryTouchEdge(n,t,this.lineEdgesList)}},labelIsolatedLine:function(t,e){var n=this.ptLocator.locate(t.getCoordinate(),this.op.getArgGeometry(e));t.getLabel().setLocation(e,n)},build:function(t){return this.findCoveredLineEdges(),this.collectLines(t),this.buildLines(t),this.resultLineList},collectLineEdge:function(t,e,n){var i=t.getLabel(),r=t.getEdge();t.isLineEdge()&&(t.isVisited()||!Xn.isResultOfOp(i,e)||r.isCovered()||(n.add(r),t.setVisitedEdge(!0)))},findCoveredLineEdges:function(){for(var t=this.op.getGraph().getNodes().iterator();t.hasNext();)t.next().getEdges().findCoveredLineEdges();for(var e=this.op.getGraph().getEdgeEnds().iterator();e.hasNext();){var n=e.next(),i=n.getEdge();if(n.isLineEdge()&&!i.isCoveredSet()){var r=this.op.isCoveredByA(n.getCoordinate());i.setCovered(r)}}},labelIsolatedLines:function(t){for(var e=t.iterator();e.hasNext();){var n=e.next(),i=n.getLabel();n.isIsolated()&&(i.isNull(0)?this.labelIsolatedLine(n,0):this.labelIsolatedLine(n,1))}},buildLines:function(t){for(var e=this.lineEdgesList.iterator();e.hasNext();){var n=e.next(),i=(n.getLabel(),this.geometryFactory.createLineString(n.getCoordinates()));this.resultLineList.add(i),n.setInResult(!0)}},collectBoundaryTouchEdge:function(t,e,n){var i=t.getLabel();return t.isLineEdge()||t.isVisited()||t.isInteriorAreaEdge()||t.getEdge().isInResult()?null:(f.isTrue(!(t.isInResult()||t.getSym().isInResult())||!t.getEdge().isInResult()),void(Xn.isResultOfOp(i,e)&&e===Xn.INTERSECTION&&(n.add(t.getEdge()),t.setVisitedEdge(!0))))},interfaces_:function(){return[]},getClass:function(){return dn}}),e(gn.prototype,{filterCoveredNodeToPoint:function(t){var e=t.getCoordinate();if(!this.op.isCoveredByLA(e)){var n=this.geometryFactory.createPoint(e);this.resultPointList.add(n)}},extractNonCoveredResultNodes:function(t){for(var e=this.op.getGraph().getNodes().iterator();e.hasNext();){var n=e.next();if(!(n.isInResult()||n.isIncidentEdgeInResult()||0!==n.getEdges().getDegree()&&t!==Xn.INTERSECTION)){var i=n.getLabel();Xn.isResultOfOp(i,t)&&this.filterCoveredNodeToPoint(n)}}},build:function(t){return this.extractNonCoveredResultNodes(t),this.resultPointList},interfaces_:function(){return[]},getClass:function(){return gn}}),e(pn.prototype,{locate:function(t){},interfaces_:function(){return[]},getClass:function(){return pn}}),e(mn.prototype,{locate:function(t){return mn.locate(t,this.geom)},interfaces_:function(){return[pn]},getClass:function(){return mn}}),mn.isPointInRing=function(t,e){return!!e.getEnvelopeInternal().intersects(t)&&Qt.isPointInRing(t,e.getCoordinates())},mn.containsPointInPolygon=function(t,e){if(e.isEmpty())return!1;var n=e.getExteriorRing();if(!mn.isPointInRing(t,n))return!1;for(var i=0;i<e.getNumInteriorRing();i++){var r=e.getInteriorRingN(i);if(mn.isPointInRing(t,r))return!1}return!0},mn.containsPoint=function(t,e){if(e instanceof Mt)return mn.containsPointInPolygon(t,e);if(e instanceof ft)for(var n=new me(e);n.hasNext();){var i=n.next();if(i!==e&&mn.containsPoint(t,i))return!0}return!1},mn.locate=function(t,e){return e.isEmpty()?C.EXTERIOR:mn.containsPoint(t,e)?C.INTERIOR:C.EXTERIOR},e(yn.prototype,{getNextCW:function(t){this.getEdges();var e=this.edgeList.indexOf(t),n=e-1;return 0===e&&(n=this.edgeList.size()-1),this.edgeList.get(n)},propagateSideLabels:function(t){for(var e=C.NONE,n=this.iterator();n.hasNext();)(s=(r=n.next()).getLabel()).isArea(t)&&s.getLocation(t,Je.LEFT)!==C.NONE&&(e=s.getLocation(t,Je.LEFT));if(e===C.NONE)return null;var i=e;for(n=this.iterator();n.hasNext();){var r,s;if((s=(r=n.next()).getLabel()).getLocation(t,Je.ON)===C.NONE&&s.setLocation(t,Je.ON,i),s.isArea(t)){var o=s.getLocation(t,Je.LEFT),a=s.getLocation(t,Je.RIGHT);if(a!==C.NONE){if(a!==i)throw new je("side location conflict",r.getCoordinate());o===C.NONE&&f.shouldNeverReachHere("found single null side (at "+r.getCoordinate()+")"),i=o}else f.isTrue(s.getLocation(t,Je.LEFT)===C.NONE,"found single null side"),s.setLocation(t,Je.RIGHT,i),s.setLocation(t,Je.LEFT,i)}}},getCoordinate:function(){var t=this.iterator();return t.hasNext()?t.next().getCoordinate():null},print:function(t){O.out.println("EdgeEndStar:   "+this.getCoordinate());for(var e=this.iterator();e.hasNext();)e.next().print(t)},isAreaLabelsConsistent:function(t){return this.computeEdgeEndLabels(t.getBoundaryNodeRule()),this.checkAreaLabelsConsistent(0)},checkAreaLabelsConsistent:function(t){var e=this.getEdges();if(e.size()<=0)return!0;var n=e.size()-1,i=e.get(n).getLabel().getLocation(t,Je.LEFT);f.isTrue(i!==C.NONE,"Found unlabelled area edge");for(var r=i,s=this.iterator();s.hasNext();){var o=s.next().getLabel();f.isTrue(o.isArea(t),"Found non-area edge");var a=o.getLocation(t,Je.LEFT),l=o.getLocation(t,Je.RIGHT);if(a===l)return!1;if(l!==r)return!1;r=a}return!0},findIndex:function(t){this.iterator();for(var e=0;e<this.edgeList.size();e++)if(this.edgeList.get(e)===t)return e;return-1},iterator:function(){return this.getEdges().iterator()},getEdges:function(){return null===this.edgeList&&(this.edgeList=new _(this.edgeMap.values())),this.edgeList},getLocation:function(t,e,n){return this.ptInAreaLocation[t]===C.NONE&&(this.ptInAreaLocation[t]=mn.locate(e,n[t].getGeometry())),this.ptInAreaLocation[t]},toString:function(){var t=new P;t.append("EdgeEndStar:   "+this.getCoordinate()),t.append("\n");for(var e=this.iterator();e.hasNext();){var n=e.next();t.append(n),t.append("\n")}return t.toString()},computeEdgeEndLabels:function(t){for(var e=this.iterator();e.hasNext();)e.next().computeLabel(t)},computeLabelling:function(t){this.computeEdgeEndLabels(t[0].getBoundaryNodeRule()),this.propagateSideLabels(0),this.propagateSideLabels(1);for(var e=[!1,!1],n=this.iterator();n.hasNext();)for(var i=(s=n.next()).getLabel(),r=0;2>r;r++)i.isLine(r)&&i.getLocation(r)===C.BOUNDARY&&(e[r]=!0);for(n=this.iterator();n.hasNext();){var s;for(i=(s=n.next()).getLabel(),r=0;2>r;r++)if(i.isAnyNull(r)){var o=C.NONE;if(e[r])o=C.EXTERIOR;else{var a=s.getCoordinate();o=this.getLocation(r,a,t)}i.setAllLocationsIfNull(r,o)}}},getDegree:function(){return this.edgeMap.size()},insertEdgeEnd:function(t,e){this.edgeMap.put(t,e),this.edgeList=null},interfaces_:function(){return[]},getClass:function(){return yn}}),u(vn,yn),e(vn.prototype,{linkResultDirectedEdges:function(){this.getResultAreaEdges();for(var t=null,e=null,n=this.SCANNING_FOR_INCOMING,i=0;i<this.resultAreaEdgeList.size();i++){var r=this.resultAreaEdgeList.get(i),s=r.getSym();if(r.getLabel().isArea())switch(null===t&&r.isInResult()&&(t=r),n){case this.SCANNING_FOR_INCOMING:if(!s.isInResult())continue;e=s,n=this.LINKING_TO_OUTGOING;break;case this.LINKING_TO_OUTGOING:if(!r.isInResult())continue;e.setNext(r),n=this.SCANNING_FOR_INCOMING}}if(n===this.LINKING_TO_OUTGOING){if(null===t)throw new je("no outgoing dirEdge found",this.getCoordinate());f.isTrue(t.isInResult(),"unable to link last incoming dirEdge"),e.setNext(t)}},insert:function(t){var e=t;this.insertEdgeEnd(e,e)},getRightmostEdge:function(){var t=this.getEdges(),e=t.size();if(1>e)return null;var n=t.get(0);if(1===e)return n;var i=t.get(e-1),r=n.getQuadrant(),s=i.getQuadrant();return Be.isNorthern(r)&&Be.isNorthern(s)?n:Be.isNorthern(r)||Be.isNorthern(s)?0!==n.getDy()?n:0!==i.getDy()?i:(f.shouldNeverReachHere("found two horizontal edges incident on node"),null):i},print:function(t){O.out.println("DirectedEdgeStar: "+this.getCoordinate());for(var e=this.iterator();e.hasNext();){var n=e.next();t.print("out "),n.print(t),t.println(),t.print("in "),n.getSym().print(t),t.println()}},getResultAreaEdges:function(){if(null!==this.resultAreaEdgeList)return this.resultAreaEdgeList;this.resultAreaEdgeList=new _;for(var t=this.iterator();t.hasNext();){var e=t.next();(e.isInResult()||e.getSym().isInResult())&&this.resultAreaEdgeList.add(e)}return this.resultAreaEdgeList},updateLabelling:function(t){for(var e=this.iterator();e.hasNext();){var n=e.next().getLabel();n.setAllLocationsIfNull(0,t.getLocation(0)),n.setAllLocationsIfNull(1,t.getLocation(1))}},linkAllDirectedEdges:function(){this.getEdges();for(var t=null,e=null,n=this.edgeList.size()-1;n>=0;n--){var i=this.edgeList.get(n),r=i.getSym();null===e&&(e=r),null!==t&&r.setNext(t),t=i}e.setNext(t)},computeDepths:function(){if(1===arguments.length){var t=arguments[0],e=this.findIndex(t),n=(t.getLabel(),t.getDepth(Je.LEFT)),i=t.getDepth(Je.RIGHT),r=this.computeDepths(e+1,this.edgeList.size(),n);if(this.computeDepths(0,e,r)!==i)throw new je("depth mismatch at "+t.getCoordinate())}else if(3===arguments.length){for(var s=arguments[1],o=arguments[2],a=arguments[0];s>a;a++){var l=this.edgeList.get(a);l.getLabel(),l.setEdgeDepths(Je.RIGHT,o),o=l.getDepth(Je.LEFT)}return o}},mergeSymLabels:function(){for(var t=this.iterator();t.hasNext();){var e=t.next();e.getLabel().merge(e.getSym().getLabel())}},linkMinimalDirectedEdges:function(t){for(var e=null,n=null,i=this.SCANNING_FOR_INCOMING,r=this.resultAreaEdgeList.size()-1;r>=0;r--){var s=this.resultAreaEdgeList.get(r),o=s.getSym();switch(null===e&&s.getEdgeRing()===t&&(e=s),i){case this.SCANNING_FOR_INCOMING:if(o.getEdgeRing()!==t)continue;n=o,i=this.LINKING_TO_OUTGOING;break;case this.LINKING_TO_OUTGOING:if(s.getEdgeRing()!==t)continue;n.setNextMin(s),i=this.SCANNING_FOR_INCOMING}}i===this.LINKING_TO_OUTGOING&&(f.isTrue(null!==e,"found null for first outgoing dirEdge"),f.isTrue(e.getEdgeRing()===t,"unable to link last incoming dirEdge"),n.setNextMin(e))},getOutgoingDegree:function(){if(0===arguments.length){for(var t=0,e=this.iterator();e.hasNext();)e.next().isInResult()&&t++;return t}if(1===arguments.length){var n=arguments[0];for(t=0,e=this.iterator();e.hasNext();)e.next().getEdgeRing()===n&&t++;return t}},getLabel:function(){return this.label},findCoveredLineEdges:function(){for(var t=C.NONE,e=this.iterator();e.hasNext();){var n=(r=e.next()).getSym();if(!r.isLineEdge()){if(r.isInResult()){t=C.INTERIOR;break}if(n.isInResult()){t=C.EXTERIOR;break}}}if(t===C.NONE)return null;var i=t;for(e=this.iterator();e.hasNext();){var r;n=(r=e.next()).getSym(),r.isLineEdge()?r.getEdge().setCovered(i===C.INTERIOR):(r.isInResult()&&(i=C.EXTERIOR),n.isInResult()&&(i=C.INTERIOR))}},computeLabelling:function(t){yn.prototype.computeLabelling.call(this,t),this.label=new tn(C.NONE);for(var e=this.iterator();e.hasNext();)for(var n=e.next().getEdge().getLabel(),i=0;2>i;i++){var r=n.getLocation(i);r!==C.INTERIOR&&r!==C.BOUNDARY||this.label.setLocation(i,C.INTERIOR)}},interfaces_:function(){return[]},getClass:function(){return vn}}),u(wn,un),e(wn.prototype,{createNode:function(t){return new on(t,new vn)},interfaces_:function(){return[]},getClass:function(){return wn}}),e(xn.prototype,{computeIntersections:function(t,e){this.mce.computeIntersectsForChain(this.chainIndex,t.mce,t.chainIndex,e)},interfaces_:function(){return[]},getClass:function(){return xn}}),e(_n.prototype,{isDelete:function(){return this.eventType===_n.DELETE},setDeleteEventIndex:function(t){this.deleteEventIndex=t},getObject:function(){return this.obj},compareTo:function(t){var e=t;return this.xValue<e.xValue?-1:this.xValue>e.xValue?1:this.eventType<e.eventType?-1:this.eventType>e.eventType?1:0},getInsertEvent:function(){return this.insertEvent},isInsert:function(){return this.eventType===_n.INSERT},isSameLabel:function(t){return null!==this.label&&this.label===t.label},getDeleteEventIndex:function(){return this.deleteEventIndex},interfaces_:function(){return[s]},getClass:function(){return _n}}),_n.INSERT=1,_n.DELETE=2,e(bn.prototype,{interfaces_:function(){return[]},getClass:function(){return bn}}),e(En.prototype,{isTrivialIntersection:function(t,e,n,i){if(t===n&&1===this.li.getIntersectionNum()){if(En.isAdjacentSegments(e,i))return!0;if(t.isClosed()){var r=t.getNumPoints()-1;if(0===e&&i===r||0===i&&e===r)return!0}}return!1},getProperIntersectionPoint:function(){return this.properIntersectionPoint},setIsDoneIfProperInt:function(t){this.isDoneWhenProperInt=t},hasProperInteriorIntersection:function(){return this.hasProperInterior},isBoundaryPointInternal:function(t,e){for(var n=e.iterator();n.hasNext();){var i=n.next().getCoordinate();if(t.isIntersection(i))return!0}return!1},hasProperIntersection:function(){return this.hasProper},hasIntersection:function(){return this._hasIntersection},isDone:function(){return this._isDone},isBoundaryPoint:function(t,e){return!(null===e||!this.isBoundaryPointInternal(t,e[0])&&!this.isBoundaryPointInternal(t,e[1]))},setBoundaryNodes:function(t,e){this.bdyNodes=new Array(2).fill(null),this.bdyNodes[0]=t,this.bdyNodes[1]=e},addIntersections:function(t,e,n,i){if(t===n&&e===i)return null;this.numTests++;var r=t.getCoordinates()[e],s=t.getCoordinates()[e+1],o=n.getCoordinates()[i],a=n.getCoordinates()[i+1];this.li.computeIntersection(r,s,o,a),this.li.hasIntersection()&&(this.recordIsolated&&(t.setIsolated(!1),n.setIsolated(!1)),this.numIntersections++,this.isTrivialIntersection(t,e,n,i)||(this._hasIntersection=!0,!this.includeProper&&this.li.isProper()||(t.addIntersections(this.li,e,0),n.addIntersections(this.li,i,1)),this.li.isProper()&&(this.properIntersectionPoint=this.li.getIntersection(0).copy(),this.hasProper=!0,this.isDoneWhenProperInt&&(this._isDone=!0),this.isBoundaryPoint(this.li,this.bdyNodes)||(this.hasProperInterior=!0))))},interfaces_:function(){return[]},getClass:function(){return En}}),En.isAdjacentSegments=function(t,e){return 1===Math.abs(t-e)},u(Sn,bn),e(Sn.prototype,{prepareEvents:function(){Zs.sort(this.events);for(var t=0;t<this.events.size();t++){var e=this.events.get(t);e.isDelete()&&e.getInsertEvent().setDeleteEventIndex(t)}},computeIntersections:function(){if(1===arguments.length){var t=arguments[0];this.nOverlaps=0,this.prepareEvents();for(var e=0;e<this.events.size();e++){var n=this.events.get(e);if(n.isInsert()&&this.processOverlaps(e,n.getDeleteEventIndex(),n,t),t.isDone())break}}else if(3===arguments.length)if(arguments[2]instanceof En&&M(arguments[0],v)&&M(arguments[1],v)){var i=arguments[0],r=arguments[1],s=arguments[2];this.addEdges(i,i),this.addEdges(r,r),this.computeIntersections(s)}else if("boolean"==typeof arguments[2]&&M(arguments[0],v)&&arguments[1]instanceof En){var o=arguments[0],a=arguments[1];arguments[2]?this.addEdges(o,null):this.addEdges(o),this.computeIntersections(a)}},addEdge:function(t,e){for(var n=t.getMonotoneChainEdge(),i=n.getStartIndexes(),r=0;r<i.length-1;r++){var s=new xn(n,r),o=new _n(e,n.getMinX(r),s);this.events.add(o),this.events.add(new _n(n.getMaxX(r),o))}},processOverlaps:function(t,e,n,i){for(var r=n.getObject(),s=t;e>s;s++){var o=this.events.get(s);if(o.isInsert()){var a=o.getObject();n.isSameLabel(o)||(r.computeIntersections(a,i),this.nOverlaps++)}}},addEdges:function(){if(1===arguments.length)for(var t=arguments[0].iterator();t.hasNext();){var e=t.next();this.addEdge(e,e)}else if(2===arguments.length){var n=arguments[1];for(t=arguments[0].iterator();t.hasNext();)e=t.next(),this.addEdge(e,n)}},interfaces_:function(){return[]},getClass:function(){return Sn}}),e(In.prototype,{getMin:function(){return this.min},intersects:function(t,e){return!(this.min>e||this.max<t)},getMax:function(){return this.max},toString:function(){return Ht.toLineString(new d(this.min,0),new d(this.max,0))},interfaces_:function(){return[]},getClass:function(){return In}}),e(Cn.prototype,{compare:function(t,e){var n=t,i=e,r=(n.min+n.max)/2,s=(i.min+i.max)/2;return s>r?-1:r>s?1:0},interfaces_:function(){return[a]},getClass:function(){return Cn}}),In.NodeComparator=Cn,u(Mn,In),e(Mn.prototype,{query:function(t,e,n){return this.intersects(t,e)?void n.visitItem(this.item):null},interfaces_:function(){return[]},getClass:function(){return Mn}}),u(Rn,In),e(Rn.prototype,{buildExtent:function(t,e){this.min=Math.min(t.min,e.min),this.max=Math.max(t.max,e.max)},query:function(t,e,n){return this.intersects(t,e)?(null!==this.node1&&this.node1.query(t,e,n),void(null!==this.node2&&this.node2.query(t,e,n))):null},interfaces_:function(){return[]},getClass:function(){return Rn}}),e(Pn.prototype,{buildTree:function(){Zs.sort(this.leaves,new IntervalRTreeNode.NodeComparator);for(var t=this.leaves,e=null,n=new _;;){if(this.buildLevel(t,n),1===n.size())return n.get(0);e=t,t=n,n=e}},insert:function(t,e,n){if(null!==this.root)throw new IllegalStateException("Index cannot be added to once it has been queried");this.leaves.add(new Mn(t,e,n))},query:function(t,e,n){this.init(),this.root.query(t,e,n)},buildRoot:function(){return null!==this.root?null:void(this.root=this.buildTree())},printNode:function(t){O.out.println(Ht.toLineString(new d(t.min,this.level),new d(t.max,this.level)))},init:function(){return null!==this.root?null:void this.buildRoot()},buildLevel:function(t,e){this.level++,e.clear();for(var n=0;n<t.size();n+=2){var i=t.get(n);if(null===(n+1<t.size()?t.get(n):null))e.add(i);else{var r=new Rn(t.get(n),t.get(n+1));e.add(r)}}},interfaces_:function(){return[]},getClass:function(){return Pn}}),e(Tn.prototype,{filter:function(t){if(this.isForcedToLineString&&t instanceof Pt){var e=t.getFactory().createLineString(t.getCoordinateSequence());return this.lines.add(e),null}t instanceof Et&&this.lines.add(t)},setForceToLineString:function(t){this.isForcedToLineString=t},interfaces_:function(){return[z]},getClass:function(){return Tn}}),Tn.getGeometry=function(){if(1===arguments.length){var t=arguments[0];return t.getFactory().buildGeometry(Tn.getLines(t))}if(2===arguments.length){var e=arguments[0],n=arguments[1];return e.getFactory().buildGeometry(Tn.getLines(e,n))}},Tn.getLines=function(){if(1===arguments.length){var t=arguments[0];return Tn.getLines(t,!1)}if(2===arguments.length){if(M(arguments[0],m)&&M(arguments[1],m)){for(var e=arguments[1],n=arguments[0].iterator();n.hasNext();){var i=n.next();Tn.getLines(i,e)}return e}if(arguments[0]instanceof G&&"boolean"==typeof arguments[1]){var r=arguments[0],s=arguments[1],o=new _;return r.apply(new Tn(o,s)),o}if(arguments[0]instanceof G&&M(arguments[1],m)){var a=arguments[0],l=arguments[1];return a instanceof Et?l.add(a):a.apply(new Tn(l)),l}}else if(3===arguments.length){if("boolean"==typeof arguments[2]&&M(arguments[0],m)&&M(arguments[1],m)){var h=arguments[1],u=arguments[2];for(n=arguments[0].iterator();n.hasNext();)i=n.next(),Tn.getLines(i,h,u);return h}if("boolean"==typeof arguments[2]&&arguments[0]instanceof G&&M(arguments[1],m)){var c=arguments[1],f=arguments[2];return arguments[0].apply(new Tn(c,f)),c}}},e(Nn.prototype,{visitItem:function(t){this.items.add(t)},getItems:function(){return this.items},interfaces_:function(){return[Se]},getClass:function(){return Nn}}),e(An.prototype,{locate:function(t){var e=new Jt(t),n=new kn(e);return this.index.query(t.y,t.y,n),e.getLocation()},interfaces_:function(){return[pn]},getClass:function(){return An}}),e(kn.prototype,{visitItem:function(t){var e=t;this.counter.countSegment(e.getCoordinate(0),e.getCoordinate(1))},interfaces_:function(){return[Se]},getClass:function(){return kn}}),e(Ln.prototype,{init:function(t){for(var e=Tn.getLines(t).iterator();e.hasNext();){var n=e.next().getCoordinates();this.addLine(n)}},addLine:function(t){for(var e=1;e<t.length;e++){var n=new te(t[e-1],t[e]),i=Math.min(n.p0.y,n.p1.y),r=Math.max(n.p0.y,n.p1.y);this.index.insert(i,r,n)}},query:function(){if(2===arguments.length){var t=arguments[0],e=arguments[1],n=new Nn;return this.index.query(t,e,n),n.getItems()}if(3===arguments.length){var i=arguments[0],r=arguments[1],s=arguments[2];this.index.query(i,r,s)}},interfaces_:function(){return[]},getClass:function(){return Ln}}),An.SegmentVisitor=kn,An.IntervalIndexedGeometry=Ln,e(On.prototype,{getSegmentIndex:function(){return this.segmentIndex},getCoordinate:function(){return this.coord},print:function(t){t.print(this.coord),t.print(" seg # = "+this.segmentIndex),t.println(" dist = "+this.dist)},compareTo:function(t){var e=t;return this.compare(e.segmentIndex,e.dist)},isEndPoint:function(t){return 0===this.segmentIndex&&0===this.dist||this.segmentIndex===t},toString:function(){return this.coord+" seg # = "+this.segmentIndex+" dist = "+this.dist},getDistance:function(){return this.dist},compare:function(t,e){return this.segmentIndex<t?-1:this.segmentIndex>t?1:this.dist<e?-1:this.dist>e?1:0},interfaces_:function(){return[s]},getClass:function(){return On}}),e(Dn.prototype,{print:function(t){t.println("Intersections:");for(var e=this.iterator();e.hasNext();)e.next().print(t)},iterator:function(){return this.nodeMap.values().iterator()},addSplitEdges:function(t){this.addEndpoints();for(var e=this.iterator(),n=e.next();e.hasNext();){var i=e.next(),r=this.createSplitEdge(n,i);t.add(r),n=i}},addEndpoints:function(){var t=this.edge.pts.length-1;this.add(this.edge.pts[0],0,0),this.add(this.edge.pts[t],t,0)},createSplitEdge:function(t,e){var n=e.segmentIndex-t.segmentIndex+2,i=this.edge.pts[e.segmentIndex],r=e.dist>0||!e.coord.equals2D(i);r||n--;var s=new Array(n).fill(null),o=0;s[o++]=new d(t.coord);for(var a=t.segmentIndex+1;a<=e.segmentIndex;a++)s[o++]=this.edge.pts[a];return r&&(s[o]=e.coord),new Bn(s,new tn(this.edge.label))},add:function(t,e,n){var i=new On(t,e,n),r=this.nodeMap.get(i);return null!==r?r:(this.nodeMap.put(i,i),i)},isIntersection:function(t){for(var e=this.iterator();e.hasNext();)if(e.next().coord.equals(t))return!0;return!1},interfaces_:function(){return[]},getClass:function(){return Dn}}),e(Fn.prototype,{getChainStartIndices:function(t){var e=0,n=new _;n.add(new T(e));do{var i=this.findChainEnd(t,e);n.add(new T(i)),e=i}while(e<t.length-1);return Fn.toIntArray(n)},findChainEnd:function(t,e){for(var n=Be.quadrant(t[e],t[e+1]),i=e+1;i<t.length&&Be.quadrant(t[i-1],t[i])===n;)i++;return i-1},interfaces_:function(){return[]},getClass:function(){return Fn}}),Fn.toIntArray=function(t){for(var e=new Array(t.size()).fill(null),n=0;n<e.length;n++)e[n]=t.get(n).intValue();return e},e(zn.prototype,{getCoordinates:function(){return this.pts},getMaxX:function(t){var e=this.pts[this.startIndex[t]].x,n=this.pts[this.startIndex[t+1]].x;return e>n?e:n},getMinX:function(t){var e=this.pts[this.startIndex[t]].x,n=this.pts[this.startIndex[t+1]].x;return n>e?e:n},computeIntersectsForChain:function(){if(4===arguments.length){var t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];this.computeIntersectsForChain(this.startIndex[t],this.startIndex[t+1],e,e.startIndex[n],e.startIndex[n+1],i)}else if(6===arguments.length){var r=arguments[0],s=arguments[1],o=arguments[2],a=arguments[3],l=arguments[4],h=arguments[5],u=this.pts[r],c=this.pts[s],f=o.pts[a],d=o.pts[l];if(s-r==1&&l-a==1)return h.addIntersections(this.e,r,o.e,a),null;if(this.env1.init(u,c),this.env2.init(f,d),!this.env1.intersects(this.env2))return null;var g=Math.trunc((r+s)/2),p=Math.trunc((a+l)/2);g>r&&(p>a&&this.computeIntersectsForChain(r,g,o,a,p,h),l>p&&this.computeIntersectsForChain(r,g,o,p,l,h)),s>g&&(p>a&&this.computeIntersectsForChain(g,s,o,a,p,h),l>p&&this.computeIntersectsForChain(g,s,o,p,l,h))}},getStartIndexes:function(){return this.startIndex},computeIntersects:function(t,e){for(var n=0;n<this.startIndex.length-1;n++)for(var i=0;i<t.startIndex.length-1;i++)this.computeIntersectsForChain(n,t,i,e)},interfaces_:function(){return[]},getClass:function(){return zn}}),e(Gn.prototype,{getDepth:function(t,e){return this.depth[t][e]},setDepth:function(t,e,n){this.depth[t][e]=n},isNull:function(){if(0===arguments.length){for(var t=0;2>t;t++)for(var e=0;3>e;e++)if(this.depth[t][e]!==Gn.NULL_VALUE)return!1;return!0}if(1===arguments.length){var n=arguments[0];return this.depth[n][1]===Gn.NULL_VALUE}if(2===arguments.length){var i=arguments[0],r=arguments[1];return this.depth[i][r]===Gn.NULL_VALUE}},normalize:function(){for(var t=0;2>t;t++)if(!this.isNull(t)){var e=this.depth[t][1];this.depth[t][2]<e&&(e=this.depth[t][2]),0>e&&(e=0);for(var n=1;3>n;n++){var i=0;this.depth[t][n]>e&&(i=1),this.depth[t][n]=i}}},getDelta:function(t){return this.depth[t][Je.RIGHT]-this.depth[t][Je.LEFT]},getLocation:function(t,e){return this.depth[t][e]<=0?C.EXTERIOR:C.INTERIOR},toString:function(){return"A: "+this.depth[0][1]+","+this.depth[0][2]+" B: "+this.depth[1][1]+","+this.depth[1][2]},add:function(){if(1===arguments.length)for(var t=arguments[0],e=0;2>e;e++)for(var n=1;3>n;n++){var i=t.getLocation(e,n);i!==C.EXTERIOR&&i!==C.INTERIOR||(this.isNull(e,n)?this.depth[e][n]=Gn.depthAtLocation(i):this.depth[e][n]+=Gn.depthAtLocation(i))}else if(3===arguments.length){var r=arguments[0],s=arguments[1];arguments[2]===C.INTERIOR&&this.depth[r][s]++}},interfaces_:function(){return[]},getClass:function(){return Gn}}),Gn.depthAtLocation=function(t){return t===C.EXTERIOR?0:t===C.INTERIOR?1:Gn.NULL_VALUE},Gn.NULL_VALUE=-1,u(Bn,sn),e(Bn.prototype,{getDepth:function(){return this.depth},getCollapsedEdge:function(){var t=new Array(2).fill(null);return t[0]=this.pts[0],t[1]=this.pts[1],new Bn(t,tn.toLineLabel(this.label))},isIsolated:function(){return this._isIsolated},getCoordinates:function(){return this.pts},setIsolated:function(t){this._isIsolated=t},setName:function(t){this.name=t},equals:function(t){if(!(t instanceof Bn))return!1;var e=t;if(this.pts.length!==e.pts.length)return!1;for(var n=!0,i=!0,r=this.pts.length,s=0;s<this.pts.length;s++)if(this.pts[s].equals2D(e.pts[s])||(n=!1),this.pts[s].equals2D(e.pts[--r])||(i=!1),!n&&!i)return!1;return!0},getCoordinate:function(){if(0===arguments.length)return this.pts.length>0?this.pts[0]:null;if(1===arguments.length){var t=arguments[0];return this.pts[t]}},print:function(t){t.print("edge "+this.name+": "),t.print("LINESTRING (");for(var e=0;e<this.pts.length;e++)e>0&&t.print(","),t.print(this.pts[e].x+" "+this.pts[e].y);t.print(")  "+this.label+" "+this.depthDelta)},computeIM:function(t){Bn.updateIM(this.label,t)},isCollapsed:function(){return!!this.label.isArea()&&3===this.pts.length&&!!this.pts[0].equals(this.pts[2])},isClosed:function(){return this.pts[0].equals(this.pts[this.pts.length-1])},getMaximumSegmentIndex:function(){return this.pts.length-1},getDepthDelta:function(){return this.depthDelta},getNumPoints:function(){return this.pts.length},printReverse:function(t){t.print("edge "+this.name+": ");for(var e=this.pts.length-1;e>=0;e--)t.print(this.pts[e]+" ");t.println("")},getMonotoneChainEdge:function(){return null===this.mce&&(this.mce=new zn(this)),this.mce},getEnvelope:function(){if(null===this.env){this.env=new E;for(var t=0;t<this.pts.length;t++)this.env.expandToInclude(this.pts[t])}return this.env},addIntersection:function(t,e,n,i){var r=new d(t.getIntersection(i)),s=e,o=t.getEdgeDistance(n,i),a=s+1;if(a<this.pts.length){var l=this.pts[a];r.equals2D(l)&&(s=a,o=0)}this.eiList.add(r,s,o)},toString:function(){var t=new P;t.append("edge "+this.name+": "),t.append("LINESTRING (");for(var e=0;e<this.pts.length;e++)e>0&&t.append(","),t.append(this.pts[e].x+" "+this.pts[e].y);return t.append(")  "+this.label+" "+this.depthDelta),t.toString()},isPointwiseEqual:function(t){if(this.pts.length!==t.pts.length)return!1;for(var e=0;e<this.pts.length;e++)if(!this.pts[e].equals2D(t.pts[e]))return!1;return!0},setDepthDelta:function(t){this.depthDelta=t},getEdgeIntersectionList:function(){return this.eiList},addIntersections:function(t,e,n){for(var i=0;i<t.getIntersectionNum();i++)this.addIntersection(t,e,n,i)},interfaces_:function(){return[]},getClass:function(){return Bn}}),Bn.updateIM=function(){if(2!==arguments.length)return sn.prototype.updateIM.apply(this,arguments);var t=arguments[0],e=arguments[1];e.setAtLeastIfValid(t.getLocation(0,Je.ON),t.getLocation(1,Je.ON),1),t.isArea()&&(e.setAtLeastIfValid(t.getLocation(0,Je.LEFT),t.getLocation(1,Je.LEFT),2),e.setAtLeastIfValid(t.getLocation(0,Je.RIGHT),t.getLocation(1,Je.RIGHT),2))},u(Un,cn),e(Un.prototype,{insertBoundaryPoint:function(t,e){var n=this.nodes.addNode(e).getLabel(),i=1;C.NONE,n.getLocation(t,Je.ON)===C.BOUNDARY&&i++;var r=Un.determineBoundary(this.boundaryNodeRule,i);n.setLocation(t,r)},computeSelfNodes:function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return this.computeSelfNodes(t,e,!1)}if(3===arguments.length){var n=arguments[1],i=arguments[2],r=new En(arguments[0],!0,!1);r.setIsDoneIfProperInt(i);var s=this.createEdgeSetIntersector(),o=this.parentGeom instanceof Pt||this.parentGeom instanceof Mt||this.parentGeom instanceof Tt,a=n||!o;return s.computeIntersections(this.edges,r,a),this.addSelfIntersectionNodes(this.argIndex),r}},computeSplitEdges:function(t){for(var e=this.edges.iterator();e.hasNext();)e.next().eiList.addSplitEdges(t)},computeEdgeIntersections:function(t,e,n){var i=new En(e,n,!0);return i.setBoundaryNodes(this.getBoundaryNodes(),t.getBoundaryNodes()),this.createEdgeSetIntersector().computeIntersections(this.edges,t.edges,i),i},getGeometry:function(){return this.parentGeom},getBoundaryNodeRule:function(){return this.boundaryNodeRule},hasTooFewPoints:function(){return this._hasTooFewPoints},addPoint:function(){if(arguments[0]instanceof It){var t=arguments[0].getCoordinate();this.insertPoint(this.argIndex,t,C.INTERIOR)}else if(arguments[0]instanceof d){var e=arguments[0];this.insertPoint(this.argIndex,e,C.INTERIOR)}},addPolygon:function(t){this.addPolygonRing(t.getExteriorRing(),C.EXTERIOR,C.INTERIOR);for(var e=0;e<t.getNumInteriorRing();e++){var n=t.getInteriorRingN(e);this.addPolygonRing(n,C.INTERIOR,C.EXTERIOR)}},addEdge:function(t){this.insertEdge(t);var e=t.getCoordinates();this.insertPoint(this.argIndex,e[0],C.BOUNDARY),this.insertPoint(this.argIndex,e[e.length-1],C.BOUNDARY)},addLineString:function(t){var e=j.removeRepeatedPoints(t.getCoordinates());if(e.length<2)return this._hasTooFewPoints=!0,this.invalidPoint=e[0],null;var n=new Bn(e,new tn(this.argIndex,C.INTERIOR));this.lineEdgeMap.put(t,n),this.insertEdge(n),f.isTrue(e.length>=2,"found LineString with single point"),this.insertBoundaryPoint(this.argIndex,e[0]),this.insertBoundaryPoint(this.argIndex,e[e.length-1])},getInvalidPoint:function(){return this.invalidPoint},getBoundaryPoints:function(){for(var t=this.getBoundaryNodes(),e=new Array(t.size()).fill(null),n=0,i=t.iterator();i.hasNext();){var r=i.next();e[n++]=r.getCoordinate().copy()}return e},getBoundaryNodes:function(){return null===this.boundaryNodes&&(this.boundaryNodes=this.nodes.getBoundaryNodes(this.argIndex)),this.boundaryNodes},addSelfIntersectionNode:function(t,e,n){return this.isBoundaryNode(t,e)?null:void(n===C.BOUNDARY&&this.useBoundaryDeterminationRule?this.insertBoundaryPoint(t,e):this.insertPoint(t,e,n))},addPolygonRing:function(t,e,n){if(t.isEmpty())return null;var i=j.removeRepeatedPoints(t.getCoordinates());if(i.length<4)return this._hasTooFewPoints=!0,this.invalidPoint=i[0],null;var r=e,s=n;Qt.isCCW(i)&&(r=n,s=e);var o=new Bn(i,new tn(this.argIndex,C.BOUNDARY,r,s));this.lineEdgeMap.put(t,o),this.insertEdge(o),this.insertPoint(this.argIndex,i[0],C.BOUNDARY)},insertPoint:function(t,e,n){var i=this.nodes.addNode(e),r=i.getLabel();null===r?i.label=new tn(t,n):r.setLocation(t,n)},createEdgeSetIntersector:function(){return new Sn},addSelfIntersectionNodes:function(t){for(var e=this.edges.iterator();e.hasNext();)for(var n=e.next(),i=n.getLabel().getLocation(t),r=n.eiList.iterator();r.hasNext();){var s=r.next();this.addSelfIntersectionNode(t,s.coord,i)}},add:function(){if(1!==arguments.length)return cn.prototype.add.apply(this,arguments);var t=arguments[0];if(t.isEmpty())return null;if(t instanceof Tt&&(this.useBoundaryDeterminationRule=!1),t instanceof Mt)this.addPolygon(t);else if(t instanceof Et)this.addLineString(t);else if(t instanceof It)this.addPoint(t);else if(t instanceof Rt)this.addCollection(t);else if(t instanceof dt)this.addCollection(t);else if(t instanceof Tt)this.addCollection(t);else{if(!(t instanceof ft))throw new UnsupportedOperationException(t.getClass().getName());this.addCollection(t)}},addCollection:function(t){for(var e=0;e<t.getNumGeometries();e++){var n=t.getGeometryN(e);this.add(n)}},locate:function(t){return M(this.parentGeom,Ct)&&this.parentGeom.getNumGeometries()>50?(null===this.areaPtLocator&&(this.areaPtLocator=new An(this.parentGeom)),this.areaPtLocator.locate(t)):this.ptLocator.locate(t,this.parentGeom)},findEdge:function(){if(1===arguments.length){var t=arguments[0];return this.lineEdgeMap.get(t)}return cn.prototype.findEdge.apply(this,arguments)},interfaces_:function(){return[]},getClass:function(){return Un}}),Un.determineBoundary=function(t,e){return t.isInBoundary(e)?C.BOUNDARY:C.INTERIOR},e(qn.prototype,{getArgGeometry:function(t){return this.arg[t].getGeometry()},setComputationPrecision:function(t){this.resultPrecisionModel=t,this.li.setPrecisionModel(this.resultPrecisionModel)},interfaces_:function(){return[]},getClass:function(){return qn}}),e(Vn.prototype,{compareTo:function(t){var e=t;return Vn.compareOriented(this.pts,this._orientation,e.pts,e._orientation)},interfaces_:function(){return[s]},getClass:function(){return Vn}}),Vn.orientation=function(t){return 1===j.increasingDirection(t)},Vn.compareOriented=function(t,e,n,i){for(var r=e?1:-1,s=i?1:-1,o=e?t.length:-1,a=i?n.length:-1,l=e?0:t.length-1,h=i?0:n.length-1;;){var u=t[l].compareTo(n[h]);if(0!==u)return u;var c=(l+=r)===o,f=(h+=s)===a;if(c&&!f)return-1;if(!c&&f)return 1;if(c&&f)return 0}},e(Yn.prototype,{print:function(t){t.print("MULTILINESTRING ( ");for(var e=0;e<this.edges.size();e++){var n=this.edges.get(e);e>0&&t.print(","),t.print("(");for(var i=n.getCoordinates(),r=0;r<i.length;r++)r>0&&t.print(","),t.print(i[r].x+" "+i[r].y);t.println(")")}t.print(")  ")},addAll:function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next())},findEdgeIndex:function(t){for(var e=0;e<this.edges.size();e++)if(this.edges.get(e).equals(t))return e;return-1},iterator:function(){return this.edges.iterator()},getEdges:function(){return this.edges},get:function(t){return this.edges.get(t)},findEqualEdge:function(t){var e=new Vn(t.getCoordinates());return this.ocaMap.get(e)},add:function(t){this.edges.add(t);var e=new Vn(t.getCoordinates());this.ocaMap.put(e,t)},interfaces_:function(){return[]},getClass:function(){return Yn}}),u(Xn,qn),e(Xn.prototype,{insertUniqueEdge:function(t){var e=this.edgeList.findEqualEdge(t);if(null!==e){var n=e.getLabel(),i=t.getLabel();e.isPointwiseEqual(t)||(i=new tn(t.getLabel())).flip();var r=e.getDepth();r.isNull()&&r.add(n),r.add(i),n.merge(i)}else this.edgeList.add(t)},getGraph:function(){return this.graph},cancelDuplicateResultEdges:function(){for(var t=this.graph.getEdgeEnds().iterator();t.hasNext();){var e=t.next(),n=e.getSym();e.isInResult()&&n.isInResult()&&(e.setInResult(!1),n.setInResult(!1))}},isCoveredByLA:function(t){return!!this.isCovered(t,this.resultLineList)||!!this.isCovered(t,this.resultPolyList)},computeGeometry:function(t,e,n,i){var r=new _;return r.addAll(t),r.addAll(e),r.addAll(n),r.isEmpty()?Xn.createEmptyResult(i,this.arg[0].getGeometry(),this.arg[1].getGeometry(),this.geomFact):this.geomFact.buildGeometry(r)},mergeSymLabels:function(){for(var t=this.graph.getNodes().iterator();t.hasNext();)t.next().getEdges().mergeSymLabels()},isCovered:function(t,e){for(var n=e.iterator();n.hasNext();){var i=n.next();if(this.ptLocator.locate(t,i)!==C.EXTERIOR)return!0}return!1},replaceCollapsedEdges:function(){for(var t=new _,e=this.edgeList.iterator();e.hasNext();){var n=e.next();n.isCollapsed()&&(e.remove(),t.add(n.getCollapsedEdge()))}this.edgeList.addAll(t)},updateNodeLabelling:function(){for(var t=this.graph.getNodes().iterator();t.hasNext();){var e=t.next(),n=e.getEdges().getLabel();e.getLabel().merge(n)}},getResultGeometry:function(t){return this.computeOverlay(t),this.resultGeom},insertUniqueEdges:function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();this.insertUniqueEdge(n)}},computeOverlay:function(t){this.copyPoints(0),this.copyPoints(1),this.arg[0].computeSelfNodes(this.li,!1),this.arg[1].computeSelfNodes(this.li,!1),this.arg[0].computeEdgeIntersections(this.arg[1],this.li,!0);var e=new _;this.arg[0].computeSplitEdges(e),this.arg[1].computeSplitEdges(e),this.insertUniqueEdges(e),this.computeLabelsFromDepths(),this.replaceCollapsedEdges(),Ze.checkValid(this.edgeList.getEdges()),this.graph.addEdges(this.edgeList.getEdges()),this.computeLabelling(),this.labelIncompleteNodes(),this.findResultAreaEdges(t),this.cancelDuplicateResultEdges();var n=new fn(this.geomFact);n.add(this.graph),this.resultPolyList=n.getPolygons();var i=new dn(this,this.geomFact,this.ptLocator);this.resultLineList=i.build(t);var r=new gn(this,this.geomFact,this.ptLocator);this.resultPointList=r.build(t),this.resultGeom=this.computeGeometry(this.resultPointList,this.resultLineList,this.resultPolyList,t)},labelIncompleteNode:function(t,e){var n=this.ptLocator.locate(t.getCoordinate(),this.arg[e].getGeometry());t.getLabel().setLocation(e,n)},copyPoints:function(t){for(var e=this.arg[t].getNodeIterator();e.hasNext();){var n=e.next();this.graph.addNode(n.getCoordinate()).setLabel(t,n.getLabel().getLocation(t))}},findResultAreaEdges:function(t){for(var e=this.graph.getEdgeEnds().iterator();e.hasNext();){var n=e.next(),i=n.getLabel();i.isArea()&&!n.isInteriorAreaEdge()&&Xn.isResultOfOp(i.getLocation(0,Je.RIGHT),i.getLocation(1,Je.RIGHT),t)&&n.setInResult(!0)}},computeLabelsFromDepths:function(){for(var t=this.edgeList.iterator();t.hasNext();){var e=t.next(),n=e.getLabel(),i=e.getDepth();if(!i.isNull()){i.normalize();for(var r=0;2>r;r++)n.isNull(r)||!n.isArea()||i.isNull(r)||(0===i.getDelta(r)?n.toLine(r):(f.isTrue(!i.isNull(r,Je.LEFT),"depth of LEFT side has not been initialized"),n.setLocation(r,Je.LEFT,i.getLocation(r,Je.LEFT)),f.isTrue(!i.isNull(r,Je.RIGHT),"depth of RIGHT side has not been initialized"),n.setLocation(r,Je.RIGHT,i.getLocation(r,Je.RIGHT))))}}},computeLabelling:function(){for(var t=this.graph.getNodes().iterator();t.hasNext();)t.next().getEdges().computeLabelling(this.arg);this.mergeSymLabels(),this.updateNodeLabelling()},labelIncompleteNodes:function(){for(var t=this.graph.getNodes().iterator();t.hasNext();){var e=t.next(),n=e.getLabel();e.isIsolated()&&(n.isNull(0)?this.labelIncompleteNode(e,0):this.labelIncompleteNode(e,1)),e.getEdges().updateLabelling(n)}},isCoveredByA:function(t){return!!this.isCovered(t,this.resultPolyList)},interfaces_:function(){return[]},getClass:function(){return Xn}}),Xn.overlayOp=function(t,e,n){return new Xn(t,e).getResultGeometry(n)},Xn.intersection=function(t,e){if(t.isEmpty()||e.isEmpty())return Xn.createEmptyResult(Xn.INTERSECTION,t,e,t.getFactory());if(t.isGeometryCollection()){var n=e;return Ke.map(t,{interfaces_:function(){return[MapOp]},map:function(t){return t.intersection(n)}})}return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),Wn.overlayOp(t,e,Xn.INTERSECTION)},Xn.symDifference=function(t,e){if(t.isEmpty()||e.isEmpty()){if(t.isEmpty()&&e.isEmpty())return Xn.createEmptyResult(Xn.SYMDIFFERENCE,t,e,t.getFactory());if(t.isEmpty())return e.copy();if(e.isEmpty())return t.copy()}return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),Wn.overlayOp(t,e,Xn.SYMDIFFERENCE)},Xn.resultDimension=function(t,e,n){var i=e.getDimension(),r=n.getDimension(),s=-1;switch(t){case Xn.INTERSECTION:s=Math.min(i,r);break;case Xn.UNION:s=Math.max(i,r);break;case Xn.DIFFERENCE:s=i;break;case Xn.SYMDIFFERENCE:s=Math.max(i,r)}return s},Xn.createEmptyResult=function(t,e,n,i){var r=null;switch(Xn.resultDimension(t,e,n)){case-1:r=i.createGeometryCollection(new Array(0).fill(null));break;case 0:r=i.createPoint();break;case 1:r=i.createLineString();break;case 2:r=i.createPolygon()}return r},Xn.difference=function(t,e){return t.isEmpty()?Xn.createEmptyResult(Xn.DIFFERENCE,t,e,t.getFactory()):e.isEmpty()?t.copy():(t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),Wn.overlayOp(t,e,Xn.DIFFERENCE))},Xn.isResultOfOp=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1],n=t.getLocation(0),i=t.getLocation(1);return Xn.isResultOfOp(n,i,e)}if(3===arguments.length){var r=arguments[0],s=arguments[1],o=arguments[2];switch(r===C.BOUNDARY&&(r=C.INTERIOR),s===C.BOUNDARY&&(s=C.INTERIOR),o){case Xn.INTERSECTION:return r===C.INTERIOR&&s===C.INTERIOR;case Xn.UNION:return r===C.INTERIOR||s===C.INTERIOR;case Xn.DIFFERENCE:return r===C.INTERIOR&&s!==C.INTERIOR;case Xn.SYMDIFFERENCE:return r===C.INTERIOR&&s!==C.INTERIOR||r!==C.INTERIOR&&s===C.INTERIOR}return!1}},Xn.INTERSECTION=1,Xn.UNION=2,Xn.DIFFERENCE=3,Xn.SYMDIFFERENCE=4,e(jn.prototype,{selfSnap:function(t){return new ue(t).snapTo(t,this.snapTolerance)},removeCommonBits:function(t){this.cbr=new de,this.cbr.add(t[0]),this.cbr.add(t[1]);var e=new Array(2).fill(null);return e[0]=this.cbr.removeCommonBits(t[0].copy()),e[1]=this.cbr.removeCommonBits(t[1].copy()),e},prepareResult:function(t){return this.cbr.addCommonBits(t),t},getResultGeometry:function(t){var e=this.snap(this.geom),n=Xn.overlayOp(e[0],e[1],t);return this.prepareResult(n)},checkValid:function(t){t.isValid()||O.out.println("Snapped geometry is invalid")},computeSnapTolerance:function(){this.snapTolerance=ue.computeOverlaySnapTolerance(this.geom[0],this.geom[1])},snap:function(t){var e=this.removeCommonBits(t);return ue.snap(e[0],e[1],this.snapTolerance)},interfaces_:function(){return[]},getClass:function(){return jn}}),jn.overlayOp=function(t,e,n){return new jn(t,e).getResultGeometry(n)},jn.union=function(t,e){return jn.overlayOp(t,e,Xn.UNION)},jn.intersection=function(t,e){return jn.overlayOp(t,e,Xn.INTERSECTION)},jn.symDifference=function(t,e){return jn.overlayOp(t,e,Xn.SYMDIFFERENCE)},jn.difference=function(t,e){return jn.overlayOp(t,e,Xn.DIFFERENCE)},e(Wn.prototype,{getResultGeometry:function(t){var e=null,n=!1,i=null;try{e=Xn.overlayOp(this.geom[0],this.geom[1],t),n=!0}catch(t){if(!(t instanceof h))throw t;i=t}if(!n)try{e=jn.overlayOp(this.geom[0],this.geom[1],t)}catch(t){throw t instanceof h?i:t}return e},interfaces_:function(){return[]},getClass:function(){return Wn}}),Wn.overlayOp=function(t,e,n){return new Wn(t,e).getResultGeometry(n)},Wn.union=function(t,e){return Wn.overlayOp(t,e,Xn.UNION)},Wn.intersection=function(t,e){return Wn.overlayOp(t,e,Xn.INTERSECTION)},Wn.symDifference=function(t,e){return Wn.overlayOp(t,e,Xn.SYMDIFFERENCE)},Wn.difference=function(t,e){return Wn.overlayOp(t,e,Xn.DIFFERENCE)},e(Hn.prototype,{addPolygon:function(t){if(t.isEmpty())return null;var e=null,n=0,i=this.horizontalBisector(t);if(0===i.getLength())n=0,e=i.getCoordinate();else{var r=Wn.overlayOp(i,t,Xn.INTERSECTION),s=this.widestGeometry(r);n=s.getEnvelopeInternal().getWidth(),e=Hn.centre(s.getEnvelopeInternal())}(null===this.interiorPoint||n>this.maxWidth)&&(this.interiorPoint=e,this.maxWidth=n)},getInteriorPoint:function(){return this.interiorPoint},widestGeometry:function(){if(arguments[0]instanceof ft){var t=arguments[0];if(t.isEmpty())return t;for(var e=t.getGeometryN(0),n=1;n<t.getNumGeometries();n++)t.getGeometryN(n).getEnvelopeInternal().getWidth()>e.getEnvelopeInternal().getWidth()&&(e=t.getGeometryN(n));return e}if(arguments[0]instanceof G){var i=arguments[0];return i instanceof ft?this.widestGeometry(i):i}},horizontalBisector:function(t){var e=t.getEnvelopeInternal(),n=$n.getBisectorY(t);return this.factory.createLineString([new d(e.getMinX(),n),new d(e.getMaxX(),n)])},add:function(t){if(t instanceof Mt)this.addPolygon(t);else if(t instanceof ft)for(var e=t,n=0;n<e.getNumGeometries();n++)this.add(e.getGeometryN(n))},interfaces_:function(){return[]},getClass:function(){return Hn}}),Hn.centre=function(t){return new d(Hn.avg(t.getMinX(),t.getMaxX()),Hn.avg(t.getMinY(),t.getMaxY()))},Hn.avg=function(t,e){return(t+e)/2},e($n.prototype,{updateInterval:function(t){t<=this.centreY?t>this.loY&&(this.loY=t):t>this.centreY&&t<this.hiY&&(this.hiY=t)},getBisectorY:function(){this.process(this.poly.getExteriorRing());for(var t=0;t<this.poly.getNumInteriorRing();t++)this.process(this.poly.getInteriorRingN(t));return Hn.avg(this.hiY,this.loY)},process:function(t){for(var e=t.getCoordinateSequence(),n=0;n<e.size();n++){var i=e.getY(n);this.updateInterval(i)}},interfaces_:function(){return[]},getClass:function(){return $n}}),$n.getBisectorY=function(t){return new $n(t).getBisectorY()},Hn.SafeBisectorFinder=$n,e(Zn.prototype,{addEndpoints:function(){if(arguments[0]instanceof G){var t=arguments[0];if(t instanceof Et)this.addEndpoints(t.getCoordinates());else if(t instanceof ft)for(var e=t,n=0;n<e.getNumGeometries();n++)this.addEndpoints(e.getGeometryN(n))}else if(arguments[0]instanceof Array){var i=arguments[0];this.add(i[0]),this.add(i[i.length-1])}},getInteriorPoint:function(){return this.interiorPoint},addInterior:function(){if(arguments[0]instanceof G){var t=arguments[0];if(t instanceof Et)this.addInterior(t.getCoordinates());else if(t instanceof ft)for(var e=t,n=0;n<e.getNumGeometries();n++)this.addInterior(e.getGeometryN(n))}else if(arguments[0]instanceof Array){var i=arguments[0];for(n=1;n<i.length-1;n++)this.add(i[n])}},add:function(t){var e=t.distance(this.centroid);e<this.minDistance&&(this.interiorPoint=new d(t),this.minDistance=e)},interfaces_:function(){return[]},getClass:function(){return Zn}}),e(Kn.prototype,{getInteriorPoint:function(){return this.interiorPoint},add:function(){if(arguments[0]instanceof G){var t=arguments[0];if(t instanceof It)this.add(t.getCoordinate());else if(t instanceof ft)for(var e=t,n=0;n<e.getNumGeometries();n++)this.add(e.getGeometryN(n))}else if(arguments[0]instanceof d){var i=arguments[0],r=i.distance(this.centroid);r<this.minDistance&&(this.interiorPoint=new d(i),this.minDistance=r)}},interfaces_:function(){return[]},getClass:function(){return Kn}}),e(Jn.prototype,{interfaces_:function(){return[]},getClass:function(){return Jn}}),Jn.toDegrees=function(t){return 180*t/Math.PI},Jn.normalize=function(t){for(;t>Math.PI;)t-=Jn.PI_TIMES_2;for(;t<=-Math.PI;)t+=Jn.PI_TIMES_2;return t},Jn.angle=function(){if(1===arguments.length){var t=arguments[0];return Math.atan2(t.y,t.x)}if(2===arguments.length){var e=arguments[0],n=arguments[1],i=n.x-e.x,r=n.y-e.y;return Math.atan2(r,i)}},Jn.isAcute=function(t,e,n){var i=t.x-e.x,r=t.y-e.y;return i*(n.x-e.x)+r*(n.y-e.y)>0},Jn.isObtuse=function(t,e,n){var i=t.x-e.x,r=t.y-e.y;return 0>i*(n.x-e.x)+r*(n.y-e.y)},Jn.interiorAngle=function(t,e,n){var i=Jn.angle(e,t),r=Jn.angle(e,n);return Math.abs(r-i)},Jn.normalizePositive=function(t){if(0>t){for(;0>t;)t+=Jn.PI_TIMES_2;t>=Jn.PI_TIMES_2&&(t=0)}else{for(;t>=Jn.PI_TIMES_2;)t-=Jn.PI_TIMES_2;0>t&&(t=0)}return t},Jn.angleBetween=function(t,e,n){var i=Jn.angle(e,t),r=Jn.angle(e,n);return Jn.diff(i,r)},Jn.diff=function(t,e){var n=null;return(n=e>t?e-t:t-e)>Math.PI&&(n=2*Math.PI-n),n},Jn.toRadians=function(t){return t*Math.PI/180},Jn.getTurn=function(t,e){var n=Math.sin(e-t);return n>0?Jn.COUNTERCLOCKWISE:0>n?Jn.CLOCKWISE:Jn.NONE},Jn.angleBetweenOriented=function(t,e,n){var i=Jn.angle(e,t),r=Jn.angle(e,n)-i;return r<=-Math.PI?r+Jn.PI_TIMES_2:r>Math.PI?r-Jn.PI_TIMES_2:r},Jn.PI_TIMES_2=2*Math.PI,Jn.PI_OVER_2=Math.PI/2,Jn.PI_OVER_4=Math.PI/4,Jn.COUNTERCLOCKWISE=Qt.COUNTERCLOCKWISE,Jn.CLOCKWISE=Qt.CLOCKWISE,Jn.NONE=Qt.COLLINEAR,e(Qn.prototype,{area:function(){return Qn.area(this.p0,this.p1,this.p2)},signedArea:function(){return Qn.signedArea(this.p0,this.p1,this.p2)},interpolateZ:function(t){if(null===t)throw new i("Supplied point is null.");return Qn.interpolateZ(t,this.p0,this.p1,this.p2)},longestSideLength:function(){return Qn.longestSideLength(this.p0,this.p1,this.p2)},isAcute:function(){return Qn.isAcute(this.p0,this.p1,this.p2)},circumcentre:function(){return Qn.circumcentre(this.p0,this.p1,this.p2)},area3D:function(){return Qn.area3D(this.p0,this.p1,this.p2)},centroid:function(){return Qn.centroid(this.p0,this.p1,this.p2)},inCentre:function(){return Qn.inCentre(this.p0,this.p1,this.p2)},interfaces_:function(){return[]},getClass:function(){return Qn}}),Qn.area=function(t,e,n){return Math.abs(((n.x-t.x)*(e.y-t.y)-(e.x-t.x)*(n.y-t.y))/2)},Qn.signedArea=function(t,e,n){return((n.x-t.x)*(e.y-t.y)-(e.x-t.x)*(n.y-t.y))/2},Qn.det=function(t,e,n,i){return t*i-e*n},Qn.interpolateZ=function(t,e,n,i){var r=e.x,s=e.y,o=n.x-r,a=i.x-r,l=n.y-s,h=i.y-s,u=o*h-a*l,c=t.x-r,f=t.y-s,d=(h*c-a*f)/u,g=(-l*c+o*f)/u;return e.z+d*(n.z-e.z)+g*(i.z-e.z)},Qn.longestSideLength=function(t,e,n){var i=t.distance(e),r=e.distance(n),s=n.distance(t),o=i;return r>o&&(o=r),s>o&&(o=s),o},Qn.isAcute=function(t,e,n){return!(!Jn.isAcute(t,e,n)||!Jn.isAcute(e,n,t)||!Jn.isAcute(n,t,e))},Qn.circumcentre=function(t,e,n){var i=n.x,r=n.y,s=t.x-i,o=t.y-r,a=e.x-i,l=e.y-r,h=2*Qn.det(s,o,a,l);return new d(i-Qn.det(o,s*s+o*o,l,a*a+l*l)/h,r+Qn.det(s,s*s+o*o,a,a*a+l*l)/h)},Qn.perpendicularBisector=function(t,e){var n=e.x-t.x,i=e.y-t.y,r=new D(t.x+n/2,t.y+i/2,1),s=new D(t.x-i+n/2,t.y+n+i/2,1);return new D(r,s)},Qn.angleBisector=function(t,e,n){var i=e.distance(t),r=i/(i+e.distance(n)),s=n.x-t.x,o=n.y-t.y;return new d(t.x+r*s,t.y+r*o)},Qn.area3D=function(t,e,n){var i=e.x-t.x,r=e.y-t.y,s=e.z-t.z,o=n.x-t.x,a=n.y-t.y,l=n.z-t.z,h=r*l-s*a,u=s*o-i*l,c=i*a-r*o,f=h*h+u*u+c*c;return Math.sqrt(f)/2},Qn.centroid=function(t,e,n){return new d((t.x+e.x+n.x)/3,(t.y+e.y+n.y)/3)},Qn.inCentre=function(t,e,n){var i=e.distance(n),r=t.distance(n),s=t.distance(e),o=i+r+s;return new d((i*t.x+r*e.x+s*n.x)/o,(i*t.y+r*e.y+s*n.y)/o)},e(ti.prototype,{getRadius:function(){return this.compute(),this.radius},getDiameter:function(){switch(this.compute(),this.extremalPts.length){case 0:return this.input.getFactory().createLineString();case 1:return this.input.getFactory().createPoint(this.centre)}var t=this.extremalPts[0],e=this.extremalPts[1];return this.input.getFactory().createLineString([t,e])},getExtremalPoints:function(){return this.compute(),this.extremalPts},computeCirclePoints:function(){if(this.input.isEmpty())return this.extremalPts=new Array(0).fill(null),null;if(1===this.input.getNumPoints()){var t=this.input.getCoordinates();return this.extremalPts=[new d(t[0])],null}var e=this.input.convexHull().getCoordinates();if(t=e,e[0].equals2D(e[e.length-1])&&(t=new Array(e.length-1).fill(null),j.copyDeep(e,0,t,0,e.length-1)),t.length<=2)return this.extremalPts=j.copyDeep(t),null;for(var n=ti.lowestPoint(t),i=ti.pointWitMinAngleWithX(t,n),r=0;r<t.length;r++){var s=ti.pointWithMinAngleWithSegment(t,n,i);if(Jn.isObtuse(n,s,i))return this.extremalPts=[new d(n),new d(i)],null;if(Jn.isObtuse(s,n,i))n=s;else{if(!Jn.isObtuse(s,i,n))return this.extremalPts=[new d(n),new d(i),new d(s)],null;i=s}}f.shouldNeverReachHere("Logic failure in Minimum Bounding Circle algorithm!")},compute:function(){return null!==this.extremalPts?null:(this.computeCirclePoints(),this.computeCentre(),void(null!==this.centre&&(this.radius=this.centre.distance(this.extremalPts[0]))))},getFarthestPoints:function(){switch(this.compute(),this.extremalPts.length){case 0:return this.input.getFactory().createLineString();case 1:return this.input.getFactory().createPoint(this.centre)}var t=this.extremalPts[0],e=this.extremalPts[this.extremalPts.length-1];return this.input.getFactory().createLineString([t,e])},getCircle:function(){if(this.compute(),null===this.centre)return this.input.getFactory().createPolygon();var t=this.input.getFactory().createPoint(this.centre);return 0===this.radius?t:t.buffer(this.radius)},getCentre:function(){return this.compute(),this.centre},computeCentre:function(){switch(this.extremalPts.length){case 0:this.centre=null;break;case 1:this.centre=this.extremalPts[0];break;case 2:this.centre=new d((this.extremalPts[0].x+this.extremalPts[1].x)/2,(this.extremalPts[0].y+this.extremalPts[1].y)/2);break;case 3:this.centre=Qn.circumcentre(this.extremalPts[0],this.extremalPts[1],this.extremalPts[2])}},interfaces_:function(){return[]},getClass:function(){return ti}}),ti.pointWitMinAngleWithX=function(t,e){for(var n=r.MAX_VALUE,i=null,s=0;s<t.length;s++){var o=t[s];if(o!==e){var a=o.x-e.x,l=o.y-e.y;0>l&&(l=-l);var h=l/Math.sqrt(a*a+l*l);n>h&&(n=h,i=o)}}return i},ti.lowestPoint=function(t){for(var e=t[0],n=1;n<t.length;n++)t[n].y<e.y&&(e=t[n]);return e},ti.pointWithMinAngleWithSegment=function(t,e,n){for(var i=r.MAX_VALUE,s=null,o=0;o<t.length;o++){var a=t[o];if(a!==e&&a!==n){var l=Jn.angleBetween(e,a,n);i>l&&(i=l,s=a)}}return s},e(ei.prototype,{getWidthCoordinate:function(){return this.computeMinimumDiameter(),this.minWidthPt},getSupportingSegment:function(){return this.computeMinimumDiameter(),this.inputGeom.getFactory().createLineString([this.minBaseSeg.p0,this.minBaseSeg.p1])},getDiameter:function(){if(this.computeMinimumDiameter(),null===this.minWidthPt)return this.inputGeom.getFactory().createLineString(null);var t=this.minBaseSeg.project(this.minWidthPt);return this.inputGeom.getFactory().createLineString([t,this.minWidthPt])},computeWidthConvex:function(t){this.convexHullPts=t instanceof Mt?t.getExteriorRing().getCoordinates():t.getCoordinates(),0===this.convexHullPts.length?(this.minWidth=0,this.minWidthPt=null,this.minBaseSeg=null):1===this.convexHullPts.length?(this.minWidth=0,this.minWidthPt=this.convexHullPts[0],this.minBaseSeg.p0=this.convexHullPts[0],this.minBaseSeg.p1=this.convexHullPts[0]):2===this.convexHullPts.length||3===this.convexHullPts.length?(this.minWidth=0,this.minWidthPt=this.convexHullPts[0],this.minBaseSeg.p0=this.convexHullPts[0],this.minBaseSeg.p1=this.convexHullPts[1]):this.computeConvexRingMinDiameter(this.convexHullPts)},computeConvexRingMinDiameter:function(t){this.minWidth=r.MAX_VALUE;for(var e=1,n=new te,i=0;i<t.length-1;i++)n.p0=t[i],n.p1=t[i+1],e=this.findMaxPerpDistance(t,n,e)},computeMinimumDiameter:function(){if(null!==this.minWidthPt)return null;if(this.isConvex)this.computeWidthConvex(this.inputGeom);else{var t=new oe(this.inputGeom).getConvexHull();this.computeWidthConvex(t)}},getLength:function(){return this.computeMinimumDiameter(),this.minWidth},findMaxPerpDistance:function(t,e,n){for(var i=e.distancePerpendicular(t[n]),r=i,s=n,o=s;r>=i;)i=r,s=o,o=ei.nextIndex(t,s),r=e.distancePerpendicular(t[o]);return i<this.minWidth&&(this.minPtIndex=s,this.minWidth=i,this.minWidthPt=t[this.minPtIndex],this.minBaseSeg=new te(e)),s},getMinimumRectangle:function(){if(this.computeMinimumDiameter(),0===this.minWidth)return this.minBaseSeg.p0.equals2D(this.minBaseSeg.p1)?this.inputGeom.getFactory().createPoint(this.minBaseSeg.p0):this.minBaseSeg.toGeometry(this.inputGeom.getFactory());for(var t=this.minBaseSeg.p1.x-this.minBaseSeg.p0.x,e=this.minBaseSeg.p1.y-this.minBaseSeg.p0.y,n=r.MAX_VALUE,i=-r.MAX_VALUE,s=r.MAX_VALUE,o=-r.MAX_VALUE,a=0;a<this.convexHullPts.length;a++){var l=ei.computeC(t,e,this.convexHullPts[a]);l>i&&(i=l),n>l&&(n=l);var h=ei.computeC(-e,t,this.convexHullPts[a]);h>o&&(o=h),s>h&&(s=h)}var u=ei.computeSegmentForLine(-t,-e,o),c=ei.computeSegmentForLine(-t,-e,s),f=ei.computeSegmentForLine(-e,t,i),d=ei.computeSegmentForLine(-e,t,n),g=f.lineIntersection(u),p=d.lineIntersection(u),m=d.lineIntersection(c),y=f.lineIntersection(c),v=this.inputGeom.getFactory().createLinearRing([g,p,m,y,g]);return this.inputGeom.getFactory().createPolygon(v,null)},interfaces_:function(){return[]},getClass:function(){return ei}}),ei.nextIndex=function(t,e){return++e>=t.length&&(e=0),e},ei.computeC=function(t,e,n){return t*n.y-e*n.x},ei.getMinimumDiameter=function(t){return new ei(t).getDiameter()},ei.getMinimumRectangle=function(t){return new ei(t).getMinimumRectangle()},ei.computeSegmentForLine=function(t,e,n){var i=null,r=null;return Math.abs(e)>Math.abs(t)?(i=new d(0,n/e),r=new d(1,n/e-t/e)):(i=new d(n/t,0),r=new d(n/t-e/t,1)),new te(i,r)};var Ks=Object.freeze({Centroid:ne,CGAlgorithms:Qt,ConvexHull:oe,InteriorPointArea:Hn,InteriorPointLine:Zn,InteriorPointPoint:Kn,RobustLineIntersector:Zt,MinimumBoundingCircle:ti,MinimumDiameter:ei});e(ni.prototype,{getResultGeometry:function(){return new ii(this.distanceTolerance).transform(this.inputGeom)},setDistanceTolerance:function(t){if(0>=t)throw new i("Tolerance must be positive");this.distanceTolerance=t},interfaces_:function(){return[]},getClass:function(){return ni}}),ni.densifyPoints=function(t,e,n){for(var i=new te,r=new b,s=0;s<t.length-1;s++){i.p0=t[s],i.p1=t[s+1],r.add(i.p0,!1);var o=i.getLength(),a=Math.trunc(o/e)+1;if(a>1)for(var l=o/a,h=1;a>h;h++){var u=h*l/o,c=i.pointAlong(u);n.makePrecise(c),r.add(c,!1)}}return r.add(t[t.length-1],!1),r.toCoordinateArray()},ni.densify=function(t,e){var n=new ni(t);return n.setDistanceTolerance(e),n.getResultGeometry()},u(ii,le),e(ii.prototype,{transformMultiPolygon:function(t,e){var n=le.prototype.transformMultiPolygon.call(this,t,e);return this.createValidArea(n)},transformPolygon:function(t,e){var n=le.prototype.transformPolygon.call(this,t,e);return e instanceof Tt?n:this.createValidArea(n)},transformCoordinates:function(t,e){var n=t.toCoordinateArray(),i=ni.densifyPoints(n,this.distanceTolerance,e.getPrecisionModel());return e instanceof Et&&1===i.length&&(i=new Array(0).fill(null)),this.factory.getCoordinateSequenceFactory().create(i)},createValidArea:function(t){return t.buffer(0)},interfaces_:function(){return[]},getClass:function(){return ii}}),ni.DensifyTransformer=ii;var Js=Object.freeze({Densifier:ni});e(ri.prototype,{find:function(t){var e=this;do{if(null===e)return null;if(e.dest().equals2D(t))return e;e=e.oNext()}while(e!==this);return null},dest:function(){return this._sym._orig},oNext:function(){return this._sym._next},insert:function(t){if(this.oNext()===this)return this.insertAfter(t),null;var e=this.compareTo(t),n=this;do{var i=n.oNext();if(i.compareTo(t)!==e||i===this)return n.insertAfter(t),null;n=i}while(n!==this);f.shouldNeverReachHere()},insertAfter:function(t){f.equals(this._orig,t.orig());var e=this.oNext();this._sym.setNext(t),t.sym().setNext(e)},degree:function(){var t=0,e=this;do{t++,e=e.oNext()}while(e!==this);return t},equals:function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return this._orig.equals2D(t)&&this._sym._orig.equals(e)}},deltaY:function(){return this._sym._orig.y-this._orig.y},sym:function(){return this._sym},prev:function(){return this._sym.next()._sym},compareAngularDirection:function(t){var e=this.deltaX(),n=this.deltaY(),i=t.deltaX(),r=t.deltaY();if(e===i&&n===r)return 0;var s=Be.quadrant(e,n),o=Be.quadrant(i,r);return s>o?1:o>s?-1:Qt.computeOrientation(t._orig,t.dest(),this.dest())},prevNode:function(){for(var t=this;2===t.degree();)if((t=t.prev())===this)return null;return t},compareTo:function(t){var e=t;return this.compareAngularDirection(e)},next:function(){return this._next},setSym:function(t){this._sym=t},orig:function(){return this._orig},toString:function(){return"HE("+this._orig.x+" "+this._orig.y+", "+this._sym._orig.x+" "+this._sym._orig.y+")"},setNext:function(t){this._next=t},init:function(t){this.setSym(t),t.setSym(this),this.setNext(t),t.setNext(this)},deltaX:function(){return this._sym._orig.x-this._orig.x},interfaces_:function(){return[]},getClass:function(){return ri}}),ri.init=function(t,e){if(null!==t._sym||null!==e._sym||null!==t._next||null!==e._next)throw new IllegalStateException("Edges are already initialized");return t.init(e),t},ri.create=function(t,e){var n=new ri(t),i=new ri(e);return n.init(i),n},u(si,ri),e(si.prototype,{mark:function(){this._isMarked=!0},setMark:function(t){this._isMarked=t},isMarked:function(){return this._isMarked},interfaces_:function(){return[]},getClass:function(){return si}}),si.setMarkBoth=function(t,e){t.setMark(e),t.sym().setMark(e)},si.isMarked=function(t){return t.isMarked()},si.setMark=function(t,e){t.setMark(e)},si.markBoth=function(t){t.mark(),t.sym().mark()},si.mark=function(t){t.mark()},e(oi.prototype,{insert:function(t,e,n){var i=this.create(t,e);null!==n?n.insert(i):this.vertexMap.put(t,i);var r=this.vertexMap.get(e);return null!==r?r.insert(i.sym()):this.vertexMap.put(e,i.sym()),i},create:function(t,e){var n=this.createEdge(t),i=this.createEdge(e);return ri.init(n,i),n},createEdge:function(t){return new ri(t)},addEdge:function(t,e){if(!oi.isValidEdge(t,e))return null;var n=this.vertexMap.get(t),i=null;return null!==n&&(i=n.find(e)),null!==i?i:this.insert(t,e,n)},getVertexEdges:function(){return this.vertexMap.values()},findEdge:function(t,e){var n=this.vertexMap.get(t);return null===n?null:n.find(e)},interfaces_:function(){return[]},getClass:function(){return oi}}),oi.isValidEdge=function(t,e){return 0!==e.compareTo(t)},u(ai,si),e(ai.prototype,{setStart:function(){this._isStart=!0},isStart:function(){return this._isStart},interfaces_:function(){return[]},getClass:function(){return ai}}),u(li,oi),e(li.prototype,{createEdge:function(t){return new ai(t)},interfaces_:function(){return[]},getClass:function(){return li}}),e(hi.prototype,{addLine:function(t){this.lines.add(this.factory.createLineString(t.toCoordinateArray()))},updateRingStartEdge:function(t){return t.isStart()||(t=t.sym()).isStart()?null===this.ringStartEdge?(this.ringStartEdge=t,null):void(t.orig().compareTo(this.ringStartEdge.orig())<0&&(this.ringStartEdge=t)):null},getResult:function(){return null===this.result&&this.computeResult(),this.result},process:function(t){var e=t.prevNode();null===e&&(e=t),this.stackEdges(e),this.buildLines()},buildRing:function(t){var e=new b,n=t;for(e.add(n.orig().copy(),!1);2===n.sym().degree();){var i=n.next();if(i===t)break;e.add(i.orig().copy(),!1),n=i}e.add(n.dest().copy(),!1),this.addLine(e)},buildLine:function(t){var e=new b,n=t;for(this.ringStartEdge=null,si.markBoth(n),e.add(n.orig().copy(),!1);2===n.sym().degree();){this.updateRingStartEdge(n);var i=n.next();if(i===t)return this.buildRing(this.ringStartEdge),null;e.add(i.orig().copy(),!1),n=i,si.markBoth(n)}e.add(n.dest().copy(),!1),this.stackEdges(n.sym()),this.addLine(e)},stackEdges:function(t){var e=t;do{si.isMarked(e)||this.nodeEdgeStack.add(e),e=e.oNext()}while(e!==t)},computeResult:function(){for(var t=this.graph.getVertexEdges().iterator();t.hasNext();){var e=t.next();si.isMarked(e)||this.process(e)}this.result=this.factory.buildGeometry(this.lines)},buildLines:function(){for(;!this.nodeEdgeStack.empty();){var t=this.nodeEdgeStack.pop();si.isMarked(t)||this.buildLine(t)}},add:function(){if(arguments[0]instanceof G)arguments[0].apply({interfaces_:function(){return[z]},filter:function(t){t instanceof Et&&this.add(t)}});else if(M(arguments[0],m))for(var t=arguments[0].iterator();t.hasNext();){var e=t.next();this.add(e)}else if(arguments[0]instanceof Et){var n=arguments[0];null===this.factory&&(this.factory=n.getFactory());var i=n.getCoordinateSequence(),r=!1;for(t=1;t<i.size();t++){var s=this.graph.addEdge(i.getCoordinate(t-1),i.getCoordinate(t));null!==s&&(r||(s.setStart(),r=!0))}}},interfaces_:function(){return[]},getClass:function(){return hi}}),hi.dissolve=function(t){var e=new hi;return e.add(t),e.getResult()};var Qs=Object.freeze({LineDissolver:hi});e(ui.prototype,{hasChildren:function(){for(var t=0;4>t;t++)if(null!==this.subnode[t])return!0;return!1},isPrunable:function(){return!(this.hasChildren()||this.hasItems())},addAllItems:function(t){t.addAll(this.items);for(var e=0;4>e;e++)null!==this.subnode[e]&&this.subnode[e].addAllItems(t);return t},getNodeCount:function(){for(var t=0,e=0;4>e;e++)null!==this.subnode[e]&&(t+=this.subnode[e].size());return t+1},size:function(){for(var t=0,e=0;4>e;e++)null!==this.subnode[e]&&(t+=this.subnode[e].size());return t+this.items.size()},addAllItemsFromOverlapping:function(t,e){if(!this.isSearchMatch(t))return null;e.addAll(this.items);for(var n=0;4>n;n++)null!==this.subnode[n]&&this.subnode[n].addAllItemsFromOverlapping(t,e)},visitItems:function(t,e){for(var n=this.items.iterator();n.hasNext();)e.visitItem(n.next())},hasItems:function(){return!this.items.isEmpty()},remove:function(t,e){if(!this.isSearchMatch(t))return!1;for(var n=!1,i=0;4>i;i++)if(null!==this.subnode[i]&&(n=this.subnode[i].remove(t,e))){this.subnode[i].isPrunable()&&(this.subnode[i]=null);break}return n||this.items.remove(e)},visit:function(t,e){if(!this.isSearchMatch(t))return null;this.visitItems(t,e);for(var n=0;4>n;n++)null!==this.subnode[n]&&this.subnode[n].visit(t,e)},getItems:function(){return this.items},depth:function(){for(var t=0,e=0;4>e;e++)if(null!==this.subnode[e]){var n=this.subnode[e].depth();n>t&&(t=n)}return t+1},isEmpty:function(){var t=!0;this.items.isEmpty()||(t=!1);for(var e=0;4>e;e++)null!==this.subnode[e]&&(this.subnode[e].isEmpty()||(t=!1));return t},add:function(t){this.items.add(t)},interfaces_:function(){return[l]},getClass:function(){return ui}}),ui.getSubnodeIndex=function(t,e,n){var i=-1;return t.getMinX()>=e&&(t.getMinY()>=n&&(i=3),t.getMaxY()<=n&&(i=1)),t.getMaxX()<=e&&(t.getMinY()>=n&&(i=2),t.getMaxY()<=n&&(i=0)),i},ci.exponent=function(t){return function(t,e){var n,i,r,s,o={32:8,64:11}[t];if(s||(n=0>e||0>1/e,isFinite(e)||(s={32:{d:127,c:128,b:0,a:0},64:{d:32752,c:0,b:0,a:0}}[t],n&&(s.d+=1<<t/4-1),i=Math.pow(2,o)-1,r=0)),!s){for(i={32:127,64:1023}[t],r=Math.abs(e);r>=2;)i++,r/=2;for(;1>r&&i>0;)i--,r*=2;0>=i&&(r/=2),32===t&&i>254&&(s={d:n?255:127,c:128,b:0,a:0},i=Math.pow(2,o)-1,r=0)}return i}(64,t)-1023},ci.powerOf2=function(t){return Math.pow(2,t)},e(fi.prototype,{getLevel:function(){return this.level},computeKey:function(){if(1===arguments.length){var t=arguments[0];for(this.level=fi.computeQuadLevel(t),this.env=new E,this.computeKey(this.level,t);!this.env.contains(t);)this.level+=1,this.computeKey(this.level,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1],i=ci.powerOf2(e);this.pt.x=Math.floor(n.getMinX()/i)*i,this.pt.y=Math.floor(n.getMinY()/i)*i,this.env.init(this.pt.x,this.pt.x+i,this.pt.y,this.pt.y+i)}},getEnvelope:function(){return this.env},getCentre:function(){return new d((this.env.getMinX()+this.env.getMaxX())/2,(this.env.getMinY()+this.env.getMaxY())/2)},getPoint:function(){return this.pt},interfaces_:function(){return[]},getClass:function(){return fi}}),fi.computeQuadLevel=function(t){var e=t.getWidth(),n=t.getHeight(),i=e>n?e:n;return ci.exponent(i)+1},u(di,ui),e(di.prototype,{find:function(t){var e=ui.getSubnodeIndex(t,this.centrex,this.centrey);return-1===e?this:null!==this.subnode[e]?this.subnode[e].find(t):this},isSearchMatch:function(t){return this.env.intersects(t)},getSubnode:function(t){return null===this.subnode[t]&&(this.subnode[t]=this.createSubnode(t)),this.subnode[t]},getEnvelope:function(){return this.env},getNode:function(t){var e=ui.getSubnodeIndex(t,this.centrex,this.centrey);return-1!==e?this.getSubnode(e).getNode(t):this},createSubnode:function(t){var e=0,n=0,i=0,r=0;switch(t){case 0:e=this.env.getMinX(),n=this.centrex,i=this.env.getMinY(),r=this.centrey;break;case 1:e=this.centrex,n=this.env.getMaxX(),i=this.env.getMinY(),r=this.centrey;break;case 2:e=this.env.getMinX(),n=this.centrex,i=this.centrey,r=this.env.getMaxY();break;case 3:e=this.centrex,n=this.env.getMaxX(),i=this.centrey,r=this.env.getMaxY()}return new di(new E(e,n,i,r),this.level-1)},insertNode:function(t){f.isTrue(null===this.env||this.env.contains(t.env));var e=ui.getSubnodeIndex(t.env,this.centrex,this.centrey);if(t.level===this.level-1)this.subnode[e]=t;else{var n=this.createSubnode(e);n.insertNode(t),this.subnode[e]=n}},interfaces_:function(){return[]},getClass:function(){return di}}),di.createNode=function(t){var e=new fi(t);return new di(e.getEnvelope(),e.getLevel())},di.createExpanded=function(t,e){var n=new E(e);null!==t&&n.expandToInclude(t.env);var i=di.createNode(n);return null!==t&&i.insertNode(t),i},e(gi.prototype,{interfaces_:function(){return[]},getClass:function(){return gi}}),gi.isZeroWidth=function(t,e){var n=e-t;if(0===n)return!0;var i=n/Math.max(Math.abs(t),Math.abs(e));return ci.exponent(i)<=gi.MIN_BINARY_EXPONENT},gi.MIN_BINARY_EXPONENT=-50,u(pi,ui),e(pi.prototype,{insert:function(t,e){var n=ui.getSubnodeIndex(t,pi.origin.x,pi.origin.y);if(-1===n)return this.add(e),null;var i=this.subnode[n];if(null===i||!i.getEnvelope().contains(t)){var r=di.createExpanded(i,t);this.subnode[n]=r}this.insertContained(this.subnode[n],t,e)},isSearchMatch:function(t){return!0},insertContained:function(t,e,n){f.isTrue(t.getEnvelope().contains(e));var i=gi.isZeroWidth(e.getMinX(),e.getMaxX()),r=gi.isZeroWidth(e.getMinY(),e.getMaxY());(i||r?t.find(e):t.getNode(e)).add(n)},interfaces_:function(){return[]},getClass:function(){return pi}}),pi.origin=new d(0,0),e(mi.prototype,{size:function(){return null!==this.root?this.root.size():0},insert:function(t,e){this.collectStats(t);var n=mi.ensureExtent(t,this.minExtent);this.root.insert(n,e)},query:function(){if(1===arguments.length){var t=arguments[0],e=new Nn;return this.query(t,e),e.getItems()}if(2===arguments.length){var n=arguments[0],i=arguments[1];this.root.visit(n,i)}},queryAll:function(){var t=new _;return this.root.addAllItems(t),t},remove:function(t,e){var n=mi.ensureExtent(t,this.minExtent);return this.root.remove(n,e)},collectStats:function(t){var e=t.getWidth();e<this.minExtent&&e>0&&(this.minExtent=e);var n=t.getHeight();n<this.minExtent&&n>0&&(this.minExtent=n)},depth:function(){return null!==this.root?this.root.depth():0},isEmpty:function(){return null===this.root},interfaces_:function(){return[Ie,l]},getClass:function(){return mi}}),mi.ensureExtent=function(t,e){var n=t.getMinX(),i=t.getMaxX(),r=t.getMinY(),s=t.getMaxY();return n!==i&&r!==s?t:(n===i&&(i=(n-=e/2)+e/2),r===s&&(s=(r-=e/2)+e/2),new E(n,i,r,s))},mi.serialVersionUID=-0x678b60c967a25400;var to=Object.freeze({Quadtree:mi}),eo=Object.freeze({STRtree:Te}),no=Object.freeze({quadtree:to,strtree:eo}),io=["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"];e(yi.prototype,{read:function(t){var e,n=(e="string"==typeof t?JSON.parse(t):t).type;if(!ro[n])throw new Error("Unknown GeoJSON type: "+e.type);return-1!==io.indexOf(n)?ro[n].apply(this,[e.coordinates]):"GeometryCollection"===n?ro[n].apply(this,[e.geometries]):ro[n].apply(this,[e])},write:function(t){var e=t.getGeometryType();if(!so[e])throw new Error("Geometry is not supported");return so[e].apply(this,[t])}});var ro={Feature:function(t){var e={};for(var n in t)e[n]=t[n];if(t.geometry){var i=t.geometry.type;if(!ro[i])throw new Error("Unknown GeoJSON type: "+t.type);e.geometry=this.read(t.geometry)}return t.bbox&&(e.bbox=ro.bbox.apply(this,[t.bbox])),e},FeatureCollection:function(t){var e={};if(t.features){e.features=[];for(var n=0;n<t.features.length;++n)e.features.push(this.read(t.features[n]))}return t.bbox&&(e.bbox=this.parse.bbox.apply(this,[t.bbox])),e},coordinates:function(t){for(var e=[],n=0;n<t.length;++n){var i=t[n];e.push(new d(i[0],i[1]))}return e},bbox:function(t){return this.geometryFactory.createLinearRing([new d(t[0],t[1]),new d(t[2],t[1]),new d(t[2],t[3]),new d(t[0],t[3]),new d(t[0],t[1])])},Point:function(t){var e=new d(t[0],t[1]);return this.geometryFactory.createPoint(e)},MultiPoint:function(t){for(var e=[],n=0;n<t.length;++n)e.push(ro.Point.apply(this,[t[n]]));return this.geometryFactory.createMultiPoint(e)},LineString:function(t){var e=ro.coordinates.apply(this,[t]);return this.geometryFactory.createLineString(e)},MultiLineString:function(t){for(var e=[],n=0;n<t.length;++n)e.push(ro.LineString.apply(this,[t[n]]));return this.geometryFactory.createMultiLineString(e)},Polygon:function(t){for(var e=ro.coordinates.apply(this,[t[0]]),n=this.geometryFactory.createLinearRing(e),i=[],r=1;r<t.length;++r){var s=t[r],o=ro.coordinates.apply(this,[s]),a=this.geometryFactory.createLinearRing(o);i.push(a)}return this.geometryFactory.createPolygon(n,i)},MultiPolygon:function(t){for(var e=[],n=0;n<t.length;++n){var i=t[n];e.push(ro.Polygon.apply(this,[i]))}return this.geometryFactory.createMultiPolygon(e)},GeometryCollection:function(t){for(var e=[],n=0;n<t.length;++n){var i=t[n];e.push(this.read(i))}return this.geometryFactory.createGeometryCollection(e)}},so={coordinate:function(t){return[t.x,t.y]},Point:function(t){return{type:"Point",coordinates:so.coordinate.apply(this,[t.getCoordinate()])}},MultiPoint:function(t){for(var e=[],n=0;n<t.geometries.length;++n){var i=t.geometries[n],r=so.Point.apply(this,[i]);e.push(r.coordinates)}return{type:"MultiPoint",coordinates:e}},LineString:function(t){for(var e=[],n=t.getCoordinates(),i=0;i<n.length;++i){var r=n[i];e.push(so.coordinate.apply(this,[r]))}return{type:"LineString",coordinates:e}},MultiLineString:function(t){for(var e=[],n=0;n<t.geometries.length;++n){var i=t.geometries[n],r=so.LineString.apply(this,[i]);e.push(r.coordinates)}return{type:"MultiLineString",coordinates:e}},Polygon:function(t){var e=[],n=so.LineString.apply(this,[t.shell]);e.push(n.coordinates);for(var i=0;i<t.holes.length;++i){var r=t.holes[i],s=so.LineString.apply(this,[r]);e.push(s.coordinates)}return{type:"Polygon",coordinates:e}},MultiPolygon:function(t){for(var e=[],n=0;n<t.geometries.length;++n){var i=t.geometries[n],r=so.Polygon.apply(this,[i]);e.push(r.coordinates)}return{type:"MultiPolygon",coordinates:e}},GeometryCollection:function(t){for(var e=[],n=0;n<t.geometries.length;++n){var i=t.geometries[n],r=i.getGeometryType();e.push(so[r].apply(this,[i]))}return{type:"GeometryCollection",geometries:e}}};e(vi.prototype,{read:function(t){var e=this.parser.read(t);return this.precisionModel.getType()===Yt.FIXED&&this.reducePrecision(e),e},reducePrecision:function(t){var e,n;if(t.coordinate)this.precisionModel.makePrecise(t.coordinate);else if(t.points)for(e=0,n=t.points.length;n>e;e++)this.precisionModel.makePrecise(t.points[e]);else if(t.geometries)for(e=0,n=t.geometries.length;n>e;e++)this.reducePrecision(t.geometries[e])}}),e(wi.prototype,{write:function(t){return this.parser.write(t)}}),e(xi.prototype,{read:function(t){var e=this.parser.read(t);return this.precisionModel.getType()===Yt.FIXED&&this.reducePrecision(e),e},reducePrecision:function(t){if(t.coordinate)this.precisionModel.makePrecise(t.coordinate);else if(t.points)for(var e=0,n=t.points.coordinates.length;n>e;e++)this.precisionModel.makePrecise(t.points.coordinates[e]);else if(t.geometries)for(var i=0,r=t.geometries.length;r>i;i++)this.reducePrecision(t.geometries[i])}}),e(bi.prototype,{read:function(t){return t instanceof ol.geom.Point?this.convertFromPoint(t):t instanceof ol.geom.LineString?this.convertFromLineString(t):t instanceof ol.geom.LinearRing?this.convertFromLinearRing(t):t instanceof ol.geom.Polygon?this.convertFromPolygon(t):t instanceof ol.geom.MultiPoint?this.convertFromMultiPoint(t):t instanceof ol.geom.MultiLineString?this.convertFromMultiLineString(t):t instanceof ol.geom.MultiPolygon?this.convertFromMultiPolygon(t):t instanceof ol.geom.GeometryCollection?this.convertFromCollection(t):void 0},convertFromPoint:function(t){var e=t.getCoordinates();return this.geometryFactory.createPoint(new d(e[0],e[1]))},convertFromLineString:function(t){return this.geometryFactory.createLineString(t.getCoordinates().map((function(t){return new d(t[0],t[1])})))},convertFromLinearRing:function(t){return this.geometryFactory.createLinearRing(t.getCoordinates().map((function(t){return new d(t[0],t[1])})))},convertFromPolygon:function(t){for(var e=t.getLinearRings(),n=null,i=[],r=0;r<e.length;r++){var s=this.convertFromLinearRing(e[r]);0===r?n=s:i.push(s)}return this.geometryFactory.createPolygon(n,i)},convertFromMultiPoint:function(t){var e=t.getPoints().map((function(t){return this.convertFromPoint(t)}),this);return this.geometryFactory.createMultiPoint(e)},convertFromMultiLineString:function(t){var e=t.getLineStrings().map((function(t){return this.convertFromLineString(t)}),this);return this.geometryFactory.createMultiLineString(e)},convertFromMultiPolygon:function(t){var e=t.getPolygons().map((function(t){return this.convertFromPolygon(t)}),this);return this.geometryFactory.createMultiPolygon(e)},convertFromCollection:function(t){var e=t.getGeometries().map((function(t){return this.read(t)}),this);return this.geometryFactory.createGeometryCollection(e)},write:function(t){return"Point"===t.getGeometryType()?this.convertToPoint(t.getCoordinate()):"LineString"===t.getGeometryType()?this.convertToLineString(t):"LinearRing"===t.getGeometryType()?this.convertToLinearRing(t):"Polygon"===t.getGeometryType()?this.convertToPolygon(t):"MultiPoint"===t.getGeometryType()?this.convertToMultiPoint(t):"MultiLineString"===t.getGeometryType()?this.convertToMultiLineString(t):"MultiPolygon"===t.getGeometryType()?this.convertToMultiPolygon(t):"GeometryCollection"===t.getGeometryType()?this.convertToCollection(t):void 0},convertToPoint:function(t){return new ol.geom.Point([t.x,t.y])},convertToLineString:function(t){var e=t.points.coordinates.map(_i);return new ol.geom.LineString(e)},convertToLinearRing:function(t){var e=t.points.coordinates.map(_i);return new ol.geom.LinearRing(e)},convertToPolygon:function(t){for(var e=[t.shell.points.coordinates.map(_i)],n=0;n<t.holes.length;n++)e.push(t.holes[n].points.coordinates.map(_i));return new ol.geom.Polygon(e)},convertToMultiPoint:function(t){return new ol.geom.MultiPoint(t.getCoordinates().map(_i))},convertToMultiLineString:function(t){for(var e=[],n=0;n<t.geometries.length;n++)e.push(this.convertToLineString(t.geometries[n]).getCoordinates());return new ol.geom.MultiLineString(e)},convertToMultiPolygon:function(t){for(var e=[],n=0;n<t.geometries.length;n++)e.push(this.convertToPolygon(t.geometries[n]).getCoordinates());return new ol.geom.MultiPolygon(e)},convertToCollection:function(t){for(var e=[],n=0;n<t.geometries.length;n++){var i=t.geometries[n];e.push(this.write(i))}return new ol.geom.GeometryCollection(e)}});var oo=Object.freeze({GeoJSONReader:vi,GeoJSONWriter:wi,OL3Parser:bi,WKTReader:xi,WKTWriter:Ht});e(Ei.prototype,{rescale:function(){if(M(arguments[0],m))for(var t=arguments[0].iterator();t.hasNext();){var e=t.next();this.rescale(e.getCoordinates())}else if(arguments[0]instanceof Array){var n=arguments[0];for(2===n.length&&(new d(n[0]),new d(n[1])),t=0;t<n.length;t++)n[t].x=n[t].x/this.scaleFactor+this.offsetX,n[t].y=n[t].y/this.scaleFactor+this.offsetY;2===n.length&&n[0].equals2D(n[1])&&O.out.println(n)}},scale:function(){if(M(arguments[0],m)){for(var t=arguments[0],e=new _,n=t.iterator();n.hasNext();){var i=n.next();e.add(new Fe(this.scale(i.getCoordinates()),i.getData()))}return e}if(arguments[0]instanceof Array){var r=arguments[0],s=new Array(r.length).fill(null);for(n=0;n<r.length;n++)s[n]=new d(Math.round((r[n].x-this.offsetX)*this.scaleFactor),Math.round((r[n].y-this.offsetY)*this.scaleFactor),r[n].z);return j.removeRepeatedPoints(s)}},isIntegerPrecision:function(){return 1===this.scaleFactor},getNodedSubstrings:function(){var t=this.noder.getNodedSubstrings();return this.isScaled&&this.rescale(t),t},computeNodes:function(t){var e=t;this.isScaled&&(e=this.scale(t)),this.noder.computeNodes(e)},interfaces_:function(){return[qe]},getClass:function(){return Ei}});var ao=Object.freeze({MCIndexNoder:Ye,ScaledNoder:Ei,SegmentString:we});e(Si.prototype,{isSimpleMultiPoint:function(t){if(t.isEmpty())return!0;for(var e=new at,n=0;n<t.getNumGeometries();n++){var i=t.getGeometryN(n).getCoordinate();if(e.contains(i))return this.nonSimpleLocation=i,!1;e.add(i)}return!0},isSimplePolygonal:function(t){for(var e=Tn.getLines(t).iterator();e.hasNext();){var n=e.next();if(!this.isSimpleLinearGeometry(n))return!1}return!0},hasClosedEndpointIntersection:function(t){for(var e=new rt,n=t.getEdgeIterator();n.hasNext();){var i=n.next(),r=(i.getMaximumSegmentIndex(),i.isClosed()),s=i.getCoordinate(0);this.addEndpoint(e,s,r);var o=i.getCoordinate(i.getNumPoints()-1);this.addEndpoint(e,o,r)}for(n=e.values().iterator();n.hasNext();){var a=n.next();if(a.isClosed&&2!==a.degree)return this.nonSimpleLocation=a.getCoordinate(),!0}return!1},getNonSimpleLocation:function(){return this.nonSimpleLocation},isSimpleLinearGeometry:function(t){if(t.isEmpty())return!0;var e=new Un(0,t),n=new Zt,i=e.computeSelfNodes(n,!0);return!(i.hasIntersection()&&(i.hasProperIntersection()?(this.nonSimpleLocation=i.getProperIntersectionPoint(),1):this.hasNonEndpointIntersection(e)||this.isClosedEndpointsInInterior&&this.hasClosedEndpointIntersection(e)))},hasNonEndpointIntersection:function(t){for(var e=t.getEdgeIterator();e.hasNext();)for(var n=e.next(),i=n.getMaximumSegmentIndex(),r=n.getEdgeIntersectionList().iterator();r.hasNext();){var s=r.next();if(!s.isEndPoint(i))return this.nonSimpleLocation=s.getCoordinate(),!0}return!1},addEndpoint:function(t,e,n){var i=t.get(e);null===i&&(i=new Ii(e),t.put(e,i)),i.addEndpoint(n)},computeSimple:function(t){return this.nonSimpleLocation=null,!!t.isEmpty()||(t instanceof Et||t instanceof dt?this.isSimpleLinearGeometry(t):t instanceof Rt?this.isSimpleMultiPoint(t):M(t,Ct)?this.isSimplePolygonal(t):!(t instanceof ft)||this.isSimpleGeometryCollection(t))},isSimple:function(){return this.nonSimpleLocation=null,this.computeSimple(this.inputGeom)},isSimpleGeometryCollection:function(t){for(var e=0;e<t.getNumGeometries();e++){var n=t.getGeometryN(e);if(!this.computeSimple(n))return!1}return!0},interfaces_:function(){return[]},getClass:function(){return Si}}),e(Ii.prototype,{addEndpoint:function(t){this.degree++,this.isClosed|=t},getCoordinate:function(){return this.pt},interfaces_:function(){return[]},getClass:function(){return Ii}}),Si.EndpointInfo=Ii,e(Ci.prototype,{getEndCapStyle:function(){return this.endCapStyle},isSingleSided:function(){return this._isSingleSided},setQuadrantSegments:function(t){this.quadrantSegments=t,0===this.quadrantSegments&&(this.joinStyle=Ci.JOIN_BEVEL),this.quadrantSegments<0&&(this.joinStyle=Ci.JOIN_MITRE,this.mitreLimit=Math.abs(this.quadrantSegments)),0>=t&&(this.quadrantSegments=1),this.joinStyle!==Ci.JOIN_ROUND&&(this.quadrantSegments=Ci.DEFAULT_QUADRANT_SEGMENTS)},getJoinStyle:function(){return this.joinStyle},setJoinStyle:function(t){this.joinStyle=t},setSimplifyFactor:function(t){this.simplifyFactor=0>t?0:t},getSimplifyFactor:function(){return this.simplifyFactor},getQuadrantSegments:function(){return this.quadrantSegments},setEndCapStyle:function(t){this.endCapStyle=t},getMitreLimit:function(){return this.mitreLimit},setMitreLimit:function(t){this.mitreLimit=t},setSingleSided:function(t){this._isSingleSided=t},interfaces_:function(){return[]},getClass:function(){return Ci}}),Ci.bufferDistanceError=function(t){var e=Math.PI/2/t;return 1-Math.cos(e/2)},Ci.CAP_ROUND=1,Ci.CAP_FLAT=2,Ci.CAP_SQUARE=3,Ci.JOIN_ROUND=1,Ci.JOIN_MITRE=2,Ci.JOIN_BEVEL=3,Ci.DEFAULT_QUADRANT_SEGMENTS=8,Ci.DEFAULT_MITRE_LIMIT=5,Ci.DEFAULT_SIMPLIFY_FACTOR=.01,e(Mi.prototype,{getCoordinate:function(){return this.minCoord},getRightmostSide:function(t,e){var n=this.getRightmostSideOfSegment(t,e);return 0>n&&(n=this.getRightmostSideOfSegment(t,e-1)),0>n&&(this.minCoord=null,this.checkForRightmostCoordinate(t)),n},findRightmostEdgeAtVertex:function(){var t=this.minDe.getEdge().getCoordinates();f.isTrue(this.minIndex>0&&this.minIndex<t.length,"rightmost point expected to be interior vertex of edge");var e=t[this.minIndex-1],n=t[this.minIndex+1],i=Qt.computeOrientation(this.minCoord,n,e),r=!1;(e.y<this.minCoord.y&&n.y<this.minCoord.y&&i===Qt.COUNTERCLOCKWISE||e.y>this.minCoord.y&&n.y>this.minCoord.y&&i===Qt.CLOCKWISE)&&(r=!0),r&&(this.minIndex=this.minIndex-1)},getRightmostSideOfSegment:function(t,e){var n=t.getEdge().getCoordinates();if(0>e||e+1>=n.length)return-1;if(n[e].y===n[e+1].y)return-1;var i=Je.LEFT;return n[e].y<n[e+1].y&&(i=Je.RIGHT),i},getEdge:function(){return this.orientedDe},checkForRightmostCoordinate:function(t){for(var e=t.getEdge().getCoordinates(),n=0;n<e.length-1;n++)(null===this.minCoord||e[n].x>this.minCoord.x)&&(this.minDe=t,this.minIndex=n,this.minCoord=e[n])},findRightmostEdgeAtNode:function(){var t=this.minDe.getNode().getEdges();this.minDe=t.getRightmostEdge(),this.minDe.isForward()||(this.minDe=this.minDe.getSym(),this.minIndex=this.minDe.getEdge().getCoordinates().length-1)},findEdge:function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();n.isForward()&&this.checkForRightmostCoordinate(n)}f.isTrue(0!==this.minIndex||this.minCoord.equals(this.minDe.getCoordinate()),"inconsistency in rightmost processing"),0===this.minIndex?this.findRightmostEdgeAtNode():this.findRightmostEdgeAtVertex(),this.orientedDe=this.minDe,this.getRightmostSide(this.minDe,this.minIndex)===Je.LEFT&&(this.orientedDe=this.minDe.getSym())},interfaces_:function(){return[]},getClass:function(){return Mi}}),Ri.prototype.addLast=function(t){this.array_.push(t)},Ri.prototype.removeFirst=function(){return this.array_.shift()},Ri.prototype.isEmpty=function(){return 0===this.array_.length},e(Pi.prototype,{clearVisitedEdges:function(){for(var t=this.dirEdgeList.iterator();t.hasNext();)t.next().setVisited(!1)},getRightmostCoordinate:function(){return this.rightMostCoord},computeNodeDepth:function(t){for(var e=null,n=t.getEdges().iterator();n.hasNext();)if((i=n.next()).isVisited()||i.getSym().isVisited()){e=i;break}if(null===e)throw new je("unable to find edge to compute depths at "+t.getCoordinate());for(t.getEdges().computeDepths(e),n=t.getEdges().iterator();n.hasNext();){var i;(i=n.next()).setVisited(!0),this.copySymDepths(i)}},computeDepth:function(t){this.clearVisitedEdges();var e=this.finder.getEdge();e.getNode(),e.getLabel(),e.setEdgeDepths(Je.RIGHT,t),this.copySymDepths(e),this.computeDepths(e)},create:function(t){this.addReachable(t),this.finder.findEdge(this.dirEdgeList),this.rightMostCoord=this.finder.getCoordinate()},findResultEdges:function(){for(var t=this.dirEdgeList.iterator();t.hasNext();){var e=t.next();e.getDepth(Je.RIGHT)>=1&&e.getDepth(Je.LEFT)<=0&&!e.isInteriorAreaEdge()&&e.setInResult(!0)}},computeDepths:function(t){var e=new J,n=new Ri,i=t.getNode();for(n.addLast(i),e.add(i),t.setVisited(!0);!n.isEmpty();){var r=n.removeFirst();e.add(r),this.computeNodeDepth(r);for(var s=r.getEdges().iterator();s.hasNext();){var o=s.next().getSym();if(!o.isVisited()){var a=o.getNode();e.contains(a)||(n.addLast(a),e.add(a))}}}},compareTo:function(t){var e=t;return this.rightMostCoord.x<e.rightMostCoord.x?-1:this.rightMostCoord.x>e.rightMostCoord.x?1:0},getEnvelope:function(){if(null===this.env){for(var t=new E,e=this.dirEdgeList.iterator();e.hasNext();)for(var n=e.next().getEdge().getCoordinates(),i=0;i<n.length-1;i++)t.expandToInclude(n[i]);this.env=t}return this.env},addReachable:function(t){var e=new re;for(e.add(t);!e.empty();){var n=e.pop();this.add(n,e)}},copySymDepths:function(t){var e=t.getSym();e.setDepth(Je.LEFT,t.getDepth(Je.RIGHT)),e.setDepth(Je.RIGHT,t.getDepth(Je.LEFT))},add:function(t,e){t.setVisited(!0),this.nodes.add(t);for(var n=t.getEdges().iterator();n.hasNext();){var i=n.next();this.dirEdgeList.add(i);var r=i.getSym().getNode();r.isVisited()||e.push(r)}},getNodes:function(){return this.nodes},getDirectedEdges:function(){return this.dirEdgeList},interfaces_:function(){return[s]},getClass:function(){return Pi}}),e(Ti.prototype,{isDeletable:function(t,e,n,i){var r=this.inputLine[t],s=this.inputLine[e],o=this.inputLine[n];return!(!this.isConcave(r,s,o)||!this.isShallow(r,s,o,i))&&this.isShallowSampled(r,s,t,n,i)},deleteShallowConcavities:function(){for(var t=1,e=(this.inputLine.length,this.findNextNonDeletedIndex(t)),n=this.findNextNonDeletedIndex(e),i=!1;n<this.inputLine.length;){var r=!1;this.isDeletable(t,e,n,this.distanceTol)&&(this.isDeleted[e]=Ti.DELETE,r=!0,i=!0),t=r?n:e,e=this.findNextNonDeletedIndex(t),n=this.findNextNonDeletedIndex(e)}return i},isShallowConcavity:function(t,e,n,i){return Qt.computeOrientation(t,e,n)===this.angleOrientation&&i>Qt.distancePointLine(e,t,n)},isShallowSampled:function(t,e,n,i,r){var s=Math.trunc((i-n)/Ti.NUM_PTS_TO_CHECK);0>=s&&(s=1);for(var o=n;i>o;o+=s)if(!this.isShallow(t,e,this.inputLine[o],r))return!1;return!0},isConcave:function(t,e,n){return Qt.computeOrientation(t,e,n)===this.angleOrientation},simplify:function(t){this.distanceTol=Math.abs(t),0>t&&(this.angleOrientation=Qt.CLOCKWISE),this.isDeleted=new Array(this.inputLine.length).fill(null);var e=!1;do{e=this.deleteShallowConcavities()}while(e);return this.collapseLine()},findNextNonDeletedIndex:function(t){for(var e=t+1;e<this.inputLine.length&&this.isDeleted[e]===Ti.DELETE;)e++;return e},isShallow:function(t,e,n,i){return i>Qt.distancePointLine(e,t,n)},collapseLine:function(){for(var t=new b,e=0;e<this.inputLine.length;e++)this.isDeleted[e]!==Ti.DELETE&&t.add(this.inputLine[e]);return t.toCoordinateArray()},interfaces_:function(){return[]},getClass:function(){return Ti}}),Ti.simplify=function(t,e){return new Ti(t).simplify(e)},Ti.INIT=0,Ti.DELETE=1,Ti.KEEP=1,Ti.NUM_PTS_TO_CHECK=10,e(Ni.prototype,{getCoordinates:function(){return this.ptList.toArray(Ni.COORDINATE_ARRAY_TYPE)},setPrecisionModel:function(t){this.precisionModel=t},addPt:function(t){var e=new d(t);return this.precisionModel.makePrecise(e),this.isRedundant(e)?null:void this.ptList.add(e)},reverse:function(){},addPts:function(t,e){if(e)for(var n=0;n<t.length;n++)this.addPt(t[n]);else for(n=t.length-1;n>=0;n--)this.addPt(t[n])},isRedundant:function(t){if(this.ptList.size()<1)return!1;var e=this.ptList.get(this.ptList.size()-1);return t.distance(e)<this.minimimVertexDistance},toString:function(){return(new jt).createLineString(this.getCoordinates()).toString()},closeRing:function(){if(this.ptList.size()<1)return null;var t=new d(this.ptList.get(0)),e=this.ptList.get(this.ptList.size()-1);return this.ptList.size()>=2&&this.ptList.get(this.ptList.size()-2),t.equals(e)?null:void this.ptList.add(t)},setMinimumVertexDistance:function(t){this.minimimVertexDistance=t},interfaces_:function(){return[]},getClass:function(){return Ni}}),Ni.COORDINATE_ARRAY_TYPE=new Array(0).fill(null),e(Ai.prototype,{addNextSegment:function(t,e){if(this.s0=this.s1,this.s1=this.s2,this.s2=t,this.seg0.setCoordinates(this.s0,this.s1),this.computeOffsetSegment(this.seg0,this.side,this.distance,this.offset0),this.seg1.setCoordinates(this.s1,this.s2),this.computeOffsetSegment(this.seg1,this.side,this.distance,this.offset1),this.s1.equals(this.s2))return null;var n=Qt.computeOrientation(this.s0,this.s1,this.s2),i=n===Qt.CLOCKWISE&&this.side===Je.LEFT||n===Qt.COUNTERCLOCKWISE&&this.side===Je.RIGHT;0===n?this.addCollinear(e):i?this.addOutsideTurn(n,e):this.addInsideTurn(n,e)},addLineEndCap:function(t,e){var n=new te(t,e),i=new te;this.computeOffsetSegment(n,Je.LEFT,this.distance,i);var r=new te;this.computeOffsetSegment(n,Je.RIGHT,this.distance,r);var s=e.x-t.x,o=e.y-t.y,a=Math.atan2(o,s);switch(this.bufParams.getEndCapStyle()){case Ci.CAP_ROUND:this.segList.addPt(i.p1),this.addFilletArc(e,a+Math.PI/2,a-Math.PI/2,Qt.CLOCKWISE,this.distance),this.segList.addPt(r.p1);break;case Ci.CAP_FLAT:this.segList.addPt(i.p1),this.segList.addPt(r.p1);break;case Ci.CAP_SQUARE:var l=new d;l.x=Math.abs(this.distance)*Math.cos(a),l.y=Math.abs(this.distance)*Math.sin(a);var h=new d(i.p1.x+l.x,i.p1.y+l.y),u=new d(r.p1.x+l.x,r.p1.y+l.y);this.segList.addPt(h),this.segList.addPt(u)}},getCoordinates:function(){return this.segList.getCoordinates()},addMitreJoin:function(t,e,n,i){var r=!0,s=null;try{s=D.intersection(e.p0,e.p1,n.p0,n.p1),(0>=i?1:s.distance(t)/Math.abs(i))>this.bufParams.getMitreLimit()&&(r=!1)}catch(t){if(!(t instanceof I))throw t;s=new d(0,0),r=!1}r?this.segList.addPt(s):this.addLimitedMitreJoin(e,n,i,this.bufParams.getMitreLimit())},addFilletCorner:function(t,e,n,i,r){var s=e.x-t.x,o=e.y-t.y,a=Math.atan2(o,s),l=n.x-t.x,h=n.y-t.y,u=Math.atan2(h,l);i===Qt.CLOCKWISE?u>=a&&(a+=2*Math.PI):a>=u&&(a-=2*Math.PI),this.segList.addPt(e),this.addFilletArc(t,a,u,i,r),this.segList.addPt(n)},addOutsideTurn:function(t,e){return this.offset0.p1.distance(this.offset1.p0)<this.distance*Ai.OFFSET_SEGMENT_SEPARATION_FACTOR?(this.segList.addPt(this.offset0.p1),null):void(this.bufParams.getJoinStyle()===Ci.JOIN_MITRE?this.addMitreJoin(this.s1,this.offset0,this.offset1,this.distance):this.bufParams.getJoinStyle()===Ci.JOIN_BEVEL?this.addBevelJoin(this.offset0,this.offset1):(e&&this.segList.addPt(this.offset0.p1),this.addFilletCorner(this.s1,this.offset0.p1,this.offset1.p0,t,this.distance),this.segList.addPt(this.offset1.p0)))},createSquare:function(t){this.segList.addPt(new d(t.x+this.distance,t.y+this.distance)),this.segList.addPt(new d(t.x+this.distance,t.y-this.distance)),this.segList.addPt(new d(t.x-this.distance,t.y-this.distance)),this.segList.addPt(new d(t.x-this.distance,t.y+this.distance)),this.segList.closeRing()},addSegments:function(t,e){this.segList.addPts(t,e)},addFirstSegment:function(){this.segList.addPt(this.offset1.p0)},addLastSegment:function(){this.segList.addPt(this.offset1.p1)},initSideSegments:function(t,e,n){this.s1=t,this.s2=e,this.side=n,this.seg1.setCoordinates(t,e),this.computeOffsetSegment(this.seg1,n,this.distance,this.offset1)},addLimitedMitreJoin:function(t,e,n,i){var r=this.seg0.p1,s=Jn.angle(r,this.seg0.p0),o=(Jn.angle(r,this.seg1.p1),Jn.angleBetweenOriented(this.seg0.p0,r,this.seg1.p1)/2),a=Jn.normalize(s+o),l=Jn.normalize(a+Math.PI),h=i*n,u=n-h*Math.abs(Math.sin(o)),c=new te(r,new d(r.x+h*Math.cos(l),r.y+h*Math.sin(l))),f=c.pointAlongOffset(1,u),g=c.pointAlongOffset(1,-u);this.side===Je.LEFT?(this.segList.addPt(f),this.segList.addPt(g)):(this.segList.addPt(g),this.segList.addPt(f))},computeOffsetSegment:function(t,e,n,i){var r=e===Je.LEFT?1:-1,s=t.p1.x-t.p0.x,o=t.p1.y-t.p0.y,a=Math.sqrt(s*s+o*o),l=r*n*s/a,h=r*n*o/a;i.p0.x=t.p0.x-h,i.p0.y=t.p0.y+l,i.p1.x=t.p1.x-h,i.p1.y=t.p1.y+l},addFilletArc:function(t,e,n,i,r){var s=i===Qt.CLOCKWISE?-1:1,o=Math.abs(e-n),a=Math.trunc(o/this.filletAngleQuantum+.5);if(1>a)return null;var l;l=o/a;for(var h=0,u=new d;o>h;){var c=e+s*h;u.x=t.x+r*Math.cos(c),u.y=t.y+r*Math.sin(c),this.segList.addPt(u),h+=l}},addInsideTurn:function(t,e){if(this.li.computeIntersection(this.offset0.p0,this.offset0.p1,this.offset1.p0,this.offset1.p1),this.li.hasIntersection())this.segList.addPt(this.li.getIntersection(0));else if(this._hasNarrowConcaveAngle=!0,this.offset0.p1.distance(this.offset1.p0)<this.distance*Ai.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR)this.segList.addPt(this.offset0.p1);else{if(this.segList.addPt(this.offset0.p1),this.closingSegLengthFactor>0){var n=new d((this.closingSegLengthFactor*this.offset0.p1.x+this.s1.x)/(this.closingSegLengthFactor+1),(this.closingSegLengthFactor*this.offset0.p1.y+this.s1.y)/(this.closingSegLengthFactor+1));this.segList.addPt(n);var i=new d((this.closingSegLengthFactor*this.offset1.p0.x+this.s1.x)/(this.closingSegLengthFactor+1),(this.closingSegLengthFactor*this.offset1.p0.y+this.s1.y)/(this.closingSegLengthFactor+1));this.segList.addPt(i)}else this.segList.addPt(this.s1);this.segList.addPt(this.offset1.p0)}},createCircle:function(t){var e=new d(t.x+this.distance,t.y);this.segList.addPt(e),this.addFilletArc(t,0,2*Math.PI,-1,this.distance),this.segList.closeRing()},addBevelJoin:function(t,e){this.segList.addPt(t.p1),this.segList.addPt(e.p0)},init:function(t){this.distance=t,this.maxCurveSegmentError=t*(1-Math.cos(this.filletAngleQuantum/2)),this.segList=new Ni,this.segList.setPrecisionModel(this.precisionModel),this.segList.setMinimumVertexDistance(t*Ai.CURVE_VERTEX_SNAP_DISTANCE_FACTOR)},addCollinear:function(t){this.li.computeIntersection(this.s0,this.s1,this.s1,this.s2),this.li.getIntersectionNum()>=2&&(this.bufParams.getJoinStyle()===Ci.JOIN_BEVEL||this.bufParams.getJoinStyle()===Ci.JOIN_MITRE?(t&&this.segList.addPt(this.offset0.p1),this.segList.addPt(this.offset1.p0)):this.addFilletCorner(this.s1,this.offset0.p1,this.offset1.p0,Qt.CLOCKWISE,this.distance))},closeRing:function(){this.segList.closeRing()},hasNarrowConcaveAngle:function(){return this._hasNarrowConcaveAngle},interfaces_:function(){return[]},getClass:function(){return Ai}}),Ai.OFFSET_SEGMENT_SEPARATION_FACTOR=.001,Ai.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR=.001,Ai.CURVE_VERTEX_SNAP_DISTANCE_FACTOR=1e-6,Ai.MAX_CLOSING_SEG_LEN_FACTOR=80,e(ki.prototype,{getOffsetCurve:function(t,e){if(this.distance=e,0===e)return null;var n=0>e,i=Math.abs(e),r=this.getSegGen(i);t.length<=1?this.computePointCurve(t[0],r):this.computeOffsetCurve(t,n,r);var s=r.getCoordinates();return n&&j.reverse(s),s},computeSingleSidedBufferCurve:function(t,e,n){var i=this.simplifyTolerance(this.distance);if(e){n.addSegments(t,!0);var r=Ti.simplify(t,-i),s=r.length-1;n.initSideSegments(r[s],r[s-1],Je.LEFT),n.addFirstSegment();for(var o=s-2;o>=0;o--)n.addNextSegment(r[o],!0)}else{n.addSegments(t,!1);var a=Ti.simplify(t,i),l=a.length-1;for(n.initSideSegments(a[0],a[1],Je.LEFT),n.addFirstSegment(),o=2;l>=o;o++)n.addNextSegment(a[o],!0)}n.addLastSegment(),n.closeRing()},computeRingBufferCurve:function(t,e,n){var i=this.simplifyTolerance(this.distance);e===Je.RIGHT&&(i=-i);var r=Ti.simplify(t,i),s=r.length-1;n.initSideSegments(r[s-1],r[0],e);for(var o=1;s>=o;o++){var a=1!==o;n.addNextSegment(r[o],a)}n.closeRing()},computeLineBufferCurve:function(t,e){var n=this.simplifyTolerance(this.distance),i=Ti.simplify(t,n),r=i.length-1;e.initSideSegments(i[0],i[1],Je.LEFT);for(var s=2;r>=s;s++)e.addNextSegment(i[s],!0);e.addLastSegment(),e.addLineEndCap(i[r-1],i[r]);var o=Ti.simplify(t,-n),a=o.length-1;for(e.initSideSegments(o[a],o[a-1],Je.LEFT),s=a-2;s>=0;s--)e.addNextSegment(o[s],!0);e.addLastSegment(),e.addLineEndCap(o[1],o[0]),e.closeRing()},computePointCurve:function(t,e){switch(this.bufParams.getEndCapStyle()){case Ci.CAP_ROUND:e.createCircle(t);break;case Ci.CAP_SQUARE:e.createSquare(t)}},getLineCurve:function(t,e){if(this.distance=e,0>e&&!this.bufParams.isSingleSided())return null;if(0===e)return null;var n=Math.abs(e),i=this.getSegGen(n);if(t.length<=1)this.computePointCurve(t[0],i);else if(this.bufParams.isSingleSided()){var r=0>e;this.computeSingleSidedBufferCurve(t,r,i)}else this.computeLineBufferCurve(t,i);return i.getCoordinates()},getBufferParameters:function(){return this.bufParams},simplifyTolerance:function(t){return t*this.bufParams.getSimplifyFactor()},getRingCurve:function(t,e,n){if(this.distance=n,t.length<=2)return this.getLineCurve(t,n);if(0===n)return ki.copyCoordinates(t);var i=this.getSegGen(n);return this.computeRingBufferCurve(t,e,i),i.getCoordinates()},computeOffsetCurve:function(t,e,n){var i=this.simplifyTolerance(this.distance);if(e){var r=Ti.simplify(t,-i),s=r.length-1;n.initSideSegments(r[s],r[s-1],Je.LEFT),n.addFirstSegment();for(var o=s-2;o>=0;o--)n.addNextSegment(r[o],!0)}else{var a=Ti.simplify(t,i),l=a.length-1;for(n.initSideSegments(a[0],a[1],Je.LEFT),n.addFirstSegment(),o=2;l>=o;o++)n.addNextSegment(a[o],!0)}n.addLastSegment()},getSegGen:function(t){return new Ai(this.precisionModel,this.bufParams,t)},interfaces_:function(){return[]},getClass:function(){return ki}}),ki.copyCoordinates=function(t){for(var e=new Array(t.length).fill(null),n=0;n<e.length;n++)e[n]=new d(t[n]);return e},e(Li.prototype,{findStabbedSegments:function(){if(1===arguments.length){for(var t=arguments[0],e=new _,n=this.subgraphs.iterator();n.hasNext();){var i=n.next(),r=i.getEnvelope();t.y<r.getMinY()||t.y>r.getMaxY()||this.findStabbedSegments(t,i.getDirectedEdges(),e)}return e}if(3===arguments.length)if(M(arguments[2],v)&&arguments[0]instanceof d&&arguments[1]instanceof hn){var s=arguments[0],o=arguments[1],a=arguments[2],l=o.getEdge().getCoordinates();for(n=0;n<l.length-1;n++)if(this.seg.p0=l[n],this.seg.p1=l[n+1],this.seg.p0.y>this.seg.p1.y&&this.seg.reverse(),!(Math.max(this.seg.p0.x,this.seg.p1.x)<s.x||this.seg.isHorizontal()||s.y<this.seg.p0.y||s.y>this.seg.p1.y||Qt.computeOrientation(this.seg.p0,this.seg.p1,s)===Qt.RIGHT)){var h=o.getDepth(Je.LEFT);this.seg.p0.equals(l[n])||(h=o.getDepth(Je.RIGHT));var u=new Oi(this.seg,h);a.add(u)}}else if(M(arguments[2],v)&&arguments[0]instanceof d&&M(arguments[1],v)){var c=arguments[0],f=arguments[2];for(n=arguments[1].iterator();n.hasNext();){var g=n.next();g.isForward()&&this.findStabbedSegments(c,g,f)}}},getDepth:function(t){var e=this.findStabbedSegments(t);return 0===e.size()?0:Zs.min(e).leftDepth},interfaces_:function(){return[]},getClass:function(){return Li}}),e(Oi.prototype,{compareTo:function(t){var e=t;if(this.upwardSeg.minX()>=e.upwardSeg.maxX())return 1;if(this.upwardSeg.maxX()<=e.upwardSeg.minX())return-1;var n=this.upwardSeg.orientationIndex(e.upwardSeg);return 0!==n||0!=(n=-1*e.upwardSeg.orientationIndex(this.upwardSeg))?n:this.upwardSeg.compareTo(e.upwardSeg)},compareX:function(t,e){var n=t.p0.compareTo(e.p0);return 0!==n?n:t.p1.compareTo(e.p1)},toString:function(){return this.upwardSeg.toString()},interfaces_:function(){return[s]},getClass:function(){return Oi}}),Li.DepthSegment=Oi,e(Di.prototype,{addPoint:function(t){if(this.distance<=0)return null;var e=t.getCoordinates(),n=this.curveBuilder.getLineCurve(e,this.distance);this.addCurve(n,C.EXTERIOR,C.INTERIOR)},addPolygon:function(t){var e=this.distance,n=Je.LEFT;this.distance<0&&(e=-this.distance,n=Je.RIGHT);var i=t.getExteriorRing(),r=j.removeRepeatedPoints(i.getCoordinates());if(this.distance<0&&this.isErodedCompletely(i,this.distance))return null;if(this.distance<=0&&r.length<3)return null;this.addPolygonRing(r,e,n,C.EXTERIOR,C.INTERIOR);for(var s=0;s<t.getNumInteriorRing();s++){var o=t.getInteriorRingN(s),a=j.removeRepeatedPoints(o.getCoordinates());this.distance>0&&this.isErodedCompletely(o,-this.distance)||this.addPolygonRing(a,e,Je.opposite(n),C.INTERIOR,C.EXTERIOR)}},isTriangleErodedCompletely:function(t,e){var n=new Qn(t[0],t[1],t[2]),i=n.inCentre();return Qt.distancePointLine(i,n.p0,n.p1)<Math.abs(e)},addLineString:function(t){if(this.distance<=0&&!this.curveBuilder.getBufferParameters().isSingleSided())return null;var e=j.removeRepeatedPoints(t.getCoordinates()),n=this.curveBuilder.getLineCurve(e,this.distance);this.addCurve(n,C.EXTERIOR,C.INTERIOR)},addCurve:function(t,e,n){if(null===t||t.length<2)return null;var i=new Fe(t,new tn(0,C.BOUNDARY,e,n));this.curveList.add(i)},getCurves:function(){return this.add(this.inputGeom),this.curveList},addPolygonRing:function(t,e,n,i,r){if(0===e&&t.length<Pt.MINIMUM_VALID_SIZE)return null;var s=i,o=r;t.length>=Pt.MINIMUM_VALID_SIZE&&Qt.isCCW(t)&&(s=r,o=i,n=Je.opposite(n));var a=this.curveBuilder.getRingCurve(t,n,e);this.addCurve(a,s,o)},add:function(t){if(t.isEmpty())return null;if(t instanceof Mt)this.addPolygon(t);else if(t instanceof Et)this.addLineString(t);else if(t instanceof It)this.addPoint(t);else if(t instanceof Rt)this.addCollection(t);else if(t instanceof dt)this.addCollection(t);else if(t instanceof Tt)this.addCollection(t);else{if(!(t instanceof ft))throw new UnsupportedOperationException(t.getClass().getName());this.addCollection(t)}},isErodedCompletely:function(t,e){var n=t.getCoordinates();if(n.length<4)return 0>e;if(4===n.length)return this.isTriangleErodedCompletely(n,e);var i=t.getEnvelopeInternal(),r=Math.min(i.getHeight(),i.getWidth());return 0>e&&2*Math.abs(e)>r},addCollection:function(t){for(var e=0;e<t.getNumGeometries();e++){var n=t.getGeometryN(e);this.add(n)}},interfaces_:function(){return[]},getClass:function(){return Di}}),e(Fi.prototype,{isTrivialIntersection:function(t,e,n,i){if(t===n&&1===this.li.getIntersectionNum()){if(Fi.isAdjacentSegments(e,i))return!0;if(t.isClosed()){var r=t.size()-1;if(0===e&&i===r||0===i&&e===r)return!0}}return!1},getProperIntersectionPoint:function(){return this.properIntersectionPoint},hasProperInteriorIntersection:function(){return this.hasProperInterior},getLineIntersector:function(){return this.li},hasProperIntersection:function(){return this.hasProper},processIntersections:function(t,e,n,i){if(t===n&&e===i)return null;this.numTests++;var r=t.getCoordinates()[e],s=t.getCoordinates()[e+1],o=n.getCoordinates()[i],a=n.getCoordinates()[i+1];this.li.computeIntersection(r,s,o,a),this.li.hasIntersection()&&(this.numIntersections++,this.li.isInteriorIntersection()&&(this.numInteriorIntersections++,this.hasInterior=!0),this.isTrivialIntersection(t,e,n,i)||(this._hasIntersection=!0,t.addIntersections(this.li,e,0),n.addIntersections(this.li,i,1),this.li.isProper()&&(this.numProperIntersections++,this.hasProper=!0,this.hasProperInterior=!0)))},hasIntersection:function(){return this._hasIntersection},isDone:function(){return!1},hasInteriorIntersection:function(){return this.hasInterior},interfaces_:function(){return[We]},getClass:function(){return Fi}}),Fi.isAdjacentSegments=function(t,e){return 1===Math.abs(t-e)},e(zi.prototype,{setWorkingPrecisionModel:function(t){this.workingPrecisionModel=t},insertUniqueEdge:function(t){var e=this.edgeList.findEqualEdge(t);if(null!==e){var n=e.getLabel(),i=t.getLabel();e.isPointwiseEqual(t)||(i=new tn(t.getLabel())).flip(),n.merge(i);var r=zi.depthDelta(i),s=e.getDepthDelta()+r;e.setDepthDelta(s)}else this.edgeList.add(t),t.setDepthDelta(zi.depthDelta(t.getLabel()))},buildSubgraphs:function(t,e){for(var n=new _,i=t.iterator();i.hasNext();){var r=i.next(),s=r.getRightmostCoordinate(),o=new Li(n).getDepth(s);r.computeDepth(o),r.findResultEdges(),n.add(r),e.add(r.getDirectedEdges(),r.getNodes())}},createSubgraphs:function(t){for(var e=new _,n=t.getNodes().iterator();n.hasNext();){var i=n.next();if(!i.isVisited()){var r=new Pi;r.create(i),e.add(r)}}return Zs.sort(e,Zs.reverseOrder()),e},createEmptyResultGeometry:function(){return this.geomFact.createPolygon()},getNoder:function(t){if(null!==this.workingNoder)return this.workingNoder;var e=new Ye,n=new Zt;return n.setPrecisionModel(t),e.setSegmentIntersector(new Fi(n)),e},buffer:function(t,e){var n=this.workingPrecisionModel;null===n&&(n=t.getPrecisionModel()),this.geomFact=t.getFactory();var i=new Di(t,e,new ki(n,this.bufParams)).getCurves();if(i.size()<=0)return this.createEmptyResultGeometry();this.computeNodedEdges(i,n),this.graph=new cn(new wn),this.graph.addEdges(this.edgeList.getEdges());var r=this.createSubgraphs(this.graph),s=new fn(this.geomFact);this.buildSubgraphs(r,s);var o=s.getPolygons();return o.size()<=0?this.createEmptyResultGeometry():this.geomFact.buildGeometry(o)},computeNodedEdges:function(t,e){var n=this.getNoder(e);n.computeNodes(t);for(var i=n.getNodedSubstrings().iterator();i.hasNext();){var r=i.next(),s=r.getCoordinates();if(2!==s.length||!s[0].equals2D(s[1])){var o=r.getData(),a=new Bn(r.getCoordinates(),new tn(o));this.insertUniqueEdge(a)}}},setNoder:function(t){this.workingNoder=t},interfaces_:function(){return[]},getClass:function(){return zi}}),zi.depthDelta=function(t){var e=t.getLocation(0,Je.LEFT),n=t.getLocation(0,Je.RIGHT);return e===C.INTERIOR&&n===C.EXTERIOR?1:e===C.EXTERIOR&&n===C.INTERIOR?-1:0},zi.convertSegStrings=function(t){for(var e=new jt,n=new _;t.hasNext();){var i=t.next(),r=e.createLineString(i.getCoordinates());n.add(r)}return e.buildGeometry(n)},e(Gi.prototype,{checkEndPtVertexIntersections:function(){if(0===arguments.length)for(var t=this.segStrings.iterator();t.hasNext();){var e=t.next().getCoordinates();this.checkEndPtVertexIntersections(e[0],this.segStrings),this.checkEndPtVertexIntersections(e[e.length-1],this.segStrings)}else if(2===arguments.length){var n=arguments[0];for(t=arguments[1].iterator();t.hasNext();){e=t.next().getCoordinates();for(var i=1;i<e.length-1;i++)if(e[i].equals(n))throw new h("found endpt/interior pt intersection at index "+i+" :pt "+n)}}},checkInteriorIntersections:function(){if(0===arguments.length)for(var t=this.segStrings.iterator();t.hasNext();)for(var e=t.next(),n=this.segStrings.iterator();n.hasNext();){var i=n.next();this.checkInteriorIntersections(e,i)}else if(2===arguments.length)for(var r=arguments[0],s=arguments[1],o=r.getCoordinates(),a=s.getCoordinates(),l=0;l<o.length-1;l++)for(var u=0;u<a.length-1;u++)this.checkInteriorIntersections(r,l,s,u);else if(4===arguments.length){var c=arguments[0],f=arguments[1],d=arguments[2],g=arguments[3];if(c===d&&f===g)return null;var p=c.getCoordinates()[f],m=c.getCoordinates()[f+1],y=d.getCoordinates()[g],v=d.getCoordinates()[g+1];if(this.li.computeIntersection(p,m,y,v),this.li.hasIntersection()&&(this.li.isProper()||this.hasInteriorIntersection(this.li,p,m)||this.hasInteriorIntersection(this.li,y,v)))throw new h("found non-noded intersection at "+p+"-"+m+" and "+y+"-"+v)}},checkValid:function(){this.checkEndPtVertexIntersections(),this.checkInteriorIntersections(),this.checkCollapses()},checkCollapses:function(){if(0===arguments.length)for(var t=this.segStrings.iterator();t.hasNext();){var e=t.next();this.checkCollapses(e)}else if(1===arguments.length){var n=arguments[0].getCoordinates();for(t=0;t<n.length-2;t++)this.checkCollapse(n[t],n[t+1],n[t+2])}},hasInteriorIntersection:function(t,e,n){for(var i=0;i<t.getIntersectionNum();i++){var r=t.getIntersection(i);if(!r.equals(e)&&!r.equals(n))return!0}return!1},checkCollapse:function(t,e,n){if(t.equals(n))throw new h("found non-noded collapse at "+Gi.fact.createLineString([t,e,n]))},interfaces_:function(){return[]},getClass:function(){return Gi}}),Gi.fact=new jt,e(Bi.prototype,{intersectsScaled:function(t,e){var n=Math.min(t.x,e.x),i=Math.max(t.x,e.x),r=Math.min(t.y,e.y),s=Math.max(t.y,e.y),o=this.maxx<n||this.minx>i||this.maxy<r||this.miny>s;if(o)return!1;var a=this.intersectsToleranceSquare(t,e);return f.isTrue(!(o&&a),"Found bad envelope test"),a},initCorners:function(t){var e=.5;this.minx=t.x-e,this.maxx=t.x+e,this.miny=t.y-e,this.maxy=t.y+e,this.corner[0]=new d(this.maxx,this.maxy),this.corner[1]=new d(this.minx,this.maxy),this.corner[2]=new d(this.minx,this.miny),this.corner[3]=new d(this.maxx,this.miny)},intersects:function(t,e){return 1===this.scaleFactor?this.intersectsScaled(t,e):(this.copyScaled(t,this.p0Scaled),this.copyScaled(e,this.p1Scaled),this.intersectsScaled(this.p0Scaled,this.p1Scaled))},scale:function(t){return Math.round(t*this.scaleFactor)},getCoordinate:function(){return this.originalPt},copyScaled:function(t,e){e.x=this.scale(t.x),e.y=this.scale(t.y)},getSafeEnvelope:function(){if(null===this.safeEnv){var t=Bi.SAFE_ENV_EXPANSION_FACTOR/this.scaleFactor;this.safeEnv=new E(this.originalPt.x-t,this.originalPt.x+t,this.originalPt.y-t,this.originalPt.y+t)}return this.safeEnv},intersectsPixelClosure:function(t,e){return this.li.computeIntersection(t,e,this.corner[0],this.corner[1]),!!(this.li.hasIntersection()||(this.li.computeIntersection(t,e,this.corner[1],this.corner[2]),this.li.hasIntersection()||(this.li.computeIntersection(t,e,this.corner[2],this.corner[3]),this.li.hasIntersection()||(this.li.computeIntersection(t,e,this.corner[3],this.corner[0]),this.li.hasIntersection()))))},intersectsToleranceSquare:function(t,e){var n=!1,i=!1;return this.li.computeIntersection(t,e,this.corner[0],this.corner[1]),!!(this.li.isProper()||(this.li.computeIntersection(t,e,this.corner[1],this.corner[2]),this.li.isProper()||(this.li.hasIntersection()&&(n=!0),this.li.computeIntersection(t,e,this.corner[2],this.corner[3]),this.li.isProper()||(this.li.hasIntersection()&&(i=!0),this.li.computeIntersection(t,e,this.corner[3],this.corner[0]),this.li.isProper()||n&&i||t.equals(this.pt)||e.equals(this.pt)))))},addSnappedNode:function(t,e){var n=t.getCoordinate(e),i=t.getCoordinate(e+1);return!!this.intersects(n,i)&&(t.addIntersection(this.getCoordinate(),e),!0)},interfaces_:function(){return[]},getClass:function(){return Bi}}),Bi.SAFE_ENV_EXPANSION_FACTOR=.75,e(Ui.prototype,{select:function(){if(1===arguments.length);else if(2===arguments.length){var t=arguments[1];arguments[0].getLineSegment(t,this.selectedSegment),this.select(this.selectedSegment)}},interfaces_:function(){return[]},getClass:function(){return Ui}}),e(qi.prototype,{snap:function(){if(1===arguments.length){var t=arguments[0];return this.snap(t,null,-1)}if(3===arguments.length){var e=arguments[0],n=arguments[1],i=arguments[2],r=e.getSafeEnvelope(),s=new Vi(e,n,i);return this.index.query(r,{interfaces_:function(){return[Se]},visitItem:function(t){t.select(r,s)}}),s.isNodeAdded()}},interfaces_:function(){return[]},getClass:function(){return qi}}),u(Vi,Ui),e(Vi.prototype,{isNodeAdded:function(){return this._isNodeAdded},select:function(){if(2!==arguments.length)return Ui.prototype.select.apply(this,arguments);var t=arguments[1],e=arguments[0].getContext();return null!==this.parentEdge&&e===this.parentEdge&&t===this.hotPixelVertexIndex?null:void(this._isNodeAdded=this.hotPixel.addSnappedNode(e,t))},interfaces_:function(){return[]},getClass:function(){return Vi}}),qi.HotPixelSnapAction=Vi,e(Yi.prototype,{processIntersections:function(t,e,n,i){if(t===n&&e===i)return null;var r=t.getCoordinates()[e],s=t.getCoordinates()[e+1],o=n.getCoordinates()[i],a=n.getCoordinates()[i+1];if(this.li.computeIntersection(r,s,o,a),this.li.hasIntersection()&&this.li.isInteriorIntersection()){for(var l=0;l<this.li.getIntersectionNum();l++)this.interiorIntersections.add(this.li.getIntersection(l));t.addIntersections(this.li,e,0),n.addIntersections(this.li,i,1)}},isDone:function(){return!1},getInteriorIntersections:function(){return this.interiorIntersections},interfaces_:function(){return[We]},getClass:function(){return Yi}}),e(Xi.prototype,{checkCorrectness:function(t){var e=new Gi(Fe.getNodedSubstrings(t));try{e.checkValid()}catch(t){if(!(t instanceof S))throw t;t.printStackTrace()}},getNodedSubstrings:function(){return Fe.getNodedSubstrings(this.nodedSegStrings)},snapRound:function(t,e){var n=this.findInteriorIntersections(t,e);this.computeIntersectionSnaps(n),this.computeVertexSnaps(t)},findInteriorIntersections:function(t,e){var n=new Yi(e);return this.noder.setSegmentIntersector(n),this.noder.computeNodes(t),n.getInteriorIntersections()},computeVertexSnaps:function(){if(M(arguments[0],m))for(var t=arguments[0].iterator();t.hasNext();){var e=t.next();this.computeVertexSnaps(e)}else if(arguments[0]instanceof Fe)for(var n=arguments[0],i=n.getCoordinates(),r=0;r<i.length;r++){var s=new Bi(i[r],this.scaleFactor,this.li);this.pointSnapper.snap(s,n,r)&&n.addIntersection(i[r],r)}},computeNodes:function(t){this.nodedSegStrings=t,this.noder=new Ye,this.pointSnapper=new qi(this.noder.getIndex()),this.snapRound(t,this.li)},computeIntersectionSnaps:function(t){for(var e=t.iterator();e.hasNext();){var n=new Bi(e.next(),this.scaleFactor,this.li);this.pointSnapper.snap(n)}},interfaces_:function(){return[qe]},getClass:function(){return Xi}}),e(ji.prototype,{bufferFixedPrecision:function(t){var e=new Ei(new Xi(new Yt(1)),t.getScale()),n=new zi(this.bufParams);n.setWorkingPrecisionModel(t),n.setNoder(e),this.resultGeometry=n.buffer(this.argGeom,this.distance)},bufferReducedPrecision:function(){if(0===arguments.length){for(var t=ji.MAX_PRECISION_DIGITS;t>=0;t--){try{this.bufferReducedPrecision(t)}catch(t){if(!(t instanceof je))throw t;this.saveException=t}if(null!==this.resultGeometry)return null}throw this.saveException}if(1===arguments.length){var e=arguments[0],n=new Yt(ji.precisionScaleFactor(this.argGeom,this.distance,e));this.bufferFixedPrecision(n)}},computeGeometry:function(){if(this.bufferOriginalPrecision(),null!==this.resultGeometry)return null;var t=this.argGeom.getFactory().getPrecisionModel();t.getType()===Yt.FIXED?this.bufferFixedPrecision(t):this.bufferReducedPrecision()},setQuadrantSegments:function(t){this.bufParams.setQuadrantSegments(t)},bufferOriginalPrecision:function(){try{var t=new zi(this.bufParams);this.resultGeometry=t.buffer(this.argGeom,this.distance)}catch(t){if(!(t instanceof h))throw t;this.saveException=t}},getResultGeometry:function(t){return this.distance=t,this.computeGeometry(),this.resultGeometry},setEndCapStyle:function(t){this.bufParams.setEndCapStyle(t)},interfaces_:function(){return[]},getClass:function(){return ji}}),ji.bufferOp=function(){if(2===arguments.length){var t=arguments[1];return new ji(arguments[0]).getResultGeometry(t)}if(3===arguments.length){if(Number.isInteger(arguments[2])&&arguments[0]instanceof G&&"number"==typeof arguments[1]){var e=arguments[1],n=arguments[2];return(r=new ji(arguments[0])).setQuadrantSegments(n),r.getResultGeometry(e)}if(arguments[2]instanceof Ci&&arguments[0]instanceof G&&"number"==typeof arguments[1]){var i=arguments[1];return(r=new ji(arguments[0],arguments[2])).getResultGeometry(i)}}else if(4===arguments.length){var r,s=arguments[1],o=arguments[2],a=arguments[3];return(r=new ji(arguments[0])).setQuadrantSegments(o),r.setEndCapStyle(a),r.getResultGeometry(s)}},ji.precisionScaleFactor=function(t,e,n){var i=t.getEnvelopeInternal(),r=R.max(Math.abs(i.getMaxX()),Math.abs(i.getMaxY()),Math.abs(i.getMinX()),Math.abs(i.getMinY()))+2*(e>0?e:0),s=n-Math.trunc(Math.log(r)/Math.log(10)+1);return Math.pow(10,s)},ji.CAP_ROUND=Ci.CAP_ROUND,ji.CAP_BUTT=Ci.CAP_FLAT,ji.CAP_FLAT=Ci.CAP_FLAT,ji.CAP_SQUARE=Ci.CAP_SQUARE,ji.MAX_PRECISION_DIGITS=12;var lo=Object.freeze({BufferOp:ji,BufferParameters:Ci});e(Wi.prototype,{filter:function(t){t instanceof Mt&&this.comps.add(t)},interfaces_:function(){return[ut]},getClass:function(){return Wi}}),Wi.getPolygons=function(){if(1===arguments.length){var t=arguments[0];return Wi.getPolygons(t,new _)}if(2===arguments.length){var e=arguments[0],n=arguments[1];return e instanceof Mt?n.add(e):e instanceof ft&&e.apply(new Wi(n)),n}},e(Hi.prototype,{isInsideArea:function(){return this.segIndex===Hi.INSIDE_AREA},getCoordinate:function(){return this.pt},getGeometryComponent:function(){return this.component},getSegmentIndex:function(){return this.segIndex},interfaces_:function(){return[]},getClass:function(){return Hi}}),Hi.INSIDE_AREA=-1,e($i.prototype,{filter:function(t){t instanceof It&&this.pts.add(t)},interfaces_:function(){return[ut]},getClass:function(){return $i}}),$i.getPoints=function(){if(1===arguments.length){var t=arguments[0];return t instanceof It?Zs.singletonList(t):$i.getPoints(t,new _)}if(2===arguments.length){var e=arguments[0],n=arguments[1];return e instanceof It?n.add(e):e instanceof ft&&e.apply(new $i(n)),n}},e(Zi.prototype,{filter:function(t){(t instanceof It||t instanceof Et||t instanceof Mt)&&this.locations.add(new Hi(t,0,t.getCoordinate()))},interfaces_:function(){return[ut]},getClass:function(){return Zi}}),Zi.getLocations=function(t){var e=new _;return t.apply(new Zi(e)),e},e(Ki.prototype,{computeContainmentDistance:function(){if(0===arguments.length){var t=new Array(2).fill(null);if(this.computeContainmentDistance(0,t),this.minDistance<=this.terminateDistance)return null;this.computeContainmentDistance(1,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1],i=1-e,r=Wi.getPolygons(this.geom[e]);if(r.size()>0){var s=Zi.getLocations(this.geom[i]);if(this.computeContainmentDistance(s,r,n),this.minDistance<=this.terminateDistance)return this.minDistanceLocation[i]=n[0],this.minDistanceLocation[e]=n[1],null}}else if(3===arguments.length)if(arguments[2]instanceof Array&&M(arguments[0],v)&&M(arguments[1],v)){for(var o=arguments[0],a=arguments[1],l=arguments[2],h=0;h<o.size();h++)for(var u=o.get(h),c=0;c<a.size();c++)if(this.computeContainmentDistance(u,a.get(c),l),this.minDistance<=this.terminateDistance)return null}else if(arguments[2]instanceof Array&&arguments[0]instanceof Hi&&arguments[1]instanceof Mt){var f=arguments[0],d=arguments[1],g=arguments[2],p=f.getCoordinate();if(C.EXTERIOR!==this.ptLocator.locate(p,d))return this.minDistance=0,g[0]=f,g[1]=new Hi(d,p),null}},computeMinDistanceLinesPoints:function(t,e,n){for(var i=0;i<t.size();i++)for(var r=t.get(i),s=0;s<e.size();s++){var o=e.get(s);if(this.computeMinDistance(r,o,n),this.minDistance<=this.terminateDistance)return null}},computeFacetDistance:function(){var t=new Array(2).fill(null),e=Tn.getLines(this.geom[0]),n=Tn.getLines(this.geom[1]),i=$i.getPoints(this.geom[0]),r=$i.getPoints(this.geom[1]);return this.computeMinDistanceLines(e,n,t),this.updateMinDistance(t,!1),this.minDistance<=this.terminateDistance?null:(t[0]=null,t[1]=null,this.computeMinDistanceLinesPoints(e,r,t),this.updateMinDistance(t,!1),this.minDistance<=this.terminateDistance?null:(t[0]=null,t[1]=null,this.computeMinDistanceLinesPoints(n,i,t),this.updateMinDistance(t,!0),this.minDistance<=this.terminateDistance?null:(t[0]=null,t[1]=null,this.computeMinDistancePoints(i,r,t),void this.updateMinDistance(t,!1))))},nearestLocations:function(){return this.computeMinDistance(),this.minDistanceLocation},updateMinDistance:function(t,e){return null===t[0]?null:void(e?(this.minDistanceLocation[0]=t[1],this.minDistanceLocation[1]=t[0]):(this.minDistanceLocation[0]=t[0],this.minDistanceLocation[1]=t[1]))},nearestPoints:function(){return this.computeMinDistance(),[this.minDistanceLocation[0].getCoordinate(),this.minDistanceLocation[1].getCoordinate()]},computeMinDistance:function(){if(0===arguments.length){if(null!==this.minDistanceLocation)return null;if(this.minDistanceLocation=new Array(2).fill(null),this.computeContainmentDistance(),this.minDistance<=this.terminateDistance)return null;this.computeFacetDistance()}else if(3===arguments.length)if(arguments[2]instanceof Array&&arguments[0]instanceof Et&&arguments[1]instanceof It){var t=arguments[0],e=arguments[1],n=arguments[2];if(t.getEnvelopeInternal().distance(e.getEnvelopeInternal())>this.minDistance)return null;for(var i=t.getCoordinates(),r=e.getCoordinate(),s=0;s<i.length-1;s++){if((f=Qt.distancePointLine(r,i[s],i[s+1]))<this.minDistance){this.minDistance=f;var o=new te(i[s],i[s+1]).closestPoint(r);n[0]=new Hi(t,s,o),n[1]=new Hi(e,0,r)}if(this.minDistance<=this.terminateDistance)return null}}else if(arguments[2]instanceof Array&&arguments[0]instanceof Et&&arguments[1]instanceof Et){var a=arguments[0],l=arguments[1],h=arguments[2];if(a.getEnvelopeInternal().distance(l.getEnvelopeInternal())>this.minDistance)return null;i=a.getCoordinates();var u=l.getCoordinates();for(s=0;s<i.length-1;s++)for(var c=0;c<u.length-1;c++){var f;if((f=Qt.distanceLineLine(i[s],i[s+1],u[c],u[c+1]))<this.minDistance){this.minDistance=f;var d=new te(i[s],i[s+1]),g=new te(u[c],u[c+1]),p=d.closestPoints(g);h[0]=new Hi(a,s,p[0]),h[1]=new Hi(l,c,p[1])}if(this.minDistance<=this.terminateDistance)return null}}},computeMinDistancePoints:function(t,e,n){for(var i=0;i<t.size();i++)for(var r=t.get(i),s=0;s<e.size();s++){var o=e.get(s),a=r.getCoordinate().distance(o.getCoordinate());if(a<this.minDistance&&(this.minDistance=a,n[0]=new Hi(r,0,r.getCoordinate()),n[1]=new Hi(o,0,o.getCoordinate())),this.minDistance<=this.terminateDistance)return null}},distance:function(){if(null===this.geom[0]||null===this.geom[1])throw new i("null geometries are not supported");return this.geom[0].isEmpty()||this.geom[1].isEmpty()?0:(this.computeMinDistance(),this.minDistance)},computeMinDistanceLines:function(t,e,n){for(var i=0;i<t.size();i++)for(var r=t.get(i),s=0;s<e.size();s++){var o=e.get(s);if(this.computeMinDistance(r,o,n),this.minDistance<=this.terminateDistance)return null}},interfaces_:function(){return[]},getClass:function(){return Ki}}),Ki.distance=function(t,e){return new Ki(t,e).distance()},Ki.isWithinDistance=function(t,e,n){return new Ki(t,e,n).distance()<=n},Ki.nearestPoints=function(t,e){return new Ki(t,e).nearestPoints()};var ho=Object.freeze({DistanceOp:Ki});e(Ji.prototype,{getCoordinates:function(){if(null===this.coordinates){for(var t=0,e=0,n=new b,i=this.directedEdges.iterator();i.hasNext();){var r=i.next();r.getEdgeDirection()?t++:e++,n.add(r.getEdge().getLine().getCoordinates(),!1,r.getEdgeDirection())}this.coordinates=n.toCoordinateArray(),e>t&&j.reverse(this.coordinates)}return this.coordinates},toLineString:function(){return this.factory.createLineString(this.getCoordinates())},add:function(t){this.directedEdges.add(t)},interfaces_:function(){return[]},getClass:function(){return Ji}}),e(Qi.prototype,{setVisited:function(t){this._isVisited=t},isMarked:function(){return this._isMarked},setData:function(t){this.data=t},getData:function(){return this.data},setMarked:function(t){this._isMarked=t},getContext:function(){return this.data},isVisited:function(){return this._isVisited},setContext:function(t){this.data=t},interfaces_:function(){return[]},getClass:function(){return Qi}}),Qi.getComponentWithVisitedState=function(t,e){for(;t.hasNext();){var n=t.next();if(n.isVisited()===e)return n}return null},Qi.setVisited=function(t,e){for(;t.hasNext();)t.next().setVisited(e)},Qi.setMarked=function(t,e){for(;t.hasNext();)t.next().setMarked(e)},u(tr,Qi),e(tr.prototype,{isRemoved:function(){return null===this.parentEdge},compareDirection:function(t){return this.quadrant>t.quadrant?1:this.quadrant<t.quadrant?-1:Qt.computeOrientation(t.p0,t.p1,this.p1)},getCoordinate:function(){return this.from.getCoordinate()},print:function(t){var e=this.getClass().getName(),n=e.lastIndexOf("."),i=e.substring(n+1);t.print("  "+i+": "+this.p0+" - "+this.p1+" "+this.quadrant+":"+this.angle)},getDirectionPt:function(){return this.p1},getAngle:function(){return this.angle},compareTo:function(t){var e=t;return this.compareDirection(e)},getFromNode:function(){return this.from},getSym:function(){return this.sym},setEdge:function(t){this.parentEdge=t},remove:function(){this.sym=null,this.parentEdge=null},getEdge:function(){return this.parentEdge},getQuadrant:function(){return this.quadrant},setSym:function(t){this.sym=t},getToNode:function(){return this.to},getEdgeDirection:function(){return this.edgeDirection},interfaces_:function(){return[s]},getClass:function(){return tr}}),tr.toEdges=function(t){for(var e=new _,n=t.iterator();n.hasNext();)e.add(n.next().parentEdge);return e},u(er,tr),e(er.prototype,{getNext:function(){return 2!==this.getToNode().getDegree()?null:this.getToNode().getOutEdges().getEdges().get(0)===this.getSym()?this.getToNode().getOutEdges().getEdges().get(1):(f.isTrue(this.getToNode().getOutEdges().getEdges().get(1)===this.getSym()),this.getToNode().getOutEdges().getEdges().get(0))},interfaces_:function(){return[]},getClass:function(){return er}}),u(nr,Qi),e(nr.prototype,{isRemoved:function(){return null===this.dirEdge},setDirectedEdges:function(t,e){this.dirEdge=[t,e],t.setEdge(this),e.setEdge(this),t.setSym(e),e.setSym(t),t.getFromNode().addOutEdge(t),e.getFromNode().addOutEdge(e)},getDirEdge:function(){if(Number.isInteger(arguments[0])){var t=arguments[0];return this.dirEdge[t]}if(arguments[0]instanceof rr){var e=arguments[0];return this.dirEdge[0].getFromNode()===e?this.dirEdge[0]:this.dirEdge[1].getFromNode()===e?this.dirEdge[1]:null}},remove:function(){this.dirEdge=null},getOppositeNode:function(t){return this.dirEdge[0].getFromNode()===t?this.dirEdge[0].getToNode():this.dirEdge[1].getFromNode()===t?this.dirEdge[1].getToNode():null},interfaces_:function(){return[]},getClass:function(){return nr}}),e(ir.prototype,{getNextEdge:function(t){var e=this.getIndex(t);return this.outEdges.get(this.getIndex(e+1))},getCoordinate:function(){var t=this.iterator();return t.hasNext()?t.next().getCoordinate():null},iterator:function(){return this.sortEdges(),this.outEdges.iterator()},sortEdges:function(){this.sorted||(Zs.sort(this.outEdges),this.sorted=!0)},remove:function(t){this.outEdges.remove(t)},getEdges:function(){return this.sortEdges(),this.outEdges},getNextCWEdge:function(t){var e=this.getIndex(t);return this.outEdges.get(this.getIndex(e-1))},getIndex:function(){if(arguments[0]instanceof nr){var t=arguments[0];this.sortEdges();for(var e=0;e<this.outEdges.size();e++)if(this.outEdges.get(e).getEdge()===t)return e;return-1}if(arguments[0]instanceof tr){var n=arguments[0];for(this.sortEdges(),e=0;e<this.outEdges.size();e++)if(this.outEdges.get(e)===n)return e;return-1}if(Number.isInteger(arguments[0])){var i=arguments[0]%this.outEdges.size();return 0>i&&(i+=this.outEdges.size()),i}},add:function(t){this.outEdges.add(t),this.sorted=!1},getDegree:function(){return this.outEdges.size()},interfaces_:function(){return[]},getClass:function(){return ir}}),u(rr,Qi),e(rr.prototype,{isRemoved:function(){return null===this.pt},addOutEdge:function(t){this.deStar.add(t)},getCoordinate:function(){return this.pt},getOutEdges:function(){return this.deStar},remove:function(){if(0===arguments.length)this.pt=null;else if(1===arguments.length){var t=arguments[0];this.deStar.remove(t)}},getIndex:function(t){return this.deStar.getIndex(t)},getDegree:function(){return this.deStar.getDegree()},interfaces_:function(){return[]},getClass:function(){return rr}}),rr.getEdgesBetween=function(t,e){var n=new J(tr.toEdges(t.getOutEdges().getEdges())),i=tr.toEdges(e.getOutEdges().getEdges());return n.retainAll(i),n},u(sr,nr),e(sr.prototype,{getLine:function(){return this.line},interfaces_:function(){return[]},getClass:function(){return sr}}),e(or.prototype,{find:function(t){return this.nodeMap.get(t)},iterator:function(){return this.nodeMap.values().iterator()},remove:function(t){return this.nodeMap.remove(t)},values:function(){return this.nodeMap.values()},add:function(t){return this.nodeMap.put(t.getCoordinate(),t),t},interfaces_:function(){return[]},getClass:function(){return or}}),e(ar.prototype,{findNodesOfDegree:function(t){for(var e=new _,n=this.nodeIterator();n.hasNext();){var i=n.next();i.getDegree()===t&&e.add(i)}return e},dirEdgeIterator:function(){return this.dirEdges.iterator()},edgeIterator:function(){return this.edges.iterator()},remove:function(){if(arguments[0]instanceof nr){var t=arguments[0];this.remove(t.getDirEdge(0)),this.remove(t.getDirEdge(1)),this.edges.remove(t),t.remove()}else if(arguments[0]instanceof tr){var e=arguments[0];null!==(r=e.getSym())&&r.setSym(null),e.getFromNode().remove(e),e.remove(),this.dirEdges.remove(e)}else if(arguments[0]instanceof rr){for(var n=arguments[0],i=n.getOutEdges().getEdges().iterator();i.hasNext();){var r,s=i.next();null!==(r=s.getSym())&&this.remove(r),this.dirEdges.remove(s);var o=s.getEdge();null!==o&&this.edges.remove(o)}this.nodeMap.remove(n.getCoordinate()),n.remove()}},findNode:function(t){return this.nodeMap.find(t)},getEdges:function(){return this.edges},nodeIterator:function(){return this.nodeMap.iterator()},contains:function(){if(arguments[0]instanceof nr){var t=arguments[0];return this.edges.contains(t)}if(arguments[0]instanceof tr){var e=arguments[0];return this.dirEdges.contains(e)}},add:function(){if(arguments[0]instanceof rr){var t=arguments[0];this.nodeMap.add(t)}else if(arguments[0]instanceof nr){var e=arguments[0];this.edges.add(e),this.add(e.getDirEdge(0)),this.add(e.getDirEdge(1))}else if(arguments[0]instanceof tr){var n=arguments[0];this.dirEdges.add(n)}},getNodes:function(){return this.nodeMap.values()},interfaces_:function(){return[]},getClass:function(){return ar}}),u(lr,ar),e(lr.prototype,{addEdge:function(t){if(t.isEmpty())return null;var e=j.removeRepeatedPoints(t.getCoordinates());if(e.length<=1)return null;var n=e[0],i=e[e.length-1],r=this.getNode(n),s=this.getNode(i),o=new er(r,s,e[1],!0),a=new er(s,r,e[e.length-2],!1),l=new sr(t);l.setDirectedEdges(o,a),this.add(l)},getNode:function(t){var e=this.findNode(t);return null===e&&(e=new rr(t),this.add(e)),e},interfaces_:function(){return[]},getClass:function(){return lr}}),e(hr.prototype,{buildEdgeStringsForUnprocessedNodes:function(){for(var t=this.graph.getNodes().iterator();t.hasNext();){var e=t.next();e.isMarked()||(f.isTrue(2===e.getDegree()),this.buildEdgeStringsStartingAt(e),e.setMarked(!0))}},buildEdgeStringsForNonDegree2Nodes:function(){for(var t=this.graph.getNodes().iterator();t.hasNext();){var e=t.next();2!==e.getDegree()&&(this.buildEdgeStringsStartingAt(e),e.setMarked(!0))}},buildEdgeStringsForObviousStartNodes:function(){this.buildEdgeStringsForNonDegree2Nodes()},getMergedLineStrings:function(){return this.merge(),this.mergedLineStrings},buildEdgeStringsStartingAt:function(t){for(var e=t.getOutEdges().iterator();e.hasNext();){var n=e.next();n.getEdge().isMarked()||this.edgeStrings.add(this.buildEdgeStringStartingWith(n))}},merge:function(){if(null!==this.mergedLineStrings)return null;Qi.setMarked(this.graph.nodeIterator(),!1),Qi.setMarked(this.graph.edgeIterator(),!1),this.edgeStrings=new _,this.buildEdgeStringsForObviousStartNodes(),this.buildEdgeStringsForIsolatedLoops(),this.mergedLineStrings=new _;for(var t=this.edgeStrings.iterator();t.hasNext();){var e=t.next();this.mergedLineStrings.add(e.toLineString())}},buildEdgeStringStartingWith:function(t){var e=new Ji(this.factory),n=t;do{e.add(n),n.getEdge().setMarked(!0),n=n.getNext()}while(null!==n&&n!==t);return e},add:function(){if(arguments[0]instanceof G)arguments[0].apply({interfaces_:function(){return[z]},filter:function(t){t instanceof Et&&this.add(t)}});else if(M(arguments[0],m)){var t=arguments[0];this.mergedLineStrings=null;for(var e=t.iterator();e.hasNext();){var n=e.next();this.add(n)}}else if(arguments[0]instanceof Et){var i=arguments[0];null===this.factory&&(this.factory=i.getFactory()),this.graph.addEdge(i)}},buildEdgeStringsForIsolatedLoops:function(){this.buildEdgeStringsForUnprocessedNodes()},interfaces_:function(){return[]},getClass:function(){return hr}});var uo=Object.freeze({LineMerger:hr}),co=Object.freeze({OverlayOp:Xn});u(ur,tr),e(ur.prototype,{getNext:function(){return this.next},isInRing:function(){return null!==this.edgeRing},setRing:function(t){this.edgeRing=t},setLabel:function(t){this.label=t},getLabel:function(){return this.label},setNext:function(t){this.next=t},getRing:function(){return this.edgeRing},interfaces_:function(){return[]},getClass:function(){return ur}}),u(cr,nr),e(cr.prototype,{getLine:function(){return this.line},interfaces_:function(){return[]},getClass:function(){return cr}}),e(fr.prototype,{isIncluded:function(){return this._isIncluded},getCoordinates:function(){if(null===this.ringPts){for(var t=new b,e=this.deList.iterator();e.hasNext();){var n=e.next(),i=n.getEdge();fr.addEdge(i.getLine().getCoordinates(),n.getEdgeDirection(),t)}this.ringPts=t.toCoordinateArray()}return this.ringPts},isIncludedSet:function(){return this._isIncludedSet},isValid:function(){return this.getCoordinates(),!(this.ringPts.length<=3)&&(this.getRing(),this.ring.isValid())},build:function(t){var e=t;do{this.add(e),e.setRing(this),e=e.getNext(),f.isTrue(null!==e,"found null DE in ring"),f.isTrue(e===t||!e.isInRing(),"found DE already in ring")}while(e!==t)},isOuterHole:function(){return!!this._isHole&&!this.hasShell()},getPolygon:function(){var t=null;if(null!==this.holes){t=new Array(this.holes.size()).fill(null);for(var e=0;e<this.holes.size();e++)t[e]=this.holes.get(e)}return this.factory.createPolygon(this.ring,t)},isHole:function(){return this._isHole},isProcessed:function(){return this._isProcessed},addHole:function(){if(arguments[0]instanceof Pt){var t=arguments[0];null===this.holes&&(this.holes=new _),this.holes.add(t)}else if(arguments[0]instanceof fr){var e=arguments[0];e.setShell(this);var n=e.getRing();null===this.holes&&(this.holes=new _),this.holes.add(n)}},setIncluded:function(t){this._isIncluded=t,this._isIncludedSet=!0},getOuterHole:function(){if(this.isHole())return null;for(var t=0;t<this.deList.size();t++){var e=this.deList.get(t).getSym().getRing();if(e.isOuterHole())return e}return null},computeHole:function(){var t=this.getRing();this._isHole=Qt.isCCW(t.getCoordinates())},hasShell:function(){return null!==this.shell},isOuterShell:function(){return null!==this.getOuterHole()},getLineString:function(){return this.getCoordinates(),this.factory.createLineString(this.ringPts)},toString:function(){return Ht.toLineString(new Dt(this.getCoordinates()))},getShell:function(){return this.isHole()?this.shell:this},add:function(t){this.deList.add(t)},getRing:function(){if(null!==this.ring)return this.ring;this.getCoordinates(),this.ringPts.length<3&&O.out.println(this.ringPts);try{this.ring=this.factory.createLinearRing(this.ringPts)}catch(t){if(!(t instanceof S))throw t;O.out.println(this.ringPts)}return this.ring},updateIncluded:function(){if(this.isHole())return null;for(var t=0;t<this.deList.size();t++){var e=this.deList.get(t).getSym().getRing().getShell();if(null!==e&&e.isIncludedSet())return this.setIncluded(!e.isIncluded()),null}},setShell:function(t){this.shell=t},setProcessed:function(t){this._isProcessed=t},interfaces_:function(){return[]},getClass:function(){return fr}}),fr.findDirEdgesInRing=function(t){var e=t,n=new _;do{n.add(e),e=e.getNext(),f.isTrue(null!==e,"found null DE in ring"),f.isTrue(e===t||!e.isInRing(),"found DE already in ring")}while(e!==t);return n},fr.addEdge=function(t,e,n){if(e)for(var i=0;i<t.length;i++)n.add(t[i],!1);else for(i=t.length-1;i>=0;i--)n.add(t[i],!1)},fr.findEdgeRingContaining=function(t,e){for(var n=t.getRing(),i=n.getEnvelopeInternal(),r=n.getCoordinateN(0),s=null,o=null,a=e.iterator();a.hasNext();){var l=a.next(),h=l.getRing(),u=h.getEnvelopeInternal();if(!u.equals(i)&&u.contains(i)){r=j.ptNotInList(n.getCoordinates(),h.getCoordinates());var c=!1;Qt.isPointInRing(r,h.getCoordinates())&&(c=!0),c&&(null===s||o.contains(u))&&(o=(s=l).getRing().getEnvelopeInternal())}}return s},e(dr.prototype,{compare:function(t,e){var n=e;return t.getRing().getEnvelope().compareTo(n.getRing().getEnvelope())},interfaces_:function(){return[a]},getClass:function(){return dr}}),fr.EnvelopeComparator=dr,u(gr,ar),e(gr.prototype,{findEdgeRing:function(t){var e=new fr(this.factory);return e.build(t),e},computeDepthParity:function(){if(0===arguments.length)for(;;){return null}},computeNextCWEdges:function(){for(var t=this.nodeIterator();t.hasNext();){var e=t.next();gr.computeNextCWEdges(e)}},addEdge:function(t){if(t.isEmpty())return null;var e=j.removeRepeatedPoints(t.getCoordinates());if(e.length<2)return null;var n=e[0],i=e[e.length-1],r=this.getNode(n),s=this.getNode(i),o=new ur(r,s,e[1],!0),a=new ur(s,r,e[e.length-2],!1),l=new cr(t);l.setDirectedEdges(o,a),this.add(l)},deleteCutEdges:function(){this.computeNextCWEdges(),gr.findLabeledEdgeRings(this.dirEdges);for(var t=new _,e=this.dirEdges.iterator();e.hasNext();){var n=e.next();if(!n.isMarked()){var i=n.getSym();if(n.getLabel()===i.getLabel()){n.setMarked(!0),i.setMarked(!0);var r=n.getEdge();t.add(r.getLine())}}}return t},getEdgeRings:function(){this.computeNextCWEdges(),gr.label(this.dirEdges,-1);var t=gr.findLabeledEdgeRings(this.dirEdges);this.convertMaximalToMinimalEdgeRings(t);for(var e=new _,n=this.dirEdges.iterator();n.hasNext();){var i=n.next();if(!i.isMarked()&&!i.isInRing()){var r=this.findEdgeRing(i);e.add(r)}}return e},getNode:function(t){var e=this.findNode(t);return null===e&&(e=new rr(t),this.add(e)),e},convertMaximalToMinimalEdgeRings:function(t){for(var e=t.iterator();e.hasNext();){var n=e.next(),i=n.getLabel(),r=gr.findIntersectionNodes(n,i);if(null!==r)for(var s=r.iterator();s.hasNext();){var o=s.next();gr.computeNextCCWEdges(o,i)}}},deleteDangles:function(){for(var t=this.findNodesOfDegree(1),e=new J,n=new re,i=t.iterator();i.hasNext();)n.push(i.next());for(;!n.isEmpty();){var r=n.pop();for(gr.deleteAllEdges(r),i=r.getOutEdges().getEdges().iterator();i.hasNext();){var s=i.next();s.setMarked(!0);var o=s.getSym();null!==o&&o.setMarked(!0);var a=s.getEdge();e.add(a.getLine());var l=s.getToNode();1===gr.getDegreeNonDeleted(l)&&n.push(l)}}return e},interfaces_:function(){return[]},getClass:function(){return gr}}),gr.findLabeledEdgeRings=function(t){for(var e=new _,n=1,i=t.iterator();i.hasNext();){var r=i.next();if(!(r.isMarked()||r.getLabel()>=0)){e.add(r);var s=fr.findDirEdgesInRing(r);gr.label(s,n),n++}}return e},gr.getDegreeNonDeleted=function(t){for(var e=0,n=t.getOutEdges().getEdges().iterator();n.hasNext();)n.next().isMarked()||e++;return e},gr.deleteAllEdges=function(t){for(var e=t.getOutEdges().getEdges().iterator();e.hasNext();){var n=e.next();n.setMarked(!0);var i=n.getSym();null!==i&&i.setMarked(!0)}},gr.label=function(t,e){for(var n=t.iterator();n.hasNext();)n.next().setLabel(e)},gr.computeNextCWEdges=function(t){for(var e=null,n=null,i=t.getOutEdges().getEdges().iterator();i.hasNext();){var r=i.next();r.isMarked()||(null===e&&(e=r),null!==n&&n.getSym().setNext(r),n=r)}null!==n&&n.getSym().setNext(e)},gr.computeNextCCWEdges=function(t,e){for(var n=null,i=null,r=t.getOutEdges().getEdges(),s=r.size()-1;s>=0;s--){var o=r.get(s),a=o.getSym(),l=null;o.getLabel()===e&&(l=o);var h=null;a.getLabel()===e&&(h=a),null===l&&null===h||(null!==h&&(i=h),null!==l&&(null!==i&&(i.setNext(l),i=null),null===n&&(n=l)))}null!==i&&(f.isTrue(null!==n),i.setNext(n))},gr.getDegree=function(t,e){for(var n=0,i=t.getOutEdges().getEdges().iterator();i.hasNext();)i.next().getLabel()===e&&n++;return n},gr.findIntersectionNodes=function(t,e){var n=t,i=null;do{var r=n.getFromNode();gr.getDegree(r,e)>1&&(null===i&&(i=new _),i.add(r)),n=n.getNext(),f.isTrue(null!==n,"found null DE in ring"),f.isTrue(n===t||!n.isInRing(),"found DE already in ring")}while(n!==t);return i},e(pr.prototype,{getGeometry:function(){return null===this.geomFactory&&(this.geomFactory=new jt),this.polygonize(),this.extractOnlyPolygonal?this.geomFactory.buildGeometry(this.polyList):this.geomFactory.createGeometryCollection(jt.toGeometryArray(this.polyList))},getInvalidRingLines:function(){return this.polygonize(),this.invalidRingLines},findValidRings:function(t,e,n){for(var i=t.iterator();i.hasNext();){var r=i.next();r.isValid()?e.add(r):n.add(r.getLineString())}},polygonize:function(){if(null!==this.polyList)return null;if(this.polyList=new _,null===this.graph)return null;this.dangles=this.graph.deleteDangles(),this.cutEdges=this.graph.deleteCutEdges();var t=this.graph.getEdgeRings(),e=new _;this.invalidRingLines=new _,this.isCheckingRingsValid?this.findValidRings(t,e,this.invalidRingLines):e=t,this.findShellsAndHoles(e),pr.assignHolesToShells(this.holeList,this.shellList),Zs.sort(this.shellList,new fr.EnvelopeComparator);var n=!0;this.extractOnlyPolygonal&&(pr.findDisjointShells(this.shellList),n=!1),this.polyList=pr.extractPolygons(this.shellList,n)},getDangles:function(){return this.polygonize(),this.dangles},getCutEdges:function(){return this.polygonize(),this.cutEdges},getPolygons:function(){return this.polygonize(),this.polyList},add:function(){if(M(arguments[0],m))for(var t=arguments[0].iterator();t.hasNext();){var e=t.next();this.add(e)}else if(arguments[0]instanceof Et){var n=arguments[0];this.geomFactory=n.getFactory(),null===this.graph&&(this.graph=new gr(this.geomFactory)),this.graph.addEdge(n)}else arguments[0]instanceof G&&arguments[0].apply(this.lineStringAdder)},setCheckRingsValid:function(t){this.isCheckingRingsValid=t},findShellsAndHoles:function(t){this.holeList=new _,this.shellList=new _;for(var e=t.iterator();e.hasNext();){var n=e.next();n.computeHole(),n.isHole()?this.holeList.add(n):this.shellList.add(n)}},interfaces_:function(){return[]},getClass:function(){return pr}}),pr.findOuterShells=function(t){for(var e=t.iterator();e.hasNext();){var n=e.next(),i=n.getOuterHole();null===i||i.isProcessed()||(n.setIncluded(!0),i.setProcessed(!0))}},pr.extractPolygons=function(t,e){for(var n=new _,i=t.iterator();i.hasNext();){var r=i.next();(e||r.isIncluded())&&n.add(r.getPolygon())}return n},pr.assignHolesToShells=function(t,e){for(var n=t.iterator();n.hasNext();){var i=n.next();pr.assignHoleToShell(i,e)}},pr.assignHoleToShell=function(t,e){var n=fr.findEdgeRingContaining(t,e);null!==n&&n.addHole(t)},pr.findDisjointShells=function(t){pr.findOuterShells(t);var e=null;do{e=!1;for(var n=t.iterator();n.hasNext();){var i=n.next();i.isIncludedSet()||(i.updateIncluded(),i.isIncludedSet()||(e=!0))}}while(e)},e(mr.prototype,{filter:function(t){t instanceof Et&&this.p.add(t)},interfaces_:function(){return[z]},getClass:function(){return mr}}),pr.LineStringAdder=mr;var fo=Object.freeze({Polygonizer:pr});e(yr.prototype,{createEdgeEndForNext:function(t,e,n,i){var r=n.segmentIndex+1;if(r>=t.getNumPoints()&&null===i)return null;var s=t.getCoordinate(r);null!==i&&i.segmentIndex===n.segmentIndex&&(s=i.coord);var o=new ln(t,n.coord,s,new tn(t.getLabel()));e.add(o)},createEdgeEndForPrev:function(t,e,n,i){var r=n.segmentIndex;if(0===n.dist){if(0===r)return null;r--}var s=t.getCoordinate(r);null!==i&&i.segmentIndex>=r&&(s=i.coord);var o=new tn(t.getLabel());o.flip();var a=new ln(t,n.coord,s,o);e.add(a)},computeEdgeEnds:function(){if(1===arguments.length){for(var t=arguments[0],e=new _,n=t;n.hasNext();){var i=n.next();this.computeEdgeEnds(i,e)}return e}if(2===arguments.length){var r=arguments[0],s=arguments[1],o=r.getEdgeIntersectionList();o.addEndpoints();var a=o.iterator(),l=null,h=null;if(!a.hasNext())return null;var u=a.next();do{l=h,h=u,u=null,a.hasNext()&&(u=a.next()),null!==h&&(this.createEdgeEndForPrev(r,s,h,l),this.createEdgeEndForNext(r,s,h,u))}while(null!==h)}},interfaces_:function(){return[]},getClass:function(){return yr}}),u(vr,ln),e(vr.prototype,{insert:function(t){this.edgeEnds.add(t)},print:function(t){t.println("EdgeEndBundle--\x3e Label: "+this.label);for(var e=this.iterator();e.hasNext();)e.next().print(t),t.println()},iterator:function(){return this.edgeEnds.iterator()},getEdgeEnds:function(){return this.edgeEnds},computeLabelOn:function(t,e){for(var n=0,i=!1,r=this.iterator();r.hasNext();)(s=r.next().getLabel().getLocation(t))===C.BOUNDARY&&n++,s===C.INTERIOR&&(i=!0);var s=C.NONE;i&&(s=C.INTERIOR),n>0&&(s=Un.determineBoundary(e,n)),this.label.setLocation(t,s)},computeLabelSide:function(t,e){for(var n=this.iterator();n.hasNext();){var i=n.next();if(i.getLabel().isArea()){var r=i.getLabel().getLocation(t,e);if(r===C.INTERIOR)return this.label.setLocation(t,e,C.INTERIOR),null;r===C.EXTERIOR&&this.label.setLocation(t,e,C.EXTERIOR)}}},getLabel:function(){return this.label},computeLabelSides:function(t){this.computeLabelSide(t,Je.LEFT),this.computeLabelSide(t,Je.RIGHT)},updateIM:function(t){Bn.updateIM(this.label,t)},computeLabel:function(t){for(var e=!1,n=this.iterator();n.hasNext();)n.next().getLabel().isArea()&&(e=!0);this.label=e?new tn(C.NONE,C.NONE,C.NONE):new tn(C.NONE);for(var i=0;2>i;i++)this.computeLabelOn(i,t),e&&this.computeLabelSides(i)},interfaces_:function(){return[]},getClass:function(){return vr}}),u(wr,yn),e(wr.prototype,{updateIM:function(t){for(var e=this.iterator();e.hasNext();)e.next().updateIM(t)},insert:function(t){var e=this.edgeMap.get(t);null===e?(e=new vr(t),this.insertEdgeEnd(t,e)):e.insert(t)},interfaces_:function(){return[]},getClass:function(){return wr}}),u(xr,on),e(xr.prototype,{updateIMFromEdges:function(t){this.edges.updateIM(t)},computeIM:function(t){t.setAtLeastIfValid(this.label.getLocation(0),this.label.getLocation(1),0)},interfaces_:function(){return[]},getClass:function(){return xr}}),u(_r,un),e(_r.prototype,{createNode:function(t){return new xr(t,new wr)},interfaces_:function(){return[]},getClass:function(){return _r}}),e(br.prototype,{insertEdgeEnds:function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();this.nodes.add(n)}},computeProperIntersectionIM:function(t,e){var n=this.arg[0].getGeometry().getDimension(),i=this.arg[1].getGeometry().getDimension(),r=t.hasProperIntersection(),s=t.hasProperInteriorIntersection();2===n&&2===i?r&&e.setAtLeast("212101212"):2===n&&1===i?(r&&e.setAtLeast("FFF0FFFF2"),s&&e.setAtLeast("1FFFFF1FF")):1===n&&2===i?(r&&e.setAtLeast("F0FFFFFF2"),s&&e.setAtLeast("1F1FFFFFF")):1===n&&1===i&&s&&e.setAtLeast("0FFFFFFFF")},labelIsolatedEdges:function(t,e){for(var n=this.arg[t].getEdgeIterator();n.hasNext();){var i=n.next();i.isIsolated()&&(this.labelIsolatedEdge(i,e,this.arg[e].getGeometry()),this.isolatedEdges.add(i))}},labelIsolatedEdge:function(t,e,n){if(n.getDimension()>0){var i=this.ptLocator.locate(t.getCoordinate(),n);t.getLabel().setAllLocations(e,i)}else t.getLabel().setAllLocations(e,C.EXTERIOR)},computeIM:function(){var t=new ee;if(t.set(C.EXTERIOR,C.EXTERIOR,2),!this.arg[0].getGeometry().getEnvelopeInternal().intersects(this.arg[1].getGeometry().getEnvelopeInternal()))return this.computeDisjointIM(t),t;this.arg[0].computeSelfNodes(this.li,!1),this.arg[1].computeSelfNodes(this.li,!1);var e=this.arg[0].computeEdgeIntersections(this.arg[1],this.li,!1);this.computeIntersectionNodes(0),this.computeIntersectionNodes(1),this.copyNodesAndLabels(0),this.copyNodesAndLabels(1),this.labelIsolatedNodes(),this.computeProperIntersectionIM(e,t);var n=new yr,i=n.computeEdgeEnds(this.arg[0].getEdgeIterator());this.insertEdgeEnds(i);var r=n.computeEdgeEnds(this.arg[1].getEdgeIterator());return this.insertEdgeEnds(r),this.labelNodeEdges(),this.labelIsolatedEdges(0,1),this.labelIsolatedEdges(1,0),this.updateIM(t),t},labelNodeEdges:function(){for(var t=this.nodes.iterator();t.hasNext();)t.next().getEdges().computeLabelling(this.arg)},copyNodesAndLabels:function(t){for(var e=this.arg[t].getNodeIterator();e.hasNext();){var n=e.next();this.nodes.addNode(n.getCoordinate()).setLabel(t,n.getLabel().getLocation(t))}},labelIntersectionNodes:function(t){for(var e=this.arg[t].getEdgeIterator();e.hasNext();)for(var n=e.next(),i=n.getLabel().getLocation(t),r=n.getEdgeIntersectionList().iterator();r.hasNext();){var s=r.next(),o=this.nodes.find(s.coord);o.getLabel().isNull(t)&&(i===C.BOUNDARY?o.setLabelBoundary(t):o.setLabel(t,C.INTERIOR))}},labelIsolatedNode:function(t,e){var n=this.ptLocator.locate(t.getCoordinate(),this.arg[e].getGeometry());t.getLabel().setAllLocations(e,n)},computeIntersectionNodes:function(t){for(var e=this.arg[t].getEdgeIterator();e.hasNext();)for(var n=e.next(),i=n.getLabel().getLocation(t),r=n.getEdgeIntersectionList().iterator();r.hasNext();){var s=r.next(),o=this.nodes.addNode(s.coord);i===C.BOUNDARY?o.setLabelBoundary(t):o.getLabel().isNull(t)&&o.setLabel(t,C.INTERIOR)}},labelIsolatedNodes:function(){for(var t=this.nodes.iterator();t.hasNext();){var e=t.next(),n=e.getLabel();f.isTrue(n.getGeometryCount()>0,"node with empty label found"),e.isIsolated()&&(n.isNull(0)?this.labelIsolatedNode(e,0):this.labelIsolatedNode(e,1))}},updateIM:function(t){for(var e=this.isolatedEdges.iterator();e.hasNext();)e.next().updateIM(t);for(var n=this.nodes.iterator();n.hasNext();){var i=n.next();i.updateIM(t),i.updateIMFromEdges(t)}},computeDisjointIM:function(t){var e=this.arg[0].getGeometry();e.isEmpty()||(t.set(C.INTERIOR,C.EXTERIOR,e.getDimension()),t.set(C.BOUNDARY,C.EXTERIOR,e.getBoundaryDimension()));var n=this.arg[1].getGeometry();n.isEmpty()||(t.set(C.EXTERIOR,C.INTERIOR,n.getDimension()),t.set(C.EXTERIOR,C.BOUNDARY,n.getBoundaryDimension()))},interfaces_:function(){return[]},getClass:function(){return br}}),e(Er.prototype,{isContainedInBoundary:function(t){if(t instanceof Mt)return!1;if(t instanceof It)return this.isPointContainedInBoundary(t);if(t instanceof Et)return this.isLineStringContainedInBoundary(t);for(var e=0;e<t.getNumGeometries();e++){var n=t.getGeometryN(e);if(!this.isContainedInBoundary(n))return!1}return!0},isLineSegmentContainedInBoundary:function(t,e){if(t.equals(e))return this.isPointContainedInBoundary(t);if(t.x===e.x){if(t.x===this.rectEnv.getMinX()||t.x===this.rectEnv.getMaxX())return!0}else if(t.y===e.y&&(t.y===this.rectEnv.getMinY()||t.y===this.rectEnv.getMaxY()))return!0;return!1},isLineStringContainedInBoundary:function(t){for(var e=t.getCoordinateSequence(),n=new d,i=new d,r=0;r<e.size()-1;r++)if(e.getCoordinate(r,n),e.getCoordinate(r+1,i),!this.isLineSegmentContainedInBoundary(n,i))return!1;return!0},isPointContainedInBoundary:function(){if(arguments[0]instanceof It){var t=arguments[0];return this.isPointContainedInBoundary(t.getCoordinate())}if(arguments[0]instanceof d){var e=arguments[0];return e.x===this.rectEnv.getMinX()||e.x===this.rectEnv.getMaxX()||e.y===this.rectEnv.getMinY()||e.y===this.rectEnv.getMaxY()}},contains:function(t){return!!this.rectEnv.contains(t.getEnvelopeInternal())&&!this.isContainedInBoundary(t)},interfaces_:function(){return[]},getClass:function(){return Er}}),Er.contains=function(t,e){return new Er(t).contains(e)},e(Sr.prototype,{intersects:function(t,e){var n=new E(t,e);if(!this.rectEnv.intersects(n))return!1;if(this.rectEnv.intersects(t))return!0;if(this.rectEnv.intersects(e))return!0;if(t.compareTo(e)>0){var i=t;t=e,e=i}var r=!1;return e.y>t.y&&(r=!0),r?this.li.computeIntersection(t,e,this.diagDown0,this.diagDown1):this.li.computeIntersection(t,e,this.diagUp0,this.diagUp1),!!this.li.hasIntersection()},interfaces_:function(){return[]},getClass:function(){return Sr}}),e(Ir.prototype,{applyTo:function(t){for(var e=0;e<t.getNumGeometries()&&!this._isDone;e++){var n=t.getGeometryN(e);if(n instanceof ft)this.applyTo(n);else if(this.visit(n),this.isDone())return this._isDone=!0,null}},interfaces_:function(){return[]},getClass:function(){return Ir}}),e(Cr.prototype,{intersects:function(t){if(!this.rectEnv.intersects(t.getEnvelopeInternal()))return!1;var e=new Mr(this.rectEnv);if(e.applyTo(t),e.intersects())return!0;var n=new Rr(this.rectangle);if(n.applyTo(t),n.containsPoint())return!0;var i=new Pr(this.rectangle);return i.applyTo(t),!!i.intersects()},interfaces_:function(){return[]},getClass:function(){return Cr}}),Cr.intersects=function(t,e){return new Cr(t).intersects(e)},u(Mr,Ir),e(Mr.prototype,{isDone:function(){return!0===this._intersects},visit:function(t){var e=t.getEnvelopeInternal();return this.rectEnv.intersects(e)?this.rectEnv.contains(e)||e.getMinX()>=this.rectEnv.getMinX()&&e.getMaxX()<=this.rectEnv.getMaxX()||e.getMinY()>=this.rectEnv.getMinY()&&e.getMaxY()<=this.rectEnv.getMaxY()?(this._intersects=!0,null):void 0:null},intersects:function(){return this._intersects},interfaces_:function(){return[]},getClass:function(){return Mr}}),u(Rr,Ir),e(Rr.prototype,{isDone:function(){return!0===this._containsPoint},visit:function(t){if(!(t instanceof Mt))return null;var e=t.getEnvelopeInternal();if(!this.rectEnv.intersects(e))return null;for(var n=new d,i=0;4>i;i++)if(this.rectSeq.getCoordinate(i,n),e.contains(n)&&mn.containsPointInPolygon(n,t))return this._containsPoint=!0,null},containsPoint:function(){return this._containsPoint},interfaces_:function(){return[]},getClass:function(){return Rr}}),u(Pr,Ir),e(Pr.prototype,{intersects:function(){return this.hasIntersection},isDone:function(){return!0===this.hasIntersection},visit:function(t){var e=t.getEnvelopeInternal();if(!this.rectEnv.intersects(e))return null;var n=Tn.getLines(t);this.checkIntersectionWithLineStrings(n)},checkIntersectionWithLineStrings:function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();if(this.checkIntersectionWithSegments(n),this.hasIntersection)return null}},checkIntersectionWithSegments:function(t){for(var e=t.getCoordinateSequence(),n=1;n<e.size();n++)if(e.getCoordinate(n-1,this.p0),e.getCoordinate(n,this.p1),this.rectIntersector.intersects(this.p0,this.p1))return this.hasIntersection=!0,null},interfaces_:function(){return[]},getClass:function(){return Pr}}),u(Tr,qn),e(Tr.prototype,{getIntersectionMatrix:function(){return this._relate.computeIM()},interfaces_:function(){return[]},getClass:function(){return Tr}}),Tr.covers=function(t,e){return!!t.getEnvelopeInternal().covers(e.getEnvelopeInternal())&&(!!t.isRectangle()||Tr.relate(t,e).isCovers())},Tr.intersects=function(t,e){return!!t.getEnvelopeInternal().intersects(e.getEnvelopeInternal())&&(t.isRectangle()?Cr.intersects(t,e):e.isRectangle()?Cr.intersects(e,t):Tr.relate(t,e).isIntersects())},Tr.touches=function(t,e){return!!t.getEnvelopeInternal().intersects(e.getEnvelopeInternal())&&Tr.relate(t,e).isTouches(t.getDimension(),e.getDimension())},Tr.within=function(t,e){return e.contains(t)},Tr.coveredBy=function(t,e){return Tr.covers(e,t)},Tr.relate=function(){if(2===arguments.length)return new Tr(arguments[0],arguments[1]).getIntersectionMatrix();if(3===arguments.length){if("string"==typeof arguments[2]&&arguments[0]instanceof G&&arguments[1]instanceof G){var t=arguments[0],e=arguments[1],n=arguments[2];return Tr.relateWithCheck(t,e).matches(n)}if(M(arguments[2],U)&&arguments[0]instanceof G&&arguments[1]instanceof G)return new Tr(arguments[0],arguments[1],arguments[2]).getIntersectionMatrix()}},Tr.overlaps=function(t,e){return!!t.getEnvelopeInternal().intersects(e.getEnvelopeInternal())&&Tr.relate(t,e).isOverlaps(t.getDimension(),e.getDimension())},Tr.disjoint=function(t,e){return!t.intersects(e)},Tr.relateWithCheck=function(t,e){return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),Tr.relate(t,e)},Tr.crosses=function(t,e){return!!t.getEnvelopeInternal().intersects(e.getEnvelopeInternal())&&Tr.relate(t,e).isCrosses(t.getDimension(),e.getDimension())},Tr.contains=function(t,e){return!!t.getEnvelopeInternal().contains(e.getEnvelopeInternal())&&(t.isRectangle()?Er.contains(t,e):Tr.relate(t,e).isContains())};var go=Object.freeze({RelateOp:Tr});e(Nr.prototype,{extractElements:function(t,e){if(null===t)return null;for(var n=0;n<t.getNumGeometries();n++){var i=t.getGeometryN(n);this.skipEmpty&&i.isEmpty()||e.add(i)}},combine:function(){for(var t=new _,e=this.inputGeoms.iterator();e.hasNext();){var n=e.next();this.extractElements(n,t)}return 0===t.size()?null!==this.geomFactory?this.geomFactory.createGeometryCollection(null):null:this.geomFactory.buildGeometry(t)},interfaces_:function(){return[]},getClass:function(){return Nr}}),Nr.combine=function(){if(1===arguments.length)return new Nr(arguments[0]).combine();if(2===arguments.length){var t=arguments[0],e=arguments[1];return new Nr(Nr.createList(t,e)).combine()}if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];return new Nr(Nr.createList(n,i,r)).combine()}},Nr.extractFactory=function(t){return t.isEmpty()?null:t.iterator().next().getFactory()},Nr.createList=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return(n=new _).add(t),n.add(e),n}if(3===arguments.length){var n,i=arguments[0],r=arguments[1],s=arguments[2];return(n=new _).add(i),n.add(r),n.add(s),n}},e(Ar.prototype,{union:function(){for(var t=new ye,e=new at,n=0;n<this.pointGeom.getNumGeometries();n++){var i=this.pointGeom.getGeometryN(n).getCoordinate();t.locate(i,this.otherGeom)===C.EXTERIOR&&e.add(i)}if(0===e.size())return this.otherGeom;var r,s=j.toCoordinateArray(e);return r=1===s.length?this.geomFact.createPoint(s[0]):this.geomFact.createMultiPointFromCoords(s),Nr.combine(r,this.otherGeom)},interfaces_:function(){return[]},getClass:function(){return Ar}}),Ar.union=function(t,e){return new Ar(t,e).union()},e(kr.prototype,{filter:function(t){-1!==this.sortIndex&&t.getSortIndex()!==this.sortIndex||this.comps.add(t)},interfaces_:function(){return[ut]},getClass:function(){return kr}}),kr.extract=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return kr.extract(t,e,new _)}if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];return n.getSortIndex()===i?r.add(n):n instanceof ft&&n.apply(new kr(i,r)),r}},e(Lr.prototype,{reduceToGeometries:function(t){for(var e=new _,n=t.iterator();n.hasNext();){var i=n.next(),r=null;M(i,v)?r=this.unionTree(i):i instanceof G&&(r=i),e.add(r)}return e},extractByEnvelope:function(t,e,n){for(var i=new _,r=0;r<e.getNumGeometries();r++){var s=e.getGeometryN(r);s.getEnvelopeInternal().intersects(t)?i.add(s):n.add(s)}return this.geomFactory.buildGeometry(i)},unionOptimized:function(t,e){var n=t.getEnvelopeInternal(),i=e.getEnvelopeInternal();if(!n.intersects(i))return Nr.combine(t,e);if(t.getNumGeometries()<=1&&e.getNumGeometries()<=1)return this.unionActual(t,e);var r=n.intersection(i);return this.unionUsingEnvelopeIntersection(t,e,r)},union:function(){if(null===this.inputPolys)throw new IllegalStateException("union() method cannot be called twice");if(this.inputPolys.isEmpty())return null;this.geomFactory=this.inputPolys.iterator().next().getFactory();for(var t=new Te(Lr.STRTREE_NODE_CAPACITY),e=this.inputPolys.iterator();e.hasNext();){var n=e.next();t.insert(n.getEnvelopeInternal(),n)}this.inputPolys=null;var i=t.itemsTree();return this.unionTree(i)},binaryUnion:function(){if(1===arguments.length){var t=arguments[0];return this.binaryUnion(t,0,t.size())}if(3===arguments.length){var e=arguments[0],n=arguments[1],i=arguments[2];if(1>=i-n){var r=Lr.getGeometry(e,n);return this.unionSafe(r,null)}if(i-n==2)return this.unionSafe(Lr.getGeometry(e,n),Lr.getGeometry(e,n+1));var s=Math.trunc((i+n)/2),o=(r=this.binaryUnion(e,n,s),this.binaryUnion(e,s,i));return this.unionSafe(r,o)}},repeatedUnion:function(t){for(var e=null,n=t.iterator();n.hasNext();){var i=n.next();e=null===e?i.copy():e.union(i)}return e},unionSafe:function(t,e){return null===t&&null===e?null:null===t?e.copy():null===e?t.copy():this.unionOptimized(t,e)},unionActual:function(t,e){return Lr.restrictToPolygons(t.union(e))},unionTree:function(t){var e=this.reduceToGeometries(t);return this.binaryUnion(e)},unionUsingEnvelopeIntersection:function(t,e,n){var i=new _,r=this.extractByEnvelope(n,t,i),s=this.extractByEnvelope(n,e,i),o=this.unionActual(r,s);return i.add(o),Nr.combine(i)},bufferUnion:function(){if(1===arguments.length){var t=arguments[0];return t.get(0).getFactory().buildGeometry(t).buffer(0)}if(2===arguments.length){var e=arguments[0],n=arguments[1];return e.getFactory().createGeometryCollection([e,n]).buffer(0)}},interfaces_:function(){return[]},getClass:function(){return Lr}}),Lr.restrictToPolygons=function(t){if(M(t,Ct))return t;var e=Wi.getPolygons(t);return 1===e.size()?e.get(0):t.getFactory().createMultiPolygon(jt.toPolygonArray(e))},Lr.getGeometry=function(t,e){return e>=t.size()?null:t.get(e)},Lr.union=function(t){return new Lr(t).union()},Lr.STRTREE_NODE_CAPACITY=4,e(Or.prototype,{unionNoOpt:function(t){var e=this.geomFact.createPoint();return Wn.overlayOp(t,e,Xn.UNION)},unionWithNull:function(t,e){return null===t&&null===e?null:null===e?t:null===t?e:t.union(e)},extract:function(){if(M(arguments[0],m))for(var t=arguments[0].iterator();t.hasNext();){var e=t.next();this.extract(e)}else if(arguments[0]instanceof G){var n=arguments[0];null===this.geomFact&&(this.geomFact=n.getFactory()),kr.extract(n,G.SORTINDEX_POLYGON,this.polygons),kr.extract(n,G.SORTINDEX_LINESTRING,this.lines),kr.extract(n,G.SORTINDEX_POINT,this.points)}},union:function(){if(null===this.geomFact)return null;var t=null;if(this.points.size()>0){var e=this.geomFact.buildGeometry(this.points);t=this.unionNoOpt(e)}var n=null;if(this.lines.size()>0){var i=this.geomFact.buildGeometry(this.lines);n=this.unionNoOpt(i)}var r=null;this.polygons.size()>0&&(r=Lr.union(this.polygons));var s,o=this.unionWithNull(n,r);return null===(s=null===t?o:null===o?t:Ar.union(t,o))?this.geomFact.createGeometryCollection():s},interfaces_:function(){return[]},getClass:function(){return Or}}),Or.union=function(){if(1===arguments.length){if(M(arguments[0],m))return new Or(arguments[0]).union();if(arguments[0]instanceof G)return new Or(arguments[0]).union()}else if(2===arguments.length)return new Or(arguments[0],arguments[1]).union()};var po=Object.freeze({UnaryUnionOp:Or});e(Dr.prototype,{visitInteriorRing:function(t,e){var n=t.getCoordinates(),i=n[0],r=Dr.findDifferentPoint(n,i),s=e.findEdgeInSameDirection(i,r),o=e.findEdgeEnd(s),a=null;o.getLabel().getLocation(0,Je.RIGHT)===C.INTERIOR?a=o:o.getSym().getLabel().getLocation(0,Je.RIGHT)===C.INTERIOR&&(a=o.getSym()),f.isTrue(null!==a,"unable to find dirEdge with Interior on RHS"),this.visitLinkedDirectedEdges(a)},visitShellInteriors:function(t,e){if(t instanceof Mt){var n=t;this.visitInteriorRing(n.getExteriorRing(),e)}if(t instanceof Tt)for(var i=t,r=0;r<i.getNumGeometries();r++)n=i.getGeometryN(r),this.visitInteriorRing(n.getExteriorRing(),e)},getCoordinate:function(){return this.disconnectedRingcoord},setInteriorEdgesInResult:function(t){for(var e=t.getEdgeEnds().iterator();e.hasNext();){var n=e.next();n.getLabel().getLocation(0,Je.RIGHT)===C.INTERIOR&&n.setInResult(!0)}},visitLinkedDirectedEdges:function(t){var e=t,n=t;do{f.isTrue(null!==n,"found null Directed Edge"),n.setVisited(!0),n=n.getNext()}while(n!==e)},buildEdgeRings:function(t){for(var e=new _,n=t.iterator();n.hasNext();){var i=n.next();if(i.isInResult()&&null===i.getEdgeRing()){var r=new rn(i,this.geometryFactory);r.linkDirectedEdgesForMinimalEdgeRings();var s=r.buildMinimalRings();e.addAll(s)}}return e},hasUnvisitedShellEdge:function(t){for(var e=0;e<t.size();e++){var n=t.get(e);if(!n.isHole()){var i=n.getEdges(),r=i.get(0);if(r.getLabel().getLocation(0,Je.RIGHT)===C.INTERIOR)for(var s=0;s<i.size();s++)if(!(r=i.get(s)).isVisited())return this.disconnectedRingcoord=r.getCoordinate(),!0}}return!1},isInteriorsConnected:function(){var t=new _;this.geomGraph.computeSplitEdges(t);var e=new cn(new wn);e.addEdges(t),this.setInteriorEdgesInResult(e),e.linkResultDirectedEdges();var n=this.buildEdgeRings(e.getEdgeEnds());return this.visitShellInteriors(this.geomGraph.getGeometry(),e),!this.hasUnvisitedShellEdge(n)},interfaces_:function(){return[]},getClass:function(){return Dr}}),Dr.findDifferentPoint=function(t,e){for(var n=0;n<t.length;n++)if(!t[n].equals(e))return t[n];return null},e(Fr.prototype,{hasChildren:function(){for(var t=0;2>t;t++)if(null!==this.subnode[t])return!0;return!1},isPrunable:function(){return!(this.hasChildren()||this.hasItems())},addAllItems:function(t){t.addAll(this.items);for(var e=0;2>e;e++)null!==this.subnode[e]&&this.subnode[e].addAllItems(t);return t},size:function(){for(var t=0,e=0;2>e;e++)null!==this.subnode[e]&&(t+=this.subnode[e].size());return t+this.items.size()},addAllItemsFromOverlapping:function(t,e){return null===t||this.isSearchMatch(t)?(e.addAll(this.items),null!==this.subnode[0]&&this.subnode[0].addAllItemsFromOverlapping(t,e),void(null!==this.subnode[1]&&this.subnode[1].addAllItemsFromOverlapping(t,e))):null},hasItems:function(){return!this.items.isEmpty()},remove:function(t,e){if(!this.isSearchMatch(t))return!1;for(var n=!1,i=0;2>i;i++)if(null!==this.subnode[i]&&(n=this.subnode[i].remove(t,e))){this.subnode[i].isPrunable()&&(this.subnode[i]=null);break}return n||this.items.remove(e)},getItems:function(){return this.items},depth:function(){for(var t=0,e=0;2>e;e++)if(null!==this.subnode[e]){var n=this.subnode[e].depth();n>t&&(t=n)}return t+1},nodeSize:function(){for(var t=0,e=0;2>e;e++)null!==this.subnode[e]&&(t+=this.subnode[e].nodeSize());return t+1},add:function(t){this.items.add(t)},interfaces_:function(){return[]},getClass:function(){return Fr}}),Fr.getSubnodeIndex=function(t,e){var n=-1;return t.min>=e&&(n=1),t.max<=e&&(n=0),n},e(zr.prototype,{expandToInclude:function(t){t.max>this.max&&(this.max=t.max),t.min<this.min&&(this.min=t.min)},getWidth:function(){return this.max-this.min},overlaps:function(){if(1===arguments.length){var t=arguments[0];return this.overlaps(t.min,t.max)}if(2===arguments.length){var e=arguments[0],n=arguments[1];return!(this.min>n||this.max<e)}},getMin:function(){return this.min},toString:function(){return"["+this.min+", "+this.max+"]"},contains:function(){if(1===arguments.length){if(arguments[0]instanceof zr){var t=arguments[0];return this.contains(t.min,t.max)}if("number"==typeof arguments[0]){var e=arguments[0];return e>=this.min&&e<=this.max}}else if(2===arguments.length){var n=arguments[1];return arguments[0]>=this.min&&n<=this.max}},init:function(t,e){this.min=t,this.max=e,t>e&&(this.min=e,this.max=t)},getMax:function(){return this.max},interfaces_:function(){return[]},getClass:function(){return zr}}),e(Gr.prototype,{getInterval:function(){return this.interval},getLevel:function(){return this.level},computeKey:function(t){for(this.level=Gr.computeLevel(t),this.interval=new zr,this.computeInterval(this.level,t);!this.interval.contains(t);)this.level+=1,this.computeInterval(this.level,t)},computeInterval:function(t,e){var n=ci.powerOf2(t);this.pt=Math.floor(e.getMin()/n)*n,this.interval.init(this.pt,this.pt+n)},getPoint:function(){return this.pt},interfaces_:function(){return[]},getClass:function(){return Gr}}),Gr.computeLevel=function(t){var e=t.getWidth();return ci.exponent(e)+1},u(Br,Fr),e(Br.prototype,{getInterval:function(){return this.interval},find:function(t){var e=Fr.getSubnodeIndex(t,this.centre);return-1===e?this:null!==this.subnode[e]?this.subnode[e].find(t):this},insert:function(t){f.isTrue(null===this.interval||this.interval.contains(t.interval));var e=Fr.getSubnodeIndex(t.interval,this.centre);if(t.level===this.level-1)this.subnode[e]=t;else{var n=this.createSubnode(e);n.insert(t),this.subnode[e]=n}},isSearchMatch:function(t){return t.overlaps(this.interval)},getSubnode:function(t){return null===this.subnode[t]&&(this.subnode[t]=this.createSubnode(t)),this.subnode[t]},getNode:function(t){var e=Fr.getSubnodeIndex(t,this.centre);return-1!==e?this.getSubnode(e).getNode(t):this},createSubnode:function(t){var e=0,n=0;switch(t){case 0:e=this.interval.getMin(),n=this.centre;break;case 1:e=this.centre,n=this.interval.getMax()}return new Br(new zr(e,n),this.level-1)},interfaces_:function(){return[]},getClass:function(){return Br}}),Br.createNode=function(t){var e=new Gr(t);return new Br(e.getInterval(),e.getLevel())},Br.createExpanded=function(t,e){var n=new zr(e);null!==t&&n.expandToInclude(t.interval);var i=Br.createNode(n);return null!==t&&i.insert(t),i},u(Ur,Fr),e(Ur.prototype,{insert:function(t,e){var n=Fr.getSubnodeIndex(t,Ur.origin);if(-1===n)return this.add(e),null;var i=this.subnode[n];if(null===i||!i.getInterval().contains(t)){var r=Br.createExpanded(i,t);this.subnode[n]=r}this.insertContained(this.subnode[n],t,e)},isSearchMatch:function(t){return!0},insertContained:function(t,e,n){f.isTrue(t.getInterval().contains(e)),(gi.isZeroWidth(e.getMin(),e.getMax())?t.find(e):t.getNode(e)).add(n)},interfaces_:function(){return[]},getClass:function(){return Ur}}),Ur.origin=0,e(qr.prototype,{size:function(){return null!==this.root?this.root.size():0},insert:function(t,e){this.collectStats(t);var n=qr.ensureExtent(t,this.minExtent);this.root.insert(n,e)},query:function(){if(1===arguments.length){if("number"==typeof arguments[0]){var t=arguments[0];return this.query(new zr(t,t))}if(arguments[0]instanceof zr){var e=arguments[0],n=new _;return this.query(e,n),n}}else if(2===arguments.length){var i=arguments[0],r=arguments[1];this.root.addAllItemsFromOverlapping(i,r)}},iterator:function(){var t=new _;return this.root.addAllItems(t),t.iterator()},remove:function(t,e){var n=qr.ensureExtent(t,this.minExtent);return this.root.remove(n,e)},collectStats:function(t){var e=t.getWidth();e<this.minExtent&&e>0&&(this.minExtent=e)},depth:function(){return null!==this.root?this.root.depth():0},nodeSize:function(){return null!==this.root?this.root.nodeSize():0},interfaces_:function(){return[]},getClass:function(){return qr}}),qr.ensureExtent=function(t,e){var n=t.getMin(),i=t.getMax();return n!==i?t:(n===i&&(i=(n-=e/2)+e/2),new zr(n,i))},e(Vr.prototype,{isInside:function(t){},interfaces_:function(){return[]},getClass:function(){return Vr}}),e(Yr.prototype,{testLineSegment:function(t,e){var n,i,r,s,o=e.p0,a=e.p1;n=o.x-t.x,i=o.y-t.y,r=a.x-t.x,s=a.y-t.y,(i>0&&0>=s||s>0&&0>=i)&&Kt.signOfDet2x2(n,i,r,s)/(s-i)>0&&this.crossings++},buildIndex:function(){this.tree=new qr;for(var t=j.removeRepeatedPoints(this.ring.getCoordinates()),e=Ue.getChains(t),n=0;n<e.size();n++){var i=e.get(n),r=i.getEnvelope();this.interval.min=r.getMinY(),this.interval.max=r.getMaxY(),this.tree.insert(this.interval,i)}},testMonotoneChain:function(t,e,n){n.select(t,e)},isInside:function(t){this.crossings=0;var e=new E(r.NEGATIVE_INFINITY,r.POSITIVE_INFINITY,t.y,t.y);this.interval.min=t.y,this.interval.max=t.y;for(var n=this.tree.query(this.interval),i=new Xr(this,t),s=n.iterator();s.hasNext();){var o=s.next();this.testMonotoneChain(e,i,o)}return this.crossings%2==1},interfaces_:function(){return[Vr]},getClass:function(){return Yr}}),u(Xr,Ui),e(Xr.prototype,{select:function(){if(1!==arguments.length)return Ui.prototype.select.apply(this,arguments);var t=arguments[0];this.mcp.testLineSegment(this.p,t)},interfaces_:function(){return[]},getClass:function(){return Xr}}),Yr.MCSelecter=Xr,e(jr.prototype,{insertEdgeEnds:function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();this.nodes.add(n)}},getNodeIterator:function(){return this.nodes.iterator()},copyNodesAndLabels:function(t,e){for(var n=t.getNodeIterator();n.hasNext();){var i=n.next();this.nodes.addNode(i.getCoordinate()).setLabel(e,i.getLabel().getLocation(e))}},build:function(t){this.computeIntersectionNodes(t,0),this.copyNodesAndLabels(t,0);var e=(new yr).computeEdgeEnds(t.getEdgeIterator());this.insertEdgeEnds(e)},computeIntersectionNodes:function(t,e){for(var n=t.getEdgeIterator();n.hasNext();)for(var i=n.next(),r=i.getLabel().getLocation(e),s=i.getEdgeIntersectionList().iterator();s.hasNext();){var o=s.next(),a=this.nodes.addNode(o.coord);r===C.BOUNDARY?a.setLabelBoundary(e):a.getLabel().isNull(e)&&a.setLabel(e,C.INTERIOR)}},interfaces_:function(){return[]},getClass:function(){return jr}}),e(Wr.prototype,{isNodeEdgeAreaLabelsConsistent:function(){for(var t=this.nodeGraph.getNodeIterator();t.hasNext();){var e=t.next();if(!e.getEdges().isAreaLabelsConsistent(this.geomGraph))return this.invalidPoint=e.getCoordinate().copy(),!1}return!0},getInvalidPoint:function(){return this.invalidPoint},hasDuplicateRings:function(){for(var t=this.nodeGraph.getNodeIterator();t.hasNext();)for(var e=t.next().getEdges().iterator();e.hasNext();){var n=e.next();if(n.getEdgeEnds().size()>1)return this.invalidPoint=n.getEdge().getCoordinate(0),!0}return!1},isNodeConsistentArea:function(){var t=this.geomGraph.computeSelfNodes(this.li,!0,!0);return t.hasProperIntersection()?(this.invalidPoint=t.getProperIntersectionPoint(),!1):(this.nodeGraph.build(this.geomGraph),this.isNodeEdgeAreaLabelsConsistent())},interfaces_:function(){return[]},getClass:function(){return Wr}}),e(Hr.prototype,{buildIndex:function(){this.index=new Te;for(var t=0;t<this.rings.size();t++){var e=this.rings.get(t),n=e.getEnvelopeInternal();this.index.insert(n,e)}},getNestedPoint:function(){return this.nestedPt},isNonNested:function(){this.buildIndex();for(var t=0;t<this.rings.size();t++)for(var e=this.rings.get(t),n=e.getCoordinates(),i=this.index.query(e.getEnvelopeInternal()),r=0;r<i.size();r++){var s=i.get(r),o=s.getCoordinates();if(e!==s&&e.getEnvelopeInternal().intersects(s.getEnvelopeInternal())){var a=Zr.findPtNotNode(n,s,this.graph);if(null!==a&&Qt.isPointInRing(a,o))return this.nestedPt=a,!1}}return!0},add:function(t){this.rings.add(t),this.totalEnv.expandToInclude(t.getEnvelopeInternal())},interfaces_:function(){return[]},getClass:function(){return Hr}}),e($r.prototype,{getErrorType:function(){return this.errorType},getMessage:function(){return $r.errMsg[this.errorType]},getCoordinate:function(){return this.pt},toString:function(){var t="";return null!==this.pt&&(t=" at or near point "+this.pt),this.getMessage()+t},interfaces_:function(){return[]},getClass:function(){return $r}}),$r.ERROR=0,$r.REPEATED_POINT=1,$r.HOLE_OUTSIDE_SHELL=2,$r.NESTED_HOLES=3,$r.DISCONNECTED_INTERIOR=4,$r.SELF_INTERSECTION=5,$r.RING_SELF_INTERSECTION=6,$r.NESTED_SHELLS=7,$r.DUPLICATE_RINGS=8,$r.TOO_FEW_POINTS=9,$r.INVALID_COORDINATE=10,$r.RING_NOT_CLOSED=11,$r.errMsg=["Topology Validation Error","Repeated Point","Hole lies outside shell","Holes are nested","Interior is disconnected","Self-intersection","Ring Self-intersection","Nested shells","Duplicate Rings","Too few distinct points in geometry component","Invalid Coordinate","Ring is not closed"],e(Zr.prototype,{checkInvalidCoordinates:function(){if(arguments[0]instanceof Array){for(var t=arguments[0],e=0;e<t.length;e++)if(!Zr.isValid(t[e]))return this.validErr=new $r($r.INVALID_COORDINATE,t[e]),null}else if(arguments[0]instanceof Mt){var n=arguments[0];if(this.checkInvalidCoordinates(n.getExteriorRing().getCoordinates()),null!==this.validErr)return null;for(e=0;e<n.getNumInteriorRing();e++)if(this.checkInvalidCoordinates(n.getInteriorRingN(e).getCoordinates()),null!==this.validErr)return null}},checkHolesNotNested:function(t,e){for(var n=new Hr(e),i=0;i<t.getNumInteriorRing();i++){var r=t.getInteriorRingN(i);n.add(r)}n.isNonNested()||(this.validErr=new $r($r.NESTED_HOLES,n.getNestedPoint()))},checkConsistentArea:function(t){var e=new Wr(t);return e.isNodeConsistentArea()?void(e.hasDuplicateRings()&&(this.validErr=new $r($r.DUPLICATE_RINGS,e.getInvalidPoint()))):(this.validErr=new $r($r.SELF_INTERSECTION,e.getInvalidPoint()),null)},isValid:function(){return this.checkValid(this.parentGeometry),null===this.validErr},checkShellInsideHole:function(t,e,n){var i=t.getCoordinates(),r=e.getCoordinates(),s=Zr.findPtNotNode(i,e,n);if(null!==s&&!Qt.isPointInRing(s,r))return s;var o=Zr.findPtNotNode(r,t,n);return null!==o?Qt.isPointInRing(o,i)?o:null:(f.shouldNeverReachHere("points in shell and hole appear to be equal"),null)},checkNoSelfIntersectingRings:function(t){for(var e=t.getEdgeIterator();e.hasNext();){var n=e.next();if(this.checkNoSelfIntersectingRing(n.getEdgeIntersectionList()),null!==this.validErr)return null}},checkConnectedInteriors:function(t){var e=new Dr(t);e.isInteriorsConnected()||(this.validErr=new $r($r.DISCONNECTED_INTERIOR,e.getCoordinate()))},checkNoSelfIntersectingRing:function(t){for(var e=new at,n=!0,i=t.iterator();i.hasNext();){var r=i.next();if(n)n=!1;else{if(e.contains(r.coord))return this.validErr=new $r($r.RING_SELF_INTERSECTION,r.coord),null;e.add(r.coord)}}},checkHolesInShell:function(t,e){for(var n=t.getExteriorRing(),i=new Yr(n),r=0;r<t.getNumInteriorRing();r++){var s=t.getInteriorRingN(r),o=Zr.findPtNotNode(s.getCoordinates(),n,e);if(null===o)return null;if(!i.isInside(o))return this.validErr=new $r($r.HOLE_OUTSIDE_SHELL,o),null}},checkTooFewPoints:function(t){return t.hasTooFewPoints()?(this.validErr=new $r($r.TOO_FEW_POINTS,t.getInvalidPoint()),null):void 0},getValidationError:function(){return this.checkValid(this.parentGeometry),this.validErr},checkValid:function(){if(arguments[0]instanceof It){var t=arguments[0];this.checkInvalidCoordinates(t.getCoordinates())}else if(arguments[0]instanceof Rt){var e=arguments[0];this.checkInvalidCoordinates(e.getCoordinates())}else if(arguments[0]instanceof Pt){var n=arguments[0];if(this.checkInvalidCoordinates(n.getCoordinates()),null!==this.validErr)return null;if(this.checkClosedRing(n),null!==this.validErr)return null;var i=new Un(0,n);if(this.checkTooFewPoints(i),null!==this.validErr)return null;var r=new Zt;i.computeSelfNodes(r,!0,!0),this.checkNoSelfIntersectingRings(i)}else if(arguments[0]instanceof Et){var s=arguments[0];if(this.checkInvalidCoordinates(s.getCoordinates()),null!==this.validErr)return null;i=new Un(0,s),this.checkTooFewPoints(i)}else if(arguments[0]instanceof Mt){var o=arguments[0];if(this.checkInvalidCoordinates(o),null!==this.validErr)return null;if(this.checkClosedRings(o),null!==this.validErr)return null;if(i=new Un(0,o),this.checkTooFewPoints(i),null!==this.validErr)return null;if(this.checkConsistentArea(i),null!==this.validErr)return null;if(!this.isSelfTouchingRingFormingHoleValid&&(this.checkNoSelfIntersectingRings(i),null!==this.validErr))return null;if(this.checkHolesInShell(o,i),null!==this.validErr)return null;if(this.checkHolesNotNested(o,i),null!==this.validErr)return null;this.checkConnectedInteriors(i)}else if(arguments[0]instanceof Tt){for(var a=arguments[0],l=0;l<a.getNumGeometries();l++){var h=a.getGeometryN(l);if(this.checkInvalidCoordinates(h),null!==this.validErr)return null;if(this.checkClosedRings(h),null!==this.validErr)return null}if(i=new Un(0,a),this.checkTooFewPoints(i),null!==this.validErr)return null;if(this.checkConsistentArea(i),null!==this.validErr)return null;if(!this.isSelfTouchingRingFormingHoleValid&&(this.checkNoSelfIntersectingRings(i),null!==this.validErr))return null;for(l=0;l<a.getNumGeometries();l++)if(h=a.getGeometryN(l),this.checkHolesInShell(h,i),null!==this.validErr)return null;for(l=0;l<a.getNumGeometries();l++)if(h=a.getGeometryN(l),this.checkHolesNotNested(h,i),null!==this.validErr)return null;if(this.checkShellsNotNested(a,i),null!==this.validErr)return null;this.checkConnectedInteriors(i)}else if(arguments[0]instanceof ft){var u=arguments[0];for(l=0;l<u.getNumGeometries();l++){var c=u.getGeometryN(l);if(this.checkValid(c),null!==this.validErr)return null}}else if(arguments[0]instanceof G){var f=arguments[0];if(this.validErr=null,f.isEmpty())return null;if(f instanceof It)this.checkValid(f);else if(f instanceof Rt)this.checkValid(f);else if(f instanceof Pt)this.checkValid(f);else if(f instanceof Et)this.checkValid(f);else if(f instanceof Mt)this.checkValid(f);else if(f instanceof Tt)this.checkValid(f);else{if(!(f instanceof ft))throw new UnsupportedOperationException(f.getClass().getName());this.checkValid(f)}}},setSelfTouchingRingFormingHoleValid:function(t){this.isSelfTouchingRingFormingHoleValid=t},checkShellNotNested:function(t,e,n){var i=t.getCoordinates(),r=e.getExteriorRing(),s=r.getCoordinates(),o=Zr.findPtNotNode(i,r,n);if(null===o)return null;if(!Qt.isPointInRing(o,s))return null;if(e.getNumInteriorRing()<=0)return this.validErr=new $r($r.NESTED_SHELLS,o),null;for(var a=null,l=0;l<e.getNumInteriorRing();l++){var h=e.getInteriorRingN(l);if(null===(a=this.checkShellInsideHole(t,h,n)))return null}this.validErr=new $r($r.NESTED_SHELLS,a)},checkClosedRings:function(t){if(this.checkClosedRing(t.getExteriorRing()),null!==this.validErr)return null;for(var e=0;e<t.getNumInteriorRing();e++)if(this.checkClosedRing(t.getInteriorRingN(e)),null!==this.validErr)return null},checkClosedRing:function(t){if(!t.isClosed()){var e=null;t.getNumPoints()>=1&&(e=t.getCoordinateN(0)),this.validErr=new $r($r.RING_NOT_CLOSED,e)}},checkShellsNotNested:function(t,e){for(var n=0;n<t.getNumGeometries();n++)for(var i=t.getGeometryN(n).getExteriorRing(),r=0;r<t.getNumGeometries();r++)if(n!==r){var s=t.getGeometryN(r);if(this.checkShellNotNested(i,s,e),null!==this.validErr)return null}},interfaces_:function(){return[]},getClass:function(){return Zr}}),Zr.findPtNotNode=function(t,e,n){for(var i=n.findEdge(e).getEdgeIntersectionList(),r=0;r<t.length;r++){var s=t[r];if(!i.isIntersection(s))return s}return null},Zr.isValid=function(){if(arguments[0]instanceof G)return new Zr(arguments[0]).isValid();if(arguments[0]instanceof d){var t=arguments[0];return!(r.isNaN(t.x)||r.isInfinite(t.x)||r.isNaN(t.y)||r.isInfinite(t.y))}};var mo=Object.freeze({IsValidOp:Zr}),yo=Object.freeze({BoundaryOp:gt,IsSimpleOp:Si,buffer:lo,distance:ho,linemerge:uo,overlay:co,polygonize:fo,relate:go,union:po,valid:mo});u(Kr,Nt.CoordinateOperation),e(Kr.prototype,{editCoordinates:function(t,e){if(0===t.length)return null;for(var n=new Array(t.length).fill(null),i=0;i<t.length;i++){var r=new d(t[i]);this.targetPM.makePrecise(r),n[i]=r}var s=new b(n,!1).toCoordinateArray(),o=0;e instanceof Et&&(o=2),e instanceof Pt&&(o=4);var a=n;return this.removeCollapsed&&(a=null),s.length<o?a:s},interfaces_:function(){return[]},getClass:function(){return Kr}}),e(Jr.prototype,{fixPolygonalTopology:function(t){var e=t;this.changePrecisionModel||(e=this.changePM(t,this.targetPM));var n=e.buffer(0),i=n;return this.changePrecisionModel||(i=t.getFactory().createGeometry(n)),i},reducePointwise:function(t){var e=null;e=this.changePrecisionModel?new Nt(this.createFactory(t.getFactory(),this.targetPM)):new Nt;var n=this.removeCollapsed;return t.getDimension()>=2&&(n=!0),e.edit(t,new Kr(this.targetPM,n))},changePM:function(t,e){return this.createEditor(t.getFactory(),e).edit(t,new Nt.NoOpGeometryOperation)},setRemoveCollapsedComponents:function(t){this.removeCollapsed=t},createFactory:function(t,e){return new jt(e,t.getSRID(),t.getCoordinateSequenceFactory())},setChangePrecisionModel:function(t){this.changePrecisionModel=t},reduce:function(t){var e=this.reducePointwise(t);return this.isPointwise?e:M(e,Ct)?e.isValid()?e:this.fixPolygonalTopology(e):e},setPointwise:function(t){this.isPointwise=t},createEditor:function(t,e){return t.getPrecisionModel()===e?new Nt:new Nt(this.createFactory(t,e))},interfaces_:function(){return[]},getClass:function(){return Jr}}),Jr.reduce=function(t,e){return new Jr(e).reduce(t)},Jr.reducePointwise=function(t,e){var n=new Jr(e);return n.setPointwise(!0),n.reduce(t)};var vo=Object.freeze({GeometryPrecisionReducer:Jr});e(Qr.prototype,{simplifySection:function(t,e){if(t+1===e)return null;this.seg.p0=this.pts[t],this.seg.p1=this.pts[e];for(var n=-1,i=t,r=t+1;e>r;r++){var s=this.seg.distance(this.pts[r]);s>n&&(n=s,i=r)}if(n<=this.distanceTolerance)for(r=t+1;e>r;r++)this.usePt[r]=!1;else this.simplifySection(t,i),this.simplifySection(i,e)},setDistanceTolerance:function(t){this.distanceTolerance=t},simplify:function(){this.usePt=new Array(this.pts.length).fill(null);for(var t=0;t<this.pts.length;t++)this.usePt[t]=!0;this.simplifySection(0,this.pts.length-1);var e=new b;for(t=0;t<this.pts.length;t++)this.usePt[t]&&e.add(new d(this.pts[t]));return e.toCoordinateArray()},interfaces_:function(){return[]},getClass:function(){return Qr}}),Qr.simplify=function(t,e){var n=new Qr(t);return n.setDistanceTolerance(e),n.simplify()},e(ts.prototype,{setEnsureValid:function(t){this.isEnsureValidTopology=t},getResultGeometry:function(){return this.inputGeom.isEmpty()?this.inputGeom.copy():new es(this.isEnsureValidTopology,this.distanceTolerance).transform(this.inputGeom)},setDistanceTolerance:function(t){if(0>t)throw new i("Tolerance must be non-negative");this.distanceTolerance=t},interfaces_:function(){return[]},getClass:function(){return ts}}),ts.simplify=function(t,e){var n=new ts(t);return n.setDistanceTolerance(e),n.getResultGeometry()},u(es,le),e(es.prototype,{transformPolygon:function(t,e){if(t.isEmpty())return null;var n=le.prototype.transformPolygon.call(this,t,e);return e instanceof Tt?n:this.createValidArea(n)},createValidArea:function(t){return this.isEnsureValidTopology?t.buffer(0):t},transformCoordinates:function(t,e){var n,i=t.toCoordinateArray();return n=0===i.length?new Array(0).fill(null):Qr.simplify(i,this.distanceTolerance),this.factory.getCoordinateSequenceFactory().create(n)},transformMultiPolygon:function(t,e){var n=le.prototype.transformMultiPolygon.call(this,t,e);return this.createValidArea(n)},transformLinearRing:function(t,e){var n=e instanceof Mt,i=le.prototype.transformLinearRing.call(this,t,e);return!n||i instanceof Pt?i:null},interfaces_:function(){return[]},getClass:function(){return es}}),ts.DPTransformer=es,u(ns,te),e(ns.prototype,{getIndex:function(){return this.index},getParent:function(){return this.parent},interfaces_:function(){return[]},getClass:function(){return ns}}),e(is.prototype,{addToResult:function(t){this.resultSegs.add(t)},asLineString:function(){return this.parentLine.getFactory().createLineString(is.extractCoordinates(this.resultSegs))},getResultSize:function(){var t=this.resultSegs.size();return 0===t?0:t+1},getParent:function(){return this.parentLine},getSegment:function(t){return this.segs[t]},getParentCoordinates:function(){return this.parentLine.getCoordinates()},getMinimumSize:function(){return this.minimumSize},asLinearRing:function(){return this.parentLine.getFactory().createLinearRing(is.extractCoordinates(this.resultSegs))},getSegments:function(){return this.segs},init:function(){var t=this.parentLine.getCoordinates();this.segs=new Array(t.length-1).fill(null);for(var e=0;e<t.length-1;e++){var n=new ns(t[e],t[e+1],this.parentLine,e);this.segs[e]=n}},getResultCoordinates:function(){return is.extractCoordinates(this.resultSegs)},interfaces_:function(){return[]},getClass:function(){return is}}),is.extractCoordinates=function(t){for(var e=new Array(t.size()+1).fill(null),n=null,i=0;i<t.size();i++)n=t.get(i),e[i]=n.p0;return e[e.length-1]=n.p1,e},e(rs.prototype,{remove:function(t){this.index.remove(new E(t.p0,t.p1),t)},add:function(){if(arguments[0]instanceof is)for(var t=arguments[0].getSegments(),e=0;e<t.length;e++){var n=t[e];this.add(n)}else if(arguments[0]instanceof te){var i=arguments[0];this.index.insert(new E(i.p0,i.p1),i)}},query:function(t){var e=new E(t.p0,t.p1),n=new ss(t);return this.index.query(e,n),n.getItems()},interfaces_:function(){return[]},getClass:function(){return rs}}),e(ss.prototype,{visitItem:function(t){var e=t;E.intersects(e.p0,e.p1,this.querySeg.p0,this.querySeg.p1)&&this.items.add(t)},getItems:function(){return this.items},interfaces_:function(){return[Se]},getClass:function(){return ss}}),e(os.prototype,{flatten:function(t,e){var n=new te(this.linePts[t],this.linePts[e]);return this.remove(this.line,t,e),this.outputIndex.add(n),n},hasBadIntersection:function(t,e,n){return!!this.hasBadOutputIntersection(n)||!!this.hasBadInputIntersection(t,e,n)},setDistanceTolerance:function(t){this.distanceTolerance=t},simplifySection:function(t,e,n){n+=1;var i=new Array(2).fill(null);if(t+1===e){var r=this.line.getSegment(t);return this.line.addToResult(r),null}var s=!0;this.line.getResultSize()<this.line.getMinimumSize()&&n+1<this.line.getMinimumSize()&&(s=!1);var o=new Array(1).fill(null),a=this.findFurthestPoint(this.linePts,t,e,o);o[0]>this.distanceTolerance&&(s=!1);var l=new te;if(l.p0=this.linePts[t],l.p1=this.linePts[e],i[0]=t,i[1]=e,this.hasBadIntersection(this.line,i,l)&&(s=!1),s)return r=this.flatten(t,e),this.line.addToResult(r),null;this.simplifySection(t,a,n),this.simplifySection(a,e,n)},hasBadOutputIntersection:function(t){for(var e=this.outputIndex.query(t).iterator();e.hasNext();){var n=e.next();if(this.hasInteriorIntersection(n,t))return!0}return!1},findFurthestPoint:function(t,e,n,i){var r=new te;r.p0=t[e],r.p1=t[n];for(var s=-1,o=e,a=e+1;n>a;a++){var l=t[a],h=r.distance(l);h>s&&(s=h,o=a)}return i[0]=s,o},simplify:function(t){this.line=t,this.linePts=t.getParentCoordinates(),this.simplifySection(0,this.linePts.length-1,0)},remove:function(t,e,n){for(var i=e;n>i;i++){var r=t.getSegment(i);this.inputIndex.remove(r)}},hasInteriorIntersection:function(t,e){return this.li.computeIntersection(t.p0,t.p1,e.p0,e.p1),this.li.isInteriorIntersection()},hasBadInputIntersection:function(t,e,n){for(var i=this.inputIndex.query(n).iterator();i.hasNext();){var r=i.next();if(this.hasInteriorIntersection(r,n)){if(os.isInLineSection(t,e,r))continue;return!0}}return!1},interfaces_:function(){return[]},getClass:function(){return os}}),os.isInLineSection=function(t,e,n){if(n.getParent()!==t.getParent())return!1;var i=n.getIndex();return i>=e[0]&&i<e[1]},e(as.prototype,{setDistanceTolerance:function(t){this.distanceTolerance=t},simplify:function(t){for(var e=t.iterator();e.hasNext();)this.inputIndex.add(e.next());for(e=t.iterator();e.hasNext();){var n=new os(this.inputIndex,this.outputIndex);n.setDistanceTolerance(this.distanceTolerance),n.simplify(e.next())}},interfaces_:function(){return[]},getClass:function(){return as}}),e(ls.prototype,{getResultGeometry:function(){return this.inputGeom.isEmpty()?this.inputGeom.copy():(this.linestringMap=new Vt,this.inputGeom.apply(new us(this)),this.lineSimplifier.simplify(this.linestringMap.values()),new hs(this.linestringMap).transform(this.inputGeom))},setDistanceTolerance:function(t){if(0>t)throw new i("Tolerance must be non-negative");this.lineSimplifier.setDistanceTolerance(t)},interfaces_:function(){return[]},getClass:function(){return ls}}),ls.simplify=function(t,e){var n=new ls(t);return n.setDistanceTolerance(e),n.getResultGeometry()},u(hs,le),e(hs.prototype,{transformCoordinates:function(t,e){if(0===t.size())return null;if(e instanceof Et){var n=this.linestringMap.get(e);return this.createCoordinateSequence(n.getResultCoordinates())}return le.prototype.transformCoordinates.call(this,t,e)},interfaces_:function(){return[]},getClass:function(){return hs}}),e(us.prototype,{filter:function(t){if(t instanceof Et){var e=t;if(e.isEmpty())return null;var n=e.isClosed()?4:2,i=new is(e,n);this.tps.linestringMap.put(e,i)}},interfaces_:function(){return[z]},getClass:function(){return us}}),ls.LineStringTransformer=hs,ls.LineStringMapBuilderFilter=us;var wo=Object.freeze({DouglasPeuckerSimplifier:ts,TopologyPreservingSimplifier:ls});e(cs.prototype,{splitAt:function(){if(1===arguments.length){var t=arguments[0],e=this.minimumLen/this.segLen;if(t.distance(this.seg.p0)<this.minimumLen)return this.splitPt=this.seg.pointAlong(e),null;if(t.distance(this.seg.p1)<this.minimumLen)return this.splitPt=cs.pointAlongReverse(this.seg,e),null;this.splitPt=t}else if(2===arguments.length){var n=arguments[0],i=arguments[1],r=this.getConstrainedLength(n)/this.segLen;i.equals2D(this.seg.p0)?this.splitPt=this.seg.pointAlong(r):this.splitPt=cs.pointAlongReverse(this.seg,r)}},setMinimumLength:function(t){this.minimumLen=t},getConstrainedLength:function(t){return t<this.minimumLen?this.minimumLen:t},getSplitPoint:function(){return this.splitPt},interfaces_:function(){return[]},getClass:function(){return cs}}),cs.pointAlongReverse=function(t,e){var n=new d;return n.x=t.p1.x-e*(t.p1.x-t.p0.x),n.y=t.p1.y-e*(t.p1.y-t.p0.y),n},e(fs.prototype,{findSplitPoint:function(t,e){},interfaces_:function(){return[]},getClass:function(){return fs}}),e(ds.prototype,{findSplitPoint:function(t,e){var n=t.getLineSegment(),i=n.getLength()/2,r=new cs(n),s=ds.projectedSplitPoint(t,e),o=2*s.distance(e)*.8;return o>i&&(o=i),r.setMinimumLength(o),r.splitAt(s),r.getSplitPoint()},interfaces_:function(){return[fs]},getClass:function(){return ds}}),ds.projectedSplitPoint=function(t,e){return t.getLineSegment().project(e)},e(gs.prototype,{interfaces_:function(){return[]},getClass:function(){return gs}}),gs.triArea=function(t,e,n){return(e.x-t.x)*(n.y-t.y)-(e.y-t.y)*(n.x-t.x)},gs.isInCircleDDNormalized=function(t,e,n,i){var r=A.valueOf(t.x).selfSubtract(i.x),s=A.valueOf(t.y).selfSubtract(i.y),o=A.valueOf(e.x).selfSubtract(i.x),a=A.valueOf(e.y).selfSubtract(i.y),l=A.valueOf(n.x).selfSubtract(i.x),h=A.valueOf(n.y).selfSubtract(i.y),u=r.multiply(a).selfSubtract(o.multiply(s)),c=o.multiply(h).selfSubtract(l.multiply(a)),f=l.multiply(s).selfSubtract(r.multiply(h)),d=r.multiply(r).selfAdd(s.multiply(s)),g=o.multiply(o).selfAdd(a.multiply(a)),p=l.multiply(l).selfAdd(h.multiply(h));return d.selfMultiply(c).selfAdd(g.selfMultiply(f)).selfAdd(p.selfMultiply(u)).doubleValue()>0},gs.checkRobustInCircle=function(t,e,n,i){var r=gs.isInCircleNonRobust(t,e,n,i),s=gs.isInCircleDDSlow(t,e,n,i),o=gs.isInCircleCC(t,e,n,i),a=Qn.circumcentre(t,e,n);O.out.println("p radius diff a = "+Math.abs(i.distance(a)-t.distance(a))/t.distance(a)),r===s&&r===o||(O.out.println("inCircle robustness failure (double result = "+r+", DD result = "+s+", CC result = "+o+")"),O.out.println(Ht.toLineString(new Dt([t,e,n,i]))),O.out.println("Circumcentre = "+Ht.toPoint(a)+" radius = "+t.distance(a)),O.out.println("p radius diff a = "+Math.abs(i.distance(a)/t.distance(a)-1)),O.out.println("p radius diff b = "+Math.abs(i.distance(a)/e.distance(a)-1)),O.out.println("p radius diff c = "+Math.abs(i.distance(a)/n.distance(a)-1)),O.out.println())},gs.isInCircleDDFast=function(t,e,n,i){var r=A.sqr(t.x).selfAdd(A.sqr(t.y)).selfMultiply(gs.triAreaDDFast(e,n,i)),s=A.sqr(e.x).selfAdd(A.sqr(e.y)).selfMultiply(gs.triAreaDDFast(t,n,i)),o=A.sqr(n.x).selfAdd(A.sqr(n.y)).selfMultiply(gs.triAreaDDFast(t,e,i)),a=A.sqr(i.x).selfAdd(A.sqr(i.y)).selfMultiply(gs.triAreaDDFast(t,e,n));return r.selfSubtract(s).selfAdd(o).selfSubtract(a).doubleValue()>0},gs.isInCircleCC=function(t,e,n,i){var r=Qn.circumcentre(t,e,n),s=t.distance(r);return 0>=i.distance(r)-s},gs.isInCircleNormalized=function(t,e,n,i){var r=t.x-i.x,s=t.y-i.y,o=e.x-i.x,a=e.y-i.y,l=n.x-i.x,h=n.y-i.y;return(r*r+s*s)*(o*h-l*a)+(o*o+a*a)*(l*s-r*h)+(l*l+h*h)*(r*a-o*s)>0},gs.isInCircleDDSlow=function(t,e,n,i){var r=A.valueOf(i.x),s=A.valueOf(i.y),o=A.valueOf(t.x),a=A.valueOf(t.y),l=A.valueOf(e.x),h=A.valueOf(e.y),u=A.valueOf(n.x),c=A.valueOf(n.y),f=o.multiply(o).add(a.multiply(a)).multiply(gs.triAreaDDSlow(l,h,u,c,r,s)),d=l.multiply(l).add(h.multiply(h)).multiply(gs.triAreaDDSlow(o,a,u,c,r,s)),g=u.multiply(u).add(c.multiply(c)).multiply(gs.triAreaDDSlow(o,a,l,h,r,s)),p=r.multiply(r).add(s.multiply(s)).multiply(gs.triAreaDDSlow(o,a,l,h,u,c));return f.subtract(d).add(g).subtract(p).doubleValue()>0},gs.isInCircleNonRobust=function(t,e,n,i){return(t.x*t.x+t.y*t.y)*gs.triArea(e,n,i)-(e.x*e.x+e.y*e.y)*gs.triArea(t,n,i)+(n.x*n.x+n.y*n.y)*gs.triArea(t,e,i)-(i.x*i.x+i.y*i.y)*gs.triArea(t,e,n)>0},gs.isInCircleRobust=function(t,e,n,i){return gs.isInCircleNormalized(t,e,n,i)},gs.triAreaDDSlow=function(t,e,n,i,r,s){return n.subtract(t).multiply(s.subtract(e)).subtract(i.subtract(e).multiply(r.subtract(t)))},gs.triAreaDDFast=function(t,e,n){var i=A.valueOf(e.x).selfSubtract(t.x).selfMultiply(A.valueOf(n.y).selfSubtract(t.y)),r=A.valueOf(e.y).selfSubtract(t.y).selfMultiply(A.valueOf(n.x).selfSubtract(t.x));return i.selfSubtract(r)},e(ps.prototype,{circleCenter:function(t,e){var n,i=new ps(this.getX(),this.getY()),r=new D(this.bisector(i,t),this.bisector(t,e)),s=null;try{s=new ps(r.getX(),r.getY())}catch(n){if(!(n instanceof I))throw n;O.err.println("a: "+i+"  b: "+t+"  c: "+e),O.err.println(n)}return s},dot:function(t){return this.p.x*t.getX()+this.p.y*t.getY()},magn:function(){return Math.sqrt(this.p.x*this.p.x+this.p.y*this.p.y)},getZ:function(){return this.p.z},bisector:function(t,e){var n=e.getX()-t.getX(),i=e.getY()-t.getY(),r=new D(t.getX()+n/2,t.getY()+i/2,1),s=new D(t.getX()-i+n/2,t.getY()+n+i/2,1);return new D(r,s)},equals:function(){if(1===arguments.length){var t=arguments[0];return this.p.x===t.getX()&&this.p.y===t.getY()}if(2===arguments.length){var e=arguments[0],n=arguments[1];return this.p.distance(e.getCoordinate())<n}},getCoordinate:function(){return this.p},isInCircle:function(t,e,n){return gs.isInCircleRobust(t.p,e.p,n.p,this.p)},interpolateZValue:function(t,e,n){var i=t.getX(),r=t.getY(),s=e.getX()-i,o=n.getX()-i,a=e.getY()-r,l=n.getY()-r,h=s*l-o*a,u=this.getX()-i,c=this.getY()-r,f=(l*u-o*c)/h,d=(-a*u+s*c)/h;return t.getZ()+f*(e.getZ()-t.getZ())+d*(n.getZ()-t.getZ())},midPoint:function(t){return new ps((this.p.x+t.getX())/2,(this.p.y+t.getY())/2,(this.p.z+t.getZ())/2)},rightOf:function(t){return this.isCCW(t.dest(),t.orig())},isCCW:function(t,e){return(t.p.x-this.p.x)*(e.p.y-this.p.y)-(t.p.y-this.p.y)*(e.p.x-this.p.x)>0},getX:function(){return this.p.x},crossProduct:function(t){return this.p.x*t.getY()-this.p.y*t.getX()},setZ:function(t){this.p.z=t},times:function(t){return new ps(t*this.p.x,t*this.p.y)},cross:function(){return new ps(this.p.y,-this.p.x)},leftOf:function(t){return this.isCCW(t.orig(),t.dest())},toString:function(){return"POINT ("+this.p.x+" "+this.p.y+")"},sub:function(t){return new ps(this.p.x-t.getX(),this.p.y-t.getY())},getY:function(){return this.p.y},classify:function(t,e){var n=this,i=e.sub(t),r=n.sub(t),s=i.crossProduct(r);return s>0?ps.LEFT:0>s?ps.RIGHT:i.getX()*r.getX()<0||i.getY()*r.getY()<0?ps.BEHIND:i.magn()<r.magn()?ps.BEYOND:t.equals(n)?ps.ORIGIN:e.equals(n)?ps.DESTINATION:ps.BETWEEN},sum:function(t){return new ps(this.p.x+t.getX(),this.p.y+t.getY())},distance:function(t,e){return Math.sqrt(Math.pow(e.getX()-t.getX(),2)+Math.pow(e.getY()-t.getY(),2))},circumRadiusRatio:function(t,e){var n=this.circleCenter(t,e),i=this.distance(n,t),r=this.distance(this,t),s=this.distance(t,e);return r>s&&(r=s),r>(s=this.distance(e,this))&&(r=s),i/r},interfaces_:function(){return[]},getClass:function(){return ps}}),ps.interpolateZ=function(){if(3===arguments.length){var t=arguments[0],e=arguments[1],n=arguments[2],i=e.distance(n),r=t.distance(e),s=n.z-e.z;return e.z+s*(r/i)}if(4===arguments.length){var o=arguments[0],a=arguments[1],l=arguments[2],h=arguments[3],u=a.x,c=a.y,f=l.x-u,d=h.x-u,g=l.y-c,p=h.y-c,m=f*p-d*g,y=o.x-u,v=o.y-c,w=(p*y-d*v)/m,x=(-g*y+f*v)/m;return a.z+w*(l.z-a.z)+x*(h.z-a.z)}},ps.LEFT=0,ps.RIGHT=1,ps.BEYOND=2,ps.BEHIND=3,ps.BETWEEN=4,ps.ORIGIN=5,ps.DESTINATION=6,u(ms,ps),e(ms.prototype,{getConstraint:function(){return this.constraint},setOnConstraint:function(t){this._isOnConstraint=t},merge:function(t){t._isOnConstraint&&(this._isOnConstraint=!0,this.constraint=t.constraint)},isOnConstraint:function(){return this._isOnConstraint},setConstraint:function(t){this._isOnConstraint=!0,this.constraint=t},interfaces_:function(){return[]},getClass:function(){return ms}}),e(ys.prototype,{equalsNonOriented:function(t){return!!this.equalsOriented(t)||!!this.equalsOriented(t.sym())},toLineSegment:function(){return new te(this.vertex.getCoordinate(),this.dest().getCoordinate())},dest:function(){return this.sym().orig()},oNext:function(){return this.next},equalsOriented:function(t){return!(!this.orig().getCoordinate().equals2D(t.orig().getCoordinate())||!this.dest().getCoordinate().equals2D(t.dest().getCoordinate()))},dNext:function(){return this.sym().oNext().sym()},lPrev:function(){return this.next.sym()},rPrev:function(){return this.sym().oNext()},rot:function(){return this._rot},oPrev:function(){return this._rot.next._rot},sym:function(){return this._rot._rot},setOrig:function(t){this.vertex=t},lNext:function(){return this.invRot().oNext().rot()},getLength:function(){return this.orig().getCoordinate().distance(this.dest().getCoordinate())},invRot:function(){return this._rot.sym()},setDest:function(t){this.sym().setOrig(t)},setData:function(t){this.data=t},getData:function(){return this.data},delete:function(){this._rot=null},orig:function(){return this.vertex},rNext:function(){return this._rot.next.invRot()},toString:function(){var t=this.vertex.getCoordinate(),e=this.dest().getCoordinate();return Ht.toLineString(t,e)},isLive:function(){return null!==this._rot},getPrimary:function(){return this.orig().getCoordinate().compareTo(this.dest().getCoordinate())<=0?this:this.sym()},dPrev:function(){return this.invRot().oNext().invRot()},setNext:function(t){this.next=t},interfaces_:function(){return[]},getClass:function(){return ys}}),ys.makeEdge=function(t,e){var n=new ys,i=new ys,r=new ys,s=new ys;n._rot=i,i._rot=r,r._rot=s,s._rot=n,n.setNext(n),i.setNext(s),r.setNext(r),s.setNext(i);var o=n;return o.setOrig(t),o.setDest(e),o},ys.swap=function(t){var e=t.oPrev(),n=t.sym().oPrev();ys.splice(t,e),ys.splice(t.sym(),n),ys.splice(t,e.lNext()),ys.splice(t.sym(),n.lNext()),t.setOrig(e.dest()),t.setDest(n.dest())},ys.splice=function(t,e){var n=t.oNext().rot(),i=e.oNext().rot(),r=e.oNext(),s=t.oNext(),o=i.oNext(),a=n.oNext();t.setNext(r),e.setNext(s),n.setNext(o),i.setNext(a)},ys.connect=function(t,e){var n=ys.makeEdge(t.dest(),e.orig());return ys.splice(n,t.lNext()),ys.splice(n.sym(),e),n},e(vs.prototype,{insertSite:function(t){var e=this.subdiv.locate(t);if(this.subdiv.isVertexOfEdge(e,t))return e;this.subdiv.isOnEdge(e,t.getCoordinate())&&(e=e.oPrev(),this.subdiv.delete(e.oNext()));var n=this.subdiv.makeEdge(e.orig(),t);ys.splice(n,e);var i=n;do{e=(n=this.subdiv.connect(e,n.sym())).oPrev()}while(e.lNext()!==i);for(;;){var r=e.oPrev();if(r.dest().rightOf(e)&&t.isInCircle(e.orig(),r.dest(),e.dest()))ys.swap(e),e=e.oPrev();else{if(e.oNext()===i)return n;e=e.oNext().lPrev()}}},insertSites:function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();this.insertSite(n)}},interfaces_:function(){return[]},getClass:function(){return vs}}),e(ws.prototype,{locate:function(t){},interfaces_:function(){return[]},getClass:function(){return ws}}),e(xs.prototype,{init:function(){this.lastEdge=this.findEdge()},locate:function(t){this.lastEdge.isLive()||this.init();var e=this.subdiv.locateFromEdge(t,this.lastEdge);return this.lastEdge=e,e},findEdge:function(){return this.subdiv.getEdges().iterator().next()},interfaces_:function(){return[ws]},getClass:function(){return xs}}),u(_s,h),e(_s.prototype,{getSegment:function(){return this.seg},interfaces_:function(){return[]},getClass:function(){return _s}}),_s.msgWithSpatial=function(t,e){return null!==e?t+" [ "+e+" ]":t},e(bs.prototype,{visit:function(t){},interfaces_:function(){return[]},getClass:function(){return bs}}),e(Es.prototype,{getTriangleVertices:function(t){var e=new Cs;return this.visitTriangles(e,t),e.getTriangleVertices()},isFrameVertex:function(t){return!!t.equals(this.frameVertex[0])||!!t.equals(this.frameVertex[1])||!!t.equals(this.frameVertex[2])},isVertexOfEdge:function(t,e){return!(!e.equals(t.orig(),this.tolerance)&&!e.equals(t.dest(),this.tolerance))},connect:function(t,e){var n=ys.connect(t,e);return this.quadEdges.add(n),n},getVoronoiCellPolygon:function(t,e){var n=new _,i=t;do{var r=t.rot().orig().getCoordinate();n.add(r),t=t.oPrev()}while(t!==i);var s=new b;s.addAll(n,!1),s.closeRing(),s.size()<4&&(O.out.println(s),s.add(s.get(s.size()-1),!0));var o=s.toCoordinateArray(),a=e.createPolygon(e.createLinearRing(o),null),l=i.orig();return a.setUserData(l.getCoordinate()),a},setLocator:function(t){this.locator=t},initSubdiv:function(){var t=this.makeEdge(this.frameVertex[0],this.frameVertex[1]),e=this.makeEdge(this.frameVertex[1],this.frameVertex[2]);ys.splice(t.sym(),e);var n=this.makeEdge(this.frameVertex[2],this.frameVertex[0]);return ys.splice(e.sym(),n),ys.splice(n.sym(),t),t},isFrameBorderEdge:function(t){var e=new Array(3).fill(null);Es.getTriangleEdges(t,e);var n=new Array(3).fill(null);Es.getTriangleEdges(t.sym(),n);var i=t.lNext().dest();if(this.isFrameVertex(i))return!0;var r=t.sym().lNext().dest();return!!this.isFrameVertex(r)},makeEdge:function(t,e){var n=ys.makeEdge(t,e);return this.quadEdges.add(n),n},visitTriangles:function(t,e){this.visitedKey++;var n=new re;n.push(this.startingEdge);for(var i=new J;!n.empty();){var r=n.pop();if(!i.contains(r)){var s=this.fetchTriangleToVisit(r,n,e,i);null!==s&&t.visit(s)}}},isFrameEdge:function(t){return!(!this.isFrameVertex(t.orig())&&!this.isFrameVertex(t.dest()))},isOnEdge:function(t,e){return this.seg.setCoordinates(t.orig().getCoordinate(),t.dest().getCoordinate()),this.seg.distance(e)<this.edgeCoincidenceTolerance},getEnvelope:function(){return new E(this.frameEnv)},createFrame:function(t){var e,n=t.getWidth(),i=t.getHeight();e=n>i?10*n:10*i,this.frameVertex[0]=new ps((t.getMaxX()+t.getMinX())/2,t.getMaxY()+e),this.frameVertex[1]=new ps(t.getMinX()-e,t.getMinY()-e),this.frameVertex[2]=new ps(t.getMaxX()+e,t.getMinY()-e),this.frameEnv=new E(this.frameVertex[0].getCoordinate(),this.frameVertex[1].getCoordinate()),this.frameEnv.expandToInclude(this.frameVertex[2].getCoordinate())},getTriangleCoordinates:function(t){var e=new Ms;return this.visitTriangles(e,t),e.getTriangles()},getVertices:function(t){for(var e=new J,n=this.quadEdges.iterator();n.hasNext();){var i=n.next(),r=i.orig();!t&&this.isFrameVertex(r)||e.add(r);var s=i.dest();!t&&this.isFrameVertex(s)||e.add(s)}return e},fetchTriangleToVisit:function(t,e,n,i){var r=t,s=0,o=!1;do{this.triEdges[s]=r,this.isFrameEdge(r)&&(o=!0);var a=r.sym();i.contains(a)||e.push(a),i.add(r),s++,r=r.lNext()}while(r!==t);return o&&!n?null:this.triEdges},getEdges:function(){if(0===arguments.length)return this.quadEdges;if(1===arguments.length){for(var t=arguments[0],e=this.getPrimaryEdges(!1),n=new Array(e.size()).fill(null),i=0,r=e.iterator();r.hasNext();){var s=r.next();n[i++]=t.createLineString([s.orig().getCoordinate(),s.dest().getCoordinate()])}return t.createMultiLineString(n)}},getVertexUniqueEdges:function(t){for(var e=new _,n=new J,i=this.quadEdges.iterator();i.hasNext();){var r=i.next(),s=r.orig();n.contains(s)||(n.add(s),!t&&this.isFrameVertex(s)||e.add(r));var o=r.sym(),a=o.orig();n.contains(a)||(n.add(a),!t&&this.isFrameVertex(a)||e.add(o))}return e},getTriangleEdges:function(t){var e=new Is;return this.visitTriangles(e,t),e.getTriangleEdges()},getPrimaryEdges:function(t){this.visitedKey++;var e=new _,n=new re;n.push(this.startingEdge);for(var i=new J;!n.empty();){var r=n.pop();if(!i.contains(r)){var s=r.getPrimary();!t&&this.isFrameEdge(s)||e.add(s),n.push(r.oNext()),n.push(r.sym().oNext()),i.add(r),i.add(r.sym())}}return e},delete:function(t){ys.splice(t,t.oPrev()),ys.splice(t.sym(),t.sym().oPrev());var e=t.sym(),n=t.rot(),i=t.rot().sym();this.quadEdges.remove(t),this.quadEdges.remove(e),this.quadEdges.remove(n),this.quadEdges.remove(i),t.delete(),e.delete(),n.delete(),i.delete()},locateFromEdge:function(t,e){for(var n=0,i=this.quadEdges.size(),r=e;;){if(++n>i)throw new _s(r.toLineSegment());if(t.equals(r.orig())||t.equals(r.dest()))break;if(t.rightOf(r))r=r.sym();else if(t.rightOf(r.oNext())){if(t.rightOf(r.dPrev()))break;r=r.dPrev()}else r=r.oNext()}return r},getTolerance:function(){return this.tolerance},getVoronoiCellPolygons:function(t){this.visitTriangles(new Ss,!0);for(var e=new _,n=this.getVertexUniqueEdges(!1).iterator();n.hasNext();){var i=n.next();e.add(this.getVoronoiCellPolygon(i,t))}return e},getVoronoiDiagram:function(t){var e=this.getVoronoiCellPolygons(t);return t.createGeometryCollection(jt.toGeometryArray(e))},getTriangles:function(t){for(var e=this.getTriangleCoordinates(!1),n=new Array(e.size()).fill(null),i=0,r=e.iterator();r.hasNext();){var s=r.next();n[i++]=t.createPolygon(t.createLinearRing(s),null)}return t.createGeometryCollection(n)},insertSite:function(t){var e=this.locate(t);if(t.equals(e.orig(),this.tolerance)||t.equals(e.dest(),this.tolerance))return e;var n=this.makeEdge(e.orig(),t);ys.splice(n,e);var i=n;do{e=(n=this.connect(e,n.sym())).oPrev()}while(e.lNext()!==i);return i},locate:function(){if(1===arguments.length){if(arguments[0]instanceof ps){var t=arguments[0];return this.locator.locate(t)}if(arguments[0]instanceof d){var e=arguments[0];return this.locator.locate(new ps(e))}}else if(2===arguments.length){var n=arguments[0],i=arguments[1],r=this.locator.locate(new ps(n));if(null===r)return null;var s=r;r.dest().getCoordinate().equals2D(n)&&(s=r.sym());var o=s;do{if(o.dest().getCoordinate().equals2D(i))return o;o=o.oNext()}while(o!==s);return null}},interfaces_:function(){return[]},getClass:function(){return Es}}),Es.getTriangleEdges=function(t,e){if(e[0]=t,e[1]=e[0].lNext(),e[2]=e[1].lNext(),e[2].lNext()!==e[0])throw new i("Edges do not form a triangle")},e(Ss.prototype,{visit:function(t){for(var e=t[0].orig().getCoordinate(),n=t[1].orig().getCoordinate(),i=t[2].orig().getCoordinate(),r=new ps(Qn.circumcentre(e,n,i)),s=0;3>s;s++)t[s].rot().setOrig(r)},interfaces_:function(){return[bs]},getClass:function(){return Ss}}),e(Is.prototype,{getTriangleEdges:function(){return this.triList},visit:function(t){this.triList.add(t.clone())},interfaces_:function(){return[bs]},getClass:function(){return Is}}),e(Cs.prototype,{visit:function(t){this.triList.add([t[0].orig(),t[1].orig(),t[2].orig()])},getTriangleVertices:function(){return this.triList},interfaces_:function(){return[bs]},getClass:function(){return Cs}}),e(Ms.prototype,{checkTriangleSize:function(t){t.length>=2?Ht.toLineString(t[0],t[1]):t.length>=1&&Ht.toPoint(t[0])},visit:function(t){this.coordList.clear();for(var e=0;3>e;e++){var n=t[e].orig();this.coordList.add(n.getCoordinate())}if(this.coordList.size()>0){this.coordList.closeRing();var i=this.coordList.toCoordinateArray();if(4!==i.length)return null;this.triCoords.add(i)}},getTriangles:function(){return this.triCoords},interfaces_:function(){return[bs]},getClass:function(){return Ms}}),Es.TriangleCircumcentreVisitor=Ss,Es.TriangleEdgesListVisitor=Is,Es.TriangleVertexListVisitor=Cs,Es.TriangleCoordinatesVisitor=Ms,Es.EDGE_COINCIDENCE_TOL_FACTOR=1e3,e(Rs.prototype,{getLineSegment:function(){return this.ls},getEndZ:function(){return this.ls.getCoordinate(1).z},getStartZ:function(){return this.ls.getCoordinate(0).z},intersection:function(t){return this.ls.intersection(t.getLineSegment())},getStart:function(){return this.ls.getCoordinate(0)},getEnd:function(){return this.ls.getCoordinate(1)},getEndY:function(){return this.ls.getCoordinate(1).y},getStartX:function(){return this.ls.getCoordinate(0).x},equalsTopo:function(t){return this.ls.equalsTopo(t.getLineSegment())},getStartY:function(){return this.ls.getCoordinate(0).y},setData:function(t){this.data=t},getData:function(){return this.data},getEndX:function(){return this.ls.getCoordinate(1).x},toString:function(){return this.ls.toString()},interfaces_:function(){return[]},getClass:function(){return Rs}}),e(Ps.prototype,{visit:function(t){},interfaces_:function(){return[]},getClass:function(){return Ps}}),e(Ts.prototype,{isRepeated:function(){return this.count>1},getRight:function(){return this.right},getCoordinate:function(){return this.p},setLeft:function(t){this.left=t},getX:function(){return this.p.x},getData:function(){return this.data},getCount:function(){return this.count},getLeft:function(){return this.left},getY:function(){return this.p.y},increment:function(){this.count=this.count+1},setRight:function(t){this.right=t},interfaces_:function(){return[]},getClass:function(){return Ts}}),e(Ns.prototype,{insert:function(){if(1===arguments.length){var t=arguments[0];return this.insert(t,null)}if(2===arguments.length){var e=arguments[0],n=arguments[1];if(null===this.root)return this.root=new Ts(e,n),this.root;if(this.tolerance>0){var i=this.findBestMatchNode(e);if(null!==i)return i.increment(),i}return this.insertExact(e,n)}},query:function(){var t=arguments,e=this;if(1===arguments.length){var n=arguments[0],i=new _;return this.query(n,i),i}if(2===arguments.length)if(arguments[0]instanceof E&&M(arguments[1],v))!function(){var n=t[0],i=t[1];e.queryNode(e.root,n,!0,{interfaces_:function(){return[Ps]},visit:function(t){i.add(t)}})}();else if(arguments[0]instanceof E&&M(arguments[1],Ps)){var r=arguments[0],s=arguments[1];this.queryNode(this.root,r,!0,s)}},queryNode:function(t,e,n,i){if(null===t)return null;var r=null,s=null,o=null;n?(r=e.getMinX(),s=e.getMaxX(),o=t.getX()):(r=e.getMinY(),s=e.getMaxY(),o=t.getY());var a=s>=o;o>r&&this.queryNode(t.getLeft(),e,!n,i),e.contains(t.getCoordinate())&&i.visit(t),a&&this.queryNode(t.getRight(),e,!n,i)},findBestMatchNode:function(t){var e=new As(t,this.tolerance);return this.query(e.queryEnvelope(),e),e.getNode()},isEmpty:function(){return null===this.root},insertExact:function(t,e){for(var n=this.root,i=this.root,r=!0,s=!0;null!==n;){if(null!==n&&t.distance(n.getCoordinate())<=this.tolerance)return n.increment(),n;s=r?t.x<n.getX():t.y<n.getY(),i=n,n=s?n.getLeft():n.getRight(),r=!r}this.numberOfNodes=this.numberOfNodes+1;var o=new Ts(t,e);return s?i.setLeft(o):i.setRight(o),o},interfaces_:function(){return[]},getClass:function(){return Ns}}),Ns.toCoordinates=function(){if(1===arguments.length){var t=arguments[0];return Ns.toCoordinates(t,!1)}if(2===arguments.length){for(var e=arguments[0],n=arguments[1],i=new b,r=e.iterator();r.hasNext();)for(var s=r.next(),o=n?s.getCount():1,a=0;o>a;a++)i.add(s.getCoordinate(),!0);return i.toCoordinateArray()}},e(As.prototype,{visit:function(t){var e=this.p.distance(t.getCoordinate());if(!(e<=this.tolerance))return null;var n=!1;(null===this.matchNode||e<this.matchDist||null!==this.matchNode&&e===this.matchDist&&t.getCoordinate().compareTo(this.matchNode.getCoordinate())<1)&&(n=!0),n&&(this.matchNode=t,this.matchDist=e)},queryEnvelope:function(){var t=new E(this.p);return t.expandBy(this.tolerance),t},getNode:function(){return this.matchNode},interfaces_:function(){return[Ps]},getClass:function(){return As}}),Ns.BestMatchVisitor=As,e(ks.prototype,{getInitialVertices:function(){return this.initialVertices},getKDT:function(){return this.kdt},enforceConstraints:function(){this.addConstraintVertices();var t=0,e=0;do{e=this.enforceGabriel(this.segments),t++}while(e>0&&t<ks.MAX_SPLIT_ITER)},insertSites:function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();this.insertSite(n)}},getVertexFactory:function(){return this.vertexFactory},getPointArray:function(){for(var t=new Array(this.initialVertices.size()+this.segVertices.size()).fill(null),e=0,n=this.initialVertices.iterator();n.hasNext();){var i=n.next();t[e++]=i.getCoordinate()}for(var r=this.segVertices.iterator();r.hasNext();)i=r.next(),t[e++]=i.getCoordinate();return t},setConstraints:function(t,e){this.segments=t,this.segVertices=e},computeConvexHull:function(){var t=new jt,e=new oe(this.getPointArray(),t);this.convexHull=e.getConvexHull()},addConstraintVertices:function(){this.computeConvexHull(),this.insertSites(this.segVertices)},findNonGabrielPoint:function(t){var e=t.getStart(),n=t.getEnd(),i=new d((e.x+n.x)/2,(e.y+n.y)/2),s=e.distance(i),o=new E(i);o.expandBy(s);for(var a=this.kdt.query(o),l=null,h=r.MAX_VALUE,u=a.iterator();u.hasNext();){var c=u.next().getCoordinate();if(!c.equals2D(e)&&!c.equals2D(n)){var f=i.distance(c);s>f&&(null===l||h>f)&&(l=c,h=f)}}return l},getConstraintSegments:function(){return this.segments},setSplitPointFinder:function(t){this.splitFinder=t},getConvexHull:function(){return this.convexHull},getTolerance:function(){return this.tolerance},enforceGabriel:function(t){for(var e=new _,n=0,i=new _,r=t.iterator();r.hasNext();){var s=r.next(),o=this.findNonGabrielPoint(s);if(null!==o){this.splitPt=this.splitFinder.findSplitPoint(s,o);var a=this.createVertex(this.splitPt,s),l=(this.insertSite(a),new Rs(s.getStartX(),s.getStartY(),s.getStartZ(),a.getX(),a.getY(),a.getZ(),s.getData())),h=new Rs(a.getX(),a.getY(),a.getZ(),s.getEndX(),s.getEndY(),s.getEndZ(),s.getData());e.add(l),e.add(h),i.add(s),n+=1}}return t.removeAll(i),t.addAll(e),n},createVertex:function(){if(1===arguments.length){var t=arguments[0],e=null;return null!==this.vertexFactory?this.vertexFactory.createVertex(t,null):new ms(t)}if(2===arguments.length){var n=arguments[0],i=arguments[1];return e=null,(e=null!==this.vertexFactory?this.vertexFactory.createVertex(n,i):new ms(n)).setOnConstraint(!0),e}},getSubdivision:function(){return this.subdiv},computeBoundingBox:function(){var t=ks.computeVertexEnvelope(this.initialVertices),e=ks.computeVertexEnvelope(this.segVertices),n=new E(t);n.expandToInclude(e);var i=.2*n.getWidth(),r=.2*n.getHeight(),s=Math.max(i,r);this.computeAreaEnv=new E(n),this.computeAreaEnv.expandBy(s)},setVertexFactory:function(t){this.vertexFactory=t},formInitialDelaunay:function(){this.computeBoundingBox(),this.subdiv=new Es(this.computeAreaEnv,this.tolerance),this.subdiv.setLocator(new xs(this.subdiv)),this.incDel=new vs(this.subdiv),this.insertSites(this.initialVertices)},insertSite:function(){if(arguments[0]instanceof ms){var t=arguments[0],e=this.kdt.insert(t.getCoordinate(),t);if(e.isRepeated()){var n=e.getData();return n.merge(t),n}return this.incDel.insertSite(t),t}if(arguments[0]instanceof d){var i=arguments[0];this.insertSite(this.createVertex(i))}},interfaces_:function(){return[]},getClass:function(){return ks}}),ks.computeVertexEnvelope=function(t){for(var e=new E,n=t.iterator();n.hasNext();){var i=n.next();e.expandToInclude(i.getCoordinate())}return e},ks.MAX_SPLIT_ITER=99,e(Ls.prototype,{create:function(){if(null!==this.subdiv)return null;var t=Ls.envelope(this.siteCoords),e=Ls.toVertices(this.siteCoords);this.subdiv=new Es(t,this.tolerance),new vs(this.subdiv).insertSites(e)},setTolerance:function(t){this.tolerance=t},setSites:function(){if(arguments[0]instanceof G){var t=arguments[0];this.siteCoords=Ls.extractUniqueCoordinates(t)}else if(M(arguments[0],m)){var e=arguments[0];this.siteCoords=Ls.unique(j.toCoordinateArray(e))}},getEdges:function(t){return this.create(),this.subdiv.getEdges(t)},getSubdivision:function(){return this.create(),this.subdiv},getTriangles:function(t){return this.create(),this.subdiv.getTriangles(t)},interfaces_:function(){return[]},getClass:function(){return Ls}}),Ls.extractUniqueCoordinates=function(t){if(null===t)return new b;var e=t.getCoordinates();return Ls.unique(e)},Ls.envelope=function(t){for(var e=new E,n=t.iterator();n.hasNext();){var i=n.next();e.expandToInclude(i)}return e},Ls.unique=function(t){var e=j.copyDeep(t);return lt.sort(e),new b(e,!1)},Ls.toVertices=function(t){for(var e=new _,n=t.iterator();n.hasNext();){var i=n.next();e.add(new ps(i))}return e},e(Os.prototype,{createSiteVertices:function(t){for(var e=new _,n=t.iterator();n.hasNext();){var i=n.next();this.constraintVertexMap.containsKey(i)||e.add(new ms(i))}return e},create:function(){if(null!==this.subdiv)return null;var t=Ls.envelope(this.siteCoords),e=new _;null!==this.constraintLines&&(t.expandToInclude(this.constraintLines.getEnvelopeInternal()),this.createVertices(this.constraintLines),e=Os.createConstraintSegments(this.constraintLines));var n=new ks(this.createSiteVertices(this.siteCoords),this.tolerance);n.setConstraints(e,new _(this.constraintVertexMap.values())),n.formInitialDelaunay(),n.enforceConstraints(),this.subdiv=n.getSubdivision()},setTolerance:function(t){this.tolerance=t},setConstraints:function(t){this.constraintLines=t},setSites:function(t){this.siteCoords=Ls.extractUniqueCoordinates(t)},getEdges:function(t){return this.create(),this.subdiv.getEdges(t)},getSubdivision:function(){return this.create(),this.subdiv},getTriangles:function(t){return this.create(),this.subdiv.getTriangles(t)},createVertices:function(t){for(var e=t.getCoordinates(),n=0;n<e.length;n++){var i=new ms(e[n]);this.constraintVertexMap.put(e[n],i)}},interfaces_:function(){return[]},getClass:function(){return Os}}),Os.createConstraintSegments=function(){if(1===arguments.length){for(var t=arguments[0],e=Tn.getLines(t),n=new _,i=e.iterator();i.hasNext();){var r=i.next();Os.createConstraintSegments(r,n)}return n}if(2===arguments.length){var s=arguments[1],o=arguments[0].getCoordinates();for(i=1;i<o.length;i++)s.add(new Rs(o[i-1],o[i]))}},e(Ds.prototype,{create:function(){if(null!==this.subdiv)return null;var t=Ls.envelope(this.siteCoords);this.diagramEnv=t;var e=Math.max(this.diagramEnv.getWidth(),this.diagramEnv.getHeight());this.diagramEnv.expandBy(e),null!==this.clipEnv&&this.diagramEnv.expandToInclude(this.clipEnv);var n=Ls.toVertices(this.siteCoords);this.subdiv=new Es(t,this.tolerance),new vs(this.subdiv).insertSites(n)},getDiagram:function(t){this.create();var e=this.subdiv.getVoronoiDiagram(t);return Ds.clipGeometryCollection(e,this.diagramEnv)},setTolerance:function(t){this.tolerance=t},setSites:function(){if(arguments[0]instanceof G){var t=arguments[0];this.siteCoords=Ls.extractUniqueCoordinates(t)}else if(M(arguments[0],m)){var e=arguments[0];this.siteCoords=Ls.unique(j.toCoordinateArray(e))}},setClipEnvelope:function(t){this.clipEnv=t},getSubdivision:function(){return this.create(),this.subdiv},interfaces_:function(){return[]},getClass:function(){return Ds}}),Ds.clipGeometryCollection=function(t,e){for(var n=t.getFactory().toGeometry(e),i=new _,r=0;r<t.getNumGeometries();r++){var s=t.getGeometryN(r),o=null;e.contains(s.getEnvelopeInternal())?o=s:e.intersects(s.getEnvelopeInternal())&&(o=n.intersection(s)).setUserData(s.getUserData()),null===o||o.isEmpty()||i.add(o)}return t.getFactory().createGeometryCollection(jt.toGeometryArray(i))};var xo=Object.freeze({ConformingDelaunayTriangulationBuilder:Os,DelaunayTriangulationBuilder:Ls,VoronoiDiagramBuilder:Ds});e(Fs.prototype,{interfaces_:function(){return[]},getClass:function(){return Fs}}),Fs.union=function(t,e){if(t.isEmpty()||e.isEmpty()){if(t.isEmpty()&&e.isEmpty())return Xn.createEmptyResult(Xn.UNION,t,e,t.getFactory());if(t.isEmpty())return e.copy();if(e.isEmpty())return t.copy()}return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),Wn.overlayOp(t,e,Xn.UNION)},e(G.prototype,{equalsTopo:function(t){return!!this.getEnvelopeInternal().equals(t.getEnvelopeInternal())&&Tr.relate(this,t).isEquals(this.getDimension(),t.getDimension())},union:function(){if(0===arguments.length)return Or.union(this);if(1===arguments.length){var t=arguments[0];return Fs.union(this,t)}},isValid:function(){return Zr.isValid(this)},intersection:function(t){if(this.isEmpty()||t.isEmpty())return Xn.createEmptyResult(Xn.INTERSECTION,this,t,this.factory);if(this.isGeometryCollection()){var e=t;return Ke.map(this,{interfaces_:function(){return[MapOp]},map:function(t){return t.intersection(e)}})}return this.checkNotGeometryCollection(this),this.checkNotGeometryCollection(t),Wn.overlayOp(this,t,Xn.INTERSECTION)},covers:function(t){return Tr.covers(this,t)},coveredBy:function(t){return Tr.coveredBy(this,t)},touches:function(t){return Tr.touches(this,t)},intersects:function(t){return Tr.intersects(this,t)},within:function(t){return Tr.within(this,t)},overlaps:function(t){return Tr.overlaps(this,t)},disjoint:function(t){return Tr.disjoint(this,t)},crosses:function(t){return Tr.crosses(this,t)},buffer:function(){if(1===arguments.length){var t=arguments[0];return ji.bufferOp(this,t)}if(2===arguments.length){var e=arguments[0],n=arguments[1];return ji.bufferOp(this,e,n)}if(3===arguments.length){var i=arguments[0],r=arguments[1],s=arguments[2];return ji.bufferOp(this,i,r,s)}},convexHull:function(){return new oe(this).getConvexHull()},relate:function(){for(var t=arguments.length,e=Array(t),n=0;t>n;n++)e[n]=arguments[n];return Tr.relate.apply(Tr,[this].concat(e))},getCentroid:function(){if(this.isEmpty())return this.factory.createPoint();var t=ne.getCentroid(this);return this.createPointFromInternalCoord(t,this)},getInteriorPoint:function(){if(this.isEmpty())return this.factory.createPoint();var t,e=this.getDimension();return t=0===e?new Kn(this).getInteriorPoint():1===e?new Zn(this).getInteriorPoint():new Hn(this).getInteriorPoint(),this.createPointFromInternalCoord(t,this)},symDifference:function(t){if(this.isEmpty()||t.isEmpty()){if(this.isEmpty()&&t.isEmpty())return Xn.createEmptyResult(Xn.SYMDIFFERENCE,this,t,this.factory);if(this.isEmpty())return t.copy();if(t.isEmpty())return this.copy()}return this.checkNotGeometryCollection(this),this.checkNotGeometryCollection(t),Wn.overlayOp(this,t,Xn.SYMDIFFERENCE)},createPointFromInternalCoord:function(t,e){return e.getPrecisionModel().makePrecise(t),e.getFactory().createPoint(t)},toText:function(){return(new Ht).write(this)},toString:function(){this.toText()},contains:function(t){return Tr.contains(this,t)},difference:function(t){return this.isEmpty()?Xn.createEmptyResult(Xn.DIFFERENCE,this,t,this.factory):t.isEmpty()?this.copy():(this.checkNotGeometryCollection(this),this.checkNotGeometryCollection(t),Wn.overlayOp(this,t,Xn.DIFFERENCE))},isSimple:function(){return new Si(this).isSimple()},isWithinDistance:function(t,e){return!(this.getEnvelopeInternal().distance(t.getEnvelopeInternal())>e)&&Ki.isWithinDistance(this,t,e)},distance:function(t){return Ki.distance(this,t)},isEquivalentClass:function(t){return this.getClass()===t.getClass()}});t.version="1.1.2 (248dab8)",t.algorithm=Ks,t.densify=Js,t.dissolve=Qs,t.geom=$s,t.index=no,t.io=oo,t.noding=ao,t.operation=yo,t.precision=vo,t.simplify=wo,t.triangulate=xo}(e)},5520:t=>{!function(){function e(t){for(var e=0,r=t.length-1,s=void 0,o=void 0,a=void 0,l=i(e,r);;){if(r<=e)return t[l];if(r==e+1)return t[e]>t[r]&&n(t,e,r),t[l];for(t[s=i(e,r)]>t[r]&&n(t,s,r),t[e]>t[r]&&n(t,e,r),t[s]>t[e]&&n(t,s,e),n(t,s,e+1),o=e+1,a=r;;){do{o++}while(t[e]>t[o]);do{a--}while(t[a]>t[e]);if(a<o)break;n(t,o,a)}n(t,e,a),a<=l&&(e=o),a>=l&&(r=a-1)}}var n=function(t,e,n){var i;return i=[t[n],t[e]],t[e]=i[0],t[n]=i[1],i},i=function(t,e){return~~((t+e)/2)};t.exports?t.exports=e:window.median=e}()},4805:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>r});var i=n(4091);function r(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!(0,i.isAnyArray)(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");if(void 0!==n.output){if(!(0,i.isAnyArray)(n.output))throw new TypeError("output option must be an array if specified");e=n.output}else e=new Array(t.length);var r=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!(0,i.isAnyArray)(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");var n=e.fromIndex,r=void 0===n?0:n,s=e.toIndex,o=void 0===s?t.length:s;if(r<0||r>=t.length||!Number.isInteger(r))throw new Error("fromIndex must be a positive integer smaller than length");if(o<=r||o>t.length||!Number.isInteger(o))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var a=t[r],l=r+1;l<o;l++)t[l]<a&&(a=t[l]);return a}(t),s=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!(0,i.isAnyArray)(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");var n=e.fromIndex,r=void 0===n?0:n,s=e.toIndex,o=void 0===s?t.length:s;if(r<0||r>=t.length||!Number.isInteger(r))throw new Error("fromIndex must be a positive integer smaller than length");if(o<=r||o>t.length||!Number.isInteger(o))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var a=t[r],l=r+1;l<o;l++)t[l]>a&&(a=t[l]);return a}(t);if(r===s)throw new RangeError("minimum and maximum input values are equal. Cannot rescale a constant array");var o=n.min,a=void 0===o?n.autoMinMax?r:0:o,l=n.max,h=void 0===l?n.autoMinMax?s:1:l;if(a>=h)throw new RangeError("min option must be smaller than max option");for(var u=(h-a)/(s-r),c=0;c<t.length;c++)e[c]=(t[c]-r)*u+a;return e}},530:t=>{"use strict";function e(t){this.value=t,this.parent=null,this.rank=0}t.exports=class{constructor(){this.nodes=new Map}add(t){var n=this.nodes.get(t);return n||(n=new e(t),this.nodes.set(t,n)),n}union(t,e){const n=this.find(t),i=this.find(e);n!==i&&(n.rank<i.rank?n.parent=i:n.rank>i.rank?i.parent=n:(i.parent=n,n.rank++))}find(t){for(var e=t;null!==e.parent;)e=e.parent;for(var n=t;null!==n.parent;){var i=n;n=n.parent,i.parent=e}return e}connected(t,e){return this.find(t)===this.find(e)}}},4953:(t,e,n)=>{"use strict";function i(t,e){let n=0;for(let i=0;i<t.length;i++)n+=(t[i]-e[i])*(t[i]-e[i]);return n}function r(t,e){return Math.sqrt(i(t,e))}n.r(e),n.d(e,{euclidean:()=>r,squaredEuclidean:()=>i})},7345:(t,e,n)=>{"use strict";var i=n(5571),r={DEBUG:!1,ifft2DArray:function(t,e,n){var r=new Array(e*n),s=e/2,o=2*(n-1);i.init(s);for(var a={re:new Array(s),im:new Array(s)},l=0;l<n;l++){for(var h=s-1;h>=0;h--)a.re[h]=t[2*h*n+l],a.im[h]=t[(2*h+1)*n+l];for(i.bt(a.re,a.im),h=s-1;h>=0;h--)r[2*h*n+l]=a.re[h],r[(2*h+1)*n+l]=a.im[h]}var u=new Array(s*o);i.init(o);var c={re:new Array(o),im:new Array(o)},f=o*s;for(h=0;h<e;h+=2){for(c.re[0]=r[h*n],c.im[0]=r[(h+1)*n],l=1;l<n;l++)c.re[l]=r[h*n+l],c.im[l]=r[(h+1)*n+l],c.re[o-l]=r[h*n+l],c.im[o-l]=-r[(h+1)*n+l];i.bt(c.re,c.im);var d=h/2*o;for(l=o-1;l>=0;l--)u[d+l]=c.re[l]/f}return u},fft2DArray:function(t,e,n,r){Object.assign({},{inplace:!0});var s=n/2+1,o=2*e,a=new Array(o*s);i.init(n);for(var l,h,u,c,f,d={re:new Array(n),im:new Array(n)},g={re:new Array(n),im:new Array(n)},p={re:new Array(n),im:new Array(n)},m=0;m<e/2;m++){l=2*m*n,d.re=t.slice(l,l+n),l=(2*m+1)*n,d.im=t.slice(l,l+n),i.fft1d(d.re,d.im),this.reconstructTwoRealFFT(d,g,p),h=4*m*s,u=(4*m+1)*s,c=(4*m+2)*s,f=(4*m+3)*s;for(var y=s-1;y>=0;y--)a[h+y]=g.re[y],a[u+y]=g.im[y],a[c+y]=p.re[y],a[f+y]=p.im[y]}g=null,p=null;var v=new Array(o*s);i.init(e);for(var w={re:new Array(e),im:new Array(e)},x=s-1;x>=0;x--){for(m=e-1;m>=0;m--)w.re[m]=a[2*m*s+x],w.im[m]=a[(2*m+1)*s+x],isNaN(w.re[m])&&(w.re[m]=0),isNaN(w.im[m])&&(w.im[m]=0);for(i.fft1d(w.re,w.im),m=e-1;m>=0;m--)v[2*m*s+x]=w.re[m],v[(2*m+1)*s+x]=w.im[m]}return v},reconstructTwoRealFFT:function(t,e,n){var i,r,s,o,a,l=t.re.length;e.re[0]=t.re[0],e.im[0]=0,n.re[0]=t.im[0],n.im[0]=0;for(var h=l/2;h>0;h--)a=l-h,i=.5*(t.re[h]-t.re[a]),r=.5*(t.re[h]+t.re[a]),s=.5*(t.im[h]-t.im[a]),o=.5*(t.im[h]+t.im[a]),e.re[h]=r,e.im[h]=s,e.re[a]=r,e.im[a]=-s,n.re[h]=o,n.im[h]=-i,n.re[a]=o,n.im[a]=i},convolute2DI:function(t,e,n,i){for(var r,s,o=0;o<n/2;o++)for(var a=0;a<i;a++)r=t[2*o*i+a]*e[2*o*i+a]-t[(2*o+1)*i+a]*e[(2*o+1)*i+a],s=t[2*o*i+a]*e[(2*o+1)*i+a]+t[(2*o+1)*i+a]*e[2*o*i+a],t[2*o*i+a]=r,t[(2*o+1)*i+a]=s},convolute:function(t,e,n,i,r){for(var s=new Array(i*n),o=0;o<n*i;o++)s[o]=t[o];s=this.fft2DArray(s,n,i);var a,l=e.length,h=e[0].length,u=new Array(i*n);for(o=0;o<i*n;o++)u[o]=0;for(var c=Math.floor((l-1)/2),f=Math.floor((h-1)/2),d=0;d<l;d++){a=(d-c+n)%n;for(var g=0;g<h;g++)u[a*i+(g-f+i)%i]=e[d][g]}u=this.fft2DArray(u,n,i);var p=2*n,m=i/2+1;return this.convolute2DI(s,u,p,m),this.ifft2DArray(s,p,m)},toRadix2:function(t,e,n){var i,r,s,o,a=n,l=e;if(0===n||0!=(n&n-1)){for(a=0;n>>++a!=0;);a=1<<a}if(0===e||0!=(e&e-1)){for(l=0;e>>++l!=0;);l=1<<l}if(l==e&&a==n)return{data:t,rows:e,cols:n};var h=new Array(l*a),u=Math.floor((l-e)/2)-e,c=Math.floor((a-n)/2)-n;for(i=0;i<l;i++)for(s=i*a,o=(i-u)%e*n,r=0;r<a;r++)h[s+r]=t[o+(r-c)%n];return{data:h,rows:l,cols:a}},crop:function(t,e,n,i,r,s){if(e==i&&n==r)return t;Object.assign({},s);var o,a,l,h,u=new Array(r*i),c=Math.floor((e-i)/2),f=Math.floor((n-r)/2);for(l=0;l<i;l++)for(o=l*r,a=(l+c)*n,h=0;h<r;h++)u[o+h]=t[a+(h+f)];return u}};t.exports=r},5571:function(t,e){(function(){var t;(t=e).toString=function(){return"version 0.3.0, released 2013-03"};for(var n=0,i=null,r=null,s={init:function(t){if(0===t||0!=(t&t-1))throw new Error("init: radix-2 required");n=t,s._initArray(),s._makeBitReversalTable(),s._makeCosSinTable()},fft1d:function(t,e){s.fft(t,e,1)},ifft1d:function(t,e){var i=1/n;s.fft(t,e,-1);for(var r=0;r<n;r++)t[r]*=i,e[r]*=i},bt1d:function(t,e){s.fft(t,e,-1)},fft2d:function(t,e){for(var i=[],r=[],o=0,a=0;a<n;a++){o=a*n;for(var l=0;l<n;l++)i[l]=t[l+o],r[l]=e[l+o];s.fft1d(i,r);for(var h=0;h<n;h++)t[h+o]=i[h],e[h+o]=r[h]}for(var u=0;u<n;u++){for(var c=0;c<n;c++)o=u+c*n,i[c]=t[o],r[c]=e[o];s.fft1d(i,r);for(var f=0;f<n;f++)t[o=u+f*n]=i[f],e[o]=r[f]}},ifft2d:function(t,e){for(var i=[],r=[],o=0,a=0;a<n;a++){o=a*n;for(var l=0;l<n;l++)i[l]=t[l+o],r[l]=e[l+o];s.ifft1d(i,r);for(var h=0;h<n;h++)t[h+o]=i[h],e[h+o]=r[h]}for(var u=0;u<n;u++){for(var c=0;c<n;c++)o=u+c*n,i[c]=t[o],r[c]=e[o];s.ifft1d(i,r);for(var f=0;f<n;f++)t[o=u+f*n]=i[f],e[o]=r[f]}},fft:function(t,e,s){for(var o,a,l,h,u,c,f,d,g,p=n>>2,m=0;m<n;m++)m<(h=i[m])&&(u=t[m],t[m]=t[h],t[h]=u,u=e[m],e[m]=e[h],e[h]=u);for(var y=1;y<n;y<<=1){a=0,o=n/(y<<1);for(var v=0;v<y;v++){c=r[a+p],f=s*r[a];for(var w=v;w<n;w+=y<<1)d=c*t[l=w+y]+f*e[l],g=c*e[l]-f*t[l],t[l]=t[w]-d,t[w]+=d,e[l]=e[w]-g,e[w]+=g;a+=o}}},_initArray:function(){i="undefined"!=typeof Uint32Array?new Uint32Array(n):[],r="undefined"!=typeof Float64Array?new Float64Array(1.25*n):[]},_paddingZero:function(){},_makeBitReversalTable:function(){var t=0,e=0,r=0;for(i[0]=0;++t<n;){for(r=n>>1;r<=e;)e-=r,r>>=1;e+=r,i[t]=e}},_makeCosSinTable:function(){var t=n>>1,e=n>>2,i=n>>3,s=t+e,o=Math.sin(Math.PI/n),a=2*o*o,l=Math.sqrt(a*(2-a)),h=r[e]=1,u=r[0]=0;o=2*a;for(var c=1;c<i;c++)a+=o*(h-=a),l-=o*(u+=l),r[c]=u,r[e-c]=h;0!==i&&(r[i]=Math.sqrt(.5));for(var f=0;f<e;f++)r[t-f]=r[f];for(var d=0;d<s;d++)r[d+t]=-r[d]}},o=["init","fft1d","ifft1d","fft2d","ifft2d"],a=0;a<o.length;a++)t[o[a]]=s[o[a]];return t.bt=s.bt1d,t.fft=s.fft1d,t.ifft=s.ifft1d,t}).call(this)},3910:(t,e,n)=>{"use strict";e.FFTUtils=n(7345),n(5571)},8881:(t,e,n)=>{"use strict";const{squaredEuclidean:i}=n(4953),r={sigma:1};t.exports=class{constructor(t){t=Object.assign({},r,t),this.sigma=t.sigma,this.divisor=2*t.sigma*t.sigma}compute(t,e){const n=i(t,e);return Math.exp(-n/this.divisor)}}},4229:t=>{"use strict";const e={degree:1,constant:1,scale:1};t.exports=class{constructor(t){t=Object.assign({},e,t),this.degree=t.degree,this.constant=t.constant,this.scale=t.scale}compute(t,e){for(var n=0,i=0;i<t.length;i++)n+=t[i]*e[i];return Math.pow(this.scale*n+this.constant,this.degree)}}},7613:t=>{"use strict";const e={alpha:.01,constant:-Math.E};t.exports=class{constructor(t){t=Object.assign({},e,t),this.alpha=t.alpha,this.constant=t.constant}compute(t,e){for(var n=0,i=0;i<t.length;i++)n+=t[i]*e[i];return Math.tanh(this.alpha*n+this.constant)}}},6952:(t,e,n)=>{"use strict";const{Matrix:i,MatrixTransposeView:r}=n(8406),s=n(8881),o=n(4229),a=n(7613),l=n(8541),h=n(9176),u=n(3316),c=n(1960),f={gaussian:s,rbf:s,polynomial:o,poly:o,anova:l,cauchy:h,exponential:u,histogram:c,min:c,laplacian:n(8557),multiquadratic:n(8609),rational:n(3029),sigmoid:a,mlp:a};t.exports=class{constructor(t,e){if(this.kernelType=t,"linear"!==t)if("string"==typeof t){t=t.toLowerCase();var n=f[t];if(!n)throw new Error(`unsupported kernel type: ${t}`);this.kernelFunction=new n(e)}else{if("object"!=typeof t||"function"!=typeof t.compute)throw new TypeError("first argument must be a valid kernel type or instance");this.kernelFunction=t}}compute(t,e){if(t=i.checkMatrix(t),e=void 0===e?t:i.checkMatrix(e),"linear"===this.kernelType)return t.mmul(new r(e));const n=new i(t.rows,e.rows);if(t===e)for(let e=0;e<t.rows;e++)for(let i=e;i<t.rows;i++){const r=this.kernelFunction.compute(t.getRow(e),t.getRow(i));n.set(e,i,r),n.set(i,e,r)}else for(let i=0;i<t.rows;i++)for(let r=0;r<e.rows;r++)n.set(i,r,this.kernelFunction.compute(t.getRow(i),e.getRow(r)));return n}}},8541:t=>{"use strict";const e={sigma:1,degree:1};t.exports=class{constructor(t){t=Object.assign({},e,t),this.sigma=t.sigma,this.degree=t.degree}compute(t,e){for(var n=0,i=Math.min(t.length,e.length),r=1;r<=i;++r)n+=Math.pow(Math.exp(-this.sigma*Math.pow(Math.pow(t[r-1],r)-Math.pow(e[r-1],r),2)),this.degree);return n}}},9176:(t,e,n)=>{"use strict";const{squaredEuclidean:i}=n(4953),r={sigma:1};t.exports=class{constructor(t){t=Object.assign({},r,t),this.sigma=t.sigma}compute(t,e){return 1/(1+i(t,e)/(this.sigma*this.sigma))}}},3316:(t,e,n)=>{"use strict";const{euclidean:i}=n(4953),r={sigma:1};t.exports=class{constructor(t){t=Object.assign({},r,t),this.sigma=t.sigma,this.divisor=2*t.sigma*t.sigma}compute(t,e){const n=i(t,e);return Math.exp(-n/this.divisor)}}},1960:t=>{"use strict";t.exports=class{compute(t,e){for(var n=Math.min(t.length,e.length),i=0,r=0;r<n;++r)i+=Math.min(t[r],e[r]);return i}}},8557:(t,e,n)=>{"use strict";const{euclidean:i}=n(4953),r={sigma:1};t.exports=class{constructor(t){t=Object.assign({},r,t),this.sigma=t.sigma}compute(t,e){const n=i(t,e);return Math.exp(-n/this.sigma)}}},8609:(t,e,n)=>{"use strict";const{squaredEuclidean:i}=n(4953),r={constant:1};t.exports=class{constructor(t){t=Object.assign({},r,t),this.constant=t.constant}compute(t,e){return Math.sqrt(i(t,e)+this.constant*this.constant)}}},3029:(t,e,n)=>{"use strict";const{squaredEuclidean:i}=n(4953),r={constant:1};t.exports=class{constructor(t){t=Object.assign({},r,t),this.constant=t.constant}compute(t,e){const n=i(t,e);return 1-n/(n+this.constant)}}},414:(t,e,n)=>{var i=n(3910).FFTUtils;function r(t){var e,n,i=t;if("number"!=typeof t[0]){e=t.length,n=t[0].length,i=new Array(e*n);for(var r=0;r<e;r++)for(var s=0;s<n;s++)i[r*n+s]=t[r][s]}else{var o=Math.sqrt(t.length);Number.isInteger(o)&&(e=o,n=o)}return{data:i,rows:e,cols:n}}t.exports={fft:function(t,e,n){var s,o,a=r(t),l=a.data,h=Object.assign({normalize:!1,divisor:1,rows:a.rows,cols:a.cols},n);if(!h.rows||!h.cols)throw new Error("Invalid number of rows or columns "+s+" "+o);s=h.rows,o=h.cols;var u,c,f=h.divisor,d=e.length,g=e[0].length;if(h.normalize)for(f=0,u=0;u<d;u++)for(c=0;c<g;c++)f+=e[u][c];if(0===f)throw new RangeError("convolution: The divisor is equal to zero");var p=i.toRadix2(l,s,o),m=i.convolute(p.data,e,p.rows,p.cols);if(m=i.crop(m,p.rows,p.cols,s,o),0!=f&&1!=f)for(u=0;u<m.length;u++)m[u]/=f;return m},direct:function(t,e,n){var i,s,o=r(t),a=o.data,l=Object.assign({normalize:!1,divisor:1,rows:o.rows,cols:o.cols},n);if(!l.rows||!l.cols)throw new Error("Invalid number of rows or columns "+i+" "+s);i=l.rows,s=l.cols;var h,u,c,f,d,g,p=l.divisor,m=e.length,y=e[0].length;if(l.normalize)for(p=0,h=0;h<m;h++)for(u=0;u<y;u++)p+=e[h][u];if(0===p)throw new RangeError("convolution: The divisor is equal to zero");var v=new Array(i*s),w=Math.floor(m/2),x=Math.floor(y/2);for(f=0;f<i;f++)for(c=0;c<s;c++){for(d=0,u=0;u<m;u++)for(h=0;h<y;h++)g=e[m-u-1][y-h-1],d+=a[(f+u-w+i)%i*s+(c+h-x+s)%s]*g;v[f*s+c]=d/p}return v},kernelFactory:{LoG:function(t,e,n){var i=1e3;n&&n.factor&&(i=n.factor);var r,s,o,a,l=new Array(e);i*=-1;var h=(e-1)/2,u=2*t*t;for(r=0;r<e;r++)for(l[r]=new Array(e),a=(r-h)*(r-h),s=0;s<e;s++)o=-((s-h)*(s-h)+a)/u,l[r][s]=Math.round(i*(1+o)*Math.exp(o));return l}},matrix2Array:r}},8406:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(4091),r=n(4805);const s=" ".repeat(2),o=" ".repeat(4);function a(t,e={}){const{maxRows:n=15,maxColumns:i=10,maxNumSize:r=8,padMinus:a="auto"}=e;return`${t.constructor.name} {\n${s}[\n${o}${function(t,e,n,i,r){const{rows:s,columns:a}=t,h=Math.min(s,e),u=Math.min(a,n),c=[];if("auto"===r){r=!1;t:for(let e=0;e<h;e++)for(let n=0;n<u;n++)if(t.get(e,n)<0){r=!0;break t}}for(let e=0;e<h;e++){let n=[];for(let s=0;s<u;s++)n.push(l(t.get(e,s),i,r));c.push(`${n.join(" ")}`)}return u!==a&&(c[c.length-1]+=` ... ${a-n} more columns`),h!==s&&c.push(`... ${s-e} more rows`),c.join(`\n${o}`)}(t,n,i,r,a)}\n${s}]\n${s}rows: ${t.rows}\n${s}columns: ${t.columns}\n}`}function l(t,e,n){return(t>=0&&n?` ${h(t,e-1)}`:h(t,e)).padEnd(e)}function h(t,e){let n=t.toString();if(n.length<=e)return n;let i=t.toFixed(e);if(i.length>e&&(i=t.toFixed(Math.max(0,e-(i.length-e)))),i.length<=e&&!i.startsWith("0.000")&&!i.startsWith("-0.000"))return i;let r=t.toExponential(e);return r.length>e&&(r=t.toExponential(Math.max(0,e-(r.length-e)))),r.slice(0)}function u(t,e,n){let i=n?t.rows:t.rows-1;if(e<0||e>i)throw new RangeError("Row index out of range")}function c(t,e,n){let i=n?t.columns:t.columns-1;if(e<0||e>i)throw new RangeError("Column index out of range")}function f(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.columns)throw new RangeError("vector size must be the same as the number of columns");return e}function d(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.rows)throw new RangeError("vector size must be the same as the number of rows");return e}function g(t,e){if(!i.isAnyArray(e))throw new TypeError("row indices must be an array");for(let n=0;n<e.length;n++)if(e[n]<0||e[n]>=t.rows)throw new RangeError("row indices are out of range")}function p(t,e){if(!i.isAnyArray(e))throw new TypeError("column indices must be an array");for(let n=0;n<e.length;n++)if(e[n]<0||e[n]>=t.columns)throw new RangeError("column indices are out of range")}function m(t,e,n,i,r){if(5!==arguments.length)throw new RangeError("expected 4 arguments");if(v("startRow",e),v("endRow",n),v("startColumn",i),v("endColumn",r),e>n||i>r||e<0||e>=t.rows||n<0||n>=t.rows||i<0||i>=t.columns||r<0||r>=t.columns)throw new RangeError("Submatrix indices are out of range")}function y(t,e=0){let n=[];for(let i=0;i<t;i++)n.push(e);return n}function v(t,e){if("number"!=typeof e)throw new TypeError(`${t} must be a number`)}function w(t){if(t.isEmpty())throw new Error("Empty matrix has no elements to index")}class x{static from1DArray(t,e,n){if(t*e!==n.length)throw new RangeError("data length does not match given dimensions");let i=new b(t,e);for(let r=0;r<t;r++)for(let t=0;t<e;t++)i.set(r,t,n[r*e+t]);return i}static rowVector(t){let e=new b(1,t.length);for(let n=0;n<t.length;n++)e.set(0,n,t[n]);return e}static columnVector(t){let e=new b(t.length,1);for(let n=0;n<t.length;n++)e.set(n,0,t[n]);return e}static zeros(t,e){return new b(t,e)}static ones(t,e){return new b(t,e).fill(1)}static rand(t,e,n={}){if("object"!=typeof n)throw new TypeError("options must be an object");const{random:i=Math.random}=n;let r=new b(t,e);for(let n=0;n<t;n++)for(let t=0;t<e;t++)r.set(n,t,i());return r}static randInt(t,e,n={}){if("object"!=typeof n)throw new TypeError("options must be an object");const{min:i=0,max:r=1e3,random:s=Math.random}=n;if(!Number.isInteger(i))throw new TypeError("min must be an integer");if(!Number.isInteger(r))throw new TypeError("max must be an integer");if(i>=r)throw new RangeError("min must be smaller than max");let o=r-i,a=new b(t,e);for(let n=0;n<t;n++)for(let t=0;t<e;t++){let e=i+Math.round(s()*o);a.set(n,t,e)}return a}static eye(t,e,n){void 0===e&&(e=t),void 0===n&&(n=1);let i=Math.min(t,e),r=this.zeros(t,e);for(let t=0;t<i;t++)r.set(t,t,n);return r}static diag(t,e,n){let i=t.length;void 0===e&&(e=i),void 0===n&&(n=e);let r=Math.min(i,e,n),s=this.zeros(e,n);for(let e=0;e<r;e++)s.set(e,e,t[e]);return s}static min(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);let n=t.rows,i=t.columns,r=new b(n,i);for(let s=0;s<n;s++)for(let n=0;n<i;n++)r.set(s,n,Math.min(t.get(s,n),e.get(s,n)));return r}static max(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);let n=t.rows,i=t.columns,r=new this(n,i);for(let s=0;s<n;s++)for(let n=0;n<i;n++)r.set(s,n,Math.max(t.get(s,n),e.get(s,n)));return r}static checkMatrix(t){return x.isMatrix(t)?t:new b(t)}static isMatrix(t){return null!=t&&"Matrix"===t.klass}get size(){return this.rows*this.columns}apply(t){if("function"!=typeof t)throw new TypeError("callback must be a function");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)t.call(this,e,n);return this}to1DArray(){let t=[];for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)t.push(this.get(e,n));return t}to2DArray(){let t=[];for(let e=0;e<this.rows;e++){t.push([]);for(let n=0;n<this.columns;n++)t[e].push(this.get(e,n))}return t}toJSON(){return this.to2DArray()}isRowVector(){return 1===this.rows}isColumnVector(){return 1===this.columns}isVector(){return 1===this.rows||1===this.columns}isSquare(){return this.rows===this.columns}isEmpty(){return 0===this.rows||0===this.columns}isSymmetric(){if(this.isSquare()){for(let t=0;t<this.rows;t++)for(let e=0;e<=t;e++)if(this.get(t,e)!==this.get(e,t))return!1;return!0}return!1}isDistance(){if(!this.isSymmetric())return!1;for(let t=0;t<this.rows;t++)if(0!==this.get(t,t))return!1;return!0}isEchelonForm(){let t=0,e=0,n=-1,i=!0,r=!1;for(;t<this.rows&&i;){for(e=0,r=!1;e<this.columns&&!1===r;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>n?(r=!0,n=e):(i=!1,r=!0);t++}return i}isReducedEchelonForm(){let t=0,e=0,n=-1,i=!0,r=!1;for(;t<this.rows&&i;){for(e=0,r=!1;e<this.columns&&!1===r;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>n?(r=!0,n=e):(i=!1,r=!0);for(let n=e+1;n<this.rows;n++)0!==this.get(t,n)&&(i=!1);t++}return i}echelonForm(){let t=this.clone(),e=0,n=0;for(;e<t.rows&&n<t.columns;){let i=e;for(let r=e;r<t.rows;r++)t.get(r,n)>t.get(i,n)&&(i=r);if(0===t.get(i,n))n++;else{t.swapRows(e,i);let r=t.get(e,n);for(let i=n;i<t.columns;i++)t.set(e,i,t.get(e,i)/r);for(let i=e+1;i<t.rows;i++){let r=t.get(i,n)/t.get(e,n);t.set(i,n,0);for(let s=n+1;s<t.columns;s++)t.set(i,s,t.get(i,s)-t.get(e,s)*r)}e++,n++}}return t}reducedEchelonForm(){let t=this.echelonForm(),e=t.columns,n=t.rows,i=n-1;for(;i>=0;)if(0===t.maxRow(i))i--;else{let r=0,s=!1;for(;r<n&&!1===s;)1===t.get(i,r)?s=!0:r++;for(let n=0;n<i;n++){let s=t.get(n,r);for(let o=r;o<e;o++){let e=t.get(n,o)-s*t.get(i,o);t.set(n,o,e)}}i--}return t}set(){throw new Error("set method is unimplemented")}get(){throw new Error("get method is unimplemented")}repeat(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{rows:e=1,columns:n=1}=t;if(!Number.isInteger(e)||e<=0)throw new TypeError("rows must be a positive integer");if(!Number.isInteger(n)||n<=0)throw new TypeError("columns must be a positive integer");let i=new b(this.rows*e,this.columns*n);for(let t=0;t<e;t++)for(let e=0;e<n;e++)i.setSubMatrix(this,this.rows*t,this.columns*e);return i}fill(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,t);return this}neg(){return this.mulS(-1)}getRow(t){u(this,t);let e=[];for(let n=0;n<this.columns;n++)e.push(this.get(t,n));return e}getRowVector(t){return b.rowVector(this.getRow(t))}setRow(t,e){u(this,t),e=f(this,e);for(let n=0;n<this.columns;n++)this.set(t,n,e[n]);return this}swapRows(t,e){u(this,t),u(this,e);for(let n=0;n<this.columns;n++){let i=this.get(t,n);this.set(t,n,this.get(e,n)),this.set(e,n,i)}return this}getColumn(t){c(this,t);let e=[];for(let n=0;n<this.rows;n++)e.push(this.get(n,t));return e}getColumnVector(t){return b.columnVector(this.getColumn(t))}setColumn(t,e){c(this,t),e=d(this,e);for(let n=0;n<this.rows;n++)this.set(n,t,e[n]);return this}swapColumns(t,e){c(this,t),c(this,e);for(let n=0;n<this.rows;n++){let i=this.get(n,t);this.set(n,t,this.get(n,e)),this.set(n,e,i)}return this}addRowVector(t){t=f(this,t);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)+t[n]);return this}subRowVector(t){t=f(this,t);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)-t[n]);return this}mulRowVector(t){t=f(this,t);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)*t[n]);return this}divRowVector(t){t=f(this,t);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)/t[n]);return this}addColumnVector(t){t=d(this,t);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)+t[e]);return this}subColumnVector(t){t=d(this,t);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)-t[e]);return this}mulColumnVector(t){t=d(this,t);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)*t[e]);return this}divColumnVector(t){t=d(this,t);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)/t[e]);return this}mulRow(t,e){u(this,t);for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)*e);return this}mulColumn(t,e){c(this,t);for(let n=0;n<this.rows;n++)this.set(n,t,this.get(n,t)*e);return this}max(t){if(this.isEmpty())return NaN;switch(t){case"row":{const t=new Array(this.rows).fill(Number.NEGATIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.get(e,n)>t[e]&&(t[e]=this.get(e,n));return t}case"column":{const t=new Array(this.columns).fill(Number.NEGATIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.get(e,n)>t[n]&&(t[n]=this.get(e,n));return t}case void 0:{let t=this.get(0,0);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.get(e,n)>t&&(t=this.get(e,n));return t}default:throw new Error(`invalid option: ${t}`)}}maxIndex(){w(this);let t=this.get(0,0),e=[0,0];for(let n=0;n<this.rows;n++)for(let i=0;i<this.columns;i++)this.get(n,i)>t&&(t=this.get(n,i),e[0]=n,e[1]=i);return e}min(t){if(this.isEmpty())return NaN;switch(t){case"row":{const t=new Array(this.rows).fill(Number.POSITIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.get(e,n)<t[e]&&(t[e]=this.get(e,n));return t}case"column":{const t=new Array(this.columns).fill(Number.POSITIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.get(e,n)<t[n]&&(t[n]=this.get(e,n));return t}case void 0:{let t=this.get(0,0);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.get(e,n)<t&&(t=this.get(e,n));return t}default:throw new Error(`invalid option: ${t}`)}}minIndex(){w(this);let t=this.get(0,0),e=[0,0];for(let n=0;n<this.rows;n++)for(let i=0;i<this.columns;i++)this.get(n,i)<t&&(t=this.get(n,i),e[0]=n,e[1]=i);return e}maxRow(t){if(u(this,t),this.isEmpty())return NaN;let e=this.get(t,0);for(let n=1;n<this.columns;n++)this.get(t,n)>e&&(e=this.get(t,n));return e}maxRowIndex(t){u(this,t),w(this);let e=this.get(t,0),n=[t,0];for(let i=1;i<this.columns;i++)this.get(t,i)>e&&(e=this.get(t,i),n[1]=i);return n}minRow(t){if(u(this,t),this.isEmpty())return NaN;let e=this.get(t,0);for(let n=1;n<this.columns;n++)this.get(t,n)<e&&(e=this.get(t,n));return e}minRowIndex(t){u(this,t),w(this);let e=this.get(t,0),n=[t,0];for(let i=1;i<this.columns;i++)this.get(t,i)<e&&(e=this.get(t,i),n[1]=i);return n}maxColumn(t){if(c(this,t),this.isEmpty())return NaN;let e=this.get(0,t);for(let n=1;n<this.rows;n++)this.get(n,t)>e&&(e=this.get(n,t));return e}maxColumnIndex(t){c(this,t),w(this);let e=this.get(0,t),n=[0,t];for(let i=1;i<this.rows;i++)this.get(i,t)>e&&(e=this.get(i,t),n[0]=i);return n}minColumn(t){if(c(this,t),this.isEmpty())return NaN;let e=this.get(0,t);for(let n=1;n<this.rows;n++)this.get(n,t)<e&&(e=this.get(n,t));return e}minColumnIndex(t){c(this,t),w(this);let e=this.get(0,t),n=[0,t];for(let i=1;i<this.rows;i++)this.get(i,t)<e&&(e=this.get(i,t),n[0]=i);return n}diag(){let t=Math.min(this.rows,this.columns),e=[];for(let n=0;n<t;n++)e.push(this.get(n,n));return e}norm(t="frobenius"){switch(t){case"max":return this.max();case"frobenius":return Math.sqrt(this.dot(this));default:throw new RangeError(`unknown norm type: ${t}`)}}cumulativeSum(){let t=0;for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)t+=this.get(e,n),this.set(e,n,t);return this}dot(t){x.isMatrix(t)&&(t=t.to1DArray());let e=this.to1DArray();if(e.length!==t.length)throw new RangeError("vectors do not have the same size");let n=0;for(let i=0;i<e.length;i++)n+=e[i]*t[i];return n}mmul(t){t=b.checkMatrix(t);let e=this.rows,n=this.columns,i=t.columns,r=new b(e,i),s=new Float64Array(n);for(let o=0;o<i;o++){for(let e=0;e<n;e++)s[e]=t.get(e,o);for(let t=0;t<e;t++){let e=0;for(let i=0;i<n;i++)e+=this.get(t,i)*s[i];r.set(t,o,e)}}return r}strassen2x2(t){t=b.checkMatrix(t);let e=new b(2,2);const n=this.get(0,0),i=t.get(0,0),r=this.get(0,1),s=t.get(0,1),o=this.get(1,0),a=t.get(1,0),l=this.get(1,1),h=t.get(1,1),u=(n+l)*(i+h),c=(o+l)*i,f=n*(s-h),d=l*(a-i),g=(n+r)*h,p=u+d-g+(r-l)*(a+h),m=f+g,y=c+d,v=u-c+f+(o-n)*(i+s);return e.set(0,0,p),e.set(0,1,m),e.set(1,0,y),e.set(1,1,v),e}strassen3x3(t){t=b.checkMatrix(t);let e=new b(3,3);const n=this.get(0,0),i=this.get(0,1),r=this.get(0,2),s=this.get(1,0),o=this.get(1,1),a=this.get(1,2),l=this.get(2,0),h=this.get(2,1),u=this.get(2,2),c=t.get(0,0),f=t.get(0,1),d=t.get(0,2),g=t.get(1,0),p=t.get(1,1),m=t.get(1,2),y=t.get(2,0),v=t.get(2,1),w=t.get(2,2),x=(n-s)*(-f+p),_=(-n+s+o)*(c-f+p),E=(s+o)*(-c+f),S=n*c,I=(-n+l+h)*(c-d+m),C=(-n+l)*(d-m),M=(l+h)*(-c+d),R=(-r+h+u)*(p+y-v),P=(r-u)*(p-v),T=r*y,N=(h+u)*(-y+v),A=(-r+o+a)*(m+y-w),k=(r-a)*(m-w),L=(o+a)*(-y+w),O=S+T+i*g,D=(n+i+r-s-o-h-u)*p+_+E+S+R+T+N,F=S+I+M+(n+i+r-o-a-l-h)*m+T+A+L,z=x+o*(-c+f+g-p-m-y+w)+_+S+T+A+k,G=x+_+E+S+a*v,B=T+A+k+L+s*d,U=S+I+C+h*(-c+d+g-p-m-y+v)+R+P+T,q=R+P+T+N+l*f,V=S+I+C+M+u*w;return e.set(0,0,O),e.set(0,1,D),e.set(0,2,F),e.set(1,0,z),e.set(1,1,G),e.set(1,2,B),e.set(2,0,U),e.set(2,1,q),e.set(2,2,V),e}mmulStrassen(t){t=b.checkMatrix(t);let e=this.clone(),n=e.rows,i=e.columns,r=t.rows,s=t.columns;function o(t,e,n){let i=t.rows,r=t.columns;if(i===e&&r===n)return t;{let i=x.zeros(e,n);return i=i.setSubMatrix(t,0,0),i}}i!==r&&console.warn(`Multiplying ${n} x ${i} and ${r} x ${s} matrix: dimensions do not match.`);let a=Math.max(n,r),l=Math.max(i,s);return e=o(e,a,l),function t(e,n,i,r){if(i<=512||r<=512)return e.mmul(n);i%2==1&&r%2==1?(e=o(e,i+1,r+1),n=o(n,i+1,r+1)):i%2==1?(e=o(e,i+1,r),n=o(n,i+1,r)):r%2==1&&(e=o(e,i,r+1),n=o(n,i,r+1));let s=parseInt(e.rows/2,10),a=parseInt(e.columns/2,10),l=e.subMatrix(0,s-1,0,a-1),h=n.subMatrix(0,s-1,0,a-1),u=e.subMatrix(0,s-1,a,e.columns-1),c=n.subMatrix(0,s-1,a,n.columns-1),f=e.subMatrix(s,e.rows-1,0,a-1),d=n.subMatrix(s,n.rows-1,0,a-1),g=e.subMatrix(s,e.rows-1,a,e.columns-1),p=n.subMatrix(s,n.rows-1,a,n.columns-1),m=t(x.add(l,g),x.add(h,p),s,a),y=t(x.add(f,g),h,s,a),v=t(l,x.sub(c,p),s,a),w=t(g,x.sub(d,h),s,a),_=t(x.add(l,u),p,s,a),b=t(x.sub(f,l),x.add(h,c),s,a),E=t(x.sub(u,g),x.add(d,p),s,a),S=x.add(m,w);S.sub(_),S.add(E);let I=x.add(v,_),C=x.add(y,w),M=x.sub(m,y);M.add(v),M.add(b);let R=x.zeros(2*S.rows,2*S.columns);return R=R.setSubMatrix(S,0,0),R=R.setSubMatrix(I,S.rows,0),R=R.setSubMatrix(C,0,S.columns),R=R.setSubMatrix(M,S.rows,S.columns),R.subMatrix(0,i-1,0,r-1)}(e,t=o(t,a,l),a,l)}scaleRows(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{min:e=0,max:n=1}=t;if(!Number.isFinite(e))throw new TypeError("min must be a number");if(!Number.isFinite(n))throw new TypeError("max must be a number");if(e>=n)throw new RangeError("min must be smaller than max");let i=new b(this.rows,this.columns);for(let t=0;t<this.rows;t++){const s=this.getRow(t);s.length>0&&r(s,{min:e,max:n,output:s}),i.setRow(t,s)}return i}scaleColumns(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{min:e=0,max:n=1}=t;if(!Number.isFinite(e))throw new TypeError("min must be a number");if(!Number.isFinite(n))throw new TypeError("max must be a number");if(e>=n)throw new RangeError("min must be smaller than max");let i=new b(this.rows,this.columns);for(let t=0;t<this.columns;t++){const s=this.getColumn(t);s.length&&r(s,{min:e,max:n,output:s}),i.setColumn(t,s)}return i}flipRows(){const t=Math.ceil(this.columns/2);for(let e=0;e<this.rows;e++)for(let n=0;n<t;n++){let t=this.get(e,n),i=this.get(e,this.columns-1-n);this.set(e,n,i),this.set(e,this.columns-1-n,t)}return this}flipColumns(){const t=Math.ceil(this.rows/2);for(let e=0;e<this.columns;e++)for(let n=0;n<t;n++){let t=this.get(n,e),i=this.get(this.rows-1-n,e);this.set(n,e,i),this.set(this.rows-1-n,e,t)}return this}kroneckerProduct(t){t=b.checkMatrix(t);let e=this.rows,n=this.columns,i=t.rows,r=t.columns,s=new b(e*i,n*r);for(let o=0;o<e;o++)for(let e=0;e<n;e++)for(let n=0;n<i;n++)for(let a=0;a<r;a++)s.set(i*o+n,r*e+a,this.get(o,e)*t.get(n,a));return s}kroneckerSum(t){if(t=b.checkMatrix(t),!this.isSquare()||!t.isSquare())throw new Error("Kronecker Sum needs two Square Matrices");let e=this.rows,n=t.rows,i=this.kroneckerProduct(b.eye(n,n)),r=b.eye(e,e).kroneckerProduct(t);return i.add(r)}transpose(){let t=new b(this.columns,this.rows);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)t.set(n,e,this.get(e,n));return t}sortRows(t=_){for(let e=0;e<this.rows;e++)this.setRow(e,this.getRow(e).sort(t));return this}sortColumns(t=_){for(let e=0;e<this.columns;e++)this.setColumn(e,this.getColumn(e).sort(t));return this}subMatrix(t,e,n,i){m(this,t,e,n,i);let r=new b(e-t+1,i-n+1);for(let s=t;s<=e;s++)for(let e=n;e<=i;e++)r.set(s-t,e-n,this.get(s,e));return r}subMatrixRow(t,e,n){if(void 0===e&&(e=0),void 0===n&&(n=this.columns-1),e>n||e<0||e>=this.columns||n<0||n>=this.columns)throw new RangeError("Argument out of range");let i=new b(t.length,n-e+1);for(let r=0;r<t.length;r++)for(let s=e;s<=n;s++){if(t[r]<0||t[r]>=this.rows)throw new RangeError(`Row index out of range: ${t[r]}`);i.set(r,s-e,this.get(t[r],s))}return i}subMatrixColumn(t,e,n){if(void 0===e&&(e=0),void 0===n&&(n=this.rows-1),e>n||e<0||e>=this.rows||n<0||n>=this.rows)throw new RangeError("Argument out of range");let i=new b(n-e+1,t.length);for(let r=0;r<t.length;r++)for(let s=e;s<=n;s++){if(t[r]<0||t[r]>=this.columns)throw new RangeError(`Column index out of range: ${t[r]}`);i.set(s-e,r,this.get(s,t[r]))}return i}setSubMatrix(t,e,n){if((t=b.checkMatrix(t)).isEmpty())return this;m(this,e,e+t.rows-1,n,n+t.columns-1);for(let i=0;i<t.rows;i++)for(let r=0;r<t.columns;r++)this.set(e+i,n+r,t.get(i,r));return this}selection(t,e){g(this,t),p(this,e);let n=new b(t.length,e.length);for(let i=0;i<t.length;i++){let r=t[i];for(let t=0;t<e.length;t++){let s=e[t];n.set(i,t,this.get(r,s))}}return n}trace(){let t=Math.min(this.rows,this.columns),e=0;for(let n=0;n<t;n++)e+=this.get(n,n);return e}clone(){return this.constructor.copy(this,new b(this.rows,this.columns))}static copy(t,e){for(const[n,i,r]of t.entries())e.set(n,i,r);return e}sum(t){switch(t){case"row":return function(t){let e=y(t.rows);for(let n=0;n<t.rows;++n)for(let i=0;i<t.columns;++i)e[n]+=t.get(n,i);return e}(this);case"column":return function(t){let e=y(t.columns);for(let n=0;n<t.rows;++n)for(let i=0;i<t.columns;++i)e[i]+=t.get(n,i);return e}(this);case void 0:return function(t){let e=0;for(let n=0;n<t.rows;n++)for(let i=0;i<t.columns;i++)e+=t.get(n,i);return e}(this);default:throw new Error(`invalid option: ${t}`)}}product(t){switch(t){case"row":return function(t){let e=y(t.rows,1);for(let n=0;n<t.rows;++n)for(let i=0;i<t.columns;++i)e[n]*=t.get(n,i);return e}(this);case"column":return function(t){let e=y(t.columns,1);for(let n=0;n<t.rows;++n)for(let i=0;i<t.columns;++i)e[i]*=t.get(n,i);return e}(this);case void 0:return function(t){let e=1;for(let n=0;n<t.rows;n++)for(let i=0;i<t.columns;i++)e*=t.get(n,i);return e}(this);default:throw new Error(`invalid option: ${t}`)}}mean(t){const e=this.sum(t);switch(t){case"row":for(let t=0;t<this.rows;t++)e[t]/=this.columns;return e;case"column":for(let t=0;t<this.columns;t++)e[t]/=this.rows;return e;case void 0:return e/this.size;default:throw new Error(`invalid option: ${t}`)}}variance(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw new TypeError("options must be an object");const{unbiased:n=!0,mean:r=this.mean(t)}=e;if("boolean"!=typeof n)throw new TypeError("unbiased must be a boolean");switch(t){case"row":if(!i.isAnyArray(r))throw new TypeError("mean must be an array");return function(t,e,n){const i=t.rows,r=t.columns,s=[];for(let o=0;o<i;o++){let i=0,a=0,l=0;for(let e=0;e<r;e++)l=t.get(o,e)-n[o],i+=l,a+=l*l;e?s.push((a-i*i/r)/(r-1)):s.push((a-i*i/r)/r)}return s}(this,n,r);case"column":if(!i.isAnyArray(r))throw new TypeError("mean must be an array");return function(t,e,n){const i=t.rows,r=t.columns,s=[];for(let o=0;o<r;o++){let r=0,a=0,l=0;for(let e=0;e<i;e++)l=t.get(e,o)-n[o],r+=l,a+=l*l;e?s.push((a-r*r/i)/(i-1)):s.push((a-r*r/i)/i)}return s}(this,n,r);case void 0:if("number"!=typeof r)throw new TypeError("mean must be a number");return function(t,e,n){const i=t.rows,r=t.columns,s=i*r;let o=0,a=0,l=0;for(let e=0;e<i;e++)for(let i=0;i<r;i++)l=t.get(e,i)-n,o+=l,a+=l*l;return e?(a-o*o/s)/(s-1):(a-o*o/s)/s}(this,n,r);default:throw new Error(`invalid option: ${t}`)}}standardDeviation(t,e){"object"==typeof t&&(e=t,t=void 0);const n=this.variance(t,e);if(void 0===t)return Math.sqrt(n);for(let t=0;t<n.length;t++)n[t]=Math.sqrt(n[t]);return n}center(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw new TypeError("options must be an object");const{center:n=this.mean(t)}=e;switch(t){case"row":if(!i.isAnyArray(n))throw new TypeError("center must be an array");return function(t,e){for(let n=0;n<t.rows;n++)for(let i=0;i<t.columns;i++)t.set(n,i,t.get(n,i)-e[n])}(this,n),this;case"column":if(!i.isAnyArray(n))throw new TypeError("center must be an array");return function(t,e){for(let n=0;n<t.rows;n++)for(let i=0;i<t.columns;i++)t.set(n,i,t.get(n,i)-e[i])}(this,n),this;case void 0:if("number"!=typeof n)throw new TypeError("center must be a number");return function(t,e){for(let n=0;n<t.rows;n++)for(let i=0;i<t.columns;i++)t.set(n,i,t.get(n,i)-e)}(this,n),this;default:throw new Error(`invalid option: ${t}`)}}scale(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw new TypeError("options must be an object");let n=e.scale;switch(t){case"row":if(void 0===n)n=function(t){const e=[];for(let n=0;n<t.rows;n++){let i=0;for(let e=0;e<t.columns;e++)i+=Math.pow(t.get(n,e),2)/(t.columns-1);e.push(Math.sqrt(i))}return e}(this);else if(!i.isAnyArray(n))throw new TypeError("scale must be an array");return function(t,e){for(let n=0;n<t.rows;n++)for(let i=0;i<t.columns;i++)t.set(n,i,t.get(n,i)/e[n])}(this,n),this;case"column":if(void 0===n)n=function(t){const e=[];for(let n=0;n<t.columns;n++){let i=0;for(let e=0;e<t.rows;e++)i+=Math.pow(t.get(e,n),2)/(t.rows-1);e.push(Math.sqrt(i))}return e}(this);else if(!i.isAnyArray(n))throw new TypeError("scale must be an array");return function(t,e){for(let n=0;n<t.rows;n++)for(let i=0;i<t.columns;i++)t.set(n,i,t.get(n,i)/e[i])}(this,n),this;case void 0:if(void 0===n)n=function(t){const e=t.size-1;let n=0;for(let i=0;i<t.columns;i++)for(let r=0;r<t.rows;r++)n+=Math.pow(t.get(r,i),2)/e;return Math.sqrt(n)}(this);else if("number"!=typeof n)throw new TypeError("scale must be a number");return function(t,e){for(let n=0;n<t.rows;n++)for(let i=0;i<t.columns;i++)t.set(n,i,t.get(n,i)/e)}(this,n),this;default:throw new Error(`invalid option: ${t}`)}}toString(t){return a(this,t)}[Symbol.iterator](){return this.entries()}*entries(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)yield[t,e,this.get(t,e)]}*values(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)yield this.get(t,e)}}function _(t,e){return t-e}x.prototype.klass="Matrix","undefined"!=typeof Symbol&&(x.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return a(this)}),x.random=x.rand,x.randomInt=x.randInt,x.diagonal=x.diag,x.prototype.diagonal=x.prototype.diag,x.identity=x.eye,x.prototype.negate=x.prototype.neg,x.prototype.tensorProduct=x.prototype.kroneckerProduct;class b extends x{data;#t(t,e){if(this.data=[],!(Number.isInteger(e)&&e>=0))throw new TypeError("nColumns must be a positive integer");for(let n=0;n<t;n++)this.data.push(new Float64Array(e));this.rows=t,this.columns=e}constructor(t,e){if(super(),b.isMatrix(t))this.#t(t.rows,t.columns),b.copy(t,this);else if(Number.isInteger(t)&&t>=0)this.#t(t,e);else{if(!i.isAnyArray(t))throw new TypeError("First argument must be a positive number or an array");{const n=t;if("number"!=typeof(e=(t=n.length)?n[0].length:0))throw new TypeError("Data must be a 2D array with at least one element");this.data=[];for(let i=0;i<t;i++){if(n[i].length!==e)throw new RangeError("Inconsistent array dimensions");if(!n[i].every((t=>"number"==typeof t)))throw new TypeError("Input data contains non-numeric values");this.data.push(Float64Array.from(n[i]))}this.rows=t,this.columns=e}}}set(t,e,n){return this.data[t][e]=n,this}get(t,e){return this.data[t][e]}removeRow(t){return u(this,t),this.data.splice(t,1),this.rows-=1,this}addRow(t,e){return void 0===e&&(e=t,t=this.rows),u(this,t,!0),e=Float64Array.from(f(this,e)),this.data.splice(t,0,e),this.rows+=1,this}removeColumn(t){c(this,t);for(let e=0;e<this.rows;e++){const n=new Float64Array(this.columns-1);for(let i=0;i<t;i++)n[i]=this.data[e][i];for(let i=t+1;i<this.columns;i++)n[i-1]=this.data[e][i];this.data[e]=n}return this.columns-=1,this}addColumn(t,e){void 0===e&&(e=t,t=this.columns),c(this,t,!0),e=d(this,e);for(let n=0;n<this.rows;n++){const i=new Float64Array(this.columns+1);let r=0;for(;r<t;r++)i[r]=this.data[n][r];for(i[r++]=e[n];r<this.columns+1;r++)i[r]=this.data[n][r-1];this.data[n]=i}return this.columns+=1,this}}!function(t,e){t.prototype.add=function(t){return"number"==typeof t?this.addS(t):this.addM(t)},t.prototype.addS=function(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)+t);return this},t.prototype.addM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)+t.get(e,n));return this},t.add=function(t,n){return new e(t).add(n)},t.prototype.sub=function(t){return"number"==typeof t?this.subS(t):this.subM(t)},t.prototype.subS=function(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)-t);return this},t.prototype.subM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)-t.get(e,n));return this},t.sub=function(t,n){return new e(t).sub(n)},t.prototype.subtract=t.prototype.sub,t.prototype.subtractS=t.prototype.subS,t.prototype.subtractM=t.prototype.subM,t.subtract=t.sub,t.prototype.mul=function(t){return"number"==typeof t?this.mulS(t):this.mulM(t)},t.prototype.mulS=function(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)*t);return this},t.prototype.mulM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)*t.get(e,n));return this},t.mul=function(t,n){return new e(t).mul(n)},t.prototype.multiply=t.prototype.mul,t.prototype.multiplyS=t.prototype.mulS,t.prototype.multiplyM=t.prototype.mulM,t.multiply=t.mul,t.prototype.div=function(t){return"number"==typeof t?this.divS(t):this.divM(t)},t.prototype.divS=function(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)/t);return this},t.prototype.divM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)/t.get(e,n));return this},t.div=function(t,n){return new e(t).div(n)},t.prototype.divide=t.prototype.div,t.prototype.divideS=t.prototype.divS,t.prototype.divideM=t.prototype.divM,t.divide=t.div,t.prototype.mod=function(t){return"number"==typeof t?this.modS(t):this.modM(t)},t.prototype.modS=function(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)%t);return this},t.prototype.modM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)%t.get(e,n));return this},t.mod=function(t,n){return new e(t).mod(n)},t.prototype.modulus=t.prototype.mod,t.prototype.modulusS=t.prototype.modS,t.prototype.modulusM=t.prototype.modM,t.modulus=t.mod,t.prototype.and=function(t){return"number"==typeof t?this.andS(t):this.andM(t)},t.prototype.andS=function(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)&t);return this},t.prototype.andM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)&t.get(e,n));return this},t.and=function(t,n){return new e(t).and(n)},t.prototype.or=function(t){return"number"==typeof t?this.orS(t):this.orM(t)},t.prototype.orS=function(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)|t);return this},t.prototype.orM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)|t.get(e,n));return this},t.or=function(t,n){return new e(t).or(n)},t.prototype.xor=function(t){return"number"==typeof t?this.xorS(t):this.xorM(t)},t.prototype.xorS=function(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)^t);return this},t.prototype.xorM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)^t.get(e,n));return this},t.xor=function(t,n){return new e(t).xor(n)},t.prototype.leftShift=function(t){return"number"==typeof t?this.leftShiftS(t):this.leftShiftM(t)},t.prototype.leftShiftS=function(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)<<t);return this},t.prototype.leftShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)<<t.get(e,n));return this},t.leftShift=function(t,n){return new e(t).leftShift(n)},t.prototype.signPropagatingRightShift=function(t){return"number"==typeof t?this.signPropagatingRightShiftS(t):this.signPropagatingRightShiftM(t)},t.prototype.signPropagatingRightShiftS=function(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)>>t);return this},t.prototype.signPropagatingRightShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)>>t.get(e,n));return this},t.signPropagatingRightShift=function(t,n){return new e(t).signPropagatingRightShift(n)},t.prototype.rightShift=function(t){return"number"==typeof t?this.rightShiftS(t):this.rightShiftM(t)},t.prototype.rightShiftS=function(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)>>>t);return this},t.prototype.rightShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)>>>t.get(e,n));return this},t.rightShift=function(t,n){return new e(t).rightShift(n)},t.prototype.zeroFillRightShift=t.prototype.rightShift,t.prototype.zeroFillRightShiftS=t.prototype.rightShiftS,t.prototype.zeroFillRightShiftM=t.prototype.rightShiftM,t.zeroFillRightShift=t.rightShift,t.prototype.not=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,~this.get(t,e));return this},t.not=function(t){return new e(t).not()},t.prototype.abs=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.abs(this.get(t,e)));return this},t.abs=function(t){return new e(t).abs()},t.prototype.acos=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.acos(this.get(t,e)));return this},t.acos=function(t){return new e(t).acos()},t.prototype.acosh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.acosh(this.get(t,e)));return this},t.acosh=function(t){return new e(t).acosh()},t.prototype.asin=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.asin(this.get(t,e)));return this},t.asin=function(t){return new e(t).asin()},t.prototype.asinh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.asinh(this.get(t,e)));return this},t.asinh=function(t){return new e(t).asinh()},t.prototype.atan=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.atan(this.get(t,e)));return this},t.atan=function(t){return new e(t).atan()},t.prototype.atanh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.atanh(this.get(t,e)));return this},t.atanh=function(t){return new e(t).atanh()},t.prototype.cbrt=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cbrt(this.get(t,e)));return this},t.cbrt=function(t){return new e(t).cbrt()},t.prototype.ceil=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.ceil(this.get(t,e)));return this},t.ceil=function(t){return new e(t).ceil()},t.prototype.clz32=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.clz32(this.get(t,e)));return this},t.clz32=function(t){return new e(t).clz32()},t.prototype.cos=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cos(this.get(t,e)));return this},t.cos=function(t){return new e(t).cos()},t.prototype.cosh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cosh(this.get(t,e)));return this},t.cosh=function(t){return new e(t).cosh()},t.prototype.exp=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.exp(this.get(t,e)));return this},t.exp=function(t){return new e(t).exp()},t.prototype.expm1=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.expm1(this.get(t,e)));return this},t.expm1=function(t){return new e(t).expm1()},t.prototype.floor=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.floor(this.get(t,e)));return this},t.floor=function(t){return new e(t).floor()},t.prototype.fround=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.fround(this.get(t,e)));return this},t.fround=function(t){return new e(t).fround()},t.prototype.log=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log(this.get(t,e)));return this},t.log=function(t){return new e(t).log()},t.prototype.log1p=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log1p(this.get(t,e)));return this},t.log1p=function(t){return new e(t).log1p()},t.prototype.log10=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log10(this.get(t,e)));return this},t.log10=function(t){return new e(t).log10()},t.prototype.log2=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log2(this.get(t,e)));return this},t.log2=function(t){return new e(t).log2()},t.prototype.round=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.round(this.get(t,e)));return this},t.round=function(t){return new e(t).round()},t.prototype.sign=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sign(this.get(t,e)));return this},t.sign=function(t){return new e(t).sign()},t.prototype.sin=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sin(this.get(t,e)));return this},t.sin=function(t){return new e(t).sin()},t.prototype.sinh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sinh(this.get(t,e)));return this},t.sinh=function(t){return new e(t).sinh()},t.prototype.sqrt=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sqrt(this.get(t,e)));return this},t.sqrt=function(t){return new e(t).sqrt()},t.prototype.tan=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.tan(this.get(t,e)));return this},t.tan=function(t){return new e(t).tan()},t.prototype.tanh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.tanh(this.get(t,e)));return this},t.tanh=function(t){return new e(t).tanh()},t.prototype.trunc=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.trunc(this.get(t,e)));return this},t.trunc=function(t){return new e(t).trunc()},t.pow=function(t,n){return new e(t).pow(n)},t.prototype.pow=function(t){return"number"==typeof t?this.powS(t):this.powM(t)},t.prototype.powS=function(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,Math.pow(this.get(e,n),t));return this},t.prototype.powM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,Math.pow(this.get(e,n),t.get(e,n)));return this}}(x,b);class E extends x{#e;get size(){return this.#e.size}get rows(){return this.#e.rows}get columns(){return this.#e.columns}get diagonalSize(){return this.rows}static isSymmetricMatrix(t){return b.isMatrix(t)&&"SymmetricMatrix"===t.klassType}static zeros(t){return new this(t)}static ones(t){return new this(t).fill(1)}constructor(t){if(super(),b.isMatrix(t)){if(!t.isSymmetric())throw new TypeError("not symmetric data");this.#e=b.copy(t,new b(t.rows,t.rows))}else if(Number.isInteger(t)&&t>=0)this.#e=new b(t,t);else if(this.#e=new b(t),!this.isSymmetric())throw new TypeError("not symmetric data")}clone(){const t=new E(this.diagonalSize);for(const[e,n,i]of this.upperRightEntries())t.set(e,n,i);return t}toMatrix(){return new b(this)}get(t,e){return this.#e.get(t,e)}set(t,e,n){return this.#e.set(t,e,n),this.#e.set(e,t,n),this}removeCross(t){return this.#e.removeRow(t),this.#e.removeColumn(t),this}addCross(t,e){void 0===e&&(e=t,t=this.diagonalSize);const n=e.slice();return n.splice(t,1),this.#e.addRow(t,n),this.#e.addColumn(t,e),this}applyMask(t){if(t.length!==this.diagonalSize)throw new RangeError("Mask size do not match with matrix size");const e=[];for(const[n,i]of t.entries())i||e.push(n);e.reverse();for(const t of e)this.removeCross(t);return this}toCompact(){const{diagonalSize:t}=this,e=new Array(t*(t+1)/2);for(let n=0,i=0,r=0;r<e.length;r++)e[r]=this.get(i,n),++n>=t&&(n=++i);return e}static fromCompact(t){const e=t.length,n=(Math.sqrt(8*e+1)-1)/2;if(!Number.isInteger(n))throw new TypeError(`This array is not a compact representation of a Symmetric Matrix, ${JSON.stringify(t)}`);const i=new E(n);for(let r=0,s=0,o=0;o<e;o++)i.set(r,s,t[o]),++r>=n&&(r=++s);return i}*upperRightEntries(){for(let t=0,e=0;t<this.diagonalSize;void 0){const n=this.get(t,e);yield[t,e,n],++e>=this.diagonalSize&&(e=++t)}}*upperRightValues(){for(let t=0,e=0;t<this.diagonalSize;void 0){const n=this.get(t,e);yield n,++e>=this.diagonalSize&&(e=++t)}}}E.prototype.klassType="SymmetricMatrix";class S extends E{static isDistanceMatrix(t){return E.isSymmetricMatrix(t)&&"DistanceMatrix"===t.klassSubType}constructor(t){if(super(t),!this.isDistance())throw new TypeError("Provided arguments do no produce a distance matrix")}set(t,e,n){return t===e&&(n=0),super.set(t,e,n)}addCross(t,e){return void 0===e&&(e=t,t=this.diagonalSize),(e=e.slice())[t]=0,super.addCross(t,e)}toSymmetricMatrix(){return new E(this)}clone(){const t=new S(this.diagonalSize);for(const[e,n,i]of this.upperRightEntries())e!==n&&t.set(e,n,i);return t}toCompact(){const{diagonalSize:t}=this,e=new Array((t-1)*t/2);for(let n=1,i=0,r=0;r<e.length;r++)e[r]=this.get(i,n),++n>=t&&(n=1+ ++i);return e}static fromCompact(t){const e=t.length,n=(Math.sqrt(8*e+1)+1)/2;if(!Number.isInteger(n))throw new TypeError(`This array is not a compact representation of a DistanceMatrix, ${JSON.stringify(t)}`);const i=new this(n);for(let r=1,s=0,o=0;o<e;o++)i.set(r,s,t[o]),++r>=n&&(r=1+ ++s);return i}}S.prototype.klassSubType="DistanceMatrix";class I extends x{constructor(t,e,n){super(),this.matrix=t,this.rows=e,this.columns=n}}class C extends I{constructor(t,e,n){g(t,e),p(t,n),super(t,e.length,n.length),this.rowIndices=e,this.columnIndices=n}set(t,e,n){return this.matrix.set(this.rowIndices[t],this.columnIndices[e],n),this}get(t,e){return this.matrix.get(this.rowIndices[t],this.columnIndices[e])}}class M extends x{constructor(t,e={}){const{rows:n=1}=e;if(t.length%n!=0)throw new Error("the data length is not divisible by the number of rows");super(),this.rows=n,this.columns=t.length/n,this.data=t}set(t,e,n){let i=this._calculateIndex(t,e);return this.data[i]=n,this}get(t,e){let n=this._calculateIndex(t,e);return this.data[n]}_calculateIndex(t,e){return t*this.columns+e}}class R extends x{constructor(t){super(),this.data=t,this.rows=t.length,this.columns=t[0].length}set(t,e,n){return this.data[t][e]=n,this}get(t,e){return this.data[t][e]}}class P{constructor(t){let e,n,i,r,s,o,a,l,h,u=(t=R.checkMatrix(t)).clone(),c=u.rows,f=u.columns,d=new Float64Array(c),g=1;for(e=0;e<c;e++)d[e]=e;for(l=new Float64Array(c),n=0;n<f;n++){for(e=0;e<c;e++)l[e]=u.get(e,n);for(e=0;e<c;e++){for(h=Math.min(e,n),s=0,i=0;i<h;i++)s+=u.get(e,i)*l[i];l[e]-=s,u.set(e,n,l[e])}for(r=n,e=n+1;e<c;e++)Math.abs(l[e])>Math.abs(l[r])&&(r=e);if(r!==n){for(i=0;i<f;i++)o=u.get(r,i),u.set(r,i,u.get(n,i)),u.set(n,i,o);a=d[r],d[r]=d[n],d[n]=a,g=-g}if(n<c&&0!==u.get(n,n))for(e=n+1;e<c;e++)u.set(e,n,u.get(e,n)/u.get(n,n))}this.LU=u,this.pivotVector=d,this.pivotSign=g}isSingular(){let t=this.LU,e=t.columns;for(let n=0;n<e;n++)if(0===t.get(n,n))return!0;return!1}solve(t){t=b.checkMatrix(t);let e=this.LU;if(e.rows!==t.rows)throw new Error("Invalid matrix dimensions");if(this.isSingular())throw new Error("LU matrix is singular");let n,i,r,s=t.columns,o=t.subMatrixRow(this.pivotVector,0,s-1),a=e.columns;for(r=0;r<a;r++)for(n=r+1;n<a;n++)for(i=0;i<s;i++)o.set(n,i,o.get(n,i)-o.get(r,i)*e.get(n,r));for(r=a-1;r>=0;r--){for(i=0;i<s;i++)o.set(r,i,o.get(r,i)/e.get(r,r));for(n=0;n<r;n++)for(i=0;i<s;i++)o.set(n,i,o.get(n,i)-o.get(r,i)*e.get(n,r))}return o}get determinant(){let t=this.LU;if(!t.isSquare())throw new Error("Matrix must be square");let e=this.pivotSign,n=t.columns;for(let i=0;i<n;i++)e*=t.get(i,i);return e}get lowerTriangularMatrix(){let t=this.LU,e=t.rows,n=t.columns,i=new b(e,n);for(let r=0;r<e;r++)for(let e=0;e<n;e++)r>e?i.set(r,e,t.get(r,e)):r===e?i.set(r,e,1):i.set(r,e,0);return i}get upperTriangularMatrix(){let t=this.LU,e=t.rows,n=t.columns,i=new b(e,n);for(let r=0;r<e;r++)for(let e=0;e<n;e++)r<=e?i.set(r,e,t.get(r,e)):i.set(r,e,0);return i}get pivotPermutationVector(){return Array.from(this.pivotVector)}}function T(t,e){let n=0;return Math.abs(t)>Math.abs(e)?(n=e/t,Math.abs(t)*Math.sqrt(1+n*n)):0!==e?(n=t/e,Math.abs(e)*Math.sqrt(1+n*n)):0}class N{constructor(t){let e,n,i,r,s=(t=R.checkMatrix(t)).clone(),o=t.rows,a=t.columns,l=new Float64Array(a);for(i=0;i<a;i++){let t=0;for(e=i;e<o;e++)t=T(t,s.get(e,i));if(0!==t){for(s.get(i,i)<0&&(t=-t),e=i;e<o;e++)s.set(e,i,s.get(e,i)/t);for(s.set(i,i,s.get(i,i)+1),n=i+1;n<a;n++){for(r=0,e=i;e<o;e++)r+=s.get(e,i)*s.get(e,n);for(r=-r/s.get(i,i),e=i;e<o;e++)s.set(e,n,s.get(e,n)+r*s.get(e,i))}}l[i]=-t}this.QR=s,this.Rdiag=l}solve(t){t=b.checkMatrix(t);let e=this.QR,n=e.rows;if(t.rows!==n)throw new Error("Matrix row dimensions must agree");if(!this.isFullRank())throw new Error("Matrix is rank deficient");let i,r,s,o,a=t.columns,l=t.clone(),h=e.columns;for(s=0;s<h;s++)for(r=0;r<a;r++){for(o=0,i=s;i<n;i++)o+=e.get(i,s)*l.get(i,r);for(o=-o/e.get(s,s),i=s;i<n;i++)l.set(i,r,l.get(i,r)+o*e.get(i,s))}for(s=h-1;s>=0;s--){for(r=0;r<a;r++)l.set(s,r,l.get(s,r)/this.Rdiag[s]);for(i=0;i<s;i++)for(r=0;r<a;r++)l.set(i,r,l.get(i,r)-l.get(s,r)*e.get(i,s))}return l.subMatrix(0,h-1,0,a-1)}isFullRank(){let t=this.QR.columns;for(let e=0;e<t;e++)if(0===this.Rdiag[e])return!1;return!0}get upperTriangularMatrix(){let t,e,n=this.QR,i=n.columns,r=new b(i,i);for(t=0;t<i;t++)for(e=0;e<i;e++)t<e?r.set(t,e,n.get(t,e)):t===e?r.set(t,e,this.Rdiag[t]):r.set(t,e,0);return r}get orthogonalMatrix(){let t,e,n,i,r=this.QR,s=r.rows,o=r.columns,a=new b(s,o);for(n=o-1;n>=0;n--){for(t=0;t<s;t++)a.set(t,n,0);for(a.set(n,n,1),e=n;e<o;e++)if(0!==r.get(n,n)){for(i=0,t=n;t<s;t++)i+=r.get(t,n)*a.get(t,e);for(i=-i/r.get(n,n),t=n;t<s;t++)a.set(t,e,a.get(t,e)+i*r.get(t,n))}}return a}}class A{constructor(t,e={}){if((t=R.checkMatrix(t)).isEmpty())throw new Error("Matrix must be non-empty");let n=t.rows,i=t.columns;const{computeLeftSingularVectors:r=!0,computeRightSingularVectors:s=!0,autoTranspose:o=!1}=e;let a,l=Boolean(r),h=Boolean(s),u=!1;if(n<i)if(o){a=t.transpose(),n=a.rows,i=a.columns,u=!0;let e=l;l=h,h=e}else a=t.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else a=t.clone();let c=Math.min(n,i),f=Math.min(n+1,i),d=new Float64Array(f),g=new b(n,c),p=new b(i,i),m=new Float64Array(i),y=new Float64Array(n),v=new Float64Array(f);for(let t=0;t<f;t++)v[t]=t;let w=Math.min(n-1,i),x=Math.max(0,Math.min(i-2,n)),_=Math.max(w,x);for(let t=0;t<_;t++){if(t<w){d[t]=0;for(let e=t;e<n;e++)d[t]=T(d[t],a.get(e,t));if(0!==d[t]){a.get(t,t)<0&&(d[t]=-d[t]);for(let e=t;e<n;e++)a.set(e,t,a.get(e,t)/d[t]);a.set(t,t,a.get(t,t)+1)}d[t]=-d[t]}for(let e=t+1;e<i;e++){if(t<w&&0!==d[t]){let i=0;for(let r=t;r<n;r++)i+=a.get(r,t)*a.get(r,e);i=-i/a.get(t,t);for(let r=t;r<n;r++)a.set(r,e,a.get(r,e)+i*a.get(r,t))}m[e]=a.get(t,e)}if(l&&t<w)for(let e=t;e<n;e++)g.set(e,t,a.get(e,t));if(t<x){m[t]=0;for(let e=t+1;e<i;e++)m[t]=T(m[t],m[e]);if(0!==m[t]){m[t+1]<0&&(m[t]=0-m[t]);for(let e=t+1;e<i;e++)m[e]/=m[t];m[t+1]+=1}if(m[t]=-m[t],t+1<n&&0!==m[t]){for(let e=t+1;e<n;e++)y[e]=0;for(let e=t+1;e<n;e++)for(let n=t+1;n<i;n++)y[e]+=m[n]*a.get(e,n);for(let e=t+1;e<i;e++){let i=-m[e]/m[t+1];for(let r=t+1;r<n;r++)a.set(r,e,a.get(r,e)+i*y[r])}}if(h)for(let e=t+1;e<i;e++)p.set(e,t,m[e])}}let E=Math.min(i,n+1);if(w<i&&(d[w]=a.get(w,w)),n<E&&(d[E-1]=0),x+1<E&&(m[x]=a.get(x,E-1)),m[E-1]=0,l){for(let t=w;t<c;t++){for(let e=0;e<n;e++)g.set(e,t,0);g.set(t,t,1)}for(let t=w-1;t>=0;t--)if(0!==d[t]){for(let e=t+1;e<c;e++){let i=0;for(let r=t;r<n;r++)i+=g.get(r,t)*g.get(r,e);i=-i/g.get(t,t);for(let r=t;r<n;r++)g.set(r,e,g.get(r,e)+i*g.get(r,t))}for(let e=t;e<n;e++)g.set(e,t,-g.get(e,t));g.set(t,t,1+g.get(t,t));for(let e=0;e<t-1;e++)g.set(e,t,0)}else{for(let e=0;e<n;e++)g.set(e,t,0);g.set(t,t,1)}}if(h)for(let t=i-1;t>=0;t--){if(t<x&&0!==m[t])for(let e=t+1;e<i;e++){let n=0;for(let r=t+1;r<i;r++)n+=p.get(r,t)*p.get(r,e);n=-n/p.get(t+1,t);for(let r=t+1;r<i;r++)p.set(r,e,p.get(r,e)+n*p.get(r,t))}for(let e=0;e<i;e++)p.set(e,t,0);p.set(t,t,1)}let S=E-1,I=Number.EPSILON;for(;E>0;){let t,e;for(t=E-2;t>=-1&&-1!==t;t--){const e=Number.MIN_VALUE+I*Math.abs(d[t]+Math.abs(d[t+1]));if(Math.abs(m[t])<=e||Number.isNaN(m[t])){m[t]=0;break}}if(t===E-2)e=4;else{let n;for(n=E-1;n>=t&&n!==t;n--){let e=(n!==E?Math.abs(m[n]):0)+(n!==t+1?Math.abs(m[n-1]):0);if(Math.abs(d[n])<=I*e){d[n]=0;break}}n===t?e=3:n===E-1?e=1:(e=2,t=n)}switch(t++,e){case 1:{let e=m[E-2];m[E-2]=0;for(let n=E-2;n>=t;n--){let r=T(d[n],e),s=d[n]/r,o=e/r;if(d[n]=r,n!==t&&(e=-o*m[n-1],m[n-1]=s*m[n-1]),h)for(let t=0;t<i;t++)r=s*p.get(t,n)+o*p.get(t,E-1),p.set(t,E-1,-o*p.get(t,n)+s*p.get(t,E-1)),p.set(t,n,r)}break}case 2:{let e=m[t-1];m[t-1]=0;for(let i=t;i<E;i++){let r=T(d[i],e),s=d[i]/r,o=e/r;if(d[i]=r,e=-o*m[i],m[i]=s*m[i],l)for(let e=0;e<n;e++)r=s*g.get(e,i)+o*g.get(e,t-1),g.set(e,t-1,-o*g.get(e,i)+s*g.get(e,t-1)),g.set(e,i,r)}break}case 3:{const e=Math.max(Math.abs(d[E-1]),Math.abs(d[E-2]),Math.abs(m[E-2]),Math.abs(d[t]),Math.abs(m[t])),r=d[E-1]/e,s=d[E-2]/e,o=m[E-2]/e,a=d[t]/e,u=m[t]/e,c=((s+r)*(s-r)+o*o)/2,f=r*o*(r*o);let y=0;0===c&&0===f||(y=c<0?0-Math.sqrt(c*c+f):Math.sqrt(c*c+f),y=f/(c+y));let v=(a+r)*(a-r)+y,w=a*u;for(let e=t;e<E-1;e++){let r=T(v,w);0===r&&(r=Number.MIN_VALUE);let s=v/r,o=w/r;if(e!==t&&(m[e-1]=r),v=s*d[e]+o*m[e],m[e]=s*m[e]-o*d[e],w=o*d[e+1],d[e+1]=s*d[e+1],h)for(let t=0;t<i;t++)r=s*p.get(t,e)+o*p.get(t,e+1),p.set(t,e+1,-o*p.get(t,e)+s*p.get(t,e+1)),p.set(t,e,r);if(r=T(v,w),0===r&&(r=Number.MIN_VALUE),s=v/r,o=w/r,d[e]=r,v=s*m[e]+o*d[e+1],d[e+1]=-o*m[e]+s*d[e+1],w=o*m[e+1],m[e+1]=s*m[e+1],l&&e<n-1)for(let t=0;t<n;t++)r=s*g.get(t,e)+o*g.get(t,e+1),g.set(t,e+1,-o*g.get(t,e)+s*g.get(t,e+1)),g.set(t,e,r)}m[E-2]=v;break}case 4:if(d[t]<=0&&(d[t]=d[t]<0?-d[t]:0,h))for(let e=0;e<=S;e++)p.set(e,t,-p.get(e,t));for(;t<S&&!(d[t]>=d[t+1]);){let e=d[t];if(d[t]=d[t+1],d[t+1]=e,h&&t<i-1)for(let n=0;n<i;n++)e=p.get(n,t+1),p.set(n,t+1,p.get(n,t)),p.set(n,t,e);if(l&&t<n-1)for(let i=0;i<n;i++)e=g.get(i,t+1),g.set(i,t+1,g.get(i,t)),g.set(i,t,e);t++}E--}}if(u){let t=p;p=g,g=t}this.m=n,this.n=i,this.s=d,this.U=g,this.V=p}solve(t){let e=t,n=this.threshold,i=this.s.length,r=b.zeros(i,i);for(let t=0;t<i;t++)Math.abs(this.s[t])<=n?r.set(t,t,0):r.set(t,t,1/this.s[t]);let s=this.U,o=this.rightSingularVectors,a=o.mmul(r),l=o.rows,h=s.rows,u=b.zeros(l,h);for(let t=0;t<l;t++)for(let e=0;e<h;e++){let n=0;for(let r=0;r<i;r++)n+=a.get(t,r)*s.get(e,r);u.set(t,e,n)}return u.mmul(e)}solveForDiagonal(t){return this.solve(b.diag(t))}inverse(){let t=this.V,e=this.threshold,n=t.rows,i=t.columns,r=new b(n,this.s.length);for(let s=0;s<n;s++)for(let n=0;n<i;n++)Math.abs(this.s[n])>e&&r.set(s,n,t.get(s,n)/this.s[n]);let s=this.U,o=s.rows,a=s.columns,l=new b(n,o);for(let t=0;t<n;t++)for(let e=0;e<o;e++){let n=0;for(let i=0;i<a;i++)n+=r.get(t,i)*s.get(e,i);l.set(t,e,n)}return l}get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]}get norm2(){return this.s[0]}get rank(){let t=Math.max(this.m,this.n)*this.s[0]*Number.EPSILON,e=0,n=this.s;for(let i=0,r=n.length;i<r;i++)n[i]>t&&e++;return e}get diagonal(){return Array.from(this.s)}get threshold(){return Number.EPSILON/2*Math.max(this.m,this.n)*this.s[0]}get leftSingularVectors(){return this.U}get rightSingularVectors(){return this.V}get diagonalMatrix(){return b.diag(this.s)}}function k(t,e,n=!1){return t=R.checkMatrix(t),e=R.checkMatrix(e),n?new A(t).solve(e):t.isSquare()?new P(t).solve(e):new N(t).solve(e)}function L(t,e){let n=[];for(let i=0;i<t;i++)i!==e&&n.push(i);return n}function O(t,e,n,i=1e-9,r=1e-9){if(t>r)return new Array(e.rows+1).fill(0);{let t=e.addRow(n,[0]);for(let e=0;e<t.rows;e++)Math.abs(t.get(e,0))<i&&t.set(e,0,0);return t.to1DArray()}}class D{constructor(t,e={}){const{assumeSymmetric:n=!1}=e;if(!(t=R.checkMatrix(t)).isSquare())throw new Error("Matrix is not a square matrix");if(t.isEmpty())throw new Error("Matrix must be non-empty");let i,r,s=t.columns,o=new b(s,s),a=new Float64Array(s),l=new Float64Array(s),h=t,u=!1;if(u=!!n||t.isSymmetric(),u){for(i=0;i<s;i++)for(r=0;r<s;r++)o.set(i,r,h.get(i,r));!function(t,e,n,i){let r,s,o,a,l,h,u,c;for(l=0;l<t;l++)n[l]=i.get(t-1,l);for(a=t-1;a>0;a--){for(c=0,o=0,h=0;h<a;h++)c+=Math.abs(n[h]);if(0===c)for(e[a]=n[a-1],l=0;l<a;l++)n[l]=i.get(a-1,l),i.set(a,l,0),i.set(l,a,0);else{for(h=0;h<a;h++)n[h]/=c,o+=n[h]*n[h];for(r=n[a-1],s=Math.sqrt(o),r>0&&(s=-s),e[a]=c*s,o-=r*s,n[a-1]=r-s,l=0;l<a;l++)e[l]=0;for(l=0;l<a;l++){for(r=n[l],i.set(l,a,r),s=e[l]+i.get(l,l)*r,h=l+1;h<=a-1;h++)s+=i.get(h,l)*n[h],e[h]+=i.get(h,l)*r;e[l]=s}for(r=0,l=0;l<a;l++)e[l]/=o,r+=e[l]*n[l];for(u=r/(o+o),l=0;l<a;l++)e[l]-=u*n[l];for(l=0;l<a;l++){for(r=n[l],s=e[l],h=l;h<=a-1;h++)i.set(h,l,i.get(h,l)-(r*e[h]+s*n[h]));n[l]=i.get(a-1,l),i.set(a,l,0)}}n[a]=o}for(a=0;a<t-1;a++){if(i.set(t-1,a,i.get(a,a)),i.set(a,a,1),o=n[a+1],0!==o){for(h=0;h<=a;h++)n[h]=i.get(h,a+1)/o;for(l=0;l<=a;l++){for(s=0,h=0;h<=a;h++)s+=i.get(h,a+1)*i.get(h,l);for(h=0;h<=a;h++)i.set(h,l,i.get(h,l)-s*n[h])}}for(h=0;h<=a;h++)i.set(h,a+1,0)}for(l=0;l<t;l++)n[l]=i.get(t-1,l),i.set(t-1,l,0);i.set(t-1,t-1,1),e[0]=0}(s,l,a,o),function(t,e,n,i){let r,s,o,a,l,h,u,c,f,d,g,p,m,y,v,w;for(o=1;o<t;o++)e[o-1]=e[o];e[t-1]=0;let x=0,_=0,b=Number.EPSILON;for(h=0;h<t;h++){for(_=Math.max(_,Math.abs(n[h])+Math.abs(e[h])),u=h;u<t&&!(Math.abs(e[u])<=b*_);)u++;if(u>h)do{for(r=n[h],c=(n[h+1]-r)/(2*e[h]),f=T(c,1),c<0&&(f=-f),n[h]=e[h]/(c+f),n[h+1]=e[h]*(c+f),d=n[h+1],s=r-n[h],o=h+2;o<t;o++)n[o]-=s;for(x+=s,c=n[u],g=1,p=g,m=g,y=e[h+1],v=0,w=0,o=u-1;o>=h;o--)for(m=p,p=g,w=v,r=g*e[o],s=g*c,f=T(c,e[o]),e[o+1]=v*f,v=e[o]/f,g=c/f,c=g*n[o]-v*r,n[o+1]=s+v*(g*r+v*n[o]),l=0;l<t;l++)s=i.get(l,o+1),i.set(l,o+1,v*i.get(l,o)+g*s),i.set(l,o,g*i.get(l,o)-v*s);c=-v*w*m*y*e[h]/d,e[h]=v*c,n[h]=g*c}while(Math.abs(e[h])>b*_);n[h]=n[h]+x,e[h]=0}for(o=0;o<t-1;o++){for(l=o,c=n[o],a=o+1;a<t;a++)n[a]<c&&(l=a,c=n[a]);if(l!==o)for(n[l]=n[o],n[o]=c,a=0;a<t;a++)c=i.get(a,o),i.set(a,o,i.get(a,l)),i.set(a,l,c)}}(s,l,a,o)}else{let t=new b(s,s),e=new Float64Array(s);for(r=0;r<s;r++)for(i=0;i<s;i++)t.set(i,r,h.get(i,r));!function(t,e,n,i){let r,s,o,a,l,h,u,c=t-1;for(h=1;h<=c-1;h++){for(u=0,a=h;a<=c;a++)u+=Math.abs(e.get(a,h-1));if(0!==u){for(o=0,a=c;a>=h;a--)n[a]=e.get(a,h-1)/u,o+=n[a]*n[a];for(s=Math.sqrt(o),n[h]>0&&(s=-s),o-=n[h]*s,n[h]=n[h]-s,l=h;l<t;l++){for(r=0,a=c;a>=h;a--)r+=n[a]*e.get(a,l);for(r/=o,a=h;a<=c;a++)e.set(a,l,e.get(a,l)-r*n[a])}for(a=0;a<=c;a++){for(r=0,l=c;l>=h;l--)r+=n[l]*e.get(a,l);for(r/=o,l=h;l<=c;l++)e.set(a,l,e.get(a,l)-r*n[l])}n[h]=u*n[h],e.set(h,h-1,u*s)}}for(a=0;a<t;a++)for(l=0;l<t;l++)i.set(a,l,a===l?1:0);for(h=c-1;h>=1;h--)if(0!==e.get(h,h-1)){for(a=h+1;a<=c;a++)n[a]=e.get(a,h-1);for(l=h;l<=c;l++){for(s=0,a=h;a<=c;a++)s+=n[a]*i.get(a,l);for(s=s/n[h]/e.get(h,h-1),a=h;a<=c;a++)i.set(a,l,i.get(a,l)+s*n[a])}}}(s,t,e,o),function(t,e,n,i,r){let s,o,a,l,h,u,c,f,d,g,p,m,y,v,w,x=t-1,_=t-1,b=Number.EPSILON,E=0,S=0,I=0,C=0,M=0,R=0,P=0,T=0;for(s=0;s<t;s++)for((s<0||s>_)&&(n[s]=r.get(s,s),e[s]=0),o=Math.max(s-1,0);o<t;o++)S+=Math.abs(r.get(s,o));for(;x>=0;){for(l=x;l>0&&(R=Math.abs(r.get(l-1,l-1))+Math.abs(r.get(l,l)),0===R&&(R=S),!(Math.abs(r.get(l,l-1))<b*R));)l--;if(l===x)r.set(x,x,r.get(x,x)+E),n[x]=r.get(x,x),e[x]=0,x--,T=0;else if(l===x-1){if(c=r.get(x,x-1)*r.get(x-1,x),I=(r.get(x-1,x-1)-r.get(x,x))/2,C=I*I+c,P=Math.sqrt(Math.abs(C)),r.set(x,x,r.get(x,x)+E),r.set(x-1,x-1,r.get(x-1,x-1)+E),f=r.get(x,x),C>=0){for(P=I>=0?I+P:I-P,n[x-1]=f+P,n[x]=n[x-1],0!==P&&(n[x]=f-c/P),e[x-1]=0,e[x]=0,f=r.get(x,x-1),R=Math.abs(f)+Math.abs(P),I=f/R,C=P/R,M=Math.sqrt(I*I+C*C),I/=M,C/=M,o=x-1;o<t;o++)P=r.get(x-1,o),r.set(x-1,o,C*P+I*r.get(x,o)),r.set(x,o,C*r.get(x,o)-I*P);for(s=0;s<=x;s++)P=r.get(s,x-1),r.set(s,x-1,C*P+I*r.get(s,x)),r.set(s,x,C*r.get(s,x)-I*P);for(s=0;s<=_;s++)P=i.get(s,x-1),i.set(s,x-1,C*P+I*i.get(s,x)),i.set(s,x,C*i.get(s,x)-I*P)}else n[x-1]=f+I,n[x]=f+I,e[x-1]=P,e[x]=-P;x-=2,T=0}else{if(f=r.get(x,x),d=0,c=0,l<x&&(d=r.get(x-1,x-1),c=r.get(x,x-1)*r.get(x-1,x)),10===T){for(E+=f,s=0;s<=x;s++)r.set(s,s,r.get(s,s)-f);R=Math.abs(r.get(x,x-1))+Math.abs(r.get(x-1,x-2)),f=d=.75*R,c=-.4375*R*R}if(30===T&&(R=(d-f)/2,R=R*R+c,R>0)){for(R=Math.sqrt(R),d<f&&(R=-R),R=f-c/((d-f)/2+R),s=0;s<=x;s++)r.set(s,s,r.get(s,s)-R);E+=R,f=d=c=.964}for(T+=1,h=x-2;h>=l&&(P=r.get(h,h),M=f-P,R=d-P,I=(M*R-c)/r.get(h+1,h)+r.get(h,h+1),C=r.get(h+1,h+1)-P-M-R,M=r.get(h+2,h+1),R=Math.abs(I)+Math.abs(C)+Math.abs(M),I/=R,C/=R,M/=R,h!==l)&&!(Math.abs(r.get(h,h-1))*(Math.abs(C)+Math.abs(M))<b*(Math.abs(I)*(Math.abs(r.get(h-1,h-1))+Math.abs(P)+Math.abs(r.get(h+1,h+1)))));)h--;for(s=h+2;s<=x;s++)r.set(s,s-2,0),s>h+2&&r.set(s,s-3,0);for(a=h;a<=x-1&&(v=a!==x-1,a!==h&&(I=r.get(a,a-1),C=r.get(a+1,a-1),M=v?r.get(a+2,a-1):0,f=Math.abs(I)+Math.abs(C)+Math.abs(M),0!==f&&(I/=f,C/=f,M/=f)),0!==f);a++)if(R=Math.sqrt(I*I+C*C+M*M),I<0&&(R=-R),0!==R){for(a!==h?r.set(a,a-1,-R*f):l!==h&&r.set(a,a-1,-r.get(a,a-1)),I+=R,f=I/R,d=C/R,P=M/R,C/=I,M/=I,o=a;o<t;o++)I=r.get(a,o)+C*r.get(a+1,o),v&&(I+=M*r.get(a+2,o),r.set(a+2,o,r.get(a+2,o)-I*P)),r.set(a,o,r.get(a,o)-I*f),r.set(a+1,o,r.get(a+1,o)-I*d);for(s=0;s<=Math.min(x,a+3);s++)I=f*r.get(s,a)+d*r.get(s,a+1),v&&(I+=P*r.get(s,a+2),r.set(s,a+2,r.get(s,a+2)-I*M)),r.set(s,a,r.get(s,a)-I),r.set(s,a+1,r.get(s,a+1)-I*C);for(s=0;s<=_;s++)I=f*i.get(s,a)+d*i.get(s,a+1),v&&(I+=P*i.get(s,a+2),i.set(s,a+2,i.get(s,a+2)-I*M)),i.set(s,a,i.get(s,a)-I),i.set(s,a+1,i.get(s,a+1)-I*C)}}}if(0!==S){for(x=t-1;x>=0;x--)if(I=n[x],C=e[x],0===C)for(l=x,r.set(x,x,1),s=x-1;s>=0;s--){for(c=r.get(s,s)-I,M=0,o=l;o<=x;o++)M+=r.get(s,o)*r.get(o,x);if(e[s]<0)P=c,R=M;else if(l=s,0===e[s]?r.set(s,x,0!==c?-M/c:-M/(b*S)):(f=r.get(s,s+1),d=r.get(s+1,s),C=(n[s]-I)*(n[s]-I)+e[s]*e[s],u=(f*R-P*M)/C,r.set(s,x,u),r.set(s+1,x,Math.abs(f)>Math.abs(P)?(-M-c*u)/f:(-R-d*u)/P)),u=Math.abs(r.get(s,x)),b*u*u>1)for(o=s;o<=x;o++)r.set(o,x,r.get(o,x)/u)}else if(C<0)for(l=x-1,Math.abs(r.get(x,x-1))>Math.abs(r.get(x-1,x))?(r.set(x-1,x-1,C/r.get(x,x-1)),r.set(x-1,x,-(r.get(x,x)-I)/r.get(x,x-1))):(w=F(0,-r.get(x-1,x),r.get(x-1,x-1)-I,C),r.set(x-1,x-1,w[0]),r.set(x-1,x,w[1])),r.set(x,x-1,0),r.set(x,x,1),s=x-2;s>=0;s--){for(g=0,p=0,o=l;o<=x;o++)g+=r.get(s,o)*r.get(o,x-1),p+=r.get(s,o)*r.get(o,x);if(c=r.get(s,s)-I,e[s]<0)P=c,M=g,R=p;else if(l=s,0===e[s]?(w=F(-g,-p,c,C),r.set(s,x-1,w[0]),r.set(s,x,w[1])):(f=r.get(s,s+1),d=r.get(s+1,s),m=(n[s]-I)*(n[s]-I)+e[s]*e[s]-C*C,y=2*(n[s]-I)*C,0===m&&0===y&&(m=b*S*(Math.abs(c)+Math.abs(C)+Math.abs(f)+Math.abs(d)+Math.abs(P))),w=F(f*M-P*g+C*p,f*R-P*p-C*g,m,y),r.set(s,x-1,w[0]),r.set(s,x,w[1]),Math.abs(f)>Math.abs(P)+Math.abs(C)?(r.set(s+1,x-1,(-g-c*r.get(s,x-1)+C*r.get(s,x))/f),r.set(s+1,x,(-p-c*r.get(s,x)-C*r.get(s,x-1))/f)):(w=F(-M-d*r.get(s,x-1),-R-d*r.get(s,x),P,C),r.set(s+1,x-1,w[0]),r.set(s+1,x,w[1]))),u=Math.max(Math.abs(r.get(s,x-1)),Math.abs(r.get(s,x))),b*u*u>1)for(o=s;o<=x;o++)r.set(o,x-1,r.get(o,x-1)/u),r.set(o,x,r.get(o,x)/u)}for(s=0;s<t;s++)if(s<0||s>_)for(o=s;o<t;o++)i.set(s,o,r.get(s,o));for(o=t-1;o>=0;o--)for(s=0;s<=_;s++){for(P=0,a=0;a<=Math.min(o,_);a++)P+=i.get(s,a)*r.get(a,o);i.set(s,o,P)}}}(s,l,a,o,t)}this.n=s,this.e=l,this.d=a,this.V=o}get realEigenvalues(){return Array.from(this.d)}get imaginaryEigenvalues(){return Array.from(this.e)}get eigenvectorMatrix(){return this.V}get diagonalMatrix(){let t,e,n=this.n,i=this.e,r=this.d,s=new b(n,n);for(t=0;t<n;t++){for(e=0;e<n;e++)s.set(t,e,0);s.set(t,t,r[t]),i[t]>0?s.set(t,t+1,i[t]):i[t]<0&&s.set(t,t-1,i[t])}return s}}function F(t,e,n,i){let r,s;return Math.abs(n)>Math.abs(i)?(r=i/n,s=n+r*i,[(t+r*e)/s,(e-r*t)/s]):(r=n/i,s=i+r*n,[(r*t+e)/s,(r*e-t)/s])}class z{constructor(t){if(!(t=R.checkMatrix(t)).isSymmetric())throw new Error("Matrix is not symmetric");let e,n,i,r=t,s=r.rows,o=new b(s,s),a=!0;for(n=0;n<s;n++){let t=0;for(i=0;i<n;i++){let s=0;for(e=0;e<i;e++)s+=o.get(i,e)*o.get(n,e);s=(r.get(n,i)-s)/o.get(i,i),o.set(n,i,s),t+=s*s}for(t=r.get(n,n)-t,a&=t>0,o.set(n,n,Math.sqrt(Math.max(t,0))),i=n+1;i<s;i++)o.set(n,i,0)}this.L=o,this.positiveDefinite=Boolean(a)}isPositiveDefinite(){return this.positiveDefinite}solve(t){t=R.checkMatrix(t);let e=this.L,n=e.rows;if(t.rows!==n)throw new Error("Matrix dimensions do not match");if(!1===this.isPositiveDefinite())throw new Error("Matrix is not positive definite");let i,r,s,o=t.columns,a=t.clone();for(s=0;s<n;s++)for(r=0;r<o;r++){for(i=0;i<s;i++)a.set(s,r,a.get(s,r)-a.get(i,r)*e.get(s,i));a.set(s,r,a.get(s,r)/e.get(s,s))}for(s=n-1;s>=0;s--)for(r=0;r<o;r++){for(i=s+1;i<n;i++)a.set(s,r,a.get(s,r)-a.get(i,r)*e.get(i,s));a.set(s,r,a.get(s,r)/e.get(s,s))}return a}get lowerTriangularMatrix(){return this.L}}class G{constructor(t,e={}){t=R.checkMatrix(t);let{Y:n}=e;const{scaleScores:r=!1,maxIterations:s=1e3,terminationCriteria:o=1e-10}=e;let a;if(n){if(n=i.isAnyArray(n)&&"number"==typeof n[0]?b.columnVector(n):R.checkMatrix(n),n.rows!==t.rows)throw new Error("Y should have the same number of rows as X");a=n.getColumnVector(0)}else a=t.getColumnVector(0);let l,h,u,c,f=1;for(let e=0;e<s&&f>o;e++)u=t.transpose().mmul(a).div(a.transpose().mmul(a).get(0,0)),u=u.div(u.norm()),l=t.mmul(u).div(u.transpose().mmul(u).get(0,0)),e>0&&(f=l.clone().sub(c).pow(2).sum()),c=l.clone(),n?(h=n.transpose().mmul(l).div(l.transpose().mmul(l).get(0,0)),h=h.div(h.norm()),a=n.mmul(h).div(h.transpose().mmul(h).get(0,0))):a=l;if(n){let e=t.transpose().mmul(l).div(l.transpose().mmul(l).get(0,0));e=e.div(e.norm());let i=t.clone().sub(l.clone().mmul(e.transpose())),r=a.transpose().mmul(l).div(l.transpose().mmul(l).get(0,0)),s=n.clone().sub(l.clone().mulS(r.get(0,0)).mmul(h.transpose()));this.t=l,this.p=e.transpose(),this.w=u.transpose(),this.q=h,this.u=a,this.s=l.transpose().mmul(l),this.xResidual=i,this.yResidual=s,this.betas=r}else this.w=u.transpose(),this.s=l.transpose().mmul(l).sqrt(),this.t=r?l.clone().div(this.s.get(0,0)):l,this.xResidual=t.sub(l.mmul(u.transpose()))}}e.AbstractMatrix=x,e.CHO=z,e.CholeskyDecomposition=z,e.DistanceMatrix=S,e.EVD=D,e.EigenvalueDecomposition=D,e.LU=P,e.LuDecomposition=P,e.Matrix=b,e.MatrixColumnSelectionView=class extends I{constructor(t,e){p(t,e),super(t,t.rows,e.length),this.columnIndices=e}set(t,e,n){return this.matrix.set(t,this.columnIndices[e],n),this}get(t,e){return this.matrix.get(t,this.columnIndices[e])}},e.MatrixColumnView=class extends I{constructor(t,e){c(t,e),super(t,t.rows,1),this.column=e}set(t,e,n){return this.matrix.set(t,this.column,n),this}get(t){return this.matrix.get(t,this.column)}},e.MatrixFlipColumnView=class extends I{constructor(t){super(t,t.rows,t.columns)}set(t,e,n){return this.matrix.set(t,this.columns-e-1,n),this}get(t,e){return this.matrix.get(t,this.columns-e-1)}},e.MatrixFlipRowView=class extends I{constructor(t){super(t,t.rows,t.columns)}set(t,e,n){return this.matrix.set(this.rows-t-1,e,n),this}get(t,e){return this.matrix.get(this.rows-t-1,e)}},e.MatrixRowSelectionView=class extends I{constructor(t,e){g(t,e),super(t,e.length,t.columns),this.rowIndices=e}set(t,e,n){return this.matrix.set(this.rowIndices[t],e,n),this}get(t,e){return this.matrix.get(this.rowIndices[t],e)}},e.MatrixRowView=class extends I{constructor(t,e){u(t,e),super(t,1,t.columns),this.row=e}set(t,e,n){return this.matrix.set(this.row,e,n),this}get(t,e){return this.matrix.get(this.row,e)}},e.MatrixSelectionView=C,e.MatrixSubView=class extends I{constructor(t,e,n,i,r){m(t,e,n,i,r),super(t,n-e+1,r-i+1),this.startRow=e,this.startColumn=i}set(t,e,n){return this.matrix.set(this.startRow+t,this.startColumn+e,n),this}get(t,e){return this.matrix.get(this.startRow+t,this.startColumn+e)}},e.MatrixTransposeView=class extends I{constructor(t){super(t,t.columns,t.rows)}set(t,e,n){return this.matrix.set(e,t,n),this}get(t,e){return this.matrix.get(e,t)}},e.NIPALS=G,e.Nipals=G,e.QR=N,e.QrDecomposition=N,e.SVD=A,e.SingularValueDecomposition=A,e.SymmetricMatrix=E,e.WrapperMatrix1D=M,e.WrapperMatrix2D=R,e.correlation=function(t,e=t,n={}){t=new b(t);let r=!1;if("object"!=typeof e||b.isMatrix(e)||i.isAnyArray(e)?e=new b(e):(n=e,e=t,r=!0),t.rows!==e.rows)throw new TypeError("Both matrices must have the same number of rows");const{center:s=!0,scale:o=!0}=n;s&&(t.center("column"),r||e.center("column")),o&&(t.scale("column"),r||e.scale("column"));const a=t.standardDeviation("column",{unbiased:!0}),l=r?a:e.standardDeviation("column",{unbiased:!0}),h=t.transpose().mmul(e);for(let e=0;e<h.rows;e++)for(let n=0;n<h.columns;n++)h.set(e,n,h.get(e,n)*(1/(a[e]*l[n]))*(1/(t.rows-1)));return h},e.covariance=function(t,e=t,n={}){t=new b(t);let r=!1;if("object"!=typeof e||b.isMatrix(e)||i.isAnyArray(e)?e=new b(e):(n=e,e=t,r=!0),t.rows!==e.rows)throw new TypeError("Both matrices must have the same number of rows");const{center:s=!0}=n;s&&(t=t.center("column"),r||(e=e.center("column")));const o=t.transpose().mmul(e);for(let e=0;e<o.rows;e++)for(let n=0;n<o.columns;n++)o.set(e,n,o.get(e,n)*(1/(t.rows-1)));return o},e.default=b,e.determinant=function t(e){if((e=b.checkMatrix(e)).isSquare()){if(0===e.columns)return 1;let n,i,r,s;if(2===e.columns)return n=e.get(0,0),i=e.get(0,1),r=e.get(1,0),s=e.get(1,1),n*s-i*r;if(3===e.columns){let s,o,a;return s=new C(e,[1,2],[1,2]),o=new C(e,[1,2],[0,2]),a=new C(e,[1,2],[0,1]),n=e.get(0,0),i=e.get(0,1),r=e.get(0,2),n*t(s)-i*t(o)+r*t(a)}return new P(e).determinant}throw Error("determinant can only be calculated for a square matrix")},e.inverse=function(t,e=!1){return t=R.checkMatrix(t),e?new A(t).inverse():k(t,b.eye(t.rows))},e.linearDependencies=function(t,e={}){const{thresholdValue:n=1e-9,thresholdError:i=1e-9}=e;let r=(t=b.checkMatrix(t)).rows,s=new b(r,r);for(let e=0;e<r;e++){let o=b.columnVector(t.getRow(e)),a=t.subMatrixRow(L(r,e)).transpose(),l=new A(a).solve(o),h=b.sub(o,a.mmul(l)).abs().max();s.setRow(e,O(h,l,e,n,i))}return s},e.pseudoInverse=function(t,e=Number.EPSILON){if((t=b.checkMatrix(t)).isEmpty())return t.transpose();let n=new A(t,{autoTranspose:!0}),i=n.leftSingularVectors,r=n.rightSingularVectors,s=n.diagonal;for(let t=0;t<s.length;t++)Math.abs(s[t])>e?s[t]=1/s[t]:s[t]=0;return r.mmul(b.diag(s).mmul(i.transpose()))},e.solve=k,e.wrap=function(t,e){if(i.isAnyArray(t))return t[0]&&i.isAnyArray(t[0])?new R(t):new M(t,e);throw new Error("the argument is not an array")}},4529:(t,e,n)=>{"use strict";t.exports=function(t){var e=t.length;if(e<3){for(var n=new Array(e),r=0;r<e;++r)n[r]=r;return 2===e&&t[0][0]===t[1][0]&&t[0][1]===t[1][1]?[0]:n}var s=new Array(e);for(r=0;r<e;++r)s[r]=r;s.sort((function(e,n){return t[e][0]-t[n][0]||t[e][1]-t[n][1]}));var o=[s[0],s[1]],a=[s[0],s[1]];for(r=2;r<e;++r){for(var l=s[r],h=t[l],u=o.length;u>1&&i(t[o[u-2]],t[o[u-1]],h)<=0;)u-=1,o.pop();for(o.push(l),u=a.length;u>1&&i(t[a[u-2]],t[a[u-1]],h)>=0;)u-=1,a.pop();a.push(l)}n=new Array(a.length+o.length-2);for(var c=0,f=(r=0,o.length);r<f;++r)n[c++]=o[r];for(var d=a.length-2;d>0;--d)n[c++]=a[d];return n};var i=n(146)[3]},2664:t=>{t.exports=function(t,e){t=t||0;for(var n=new Array(t),i=0;i<t;i++)n[i]=e;return n}},995:t=>{t.exports=function(t){return 0===t?1:(t--,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,1+(t|=t>>16))}},4244:t=>{"use strict";var e=function(t){return t!=t};t.exports=function(t,n){return 0===t&&0===n?1/t==1/n:t===n||!(!e(t)||!e(n))}},609:(t,e,n)=>{"use strict";var i=n(4289),r=n(5559),s=n(4244),o=n(5624),a=n(2281),l=r(o(),Object);i(l,{getPolyfill:o,implementation:s,shim:a}),t.exports=l},5624:(t,e,n)=>{"use strict";var i=n(4244);t.exports=function(){return"function"==typeof Object.is?Object.is:i}},2281:(t,e,n)=>{"use strict";var i=n(5624),r=n(4289);t.exports=function(){var t=i();return r(Object,{is:t},{is:function(){return Object.is!==t}}),t}},8987:(t,e,n)=>{"use strict";var i;if(!Object.keys){var r=Object.prototype.hasOwnProperty,s=Object.prototype.toString,o=n(1414),a=Object.prototype.propertyIsEnumerable,l=!a.call({toString:null},"toString"),h=a.call((function(){}),"prototype"),u=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],c=function(t){var e=t.constructor;return e&&e.prototype===t},f={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},d=function(){if("undefined"==typeof window)return!1;for(var t in window)try{if(!f["$"+t]&&r.call(window,t)&&null!==window[t]&&"object"==typeof window[t])try{c(window[t])}catch(t){return!0}}catch(t){return!0}return!1}();i=function(t){var e=null!==t&&"object"==typeof t,n="[object Function]"===s.call(t),i=o(t),a=e&&"[object String]"===s.call(t),f=[];if(!e&&!n&&!i)throw new TypeError("Object.keys called on a non-object");var g=h&&n;if(a&&t.length>0&&!r.call(t,0))for(var p=0;p<t.length;++p)f.push(String(p));if(i&&t.length>0)for(var m=0;m<t.length;++m)f.push(String(m));else for(var y in t)g&&"prototype"===y||!r.call(t,y)||f.push(String(y));if(l)for(var v=function(t){if("undefined"==typeof window||!d)return c(t);try{return c(t)}catch(t){return!1}}(t),w=0;w<u.length;++w)v&&"constructor"===u[w]||!r.call(t,u[w])||f.push(u[w]);return f}}t.exports=i},2215:(t,e,n)=>{"use strict";var i=Array.prototype.slice,r=n(1414),s=Object.keys,o=s?function(t){return s(t)}:n(8987),a=Object.keys;o.shim=function(){if(Object.keys){var t=function(){var t=Object.keys(arguments);return t&&t.length===arguments.length}(1,2);t||(Object.keys=function(t){return r(t)?a(i.call(t)):a(t)})}else Object.keys=o;return Object.keys||o},t.exports=o},1414:t=>{"use strict";var e=Object.prototype.toString;t.exports=function(t){var n=e.call(t),i="[object Arguments]"===n;return i||(i="[object Array]"!==n&&null!==t&&"object"==typeof t&&"number"==typeof t.length&&t.length>=0&&"[object Function]"===e.call(t.callee)),i}},3614:(t,e,n)=>{"use strict";t.exports=r;var i=n(645);function r(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}r.Varint=0,r.Fixed64=1,r.Bytes=2,r.Fixed32=5;var s=4294967296,o=1/s,a="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");function l(t){return t.type===r.Bytes?t.readVarint()+t.pos:t.pos+1}function h(t,e,n){return n?4294967296*e+(t>>>0):4294967296*(e>>>0)+(t>>>0)}function u(t,e,n){var i=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));n.realloc(i);for(var r=n.pos-1;r>=t;r--)n.buf[r+i]=n.buf[r]}function c(t,e){for(var n=0;n<t.length;n++)e.writeVarint(t[n])}function f(t,e){for(var n=0;n<t.length;n++)e.writeSVarint(t[n])}function d(t,e){for(var n=0;n<t.length;n++)e.writeFloat(t[n])}function g(t,e){for(var n=0;n<t.length;n++)e.writeDouble(t[n])}function p(t,e){for(var n=0;n<t.length;n++)e.writeBoolean(t[n])}function m(t,e){for(var n=0;n<t.length;n++)e.writeFixed32(t[n])}function y(t,e){for(var n=0;n<t.length;n++)e.writeSFixed32(t[n])}function v(t,e){for(var n=0;n<t.length;n++)e.writeFixed64(t[n])}function w(t,e){for(var n=0;n<t.length;n++)e.writeSFixed64(t[n])}function x(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+16777216*t[e+3]}function _(t,e,n){t[n]=e,t[n+1]=e>>>8,t[n+2]=e>>>16,t[n+3]=e>>>24}function b(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}r.prototype={destroy:function(){this.buf=null},readFields:function(t,e,n){for(n=n||this.length;this.pos<n;){var i=this.readVarint(),r=i>>3,s=this.pos;this.type=7&i,t(r,e,this),this.pos===s&&this.skip(i)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=x(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=b(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=x(this.buf,this.pos)+x(this.buf,this.pos+4)*s;return this.pos+=8,t},readSFixed64:function(){var t=x(this.buf,this.pos)+b(this.buf,this.pos+4)*s;return this.pos+=8,t},readFloat:function(){var t=i.read(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=i.read(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e,n,i=this.buf;return e=127&(n=i[this.pos++]),n<128?e:(e|=(127&(n=i[this.pos++]))<<7,n<128?e:(e|=(127&(n=i[this.pos++]))<<14,n<128?e:(e|=(127&(n=i[this.pos++]))<<21,n<128?e:function(t,e,n){var i,r,s=n.buf;if(i=(112&(r=s[n.pos++]))>>4,r<128)return h(t,i,e);if(i|=(127&(r=s[n.pos++]))<<3,r<128)return h(t,i,e);if(i|=(127&(r=s[n.pos++]))<<10,r<128)return h(t,i,e);if(i|=(127&(r=s[n.pos++]))<<17,r<128)return h(t,i,e);if(i|=(127&(r=s[n.pos++]))<<24,r<128)return h(t,i,e);if(i|=(1&(r=s[n.pos++]))<<31,r<128)return h(t,i,e);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(n=i[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,e=this.pos;return this.pos=t,t-e>=12&&a?function(t,e,n){return a.decode(t.subarray(e,n))}(this.buf,e,t):function(t,e,n){for(var i="",r=e;r<n;){var s,o,a,l=t[r],h=null,u=l>239?4:l>223?3:l>191?2:1;if(r+u>n)break;1===u?l<128&&(h=l):2===u?128==(192&(s=t[r+1]))&&(h=(31&l)<<6|63&s)<=127&&(h=null):3===u?(s=t[r+1],o=t[r+2],128==(192&s)&&128==(192&o)&&((h=(15&l)<<12|(63&s)<<6|63&o)<=2047||h>=55296&&h<=57343)&&(h=null)):4===u&&(s=t[r+1],o=t[r+2],a=t[r+3],128==(192&s)&&128==(192&o)&&128==(192&a)&&((h=(15&l)<<18|(63&s)<<12|(63&o)<<6|63&a)<=65535||h>=1114112)&&(h=null)),null===h?(h=65533,u=1):h>65535&&(h-=65536,i+=String.fromCharCode(h>>>10&1023|55296),h=56320|1023&h),i+=String.fromCharCode(h),r+=u}return i}(this.buf,e,t)},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){if(this.type!==r.Bytes)return t.push(this.readVarint(e));var n=l(this);for(t=t||[];this.pos<n;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){if(this.type!==r.Bytes)return t.push(this.readSVarint());var e=l(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==r.Bytes)return t.push(this.readBoolean());var e=l(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==r.Bytes)return t.push(this.readFloat());var e=l(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==r.Bytes)return t.push(this.readDouble());var e=l(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==r.Bytes)return t.push(this.readFixed32());var e=l(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==r.Bytes)return t.push(this.readSFixed32());var e=l(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==r.Bytes)return t.push(this.readFixed64());var e=l(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==r.Bytes)return t.push(this.readSFixed64());var e=l(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=7&t;if(e===r.Varint)for(;this.buf[this.pos++]>127;);else if(e===r.Bytes)this.pos=this.readVarint()+this.pos;else if(e===r.Fixed32)this.pos+=4;else{if(e!==r.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var n=new Uint8Array(e);n.set(this.buf),this.buf=n,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),_(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),_(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),_(this.buf,-1&t,this.pos),_(this.buf,Math.floor(t*o),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),_(this.buf,-1&t,this.pos),_(this.buf,Math.floor(t*o),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?function(t,e){var n,i;if(t>=0?(n=t%4294967296|0,i=t/4294967296|0):(i=~(-t/4294967296),4294967295^(n=~(-t%4294967296))?n=n+1|0:(n=0,i=i+1|0)),t>=0x10000000000000000||t<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");e.realloc(10),function(t,e,n){n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos]=127&t}(n,0,e),function(t,e){var n=(7&t)<<4;e.buf[e.pos++]|=n|((t>>>=3)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t)))))}(i,e)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var e=this.pos;this.pos=function(t,e,n){for(var i,r,s=0;s<e.length;s++){if((i=e.charCodeAt(s))>55295&&i<57344){if(!r){i>56319||s+1===e.length?(t[n++]=239,t[n++]=191,t[n++]=189):r=i;continue}if(i<56320){t[n++]=239,t[n++]=191,t[n++]=189,r=i;continue}i=r-55296<<10|i-56320|65536,r=null}else r&&(t[n++]=239,t[n++]=191,t[n++]=189,r=null);i<128?t[n++]=i:(i<2048?t[n++]=i>>6|192:(i<65536?t[n++]=i>>12|224:(t[n++]=i>>18|240,t[n++]=i>>12&63|128),t[n++]=i>>6&63|128),t[n++]=63&i|128)}return n}(this.buf,t,this.pos);var n=this.pos-e;n>=128&&u(e,n,this),this.pos=e-1,this.writeVarint(n),this.pos+=n},writeFloat:function(t){this.realloc(4),i.write(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),i.write(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var n=0;n<e;n++)this.buf[this.pos++]=t[n]},writeRawMessage:function(t,e){this.pos++;var n=this.pos;t(e,this);var i=this.pos-n;i>=128&&u(n,i,this),this.pos=n-1,this.writeVarint(i),this.pos+=i},writeMessage:function(t,e,n){this.writeTag(t,r.Bytes),this.writeRawMessage(e,n)},writePackedVarint:function(t,e){e.length&&this.writeMessage(t,c,e)},writePackedSVarint:function(t,e){e.length&&this.writeMessage(t,f,e)},writePackedBoolean:function(t,e){e.length&&this.writeMessage(t,p,e)},writePackedFloat:function(t,e){e.length&&this.writeMessage(t,d,e)},writePackedDouble:function(t,e){e.length&&this.writeMessage(t,g,e)},writePackedFixed32:function(t,e){e.length&&this.writeMessage(t,m,e)},writePackedSFixed32:function(t,e){e.length&&this.writeMessage(t,y,e)},writePackedFixed64:function(t,e){e.length&&this.writeMessage(t,v,e)},writePackedSFixed64:function(t,e){e.length&&this.writeMessage(t,w,e)},writeBytesField:function(t,e){this.writeTag(t,r.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,r.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,r.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,r.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,r.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,r.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,r.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,r.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,r.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,r.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,Boolean(e))}}},148:t=>{"use strict";t.exports=function(t,r,o,a,l,h){if(!n(t)||!n(r)||o&&!n(o))throw new Error("Image data: Uint8Array, Uint8ClampedArray or Buffer expected.");if(t.length!==r.length||o&&o.length!==t.length)throw new Error("Image sizes do not match.");if(t.length!==a*l*4)throw new Error("Image data size does not match width/height.");h=Object.assign({},e,h);const f=a*l,d=new Uint32Array(t.buffer,t.byteOffset,f),g=new Uint32Array(r.buffer,r.byteOffset,f);let p=!0;for(let t=0;t<f;t++)if(d[t]!==g[t]){p=!1;break}if(p){if(o&&!h.diffMask)for(let e=0;e<f;e++)c(t,4*e,h.alpha,o);return 0}const m=35215*h.threshold*h.threshold;let y=0;for(let e=0;e<l;e++)for(let n=0;n<a;n++){const f=4*(e*a+n),d=s(t,r,f,f);Math.abs(d)>m?h.includeAA||!i(t,n,e,a,l,r)&&!i(r,n,e,a,l,t)?(o&&u(o,f,...d<0&&h.diffColorAlt||h.diffColor),y++):o&&!h.diffMask&&u(o,f,...h.aaColor):o&&(h.diffMask||c(t,f,h.alpha,o))}return y};const e={threshold:.1,includeAA:!1,alpha:.1,aaColor:[255,255,0],diffColor:[255,0,0],diffColorAlt:null,diffMask:!1};function n(t){return ArrayBuffer.isView(t)&&1===t.constructor.BYTES_PER_ELEMENT}function i(t,e,n,i,o,a){const l=Math.max(e-1,0),h=Math.max(n-1,0),u=Math.min(e+1,i-1),c=Math.min(n+1,o-1),f=4*(n*i+e);let d,g,p,m,y=e===l||e===u||n===h||n===c?1:0,v=0,w=0;for(let r=l;r<=u;r++)for(let o=h;o<=c;o++){if(r===e&&o===n)continue;const a=s(t,t,f,4*(o*i+r),!0);if(0===a){if(y++,y>2)return!1}else a<v?(v=a,d=r,g=o):a>w&&(w=a,p=r,m=o)}return 0!==v&&0!==w&&(r(t,d,g,i,o)&&r(a,d,g,i,o)||r(t,p,m,i,o)&&r(a,p,m,i,o))}function r(t,e,n,i,r){const s=Math.max(e-1,0),o=Math.max(n-1,0),a=Math.min(e+1,i-1),l=Math.min(n+1,r-1),h=4*(n*i+e);let u=e===s||e===a||n===o||n===l?1:0;for(let r=s;r<=a;r++)for(let s=o;s<=l;s++){if(r===e&&s===n)continue;const o=4*(s*i+r);if(t[h]===t[o]&&t[h+1]===t[o+1]&&t[h+2]===t[o+2]&&t[h+3]===t[o+3]&&u++,u>2)return!0}return!1}function s(t,e,n,i,r){let s=t[n+0],u=t[n+1],c=t[n+2],f=t[n+3],d=e[i+0],g=e[i+1],p=e[i+2],m=e[i+3];if(f===m&&s===d&&u===g&&c===p)return 0;f<255&&(f/=255,s=h(s,f),u=h(u,f),c=h(c,f)),m<255&&(m/=255,d=h(d,m),g=h(g,m),p=h(p,m));const y=o(s,u,c),v=o(d,g,p),w=y-v;if(r)return w;const x=a(s,u,c)-a(d,g,p),_=l(s,u,c)-l(d,g,p),b=.5053*w*w+.299*x*x+.1957*_*_;return y>v?-b:b}function o(t,e,n){return.29889531*t+.58662247*e+.11448223*n}function a(t,e,n){return.59597799*t-.2741761*e-.32180189*n}function l(t,e,n){return.21147017*t-.52261711*e+.31114694*n}function h(t,e){return 255+(t-255)*e}function u(t,e,n,i,r){t[e+0]=n,t[e+1]=i,t[e+2]=r,t[e+3]=255}function c(t,e,n,i){const r=h(o(t[e+0],t[e+1],t[e+2]),n*t[e+3]/255);u(i,e,r,r,r)}},2676:function(t){t.exports=function(){"use strict";function t(t,e){var n,i,r,s,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,i&&(r=2&s[0]?i.return:s[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,s[1])).done)return r;switch(i=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,i=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((r=(r=o.trys).length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){o.label=s[1];break}if(6===s[0]&&o.label<r[1]){o.label=r[1],r=s;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(s);break}r[2]&&o.ops.pop(),o.trys.pop();continue}s=e.call(t,o)}catch(t){s=[6,t],i=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}}var e=function(t,e){this.next=null,this.key=t,this.data=e,this.left=null,this.right=null};function n(t,e){return t>e?1:t<e?-1:0}function i(t,n,i){for(var r=new e(null,null),s=r,o=r;;){var a=i(t,n.key);if(a<0){if(null===n.left)break;if(i(t,n.left.key)<0){var l=n.left;if(n.left=l.right,l.right=n,null===(n=l).left)break}o.left=n,o=n,n=n.left}else{if(!(a>0))break;if(null===n.right)break;if(i(t,n.right.key)>0&&(l=n.right,n.right=l.left,l.left=n,null===(n=l).right))break;s.right=n,s=n,n=n.right}}return s.right=n.left,o.left=n.right,n.left=r.right,n.right=r.left,n}function r(t,n,r,s){var o=new e(t,n);if(null===r)return o.left=o.right=null,o;var a=s(t,(r=i(t,r,s)).key);return a<0?(o.left=r.left,o.right=r,r.left=null):a>=0&&(o.right=r.right,o.left=r,r.right=null),o}function s(t,e,n){var r=null,s=null;if(e){var o=n((e=i(t,e,n)).key,t);0===o?(r=e.left,s=e.right):o<0?(s=e.right,e.right=null,r=e):(r=e.left,e.left=null,s=e)}return{left:r,right:s}}function o(t,e,n,i,r){if(t){i(e+(n?" ":" ")+r(t)+"\n");var s=e+(n?"    ":"   ");t.left&&o(t.left,s,!1,i,r),t.right&&o(t.right,s,!0,i,r)}}var a=function(){function a(t){void 0===t&&(t=n),this._root=null,this._size=0,this._comparator=t}return a.prototype.insert=function(t,e){return this._size++,this._root=r(t,e,this._root,this._comparator)},a.prototype.add=function(t,n){var r=new e(t,n);null===this._root&&(r.left=r.right=null,this._size++,this._root=r);var s=this._comparator,o=i(t,this._root,s),a=s(t,o.key);return 0===a?this._root=o:(a<0?(r.left=o.left,r.right=o,o.left=null):a>0&&(r.right=o.right,r.left=o,o.right=null),this._size++,this._root=r),this._root},a.prototype.remove=function(t){this._root=this._remove(t,this._root,this._comparator)},a.prototype._remove=function(t,e,n){var r;return null===e?null:0===n(t,(e=i(t,e,n)).key)?(null===e.left?r=e.right:(r=i(t,e.left,n)).right=e.right,this._size--,r):e},a.prototype.pop=function(){var t=this._root;if(t){for(;t.left;)t=t.left;return this._root=i(t.key,this._root,this._comparator),this._root=this._remove(t.key,this._root,this._comparator),{key:t.key,data:t.data}}return null},a.prototype.findStatic=function(t){for(var e=this._root,n=this._comparator;e;){var i=n(t,e.key);if(0===i)return e;e=i<0?e.left:e.right}return null},a.prototype.find=function(t){return this._root&&(this._root=i(t,this._root,this._comparator),0!==this._comparator(t,this._root.key))?null:this._root},a.prototype.contains=function(t){for(var e=this._root,n=this._comparator;e;){var i=n(t,e.key);if(0===i)return!0;e=i<0?e.left:e.right}return!1},a.prototype.forEach=function(t,e){for(var n=this._root,i=[],r=!1;!r;)null!==n?(i.push(n),n=n.left):0!==i.length?(n=i.pop(),t.call(e,n),n=n.right):r=!0;return this},a.prototype.range=function(t,e,n,i){for(var r=[],s=this._comparator,o=this._root;0!==r.length||o;)if(o)r.push(o),o=o.left;else{if(s((o=r.pop()).key,e)>0)break;if(s(o.key,t)>=0&&n.call(i,o))return this;o=o.right}return this},a.prototype.keys=function(){var t=[];return this.forEach((function(e){var n=e.key;return t.push(n)})),t},a.prototype.values=function(){var t=[];return this.forEach((function(e){var n=e.data;return t.push(n)})),t},a.prototype.min=function(){return this._root?this.minNode(this._root).key:null},a.prototype.max=function(){return this._root?this.maxNode(this._root).key:null},a.prototype.minNode=function(t){if(void 0===t&&(t=this._root),t)for(;t.left;)t=t.left;return t},a.prototype.maxNode=function(t){if(void 0===t&&(t=this._root),t)for(;t.right;)t=t.right;return t},a.prototype.at=function(t){for(var e=this._root,n=!1,i=0,r=[];!n;)if(e)r.push(e),e=e.left;else if(r.length>0){if(e=r.pop(),i===t)return e;i++,e=e.right}else n=!0;return null},a.prototype.next=function(t){var e=this._root,n=null;if(t.right){for(n=t.right;n.left;)n=n.left;return n}for(var i=this._comparator;e;){var r=i(t.key,e.key);if(0===r)break;r<0?(n=e,e=e.left):e=e.right}return n},a.prototype.prev=function(t){var e=this._root,n=null;if(null!==t.left){for(n=t.left;n.right;)n=n.right;return n}for(var i=this._comparator;e;){var r=i(t.key,e.key);if(0===r)break;r<0?e=e.left:(n=e,e=e.right)}return n},a.prototype.clear=function(){return this._root=null,this._size=0,this},a.prototype.toList=function(){return function(t){for(var n=t,i=[],r=!1,s=new e(null,null),o=s;!r;)n?(i.push(n),n=n.left):i.length>0?n=(n=o=o.next=i.pop()).right:r=!0;return o.next=null,s.next}(this._root)},a.prototype.load=function(t,n,i){void 0===n&&(n=[]),void 0===i&&(i=!1);var r=t.length,s=this._comparator;if(i&&u(t,n,0,r-1,s),null===this._root)this._root=l(t,n,0,r),this._size=r;else{var o=function(t,n,i){for(var r=new e(null,null),s=r,o=t,a=n;null!==o&&null!==a;)i(o.key,a.key)<0?(s.next=o,o=o.next):(s.next=a,a=a.next),s=s.next;return null!==o?s.next=o:null!==a&&(s.next=a),r.next}(this.toList(),function(t,n){for(var i=new e(null,null),r=i,s=0;s<t.length;s++)r=r.next=new e(t[s],n[s]);return r.next=null,i.next}(t,n),s);r=this._size+r,this._root=h({head:o},0,r)}return this},a.prototype.isEmpty=function(){return null===this._root},Object.defineProperty(a.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),a.prototype.toString=function(t){void 0===t&&(t=function(t){return String(t.key)});var e=[];return o(this._root,"",!0,(function(t){return e.push(t)}),t),e.join("")},a.prototype.update=function(t,e,n){var o=this._comparator,a=s(t,this._root,o),l=a.left,h=a.right;o(t,e)<0?h=r(e,n,h,o):l=r(e,n,l,o),this._root=function(t,e,n){return null===e?t:(null===t||((e=i(t.key,e,n)).left=t),e)}(l,h,o)},a.prototype.split=function(t){return s(t,this._root,this._comparator)},a.prototype[Symbol.iterator]=function(){var e,n,i;return t(this,(function(t){switch(t.label){case 0:e=this._root,n=[],i=!1,t.label=1;case 1:return i?[3,6]:null===e?[3,2]:(n.push(e),e=e.left,[3,5]);case 2:return 0===n.length?[3,4]:[4,e=n.pop()];case 3:return t.sent(),e=e.right,[3,5];case 4:i=!0,t.label=5;case 5:return[3,1];case 6:return[2]}}))},a}();function l(t,n,i,r){var s=r-i;if(s>0){var o=i+Math.floor(s/2),a=t[o],h=n[o],u=new e(a,h);return u.left=l(t,n,i,o),u.right=l(t,n,o+1,r),u}return null}function h(t,e,n){var i=n-e;if(i>0){var r=e+Math.floor(i/2),s=h(t,e,r),o=t.head;return o.left=s,t.head=t.head.next,o.right=h(t,r+1,n),o}return null}function u(t,e,n,i,r){if(!(n>=i)){for(var s=t[n+i>>1],o=n-1,a=i+1;;){do{o++}while(r(t[o],s)<0);do{a--}while(r(t[a],s)>0);if(o>=a)break;var l=t[o];t[o]=t[a],t[a]=l,l=e[o],e[o]=e[a],e[a]=l}u(t,e,n,a,r),u(t,e,a+1,i,r)}}const c=(t,e)=>t.ll.x<=e.x&&e.x<=t.ur.x&&t.ll.y<=e.y&&e.y<=t.ur.y,f=(t,e)=>{if(e.ur.x<t.ll.x||t.ur.x<e.ll.x||e.ur.y<t.ll.y||t.ur.y<e.ll.y)return null;const n=t.ll.x<e.ll.x?e.ll.x:t.ll.x,i=t.ur.x<e.ur.x?t.ur.x:e.ur.x;return{ll:{x:n,y:t.ll.y<e.ll.y?e.ll.y:t.ll.y},ur:{x:i,y:t.ur.y<e.ur.y?t.ur.y:e.ur.y}}};let d=Number.EPSILON;void 0===d&&(d=Math.pow(2,-52));const g=d*d,p=(t,e)=>{if(-d<t&&t<d&&-d<e&&e<d)return 0;const n=t-e;return n*n<g*t*e?0:t<e?-1:1};class m{constructor(){this.tree=new a,this.round(0)}round(t){const e=this.tree.add(t),n=this.tree.prev(e);if(null!==n&&0===p(e.key,n.key))return this.tree.remove(t),n.key;const i=this.tree.next(e);return null!==i&&0===p(e.key,i.key)?(this.tree.remove(t),i.key):t}}const y=new class{constructor(){this.reset()}reset(){this.xRounder=new m,this.yRounder=new m}round(t,e){return{x:this.xRounder.round(t),y:this.yRounder.round(e)}}},v=11102230246251565e-32,w=134217729,x=(3+8*v)*v;function _(t,e,n,i,r){let s,o,a,l,h=e[0],u=i[0],c=0,f=0;u>h==u>-h?(s=h,h=e[++c]):(s=u,u=i[++f]);let d=0;if(c<t&&f<n)for(u>h==u>-h?(o=h+s,a=s-(o-h),h=e[++c]):(o=u+s,a=s-(o-u),u=i[++f]),s=o,0!==a&&(r[d++]=a);c<t&&f<n;)u>h==u>-h?(o=s+h,l=o-s,a=s-(o-l)+(h-l),h=e[++c]):(o=s+u,l=o-s,a=s-(o-l)+(u-l),u=i[++f]),s=o,0!==a&&(r[d++]=a);for(;c<t;)o=s+h,l=o-s,a=s-(o-l)+(h-l),h=e[++c],s=o,0!==a&&(r[d++]=a);for(;f<n;)o=s+u,l=o-s,a=s-(o-l)+(u-l),u=i[++f],s=o,0!==a&&(r[d++]=a);return 0===s&&0!==d||(r[d++]=s),d}function b(t){return new Float64Array(t)}const E=22204460492503146e-32,S=11093356479670487e-47,I=b(4),C=b(8),M=b(12),R=b(16),P=b(4);function T(t,e,n,i,r,s){const o=(e-s)*(n-r),a=(t-r)*(i-s),l=o-a,h=Math.abs(o+a);return Math.abs(l)>=33306690738754716e-32*h?l:-function(t,e,n,i,r,s,o){let a,l,h,u,c,f,d,g,p,m,y,v,b,T,N,A,k,L;const O=t-r,D=n-r,F=e-s,z=i-s;T=O*z,f=w*O,d=f-(f-O),g=O-d,f=w*z,p=f-(f-z),m=z-p,N=g*m-(T-d*p-g*p-d*m),A=F*D,f=w*F,d=f-(f-F),g=F-d,f=w*D,p=f-(f-D),m=D-p,k=g*m-(A-d*p-g*p-d*m),y=N-k,c=N-y,I[0]=N-(y+c)+(c-k),v=T+y,c=v-T,b=T-(v-c)+(y-c),y=b-A,c=b-y,I[1]=b-(y+c)+(c-A),L=v+y,c=L-v,I[2]=v-(L-c)+(y-c),I[3]=L;let G=function(t,e){let n=e[0];for(let i=1;i<t;i++)n+=e[i];return n}(4,I),B=E*o;if(G>=B||-G>=B)return G;if(c=t-O,a=t-(O+c)+(c-r),c=n-D,h=n-(D+c)+(c-r),c=e-F,l=e-(F+c)+(c-s),c=i-z,u=i-(z+c)+(c-s),0===a&&0===l&&0===h&&0===u)return G;if(B=S*o+x*Math.abs(G),G+=O*u+z*a-(F*h+D*l),G>=B||-G>=B)return G;T=a*z,f=w*a,d=f-(f-a),g=a-d,f=w*z,p=f-(f-z),m=z-p,N=g*m-(T-d*p-g*p-d*m),A=l*D,f=w*l,d=f-(f-l),g=l-d,f=w*D,p=f-(f-D),m=D-p,k=g*m-(A-d*p-g*p-d*m),y=N-k,c=N-y,P[0]=N-(y+c)+(c-k),v=T+y,c=v-T,b=T-(v-c)+(y-c),y=b-A,c=b-y,P[1]=b-(y+c)+(c-A),L=v+y,c=L-v,P[2]=v-(L-c)+(y-c),P[3]=L;const U=_(4,I,4,P,C);T=O*u,f=w*O,d=f-(f-O),g=O-d,f=w*u,p=f-(f-u),m=u-p,N=g*m-(T-d*p-g*p-d*m),A=F*h,f=w*F,d=f-(f-F),g=F-d,f=w*h,p=f-(f-h),m=h-p,k=g*m-(A-d*p-g*p-d*m),y=N-k,c=N-y,P[0]=N-(y+c)+(c-k),v=T+y,c=v-T,b=T-(v-c)+(y-c),y=b-A,c=b-y,P[1]=b-(y+c)+(c-A),L=v+y,c=L-v,P[2]=v-(L-c)+(y-c),P[3]=L;const q=_(U,C,4,P,M);T=a*u,f=w*a,d=f-(f-a),g=a-d,f=w*u,p=f-(f-u),m=u-p,N=g*m-(T-d*p-g*p-d*m),A=l*h,f=w*l,d=f-(f-l),g=l-d,f=w*h,p=f-(f-h),m=h-p,k=g*m-(A-d*p-g*p-d*m),y=N-k,c=N-y,P[0]=N-(y+c)+(c-k),v=T+y,c=v-T,b=T-(v-c)+(y-c),y=b-A,c=b-y,P[1]=b-(y+c)+(c-A),L=v+y,c=L-v,P[2]=v-(L-c)+(y-c),P[3]=L;const V=_(q,M,4,P,R);return R[V-1]}(t,e,n,i,r,s,h)}const N=(t,e)=>t.x*e.y-t.y*e.x,A=(t,e)=>t.x*e.x+t.y*e.y,k=(t,e,n)=>{const i=T(t.x,t.y,e.x,e.y,n.x,n.y);return i>0?-1:i<0?1:0},L=t=>Math.sqrt(A(t,t)),O=(t,e,n)=>{const i={x:e.x-t.x,y:e.y-t.y},r={x:n.x-t.x,y:n.y-t.y};return N(r,i)/L(r)/L(i)},D=(t,e,n)=>{const i={x:e.x-t.x,y:e.y-t.y},r={x:n.x-t.x,y:n.y-t.y};return A(r,i)/L(r)/L(i)},F=(t,e,n)=>0===e.y?null:{x:t.x+e.x/e.y*(n-t.y),y:n},z=(t,e,n)=>0===e.x?null:{x:n,y:t.y+e.y/e.x*(n-t.x)};class G{static compare(t,e){const n=G.comparePoints(t.point,e.point);return 0!==n?n:(t.point!==e.point&&t.link(e),t.isLeft!==e.isLeft?t.isLeft?1:-1:U.compare(t.segment,e.segment))}static comparePoints(t,e){return t.x<e.x?-1:t.x>e.x?1:t.y<e.y?-1:t.y>e.y?1:0}constructor(t,e){void 0===t.events?t.events=[this]:t.events.push(this),this.point=t,this.isLeft=e}link(t){if(t.point===this.point)throw new Error("Tried to link already linked events");const e=t.point.events;for(let t=0,n=e.length;t<n;t++){const n=e[t];this.point.events.push(n),n.point=this.point}this.checkForConsuming()}checkForConsuming(){const t=this.point.events.length;for(let e=0;e<t;e++){const n=this.point.events[e];if(void 0===n.segment.consumedBy)for(let i=e+1;i<t;i++){const t=this.point.events[i];void 0===t.consumedBy&&n.otherSE.point.events===t.otherSE.point.events&&n.segment.consume(t.segment)}}}getAvailableLinkedEvents(){const t=[];for(let e=0,n=this.point.events.length;e<n;e++){const n=this.point.events[e];n!==this&&!n.segment.ringOut&&n.segment.isInResult()&&t.push(n)}return t}getLeftmostComparator(t){const e=new Map,n=n=>{const i=n.otherSE;e.set(n,{sine:O(this.point,t.point,i.point),cosine:D(this.point,t.point,i.point)})};return(t,i)=>{e.has(t)||n(t),e.has(i)||n(i);const{sine:r,cosine:s}=e.get(t),{sine:o,cosine:a}=e.get(i);return r>=0&&o>=0?s<a?1:s>a?-1:0:r<0&&o<0?s<a?-1:s>a?1:0:o<r?-1:o>r?1:0}}}let B=0;class U{static compare(t,e){const n=t.leftSE.point.x,i=e.leftSE.point.x,r=t.rightSE.point.x,s=e.rightSE.point.x;if(s<n)return 1;if(r<i)return-1;const o=t.leftSE.point.y,a=e.leftSE.point.y,l=t.rightSE.point.y,h=e.rightSE.point.y;if(n<i){if(a<o&&a<l)return 1;if(a>o&&a>l)return-1;const n=t.comparePoint(e.leftSE.point);if(n<0)return 1;if(n>0)return-1;const i=e.comparePoint(t.rightSE.point);return 0!==i?i:-1}if(n>i){if(o<a&&o<h)return-1;if(o>a&&o>h)return 1;const n=e.comparePoint(t.leftSE.point);if(0!==n)return n;const i=t.comparePoint(e.rightSE.point);return i<0?1:i>0?-1:1}if(o<a)return-1;if(o>a)return 1;if(r<s){const n=e.comparePoint(t.rightSE.point);if(0!==n)return n}if(r>s){const n=t.comparePoint(e.rightSE.point);if(n<0)return 1;if(n>0)return-1}if(r!==s){const t=l-o,e=r-n,u=h-a,c=s-i;if(t>e&&u<c)return 1;if(t<e&&u>c)return-1}return r>s?1:r<s||l<h?-1:l>h?1:t.id<e.id?-1:t.id>e.id?1:0}constructor(t,e,n,i){this.id=++B,this.leftSE=t,t.segment=this,t.otherSE=e,this.rightSE=e,e.segment=this,e.otherSE=t,this.rings=n,this.windings=i}static fromRing(t,e,n){let i,r,s;const o=G.comparePoints(t,e);if(o<0)i=t,r=e,s=1;else{if(!(o>0))throw new Error(`Tried to create degenerate segment at [${t.x}, ${t.y}]`);i=e,r=t,s=-1}const a=new G(i,!0),l=new G(r,!1);return new U(a,l,[n],[s])}replaceRightSE(t){this.rightSE=t,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}bbox(){const t=this.leftSE.point.y,e=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:t<e?t:e},ur:{x:this.rightSE.point.x,y:t>e?t:e}}}vector(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}isAnEndpoint(t){return t.x===this.leftSE.point.x&&t.y===this.leftSE.point.y||t.x===this.rightSE.point.x&&t.y===this.rightSE.point.y}comparePoint(t){if(this.isAnEndpoint(t))return 0;const e=this.leftSE.point,n=this.rightSE.point,i=this.vector();if(e.x===n.x)return t.x===e.x?0:t.x<e.x?1:-1;const r=(t.y-e.y)/i.y,s=e.x+r*i.x;if(t.x===s)return 0;const o=(t.x-e.x)/i.x,a=e.y+o*i.y;return t.y===a?0:t.y<a?-1:1}getIntersection(t){const e=this.bbox(),n=t.bbox(),i=f(e,n);if(null===i)return null;const r=this.leftSE.point,s=this.rightSE.point,o=t.leftSE.point,a=t.rightSE.point,l=c(e,o)&&0===this.comparePoint(o),h=c(n,r)&&0===t.comparePoint(r),u=c(e,a)&&0===this.comparePoint(a),d=c(n,s)&&0===t.comparePoint(s);if(h&&l)return d&&!u?s:!d&&u?a:null;if(h)return u&&r.x===a.x&&r.y===a.y?null:r;if(l)return d&&s.x===o.x&&s.y===o.y?null:o;if(d&&u)return null;if(d)return s;if(u)return a;const g=((t,e,n,i)=>{if(0===e.x)return z(n,i,t.x);if(0===i.x)return z(t,e,n.x);if(0===e.y)return F(n,i,t.y);if(0===i.y)return F(t,e,n.y);const r=N(e,i);if(0==r)return null;const s={x:n.x-t.x,y:n.y-t.y},o=N(s,e)/r,a=N(s,i)/r;return{x:(t.x+a*e.x+(n.x+o*i.x))/2,y:(t.y+a*e.y+(n.y+o*i.y))/2}})(r,this.vector(),o,t.vector());return null===g?null:c(i,g)?y.round(g.x,g.y):null}split(t){const e=[],n=void 0!==t.events,i=new G(t,!0),r=new G(t,!1),s=this.rightSE;this.replaceRightSE(r),e.push(r),e.push(i);const o=new U(i,s,this.rings.slice(),this.windings.slice());return G.comparePoints(o.leftSE.point,o.rightSE.point)>0&&o.swapEvents(),G.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),n&&(i.checkForConsuming(),r.checkForConsuming()),e}swapEvents(){const t=this.rightSE;this.rightSE=this.leftSE,this.leftSE=t,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(let t=0,e=this.windings.length;t<e;t++)this.windings[t]*=-1}consume(t){let e=this,n=t;for(;e.consumedBy;)e=e.consumedBy;for(;n.consumedBy;)n=n.consumedBy;const i=U.compare(e,n);if(0!==i){if(i>0){const t=e;e=n,n=t}if(e.prev===n){const t=e;e=n,n=t}for(let t=0,i=n.rings.length;t<i;t++){const i=n.rings[t],r=n.windings[t],s=e.rings.indexOf(i);-1===s?(e.rings.push(i),e.windings.push(r)):e.windings[s]+=r}n.rings=null,n.windings=null,n.consumedBy=e,n.leftSE.consumedBy=e.leftSE,n.rightSE.consumedBy=e.rightSE}}prevInResult(){return void 0!==this._prevInResult||(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null),this._prevInResult}beforeState(){if(void 0!==this._beforeState)return this._beforeState;if(this.prev){const t=this.prev.consumedBy||this.prev;this._beforeState=t.afterState()}else this._beforeState={rings:[],windings:[],multiPolys:[]};return this._beforeState}afterState(){if(void 0!==this._afterState)return this._afterState;const t=this.beforeState();this._afterState={rings:t.rings.slice(0),windings:t.windings.slice(0),multiPolys:[]};const e=this._afterState.rings,n=this._afterState.windings,i=this._afterState.multiPolys;for(let t=0,i=this.rings.length;t<i;t++){const i=this.rings[t],r=this.windings[t],s=e.indexOf(i);-1===s?(e.push(i),n.push(r)):n[s]+=r}const r=[],s=[];for(let t=0,i=e.length;t<i;t++){if(0===n[t])continue;const i=e[t],o=i.poly;if(-1===s.indexOf(o))if(i.isExterior)r.push(o);else{-1===s.indexOf(o)&&s.push(o);const t=r.indexOf(i.poly);-1!==t&&r.splice(t,1)}}for(let t=0,e=r.length;t<e;t++){const e=r[t].multiPoly;-1===i.indexOf(e)&&i.push(e)}return this._afterState}isInResult(){if(this.consumedBy)return!1;if(void 0!==this._isInResult)return this._isInResult;const t=this.beforeState().multiPolys,e=this.afterState().multiPolys;switch(K.type){case"union":{const n=0===t.length,i=0===e.length;this._isInResult=n!==i;break}case"intersection":{let n,i;t.length<e.length?(n=t.length,i=e.length):(n=e.length,i=t.length),this._isInResult=i===K.numMultiPolys&&n<i;break}case"xor":{const n=Math.abs(t.length-e.length);this._isInResult=n%2==1;break}case"difference":{const n=t=>1===t.length&&t[0].isSubject;this._isInResult=n(t)!==n(e);break}default:throw new Error(`Unrecognized operation type found ${K.type}`)}return this._isInResult}}class q{constructor(t,e,n){if(!Array.isArray(t)||0===t.length)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=e,this.isExterior=n,this.segments=[],"number"!=typeof t[0][0]||"number"!=typeof t[0][1])throw new Error("Input geometry is not a valid Polygon or MultiPolygon");const i=y.round(t[0][0],t[0][1]);this.bbox={ll:{x:i.x,y:i.y},ur:{x:i.x,y:i.y}};let r=i;for(let e=1,n=t.length;e<n;e++){if("number"!=typeof t[e][0]||"number"!=typeof t[e][1])throw new Error("Input geometry is not a valid Polygon or MultiPolygon");let n=y.round(t[e][0],t[e][1]);n.x===r.x&&n.y===r.y||(this.segments.push(U.fromRing(r,n,this)),n.x<this.bbox.ll.x&&(this.bbox.ll.x=n.x),n.y<this.bbox.ll.y&&(this.bbox.ll.y=n.y),n.x>this.bbox.ur.x&&(this.bbox.ur.x=n.x),n.y>this.bbox.ur.y&&(this.bbox.ur.y=n.y),r=n)}i.x===r.x&&i.y===r.y||this.segments.push(U.fromRing(r,i,this))}getSweepEvents(){const t=[];for(let e=0,n=this.segments.length;e<n;e++){const n=this.segments[e];t.push(n.leftSE),t.push(n.rightSE)}return t}}class V{constructor(t,e){if(!Array.isArray(t))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new q(t[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(let e=1,n=t.length;e<n;e++){const n=new q(t[e],this,!1);n.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=n.bbox.ll.x),n.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=n.bbox.ll.y),n.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=n.bbox.ur.x),n.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=n.bbox.ur.y),this.interiorRings.push(n)}this.multiPoly=e}getSweepEvents(){const t=this.exteriorRing.getSweepEvents();for(let e=0,n=this.interiorRings.length;e<n;e++){const n=this.interiorRings[e].getSweepEvents();for(let e=0,i=n.length;e<i;e++)t.push(n[e])}return t}}class Y{constructor(t,e){if(!Array.isArray(t))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{"number"==typeof t[0][0][0]&&(t=[t])}catch(t){}this.polys=[],this.bbox={ll:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY},ur:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY}};for(let e=0,n=t.length;e<n;e++){const n=new V(t[e],this);n.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=n.bbox.ll.x),n.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=n.bbox.ll.y),n.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=n.bbox.ur.x),n.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=n.bbox.ur.y),this.polys.push(n)}this.isSubject=e}getSweepEvents(){const t=[];for(let e=0,n=this.polys.length;e<n;e++){const n=this.polys[e].getSweepEvents();for(let e=0,i=n.length;e<i;e++)t.push(n[e])}return t}}class X{static factory(t){const e=[];for(let n=0,i=t.length;n<i;n++){const i=t[n];if(!i.isInResult()||i.ringOut)continue;let r=null,s=i.leftSE,o=i.rightSE;const a=[s],l=s.point,h=[];for(;r=s,s=o,a.push(s),s.point!==l;)for(;;){const t=s.getAvailableLinkedEvents();if(0===t.length){const t=a[0].point,e=a[a.length-1].point;throw new Error(`Unable to complete output ring starting at [${t.x}, ${t.y}]. Last matching segment found ends at [${e.x}, ${e.y}].`)}if(1===t.length){o=t[0].otherSE;break}let n=null;for(let t=0,e=h.length;t<e;t++)if(h[t].point===s.point){n=t;break}if(null!==n){const t=h.splice(n)[0],i=a.splice(t.index);i.unshift(i[0].otherSE),e.push(new X(i.reverse()));continue}h.push({index:a.length,point:s.point});const i=s.getLeftmostComparator(r);o=t.sort(i)[0].otherSE;break}e.push(new X(a))}return e}constructor(t){this.events=t;for(let e=0,n=t.length;e<n;e++)t[e].segment.ringOut=this;this.poly=null}getGeom(){let t=this.events[0].point;const e=[t];for(let n=1,i=this.events.length-1;n<i;n++){const i=this.events[n].point,r=this.events[n+1].point;0!==k(i,t,r)&&(e.push(i),t=i)}if(1===e.length)return null;const n=e[0],i=e[1];0===k(n,t,i)&&e.shift(),e.push(e[0]);const r=this.isExteriorRing()?1:-1,s=this.isExteriorRing()?0:e.length-1,o=this.isExteriorRing()?e.length:-1,a=[];for(let t=s;t!=o;t+=r)a.push([e[t].x,e[t].y]);return a}isExteriorRing(){if(void 0===this._isExteriorRing){const t=this.enclosingRing();this._isExteriorRing=!t||!t.isExteriorRing()}return this._isExteriorRing}enclosingRing(){return void 0===this._enclosingRing&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}_calcEnclosingRing(){let t=this.events[0];for(let e=1,n=this.events.length;e<n;e++){const n=this.events[e];G.compare(t,n)>0&&(t=n)}let e=t.segment.prevInResult(),n=e?e.prevInResult():null;for(;;){if(!e)return null;if(!n)return e.ringOut;if(n.ringOut!==e.ringOut)return n.ringOut.enclosingRing()!==e.ringOut?e.ringOut:e.ringOut.enclosingRing();e=n.prevInResult(),n=e?e.prevInResult():null}}}class j{constructor(t){this.exteriorRing=t,t.poly=this,this.interiorRings=[]}addInterior(t){this.interiorRings.push(t),t.poly=this}getGeom(){const t=[this.exteriorRing.getGeom()];if(null===t[0])return null;for(let e=0,n=this.interiorRings.length;e<n;e++){const n=this.interiorRings[e].getGeom();null!==n&&t.push(n)}return t}}class W{constructor(t){this.rings=t,this.polys=this._composePolys(t)}getGeom(){const t=[];for(let e=0,n=this.polys.length;e<n;e++){const n=this.polys[e].getGeom();null!==n&&t.push(n)}return t}_composePolys(t){const e=[];for(let n=0,i=t.length;n<i;n++){const i=t[n];if(!i.poly)if(i.isExteriorRing())e.push(new j(i));else{const t=i.enclosingRing();t.poly||e.push(new j(t)),t.poly.addInterior(i)}}return e}}class H{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:U.compare;this.queue=t,this.tree=new a(e),this.segments=[]}process(t){const e=t.segment,n=[];if(t.consumedBy)return t.isLeft?this.queue.remove(t.otherSE):this.tree.remove(e),n;const i=t.isLeft?this.tree.add(e):this.tree.find(e);if(!i)throw new Error(`Unable to find segment #${e.id} [${e.leftSE.point.x}, ${e.leftSE.point.y}] -> [${e.rightSE.point.x}, ${e.rightSE.point.y}] in SweepLine tree.`);let r,s,o=i,a=i;for(;void 0===r;)o=this.tree.prev(o),null===o?r=null:void 0===o.key.consumedBy&&(r=o.key);for(;void 0===s;)a=this.tree.next(a),null===a?s=null:void 0===a.key.consumedBy&&(s=a.key);if(t.isLeft){let i=null;if(r){const t=r.getIntersection(e);if(null!==t&&(e.isAnEndpoint(t)||(i=t),!r.isAnEndpoint(t))){const e=this._splitSafely(r,t);for(let t=0,i=e.length;t<i;t++)n.push(e[t])}}let o=null;if(s){const t=s.getIntersection(e);if(null!==t&&(e.isAnEndpoint(t)||(o=t),!s.isAnEndpoint(t))){const e=this._splitSafely(s,t);for(let t=0,i=e.length;t<i;t++)n.push(e[t])}}if(null!==i||null!==o){let t=null;t=null===i?o:null===o||G.comparePoints(i,o)<=0?i:o,this.queue.remove(e.rightSE),n.push(e.rightSE);const r=e.split(t);for(let t=0,e=r.length;t<e;t++)n.push(r[t])}n.length>0?(this.tree.remove(e),n.push(t)):(this.segments.push(e),e.prev=r)}else{if(r&&s){const t=r.getIntersection(s);if(null!==t){if(!r.isAnEndpoint(t)){const e=this._splitSafely(r,t);for(let t=0,i=e.length;t<i;t++)n.push(e[t])}if(!s.isAnEndpoint(t)){const e=this._splitSafely(s,t);for(let t=0,i=e.length;t<i;t++)n.push(e[t])}}}this.tree.remove(e)}return n}_splitSafely(t,e){this.tree.remove(t);const n=t.rightSE;this.queue.remove(n);const i=t.split(e);return i.push(n),void 0===t.consumedBy&&this.tree.add(t),i}}const $="undefined"!=typeof process&&process.env.POLYGON_CLIPPING_MAX_QUEUE_SIZE||1e6,Z="undefined"!=typeof process&&process.env.POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS||1e6;const K=new class{run(t,e,n){K.type=t,y.reset();const i=[new Y(e,!0)];for(let t=0,e=n.length;t<e;t++)i.push(new Y(n[t],!1));if(K.numMultiPolys=i.length,"difference"===K.type){const t=i[0];let e=1;for(;e<i.length;)null!==f(i[e].bbox,t.bbox)?e++:i.splice(e,1)}if("intersection"===K.type)for(let t=0,e=i.length;t<e;t++){const e=i[t];for(let n=t+1,r=i.length;n<r;n++)if(null===f(e.bbox,i[n].bbox))return[]}const r=new a(G.compare);for(let t=0,e=i.length;t<e;t++){const e=i[t].getSweepEvents();for(let t=0,n=e.length;t<n;t++)if(r.insert(e[t]),r.size>$)throw new Error("Infinite loop when putting segment endpoints in a priority queue (queue size too big).")}const s=new H(r);let o=r.size,l=r.pop();for(;l;){const t=l.key;if(r.size===o){const e=t.segment;throw new Error(`Unable to pop() ${t.isLeft?"left":"right"} SweepEvent [${t.point.x}, ${t.point.y}] from segment #${e.id} [${e.leftSE.point.x}, ${e.leftSE.point.y}] -> [${e.rightSE.point.x}, ${e.rightSE.point.y}] from queue.`)}if(r.size>$)throw new Error("Infinite loop when passing sweep line over endpoints (queue size too big).");if(s.segments.length>Z)throw new Error("Infinite loop when passing sweep line over endpoints (too many sweep line segments).");const e=s.process(t);for(let t=0,n=e.length;t<n;t++){const n=e[t];void 0===n.consumedBy&&r.insert(n)}o=r.size,l=r.pop()}y.reset();const h=X.factory(s.segments);return new W(h).getGeom()}};return{union:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return K.run("union",t,n)},intersection:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return K.run("intersection",t,n)},xor:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return K.run("xor",t,n)},difference:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return K.run("difference",t,n)}}}()},2582:function(t){t.exports=function(){"use strict";function t(t,i,r,s,o){!function t(n,i,r,s,o){for(;s>r;){if(s-r>600){var a=s-r+1,l=i-r+1,h=Math.log(a),u=.5*Math.exp(2*h/3),c=.5*Math.sqrt(h*u*(a-u)/a)*(l-a/2<0?-1:1);t(n,i,Math.max(r,Math.floor(i-l*u/a+c)),Math.min(s,Math.floor(i+(a-l)*u/a+c)),o)}var f=n[i],d=r,g=s;for(e(n,r,i),o(n[s],f)>0&&e(n,r,s);d<g;){for(e(n,d,g),d++,g--;o(n[d],f)<0;)d++;for(;o(n[g],f)>0;)g--}0===o(n[r],f)?e(n,r,g):e(n,++g,s),g<=i&&(r=g+1),i<=g&&(s=g-1)}}(t,i,r||0,s||t.length-1,o||n)}function e(t,e,n){var i=t[e];t[e]=t[n],t[n]=i}function n(t,e){return t<e?-1:t>e?1:0}var i=function(t){void 0===t&&(t=9),this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function r(t,e,n){if(!n)return e.indexOf(t);for(var i=0;i<e.length;i++)if(n(t,e[i]))return i;return-1}function s(t,e){o(t,0,t.children.length,e,t)}function o(t,e,n,i,r){r||(r=g(null)),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(var s=e;s<n;s++){var o=t.children[s];a(r,t.leaf?i(o):o)}return r}function a(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function l(t,e){return t.minX-e.minX}function h(t,e){return t.minY-e.minY}function u(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function c(t){return t.maxX-t.minX+(t.maxY-t.minY)}function f(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function d(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function g(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function p(e,n,i,r,s){for(var o=[n,i];o.length;)if(!((i=o.pop())-(n=o.pop())<=r)){var a=n+Math.ceil((i-n)/r/2)*r;t(e,a,n,i,s),o.push(n,a,a,i)}}return i.prototype.all=function(){return this._all(this.data,[])},i.prototype.search=function(t){var e=this.data,n=[];if(!d(t,e))return n;for(var i=this.toBBox,r=[];e;){for(var s=0;s<e.children.length;s++){var o=e.children[s],a=e.leaf?i(o):o;d(t,a)&&(e.leaf?n.push(o):f(t,a)?this._all(o,n):r.push(o))}e=r.pop()}return n},i.prototype.collides=function(t){var e=this.data;if(!d(t,e))return!1;for(var n=[];e;){for(var i=0;i<e.children.length;i++){var r=e.children[i],s=e.leaf?this.toBBox(r):r;if(d(t,s)){if(e.leaf||f(t,s))return!0;n.push(r)}}e=n.pop()}return!1},i.prototype.load=function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0;e<t.length;e++)this.insert(t[e]);return this}var n=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){var i=this.data;this.data=n,n=i}this._insert(n,this.data.height-n.height-1,!0)}else this.data=n;return this},i.prototype.insert=function(t){return t&&this._insert(t,this.data.height-1),this},i.prototype.clear=function(){return this.data=g([]),this},i.prototype.remove=function(t,e){if(!t)return this;for(var n,i,s,o=this.data,a=this.toBBox(t),l=[],h=[];o||l.length;){if(o||(o=l.pop(),i=l[l.length-1],n=h.pop(),s=!0),o.leaf){var u=r(t,o.children,e);if(-1!==u)return o.children.splice(u,1),l.push(o),this._condense(l),this}s||o.leaf||!f(o,a)?i?(n++,o=i.children[n],s=!1):o=null:(l.push(o),h.push(n),n=0,i=o,o=o.children[0])}return this},i.prototype.toBBox=function(t){return t},i.prototype.compareMinX=function(t,e){return t.minX-e.minX},i.prototype.compareMinY=function(t,e){return t.minY-e.minY},i.prototype.toJSON=function(){return this.data},i.prototype.fromJSON=function(t){return this.data=t,this},i.prototype._all=function(t,e){for(var n=[];t;)t.leaf?e.push.apply(e,t.children):n.push.apply(n,t.children),t=n.pop();return e},i.prototype._build=function(t,e,n,i){var r,o=n-e+1,a=this._maxEntries;if(o<=a)return s(r=g(t.slice(e,n+1)),this.toBBox),r;i||(i=Math.ceil(Math.log(o)/Math.log(a)),a=Math.ceil(o/Math.pow(a,i-1))),(r=g([])).leaf=!1,r.height=i;var l=Math.ceil(o/a),h=l*Math.ceil(Math.sqrt(a));p(t,e,n,h,this.compareMinX);for(var u=e;u<=n;u+=h){var c=Math.min(u+h-1,n);p(t,u,c,l,this.compareMinY);for(var f=u;f<=c;f+=l){var d=Math.min(f+l-1,c);r.children.push(this._build(t,f,d,i-1))}}return s(r,this.toBBox),r},i.prototype._chooseSubtree=function(t,e,n,i){for(;i.push(e),!e.leaf&&i.length-1!==n;){for(var r=1/0,s=1/0,o=void 0,a=0;a<e.children.length;a++){var l=e.children[a],h=u(l),c=(f=t,d=l,(Math.max(d.maxX,f.maxX)-Math.min(d.minX,f.minX))*(Math.max(d.maxY,f.maxY)-Math.min(d.minY,f.minY))-h);c<s?(s=c,r=h<r?h:r,o=l):c===s&&h<r&&(r=h,o=l)}e=o||e.children[0]}var f,d;return e},i.prototype._insert=function(t,e,n){var i=n?t:this.toBBox(t),r=[],s=this._chooseSubtree(i,this.data,e,r);for(s.children.push(t),a(s,i);e>=0&&r[e].children.length>this._maxEntries;)this._split(r,e),e--;this._adjustParentBBoxes(i,r,e)},i.prototype._split=function(t,e){var n=t[e],i=n.children.length,r=this._minEntries;this._chooseSplitAxis(n,r,i);var o=this._chooseSplitIndex(n,r,i),a=g(n.children.splice(o,n.children.length-o));a.height=n.height,a.leaf=n.leaf,s(n,this.toBBox),s(a,this.toBBox),e?t[e-1].children.push(a):this._splitRoot(n,a)},i.prototype._splitRoot=function(t,e){this.data=g([t,e]),this.data.height=t.height+1,this.data.leaf=!1,s(this.data,this.toBBox)},i.prototype._chooseSplitIndex=function(t,e,n){for(var i,r,s,a,l,h,c,f=1/0,d=1/0,g=e;g<=n-e;g++){var p=o(t,0,g,this.toBBox),m=o(t,g,n,this.toBBox),y=(r=p,s=m,void 0,void 0,void 0,void 0,a=Math.max(r.minX,s.minX),l=Math.max(r.minY,s.minY),h=Math.min(r.maxX,s.maxX),c=Math.min(r.maxY,s.maxY),Math.max(0,h-a)*Math.max(0,c-l)),v=u(p)+u(m);y<f?(f=y,i=g,d=v<d?v:d):y===f&&v<d&&(d=v,i=g)}return i||n-e},i.prototype._chooseSplitAxis=function(t,e,n){var i=t.leaf?this.compareMinX:l,r=t.leaf?this.compareMinY:h;this._allDistMargin(t,e,n,i)<this._allDistMargin(t,e,n,r)&&t.children.sort(i)},i.prototype._allDistMargin=function(t,e,n,i){t.children.sort(i);for(var r=this.toBBox,s=o(t,0,e,r),l=o(t,n-e,n,r),h=c(s)+c(l),u=e;u<n-e;u++){var f=t.children[u];a(s,t.leaf?r(f):f),h+=c(s)}for(var d=n-e-1;d>=e;d--){var g=t.children[d];a(l,t.leaf?r(g):g),h+=c(l)}return h},i.prototype._adjustParentBBoxes=function(t,e,n){for(var i=n;i>=0;i--)a(e[i],t)},i.prototype._condense=function(t){for(var e=t.length-1,n=void 0;e>=0;e--)0===t[e].children.length?e>0?(n=t[e-1].children).splice(n.indexOf(t[e]),1):this.clear():s(t[e],this.toBBox)},i}()},3697:(t,e,n)=>{"use strict";var i=n(8052),r=n(4453),s=Object;t.exports=i((function(){if(null==this||this!==s(this))throw new r("RegExp.prototype.flags getter called on non-object");var t="";return this.hasIndices&&(t+="d"),this.global&&(t+="g"),this.ignoreCase&&(t+="i"),this.multiline&&(t+="m"),this.dotAll&&(t+="s"),this.unicode&&(t+="u"),this.unicodeSets&&(t+="v"),this.sticky&&(t+="y"),t}),"get flags",!0)},2847:(t,e,n)=>{"use strict";var i=n(4289),r=n(5559),s=n(3697),o=n(1721),a=n(2753),l=r(o());i(l,{getPolyfill:o,implementation:s,shim:a}),t.exports=l},1721:(t,e,n)=>{"use strict";var i=n(3697),r=n(4289).supportsDescriptors,s=Object.getOwnPropertyDescriptor;t.exports=function(){if(r&&"gim"===/a/gim.flags){var t=s(RegExp.prototype,"flags");if(t&&"function"==typeof t.get&&"boolean"==typeof RegExp.prototype.dotAll&&"boolean"==typeof RegExp.prototype.hasIndices){var e="",n={};if(Object.defineProperty(n,"hasIndices",{get:function(){e+="d"}}),Object.defineProperty(n,"sticky",{get:function(){e+="y"}}),"dy"===e)return t.get}}return i}},2753:(t,e,n)=>{"use strict";var i=n(4289).supportsDescriptors,r=n(1721),s=Object.getOwnPropertyDescriptor,o=Object.defineProperty,a=TypeError,l=Object.getPrototypeOf,h=/a/;t.exports=function(){if(!i||!l)throw new a("RegExp.prototype.flags requires a true ES5 environment that supports property descriptors");var t=r(),e=l(h),n=s(e,"flags");return n&&n.get===t||o(e,"flags",{configurable:!0,enumerable:!1,get:t}),t}},146:(t,e,n)=>{"use strict";var i=n(8005),r=n(6740),s=n(5442),o=n(7972);function a(t,e,n,i){return function(n,r,s){var o=t(t(e(r[1],s[0]),e(-s[1],r[0])),t(e(n[1],r[0]),e(-r[1],n[0]))),a=t(e(n[1],s[0]),e(-s[1],n[0])),l=i(o,a);return l[l.length-1]}}function l(t,e,n,i){return function(r,s,o,a){var l=t(t(n(t(e(o[1],a[0]),e(-a[1],o[0])),s[2]),t(n(t(e(s[1],a[0]),e(-a[1],s[0])),-o[2]),n(t(e(s[1],o[0]),e(-o[1],s[0])),a[2]))),t(n(t(e(s[1],a[0]),e(-a[1],s[0])),r[2]),t(n(t(e(r[1],a[0]),e(-a[1],r[0])),-s[2]),n(t(e(r[1],s[0]),e(-s[1],r[0])),a[2])))),h=t(t(n(t(e(o[1],a[0]),e(-a[1],o[0])),r[2]),t(n(t(e(r[1],a[0]),e(-a[1],r[0])),-o[2]),n(t(e(r[1],o[0]),e(-o[1],r[0])),a[2]))),t(n(t(e(s[1],o[0]),e(-o[1],s[0])),r[2]),t(n(t(e(r[1],o[0]),e(-o[1],r[0])),-s[2]),n(t(e(r[1],s[0]),e(-s[1],r[0])),o[2])))),u=i(l,h);return u[u.length-1]}}function h(t,e,n,i){return function(r,s,o,a,l){var h=t(t(t(n(t(n(t(e(a[1],l[0]),e(-l[1],a[0])),o[2]),t(n(t(e(o[1],l[0]),e(-l[1],o[0])),-a[2]),n(t(e(o[1],a[0]),e(-a[1],o[0])),l[2]))),s[3]),t(n(t(n(t(e(a[1],l[0]),e(-l[1],a[0])),s[2]),t(n(t(e(s[1],l[0]),e(-l[1],s[0])),-a[2]),n(t(e(s[1],a[0]),e(-a[1],s[0])),l[2]))),-o[3]),n(t(n(t(e(o[1],l[0]),e(-l[1],o[0])),s[2]),t(n(t(e(s[1],l[0]),e(-l[1],s[0])),-o[2]),n(t(e(s[1],o[0]),e(-o[1],s[0])),l[2]))),a[3]))),t(n(t(n(t(e(o[1],a[0]),e(-a[1],o[0])),s[2]),t(n(t(e(s[1],a[0]),e(-a[1],s[0])),-o[2]),n(t(e(s[1],o[0]),e(-o[1],s[0])),a[2]))),-l[3]),t(n(t(n(t(e(a[1],l[0]),e(-l[1],a[0])),s[2]),t(n(t(e(s[1],l[0]),e(-l[1],s[0])),-a[2]),n(t(e(s[1],a[0]),e(-a[1],s[0])),l[2]))),r[3]),n(t(n(t(e(a[1],l[0]),e(-l[1],a[0])),r[2]),t(n(t(e(r[1],l[0]),e(-l[1],r[0])),-a[2]),n(t(e(r[1],a[0]),e(-a[1],r[0])),l[2]))),-s[3])))),t(t(n(t(n(t(e(s[1],l[0]),e(-l[1],s[0])),r[2]),t(n(t(e(r[1],l[0]),e(-l[1],r[0])),-s[2]),n(t(e(r[1],s[0]),e(-s[1],r[0])),l[2]))),a[3]),t(n(t(n(t(e(s[1],a[0]),e(-a[1],s[0])),r[2]),t(n(t(e(r[1],a[0]),e(-a[1],r[0])),-s[2]),n(t(e(r[1],s[0]),e(-s[1],r[0])),a[2]))),-l[3]),n(t(n(t(e(o[1],a[0]),e(-a[1],o[0])),s[2]),t(n(t(e(s[1],a[0]),e(-a[1],s[0])),-o[2]),n(t(e(s[1],o[0]),e(-o[1],s[0])),a[2]))),r[3]))),t(n(t(n(t(e(o[1],a[0]),e(-a[1],o[0])),r[2]),t(n(t(e(r[1],a[0]),e(-a[1],r[0])),-o[2]),n(t(e(r[1],o[0]),e(-o[1],r[0])),a[2]))),-s[3]),t(n(t(n(t(e(s[1],a[0]),e(-a[1],s[0])),r[2]),t(n(t(e(r[1],a[0]),e(-a[1],r[0])),-s[2]),n(t(e(r[1],s[0]),e(-s[1],r[0])),a[2]))),o[3]),n(t(n(t(e(s[1],o[0]),e(-o[1],s[0])),r[2]),t(n(t(e(r[1],o[0]),e(-o[1],r[0])),-s[2]),n(t(e(r[1],s[0]),e(-s[1],r[0])),o[2]))),-a[3]))))),u=t(t(t(n(t(n(t(e(a[1],l[0]),e(-l[1],a[0])),o[2]),t(n(t(e(o[1],l[0]),e(-l[1],o[0])),-a[2]),n(t(e(o[1],a[0]),e(-a[1],o[0])),l[2]))),r[3]),n(t(n(t(e(a[1],l[0]),e(-l[1],a[0])),r[2]),t(n(t(e(r[1],l[0]),e(-l[1],r[0])),-a[2]),n(t(e(r[1],a[0]),e(-a[1],r[0])),l[2]))),-o[3])),t(n(t(n(t(e(o[1],l[0]),e(-l[1],o[0])),r[2]),t(n(t(e(r[1],l[0]),e(-l[1],r[0])),-o[2]),n(t(e(r[1],o[0]),e(-o[1],r[0])),l[2]))),a[3]),n(t(n(t(e(o[1],a[0]),e(-a[1],o[0])),r[2]),t(n(t(e(r[1],a[0]),e(-a[1],r[0])),-o[2]),n(t(e(r[1],o[0]),e(-o[1],r[0])),a[2]))),-l[3]))),t(t(n(t(n(t(e(o[1],l[0]),e(-l[1],o[0])),s[2]),t(n(t(e(s[1],l[0]),e(-l[1],s[0])),-o[2]),n(t(e(s[1],o[0]),e(-o[1],s[0])),l[2]))),r[3]),n(t(n(t(e(o[1],l[0]),e(-l[1],o[0])),r[2]),t(n(t(e(r[1],l[0]),e(-l[1],r[0])),-o[2]),n(t(e(r[1],o[0]),e(-o[1],r[0])),l[2]))),-s[3])),t(n(t(n(t(e(s[1],l[0]),e(-l[1],s[0])),r[2]),t(n(t(e(r[1],l[0]),e(-l[1],r[0])),-s[2]),n(t(e(r[1],s[0]),e(-s[1],r[0])),l[2]))),o[3]),n(t(n(t(e(s[1],o[0]),e(-o[1],s[0])),r[2]),t(n(t(e(r[1],o[0]),e(-o[1],r[0])),-s[2]),n(t(e(r[1],s[0]),e(-s[1],r[0])),o[2]))),-l[3])))),c=i(h,u);return c[c.length-1]}}function u(t){return(3===t?a:4===t?l:h)(r,i,s,o)}var c=u(3),f=u(4),d=[function(){return 0},function(){return 0},function(t,e){return e[0]-t[0]},function(t,e,n){var i,r=(t[1]-n[1])*(e[0]-n[0]),s=(t[0]-n[0])*(e[1]-n[1]),o=r-s;if(r>0){if(s<=0)return o;i=r+s}else{if(!(r<0))return o;if(s>=0)return o;i=-(r+s)}var a=33306690738754716e-32*i;return o>=a||o<=-a?o:c(t,e,n)},function(t,e,n,i){var r=t[0]-i[0],s=e[0]-i[0],o=n[0]-i[0],a=t[1]-i[1],l=e[1]-i[1],h=n[1]-i[1],u=t[2]-i[2],c=e[2]-i[2],d=n[2]-i[2],g=s*h,p=o*l,m=o*a,y=r*h,v=r*l,w=s*a,x=u*(g-p)+c*(m-y)+d*(v-w),_=7771561172376103e-31*((Math.abs(g)+Math.abs(p))*Math.abs(u)+(Math.abs(m)+Math.abs(y))*Math.abs(c)+(Math.abs(v)+Math.abs(w))*Math.abs(d));return x>_||-x>_?x:f(t,e,n,i)}];function g(t){var e=d[t.length];return e||(e=d[t.length]=u(t.length)),e.apply(void 0,t)}function p(t,e,n,i,r,s,o){return function(e,n,a,l,h){switch(arguments.length){case 0:case 1:return 0;case 2:return i(e,n);case 3:return r(e,n,a);case 4:return s(e,n,a,l);case 5:return o(e,n,a,l,h)}for(var u=new Array(arguments.length),c=0;c<arguments.length;++c)u[c]=arguments[c];return t(u)}}!function(){for(;d.length<=5;)d.push(u(d.length));t.exports=p.apply(void 0,[g].concat(d));for(var e=0;e<=5;++e)t.exports[e]=d[e]}()},4707:(t,e,n)=>{t.exports=function(t,e){for(var n=e[0],r=e[1],s=t.length,o=1,a=s,l=0,h=s-1;l<a;h=l++){var u=t[l],c=t[h],f=u[1],d=c[1];if(d<f){if(d<r&&r<f){if(0===(g=i(u,c,e)))return 0;o^=0<g|0}else if(r===f&&f<t[(l+1)%s][1]){if(0===(g=i(u,c,e)))return 0;o^=0<g|0}}else if(f<d){if(f<r&&r<d){if(0===(g=i(u,c,e)))return 0;o^=g<0|0}else if(r===f&&t[(l+1)%s][1]<f){var g;if(0===(g=i(u,c,e)))return 0;o^=g<0|0}}else if(r===f){var p=Math.min(u[0],c[0]),m=Math.max(u[0],c[0]);if(0===l){for(;h>0;){var y=(h+s-1)%s;if((x=t[y])[1]!==r)break;var v=x[0];p=Math.min(p,v),m=Math.max(m,v),h=y}if(0===h)return p<=n&&n<=m?0:1;a=h+1}for(var w=t[(h+s-1)%s][1];l+1<a;){var x;if((x=t[l+1])[1]!==r)break;v=x[0],p=Math.min(p,v),m=Math.max(m,v),l+=1}if(p<=n&&n<=m)return 0;var _=t[(l+1)%s][1];n<p&&w<r!=_<r&&(o^=1)}}return 2*o-1};var i=n(146)},5442:(t,e,n)=>{"use strict";var i=n(8005),r=n(6359);t.exports=function(t,e){var n=t.length;if(1===n){var s=i(t[0],e);return s[0]?s:[s[1]]}var o=new Array(2*n),a=[.1,.1],l=[.1,.1],h=0;i(t[0],e,a),a[0]&&(o[h++]=a[0]);for(var u=1;u<n;++u){i(t[u],e,l);var c=a[1];r(c,l[0],a),a[0]&&(o[h++]=a[0]);var f=l[1],d=a[1],g=f+d,p=d-(g-f);a[1]=g,p&&(o[h++]=p)}return a[1]&&(o[h++]=a[1]),0===h&&(o[h++]=0),o.length=h,o}},7972:t=>{"use strict";t.exports=function(t,e){var n=0|t.length,i=0|e.length;if(1===n&&1===i)return function(t,e){var n=t+e,i=n-t,r=t-(n-i)+(e-i);return r?[r,n]:[n]}(t[0],-e[0]);var r,s,o=new Array(n+i),a=0,l=0,h=0,u=Math.abs,c=t[l],f=u(c),d=-e[h],g=u(d);f<g?(s=c,(l+=1)<n&&(f=u(c=t[l]))):(s=d,(h+=1)<i&&(g=u(d=-e[h]))),l<n&&f<g||h>=i?(r=c,(l+=1)<n&&(f=u(c=t[l]))):(r=d,(h+=1)<i&&(g=u(d=-e[h])));for(var p,m,y=r+s,v=y-r,w=s-v,x=w,_=y;l<n&&h<i;)f<g?(r=c,(l+=1)<n&&(f=u(c=t[l]))):(r=d,(h+=1)<i&&(g=u(d=-e[h]))),(w=(s=x)-(v=(y=r+s)-r))&&(o[a++]=w),x=_-((p=_+y)-(m=p-_))+(y-m),_=p;for(;l<n;)(w=(s=x)-(v=(y=(r=c)+s)-r))&&(o[a++]=w),x=_-((p=_+y)-(m=p-_))+(y-m),_=p,(l+=1)<n&&(c=t[l]);for(;h<i;)(w=(s=x)-(v=(y=(r=d)+s)-r))&&(o[a++]=w),x=_-((p=_+y)-(m=p-_))+(y-m),_=p,(h+=1)<i&&(d=-e[h]);return x&&(o[a++]=x),_&&(o[a++]=_),a||(o[a++]=0),o.length=a,o}},6740:t=>{"use strict";t.exports=function(t,e){var n=0|t.length,i=0|e.length;if(1===n&&1===i)return function(t,e){var n=t+e,i=n-t,r=t-(n-i)+(e-i);return r?[r,n]:[n]}(t[0],e[0]);var r,s,o=new Array(n+i),a=0,l=0,h=0,u=Math.abs,c=t[l],f=u(c),d=e[h],g=u(d);f<g?(s=c,(l+=1)<n&&(f=u(c=t[l]))):(s=d,(h+=1)<i&&(g=u(d=e[h]))),l<n&&f<g||h>=i?(r=c,(l+=1)<n&&(f=u(c=t[l]))):(r=d,(h+=1)<i&&(g=u(d=e[h])));for(var p,m,y=r+s,v=y-r,w=s-v,x=w,_=y;l<n&&h<i;)f<g?(r=c,(l+=1)<n&&(f=u(c=t[l]))):(r=d,(h+=1)<i&&(g=u(d=e[h]))),(w=(s=x)-(v=(y=r+s)-r))&&(o[a++]=w),x=_-((p=_+y)-(m=p-_))+(y-m),_=p;for(;l<n;)(w=(s=x)-(v=(y=(r=c)+s)-r))&&(o[a++]=w),x=_-((p=_+y)-(m=p-_))+(y-m),_=p,(l+=1)<n&&(c=t[l]);for(;h<i;)(w=(s=x)-(v=(y=(r=d)+s)-r))&&(o[a++]=w),x=_-((p=_+y)-(m=p-_))+(y-m),_=p,(h+=1)<i&&(d=e[h]);return x&&(o[a++]=x),_&&(o[a++]=_),a||(o[a++]=0),o.length=a,o}},7771:(t,e,n)=>{"use strict";var i=n(210),r=n(2296),s=n(1044)(),o=n(7296),a=n(4453),l=i("%Math.floor%");t.exports=function(t,e){if("function"!=typeof t)throw new a("`fn` is not a function");if("number"!=typeof e||e<0||e>4294967295||l(e)!==e)throw new a("`length` must be a positive 32-bit integer");var n=arguments.length>2&&!!arguments[2],i=!0,h=!0;if("length"in t&&o){var u=o(t,"length");u&&!u.configurable&&(i=!1),u&&!u.writable&&(h=!1)}return(i||h||!n)&&(s?r(t,"length",e,!0,!0):r(t,"length",e)),t}},8052:(t,e,n)=>{"use strict";var i=n(2296),r=n(1044)(),s=n(5972).functionsHaveConfigurableNames(),o=n(4453);t.exports=function(t,e){if("function"!=typeof t)throw new o("`fn` is not a function");return arguments.length>2&&!!arguments[2]&&!s||(r?i(t,"name",e,!0,!0):i(t,"name",e)),t}},4572:(t,e,n)=>{"use strict";n(746),n(7102);function i(t,e){var n=t.length,i=t.length-e.length,r=Math.min;if(i)return i;switch(n){case 0:return 0;case 1:return t[0]-e[0];case 2:return(a=t[0]+t[1]-e[0]-e[1])||r(t[0],t[1])-r(e[0],e[1]);case 3:var s=t[0]+t[1],o=e[0]+e[1];if(a=s+t[2]-(o+e[2]))return a;var a,l=r(t[0],t[1]),h=r(e[0],e[1]);return(a=r(l,t[2])-r(h,e[2]))||r(l+t[2],s)-r(h+e[2],o);default:var u=t.slice(0);u.sort();var c=e.slice(0);c.sort();for(var f=0;f<n;++f)if(i=u[f]-c[f])return i;return 0}}e.H=i},6479:(t,e,n)=>{var i;!function(){"use strict";function r(t,e,n){var i=e.x,r=e.y,s=n.x-i,o=n.y-r;if(0!==s||0!==o){var a=((t.x-i)*s+(t.y-r)*o)/(s*s+o*o);a>1?(i=n.x,r=n.y):a>0&&(i+=s*a,r+=o*a)}return(s=t.x-i)*s+(o=t.y-r)*o}function s(t,e,n,i,o){for(var a,l=i,h=e+1;h<n;h++){var u=r(t[h],t[e],t[n]);u>l&&(a=h,l=u)}l>i&&(a-e>1&&s(t,e,a,i,o),o.push(t[a]),n-a>1&&s(t,a,n,i,o))}function o(t,e){var n=t.length-1,i=[t[0]];return s(t,0,n,e,i),i.push(t[n]),i}function a(t,e,n){if(t.length<=2)return t;var i=void 0!==e?e*e:1;return t=n?t:function(t,e){for(var n,i,r,s,o,a=t[0],l=[a],h=1,u=t.length;h<u;h++)r=a,void 0,void 0,(s=(i=n=t[h]).x-r.x)*s+(o=i.y-r.y)*o>e&&(l.push(n),a=n);return a!==n&&l.push(n),l}(t,i),o(t,i)}void 0===(i=function(){return a}.call(e,n,e,t))||(t.exports=i)}()},556:t=>{self,t.exports=(()=>{"use strict";var t={132:(t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.bezkrovnySsim=void 0;var i=n(490),r=n(971);function s(t,e,n){var r=t.data,s=e.data,o=n.bitDepth,a=n.k1,l=n.k2,h=Math.pow(2,o)-1,u=Math.pow(a*h,2),c=Math.pow(l*h,2),f=i.average(r),d=i.average(s),g=i.variance(r,f),p=i.variance(s,d);return(2*f*d+u)*(2*i.covariance(r,s,f,d)+c)/((Math.pow(f,2)+Math.pow(d,2)+u)*(g+p+c))}e.bezkrovnySsim=function(t,e,n){for(var i=n.windowSize,o=Math.ceil(t.width/i),a=Math.ceil(t.height/i),l=new Array(o*a),h=0,u=0;u<t.height;u+=i)for(var c=0;c<t.width;c+=i){var f=Math.min(i,t.width-c),d=Math.min(i,t.height-u),g=r.sub(t,c,d,u,f),p=r.sub(e,c,d,u,f);l[h++]=s(g,p,n)}return{data:l,width:o,height:a}}},63:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.defaults=void 0,e.defaults={windowSize:11,k1:.01,k2:.03,bitDepth:8,downsample:"original",ssim:"weber",maxSize:256,rgb2grayVersion:"integer"}},441:(t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.downsample=void 0;var i=n(490),r=n(971);function s(t,e,n){var i=r.imfilter(t,e,"symmetric","same");return r.skip2d(i,[0,n,i.height],[0,n,i.width])}e.downsample=function(t,e){return"original"===e.downsample?function(t,e,n){void 0===n&&(n=256);var o=Math.min(t.width,e.height)/n,a=Math.round(o);if(a>1){var l=r.ones(a);t=s(t,l=i.divide2d(l,i.sum2d(l)),a),e=s(e,l,a)}return[t,e]}(t[0],t[1],e.maxSize):t}},607:function(t,e,n){var i=this&&this.__assign||function(){return(i=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0}),e.ssim=e.getOptions=void 0;var r=n(971),s=n(490),o=n(773),a=n(595),l=n(132),h=n(441),u=n(63),c=n(535),f={fast:o.ssim,original:a.originalSsim,bezkrovny:l.bezkrovnySsim,weber:c.weberSsim};function d(t){var e=i(i({},u.defaults),t);return function(t){if(Object.keys(t).forEach((function(t){if(!(t in u.defaults))throw new Error('"'+t+'" is not a valid option')})),"k1"in t&&("number"!=typeof t.k1||t.k1<0))throw new Error("Invalid k1 value. Default is "+u.defaults.k1);if("k2"in t&&("number"!=typeof t.k2||t.k2<0))throw new Error("Invalid k2 value. Default is "+u.defaults.k2);if(!(t.ssim in f))throw new Error("Invalid ssim option (use: "+Object.keys(f).join(", ")+")")}(e),e}function g(t,e,n){var i,o,a,l,u=(new Date).getTime(),c=function(t){var e=t[0],n=t[1],i=t[2];return f[i.ssim](e,n,i)}(function(t){var e=t[0],n=t[1],i=t[2],r=h.downsample([e,n],i);return[r[0],r[1],i]}((i=function(t){var e=t[0],n=t[1],i=t[2];if(e.width!==n.width||e.height!==n.height)throw new Error("Image dimensions do not match");return[e,n,i]}([t,e,d(n)]),o=i[0],a=i[1],"original"===(l=i[2]).rgb2grayVersion?[r.rgb2gray(o),r.rgb2gray(a),l]:[r.rgb2grayInteger(o),r.rgb2grayInteger(a),l])));return{mssim:void 0!==c.mssim?c.mssim:s.mean2d(c),ssim_map:c,performance:(new Date).getTime()-u}}e.getOptions=d,e.ssim=g,e.default=g},490:(t,e)=>{function n(t){return i(t)/t.length}function i(t){for(var e=0,n=0;n<t.length;n++)e+=t[n];return e}function r(t){for(var e=t.data,n=0,i=0;i<e.length;i++)n+=e[i];return n}function s(t,e){for(var n=t.data,i=t.width,r=t.height,s=new Array(n.length),o=0;o<n.length;o++)s[o]=n[o]+e;return{data:s,width:i,height:r}}function o(t,e){return"number"==typeof e?function(t,e){for(var n=t.data,i=t.width,r=t.height,s=new Array(n.length),o=0;o<n.length;o++)s[o]=n[o]*e;return{data:s,width:i,height:r}}(t,e):function(t,e){for(var n=t.data,i=t.width,r=t.height,s=e.data,o=new Array(n.length),a=0;a<n.length;a++)o[a]=n[a]*s[a];return{data:o,width:i,height:r}}(t,e)}Object.defineProperty(e,"__esModule",{value:!0}),e.covariance=e.variance=e.mean2d=e.square2d=e.multiply2d=e.divide2d=e.subtract2d=e.add2d=e.sum2d=e.floor=e.sum=e.average=void 0,e.average=n,e.sum=i,e.floor=function(t){for(var e=new Array(t.length),n=0;n<t.length;n++)e[n]=Math.floor(t[n]);return e},e.sum2d=r,e.add2d=function(t,e){return"number"==typeof e?s(t,e):function(t,e){for(var n=t.data,i=t.width,r=t.height,s=e.data,o=new Array(n.length),a=0;a<r;a++)for(var l=a*i,h=0;h<i;h++)o[l+h]=n[l+h]+s[l+h];return{data:o,width:i,height:r}}(t,e)},e.subtract2d=function(t,e){return"number"==typeof e?s(t,-e):function(t,e){for(var n=t.data,i=t.width,r=t.height,s=e.data,o=new Array(n.length),a=0;a<r;a++)for(var l=a*i,h=0;h<i;h++)o[l+h]=n[l+h]-s[l+h];return{data:o,width:i,height:r}}(t,e)},e.divide2d=function(t,e){return"number"==typeof e?function(t,e){for(var n=t.data,i=t.width,r=t.height,s=new Array(n.length),o=0;o<n.length;o++)s[o]=n[o]/e;return{data:s,width:i,height:r}}(t,e):function(t,e){for(var n=t.data,i=t.width,r=t.height,s=e.data,o=new Array(n.length),a=0;a<n.length;a++)o[a]=n[a]/s[a];return{data:o,width:i,height:r}}(t,e)},e.multiply2d=o,e.square2d=function(t){return o(t,t)},e.mean2d=function(t){return r(t)/t.data.length},e.variance=function(t,e){void 0===e&&(e=n(t));for(var i=0,r=t.length;r--;)i+=Math.pow(t[r]-e,2);return i/t.length},e.covariance=function(t,e,i,r){void 0===i&&(i=n(t)),void 0===r&&(r=n(e));for(var s=0,o=t.length;o--;)s+=(t[o]-i)*(e[o]-r);return s/t.length}},687:(t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.conv2=void 0;var i=n(490),r=n(298),s=n(118),o=n(799);function a(t,e,n){var i=t.data,r=t.width,s=t.height;void 0===n&&(n="full");for(var a=r+e.width-1,l=s+e.height-1,h=o.zeros(l,a).data,c=0;c<e.height;c++)for(var f=0;f<e.width;f++){var d=e.data[c*e.width+f];if(d)for(var g=0;g<s;g++)for(var p=0;p<r;p++)h[(g+c)*a+p+f]+=i[g*r+p]*d}return u({data:h,width:a,height:l},n,s,e.height,r,e.width)}function l(t,e,n){var s=e.data,o=e.width,a=e.height;void 0===n&&(n="full");var l=h(t,r.ones(a,1),r.ones(1,o),n);return i.multiply2d(l,s[0])}function h(t,e,n,i){void 0===i&&(i="full");var r=Math.max(e.height,e.width),s=Math.max(n.height,n.width),o=a(t,e,"full");return u(a(o,n,"full"),i,t.height,r,t.width,s)}function u(t,e,n,i,r,o){if("full"===e)return t;if("same"===e){var a=Math.ceil((t.height-n)/2),l=Math.ceil((t.width-r)/2);return s.sub(t,a,n,l,r)}return s.sub(t,i-1,n-i+1,o-1,r-o+1)}e.conv2=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return t[2]&&t[2].data?h.apply(void 0,t):function(t){for(var e=t.data,n=e[0],i=1;i<e.length;i++)if(e[i]!==n)return!1;return!0}(t[1])?l.apply(void 0,t):a.apply(void 0,t)}},346:(t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.filter2=void 0;var i=n(687);e.filter2=function(t,e,n){return void 0===n&&(n="same"),i.conv2(e,function(t){for(var e=t.data,n=t.width,i=t.height,r=new Array(e.length),s=0;s<i;s++)for(var o=0;o<n;o++)r[s*n+o]=e[(i-1-s)*n+n-1-o];return{data:r,width:n,height:i}}(t),n)}},470:(t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.fspecial=void 0;var i=n(490);e.fspecial=function(t,e,n){void 0===e&&(e=3),void 0===n&&(n=1.5);var r=function(t,e){for(var n=t.data,i=t.width,r=t.height,s=new Array(n.length),o=0;o<n.length;o++)s[o]=Math.exp(-n[o]/(2*Math.pow(e,2)));return{data:s,width:i,height:r}}(function(t){for(var e=2*t+1,n=new Array(Math.pow(e,2)),i=0;i<e;i++)for(var r=0;r<e;r++)n[i*e+r]=Math.pow(i-t,2)+Math.pow(r-t,2);return{data:n,width:e,height:e}}(e=(e-1)/2),n),s=i.sum2d(r);return i.divide2d(r,s)}},521:(t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.imfilter=void 0;var i=n(20),r=n(389),s=n(490),o=n(346);e.imfilter=function(t,e,n,a){return void 0===n&&(n="symmetric"),void 0===a&&(a="same"),t=function(t,e,n,o){if(t=r.padarray(t,s.floor([e/2,n/2]),o),0===i.mod(e,2)&&(t.data=t.data.slice(0,-t.width),t.height--),0===i.mod(n,2)){for(var a=[],l=0;l<t.data.length;l++)(l+1)%t.width!=0&&a.push(t.data[l]);t.data=a,t.width--}return t}(t,e.width,e.height,n),a=function(t){return"same"===t&&(t="valid"),t}(a),o.filter2(e,t,a)}},971:function(t,e,n){var i=this&&this.__createBinding||(Object.create?function(t,e,n,i){void 0===i&&(i=n),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,i){void 0===i&&(i=n),t[i]=e[n]}),r=this&&this.__exportStar||function(t,e){for(var n in t)"default"===n||Object.prototype.hasOwnProperty.call(e,n)||i(e,t,n)};Object.defineProperty(e,"__esModule",{value:!0}),r(n(687),e),r(n(346),e),r(n(470),e),r(n(521),e),r(n(150),e),r(n(298),e),r(n(389),e),r(n(582),e),r(n(439),e),r(n(118),e),r(n(240),e),r(n(799),e)},928:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.numbers=void 0,e.numbers=function(t,e,n){for(var i=e*t,r=new Array(i),s=0;s<i;s++)r[s]=n;return{data:r,width:e,height:t}}},20:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.mod=void 0,e.mod=function(t,e){return t-e*Math.floor(t/e)}},150:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.normpdf=void 0,e.normpdf=function(t,e,n){var i=t.data,r=t.width,s=t.height;void 0===e&&(e=0),void 0===n&&(n=1);for(var o=new Array(i.length),a=0;a<i.length;a++){var l=(i[a]-e)/n;o[a]=Math.exp(-Math.pow(l,2)/2)/(2.5066282746310007*n)}return{data:o,width:r,height:s}}},298:(t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ones=void 0;var i=n(928);e.ones=function(t,e){return void 0===e&&(e=t),i.numbers(t,e,1)}},389:(t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.padarray=void 0;var i=n(20);e.padarray=function(t,e,n,r){var s=e[0],o=e[1];return t.height>=s&&t.width>=o?function(t,e){for(var n=e[0],i=e[1],r=t.width+2*i,s=t.height+2*n,o=new Array(r*s),a=-n;a<0;a++){for(var l=-i;l<0;l++)o[(a+n)*r+l+i]=t.data[(Math.abs(a)-1)*t.width+Math.abs(l)-1];for(l=0;l<t.width;l++)o[(a+n)*r+l+i]=t.data[(Math.abs(a)-1)*t.width+l];for(l=t.width;l<t.width+i;l++)o[(a+n)*r+l+i]=t.data[(Math.abs(a)-1)*t.width+2*t.width-l-1]}for(a=0;a<t.height;a++){for(l=-i;l<0;l++)o[(a+n)*r+l+i]=t.data[a*t.width+Math.abs(l)-1];for(l=0;l<t.width;l++)o[(a+n)*r+l+i]=t.data[a*t.width+l];for(l=t.width;l<t.width+i;l++)o[(a+n)*r+l+i]=t.data[a*t.width+2*t.width-l-1]}for(a=t.height;a<t.height+n;a++){for(l=-i;l<0;l++)o[(a+n)*r+l+i]=t.data[(2*t.height-a-1)*t.width+Math.abs(l)-1];for(l=0;l<t.width;l++)o[(a+n)*r+l+i]=t.data[(2*t.height-a-1)*t.width+l];for(l=t.width;l<t.width+i;l++)o[(a+n)*r+l+i]=t.data[(2*t.height-a-1)*t.width+2*t.width-l-1]}return{data:o,width:r,height:s}}(t,[s,o]):function(t,e){for(var n=function(t,e){return{data:t.data.concat(e.data),height:t.height+e.height,width:t.width}}(t,function(t){for(var e=t.data,n=t.width,i=t.height,r=new Array(e.length),s=0;s<i;s++)for(var o=0;o<n;o++)r[s*n+o]=e[(i-1-s)*n+o];return{data:r,width:n,height:i}}(t)),r=t.height+2*e,s=new Array(t.width*r),o=-e;o<t.height+e;o++)for(var a=0;a<t.width;a++)s[(o+e)*t.width+a]=n.data[i.mod(o,n.height)*t.width+a];return{data:s,width:t.width,height:r}}(function(t,e){for(var n=t.width+2*e,r=new Array(n*t.height),s=function(t,e){for(var n=t.width+e.width,i=new Array(t.height*n),r=0;r<t.height;r++){for(var s=0;s<t.width;s++)i[r*n+s]=t.data[r*t.width+s];for(s=0;s<e.width;s++)i[r*n+s+t.width]=e.data[r*e.width+s]}return{data:i,width:n,height:t.height}}(t,function(t){for(var e=t.data,n=t.width,i=t.height,r=new Array(e.length),s=0;s<i;s++)for(var o=0;o<n;o++)r[s*n+o]=e[s*n+n-1-o];return{data:r,width:n,height:i}}(t)),o=0;o<t.height;o++)for(var a=-e;a<t.width+e;a++)r[o*n+a+e]=s.data[o*s.width+i.mod(a,s.width)];return{data:r,width:n,height:t.height}}(t,o),s)}},582:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.rgb2grayInteger=e.rgb2gray=void 0,e.rgb2gray=function(t){for(var e=t.data,n=t.width,i=t.height,r=new Uint8Array(n*i),s=0;s<e.length;s+=4)r[s/4]=.29894*e[s]+.58704*e[s+1]+.11402*e[s+2]+.5;return{data:Array.from(r),width:n,height:i}},e.rgb2grayInteger=function(t){for(var e=t.data,n=t.width,i=t.height,r=new Array(n*i),s=0;s<e.length;s+=4)r[s/4]=77*e[s]+150*e[s+1]+29*e[s+2]+128>>8;return{data:r,width:n,height:i}}},439:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.skip2d=void 0,e.skip2d=function(t,e,n){for(var i=e[0],r=e[1],s=e[2],o=n[0],a=n[1],l=n[2],h=Math.ceil((l-o)/a),u=Math.ceil((s-i)/r),c=new Array(h*u),f=0;f<u;f++)for(var d=0;d<h;d++){var g=i+f*r,p=o+d*a;c[f*h+d]=t.data[g*t.width+p]}return{data:c,width:h,height:u}}},118:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.sub=void 0,e.sub=function(t,e,n,i,r){for(var s=t.data,o=t.width,a=new Array(r*n),l=0;l<n;l++)for(var h=0;h<r;h++)a[l*r+h]=s[(i+l)*o+e+h];return{data:a,width:r,height:n}}},240:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.transpose=void 0,e.transpose=function(t){for(var e=t.data,n=t.width,i=t.height,r=new Array(n*i),s=0;s<i;s++)for(var o=0;o<n;o++)r[o*i+s]=e[s*n+o];return{data:r,height:n,width:i}}},799:(t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.zeros=void 0;var i=n(928);e.zeros=function(t,e){return void 0===e&&(e=t),i.numbers(t,e,0)}},595:(t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.originalSsim=void 0;var i=n(490),r=n(971);e.originalSsim=function(t,e,n){var s=r.fspecial("gaussian",n.windowSize,1.5),o=Math.pow(2,n.bitDepth)-1,a=Math.pow(n.k1*o,2),l=Math.pow(n.k2*o,2);s=i.divide2d(s,i.sum2d(s));var h=r.filter2(s,t,"valid"),u=r.filter2(s,e,"valid"),c=i.square2d(h),f=i.square2d(u),d=i.multiply2d(h,u),g=i.square2d(t),p=i.square2d(e),m=i.subtract2d(r.filter2(s,g,"valid"),c),y=i.subtract2d(r.filter2(s,p,"valid"),f),v=i.subtract2d(r.filter2(s,i.multiply2d(t,e),"valid"),d);if(a>0&&l>0){var w=i.add2d(i.multiply2d(d,2),a),x=i.add2d(i.multiply2d(v,2),l),_=i.add2d(i.add2d(c,f),a),b=i.add2d(i.add2d(m,y),l);return i.divide2d(i.multiply2d(w,x),i.multiply2d(_,b))}var E=i.multiply2d(d,2),S=i.multiply2d(v,2),I=i.add2d(c,f),C=i.add2d(m,y);return i.divide2d(i.multiply2d(E,S),i.multiply2d(I,C))}},773:(t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ssim=void 0;var i=n(490),r=n(971);e.ssim=function(t,e,n){var s=r.normpdf(function(t){for(var e=Math.floor(t/2),n=new Array(2*e+1),i=-e;i<=e;i++)n[i+e]=Math.abs(i);return{data:n,width:n.length,height:1}}(n.windowSize),0,1.5),o=Math.pow(2,n.bitDepth)-1,a=Math.pow(n.k1*o,2),l=Math.pow(n.k2*o,2);s=i.divide2d(s,i.sum2d(s));var h=r.transpose(s),u=r.conv2(t,s,h,"valid"),c=r.conv2(e,s,h,"valid"),f=i.square2d(u),d=i.square2d(c),g=i.multiply2d(u,c),p=i.square2d(t),m=i.square2d(e),y=i.subtract2d(r.conv2(p,s,h,"valid"),f),v=i.subtract2d(r.conv2(m,s,h,"valid"),d),w=i.subtract2d(r.conv2(i.multiply2d(t,e),s,h,"valid"),g);return a>0&&l>0?function(t,e,n,r,s,o,a,l){var h=i.add2d(i.multiply2d(t,2),a),u=i.add2d(i.multiply2d(e,2),l),c=i.add2d(i.add2d(n,r),a),f=i.add2d(i.add2d(s,o),l);return i.divide2d(i.multiply2d(h,u),i.multiply2d(c,f))}(g,w,f,d,y,v,a,l):function(t,e,n,r,s,o){var a=i.multiply2d(t,2),l=i.multiply2d(e,2),h=i.add2d(n,r),u=i.add2d(s,o);return i.divide2d(i.multiply2d(a,l),i.multiply2d(h,u))}(g,w,f,d,y,v)}},535:function(t,e){var n=this&&this.__assign||function(){return(n=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)};function i(t,e,n,i){return{rightEdge:n[e*i+t+1],bottomEdge:n[(e+1)*i+t],bottomRightEdge:n[(e+1)*i+t+1]}}function r(t,e){for(var n=t.width,r=t.height,s=t.data,o=n+1,a=r+1,l=new Int32Array(o*a),h=r-1;h>=0;--h)for(var u=n-1;u>=0;--u){var c=i(u,h,l,o),f=c.rightEdge,d=c.bottomEdge,g=c.bottomRightEdge;l[h*o+u]=e(s[h*n+u],u,h)+f+d-g}return{data:l,height:a,width:o}}function s(t,e,n){for(var r=t.width,s=t.height,o=t.data,a=e.data,l=r+1,h=s+1,u=new Int32Array(l*h),c=s-1;c>=0;--c)for(var f=r-1;f>=0;--f){var d=i(f,c,u,l),g=d.rightEdge,p=d.bottomEdge,m=d.bottomRightEdge,y=c*r+f;u[c*l+f]=n(o[y],a[y],f,c)+g+p-m}return{data:u,height:h,width:l}}function o(t,e,n){for(var i=t.width,r=t.height,s=t.data,o=i-1,a=r-1,l=o-e+1,h=a-e+1,u=new Int32Array(l*h),c=0;c<a;++c)for(var f=0;f<o;++f)if(f<l&&c<h){var d=s[i*c+f]-s[i*c+f+e]-s[i*(c+e)+f]+s[i*(c+e)+f+e];u[c*l+f]=d/n}return{height:h,width:l,data:u}}function a(t,e){return o(r(t,(function(t){return t})),e,1)}function l(t,e,n){for(var i=n*n,s=o(r(t,(function(t){return t*t})),n,1),a=0;a<e.data.length;++a){var l=e.data[a]/i,h=s.data[a]/i,u=l*l;s.data[a]=1024*(h-u)}return s}function h(t,e,n,i,r){for(var a=r*r,l=o(s(t,e,(function(t,e){return t*e})),r,1),h=0;h<n.data.length;++h)l.data[h]=1024*(l.data[h]/a-n.data[h]/a*(i.data[h]/a));return l}Object.defineProperty(e,"__esModule",{value:!0}),e.weberSsim=e.windowCovariance=e.windowVariance=e.windowSums=e.windowMatrix=e.partialSumMatrix2=e.partialSumMatrix1=void 0,e.partialSumMatrix1=r,e.partialSumMatrix2=s,e.windowMatrix=o,e.windowSums=a,e.windowVariance=l,e.windowCovariance=h,e.weberSsim=function(t,e,i){for(var r=i.bitDepth,s=i.k1,o=i.k2,u=i.windowSize,c=Math.pow(2,r)-1,f=s*c*(s*c),d=o*c*(o*c),g=u*u,p=n(n({},t),{data:Int32Array.from(t.data,(function(t){return t+.5}))}),m=n(n({},e),{data:Int32Array.from(e.data,(function(t){return t+.5}))}),y=a(p,u),v=l(p,y,u),w=a(m,u),x=l(m,w,u),_=h(p,m,y,w,u),b=y.data.length,E=0,S=new Array(b),I=0;I<b;++I){var C=y.data[I]/g,M=w.data[I]/g,R=v.data[I]/1024,P=x.data[I]/1024,T=(2*C*M+f)*(_.data[I]/1024*2+d)/(C*C+M*M+f)/(R+P+d);S[I]=T,0==I?E=T:E+=(T-E)/(I+1)}return{data:S,width:y.width,height:y.height,mssim:E}}}},e={};return function n(i){if(e[i])return e[i].exports;var r=e[i]={exports:{}};return t[i].call(r.exports,r,r.exports,n),r.exports}(607)})()},3379:t=>{"use strict";var e=[];function n(t){for(var n=-1,i=0;i<e.length;i++)if(e[i].identifier===t){n=i;break}return n}function i(t,i){for(var s={},o=[],a=0;a<t.length;a++){var l=t[a],h=i.base?l[0]+i.base:l[0],u=s[h]||0,c="".concat(h," ").concat(u);s[h]=u+1;var f=n(c),d={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==f)e[f].references++,e[f].updater(d);else{var g=r(d,i);i.byIndex=a,e.splice(a,0,{identifier:c,updater:g,references:1})}o.push(c)}return o}function r(t,e){var n=e.domAPI(e);return n.update(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap&&e.supports===t.supports&&e.layer===t.layer)return;n.update(t=e)}else n.remove()}}t.exports=function(t,r){var s=i(t=t||[],r=r||{});return function(t){t=t||[];for(var o=0;o<s.length;o++){var a=n(s[o]);e[a].references--}for(var l=i(t,r),h=0;h<s.length;h++){var u=n(s[h]);0===e[u].references&&(e[u].updater(),e.splice(u,1))}s=l}}},569:t=>{"use strict";var e={};t.exports=function(t,n){var i=function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}e[t]=n}return e[t]}(t);if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");i.appendChild(n)}},9216:t=>{"use strict";t.exports=function(t){var e=document.createElement("style");return t.setAttributes(e,t.attributes),t.insert(e,t.options),e}},3565:(t,e,n)=>{"use strict";t.exports=function(t){var e=n.nc;e&&t.setAttribute("nonce",e)}},7795:t=>{"use strict";t.exports=function(t){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var e=t.insertStyleElement(t);return{update:function(n){!function(t,e,n){var i="";n.supports&&(i+="@supports (".concat(n.supports,") {")),n.media&&(i+="@media ".concat(n.media," {"));var r=void 0!==n.layer;r&&(i+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),i+=n.css,r&&(i+="}"),n.media&&(i+="}"),n.supports&&(i+="}");var s=n.sourceMap;s&&"undefined"!=typeof btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(s))))," */")),e.styleTagTransform(i,t,e.options)}(e,t,n)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)}}}},4589:t=>{"use strict";t.exports=function(t,e){if(e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}},5324:(t,e,n)=>{var i=n(720),r=n(3465).point,s=n(2352),o=n(7195);t.exports=function(t,e,n){var a;if("Feature"===t.type)a=t.geometry.coordinates;else{if("LineString"!==t.type)throw new Error("input must be a LineString Feature or Geometry");a=t.coordinates}for(var l=0,h=0;h<a.length&&!(e>=l&&h===a.length-1);h++){if(l>=e){var u=e-l;if(u){var c=s(a[h],a[h-1])-180;return o(a[h],u,c,n)}return r(a[h])}l+=i(a[h],a[h+1],n)}return r(a[a.length-1])}},3464:(t,e,n)=>{var i=n(5575).Q;t.exports=function(t){if("FeatureCollection"===t.type){for(var e=0,n=0;e<t.features.length;e++)t.features[e].geometry&&(n+=i(t.features[e].geometry));return n}return"Feature"===t.type?i(t.geometry):i(t)}},3035:(t,e,n)=>{var i=n(3465).polygon;t.exports=function(t){var e=[t[0],t[1]],n=[t[0],t[3]],r=[t[2],t[3]],s=[t[2],t[1]];return i([[e,s,r,n,e]])}},6406:(t,e,n)=>{var i=n(1594).coordEach;t.exports=function(t){var e=[1/0,1/0,-1/0,-1/0];return i(t,(function(t){e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]<t[0]&&(e[2]=t[0]),e[3]<t[1]&&(e[3]=t[1])})),e}},2352:(t,e,n)=>{var i=n(4768).getCoord;t.exports=function(t,e){var n=Math.PI/180,r=180/Math.PI,s=i(t),o=i(e),a=n*s[0],l=n*o[0],h=n*s[1],u=n*o[1],c=Math.sin(l-a)*Math.cos(u),f=Math.cos(h)*Math.sin(u)-Math.sin(h)*Math.cos(u)*Math.cos(l-a);return r*Math.atan2(c,f)}},5853:(t,e,n)=>{var i=n(3465).lineString,r=n(8949);t.exports=function(t,e,n){var s=i([]);s.properties=t.properties;for(var o=new r({points:t.geometry.coordinates.map((function(t){return{x:t[0],y:t[1]}})),duration:e,sharpness:n}),a=0;a<o.duration;a+=10){var l=o.pos(a);Math.floor(a/100)%2==0&&s.geometry.coordinates.push([l.x,l.y])}return s}},8949:t=>{var e=function(t){this.points=t.points||[],this.duration=t.duration||1e4,this.sharpness=t.sharpness||.85,this.centers=[],this.controls=[],this.stepLength=t.stepLength||60,this.length=this.points.length,this.delay=0;for(var e=0;e<this.length;e++)this.points[e].z=this.points[e].z||0;for(e=0;e<this.length-1;e++){var n=this.points[e],i=this.points[e+1];this.centers.push({x:(n.x+i.x)/2,y:(n.y+i.y)/2,z:(n.z+i.z)/2})}for(this.controls.push([this.points[0],this.points[0]]),e=0;e<this.centers.length-1;e++){n=this.centers[e],i=this.centers[e+1];var r=this.points[e+1].x-(this.centers[e].x+this.centers[e+1].x)/2,s=this.points[e+1].y-(this.centers[e].y+this.centers[e+1].y)/2,o=this.points[e+1].z-(this.centers[e].y+this.centers[e+1].z)/2;this.controls.push([{x:(1-this.sharpness)*this.points[e+1].x+this.sharpness*(this.centers[e].x+r),y:(1-this.sharpness)*this.points[e+1].y+this.sharpness*(this.centers[e].y+s),z:(1-this.sharpness)*this.points[e+1].z+this.sharpness*(this.centers[e].z+o)},{x:(1-this.sharpness)*this.points[e+1].x+this.sharpness*(this.centers[e+1].x+r),y:(1-this.sharpness)*this.points[e+1].y+this.sharpness*(this.centers[e+1].y+s),z:(1-this.sharpness)*this.points[e+1].z+this.sharpness*(this.centers[e+1].z+o)}])}return this.controls.push([this.points[this.length-1],this.points[this.length-1]]),this.steps=this.cacheSteps(this.stepLength),this};e.prototype.cacheSteps=function(t){var e=[],n=this.pos(0);e.push(0);for(var i=0;i<this.duration;i+=10){var r=this.pos(i);Math.sqrt((r.x-n.x)*(r.x-n.x)+(r.y-n.y)*(r.y-n.y)+(r.z-n.z)*(r.z-n.z))>t&&(e.push(i),n=r)}return e},e.prototype.vector=function(t){var e=this.pos(t+10),n=this.pos(t-10);return{angle:180*Math.atan2(e.y-n.y,e.x-n.x)/3.14,speed:Math.sqrt((n.x-e.x)*(n.x-e.x)+(n.y-e.y)*(n.y-e.y)+(n.z-e.z)*(n.z-e.z))}},e.prototype.pos=function(t){var e=t-this.delay;e<0&&(e=0),e>this.duration&&(e=this.duration-1);var n=e/this.duration;if(n>=1)return this.points[this.length-1];var i=Math.floor((this.points.length-1)*n);return function(t,e,n,i,r){var s=function(t){var e=t*t;return[e*t,3*e*(1-t),3*t*(1-t)*(1-t),(1-t)*(1-t)*(1-t)]}(t);return{x:r.x*s[0]+i.x*s[1]+n.x*s[2]+e.x*s[3],y:r.y*s[0]+i.y*s[1]+n.y*s[2]+e.y*s[3],z:r.z*s[0]+i.z*s[1]+n.z*s[2]+e.z*s[3]}}((this.length-1)*n-i,this.points[i],this.controls[i][1],this.controls[i+1][0],this.points[i+1])},t.exports=e},5745:(t,e,n)=>{var i=n(3465),r=i.featureCollection,s=n(8098),o=n(4625);t.exports=function(t,e,n){var a=i.distanceToDegrees(e,n),l=o(t),h=o(r(l.features.map((function(t){return function(t,e){var n=(new s.io.GeoJSONReader).read(t.geometry).buffer(e);return{type:"Feature",geometry:n=(new s.io.GeoJSONWriter).write(n),properties:{}}}(t,a)}))));return h.features.length>1?h:1===h.features.length?h.features[0]:void 0}},7:(t,e,n)=>{var i=n(6406),r=n(3465).point;t.exports=function(t){var e=i(t),n=(e[0]+e[2])/2,s=(e[1]+e[3])/2;return r([n,s])}},3532:(t,e,n)=>{var i=n(1594).coordEach,r=n(3465).point;t.exports=function(t){var e=0,n=0,s=0;return i(t,(function(t){e+=t[0],n+=t[1],s++}),!0),r([e/s,n/s])}},3916:(t,e,n)=>{var i=n(8576);t.exports=function(t,e,n,r){return t.features.forEach((function(t){var s=e.features.filter((function(e){return i(e,t)})).map((function(t){return t.properties[n]}));t.properties||(t.properties={}),t.properties[r]=s})),t}},4764:(t,e,n)=>{var i=n(1594);t.exports=function(t){var e={MultiPoint:{coordinates:[],properties:[]},MultiLineString:{coordinates:[],properties:[]},MultiPolygon:{coordinates:[],properties:[]}},n=Object.keys(e).reduce((function(t,e){return t[e.replace("Multi","")]=e,t}),{});function r(t,n,i){i?e[n].coordinates=e[n].coordinates.concat(t.geometry.coordinates):e[n].coordinates.push(t.geometry.coordinates),e[n].properties.push(t.properties)}return i.featureEach(t,(function(t){t.geometry&&(e[t.geometry.type]?r(t,t.geometry.type,!0):n[t.geometry.type]&&r(t,n[t.geometry.type],!1))})),{type:"FeatureCollection",features:Object.keys(e).filter((function(t){return e[t].coordinates.length})).sort().map((function(t){return{type:"Feature",properties:{collectedProperties:e[t].properties},geometry:{type:t,coordinates:e[t].coordinates}}}))}}},1580:(t,e,n)=>{var i=n(9016),r=n(9412),s=n(720);t.exports=function(t,e,n){if("number"!=typeof e)throw new Error("maxEdge parameter is required");if("string"!=typeof n)throw new Error("units parameter is required");var o=i(t),a=o.features.filter((function(t){var i=t.geometry.coordinates[0][0],r=t.geometry.coordinates[0][1],o=t.geometry.coordinates[0][2],a=s(i,r,n),l=s(r,o,n),h=s(i,o,n);return a<=e&&l<=e&&h<=e}));return o.features=a,function(t){for(var e=JSON.parse(JSON.stringify(t.features[0])),n=t.features,i=0,s=n.length;i<s;i++){var o=n[i];o.geometry&&(e=r(e,o))}return e}(o)}},6109:(t,e,n)=>{var i=n(1594).coordEach,r=n(9894),s=n(3465).polygon;t.exports=function(t){var e=[];i(t,(function(t){e.push(t)}));var n=r(e);if(n.length>0){for(var o=[],a=0;a<n.length;a++)o.push(e[n[a][0]]);return o.push(e[n[n.length-1][1]]),s([o])}}},7195:(t,e,n)=>{var i=n(4768).getCoord,r=n(3465),s=r.point,o=r.distanceToRadians;t.exports=function(t,e,n,r){var a=Math.PI/180,l=180/Math.PI,h=i(t),u=a*h[0],c=a*h[1],f=a*n,d=o(e,r),g=Math.asin(Math.sin(c)*Math.cos(d)+Math.cos(c)*Math.sin(d)*Math.cos(f)),p=u+Math.atan2(Math.sin(f)*Math.sin(d)*Math.cos(c),Math.cos(d)-Math.sin(c)*Math.sin(g));return s([l*p,l*g])}},6052:(t,e,n)=>{var i=n(8098);t.exports=function(t,e){var n=JSON.parse(JSON.stringify(t)),r=JSON.parse(JSON.stringify(e));"Feature"!==n.type&&(n={type:"Feature",properties:{},geometry:n}),"Feature"!==r.type&&(r={type:"Feature",properties:{},geometry:r});var s=new i.io.GeoJSONReader,o=s.read(JSON.stringify(n.geometry)),a=s.read(JSON.stringify(r.geometry)),l=o.difference(a);if(!l.isEmpty()){var h=(new i.io.GeoJSONWriter).write(l);return n.geometry=l,{type:"Feature",properties:n.properties,geometry:h}}}},720:(t,e,n)=>{var i=n(4768).getCoord,r=n(3465).radiansToDistance;t.exports=function(t,e,n){var s=Math.PI/180,o=i(t),a=i(e),l=s*(a[1]-o[1]),h=s*(a[0]-o[0]),u=s*o[1],c=s*a[1],f=Math.pow(Math.sin(l/2),2)+Math.pow(Math.sin(h/2),2)*Math.cos(u)*Math.cos(c);return r(2*Math.atan2(Math.sqrt(f),Math.sqrt(1-f)),n)}},6322:(t,e,n)=>{var i=n(6406),r=n(3035);t.exports=function(t){return r(i(t))}},2543:(t,e,n)=>{var i=n(3465).featureCollection,r=n(1594).coordEach,s=n(3465).point;t.exports=function(t){var e=[];return r(t,(function(t){e.push(s(t))})),i(e)}},8980:(t,e,n)=>{var i=n(1594).coordEach;t.exports=function(t){return t=JSON.parse(JSON.stringify(t)),i(t,(function(t){t.reverse()})),t}},6562:(t,e,n)=>{var i=n(3384);t.exports=function(t,e){for(var n=t[0],r=t[1],s=t[2],o=(t[3],(s-n)/e),a={type:"FeatureCollection",features:[]},l=0;l<=e;l++)for(var h=0;h<=e;h++)a.features.push(i([l*o+n,h*o+r]));return a}},3465:t=>{function e(t,e){return{type:"Feature",properties:e||{},geometry:t}}t.exports.feature=e,t.exports.point=function(t,n){if(!Array.isArray(t))throw new Error("Coordinates must be an array");if(t.length<2)throw new Error("Coordinates must be at least 2 numbers long");return e({type:"Point",coordinates:t.slice()},n)},t.exports.polygon=function(t,n){if(!t)throw new Error("No coordinates passed");for(var i=0;i<t.length;i++){var r=t[i];if(r.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var s=0;s<r[r.length-1].length;s++)if(r[r.length-1][s]!==r[0][s])throw new Error("First and last Position are not equivalent.")}return e({type:"Polygon",coordinates:t},n)},t.exports.lineString=function(t,n){if(!t)throw new Error("No coordinates passed");return e({type:"LineString",coordinates:t},n)},t.exports.featureCollection=function(t){return{type:"FeatureCollection",features:t}},t.exports.multiLineString=function(t,n){if(!t)throw new Error("No coordinates passed");return e({type:"MultiLineString",coordinates:t},n)},t.exports.multiPoint=function(t,n){if(!t)throw new Error("No coordinates passed");return e({type:"MultiPoint",coordinates:t},n)},t.exports.multiPolygon=function(t,n){if(!t)throw new Error("No coordinates passed");return e({type:"MultiPolygon",coordinates:t},n)},t.exports.geometryCollection=function(t,n){return e({type:"GeometryCollection",geometries:t},n)};var n={miles:3960,nauticalmiles:3441.145,degrees:57.2957795,radians:1,inches:250905600,yards:6969600,meters:6373e3,metres:6373e3,kilometers:6373,kilometres:6373};t.exports.radiansToDistance=function(t,e){var i=n[e||"kilometers"];if(void 0===i)throw new Error("Invalid unit");return t*i},t.exports.distanceToRadians=function(t,e){var i=n[e||"kilometers"];if(void 0===i)throw new Error("Invalid unit");return t/i},t.exports.distanceToDegrees=function(t,e){var i=n[e||"kilometers"];if(void 0===i)throw new Error("Invalid unit");return t/i*57.2958}},4383:(t,e,n)=>{for(var i=n(3465).point,r=n(3465).polygon,s=n(720),o=n(3465).featureCollection,a=[],l=[],h=0;h<6;h++){var u=2*Math.PI/6*h;a.push(Math.cos(u)),l.push(Math.sin(u))}function c(t,e,n){for(var i=[],s=0;s<6;s++){var o=t[0]+e*a[s],h=t[1]+n*l[s];i.push([o,h])}return i.push(i[0]),r([i])}function f(t,e,n){for(var i=[],s=0;s<6;s++){var o=[];o.push(t),o.push([t[0]+e*a[s],t[1]+n*l[s]]),o.push([t[0]+e*a[(s+1)%6],t[1]+n*l[(s+1)%6]]),o.push(t),i.push(r([o]))}return i}t.exports=function(t,e,n,r){var a=e/s(i([t[0],t[1]]),i([t[2],t[1]]),n)*(t[2]-t[0]),l=e/s(i([t[0],t[1]]),i([t[0],t[3]]),n)*(t[3]-t[1]),h=a/2,u=2*h,d=Math.sqrt(3)/2*l,g=t[2]-t[0],p=t[3]-t[1],m=3/4*u,y=d,v=g/(u-h/2),w=Math.ceil(v);Math.round(v)===w&&w++;var x=(w*m-h/2-g)/2-h/2,_=Math.ceil(p/d),b=(p-_*d)/2,E=_*d-p>d/2;E&&(b-=d/4);for(var S=o([]),I=0;I<w;I++)for(var C=0;C<=_;C++){var M=I%2==1;if(!(0===C&&M||0===C&&E)){var R=I*m+t[0]-x,P=C*y+t[1]+b;M&&(P-=d/2),r?S.features.push.apply(S.features,f([R,P],a/2,l/2)):S.features.push(c([R,P],a/2,l/2))}}return S}},8576:(t,e,n)=>{var i=n(4768);function r(t,e){for(var n=!1,i=0,r=e.length-1;i<e.length;r=i++){var s=e[i][0],o=e[i][1],a=e[r][0],l=e[r][1];o>t[1]!=l>t[1]&&t[0]<(a-s)*(t[1]-o)/(l-o)+s&&(n=!n)}return n}t.exports=function(t,e){var n=i.getCoord(t),s=e.geometry.coordinates;"Polygon"===e.geometry.type&&(s=[s]);for(var o=0,a=!1;o<s.length&&!a;o++)if(r(n,s[o][0])){for(var l=!1,h=1;h<s[o].length&&!l;)r(n,s[o][h])&&(l=!0),h++;l||(a=!0)}return a}},8579:(t,e,n)=>{var i=n(8098);t.exports=function(t,e){var n,r;n="Feature"===t.type?t.geometry:t,r="Feature"===e.type?e.geometry:e;var s=new i.io.GeoJSONReader,o=s.read(JSON.stringify(n)),a=s.read(JSON.stringify(r)),l=o.intersection(a);if(!l.isEmpty())return{type:"Feature",properties:{},geometry:(new i.io.GeoJSONWriter).write(l)}}},4768:t=>{t.exports.geojsonType=function(t,e,n){if(!e||!n)throw new Error("type and name required");if(!t||t.type!==e)throw new Error("Invalid input to "+n+": must be a "+e+", given "+t.type)},t.exports.collectionOf=function(t,e,n){if(!n)throw new Error(".collectionOf() requires a name");if(!t||"FeatureCollection"!==t.type)throw new Error("Invalid input to "+n+", FeatureCollection required");for(var i=0;i<t.features.length;i++){var r=t.features[i];if(!r||"Feature"!==r.type||!r.geometry)throw new Error("Invalid input to "+n+", Feature with geometry required");if(!r.geometry||r.geometry.type!==e)throw new Error("Invalid input to "+n+": must be a "+e+", given "+r.geometry.type)}},t.exports.featureOf=function(t,e,n){if(!n)throw new Error(".featureOf() requires a name");if(!t||"Feature"!==t.type||!t.geometry)throw new Error("Invalid input to "+n+", Feature with geometry required");if(!t.geometry||t.geometry.type!==e)throw new Error("Invalid input to "+n+": must be a "+e+", given "+t.geometry.type)},t.exports.getCoord=function(t){if(Array.isArray(t)&&"number"==typeof t[0]&&"number"==typeof t[1])return t;if(t){if("Feature"===t.type&&t.geometry&&"Point"===t.geometry.type&&Array.isArray(t.geometry.coordinates))return t.geometry.coordinates;if("Point"===t.type&&Array.isArray(t.coordinates))return t.coordinates}throw new Error("A coordinate, feature, or point geometry is required")}},9910:t=>{t.exports=r;function e(t,e){var n=t.x-e.x,i=t.y-e.y;return n*n+i*i<1e-10}function n(t){for(var e=t.head;e;){var n=e.next;e.next=e.prev,e.prev=n,e=n}n=t.head,t.head=t.tail,t.tail=n}function i(t){this.level=t,this.s=null,this.count=0}function r(t){if(t)this.drawContour=t;else{var e=this;e.contours={},this.drawContour=function(t,n,r,s,o,a){var l=e.contours[a];l||(l=e.contours[a]=new i(o)),l.addSegment({x:t,y:n},{x:r,y:s})},this.contourList=function(){var t=[],n=e.contours;for(var i in n)for(var r=n[i].s,s=n[i].level;r;){var o=r.head,a=[];for(a.level=s,a.k=i;o&&o.p;)a.push(o.p),o=o.next;t.push(a),r=r.next}return t.sort((function(t,e){return t.k-e.k})),t}}this.h=new Array(5),this.sh=new Array(5),this.xh=new Array(5),this.yh=new Array(5)}i.prototype.remove_seq=function(t){t.prev?t.prev.next=t.next:this.s=t.next,t.next&&(t.next.prev=t.prev),--this.count},i.prototype.addSegment=function(t,i){for(var r=this.s,s=null,o=null,a=!1,l=!1;r&&(null==s&&(e(t,r.head.p)?(s=r,a=!0):e(t,r.tail.p)&&(s=r)),null==o&&(e(i,r.head.p)?(o=r,l=!0):e(i,r.tail.p)&&(o=r)),null==o||null==s);)r=r.next;switch((null!=s?1:0)|(null!=o?2:0)){case 0:var h={p:t,prev:null},u={p:i,next:null};h.next=u,u.prev=h,s={head:h,tail:u,next:this.s,prev:null,closed:!1},this.s&&(this.s.prev=s),this.s=s,++this.count;break;case 1:var c={p:i};a?(c.next=s.head,c.prev=null,s.head.prev=c,s.head=c):(c.next=null,c.prev=s.tail,s.tail.next=c,s.tail=c);break;case 2:c={p:t},l?(c.next=o.head,c.prev=null,o.head.prev=c,o.head=c):(c.next=null,c.prev=o.tail,o.tail.next=c,o.tail=c);break;case 3:if(s===o){c={p:s.tail.p,next:s.head,prev:null},s.head.prev=c,s.head=c,s.closed=!0;break}switch((a?1:0)|(l?2:0)){case 0:n(s);case 1:o.tail.next=s.head,s.head.prev=o.tail,o.tail=s.tail,this.remove_seq(s);break;case 3:n(s);case 2:s.tail.next=o.head,o.head.prev=s.tail,s.tail=o.tail,this.remove_seq(o)}}},r.prototype.contour=function(t,e,n,i,r,s,o,a,l){var h=this.h,u=this.sh,c=this.xh,f=this.yh,d=this.drawContour;this.contours={};for(var g,p,m,y,v,w=function(t,e){return(h[e]*c[t]-h[t]*c[e])/(h[e]-h[t])},x=function(t,e){return(h[e]*f[t]-h[t]*f[e])/(h[e]-h[t])},_=0,b=0,E=0,S=0,I=[0,1,1,0],C=[0,0,1,1],M=[[[0,0,8],[0,2,5],[7,6,9]],[[0,3,4],[1,3,1],[4,3,0]],[[9,6,7],[5,2,0],[8,0,0]]],R=r-1;R>=i;R--)for(var P=e;P<=n-1;P++){var T,N;if(T=Math.min(t[P][R],t[P][R+1]),N=Math.min(t[P+1][R],t[P+1][R+1]),y=Math.min(T,N),T=Math.max(t[P][R],t[P][R+1]),N=Math.max(t[P+1][R],t[P+1][R+1]),(v=Math.max(T,N))>=l[0]&&y<=l[a-1])for(var A=0;A<a;A++)if(l[A]>=y&&l[A]<=v){for(var k=4;k>=0;k--)k>0?(h[k]=t[P+I[k-1]][R+C[k-1]]-l[A],c[k]=s[P+I[k-1]],f[k]=o[R+C[k-1]]):(h[0]=.25*(h[1]+h[2]+h[3]+h[4]),c[0]=.5*(s[P]+s[P+1]),f[0]=.5*(o[R]+o[R+1])),h[k]>1e-10?u[k]=1:h[k]<-1e-10?u[k]=-1:u[k]=0;for(k=1;k<=4;k++)if(p=4!=k?k+1:1,0!=(m=M[u[g=k]+1][u[0]+1][u[p]+1])){switch(m){case 1:_=c[g],E=f[g],b=c[0],S=f[0];break;case 2:_=c[0],E=f[0],b=c[p],S=f[p];break;case 3:_=c[p],E=f[p],b=c[g],S=f[g];break;case 4:_=c[g],E=f[g],b=w(0,p),S=x(0,p);break;case 5:_=c[0],E=f[0],b=w(p,g),S=x(p,g);break;case 6:_=c[p],E=f[p],b=w(g,0),S=x(g,0);break;case 7:_=w(g,0),E=x(g,0),b=w(0,p),S=x(0,p);break;case 8:_=w(0,p),E=x(0,p),b=w(p,g),S=x(p,g);break;case 9:_=w(p,g),E=x(p,g),b=w(g,0),S=x(g,0)}d(_,E,b,S,l[A],A)}}}}},1807:(t,e,n)=>{var i=n(9016),r=n(8576),s=n(6562),o=n(6406),a=n(798),l=n(3465).featureCollection,h=n(3465).lineString,u=n(7430),c=n(9910);t.exports=function(t,e,n,f){for(var d=i(t,e),g=o(t),p=u(g),m=s(p,n),y=[],v=0;v<m.features.length;v++)for(var w=m.features[v],x=0;x<d.features.length;x++){var _=d.features[x];r(w,_)&&(w.properties={},w.properties[e]=a(w,_))}for(var b=Math.sqrt(m.features.length),E=0;E<b;E++){for(var S=m.features.slice(E*b,(E+1)*b),I=[],C=0;C<S.length;C++)S[C].properties?I.push(S[C].properties[e]):I.push(0);y.push(I)}for(var M=(p[2]-p[0])/b,R=[],P=[],T=0;T<b;T++)R.push(T*M+p[0]),P.push(T*M+p[1]);var N=new c;N.contour(y,0,n,0,n,R,P,f.length,f);var A=N.contourList(),k=l([]);return A.forEach((function(t){if(t.length>2){var n=[];t.forEach((function(t){n.push([t.x,t.y])}));var i=h(n);i.properties={},i.properties[e]=t.level,k.features.push(i)}})),k}},4998:(t,e,n)=>{var i=n(3465).point;t.exports=function(t){var e,n={type:"FeatureCollection",features:[]};return(e="Feature"===t.type?t.geometry:t).coordinates.forEach((function(t){e.coordinates.forEach((function(e){for(var r=0;r<t.length-1;r++)for(var s=0;s<e.length-1;s++)if(t!==e||1!==Math.abs(r-s)&&Math.abs(r-s)!==t.length-2){var o=(a=t[r][0],l=t[r][1],h=t[r+1][0],u=t[r+1][1],c=e[s][0],f=e[s][1],d=e[s+1][0],g=e[s+1][1],p=void 0,m=void 0,y=void 0,v=void 0,w=void 0,w={x:null,y:null,onLine1:!1,onLine2:!1},0==(p=(g-f)*(h-a)-(d-c)*(u-l))?null!==w.x&&null!==w.y&&w:(v=(h-a)*(m=l-f)-(u-l)*(y=a-c),m=((d-c)*m-(g-f)*y)/p,y=v/p,w.x=a+m*(h-a),w.y=l+m*(u-l),m>=0&&m<=1&&(w.onLine1=!0),y>=0&&y<=1&&(w.onLine2=!0),!(!w.onLine1||!w.onLine2)&&[w.x,w.y]));o&&n.features.push(i([o[0],o[1]]))}var a,l,h,u,c,f,d,g,p,m,y,v,w}))})),n}},927:(t,e,n)=>{var i=n(720),r=n(3465).point;function s(t,e){for(var n,s=0,o=r(t[0]),a=r(t[0]),l=1;l<t.length;l++)a.geometry.coordinates=t[l],s+=i(o,a,e),n=o,o=a,a=n;return s}t.exports=function t(e,n){if("FeatureCollection"===e.type)return e.features.reduce((function(e,i){return e+t(i,n)}),0);var i,r,o="Feature"===e.type?e.geometry:e;if("LineString"===o.type)return s(o.coordinates,n);if("Polygon"===o.type||"MultiLineString"===o.type){for(i=0,r=0;r<o.coordinates.length;r++)i+=s(o.coordinates[r],n);return i}if("MultiPolygon"===e.type){for(i=0,r=0;r<o.coordinates.length;r++)for(var a=0;a<o.coordinates[r].length;a++)i+=s(o.coordinates[r][a],n);return i}throw new Error("input must be a LineString, MultiLineString, Polygon, or MultiPolygon Feature or Geometry (or a FeatureCollection containing only those types)")}},4381:(t,e,n)=>{var i=n(3465).lineString,r=n(6727);t.exports=function(t,e,n){var s;if("Feature"===n.type)s=n.geometry.coordinates;else{if("LineString"!==n.type)throw new Error("input must be a LineString Feature or Geometry");s=n.coordinates}var o,a=r(n,t),l=r(n,e);o=a.properties.index<=l.properties.index?[a,l]:[l,a];for(var h=i([o[0].geometry.coordinates],{}),u=o[0].properties.index+1;u<o[1].properties.index+1;u++)h.geometry.coordinates.push(s[u]);return h.geometry.coordinates.push(o[1].geometry.coordinates),h}},1594:t=>{function e(t,e,n){var i,r,s,o,a,l,h,u,c,f,d=0,g="FeatureCollection"===t.type,p="Feature"===t.type,m=g?t.features.length:1;for(i=0;i<m;i++)for(h=(f="GeometryCollection"===(c=g?t.features[i].geometry:p?t.geometry:t).type)?c.geometries.length:1,o=0;o<h;o++)if(u=(l=f?c.geometries[o]:c).coordinates,d=!n||"Polygon"!==l.type&&"MultiPolygon"!==l.type?0:1,"Point"===l.type)e(u);else if("LineString"===l.type||"MultiPoint"===l.type)for(r=0;r<u.length;r++)e(u[r]);else if("Polygon"===l.type||"MultiLineString"===l.type)for(r=0;r<u.length;r++)for(s=0;s<u[r].length-d;s++)e(u[r][s]);else{if("MultiPolygon"!==l.type)throw new Error("Unknown Geometry Type");for(r=0;r<u.length;r++)for(s=0;s<u[r].length;s++)for(a=0;a<u[r][s].length-d;a++)e(u[r][s][a])}}function n(t,e){var n;switch(t.type){case"FeatureCollection":for(n=0;n<t.features.length;n++)e(t.features[n].properties);break;case"Feature":e(t.properties)}}t.exports.coordEach=e,t.exports.coordReduce=function(t,n,i,r){return e(t,(function(t){i=n(i,t)}),r),i},t.exports.propEach=n,t.exports.propReduce=function(t,e,i){return n(t,(function(t){i=e(i,t)})),i},t.exports.featureEach=function(t,e){if("Feature"===t.type)e(t);else if("FeatureCollection"===t.type)for(var n=0;n<t.features.length;n++)e(t.features[n])},t.exports.coordAll=function(t){var n=[];return e(t,(function(t){n.push(t)})),n}},4223:(t,e,n)=>{var i=n(2352),r=n(7195),s=n(720);t.exports=function(t,e){var n=s(t,e,"miles"),o=i(t,e);return r(t,n/2,o,"miles")}},8687:(t,e,n)=>{var i=n(720);t.exports=function(t,e){for(var n,r=1/0,s=0;s<e.features.length;s++){var o=i(t,e.features[s],"miles");o<r&&(n=e.features[s],r=o)}return n}},798:t=>{t.exports=function(t,e){var n=t.geometry.coordinates[0],i=t.geometry.coordinates[1],r=e.geometry.coordinates[0][0][0],s=e.geometry.coordinates[0][0][1],o=e.properties.a,a=e.geometry.coordinates[0][1][0],l=e.geometry.coordinates[0][1][1],h=e.properties.b,u=e.geometry.coordinates[0][2][0],c=e.geometry.coordinates[0][2][1],f=e.properties.c;return(f*(n-r)*(i-l)+o*(n-a)*(i-c)+h*(n-u)*(i-s)-h*(n-r)*(i-c)-f*(n-a)*(i-s)-o*(n-u)*(i-l))/((n-r)*(i-l)+(n-a)*(i-c)+(n-u)*(i-s)-(n-r)*(i-c)-(n-a)*(i-s)-(n-u)*(i-l))}},7356:(t,e,n)=>{var i=n(3465).point,r=n(3465).featureCollection,s=n(720);t.exports=function(t,e,n){for(var o=r([]),a=e/s(i([t[0],t[1]]),i([t[2],t[1]]),n)*(t[2]-t[0]),l=e/s(i([t[0],t[1]]),i([t[0],t[3]]),n)*(t[3]-t[1]),h=t[0];h<=t[2];){for(var u=t[1];u<=t[3];)o.features.push(i([h,u])),u+=l;h+=a}return o}},6727:(t,e,n)=>{var i=n(720),r=n(3465).point,s=n(2352),o=n(7195);t.exports=function(t,e){var n;if("Feature"===t.type)n=t.geometry.coordinates;else{if("LineString"!==t.type)throw new Error("input must be a LineString Feature or Geometry");n=t.coordinates}return function(t,e){for(var n="miles",a=r([1/0,1/0],{dist:1/0}),l=0;l<e.length-1;l++){var h=r(e[l]),u=r(e[l+1]);h.properties.dist=i(t,h,n),u.properties.dist=i(t,u,n);var c,f=Math.max(h.properties.dist,u.properties.dist),d=s(h,u),g=o(t,f,d+90,n),p=o(t,f,d-90,n),m=(y=g.geometry.coordinates[0],v=g.geometry.coordinates[1],w=p.geometry.coordinates[0],x=p.geometry.coordinates[1],_=h.geometry.coordinates[0],b=h.geometry.coordinates[1],E=u.geometry.coordinates[0],S=u.geometry.coordinates[1],I=void 0,C=void 0,M=void 0,R=void 0,P=void 0,P={x:null,y:null,onLine1:!1,onLine2:!1},0==(I=(S-b)*(w-y)-(E-_)*(x-v))?null!==P.x&&null!==P.y&&P:(R=(w-y)*(C=v-b)-(x-v)*(M=y-_),C=((E-_)*C-(S-b)*M)/I,M=R/I,P.x=y+C*(w-y),P.y=v+C*(x-v),C>0&&C<1&&(P.onLine1=!0),M>0&&M<1&&(P.onLine2=!0),!(!P.onLine1||!P.onLine2)&&[P.x,P.y]));m&&((c=r(m)).properties.dist=i(t,c,n)),h.properties.dist<a.properties.dist&&((a=h).properties.index=l),u.properties.dist<a.properties.dist&&((a=u).properties.index=l),c&&c.properties.dist<a.properties.dist&&((a=c).properties.index=l)}var y,v,w,x,_,b,E,S,I,C,M,R,P;return a}(e,n)}},130:(t,e,n)=>{var i=n(3465).featureCollection,r=n(7),s=n(720),o=n(8576),a=n(2543);function l(t,e,n,i,r,s){if(Math.sqrt((r-n)*(r-n)+(s-i)*(s-i))===Math.sqrt((t-n)*(t-n)+(e-i)*(e-i))+Math.sqrt((r-t)*(r-t)+(s-e)*(s-e)))return!0}t.exports=function(t){"FeatureCollection"!==t.type&&("Feature"!==t.type&&(t={type:"Feature",geometry:t,properties:{}}),t=i([t]));for(var e=r(t),n=!1,h=0;!n&&h<t.features.length;){var u,c=t.features[h].geometry,f=!1;if("Point"===c.type)e.geometry.coordinates[0]===c.coordinates[0]&&e.geometry.coordinates[1]===c.coordinates[1]&&(n=!0);else if("MultiPoint"===c.type){var d=!1;for(u=0;!d&&u<c.coordinates.length;)e.geometry.coordinates[0]===c.coordinates[u][0]&&e.geometry.coordinates[1]===c.coordinates[u][1]&&(n=!0,d=!0),u++}else if("LineString"===c.type)for(u=0;!f&&u<c.coordinates.length-1;)l(e.geometry.coordinates[0],e.geometry.coordinates[1],c.coordinates[u][0],c.coordinates[u][1],c.coordinates[u+1][0],c.coordinates[u+1][1])&&(f=!0,n=!0),u++;else if("MultiLineString"===c.type)for(var g=0;g<c.coordinates.length;){f=!1,u=0;for(var p=c.coordinates[g];!f&&u<p.length-1;)l(e.geometry.coordinates[0],e.geometry.coordinates[1],p[u][0],p[u][1],p[u+1][0],p[u+1][1])&&(f=!0,n=!0),u++;g++}else"Polygon"!==c.type&&"MultiPolygon"!==c.type||o(e,{type:"Feature",geometry:c,properties:{}})&&(n=!0);h++}if(n)return e;var m,y=i([]);for(h=0;h<t.features.length;h++)y.features=y.features.concat(a(t.features[h]).features);var v=1/0;for(h=0;h<y.features.length;h++){var w=s(e,y.features[h],"miles");w<v&&(v=w,m=y.features[h])}return m}},3384:t=>{var e=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};t.exports=function(t,n){if(!e(t))throw new Error("Coordinates must be an array");if(t.length<2)throw new Error("Coordinates must be at least 2 numbers long");return{type:"Feature",geometry:{type:"Point",coordinates:t},properties:n||{}}}},7537:(t,e,n)=>{var i=n(6498);t.exports=function(t,e,n){switch(n=n||{},e=e||1,t){case"point":case"points":case void 0:return i.point(e,n.bbox);case"polygon":case"polygons":return i.polygon(e,n.num_vertices,n.max_radial_length,n.bbox);default:throw new Error("Unknown type given: valid options are points and polygons")}}},913:(t,e,n)=>{var i=n(3465).featureCollection;t.exports=function(t,e){return i(function(t,e){for(var n,i,r=t.slice(0),s=t.length,o=s-e;s-- >o;)n=r[i=Math.floor((s+1)*Math.random())],r[i]=r[s],r[s]=n;return r.slice(o)}(t.features,e))}},6909:(t,e,n)=>{var i=n(6479),r=["LineString","MultiLineString","Polygon","MultiPolygon"];function s(t,e,n){return"LineString"===t.geometry.type?{type:"LineString",coordinates:l(t.geometry.coordinates,e,n)}:"MultiLineString"===t.geometry.type?{type:"MultiLineString",coordinates:t.geometry.coordinates.map((function(t){return l(t,e,n)}))}:"Polygon"===t.geometry.type?{type:"Polygon",coordinates:h(t.geometry.coordinates,e,n)}:"MultiPolygon"===t.geometry.type?{type:"MultiPolygon",coordinates:t.geometry.coordinates.map((function(t){return h(t,e,n)}))}:t}function o(t){return!(t.length<3||3===t.length&&t[2][0]===t[0][0]&&t[2][1]===t[0][1])}function a(t,e){return{type:"Feature",geometry:t,properties:e}}function l(t,e,n){return i(t.map((function(t){return{x:t[0],y:t[1]}})),e,n).map((function(t){return[t.x,t.y]}))}function h(t,e,n){return t.map((function(t){var r=t.map((function(t){return{x:t[0],y:t[1]}}));if(r.length<4)throw new Error("Invalid polygon");for(var s=i(r,e,n).map((function(t){return[t.x,t.y]}));!o(s);)s=i(r,e-=.01*e,n).map((function(t){return[t.x,t.y]}));return s[s.length-1][0]===s[0][0]&&s[s.length-1][1]===s[0][1]||s.push(s[0]),s}))}t.exports=function(t,e,n){return"Feature"===t.type?a(s(t,e,n),t.properties):"FeatureCollection"===t.type?{type:"FeatureCollection",features:t.features.map((function(t){var i=s(t,e,n);return r.indexOf(i.type)>-1?a(i,t.properties):i}))}:"GeometryCollection"===t.type?{type:"GeometryCollection",geometries:t.geometries.map((function(t){return r.indexOf(t.type)>-1?s({type:"Feature",geometry:t},e,n):t}))}:t}},9899:(t,e,n)=>{var i=n(3465).featureCollection,r=n(3465).point,s=n(3465).polygon,o=n(720);t.exports=function(t,e,n){for(var a=i([]),l=e/o(r([t[0],t[1]]),r([t[2],t[1]]),n)*(t[2]-t[0]),h=e/o(r([t[0],t[1]]),r([t[0],t[3]]),n)*(t[3]-t[1]),u=t[0];u<=t[2];){for(var c=t[1];c<=t[3];){var f=s([[[u,c],[u,c+h],[u+l,c+h],[u+l,c],[u,c]]]);a.features.push(f),c+=h}u+=l}return a}},7430:(t,e,n)=>{var i=n(720);t.exports=function(t){if(i(t.slice(0,2),[t[2],t[1]],"miles")>=i(t.slice(0,2),[t[0],t[3]],"miles")){var e=(t[1]+t[3])/2;return[t[0],e-(t[2]-t[0])/2,t[2],e+(t[2]-t[0])/2]}var n=(t[0]+t[2])/2;return[n-(t[3]-t[1])/2,t[1],n+(t[3]-t[1])/2,t[3]]}},3708:(t,e,n)=>{var i=n(8576);t.exports=function(t,e,n,r){return t=JSON.parse(JSON.stringify(t)),e=JSON.parse(JSON.stringify(e)),t.features.forEach((function(t){t.properties||(t.properties={}),e.features.forEach((function(e){void 0===t.properties[r]&&i(t,e)&&(t.properties[r]=e.properties[n])}))})),t}},4634:(t,e,n)=>{var i=n(3465).polygon,r=n(9187);function s(t){var e=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},i=0,r=0;r<t.length;r++){for(var s=0;s<t[r].length;s++)for(var o=0;o<e;o++)n.vertices.push(t[r][s][o]);r>0&&(i+=t[r-1].length,n.holes.push(i))}return n}(t),n=r(e.vertices,e.holes,2),s=[],o=[];n.forEach((function(t,i){var r=n[i];o.push([e.vertices[2*r],e.vertices[2*r+1]])}));for(var a=0;a<o.length;a+=3){var l=o.slice(a,a+3);l.push(o[a]),s.push(i([l]))}return s}t.exports=function(t){if(!t.geometry||"Polygon"!==t.geometry.type&&"MultiPolygon"!==t.geometry.type)throw new Error("input must be a Polygon or MultiPolygon");var e={type:"FeatureCollection",features:[]};return"Polygon"===t.geometry.type?e.features=s(t.geometry.coordinates):t.geometry.coordinates.forEach((function(t){e.features=e.features.concat(s(t))})),e}},9016:(t,e,n)=>{var i=n(3465).polygon,r=n(3465).featureCollection;function s(t,e,n){this.a=t,this.b=e,this.c=n;var i,r,s,o,a=e.x-t.x,l=e.y-t.y,h=n.x-t.x,u=n.y-t.y,c=a*(t.x+e.x)+l*(t.y+e.y),f=h*(t.x+n.x)+u*(t.y+n.y),d=2*(a*(n.y-e.y)-l*(n.x-e.x));Math.abs(d)<1e-6?(i=Math.min(t.x,e.x,n.x),r=Math.min(t.y,e.y,n.y),s=.5*(Math.max(t.x,e.x,n.x)-i),o=.5*(Math.max(t.y,e.y,n.y)-r),this.x=i+s,this.y=r+o,this.r=s*s+o*o):(this.x=(u*c-l*f)/d,this.y=(a*f-h*c)/d,s=this.x-t.x,o=this.y-t.y,this.r=s*s+o*o)}function o(t,e){return e.x-t.x}function a(t){var e,n,i,r,s,o=t.length;t:for(;o;)for(n=t[--o],e=t[--o],i=o;i;)if(s=t[--i],e===(r=t[--i])&&n===s||e===s&&n===r){t.splice(o,2),t.splice(i,2),o-=2;continue t}}t.exports=function(t,e){return r(function(t){if(t.length<3)return[];t.sort(o);for(var e=t.length-1,n=t[e].x,i=t[0].x,r=t[e].y,l=r;e--;)t[e].y<r&&(r=t[e].y),t[e].y>l&&(l=t[e].y);var h,u,c,f=i-n,d=l-r,g=f>d?f:d,p=.5*(i+n),m=.5*(l+r),y=[new s({x:p-20*g,y:m-g,__sentinel:!0},{x:p,y:m+20*g,__sentinel:!0},{x:p+20*g,y:m-g,__sentinel:!0})],v=[],w=[];for(e=t.length;e--;){for(w.length=0,h=y.length;h--;)(f=t[e].x-y[h].x)>0&&f*f>y[h].r?(v.push(y[h]),y.splice(h,1)):f*f+(d=t[e].y-y[h].y)*d>y[h].r||(w.push(y[h].a,y[h].b,y[h].b,y[h].c,y[h].c,y[h].a),y.splice(h,1));for(a(w),h=w.length;h;)c=w[--h],u=w[--h],y.push(new s(u,c,t[e]))}for(Array.prototype.push.apply(v,y),e=v.length;e--;)(v[e].a.__sentinel||v[e].b.__sentinel||v[e].c.__sentinel)&&v.splice(e,1);return v}(t.features.map((function(t){var n={x:t.geometry.coordinates[0],y:t.geometry.coordinates[1]};return e&&(n.z=t.properties[e]),n}))).map((function(t){return i([[[t.a.x,t.a.y],[t.b.x,t.b.y],[t.c.x,t.c.y],[t.a.x,t.a.y]]],{a:t.a.z,b:t.b.z,c:t.c.z})})))}},3569:(t,e,n)=>{var i=n(3465).featureCollection,r=n(3465).polygon,s=n(720);t.exports=function(t,e,n){for(var o=i([]),a=e/s([t[0],t[1]],[t[2],t[1]],n)*(t[2]-t[0]),l=e/s([t[0],t[1]],[t[0],t[3]],n)*(t[3]-t[1]),h=0,u=t[0];u<=t[2];){for(var c=0,f=t[1];f<=t[3];)h%2==0&&c%2==0?o.features.push(r([[[u,f],[u,f+l],[u+a,f],[u,f]]]),r([[[u,f+l],[u+a,f+l],[u+a,f],[u,f+l]]])):h%2==0&&c%2==1?o.features.push(r([[[u,f],[u+a,f+l],[u+a,f],[u,f]]]),r([[[u,f],[u,f+l],[u+a,f+l],[u,f]]])):c%2==0&&h%2==1?o.features.push(r([[[u,f],[u,f+l],[u+a,f+l],[u,f]]]),r([[[u,f],[u+a,f+l],[u+a,f],[u,f]]])):c%2==1&&h%2==1&&o.features.push(r([[[u,f],[u,f+l],[u+a,f],[u,f]]]),r([[[u,f+l],[u+a,f+l],[u+a,f],[u,f+l]]])),f+=l,c++;h++,u+=a}return o}},9412:(t,e,n)=>{var i=n(8098);t.exports=function(t,e){var n=new i.io.GeoJSONReader,r=n.read(JSON.stringify(t.geometry)),s=n.read(JSON.stringify(e.geometry)),o=r.union(s);return{type:"Feature",geometry:o=(new i.io.GeoJSONWriter).write(o),properties:t.properties}}},6629:(t,e,n)=>{var i=n(8576),r=n(3465).featureCollection;t.exports=function(t,e){for(var n=r([]),s=0;s<e.features.length;s++)for(var o=0;o<t.features.length;o++)i(t.features[o],e.features[s])&&n.features.push(t.features[o]);return n}},2796:(t,e,n)=>{t.exports={isolines:n(1807),convex:n(6109),within:n(6629),concave:n(1580),difference:n(6052),collect:n(3916),flip:n(8980),simplify:n(6909),bezier:n(5853),tag:n(3708),sample:n(913),envelope:n(6322),square:n(7430),midpoint:n(4223),buffer:n(5745),center:n(7),centroid:n(3532),combine:n(4764),distance:n(720),explode:n(2543),bbox:n(6406),tesselate:n(4634),bboxPolygon:n(3035),inside:n(8576),intersect:n(8579),nearest:n(8687),planepoint:n(798),random:n(7537),tin:n(9016),union:n(9412),bearing:n(2352),destination:n(7195),kinks:n(4998),pointOnSurface:n(130),area:n(3464),along:n(5324),lineDistance:n(927),lineSlice:n(4381),pointOnLine:n(6727),pointGrid:n(7356),squareGrid:n(9899),triangleGrid:n(3569),hexGrid:n(4383)};var i=n(3465);t.exports.point=i.point,t.exports.polygon=i.polygon,t.exports.lineString=i.lineString,t.exports.multiPoint=i.multiPoint,t.exports.multiPolygon=i.multiPolygon,t.exports.multiLineString=i.multiLineString,t.exports.feature=i.feature,t.exports.featureCollection=i.featureCollection,t.exports.geometryCollection=i.geometryCollection},8005:t=>{"use strict";t.exports=function(t,n,i){var r=t*n,s=e*t,o=s-(s-t),a=t-o,l=e*n,h=l-(l-n),u=n-h,c=a*u-(r-o*h-a*h-o*u);return i?(i[0]=c,i[1]=r,i):[c,r]};var e=+(Math.pow(2,27)+1)},6359:t=>{"use strict";t.exports=function(t,e,n){var i=t+e,r=i-t,s=e-r,o=t-(i-r);return n?(n[0]=o+s,n[1]=i,n):[o+s,i]}},7102:t=>{"use strict";function e(t){this.roots=new Array(t),this.ranks=new Array(t);for(var e=0;e<t;++e)this.roots[e]=e,this.ranks[e]=0}t.exports=e;var n=e.prototype;Object.defineProperty(n,"length",{get:function(){return this.roots.length}}),n.makeSet=function(){var t=this.roots.length;return this.roots.push(t),this.ranks.push(0),t},n.find=function(t){for(var e=t,n=this.roots;n[t]!==t;)t=n[t];for(;n[e]!==t;){var i=n[e];n[e]=t,e=i}return t},n.link=function(t,e){var n=this.find(t),i=this.find(e);if(n!==i){var r=this.ranks,s=this.roots,o=r[n],a=r[i];o<a?s[n]=i:a<o?s[i]=n:(s[i]=n,++r[n])}}},6732:(t,e,n)=>{"use strict";var i=n(7963),r=navigator.hardwareConcurrency||1;function s(t,e){if("string"!=typeof t&&"function"!=typeof t)throw new TypeError("func argument must be a function");if(void 0===e&&(e={}),"object"!=typeof e||null===e)throw new TypeError("options argument must be an object");this._workerCode=t.toString(),void 0===e.maxWorkers||"auto"===e.maxWorkers?this._numWorkers=Math.min(r-1,1):e.maxWorkers>0?this._numWorkers=Math.min(e.maxWorkers,r):this._numWorkers=r,this._workers=new Map,this._timeout=e.timeout||0,this._terminateOnError=!!e.terminateOnError;var n=e.deps;"string"==typeof n&&(n=[n]),Array.isArray(n)||(n=void 0),this._id=0,this._terminated=!1,this._working=0,this._waiting=[],this._init(n)}Function.prototype,s.prototype._init=function(t){for(var e=i.newWorkerURL(this._workerCode,t),n=0;n<this._numWorkers;n++){var r=new Worker(e);r.onmessage=this._onmessage.bind(this,r),r.onerror=this._onerror.bind(this,r),r.running=!1,r.id=n,this._workers.set(r,null)}URL.revokeObjectURL(e)},s.prototype._onerror=function(t,e){if(!this._terminated){this._working--,t.running=!1;var n=this._workers.get(t);n&&n[1](e.message),this._workers.set(t,null),this._terminateOnError?this.terminate():this._exec()}},s.prototype._onmessage=function(t,e){if(!this._terminated){this._working--,t.running=!1;var n=this._workers.get(t);n&&n[0](e.data.data),this._workers.set(t,null),this._exec()}},s.prototype._exec=function(){for(var t of this._workers.keys()){if(this._working===this._numWorkers||0===this._waiting.length)return;if(!t.running)for(var e=0;e<this._waiting.length;e++){var n=this._waiting[e];if("number"!=typeof n[4]||n[4]===t.id){this._waiting.splice(e,1),t.postMessage({action:"exec",event:n[0],args:n[1]},n[2]),t.running=!0,t.time=Date.now(),this._workers.set(t,n[3]),this._working++;break}}}},s.prototype.terminate=function(){if(!this._terminated){for(var t of this._workers)t[0].terminate(),t[1]&&t[1][1](new Error("Terminated"));this._workers.clear(),this._waiting=[],this._working=0,this._terminated=!0}},s.prototype.postAll=function(t,e){if(this._terminated)throw new Error("Cannot post (terminated)");var n=[];for(var i of this._workers.keys())n.push(this.post(t,e,[],i.id));return Promise.all(n)},s.prototype.post=function(t,e,n,i){void 0===e&&(e=[]),void 0===n&&(n=[]),Array.isArray(e)||(e=[e]),Array.isArray(n)||(n=[n]);var r=this;return new Promise((function(s,o){if(r._terminated)throw new Error("Cannot post (terminated)");r._waiting.push([t,e,n,[s,o],i]),r._exec()}))},t.exports=s},7963:(t,e)=>{"use strict";var n=function(){function t(){this._listeners={}}self.window=self,t.prototype.on=function(t,e){if(this._listeners[t])throw new RangeError("there is already a listener for "+t);if("function"!=typeof e)throw new TypeError("callback argument must be a function");this._listeners[t]=e},t.prototype._send=function(t,e,n){void 0===n?n=[]:Array.isArray(n)||(n=[n]),self.postMessage({id:t,data:e},n)},t.prototype._trigger=function(t,e){if(!this._listeners[t])throw new Error("event "+t+" is not defined");this._listeners[t].apply(null,e)};var e=new t;self.onmessage=function(t){switch(t.data.action){case"exec":t.data.args.unshift((function(n,i){e._send(t.data.id,n,i)})),e._trigger(t.data.event,t.data.args);break;case"ping":e._send(t.data.id,"pong");break;default:throw new Error("unexpected action: "+t.data.action)}}}.toString().split('"CODE";');e.newWorkerURL=function(t,e){var i=new Blob(["(",n[0],"importScripts.apply(self, "+JSON.stringify(e)+");\n","(",t,")();",n[1],")();"],{type:"application/javascript"});return URL.createObjectURL(i)}},5752:t=>{t.exports.RADIUS=6378137,t.exports.FLATTENING=1/298.257223563,t.exports.POLAR_RADIUS=6356752.3142},9152:(t,e,n)=>{"use strict";n.d(e,{b:()=>i}),t=n.hmd(t);const i=function(){let t,e,n,i=[],r=[],s=[],o=u,a=function(t,e){return Math.abs(e.timestamp-t.timestamp)};function l(t,e){let n,i,r=-1,s=t.length;if(1===arguments.length){for(;++r<s&&!(null!=(n=t[r])&&n<=n);)n=void 0;for(;++r<s;)null!=(i=t[r])&&n>i&&(n=i)}else{for(;++r<s&&!(null!=(n=e.call(t,t[r],r))&&n<=n);)n=void 0;for(;++r<s;)null!=(i=e.call(t,t[r],r))&&n>i&&(n=i)}return n}function h(t,e){let n,i,r=-1,s=t.length;if(1===arguments.length){for(;++r<s&&!(null!=(n=t[r])&&n<=n);)n=void 0;for(;++r<s;)null!=(i=t[r])&&i>n&&(n=i)}else{for(;++r<s&&!(null!=(n=e.call(t,t[r],r))&&n<=n);)n=void 0;for(;++r<s;)null!=(i=e.call(t,t[r],r))&&i>n&&(n=i)}return n}function u(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function c(t,e){return Math.abs(e.x-t.x)+Math.abs(e.y-t.y)}function f(t,e){const n=t.location.latitude*Math.PI/180,i=t.location.longitude*Math.PI/180,r=e.location.latitude*Math.PI/180,s=r-n,o=e.location.longitude*Math.PI/180-i,a=Math.sin(s/2)*Math.sin(s/2)+Math.cos(n)*Math.cos(r)*Math.sin(o/2)*Math.sin(o/2);return(2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a))*6371).toPrecision(4)}function d(n){const r=[];let s=i[n];for(let l=0;l<i.length;l++)n!==l&&(e&&a(i[l],s)<=e&&o(i[l],s)<=t||o(i[l],s)<=t)&&r.push(l);return r}function g(t,e,i){r[i-1].push(t),s[t]=i;for(let t=0;t<e.length;t++){const o=e[t];if(void 0===s[o]){s[o]=0;let t=d(o);t.length>=n&&g(o,t,i)}s[o]<1&&(s[o]=i,r[i-1].push(o))}}let p=function(){s=[],r=[];for(let t=0;t<i.length;t++)if(void 0===s[t]){s[t]=0;const e=d(t);e.length<n?s[t]=0:(r.push([]),g(t,e,r.length))}return s};return p.getClusters=function(){const t=r.length,n=[];for(let s=0;s<t;s++){if(o===u||o===c){n[s]={x:0,y:0};for(let t=0;t<r[s].length;t++)n[s].x+=i[r[s][t]].x,n[s].y+=i[r[s][t]].y;n[s].x/=r[s].length,n[s].y/=r[s].length,n[s].dimension=r[s].length,n[s].parts=r[s]}if(o===f){n[s]={location:{latitude:0,longitude:0,accuracy:0}};for(let t=0;t<r[s].length;t++)n[s].location.latitude+=i[r[s][t]].location.latitude,n[s].location.longitude+=i[r[s][t]].location.longitude,n[s].location.accuracy+=i[r[s][t]].location.accuracy;n[s].dimension=r[s].length,n[s].parts=r[s],n[s].location.latitude/=r[s].length,n[s].location.longitude/=r[s].length,n[s].location.accuracy/=r[s].length}e&&(n[s].duration={},n[s].duration.start=l(r[s],(function(t){return i[t].timestamp})),n[s].duration.end=h(r[s],(function(t){return i[t].timestamp})),n[s].duration.span=n[s].duration.end-n[s].duration.start)}return n},p.data=function(t){return 0===arguments.length?i:(Array.isArray(t)&&(i=t),p)},p.eps=function(e){return 0===arguments.length?t:("number"==typeof e&&(t=e),p)},p.timeEps=function(t){return 0===arguments.length?e:("number"==typeof t&&(e=t),p)},p.minPts=function(t){return 0===arguments.length?n:("number"==typeof t&&(n=t),p)},p.distance=function(t){if(1===arguments.length)if("string"==typeof t)switch(t){case"HAVERSINE":o=f;break;case"EUCLIDEAN":default:o=u;break;case"MANHATTAN":o=c}else"function"==typeof t&&(o=t);return p},p.timeDistance=function(t){return 1===arguments.length&&(a=t),p},p};var r,s;r="undefined"!=typeof self?self:void 0,s=function(){return i},"function"==typeof define&&n.amdO?define([],s):t.exports?t.exports=s():r.jDBSCAN=s()},2898:t=>{"use strict";t.exports={version:"1.0.1"}}},__webpack_module_cache__={};function __webpack_require__(t){var e=__webpack_module_cache__[t];if(void 0!==e)return e.exports;var n=__webpack_module_cache__[t]={id:t,loaded:!1,exports:{}};return __webpack_modules__[t].call(n.exports,n,n.exports,__webpack_require__),n.loaded=!0,n.exports}__webpack_require__.amdO={},__webpack_require__.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return __webpack_require__.d(e,{a:e}),e},__webpack_require__.d=(t,e)=>{for(var n in e)__webpack_require__.o(e,n)&&!__webpack_require__.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},__webpack_require__.hmd=t=>((t=Object.create(t)).children||(t.children=[]),Object.defineProperty(t,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+t.id)}}),t),__webpack_require__.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),__webpack_require__.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},__webpack_require__.nc=void 0;var __webpack_exports__={};(()=>{"use strict";var t={};__webpack_require__.r(t),__webpack_require__.d(t,{CMYK:()=>Om,GREY:()=>Nm,HSL:()=>km,HSV:()=>Lm,RGB:()=>Am});var e={};__webpack_require__.r(e),__webpack_require__.d(e,{tagsById:()=>Vm,tagsByName:()=>Ym});var n={};__webpack_require__.r(n),__webpack_require__.d(n,{tagsById:()=>Xm,tagsByName:()=>jm});var i={};__webpack_require__.r(i),__webpack_require__.d(i,{tagsById:()=>Wm,tagsByName:()=>Hm});const r=class{constructor(t){this.propagationStopped,this.defaultPrevented,this.type=t,this.target=null}preventDefault(){this.defaultPrevented=!0}stopPropagation(){this.propagationStopped=!0}},s="propertychange",o=class{constructor(){this.disposed=!1}dispose(){this.disposed||(this.disposed=!0,this.disposeInternal())}disposeInternal(){}};function a(t,e){return t>e?1:t<e?-1:0}function l(t,e,n){if(t[0]<=e)return 0;const i=t.length;if(e<=t[i-1])return i-1;if("function"==typeof n){for(let r=1;r<i;++r){const i=t[r];if(i===e)return r;if(i<e)return n(e,t[r-1],i)>0?r-1:r}return i-1}if(n>0){for(let n=1;n<i;++n)if(t[n]<e)return n-1;return i-1}if(n<0){for(let n=1;n<i;++n)if(t[n]<=e)return n;return i-1}for(let n=1;n<i;++n){if(t[n]==e)return n;if(t[n]<e)return t[n-1]-e<e-t[n]?n-1:n}return i-1}function h(t,e,n){for(;e<n;){const i=t[e];t[e]=t[n],t[n]=i,++e,--n}}function u(t,e){const n=Array.isArray(e)?e:[e],i=n.length;for(let e=0;e<i;e++)t[t.length]=n[e]}function c(t,e){const n=t.length;if(n!==e.length)return!1;for(let i=0;i<n;i++)if(t[i]!==e[i])return!1;return!0}function f(){return!0}function d(){return!1}function g(){}function p(t){let e,n,i,r=!1;return function(){const s=Array.prototype.slice.call(arguments);return r&&this===i&&c(s,n)||(r=!0,i=this,n=s,e=t.apply(this,arguments)),e}}function m(t){return function(){let e;try{e=t()}catch(t){return Promise.reject(t)}return e instanceof Promise?e:Promise.resolve(e)}()}function y(t){for(const e in t)delete t[e]}function v(t){let e;for(e in t)return!1;return!e}const w=class extends o{constructor(t){super(),this.eventTarget_=t,this.pendingRemovals_=null,this.dispatching_=null,this.listeners_=null}addEventListener(t,e){if(!t||!e)return;const n=this.listeners_||(this.listeners_={}),i=n[t]||(n[t]=[]);i.includes(e)||i.push(e)}dispatchEvent(t){const e="string"==typeof t,n=e?t:t.type,i=this.listeners_&&this.listeners_[n];if(!i)return;const s=e?new r(t):t;s.target||(s.target=this.eventTarget_||this);const o=this.dispatching_||(this.dispatching_={}),a=this.pendingRemovals_||(this.pendingRemovals_={});let l;n in o||(o[n]=0,a[n]=0),++o[n];for(let t=0,e=i.length;t<e;++t)if(l="handleEvent"in i[t]?i[t].handleEvent(s):i[t].call(this,s),!1===l||s.propagationStopped){l=!1;break}if(0==--o[n]){let t=a[n];for(delete a[n];t--;)this.removeEventListener(n,g);delete o[n]}return l}disposeInternal(){this.listeners_&&y(this.listeners_)}getListeners(t){return this.listeners_&&this.listeners_[t]||void 0}hasListener(t){return!!this.listeners_&&(t?t in this.listeners_:Object.keys(this.listeners_).length>0)}removeEventListener(t,e){if(!this.listeners_)return;const n=this.listeners_[t];if(!n)return;const i=n.indexOf(e);-1!==i&&(this.pendingRemovals_&&t in this.pendingRemovals_?(n[i]=g,++this.pendingRemovals_[t]):(n.splice(i,1),0===n.length&&delete this.listeners_[t]))}},x="change",_="contextmenu",b="click",E="keydown",S="keypress",I="touchmove",C="wheel";function M(t,e,n,i,r){if(i&&i!==t&&(n=n.bind(i)),r){const i=n;n=function(){t.removeEventListener(e,n),i.apply(this,arguments)}}const s={target:t,type:e,listener:n};return t.addEventListener(e,n),s}function R(t,e,n,i){return M(t,e,n,i,!0)}function P(t){t&&t.target&&(t.target.removeEventListener(t.type,t.listener),y(t))}class T extends w{constructor(){super(),this.on=this.onInternal,this.once=this.onceInternal,this.un=this.unInternal,this.revision_=0}changed(){++this.revision_,this.dispatchEvent(x)}getRevision(){return this.revision_}onInternal(t,e){if(Array.isArray(t)){const n=t.length,i=new Array(n);for(let r=0;r<n;++r)i[r]=M(this,t[r],e);return i}return M(this,t,e)}onceInternal(t,e){let n;if(Array.isArray(t)){const i=t.length;n=new Array(i);for(let r=0;r<i;++r)n[r]=R(this,t[r],e)}else n=R(this,t,e);return e.ol_key=n,n}unInternal(t,e){const n=e.ol_key;if(n)!function(t){if(Array.isArray(t))for(let e=0,n=t.length;e<n;++e)P(t[e]);else P(t)}(n);else if(Array.isArray(t))for(let n=0,i=t.length;n<i;++n)this.removeEventListener(t[n],e);else this.removeEventListener(t,e)}}T.prototype.on,T.prototype.once,T.prototype.un;const N=T;function A(){throw new Error("Unimplemented abstract method.")}let k=0;function L(t){return t.ol_uid||(t.ol_uid=String(++k))}class O extends r{constructor(t,e,n){super(t),this.key=e,this.oldValue=n}}const D=class extends N{constructor(t){super(),this.on,this.once,this.un,L(this),this.values_=null,void 0!==t&&this.setProperties(t)}get(t){let e;return this.values_&&this.values_.hasOwnProperty(t)&&(e=this.values_[t]),e}getKeys(){return this.values_&&Object.keys(this.values_)||[]}getProperties(){return this.values_&&Object.assign({},this.values_)||{}}getPropertiesInternal(){return this.values_}hasProperties(){return!!this.values_}notify(t,e){let n;n=`change:${t}`,this.hasListener(n)&&this.dispatchEvent(new O(n,t,e)),n=s,this.hasListener(n)&&this.dispatchEvent(new O(n,t,e))}addChangeListener(t,e){this.addEventListener(`change:${t}`,e)}removeChangeListener(t,e){this.removeEventListener(`change:${t}`,e)}set(t,e,n){const i=this.values_||(this.values_={});if(n)i[t]=e;else{const n=i[t];i[t]=e,n!==e&&this.notify(t,n)}}setProperties(t,e){for(const n in t)this.set(n,t[n],e)}applyProperties(t){t.values_&&Object.assign(this.values_||(this.values_={}),t.values_)}unset(t,e){if(this.values_&&t in this.values_){const n=this.values_[t];delete this.values_[t],v(this.values_)&&(this.values_=null),e||this.notify(t,n)}}},F="add",z="remove",G="length";class B extends r{constructor(t,e,n){super(t),this.element=e,this.index=n}}const U=class extends D{constructor(t,e){if(super(),this.on,this.once,this.un,e=e||{},this.unique_=!!e.unique,this.array_=t||[],this.unique_)for(let t=0,e=this.array_.length;t<e;++t)this.assertUnique_(this.array_[t],t);this.updateLength_()}clear(){for(;this.getLength()>0;)this.pop()}extend(t){for(let e=0,n=t.length;e<n;++e)this.push(t[e]);return this}forEach(t){const e=this.array_;for(let n=0,i=e.length;n<i;++n)t(e[n],n,e)}getArray(){return this.array_}item(t){return this.array_[t]}getLength(){return this.get(G)}insertAt(t,e){if(t<0||t>this.getLength())throw new Error("Index out of bounds: "+t);this.unique_&&this.assertUnique_(e),this.array_.splice(t,0,e),this.updateLength_(),this.dispatchEvent(new B(F,e,t))}pop(){return this.removeAt(this.getLength()-1)}push(t){this.unique_&&this.assertUnique_(t);const e=this.getLength();return this.insertAt(e,t),this.getLength()}remove(t){const e=this.array_;for(let n=0,i=e.length;n<i;++n)if(e[n]===t)return this.removeAt(n)}removeAt(t){if(t<0||t>=this.getLength())return;const e=this.array_[t];return this.array_.splice(t,1),this.updateLength_(),this.dispatchEvent(new B(z,e,t)),e}setAt(t,e){if(t>=this.getLength())return void this.insertAt(t,e);if(t<0)throw new Error("Index out of bounds: "+t);this.unique_&&this.assertUnique_(e,t);const n=this.array_[t];this.array_[t]=e,this.dispatchEvent(new B(z,n,t)),this.dispatchEvent(new B(F,e,t))}updateLength_(){this.set(G,this.array_.length)}assertUnique_(t,e){for(let n=0,i=this.array_.length;n<i;++n)if(this.array_[n]===t&&n!==e)throw new Error("Duplicate item added to a unique collection")}},q="opacity",V="visible",Y="extent",X="zIndex",j="maxResolution",W="minResolution",H="maxZoom",$="minZoom",Z="source";function K(t,e){if(!t)throw new Error(e)}function J(t,e,n){return Math.min(Math.max(t,e),n)}function Q(t,e,n,i,r,s){const o=r-n,a=s-i;if(0!==o||0!==a){const l=((t-n)*o+(e-i)*a)/(o*o+a*a);l>1?(n=r,i=s):l>0&&(n+=o*l,i+=a*l)}return tt(t,e,n,i)}function tt(t,e,n,i){const r=n-t,s=i-e;return r*r+s*s}function et(t){return t*Math.PI/180}function nt(t,e){const n=t%e;return n*e<0?n+e:n}function it(t,e,n){return t+n*(e-t)}function rt(t,e){const n=Math.pow(10,e);return Math.round(t*n)/n}function st(t,e){return Math.round(rt(t,e))}function ot(t,e){return Math.floor(rt(t,e))}function at(t,e){return Math.ceil(rt(t,e))}const lt=class extends D{constructor(t){super(),this.on,this.once,this.un,this.background_=t.background;const e=Object.assign({},t);"object"==typeof t.properties&&(delete e.properties,Object.assign(e,t.properties)),e[q]=void 0!==t.opacity?t.opacity:1,K("number"==typeof e[q],"Layer opacity must be a number"),e[V]=void 0===t.visible||t.visible,e[X]=t.zIndex,e[j]=void 0!==t.maxResolution?t.maxResolution:1/0,e[W]=void 0!==t.minResolution?t.minResolution:0,e[$]=void 0!==t.minZoom?t.minZoom:-1/0,e[H]=void 0!==t.maxZoom?t.maxZoom:1/0,this.className_=void 0!==e.className?e.className:"ol-layer",delete e.className,this.setProperties(e),this.state_=null}getBackground(){return this.background_}getClassName(){return this.className_}getLayerState(t){const e=this.state_||{layer:this,managed:void 0===t||t},n=this.getZIndex();return e.opacity=J(Math.round(100*this.getOpacity())/100,0,1),e.visible=this.getVisible(),e.extent=this.getExtent(),e.zIndex=void 0!==n||e.managed?n:1/0,e.maxResolution=this.getMaxResolution(),e.minResolution=Math.max(this.getMinResolution(),0),e.minZoom=this.getMinZoom(),e.maxZoom=this.getMaxZoom(),this.state_=e,e}getLayersArray(t){return A()}getLayerStatesArray(t){return A()}getExtent(){return this.get(Y)}getMaxResolution(){return this.get(j)}getMinResolution(){return this.get(W)}getMinZoom(){return this.get($)}getMaxZoom(){return this.get(H)}getOpacity(){return this.get(q)}getSourceState(){return A()}getVisible(){return this.get(V)}getZIndex(){return this.get(X)}setBackground(t){this.background_=t,this.changed()}setExtent(t){this.set(Y,t)}setMaxResolution(t){this.set(j,t)}setMinResolution(t){this.set(W,t)}setMaxZoom(t){this.set(H,t)}setMinZoom(t){this.set($,t)}setOpacity(t){K("number"==typeof t,"Layer opacity must be a number"),this.set(q,t)}setVisible(t){this.set(V,t)}setZIndex(t){this.set(X,t)}disposeInternal(){this.state_&&(this.state_.layer=null,this.state_=null),super.disposeInternal()}},ht="prerender",ut="postrender",ct="precompose",ft="rendercomplete",dt={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"},gt=42,pt=256,mt={radians:6370997/(2*Math.PI),degrees:2*Math.PI*6370997/360,ft:.3048,m:1,"us-ft":1200/3937},yt=class{constructor(t){this.code_=t.code,this.units_=t.units,this.extent_=void 0!==t.extent?t.extent:null,this.worldExtent_=void 0!==t.worldExtent?t.worldExtent:null,this.axisOrientation_=void 0!==t.axisOrientation?t.axisOrientation:"enu",this.global_=void 0!==t.global&&t.global,this.canWrapX_=!(!this.global_||!this.extent_),this.getPointResolutionFunc_=t.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=t.metersPerUnit}canWrapX(){return this.canWrapX_}getCode(){return this.code_}getExtent(){return this.extent_}getUnits(){return this.units_}getMetersPerUnit(){return this.metersPerUnit_||mt[this.units_]}getWorldExtent(){return this.worldExtent_}getAxisOrientation(){return this.axisOrientation_}isGlobal(){return this.global_}setGlobal(t){this.global_=t,this.canWrapX_=!(!t||!this.extent_)}getDefaultTileGrid(){return this.defaultTileGrid_}setDefaultTileGrid(t){this.defaultTileGrid_=t}setExtent(t){this.extent_=t,this.canWrapX_=!(!this.global_||!t)}setWorldExtent(t){this.worldExtent_=t}setGetPointResolution(t){this.getPointResolutionFunc_=t}getPointResolutionFunc(){return this.getPointResolutionFunc_}},vt=6378137,wt=Math.PI*vt,xt=[-wt,-wt,wt,wt],_t=[-180,-85,180,85],bt=vt*Math.log(Math.tan(Math.PI/2));class Et extends yt{constructor(t){super({code:t,units:"m",extent:xt,global:!0,worldExtent:_t,getPointResolution:function(t,e){return t/Math.cosh(e[1]/vt)}})}}const St=[new Et("EPSG:3857"),new Et("EPSG:102100"),new Et("EPSG:102113"),new Et("EPSG:900913"),new Et("http://www.opengis.net/def/crs/EPSG/0/3857"),new Et("http://www.opengis.net/gml/srs/epsg.xml#3857")];const It=[-180,-90,180,90],Ct=6378137*Math.PI/180;class Mt extends yt{constructor(t,e){super({code:t,units:"degrees",extent:It,axisOrientation:e,global:!0,metersPerUnit:Ct,worldExtent:It})}}const Rt=[new Mt("CRS:84"),new Mt("EPSG:4326","neu"),new Mt("urn:ogc:def:crs:OGC:1.3:CRS84"),new Mt("urn:ogc:def:crs:OGC:2:84"),new Mt("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new Mt("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new Mt("http://www.opengis.net/def/crs/EPSG/0/4326","neu")];let Pt={},Tt={};function Nt(t,e,n){const i=t.getCode(),r=e.getCode();i in Tt||(Tt[i]={}),Tt[i][r]=n}const At={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};function kt(t){const e=[1/0,1/0,-1/0,-1/0];for(let n=0,i=t.length;n<i;++n)Wt(e,t[n]);return e}function Lt(t,e,n){return n?(n[0]=t[0]-e,n[1]=t[1]-e,n[2]=t[2]+e,n[3]=t[3]+e,n):[t[0]-e,t[1]-e,t[2]+e,t[3]+e]}function Ot(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t.slice()}function Dt(t,e,n){let i,r;return i=e<t[0]?t[0]-e:t[2]<e?e-t[2]:0,r=n<t[1]?t[1]-n:t[3]<n?n-t[3]:0,i*i+r*r}function Ft(t,e){return Gt(t,e[0],e[1])}function zt(t,e){return t[0]<=e[0]&&e[2]<=t[2]&&t[1]<=e[1]&&e[3]<=t[3]}function Gt(t,e,n){return t[0]<=e&&e<=t[2]&&t[1]<=n&&n<=t[3]}function Bt(t,e){const n=t[0],i=t[1],r=t[2],s=t[3],o=e[0],a=e[1];let l=At.UNKNOWN;return o<n?l|=At.LEFT:o>r&&(l|=At.RIGHT),a<i?l|=At.BELOW:a>s&&(l|=At.ABOVE),l===At.UNKNOWN&&(l=At.INTERSECTING),l}function Ut(t,e,n,i,r){return r?(r[0]=t,r[1]=e,r[2]=n,r[3]=i,r):[t,e,n,i]}function qt(t){return Ut(1/0,1/0,-1/0,-1/0,t)}function Vt(t,e){const n=t[0],i=t[1];return Ut(n,i,n,i,e)}function Yt(t,e,n,i,r){return Ht(qt(r),t,e,n,i)}function Xt(t,e){return t[0]==e[0]&&t[2]==e[2]&&t[1]==e[1]&&t[3]==e[3]}function jt(t,e){return e[0]<t[0]&&(t[0]=e[0]),e[2]>t[2]&&(t[2]=e[2]),e[1]<t[1]&&(t[1]=e[1]),e[3]>t[3]&&(t[3]=e[3]),t}function Wt(t,e){e[0]<t[0]&&(t[0]=e[0]),e[0]>t[2]&&(t[2]=e[0]),e[1]<t[1]&&(t[1]=e[1]),e[1]>t[3]&&(t[3]=e[1])}function Ht(t,e,n,i,r){for(;n<i;n+=r)$t(t,e[n],e[n+1]);return t}function $t(t,e,n){t[0]=Math.min(t[0],e),t[1]=Math.min(t[1],n),t[2]=Math.max(t[2],e),t[3]=Math.max(t[3],n)}function Zt(t,e){let n;return n=e(Jt(t)),n||(n=e(Qt(t)),n||(n=e(ae(t)),n||(n=e(oe(t)),n||!1)))}function Kt(t){let e=0;return ue(t)||(e=le(t)*re(t)),e}function Jt(t){return[t[0],t[1]]}function Qt(t){return[t[2],t[1]]}function te(t){return[(t[0]+t[2])/2,(t[1]+t[3])/2]}function ee(t,e){let n;if("bottom-left"===e)n=Jt(t);else if("bottom-right"===e)n=Qt(t);else if("top-left"===e)n=oe(t);else{if("top-right"!==e)throw new Error("Invalid corner");n=ae(t)}return n}function ne(t,e,n,i,r){const[s,o,a,l,h,u,c,f]=ie(t,e,n,i);return Ut(Math.min(s,a,h,c),Math.min(o,l,u,f),Math.max(s,a,h,c),Math.max(o,l,u,f),r)}function ie(t,e,n,i){const r=e*i[0]/2,s=e*i[1]/2,o=Math.cos(n),a=Math.sin(n),l=r*o,h=r*a,u=s*o,c=s*a,f=t[0],d=t[1];return[f-l+c,d-h-u,f-l-c,d-h+u,f+l-c,d+h+u,f+l+c,d+h-u,f-l+c,d-h-u]}function re(t){return t[3]-t[1]}function se(t,e,n){const i=n||[1/0,1/0,-1/0,-1/0];return he(t,e)?(t[0]>e[0]?i[0]=t[0]:i[0]=e[0],t[1]>e[1]?i[1]=t[1]:i[1]=e[1],t[2]<e[2]?i[2]=t[2]:i[2]=e[2],t[3]<e[3]?i[3]=t[3]:i[3]=e[3]):qt(i),i}function oe(t){return[t[0],t[3]]}function ae(t){return[t[2],t[3]]}function le(t){return t[2]-t[0]}function he(t,e){return t[0]<=e[2]&&t[2]>=e[0]&&t[1]<=e[3]&&t[3]>=e[1]}function ue(t){return t[2]<t[0]||t[3]<t[1]}function ce(t,e,n,i){if(ue(t))return qt(n);let r=[];if(i>1){const e=t[2]-t[0],n=t[3]-t[1];for(let s=0;s<i;++s)r.push(t[0]+e*s/i,t[1],t[2],t[1]+n*s/i,t[2]-e*s/i,t[3],t[0],t[3]-n*s/i)}else r=[t[0],t[1],t[2],t[1],t[2],t[3],t[0],t[3]];e(r,r,2);const s=[],o=[];for(let t=0,e=r.length;t<e;t+=2)s.push(r[t]),o.push(r[t+1]);return function(t,e,n){return Ut(Math.min.apply(null,t),Math.min.apply(null,e),Math.max.apply(null,t),Math.max.apply(null,e),n)}(s,o,n)}function fe(t,e){const n=e.getExtent(),i=te(t);if(e.canWrapX()&&(i[0]<n[0]||i[0]>=n[2])){const e=le(n),r=Math.floor((i[0]-n[0])/e)*e;t[0]-=r,t[2]-=r}return t}function de(t,e){let n=!0;for(let i=t.length-1;i>=0;--i)if(t[i]!=e[i]){n=!1;break}return n}function ge(t,e){const n=Math.cos(e),i=Math.sin(e),r=t[0]*n-t[1]*i,s=t[1]*n+t[0]*i;return t[0]=r,t[1]=s,t}function pe(t,e){if(e.canWrapX()){const n=le(e.getExtent()),i=function(t,e,n){const i=e.getExtent();let r=0;return e.canWrapX()&&(t[0]<i[0]||t[0]>i[2])&&(n=n||le(i),r=Math.floor((t[0]-i[0])/n)),r}(t,e,n);i&&(t[0]-=i*n)}return t}const me=6371008.8;function ye(t,e,n){n=n||me;const i=et(t[1]),r=et(e[1]),s=(r-i)/2,o=et(e[0]-t[0])/2,a=Math.sin(s)*Math.sin(s)+Math.sin(o)*Math.sin(o)*Math.cos(i)*Math.cos(r);return 2*n*Math.atan2(Math.sqrt(a),Math.sqrt(1-a))}function ve(t,e){let n=0;for(let i=0,r=t.length;i<r-1;++i)n+=ye(t[i],t[i+1],e);return n}function we(t,e){const n=(e=e||{}).radius||me,i=e.projection||"EPSG:3857",r=t.getType();"GeometryCollection"!==r&&(t=t.clone().transform(i,"EPSG:4326"));let s,o,a,l,h,u,c=0;switch(r){case"Point":case"MultiPoint":break;case"LineString":case"LinearRing":s=t.getCoordinates(),c=ve(s,n);break;case"MultiLineString":case"Polygon":for(s=t.getCoordinates(),a=0,l=s.length;a<l;++a)c+=ve(s[a],n);break;case"MultiPolygon":for(s=t.getCoordinates(),a=0,l=s.length;a<l;++a)for(o=s[a],h=0,u=o.length;h<u;++h)c+=ve(o[h],n);break;case"GeometryCollection":{const n=t.getGeometries();for(a=0,l=n.length;a<l;++a)c+=we(n[a],e);break}default:throw new Error("Unsupported geometry type: "+r)}return c}function xe(t,e){let n=0;const i=t.length;let r=t[i-1][0],s=t[i-1][1];for(let e=0;e<i;e++){const i=t[e][0],o=t[e][1];n+=et(i-r)*(2+Math.sin(et(s))+Math.sin(et(o))),r=i,s=o}return n*e*e/2}function _e(t,e){const n=(e=e||{}).radius||me,i=e.projection||"EPSG:3857",r=t.getType();"GeometryCollection"!==r&&(t=t.clone().transform(i,"EPSG:4326"));let s,o,a,l,h,u,c=0;switch(r){case"Point":case"MultiPoint":case"LineString":case"MultiLineString":case"LinearRing":break;case"Polygon":for(s=t.getCoordinates(),c=Math.abs(xe(s[0],n)),a=1,l=s.length;a<l;++a)c-=Math.abs(xe(s[a],n));break;case"MultiPolygon":for(s=t.getCoordinates(),a=0,l=s.length;a<l;++a)for(o=s[a],c+=Math.abs(xe(o[0],n)),h=1,u=o.length;h<u;++h)c-=Math.abs(xe(o[h],n));break;case"GeometryCollection":{const n=t.getGeometries();for(a=0,l=n.length;a<l;++a)c+=_e(n[a],e);break}default:throw new Error("Unsupported geometry type: "+r)}return c}const be={info:1,warn:2,error:3,none:4};let Ee=be.info;function Se(...t){Ee>be.warn||console.warn(...t)}let Ie=!0;function Ce(t,e){if(void 0!==e)for(let n=0,i=t.length;n<i;++n)e[n]=t[n];else e=t.slice();return e}function Me(t,e){if(void 0!==e&&t!==e){for(let n=0,i=t.length;n<i;++n)e[n]=t[n];t=e}return t}function Re(t){!function(t,e){Pt[t]=e}(t.getCode(),t),Nt(t,t,Ce)}function Pe(t){return"string"==typeof t?Pt[e=t]||Pt[e.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null:t||null;var e}function Te(t,e,n,i){let r;const s=(t=Pe(t)).getPointResolutionFunc();if(s){if(r=s(e,n),i&&i!==t.getUnits()){const e=t.getMetersPerUnit();e&&(r=r*e/mt[i])}}else{const s=t.getUnits();if("degrees"==s&&!i||"degrees"==i)r=e;else{const o=Oe(t,Pe("EPSG:4326"));if(o===Me&&"degrees"!==s)r=e*t.getMetersPerUnit();else{let t=[n[0]-e/2,n[1],n[0]+e/2,n[1],n[0],n[1]-e/2,n[0],n[1]+e/2];t=o(t,t,2),r=(ye(t.slice(0,2),t.slice(2,4))+ye(t.slice(4,6),t.slice(6,8)))/2}const a=i?mt[i]:t.getMetersPerUnit();void 0!==a&&(r/=a)}}return r}function Ne(t){!function(t){t.forEach(Re)}(t),t.forEach((function(e){t.forEach((function(t){e!==t&&Nt(e,t,Ce)}))}))}function Ae(t,e){return t?"string"==typeof t?Pe(t):t:Pe(e)}function ke(t,e){const n=Fe(t,void 0!==e?e:"EPSG:3857","EPSG:4326"),i=n[0];return(i<-180||i>180)&&(n[0]=nt(i+180,360)-180),n}function Le(t,e){if(t===e)return!0;const n=t.getUnits()===e.getUnits();return(t.getCode()===e.getCode()||Oe(t,e)===Ce)&&n}function Oe(t,e){let n=function(t,e){let n;return t in Tt&&e in Tt[t]&&(n=Tt[t][e]),n}(t.getCode(),e.getCode());return n||(n=Me),n}function De(t,e){return Oe(Pe(t),Pe(e))}function Fe(t,e,n){return De(e,n)(t,void 0,t.length)}function ze(t,e,n,i){return ce(t,De(e,n),void 0,i)}let Ge=null;function Be(){return Ge}function Ue(t,e){return Ge?Fe(t,e,Ge):t}function qe(t,e){return Ge?Fe(t,Ge,e):(Ie&&!de(t,[0,0])&&t[0]>=-180&&t[0]<=180&&t[1]>=-90&&t[1]<=90&&(Ie=!1,Se("Call useGeographic() from ol/proj once to work with [longitude, latitude] coordinates.")),t)}function Ve(t,e){return Ge?ze(t,e,Ge):t}function Ye(t,e){return Ge?ze(t,Ge,e):t}function Xe(t,e){if(!Ge)return t;const n=Pe(e).getMetersPerUnit(),i=Ge.getMetersPerUnit();return n&&i?t*n/i:t}var je,We,He;function $e(t,e,n){return function(i,r,s,o,a){if(!i)return;if(!r&&!e)return i;const l=e?0:s[0]*r,h=e?0:s[1]*r,u=a?a[0]:0,c=a?a[1]:0;let f=t[0]+l/2+u,d=t[2]-l/2+u,g=t[1]+h/2+c,p=t[3]-h/2+c;f>d&&(f=(d+f)/2,d=f),g>p&&(g=(p+g)/2,p=g);let m=J(i[0],f,d),y=J(i[1],g,p);if(o&&n&&r){const t=30*r;m+=-t*Math.log(1+Math.max(0,f-i[0])/t)+t*Math.log(1+Math.max(0,i[0]-d)/t),y+=-t*Math.log(1+Math.max(0,g-i[1])/t)+t*Math.log(1+Math.max(0,i[1]-p)/t)}return[m,y]}}function Ze(t){return t}function Ke(t,e,n,i){const r=le(e)/n[0],s=re(e)/n[1];return i?Math.min(t,Math.max(r,s)):Math.min(t,Math.min(r,s))}function Je(t,e,n){let i=Math.min(t,e);return i*=Math.log(1+50*Math.max(0,t/e-1))/50+1,n&&(i=Math.max(i,n),i/=Math.log(1+50*Math.max(0,n/t-1))/50+1),J(i,n/2,2*e)}function Qe(t,e,n,i,r){return n=void 0===n||n,function(s,o,a,l){if(void 0!==s){const o=i?Ke(t,i,a,r):t;return n&&l?Je(s,o,e):J(s,e,o)}}}function tn(t){if(void 0!==t)return 0}function en(t){if(void 0!==t)return t}function nn(t){return Math.pow(t,3)}function rn(t){return 1-nn(1-t)}function sn(t){return 3*t*t-2*t*t*t}function on(t){return t}function an(t,e){const n=e[0],i=e[1];return e[0]=t[0]*n+t[2]*i+t[4],e[1]=t[1]*n+t[3]*i+t[5],e}function ln(t,e,n,i,r,s,o,a){const l=Math.sin(s),h=Math.cos(s);return t[0]=i*h,t[1]=r*l,t[2]=-i*l,t[3]=r*h,t[4]=o*i*h-a*i*l+e,t[5]=o*r*l+a*r*h+n,t}function hn(t,e){const n=(i=e)[0]*i[3]-i[1]*i[2];var i;K(0!==n,"Transformation matrix cannot be inverted");const r=e[0],s=e[1],o=e[2],a=e[3],l=e[4],h=e[5];return t[0]=a/n,t[1]=-s/n,t[2]=-o/n,t[3]=r/n,t[4]=(o*h-a*l)/n,t[5]=-(r*h-s*l)/n,t}Ne(St),Ne(Rt),je=St,We=function(t,e,n){const i=t.length;n=n>1?n:2,void 0===e&&(e=n>2?t.slice():new Array(i));for(let r=0;r<i;r+=n){e[r]=wt*t[r]/180;let n=vt*Math.log(Math.tan(Math.PI*(+t[r+1]+90)/360));n>bt?n=bt:n<-bt&&(n=-bt),e[r+1]=n}return e},He=function(t,e,n){const i=t.length;n=n>1?n:2,void 0===e&&(e=n>2?t.slice():new Array(i));for(let r=0;r<i;r+=n)e[r]=180*t[r]/wt,e[r+1]=360*Math.atan(Math.exp(t[r+1]/vt))/Math.PI-90;return e},Rt.forEach((function(t){je.forEach((function(e){Nt(t,e,We),Nt(e,t,He)}))})),new Array(6);const un=[1e6,1e6,1e6,1e6,2,2];function cn(t){const e="matrix("+t.map(((t,e)=>Math.round(t*un[e])/un[e])).join(", ")+")";return e}function fn(t,e,n,i,r,s){s=s||[];let o=0;for(let a=e;a<n;a+=i){const e=t[a],n=t[a+1];s[o++]=r[0]*e+r[2]*n+r[4],s[o++]=r[1]*e+r[3]*n+r[5]}return s&&s.length!=o&&(s.length=o),s}function dn(t,e,n,i,r,s,o){o=o||[];const a=Math.cos(r),l=Math.sin(r),h=s[0],u=s[1];let c=0;for(let r=e;r<n;r+=i){const e=t[r]-h,n=t[r+1]-u;o[c++]=h+e*a-n*l,o[c++]=u+e*l+n*a;for(let e=r+2;e<r+i;++e)o[c++]=t[e]}return o&&o.length!=c&&(o.length=c),o}const gn=[1,0,0,1,0,0],pn=class extends D{constructor(){super(),this.extent_=[1/0,1/0,-1/0,-1/0],this.extentRevision_=-1,this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0,this.simplifyTransformedInternal=p(((t,e,n)=>{if(!n)return this.getSimplifiedGeometry(e);const i=this.clone();return i.applyTransform(n),i.getSimplifiedGeometry(e)}))}simplifyTransformed(t,e){return this.simplifyTransformedInternal(this.getRevision(),t,e)}clone(){return A()}closestPointXY(t,e,n,i){return A()}containsXY(t,e){const n=this.getClosestPoint([t,e]);return n[0]===t&&n[1]===e}getClosestPoint(t,e){return e=e||[NaN,NaN],this.closestPointXY(t[0],t[1],e,1/0),e}intersectsCoordinate(t){return this.containsXY(t[0],t[1])}computeExtent(t){return A()}getExtent(t){if(this.extentRevision_!=this.getRevision()){const t=this.computeExtent(this.extent_);(isNaN(t[0])||isNaN(t[1]))&&qt(t),this.extentRevision_=this.getRevision()}return function(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t}(this.extent_,t)}rotate(t,e){A()}scale(t,e,n){A()}simplify(t){return this.getSimplifiedGeometry(t*t)}getSimplifiedGeometry(t){return A()}getType(){return A()}applyTransform(t){A()}intersectsExtent(t){return A()}translate(t,e){A()}transform(t,e){const n=Pe(t),i="tile-pixels"==n.getUnits()?function(t,i,r){const s=n.getExtent(),o=n.getWorldExtent(),a=re(o)/re(s);return ln(gn,o[0],o[3],a,-a,0,0,0),fn(t,0,t.length,r,gn,i),De(n,e)(t,i,r)}:De(n,e);return this.applyTransform(i),this}};function mn(t){let e;return 2==t?e="XY":3==t?e="XYZ":4==t&&(e="XYZM"),e}function yn(t){let e;return"XY"==t?e=2:"XYZ"==t||"XYM"==t?e=3:"XYZM"==t&&(e=4),e}const vn=class extends pn{constructor(){super(),this.layout="XY",this.stride=2,this.flatCoordinates}computeExtent(t){return Yt(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}getCoordinates(){return A()}getFirstCoordinate(){return this.flatCoordinates.slice(0,this.stride)}getFlatCoordinates(){return this.flatCoordinates}getLastCoordinate(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}getLayout(){return this.layout}getSimplifiedGeometry(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&t<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;const e=this.getSimplifiedGeometryInternal(t);return e.getFlatCoordinates().length<this.flatCoordinates.length?e:(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)}getSimplifiedGeometryInternal(t){return this}getStride(){return this.stride}setFlatCoordinates(t,e){this.stride=yn(t),this.layout=t,this.flatCoordinates=e}setCoordinates(t,e){A()}setLayout(t,e,n){let i;if(t)i=yn(t);else{for(let t=0;t<n;++t){if(0===e.length)return this.layout="XY",void(this.stride=2);e=e[0]}i=e.length,t=mn(i)}this.layout=t,this.stride=i}applyTransform(t){this.flatCoordinates&&(t(this.flatCoordinates,this.flatCoordinates,this.stride),this.changed())}rotate(t,e){const n=this.getFlatCoordinates();if(n){const i=this.getStride();dn(n,0,n.length,i,t,e,n),this.changed()}}scale(t,e,n){void 0===e&&(e=t),n||(n=te(this.getExtent()));const i=this.getFlatCoordinates();if(i){const r=this.getStride();!function(t,e,n,i,r,s,o,a){a=a||[];const l=o[0],h=o[1];let u=0;for(let e=0;e<n;e+=i){const n=t[e]-l,o=t[e+1]-h;a[u++]=l+r*n,a[u++]=h+s*o;for(let n=e+2;n<e+i;++n)a[u++]=t[n]}a&&a.length!=u&&(a.length=u)}(i,0,i.length,r,t,e,n,i),this.changed()}}translate(t,e){const n=this.getFlatCoordinates();if(n){const i=this.getStride();!function(t,e,n,i,r,s,o){o=o||[];let a=0;for(let e=0;e<n;e+=i){o[a++]=t[e]+r,o[a++]=t[e+1]+s;for(let n=e+2;n<e+i;++n)o[a++]=t[n]}o&&o.length!=a&&(o.length=a)}(n,0,n.length,i,t,e,n),this.changed()}}};function wn(t,e,n,i,r,s,o){const a=t[e],l=t[e+1],h=t[n]-a,u=t[n+1]-l;let c;if(0===h&&0===u)c=e;else{const f=((r-a)*h+(s-l)*u)/(h*h+u*u);if(f>1)c=n;else{if(f>0){for(let r=0;r<i;++r)o[r]=it(t[e+r],t[n+r],f);return void(o.length=i)}c=e}}for(let e=0;e<i;++e)o[e]=t[c+e];o.length=i}function xn(t,e,n,i,r){let s=t[e],o=t[e+1];for(e+=i;e<n;e+=i){const n=t[e],i=t[e+1],a=tt(s,o,n,i);a>r&&(r=a),s=n,o=i}return r}function _n(t,e,n,i,r){for(let s=0,o=n.length;s<o;++s){const o=n[s];r=xn(t,e,o,i,r),e=o}return r}function bn(t,e,n,i,r,s,o,a,l,h,u){if(e==n)return h;let c,f;if(0===r){if(f=tt(o,a,t[e],t[e+1]),f<h){for(c=0;c<i;++c)l[c]=t[e+c];return l.length=i,f}return h}u=u||[NaN,NaN];let d=e+i;for(;d<n;)if(wn(t,d-i,d,i,o,a,u),f=tt(o,a,u[0],u[1]),f<h){for(h=f,c=0;c<i;++c)l[c]=u[c];l.length=i,d+=i}else d+=i*Math.max((Math.sqrt(f)-Math.sqrt(h))/r|0,1);if(s&&(wn(t,n-i,e,i,o,a,u),f=tt(o,a,u[0],u[1]),f<h)){for(h=f,c=0;c<i;++c)l[c]=u[c];l.length=i}return h}function En(t,e,n,i,r,s,o,a,l,h,u){u=u||[NaN,NaN];for(let c=0,f=n.length;c<f;++c){const f=n[c];h=bn(t,e,f,i,r,s,o,a,l,h,u),e=f}return h}function Sn(t,e,n,i){for(let r=0,s=n.length;r<s;++r){const s=n[r];for(let n=0;n<i;++n)t[e++]=s[n]}return e}function In(t,e,n,i,r){r=r||[];let s=0;for(let o=0,a=n.length;o<a;++o){const a=Sn(t,e,n[o],i);r[s++]=a,e=a}return r.length=s,r}function Cn(t,e,n,i,r){r=r||[];let s=0;for(let o=0,a=n.length;o<a;++o){const a=In(t,e,n[o],i,r[s]);0===a.length&&(a[0]=e),r[s++]=a,e=a[a.length-1]}return r.length=s,r}function Mn(t,e,n,i,r,s,o){const a=(n-e)/i;if(a<3){for(;e<n;e+=i)s[o++]=t[e],s[o++]=t[e+1];return o}const l=new Array(a);l[0]=1,l[a-1]=1;const h=[e,n-i];let u=0;for(;h.length>0;){const n=h.pop(),s=h.pop();let o=0;const a=t[s],c=t[s+1],f=t[n],d=t[n+1];for(let e=s+i;e<n;e+=i){const n=Q(t[e],t[e+1],a,c,f,d);n>o&&(u=e,o=n)}o>r&&(l[(u-e)/i]=1,s+i<u&&h.push(s,u),u+i<n&&h.push(u,n))}for(let n=0;n<a;++n)l[n]&&(s[o++]=t[e+n*i],s[o++]=t[e+n*i+1]);return o}function Rn(t,e,n,i,r,s,o,a){for(let l=0,h=n.length;l<h;++l){const h=n[l];o=Mn(t,e,h,i,r,s,o),a.push(o),e=h}return o}function Pn(t,e){return e*Math.round(t/e)}function Tn(t,e,n,i,r,s,o){if(e==n)return o;let a,l,h=Pn(t[e],r),u=Pn(t[e+1],r);e+=i,s[o++]=h,s[o++]=u;do{if(a=Pn(t[e],r),l=Pn(t[e+1],r),(e+=i)==n)return s[o++]=a,s[o++]=l,o}while(a==h&&l==u);for(;e<n;){const n=Pn(t[e],r),c=Pn(t[e+1],r);if(e+=i,n==a&&c==l)continue;const f=a-h,d=l-u,g=n-h,p=c-u;f*p==d*g&&(f<0&&g<f||f==g||f>0&&g>f)&&(d<0&&p<d||d==p||d>0&&p>d)?(a=n,l=c):(s[o++]=a,s[o++]=l,h=a,u=l,a=n,l=c)}return s[o++]=a,s[o++]=l,o}function Nn(t,e,n,i,r,s,o,a){for(let l=0,h=n.length;l<h;++l){const h=n[l];o=Tn(t,e,h,i,r,s,o),a.push(o),e=h}return o}function An(t,e,n,i,r){r=void 0!==r?r:[];let s=0;for(let o=e;o<n;o+=i)r[s++]=t.slice(o,o+i);return r.length=s,r}function kn(t,e,n,i,r){r=void 0!==r?r:[];let s=0;for(let o=0,a=n.length;o<a;++o){const a=n[o];r[s++]=An(t,e,a,i,r[s]),e=a}return r.length=s,r}function Ln(t,e,n,i,r){r=void 0!==r?r:[];let s=0;for(let o=0,a=n.length;o<a;++o){const a=n[o];r[s++]=1===a.length&&a[0]===e?[]:kn(t,e,a,i,r[s]),e=a[a.length-1]}return r.length=s,r}function On(t,e,n,i){let r=0,s=t[n-i],o=t[n-i+1];for(;e<n;e+=i){const n=t[e],i=t[e+1];r+=o*n-s*i,s=n,o=i}return r/2}function Dn(t,e,n,i){let r=0;for(let s=0,o=n.length;s<o;++s){const o=n[s];r+=On(t,e,o,i),e=o}return r}class Fn extends vn{constructor(t,e){super(),this.maxDelta_=-1,this.maxDeltaRevision_=-1,void 0===e||Array.isArray(t[0])?this.setCoordinates(t,e):this.setFlatCoordinates(e,t)}clone(){return new Fn(this.flatCoordinates.slice(),this.layout)}closestPointXY(t,e,n,i){return i<Dt(this.getExtent(),t,e)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(xn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),bn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,t,e,n,i))}getArea(){return On(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinates(){return An(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getSimplifiedGeometryInternal(t){const e=[];return e.length=Mn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,0),new Fn(e,"XY")}getType(){return"LinearRing"}intersectsExtent(t){return!1}setCoordinates(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Sn(this.flatCoordinates,0,t,this.stride),this.changed()}}const zn=Fn;class Gn extends vn{constructor(t,e){super(),this.setCoordinates(t,e)}clone(){const t=new Gn(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(t,e,n,i){const r=this.flatCoordinates,s=tt(t,e,r[0],r[1]);if(s<i){const t=this.stride;for(let e=0;e<t;++e)n[e]=r[e];return n.length=t,s}return i}getCoordinates(){return this.flatCoordinates.slice()}computeExtent(t){return Vt(this.flatCoordinates,t)}getType(){return"Point"}intersectsExtent(t){return Gt(t,this.flatCoordinates[0],this.flatCoordinates[1])}setCoordinates(t,e){this.setLayout(e,t,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=function(t,e,n,i){for(let i=0,r=n.length;i<r;++i)t[e++]=n[i];return e}(this.flatCoordinates,0,t,this.stride),this.changed()}}const Bn=Gn;function Un(t,e,n,i,r){return!Zt(r,(function(r){return!qn(t,e,n,i,r[0],r[1])}))}function qn(t,e,n,i,r,s){let o=0,a=t[n-i],l=t[n-i+1];for(;e<n;e+=i){const n=t[e],i=t[e+1];l<=s?i>s&&(n-a)*(s-l)-(r-a)*(i-l)>0&&o++:i<=s&&(n-a)*(s-l)-(r-a)*(i-l)<0&&o--,a=n,l=i}return 0!==o}function Vn(t,e,n,i,r,s){if(0===n.length)return!1;if(!qn(t,e,n[0],i,r,s))return!1;for(let e=1,o=n.length;e<o;++e)if(qn(t,n[e-1],n[e],i,r,s))return!1;return!0}function Yn(t,e,n,i,r,s,o){let l,h,u,c,f,d,g;const p=r[s+1],m=[];for(let r=0,s=n.length;r<s;++r){const s=n[r];for(c=t[s-i],d=t[s-i+1],l=e;l<s;l+=i)f=t[l],g=t[l+1],(p<=d&&g<=p||d<=p&&p<=g)&&(u=(p-d)/(g-d)*(f-c)+c,m.push(u)),c=f,d=g}let y=NaN,v=-1/0;for(m.sort(a),c=m[0],l=1,h=m.length;l<h;++l){f=m[l];const r=Math.abs(f-c);r>v&&(u=(c+f)/2,Vn(t,e,n,i,u,p)&&(y=u,v=r)),c=f}return isNaN(y)&&(y=r[s]),o?(o.push(y,p,v),o):[y,p,v]}function Xn(t,e,n,i,r){let s=[];for(let o=0,a=n.length;o<a;++o){const a=n[o];s=Yn(t,e,a,i,r,2*o,s),e=a[a.length-1]}return s}function jn(t,e,n,i,r){let s;for(e+=i;e<n;e+=i)if(s=r(t.slice(e-i,e),t.slice(e,e+i)),s)return s;return!1}function Wn(t,e,n,i,r){const s=Ht([1/0,1/0,-1/0,-1/0],t,e,n,i);return!!he(r,s)&&(!!zt(r,s)||s[0]>=r[0]&&s[2]<=r[2]||s[1]>=r[1]&&s[3]<=r[3]||jn(t,e,n,i,(function(t,e){return function(t,e,n){let i=!1;const r=Bt(t,e),s=Bt(t,n);if(r===At.INTERSECTING||s===At.INTERSECTING)i=!0;else{const o=t[0],a=t[1],l=t[2],h=t[3],u=e[0],c=e[1],f=n[0],d=n[1],g=(d-c)/(f-u);let p,m;s&At.ABOVE&&!(r&At.ABOVE)&&(p=f-(d-h)/g,i=p>=o&&p<=l),i||!(s&At.RIGHT)||r&At.RIGHT||(m=d-(f-l)*g,i=m>=a&&m<=h),i||!(s&At.BELOW)||r&At.BELOW||(p=f-(d-a)/g,i=p>=o&&p<=l),i||!(s&At.LEFT)||r&At.LEFT||(m=d-(f-o)*g,i=m>=a&&m<=h)}return i}(r,t,e)})))}function Hn(t,e,n,i,r){return!!(Wn(t,e,n,i,r)||qn(t,e,n,i,r[0],r[1])||qn(t,e,n,i,r[0],r[3])||qn(t,e,n,i,r[2],r[1])||qn(t,e,n,i,r[2],r[3]))}function $n(t,e,n,i,r){if(!Hn(t,e,n[0],i,r))return!1;if(1===n.length)return!0;for(let e=1,s=n.length;e<s;++e)if(Un(t,n[e-1],n[e],i,r)&&!Wn(t,n[e-1],n[e],i,r))return!1;return!0}function Zn(t,e,n,i){for(;e<n-i;){for(let r=0;r<i;++r){const s=t[e+r];t[e+r]=t[n-i+r],t[n-i+r]=s}e+=i,n-=i}}function Kn(t,e,n,i){let r=0,s=t[n-i],o=t[n-i+1];for(;e<n;e+=i){const n=t[e],i=t[e+1];r+=(n-s)*(i+o),s=n,o=i}return 0===r?void 0:r>0}function Jn(t,e,n,i,r){r=void 0!==r&&r;for(let s=0,o=n.length;s<o;++s){const o=n[s],a=Kn(t,e,o,i);if(0===s){if(r&&a||!r&&!a)return!1}else if(r&&!a||!r&&a)return!1;e=o}return!0}function Qn(t,e,n,i,r){for(let s=0,o=n.length;s<o;++s){const o=n[s];if(!Jn(t,e,o,i,r))return!1;o.length&&(e=o[o.length-1])}return!0}function ti(t,e,n,i,r){r=void 0!==r&&r;for(let s=0,o=n.length;s<o;++s){const o=n[s],a=Kn(t,e,o,i);(0===s?r&&a||!r&&!a:r&&!a||!r&&a)&&Zn(t,e,o,i),e=o}return e}function ei(t,e,n,i,r){for(let s=0,o=n.length;s<o;++s)e=ti(t,e,n[s],i,r);return e}class ni extends vn{constructor(t,e,n){super(),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,void 0!==e&&n?(this.setFlatCoordinates(e,t),this.ends_=n):this.setCoordinates(t,e)}appendLinearRing(t){this.flatCoordinates?u(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const t=new ni(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return t.applyProperties(this),t}closestPointXY(t,e,n,i){return i<Dt(this.getExtent(),t,e)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(_n(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),En(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,t,e,n,i))}containsXY(t,e){return Vn(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,e)}getArea(){return Dn(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)}getCoordinates(t){let e;return void 0!==t?(e=this.getOrientedFlatCoordinates().slice(),ti(e,0,this.ends_,this.stride,t)):e=this.flatCoordinates,kn(e,0,this.ends_,this.stride)}getEnds(){return this.ends_}getFlatInteriorPoint(){if(this.flatInteriorPointRevision_!=this.getRevision()){const t=te(this.getExtent());this.flatInteriorPoint_=Yn(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_}getInteriorPoint(){return new Bn(this.getFlatInteriorPoint(),"XYM")}getLinearRingCount(){return this.ends_.length}getLinearRing(t){return t<0||this.ends_.length<=t?null:new zn(this.flatCoordinates.slice(0===t?0:this.ends_[t-1],this.ends_[t]),this.layout)}getLinearRings(){const t=this.layout,e=this.flatCoordinates,n=this.ends_,i=[];let r=0;for(let s=0,o=n.length;s<o;++s){const o=n[s],a=new zn(e.slice(r,o),t);i.push(a),r=o}return i}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const t=this.flatCoordinates;Jn(t,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=ti(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(t){const e=[],n=[];return e.length=Nn(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(t),e,0,n),new ni(e,"XY",n)}getType(){return"Polygon"}intersectsExtent(t){return $n(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);const n=In(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=0===n.length?0:n[n.length-1],this.changed()}}const ii=ni;function ri(t){if(ue(t))throw new Error("Cannot create polygon from empty extent");const e=t[0],n=t[1],i=t[2],r=t[3],s=[e,n,e,r,i,r,i,n,e,n];return new ni(s,"XY",[s.length])}function si(t,e){setTimeout((function(){t(e)}),0)}function oi(t){return!(t.sourceCenter&&t.targetCenter&&!de(t.sourceCenter,t.targetCenter))&&t.sourceResolution===t.targetResolution&&t.sourceRotation===t.targetRotation}function ai(t,e,n,i,r){const s=Math.cos(-r);let o=Math.sin(-r),a=t[0]*s-t[1]*o,l=t[1]*s+t[0]*o;return a+=(e[0]/2-n[0])*i,l+=(n[1]-e[1]/2)*i,o=-o,[a*s-l*o,l*s+a*o]}const li=class extends D{constructor(t){super(),this.on,this.once,this.un,t=Object.assign({},t),this.hints_=[0,0],this.animations_=[],this.updateAnimationKey_,this.projection_=Ae(t.projection,"EPSG:3857"),this.viewportSize_=[100,100],this.targetCenter_=null,this.targetResolution_,this.targetRotation_,this.nextCenter_=null,this.nextResolution_,this.nextRotation_,this.cancelAnchor_=void 0,t.projection&&function(t){Ie=!(void 0===t||t)}(),t.center&&(t.center=qe(t.center,this.projection_)),t.extent&&(t.extent=Ye(t.extent,this.projection_)),this.applyOptions_(t)}applyOptions_(t){const e=Object.assign({},t);for(const t in dt)delete e[t];this.setProperties(e,!0);const n=function(t){let e,n,i;let r=void 0!==t.minZoom?t.minZoom:0,s=void 0!==t.maxZoom?t.maxZoom:28;const o=void 0!==t.zoomFactor?t.zoomFactor:2,a=void 0!==t.multiWorld&&t.multiWorld,h=void 0===t.smoothResolutionConstraint||t.smoothResolutionConstraint,u=void 0!==t.showFullExtent&&t.showFullExtent,c=Ae(t.projection,"EPSG:3857"),f=c.getExtent();let d=t.constrainOnlyCenter,g=t.extent;if(a||g||!c.isGlobal()||(d=!1,g=f),void 0!==t.resolutions){const o=t.resolutions;n=o[r],i=void 0!==o[s]?o[s]:o[o.length-1],e=t.constrainResolution?function(t,e,n,i){return e=void 0===e||e,function(r,s,o,a){if(void 0!==r){const h=t[0],u=t[t.length-1],c=n?Ke(h,n,o,i):h;if(a)return e?Je(r,c,u):J(r,u,c);const f=Math.min(c,r),d=Math.floor(l(t,f,s));return t[d]>c&&d<t.length-1?t[d+1]:t[d]}}}(o,h,!d&&g,u):Qe(n,i,h,!d&&g,u)}else{const a=(f?Math.max(le(f),re(f)):360*mt.degrees/c.getMetersPerUnit())/pt/Math.pow(2,0),l=a/Math.pow(2,28);n=t.maxResolution,void 0!==n?r=0:n=a/Math.pow(o,r),i=t.minResolution,void 0===i&&(i=void 0!==t.maxZoom?void 0!==t.maxResolution?n/Math.pow(o,s):a/Math.pow(o,s):l),s=r+Math.floor(Math.log(n/i)/Math.log(o)),i=n/Math.pow(o,s-r),e=t.constrainResolution?function(t,e,n,i,r,s){return i=void 0===i||i,n=void 0!==n?n:0,function(o,a,l,h){if(void 0!==o){const u=r?Ke(e,r,l,s):e;if(h)return i?Je(o,u,n):J(o,n,u);const c=1e-9,f=Math.ceil(Math.log(e/u)/Math.log(t)-c),d=-a*(.5-c)+.5,g=Math.min(u,o),p=Math.floor(Math.log(e/g)/Math.log(t)+d),m=Math.max(f,p);return J(e/Math.pow(t,m),n,u)}}}(o,n,i,h,!d&&g,u):Qe(n,i,h,!d&&g,u)}return{constraint:e,maxResolution:n,minResolution:i,minZoom:r,zoomFactor:o}}(t);this.maxResolution_=n.maxResolution,this.minResolution_=n.minResolution,this.zoomFactor_=n.zoomFactor,this.resolutions_=t.resolutions,this.padding_=t.padding,this.minZoom_=n.minZoom;const i=function(t){if(void 0!==t.extent){const e=void 0===t.smoothExtentConstraint||t.smoothExtentConstraint;return $e(t.extent,t.constrainOnlyCenter,e)}const e=Ae(t.projection,"EPSG:3857");if(!0!==t.multiWorld&&e.isGlobal()){const t=e.getExtent().slice();return t[0]=-1/0,t[2]=1/0,$e(t,!1,!1)}return Ze}(t),r=n.constraint,s=function(t){if(void 0===t.enableRotation||t.enableRotation){const e=t.constrainRotation;return void 0===e||!0===e?function(t){const e=et(5);return function(t,n){return n||void 0===t?t:Math.abs(t)<=e?0:t}}():!1===e?en:"number"==typeof e?function(t){const e=2*Math.PI/t;return function(t,n){return n?t:void 0!==t?t=Math.floor(t/e+.5)*e:void 0}}(e):en}return tn}(t);this.constraints_={center:i,resolution:r,rotation:s},this.setRotation(void 0!==t.rotation?t.rotation:0),this.setCenterInternal(void 0!==t.center?t.center:null),void 0!==t.resolution?this.setResolution(t.resolution):void 0!==t.zoom&&this.setZoom(t.zoom)}get padding(){return this.padding_}set padding(t){let e=this.padding_;this.padding_=t;const n=this.getCenterInternal();if(n){const i=t||[0,0,0,0];e=e||[0,0,0,0];const r=this.getResolution(),s=r/2*(i[3]-e[3]+e[1]-i[1]),o=r/2*(i[0]-e[0]+e[2]-i[2]);this.setCenterInternal([n[0]+s,n[1]-o])}}getUpdatedOptions_(t){const e=this.getProperties();return void 0!==e.resolution?e.resolution=this.getResolution():e.zoom=this.getZoom(),e.center=this.getCenterInternal(),e.rotation=this.getRotation(),Object.assign({},e,t)}animate(t){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);const e=new Array(arguments.length);for(let t=0;t<e.length;++t){let n=arguments[t];n.center&&(n=Object.assign({},n),n.center=qe(n.center,this.getProjection())),n.anchor&&(n=Object.assign({},n),n.anchor=qe(n.anchor,this.getProjection())),e[t]=n}this.animateInternal.apply(this,e)}animateInternal(t){let e,n=arguments.length;n>1&&"function"==typeof arguments[n-1]&&(e=arguments[n-1],--n);let i=0;for(;i<n&&!this.isDef();++i){const t=arguments[i];t.center&&this.setCenterInternal(t.center),void 0!==t.zoom?this.setZoom(t.zoom):t.resolution&&this.setResolution(t.resolution),void 0!==t.rotation&&this.setRotation(t.rotation)}if(i===n)return void(e&&si(e,!0));let r=Date.now(),s=this.targetCenter_.slice(),o=this.targetResolution_,a=this.targetRotation_;const l=[];for(;i<n;++i){const t=arguments[i],n={start:r,complete:!1,anchor:t.anchor,duration:void 0!==t.duration?t.duration:1e3,easing:t.easing||sn,callback:e};if(t.center&&(n.sourceCenter=s,n.targetCenter=t.center.slice(),s=n.targetCenter),void 0!==t.zoom?(n.sourceResolution=o,n.targetResolution=this.getResolutionForZoom(t.zoom),o=n.targetResolution):t.resolution&&(n.sourceResolution=o,n.targetResolution=t.resolution,o=n.targetResolution),void 0!==t.rotation){n.sourceRotation=a;const e=nt(t.rotation-a+Math.PI,2*Math.PI)-Math.PI;n.targetRotation=a+e,a=n.targetRotation}oi(n)?n.complete=!0:r+=n.duration,l.push(n)}this.animations_.push(l),this.setHint(0,1),this.updateAnimations_()}getAnimating(){return this.hints_[0]>0}getInteracting(){return this.hints_[1]>0}cancelAnimations(){let t;this.setHint(0,-this.hints_[0]);for(let e=0,n=this.animations_.length;e<n;++e){const n=this.animations_[e];if(n[0].callback&&si(n[0].callback,!1),!t)for(let e=0,i=n.length;e<i;++e){const i=n[e];if(!i.complete){t=i.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=t,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN}updateAnimations_(){if(void 0!==this.updateAnimationKey_&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),!this.getAnimating())return;const t=Date.now();let e=!1;for(let n=this.animations_.length-1;n>=0;--n){const i=this.animations_[n];let r=!0;for(let n=0,s=i.length;n<s;++n){const s=i[n];if(s.complete)continue;const o=t-s.start;let a=s.duration>0?o/s.duration:1;a>=1?(s.complete=!0,a=1):r=!1;const l=s.easing(a);if(s.sourceCenter){const t=s.sourceCenter[0],e=s.sourceCenter[1],n=s.targetCenter[0],i=s.targetCenter[1];this.nextCenter_=s.targetCenter;const r=t+l*(n-t),o=e+l*(i-e);this.targetCenter_=[r,o]}if(s.sourceResolution&&s.targetResolution){const t=1===l?s.targetResolution:s.sourceResolution+l*(s.targetResolution-s.sourceResolution);if(s.anchor){const e=this.getViewportSize_(this.getRotation()),n=this.constraints_.resolution(t,0,e,!0);this.targetCenter_=this.calculateCenterZoom(n,s.anchor)}this.nextResolution_=s.targetResolution,this.targetResolution_=t,this.applyTargetState_(!0)}if(void 0!==s.sourceRotation&&void 0!==s.targetRotation){const t=1===l?nt(s.targetRotation+Math.PI,2*Math.PI)-Math.PI:s.sourceRotation+l*(s.targetRotation-s.sourceRotation);if(s.anchor){const e=this.constraints_.rotation(t,!0);this.targetCenter_=this.calculateCenterRotate(e,s.anchor)}this.nextRotation_=s.targetRotation,this.targetRotation_=t}if(this.applyTargetState_(!0),e=!0,!s.complete)break}if(r){this.animations_[n]=null,this.setHint(0,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;const t=i[0].callback;t&&si(t,!0)}}this.animations_=this.animations_.filter(Boolean),e&&void 0===this.updateAnimationKey_&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}calculateCenterRotate(t,e){let n;const i=this.getCenterInternal();var r,s;return void 0!==i&&(n=[i[0]-e[0],i[1]-e[1]],ge(n,t-this.getRotation()),s=e,(r=n)[0]+=+s[0],r[1]+=+s[1]),n}calculateCenterZoom(t,e){let n;const i=this.getCenterInternal(),r=this.getResolution();return void 0!==i&&void 0!==r&&(n=[e[0]-t*(e[0]-i[0])/r,e[1]-t*(e[1]-i[1])/r]),n}getViewportSize_(t){const e=this.viewportSize_;if(t){const n=e[0],i=e[1];return[Math.abs(n*Math.cos(t))+Math.abs(i*Math.sin(t)),Math.abs(n*Math.sin(t))+Math.abs(i*Math.cos(t))]}return e}setViewportSize(t){this.viewportSize_=Array.isArray(t)?t.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)}getCenter(){const t=this.getCenterInternal();return t?Ue(t,this.getProjection()):t}getCenterInternal(){return this.get(dt.CENTER)}getConstraints(){return this.constraints_}getConstrainResolution(){return this.get("constrainResolution")}getHints(t){return void 0!==t?(t[0]=this.hints_[0],t[1]=this.hints_[1],t):this.hints_.slice()}calculateExtent(t){return Ve(this.calculateExtentInternal(t),this.getProjection())}calculateExtentInternal(t){t=t||this.getViewportSizeMinusPadding_();const e=this.getCenterInternal();K(e,"The view center is not defined");const n=this.getResolution();K(void 0!==n,"The view resolution is not defined");const i=this.getRotation();return K(void 0!==i,"The view rotation is not defined"),ne(e,n,i,t)}getMaxResolution(){return this.maxResolution_}getMinResolution(){return this.minResolution_}getMaxZoom(){return this.getZoomForResolution(this.minResolution_)}setMaxZoom(t){this.applyOptions_(this.getUpdatedOptions_({maxZoom:t}))}getMinZoom(){return this.getZoomForResolution(this.maxResolution_)}setMinZoom(t){this.applyOptions_(this.getUpdatedOptions_({minZoom:t}))}setConstrainResolution(t){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:t}))}getProjection(){return this.projection_}getResolution(){return this.get(dt.RESOLUTION)}getResolutions(){return this.resolutions_}getResolutionForExtent(t,e){return this.getResolutionForExtentInternal(Ye(t,this.getProjection()),e)}getResolutionForExtentInternal(t,e){e=e||this.getViewportSizeMinusPadding_();const n=le(t)/e[0],i=re(t)/e[1];return Math.max(n,i)}getResolutionForValueFunction(t){t=t||2;const e=this.getConstrainedResolution(this.maxResolution_),n=this.minResolution_,i=Math.log(e/n)/Math.log(t);return function(n){return e/Math.pow(t,n*i)}}getRotation(){return this.get(dt.ROTATION)}getValueForResolutionFunction(t){const e=Math.log(t||2),n=this.getConstrainedResolution(this.maxResolution_),i=this.minResolution_,r=Math.log(n/i)/e;return function(t){return Math.log(n/t)/e/r}}getViewportSizeMinusPadding_(t){let e=this.getViewportSize_(t);const n=this.padding_;return n&&(e=[e[0]-n[1]-n[3],e[1]-n[0]-n[2]]),e}getState(){const t=this.getProjection(),e=this.getResolution(),n=this.getRotation();let i=this.getCenterInternal();const r=this.padding_;if(r){const t=this.getViewportSizeMinusPadding_();i=ai(i,this.getViewportSize_(),[t[0]/2+r[3],t[1]/2+r[0]],e,n)}return{center:i.slice(0),projection:void 0!==t?t:null,resolution:e,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:n,zoom:this.getZoom()}}getViewStateAndExtent(){return{viewState:this.getState(),extent:this.calculateExtent()}}getZoom(){let t;const e=this.getResolution();return void 0!==e&&(t=this.getZoomForResolution(e)),t}getZoomForResolution(t){let e,n,i=this.minZoom_||0;if(this.resolutions_){const r=l(this.resolutions_,t,1);i=r,e=this.resolutions_[r],n=r==this.resolutions_.length-1?2:e/this.resolutions_[r+1]}else e=this.maxResolution_,n=this.zoomFactor_;return i+Math.log(e/t)/Math.log(n)}getResolutionForZoom(t){if(this.resolutions_){if(this.resolutions_.length<=1)return 0;const e=J(Math.floor(t),0,this.resolutions_.length-2),n=this.resolutions_[e]/this.resolutions_[e+1];return this.resolutions_[e]/Math.pow(n,J(t-e,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,t-this.minZoom_)}fit(t,e){let n;if(K(Array.isArray(t)||"function"==typeof t.getSimplifiedGeometry,"Invalid extent or geometry provided as `geometry`"),Array.isArray(t))K(!ue(t),"Cannot fit empty extent provided as `geometry`"),n=ri(Ye(t,this.getProjection()));else if("Circle"===t.getType()){const e=Ye(t.getExtent(),this.getProjection());n=ri(e),n.rotate(this.getRotation(),te(e))}else{const e=Be();n=e?t.clone().transform(e,this.getProjection()):t}this.fitInternal(n,e)}rotatedExtentForGeometry(t){const e=this.getRotation(),n=Math.cos(e),i=Math.sin(-e),r=t.getFlatCoordinates(),s=t.getStride();let o=1/0,a=1/0,l=-1/0,h=-1/0;for(let t=0,e=r.length;t<e;t+=s){const e=r[t]*n-r[t+1]*i,s=r[t]*i+r[t+1]*n;o=Math.min(o,e),a=Math.min(a,s),l=Math.max(l,e),h=Math.max(h,s)}return[o,a,l,h]}fitInternal(t,e){let n=(e=e||{}).size;n||(n=this.getViewportSizeMinusPadding_());const i=void 0!==e.padding?e.padding:[0,0,0,0],r=void 0!==e.nearest&&e.nearest;let s;s=void 0!==e.minResolution?e.minResolution:void 0!==e.maxZoom?this.getResolutionForZoom(e.maxZoom):0;const o=this.rotatedExtentForGeometry(t);let a=this.getResolutionForExtentInternal(o,[n[0]-i[1]-i[3],n[1]-i[0]-i[2]]);a=isNaN(a)?s:Math.max(a,s),a=this.getConstrainedResolution(a,r?0:1);const l=this.getRotation(),h=Math.sin(l),u=Math.cos(l),c=te(o);c[0]+=(i[1]-i[3])/2*a,c[1]+=(i[0]-i[2])/2*a;const f=c[0]*u-c[1]*h,d=c[1]*u+c[0]*h,p=this.getConstrainedCenter([f,d],a),m=e.callback?e.callback:g;void 0!==e.duration?this.animateInternal({resolution:a,center:p,duration:e.duration,easing:e.easing},m):(this.targetResolution_=a,this.targetCenter_=p,this.applyTargetState_(!1,!0),si(m,!0))}centerOn(t,e,n){this.centerOnInternal(qe(t,this.getProjection()),e,n)}centerOnInternal(t,e,n){this.setCenterInternal(ai(t,e,n,this.getResolution(),this.getRotation()))}calculateCenterShift(t,e,n,i){let r;const s=this.padding_;if(s&&t){const o=this.getViewportSizeMinusPadding_(-n),a=ai(t,i,[o[0]/2+s[3],o[1]/2+s[0]],e,n);r=[t[0]-a[0],t[1]-a[1]]}return r}isDef(){return!!this.getCenterInternal()&&void 0!==this.getResolution()}adjustCenter(t){const e=Ue(this.targetCenter_,this.getProjection());this.setCenter([e[0]+t[0],e[1]+t[1]])}adjustCenterInternal(t){const e=this.targetCenter_;this.setCenterInternal([e[0]+t[0],e[1]+t[1]])}adjustResolution(t,e){e=e&&qe(e,this.getProjection()),this.adjustResolutionInternal(t,e)}adjustResolutionInternal(t,e){const n=this.getAnimating()||this.getInteracting(),i=this.getViewportSize_(this.getRotation()),r=this.constraints_.resolution(this.targetResolution_*t,0,i,n);e&&(this.targetCenter_=this.calculateCenterZoom(r,e)),this.targetResolution_*=t,this.applyTargetState_()}adjustZoom(t,e){this.adjustResolution(Math.pow(this.zoomFactor_,-t),e)}adjustRotation(t,e){e&&(e=qe(e,this.getProjection())),this.adjustRotationInternal(t,e)}adjustRotationInternal(t,e){const n=this.getAnimating()||this.getInteracting(),i=this.constraints_.rotation(this.targetRotation_+t,n);e&&(this.targetCenter_=this.calculateCenterRotate(i,e)),this.targetRotation_+=t,this.applyTargetState_()}setCenter(t){this.setCenterInternal(t?qe(t,this.getProjection()):t)}setCenterInternal(t){this.targetCenter_=t,this.applyTargetState_()}setHint(t,e){return this.hints_[t]+=e,this.changed(),this.hints_[t]}setResolution(t){this.targetResolution_=t,this.applyTargetState_()}setRotation(t){this.targetRotation_=t,this.applyTargetState_()}setZoom(t){this.setResolution(this.getResolutionForZoom(t))}applyTargetState_(t,e){const n=this.getAnimating()||this.getInteracting()||e,i=this.constraints_.rotation(this.targetRotation_,n),r=this.getViewportSize_(i),s=this.constraints_.resolution(this.targetResolution_,0,r,n),o=this.constraints_.center(this.targetCenter_,s,r,n,this.calculateCenterShift(this.targetCenter_,s,i,r));this.get(dt.ROTATION)!==i&&this.set(dt.ROTATION,i),this.get(dt.RESOLUTION)!==s&&(this.set(dt.RESOLUTION,s),this.set("zoom",this.getZoom(),!0)),o&&this.get(dt.CENTER)&&de(this.get(dt.CENTER),o)||this.set(dt.CENTER,o),this.getAnimating()&&!t&&this.cancelAnimations(),this.cancelAnchor_=void 0}resolveConstraints(t,e,n){t=void 0!==t?t:200;const i=e||0,r=this.constraints_.rotation(this.targetRotation_),s=this.getViewportSize_(r),o=this.constraints_.resolution(this.targetResolution_,i,s),a=this.constraints_.center(this.targetCenter_,o,s,!1,this.calculateCenterShift(this.targetCenter_,o,r,s));if(0===t&&!this.cancelAnchor_)return this.targetResolution_=o,this.targetRotation_=r,this.targetCenter_=a,void this.applyTargetState_();n=n||(0===t?this.cancelAnchor_:void 0),this.cancelAnchor_=void 0,this.getResolution()===o&&this.getRotation()===r&&this.getCenterInternal()&&de(this.getCenterInternal(),a)||(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:r,center:a,resolution:o,duration:t,easing:rn,anchor:n}))}beginInteraction(){this.resolveConstraints(0),this.setHint(1,1)}endInteraction(t,e,n){n=n&&qe(n,this.getProjection()),this.endInteractionInternal(t,e,n)}endInteractionInternal(t,e,n){this.getInteracting()&&(this.setHint(1,-1),this.resolveConstraints(t,e,n))}getConstrainedCenter(t,e){const n=this.getViewportSize_(this.getRotation());return this.constraints_.center(t,e||this.getResolution(),n)}getConstrainedZoom(t,e){const n=this.getResolutionForZoom(t);return this.getZoomForResolution(this.getConstrainedResolution(n,e))}getConstrainedResolution(t,e){e=e||0;const n=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(t,e,n)}};function hi(t,e){if(!t.visible)return!1;const n=e.resolution;if(n<t.minResolution||n>=t.maxResolution)return!1;const i=e.zoom;return i>t.minZoom&&i<=t.maxZoom}const ui=class extends lt{constructor(t){const e=Object.assign({},t);delete e.source,super(e),this.on,this.once,this.un,this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,this.renderer_=null,this.sourceReady_=!1,this.rendered=!1,t.render&&(this.render=t.render),t.map&&this.setMap(t.map),this.addChangeListener(Z,this.handleSourcePropertyChange_);const n=t.source?t.source:null;this.setSource(n)}getLayersArray(t){return(t=t||[]).push(this),t}getLayerStatesArray(t){return(t=t||[]).push(this.getLayerState()),t}getSource(){return this.get(Z)||null}getRenderSource(){return this.getSource()}getSourceState(){const t=this.getSource();return t?t.getState():"undefined"}handleSourceChange_(){this.changed(),this.sourceReady_||"ready"!==this.getSource().getState()||(this.sourceReady_=!0,this.dispatchEvent("sourceready"))}handleSourcePropertyChange_(){this.sourceChangeKey_&&(P(this.sourceChangeKey_),this.sourceChangeKey_=null),this.sourceReady_=!1;const t=this.getSource();t&&(this.sourceChangeKey_=M(t,x,this.handleSourceChange_,this),"ready"===t.getState()&&(this.sourceReady_=!0,setTimeout((()=>{this.dispatchEvent("sourceready")}),0))),this.changed()}getFeatures(t){return this.renderer_?this.renderer_.getFeatures(t):Promise.resolve([])}getData(t){return this.renderer_&&this.rendered?this.renderer_.getData(t):null}isVisible(t){let e;const n=this.getMapInternal();let i;!t&&n&&(t=n.getView()),e=t instanceof li?{viewState:t.getState(),extent:t.calculateExtent()}:t,!e.layerStatesArray&&n&&(e.layerStatesArray=n.getLayerGroup().getLayerStatesArray()),i=e.layerStatesArray?e.layerStatesArray.find((t=>t.layer===this)):this.getLayerState();const r=this.getExtent();return hi(i,e.viewState)&&(!r||he(r,e.extent))}getAttributions(t){if(!this.isVisible(t))return[];let e;const n=this.getSource();if(n&&(e=n.getAttributions()),!e)return[];let i=e(t instanceof li?t.getViewStateAndExtent():t);return Array.isArray(i)||(i=[i]),i}render(t,e){const n=this.getRenderer();return n.prepareFrame(t)?(this.rendered=!0,n.renderFrame(t,e)):null}unrender(){this.rendered=!1}getDeclutter(){}renderDeclutter(t,e){}renderDeferred(t){const e=this.getRenderer();e&&e.renderDeferred(t)}setMapInternal(t){t||this.unrender(),this.set("map",t)}getMapInternal(){return this.get("map")}setMap(t){this.mapPrecomposeKey_&&(P(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),t||this.changed(),this.mapRenderKey_&&(P(this.mapRenderKey_),this.mapRenderKey_=null),t&&(this.mapPrecomposeKey_=M(t,ct,(function(t){const e=t.frameState.layerStatesArray,n=this.getLayerState(!1);K(!e.some((function(t){return t.layer===n.layer})),"A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both."),e.push(n)}),this),this.mapRenderKey_=M(this,x,t.render,t),this.changed())}setSource(t){this.set(Z,t)}getRenderer(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_}hasRenderer(){return!!this.renderer_}createRenderer(){return null}disposeInternal(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_),this.setSource(null),super.disposeInternal()}};var ci=__webpack_require__(2582);const fi=0,di=1,gi=2,pi=3,mi=4;function yi(t){return t[0]>0&&t[1]>0}function vi(t,e,n){return void 0===n&&(n=[0,0]),n[0]=t[0]*e+.5|0,n[1]=t[1]*e+.5|0,n}function wi(t,e){return Array.isArray(t)?t:(void 0===e?e=[t,t]:(e[0]=t,e[1]=t),e)}class xi{constructor(t){this.opacity_=t.opacity,this.rotateWithView_=t.rotateWithView,this.rotation_=t.rotation,this.scale_=t.scale,this.scaleArray_=wi(t.scale),this.displacement_=t.displacement,this.declutterMode_=t.declutterMode}clone(){const t=this.getScale();return new xi({opacity:this.getOpacity(),scale:Array.isArray(t)?t.slice():t,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getOpacity(){return this.opacity_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getDisplacement(){return this.displacement_}getDeclutterMode(){return this.declutterMode_}getAnchor(){return A()}getImage(t){return A()}getHitDetectionImage(){return A()}getPixelRatio(t){return 1}getImageState(){return A()}getImageSize(){return A()}getOrigin(){return A()}getSize(){return A()}setDisplacement(t){this.displacement_=t}setOpacity(t){this.opacity_=t}setRotateWithView(t){this.rotateWithView_=t}setRotation(t){this.rotation_=t}setScale(t){this.scale_=t,this.scaleArray_=wi(t)}listenImageChange(t){A()}load(){A()}unlistenImageChange(t){A()}ready(){return Promise.resolve()}}const _i=xi,bi={name:"rgb",min:[0,0,0],max:[255,255,255],channel:["red","green","blue"],alias:["RGB"]};var Ei={name:"xyz",min:[0,0,0],channel:["X","Y","Z"],alias:["XYZ","ciexyz","cie1931"],whitepoint:{2:{A:[109.85,100,35.585],C:[98.074,100,118.232],D50:[96.422,100,82.521],D55:[95.682,100,92.149],D65:[95.045592705167,100,108.9057750759878],D75:[94.972,100,122.638],F2:[99.187,100,67.395],F7:[95.044,100,108.755],F11:[100.966,100,64.37],E:[100,100,100]},10:{A:[111.144,100,35.2],C:[97.285,100,116.145],D50:[96.72,100,81.427],D55:[95.799,100,90.926],D65:[94.811,100,107.304],D75:[94.416,100,120.641],F2:[103.28,100,69.026],F7:[95.792,100,107.687],F11:[103.866,100,65.627],E:[100,100,100]}}};Ei.max=Ei.whitepoint[2].D65,Ei.rgb=function(t,e){e=e||Ei.whitepoint[2].E;var n,i,r,s=t[0]/e[0],o=t[1]/e[1],a=t[2]/e[2];return i=-.96924363628087*s+1.87596750150772*o+.041555057407175*a,r=.055630079696993*s+-.20397695888897*o+1.056971514242878*a,n=(n=3.240969941904521*s+-1.537383177570093*o+-.498610760293*a)>.0031308?1.055*Math.pow(n,1/2.4)-.055:n*=12.92,i=i>.0031308?1.055*Math.pow(i,1/2.4)-.055:i*=12.92,r=r>.0031308?1.055*Math.pow(r,1/2.4)-.055:r*=12.92,[255*(n=Math.min(Math.max(0,n),1)),255*(i=Math.min(Math.max(0,i),1)),255*(r=Math.min(Math.max(0,r),1))]},bi.xyz=function(t,e){var n=t[0]/255,i=t[1]/255,r=t[2]/255,s=.21263900587151*(n=n>.04045?Math.pow((n+.055)/1.055,2.4):n/12.92)+.71516867876775*(i=i>.04045?Math.pow((i+.055)/1.055,2.4):i/12.92)+.072192315360733*(r=r>.04045?Math.pow((r+.055)/1.055,2.4):r/12.92),o=.019330818715591*n+.11919477979462*i+.95053215224966*r;return[(.41239079926595*n+.35758433938387*i+.18048078840183*r)*(e=e||Ei.whitepoint[2].E)[0],s*e[1],o*e[2]]};const Si=Ei,Ii={name:"luv",min:[0,-134,-140],max:[100,224,122],channel:["lightness","u","v"],alias:["LUV","cieluv","cie1976"],xyz:function(t,e,n){var i,r,s,o,a,l,h,u,c;return s=t[0],o=t[1],a=t[2],0===s?[0,0,0]:(e=e||"D65",n=n||2,i=o/(13*s)+4*(h=Si.whitepoint[n][e][0])/(h+15*(u=Si.whitepoint[n][e][1])+3*(c=Si.whitepoint[n][e][2]))||0,r=a/(13*s)+9*u/(h+15*u+3*c)||0,[9*(l=s>8?u*Math.pow((s+16)/116,3):u*s*.0011070564598794539)*i/(4*r)||0,l,l*(12-3*i-20*r)/(4*r)||0])}};Si.luv=function(t,e,n){var i,r,s,o,a,l,h,u,c,f,d;e=e||"D65",n=n||2,f=4*(h=Si.whitepoint[n][e][0])/(h+15*(u=Si.whitepoint[n][e][1])+3*(c=Si.whitepoint[n][e][2])),d=9*u/(h+15*u+3*c),i=4*(o=t[0])/(o+15*(a=t[1])+3*(l=t[2]))||0,r=9*a/(o+15*a+3*l)||0;var g=a/u;return[s=g<=.008856451679035631?903.2962962962961*g:116*Math.pow(g,1/3)-16,13*s*(i-f),13*s*(r-d)]};var Ci={name:"lchuv",channel:["lightness","chroma","hue"],alias:["LCHuv","cielchuv"],min:[0,0,0],max:[100,100,360],luv:function(t){var e,n=t[0],i=t[1];return e=t[2]/360*2*Math.PI,[n,i*Math.cos(e),i*Math.sin(e)]},xyz:function(t){return Ii.xyz(Ci.luv(t))}};const Mi=Ci;Ii.lchuv=function(t){var e=t[0],n=t[1],i=t[2],r=Math.sqrt(n*n+i*i),s=360*Math.atan2(i,n)/2/Math.PI;return s<0&&(s+=360),[e,r,s]},Si.lchuv=function(t){return Ii.lchuv(Si.luv(t))};var Ri=__webpack_require__(8874);const Pi=function(t){var e,n,i=[],r=1;if("number"==typeof t)return{space:"rgb",values:[t>>>16,(65280&t)>>>8,255&t],alpha:1};if("number"==typeof t)return{space:"rgb",values:[t>>>16,(65280&t)>>>8,255&t],alpha:1};if(t=String(t).toLowerCase(),Ri[t])i=Ri[t].slice(),n="rgb";else if("transparent"===t)r=0,n="rgb",i=[0,0,0];else if("#"===t[0]){var s=t.slice(1),o=s.length;r=1,o<=4?(i=[parseInt(s[0]+s[0],16),parseInt(s[1]+s[1],16),parseInt(s[2]+s[2],16)],4===o&&(r=parseInt(s[3]+s[3],16)/255)):(i=[parseInt(s[0]+s[1],16),parseInt(s[2]+s[3],16),parseInt(s[4]+s[5],16)],8===o&&(r=parseInt(s[6]+s[7],16)/255)),i[0]||(i[0]=0),i[1]||(i[1]=0),i[2]||(i[2]=0),n="rgb"}else if(e=/^((?:rgba?|hs[lvb]a?|hwba?|cmyk?|xy[zy]|gray|lab|lchu?v?|[ly]uv|lms|oklch|oklab|color))\s*\(([^\)]*)\)/.exec(t)){var a=e[1],l="cmyk"===(n=a.replace(/a$/,""))?4:"gray"===n?1:3;i=e[2].trim().split(/\s*[,\/]\s*|\s+/),"color"===n&&(n=i.shift()),r=(i=i.map((function(t,e){if("%"===t[t.length-1])return t=parseFloat(t)/100,3===e?t:"rgb"===n?255*t:"h"===n[0]?100*t:"l"!==n[0]||e?"lab"===n?125*t:"lch"===n?e<2?150*t:360*t:"o"!==n[0]||e?"oklab"===n?.4*t:"oklch"===n?e<2?.4*t:360*t:t:t:100*t;if("h"===n[e]||2===e&&"h"===n[n.length-1]){if(void 0!==Ti[t])return Ti[t];if(t.endsWith("deg"))return parseFloat(t);if(t.endsWith("turn"))return 360*parseFloat(t);if(t.endsWith("grad"))return 360*parseFloat(t)/400;if(t.endsWith("rad"))return 180*parseFloat(t)/Math.PI}return"none"===t?0:parseFloat(t)}))).length>l?i.pop():1}else/[0-9](?:\s|\/|,)/.test(t)&&(i=t.match(/([0-9]+)/g).map((function(t){return parseFloat(t)})),n=t.match(/([a-z])/gi)?.join("")?.toLowerCase()||"rgb");return{space:n,values:i,alpha:r}};var Ti={red:0,orange:60,yellow:120,green:180,blue:240,purple:300};const Ni={name:"hsl",min:[0,0,0],max:[360,100,100],channel:["hue","saturation","lightness"],alias:["HSL"],rgb:function(t){var e,n,i,r,s,o=t[0]/360,a=t[1]/100,l=t[2]/100,h=0;if(0===a)return[s=255*l,s,s];for(e=2*l-(n=l<.5?l*(1+a):l+a-l*a),r=[0,0,0];h<3;)(i=o+1/3*-(h-1))<0?i++:i>1&&i--,s=6*i<1?e+6*(n-e)*i:2*i<1?n:3*i<2?e+(n-e)*(2/3-i)*6:e,r[h++]=255*s;return r}};bi.hsl=function(t){var e,n,i=t[0]/255,r=t[1]/255,s=t[2]/255,o=Math.min(i,r,s),a=Math.max(i,r,s),l=a-o;return a===o?e=0:i===a?e=(r-s)/l:r===a?e=2+(s-i)/l:s===a&&(e=4+(i-r)/l),(e=Math.min(60*e,360))<0&&(e+=360),n=(o+a)/2,[e,100*(a===o?0:n<=.5?l/(a+o):l/(2-a-o)),100*n]};const Ai=1024,ki={};let Li=0;function Oi(t){if(4===t.length)return t;const e=t.slice();return e[3]=1,e}function Di(t){const e=Si.lchuv(bi.xyz(t));return e[3]=t[3],e}function Fi(t){if(ki.hasOwnProperty(t))return ki[t];if(Li>=Ai){let t=0;for(const e in ki)0==(3&t++)&&(delete ki[e],--Li)}const e=function(t){var e;Array.isArray(t)&&t.raw&&(t=String.raw(...arguments)),t instanceof Number&&(t=+t);var n=Pi(t);if(!n.space)return[];const i="h"===n.space[0]?Ni.min:bi.min,r="h"===n.space[0]?Ni.max:bi.max;return(e=Array(3))[0]=Math.min(Math.max(n.values[0],i[0]),r[0]),e[1]=Math.min(Math.max(n.values[1],i[1]),r[1]),e[2]=Math.min(Math.max(n.values[2],i[2]),r[2]),"h"===n.space[0]&&(e=Ni.rgb(e)),e.push(Math.min(Math.max(n.alpha,0),1)),e}(t);if(4!==e.length)throw new Error('Failed to parse "'+t+'" as color');for(const n of e)if(isNaN(n))throw new Error('Failed to parse "'+t+'" as color');return Gi(e),ki[t]=e,++Li,e}function zi(t){return Array.isArray(t)?t:Fi(t)}function Gi(t){return t[0]=J(t[0]+.5|0,0,255),t[1]=J(t[1]+.5|0,0,255),t[2]=J(t[2]+.5|0,0,255),t[3]=J(t[3],0,1),t}function Bi(t){let e=t[0];e!=(0|e)&&(e=e+.5|0);let n=t[1];n!=(0|n)&&(n=n+.5|0);let i=t[2];return i!=(0|i)&&(i=i+.5|0),"rgba("+e+","+n+","+i+","+(void 0===t[3]?1:Math.round(1e3*t[3])/1e3)+")"}const Ui="undefined"!=typeof navigator&&void 0!==navigator.userAgent?navigator.userAgent.toLowerCase():"",qi=Ui.includes("firefox"),Vi=(Ui.includes("safari")&&!Ui.includes("chrom")&&(Ui.includes("version/15.4")||/cpu (os|iphone os) 15_4 like mac os x/.test(Ui)),Ui.includes("webkit")&&!Ui.includes("edge")),Yi=Ui.includes("macintosh"),Xi="undefined"!=typeof devicePixelRatio?devicePixelRatio:1,ji="undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof OffscreenCanvas&&self instanceof WorkerGlobalScope,Wi="undefined"!=typeof Image&&Image.prototype.decode,Hi=function(){let t=!1;try{const e=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("_",null,e),window.removeEventListener("_",null,e)}catch(t){}return t}();function $i(t,e,n,i){let r;return r=n&&n.length?n.shift():ji?new OffscreenCanvas(t||300,e||300):document.createElement("canvas"),t&&(r.width=t),e&&(r.height=e),r.getContext("2d",i)}let Zi;function Ki(){return Zi||(Zi=$i(1,1)),Zi}function Ji(t){const e=t.canvas;e.width=1,e.height=1,t.clearRect(0,0,1,1)}function Qi(t,e){const n=e.parentNode;n&&n.replaceChild(t,e)}function tr(t){return t&&t.parentNode?t.parentNode.removeChild(t):null}const er=class extends w{constructor(t,e,n,i){super(),this.extent=t,this.pixelRatio_=n,this.resolution=e,this.state="function"==typeof i?fi:i,this.image_=null,this.loader="function"==typeof i?i:null}changed(){this.dispatchEvent(x)}getExtent(){return this.extent}getImage(){return this.image_}getPixelRatio(){return this.pixelRatio_}getResolution(){return this.resolution}getState(){return this.state}load(){if(this.state==fi&&this.loader){this.state=di,this.changed();const t=this.getResolution(),e=Array.isArray(t)?t[0]:t;m((()=>this.loader(this.getExtent(),e,this.getPixelRatio()))).then((t=>{"image"in t&&(this.image_=t.image),"extent"in t&&(this.extent=t.extent),"resolution"in t&&(this.resolution=t.resolution),"pixelRatio"in t&&(this.pixelRatio_=t.pixelRatio),(t instanceof HTMLImageElement||t instanceof ImageBitmap||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement)&&(this.image_=t),this.state=gi})).catch((t=>{this.state=pi,console.error(t)})).finally((()=>this.changed()))}}setImage(t){this.image_=t}setResolution(t){this.resolution=t}};function nr(t,e,n){return e+":"+t+":"+(n?zi(n):"null")}const ir=new class{constructor(){this.cache_={},this.patternCache_={},this.cacheSize_=0,this.maxCacheSize_=32}clear(){this.cache_={},this.patternCache_={},this.cacheSize_=0}canExpireCache(){return this.cacheSize_>this.maxCacheSize_}expire(){if(this.canExpireCache()){let t=0;for(const e in this.cache_){const n=this.cache_[e];0!=(3&t++)||n.hasListener()||(delete this.cache_[e],delete this.patternCache_[e],--this.cacheSize_)}}}get(t,e,n){const i=nr(t,e,n);return i in this.cache_?this.cache_[i]:null}getPattern(t,e,n){const i=nr(t,e,n);return i in this.patternCache_?this.patternCache_[i]:null}set(t,e,n,i,r){const s=nr(t,e,n),o=s in this.cache_;this.cache_[s]=i,r&&(i.getImageState()===fi&&i.load(),i.getImageState()===di?i.ready().then((()=>{this.patternCache_[s]=Ki().createPattern(i.getImage(1),"repeat")})):this.patternCache_[s]=Ki().createPattern(i.getImage(1),"repeat")),o||++this.cacheSize_}setSize(t){this.maxCacheSize_=t,this.expire()}};let rr=null;class sr extends w{constructor(t,e,n,i,r){super(),this.hitDetectionImage_=null,this.image_=t,this.crossOrigin_=n,this.canvas_={},this.color_=r,this.imageState_=void 0===i?fi:i,this.size_=t&&t.width&&t.height?[t.width,t.height]:null,this.src_=e,this.tainted_,this.ready_=null}initializeImage_(){this.image_=new Image,null!==this.crossOrigin_&&(this.image_.crossOrigin=this.crossOrigin_)}isTainted_(){if(void 0===this.tainted_&&this.imageState_===gi){rr||(rr=$i(1,1,void 0,{willReadFrequently:!0})),rr.drawImage(this.image_,0,0);try{rr.getImageData(0,0,1,1),this.tainted_=!1}catch(t){rr=null,this.tainted_=!0}}return!0===this.tainted_}dispatchChangeEvent_(){this.dispatchEvent(x)}handleImageError_(){this.imageState_=pi,this.dispatchChangeEvent_()}handleImageLoad_(){this.imageState_=gi,this.size_=[this.image_.width,this.image_.height],this.dispatchChangeEvent_()}getImage(t){return this.image_||this.initializeImage_(),this.replaceColor_(t),this.canvas_[t]?this.canvas_[t]:this.image_}getPixelRatio(t){return this.replaceColor_(t),this.canvas_[t]?t:1}getImageState(){return this.imageState_}getHitDetectionImage(){if(this.image_||this.initializeImage_(),!this.hitDetectionImage_)if(this.isTainted_()){const t=this.size_[0],e=this.size_[1],n=$i(t,e);n.fillRect(0,0,t,e),this.hitDetectionImage_=n.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_}getSize(){return this.size_}getSrc(){return this.src_}load(){if(this.imageState_===fi){this.image_||this.initializeImage_(),this.imageState_=di;try{void 0!==this.src_&&(this.image_.src=this.src_)}catch(t){this.handleImageError_()}this.image_ instanceof HTMLImageElement&&function(t,e){return e&&(t.src=e),t.src&&Wi?new Promise(((e,n)=>t.decode().then((()=>e(t))).catch((i=>t.complete&&t.width?e(t):n(i))))):function(t,e){return new Promise(((e,n)=>{function i(){s(),e(t)}function r(){s(),n(new Error("Image load error"))}function s(){t.removeEventListener("load",i),t.removeEventListener("error",r)}t.addEventListener("load",i),t.addEventListener("error",r)}))}(t)}(this.image_,this.src_).then((t=>{this.image_=t,this.handleImageLoad_()})).catch(this.handleImageError_.bind(this))}}replaceColor_(t){if(!this.color_||this.canvas_[t]||this.imageState_!==gi)return;const e=this.image_,n=document.createElement("canvas");n.width=Math.ceil(e.width*t),n.height=Math.ceil(e.height*t);const i=n.getContext("2d");i.scale(t,t),i.drawImage(e,0,0),i.globalCompositeOperation="multiply",i.fillStyle=function(t){return"string"==typeof t?t:Bi(t)}(this.color_),i.fillRect(0,0,n.width/t,n.height/t),i.globalCompositeOperation="destination-in",i.drawImage(e,0,0),this.canvas_[t]=n}ready(){return this.ready_||(this.ready_=new Promise((t=>{this.imageState_===gi||this.imageState_===pi?t():this.addEventListener(x,(function e(){this.imageState_!==gi&&this.imageState_!==pi||(this.removeEventListener(x,e),t())}))}))),this.ready_}}function or(t,e,n,i,r,s){let o=void 0===e?void 0:ir.get(e,n,r);return o||(o=new sr(t,t instanceof HTMLImageElement?t.src||void 0:e,n,i,r),ir.set(e,n,r,o,s)),s&&o&&!ir.getPattern(e,n,r)&&ir.set(e,n,r,o,s),o}function ar(t){return t?Array.isArray(t)?Bi(t):"object"==typeof t&&"src"in t?function(t){if(!t.offset||!t.size)return ir.getPattern(t.src,"anonymous",t.color);const e=t.src+":"+t.offset,n=ir.getPattern(e,void 0,t.color);if(n)return n;const i=ir.get(t.src,"anonymous",null);if(i.getImageState()!==gi)return null;const r=$i(t.size[0],t.size[1]);return r.drawImage(i.getImage(1),t.offset[0],t.offset[1],t.size[0],t.size[1],0,0,t.size[0],t.size[1]),or(r.canvas,e,void 0,gi,t.color,!0),ir.getPattern(e,void 0,t.color)}(t):t:null}const lr="ol-hidden",hr="ol-unselectable",ur="ol-control",cr="ol-collapsed",fr=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))","?\\s*([-,\\\"\\'\\sa-z]+?)\\s*$"].join(""),"i"),dr=["style","variant","weight","size","lineHeight","family"],gr=function(t){const e=t.match(fr);if(!e)return null;const n={lineHeight:"normal",size:"1.2em",style:"normal",weight:"normal",variant:"normal"};for(let t=0,i=dr.length;t<i;++t){const i=e[t+1];void 0!==i&&(n[dr[t]]=i)}return n.families=n.family.split(/,\s?/),n},pr="10px sans-serif",mr="#000",yr="round",vr=[],wr="round",xr="#000",_r="center",br="middle",Er=[0,0,0,0],Sr=new D;let Ir,Cr=null;const Mr={},Rr=function(){const t="32px ",e=["monospace","serif"],n=e.length,i="wmytzilWMYTZIL@#/&?$%10";let r,s;function o(r,o,a){let l=!0;for(let h=0;h<n;++h){const n=e[h];if(s=Nr(r+" "+o+" "+t+n,i),a!=n){const e=Nr(r+" "+o+" "+t+a+","+n,i);l=l&&e!=s}}return!!l}function a(){let t=!0;const e=Sr.getKeys();for(let n=0,i=e.length;n<i;++n){const i=e[n];Sr.get(i)<100&&(o.apply(this,i.split("\n"))?(y(Mr),Cr=null,Ir=void 0,Sr.set(i,100)):(Sr.set(i,Sr.get(i)+1,!0),t=!1))}t&&(clearInterval(r),r=void 0)}return function(t){const e=gr(t);if(!e)return;const n=e.families;for(let t=0,i=n.length;t<i;++t){const i=n[t],s=e.style+"\n"+e.weight+"\n"+i;void 0===Sr.get(s)&&(Sr.set(s,100,!0),o(e.style,e.weight,i)||(Sr.set(s,0,!0),void 0===r&&(r=setInterval(a,32))))}}}(),Pr=function(){let t;return function(e){let n=Mr[e];if(null==n){if(ji){const t=gr(e),i=Tr(e,"g");n=(isNaN(Number(t.lineHeight))?1.2:Number(t.lineHeight))*(i.actualBoundingBoxAscent+i.actualBoundingBoxDescent)}else t||(t=document.createElement("div"),t.innerHTML="M",t.style.minHeight="0",t.style.maxHeight="none",t.style.height="auto",t.style.padding="0",t.style.border="none",t.style.position="absolute",t.style.display="block",t.style.left="-99999px"),t.style.font=e,document.body.appendChild(t),n=t.offsetHeight,document.body.removeChild(t);Mr[e]=n}return n}}();function Tr(t,e){return Cr||(Cr=$i(1,1)),t!=Ir&&(Cr.font=t,Ir=Cr.font),Cr.measureText(e)}function Nr(t,e){return Tr(t,e).width}function Ar(t,e,n){if(e in n)return n[e];const i=e.split("\n").reduce(((e,n)=>Math.max(e,Nr(t,n))),0);return n[e]=i,i}class kr extends _i{constructor(t){super({opacity:1,rotateWithView:void 0!==t.rotateWithView&&t.rotateWithView,rotation:void 0!==t.rotation?t.rotation:0,scale:void 0!==t.scale?t.scale:1,displacement:void 0!==t.displacement?t.displacement:[0,0],declutterMode:t.declutterMode}),this.canvases_,this.hitDetectionCanvas_=null,this.fill_=void 0!==t.fill?t.fill:null,this.origin_=[0,0],this.points_=t.points,this.radius_=t.radius,this.radius2_=t.radius2,this.angle_=void 0!==t.angle?t.angle:0,this.stroke_=void 0!==t.stroke?t.stroke:null,this.size_,this.renderOptions_,this.imageState_=this.fill_&&this.fill_.loading()?di:gi,this.imageState_===di&&this.ready().then((()=>this.imageState_=gi)),this.render()}clone(){const t=this.getScale(),e=new kr({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(t)?t.slice():t,displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return e.setOpacity(this.getOpacity()),e}getAnchor(){const t=this.size_,e=this.getDisplacement(),n=this.getScaleArray();return[t[0]/2-e[0]/n[0],t[1]/2+e[1]/n[1]]}getAngle(){return this.angle_}getFill(){return this.fill_}setFill(t){this.fill_=t,this.render()}getHitDetectionImage(){return this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.createHitDetectionCanvas_(this.renderOptions_)),this.hitDetectionCanvas_}getImage(t){let e=this.canvases_[t];if(!e){const n=this.renderOptions_,i=$i(n.size*t,n.size*t);this.draw_(n,i,t),e=i.canvas,this.canvases_[t]=e}return e}getPixelRatio(t){return t}getImageSize(){return this.size_}getImageState(){return this.imageState_}getOrigin(){return this.origin_}getPoints(){return this.points_}getRadius(){return this.radius_}getRadius2(){return this.radius2_}getSize(){return this.size_}getStroke(){return this.stroke_}setStroke(t){this.stroke_=t,this.render()}listenImageChange(t){}load(){}unlistenImageChange(t){}calculateLineJoinSize_(t,e,n){if(0===e||this.points_===1/0||"bevel"!==t&&"miter"!==t)return e;let i=this.radius_,r=void 0===this.radius2_?i:this.radius2_;if(i<r){const t=i;i=r,r=t}const s=void 0===this.radius2_?this.points_:2*this.points_,o=2*Math.PI/s,a=r*Math.sin(o),l=i-Math.sqrt(r*r-a*a),h=Math.sqrt(a*a+l*l),u=h/a;if("miter"===t&&u<=n)return u*e;const c=e/2/u,f=e/2*(l/h),d=Math.sqrt((i+c)*(i+c)+f*f)-i;if(void 0===this.radius2_||"bevel"===t)return 2*d;const g=i*Math.sin(o),p=r-Math.sqrt(i*i-g*g),m=Math.sqrt(g*g+p*p)/g;if(m<=n){const t=m*e/2-r-i;return 2*Math.max(d,t)}return 2*d}createRenderOptions(){let t,e=yr,n=wr,i=0,r=null,s=0,o=0;this.stroke_&&(t=ar(this.stroke_.getColor()??xr),o=this.stroke_.getWidth()??1,r=this.stroke_.getLineDash(),s=this.stroke_.getLineDashOffset()??0,n=this.stroke_.getLineJoin()??wr,e=this.stroke_.getLineCap()??yr,i=this.stroke_.getMiterLimit()??10);const a=this.calculateLineJoinSize_(n,o,i),l=Math.max(this.radius_,this.radius2_||0);return{strokeStyle:t,strokeWidth:o,size:Math.ceil(2*l+a),lineCap:e,lineDash:r,lineDashOffset:s,lineJoin:n,miterLimit:i}}render(){this.renderOptions_=this.createRenderOptions();const t=this.renderOptions_.size;this.canvases_={},this.hitDetectionCanvas_=null,this.size_=[t,t]}draw_(t,e,n){if(e.scale(n,n),e.translate(t.size/2,t.size/2),this.createPath_(e),this.fill_){let t=this.fill_.getColor();null===t&&(t=mr),e.fillStyle=ar(t),e.fill()}t.strokeStyle&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineCap=t.lineCap,e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit,e.stroke())}createHitDetectionCanvas_(t){let e;if(this.fill_){let n=this.fill_.getColor(),i=0;"string"==typeof n&&(n=zi(n)),null===n?i=1:Array.isArray(n)&&(i=4===n.length?n[3]:1),0===i&&(e=$i(t.size,t.size),this.drawHitDetectionCanvas_(t,e))}return e?e.canvas:this.getImage(1)}createPath_(t){let e=this.points_;const n=this.radius_;if(e===1/0)t.arc(0,0,n,0,2*Math.PI);else{const i=void 0===this.radius2_?n:this.radius2_;void 0!==this.radius2_&&(e*=2);const r=this.angle_-Math.PI/2,s=2*Math.PI/e;for(let o=0;o<e;o++){const e=r+o*s,a=o%2==0?n:i;t.lineTo(a*Math.cos(e),a*Math.sin(e))}t.closePath()}}drawHitDetectionCanvas_(t,e){e.translate(t.size/2,t.size/2),this.createPath_(e),e.fillStyle=mr,e.fill(),t.strokeStyle&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit,e.stroke())}ready(){return this.fill_?this.fill_.ready():Promise.resolve()}}const Lr=kr;class Or extends Lr{constructor(t){super({points:1/0,fill:(t=t||{radius:5}).fill,radius:t.radius,stroke:t.stroke,scale:void 0!==t.scale?t.scale:1,rotation:void 0!==t.rotation?t.rotation:0,rotateWithView:void 0!==t.rotateWithView&&t.rotateWithView,displacement:void 0!==t.displacement?t.displacement:[0,0],declutterMode:t.declutterMode})}clone(){const t=this.getScale(),e=new Or({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(t)?t.slice():t,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return e.setOpacity(this.getOpacity()),e}setRadius(t){this.radius_=t,this.render()}}const Dr=Or;class Fr{constructor(t){t=t||{},this.patternImage_=null,this.color_=null,void 0!==t.color&&this.setColor(t.color)}clone(){const t=this.getColor();return new Fr({color:Array.isArray(t)?t.slice():t||void 0})}getColor(){return this.color_}setColor(t){if(null!==t&&"object"==typeof t&&"src"in t){const e=or(null,t.src,"anonymous",void 0,t.offset?null:t.color?t.color:null,!(t.offset&&t.size));e.ready().then((()=>{this.patternImage_=null})),e.getImageState()===fi&&e.load(),e.getImageState()===di&&(this.patternImage_=e)}this.color_=t}loading(){return!!this.patternImage_}ready(){return this.patternImage_?this.patternImage_.ready():Promise.resolve()}}const zr=Fr;class Gr{constructor(t){t=t||{},this.color_=void 0!==t.color?t.color:null,this.lineCap_=t.lineCap,this.lineDash_=void 0!==t.lineDash?t.lineDash:null,this.lineDashOffset_=t.lineDashOffset,this.lineJoin_=t.lineJoin,this.miterLimit_=t.miterLimit,this.width_=t.width}clone(){const t=this.getColor();return new Gr({color:Array.isArray(t)?t.slice():t||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})}getColor(){return this.color_}getLineCap(){return this.lineCap_}getLineDash(){return this.lineDash_}getLineDashOffset(){return this.lineDashOffset_}getLineJoin(){return this.lineJoin_}getMiterLimit(){return this.miterLimit_}getWidth(){return this.width_}setColor(t){this.color_=t}setLineCap(t){this.lineCap_=t}setLineDash(t){this.lineDash_=t}setLineDashOffset(t){this.lineDashOffset_=t}setLineJoin(t){this.lineJoin_=t}setMiterLimit(t){this.miterLimit_=t}setWidth(t){this.width_=t}}const Br=Gr;class Ur{constructor(t){t=t||{},this.geometry_=null,this.geometryFunction_=Yr,void 0!==t.geometry&&this.setGeometry(t.geometry),this.fill_=void 0!==t.fill?t.fill:null,this.image_=void 0!==t.image?t.image:null,this.renderer_=void 0!==t.renderer?t.renderer:null,this.hitDetectionRenderer_=void 0!==t.hitDetectionRenderer?t.hitDetectionRenderer:null,this.stroke_=void 0!==t.stroke?t.stroke:null,this.text_=void 0!==t.text?t.text:null,this.zIndex_=t.zIndex}clone(){let t=this.getGeometry();return t&&"object"==typeof t&&(t=t.clone()),new Ur({geometry:t??void 0,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:this.getRenderer()??void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})}getRenderer(){return this.renderer_}setRenderer(t){this.renderer_=t}setHitDetectionRenderer(t){this.hitDetectionRenderer_=t}getHitDetectionRenderer(){return this.hitDetectionRenderer_}getGeometry(){return this.geometry_}getGeometryFunction(){return this.geometryFunction_}getFill(){return this.fill_}setFill(t){this.fill_=t}getImage(){return this.image_}setImage(t){this.image_=t}getStroke(){return this.stroke_}setStroke(t){this.stroke_=t}getText(){return this.text_}setText(t){this.text_=t}getZIndex(){return this.zIndex_}setGeometry(t){"function"==typeof t?this.geometryFunction_=t:"string"==typeof t?this.geometryFunction_=function(e){return e.get(t)}:t?void 0!==t&&(this.geometryFunction_=function(){return t}):this.geometryFunction_=Yr,this.geometry_=t}setZIndex(t){this.zIndex_=t}}let qr=null;function Vr(t,e){if(!qr){const t=new zr({color:"rgba(255,255,255,0.4)"}),e=new Br({color:"#3399CC",width:1.25});qr=[new Ur({image:new Dr({fill:t,stroke:e,radius:5}),fill:t,stroke:e})]}return qr}function Yr(t){return t.getGeometry()}const Xr=Ur;function jr(t,e,n,i){return void 0!==n&&void 0!==i?[n/t,i/e]:void 0!==n?n/t:void 0!==i?i/e:1}class Wr extends _i{constructor(t){const e=void 0!==(t=t||{}).opacity?t.opacity:1,n=void 0!==t.rotation?t.rotation:0,i=void 0!==t.scale?t.scale:1,r=void 0!==t.rotateWithView&&t.rotateWithView;super({opacity:e,rotation:n,scale:i,displacement:void 0!==t.displacement?t.displacement:[0,0],rotateWithView:r,declutterMode:t.declutterMode}),this.anchor_=void 0!==t.anchor?t.anchor:[.5,.5],this.normalizedAnchor_=null,this.anchorOrigin_=void 0!==t.anchorOrigin?t.anchorOrigin:"top-left",this.anchorXUnits_=void 0!==t.anchorXUnits?t.anchorXUnits:"fraction",this.anchorYUnits_=void 0!==t.anchorYUnits?t.anchorYUnits:"fraction",this.crossOrigin_=void 0!==t.crossOrigin?t.crossOrigin:null;const s=void 0!==t.img?t.img:null;let o,a=t.src;if(K(!(void 0!==a&&s),"`image` and `src` cannot be provided at the same time"),void 0!==a&&0!==a.length||!s||(a=s.src||L(s)),K(void 0!==a&&a.length>0,"A defined and non-empty `src` or `image` must be provided"),K(!((void 0!==t.width||void 0!==t.height)&&void 0!==t.scale),"`width` or `height` cannot be provided together with `scale`"),void 0!==t.src?o=fi:void 0!==s&&(o=s instanceof HTMLImageElement?s.complete?s.src?gi:fi:di:gi),this.color_=void 0!==t.color?zi(t.color):null,this.iconImage_=or(s,a,this.crossOrigin_,o,this.color_),this.offset_=void 0!==t.offset?t.offset:[0,0],this.offsetOrigin_=void 0!==t.offsetOrigin?t.offsetOrigin:"top-left",this.origin_=null,this.size_=void 0!==t.size?t.size:null,void 0!==t.width||void 0!==t.height){let e,n;if(t.size)[e,n]=t.size;else{const i=this.getImage(1);if(i.width&&i.height)e=i.width,n=i.height;else if(i instanceof HTMLImageElement){this.initialOptions_=t;const e=()=>{if(this.unlistenImageChange(e),!this.initialOptions_)return;const n=this.iconImage_.getSize();this.setScale(jr(n[0],n[1],t.width,t.height))};return void this.listenImageChange(e)}}void 0!==e&&this.setScale(jr(e,n,t.width,t.height))}}clone(){let t,e,n;return this.initialOptions_?(e=this.initialOptions_.width,n=this.initialOptions_.height):(t=this.getScale(),t=Array.isArray(t)?t.slice():t),new Wr({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,crossOrigin:this.crossOrigin_,offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,opacity:this.getOpacity(),rotateWithView:this.getRotateWithView(),rotation:this.getRotation(),scale:t,width:e,height:n,size:null!==this.size_?this.size_.slice():void 0,src:this.getSrc(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getAnchor(){let t=this.normalizedAnchor_;if(!t){t=this.anchor_;const e=this.getSize();if("fraction"==this.anchorXUnits_||"fraction"==this.anchorYUnits_){if(!e)return null;t=this.anchor_.slice(),"fraction"==this.anchorXUnits_&&(t[0]*=e[0]),"fraction"==this.anchorYUnits_&&(t[1]*=e[1])}if("top-left"!=this.anchorOrigin_){if(!e)return null;t===this.anchor_&&(t=this.anchor_.slice()),"top-right"!=this.anchorOrigin_&&"bottom-right"!=this.anchorOrigin_||(t[0]=-t[0]+e[0]),"bottom-left"!=this.anchorOrigin_&&"bottom-right"!=this.anchorOrigin_||(t[1]=-t[1]+e[1])}this.normalizedAnchor_=t}const e=this.getDisplacement(),n=this.getScaleArray();return[t[0]-e[0]/n[0],t[1]+e[1]/n[1]]}setAnchor(t){this.anchor_=t,this.normalizedAnchor_=null}getColor(){return this.color_}getImage(t){return this.iconImage_.getImage(t)}getPixelRatio(t){return this.iconImage_.getPixelRatio(t)}getImageSize(){return this.iconImage_.getSize()}getImageState(){return this.iconImage_.getImageState()}getHitDetectionImage(){return this.iconImage_.getHitDetectionImage()}getOrigin(){if(this.origin_)return this.origin_;let t=this.offset_;if("top-left"!=this.offsetOrigin_){const e=this.getSize(),n=this.iconImage_.getSize();if(!e||!n)return null;t=t.slice(),"top-right"!=this.offsetOrigin_&&"bottom-right"!=this.offsetOrigin_||(t[0]=n[0]-e[0]-t[0]),"bottom-left"!=this.offsetOrigin_&&"bottom-right"!=this.offsetOrigin_||(t[1]=n[1]-e[1]-t[1])}return this.origin_=t,this.origin_}getSrc(){return this.iconImage_.getSrc()}getSize(){return this.size_?this.size_:this.iconImage_.getSize()}getWidth(){const t=this.getScaleArray();return this.size_?this.size_[0]*t[0]:this.iconImage_.getImageState()==gi?this.iconImage_.getSize()[0]*t[0]:void 0}getHeight(){const t=this.getScaleArray();return this.size_?this.size_[1]*t[1]:this.iconImage_.getImageState()==gi?this.iconImage_.getSize()[1]*t[1]:void 0}setScale(t){delete this.initialOptions_,super.setScale(t)}listenImageChange(t){this.iconImage_.addEventListener(x,t)}load(){this.iconImage_.load()}unlistenImageChange(t){this.iconImage_.removeEventListener(x,t)}ready(){return this.iconImage_.ready()}}const Hr=Wr;class $r{constructor(t){t=t||{},this.font_=t.font,this.rotation_=t.rotation,this.rotateWithView_=t.rotateWithView,this.scale_=t.scale,this.scaleArray_=wi(void 0!==t.scale?t.scale:1),this.text_=t.text,this.textAlign_=t.textAlign,this.justify_=t.justify,this.repeat_=t.repeat,this.textBaseline_=t.textBaseline,this.fill_=void 0!==t.fill?t.fill:new zr({color:"#333"}),this.maxAngle_=void 0!==t.maxAngle?t.maxAngle:Math.PI/4,this.placement_=void 0!==t.placement?t.placement:"point",this.overflow_=!!t.overflow,this.stroke_=void 0!==t.stroke?t.stroke:null,this.offsetX_=void 0!==t.offsetX?t.offsetX:0,this.offsetY_=void 0!==t.offsetY?t.offsetY:0,this.backgroundFill_=t.backgroundFill?t.backgroundFill:null,this.backgroundStroke_=t.backgroundStroke?t.backgroundStroke:null,this.padding_=void 0===t.padding?null:t.padding,this.declutterMode_=t.declutterMode}clone(){const t=this.getScale();return new $r({font:this.getFont(),placement:this.getPlacement(),repeat:this.getRepeat(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(t)?t.slice():t,text:this.getText(),textAlign:this.getTextAlign(),justify:this.getJustify(),textBaseline:this.getTextBaseline(),fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()||void 0,declutterMode:this.getDeclutterMode()})}getOverflow(){return this.overflow_}getFont(){return this.font_}getMaxAngle(){return this.maxAngle_}getPlacement(){return this.placement_}getRepeat(){return this.repeat_}getOffsetX(){return this.offsetX_}getOffsetY(){return this.offsetY_}getFill(){return this.fill_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getStroke(){return this.stroke_}getText(){return this.text_}getTextAlign(){return this.textAlign_}getJustify(){return this.justify_}getTextBaseline(){return this.textBaseline_}getBackgroundFill(){return this.backgroundFill_}getBackgroundStroke(){return this.backgroundStroke_}getPadding(){return this.padding_}getDeclutterMode(){return this.declutterMode_}setOverflow(t){this.overflow_=t}setFont(t){this.font_=t}setMaxAngle(t){this.maxAngle_=t}setOffsetX(t){this.offsetX_=t}setOffsetY(t){this.offsetY_=t}setPlacement(t){this.placement_=t}setRepeat(t){this.repeat_=t}setRotateWithView(t){this.rotateWithView_=t}setFill(t){this.fill_=t}setRotation(t){this.rotation_=t}setScale(t){this.scale_=t,this.scaleArray_=wi(void 0!==t?t:1)}setStroke(t){this.stroke_=t}setText(t){this.text_=t}setTextAlign(t){this.textAlign_=t}setJustify(t){this.justify_=t}setTextBaseline(t){this.textBaseline_=t}setBackgroundFill(t){this.backgroundFill_=t}setBackgroundStroke(t){this.backgroundStroke_=t}setPadding(t){this.padding_=t}}const Zr=$r;let Kr=0;const Jr=0,Qr=1<<Kr++,ts=1<<Kr++,es=1<<Kr++,ns=1<<Kr++,is=1<<Kr++,rs=Math.pow(2,5)-1,ss={[Qr]:"boolean",[ts]:"number",[es]:"string",[ns]:"color",[is]:"number[]"},os=Object.keys(ss).map(Number).sort(a);function as(t){const e=[];for(const i of os)(t&(n=i))===n&&e.push(ss[i]);var n;return 0===e.length?"untyped":e.length<3?e.join(" or "):e.slice(0,-1).join(", ")+", or "+e[e.length-1]}function ls(t,e){return!!(t&e)}function hs(t,e){return t===e}class us{constructor(t,e){this.type=t,this.value=e}}class cs{constructor(t,e,...n){this.type=t,this.operator=e,this.args=n}}function fs(){return{variables:new Set,properties:new Set,featureId:!1,geometryType:!1,style:{}}}function ds(t,e,n){switch(typeof t){case"boolean":return new us(Qr,t);case"number":return new us(ts,t);case"string":{let e=es;return function(t){try{return Fi(t),!0}catch(t){return!1}}(t)&&(e|=ns),hs(e&n,Jr)||(e&=n),new us(e,t)}}if(!Array.isArray(t))throw new Error("Expression must be an array or a primitive value");if(0===t.length)throw new Error("Empty expression");if("string"==typeof t[0])return function(t,e,n){const i=t[0],r=ps[i];if(!r)throw new Error(`Unknown operator: ${i}`);return r(t,e,n)}(t,e,n);for(const e of t)if("number"!=typeof e)throw new Error("Expected an array of numbers");let i=is;return 3!==t.length&&4!==t.length||(i|=ns),n&&(i&=n),new us(i,t)}const gs={Get:"get",Var:"var",Concat:"concat",GeometryType:"geometry-type",Any:"any",All:"all",Not:"!",Resolution:"resolution",Zoom:"zoom",Time:"time",Equal:"==",NotEqual:"!=",GreaterThan:">",GreaterThanOrEqualTo:">=",LessThan:"<",LessThanOrEqualTo:"<=",Multiply:"*",Divide:"/",Add:"+",Subtract:"-",Clamp:"clamp",Mod:"%",Pow:"^",Abs:"abs",Floor:"floor",Ceil:"ceil",Round:"round",Sin:"sin",Cos:"cos",Atan:"atan",Sqrt:"sqrt",Match:"match",Between:"between",Interpolate:"interpolate",Coalesce:"coalesce",Case:"case",In:"in",Number:"number",String:"string",Array:"array",Color:"color",Id:"id",Band:"band",Palette:"palette",ToString:"to-string"},ps={[gs.Get]:_s((([t,e])=>void 0!==e?function(t){switch(t){case"string":return es;case"color":return ns;case"number":return ts;case"boolean":return Qr;case"number[]":return is;default:throw new Error(`Unrecognized type hint: ${t}`)}}(e.value):rs),ys(1,2),(function(t,e){const n=ds(t[1],e);if(!(n instanceof us))throw new Error("Expected a literal argument for get operation");if("string"!=typeof n.value)throw new Error("Expected a string argument for get operation");return e.properties.add(n.value),3===t.length?[n,ds(t[2],e)]:[n]})),[gs.Var]:_s((([t])=>t.type),ys(1,1),(function(t,e,n,i){const r=t[1];if("string"!=typeof r)throw new Error("Expected a string argument for var operation");if(e.variables.add(r),!("variables"in e.style)||void 0===e.style.variables[r])return[new us(rs,r)];const s=ds(e.style.variables[r],e);if(s.value=r,i&&!ls(i,s.type))throw new Error(`The variable ${r} has type ${as(s.type)} but the following type was expected: ${as(i)}`);return[s]})),[gs.Id]:_s(ts|es,ms,(function(t,e){e.featureId=!0})),[gs.Concat]:_s(es,ys(2,1/0),vs(rs)),[gs.GeometryType]:_s(es,ms,(function(t,e){e.geometryType=!0})),[gs.Resolution]:_s(ts,ms),[gs.Zoom]:_s(ts,ms),[gs.Time]:_s(ts,ms),[gs.Any]:_s(Qr,ys(2,1/0),vs(Qr)),[gs.All]:_s(Qr,ys(2,1/0),vs(Qr)),[gs.Not]:_s(Qr,ys(1,1),vs(Qr)),[gs.Equal]:_s(Qr,ys(2,2),vs(rs),ws),[gs.NotEqual]:_s(Qr,ys(2,2),vs(rs),ws),[gs.GreaterThan]:_s(Qr,ys(2,2),vs(rs),ws),[gs.GreaterThanOrEqualTo]:_s(Qr,ys(2,2),vs(rs),ws),[gs.LessThan]:_s(Qr,ys(2,2),vs(rs),ws),[gs.LessThanOrEqualTo]:_s(Qr,ys(2,2),vs(rs),ws),[gs.Multiply]:_s((t=>{let e=ts|ns;for(let n=0;n<t.length;n++)e&=t[n].type;return e}),ys(2,1/0),vs(ts|ns),ws),[gs.Coalesce]:_s((t=>{let e=rs;for(let n=1;n<t.length;n+=2)e&=t[n].type;return e&=t[t.length-1].type,e}),ys(2,1/0),vs(rs),ws),[gs.Divide]:_s(ts,ys(2,2),vs(ts)),[gs.Add]:_s(ts,ys(2,1/0),vs(ts)),[gs.Subtract]:_s(ts,ys(2,2),vs(ts)),[gs.Clamp]:_s(ts,ys(3,3),vs(ts)),[gs.Mod]:_s(ts,ys(2,2),vs(ts)),[gs.Pow]:_s(ts,ys(2,2),vs(ts)),[gs.Abs]:_s(ts,ys(1,1),vs(ts)),[gs.Floor]:_s(ts,ys(1,1),vs(ts)),[gs.Ceil]:_s(ts,ys(1,1),vs(ts)),[gs.Round]:_s(ts,ys(1,1),vs(ts)),[gs.Sin]:_s(ts,ys(1,1),vs(ts)),[gs.Cos]:_s(ts,ys(1,1),vs(ts)),[gs.Atan]:_s(ts,ys(1,2),vs(ts)),[gs.Sqrt]:_s(ts,ys(1,1),vs(ts)),[gs.Match]:_s((t=>{let e=rs;for(let n=2;n<t.length;n+=2)e&=t[n].type;return e&=t[t.length-1].type,e}),ys(4,1/0),xs,(function(t,e,n,i){const r=t.length-1;let s=ds(t[1],e).type;const o=ds(t[t.length-1],e);let a=void 0!==i?i&o.type:o.type;const l=new Array(r-2);for(let n=0;n<r-2;n+=2){const i=ds(t[n+2],e),r=ds(t[n+3],e);s&=i.type,a&=r.type,l[n]=i,l[n+1]=r}const h=es|ts|Qr;if(!ls(h,s))throw new Error(`Expected an input of type ${as(h)} for the interpolate operation, got ${as(s)} instead`);if(hs(a,Jr))throw new Error("Could not find a common output type for the following match operation: "+JSON.stringify(t));for(let n=0;n<r-2;n+=2){const i=ds(t[n+2],e,s),r=ds(t[n+3],e,a);l[n]=i,l[n+1]=r}return[ds(t[1],e,s),...l,ds(t[t.length-1],e,a)]})),[gs.Between]:_s(Qr,ys(3,3),vs(ts)),[gs.Interpolate]:_s((t=>{let e=ns|ts;for(let n=3;n<t.length;n+=2)e&=t[n].type;return e}),ys(6,1/0),xs,(function(t,e,n,i){const r=t[1];let s;switch(r[0]){case"linear":s=1;break;case"exponential":if(s=r[1],"number"!=typeof s)throw new Error(`Expected a number base for exponential interpolation, got ${JSON.stringify(s)} instead`);break;default:s=null}if(!s)throw new Error(`Invalid interpolation type: ${JSON.stringify(r)}`);s=ds(s,e);let o=ds(t[2],e);if(!ls(ts,o.type))throw new Error(`Expected an input of type number for the interpolate operation, got ${as(o.type)} instead`);o=ds(t[2],e,ts);const a=new Array(t.length-3);for(let n=0;n<a.length;n+=2){let i=ds(t[n+3],e);if(!ls(ts,i.type))throw new Error(`Expected all stop input values in the interpolate operation to be of type number, got ${as(i.type)} at position ${n+2} instead`);let r=ds(t[n+4],e);if(!ls(ts|ns,r.type))throw new Error(`Expected all stop output values in the interpolate operation to be a number or color, got ${as(r.type)} at position ${n+3} instead`);i=ds(t[n+3],e,ts),r=ds(t[n+4],e,ts|ns),a[n]=i,a[n+1]=r}return[s,o,...a]})),[gs.Case]:_s((t=>{let e=rs;for(let n=1;n<t.length;n+=2)e&=t[n].type;return e&=t[t.length-1].type,e}),ys(3,1/0),(function(t,e){const n=t[0],i=t.length-1;if(i%2==0)throw new Error(`An odd amount of arguments was expected for operation ${n}, got ${JSON.stringify(i)} instead`)}),(function(t,e,n,i){const r=ds(t[t.length-1],e);let s=void 0!==i?i&r.type:r.type;const o=new Array(t.length-1);for(let n=0;n<o.length-1;n+=2){const i=ds(t[n+1],e),r=ds(t[n+2],e);if(!ls(Qr,i.type))throw new Error(`Expected all conditions in the case operation to be of type boolean, got ${as(i.type)} at position ${n} instead`);s&=r.type,o[n]=i,o[n+1]=r}if(hs(s,Jr))throw new Error("Could not find a common output type for the following case operation: "+JSON.stringify(t));for(let n=0;n<o.length-1;n+=2)o[n+1]=ds(t[n+2],e,s);return o[o.length-1]=ds(t[t.length-1],e,s),o})),[gs.In]:_s(Qr,ys(2,2),(function(t,e){let n=t[2];if(!Array.isArray(n))throw new Error('The "in" operator was provided a literal value which was not an array as second argument.');if("string"==typeof n[0]){if("literal"!==n[0])throw new Error('For the "in" operator, a string array should be wrapped in a "literal" operator to disambiguate from expressions.');if(!Array.isArray(n[1]))throw new Error('The "in" operator was provided a literal value which was not an array as second argument.');n=n[1]}let i=es|ts;const r=new Array(n.length);for(let t=0;t<r.length;t++){const s=ds(n[t],e);i&=s.type,r[t]=s}if(hs(i,Jr))throw new Error("Could not find a common type for the following in operation: "+JSON.stringify(t));return[ds(t[1],e,i),...r]})),[gs.Number]:_s(ts,ys(1,1/0),vs(rs)),[gs.String]:_s(es,ys(1,1/0),vs(rs)),[gs.Array]:_s((t=>3===t.length||4===t.length?is|ns:is),ys(1,1/0),vs(ts)),[gs.Color]:_s(ns,ys(1,4),vs(ts)),[gs.Band]:_s(ts,ys(1,3),vs(ts)),[gs.Palette]:_s(ns,ys(2,2),(function(t,e){const n=ds(t[1],e,ts);if(n.type!==ts)throw new Error(`The first argument of palette must be an number, got ${as(n.type)} instead`);const i=t[2];if(!Array.isArray(i))throw new Error("The second argument of palette must be an array");const r=new Array(i.length);for(let t=0;t<r.length;t++){const n=ds(i[t],e,ns);if(!(n instanceof us))throw new Error(`The palette color at index ${t} must be a literal value`);if(!ls(n.type,ns))throw new Error(`The palette color at index ${t} should be of type color, got ${as(n.type)} instead`);r[t]=n}return[n,...r]})),[gs.ToString]:_s(es,ys(1,1),vs(Qr|ts|es|ns))};function ms(t,e){const n=t[0];if(1!==t.length)throw new Error(`Expected no arguments for ${n} operation`);return[]}function ys(t,e){return function(n,i){const r=n[0],s=n.length-1;if(t===e){if(s!==t)throw new Error(`Expected ${t} argument${1===t?"":"s"} for ${r}, got ${s}`)}else if(s<t||s>e)throw new Error(`Expected ${e===1/0?`${t} or more`:`${t} to ${e}`} arguments for ${r}, got ${s}`)}}function vs(t){return function(e,n){const i=e[0],r=e.length-1,s=new Array(r);for(let o=0;o<r;++o){const r=ds(e[o+1],n);if(!ls(t,r.type)){const e=as(t),n=as(r.type);throw new Error(`Unexpected type for argument ${o} of ${i} operation, got ${e} but expected ${n}`)}r.type&=t,s[o]=r}return s}}function ws(t,e,n){const i=t[0],r=t.length-1;let s=rs;for(let t=0;t<n.length;++t)s&=n[t].type;if(s===Jr)throw new Error(`No common type could be found for arguments of ${i} operation`);const o=new Array(r);for(let n=0;n<r;++n)o[n]=ds(t[n+1],e,s);return o}function xs(t,e){const n=t[0],i=t.length-1;if(i%2==1)throw new Error(`An even amount of arguments was expected for operation ${n}, got ${JSON.stringify(i)} instead`)}function _s(t,...e){return function(n,i,r){const s=n[0];let o=[];for(let t=0;t<e.length;t++)o=e[t](n,i,o,r)||o;let a="function"==typeof t?t(o):t;if(void 0!==r){if(!ls(a,r))throw new Error(`The following expression was expected to return ${as(r)}, but returns ${as(a)} instead: ${JSON.stringify(n)}`);a&=r}if(a===Jr)throw new Error(`No matching type was found for the following expression: ${JSON.stringify(n)}`);return new cs(a,s,...o)}}function bs(t){if(!t)return"";const e=t.getType();switch(e){case"Point":case"LineString":case"Polygon":return e;case"MultiPoint":case"MultiLineString":case"MultiPolygon":return e.substring(5);case"Circle":return"Polygon";case"GeometryCollection":return bs(t.getGeometries()[0]);default:return""}}function Es(t,e,n){const i=ds(t,n);if(!ls(e,i.type)){const t=as(e),n=as(i.type);throw new Error(`Expected expression to be of type ${t}, got ${n}`)}return Ss(i,n)}function Ss(t,e){if(t instanceof us){if(t.type===ns&&"string"==typeof t.value){const e=Fi(t.value);return function(){return e}}return function(){return t.value}}const n=t.operator;switch(n){case gs.Number:case gs.String:case gs.Coalesce:return function(t,e){const n=t.operator,i=t.args.length,r=new Array(i);for(let n=0;n<i;++n)r[n]=Ss(t.args[n],e);switch(n){case gs.Coalesce:return t=>{for(let e=0;e<i;++e){const n=r[e](t);if(null!=n)return n}throw new Error("Expected one of the values to be non-null")};case gs.Number:case gs.String:return t=>{for(let e=0;e<i;++e){const i=r[e](t);if(typeof i===n)return i}throw new Error(`Expected one of the values to be a ${n}`)};default:throw new Error(`Unsupported assertion operator ${n}`)}}(t,e);case gs.Get:case gs.Var:return function(t,e){const n=t.args[0].value;switch(t.operator){case gs.Get:return t=>t.properties[n];case gs.Var:return t=>t.variables[n];default:throw new Error(`Unsupported accessor operator ${t.operator}`)}}(t);case gs.Id:return t=>t.featureId;case gs.GeometryType:return t=>t.geometryType;case gs.Concat:{const n=t.args.map((t=>Ss(t,e)));return t=>"".concat(...n.map((e=>e(t).toString())))}case gs.Resolution:return t=>t.resolution;case gs.Any:case gs.All:case gs.Between:case gs.In:case gs.Not:return function(t,e){const n=t.operator,i=t.args.length,r=new Array(i);for(let n=0;n<i;++n)r[n]=Ss(t.args[n],e);switch(n){case gs.Any:return t=>{for(let e=0;e<i;++e)if(r[e](t))return!0;return!1};case gs.All:return t=>{for(let e=0;e<i;++e)if(!r[e](t))return!1;return!0};case gs.Between:return t=>{const e=r[0](t),n=r[1](t),i=r[2](t);return e>=n&&e<=i};case gs.In:return t=>{const e=r[0](t);for(let n=1;n<i;++n)if(e===r[n](t))return!0;return!1};case gs.Not:return t=>!r[0](t);default:throw new Error(`Unsupported logical operator ${n}`)}}(t,e);case gs.Equal:case gs.NotEqual:case gs.LessThan:case gs.LessThanOrEqualTo:case gs.GreaterThan:case gs.GreaterThanOrEqualTo:return function(t,e){const n=t.operator,i=Ss(t.args[0],e),r=Ss(t.args[1],e);switch(n){case gs.Equal:return t=>i(t)===r(t);case gs.NotEqual:return t=>i(t)!==r(t);case gs.LessThan:return t=>i(t)<r(t);case gs.LessThanOrEqualTo:return t=>i(t)<=r(t);case gs.GreaterThan:return t=>i(t)>r(t);case gs.GreaterThanOrEqualTo:return t=>i(t)>=r(t);default:throw new Error(`Unsupported comparison operator ${n}`)}}(t,e);case gs.Multiply:case gs.Divide:case gs.Add:case gs.Subtract:case gs.Clamp:case gs.Mod:case gs.Pow:case gs.Abs:case gs.Floor:case gs.Ceil:case gs.Round:case gs.Sin:case gs.Cos:case gs.Atan:case gs.Sqrt:return function(t,e){const n=t.operator,i=t.args.length,r=new Array(i);for(let n=0;n<i;++n)r[n]=Ss(t.args[n],e);switch(n){case gs.Multiply:return t=>{let e=1;for(let n=0;n<i;++n)e*=r[n](t);return e};case gs.Divide:return t=>r[0](t)/r[1](t);case gs.Add:return t=>{let e=0;for(let n=0;n<i;++n)e+=r[n](t);return e};case gs.Subtract:return t=>r[0](t)-r[1](t);case gs.Clamp:return t=>{const e=r[0](t),n=r[1](t);if(e<n)return n;const i=r[2](t);return e>i?i:e};case gs.Mod:return t=>r[0](t)%r[1](t);case gs.Pow:return t=>Math.pow(r[0](t),r[1](t));case gs.Abs:return t=>Math.abs(r[0](t));case gs.Floor:return t=>Math.floor(r[0](t));case gs.Ceil:return t=>Math.ceil(r[0](t));case gs.Round:return t=>Math.round(r[0](t));case gs.Sin:return t=>Math.sin(r[0](t));case gs.Cos:return t=>Math.cos(r[0](t));case gs.Atan:return 2===i?t=>Math.atan2(r[0](t),r[1](t)):t=>Math.atan(r[0](t));case gs.Sqrt:return t=>Math.sqrt(r[0](t));default:throw new Error(`Unsupported numeric operator ${n}`)}}(t,e);case gs.Case:return function(t,e){const n=t.args.length,i=new Array(n);for(let r=0;r<n;++r)i[r]=Ss(t.args[r],e);return t=>{for(let e=0;e<n-1;e+=2)if(i[e](t))return i[e+1](t);return i[n-1](t)}}(t,e);case gs.Match:return function(t,e){const n=t.args.length,i=new Array(n);for(let r=0;r<n;++r)i[r]=Ss(t.args[r],e);return t=>{const e=i[0](t);for(let r=1;r<n;r+=2)if(e===i[r](t))return i[r+1](t);return i[n-1](t)}}(t,e);case gs.Interpolate:return function(t,e){const n=t.args.length,i=new Array(n);for(let r=0;r<n;++r)i[r]=Ss(t.args[r],e);return t=>{const e=i[0](t),r=i[1](t);let s,o;for(let a=2;a<n;a+=2){const n=i[a](t);let l=i[a+1](t);const h=Array.isArray(l);if(h&&(l=Oi(l)),n>=r)return 2===a?l:h?Cs(e,r,s,o,n,l):Is(e,r,s,o,n,l);s=n,o=l}return o}}(t,e);case gs.ToString:return function(t,e){const n=t.operator,i=t.args.length,r=new Array(i);for(let n=0;n<i;++n)r[n]=Ss(t.args[n],e);if(n===gs.ToString)return e=>{const n=r[0](e);return t.args[0].type===ns?Bi(n):n.toString()};throw new Error(`Unsupported convert operator ${n}`)}(t,e);default:throw new Error(`Unsupported operator ${n}`)}}function Is(t,e,n,i,r,s){const o=r-n;if(0===o)return i;const a=e-n;return i+(1===t?a/o:(Math.pow(t,a)-1)/(Math.pow(t,o)-1))*(s-i)}function Cs(t,e,n,i,r,s){if(0==r-n)return i;const o=Di(i),a=Di(s);let l=a[2]-o[2];return l>180?l-=360:l<-180&&(l+=360),Gi(function(t){const e=Si.rgb(Mi.xyz(t));return e[3]=t[3],e}([Is(t,e,n,o[0],r,a[0]),Is(t,e,n,o[1],r,a[1]),o[2]+Is(t,e,n,0,r,l),Is(t,e,n,i[3],r,s[3])]))}function Ms(t){return!0}function Rs(t){const e=fs(),n=function(t,e){const n=t.length,i=new Array(n);for(let r=0;r<n;++r){const n=t[r],s="filter"in n?Es(n.filter,Qr,e):Ms;let o;if(Array.isArray(n.style)){const t=n.style.length;o=new Array(t);for(let i=0;i<t;++i)o[i]=Ts(n.style[i],e)}else o=[Ts(n.style,e)];i[r]={filter:s,styles:o}}return function(e){const r=[];let s=!1;for(let o=0;o<n;++o)if((0,i[o].filter)(e)&&(!t[o].else||!s)){s=!0;for(const t of i[o].styles){const n=t(e);n&&r.push(n)}}return r}}(t,e),i={variables:{},properties:{},resolution:NaN,featureId:null,geometryType:""};return function(t,r){if(i.properties=t.getPropertiesInternal(),i.resolution=r,e.featureId){const e=t.getId();i.featureId=void 0!==e?e:null}return e.geometryType&&(i.geometryType=bs(t.getGeometry())),n(i)}}function Ps(t){const e=fs(),n=t.length,i=new Array(n);for(let r=0;r<n;++r)i[r]=Ts(t[r],e);const r={variables:{},properties:{},resolution:NaN,featureId:null,geometryType:""},s=new Array(n);return function(t,o){if(r.properties=t.getPropertiesInternal(),r.resolution=o,e.featureId){const e=t.getId();r.featureId=void 0!==e?e:null}let a=0;for(let t=0;t<n;++t){const e=i[t](r);e&&(s[a]=e,a+=1)}return s.length=a,s}}function Ts(t,e){const n=Ns(t,"",e),i=As(t,"",e),r=function(t,e){const n="text-",i=Ls(t,n+"value",e);if(!i)return null;const r=Ns(t,n,e),s=Ns(t,n+"background-",e),o=As(t,n,e),a=As(t,n+"background-",e),l=Ls(t,n+"font",e),h=ks(t,n+"max-angle",e),u=ks(t,n+"offset-x",e),c=ks(t,n+"offset-y",e),f=Os(t,n+"overflow",e),d=Ls(t,n+"placement",e),g=ks(t,n+"repeat",e),p=Bs(t,n+"scale",e),m=Os(t,n+"rotate-with-view",e),y=ks(t,n+"rotation",e),v=Ls(t,n+"align",e),w=Ls(t,n+"justify",e),x=Ls(t,n+"baseline",e),_=Fs(t,n+"padding",e),b=Ys(t,n+"declutter-mode"),E=new Zr({declutterMode:b});return function(t){if(E.setText(i(t)),r&&E.setFill(r(t)),s&&E.setBackgroundFill(s(t)),o&&E.setStroke(o(t)),a&&E.setBackgroundStroke(a(t)),l&&E.setFont(l(t)),h&&E.setMaxAngle(h(t)),u&&E.setOffsetX(u(t)),c&&E.setOffsetY(c(t)),f&&E.setOverflow(f(t)),d){const e=d(t);if("point"!==e&&"line"!==e)throw new Error("Expected point or line for text-placement");E.setPlacement(e)}if(g&&E.setRepeat(g(t)),p&&E.setScale(p(t)),m&&E.setRotateWithView(m(t)),y&&E.setRotation(y(t)),v){const e=v(t);if("left"!==e&&"center"!==e&&"right"!==e&&"end"!==e&&"start"!==e)throw new Error("Expected left, right, center, start, or end for text-align");E.setTextAlign(e)}if(w){const e=w(t);if("left"!==e&&"right"!==e&&"center"!==e)throw new Error("Expected left, right, or center for text-justify");E.setJustify(e)}if(x){const e=x(t);if("bottom"!==e&&"top"!==e&&"middle"!==e&&"alphabetic"!==e&&"hanging"!==e)throw new Error("Expected bottom, top, middle, alphabetic, or hanging for text-baseline");E.setTextBaseline(e)}return _&&E.setPadding(_(t)),E}}(t,e),s=function(t,e){return"icon-src"in t?function(t,e){const n="icon-",i=n+"src",r=js(t[i],i),s=zs(t,n+"anchor",e),o=Bs(t,n+"scale",e),a=ks(t,n+"opacity",e),l=zs(t,n+"displacement",e),h=ks(t,n+"rotation",e),u=Os(t,n+"rotate-with-view",e),c=qs(t,n+"anchor-origin"),f=Vs(t,n+"anchor-x-units"),d=Vs(t,n+"anchor-y-units"),g=function(t,e){const n=t[e];if(void 0!==n)return Hs(n,e)}(t,n+"color"),p=function(t,e){const n=t[e];if(void 0!==n){if("string"!=typeof n)throw new Error(`Expected a string for ${e}`);return n}}(t,n+"cross-origin"),m=function(t,e){const n=t[e];if(void 0!==n)return Xs(n,e)}(t,n+"offset"),y=qs(t,n+"offset-origin"),v=Us(t,n+"width"),w=Us(t,n+"height"),x=function(t,e){const n=t[e];if(void 0!==n){if("number"==typeof n)return wi(n);if(!Array.isArray(n))throw new Error(`Expected a number or size array for ${e}`);if(2!==n.length||"number"!=typeof n[0]||"number"!=typeof n[1])throw new Error(`Expected a number or size array for ${e}`);return n}}(t,n+"size"),_=Ys(t,n+"declutter-mode"),b=new Hr({src:r,anchorOrigin:c,anchorXUnits:f,anchorYUnits:d,color:g,crossOrigin:p,offset:m,offsetOrigin:y,height:w,width:v,size:x,declutterMode:_});return function(t){return a&&b.setOpacity(a(t)),l&&b.setDisplacement(l(t)),h&&b.setRotation(h(t)),u&&b.setRotateWithView(u(t)),o&&b.setScale(o(t)),s&&b.setAnchor(s(t)),b}}(t,e):"shape-points"in t?function(t,e){const n="shape-",i=n+"points",r=n+"radius",s=Ws(t[i],i),o=Ws(t[r],r),a=Ns(t,n,e),l=As(t,n,e),h=Bs(t,n+"scale",e),u=zs(t,n+"displacement",e),c=ks(t,n+"rotation",e),f=Os(t,n+"rotate-with-view",e),d=Us(t,n+"radius2"),g=Us(t,n+"angle"),p=Ys(t,n+"declutter-mode"),m=new Lr({points:s,radius:o,radius2:d,angle:g,declutterMode:p});return function(t){return a&&m.setFill(a(t)),l&&m.setStroke(l(t)),u&&m.setDisplacement(u(t)),c&&m.setRotation(c(t)),f&&m.setRotateWithView(f(t)),h&&m.setScale(h(t)),m}}(t,e):"circle-radius"in t?function(t,e){const n="circle-",i=Ns(t,n,e),r=As(t,n,e),s=ks(t,n+"radius",e),o=Bs(t,n+"scale",e),a=zs(t,n+"displacement",e),l=ks(t,n+"rotation",e),h=Os(t,n+"rotate-with-view",e),u=Ys(t,n+"declutter-mode"),c=new Dr({radius:5,declutterMode:u});return function(t){return s&&c.setRadius(s(t)),i&&c.setFill(i(t)),r&&c.setStroke(r(t)),a&&c.setDisplacement(a(t)),l&&c.setRotation(l(t)),h&&c.setRotateWithView(h(t)),o&&c.setScale(o(t)),c}}(t,e):null}(t,e),o=ks(t,"z-index",e);if(!(n||i||r||s||v(t)))throw new Error("No fill, stroke, point, or text symbolizer properties in style: "+JSON.stringify(t));const a=new Xr;return function(t){let e=!0;if(n){const i=n(t);i&&(e=!1),a.setFill(i)}if(i){const n=i(t);n&&(e=!1),a.setStroke(n)}if(r){const n=r(t);n&&(e=!1),a.setText(n)}if(s){const n=s(t);n&&(e=!1),a.setImage(n)}return o&&a.setZIndex(o(t)),e?null:a}}function Ns(t,e,n){let i;if(i=e+"fill-pattern-src"in t?function(t,e,n){const i=Ls(t,e+"pattern-src",n),r=Gs(t,e+"pattern-offset",n),s=Gs(t,e+"pattern-size",n),o=Ds(t,e+"color",n);return function(t){return{src:i(t),offset:r&&r(t),size:s&&s(t),color:o&&o(t)}}}(t,e+"fill-",n):Ds(t,e+"fill-color",n),!i)return null;const r=new zr;return function(t){const e=i(t);return"none"===e?null:(r.setColor(e),r)}}function As(t,e,n){const i=ks(t,e+"stroke-width",n),r=Ds(t,e+"stroke-color",n);if(!i&&!r)return null;const s=Ls(t,e+"stroke-line-cap",n),o=Ls(t,e+"stroke-line-join",n),a=Fs(t,e+"stroke-line-dash",n),l=ks(t,e+"stroke-line-dash-offset",n),h=ks(t,e+"stroke-miter-limit",n),u=new Br;return function(t){if(r){const e=r(t);if("none"===e)return null;u.setColor(e)}if(i&&u.setWidth(i(t)),s){const e=s(t);if("butt"!==e&&"round"!==e&&"square"!==e)throw new Error("Expected butt, round, or square line cap");u.setLineCap(e)}if(o){const e=o(t);if("bevel"!==e&&"round"!==e&&"miter"!==e)throw new Error("Expected bevel, round, or miter line join");u.setLineJoin(e)}return a&&u.setLineDash(a(t)),l&&u.setLineDashOffset(l(t)),h&&u.setMiterLimit(h(t)),u}}function ks(t,e,n){if(!(e in t))return;const i=Es(t[e],ts,n);return function(t){return Ws(i(t),e)}}function Ls(t,e,n){if(!(e in t))return null;const i=Es(t[e],es,n);return function(t){return js(i(t),e)}}function Os(t,e,n){if(!(e in t))return null;const i=Es(t[e],Qr,n);return function(t){const n=i(t);if("boolean"!=typeof n)throw new Error(`Expected a boolean for ${e}`);return n}}function Ds(t,e,n){if(!(e in t))return null;const i=Es(t[e],ns|es,n);return function(t){return Hs(i(t),e)}}function Fs(t,e,n){if(!(e in t))return null;const i=Es(t[e],is,n);return function(t){return Xs(i(t),e)}}function zs(t,e,n){if(!(e in t))return null;const i=Es(t[e],is,n);return function(t){const n=Xs(i(t),e);if(2!==n.length)throw new Error(`Expected two numbers for ${e}`);return n}}function Gs(t,e,n){if(!(e in t))return null;const i=Es(t[e],is,n);return function(t){return $s(i(t),e)}}function Bs(t,e,n){if(!(e in t))return null;const i=Es(t[e],is|ts,n);return function(t){return function(t,e){return"number"==typeof t?t:$s(t,e)}(i(t),e)}}function Us(t,e){const n=t[e];if(void 0!==n){if("number"!=typeof n)throw new Error(`Expected a number for ${e}`);return n}}function qs(t,e){const n=t[e];if(void 0!==n){if("bottom-left"!==n&&"bottom-right"!==n&&"top-left"!==n&&"top-right"!==n)throw new Error(`Expected bottom-left, bottom-right, top-left, or top-right for ${e}`);return n}}function Vs(t,e){const n=t[e];if(void 0!==n){if("pixels"!==n&&"fraction"!==n)throw new Error(`Expected pixels or fraction for ${e}`);return n}}function Ys(t,e){const n=t[e];if(void 0!==n){if("string"!=typeof n)throw new Error(`Expected a string for ${e}`);if("declutter"!==n&&"obstacle"!==n&&"none"!==n)throw new Error(`Expected declutter, obstacle, or none for ${e}`);return n}}function Xs(t,e){if(!Array.isArray(t))throw new Error(`Expected an array for ${e}`);const n=t.length;for(let i=0;i<n;++i)if("number"!=typeof t[i])throw new Error(`Expected an array of numbers for ${e}`);return t}function js(t,e){if("string"!=typeof t)throw new Error(`Expected a string for ${e}`);return t}function Ws(t,e){if("number"!=typeof t)throw new Error(`Expected a number for ${e}`);return t}function Hs(t,e){if("string"==typeof t)return t;const n=Xs(t,e),i=n.length;if(i<3||i>4)throw new Error(`Expected a color with 3 or 4 values for ${e}`);return n}function $s(t,e){const n=Xs(t,e);if(2!==n.length)throw new Error(`Expected an array of two numbers for ${e}`);return n}const Zs="renderOrder",Ks=class extends ui{constructor(t){t=t||{};const e=Object.assign({},t);delete e.style,delete e.renderBuffer,delete e.updateWhileAnimating,delete e.updateWhileInteracting,super(e),this.declutter_=t.declutter?String(t.declutter):void 0,this.renderBuffer_=void 0!==t.renderBuffer?t.renderBuffer:100,this.style_=null,this.styleFunction_=void 0,this.setStyle(t.style),this.updateWhileAnimating_=void 0!==t.updateWhileAnimating&&t.updateWhileAnimating,this.updateWhileInteracting_=void 0!==t.updateWhileInteracting&&t.updateWhileInteracting}getDeclutter(){return this.declutter_}getFeatures(t){return super.getFeatures(t)}getRenderBuffer(){return this.renderBuffer_}getRenderOrder(){return this.get(Zs)}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}getUpdateWhileAnimating(){return this.updateWhileAnimating_}getUpdateWhileInteracting(){return this.updateWhileInteracting_}renderDeclutter(t,e){const n=this.getDeclutter();n in t.declutter==0&&(t.declutter[n]=new ci(9)),this.getRenderer().renderDeclutter(t,e)}setRenderOrder(t){this.set(Zs,t)}setStyle(t){this.style_=function(t){if(void 0===t)return Vr;if(!t)return null;if("function"==typeof t)return t;if(t instanceof Xr)return t;if(!Array.isArray(t))return Ps([t]);if(0===t.length)return[];const e=t.length,n=t[0];if(n instanceof Xr){const n=new Array(e);for(let i=0;i<e;++i){const e=t[i];if(!(e instanceof Xr))throw new Error("Expected a list of style instances");n[i]=e}return n}if("style"in n){const n=new Array(e);for(let i=0;i<e;++i){const e=t[i];if(!("style"in e))throw new Error("Expected a list of rules with a style property");n[i]=e}return Rs(n)}return Ps(t)}(t),this.styleFunction_=null===t?void 0:function(t){let e;if("function"==typeof t)e=t;else{let n;Array.isArray(t)?n=t:(K("function"==typeof t.getZIndex,"Expected an `Style` or an array of `Style`"),n=[t]),e=function(){return n}}return e}(this.style_),this.changed()}};function Js(t,e){ir.expire()}const Qs=class extends o{constructor(t){super(),this.map_=t}dispatchRenderEvent(t,e){A()}calculateMatrices2D(t){const e=t.viewState,n=t.coordinateToPixelTransform,i=t.pixelToCoordinateTransform;ln(n,t.size[0]/2,t.size[1]/2,1/e.resolution,-1/e.resolution,-e.rotation,-e.center[0],-e.center[1]),hn(i,n)}forEachFeatureAtCoordinate(t,e,n,i,r,s,o,a){let l;const h=e.viewState;function u(t,e,n,i){return r.call(s,e,t?n:null,i)}const c=h.projection,f=pe(t.slice(),c),d=[[0,0]];if(c.canWrapX()&&i){const t=le(c.getExtent());d.push([-t,0],[t,0])}const g=e.layerStatesArray,p=g.length,m=[],y=[];for(let i=0;i<d.length;i++)for(let r=p-1;r>=0;--r){const s=g[r],c=s.layer;if(c.hasRenderer()&&hi(s,h)&&o.call(a,c)){const r=c.getRenderer(),o=c.getSource();if(r&&o){const a=o.getWrapX()?f:t,h=u.bind(null,s.managed);y[0]=a[0]+d[i][0],y[1]=a[1]+d[i][1],l=r.forEachFeatureAtCoordinate(y,e,n,h,m)}if(l)return l}}if(0===m.length)return;const v=1/m.length;return m.forEach(((t,e)=>t.distanceSq+=e*v)),m.sort(((t,e)=>t.distanceSq-e.distanceSq)),m.some((t=>l=t.callback(t.feature,t.layer,t.geometry))),l}hasFeatureAtCoordinate(t,e,n,i,r,s){return void 0!==this.forEachFeatureAtCoordinate(t,e,n,i,f,this,r,s)}getMap(){return this.map_}renderFrame(t){A()}scheduleExpireIconCache(t){ir.canExpireCache()&&t.postRenderFunctions.push(Js)}},to=class extends r{constructor(t,e,n,i){super(t),this.inversePixelTransform=e,this.frameState=n,this.context=i}},eo=class extends Qs{constructor(t){super(t),this.fontChangeListenerKey_=M(Sr,s,t.redrawText.bind(t)),this.element_=document.createElement("div");const e=this.element_.style;e.position="absolute",e.width="100%",e.height="100%",e.zIndex="0",this.element_.className=hr+" ol-layers";const n=t.getViewport();n.insertBefore(this.element_,n.firstChild||null),this.children_=[],this.renderedVisible_=!0}dispatchRenderEvent(t,e){const n=this.getMap();if(n.hasListener(t)){const i=new to(t,void 0,e);n.dispatchEvent(i)}}disposeInternal(){P(this.fontChangeListenerKey_),this.element_.parentNode.removeChild(this.element_),super.disposeInternal()}renderFrame(t){if(!t)return void(this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1));this.calculateMatrices2D(t),this.dispatchRenderEvent(ct,t);const e=t.layerStatesArray.sort((function(t,e){return t.zIndex-e.zIndex}));e.some((t=>t.layer instanceof Ks&&t.layer.getDeclutter()))&&(t.declutter={});const n=t.viewState;this.children_.length=0;const i=[];let r=null;for(let s=0,o=e.length;s<o;++s){const o=e[s];t.layerIndex=s;const a=o.layer,l=a.getSourceState();if(!hi(o,n)||"ready"!=l&&"undefined"!=l){a.unrender();continue}const h=a.render(t,r);h&&(h!==r&&(this.children_.push(h),r=h),i.push(o))}this.declutter(t,i),function(t,e){const n=t.childNodes;for(let i=0;;++i){const r=n[i],s=e[i];if(!r&&!s)break;r!==s&&(r?s?t.insertBefore(s,r):(t.removeChild(r),--i):t.appendChild(s))}}(this.element_,this.children_),this.dispatchRenderEvent("postcompose",t),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(t)}declutter(t,e){for(let n=e.length-1;n>=0;--n){const i=e[n],r=i.layer;r.getDeclutter()&&r.renderDeclutter(t,i)}e.forEach((e=>e.layer.renderDeferred(t)))}};class no extends r{constructor(t,e){super(t),this.layer=e}}const io="layers";class ro extends lt{constructor(t){t=t||{};const e=Object.assign({},t);delete e.layers;let n=t.layers;super(e),this.on,this.once,this.un,this.layersListenerKeys_=[],this.listenerKeys_={},this.addChangeListener(io,this.handleLayersChanged_),n?Array.isArray(n)?n=new U(n.slice(),{unique:!0}):K("function"==typeof n.getArray,"Expected `layers` to be an array or a `Collection`"):n=new U(void 0,{unique:!0}),this.setLayers(n)}handleLayerChange_(){this.changed()}handleLayersChanged_(){this.layersListenerKeys_.forEach(P),this.layersListenerKeys_.length=0;const t=this.getLayers();this.layersListenerKeys_.push(M(t,F,this.handleLayersAdd_,this),M(t,z,this.handleLayersRemove_,this));for(const t in this.listenerKeys_)this.listenerKeys_[t].forEach(P);y(this.listenerKeys_);const e=t.getArray();for(let t=0,n=e.length;t<n;t++){const n=e[t];this.registerLayerListeners_(n),this.dispatchEvent(new no("addlayer",n))}this.changed()}registerLayerListeners_(t){const e=[M(t,s,this.handleLayerChange_,this),M(t,x,this.handleLayerChange_,this)];t instanceof ro&&e.push(M(t,"addlayer",this.handleLayerGroupAdd_,this),M(t,"removelayer",this.handleLayerGroupRemove_,this)),this.listenerKeys_[L(t)]=e}handleLayerGroupAdd_(t){this.dispatchEvent(new no("addlayer",t.layer))}handleLayerGroupRemove_(t){this.dispatchEvent(new no("removelayer",t.layer))}handleLayersAdd_(t){const e=t.element;this.registerLayerListeners_(e),this.dispatchEvent(new no("addlayer",e)),this.changed()}handleLayersRemove_(t){const e=t.element,n=L(e);this.listenerKeys_[n].forEach(P),delete this.listenerKeys_[n],this.dispatchEvent(new no("removelayer",e)),this.changed()}getLayers(){return this.get(io)}setLayers(t){const e=this.getLayers();if(e){const t=e.getArray();for(let e=0,n=t.length;e<n;++e)this.dispatchEvent(new no("removelayer",t[e]))}this.set(io,t)}getLayersArray(t){return t=void 0!==t?t:[],this.getLayers().forEach((function(e){e.getLayersArray(t)})),t}getLayerStatesArray(t){const e=void 0!==t?t:[],n=e.length;this.getLayers().forEach((function(t){t.getLayerStatesArray(e)}));const i=this.getLayerState();let r=i.zIndex;t||void 0!==i.zIndex||(r=0);for(let t=n,s=e.length;t<s;t++){const n=e[t];n.opacity*=i.opacity,n.visible=n.visible&&i.visible,n.maxResolution=Math.min(n.maxResolution,i.maxResolution),n.minResolution=Math.max(n.minResolution,i.minResolution),n.minZoom=Math.max(n.minZoom,i.minZoom),n.maxZoom=Math.min(n.maxZoom,i.maxZoom),void 0!==i.extent&&(void 0!==n.extent?n.extent=se(n.extent,i.extent):n.extent=i.extent),void 0===n.zIndex&&(n.zIndex=r)}return e}getSourceState(){return"ready"}}const so=ro,oo=class extends r{constructor(t,e,n){super(t),this.map=e,this.frameState=void 0!==n?n:null}},ao=class extends oo{constructor(t,e,n,i,r,s){super(t,e,r),this.originalEvent=n,this.pixel_=null,this.coordinate_=null,this.dragging=void 0!==i&&i,this.activePointers=s}get pixel(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_}set pixel(t){this.pixel_=t}get coordinate(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_}set coordinate(t){this.coordinate_=t}preventDefault(){super.preventDefault(),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()}stopPropagation(){super.stopPropagation(),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()}},lo={SINGLECLICK:"singleclick",CLICK:b,DBLCLICK:"dblclick",POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},ho="pointerdown",uo=class extends w{constructor(t,e){super(t),this.map_=t,this.clickTimeoutId_,this.emulateClicks_=!1,this.dragging_=!1,this.dragListenerKeys_=[],this.moveTolerance_=void 0===e?1:e,this.down_=null;const n=this.map_.getViewport();this.activePointers_=[],this.trackedTouches_={},this.element_=n,this.pointerdownListenerKey_=M(n,ho,this.handlePointerDown_,this),this.originalPointerMoveEvent_,this.relayedListenerKey_=M(n,"pointermove",this.relayMoveEvent_,this),this.boundHandleTouchMove_=this.handleTouchMove_.bind(this),this.element_.addEventListener(I,this.boundHandleTouchMove_,!!Hi&&{passive:!1})}emulateClick_(t){let e=new ao(lo.CLICK,this.map_,t);this.dispatchEvent(e),void 0!==this.clickTimeoutId_?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,e=new ao(lo.DBLCLICK,this.map_,t),this.dispatchEvent(e)):this.clickTimeoutId_=setTimeout((()=>{this.clickTimeoutId_=void 0;const e=new ao(lo.SINGLECLICK,this.map_,t);this.dispatchEvent(e)}),250)}updateActivePointers_(t){const e=t,n=e.pointerId;if(e.type==lo.POINTERUP||e.type==lo.POINTERCANCEL){delete this.trackedTouches_[n];for(const t in this.trackedTouches_)if(this.trackedTouches_[t].target!==e.target){delete this.trackedTouches_[t];break}}else e.type!=lo.POINTERDOWN&&e.type!=lo.POINTERMOVE||(this.trackedTouches_[n]=e);this.activePointers_=Object.values(this.trackedTouches_)}handlePointerUp_(t){this.updateActivePointers_(t);const e=new ao(lo.POINTERUP,this.map_,t,void 0,void 0,this.activePointers_);this.dispatchEvent(e),this.emulateClicks_&&!e.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(t)&&this.emulateClick_(this.down_),0===this.activePointers_.length&&(this.dragListenerKeys_.forEach(P),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)}isMouseActionButton_(t){return 0===t.button}handlePointerDown_(t){this.emulateClicks_=0===this.activePointers_.length,this.updateActivePointers_(t);const e=new ao(lo.POINTERDOWN,this.map_,t,void 0,void 0,this.activePointers_);if(this.dispatchEvent(e),this.down_=new PointerEvent(t.type,t),Object.defineProperty(this.down_,"target",{writable:!1,value:t.target}),0===this.dragListenerKeys_.length){const t=this.map_.getOwnerDocument();this.dragListenerKeys_.push(M(t,lo.POINTERMOVE,this.handlePointerMove_,this),M(t,lo.POINTERUP,this.handlePointerUp_,this),M(this.element_,lo.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==t&&this.dragListenerKeys_.push(M(this.element_.getRootNode(),lo.POINTERUP,this.handlePointerUp_,this))}}handlePointerMove_(t){if(this.isMoving_(t)){this.updateActivePointers_(t),this.dragging_=!0;const e=new ao(lo.POINTERDRAG,this.map_,t,this.dragging_,void 0,this.activePointers_);this.dispatchEvent(e)}}relayMoveEvent_(t){this.originalPointerMoveEvent_=t;const e=!(!this.down_||!this.isMoving_(t));this.dispatchEvent(new ao(lo.POINTERMOVE,this.map_,t,e))}handleTouchMove_(t){const e=this.originalPointerMoveEvent_;e&&!e.defaultPrevented||"boolean"==typeof t.cancelable&&!0!==t.cancelable||t.preventDefault()}isMoving_(t){return this.dragging_||Math.abs(t.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(t.clientY-this.down_.clientY)>this.moveTolerance_}disposeInternal(){this.relayedListenerKey_&&(P(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(I,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(P(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(P),this.dragListenerKeys_.length=0,this.element_=null,super.disposeInternal()}},co="postrender",fo="loadstart",go="loadend",po="layergroup",mo="size",yo="target",vo="view",wo=1/0,xo=class{constructor(t,e){this.priorityFunction_=t,this.keyFunction_=e,this.elements_=[],this.priorities_=[],this.queuedElements_={}}clear(){this.elements_.length=0,this.priorities_.length=0,y(this.queuedElements_)}dequeue(){const t=this.elements_,e=this.priorities_,n=t[0];1==t.length?(t.length=0,e.length=0):(t[0]=t.pop(),e[0]=e.pop(),this.siftUp_(0));const i=this.keyFunction_(n);return delete this.queuedElements_[i],n}enqueue(t){K(!(this.keyFunction_(t)in this.queuedElements_),"Tried to enqueue an `element` that was already added to the queue");const e=this.priorityFunction_(t);return e!=wo&&(this.elements_.push(t),this.priorities_.push(e),this.queuedElements_[this.keyFunction_(t)]=!0,this.siftDown_(0,this.elements_.length-1),!0)}getCount(){return this.elements_.length}getLeftChildIndex_(t){return 2*t+1}getRightChildIndex_(t){return 2*t+2}getParentIndex_(t){return t-1>>1}heapify_(){let t;for(t=(this.elements_.length>>1)-1;t>=0;t--)this.siftUp_(t)}isEmpty(){return 0===this.elements_.length}isKeyQueued(t){return t in this.queuedElements_}isQueued(t){return this.isKeyQueued(this.keyFunction_(t))}siftUp_(t){const e=this.elements_,n=this.priorities_,i=e.length,r=e[t],s=n[t],o=t;for(;t<i>>1;){const r=this.getLeftChildIndex_(t),s=this.getRightChildIndex_(t),o=s<i&&n[s]<n[r]?s:r;e[t]=e[o],n[t]=n[o],t=o}e[t]=r,n[t]=s,this.siftDown_(o,t)}siftDown_(t,e){const n=this.elements_,i=this.priorities_,r=n[e],s=i[e];for(;e>t;){const t=this.getParentIndex_(e);if(!(i[t]>s))break;n[e]=n[t],i[e]=i[t],e=t}n[e]=r,i[e]=s}reprioritize(){const t=this.priorityFunction_,e=this.elements_,n=this.priorities_;let i=0;const r=e.length;let s,o,a;for(o=0;o<r;++o)s=e[o],a=t(s),a==wo?delete this.queuedElements_[this.keyFunction_(s)]:(n[i]=a,e[i++]=s);e.length=i,n.length=i,this.heapify_()}},_o=0,bo=1,Eo=2,So=3,Io=4,Co=class extends xo{constructor(t,e){super((function(e){return t.apply(null,e)}),(function(t){return t[0].getKey()})),this.boundHandleTileChange_=this.handleTileChange.bind(this),this.tileChangeCallback_=e,this.tilesLoading_=0,this.tilesLoadingKeys_={}}enqueue(t){const e=super.enqueue(t);return e&&t[0].addEventListener(x,this.boundHandleTileChange_),e}getTilesLoading(){return this.tilesLoading_}handleTileChange(t){const e=t.target,n=e.getState();if(n===Eo||n===So||n===Io){n!==So&&e.removeEventListener(x,this.boundHandleTileChange_);const t=e.getKey();t in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[t],--this.tilesLoading_),this.tileChangeCallback_()}}loadMoreTiles(t,e){let n,i,r,s=0;for(;this.tilesLoading_<t&&s<e&&this.getCount()>0;)i=this.dequeue()[0],r=i.getKey(),n=i.getState(),n!==_o||r in this.tilesLoadingKeys_||(this.tilesLoadingKeys_[r]=!0,++this.tilesLoading_,++s,i.load())}},Mo=class extends D{constructor(t){super();const e=t.element;!e||t.target||e.style.pointerEvents||(e.style.pointerEvents="auto"),this.element=e||null,this.target_=null,this.map_=null,this.listenerKeys=[],t.render&&(this.render=t.render),t.target&&this.setTarget(t.target)}disposeInternal(){tr(this.element),super.disposeInternal()}getMap(){return this.map_}setMap(t){this.map_&&tr(this.element);for(let t=0,e=this.listenerKeys.length;t<e;++t)P(this.listenerKeys[t]);this.listenerKeys.length=0,this.map_=t,t&&((this.target_?this.target_:t.getOverlayContainerStopEvent()).appendChild(this.element),this.render!==g&&this.listenerKeys.push(M(t,co,this.render,this)),t.render())}render(t){}setTarget(t){this.target_="string"==typeof t?document.getElementById(t):t}},Ro=class extends Mo{constructor(t){t=t||{},super({element:document.createElement("div"),render:t.render,target:t.target}),this.ulElement_=document.createElement("ul"),this.collapsed_=void 0===t.collapsed||t.collapsed,this.userCollapsed_=this.collapsed_,this.overrideCollapsible_=void 0!==t.collapsible,this.collapsible_=void 0===t.collapsible||t.collapsible,this.collapsible_||(this.collapsed_=!1);const e=void 0!==t.className?t.className:"ol-attribution",n=void 0!==t.tipLabel?t.tipLabel:"Attributions",i=void 0!==t.expandClassName?t.expandClassName:e+"-expand",r=void 0!==t.collapseLabel?t.collapseLabel:"",s=void 0!==t.collapseClassName?t.collapseClassName:e+"-collapse";"string"==typeof r?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=r,this.collapseLabel_.className=s):this.collapseLabel_=r;const o=void 0!==t.label?t.label:"i";"string"==typeof o?(this.label_=document.createElement("span"),this.label_.textContent=o,this.label_.className=i):this.label_=o;const a=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_;this.toggleButton_=document.createElement("button"),this.toggleButton_.setAttribute("type","button"),this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_)),this.toggleButton_.title=n,this.toggleButton_.appendChild(a),this.toggleButton_.addEventListener(b,this.handleClick_.bind(this),!1);const l=e+" "+hr+" "+ur+(this.collapsed_&&this.collapsible_?" "+cr:"")+(this.collapsible_?"":" ol-uncollapsible"),h=this.element;h.className=l,h.appendChild(this.toggleButton_),h.appendChild(this.ulElement_),this.renderedAttributions_=[],this.renderedVisible_=!0}collectSourceAttributions_(t){const e=Array.from(new Set(this.getMap().getAllLayers().flatMap((e=>e.getAttributions(t))))),n=!this.getMap().getAllLayers().some((t=>t.getSource()&&!1===t.getSource().getAttributionsCollapsible()));return this.overrideCollapsible_||this.setCollapsible(n),e}async updateElement_(t){if(!t)return void(this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1));const e=await Promise.all(this.collectSourceAttributions_(t).map((t=>m((()=>t))))),n=e.length>0;if(this.renderedVisible_!=n&&(this.element.style.display=n?"":"none",this.renderedVisible_=n),!c(e,this.renderedAttributions_)){!function(t){for(;t.lastChild;)t.removeChild(t.lastChild)}(this.ulElement_);for(let t=0,n=e.length;t<n;++t){const n=document.createElement("li");n.innerHTML=e[t],this.ulElement_.appendChild(n)}this.renderedAttributions_=e}}handleClick_(t){t.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_}handleToggle_(){this.element.classList.toggle(cr),this.collapsed_?Qi(this.collapseLabel_,this.label_):Qi(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))}getCollapsible(){return this.collapsible_}setCollapsible(t){this.collapsible_!==t&&(this.collapsible_=t,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_())}setCollapsed(t){this.userCollapsed_=t,this.collapsible_&&this.collapsed_!==t&&this.handleToggle_()}getCollapsed(){return this.collapsed_}render(t){this.updateElement_(t.frameState)}},Po=class extends Mo{constructor(t){t=t||{},super({element:document.createElement("div"),render:t.render,target:t.target});const e=void 0!==t.className?t.className:"ol-rotate",n=void 0!==t.label?t.label:"",i=void 0!==t.compassClassName?t.compassClassName:"ol-compass";this.label_=null,"string"==typeof n?(this.label_=document.createElement("span"),this.label_.className=i,this.label_.textContent=n):(this.label_=n,this.label_.classList.add(i));const r=t.tipLabel?t.tipLabel:"Reset rotation",s=document.createElement("button");s.className=e+"-reset",s.setAttribute("type","button"),s.title=r,s.appendChild(this.label_),s.addEventListener(b,this.handleClick_.bind(this),!1);const o=e+" "+hr+" "+ur,a=this.element;a.className=o,a.appendChild(s),this.callResetNorth_=t.resetNorth?t.resetNorth:void 0,this.duration_=void 0!==t.duration?t.duration:250,this.autoHide_=void 0===t.autoHide||t.autoHide,this.rotation_=void 0,this.autoHide_&&this.element.classList.add(lr)}handleClick_(t){t.preventDefault(),void 0!==this.callResetNorth_?this.callResetNorth_():this.resetNorth_()}resetNorth_(){const t=this.getMap().getView();if(!t)return;const e=t.getRotation();void 0!==e&&(this.duration_>0&&e%(2*Math.PI)!=0?t.animate({rotation:0,duration:this.duration_,easing:rn}):t.setRotation(0))}render(t){const e=t.frameState;if(!e)return;const n=e.viewState.rotation;if(n!=this.rotation_){const t="rotate("+n+"rad)";if(this.autoHide_){const t=this.element.classList.contains(lr);t||0!==n?t&&0!==n&&this.element.classList.remove(lr):this.element.classList.add(lr)}this.label_.style.transform=t}this.rotation_=n}},To=class extends Mo{constructor(t){t=t||{},super({element:document.createElement("div"),target:t.target});const e=void 0!==t.className?t.className:"ol-zoom",n=void 0!==t.delta?t.delta:1,i=void 0!==t.zoomInClassName?t.zoomInClassName:e+"-in",r=void 0!==t.zoomOutClassName?t.zoomOutClassName:e+"-out",s=void 0!==t.zoomInLabel?t.zoomInLabel:"+",o=void 0!==t.zoomOutLabel?t.zoomOutLabel:"",a=void 0!==t.zoomInTipLabel?t.zoomInTipLabel:"Zoom in",l=void 0!==t.zoomOutTipLabel?t.zoomOutTipLabel:"Zoom out",h=document.createElement("button");h.className=i,h.setAttribute("type","button"),h.title=a,h.appendChild("string"==typeof s?document.createTextNode(s):s),h.addEventListener(b,this.handleClick_.bind(this,n),!1);const u=document.createElement("button");u.className=r,u.setAttribute("type","button"),u.title=l,u.appendChild("string"==typeof o?document.createTextNode(o):o),u.addEventListener(b,this.handleClick_.bind(this,-n),!1);const c=e+" "+hr+" "+ur,f=this.element;f.className=c,f.appendChild(h),f.appendChild(u),this.duration_=void 0!==t.duration?t.duration:250}handleClick_(t,e){e.preventDefault(),this.zoomByDelta_(t)}zoomByDelta_(t){const e=this.getMap().getView();if(!e)return;const n=e.getZoom();if(void 0!==n){const i=e.getConstrainedZoom(n+t);this.duration_>0?(e.getAnimating()&&e.cancelAnimations(),e.animate({zoom:i,duration:this.duration_,easing:rn})):e.setZoom(i)}}},No="active";function Ao(t,e,n,i){const r=t.getZoom();if(void 0===r)return;const s=t.getConstrainedZoom(r+e),o=t.getResolutionForZoom(s);t.getAnimating()&&t.cancelAnimations(),t.animate({resolution:o,anchor:n,duration:void 0!==i?i:250,easing:rn})}const ko=class extends D{constructor(t){super(),this.on,this.once,this.un,t&&t.handleEvent&&(this.handleEvent=t.handleEvent),this.map_=null,this.setActive(!0)}getActive(){return this.get(No)}getMap(){return this.map_}handleEvent(t){return!0}setActive(t){this.set(No,t)}setMap(t){this.map_=t}},Lo=class extends ko{constructor(t){super(),t=t||{},this.delta_=t.delta?t.delta:1,this.duration_=void 0!==t.duration?t.duration:250}handleEvent(t){let e=!1;if(t.type==lo.DBLCLICK){const n=t.originalEvent,i=t.map,r=t.coordinate,s=n.shiftKey?-this.delta_:this.delta_;Ao(i.getView(),s,r,this.duration_),n.preventDefault(),e=!0}return!e}};function Oo(t){const e=t.length;let n=0,i=0;for(let r=0;r<e;r++)n+=t[r].clientX,i+=t[r].clientY;return{clientX:n/e,clientY:i/e}}const Do=class extends ko{constructor(t){super(t=t||{}),t.handleDownEvent&&(this.handleDownEvent=t.handleDownEvent),t.handleDragEvent&&(this.handleDragEvent=t.handleDragEvent),t.handleMoveEvent&&(this.handleMoveEvent=t.handleMoveEvent),t.handleUpEvent&&(this.handleUpEvent=t.handleUpEvent),t.stopDown&&(this.stopDown=t.stopDown),this.handlingDownUpSequence=!1,this.targetPointers=[]}getPointerCount(){return this.targetPointers.length}handleDownEvent(t){return!1}handleDragEvent(t){}handleEvent(t){if(!t.originalEvent)return!0;let e=!1;if(this.updateTrackedPointers_(t),this.handlingDownUpSequence){if(t.type==lo.POINTERDRAG)this.handleDragEvent(t),t.originalEvent.preventDefault();else if(t.type==lo.POINTERUP){const e=this.handleUpEvent(t);this.handlingDownUpSequence=e&&this.targetPointers.length>0}}else if(t.type==lo.POINTERDOWN){const n=this.handleDownEvent(t);this.handlingDownUpSequence=n,e=this.stopDown(n)}else t.type==lo.POINTERMOVE&&this.handleMoveEvent(t);return!e}handleMoveEvent(t){}handleUpEvent(t){return!1}stopDown(t){return t}updateTrackedPointers_(t){t.activePointers&&(this.targetPointers=t.activePointers)}};function Fo(t){const e=arguments;return function(t){let n=!0;for(let i=0,r=e.length;i<r&&(n=n&&e[i](t),n);++i);return n}}const zo=function(t){const e=t.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},Go=function(t){return!t.map.getTargetElement().hasAttribute("tabindex")||function(t){const e=t.map.getTargetElement(),n=t.map.getOwnerDocument().activeElement;return e.contains(n)}(t)},Bo=f,Uo=function(t){const e=t.originalEvent;return 0==e.button&&!(Vi&&Yi&&e.ctrlKey)},qo=function(t){const e=t.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},Vo=function(t){const e=t.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},Yo=function(t){const e=t.originalEvent,n=e.target.tagName;return"INPUT"!==n&&"SELECT"!==n&&"TEXTAREA"!==n&&!e.target.isContentEditable},Xo=function(t){const e=t.originalEvent;return K(void 0!==e,"mapBrowserEvent must originate from a pointer event"),"mouse"==e.pointerType},jo=function(t){const e=t.originalEvent;return K(void 0!==e,"mapBrowserEvent must originate from a pointer event"),e.isPrimary&&0===e.button},Wo=class extends Do{constructor(t){super({stopDown:d}),t=t||{},this.kinetic_=t.kinetic,this.lastCentroid=null,this.lastPointersCount_,this.panning_=!1;const e=t.condition?t.condition:Fo(qo,jo);this.condition_=t.onFocusOnly?Fo(Go,e):e,this.noKinetic_=!1}handleDragEvent(t){const e=t.map;this.panning_||(this.panning_=!0,e.getView().beginInteraction());const n=this.targetPointers,i=e.getEventPixel(Oo(n));if(n.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(i[0],i[1]),this.lastCentroid){const e=[this.lastCentroid[0]-i[0],i[1]-this.lastCentroid[1]],n=t.map.getView();r=e,s=n.getResolution(),r[0]*=s,r[1]*=s,ge(e,n.getRotation()),n.adjustCenterInternal(e)}}else this.kinetic_&&this.kinetic_.begin();var r,s;this.lastCentroid=i,this.lastPointersCount_=n.length,t.originalEvent.preventDefault()}handleUpEvent(t){const e=t.map,n=e.getView();if(0===this.targetPointers.length){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){const t=this.kinetic_.getDistance(),i=this.kinetic_.getAngle(),r=n.getCenterInternal(),s=e.getPixelFromCoordinateInternal(r),o=e.getCoordinateFromPixelInternal([s[0]-t*Math.cos(i),s[1]-t*Math.sin(i)]);n.animateInternal({center:n.getConstrainedCenter(o),duration:500,easing:rn})}return this.panning_&&(this.panning_=!1,n.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0}handleDownEvent(t){if(this.targetPointers.length>0&&this.condition_(t)){const e=t.map.getView();return this.lastCentroid=null,e.getAnimating()&&e.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1}},Ho=class extends Do{constructor(t){t=t||{},super({stopDown:d}),this.condition_=t.condition?t.condition:zo,this.lastAngle_=void 0,this.duration_=void 0!==t.duration?t.duration:250}handleDragEvent(t){if(!Xo(t))return;const e=t.map,n=e.getView();if(n.getConstraints().rotation===tn)return;const i=e.getSize(),r=t.pixel,s=Math.atan2(i[1]/2-r[1],r[0]-i[0]/2);if(void 0!==this.lastAngle_){const t=s-this.lastAngle_;n.adjustRotationInternal(-t)}this.lastAngle_=s}handleUpEvent(t){return!Xo(t)||(t.map.getView().endInteraction(this.duration_),!1)}handleDownEvent(t){return!!Xo(t)&&(!(!Uo(t)||!this.condition_(t))&&(t.map.getView().beginInteraction(),this.lastAngle_=void 0,!0))}},$o=class extends o{constructor(t){super(),this.geometry_=null,this.element_=document.createElement("div"),this.element_.style.position="absolute",this.element_.style.pointerEvents="auto",this.element_.className="ol-box "+t,this.map_=null,this.startPixel_=null,this.endPixel_=null}disposeInternal(){this.setMap(null)}render_(){const t=this.startPixel_,e=this.endPixel_,n="px",i=this.element_.style;i.left=Math.min(t[0],e[0])+n,i.top=Math.min(t[1],e[1])+n,i.width=Math.abs(e[0]-t[0])+n,i.height=Math.abs(e[1]-t[1])+n}setMap(t){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);const t=this.element_.style;t.left="inherit",t.top="inherit",t.width="inherit",t.height="inherit"}this.map_=t,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)}setPixels(t,e){this.startPixel_=t,this.endPixel_=e,this.createOrUpdateGeometry(),this.render_()}createOrUpdateGeometry(){const t=this.startPixel_,e=this.endPixel_,n=[t,[t[0],e[1]],e,[e[0],t[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);n[4]=n[0].slice(),this.geometry_?this.geometry_.setCoordinates([n]):this.geometry_=new ii([n])}getGeometry(){return this.geometry_}};class Zo extends r{constructor(t,e,n){super(t),this.coordinate=e,this.mapBrowserEvent=n}}const Ko=class extends Do{constructor(t){super(),this.on,this.once,this.un,t=t||{},this.box_=new $o(t.className||"ol-dragbox"),this.minArea_=void 0!==t.minArea?t.minArea:64,t.onBoxEnd&&(this.onBoxEnd=t.onBoxEnd),this.startPixel_=null,this.condition_=t.condition?t.condition:Uo,this.boxEndCondition_=t.boxEndCondition?t.boxEndCondition:this.defaultBoxEndCondition}defaultBoxEndCondition(t,e,n){const i=n[0]-e[0],r=n[1]-e[1];return i*i+r*r>=this.minArea_}getGeometry(){return this.box_.getGeometry()}handleDragEvent(t){this.box_.setPixels(this.startPixel_,t.pixel),this.dispatchEvent(new Zo("boxdrag",t.coordinate,t))}handleUpEvent(t){this.box_.setMap(null);const e=this.boxEndCondition_(t,this.startPixel_,t.pixel);return e&&this.onBoxEnd(t),this.dispatchEvent(new Zo(e?"boxend":"boxcancel",t.coordinate,t)),!1}handleDownEvent(t){return!!this.condition_(t)&&(this.startPixel_=t.pixel,this.box_.setMap(t.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new Zo("boxstart",t.coordinate,t)),!0)}onBoxEnd(t){}},Jo=class extends Ko{constructor(t){super({condition:(t=t||{}).condition?t.condition:Vo,className:t.className||"ol-dragzoom",minArea:t.minArea}),this.duration_=void 0!==t.duration?t.duration:200,this.out_=void 0!==t.out&&t.out}onBoxEnd(t){const e=this.getMap().getView();let n=this.getGeometry();if(this.out_){const t=e.rotatedExtentForGeometry(n),i=e.getResolutionForExtentInternal(t),r=e.getResolution()/i;n=n.clone(),n.scale(r*r)}e.fitInternal(n,{duration:this.duration_,easing:rn})}},Qo="ArrowLeft",ta="ArrowRight",ea="ArrowDown",na=class extends ko{constructor(t){super(),t=t||{},this.defaultCondition_=function(t){return qo(t)&&Yo(t)},this.condition_=void 0!==t.condition?t.condition:this.defaultCondition_,this.duration_=void 0!==t.duration?t.duration:100,this.pixelDelta_=void 0!==t.pixelDelta?t.pixelDelta:128}handleEvent(t){let e=!1;if(t.type==E){const n=t.originalEvent,i=n.key;if(this.condition_(t)&&(i==ea||i==Qo||i==ta||"ArrowUp"==i)){const r=t.map.getView(),s=r.getResolution()*this.pixelDelta_;let o=0,a=0;i==ea?a=-s:i==Qo?o=-s:i==ta?o=s:a=s;const l=[o,a];ge(l,r.getRotation()),function(t,e,n){const i=t.getCenterInternal();if(i){const r=[i[0]+e[0],i[1]+e[1]];t.animateInternal({duration:void 0!==n?n:250,easing:on,center:t.getConstrainedCenter(r)})}}(r,l,this.duration_),n.preventDefault(),e=!0}}return!e}},ia=class extends ko{constructor(t){super(),t=t||{},this.condition_=t.condition?t.condition:function(t){return!function(t){const e=t.originalEvent;return Yi?e.metaKey:e.ctrlKey}(t)&&Yo(t)},this.delta_=t.delta?t.delta:1,this.duration_=void 0!==t.duration?t.duration:100}handleEvent(t){let e=!1;if(t.type==E||t.type==S){const n=t.originalEvent,i=n.key;if(this.condition_(t)&&("+"===i||"-"===i)){const r=t.map,s="+"===i?this.delta_:-this.delta_;Ao(r.getView(),s,void 0,this.duration_),n.preventDefault(),e=!0}}return!e}},ra=class{constructor(t,e,n){this.decay_=t,this.minVelocity_=e,this.delay_=n,this.points_=[],this.angle_=0,this.initialVelocity_=0}begin(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0}update(t,e){this.points_.push(t,e,Date.now())}end(){if(this.points_.length<6)return!1;const t=Date.now()-this.delay_,e=this.points_.length-3;if(this.points_[e+2]<t)return!1;let n=e-3;for(;n>0&&this.points_[n+2]>t;)n-=3;const i=this.points_[e+2]-this.points_[n+2];if(i<1e3/60)return!1;const r=this.points_[e]-this.points_[n],s=this.points_[e+1]-this.points_[n+1];return this.angle_=Math.atan2(s,r),this.initialVelocity_=Math.sqrt(r*r+s*s)/i,this.initialVelocity_>this.minVelocity_}getDistance(){return(this.minVelocity_-this.initialVelocity_)/this.decay_}getAngle(){return this.angle_}},sa=class extends ko{constructor(t){super(t=t||{}),this.totalDelta_=0,this.lastDelta_=0,this.maxDelta_=void 0!==t.maxDelta?t.maxDelta:1,this.duration_=void 0!==t.duration?t.duration:250,this.timeout_=void 0!==t.timeout?t.timeout:80,this.useAnchor_=void 0===t.useAnchor||t.useAnchor,this.constrainResolution_=void 0!==t.constrainResolution&&t.constrainResolution;const e=t.condition?t.condition:Bo;this.condition_=t.onFocusOnly?Fo(Go,e):e,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_,this.mode_=void 0,this.trackpadEventGap_=400,this.trackpadTimeoutId_,this.deltaPerZoom_=300}endInteraction_(){this.trackpadTimeoutId_=void 0;const t=this.getMap();t&&t.getView().endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_)}handleEvent(t){if(!this.condition_(t))return!0;if(t.type!==C)return!0;const e=t.map,n=t.originalEvent;let i;if(n.preventDefault(),this.useAnchor_&&(this.lastAnchor_=t.coordinate),t.type==C&&(i=n.deltaY,qi&&n.deltaMode===WheelEvent.DOM_DELTA_PIXEL&&(i/=Xi),n.deltaMode===WheelEvent.DOM_DELTA_LINE&&(i*=40)),0===i)return!1;this.lastDelta_=i;const r=Date.now();void 0===this.startTime_&&(this.startTime_=r),(!this.mode_||r-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(i)<4?"trackpad":"wheel");const s=e.getView();if("trackpad"===this.mode_&&!s.getConstrainResolution()&&!this.constrainResolution_)return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(s.getAnimating()&&s.cancelAnimations(),s.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),s.adjustZoom(-i/this.deltaPerZoom_,this.lastAnchor_),this.startTime_=r,!1;this.totalDelta_+=i;const o=Math.max(this.timeout_-(r-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,e),o),!1}handleWheelZoom_(t){const e=t.getView();e.getAnimating()&&e.cancelAnimations();let n=-J(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(e.getConstrainResolution()||this.constrainResolution_)&&(n=n?n>0?1:-1:0),Ao(e,n,this.lastAnchor_,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0}setMouseAnchor(t){this.useAnchor_=t,t||(this.lastAnchor_=null)}},oa=class extends Do{constructor(t){const e=t=t||{};e.stopDown||(e.stopDown=d),super(e),this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.threshold_=void 0!==t.threshold?t.threshold:.3,this.duration_=void 0!==t.duration?t.duration:250}handleDragEvent(t){let e=0;const n=this.targetPointers[0],i=this.targetPointers[1],r=Math.atan2(i.clientY-n.clientY,i.clientX-n.clientX);if(void 0!==this.lastAngle_){const t=r-this.lastAngle_;this.rotationDelta_+=t,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),e=t}this.lastAngle_=r;const s=t.map,o=s.getView();o.getConstraints().rotation!==tn&&(this.anchor_=s.getCoordinateFromPixelInternal(s.getEventPixel(Oo(this.targetPointers))),this.rotating_&&(s.render(),o.adjustRotationInternal(e,this.anchor_)))}handleUpEvent(t){return!(this.targetPointers.length<2)||(t.map.getView().endInteraction(this.duration_),!1)}handleDownEvent(t){if(this.targetPointers.length>=2){const e=t.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||e.getView().beginInteraction(),!0}return!1}},aa=class extends Do{constructor(t){const e=t=t||{};e.stopDown||(e.stopDown=d),super(e),this.anchor_=null,this.duration_=void 0!==t.duration?t.duration:400,this.lastDistance_=void 0,this.lastScaleDelta_=1}handleDragEvent(t){let e=1;const n=this.targetPointers[0],i=this.targetPointers[1],r=n.clientX-i.clientX,s=n.clientY-i.clientY,o=Math.sqrt(r*r+s*s);void 0!==this.lastDistance_&&(e=this.lastDistance_/o),this.lastDistance_=o;const a=t.map,l=a.getView();1!=e&&(this.lastScaleDelta_=e),this.anchor_=a.getCoordinateFromPixelInternal(a.getEventPixel(Oo(this.targetPointers))),a.render(),l.adjustResolutionInternal(e,this.anchor_)}handleUpEvent(t){if(this.targetPointers.length<2){const e=t.map.getView(),n=this.lastScaleDelta_>1?1:-1;return e.endInteraction(this.duration_,n),!1}return!0}handleDownEvent(t){if(this.targetPointers.length>=2){const e=t.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||e.getView().beginInteraction(),!0}return!1}};function la(t){t instanceof ui?t.setMapInternal(null):t instanceof so&&t.getLayers().forEach(la)}function ha(t,e){if(t instanceof ui)t.setMapInternal(e);else if(t instanceof so){const n=t.getLayers().getArray();for(let t=0,i=n.length;t<i;++t)ha(n[t],e)}}const ua=class extends D{constructor(t){super(),t=t||{},this.on,this.once,this.un;const e=function(t){let e=null;void 0!==t.keyboardEventTarget&&(e="string"==typeof t.keyboardEventTarget?document.getElementById(t.keyboardEventTarget):t.keyboardEventTarget);const n={},i=t.layers&&"function"==typeof t.layers.getLayers?t.layers:new so({layers:t.layers});let r,s,o;return n[po]=i,n[yo]=t.target,n[vo]=t.view instanceof li?t.view:new li,void 0!==t.controls&&(Array.isArray(t.controls)?r=new U(t.controls.slice()):(K("function"==typeof t.controls.getArray,"Expected `controls` to be an array or an `ol/Collection.js`"),r=t.controls)),void 0!==t.interactions&&(Array.isArray(t.interactions)?s=new U(t.interactions.slice()):(K("function"==typeof t.interactions.getArray,"Expected `interactions` to be an array or an `ol/Collection.js`"),s=t.interactions)),void 0!==t.overlays?Array.isArray(t.overlays)?o=new U(t.overlays.slice()):(K("function"==typeof t.overlays.getArray,"Expected `overlays` to be an array or an `ol/Collection.js`"),o=t.overlays):o=new U,{controls:r,interactions:s,keyboardEventTarget:e,overlays:o,values:n}}(t);this.renderComplete_,this.loaded_=!0,this.boundHandleBrowserEvent_=this.handleBrowserEvent.bind(this),this.maxTilesLoading_=void 0!==t.maxTilesLoading?t.maxTilesLoading:16,this.pixelRatio_=void 0!==t.pixelRatio?t.pixelRatio:Xi,this.postRenderTimeoutHandle_,this.animationDelayKey_,this.animationDelay_=this.animationDelay_.bind(this),this.coordinateToPixelTransform_=[1,0,0,1,0,0],this.pixelToCoordinateTransform_=[1,0,0,1,0,0],this.frameIndex_=0,this.frameState_=null,this.previousExtent_=null,this.viewPropertyListenerKey_=null,this.viewChangeListenerKey_=null,this.layerGroupPropertyListenerKeys_=null,this.viewport_=document.createElement("div"),this.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),this.viewport_.style.position="relative",this.viewport_.style.overflow="hidden",this.viewport_.style.width="100%",this.viewport_.style.height="100%",this.overlayContainer_=document.createElement("div"),this.overlayContainer_.style.position="absolute",this.overlayContainer_.style.zIndex="0",this.overlayContainer_.style.width="100%",this.overlayContainer_.style.height="100%",this.overlayContainer_.style.pointerEvents="none",this.overlayContainer_.className="ol-overlaycontainer",this.viewport_.appendChild(this.overlayContainer_),this.overlayContainerStopEvent_=document.createElement("div"),this.overlayContainerStopEvent_.style.position="absolute",this.overlayContainerStopEvent_.style.zIndex="0",this.overlayContainerStopEvent_.style.width="100%",this.overlayContainerStopEvent_.style.height="100%",this.overlayContainerStopEvent_.style.pointerEvents="none",this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",this.viewport_.appendChild(this.overlayContainerStopEvent_),this.mapBrowserEventHandler_=null,this.moveTolerance_=t.moveTolerance,this.keyboardEventTarget_=e.keyboardEventTarget,this.targetChangeHandlerKeys_=null,this.targetElement_=null,this.resizeObserver_=new ResizeObserver((()=>this.updateSize())),this.controls=e.controls||function(t){t=t||{};const e=new U;return(void 0===t.zoom||t.zoom)&&e.push(new To(t.zoomOptions)),(void 0===t.rotate||t.rotate)&&e.push(new Po(t.rotateOptions)),(void 0===t.attribution||t.attribution)&&e.push(new Ro(t.attributionOptions)),e}(),this.interactions=e.interactions||function(t){t=t||{};const e=new U,n=new ra(-.005,.05,100);return(void 0===t.altShiftDragRotate||t.altShiftDragRotate)&&e.push(new Ho),(void 0===t.doubleClickZoom||t.doubleClickZoom)&&e.push(new Lo({delta:t.zoomDelta,duration:t.zoomDuration})),(void 0===t.dragPan||t.dragPan)&&e.push(new Wo({onFocusOnly:t.onFocusOnly,kinetic:n})),(void 0===t.pinchRotate||t.pinchRotate)&&e.push(new oa),(void 0===t.pinchZoom||t.pinchZoom)&&e.push(new aa({duration:t.zoomDuration})),(void 0===t.keyboard||t.keyboard)&&(e.push(new na),e.push(new ia({delta:t.zoomDelta,duration:t.zoomDuration}))),(void 0===t.mouseWheelZoom||t.mouseWheelZoom)&&e.push(new sa({onFocusOnly:t.onFocusOnly,duration:t.zoomDuration})),(void 0===t.shiftDragZoom||t.shiftDragZoom)&&e.push(new Jo({duration:t.zoomDuration})),e}({onFocusOnly:!0}),this.overlays_=e.overlays,this.overlayIdIndex_={},this.renderer_=null,this.postRenderFunctions_=[],this.tileQueue_=new Co(this.getTilePriority.bind(this),this.handleTileChange_.bind(this)),this.addChangeListener(po,this.handleLayerGroupChanged_),this.addChangeListener(vo,this.handleViewChanged_),this.addChangeListener(mo,this.handleSizeChanged_),this.addChangeListener(yo,this.handleTargetChanged_),this.setProperties(e.values);const n=this;!t.view||t.view instanceof li||t.view.then((function(t){n.setView(new li(t))})),this.controls.addEventListener(F,(t=>{t.element.setMap(this)})),this.controls.addEventListener(z,(t=>{t.element.setMap(null)})),this.interactions.addEventListener(F,(t=>{t.element.setMap(this)})),this.interactions.addEventListener(z,(t=>{t.element.setMap(null)})),this.overlays_.addEventListener(F,(t=>{this.addOverlayInternal_(t.element)})),this.overlays_.addEventListener(z,(t=>{const e=t.element.getId();void 0!==e&&delete this.overlayIdIndex_[e.toString()],t.element.setMap(null)})),this.controls.forEach((t=>{t.setMap(this)})),this.interactions.forEach((t=>{t.setMap(this)})),this.overlays_.forEach(this.addOverlayInternal_.bind(this))}addControl(t){this.getControls().push(t)}addInteraction(t){this.getInteractions().push(t)}addLayer(t){this.getLayerGroup().getLayers().push(t)}handleLayerAdd_(t){ha(t.layer,this)}addOverlay(t){this.getOverlays().push(t)}addOverlayInternal_(t){const e=t.getId();void 0!==e&&(this.overlayIdIndex_[e.toString()]=t),t.setMap(this)}disposeInternal(){this.controls.clear(),this.interactions.clear(),this.overlays_.clear(),this.resizeObserver_.disconnect(),this.setTarget(null),super.disposeInternal()}forEachFeatureAtPixel(t,e,n){if(!this.frameState_||!this.renderer_)return;const i=this.getCoordinateFromPixelInternal(t),r=void 0!==(n=void 0!==n?n:{}).hitTolerance?n.hitTolerance:0,s=void 0!==n.layerFilter?n.layerFilter:f,o=!1!==n.checkWrapped;return this.renderer_.forEachFeatureAtCoordinate(i,this.frameState_,r,o,e,null,s,null)}getFeaturesAtPixel(t,e){const n=[];return this.forEachFeatureAtPixel(t,(function(t){n.push(t)}),e),n}getAllLayers(){const t=[];return function e(n){n.forEach((function(n){n instanceof so?e(n.getLayers()):t.push(n)}))}(this.getLayers()),t}hasFeatureAtPixel(t,e){if(!this.frameState_||!this.renderer_)return!1;const n=this.getCoordinateFromPixelInternal(t),i=void 0!==(e=void 0!==e?e:{}).layerFilter?e.layerFilter:f,r=void 0!==e.hitTolerance?e.hitTolerance:0,s=!1!==e.checkWrapped;return this.renderer_.hasFeatureAtCoordinate(n,this.frameState_,r,s,i,null)}getEventCoordinate(t){return this.getCoordinateFromPixel(this.getEventPixel(t))}getEventCoordinateInternal(t){return this.getCoordinateFromPixelInternal(this.getEventPixel(t))}getEventPixel(t){const e=this.viewport_.getBoundingClientRect(),n=this.getSize(),i=e.width/n[0],r=e.height/n[1],s="changedTouches"in t?t.changedTouches[0]:t;return[(s.clientX-e.left)/i,(s.clientY-e.top)/r]}getTarget(){return this.get(yo)}getTargetElement(){return this.targetElement_}getCoordinateFromPixel(t){return Ue(this.getCoordinateFromPixelInternal(t),this.getView().getProjection())}getCoordinateFromPixelInternal(t){const e=this.frameState_;return e?an(e.pixelToCoordinateTransform,t.slice()):null}getControls(){return this.controls}getOverlays(){return this.overlays_}getOverlayById(t){const e=this.overlayIdIndex_[t.toString()];return void 0!==e?e:null}getInteractions(){return this.interactions}getLayerGroup(){return this.get(po)}setLayers(t){const e=this.getLayerGroup();if(t instanceof U)return void e.setLayers(t);const n=e.getLayers();n.clear(),n.extend(t)}getLayers(){return this.getLayerGroup().getLayers()}getLoadingOrNotReady(){const t=this.getLayerGroup().getLayerStatesArray();for(let e=0,n=t.length;e<n;++e){const n=t[e];if(!n.visible)continue;const i=n.layer.getRenderer();if(i&&!i.ready)return!0;const r=n.layer.getSource();if(r&&r.loading)return!0}return!1}getPixelFromCoordinate(t){const e=qe(t,this.getView().getProjection());return this.getPixelFromCoordinateInternal(e)}getPixelFromCoordinateInternal(t){const e=this.frameState_;return e?an(e.coordinateToPixelTransform,t.slice(0,2)):null}getRenderer(){return this.renderer_}getSize(){return this.get(mo)}getView(){return this.get(vo)}getViewport(){return this.viewport_}getOverlayContainer(){return this.overlayContainer_}getOverlayContainerStopEvent(){return this.overlayContainerStopEvent_}getOwnerDocument(){const t=this.getTargetElement();return t?t.ownerDocument:document}getTilePriority(t,e,n,i){return function(t,e,n,i,r){if(!t||!(n in t.wantedTiles))return wo;if(!t.wantedTiles[n][e.getKey()])return wo;const s=t.viewState.center,o=i[0]-s[0],a=i[1]-s[1];return 65536*Math.log(r)+Math.sqrt(o*o+a*a)/r}(this.frameState_,t,e,n,i)}handleBrowserEvent(t,e){e=e||t.type;const n=new ao(e,this,t);this.handleMapBrowserEvent(n)}handleMapBrowserEvent(t){if(!this.frameState_)return;const e=t.originalEvent,n=e.type;if(n===ho||n===C||n===E){const t=this.getOwnerDocument(),n=this.viewport_.getRootNode?this.viewport_.getRootNode():t,i=e.target;if(this.overlayContainerStopEvent_.contains(i)||!(n===t?t.documentElement:n).contains(i))return}if(t.frameState=this.frameState_,!1!==this.dispatchEvent(t)){const e=this.getInteractions().getArray().slice();for(let n=e.length-1;n>=0;n--){const i=e[n];if(i.getMap()===this&&i.getActive()&&this.getTargetElement()&&(!i.handleEvent(t)||t.propagationStopped))break}}}handlePostRender(){const t=this.frameState_,e=this.tileQueue_;if(!e.isEmpty()){let n=this.maxTilesLoading_,i=n;if(t){const e=t.viewHints;if(e[0]||e[1]){const e=Date.now()-t.time>8;n=e?0:8,i=e?0:2}}e.getTilesLoading()<n&&(e.reprioritize(),e.loadMoreTiles(n,i))}t&&this.renderer_&&!t.animate&&(!0===this.renderComplete_?(this.hasListener(ft)&&this.renderer_.dispatchRenderEvent(ft,t),!1===this.loaded_&&(this.loaded_=!0,this.dispatchEvent(new oo(go,this,t)))):!0===this.loaded_&&(this.loaded_=!1,this.dispatchEvent(new oo(fo,this,t))));const n=this.postRenderFunctions_;for(let e=0,i=n.length;e<i;++e)n[e](this,t);n.length=0}handleSizeChanged_(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()}handleTargetChanged_(){if(this.mapBrowserEventHandler_){for(let t=0,e=this.targetChangeHandlerKeys_.length;t<e;++t)P(this.targetChangeHandlerKeys_[t]);this.targetChangeHandlerKeys_=null,this.viewport_.removeEventListener(_,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(C,this.boundHandleBrowserEvent_),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,tr(this.viewport_)}if(this.targetElement_){this.resizeObserver_.unobserve(this.targetElement_);const t=this.targetElement_.getRootNode();t instanceof ShadowRoot&&this.resizeObserver_.unobserve(t.host),this.setSize(void 0)}const t=this.getTarget(),e="string"==typeof t?document.getElementById(t):t;if(this.targetElement_=e,e){e.appendChild(this.viewport_),this.renderer_||(this.renderer_=new eo(this)),this.mapBrowserEventHandler_=new uo(this,this.moveTolerance_);for(const t in lo)this.mapBrowserEventHandler_.addEventListener(lo[t],this.handleMapBrowserEvent.bind(this));this.viewport_.addEventListener(_,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(C,this.boundHandleBrowserEvent_,!!Hi&&{passive:!1});const t=this.keyboardEventTarget_?this.keyboardEventTarget_:e;this.targetChangeHandlerKeys_=[M(t,E,this.handleBrowserEvent,this),M(t,S,this.handleBrowserEvent,this)];const n=e.getRootNode();n instanceof ShadowRoot&&this.resizeObserver_.observe(n.host),this.resizeObserver_.observe(e)}else this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);this.updateSize()}handleTileChange_(){this.render()}handleViewPropertyChanged_(){this.render()}handleViewChanged_(){this.viewPropertyListenerKey_&&(P(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(P(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);const t=this.getView();t&&(this.updateViewportSize_(this.getSize()),this.viewPropertyListenerKey_=M(t,s,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=M(t,x,this.handleViewPropertyChanged_,this),t.resolveConstraints(0)),this.render()}handleLayerGroupChanged_(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(P),this.layerGroupPropertyListenerKeys_=null);const t=this.getLayerGroup();t&&(this.handleLayerAdd_(new no("addlayer",t)),this.layerGroupPropertyListenerKeys_=[M(t,s,this.render,this),M(t,x,this.render,this),M(t,"addlayer",this.handleLayerAdd_,this),M(t,"removelayer",this.handleLayerRemove_,this)]),this.render()}isRendered(){return!!this.frameState_}animationDelay_(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}renderSync(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()}redrawText(){const t=this.getLayerGroup().getLayerStatesArray();for(let e=0,n=t.length;e<n;++e){const n=t[e].layer;n.hasRenderer()&&n.getRenderer().handleFontsChanged()}}render(){this.renderer_&&void 0===this.animationDelayKey_&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))}removeControl(t){return this.getControls().remove(t)}removeInteraction(t){return this.getInteractions().remove(t)}removeLayer(t){return this.getLayerGroup().getLayers().remove(t)}handleLayerRemove_(t){la(t.layer)}removeOverlay(t){return this.getOverlays().remove(t)}renderFrame_(t){const e=this.getSize(),n=this.getView(),i=this.frameState_;let r=null;if(void 0!==e&&yi(e)&&n&&n.isDef()){const i=n.getHints(this.frameState_?this.frameState_.viewHints:void 0),s=n.getState();if(r={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutter:null,extent:ne(s.center,s.resolution,s.rotation,e),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:e,tileQueue:this.tileQueue_,time:t,usedTiles:{},viewState:s,viewHints:i,wantedTiles:{},mapId:L(this),renderTargets:{}},s.nextCenter&&s.nextResolution){const t=isNaN(s.nextRotation)?s.rotation:s.nextRotation;r.nextExtent=ne(s.nextCenter,s.nextResolution,t,e)}}this.frameState_=r,this.renderer_.renderFrame(r),r&&(r.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,r.postRenderFunctions),i&&(!this.previousExtent_||!ue(this.previousExtent_)&&!Xt(r.extent,this.previousExtent_))&&(this.dispatchEvent(new oo("movestart",this,i)),this.previousExtent_=qt(this.previousExtent_)),this.previousExtent_&&!r.viewHints[0]&&!r.viewHints[1]&&!Xt(r.extent,this.previousExtent_)&&(this.dispatchEvent(new oo("moveend",this,r)),Ot(r.extent,this.previousExtent_))),this.dispatchEvent(new oo(co,this,r)),this.renderComplete_=this.hasListener(fo)||this.hasListener(go)||this.hasListener(ft)?!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoadingOrNotReady():void 0,this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout((()=>{this.postRenderTimeoutHandle_=void 0,this.handlePostRender()}),0))}setLayerGroup(t){const e=this.getLayerGroup();e&&this.handleLayerRemove_(new no("removelayer",e)),this.set(po,t)}setSize(t){this.set(mo,t)}setTarget(t){this.set(yo,t)}setView(t){if(!t||t instanceof li)return void this.set(vo,t);this.set(vo,new li);const e=this;t.then((function(t){e.setView(new li(t))}))}updateSize(){const t=this.getTargetElement();let e;if(t){const n=getComputedStyle(t),i=t.offsetWidth-parseFloat(n.borderLeftWidth)-parseFloat(n.paddingLeft)-parseFloat(n.paddingRight)-parseFloat(n.borderRightWidth),r=t.offsetHeight-parseFloat(n.borderTopWidth)-parseFloat(n.paddingTop)-parseFloat(n.paddingBottom)-parseFloat(n.borderBottomWidth);isNaN(i)||isNaN(r)||(e=[i,r],!yi(e)&&(t.offsetWidth||t.offsetHeight||t.getClientRects().length)&&Se("No map visible because the map container's width or height are 0."))}const n=this.getSize();!e||n&&c(e,n)||(this.setSize(e),this.updateViewportSize_(e))}updateViewportSize_(t){const e=this.getView();e&&e.setViewportSize(t)}},ca="preload",fa="useInterimTilesOnError",da=class extends ui{constructor(t){t=t||{};const e=Object.assign({},t);delete e.preload,delete e.useInterimTilesOnError,super(e),this.on,this.once,this.un,this.setPreload(void 0!==t.preload?t.preload:0),this.setUseInterimTilesOnError(void 0===t.useInterimTilesOnError||t.useInterimTilesOnError)}getPreload(){return this.get(ca)}setPreload(t){this.set(ca,t)}getUseInterimTilesOnError(){return this.get(fa)}setUseInterimTilesOnError(t){this.set(fa,t)}getData(t){return super.getData(t)}},ga=class extends N{constructor(t){super(),this.ready=!0,this.boundHandleImageChange_=this.handleImageChange_.bind(this),this.layer_=t,this.declutterExecutorGroup=null}getFeatures(t){return A()}getData(t){return null}prepareFrame(t){return A()}renderFrame(t,e){return A()}loadedTileCallback(t,e,n){t[e]||(t[e]={}),t[e][n.tileCoord.toString()]=n}createLoadedTileFinder(t,e,n){return(i,r)=>{const s=this.loadedTileCallback.bind(this,n,i);return t.forEachLoadedTile(e,i,r,s)}}forEachFeatureAtCoordinate(t,e,n,i,r){}getLayer(){return this.layer_}handleFontsChanged(){}handleImageChange_(t){const e=t.target;e.getState()!==gi&&e.getState()!==pi||this.renderIfReadyAndVisible()}loadImage(t){let e=t.getState();return e!=gi&&e!=pi&&t.addEventListener(x,this.boundHandleImageChange_),e==fi&&(t.load(),e=t.getState()),e==gi}renderIfReadyAndVisible(){const t=this.getLayer();t&&t.getVisible()&&"ready"===t.getSourceState()&&t.changed()}renderDeferred(t){}disposeInternal(){delete this.layer_,super.disposeInternal()}},pa=class{constructor(){this.instructions_=[],this.zIndex=0,this.offset_=0,this.context_=new Proxy(CanvasRenderingContext2D.prototype,{get:(t,e)=>{if("function"==typeof Ki()[e])return this.instructions_[this.zIndex+this.offset_]||(this.instructions_[this.zIndex+this.offset_]=[]),this.instructions_[this.zIndex+this.offset_].push(e),this.pushMethodArgs_},set:(t,e,n)=>(this.instructions_[this.zIndex+this.offset_]||(this.instructions_[this.zIndex+this.offset_]=[]),this.instructions_[this.zIndex+this.offset_].push(e,n),!0)})}pushMethodArgs_=(...t)=>(this.instructions_[this.zIndex+this.offset_].push(t),this);getContext(){return this.context_}draw(t){this.instructions_.forEach((e=>{for(let n=0,i=e.length;n<i;n+=2){const i=e[n],r=e[n+1];if("function"==typeof t[i])t[i](...r);else{if("function"==typeof r){t[i]=r(t);continue}t[i]=r}}}))}clear(){this.instructions_.length=0,this.zIndex=0,this.offset_=0}offset(){this.offset_=this.instructions_.length,this.zIndex=0}},ma=[];let ya=null;const va=class extends ga{constructor(t){super(t),this.container=null,this.renderedResolution,this.tempTransform=[1,0,0,1,0,0],this.pixelTransform=[1,0,0,1,0,0],this.inversePixelTransform=[1,0,0,1,0,0],this.context=null,this.deferredContext_=null,this.containerReused=!1,this.pixelContext_=null,this.frameState=null}getImageData(t,e,n){let i;ya||(ya=$i(1,1,void 0,{willReadFrequently:!0})),ya.clearRect(0,0,1,1);try{ya.drawImage(t,e,n,1,1,0,0,1,1),i=ya.getImageData(0,0,1,1).data}catch(t){return ya=null,null}return i}getBackground(t){let e=this.getLayer().getBackground();return"function"==typeof e&&(e=e(t.viewState.resolution)),e||void 0}useContainer(t,e,n){const i=this.getLayer().getClassName();let r,s;if(t&&t.className===i&&(!n||t&&t.style.backgroundColor&&c(zi(t.style.backgroundColor),zi(n)))){const e=t.firstElementChild;e instanceof HTMLCanvasElement&&(s=e.getContext("2d"))}if(s&&s.canvas.style.transform===e?(this.container=t,this.context=s,this.containerReused=!0):this.containerReused?(this.container=null,this.context=null,this.containerReused=!1):this.container&&(this.container.style.backgroundColor=null),!this.container){r=document.createElement("div"),r.className=i;let t=r.style;t.position="absolute",t.width="100%",t.height="100%",s=$i();const e=s.canvas;r.appendChild(e),t=e.style,t.position="absolute",t.left="0",t.transformOrigin="top left",this.container=r,this.context=s}this.containerReused||!n||this.container.style.backgroundColor||(this.container.style.backgroundColor=n)}clipUnrotated(t,e,n){const i=oe(n),r=ae(n),s=Qt(n),o=Jt(n);an(e.coordinateToPixelTransform,i),an(e.coordinateToPixelTransform,r),an(e.coordinateToPixelTransform,s),an(e.coordinateToPixelTransform,o);const a=this.inversePixelTransform;an(a,i),an(a,r),an(a,s),an(a,o),t.save(),t.beginPath(),t.moveTo(Math.round(i[0]),Math.round(i[1])),t.lineTo(Math.round(r[0]),Math.round(r[1])),t.lineTo(Math.round(s[0]),Math.round(s[1])),t.lineTo(Math.round(o[0]),Math.round(o[1])),t.clip()}dispatchRenderEvent_(t,e,n){const i=this.getLayer();if(i.hasListener(t)){const r=new to(t,this.inversePixelTransform,n,e);i.dispatchEvent(r)}}preRender(t,e){this.frameState=e,e.declutter||this.dispatchRenderEvent_(ht,t,e)}postRender(t,e){e.declutter||this.dispatchRenderEvent_(ut,t,e)}renderDeferredInternal(t){}getRenderContext(t){return t.declutter&&!this.deferredContext_&&(this.deferredContext_=new pa),t.declutter?this.deferredContext_.getContext():this.context}renderDeferred(t){t.declutter&&(this.dispatchRenderEvent_(ht,this.context,t),t.declutter&&this.deferredContext_&&(this.deferredContext_.draw(this.context),this.deferredContext_.clear()),this.renderDeferredInternal(t),this.dispatchRenderEvent_(ut,this.context,t))}getRenderTransform(t,e,n,i,r,s,o){const a=r/2,l=s/2,h=i/e,u=-h,c=-t[0]+o,f=-t[1];return ln(this.tempTransform,a,l,h,u,-n,c,f)}disposeInternal(){delete this.frameState,super.disposeInternal()}},wa=class extends w{constructor(t,e,n){super(),n=n||{},this.tileCoord=t,this.state=e,this.interimTile=null,this.key="",this.transition_=void 0===n.transition?250:n.transition,this.transitionStarts_={},this.interpolate=!!n.interpolate}changed(){this.dispatchEvent(x)}release(){this.state===So&&this.setState(Io)}getKey(){return this.key+"/"+this.tileCoord}getInterimTile(){let t=this.interimTile;if(!t)return this;do{if(t.getState()==Eo)return this.transition_=0,t;t=t.interimTile}while(t);return this}refreshInterimChain(){let t=this.interimTile;if(!t)return;let e=this;do{if(t.getState()==Eo){t.interimTile=null;break}t.getState()==bo?e=t:t.getState()==_o?e.interimTile=t.interimTile:e=t,t=e.interimTile}while(t)}getTileCoord(){return this.tileCoord}getState(){return this.state}setState(t){if(this.state!==So&&this.state>t)throw new Error("Tile load sequence violation");this.state=t,this.changed()}load(){A()}getAlpha(t,e){if(!this.transition_)return 1;let n=this.transitionStarts_[t];if(n){if(-1===n)return 1}else n=e,this.transitionStarts_[t]=n;const i=e-n+1e3/60;return i>=this.transition_?1:nn(i/this.transition_)}inTransition(t){return!!this.transition_&&-1!==this.transitionStarts_[t]}endTransition(t){this.transition_&&(this.transitionStarts_[t]=-1)}},xa=class extends wa{constructor(t,e,n,i,r,s){super(t,e,s),this.crossOrigin_=i,this.src_=n,this.key=n,this.image_=new Image,null!==i&&(this.image_.crossOrigin=i),this.unlisten_=null,this.tileLoadFunction_=r}getImage(){return this.image_}setImage(t){this.image_=t,this.state=Eo,this.unlistenImage_(),this.changed()}handleImageError_(){this.state=So,this.unlistenImage_(),this.image_=function(){const t=$i(1,1);return t.fillStyle="rgba(0,0,0,0)",t.fillRect(0,0,1,1),t.canvas}(),this.changed()}handleImageLoad_(){const t=this.image_;t.naturalWidth&&t.naturalHeight?this.state=Eo:this.state=Io,this.unlistenImage_(),this.changed()}load(){this.state==So&&(this.state=_o,this.image_=new Image,null!==this.crossOrigin_&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==_o&&(this.state=bo,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=function(t,e,n){const i=t;let r=!0,s=!1,o=!1;const a=[R(i,"load",(function(){o=!0,s||e()}))];return i.src&&Wi?(s=!0,i.decode().then((function(){r&&e()})).catch((function(t){r&&(o?e():n())}))):a.push(R(i,"error",n)),function(){r=!1,a.forEach(P)}}(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}},_a=class{constructor(t,e,n,i,r,s){this.sourceProj_=t,this.targetProj_=e;let o={};const a=De(this.targetProj_,this.sourceProj_);this.transformInv_=function(t){const e=t[0]+"/"+t[1];return o[e]||(o[e]=a(t)),o[e]},this.maxSourceExtent_=i,this.errorThresholdSquared_=r*r,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!i&&!!this.sourceProj_.getExtent()&&le(i)>=le(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?le(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?le(this.targetProj_.getExtent()):null;const l=oe(n),h=ae(n),u=Qt(n),c=Jt(n),f=this.transformInv_(l),d=this.transformInv_(h),g=this.transformInv_(u),p=this.transformInv_(c),m=10+(s?Math.max(0,Math.ceil(Math.log2(Kt(n)/(s*s*256*256)))):0);if(this.addQuad_(l,h,u,c,f,d,g,p,m),this.wrapsXInSource_){let t=1/0;this.triangles_.forEach((function(e,n,i){t=Math.min(t,e.source[0][0],e.source[1][0],e.source[2][0])})),this.triangles_.forEach((e=>{if(Math.max(e.source[0][0],e.source[1][0],e.source[2][0])-t>this.sourceWorldWidth_/2){const n=[[e.source[0][0],e.source[0][1]],[e.source[1][0],e.source[1][1]],[e.source[2][0],e.source[2][1]]];n[0][0]-t>this.sourceWorldWidth_/2&&(n[0][0]-=this.sourceWorldWidth_),n[1][0]-t>this.sourceWorldWidth_/2&&(n[1][0]-=this.sourceWorldWidth_),n[2][0]-t>this.sourceWorldWidth_/2&&(n[2][0]-=this.sourceWorldWidth_);const i=Math.min(n[0][0],n[1][0],n[2][0]);Math.max(n[0][0],n[1][0],n[2][0])-i<this.sourceWorldWidth_/2&&(e.source=n)}}))}o={}}addTriangle_(t,e,n,i,r,s){this.triangles_.push({source:[i,r,s],target:[t,e,n]})}addQuad_(t,e,n,i,r,s,o,a,l){const h=kt([r,s,o,a]),u=this.sourceWorldWidth_?le(h)/this.sourceWorldWidth_:null,c=this.sourceWorldWidth_,f=this.sourceProj_.canWrapX()&&u>.5&&u<1;let d=!1;if(l>0&&(this.targetProj_.isGlobal()&&this.targetWorldWidth_&&(d=le(kt([t,e,n,i]))/this.targetWorldWidth_>.25||d),!f&&this.sourceProj_.isGlobal()&&u&&(d=u>.25||d)),!d&&this.maxSourceExtent_&&isFinite(h[0])&&isFinite(h[1])&&isFinite(h[2])&&isFinite(h[3])&&!he(h,this.maxSourceExtent_))return;let g=0;if(!(d||isFinite(r[0])&&isFinite(r[1])&&isFinite(s[0])&&isFinite(s[1])&&isFinite(o[0])&&isFinite(o[1])&&isFinite(a[0])&&isFinite(a[1])))if(l>0)d=!0;else if(g=(isFinite(r[0])&&isFinite(r[1])?0:8)+(isFinite(s[0])&&isFinite(s[1])?0:4)+(isFinite(o[0])&&isFinite(o[1])?0:2)+(isFinite(a[0])&&isFinite(a[1])?0:1),1!=g&&2!=g&&4!=g&&8!=g)return;if(l>0){if(!d){const e=[(t[0]+n[0])/2,(t[1]+n[1])/2],i=this.transformInv_(e);let s;s=f?(nt(r[0],c)+nt(o[0],c))/2-nt(i[0],c):(r[0]+o[0])/2-i[0];const a=(r[1]+o[1])/2-i[1];d=s*s+a*a>this.errorThresholdSquared_}if(d){if(Math.abs(t[0]-n[0])<=Math.abs(t[1]-n[1])){const h=[(e[0]+n[0])/2,(e[1]+n[1])/2],u=this.transformInv_(h),c=[(i[0]+t[0])/2,(i[1]+t[1])/2],f=this.transformInv_(c);this.addQuad_(t,e,h,c,r,s,u,f,l-1),this.addQuad_(c,h,n,i,f,u,o,a,l-1)}else{const h=[(t[0]+e[0])/2,(t[1]+e[1])/2],u=this.transformInv_(h),c=[(n[0]+i[0])/2,(n[1]+i[1])/2],f=this.transformInv_(c);this.addQuad_(t,h,c,i,r,u,f,a,l-1),this.addQuad_(h,e,n,c,u,s,o,f,l-1)}return}}if(f){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}0==(11&g)&&this.addTriangle_(t,n,i,r,o,a),0==(14&g)&&this.addTriangle_(t,n,e,r,o,s),g&&(0==(13&g)&&this.addTriangle_(e,i,t,s,a,r),0==(7&g)&&this.addTriangle_(e,i,n,s,a,o))}calculateSourceExtent(){const t=[1/0,1/0,-1/0,-1/0];return this.triangles_.forEach((function(e,n,i){const r=e.source;Wt(t,r[0]),Wt(t,r[1]),Wt(t,r[2])})),t}getTriangles(){return this.triangles_}};let ba;const Ea=[];function Sa(t,e,n,i,r){t.beginPath(),t.moveTo(0,0),t.lineTo(e,n),t.lineTo(i,r),t.closePath(),t.save(),t.clip(),t.fillRect(0,0,Math.max(e,i)+1,Math.max(n,r)),t.restore()}function Ia(t,e){return Math.abs(t[4*e]-210)>2||Math.abs(t[4*e+3]-191.25)>2}function Ca(t,e,n,i){const r=Fe(n,e,t);let s=Te(e,i,n);const o=e.getMetersPerUnit();void 0!==o&&(s*=o);const a=t.getMetersPerUnit();void 0!==a&&(s/=a);const l=t.getExtent();if(!l||Ft(l,r)){const e=Te(t,s,r)/s;isFinite(e)&&e>0&&(s/=e)}return s}function Ma(t,e,n,i,r,s,o,a,l,h,u,c,f,d){const g=$i(Math.round(n*t),Math.round(n*e),Ea);if(c||(g.imageSmoothingEnabled=!1),0===l.length)return g.canvas;function p(t){return Math.round(t*n)/n}g.scale(n,n),g.globalCompositeOperation="lighter";const m=[1/0,1/0,-1/0,-1/0];let y;l.forEach((function(t,e,n){jt(m,t.extent)}));const v=n/i,w=(c?1:1+Math.pow(2,-24))/v;if(!f||1!==l.length||0!==h){if(y=$i(Math.round(le(m)*v),Math.round(re(m)*v),Ea),c||(y.imageSmoothingEnabled=!1),r&&d){const t=(r[0]-m[0])*v,e=-(r[3]-m[3])*v,n=le(r)*v,i=re(r)*v;y.rect(t,e,n,i),y.clip()}l.forEach((function(t,e,n){const i=(t.extent[0]-m[0])*v,r=-(t.extent[3]-m[3])*v,s=le(t.extent)*v,o=re(t.extent)*v;t.image.width>0&&t.image.height>0&&y.drawImage(t.image,h,h,t.image.width-2*h,t.image.height-2*h,c?i:Math.round(i),c?r:Math.round(r),c?s:Math.round(i+s)-Math.round(i),c?o:Math.round(r+o)-Math.round(r))}))}const x=oe(o);return a.getTriangles().forEach((function(t,e,n){const i=t.source,r=t.target;let o=i[0][0],a=i[0][1],h=i[1][0],u=i[1][1],f=i[2][0],d=i[2][1];const v=p((r[0][0]-x[0])/s),_=p(-(r[0][1]-x[1])/s),b=p((r[1][0]-x[0])/s),E=p(-(r[1][1]-x[1])/s),S=p((r[2][0]-x[0])/s),I=p(-(r[2][1]-x[1])/s),C=o,M=a;o=0,a=0,h-=C,u-=M,f-=C,d-=M;const R=function(t){const e=t.length;for(let n=0;n<e;n++){let i=n,r=Math.abs(t[n][n]);for(let s=n+1;s<e;s++){const e=Math.abs(t[s][n]);e>r&&(r=e,i=s)}if(0===r)return null;const s=t[i];t[i]=t[n],t[n]=s;for(let i=n+1;i<e;i++){const r=-t[i][n]/t[n][n];for(let s=n;s<e+1;s++)n==s?t[i][s]=0:t[i][s]+=r*t[n][s]}}const n=new Array(e);for(let i=e-1;i>=0;i--){n[i]=t[i][e]/t[i][i];for(let r=i-1;r>=0;r--)t[r][e]-=t[r][i]*n[i]}return n}([[h,u,0,0,b-v],[f,d,0,0,S-v],[0,0,h,u,E-_],[0,0,f,d,I-_]]);if(!R)return;if(g.save(),g.beginPath(),function(){if(void 0===ba){const t=$i(6,6,Ea);t.globalCompositeOperation="lighter",t.fillStyle="rgba(210, 0, 0, 0.75)",Sa(t,4,5,4,0),Sa(t,4,5,0,5);const e=t.getImageData(0,0,3,3).data;ba=Ia(e,0)||Ia(e,4)||Ia(e,8),Ji(t),Ea.push(t.canvas)}return ba}()||!c){g.moveTo(b,E);const t=4,e=v-b,n=_-E;for(let i=0;i<t;i++)g.lineTo(b+p((i+1)*e/t),E+p(i*n/(t-1))),i!=t-1&&g.lineTo(b+p((i+1)*e/t),E+p((i+1)*n/(t-1)));g.lineTo(S,I)}else g.moveTo(b,E),g.lineTo(v,_),g.lineTo(S,I);let P;if(g.clip(),g.transform(R[0],R[2],R[1],R[3],v,_),g.translate(m[0]-C,m[3]-M),y)P=y.canvas,g.scale(w,-w);else{const t=l[0],e=t.extent;P=t.image,g.scale(le(e)/P.width,-re(e)/P.height)}g.drawImage(P,0,0),g.restore()})),y&&(Ji(y),Ea.push(y.canvas)),u&&(g.save(),g.globalCompositeOperation="source-over",g.strokeStyle="black",g.lineWidth=1,a.getTriangles().forEach((function(t,e,n){const i=t.target,r=(i[0][0]-x[0])/s,o=-(i[0][1]-x[1])/s,a=(i[1][0]-x[0])/s,l=-(i[1][1]-x[1])/s,h=(i[2][0]-x[0])/s,u=-(i[2][1]-x[1])/s;g.beginPath(),g.moveTo(a,l),g.lineTo(r,o),g.lineTo(h,u),g.closePath(),g.stroke()})),g.restore()),g.canvas}const Ra=class extends wa{constructor(t,e,n,i,r,s,o,a,l,h,u,c){super(r,_o,c),this.renderEdges_=void 0!==u&&u,this.pixelRatio_=o,this.gutter_=a,this.canvas_=null,this.sourceTileGrid_=e,this.targetTileGrid_=i,this.wrappedTileCoord_=s||r,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0;const f=i.getTileCoordExtent(this.wrappedTileCoord_),d=this.targetTileGrid_.getExtent();let g=this.sourceTileGrid_.getExtent();const p=d?se(f,d):f;if(0===Kt(p))return void(this.state=Io);const m=t.getExtent();m&&(g=g?se(g,m):m);const y=i.getResolution(this.wrappedTileCoord_[0]),v=function(t,e,n,i){const r=te(n);let s=Ca(t,e,r,i);return(!isFinite(s)||s<=0)&&Zt(n,(function(n){return s=Ca(t,e,n,i),isFinite(s)&&s>0})),s}(t,n,p,y);if(!isFinite(v)||v<=0)return void(this.state=Io);const w=void 0!==h?h:.5;if(this.triangulation_=new _a(t,n,p,g,v*w,y),0===this.triangulation_.getTriangles().length)return void(this.state=Io);this.sourceZ_=e.getZForResolution(v);let x=this.triangulation_.calculateSourceExtent();if(g&&(t.canWrapX()?(x[1]=J(x[1],g[1],g[3]),x[3]=J(x[3],g[1],g[3])):x=se(x,g)),Kt(x)){const t=e.getTileRangeForExtentAndZ(x,this.sourceZ_);for(let e=t.minX;e<=t.maxX;e++)for(let n=t.minY;n<=t.maxY;n++){const t=l(this.sourceZ_,e,n,o);t&&this.sourceTiles_.push(t)}0===this.sourceTiles_.length&&(this.state=Io)}else this.state=Io}getImage(){return this.canvas_}reproject_(){const t=[];if(this.sourceTiles_.forEach((e=>{e&&e.getState()==Eo&&t.push({extent:this.sourceTileGrid_.getTileCoordExtent(e.tileCoord),image:e.getImage()})})),this.sourceTiles_.length=0,0===t.length)this.state=So;else{const e=this.wrappedTileCoord_[0],n=this.targetTileGrid_.getTileSize(e),i="number"==typeof n?n:n[0],r="number"==typeof n?n:n[1],s=this.targetTileGrid_.getResolution(e),o=this.sourceTileGrid_.getResolution(this.sourceZ_),a=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=Ma(i,r,this.pixelRatio_,o,this.sourceTileGrid_.getExtent(),s,a,this.triangulation_,t,this.gutter_,this.renderEdges_,this.interpolate),this.state=Eo}this.changed()}load(){if(this.state==_o){this.state=bo,this.changed();let t=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach((e=>{const n=e.getState();if(n==_o||n==bo){t++;const n=M(e,x,(function(i){const r=e.getState();r!=Eo&&r!=So&&r!=Io||(P(n),t--,0===t&&(this.unlistenSources_(),this.reproject_()))}),this);this.sourcesListenerKeys_.push(n)}})),0===t?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach((function(t,e,n){t.getState()==_o&&t.load()}))}}unlistenSources_(){this.sourcesListenerKeys_.forEach(P),this.sourcesListenerKeys_=null}release(){this.canvas_&&(Ji(this.canvas_.getContext("2d")),Ea.push(this.canvas_),this.canvas_=null),super.release()}};class Pa{constructor(t,e,n,i){this.minX=t,this.maxX=e,this.minY=n,this.maxY=i}contains(t){return this.containsXY(t[1],t[2])}containsTileRange(t){return this.minX<=t.minX&&t.maxX<=this.maxX&&this.minY<=t.minY&&t.maxY<=this.maxY}containsXY(t,e){return this.minX<=t&&t<=this.maxX&&this.minY<=e&&e<=this.maxY}equals(t){return this.minX==t.minX&&this.minY==t.minY&&this.maxX==t.maxX&&this.maxY==t.maxY}extend(t){t.minX<this.minX&&(this.minX=t.minX),t.maxX>this.maxX&&(this.maxX=t.maxX),t.minY<this.minY&&(this.minY=t.minY),t.maxY>this.maxY&&(this.maxY=t.maxY)}getHeight(){return this.maxY-this.minY+1}getSize(){return[this.getWidth(),this.getHeight()]}getWidth(){return this.maxX-this.minX+1}intersects(t){return this.minX<=t.maxX&&this.maxX>=t.minX&&this.minY<=t.maxY&&this.maxY>=t.minY}}function Ta(t,e,n,i,r){return void 0!==r?(r.minX=t,r.maxX=e,r.minY=n,r.maxY=i,r):new Pa(t,e,n,i)}const Na=Pa,Aa=class extends va{constructor(t){super(t),this.extentChanged=!0,this.renderedExtent_=null,this.renderedPixelRatio,this.renderedProjection=null,this.renderedRevision,this.renderedTiles=[],this.newTiles_=!1,this.tmpExtent=[1/0,1/0,-1/0,-1/0],this.tmpTileRange_=new Na(0,0,0,0)}isDrawableTile(t){const e=this.getLayer(),n=t.getState(),i=e.getUseInterimTilesOnError();return n==Eo||n==Io||n==So&&!i}getTile(t,e,n,i){const r=i.pixelRatio,s=i.viewState.projection,o=this.getLayer();let a=o.getSource().getTile(t,e,n,r,s);return a.getState()==So&&o.getUseInterimTilesOnError()&&o.getPreload()>0&&(this.newTiles_=!0),this.isDrawableTile(a)||(a=a.getInterimTile()),a}getData(t){const e=this.frameState;if(!e)return null;const n=this.getLayer(),i=an(e.pixelToCoordinateTransform,t.slice()),r=n.getExtent();if(r&&!Ft(r,i))return null;const s=e.pixelRatio,o=e.viewState.projection,a=e.viewState,l=n.getRenderSource(),h=l.getTileGridForProjection(a.projection),u=l.getTilePixelRatio(e.pixelRatio);for(let t=h.getZForResolution(a.resolution);t>=h.getMinZoom();--t){const e=h.getTileCoordForCoordAndZ(i,t),n=l.getTile(t,e[1],e[2],s,o);if(!(n instanceof xa||n instanceof Ra)||n instanceof Ra&&n.getState()===Io)return null;if(n.getState()!==Eo)continue;const r=h.getOrigin(t),c=wi(h.getTileSize(t)),f=h.getResolution(t),d=Math.floor(u*((i[0]-r[0])/f-e[1]*c[0])),g=Math.floor(u*((r[1]-i[1])/f-e[2]*c[1])),p=Math.round(u*l.getGutterForProjection(a.projection));return this.getImageData(n.getImage(),d+p,g+p)}return null}loadedTileCallback(t,e,n){return!!this.isDrawableTile(n)&&super.loadedTileCallback(t,e,n)}prepareFrame(t){return!!this.getLayer().getSource()}renderFrame(t,e){const n=t.layerStatesArray[t.layerIndex],i=t.viewState,r=i.projection,s=i.resolution,o=i.center,l=i.rotation,h=t.pixelRatio,u=this.getLayer(),c=u.getSource(),f=c.getRevision(),d=c.getTileGridForProjection(r),g=d.getZForResolution(s,c.zDirection),p=d.getResolution(g);let m=t.extent;const y=t.viewState.resolution,v=c.getTilePixelRatio(h),w=Math.round(le(m)/y*h),x=Math.round(re(m)/y*h),_=n.extent&&Ye(n.extent,r);_&&(m=se(m,Ye(n.extent,r)));const b=p*w/2/v,E=p*x/2/v,S=[o[0]-b,o[1]-E,o[0]+b,o[1]+E],I=d.getTileRangeForExtentAndZ(m,g),C={};C[g]={};const M=this.createLoadedTileFinder(c,r,C),R=this.tmpExtent,P=this.tmpTileRange_;this.newTiles_=!1;const T=l?ie(i.center,y,l,t.size):void 0;for(let e=I.minX;e<=I.maxX;++e)for(let i=I.minY;i<=I.maxY;++i){if(l&&!d.tileCoordIntersectsViewport([g,e,i],T))continue;const r=this.getTile(g,e,i,t);if(this.isDrawableTile(r)){const e=L(this);if(r.getState()==Eo){C[g][r.tileCoord.toString()]=r;let t=r.inTransition(e);t&&1!==n.opacity&&(r.endTransition(e),t=!1),this.newTiles_||!t&&this.renderedTiles.includes(r)||(this.newTiles_=!0)}if(1===r.getAlpha(e,t.time))continue}const s=d.getTileCoordChildTileRange(r.tileCoord,P,R);let o=!1;s&&(o=M(g+1,s)),o||d.forEachTileCoordParentTileRange(r.tileCoord,M,P,R)}const N=p/s*h/v;ln(this.pixelTransform,t.size[0]/2,t.size[1]/2,1/h,1/h,l,-w/2,-x/2);const A=cn(this.pixelTransform);this.useContainer(e,A,this.getBackground(t));const k=this.getRenderContext(t),O=this.context.canvas;hn(this.inversePixelTransform,this.pixelTransform),ln(this.tempTransform,w/2,x/2,N,N,0,-w/2,-x/2),O.width!=w||O.height!=x?(O.width=w,O.height=x):this.containerReused||k.clearRect(0,0,w,x),_&&this.clipUnrotated(k,t,_),c.getInterpolate()||(k.imageSmoothingEnabled=!1),this.preRender(k,t),this.renderedTiles.length=0;let D,F,z,G=Object.keys(C).map(Number);G.sort(a),1!==n.opacity||this.containerReused&&!c.getOpaque(t.viewState.projection)?(D=[],F=[]):G=G.reverse();for(let e=G.length-1;e>=0;--e){const n=G[e],i=c.getTilePixelSize(n,h,r),s=d.getResolution(n)/p,o=i[0]*s*N,a=i[1]*s*N,l=d.getTileCoordForCoordAndZ(oe(S),n),u=d.getTileCoordExtent(l),f=an(this.tempTransform,[v*(u[0]-S[0])/p,v*(S[3]-u[3])/p]),m=v*c.getGutterForProjection(r),y=C[n];for(const e in y){const i=y[e],r=i.tileCoord,s=l[1]-r[1],h=Math.round(f[0]-(s-1)*o),u=l[2]-r[2],d=Math.round(f[1]-(u-1)*a),p=Math.round(f[0]-s*o),v=Math.round(f[1]-u*a),w=h-p,x=d-v,_=g===n,b=_&&1!==i.getAlpha(L(this),t.time);let E=!1;if(!b)if(D){z=[p,v,p+w,v,p+w,v+x,p,v+x];for(let t=0,e=D.length;t<e;++t)if(g!==n&&n<F[t]){const e=D[t];he([p,v,p+w,v+x],[e[0],e[3],e[4],e[7]])&&(E||(k.save(),E=!0),k.beginPath(),k.moveTo(z[0],z[1]),k.lineTo(z[2],z[3]),k.lineTo(z[4],z[5]),k.lineTo(z[6],z[7]),k.moveTo(e[6],e[7]),k.lineTo(e[4],e[5]),k.lineTo(e[2],e[3]),k.lineTo(e[0],e[1]),k.clip())}D.push(z),F.push(n)}else k.clearRect(p,v,w,x);this.drawTileImage(i,t,p,v,w,x,m,_),D&&!b?(E&&k.restore(),this.renderedTiles.unshift(i)):this.renderedTiles.push(i),this.updateUsedTiles(t.usedTiles,c,i)}}return this.renderedRevision=f,this.renderedResolution=p,this.extentChanged=!this.renderedExtent_||!Xt(this.renderedExtent_,S),this.renderedExtent_=S,this.renderedPixelRatio=h,this.renderedProjection=r,this.manageTilePyramid(t,c,d,h,r,m,g,u.getPreload()),this.scheduleExpireCache(t,c),this.postRender(this.context,t),n.extent&&k.restore(),k.imageSmoothingEnabled=!0,A!==O.style.transform&&(O.style.transform=A),this.container}drawTileImage(t,e,n,i,r,s,o,a){const l=this.getTileImage(t);if(!l)return;const h=this.getRenderContext(e),u=L(this),c=e.layerStatesArray[e.layerIndex],f=c.opacity*(a?t.getAlpha(u,e.time):1),d=f!==h.globalAlpha;d&&(h.save(),h.globalAlpha=f),h.drawImage(l,o,o,l.width-2*o,l.height-2*o,n,i,r,s),d&&h.restore(),f!==c.opacity?e.animate=!0:a&&t.endTransition(u)}getImage(){const t=this.context;return t?t.canvas:null}getTileImage(t){return t.getImage()}scheduleExpireCache(t,e){if(e.canExpireCache()){const n=function(t,e,n){const i=L(t);i in n.usedTiles&&t.expireCache(n.viewState.projection,n.usedTiles[i])}.bind(null,e);t.postRenderFunctions.push(n)}}updateUsedTiles(t,e,n){const i=L(e);i in t||(t[i]={}),t[i][n.getKey()]=!0}manageTilePyramid(t,e,n,i,r,s,o,a,l){const h=L(e);h in t.wantedTiles||(t.wantedTiles[h]={});const u=t.wantedTiles[h],c=t.tileQueue,f=n.getMinZoom(),d=t.viewState.rotation,g=d?ie(t.viewState.center,t.viewState.resolution,d,t.size):void 0;let p,m,y,v,w,x,_=0;for(x=f;x<=o;++x)for(m=n.getTileRangeForExtentAndZ(s,x,m),y=n.getResolution(x),v=m.minX;v<=m.maxX;++v)for(w=m.minY;w<=m.maxY;++w)d&&!n.tileCoordIntersectsViewport([x,v,w],g)||(o-x<=a?(++_,p=e.getTile(x,v,w,i,r),p.getState()==_o&&(u[p.getKey()]=!0,c.isKeyQueued(p.getKey())||c.enqueue([p,h,n.getTileCoordCenter(p.tileCoord),y])),void 0!==l&&l(p)):e.useTile(x,v,w,r));e.updateCacheSize(_,r)}},ka=class extends da{constructor(t){super(t)}createRenderer(){return new Aa(this)}};var La=__webpack_require__(3379),Oa=__webpack_require__.n(La),Da=__webpack_require__(7795),Fa=__webpack_require__.n(Da),za=__webpack_require__(569),Ga=__webpack_require__.n(za),Ba=__webpack_require__(3565),Ua=__webpack_require__.n(Ba),qa=__webpack_require__(9216),Va=__webpack_require__.n(qa),Ya=__webpack_require__(4589),Xa=__webpack_require__.n(Ya),ja=__webpack_require__(1828),Wa={};Wa.styleTagTransform=Xa(),Wa.setAttributes=Ua(),Wa.insert=Ga().bind(null,"head"),Wa.domAPI=Fa(),Wa.insertStyleElement=Va(),Oa()(ja.Z,Wa),ja.Z&&ja.Z.locals&&ja.Z.locals;var Ha=__webpack_require__(1788),$a={};function Za(t,e){let n=[],i=[],r=cv.matFromImageData(t),s=cv.Mat.zeros(r.rows,r.cols,cv.CV_8UC3);cv.cvtColor(r,r,cv.COLOR_RGBA2GRAY,0),cv.threshold(r,r,0,255,cv.THRESH_BINARY);let o=new cv.MatVector,a=new cv.Mat;cv.findContours(r,o,a,cv.RETR_CCOMP,cv.CHAIN_APPROX_SIMPLE);for(let t=0;t<o.size();++t){let e=new cv.Scalar(Math.round(255*Math.random()),Math.round(255*Math.random()),Math.round(255*Math.random()));cv.drawContours(s,o,t,e,1,cv.LINE_8,a,10),i.push([e[0],e[1],e[2]])}return n=s,e&&cv.imshow(e,s),r.delete(),{contour:n.data,color:i}}function Ka(t,e){let n=cv.matFromImageData(t),i=cv.Mat.zeros(n.rows,n.cols,cv.CV_8UC3);console.log(i),cv.cvtColor(n,n,cv.COLOR_RGBA2GRAY,0);let r=new cv.Size(3,3),s=new cv.Point(-1,-1);return cv.blur(n,n,r,s,cv.BORDER_DEFAULT),cv.Canny(n,i,50,100,3,!1),n.delete(),i}function Ja(t,e,n){let i=function(t,e,n){let i=cv.matFromImageData(t),r=new cv.Mat,s=cv.Mat.ones(e,e,cv.CV_8U),o=new cv.Point(-1,-1);return cv.erode(i,r,s,o,n,cv.BORDER_CONSTANT,cv.morphologyDefaultBorderValue()),i.delete(),s.delete(),r}(t,e,n),r=Ka(t),s=new Uint8ClampedArray(i.data.length);for(let t=0,e=0;i.data.length,e<r.data.length;t+=4,e++)s[t]=i.data[t],s[t+1]=r.data[e],s[t+3]=255;return new ImageData(s,300,300)}function Qa(t,e){let n;if(void 0===e)for(const e of t)null!=e&&(n<e||void 0===n&&e>=e)&&(n=e);else{let i=-1;for(let r of t)null!=(r=e(r,++i,t))&&(n<r||void 0===n&&r>=r)&&(n=r)}return n}function tl(t){return t}$a.styleTagTransform=Xa(),$a.setAttributes=Ua(),$a.insert=Ga().bind(null,"head"),$a.domAPI=Fa(),$a.insertStyleElement=Va(),Oa()(Ha.Z,$a),Ha.Z&&Ha.Z.locals&&Ha.Z.locals;var el=1,nl=2,il=3,rl=4,sl=1e-6;function ol(t){return"translate("+t+",0)"}function al(t){return"translate(0,"+t+")"}function ll(t){return e=>+t(e)}function hl(t,e){return e=Math.max(0,t.bandwidth()-2*e)/2,t.round()&&(e=Math.round(e)),n=>+t(n)+e}function ul(){return!this.__axis}function cl(t,e){var n=[],i=null,r=null,s=6,o=6,a=3,l="undefined"!=typeof window&&window.devicePixelRatio>1?0:.5,h=t===el||t===rl?-1:1,u=t===rl||t===nl?"x":"y",c=t===el||t===il?ol:al;function f(f){var d=null==i?e.ticks?e.ticks.apply(e,n):e.domain():i,g=null==r?e.tickFormat?e.tickFormat.apply(e,n):tl:r,p=Math.max(s,0)+a,m=e.range(),y=+m[0]+l,v=+m[m.length-1]+l,w=(e.bandwidth?hl:ll)(e.copy(),l),x=f.selection?f.selection():f,_=x.selectAll(".domain").data([null]),b=x.selectAll(".tick").data(d,e).order(),E=b.exit(),S=b.enter().append("g").attr("class","tick"),I=b.select("line"),C=b.select("text");_=_.merge(_.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),b=b.merge(S),I=I.merge(S.append("line").attr("stroke","currentColor").attr(u+"2",h*s)),C=C.merge(S.append("text").attr("fill","currentColor").attr(u,h*p).attr("dy",t===el?"0em":t===il?"0.71em":"0.32em")),f!==x&&(_=_.transition(f),b=b.transition(f),I=I.transition(f),C=C.transition(f),E=E.transition(f).attr("opacity",sl).attr("transform",(function(t){return isFinite(t=w(t))?c(t+l):this.getAttribute("transform")})),S.attr("opacity",sl).attr("transform",(function(t){var e=this.parentNode.__axis;return c((e&&isFinite(e=e(t))?e:w(t))+l)}))),E.remove(),_.attr("d",t===rl||t===nl?o?"M"+h*o+","+y+"H"+l+"V"+v+"H"+h*o:"M"+l+","+y+"V"+v:o?"M"+y+","+h*o+"V"+l+"H"+v+"V"+h*o:"M"+y+","+l+"H"+v),b.attr("opacity",1).attr("transform",(function(t){return c(w(t)+l)})),I.attr(u+"2",h*s),C.attr(u,h*p).text(g),x.filter(ul).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",t===nl?"start":t===rl?"end":"middle"),x.each((function(){this.__axis=w}))}return f.scale=function(t){return arguments.length?(e=t,f):e},f.ticks=function(){return n=Array.from(arguments),f},f.tickArguments=function(t){return arguments.length?(n=null==t?[]:Array.from(t),f):n.slice()},f.tickValues=function(t){return arguments.length?(i=null==t?null:Array.from(t),f):i&&i.slice()},f.tickFormat=function(t){return arguments.length?(r=t,f):r},f.tickSize=function(t){return arguments.length?(s=o=+t,f):s},f.tickSizeInner=function(t){return arguments.length?(s=+t,f):s},f.tickSizeOuter=function(t){return arguments.length?(o=+t,f):o},f.tickPadding=function(t){return arguments.length?(a=+t,f):a},f.offset=function(t){return arguments.length?(l=+t,f):l},f}function fl(){}function dl(t){return null==t?fl:function(){return this.querySelector(t)}}function gl(){return[]}function pl(t){return null==t?gl:function(){return this.querySelectorAll(t)}}function ml(t){return function(){return this.matches(t)}}function yl(t){return function(e){return e.matches(t)}}var vl=Array.prototype.find;function wl(){return this.firstElementChild}var xl=Array.prototype.filter;function _l(){return Array.from(this.children)}function bl(t){return new Array(t.length)}function El(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}function Sl(t,e,n,i,r,s){for(var o,a=0,l=e.length,h=s.length;a<h;++a)(o=e[a])?(o.__data__=s[a],i[a]=o):n[a]=new El(t,s[a]);for(;a<l;++a)(o=e[a])&&(r[a]=o)}function Il(t,e,n,i,r,s,o){var a,l,h,u=new Map,c=e.length,f=s.length,d=new Array(c);for(a=0;a<c;++a)(l=e[a])&&(d[a]=h=o.call(l,l.__data__,a,e)+"",u.has(h)?r[a]=l:u.set(h,l));for(a=0;a<f;++a)h=o.call(t,s[a],a,s)+"",(l=u.get(h))?(i[a]=l,l.__data__=s[a],u.delete(h)):n[a]=new El(t,s[a]);for(a=0;a<c;++a)(l=e[a])&&u.get(d[a])===l&&(r[a]=l)}function Cl(t){return t.__data__}function Ml(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}function Rl(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}El.prototype={constructor:El,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};var Pl="http://www.w3.org/1999/xhtml";const Tl={svg:"http://www.w3.org/2000/svg",xhtml:Pl,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Nl(t){var e=t+="",n=e.indexOf(":");return n>=0&&"xmlns"!==(e=t.slice(0,n))&&(t=t.slice(n+1)),Tl.hasOwnProperty(e)?{space:Tl[e],local:t}:t}function Al(t){return function(){this.removeAttribute(t)}}function kl(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Ll(t,e){return function(){this.setAttribute(t,e)}}function Ol(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function Dl(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}}function Fl(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function zl(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function Gl(t){return function(){this.style.removeProperty(t)}}function Bl(t,e,n){return function(){this.style.setProperty(t,e,n)}}function Ul(t,e,n){return function(){var i=e.apply(this,arguments);null==i?this.style.removeProperty(t):this.style.setProperty(t,i,n)}}function ql(t,e){return t.style.getPropertyValue(e)||zl(t).getComputedStyle(t,null).getPropertyValue(e)}function Vl(t){return function(){delete this[t]}}function Yl(t,e){return function(){this[t]=e}}function Xl(t,e){return function(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}}function jl(t){return t.trim().split(/^|\s+/)}function Wl(t){return t.classList||new Hl(t)}function Hl(t){this._node=t,this._names=jl(t.getAttribute("class")||"")}function $l(t,e){for(var n=Wl(t),i=-1,r=e.length;++i<r;)n.add(e[i])}function Zl(t,e){for(var n=Wl(t),i=-1,r=e.length;++i<r;)n.remove(e[i])}function Kl(t){return function(){$l(this,t)}}function Jl(t){return function(){Zl(this,t)}}function Ql(t,e){return function(){(e.apply(this,arguments)?$l:Zl)(this,t)}}function th(){this.textContent=""}function eh(t){return function(){this.textContent=t}}function nh(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}function ih(){this.innerHTML=""}function rh(t){return function(){this.innerHTML=t}}function sh(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}function oh(){this.nextSibling&&this.parentNode.appendChild(this)}function ah(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function lh(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===Pl&&e.documentElement.namespaceURI===Pl?e.createElement(t):e.createElementNS(n,t)}}function hh(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function uh(t){var e=Nl(t);return(e.local?hh:lh)(e)}function ch(){return null}function fh(){var t=this.parentNode;t&&t.removeChild(this)}function dh(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function gh(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function ph(t){return function(){var e=this.__on;if(e){for(var n,i=0,r=-1,s=e.length;i<s;++i)n=e[i],t.type&&n.type!==t.type||n.name!==t.name?e[++r]=n:this.removeEventListener(n.type,n.listener,n.options);++r?e.length=r:delete this.__on}}}function mh(t,e,n){return function(){var i,r=this.__on,s=function(t){return function(e){t.call(this,e,this.__data__)}}(e);if(r)for(var o=0,a=r.length;o<a;++o)if((i=r[o]).type===t.type&&i.name===t.name)return this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=s,i.options=n),void(i.value=e);this.addEventListener(t.type,s,n),i={type:t.type,name:t.name,value:e,listener:s,options:n},r?r.push(i):this.__on=[i]}}function yh(t,e,n){var i=zl(t),r=i.CustomEvent;"function"==typeof r?r=new r(e,n):(r=i.document.createEvent("Event"),n?(r.initEvent(e,n.bubbles,n.cancelable),r.detail=n.detail):r.initEvent(e,!1,!1)),t.dispatchEvent(r)}function vh(t,e){return function(){return yh(this,t,e)}}function wh(t,e){return function(){return yh(this,t,e.apply(this,arguments))}}Hl.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var xh=[null];function _h(t,e){this._groups=t,this._parents=e}function bh(){return new _h([[document.documentElement]],xh)}_h.prototype=bh.prototype={constructor:_h,select:function(t){"function"!=typeof t&&(t=dl(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var s,o,a=e[r],l=a.length,h=i[r]=new Array(l),u=0;u<l;++u)(s=a[u])&&(o=t.call(s,s.__data__,u,a))&&("__data__"in s&&(o.__data__=s.__data__),h[u]=o);return new _h(i,this._parents)},selectAll:function(t){t="function"==typeof t?function(t){return function(){return null==(e=t.apply(this,arguments))?[]:Array.isArray(e)?e:Array.from(e);var e}}(t):pl(t);for(var e=this._groups,n=e.length,i=[],r=[],s=0;s<n;++s)for(var o,a=e[s],l=a.length,h=0;h<l;++h)(o=a[h])&&(i.push(t.call(o,o.__data__,h,a)),r.push(o));return new _h(i,r)},selectChild:function(t){return this.select(null==t?wl:function(t){return function(){return vl.call(this.children,t)}}("function"==typeof t?t:yl(t)))},selectChildren:function(t){return this.selectAll(null==t?_l:function(t){return function(){return xl.call(this.children,t)}}("function"==typeof t?t:yl(t)))},filter:function(t){"function"!=typeof t&&(t=ml(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var s,o=e[r],a=o.length,l=i[r]=[],h=0;h<a;++h)(s=o[h])&&t.call(s,s.__data__,h,o)&&l.push(s);return new _h(i,this._parents)},data:function(t,e){if(!arguments.length)return Array.from(this,Cl);var n,i=e?Il:Sl,r=this._parents,s=this._groups;"function"!=typeof t&&(n=t,t=function(){return n});for(var o=s.length,a=new Array(o),l=new Array(o),h=new Array(o),u=0;u<o;++u){var c=r[u],f=s[u],d=f.length,g=Ml(t.call(c,c&&c.__data__,u,r)),p=g.length,m=l[u]=new Array(p),y=a[u]=new Array(p);i(c,f,m,y,h[u]=new Array(d),g,e);for(var v,w,x=0,_=0;x<p;++x)if(v=m[x]){for(x>=_&&(_=x+1);!(w=y[_])&&++_<p;);v._next=w||null}}return(a=new _h(a,r))._enter=l,a._exit=h,a},enter:function(){return new _h(this._enter||this._groups.map(bl),this._parents)},exit:function(){return new _h(this._exit||this._groups.map(bl),this._parents)},join:function(t,e,n){var i=this.enter(),r=this,s=this.exit();return"function"==typeof t?(i=t(i))&&(i=i.selection()):i=i.append(t+""),null!=e&&(r=e(r))&&(r=r.selection()),null==n?s.remove():n(s),i&&r?i.merge(r).order():r},merge:function(t){for(var e=t.selection?t.selection():t,n=this._groups,i=e._groups,r=n.length,s=i.length,o=Math.min(r,s),a=new Array(r),l=0;l<o;++l)for(var h,u=n[l],c=i[l],f=u.length,d=a[l]=new Array(f),g=0;g<f;++g)(h=u[g]||c[g])&&(d[g]=h);for(;l<r;++l)a[l]=n[l];return new _h(a,this._parents)},selection:function(){return this},order:function(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var i,r=t[e],s=r.length-1,o=r[s];--s>=0;)(i=r[s])&&(o&&4^i.compareDocumentPosition(o)&&o.parentNode.insertBefore(i,o),o=i);return this},sort:function(t){function e(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}t||(t=Rl);for(var n=this._groups,i=n.length,r=new Array(i),s=0;s<i;++s){for(var o,a=n[s],l=a.length,h=r[s]=new Array(l),u=0;u<l;++u)(o=a[u])&&(h[u]=o);h.sort(e)}return new _h(r,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var i=t[e],r=0,s=i.length;r<s;++r){var o=i[r];if(o)return o}return null},size:function(){let t=0;for(const e of this)++t;return t},empty:function(){return!this.node()},each:function(t){for(var e=this._groups,n=0,i=e.length;n<i;++n)for(var r,s=e[n],o=0,a=s.length;o<a;++o)(r=s[o])&&t.call(r,r.__data__,o,s);return this},attr:function(t,e){var n=Nl(t);if(arguments.length<2){var i=this.node();return n.local?i.getAttributeNS(n.space,n.local):i.getAttribute(n)}return this.each((null==e?n.local?kl:Al:"function"==typeof e?n.local?Fl:Dl:n.local?Ol:Ll)(n,e))},style:function(t,e,n){return arguments.length>1?this.each((null==e?Gl:"function"==typeof e?Ul:Bl)(t,e,null==n?"":n)):ql(this.node(),t)},property:function(t,e){return arguments.length>1?this.each((null==e?Vl:"function"==typeof e?Xl:Yl)(t,e)):this.node()[t]},classed:function(t,e){var n=jl(t+"");if(arguments.length<2){for(var i=Wl(this.node()),r=-1,s=n.length;++r<s;)if(!i.contains(n[r]))return!1;return!0}return this.each(("function"==typeof e?Ql:e?Kl:Jl)(n,e))},text:function(t){return arguments.length?this.each(null==t?th:("function"==typeof t?nh:eh)(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?ih:("function"==typeof t?sh:rh)(t)):this.node().innerHTML},raise:function(){return this.each(oh)},lower:function(){return this.each(ah)},append:function(t){var e="function"==typeof t?t:uh(t);return this.select((function(){return this.appendChild(e.apply(this,arguments))}))},insert:function(t,e){var n="function"==typeof t?t:uh(t),i=null==e?ch:"function"==typeof e?e:dl(e);return this.select((function(){return this.insertBefore(n.apply(this,arguments),i.apply(this,arguments)||null)}))},remove:function(){return this.each(fh)},clone:function(t){return this.select(t?gh:dh)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,e,n){var i,r,s=function(t){return t.trim().split(/^|\s+/).map((function(t){var e="",n=t.indexOf(".");return n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),{type:t,name:e}}))}(t+""),o=s.length;if(!(arguments.length<2)){for(a=e?mh:ph,i=0;i<o;++i)this.each(a(s[i],e,n));return this}var a=this.node().__on;if(a)for(var l,h=0,u=a.length;h<u;++h)for(i=0,l=a[h];i<o;++i)if((r=s[i]).type===l.type&&r.name===l.name)return l.value},dispatch:function(t,e){return this.each(("function"==typeof e?wh:vh)(t,e))},[Symbol.iterator]:function*(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var i,r=t[e],s=0,o=r.length;s<o;++s)(i=r[s])&&(yield i)}};const Eh=bh;var Sh={value:()=>{}};function Ih(){for(var t,e=0,n=arguments.length,i={};e<n;++e){if(!(t=arguments[e]+"")||t in i||/[\s.]/.test(t))throw new Error("illegal type: "+t);i[t]=[]}return new Ch(i)}function Ch(t){this._=t}function Mh(t,e){for(var n,i=0,r=t.length;i<r;++i)if((n=t[i]).name===e)return n.value}function Rh(t,e,n){for(var i=0,r=t.length;i<r;++i)if(t[i].name===e){t[i]=Sh,t=t.slice(0,i).concat(t.slice(i+1));break}return null!=n&&t.push({name:e,value:n}),t}Ch.prototype=Ih.prototype={constructor:Ch,on:function(t,e){var n,i=this._,r=function(t,e){return t.trim().split(/^|\s+/).map((function(t){var n="",i=t.indexOf(".");if(i>=0&&(n=t.slice(i+1),t=t.slice(0,i)),t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:n}}))}(t+"",i),s=-1,o=r.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++s<o;)if(n=(t=r[s]).type)i[n]=Rh(i[n],t.name,e);else if(null==e)for(n in i)i[n]=Rh(i[n],t.name,null);return this}for(;++s<o;)if((n=(t=r[s]).type)&&(n=Mh(i[n],t.name)))return n},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new Ch(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,i,r=new Array(n),s=0;s<n;++s)r[s]=arguments[s+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(s=0,n=(i=this._[t]).length;s<n;++s)i[s].value.apply(e,r)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var i=this._[t],r=0,s=i.length;r<s;++r)i[r].value.apply(e,n)}};const Ph=Ih;var Th,Nh,Ah=0,kh=0,Lh=0,Oh=1e3,Dh=0,Fh=0,zh=0,Gh="object"==typeof performance&&performance.now?performance:Date,Bh="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function Uh(){return Fh||(Bh(qh),Fh=Gh.now()+zh)}function qh(){Fh=0}function Vh(){this._call=this._time=this._next=null}function Yh(t,e,n){var i=new Vh;return i.restart(t,e,n),i}function Xh(){Fh=(Dh=Gh.now())+zh,Ah=kh=0;try{!function(){Uh(),++Ah;for(var t,e=Th;e;)(t=Fh-e._time)>=0&&e._call.call(void 0,t),e=e._next;--Ah}()}finally{Ah=0,function(){for(var t,e,n=Th,i=1/0;n;)n._call?(i>n._time&&(i=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:Th=e);Nh=t,Wh(i)}(),Fh=0}}function jh(){var t=Gh.now(),e=t-Dh;e>Oh&&(zh-=e,Dh=t)}function Wh(t){Ah||(kh&&(kh=clearTimeout(kh)),t-Fh>24?(t<1/0&&(kh=setTimeout(Xh,t-Gh.now()-zh)),Lh&&(Lh=clearInterval(Lh))):(Lh||(Dh=Gh.now(),Lh=setInterval(jh,Oh)),Ah=1,Bh(Xh)))}function Hh(t,e,n){var i=new Vh;return e=null==e?0:+e,i.restart((n=>{i.stop(),t(n+e)}),e,n),i}Vh.prototype=Yh.prototype={constructor:Vh,restart:function(t,e,n){if("function"!=typeof t)throw new TypeError("callback is not a function");n=(null==n?Uh():+n)+(null==e?0:+e),this._next||Nh===this||(Nh?Nh._next=this:Th=this,Nh=this),this._call=t,this._time=n,Wh()},stop:function(){this._call&&(this._call=null,this._time=1/0,Wh())}};var $h=Ph("start","end","cancel","interrupt"),Zh=[],Kh=0,Jh=3;function Qh(t,e,n,i,r,s){var o=t.__transition;if(o){if(n in o)return}else t.__transition={};!function(t,e,n){var i,r=t.__transition;function s(l){var h,u,c,f;if(1!==n.state)return a();for(h in r)if((f=r[h]).name===n.name){if(f.state===Jh)return Hh(s);4===f.state?(f.state=6,f.timer.stop(),f.on.call("interrupt",t,t.__data__,f.index,f.group),delete r[h]):+h<e&&(f.state=6,f.timer.stop(),f.on.call("cancel",t,t.__data__,f.index,f.group),delete r[h])}if(Hh((function(){n.state===Jh&&(n.state=4,n.timer.restart(o,n.delay,n.time),o(l))})),n.state=2,n.on.call("start",t,t.__data__,n.index,n.group),2===n.state){for(n.state=Jh,i=new Array(c=n.tween.length),h=0,u=-1;h<c;++h)(f=n.tween[h].value.call(t,t.__data__,n.index,n.group))&&(i[++u]=f);i.length=u+1}}function o(e){for(var r=e<n.duration?n.ease.call(null,e/n.duration):(n.timer.restart(a),n.state=5,1),s=-1,o=i.length;++s<o;)i[s].call(t,r);5===n.state&&(n.on.call("end",t,t.__data__,n.index,n.group),a())}function a(){for(var i in n.state=6,n.timer.stop(),delete r[e],r)return;delete t.__transition}r[e]=n,n.timer=Yh((function(t){n.state=1,n.timer.restart(s,n.delay,n.time),n.delay<=t&&s(t-n.delay)}),0,n.time)}(t,n,{name:e,index:i,group:r,on:$h,tween:Zh,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:Kh})}function tu(t,e){var n=nu(t,e);if(n.state>Kh)throw new Error("too late; already scheduled");return n}function eu(t,e){var n=nu(t,e);if(n.state>Jh)throw new Error("too late; already running");return n}function nu(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function iu(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}var ru,su=180/Math.PI,ou={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function au(t,e,n,i,r,s){var o,a,l;return(o=Math.sqrt(t*t+e*e))&&(t/=o,e/=o),(l=t*n+e*i)&&(n-=t*l,i-=e*l),(a=Math.sqrt(n*n+i*i))&&(n/=a,i/=a,l/=a),t*i<e*n&&(t=-t,e=-e,l=-l,o=-o),{translateX:r,translateY:s,rotate:Math.atan2(e,t)*su,skewX:Math.atan(l)*su,scaleX:o,scaleY:a}}function lu(t,e,n,i){function r(t){return t.length?t.pop()+" ":""}return function(s,o){var a=[],l=[];return s=t(s),o=t(o),function(t,i,r,s,o,a){if(t!==r||i!==s){var l=o.push("translate(",null,e,null,n);a.push({i:l-4,x:iu(t,r)},{i:l-2,x:iu(i,s)})}else(r||s)&&o.push("translate("+r+e+s+n)}(s.translateX,s.translateY,o.translateX,o.translateY,a,l),function(t,e,n,s){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),s.push({i:n.push(r(n)+"rotate(",null,i)-2,x:iu(t,e)})):e&&n.push(r(n)+"rotate("+e+i)}(s.rotate,o.rotate,a,l),function(t,e,n,s){t!==e?s.push({i:n.push(r(n)+"skewX(",null,i)-2,x:iu(t,e)}):e&&n.push(r(n)+"skewX("+e+i)}(s.skewX,o.skewX,a,l),function(t,e,n,i,s,o){if(t!==n||e!==i){var a=s.push(r(s)+"scale(",null,",",null,")");o.push({i:a-4,x:iu(t,n)},{i:a-2,x:iu(e,i)})}else 1===n&&1===i||s.push(r(s)+"scale("+n+","+i+")")}(s.scaleX,s.scaleY,o.scaleX,o.scaleY,a,l),s=o=null,function(t){for(var e,n=-1,i=l.length;++n<i;)a[(e=l[n]).i]=e.x(t);return a.join("")}}}var hu=lu((function(t){const e=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?ou:au(e.a,e.b,e.c,e.d,e.e,e.f)}),"px, ","px)","deg)"),uu=lu((function(t){return null==t?ou:(ru||(ru=document.createElementNS("http://www.w3.org/2000/svg","g")),ru.setAttribute("transform",t),(t=ru.transform.baseVal.consolidate())?au((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):ou)}),", ",")",")");function cu(t,e){var n,i;return function(){var r=eu(this,t),s=r.tween;if(s!==n)for(var o=0,a=(i=n=s).length;o<a;++o)if(i[o].name===e){(i=i.slice()).splice(o,1);break}r.tween=i}}function fu(t,e,n){var i,r;if("function"!=typeof n)throw new Error;return function(){var s=eu(this,t),o=s.tween;if(o!==i){r=(i=o).slice();for(var a={name:e,value:n},l=0,h=r.length;l<h;++l)if(r[l].name===e){r[l]=a;break}l===h&&r.push(a)}s.tween=r}}function du(t,e,n){var i=t._id;return t.each((function(){var t=eu(this,i);(t.value||(t.value={}))[e]=n.apply(this,arguments)})),function(t){return nu(t,i).value[e]}}function gu(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function pu(t,e){var n=Object.create(t.prototype);for(var i in e)n[i]=e[i];return n}function mu(){}var yu=.7,vu=1/yu,wu="\\s*([+-]?\\d+)\\s*",xu="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",_u="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",bu=/^#([0-9a-f]{3,8})$/,Eu=new RegExp(`^rgb\\(${wu},${wu},${wu}\\)$`),Su=new RegExp(`^rgb\\(${_u},${_u},${_u}\\)$`),Iu=new RegExp(`^rgba\\(${wu},${wu},${wu},${xu}\\)$`),Cu=new RegExp(`^rgba\\(${_u},${_u},${_u},${xu}\\)$`),Mu=new RegExp(`^hsl\\(${xu},${_u},${_u}\\)$`),Ru=new RegExp(`^hsla\\(${xu},${_u},${_u},${xu}\\)$`),Pu={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Tu(){return this.rgb().formatHex()}function Nu(){return this.rgb().formatRgb()}function Au(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=bu.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?ku(e):3===n?new Du(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?Lu(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?Lu(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=Eu.exec(t))?new Du(e[1],e[2],e[3],1):(e=Su.exec(t))?new Du(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=Iu.exec(t))?Lu(e[1],e[2],e[3],e[4]):(e=Cu.exec(t))?Lu(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=Mu.exec(t))?qu(e[1],e[2]/100,e[3]/100,1):(e=Ru.exec(t))?qu(e[1],e[2]/100,e[3]/100,e[4]):Pu.hasOwnProperty(t)?ku(Pu[t]):"transparent"===t?new Du(NaN,NaN,NaN,0):null}function ku(t){return new Du(t>>16&255,t>>8&255,255&t,1)}function Lu(t,e,n,i){return i<=0&&(t=e=n=NaN),new Du(t,e,n,i)}function Ou(t,e,n,i){return 1===arguments.length?((r=t)instanceof mu||(r=Au(r)),r?new Du((r=r.rgb()).r,r.g,r.b,r.opacity):new Du):new Du(t,e,n,null==i?1:i);var r}function Du(t,e,n,i){this.r=+t,this.g=+e,this.b=+n,this.opacity=+i}function Fu(){return`#${Uu(this.r)}${Uu(this.g)}${Uu(this.b)}`}function zu(){const t=Gu(this.opacity);return`${1===t?"rgb(":"rgba("}${Bu(this.r)}, ${Bu(this.g)}, ${Bu(this.b)}${1===t?")":`, ${t})`}`}function Gu(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function Bu(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function Uu(t){return((t=Bu(t))<16?"0":"")+t.toString(16)}function qu(t,e,n,i){return i<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new Yu(t,e,n,i)}function Vu(t){if(t instanceof Yu)return new Yu(t.h,t.s,t.l,t.opacity);if(t instanceof mu||(t=Au(t)),!t)return new Yu;if(t instanceof Yu)return t;var e=(t=t.rgb()).r/255,n=t.g/255,i=t.b/255,r=Math.min(e,n,i),s=Math.max(e,n,i),o=NaN,a=s-r,l=(s+r)/2;return a?(o=e===s?(n-i)/a+6*(n<i):n===s?(i-e)/a+2:(e-n)/a+4,a/=l<.5?s+r:2-s-r,o*=60):a=l>0&&l<1?0:o,new Yu(o,a,l,t.opacity)}function Yu(t,e,n,i){this.h=+t,this.s=+e,this.l=+n,this.opacity=+i}function Xu(t){return(t=(t||0)%360)<0?t+360:t}function ju(t){return Math.max(0,Math.min(1,t||0))}function Wu(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}function Hu(t,e,n,i,r){var s=t*t,o=s*t;return((1-3*t+3*s-o)*e+(4-6*s+3*o)*n+(1+3*t+3*s-3*o)*i+o*r)/6}gu(mu,Au,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:Tu,formatHex:Tu,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return Vu(this).formatHsl()},formatRgb:Nu,toString:Nu}),gu(Du,Ou,pu(mu,{brighter(t){return t=null==t?vu:Math.pow(vu,t),new Du(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=null==t?yu:Math.pow(yu,t),new Du(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new Du(Bu(this.r),Bu(this.g),Bu(this.b),Gu(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Fu,formatHex:Fu,formatHex8:function(){return`#${Uu(this.r)}${Uu(this.g)}${Uu(this.b)}${Uu(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:zu,toString:zu})),gu(Yu,(function(t,e,n,i){return 1===arguments.length?Vu(t):new Yu(t,e,n,null==i?1:i)}),pu(mu,{brighter(t){return t=null==t?vu:Math.pow(vu,t),new Yu(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=null==t?yu:Math.pow(yu,t),new Yu(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*e,r=2*n-i;return new Du(Wu(t>=240?t-240:t+120,r,i),Wu(t,r,i),Wu(t<120?t+240:t-120,r,i),this.opacity)},clamp(){return new Yu(Xu(this.h),ju(this.s),ju(this.l),Gu(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=Gu(this.opacity);return`${1===t?"hsl(":"hsla("}${Xu(this.h)}, ${100*ju(this.s)}%, ${100*ju(this.l)}%${1===t?")":`, ${t})`}`}}));const $u=t=>()=>t;function Zu(t,e){var n=e-t;return n?function(t,e){return function(n){return t+n*e}}(t,n):$u(isNaN(t)?e:t)}const Ku=function t(e){var n=function(t){return 1==(t=+t)?Zu:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(i){return Math.pow(t+i*e,n)}}(e,n,t):$u(isNaN(e)?n:e)}}(e);function i(t,e){var i=n((t=Ou(t)).r,(e=Ou(e)).r),r=n(t.g,e.g),s=n(t.b,e.b),o=Zu(t.opacity,e.opacity);return function(e){return t.r=i(e),t.g=r(e),t.b=s(e),t.opacity=o(e),t+""}}return i.gamma=t,i}(1);function Ju(t){return function(e){var n,i,r=e.length,s=new Array(r),o=new Array(r),a=new Array(r);for(n=0;n<r;++n)i=Ou(e[n]),s[n]=i.r||0,o[n]=i.g||0,a[n]=i.b||0;return s=t(s),o=t(o),a=t(a),i.opacity=1,function(t){return i.r=s(t),i.g=o(t),i.b=a(t),i+""}}}Ju((function(t){var e=t.length-1;return function(n){var i=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),r=t[i],s=t[i+1],o=i>0?t[i-1]:2*r-s,a=i<e-1?t[i+2]:2*s-r;return Hu((n-i/e)*e,o,r,s,a)}})),Ju((function(t){var e=t.length;return function(n){var i=Math.floor(((n%=1)<0?++n:n)*e),r=t[(i+e-1)%e],s=t[i%e],o=t[(i+1)%e],a=t[(i+2)%e];return Hu((n-i/e)*e,r,s,o,a)}}));var Qu=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,tc=new RegExp(Qu.source,"g");function ec(t,e){var n,i,r,s=Qu.lastIndex=tc.lastIndex=0,o=-1,a=[],l=[];for(t+="",e+="";(n=Qu.exec(t))&&(i=tc.exec(e));)(r=i.index)>s&&(r=e.slice(s,r),a[o]?a[o]+=r:a[++o]=r),(n=n[0])===(i=i[0])?a[o]?a[o]+=i:a[++o]=i:(a[++o]=null,l.push({i:o,x:iu(n,i)})),s=tc.lastIndex;return s<e.length&&(r=e.slice(s),a[o]?a[o]+=r:a[++o]=r),a.length<2?l[0]?function(t){return function(e){return t(e)+""}}(l[0].x):function(t){return function(){return t}}(e):(e=l.length,function(t){for(var n,i=0;i<e;++i)a[(n=l[i]).i]=n.x(t);return a.join("")})}function nc(t,e){var n;return("number"==typeof e?iu:e instanceof Au?Ku:(n=Au(e))?(e=n,Ku):ec)(t,e)}function ic(t){return function(){this.removeAttribute(t)}}function rc(t){return function(){this.removeAttributeNS(t.space,t.local)}}function sc(t,e,n){var i,r,s=n+"";return function(){var o=this.getAttribute(t);return o===s?null:o===i?r:r=e(i=o,n)}}function oc(t,e,n){var i,r,s=n+"";return function(){var o=this.getAttributeNS(t.space,t.local);return o===s?null:o===i?r:r=e(i=o,n)}}function ac(t,e,n){var i,r,s;return function(){var o,a,l=n(this);if(null!=l)return(o=this.getAttribute(t))===(a=l+"")?null:o===i&&a===r?s:(r=a,s=e(i=o,l));this.removeAttribute(t)}}function lc(t,e,n){var i,r,s;return function(){var o,a,l=n(this);if(null!=l)return(o=this.getAttributeNS(t.space,t.local))===(a=l+"")?null:o===i&&a===r?s:(r=a,s=e(i=o,l));this.removeAttributeNS(t.space,t.local)}}function hc(t,e){var n,i;function r(){var r=e.apply(this,arguments);return r!==i&&(n=(i=r)&&function(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}(t,r)),n}return r._value=e,r}function uc(t,e){var n,i;function r(){var r=e.apply(this,arguments);return r!==i&&(n=(i=r)&&function(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}(t,r)),n}return r._value=e,r}function cc(t,e){return function(){tu(this,t).delay=+e.apply(this,arguments)}}function fc(t,e){return e=+e,function(){tu(this,t).delay=e}}function dc(t,e){return function(){eu(this,t).duration=+e.apply(this,arguments)}}function gc(t,e){return e=+e,function(){eu(this,t).duration=e}}var pc=Eh.prototype.constructor;function mc(t){return function(){this.style.removeProperty(t)}}var yc=0;function vc(t,e,n,i){this._groups=t,this._parents=e,this._name=n,this._id=i}function wc(){return++yc}var xc=Eh.prototype;vc.prototype=function(t){return Eh().transition(t)}.prototype={constructor:vc,select:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=dl(t));for(var i=this._groups,r=i.length,s=new Array(r),o=0;o<r;++o)for(var a,l,h=i[o],u=h.length,c=s[o]=new Array(u),f=0;f<u;++f)(a=h[f])&&(l=t.call(a,a.__data__,f,h))&&("__data__"in a&&(l.__data__=a.__data__),c[f]=l,Qh(c[f],e,n,f,c,nu(a,n)));return new vc(s,this._parents,e,n)},selectAll:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=pl(t));for(var i=this._groups,r=i.length,s=[],o=[],a=0;a<r;++a)for(var l,h=i[a],u=h.length,c=0;c<u;++c)if(l=h[c]){for(var f,d=t.call(l,l.__data__,c,h),g=nu(l,n),p=0,m=d.length;p<m;++p)(f=d[p])&&Qh(f,e,n,p,d,g);s.push(d),o.push(l)}return new vc(s,o,e,n)},selectChild:xc.selectChild,selectChildren:xc.selectChildren,filter:function(t){"function"!=typeof t&&(t=ml(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var s,o=e[r],a=o.length,l=i[r]=[],h=0;h<a;++h)(s=o[h])&&t.call(s,s.__data__,h,o)&&l.push(s);return new vc(i,this._parents,this._name,this._id)},merge:function(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,i=e.length,r=n.length,s=Math.min(i,r),o=new Array(i),a=0;a<s;++a)for(var l,h=e[a],u=n[a],c=h.length,f=o[a]=new Array(c),d=0;d<c;++d)(l=h[d]||u[d])&&(f[d]=l);for(;a<i;++a)o[a]=e[a];return new vc(o,this._parents,this._name,this._id)},selection:function(){return new pc(this._groups,this._parents)},transition:function(){for(var t=this._name,e=this._id,n=wc(),i=this._groups,r=i.length,s=0;s<r;++s)for(var o,a=i[s],l=a.length,h=0;h<l;++h)if(o=a[h]){var u=nu(o,e);Qh(o,t,n,h,a,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new vc(i,this._parents,t,n)},call:xc.call,nodes:xc.nodes,node:xc.node,size:xc.size,empty:xc.empty,each:xc.each,on:function(t,e){var n=this._id;return arguments.length<2?nu(this.node(),n).on.on(t):this.each(function(t,e,n){var i,r,s=function(t){return(t+"").trim().split(/^|\s+/).every((function(t){var e=t.indexOf(".");return e>=0&&(t=t.slice(0,e)),!t||"start"===t}))}(e)?tu:eu;return function(){var o=s(this,t),a=o.on;a!==i&&(r=(i=a).copy()).on(e,n),o.on=r}}(n,t,e))},attr:function(t,e){var n=Nl(t),i="transform"===n?uu:nc;return this.attrTween(t,"function"==typeof e?(n.local?lc:ac)(n,i,du(this,"attr."+t,e)):null==e?(n.local?rc:ic)(n):(n.local?oc:sc)(n,i,e))},attrTween:function(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==e)return this.tween(n,null);if("function"!=typeof e)throw new Error;var i=Nl(t);return this.tween(n,(i.local?hc:uc)(i,e))},style:function(t,e,n){var i="transform"==(t+="")?hu:nc;return null==e?this.styleTween(t,function(t,e){var n,i,r;return function(){var s=ql(this,t),o=(this.style.removeProperty(t),ql(this,t));return s===o?null:s===n&&o===i?r:r=e(n=s,i=o)}}(t,i)).on("end.style."+t,mc(t)):"function"==typeof e?this.styleTween(t,function(t,e,n){var i,r,s;return function(){var o=ql(this,t),a=n(this),l=a+"";return null==a&&(this.style.removeProperty(t),l=a=ql(this,t)),o===l?null:o===i&&l===r?s:(r=l,s=e(i=o,a))}}(t,i,du(this,"style."+t,e))).each(function(t,e){var n,i,r,s,o="style."+e,a="end."+o;return function(){var l=eu(this,t),h=l.on,u=null==l.value[o]?s||(s=mc(e)):void 0;h===n&&r===u||(i=(n=h).copy()).on(a,r=u),l.on=i}}(this._id,t)):this.styleTween(t,function(t,e,n){var i,r,s=n+"";return function(){var o=ql(this,t);return o===s?null:o===i?r:r=e(i=o,n)}}(t,i,e),n).on("end.style."+t,null)},styleTween:function(t,e,n){var i="style."+(t+="");if(arguments.length<2)return(i=this.tween(i))&&i._value;if(null==e)return this.tween(i,null);if("function"!=typeof e)throw new Error;return this.tween(i,function(t,e,n){var i,r;function s(){var s=e.apply(this,arguments);return s!==r&&(i=(r=s)&&function(t,e,n){return function(i){this.style.setProperty(t,e.call(this,i),n)}}(t,s,n)),i}return s._value=e,s}(t,e,null==n?"":n))},text:function(t){return this.tween("text","function"==typeof t?function(t){return function(){var e=t(this);this.textContent=null==e?"":e}}(du(this,"text",t)):function(t){return function(){this.textContent=t}}(null==t?"":t+""))},textTween:function(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(null==t)return this.tween(e,null);if("function"!=typeof t)throw new Error;return this.tween(e,function(t){var e,n;function i(){var i=t.apply(this,arguments);return i!==n&&(e=(n=i)&&function(t){return function(e){this.textContent=t.call(this,e)}}(i)),e}return i._value=t,i}(t))},remove:function(){return this.on("end.remove",function(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}(this._id))},tween:function(t,e){var n=this._id;if(t+="",arguments.length<2){for(var i,r=nu(this.node(),n).tween,s=0,o=r.length;s<o;++s)if((i=r[s]).name===t)return i.value;return null}return this.each((null==e?cu:fu)(n,t,e))},delay:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?cc:fc)(e,t)):nu(this.node(),e).delay},duration:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?dc:gc)(e,t)):nu(this.node(),e).duration},ease:function(t){var e=this._id;return arguments.length?this.each(function(t,e){if("function"!=typeof e)throw new Error;return function(){eu(this,t).ease=e}}(e,t)):nu(this.node(),e).ease},easeVarying:function(t){if("function"!=typeof t)throw new Error;return this.each(function(t,e){return function(){var n=e.apply(this,arguments);if("function"!=typeof n)throw new Error;eu(this,t).ease=n}}(this._id,t))},end:function(){var t,e,n=this,i=n._id,r=n.size();return new Promise((function(s,o){var a={value:o},l={value:function(){0==--r&&s()}};n.each((function(){var n=eu(this,i),r=n.on;r!==t&&((e=(t=r).copy())._.cancel.push(a),e._.interrupt.push(a),e._.end.push(l)),n.on=e})),0===r&&s()}))},[Symbol.iterator]:xc[Symbol.iterator]};var _c={time:null,delay:0,duration:250,ease:function(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}};function bc(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}Eh.prototype.interrupt=function(t){return this.each((function(){!function(t,e){var n,i,r,s=t.__transition,o=!0;if(s){for(r in e=null==e?null:e+"",s)(n=s[r]).name===e?(i=n.state>2&&n.state<5,n.state=6,n.timer.stop(),n.on.call(i?"interrupt":"cancel",t,t.__data__,n.index,n.group),delete s[r]):o=!1;o&&delete t.__transition}}(this,t)}))},Eh.prototype.transition=function(t){var e,n;t instanceof vc?(e=t._id,t=t._name):(e=wc(),(n=_c).time=Uh(),t=null==t?null:t+"");for(var i=this._groups,r=i.length,s=0;s<r;++s)for(var o,a=i[s],l=a.length,h=0;h<l;++h)(o=a[h])&&Qh(o,t,e,h,a,n||bc(o,e));return new vc(i,this._parents,t,e)};const{abs:Ec,max:Sc,min:Ic}=Math;function Cc(t){return{type:t}}["w","e"].map(Cc),["n","s"].map(Cc),["n","w","e","s","nw","ne","sw","se"].map(Cc);const Mc=Math.sqrt(50),Rc=Math.sqrt(10),Pc=Math.sqrt(2);function Tc(t,e,n){const i=(e-t)/Math.max(0,n),r=Math.floor(Math.log10(i)),s=i/Math.pow(10,r),o=s>=Mc?10:s>=Rc?5:s>=Pc?2:1;let a,l,h;return r<0?(h=Math.pow(10,-r)/o,a=Math.round(t*h),l=Math.round(e*h),a/h<t&&++a,l/h>e&&--l,h=-h):(h=Math.pow(10,r)*o,a=Math.round(t/h),l=Math.round(e/h),a*h<t&&++a,l*h>e&&--l),l<a&&.5<=n&&n<2?Tc(t,e,2*n):[a,l,h]}function Nc(t,e,n){return Tc(t=+t,e=+e,n=+n)[2]}function Ac(t,e){return null==t||null==e?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function kc(t,e){return null==t||null==e?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function Lc(t){let e,n,i;function r(t,i,r=0,s=t.length){if(r<s){if(0!==e(i,i))return s;do{const e=r+s>>>1;n(t[e],i)<0?r=e+1:s=e}while(r<s)}return r}return 2!==t.length?(e=Ac,n=(e,n)=>Ac(t(e),n),i=(e,n)=>t(e)-n):(e=t===Ac||t===kc?t:Oc,n=t,i=t),{left:r,center:function(t,e,n=0,s=t.length){const o=r(t,e,n,s-1);return o>n&&i(t[o-1],e)>-i(t[o],e)?o-1:o},right:function(t,i,r=0,s=t.length){if(r<s){if(0!==e(i,i))return s;do{const e=r+s>>>1;n(t[e],i)<=0?r=e+1:s=e}while(r<s)}return r}}}function Oc(){return 0}const Dc=Lc(Ac),Fc=Dc.right,zc=(Dc.left,Lc((function(t){return null===t?NaN:+t})).center,Fc);function Gc(t,e){var n,i=e?e.length:0,r=t?Math.min(i,t.length):0,s=new Array(r),o=new Array(i);for(n=0;n<r;++n)s[n]=Vc(t[n],e[n]);for(;n<i;++n)o[n]=e[n];return function(t){for(n=0;n<r;++n)o[n]=s[n](t);return o}}function Bc(t,e){var n=new Date;return t=+t,e=+e,function(i){return n.setTime(t*(1-i)+e*i),n}}function Uc(t,e){var n,i={},r={};for(n in null!==t&&"object"==typeof t||(t={}),null!==e&&"object"==typeof e||(e={}),e)n in t?i[n]=Vc(t[n],e[n]):r[n]=e[n];return function(t){for(n in i)r[n]=i[n](t);return r}}function qc(t,e){e||(e=[]);var n,i=t?Math.min(e.length,t.length):0,r=e.slice();return function(s){for(n=0;n<i;++n)r[n]=t[n]*(1-s)+e[n]*s;return r}}function Vc(t,e){var n,i,r=typeof e;return null==e||"boolean"===r?$u(e):("number"===r?iu:"string"===r?(n=Au(e))?(e=n,Ku):ec:e instanceof Au?Ku:e instanceof Date?Bc:(i=e,!ArrayBuffer.isView(i)||i instanceof DataView?Array.isArray(e)?Gc:"function"!=typeof e.valueOf&&"function"!=typeof e.toString||isNaN(e)?Uc:iu:qc))(t,e)}function Yc(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}function Xc(t){return+t}var jc=[0,1];function Wc(t){return t}function Hc(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:(n=isNaN(e)?NaN:.5,function(){return n});var n}function $c(t,e,n){var i=t[0],r=t[1],s=e[0],o=e[1];return r<i?(i=Hc(r,i),s=n(o,s)):(i=Hc(i,r),s=n(s,o)),function(t){return s(i(t))}}function Zc(t,e,n){var i=Math.min(t.length,e.length)-1,r=new Array(i),s=new Array(i),o=-1;for(t[i]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++o<i;)r[o]=Hc(t[o],t[o+1]),s[o]=n(e[o],e[o+1]);return function(e){var n=zc(t,e,1,i)-1;return s[n](r[n](e))}}function Kc(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t)}return this}var Jc,Qc=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function tf(t){if(!(e=Qc.exec(t)))throw new Error("invalid format: "+t);var e;return new ef({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}function ef(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}function nf(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,i=t.slice(0,n);return[i.length>1?i[0]+i.slice(2):i,+t.slice(n+1)]}function rf(t){return(t=nf(Math.abs(t)))?t[1]:NaN}function sf(t,e){var n=nf(t,e);if(!n)return t+"";var i=n[0],r=n[1];return r<0?"0."+new Array(-r).join("0")+i:i.length>r+1?i.slice(0,r+1)+"."+i.slice(r+1):i+new Array(r-i.length+2).join("0")}tf.prototype=ef.prototype,ef.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};const of={"%":(t,e)=>(100*t).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:function(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)},e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>sf(100*t,e),r:sf,s:function(t,e){var n=nf(t,e);if(!n)return t+"";var i=n[0],r=n[1],s=r-(Jc=3*Math.max(-8,Math.min(8,Math.floor(r/3))))+1,o=i.length;return s===o?i:s>o?i+new Array(s-o+1).join("0"):s>0?i.slice(0,s)+"."+i.slice(s):"0."+new Array(1-s).join("0")+nf(t,Math.max(0,e+s-1))[0]},X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function af(t){return t}var lf,hf,uf,cf=Array.prototype.map,ff=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function df(t){var e=t.domain;return t.ticks=function(t){var n=e();return function(t,e,n){if(!((n=+n)>0))return[];if((t=+t)==(e=+e))return[t];const i=e<t,[r,s,o]=i?Tc(e,t,n):Tc(t,e,n);if(!(s>=r))return[];const a=s-r+1,l=new Array(a);if(i)if(o<0)for(let t=0;t<a;++t)l[t]=(s-t)/-o;else for(let t=0;t<a;++t)l[t]=(s-t)*o;else if(o<0)for(let t=0;t<a;++t)l[t]=(r+t)/-o;else for(let t=0;t<a;++t)l[t]=(r+t)*o;return l}(n[0],n[n.length-1],null==t?10:t)},t.tickFormat=function(t,n){var i=e();return function(t,e,n,i){var r,s=function(t,e,n){n=+n;const i=(e=+e)<(t=+t),r=i?Nc(e,t,n):Nc(t,e,n);return(i?-1:1)*(r<0?1/-r:r)}(t,e,n);switch((i=tf(null==i?",f":i)).type){case"s":var o=Math.max(Math.abs(t),Math.abs(e));return null!=i.precision||isNaN(r=function(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(rf(e)/3)))-rf(Math.abs(t)))}(s,o))||(i.precision=r),uf(i,o);case"":case"e":case"g":case"p":case"r":null!=i.precision||isNaN(r=function(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,rf(e)-rf(t))+1}(s,Math.max(Math.abs(t),Math.abs(e))))||(i.precision=r-("e"===i.type));break;case"f":case"%":null!=i.precision||isNaN(r=function(t){return Math.max(0,-rf(Math.abs(t)))}(s))||(i.precision=r-2*("%"===i.type))}return hf(i)}(i[0],i[i.length-1],null==t?10:t,n)},t.nice=function(n){null==n&&(n=10);var i,r,s=e(),o=0,a=s.length-1,l=s[o],h=s[a],u=10;for(h<l&&(r=l,l=h,h=r,r=o,o=a,a=r);u-- >0;){if((r=Nc(l,h,n))===i)return s[o]=l,s[a]=h,e(s);if(r>0)l=Math.floor(l/r)*r,h=Math.ceil(h/r)*r;else{if(!(r<0))break;l=Math.ceil(l*r)/r,h=Math.floor(h*r)/r}i=r}return t},t}function gf(){var t=function(){var t,e,n,i,r,s,o=jc,a=jc,l=Vc,h=Wc;function u(){var t,e,n,l=Math.min(o.length,a.length);return h!==Wc&&(t=o[0],e=o[l-1],t>e&&(n=t,t=e,e=n),h=function(n){return Math.max(t,Math.min(e,n))}),i=l>2?Zc:$c,r=s=null,c}function c(e){return null==e||isNaN(e=+e)?n:(r||(r=i(o.map(t),a,l)))(t(h(e)))}return c.invert=function(n){return h(e((s||(s=i(a,o.map(t),iu)))(n)))},c.domain=function(t){return arguments.length?(o=Array.from(t,Xc),u()):o.slice()},c.range=function(t){return arguments.length?(a=Array.from(t),u()):a.slice()},c.rangeRound=function(t){return a=Array.from(t),l=Yc,u()},c.clamp=function(t){return arguments.length?(h=!!t||Wc,u()):h!==Wc},c.interpolate=function(t){return arguments.length?(l=t,u()):l},c.unknown=function(t){return arguments.length?(n=t,c):n},function(n,i){return t=n,e=i,u()}}()(Wc,Wc);return t.copy=function(){return e=t,gf().domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown());var e},Kc.apply(t,arguments),df(t)}function pf(t){return function(){return t}}function mf(t){this._context=t}function yf(t){return new mf(t)}lf=function(t){var e,n,i=void 0===t.grouping||void 0===t.thousands?af:(e=cf.call(t.grouping,Number),n=t.thousands+"",function(t,i){for(var r=t.length,s=[],o=0,a=e[0],l=0;r>0&&a>0&&(l+a+1>i&&(a=Math.max(1,i-l)),s.push(t.substring(r-=a,r+a)),!((l+=a+1)>i));)a=e[o=(o+1)%e.length];return s.reverse().join(n)}),r=void 0===t.currency?"":t.currency[0]+"",s=void 0===t.currency?"":t.currency[1]+"",o=void 0===t.decimal?".":t.decimal+"",a=void 0===t.numerals?af:function(t){return function(e){return e.replace(/[0-9]/g,(function(e){return t[+e]}))}}(cf.call(t.numerals,String)),l=void 0===t.percent?"%":t.percent+"",h=void 0===t.minus?"":t.minus+"",u=void 0===t.nan?"NaN":t.nan+"";function c(t){var e=(t=tf(t)).fill,n=t.align,c=t.sign,f=t.symbol,d=t.zero,g=t.width,p=t.comma,m=t.precision,y=t.trim,v=t.type;"n"===v?(p=!0,v="g"):of[v]||(void 0===m&&(m=12),y=!0,v="g"),(d||"0"===e&&"="===n)&&(d=!0,e="0",n="=");var w="$"===f?r:"#"===f&&/[boxX]/.test(v)?"0"+v.toLowerCase():"",x="$"===f?s:/[%p]/.test(v)?l:"",_=of[v],b=/[defgprs%]/.test(v);function E(t){var r,s,l,f=w,E=x;if("c"===v)E=_(t)+E,t="";else{var S=(t=+t)<0||1/t<0;if(t=isNaN(t)?u:_(Math.abs(t),m),y&&(t=function(t){t:for(var e,n=t.length,i=1,r=-1;i<n;++i)switch(t[i]){case".":r=e=i;break;case"0":0===r&&(r=i),e=i;break;default:if(!+t[i])break t;r>0&&(r=0)}return r>0?t.slice(0,r)+t.slice(e+1):t}(t)),S&&0==+t&&"+"!==c&&(S=!1),f=(S?"("===c?c:h:"-"===c||"("===c?"":c)+f,E=("s"===v?ff[8+Jc/3]:"")+E+(S&&"("===c?")":""),b)for(r=-1,s=t.length;++r<s;)if(48>(l=t.charCodeAt(r))||l>57){E=(46===l?o+t.slice(r+1):t.slice(r))+E,t=t.slice(0,r);break}}p&&!d&&(t=i(t,1/0));var I=f.length+t.length+E.length,C=I<g?new Array(g-I+1).join(e):"";switch(p&&d&&(t=i(C+t,C.length?g-E.length:1/0),C=""),n){case"<":t=f+t+E+C;break;case"=":t=f+C+t+E;break;case"^":t=C.slice(0,I=C.length>>1)+f+t+E+C.slice(I);break;default:t=C+f+t+E}return a(t)}return m=void 0===m?6:/[gprs]/.test(v)?Math.max(1,Math.min(21,m)):Math.max(0,Math.min(20,m)),E.toString=function(){return t+""},E}return{format:c,formatPrefix:function(t,e){var n=c(((t=tf(t)).type="f",t)),i=3*Math.max(-8,Math.min(8,Math.floor(rf(e)/3))),r=Math.pow(10,-i),s=ff[8+i/3];return function(t){return n(r*t)+s}}}}({thousands:",",grouping:[3],currency:["$",""]}),hf=lf.format,uf=lf.formatPrefix,Array.prototype.slice,mf.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e)}}};const vf=Math.PI,wf=2*vf,xf=1e-6,_f=wf-xf;function bf(t){this._+=t[0];for(let e=1,n=t.length;e<n;++e)this._+=arguments[e]+t[e]}class Ef{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=null==t?bf:function(t){let e=Math.floor(t);if(!(e>=0))throw new Error(`invalid digits: ${t}`);if(e>15)return bf;const n=10**e;return function(t){this._+=t[0];for(let e=1,i=t.length;e<i;++e)this._+=Math.round(arguments[e]*n)/n+t[e]}}(t)}moveTo(t,e){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+e}`}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,e){this._append`L${this._x1=+t},${this._y1=+e}`}quadraticCurveTo(t,e,n,i){this._append`Q${+t},${+e},${this._x1=+n},${this._y1=+i}`}bezierCurveTo(t,e,n,i,r,s){this._append`C${+t},${+e},${+n},${+i},${this._x1=+r},${this._y1=+s}`}arcTo(t,e,n,i,r){if(t=+t,e=+e,n=+n,i=+i,(r=+r)<0)throw new Error(`negative radius: ${r}`);let s=this._x1,o=this._y1,a=n-t,l=i-e,h=s-t,u=o-e,c=h*h+u*u;if(null===this._x1)this._append`M${this._x1=t},${this._y1=e}`;else if(c>xf)if(Math.abs(u*a-l*h)>xf&&r){let f=n-s,d=i-o,g=a*a+l*l,p=f*f+d*d,m=Math.sqrt(g),y=Math.sqrt(c),v=r*Math.tan((vf-Math.acos((g+c-p)/(2*m*y)))/2),w=v/y,x=v/m;Math.abs(w-1)>xf&&this._append`L${t+w*h},${e+w*u}`,this._append`A${r},${r},0,0,${+(u*f>h*d)},${this._x1=t+x*a},${this._y1=e+x*l}`}else this._append`L${this._x1=t},${this._y1=e}`}arc(t,e,n,i,r,s){if(t=+t,e=+e,s=!!s,(n=+n)<0)throw new Error(`negative radius: ${n}`);let o=n*Math.cos(i),a=n*Math.sin(i),l=t+o,h=e+a,u=1^s,c=s?i-r:r-i;null===this._x1?this._append`M${l},${h}`:(Math.abs(this._x1-l)>xf||Math.abs(this._y1-h)>xf)&&this._append`L${l},${h}`,n&&(c<0&&(c=c%wf+wf),c>_f?this._append`A${n},${n},0,1,${u},${t-o},${e-a}A${n},${n},0,1,${u},${this._x1=l},${this._y1=h}`:c>xf&&this._append`A${n},${n},0,${+(c>=vf)},${u},${this._x1=t+n*Math.cos(r)},${this._y1=e+n*Math.sin(r)}`)}rect(t,e,n,i){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+e}h${n=+n}v${+i}h${-n}Z`}toString(){return this._}}function Sf(t){return t[0]}function If(t){return t[1]}function Cf(t,e,n){this.k=t,this.x=e,this.y=n}function Mf(t){const e=function(t){return new _h([[document.querySelector(t)]],[document.documentElement])}("#chart").append("svg").attr("width",400).attr("height",400).append("g").attr("transform","translate(40, 20)"),n=gf().domain([1,Qa(t,(t=>t.bufferWidth))]).range([0,330]),i=gf().domain([0,Qa(t,(t=>t.percentageInBuffer))]).range([350,0]),r=function(t,e){var n=pf(!0),i=null,r=yf,s=null,o=function(t){let e=3;return t.digits=function(n){if(!arguments.length)return e;if(null==n)e=null;else{const t=Math.floor(n);if(!(t>=0))throw new RangeError(`invalid digits: ${n}`);e=t}return t},()=>new Ef(e)}(a);function a(a){var l,h,u,c=(a=function(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}(a)).length,f=!1;for(null==i&&(s=r(u=o())),l=0;l<=c;++l)!(l<c&&n(h=a[l],l,a))===f&&((f=!f)?s.lineStart():s.lineEnd()),f&&s.point(+t(h,l,a),+e(h,l,a));if(u)return s=null,u+""||null}return t="function"==typeof t?t:void 0===t?Sf:pf(t),e="function"==typeof e?e:void 0===e?If:pf(e),a.x=function(e){return arguments.length?(t="function"==typeof e?e:pf(+e),a):t},a.y=function(t){return arguments.length?(e="function"==typeof t?t:pf(+t),a):e},a.defined=function(t){return arguments.length?(n="function"==typeof t?t:pf(!!t),a):n},a.curve=function(t){return arguments.length?(r=t,null!=i&&(s=r(i)),a):r},a.context=function(t){return arguments.length?(null==t?i=s=null:s=r(i=t),a):i},a}().x((t=>n(t.bufferWidth))).y((t=>i(t.percentageInBuffer)));e.append("path").datum(t).attr("fill","none").attr("stroke","steelblue").attr("stroke-width",2).attr("d",r);const s=cl(il,n),o=function(t){return cl(rl,t)}(i);e.append("g").attr("class","x-axis").attr("transform","translate(0, 350)").call(s),e.append("g").attr("class","y-axis").call(o),e.selectAll("circle").data(t).enter().append("circle").attr("cx",(t=>n(t.bufferWidth))).attr("cy",(t=>i(t.percentageInBuffer))).attr("r",5).attr("fill","steelblue")}function Rf(t,e){let n=[];if(!1===e)for(let e=0;e<t.length;e+=4){let i=t[e],r=t[e+1],s=t[e+2];t[e+3],n.push([i,r,s])}else if(!0===e)for(let e=0;e<t.length;e+=4){let i=t[e],r=t[e+1],s=t[e+2],o=t[e+3];n.push([i,r,s,o])}return n}function Pf(t,e,n,i){return Rf(e,!1)[Math.floor(t[1])*n+Math.floor(t[0])]}function Tf(t,e){return Math.sqrt(Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2))}Ef.prototype,Cf.prototype={constructor:Cf,scale:function(t){return 1===t?this:new Cf(this.k*t,this.x,this.y)},translate:function(t,e){return 0===t&0===e?this:new Cf(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}},new Cf(1,0,0),Cf.prototype;const Nf={getBit(t){return this.data[Af(t)]&1<<kf(t)?1:0},setBit(t){this.data[Af(t)]|=1<<kf(t)},clearBit(t){this.data[Af(t)]&=~(1<<kf(t))},toggleBit(t){this.data[Af(t)]^=1<<kf(t)},getBitXY(t,e){return t>=this.width||e>=this.height?0:this.getBit(e*this.width+t)},setBitXY(t,e){this.setBit(e*this.width+t)},clearBitXY(t,e){this.clearBit(e*this.width+t)},toggleBitXY(t,e){this.toggleBit(e*this.width+t)}};function Af(t){return t>>3}function kf(t){return 7-(7&t)}function Lf(t,e,n){return"function"==typeof t.toBlob?new Promise((function(i){t.toBlob(i,e,n)})):Promise.resolve(function(t){var e=t.match(/data:([^;]+)/)[1],n=t.replace(/^[^,]+,/,"");return function(t,e){t=t||[],"string"==typeof(e=e||{})&&(e={type:e});try{return new Blob(t,e)}catch(r){if("TypeError"!==r.name)throw r;for(var n=new("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),i=0;i<t.length;i+=1)n.append(t[i]);return n.getBlob(e.type)}}([Of(atob(n))],{type:e})}(t.toDataURL(e,n)))}function Of(t){for(var e=t.length,n=new ArrayBuffer(e),i=new Uint8Array(n),r=-1;++r<e;)i[r]=t.charCodeAt(r);return n}var Df=__webpack_require__(4665),Ff=__webpack_require__(2155);function zf(t){let e=t.length;for(;--e>=0;)t[e]=0}const Gf=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),Bf=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),Uf=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),qf=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Vf=new Array(576);zf(Vf);const Yf=new Array(60);zf(Yf);const Xf=new Array(512);zf(Xf);const jf=new Array(256);zf(jf);const Wf=new Array(29);zf(Wf);const Hf=new Array(30);function $f(t,e,n,i,r){this.static_tree=t,this.extra_bits=e,this.extra_base=n,this.elems=i,this.max_length=r,this.has_stree=t&&t.length}let Zf,Kf,Jf;function Qf(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e}zf(Hf);const td=t=>t<256?Xf[t]:Xf[256+(t>>>7)],ed=(t,e)=>{t.pending_buf[t.pending++]=255&e,t.pending_buf[t.pending++]=e>>>8&255},nd=(t,e,n)=>{t.bi_valid>16-n?(t.bi_buf|=e<<t.bi_valid&65535,ed(t,t.bi_buf),t.bi_buf=e>>16-t.bi_valid,t.bi_valid+=n-16):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=n)},id=(t,e,n)=>{nd(t,n[2*e],n[2*e+1])},rd=(t,e)=>{let n=0;do{n|=1&t,t>>>=1,n<<=1}while(--e>0);return n>>>1},sd=(t,e,n)=>{const i=new Array(16);let r,s,o=0;for(r=1;r<=15;r++)o=o+n[r-1]<<1,i[r]=o;for(s=0;s<=e;s++){let e=t[2*s+1];0!==e&&(t[2*s]=rd(i[e]++,e))}},od=t=>{let e;for(e=0;e<286;e++)t.dyn_ltree[2*e]=0;for(e=0;e<30;e++)t.dyn_dtree[2*e]=0;for(e=0;e<19;e++)t.bl_tree[2*e]=0;t.dyn_ltree[512]=1,t.opt_len=t.static_len=0,t.sym_next=t.matches=0},ad=t=>{t.bi_valid>8?ed(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0},ld=(t,e,n,i)=>{const r=2*e,s=2*n;return t[r]<t[s]||t[r]===t[s]&&i[e]<=i[n]},hd=(t,e,n)=>{const i=t.heap[n];let r=n<<1;for(;r<=t.heap_len&&(r<t.heap_len&&ld(e,t.heap[r+1],t.heap[r],t.depth)&&r++,!ld(e,i,t.heap[r],t.depth));)t.heap[n]=t.heap[r],n=r,r<<=1;t.heap[n]=i},ud=(t,e,n)=>{let i,r,s,o,a=0;if(0!==t.sym_next)do{i=255&t.pending_buf[t.sym_buf+a++],i+=(255&t.pending_buf[t.sym_buf+a++])<<8,r=t.pending_buf[t.sym_buf+a++],0===i?id(t,r,e):(s=jf[r],id(t,s+256+1,e),o=Gf[s],0!==o&&(r-=Wf[s],nd(t,r,o)),i--,s=td(i),id(t,s,n),o=Bf[s],0!==o&&(i-=Hf[s],nd(t,i,o)))}while(a<t.sym_next);id(t,256,e)},cd=(t,e)=>{const n=e.dyn_tree,i=e.stat_desc.static_tree,r=e.stat_desc.has_stree,s=e.stat_desc.elems;let o,a,l,h=-1;for(t.heap_len=0,t.heap_max=573,o=0;o<s;o++)0!==n[2*o]?(t.heap[++t.heap_len]=h=o,t.depth[o]=0):n[2*o+1]=0;for(;t.heap_len<2;)l=t.heap[++t.heap_len]=h<2?++h:0,n[2*l]=1,t.depth[l]=0,t.opt_len--,r&&(t.static_len-=i[2*l+1]);for(e.max_code=h,o=t.heap_len>>1;o>=1;o--)hd(t,n,o);l=s;do{o=t.heap[1],t.heap[1]=t.heap[t.heap_len--],hd(t,n,1),a=t.heap[1],t.heap[--t.heap_max]=o,t.heap[--t.heap_max]=a,n[2*l]=n[2*o]+n[2*a],t.depth[l]=(t.depth[o]>=t.depth[a]?t.depth[o]:t.depth[a])+1,n[2*o+1]=n[2*a+1]=l,t.heap[1]=l++,hd(t,n,1)}while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],((t,e)=>{const n=e.dyn_tree,i=e.max_code,r=e.stat_desc.static_tree,s=e.stat_desc.has_stree,o=e.stat_desc.extra_bits,a=e.stat_desc.extra_base,l=e.stat_desc.max_length;let h,u,c,f,d,g,p=0;for(f=0;f<=15;f++)t.bl_count[f]=0;for(n[2*t.heap[t.heap_max]+1]=0,h=t.heap_max+1;h<573;h++)u=t.heap[h],f=n[2*n[2*u+1]+1]+1,f>l&&(f=l,p++),n[2*u+1]=f,u>i||(t.bl_count[f]++,d=0,u>=a&&(d=o[u-a]),g=n[2*u],t.opt_len+=g*(f+d),s&&(t.static_len+=g*(r[2*u+1]+d)));if(0!==p){do{for(f=l-1;0===t.bl_count[f];)f--;t.bl_count[f]--,t.bl_count[f+1]+=2,t.bl_count[l]--,p-=2}while(p>0);for(f=l;0!==f;f--)for(u=t.bl_count[f];0!==u;)c=t.heap[--h],c>i||(n[2*c+1]!==f&&(t.opt_len+=(f-n[2*c+1])*n[2*c],n[2*c+1]=f),u--)}})(t,e),sd(n,h,t.bl_count)},fd=(t,e,n)=>{let i,r,s=-1,o=e[1],a=0,l=7,h=4;for(0===o&&(l=138,h=3),e[2*(n+1)+1]=65535,i=0;i<=n;i++)r=o,o=e[2*(i+1)+1],++a<l&&r===o||(a<h?t.bl_tree[2*r]+=a:0!==r?(r!==s&&t.bl_tree[2*r]++,t.bl_tree[32]++):a<=10?t.bl_tree[34]++:t.bl_tree[36]++,a=0,s=r,0===o?(l=138,h=3):r===o?(l=6,h=3):(l=7,h=4))},dd=(t,e,n)=>{let i,r,s=-1,o=e[1],a=0,l=7,h=4;for(0===o&&(l=138,h=3),i=0;i<=n;i++)if(r=o,o=e[2*(i+1)+1],!(++a<l&&r===o)){if(a<h)do{id(t,r,t.bl_tree)}while(0!=--a);else 0!==r?(r!==s&&(id(t,r,t.bl_tree),a--),id(t,16,t.bl_tree),nd(t,a-3,2)):a<=10?(id(t,17,t.bl_tree),nd(t,a-3,3)):(id(t,18,t.bl_tree),nd(t,a-11,7));a=0,s=r,0===o?(l=138,h=3):r===o?(l=6,h=3):(l=7,h=4)}};let gd=!1;const pd=(t,e,n,i)=>{nd(t,0+(i?1:0),3),ad(t),ed(t,n),ed(t,~n),n&&t.pending_buf.set(t.window.subarray(e,e+n),t.pending),t.pending+=n};var md={_tr_init:t=>{gd||((()=>{let t,e,n,i,r;const s=new Array(16);for(n=0,i=0;i<28;i++)for(Wf[i]=n,t=0;t<1<<Gf[i];t++)jf[n++]=i;for(jf[n-1]=i,r=0,i=0;i<16;i++)for(Hf[i]=r,t=0;t<1<<Bf[i];t++)Xf[r++]=i;for(r>>=7;i<30;i++)for(Hf[i]=r<<7,t=0;t<1<<Bf[i]-7;t++)Xf[256+r++]=i;for(e=0;e<=15;e++)s[e]=0;for(t=0;t<=143;)Vf[2*t+1]=8,t++,s[8]++;for(;t<=255;)Vf[2*t+1]=9,t++,s[9]++;for(;t<=279;)Vf[2*t+1]=7,t++,s[7]++;for(;t<=287;)Vf[2*t+1]=8,t++,s[8]++;for(sd(Vf,287,s),t=0;t<30;t++)Yf[2*t+1]=5,Yf[2*t]=rd(t,5);Zf=new $f(Vf,Gf,257,286,15),Kf=new $f(Yf,Bf,0,30,15),Jf=new $f(new Array(0),Uf,0,19,7)})(),gd=!0),t.l_desc=new Qf(t.dyn_ltree,Zf),t.d_desc=new Qf(t.dyn_dtree,Kf),t.bl_desc=new Qf(t.bl_tree,Jf),t.bi_buf=0,t.bi_valid=0,od(t)},_tr_stored_block:pd,_tr_flush_block:(t,e,n,i)=>{let r,s,o=0;t.level>0?(2===t.strm.data_type&&(t.strm.data_type=(t=>{let e,n=4093624447;for(e=0;e<=31;e++,n>>>=1)if(1&n&&0!==t.dyn_ltree[2*e])return 0;if(0!==t.dyn_ltree[18]||0!==t.dyn_ltree[20]||0!==t.dyn_ltree[26])return 1;for(e=32;e<256;e++)if(0!==t.dyn_ltree[2*e])return 1;return 0})(t)),cd(t,t.l_desc),cd(t,t.d_desc),o=(t=>{let e;for(fd(t,t.dyn_ltree,t.l_desc.max_code),fd(t,t.dyn_dtree,t.d_desc.max_code),cd(t,t.bl_desc),e=18;e>=3&&0===t.bl_tree[2*qf[e]+1];e--);return t.opt_len+=3*(e+1)+5+5+4,e})(t),r=t.opt_len+3+7>>>3,s=t.static_len+3+7>>>3,s<=r&&(r=s)):r=s=n+5,n+4<=r&&-1!==e?pd(t,e,n,i):4===t.strategy||s===r?(nd(t,2+(i?1:0),3),ud(t,Vf,Yf)):(nd(t,4+(i?1:0),3),((t,e,n,i)=>{let r;for(nd(t,e-257,5),nd(t,n-1,5),nd(t,i-4,4),r=0;r<i;r++)nd(t,t.bl_tree[2*qf[r]+1],3);dd(t,t.dyn_ltree,e-1),dd(t,t.dyn_dtree,n-1)})(t,t.l_desc.max_code+1,t.d_desc.max_code+1,o+1),ud(t,t.dyn_ltree,t.dyn_dtree)),od(t),i&&ad(t)},_tr_tally:(t,e,n)=>(t.pending_buf[t.sym_buf+t.sym_next++]=e,t.pending_buf[t.sym_buf+t.sym_next++]=e>>8,t.pending_buf[t.sym_buf+t.sym_next++]=n,0===e?t.dyn_ltree[2*n]++:(t.matches++,e--,t.dyn_ltree[2*(jf[n]+256+1)]++,t.dyn_dtree[2*td(e)]++),t.sym_next===t.sym_end),_tr_align:t=>{nd(t,2,3),id(t,256,Vf),(t=>{16===t.bi_valid?(ed(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)})(t)}},yd=(t,e,n,i)=>{let r=65535&t|0,s=t>>>16&65535|0,o=0;for(;0!==n;){o=n>2e3?2e3:n,n-=o;do{r=r+e[i++]|0,s=s+r|0}while(--o);r%=65521,s%=65521}return r|s<<16|0};const vd=new Uint32Array((()=>{let t,e=[];for(var n=0;n<256;n++){t=n;for(var i=0;i<8;i++)t=1&t?3988292384^t>>>1:t>>>1;e[n]=t}return e})());var wd=(t,e,n,i)=>{const r=vd,s=i+n;t^=-1;for(let n=i;n<s;n++)t=t>>>8^r[255&(t^e[n])];return-1^t},xd={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},_d={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:bd,_tr_stored_block:Ed,_tr_flush_block:Sd,_tr_tally:Id,_tr_align:Cd}=md,{Z_NO_FLUSH:Md,Z_PARTIAL_FLUSH:Rd,Z_FULL_FLUSH:Pd,Z_FINISH:Td,Z_BLOCK:Nd,Z_OK:Ad,Z_STREAM_END:kd,Z_STREAM_ERROR:Ld,Z_DATA_ERROR:Od,Z_BUF_ERROR:Dd,Z_DEFAULT_COMPRESSION:Fd,Z_FILTERED:zd,Z_HUFFMAN_ONLY:Gd,Z_RLE:Bd,Z_FIXED:Ud,Z_DEFAULT_STRATEGY:qd,Z_UNKNOWN:Vd,Z_DEFLATED:Yd}=_d,Xd=258,jd=262,Wd=42,Hd=113,$d=666,Zd=(t,e)=>(t.msg=xd[e],e),Kd=t=>2*t-(t>4?9:0),Jd=t=>{let e=t.length;for(;--e>=0;)t[e]=0},Qd=t=>{let e,n,i,r=t.w_size;e=t.hash_size,i=e;do{n=t.head[--i],t.head[i]=n>=r?n-r:0}while(--e);e=r,i=e;do{n=t.prev[--i],t.prev[i]=n>=r?n-r:0}while(--e)};let tg=(t,e,n)=>(e<<t.hash_shift^n)&t.hash_mask;const eg=t=>{const e=t.state;let n=e.pending;n>t.avail_out&&(n=t.avail_out),0!==n&&(t.output.set(e.pending_buf.subarray(e.pending_out,e.pending_out+n),t.next_out),t.next_out+=n,e.pending_out+=n,t.total_out+=n,t.avail_out-=n,e.pending-=n,0===e.pending&&(e.pending_out=0))},ng=(t,e)=>{Sd(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,eg(t.strm)},ig=(t,e)=>{t.pending_buf[t.pending++]=e},rg=(t,e)=>{t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=255&e},sg=(t,e,n,i)=>{let r=t.avail_in;return r>i&&(r=i),0===r?0:(t.avail_in-=r,e.set(t.input.subarray(t.next_in,t.next_in+r),n),1===t.state.wrap?t.adler=yd(t.adler,e,r,n):2===t.state.wrap&&(t.adler=wd(t.adler,e,r,n)),t.next_in+=r,t.total_in+=r,r)},og=(t,e)=>{let n,i,r=t.max_chain_length,s=t.strstart,o=t.prev_length,a=t.nice_match;const l=t.strstart>t.w_size-jd?t.strstart-(t.w_size-jd):0,h=t.window,u=t.w_mask,c=t.prev,f=t.strstart+Xd;let d=h[s+o-1],g=h[s+o];t.prev_length>=t.good_match&&(r>>=2),a>t.lookahead&&(a=t.lookahead);do{if(n=e,h[n+o]===g&&h[n+o-1]===d&&h[n]===h[s]&&h[++n]===h[s+1]){s+=2,n++;do{}while(h[++s]===h[++n]&&h[++s]===h[++n]&&h[++s]===h[++n]&&h[++s]===h[++n]&&h[++s]===h[++n]&&h[++s]===h[++n]&&h[++s]===h[++n]&&h[++s]===h[++n]&&s<f);if(i=Xd-(f-s),s=f-Xd,i>o){if(t.match_start=e,o=i,i>=a)break;d=h[s+o-1],g=h[s+o]}}}while((e=c[e&u])>l&&0!=--r);return o<=t.lookahead?o:t.lookahead},ag=t=>{const e=t.w_size;let n,i,r;do{if(i=t.window_size-t.lookahead-t.strstart,t.strstart>=e+(e-jd)&&(t.window.set(t.window.subarray(e,e+e-i),0),t.match_start-=e,t.strstart-=e,t.block_start-=e,t.insert>t.strstart&&(t.insert=t.strstart),Qd(t),i+=e),0===t.strm.avail_in)break;if(n=sg(t.strm,t.window,t.strstart+t.lookahead,i),t.lookahead+=n,t.lookahead+t.insert>=3)for(r=t.strstart-t.insert,t.ins_h=t.window[r],t.ins_h=tg(t,t.ins_h,t.window[r+1]);t.insert&&(t.ins_h=tg(t,t.ins_h,t.window[r+3-1]),t.prev[r&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=r,r++,t.insert--,!(t.lookahead+t.insert<3)););}while(t.lookahead<jd&&0!==t.strm.avail_in)},lg=(t,e)=>{let n,i,r,s=t.pending_buf_size-5>t.w_size?t.w_size:t.pending_buf_size-5,o=0,a=t.strm.avail_in;do{if(n=65535,r=t.bi_valid+42>>3,t.strm.avail_out<r)break;if(r=t.strm.avail_out-r,i=t.strstart-t.block_start,n>i+t.strm.avail_in&&(n=i+t.strm.avail_in),n>r&&(n=r),n<s&&(0===n&&e!==Td||e===Md||n!==i+t.strm.avail_in))break;o=e===Td&&n===i+t.strm.avail_in?1:0,Ed(t,0,0,o),t.pending_buf[t.pending-4]=n,t.pending_buf[t.pending-3]=n>>8,t.pending_buf[t.pending-2]=~n,t.pending_buf[t.pending-1]=~n>>8,eg(t.strm),i&&(i>n&&(i=n),t.strm.output.set(t.window.subarray(t.block_start,t.block_start+i),t.strm.next_out),t.strm.next_out+=i,t.strm.avail_out-=i,t.strm.total_out+=i,t.block_start+=i,n-=i),n&&(sg(t.strm,t.strm.output,t.strm.next_out,n),t.strm.next_out+=n,t.strm.avail_out-=n,t.strm.total_out+=n)}while(0===o);return a-=t.strm.avail_in,a&&(a>=t.w_size?(t.matches=2,t.window.set(t.strm.input.subarray(t.strm.next_in-t.w_size,t.strm.next_in),0),t.strstart=t.w_size,t.insert=t.strstart):(t.window_size-t.strstart<=a&&(t.strstart-=t.w_size,t.window.set(t.window.subarray(t.w_size,t.w_size+t.strstart),0),t.matches<2&&t.matches++,t.insert>t.strstart&&(t.insert=t.strstart)),t.window.set(t.strm.input.subarray(t.strm.next_in-a,t.strm.next_in),t.strstart),t.strstart+=a,t.insert+=a>t.w_size-t.insert?t.w_size-t.insert:a),t.block_start=t.strstart),t.high_water<t.strstart&&(t.high_water=t.strstart),o?4:e!==Md&&e!==Td&&0===t.strm.avail_in&&t.strstart===t.block_start?2:(r=t.window_size-t.strstart,t.strm.avail_in>r&&t.block_start>=t.w_size&&(t.block_start-=t.w_size,t.strstart-=t.w_size,t.window.set(t.window.subarray(t.w_size,t.w_size+t.strstart),0),t.matches<2&&t.matches++,r+=t.w_size,t.insert>t.strstart&&(t.insert=t.strstart)),r>t.strm.avail_in&&(r=t.strm.avail_in),r&&(sg(t.strm,t.window,t.strstart,r),t.strstart+=r,t.insert+=r>t.w_size-t.insert?t.w_size-t.insert:r),t.high_water<t.strstart&&(t.high_water=t.strstart),r=t.bi_valid+42>>3,r=t.pending_buf_size-r>65535?65535:t.pending_buf_size-r,s=r>t.w_size?t.w_size:r,i=t.strstart-t.block_start,(i>=s||(i||e===Td)&&e!==Md&&0===t.strm.avail_in&&i<=r)&&(n=i>r?r:i,o=e===Td&&0===t.strm.avail_in&&n===i?1:0,Ed(t,t.block_start,n,o),t.block_start+=n,eg(t.strm)),o?3:1)},hg=(t,e)=>{let n,i;for(;;){if(t.lookahead<jd){if(ag(t),t.lookahead<jd&&e===Md)return 1;if(0===t.lookahead)break}if(n=0,t.lookahead>=3&&(t.ins_h=tg(t,t.ins_h,t.window[t.strstart+3-1]),n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!==n&&t.strstart-n<=t.w_size-jd&&(t.match_length=og(t,n)),t.match_length>=3)if(i=Id(t,t.strstart-t.match_start,t.match_length-3),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=3){t.match_length--;do{t.strstart++,t.ins_h=tg(t,t.ins_h,t.window[t.strstart+3-1]),n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart}while(0!=--t.match_length);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=tg(t,t.ins_h,t.window[t.strstart+1]);else i=Id(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(i&&(ng(t,!1),0===t.strm.avail_out))return 1}return t.insert=t.strstart<2?t.strstart:2,e===Td?(ng(t,!0),0===t.strm.avail_out?3:4):t.sym_next&&(ng(t,!1),0===t.strm.avail_out)?1:2},ug=(t,e)=>{let n,i,r;for(;;){if(t.lookahead<jd){if(ag(t),t.lookahead<jd&&e===Md)return 1;if(0===t.lookahead)break}if(n=0,t.lookahead>=3&&(t.ins_h=tg(t,t.ins_h,t.window[t.strstart+3-1]),n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=2,0!==n&&t.prev_length<t.max_lazy_match&&t.strstart-n<=t.w_size-jd&&(t.match_length=og(t,n),t.match_length<=5&&(t.strategy===zd||3===t.match_length&&t.strstart-t.match_start>4096)&&(t.match_length=2)),t.prev_length>=3&&t.match_length<=t.prev_length){r=t.strstart+t.lookahead-3,i=Id(t,t.strstart-1-t.prev_match,t.prev_length-3),t.lookahead-=t.prev_length-1,t.prev_length-=2;do{++t.strstart<=r&&(t.ins_h=tg(t,t.ins_h,t.window[t.strstart+3-1]),n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart)}while(0!=--t.prev_length);if(t.match_available=0,t.match_length=2,t.strstart++,i&&(ng(t,!1),0===t.strm.avail_out))return 1}else if(t.match_available){if(i=Id(t,0,t.window[t.strstart-1]),i&&ng(t,!1),t.strstart++,t.lookahead--,0===t.strm.avail_out)return 1}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(i=Id(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<2?t.strstart:2,e===Td?(ng(t,!0),0===t.strm.avail_out?3:4):t.sym_next&&(ng(t,!1),0===t.strm.avail_out)?1:2};function cg(t,e,n,i,r){this.good_length=t,this.max_lazy=e,this.nice_length=n,this.max_chain=i,this.func=r}const fg=[new cg(0,0,0,0,lg),new cg(4,4,8,4,hg),new cg(4,5,16,8,hg),new cg(4,6,32,32,hg),new cg(4,4,16,16,ug),new cg(8,16,32,32,ug),new cg(8,16,128,128,ug),new cg(8,32,128,256,ug),new cg(32,128,258,1024,ug),new cg(32,258,258,4096,ug)];function dg(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Yd,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),Jd(this.dyn_ltree),Jd(this.dyn_dtree),Jd(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),Jd(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),Jd(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const gg=t=>{if(!t)return 1;const e=t.state;return!e||e.strm!==t||e.status!==Wd&&57!==e.status&&69!==e.status&&73!==e.status&&91!==e.status&&103!==e.status&&e.status!==Hd&&e.status!==$d?1:0},pg=t=>{if(gg(t))return Zd(t,Ld);t.total_in=t.total_out=0,t.data_type=Vd;const e=t.state;return e.pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=2===e.wrap?57:e.wrap?Wd:Hd,t.adler=2===e.wrap?0:1,e.last_flush=-2,bd(e),Ad},mg=t=>{const e=pg(t);var n;return e===Ad&&((n=t.state).window_size=2*n.w_size,Jd(n.head),n.max_lazy_match=fg[n.level].max_lazy,n.good_match=fg[n.level].good_length,n.nice_match=fg[n.level].nice_length,n.max_chain_length=fg[n.level].max_chain,n.strstart=0,n.block_start=0,n.lookahead=0,n.insert=0,n.match_length=n.prev_length=2,n.match_available=0,n.ins_h=0),e},yg=(t,e,n,i,r,s)=>{if(!t)return Ld;let o=1;if(e===Fd&&(e=6),i<0?(o=0,i=-i):i>15&&(o=2,i-=16),r<1||r>9||n!==Yd||i<8||i>15||e<0||e>9||s<0||s>Ud||8===i&&1!==o)return Zd(t,Ld);8===i&&(i=9);const a=new dg;return t.state=a,a.strm=t,a.status=Wd,a.wrap=o,a.gzhead=null,a.w_bits=i,a.w_size=1<<a.w_bits,a.w_mask=a.w_size-1,a.hash_bits=r+7,a.hash_size=1<<a.hash_bits,a.hash_mask=a.hash_size-1,a.hash_shift=~~((a.hash_bits+3-1)/3),a.window=new Uint8Array(2*a.w_size),a.head=new Uint16Array(a.hash_size),a.prev=new Uint16Array(a.w_size),a.lit_bufsize=1<<r+6,a.pending_buf_size=4*a.lit_bufsize,a.pending_buf=new Uint8Array(a.pending_buf_size),a.sym_buf=a.lit_bufsize,a.sym_end=3*(a.lit_bufsize-1),a.level=e,a.strategy=s,a.method=n,mg(t)};var vg={deflateInit:(t,e)=>yg(t,e,Yd,15,8,qd),deflateInit2:yg,deflateReset:mg,deflateResetKeep:pg,deflateSetHeader:(t,e)=>gg(t)||2!==t.state.wrap?Ld:(t.state.gzhead=e,Ad),deflate:(t,e)=>{if(gg(t)||e>Nd||e<0)return t?Zd(t,Ld):Ld;const n=t.state;if(!t.output||0!==t.avail_in&&!t.input||n.status===$d&&e!==Td)return Zd(t,0===t.avail_out?Dd:Ld);const i=n.last_flush;if(n.last_flush=e,0!==n.pending){if(eg(t),0===t.avail_out)return n.last_flush=-1,Ad}else if(0===t.avail_in&&Kd(e)<=Kd(i)&&e!==Td)return Zd(t,Dd);if(n.status===$d&&0!==t.avail_in)return Zd(t,Dd);if(n.status===Wd&&0===n.wrap&&(n.status=Hd),n.status===Wd){let e=Yd+(n.w_bits-8<<4)<<8,i=-1;if(i=n.strategy>=Gd||n.level<2?0:n.level<6?1:6===n.level?2:3,e|=i<<6,0!==n.strstart&&(e|=32),e+=31-e%31,rg(n,e),0!==n.strstart&&(rg(n,t.adler>>>16),rg(n,65535&t.adler)),t.adler=1,n.status=Hd,eg(t),0!==n.pending)return n.last_flush=-1,Ad}if(57===n.status)if(t.adler=0,ig(n,31),ig(n,139),ig(n,8),n.gzhead)ig(n,(n.gzhead.text?1:0)+(n.gzhead.hcrc?2:0)+(n.gzhead.extra?4:0)+(n.gzhead.name?8:0)+(n.gzhead.comment?16:0)),ig(n,255&n.gzhead.time),ig(n,n.gzhead.time>>8&255),ig(n,n.gzhead.time>>16&255),ig(n,n.gzhead.time>>24&255),ig(n,9===n.level?2:n.strategy>=Gd||n.level<2?4:0),ig(n,255&n.gzhead.os),n.gzhead.extra&&n.gzhead.extra.length&&(ig(n,255&n.gzhead.extra.length),ig(n,n.gzhead.extra.length>>8&255)),n.gzhead.hcrc&&(t.adler=wd(t.adler,n.pending_buf,n.pending,0)),n.gzindex=0,n.status=69;else if(ig(n,0),ig(n,0),ig(n,0),ig(n,0),ig(n,0),ig(n,9===n.level?2:n.strategy>=Gd||n.level<2?4:0),ig(n,3),n.status=Hd,eg(t),0!==n.pending)return n.last_flush=-1,Ad;if(69===n.status){if(n.gzhead.extra){let e=n.pending,i=(65535&n.gzhead.extra.length)-n.gzindex;for(;n.pending+i>n.pending_buf_size;){let r=n.pending_buf_size-n.pending;if(n.pending_buf.set(n.gzhead.extra.subarray(n.gzindex,n.gzindex+r),n.pending),n.pending=n.pending_buf_size,n.gzhead.hcrc&&n.pending>e&&(t.adler=wd(t.adler,n.pending_buf,n.pending-e,e)),n.gzindex+=r,eg(t),0!==n.pending)return n.last_flush=-1,Ad;e=0,i-=r}let r=new Uint8Array(n.gzhead.extra);n.pending_buf.set(r.subarray(n.gzindex,n.gzindex+i),n.pending),n.pending+=i,n.gzhead.hcrc&&n.pending>e&&(t.adler=wd(t.adler,n.pending_buf,n.pending-e,e)),n.gzindex=0}n.status=73}if(73===n.status){if(n.gzhead.name){let e,i=n.pending;do{if(n.pending===n.pending_buf_size){if(n.gzhead.hcrc&&n.pending>i&&(t.adler=wd(t.adler,n.pending_buf,n.pending-i,i)),eg(t),0!==n.pending)return n.last_flush=-1,Ad;i=0}e=n.gzindex<n.gzhead.name.length?255&n.gzhead.name.charCodeAt(n.gzindex++):0,ig(n,e)}while(0!==e);n.gzhead.hcrc&&n.pending>i&&(t.adler=wd(t.adler,n.pending_buf,n.pending-i,i)),n.gzindex=0}n.status=91}if(91===n.status){if(n.gzhead.comment){let e,i=n.pending;do{if(n.pending===n.pending_buf_size){if(n.gzhead.hcrc&&n.pending>i&&(t.adler=wd(t.adler,n.pending_buf,n.pending-i,i)),eg(t),0!==n.pending)return n.last_flush=-1,Ad;i=0}e=n.gzindex<n.gzhead.comment.length?255&n.gzhead.comment.charCodeAt(n.gzindex++):0,ig(n,e)}while(0!==e);n.gzhead.hcrc&&n.pending>i&&(t.adler=wd(t.adler,n.pending_buf,n.pending-i,i))}n.status=103}if(103===n.status){if(n.gzhead.hcrc){if(n.pending+2>n.pending_buf_size&&(eg(t),0!==n.pending))return n.last_flush=-1,Ad;ig(n,255&t.adler),ig(n,t.adler>>8&255),t.adler=0}if(n.status=Hd,eg(t),0!==n.pending)return n.last_flush=-1,Ad}if(0!==t.avail_in||0!==n.lookahead||e!==Md&&n.status!==$d){let i=0===n.level?lg(n,e):n.strategy===Gd?((t,e)=>{let n;for(;;){if(0===t.lookahead&&(ag(t),0===t.lookahead)){if(e===Md)return 1;break}if(t.match_length=0,n=Id(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,n&&(ng(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,e===Td?(ng(t,!0),0===t.strm.avail_out?3:4):t.sym_next&&(ng(t,!1),0===t.strm.avail_out)?1:2})(n,e):n.strategy===Bd?((t,e)=>{let n,i,r,s;const o=t.window;for(;;){if(t.lookahead<=Xd){if(ag(t),t.lookahead<=Xd&&e===Md)return 1;if(0===t.lookahead)break}if(t.match_length=0,t.lookahead>=3&&t.strstart>0&&(r=t.strstart-1,i=o[r],i===o[++r]&&i===o[++r]&&i===o[++r])){s=t.strstart+Xd;do{}while(i===o[++r]&&i===o[++r]&&i===o[++r]&&i===o[++r]&&i===o[++r]&&i===o[++r]&&i===o[++r]&&i===o[++r]&&r<s);t.match_length=Xd-(s-r),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=3?(n=Id(t,1,t.match_length-3),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(n=Id(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),n&&(ng(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,e===Td?(ng(t,!0),0===t.strm.avail_out?3:4):t.sym_next&&(ng(t,!1),0===t.strm.avail_out)?1:2})(n,e):fg[n.level].func(n,e);if(3!==i&&4!==i||(n.status=$d),1===i||3===i)return 0===t.avail_out&&(n.last_flush=-1),Ad;if(2===i&&(e===Rd?Cd(n):e!==Nd&&(Ed(n,0,0,!1),e===Pd&&(Jd(n.head),0===n.lookahead&&(n.strstart=0,n.block_start=0,n.insert=0))),eg(t),0===t.avail_out))return n.last_flush=-1,Ad}return e!==Td?Ad:n.wrap<=0?kd:(2===n.wrap?(ig(n,255&t.adler),ig(n,t.adler>>8&255),ig(n,t.adler>>16&255),ig(n,t.adler>>24&255),ig(n,255&t.total_in),ig(n,t.total_in>>8&255),ig(n,t.total_in>>16&255),ig(n,t.total_in>>24&255)):(rg(n,t.adler>>>16),rg(n,65535&t.adler)),eg(t),n.wrap>0&&(n.wrap=-n.wrap),0!==n.pending?Ad:kd)},deflateEnd:t=>{if(gg(t))return Ld;const e=t.state.status;return t.state=null,e===Hd?Zd(t,Od):Ad},deflateSetDictionary:(t,e)=>{let n=e.length;if(gg(t))return Ld;const i=t.state,r=i.wrap;if(2===r||1===r&&i.status!==Wd||i.lookahead)return Ld;if(1===r&&(t.adler=yd(t.adler,e,n,0)),i.wrap=0,n>=i.w_size){0===r&&(Jd(i.head),i.strstart=0,i.block_start=0,i.insert=0);let t=new Uint8Array(i.w_size);t.set(e.subarray(n-i.w_size,n),0),e=t,n=i.w_size}const s=t.avail_in,o=t.next_in,a=t.input;for(t.avail_in=n,t.next_in=0,t.input=e,ag(i);i.lookahead>=3;){let t=i.strstart,e=i.lookahead-2;do{i.ins_h=tg(i,i.ins_h,i.window[t+3-1]),i.prev[t&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=t,t++}while(--e);i.strstart=t,i.lookahead=2,ag(i)}return i.strstart+=i.lookahead,i.block_start=i.strstart,i.insert=i.lookahead,i.lookahead=0,i.match_length=i.prev_length=2,i.match_available=0,t.next_in=o,t.input=a,t.avail_in=s,i.wrap=r,Ad},deflateInfo:"pako deflate (from Nodeca project)"};const wg=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var xg={assign:function(t){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const n=e.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(const e in n)wg(n,e)&&(t[e]=n[e])}}return t},flattenChunks:t=>{let e=0;for(let n=0,i=t.length;n<i;n++)e+=t[n].length;const n=new Uint8Array(e);for(let e=0,i=0,r=t.length;e<r;e++){let r=t[e];n.set(r,i),i+=r.length}return n}};let _g=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(t){_g=!1}const bg=new Uint8Array(256);for(let t=0;t<256;t++)bg[t]=t>=252?6:t>=248?5:t>=240?4:t>=224?3:t>=192?2:1;bg[254]=bg[254]=1;var Eg={string2buf:t=>{if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(t);let e,n,i,r,s,o=t.length,a=0;for(r=0;r<o;r++)n=t.charCodeAt(r),55296==(64512&n)&&r+1<o&&(i=t.charCodeAt(r+1),56320==(64512&i)&&(n=65536+(n-55296<<10)+(i-56320),r++)),a+=n<128?1:n<2048?2:n<65536?3:4;for(e=new Uint8Array(a),s=0,r=0;s<a;r++)n=t.charCodeAt(r),55296==(64512&n)&&r+1<o&&(i=t.charCodeAt(r+1),56320==(64512&i)&&(n=65536+(n-55296<<10)+(i-56320),r++)),n<128?e[s++]=n:n<2048?(e[s++]=192|n>>>6,e[s++]=128|63&n):n<65536?(e[s++]=224|n>>>12,e[s++]=128|n>>>6&63,e[s++]=128|63&n):(e[s++]=240|n>>>18,e[s++]=128|n>>>12&63,e[s++]=128|n>>>6&63,e[s++]=128|63&n);return e},buf2string:(t,e)=>{const n=e||t.length;if("function"==typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(t.subarray(0,e));let i,r;const s=new Array(2*n);for(r=0,i=0;i<n;){let e=t[i++];if(e<128){s[r++]=e;continue}let o=bg[e];if(o>4)s[r++]=65533,i+=o-1;else{for(e&=2===o?31:3===o?15:7;o>1&&i<n;)e=e<<6|63&t[i++],o--;o>1?s[r++]=65533:e<65536?s[r++]=e:(e-=65536,s[r++]=55296|e>>10&1023,s[r++]=56320|1023&e)}}return((t,e)=>{if(e<65534&&t.subarray&&_g)return String.fromCharCode.apply(null,t.length===e?t:t.subarray(0,e));let n="";for(let i=0;i<e;i++)n+=String.fromCharCode(t[i]);return n})(s,r)},utf8border:(t,e)=>{(e=e||t.length)>t.length&&(e=t.length);let n=e-1;for(;n>=0&&128==(192&t[n]);)n--;return n<0||0===n?e:n+bg[t[n]]>e?n:e}},Sg=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};const Ig=Object.prototype.toString,{Z_NO_FLUSH:Cg,Z_SYNC_FLUSH:Mg,Z_FULL_FLUSH:Rg,Z_FINISH:Pg,Z_OK:Tg,Z_STREAM_END:Ng,Z_DEFAULT_COMPRESSION:Ag,Z_DEFAULT_STRATEGY:kg,Z_DEFLATED:Lg}=_d;function Og(t){this.options=xg.assign({level:Ag,method:Lg,chunkSize:16384,windowBits:15,memLevel:8,strategy:kg},t||{});let e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Sg,this.strm.avail_out=0;let n=vg.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(n!==Tg)throw new Error(xd[n]);if(e.header&&vg.deflateSetHeader(this.strm,e.header),e.dictionary){let t;if(t="string"==typeof e.dictionary?Eg.string2buf(e.dictionary):"[object ArrayBuffer]"===Ig.call(e.dictionary)?new Uint8Array(e.dictionary):e.dictionary,n=vg.deflateSetDictionary(this.strm,t),n!==Tg)throw new Error(xd[n]);this._dict_set=!0}}function Dg(t,e){const n=new Og(e);if(n.push(t,!0),n.err)throw n.msg||xd[n.err];return n.result}Og.prototype.push=function(t,e){const n=this.strm,i=this.options.chunkSize;let r,s;if(this.ended)return!1;for(s=e===~~e?e:!0===e?Pg:Cg,"string"==typeof t?n.input=Eg.string2buf(t):"[object ArrayBuffer]"===Ig.call(t)?n.input=new Uint8Array(t):n.input=t,n.next_in=0,n.avail_in=n.input.length;;)if(0===n.avail_out&&(n.output=new Uint8Array(i),n.next_out=0,n.avail_out=i),(s===Mg||s===Rg)&&n.avail_out<=6)this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;else{if(r=vg.deflate(n,s),r===Ng)return n.next_out>0&&this.onData(n.output.subarray(0,n.next_out)),r=vg.deflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===Tg;if(0!==n.avail_out){if(s>0&&n.next_out>0)this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;else if(0===n.avail_in)break}else this.onData(n.output)}return!0},Og.prototype.onData=function(t){this.chunks.push(t)},Og.prototype.onEnd=function(t){t===Tg&&(this.result=xg.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};var Fg={Deflate:Og,deflate:Dg,deflateRaw:function(t,e){return(e=e||{}).raw=!0,Dg(t,e)},gzip:function(t,e){return(e=e||{}).gzip=!0,Dg(t,e)},constants:_d};const zg=16209;var Gg=function(t,e){let n,i,r,s,o,a,l,h,u,c,f,d,g,p,m,y,v,w,x,_,b,E,S,I;const C=t.state;n=t.next_in,S=t.input,i=n+(t.avail_in-5),r=t.next_out,I=t.output,s=r-(e-t.avail_out),o=r+(t.avail_out-257),a=C.dmax,l=C.wsize,h=C.whave,u=C.wnext,c=C.window,f=C.hold,d=C.bits,g=C.lencode,p=C.distcode,m=(1<<C.lenbits)-1,y=(1<<C.distbits)-1;t:do{d<15&&(f+=S[n++]<<d,d+=8,f+=S[n++]<<d,d+=8),v=g[f&m];e:for(;;){if(w=v>>>24,f>>>=w,d-=w,w=v>>>16&255,0===w)I[r++]=65535&v;else{if(!(16&w)){if(0==(64&w)){v=g[(65535&v)+(f&(1<<w)-1)];continue e}if(32&w){C.mode=16191;break t}t.msg="invalid literal/length code",C.mode=zg;break t}x=65535&v,w&=15,w&&(d<w&&(f+=S[n++]<<d,d+=8),x+=f&(1<<w)-1,f>>>=w,d-=w),d<15&&(f+=S[n++]<<d,d+=8,f+=S[n++]<<d,d+=8),v=p[f&y];n:for(;;){if(w=v>>>24,f>>>=w,d-=w,w=v>>>16&255,!(16&w)){if(0==(64&w)){v=p[(65535&v)+(f&(1<<w)-1)];continue n}t.msg="invalid distance code",C.mode=zg;break t}if(_=65535&v,w&=15,d<w&&(f+=S[n++]<<d,d+=8,d<w&&(f+=S[n++]<<d,d+=8)),_+=f&(1<<w)-1,_>a){t.msg="invalid distance too far back",C.mode=zg;break t}if(f>>>=w,d-=w,w=r-s,_>w){if(w=_-w,w>h&&C.sane){t.msg="invalid distance too far back",C.mode=zg;break t}if(b=0,E=c,0===u){if(b+=l-w,w<x){x-=w;do{I[r++]=c[b++]}while(--w);b=r-_,E=I}}else if(u<w){if(b+=l+u-w,w-=u,w<x){x-=w;do{I[r++]=c[b++]}while(--w);if(b=0,u<x){w=u,x-=w;do{I[r++]=c[b++]}while(--w);b=r-_,E=I}}}else if(b+=u-w,w<x){x-=w;do{I[r++]=c[b++]}while(--w);b=r-_,E=I}for(;x>2;)I[r++]=E[b++],I[r++]=E[b++],I[r++]=E[b++],x-=3;x&&(I[r++]=E[b++],x>1&&(I[r++]=E[b++]))}else{b=r-_;do{I[r++]=I[b++],I[r++]=I[b++],I[r++]=I[b++],x-=3}while(x>2);x&&(I[r++]=I[b++],x>1&&(I[r++]=I[b++]))}break}}break}}while(n<i&&r<o);x=d>>3,n-=x,d-=x<<3,f&=(1<<d)-1,t.next_in=n,t.next_out=r,t.avail_in=n<i?i-n+5:5-(n-i),t.avail_out=r<o?o-r+257:257-(r-o),C.hold=f,C.bits=d};const Bg=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),Ug=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),qg=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),Vg=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var Yg=(t,e,n,i,r,s,o,a)=>{const l=a.bits;let h,u,c,f,d,g,p=0,m=0,y=0,v=0,w=0,x=0,_=0,b=0,E=0,S=0,I=null;const C=new Uint16Array(16),M=new Uint16Array(16);let R,P,T,N=null;for(p=0;p<=15;p++)C[p]=0;for(m=0;m<i;m++)C[e[n+m]]++;for(w=l,v=15;v>=1&&0===C[v];v--);if(w>v&&(w=v),0===v)return r[s++]=20971520,r[s++]=20971520,a.bits=1,0;for(y=1;y<v&&0===C[y];y++);for(w<y&&(w=y),b=1,p=1;p<=15;p++)if(b<<=1,b-=C[p],b<0)return-1;if(b>0&&(0===t||1!==v))return-1;for(M[1]=0,p=1;p<15;p++)M[p+1]=M[p]+C[p];for(m=0;m<i;m++)0!==e[n+m]&&(o[M[e[n+m]]++]=m);if(0===t?(I=N=o,g=20):1===t?(I=Bg,N=Ug,g=257):(I=qg,N=Vg,g=0),S=0,m=0,p=y,d=s,x=w,_=0,c=-1,E=1<<w,f=E-1,1===t&&E>852||2===t&&E>592)return 1;for(;;){R=p-_,o[m]+1<g?(P=0,T=o[m]):o[m]>=g?(P=N[o[m]-g],T=I[o[m]-g]):(P=96,T=0),h=1<<p-_,u=1<<x,y=u;do{u-=h,r[d+(S>>_)+u]=R<<24|P<<16|T|0}while(0!==u);for(h=1<<p-1;S&h;)h>>=1;if(0!==h?(S&=h-1,S+=h):S=0,m++,0==--C[p]){if(p===v)break;p=e[n+o[m]]}if(p>w&&(S&f)!==c){for(0===_&&(_=w),d+=y,x=p-_,b=1<<x;x+_<v&&(b-=C[x+_],!(b<=0));)x++,b<<=1;if(E+=1<<x,1===t&&E>852||2===t&&E>592)return 1;c=S&f,r[c]=w<<24|x<<16|d-s|0}}return 0!==S&&(r[d+S]=p-_<<24|64<<16|0),a.bits=w,0};const{Z_FINISH:Xg,Z_BLOCK:jg,Z_TREES:Wg,Z_OK:Hg,Z_STREAM_END:$g,Z_NEED_DICT:Zg,Z_STREAM_ERROR:Kg,Z_DATA_ERROR:Jg,Z_MEM_ERROR:Qg,Z_BUF_ERROR:tp,Z_DEFLATED:ep}=_d,np=16180,ip=16190,rp=16191,sp=16192,op=16194,ap=16199,lp=16200,hp=16206,up=16209,cp=t=>(t>>>24&255)+(t>>>8&65280)+((65280&t)<<8)+((255&t)<<24);function fp(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const dp=t=>{if(!t)return 1;const e=t.state;return!e||e.strm!==t||e.mode<np||e.mode>16211?1:0},gp=t=>{if(dp(t))return Kg;const e=t.state;return t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=1&e.wrap),e.mode=np,e.last=0,e.havedict=0,e.flags=-1,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(852),e.distcode=e.distdyn=new Int32Array(592),e.sane=1,e.back=-1,Hg},pp=t=>{if(dp(t))return Kg;const e=t.state;return e.wsize=0,e.whave=0,e.wnext=0,gp(t)},mp=(t,e)=>{let n;if(dp(t))return Kg;const i=t.state;return e<0?(n=0,e=-e):(n=5+(e>>4),e<48&&(e&=15)),e&&(e<8||e>15)?Kg:(null!==i.window&&i.wbits!==e&&(i.window=null),i.wrap=n,i.wbits=e,pp(t))},yp=(t,e)=>{if(!t)return Kg;const n=new fp;t.state=n,n.strm=t,n.window=null,n.mode=np;const i=mp(t,e);return i!==Hg&&(t.state=null),i};let vp,wp,xp=!0;const _p=t=>{if(xp){vp=new Int32Array(512),wp=new Int32Array(32);let e=0;for(;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(Yg(1,t.lens,0,288,vp,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;Yg(2,t.lens,0,32,wp,0,t.work,{bits:5}),xp=!1}t.lencode=vp,t.lenbits=9,t.distcode=wp,t.distbits=5},bp=(t,e,n,i)=>{let r;const s=t.state;return null===s.window&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new Uint8Array(s.wsize)),i>=s.wsize?(s.window.set(e.subarray(n-s.wsize,n),0),s.wnext=0,s.whave=s.wsize):(r=s.wsize-s.wnext,r>i&&(r=i),s.window.set(e.subarray(n-i,n-i+r),s.wnext),(i-=r)?(s.window.set(e.subarray(n-i,n),0),s.wnext=i,s.whave=s.wsize):(s.wnext+=r,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=r))),0};var Ep={inflateReset:pp,inflateReset2:mp,inflateResetKeep:gp,inflateInit:t=>yp(t,15),inflateInit2:yp,inflate:(t,e)=>{let n,i,r,s,o,a,l,h,u,c,f,d,g,p,m,y,v,w,x,_,b,E,S=0;const I=new Uint8Array(4);let C,M;const R=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(dp(t)||!t.output||!t.input&&0!==t.avail_in)return Kg;n=t.state,n.mode===rp&&(n.mode=sp),o=t.next_out,r=t.output,l=t.avail_out,s=t.next_in,i=t.input,a=t.avail_in,h=n.hold,u=n.bits,c=a,f=l,E=Hg;t:for(;;)switch(n.mode){case np:if(0===n.wrap){n.mode=sp;break}for(;u<16;){if(0===a)break t;a--,h+=i[s++]<<u,u+=8}if(2&n.wrap&&35615===h){0===n.wbits&&(n.wbits=15),n.check=0,I[0]=255&h,I[1]=h>>>8&255,n.check=wd(n.check,I,2,0),h=0,u=0,n.mode=16181;break}if(n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&h)<<8)+(h>>8))%31){t.msg="incorrect header check",n.mode=up;break}if((15&h)!==ep){t.msg="unknown compression method",n.mode=up;break}if(h>>>=4,u-=4,b=8+(15&h),0===n.wbits&&(n.wbits=b),b>15||b>n.wbits){t.msg="invalid window size",n.mode=up;break}n.dmax=1<<n.wbits,n.flags=0,t.adler=n.check=1,n.mode=512&h?16189:rp,h=0,u=0;break;case 16181:for(;u<16;){if(0===a)break t;a--,h+=i[s++]<<u,u+=8}if(n.flags=h,(255&n.flags)!==ep){t.msg="unknown compression method",n.mode=up;break}if(57344&n.flags){t.msg="unknown header flags set",n.mode=up;break}n.head&&(n.head.text=h>>8&1),512&n.flags&&4&n.wrap&&(I[0]=255&h,I[1]=h>>>8&255,n.check=wd(n.check,I,2,0)),h=0,u=0,n.mode=16182;case 16182:for(;u<32;){if(0===a)break t;a--,h+=i[s++]<<u,u+=8}n.head&&(n.head.time=h),512&n.flags&&4&n.wrap&&(I[0]=255&h,I[1]=h>>>8&255,I[2]=h>>>16&255,I[3]=h>>>24&255,n.check=wd(n.check,I,4,0)),h=0,u=0,n.mode=16183;case 16183:for(;u<16;){if(0===a)break t;a--,h+=i[s++]<<u,u+=8}n.head&&(n.head.xflags=255&h,n.head.os=h>>8),512&n.flags&&4&n.wrap&&(I[0]=255&h,I[1]=h>>>8&255,n.check=wd(n.check,I,2,0)),h=0,u=0,n.mode=16184;case 16184:if(1024&n.flags){for(;u<16;){if(0===a)break t;a--,h+=i[s++]<<u,u+=8}n.length=h,n.head&&(n.head.extra_len=h),512&n.flags&&4&n.wrap&&(I[0]=255&h,I[1]=h>>>8&255,n.check=wd(n.check,I,2,0)),h=0,u=0}else n.head&&(n.head.extra=null);n.mode=16185;case 16185:if(1024&n.flags&&(d=n.length,d>a&&(d=a),d&&(n.head&&(b=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Uint8Array(n.head.extra_len)),n.head.extra.set(i.subarray(s,s+d),b)),512&n.flags&&4&n.wrap&&(n.check=wd(n.check,i,d,s)),a-=d,s+=d,n.length-=d),n.length))break t;n.length=0,n.mode=16186;case 16186:if(2048&n.flags){if(0===a)break t;d=0;do{b=i[s+d++],n.head&&b&&n.length<65536&&(n.head.name+=String.fromCharCode(b))}while(b&&d<a);if(512&n.flags&&4&n.wrap&&(n.check=wd(n.check,i,d,s)),a-=d,s+=d,b)break t}else n.head&&(n.head.name=null);n.length=0,n.mode=16187;case 16187:if(4096&n.flags){if(0===a)break t;d=0;do{b=i[s+d++],n.head&&b&&n.length<65536&&(n.head.comment+=String.fromCharCode(b))}while(b&&d<a);if(512&n.flags&&4&n.wrap&&(n.check=wd(n.check,i,d,s)),a-=d,s+=d,b)break t}else n.head&&(n.head.comment=null);n.mode=16188;case 16188:if(512&n.flags){for(;u<16;){if(0===a)break t;a--,h+=i[s++]<<u,u+=8}if(4&n.wrap&&h!==(65535&n.check)){t.msg="header crc mismatch",n.mode=up;break}h=0,u=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),t.adler=n.check=0,n.mode=rp;break;case 16189:for(;u<32;){if(0===a)break t;a--,h+=i[s++]<<u,u+=8}t.adler=n.check=cp(h),h=0,u=0,n.mode=ip;case ip:if(0===n.havedict)return t.next_out=o,t.avail_out=l,t.next_in=s,t.avail_in=a,n.hold=h,n.bits=u,Zg;t.adler=n.check=1,n.mode=rp;case rp:if(e===jg||e===Wg)break t;case sp:if(n.last){h>>>=7&u,u-=7&u,n.mode=hp;break}for(;u<3;){if(0===a)break t;a--,h+=i[s++]<<u,u+=8}switch(n.last=1&h,h>>>=1,u-=1,3&h){case 0:n.mode=16193;break;case 1:if(_p(n),n.mode=ap,e===Wg){h>>>=2,u-=2;break t}break;case 2:n.mode=16196;break;case 3:t.msg="invalid block type",n.mode=up}h>>>=2,u-=2;break;case 16193:for(h>>>=7&u,u-=7&u;u<32;){if(0===a)break t;a--,h+=i[s++]<<u,u+=8}if((65535&h)!=(h>>>16^65535)){t.msg="invalid stored block lengths",n.mode=up;break}if(n.length=65535&h,h=0,u=0,n.mode=op,e===Wg)break t;case op:n.mode=16195;case 16195:if(d=n.length,d){if(d>a&&(d=a),d>l&&(d=l),0===d)break t;r.set(i.subarray(s,s+d),o),a-=d,s+=d,l-=d,o+=d,n.length-=d;break}n.mode=rp;break;case 16196:for(;u<14;){if(0===a)break t;a--,h+=i[s++]<<u,u+=8}if(n.nlen=257+(31&h),h>>>=5,u-=5,n.ndist=1+(31&h),h>>>=5,u-=5,n.ncode=4+(15&h),h>>>=4,u-=4,n.nlen>286||n.ndist>30){t.msg="too many length or distance symbols",n.mode=up;break}n.have=0,n.mode=16197;case 16197:for(;n.have<n.ncode;){for(;u<3;){if(0===a)break t;a--,h+=i[s++]<<u,u+=8}n.lens[R[n.have++]]=7&h,h>>>=3,u-=3}for(;n.have<19;)n.lens[R[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,C={bits:n.lenbits},E=Yg(0,n.lens,0,19,n.lencode,0,n.work,C),n.lenbits=C.bits,E){t.msg="invalid code lengths set",n.mode=up;break}n.have=0,n.mode=16198;case 16198:for(;n.have<n.nlen+n.ndist;){for(;S=n.lencode[h&(1<<n.lenbits)-1],m=S>>>24,y=S>>>16&255,v=65535&S,!(m<=u);){if(0===a)break t;a--,h+=i[s++]<<u,u+=8}if(v<16)h>>>=m,u-=m,n.lens[n.have++]=v;else{if(16===v){for(M=m+2;u<M;){if(0===a)break t;a--,h+=i[s++]<<u,u+=8}if(h>>>=m,u-=m,0===n.have){t.msg="invalid bit length repeat",n.mode=up;break}b=n.lens[n.have-1],d=3+(3&h),h>>>=2,u-=2}else if(17===v){for(M=m+3;u<M;){if(0===a)break t;a--,h+=i[s++]<<u,u+=8}h>>>=m,u-=m,b=0,d=3+(7&h),h>>>=3,u-=3}else{for(M=m+7;u<M;){if(0===a)break t;a--,h+=i[s++]<<u,u+=8}h>>>=m,u-=m,b=0,d=11+(127&h),h>>>=7,u-=7}if(n.have+d>n.nlen+n.ndist){t.msg="invalid bit length repeat",n.mode=up;break}for(;d--;)n.lens[n.have++]=b}}if(n.mode===up)break;if(0===n.lens[256]){t.msg="invalid code -- missing end-of-block",n.mode=up;break}if(n.lenbits=9,C={bits:n.lenbits},E=Yg(1,n.lens,0,n.nlen,n.lencode,0,n.work,C),n.lenbits=C.bits,E){t.msg="invalid literal/lengths set",n.mode=up;break}if(n.distbits=6,n.distcode=n.distdyn,C={bits:n.distbits},E=Yg(2,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,C),n.distbits=C.bits,E){t.msg="invalid distances set",n.mode=up;break}if(n.mode=ap,e===Wg)break t;case ap:n.mode=lp;case lp:if(a>=6&&l>=258){t.next_out=o,t.avail_out=l,t.next_in=s,t.avail_in=a,n.hold=h,n.bits=u,Gg(t,f),o=t.next_out,r=t.output,l=t.avail_out,s=t.next_in,i=t.input,a=t.avail_in,h=n.hold,u=n.bits,n.mode===rp&&(n.back=-1);break}for(n.back=0;S=n.lencode[h&(1<<n.lenbits)-1],m=S>>>24,y=S>>>16&255,v=65535&S,!(m<=u);){if(0===a)break t;a--,h+=i[s++]<<u,u+=8}if(y&&0==(240&y)){for(w=m,x=y,_=v;S=n.lencode[_+((h&(1<<w+x)-1)>>w)],m=S>>>24,y=S>>>16&255,v=65535&S,!(w+m<=u);){if(0===a)break t;a--,h+=i[s++]<<u,u+=8}h>>>=w,u-=w,n.back+=w}if(h>>>=m,u-=m,n.back+=m,n.length=v,0===y){n.mode=16205;break}if(32&y){n.back=-1,n.mode=rp;break}if(64&y){t.msg="invalid literal/length code",n.mode=up;break}n.extra=15&y,n.mode=16201;case 16201:if(n.extra){for(M=n.extra;u<M;){if(0===a)break t;a--,h+=i[s++]<<u,u+=8}n.length+=h&(1<<n.extra)-1,h>>>=n.extra,u-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=16202;case 16202:for(;S=n.distcode[h&(1<<n.distbits)-1],m=S>>>24,y=S>>>16&255,v=65535&S,!(m<=u);){if(0===a)break t;a--,h+=i[s++]<<u,u+=8}if(0==(240&y)){for(w=m,x=y,_=v;S=n.distcode[_+((h&(1<<w+x)-1)>>w)],m=S>>>24,y=S>>>16&255,v=65535&S,!(w+m<=u);){if(0===a)break t;a--,h+=i[s++]<<u,u+=8}h>>>=w,u-=w,n.back+=w}if(h>>>=m,u-=m,n.back+=m,64&y){t.msg="invalid distance code",n.mode=up;break}n.offset=v,n.extra=15&y,n.mode=16203;case 16203:if(n.extra){for(M=n.extra;u<M;){if(0===a)break t;a--,h+=i[s++]<<u,u+=8}n.offset+=h&(1<<n.extra)-1,h>>>=n.extra,u-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){t.msg="invalid distance too far back",n.mode=up;break}n.mode=16204;case 16204:if(0===l)break t;if(d=f-l,n.offset>d){if(d=n.offset-d,d>n.whave&&n.sane){t.msg="invalid distance too far back",n.mode=up;break}d>n.wnext?(d-=n.wnext,g=n.wsize-d):g=n.wnext-d,d>n.length&&(d=n.length),p=n.window}else p=r,g=o-n.offset,d=n.length;d>l&&(d=l),l-=d,n.length-=d;do{r[o++]=p[g++]}while(--d);0===n.length&&(n.mode=lp);break;case 16205:if(0===l)break t;r[o++]=n.length,l--,n.mode=lp;break;case hp:if(n.wrap){for(;u<32;){if(0===a)break t;a--,h|=i[s++]<<u,u+=8}if(f-=l,t.total_out+=f,n.total+=f,4&n.wrap&&f&&(t.adler=n.check=n.flags?wd(n.check,r,f,o-f):yd(n.check,r,f,o-f)),f=l,4&n.wrap&&(n.flags?h:cp(h))!==n.check){t.msg="incorrect data check",n.mode=up;break}h=0,u=0}n.mode=16207;case 16207:if(n.wrap&&n.flags){for(;u<32;){if(0===a)break t;a--,h+=i[s++]<<u,u+=8}if(4&n.wrap&&h!==(4294967295&n.total)){t.msg="incorrect length check",n.mode=up;break}h=0,u=0}n.mode=16208;case 16208:E=$g;break t;case up:E=Jg;break t;case 16210:return Qg;default:return Kg}return t.next_out=o,t.avail_out=l,t.next_in=s,t.avail_in=a,n.hold=h,n.bits=u,(n.wsize||f!==t.avail_out&&n.mode<up&&(n.mode<hp||e!==Xg))&&bp(t,t.output,t.next_out,f-t.avail_out),c-=t.avail_in,f-=t.avail_out,t.total_in+=c,t.total_out+=f,n.total+=f,4&n.wrap&&f&&(t.adler=n.check=n.flags?wd(n.check,r,f,t.next_out-f):yd(n.check,r,f,t.next_out-f)),t.data_type=n.bits+(n.last?64:0)+(n.mode===rp?128:0)+(n.mode===ap||n.mode===op?256:0),(0===c&&0===f||e===Xg)&&E===Hg&&(E=tp),E},inflateEnd:t=>{if(dp(t))return Kg;let e=t.state;return e.window&&(e.window=null),t.state=null,Hg},inflateGetHeader:(t,e)=>{if(dp(t))return Kg;const n=t.state;return 0==(2&n.wrap)?Kg:(n.head=e,e.done=!1,Hg)},inflateSetDictionary:(t,e)=>{const n=e.length;let i,r,s;return dp(t)?Kg:(i=t.state,0!==i.wrap&&i.mode!==ip?Kg:i.mode===ip&&(r=1,r=yd(r,e,n,0),r!==i.check)?Jg:(s=bp(t,e,n,n),s?(i.mode=16210,Qg):(i.havedict=1,Hg)))},inflateInfo:"pako inflate (from Nodeca project)"},Sp=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};const Ip=Object.prototype.toString,{Z_NO_FLUSH:Cp,Z_FINISH:Mp,Z_OK:Rp,Z_STREAM_END:Pp,Z_NEED_DICT:Tp,Z_STREAM_ERROR:Np,Z_DATA_ERROR:Ap,Z_MEM_ERROR:kp}=_d;function Lp(t){this.options=xg.assign({chunkSize:65536,windowBits:15,to:""},t||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,0===e.windowBits&&(e.windowBits=-15)),!(e.windowBits>=0&&e.windowBits<16)||t&&t.windowBits||(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&0==(15&e.windowBits)&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Sg,this.strm.avail_out=0;let n=Ep.inflateInit2(this.strm,e.windowBits);if(n!==Rp)throw new Error(xd[n]);if(this.header=new Sp,Ep.inflateGetHeader(this.strm,this.header),e.dictionary&&("string"==typeof e.dictionary?e.dictionary=Eg.string2buf(e.dictionary):"[object ArrayBuffer]"===Ip.call(e.dictionary)&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(n=Ep.inflateSetDictionary(this.strm,e.dictionary),n!==Rp)))throw new Error(xd[n])}function Op(t,e){const n=new Lp(e);if(n.push(t),n.err)throw n.msg||xd[n.err];return n.result}Lp.prototype.push=function(t,e){const n=this.strm,i=this.options.chunkSize,r=this.options.dictionary;let s,o,a;if(this.ended)return!1;for(o=e===~~e?e:!0===e?Mp:Cp,"[object ArrayBuffer]"===Ip.call(t)?n.input=new Uint8Array(t):n.input=t,n.next_in=0,n.avail_in=n.input.length;;){for(0===n.avail_out&&(n.output=new Uint8Array(i),n.next_out=0,n.avail_out=i),s=Ep.inflate(n,o),s===Tp&&r&&(s=Ep.inflateSetDictionary(n,r),s===Rp?s=Ep.inflate(n,o):s===Ap&&(s=Tp));n.avail_in>0&&s===Pp&&n.state.wrap>0&&0!==t[n.next_in];)Ep.inflateReset(n),s=Ep.inflate(n,o);switch(s){case Np:case Ap:case Tp:case kp:return this.onEnd(s),this.ended=!0,!1}if(a=n.avail_out,n.next_out&&(0===n.avail_out||s===Pp))if("string"===this.options.to){let t=Eg.utf8border(n.output,n.next_out),e=n.next_out-t,r=Eg.buf2string(n.output,t);n.next_out=e,n.avail_out=i-e,e&&n.output.set(n.output.subarray(t,t+e),0),this.onData(r)}else this.onData(n.output.length===n.next_out?n.output:n.output.subarray(0,n.next_out));if(s!==Rp||0!==a){if(s===Pp)return s=Ep.inflateEnd(this.strm),this.onEnd(s),this.ended=!0,!0;if(0===n.avail_in)break}}return!0},Lp.prototype.onData=function(t){this.chunks.push(t)},Lp.prototype.onEnd=function(t){t===Rp&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=xg.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};var Dp={Inflate:Lp,inflate:Op,inflateRaw:function(t,e){return(e=e||{}).raw=!0,Op(t,e)},ungzip:Op,constants:_d};const{Deflate:Fp,deflate:zp,deflateRaw:Gp,gzip:Bp}=Fg,{Inflate:Up,inflate:qp,inflateRaw:Vp,ungzip:Yp}=Dp;var Xp=zp,jp=Up,Wp=qp;const Hp=[137,80,78,71,13,10,26,10],$p=[];for(let t=0;t<256;t++){let e=t;for(let t=0;t<8;t++)1&e?e=3988292384^e>>>1:e>>>=1;$p[t]=e}const Zp=4294967295;function Kp(t,e){return(function(t,e,n){let i=4294967295;for(let t=0;t<n;t++)i=$p[255&(i^e[t])]^i>>>8;return i}(0,t,e)^Zp)>>>0}var Jp,Qp,tm,em;!function(t){t[t.UNKNOWN=-1]="UNKNOWN",t[t.GREYSCALE=0]="GREYSCALE",t[t.TRUECOLOUR=2]="TRUECOLOUR",t[t.INDEXED_COLOUR=3]="INDEXED_COLOUR",t[t.GREYSCALE_ALPHA=4]="GREYSCALE_ALPHA",t[t.TRUECOLOUR_ALPHA=6]="TRUECOLOUR_ALPHA"}(Jp||(Jp={})),function(t){t[t.UNKNOWN=-1]="UNKNOWN",t[t.DEFLATE=0]="DEFLATE"}(Qp||(Qp={})),function(t){t[t.UNKNOWN=-1]="UNKNOWN",t[t.ADAPTIVE=0]="ADAPTIVE"}(tm||(tm={})),function(t){t[t.UNKNOWN=-1]="UNKNOWN",t[t.NO_INTERLACE=0]="NO_INTERLACE",t[t.ADAM7=1]="ADAM7"}(em||(em={}));const nm=new Uint8Array(0),im=new Uint16Array([255]),rm=255===new Uint8Array(im.buffer)[0];class sm extends Ff.IOBuffer{constructor(t,e={}){super(t);const{checkCrc:n=!1}=e;this._checkCrc=n,this._inflator=new jp,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=Qp.UNKNOWN,this._filterMethod=tm.UNKNOWN,this._interlaceMethod=em.UNKNOWN,this._colorType=Jp.UNKNOWN,this.setBigEndian()}decode(){for(this.decodeSignature();!this._end;)this.decodeChunk();return this.decodeImage(),this._png}decodeSignature(){for(let t=0;t<Hp.length;t++)if(this.readUint8()!==Hp[t])throw new Error(`wrong PNG signature. Byte at ${t} should be ${Hp[t]}.`)}decodeChunk(){const t=this.readUint32(),e=this.readChars(4),n=this.offset;switch(e){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(t);break;case"IDAT":this.decodeIDAT(t);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(t);break;case"iCCP":this.decodeiCCP(t);break;case"tEXt":this.decodetEXt(t);break;case"pHYs":this.decodepHYs();break;default:this.skip(t)}if(this.offset-n!==t)throw new Error(`Length mismatch while decoding chunk ${e}`);if(this._checkCrc){const n=this.readUint32(),i=t+4,r=Kp(new Uint8Array(this.buffer,this.byteOffset+this.offset-i-4,i),i);if(r!==n)throw new Error(`CRC mismatch for chunk ${e}. Expected ${n}, found ${r}`)}else this.skip(4)}decodeIHDR(){const t=this._png;t.width=this.readUint32(),t.height=this.readUint32(),t.depth=function(t){if(1!==t&&2!==t&&4!==t&&8!==t&&16!==t)throw new Error(`invalid bit depth: ${t}`);return t}(this.readUint8());const e=this.readUint8();let n;switch(this._colorType=e,e){case Jp.GREYSCALE:n=1;break;case Jp.TRUECOLOUR:n=3;break;case Jp.INDEXED_COLOUR:n=1;break;case Jp.GREYSCALE_ALPHA:n=2;break;case Jp.TRUECOLOUR_ALPHA:n=4;break;default:throw new Error(`Unknown color type: ${e}`)}if(this._png.channels=n,this._compressionMethod=this.readUint8(),this._compressionMethod!==Qp.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodePLTE(t){if(t%3!=0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${t}`);const e=t/3;this._hasPalette=!0;const n=[];this._palette=n;for(let t=0;t<e;t++)n.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(t){this._inflator.push(new Uint8Array(this.buffer,this.offset+this.byteOffset,t)),this.skip(t)}decodetRNS(t){switch(this._colorType){case Jp.GREYSCALE:case Jp.TRUECOLOUR:if(t%2!=0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${t}`);if(t/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${t/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(t/2);for(let e=0;e<t/2;e++)this._transparency[e]=this.readUint16();break;case Jp.INDEXED_COLOUR:{if(t>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${t} vs ${this._palette.length})`);let e=0;for(;e<t;e++){const t=this.readByte();this._palette[e].push(t)}for(;e<this._palette.length;e++)this._palette[e].push(255);break}default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(t){let e,n="";for(;"\0"!==(e=this.readChar());)n+=e;const i=this.readUint8();if(i!==Qp.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${i}`);const r=this.readBytes(t-n.length-2);this._png.iccEmbeddedProfile={name:n,profile:Wp(r)}}decodetEXt(t){let e,n="";for(;"\0"!==(e=this.readChar());)n+=e;this._png.text[n]=this.readChars(t-n.length-1)}decodepHYs(){const t=this.readUint32(),e=this.readUint32(),n=this.readByte();this._png.resolution={x:t,y:e,unit:n}}decodeImage(){if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const t=this._inflator.result;if(this._filterMethod!==tm.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod!==em.NO_INTERLACE)throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this.decodeInterlaceNull(t)}decodeInterlaceNull(t){const e=this._png.height,n=this._png.channels*this._png.depth/8,i=this._png.width*n,r=new Uint8Array(this._png.height*i);let s,o,a=nm,l=0;for(let h=0;h<e;h++){switch(s=t.subarray(l+1,l+1+i),o=r.subarray(h*i,(h+1)*i),t[l]){case 0:om(s,o,i);break;case 1:am(s,o,i,n);break;case 2:lm(s,o,a,i);break;case 3:hm(s,o,a,i,n);break;case 4:um(s,o,a,i,n);break;default:throw new Error(`Unsupported filter: ${t[l]}`)}a=o,l+=i+1}if(this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency),16===this._png.depth){const t=new Uint16Array(r.buffer);if(rm)for(let e=0;e<t.length;e++)t[e]=(255&(h=t[e]))<<8|h>>8&255;this._png.data=t}else this._png.data=r;var h}}function om(t,e,n){for(let i=0;i<n;i++)e[i]=t[i]}function am(t,e,n,i){let r=0;for(;r<i;r++)e[r]=t[r];for(;r<n;r++)e[r]=t[r]+e[r-i]&255}function lm(t,e,n,i){let r=0;if(0===n.length)for(;r<i;r++)e[r]=t[r];else for(;r<i;r++)e[r]=t[r]+n[r]&255}function hm(t,e,n,i,r){let s=0;if(0===n.length){for(;s<r;s++)e[s]=t[s];for(;s<i;s++)e[s]=t[s]+(e[s-r]>>1)&255}else{for(;s<r;s++)e[s]=t[s]+(n[s]>>1)&255;for(;s<i;s++)e[s]=t[s]+(e[s-r]+n[s]>>1)&255}}function um(t,e,n,i,r){let s=0;if(0===n.length){for(;s<r;s++)e[s]=t[s];for(;s<i;s++)e[s]=t[s]+e[s-r]&255}else{for(;s<r;s++)e[s]=t[s]+n[s]&255;for(;s<i;s++)e[s]=t[s]+cm(e[s-r],n[s],n[s-r])&255}}function cm(t,e,n){const i=t+e-n,r=Math.abs(i-t),s=Math.abs(i-e),o=Math.abs(i-n);return r<=s&&r<=o?t:s<=o?e:n}const fm={level:3};class dm extends Ff.IOBuffer{constructor(t,e={}){super(),this._colorType=Jp.UNKNOWN,this._zlibOptions={...fm,...e.zlib},this._png=this._checkData(t),this.setBigEndian()}encode(){return this.encodeSignature(),this.encodeIHDR(),this.encodeData(),this.encodeIEND(),this.toArray()}encodeSignature(){this.writeBytes(Hp)}encodeIHDR(){this.writeUint32(13),this.writeChars("IHDR"),this.writeUint32(this._png.width),this.writeUint32(this._png.height),this.writeByte(this._png.depth),this.writeByte(this._colorType),this.writeByte(Qp.DEFLATE),this.writeByte(tm.ADAPTIVE),this.writeByte(em.NO_INTERLACE),this.writeCrc(17)}encodeIEND(){this.writeUint32(0),this.writeChars("IEND"),this.writeCrc(4)}encodeIDAT(t){this.writeUint32(t.length),this.writeChars("IDAT"),this.writeBytes(t),this.writeCrc(t.length+4)}encodeData(){const{width:t,height:e,channels:n,depth:i,data:r}=this._png,s=n*t,o=(new Ff.IOBuffer).setBigEndian();let a=0;for(let t=0;t<e;t++)if(o.writeByte(0),8===i)a=pm(r,o,s,a);else{if(16!==i)throw new Error("unreachable");a=mm(r,o,s,a)}const l=o.toArray(),h=Xp(l,this._zlibOptions);this.encodeIDAT(h)}_checkData(t){const{colorType:e,channels:n,depth:i}=function(t){const{channels:e=4,depth:n=8}=t;if(4!==e&&3!==e&&2!==e&&1!==e)throw new RangeError(`unsupported number of channels: ${e}`);if(8!==n&&16!==n)throw new RangeError(`unsupported bit depth: ${n}`);const i={channels:e,depth:n,colorType:Jp.UNKNOWN};switch(e){case 4:i.colorType=Jp.TRUECOLOUR_ALPHA;break;case 3:i.colorType=Jp.TRUECOLOUR;break;case 1:i.colorType=Jp.GREYSCALE;break;case 2:i.colorType=Jp.GREYSCALE_ALPHA;break;default:throw new Error("unsupported number of channels")}return i}(t),r={width:gm(t.width,"width"),height:gm(t.height,"height"),channels:n,data:t.data,depth:i,text:{}};this._colorType=e;const s=r.width*r.height*n;if(r.data.length!==s)throw new RangeError(`wrong data size. Found ${r.data.length}, expected ${s}`);return r}writeCrc(t){this.writeUint32(Kp(new Uint8Array(this.buffer,this.byteOffset+this.offset-t,t),t))}}function gm(t,e){if(Number.isInteger(t)&&t>0)return t;throw new TypeError(`${e} must be a positive integer`)}function pm(t,e,n,i){for(let r=0;r<n;r++)e.writeByte(t[i++]);return i}function mm(t,e,n,i){for(let r=0;r<n;r++)e.writeUint16(t[i++]);return i}var ym;!function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.METRE=1]="METRE"}(ym||(ym={}));var vm=__webpack_require__(7870);let wm="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",xm=new Uint8Array(256);for(let t=0;t<wm.length;t++)xm[wm.charCodeAt(t)]=t;function _m(t,e){return`data:${e};base64,${function(t){let e,n=t.length,i="";for(e=0;e<n;e+=3)i+=wm[t[e]>>2],i+=wm[(3&t[e])<<4|t[e+1]>>4],i+=wm[(15&t[e+1])<<2|t[e+2]>>6],i+=wm[63&t[e+2]];return n%3==2?i=`${i.substring(0,i.length-1)}=`:n%3==1&&(i=`${i.substring(0,i.length-2)}==`),i}(t)}`}const bm=self.ImageData,Em=self.Image;function Sm(t,e){let n=self.document.createElement("canvas");return n.width=t,n.height=e,n}function Im(t,e={}){const n={width:t.width,height:t.height,data:t.getRGBAData()};return(0,vm.encode)(n,e.quality).data}function Cm(t,e){const n={width:t.width,height:t.height,channels:t.channels,depth:t.bitDepth,data:t.data};return 1!==n.depth&&32!==n.depth||(n.depth=8,n.channels=4,n.data=t.getRGBAData()),function(t,e){return new dm(t,e).encode()}(n,e)}const Mm={save(t,e={}){const{useCanvas:n=!1,encoder:i}=e;let{format:r}=e;if(!r){const e=/\.(?<format>[a-zA-Z]+)$/.exec(t);e&&(r=e.groups.format.toLowerCase())}if(!r)throw new Error("file format not provided");return new Promise(((t,e)=>{let s,o;switch(r.toLowerCase()){case"png":n?s=this.getCanvas().pngStream():o=Cm(this,i);break;case"jpg":case"jpeg":n?s=this.getCanvas().jpegStream():o=Im(this,i);break;case"bmp":o=(0,Df.c)(this,i);break;default:throw new RangeError(`invalid output format: ${r}`)}if(s){let n=function(){throw new Error("createWriteStream does not exist in the browser")}();n.on("finish",t),n.on("error",e),s.pipe(n)}else o&&function(){throw new Error("writeFile does not exist in the browser")}()}))},toDataURL(t="image/png",e={}){"object"==typeof t&&(e=t,t="image/png");const{useCanvas:n=!1,encoder:i}=e;function r(e,n){return _m(e(n,i),t)}return"image/bmp"===(t=function(t){return t.includes("/")||(t=`image/${t}`),t}(t))?r(Df.c,this):"image/png"!==t||n?"image/jpeg"!==t||n?this.getCanvas().toDataURL(t):r(Im,this):r(Cm,this)},toBuffer(t={}){const{format:e="png",encoder:n}=t;switch(e.toLowerCase()){case"png":return Cm(this,n);case"jpeg":case"jpg":return Im(this,n);case"bmp":return(0,Df.c)(this,n);default:throw new RangeError(`invalid output format: ${e}`)}},toBase64(t="image/png",e={}){if(e.async)return this.toDataURL(t,e).then((function(t){return t.substring(t.indexOf(",")+1)}));{const n=this.toDataURL(t,e);return n.substring(n.indexOf(",")+1)}},toBlob(t="image/png",e=.8){return Lf(this.getCanvas(),t,e)},getCanvas(){const t=new bm(this.getRGBAData({clamped:!0}),this.width,this.height);let e=Sm(this.width,this.height);return e.getContext("2d").putImageData(t,0,0),e}};var Rm=__webpack_require__(2251),Pm=__webpack_require__.n(Rm);let Tm={configurable:!0,enumerable:!1,get:void 0};const Nm="GREY",Am="RGB",km="HSL",Lm="HSV",Om="CMYK",Dm="BINARY",Fm="RGBA",zm={};zm[Dm]={components:1,alpha:0,bitDepth:1,colorModel:Nm},zm.GREYA={components:1,alpha:1,bitDepth:8,colorModel:Nm},zm.GREY={components:1,alpha:0,bitDepth:8,colorModel:Nm},zm[Fm]={components:3,alpha:1,bitDepth:8,colorModel:Am},zm.RGB={components:3,alpha:0,bitDepth:8,colorModel:Am},zm.CMYK={components:4,alpha:0,bitDepth:8,colorModel:Om},zm.CMYKA={components:4,alpha:1,bitDepth:8,colorModel:Om};const Gm=[1,8,16,32];var Bm=__webpack_require__(9464),Um=__webpack_require__(9184),qm=__webpack_require__.n(Um);const Vm={33434:"ExposureTime",33437:"FNumber",34850:"ExposureProgram",34852:"SpectralSensitivity",34855:"ISOSpeedRatings",34856:"OECF",34864:"SensitivityType",34865:"StandardOutputSensitivity",34866:"RecommendedExposureIndex",34867:"ISOSpeed",34868:"ISOSpeedLatitudeyyy",34869:"ISOSpeedLatitudezzz",36864:"ExifVersion",36867:"DateTimeOriginal",36868:"DateTimeDigitized",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureBiasValue",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37386:"FocalLength",37396:"SubjectArea",37500:"MakerNote",37510:"UserComment",37520:"SubsecTime",37521:"SubsecTimeOriginal",37522:"SubsecTimeDigitized",40960:"FlashpixVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",40964:"RelatedSoundFile",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41492:"SubjectLocation",41493:"ExposureIndex",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRatio",41989:"FocalLengthIn35mmFilm",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",42016:"ImageUniqueID",42032:"CameraOwnerName",42033:"BodySerialNumber",42034:"LensSpecification",42035:"LensMake",42036:"LensModel",42037:"LensSerialNumber",42240:"Gamma"},Ym={};for(let t in Vm)Ym[Vm[t]]=Number(t);const Xm={0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential",31:"GPSHPositioningError"},jm={};for(let t in Xm)jm[Xm[t]]=Number(t);const Wm={254:"NewSubfileType",255:"SubfileType",256:"ImageWidth",257:"ImageLength",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",263:"Threshholding",264:"CellWidth",265:"CellLength",266:"FillOrder",270:"ImageDescription",271:"Make",272:"Model",273:"StripOffsets",274:"Orientation",277:"SamplesPerPixel",278:"RowsPerStrip",279:"StripByteCounts",280:"MinSampleValue",281:"MaxSampleValue",282:"XResolution",283:"YResolution",284:"PlanarConfiguration",288:"FreeOffsets",289:"FreeByteCounts",290:"GrayResponseUnit",291:"GrayResponseCurve",296:"ResolutionUnit",305:"Software",306:"DateTime",315:"Artist",316:"HostComputer",320:"ColorMap",338:"ExtraSamples",33432:"Copyright",269:"DocumentName",285:"PageName",286:"XPosition",287:"YPosition",292:"T4Options",293:"T6Options",297:"PageNumber",301:"TransferFunction",317:"Predictor",318:"WhitePoint",319:"PrimaryChromaticities",321:"HalftoneHints",322:"TileWidth",323:"TileLength",324:"TileOffsets",325:"TileByteCounts",326:"BadFaxLines",327:"CleanFaxData",328:"ConsecutiveBadFaxLines",330:"SubIFDs",332:"InkSet",333:"InkNames",334:"NumberOfInks",336:"DotRange",337:"TargetPrinter",339:"SampleFormat",340:"SMinSampleValue",341:"SMaxSampleValue",342:"TransferRange",343:"ClipPath",344:"XClipPathUnits",345:"YClipPathUnits",346:"Indexed",347:"JPEGTables",351:"OPIProxy",400:"GlobalParametersIFD",401:"ProfileType",402:"FaxProfile",403:"CodingMethods",404:"VersionYear",405:"ModeNumber",433:"Decode",434:"DefaultImageColor",512:"JPEGProc",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",515:"JPEGRestartInterval",517:"JPEGLosslessPredictors",518:"JPEGPointTransforms",519:"JPEGQTables",520:"JPEGDCTables",521:"JPEGACTables",529:"YCbCrCoefficients",530:"YCbCrSubSampling",531:"YCbCrPositioning",532:"ReferenceBlackWhite",559:"StripRowCounts",700:"XMP",32781:"ImageID",34732:"ImageLayer",32932:"WangAnnotatio",33445:"MDFileTag",33446:"MDScalePixel",33447:"MDColorTable",33448:"MDLabName",33449:"MDSampleInfo",33450:"MDPrepDate",33451:"MDPrepTime",33452:"MDFileUnits",33550:"ModelPixelScaleTag",33723:"IPTC",33918:"INGRPacketDataTag",33919:"INGRFlagRegisters",33920:"IrasBTransformationMatrix",33922:"ModelTiepointTag",34264:"ModelTransformationTag",34377:"Photoshop",34665:"ExifIFD",34675:"ICCProfile",34735:"GeoKeyDirectoryTag",34736:"GeoDoubleParamsTag",34737:"GeoAsciiParamsTag",34853:"GPSIFD",34908:"HylaFAXFaxRecvParams",34909:"HylaFAXFaxSubAddress",34910:"HylaFAXFaxRecvTime",37724:"ImageSourceData",40965:"InteroperabilityIFD",42112:"GDAL_METADATA",42113:"GDAL_NODATA",50215:"OceScanjobDescription",50216:"OceApplicationSelector",50217:"OceIdentificationNumber",50218:"OceImageLogicCharacteristics",50706:"DNGVersion",50707:"DNGBackwardVersion",50708:"UniqueCameraModel",50709:"LocalizedCameraModel",50710:"CFAPlaneColor",50711:"CFALayout",50712:"LinearizationTable",50713:"BlackLevelRepeatDim",50714:"BlackLevel",50715:"BlackLevelDeltaH",50716:"BlackLevelDeltaV",50717:"WhiteLevel",50718:"DefaultScale",50719:"DefaultCropOrigin",50720:"DefaultCropSize",50721:"ColorMatrix1",50722:"ColorMatrix2",50723:"CameraCalibration1",50724:"CameraCalibration2",50725:"ReductionMatrix1",50726:"ReductionMatrix2",50727:"AnalogBalance",50728:"AsShotNeutral",50729:"AsShotWhiteXY",50730:"BaselineExposure",50731:"BaselineNoise",50732:"BaselineSharpness",50733:"BayerGreenSplit",50734:"LinearResponseLimit",50735:"CameraSerialNumber",50736:"LensInfo",50737:"ChromaBlurRadius",50738:"AntiAliasStrength",50740:"DNGPrivateData",50741:"MakerNoteSafety",50778:"CalibrationIlluminant1",50779:"CalibrationIlluminant2",50780:"BestQualityScale",50784:"AliasLayerMetadata"},Hm={};for(let t in Wm)Hm[Wm[t]]=Number(t);const $m={standard:i,exif:e,gps:n};class Zm{constructor(t){if(!t)throw new Error("missing kind");this.data=new Uint8Array,this.fields=new Map,this.kind=t,this._hasMap=!1,this._map={}}get(t){if("number"==typeof t)return this.fields.get(t);if("string"==typeof t)return this.fields.get($m[this.kind].tagsByName[t]);throw new Error("expected a number or string")}get map(){if(!this._hasMap){const t=$m[this.kind].tagsById;for(let e of this.fields.keys())t[e]&&(this._map[t[e]]=this.fields.get(e));this._hasMap=!0}return this._map}}let Km=new Map([[1,[1,Jm]],[2,[1,function(t,e){let n=[],i="";for(let r=0;r<e;r++){let e=String.fromCharCode(t.readUint8());"\0"===e?(n.push(i),i=""):i+=e}return 1===n.length?n[0]:n}]],[3,[2,function(t,e){if(1===e)return t.readUint16();let n=new Uint16Array(e);for(let i=0;i<e;i++)n[i]=t.readUint16();return n}]],[4,[4,function(t,e){if(1===e)return t.readUint32();let n=new Uint32Array(e);for(let i=0;i<e;i++)n[i]=t.readUint32();return n}]],[5,[8,function(t,e){if(1===e)return t.readUint32()/t.readUint32();let n=new Array(e);for(let i=0;i<e;i++)n[i]=t.readUint32()/t.readUint32();return n}]],[6,[1,function(t,e){if(1===e)return t.readInt8();let n=new Int8Array(e);for(let i=0;i<e;i++)n[i]=t.readInt8();return n}]],[7,[1,Jm]],[8,[2,function(t,e){if(1===e)return t.readInt16();let n=new Int16Array(e);for(let i=0;i<e;i++)n[i]=t.readInt16();return n}]],[9,[4,function(t,e){if(1===e)return t.readInt32();let n=new Int32Array(e);for(let i=0;i<e;i++)n[i]=t.readInt32();return n}]],[10,[8,function(t,e){if(1===e)return t.readInt32()/t.readInt32();let n=new Array(e);for(let i=0;i<e;i++)n[i]=t.readInt32()/t.readInt32();return n}]],[11,[4,function(t,e){if(1===e)return t.readFloat32();let n=new Float32Array(e);for(let i=0;i<e;i++)n[i]=t.readFloat32();return n}]],[12,[8,function(t,e){if(1===e)return t.readFloat64();let n=new Float64Array(e);for(let i=0;i<e;i++)n[i]=t.readFloat64();return n}]]]);function Jm(t,e){if(1===e)return t.readUint8();let n=new Uint8Array(e);for(let i=0;i<e;i++)n[i]=t.readUint8();return n}let Qm=[];const ty=[511,1023,2047,4095],ey=[0,0,0,0,0,0,0,0,0,511,1023,2047,4095];class ny{constructor(t){this.nextData=0,this.nextBits=0,this.bytePointer=0,this.tableLength=258,this.currentBitLength=9,this.stripArray=new Uint8Array(t.buffer,t.byteOffset,t.byteLength),this.outData=new Ff.IOBuffer(t.byteLength),this.initializeTable()}decode(){let t=0,e=0;for(;257!==(t=this.getNextCode());)if(256===t){if(this.initializeTable(),t=this.getNextCode(),257===t)break;this.writeString(this.stringFromCode(t)),e=t}else if(this.isInTable(t))this.writeString(this.stringFromCode(t)),this.addStringToTable(this.stringFromCode(e).concat(this.stringFromCode(t)[0])),e=t;else{const n=this.stringFromCode(e).concat(this.stringFromCode(e)[0]);this.writeString(n),this.addStringToTable(n),e=t}const n=this.outData.toArray();return new DataView(n.buffer,n.byteOffset,n.byteLength)}initializeTable(){!function(){if(0===Qm.length){for(let t=0;t<256;t++)Qm.push([t]);const t=[];for(let e=256;e<4096;e++)Qm.push(t)}}(),this.tableLength=258,this.currentBitLength=9}writeString(t){this.outData.writeBytes(t)}stringFromCode(t){return Qm[t]}isInTable(t){return t<this.tableLength}addStringToTable(t){if(Qm[this.tableLength++]=t,Qm.length>4096)throw Qm=[],new Error("LZW decoding error. Please open an issue at https://github.com/image-js/tiff/issues/new/choose (include a test image).");this.tableLength===ey[this.currentBitLength]&&this.currentBitLength++}getNextCode(){this.nextData=this.nextData<<8|255&this.stripArray[this.bytePointer++],this.nextBits+=8,this.nextBits<this.currentBitLength&&(this.nextData=this.nextData<<8|255&this.stripArray[this.bytePointer++],this.nextBits+=8);const t=this.nextData>>this.nextBits-this.currentBitLength&ty[this.currentBitLength-9];return this.nextBits-=this.currentBitLength,this.bytePointer>this.stripArray.length?257:t}}function iy(t){return new ny(t).decode()}const ry=/^(\d{4}):(\d{2}):(\d{2}) (\d{2}):(\d{2}):(\d{2})$/;class sy extends Zm{constructor(){super("standard")}get size(){return this.width*this.height}get width(){return this.imageWidth}get height(){return this.imageLength}get components(){return this.samplesPerPixel}get date(){let t=new Date,e=ry.exec(this.dateTime);if(null===e)throw new Error(`invalid dateTime: ${this.dateTime}`);return t.setFullYear(Number(e[1]),Number(e[2])-1,Number(e[3])),t.setHours(Number(e[4]),Number(e[5]),Number(e[6])),t}get newSubfileType(){return this.get("NewSubfileType")}get imageWidth(){return this.get("ImageWidth")}get imageLength(){return this.get("ImageLength")}get bitsPerSample(){const t=this.get("BitsPerSample");return t&&"number"!=typeof t?t[0]:t}get alpha(){const t=this.extraSamples;return!!t&&0!==t[0]}get associatedAlpha(){const t=this.extraSamples;return!!t&&1===t[0]}get extraSamples(){return oy(this.get("ExtraSamples"))}get compression(){return this.get("Compression")||1}get type(){return this.get("PhotometricInterpretation")}get fillOrder(){return this.get("FillOrder")||1}get documentName(){return this.get("DocumentName")}get imageDescription(){return this.get("ImageDescription")}get stripOffsets(){return oy(this.get("StripOffsets"))}get orientation(){return this.get("Orientation")}get samplesPerPixel(){return this.get("SamplesPerPixel")||1}get rowsPerStrip(){return this.get("RowsPerStrip")}get stripByteCounts(){return oy(this.get("StripByteCounts"))}get minSampleValue(){return this.get("MinSampleValue")||0}get maxSampleValue(){return this.get("MaxSampleValue")||Math.pow(2,this.bitsPerSample)-1}get xResolution(){return this.get("XResolution")}get yResolution(){return this.get("YResolution")}get planarConfiguration(){return this.get("PlanarConfiguration")||1}get resolutionUnit(){return this.get("ResolutionUnit")||2}get dateTime(){return this.get("DateTime")}get predictor(){return this.get("Predictor")||1}get sampleFormat(){return this.get("SampleFormat")||1}get sMinSampleValue(){return this.get("SMinSampleValue")||this.minSampleValue}get sMaxSampleValue(){return this.get("SMaxSampleValue")||this.maxSampleValue}get palette(){const t=2**this.bitsPerSample,e=this.get("ColorMap");if(!e)return;if(e.length!==3*t)throw new Error(`ColorMap size must be ${t}`);const n=[];for(let i=0;i<t;i++)n.push([e[i],e[i+t],e[i+2*t]]);return n}}function oy(t){return"number"==typeof t?[t]:t}function ay(t){const e=new Uint8Array(t.buffer,t.byteOffset,t.byteLength),n=Wp(e);return new DataView(n.buffer,n.byteOffset,n.byteLength)}const ly={ignoreImageData:!1,onlyFirst:!1};class hy extends Ff.IOBuffer{constructor(t){super(t),this._nextIFD=0}get isMultiPage(){let t=0;for(this.decodeHeader();this._nextIFD;)if(t++,this.decodeIFD({ignoreImageData:!0},!0),2===t)return!0;if(1===t)return!1;throw uy("ifdCount",t)}get pageCount(){let t=0;for(this.decodeHeader();this._nextIFD;)t++,this.decodeIFD({ignoreImageData:!0},!0);if(t>0)return t;throw uy("ifdCount",t)}decode(t={}){t=Object.assign({},ly,t);const e=[];for(this.decodeHeader();this._nextIFD;)if(e.push(this.decodeIFD(t,!0)),t.onlyFirst)return[e[0]];return e}decodeHeader(){const t=this.readUint16();if(18761===t)this.setLittleEndian();else{if(19789!==t)throw new Error(`invalid byte order: 0x${t.toString(16)}`);this.setBigEndian()}if(42!==this.readUint16())throw new Error("not a TIFF file");this._nextIFD=this.readUint32()}decodeIFD(t,e){let n;if(this.seek(this._nextIFD),e)n=new sy;else{if(!t.kind)throw new Error("kind is missing");n=new Zm(t.kind)}const i=this.readUint16();for(let t=0;t<i;t++)this.decodeIFDEntry(n);if(!t.ignoreImageData){if(!(n instanceof sy))throw new Error("must be a tiff ifd");this.decodeImageData(n)}return this._nextIFD=this.readUint32(),n}decodeIFDEntry(t){const e=this.offset,n=this.readUint16(),i=this.readUint16(),r=this.readUint32();if(i<1||i>12)return void this.skip(4);const s=function(t,e){const n=Km.get(t);if(!n)throw new Error(`type not found: ${t}`);return n[0]*e}(i,r);s>4&&this.seek(this.readUint32());const o=function(t,e,n){const i=Km.get(e);if(!i)throw new Error(`type not found: ${e}`);return i[1](t,n)}(this,i,r);if(t.fields.set(n,o),34665===n||34853===n){let e=this.offset,i="exif";34665===n?i="exif":34853===n&&(i="gps"),this._nextIFD=o,t[i]=this.decodeIFD({kind:i,ignoreImageData:!0},!1),this.offset=e}this.seek(e),this.skip(12)}decodeImageData(t){const e=t.orientation;if(e&&1!==e)throw uy("orientation",e);switch(t.type){case 0:case 1:case 2:case 3:this.readStripData(t);break;default:throw uy("image type",t.type)}if(this.applyPredictor(t),this.convertAlpha(t),0===t.type){const e=t.bitsPerSample,n=Math.pow(2,e)-1;for(let e=0;e<t.data.length;e++)t.data[e]=n-t.data[e]}}readStripData(t){const e=t.width,n=t.height,i=t.bitsPerSample,r=t.sampleFormat,s=e*n*t.samplesPerPixel,o=function(t,e,n){if(8===e)return new Uint8Array(t);if(16===e)return new Uint16Array(t);if(32===e&&3===n)return new Float32Array(t);throw uy("bit depth / sample format",`${e} / ${n}`)}(s,i,r),a=t.rowsPerStrip*e*t.samplesPerPixel,l=t.stripOffsets,h=t.stripByteCounts||function(t){if(1!==t.compression)throw new Error("missing mandatory StripByteCounts field in compressed image");const e=t.rowsPerStrip*t.width*t.samplesPerPixel*(t.bitsPerSample/8);return new Array(t.stripOffsets.length).fill(e)}(t);let u=s,c=0;for(let e=0;e<l.length;e++){let n=new DataView(this.buffer,this.byteOffset+l[e],h[e]),s=u>a?a:u;u-=s;let f=n;switch(t.compression){case 1:break;case 5:f=iy(n);break;case 8:f=ay(n);break;case 2:throw uy("Compression","CCITT Group 3");case 32773:throw uy("Compression","PackBits");default:throw uy("Compression",t.compression)}c=this.fillUncompressed(i,r,o,f,c,s)}t.data=o}fillUncompressed(t,e,n,i,r,s){if(8===t)return function(t,e,n,i){for(let r=0;r<i;r++)t[n++]=e.getUint8(r);return n}(n,i,r,s);if(16===t)return function(t,e,n,i,r){for(let s=0;s<2*i;s+=2)t[n++]=e.getUint16(s,r);return n}(n,i,r,s,this.isLittleEndian());if(32===t&&3===e)return function(t,e,n,i,r){for(let s=0;s<4*i;s+=4)t[n++]=e.getFloat32(s,r);return n}(n,i,r,s,this.isLittleEndian());throw uy("bitDepth",t)}applyPredictor(t){const e=t.bitsPerSample;switch(t.predictor){case 1:break;case 2:if(8===e)!function(t,e,n){let i=0;for(;i<t.length;){for(let r=n;r<e*n;r+=n)for(let e=0;e<n;e++)t[i+r+e]=t[i+r+e]+t[i+r-(n-e)]&255;i+=e*n}}(t.data,t.width,t.components);else{if(16!==e)throw new Error(`Horizontal differencing is only supported for images with a bit depth of ${e}`);!function(t,e,n){let i=0;for(;i<t.length;){for(let r=n;r<e*n;r+=n)for(let e=0;e<n;e++)t[i+r+e]=t[i+r+e]+t[i+r-(n-e)]&65535;i+=e*n}}(t.data,t.width,t.components)}break;default:throw new Error(`invalid predictor: ${t.predictor}`)}}convertAlpha(t){if(t.alpha&&t.associatedAlpha){const{data:e,components:n,maxSampleValue:i}=t;for(let t=0;t<e.length;t+=n){const r=e[t+n-1];for(let s=0;s<n-1;s++)e[t+s]=Math.round(e[t+s]*i/r)}}}}function uy(t,e){return new Error(`Unsupported ${t}: ${e}`)}function cy(t={}){let{algorithm:e="matchToPrevious",ignoreBorder:n=[0,0]}=t;this.checkProcessable("matchAndCrop",{bitDepth:[8,16]});let i="matchToPrevious"===e,r=this[0],s=[];s[0]={position:[0,0],image:this[0]};let o=[0,0];for(let t=1;t<this.length;t++){let e=r.getBestMatch(this[t],{border:n});s[t]={position:[e[0]+o[0],e[1]+o[1]],image:this[t]},i&&(o[0]+=e[0],o[1]+=e[1],r=this[t])}let a=0,l=0,h=0,u=0;for(let t=0;t<s.length;t++){let e=s[t];e.position[0]>a&&(a=e.position[0]),e.position[0]<l&&(l=e.position[0]),e.position[1]>h&&(h=e.position[1]),e.position[1]<u&&(u=e.position[1])}l=0-l,u=0-u;for(let t=0;t<s.length;t++){let e=s[t];e.crop=e.image.crop({x:a-e.position[0],y:h-e.position[1],width:r.width-l-a,height:r.height-u-h})}let c=[];for(let t=0;t<s.length;t++)c[t]=s[t].crop;return new Ey(c)}function fy(){this.checkProcessable("min",{bitDepth:[8,16]});let t=this[0].min;for(let e=1;e<this.length;e++)for(let n=0;n<t.length;n++)t[n]=Math.min(t[n],this[e].min[n]);return t}function dy(){this.checkProcessable("min",{bitDepth:[8,16]});let t=this[0].max;for(let e=1;e<this.length;e++)for(let n=0;n<t.length;n++)t[n]=Math.max(t[n],this[e].max[n]);return t}function gy(t){let e=t.reduce(((t,e)=>t+e));if(0===e)throw new Error("unreachable");let n,i=0,r=0,s=e/2;for(;;){if(t[i]>0){if(void 0!==n)return(n+i)/2;if(r+=t[i],r>s)return i;r===s&&(n=i)}i++}}function py(t){let e=0,n=0;for(let i=0;i<t.length;i++)e+=t[i],n+=t[i]*i;return 0===e?0:n/e}function my(){this.checkProcessable("median",{bitDepth:[8,16]});let t=this.getHistograms({maxSlots:this[0].maxValue+1}),e=new Array(t.length);for(let n=0;n<t.length;n++){let i=t[n];e[n]=gy(i)}return e}function yy(t){this.checkProcessable("min",{bitDepth:[8,16]});let e=this[0].getHistogram(t);for(let n=1;n<this.length;n++){let i=this[n].getHistogram(t);for(let t=0;t<e.length;t++)e[t]+=i[t]}return e}function vy(t){this.checkProcessable("min",{bitDepth:[8,16]});let e=this[0].getHistograms(t),n=e[0].length;for(let i=1;i<this.length;i++){let r=this[i].getHistograms(t);for(let t=0;t<e.length;t++)for(let i=0;i<n;i++)e[t][i]+=r[t][i]}return e}function wy(){this.checkProcessable("averageImage",{bitDepth:[8,16]});let t=new Uint32Array(this[0].data.length);for(let e=0;e<this.length;e++){let n=this[e];for(let e=0;e<this[0].data.length;e++)t[e]+=n.data[e]}let e=R_.createFrom(this[0]),n=e.data;for(let e=0;e<this[0].data.length;e++)n[e]=t[e]/this.length;return e}function xy(){this.checkProcessable("max",{bitDepth:[8,16]});let t=R_.createFrom(this[0]);t.data.fill(0);for(const e of this)for(let n=0;n<t.data.length;n++)t.data[n]=Math.max(e.data[n],t.data[n]);return t}function _y(){this.checkProcessable("max",{bitDepth:[8,16]});let t=R_.createFrom(this[0]);t.data.fill(t.maxValue);for(const e of this)for(let n=0;n<t.data.length;n++)t.data[n]=Math.min(e.data[n],t.data[n]);return t}let by={configurable:!0,enumerable:!1,get:void 0};class Ey extends Array{constructor(t){if(Array.isArray(t)){super(t.length);for(let e=0;e<t.length;e++)this[e]=t[e]}else"number"==typeof t?super(t):super();this.computed=null}static load(t){return Promise.all(t.map(R_.load)).then((t=>new Ey(t)))}static extendMethod(t,e,n={}){let{inPlace:i=!1,returnThis:r=!0,partialArgs:s=[]}=n;return Ey.prototype[t]=i?function(...t){this.computed=null;let n=e.apply(this,[...s,...t]);return r?this:n}:function(...t){return e.apply(this,[...s,...t])},Ey}static extendProperty(t,e,n={}){let{partialArgs:i=[]}=n;return by.get=function(){if(null===this.computed)this.computed={};else if(Pm()(t,this.computed))return this.computed[t];let n=e.apply(this,i);return this.computed[t]=n,n},Object.defineProperty(Ey.prototype,t,by),Ey}checkProcessable(t,e={}){if("string"!=typeof t)throw new TypeError("checkProcessable requires as first parameter the processName (a string)");if(0===this.size)throw new TypeError(`The process: ${t} can not be applied on an empty stack`);this[0].checkProcessable(t,e);for(let n=1;n<this.length;n++){if((void 0===e.sameSize||e.sameSize)&&this[0].width!==this[n].width)throw new TypeError(`The process: ${t} can not be applied if width is not identical in all images`);if((void 0===e.sameSize||e.sameSize)&&this[0].height!==this[n].height)throw new TypeError(`The process: ${t} can not be applied if height is not identical in all images`);if((void 0===e.sameAlpha||e.sameAlpha)&&this[0].alpha!==this[n].alpha)throw new TypeError(`The process: ${t} can not be applied if alpha is not identical in all images`);if((void 0===e.sameBitDepth||e.sameBitDepth)&&this[0].bitDepth!==this[n].bitDepth)throw new TypeError(`The process: ${t} can not be applied if bitDepth is not identical in all images`);if((void 0===e.sameColorModel||e.sameColorModel)&&this[0].colorModel!==this[n].colorModel)throw new TypeError(`The process: ${t} can not be applied if colorModel is not identical in all images`);if((void 0===e.sameNumberChannels||e.sameNumberChannels)&&this[0].channels!==this[n].channels)throw new TypeError(`The process: ${t} can not be applied if channels is not identical in all images`)}}}Array[Symbol.species]||(Ey.prototype.map=function(t,e){if("function"!=typeof t)throw new TypeError(`${t} is not a function`);let n=new Ey(this.length);for(let i=0;i<this.length;i++)n[i]=t.call(e,this[i],i,this);return n}),function(t){t.extendMethod("matchAndCrop",cy),t.extendMethod("getMin",fy),t.extendMethod("getMax",dy),t.extendMethod("getMedian",my),t.extendMethod("getHistogram",yy),t.extendMethod("getHistograms",vy),t.extendMethod("getAverage",wy),t.extendMethod("getAverageImage",wy),t.extendMethod("getMaxImage",xy),t.extendMethod("getMinImage",_y)}(Ey);const Sy=/^data:[a-z]+\/(?:[a-z]+);base64,/;function Iy(t,e,n){const i=qm()(t);if(i)switch(i.mime){case"image/png":return function(t){const e=function(t,e){return new sm(t,void 0).decode()}(t);let n,i=e.channels,r=0;return 2===i||4===i?(n=i-1,r=1):n=i,e.palette?function(t){const e=t.width*t.height,n=t.palette[0].length,i=new Uint8Array(e*n),r=8/t.depth,s=t.depth<8?r:1,o=parseInt("1".repeat(t.depth),2),a=4===n;let l=0;for(let n=0;n<e;n++){const e=Math.floor(n/s);let h=t.data[e];t.depth<8&&(h=h>>>t.depth*(r-1-n%r)&o);const u=t.palette[h];i[l++]=u[0],i[l++]=u[1],i[l++]=u[2],a&&(i[l++]=u[3])}return new R_(t.width,t.height,i,{components:3,alpha:a,bitDepth:8})}(e):new R_(e.width,e.height,e.data,{components:n,alpha:r,bitDepth:e.depth})}(t);case"image/jpeg":return function(t){const e=(0,Bm.decode)(t);let n;e.exif&&(n=Cy(e.exif));const i=(0,vm.decode)(t,{useTArray:!0,maxMemoryUsageInMB:1024});let r=new R_(i.width,i.height,i.data,{meta:n});if(n&&n.tiff.tags.Orientation){const t=n.tiff.tags.Orientation;t>2&&(r=r.rotate({3:180,4:180,5:90,6:90,7:270,8:270}[t])),[2,4,5,7].includes(t)&&(r=r.flipX())}return r}(t);case"image/tiff":return function(t,e){let n=function(t,e){return new hy(t).decode(void 0)}(t);return 1===n.length?My(n[0],e):new Ey(n.map((function(t){return My(t,e)})))}(t,n);default:return Ry(r(i.mime))}return Ry(r("application/octet-stream"));function r(n){return e||_m(t,n)}}function Cy(t){const e={tiff:{fields:t.fields,tags:t.map}};return t.exif&&(e.exif=t.exif),t.gps&&(e.gps=t.gps),e}function My(t,e){if(e||3!==t.type)return new R_(t.width,t.height,t.data,{components:2===t.type?3:1,alpha:t.alpha,colorModel:2===t.type?Am:Nm,bitDepth:t.bitsPerSample.length?t.bitsPerSample[0]:t.bitsPerSample,meta:Cy(t)});{const e=new Uint16Array(3*t.width*t.height),n=t.palette;let i=0;for(let r=0;r<t.data.length;r++){const s=n[t.data[r]];e[i++]=s[0],e[i++]=s[1],e[i++]=s[2]}return new R_(t.width,t.height,e,{components:3,alpha:t.alpha,colorModel:Am,bitDepth:16,meta:Cy(t)})}}function Ry(t,e){return e=e||{},new Promise((function(n,i){let r=new Em;r.onload=function(){let t=r.width,i=r.height,s=Sm(t,i).getContext("2d");s.drawImage(r,0,0,t,i);let o=s.getImageData(0,0,t,i).data;n(new R_(t,i,o,e))},r.onerror=function(){i(new Error(`Could not load ${t}`))},r.src=t}))}const Py={getValueXY(t,e,n){return this.data[(e*this.width+t)*this.channels+n]},setValueXY(t,e,n,i){return this.data[(e*this.width+t)*this.channels+n]=i,this.computed=null,this},getValue(t,e){return this.data[t*this.channels+e]},setValue(t,e,n){return this.data[t*this.channels+e]=n,this.computed=null,this},getPixelXY(t,e){return this.getPixel(e*this.width+t)},setPixelXY(t,e,n){return this.setPixel(e*this.width+t,n)},getPixel(t){const e=new Array(this.channels),n=t*this.channels;for(let t=0;t<this.channels;t++)e[t]=this.data[n+t];return e},setPixel(t,e){const n=t*this.channels;for(let t=0;t<e.length;t++)this.data[n+t]=e[t];return this.computed=null,this}};function Ty(t){return{width:t.width,height:t.height,components:t.components,alpha:t.alpha,colorModel:t.colorModel,bitDepth:t.bitDepth}}function Ny(t,e,n,i={}){const{out:r}=e;if(void 0===r)return i.copy?t.clone():R_.createFrom(t,n);{if(!R_.isImage(r))throw new TypeError("out must be an Image object");const e=Object.assign(Ty(t),n);for(const t in e)if(r[t]!==e[t])throw new RangeError(`cannot use out. Its ${t} must be "${e[t]}" (found "${r[t]}")`);return r}}function Ay(t,e,n){if(void 0!==e.inPlace&&"boolean"!=typeof e.inPlace)throw new TypeError("inPlace option must be a boolean");if(e.inPlace){if(void 0!==e.out)throw new TypeError("out option must not be set if inPlace option is true");return t}return Ny(t,e,null,n)}function ky(t={}){this.checkProcessable("abs",{bitDepth:[32]});const e=Ay(this,t);return function(t,e){for(let n=0;n<t.data.length;n++)e.data[n]=Math.abs(t.data[n])}(this,e),e}function Ly(t={}){this.checkProcessable("invert",{bitDepth:[1,8,16]});const e=Ay(this,t);return 1===this.bitDepth?function(t,e){for(let n=0;n<t.data.length;n++)e.data[n]=~t.data[n]}(this,e):(function(t,e){for(let n=0;n<t.data.length;n+=t.channels)for(let i=0;i<t.components;i++)e.data[n+i]=t.maxValue-t.data[n+i]}(this,e),this!==e&&function(t,e){if(1===t.alpha&&1===e.alpha)for(let n=0;n<t.size;n++)e.data[n*e.channels+e.components]=t.data[n*t.channels+t.components]}(this,e)),e}function Oy(){this.checkProcessable("flipX",{bitDepth:[8,16]});for(let t=0;t<this.height;t++){let e=t*this.width*this.channels;for(let t=0;t<Math.floor(this.width/2);t++){let n=t*this.channels+e,i=(this.width-t-1)*this.channels+e;for(let t=0;t<this.channels;t++){let e=this.data[n+t];this.data[n+t]=this.data[i+t],this.data[i+t]=e}}}return this}function Dy(){this.checkProcessable("flipY",{bitDepth:[8,16]});for(let t=0;t<Math.floor(this.height/2);t++)for(let e=0;e<this.width;e++){let n=e*this.channels+t*this.width*this.channels,i=e*this.channels+(this.height-1-t)*this.channels*this.width;for(let t=0;t<this.channels;t++){let e=this.data[n+t];this.data[n+t]=this.data[i+t],this.data[i+t]=e}}return this}function Fy(t={}){const{radius:e=1}=t;if(e<1)throw new Error("radius must be greater than 1");const n=2*e+1,i=new Array(n);for(let t=0;t<n;t++){i[t]=new Array(n);for(let e=0;e<n;e++)i[t][e]=1/(n*n)}return this.convolution(i)}var zy=__webpack_require__(5520),Gy=__webpack_require__.n(zy);function By(t,e={}){let{channels:n,allowAlpha:i,defaultAlpha:r}=e;return"boolean"!=typeof i&&(i=!0),void 0===n?function(t,e){let n=e?t.channels:t.components,i=new Array(n);for(let t=0;t<n;t++)i[t]=t;return i}(t,r):function(t,e,n){Array.isArray(e)||(e=[e]);for(let i=0;i<e.length;i++)e[i]=Uy(t,e[i],n);return e}(t,n,i)}function Uy(t,e,n=!0){if(void 0===e)throw new RangeError(`validateChannel : the channel has to be >=0 and <${t.channels}`);if("string"==typeof e){switch(t.colorModel){case Nm:break;case Am:if("rgb".includes(e))switch(e){case"r":e=0;break;case"g":e=1;break;case"b":e=2}break;case km:if("hsl".includes(e))switch(e){case"h":e=0;break;case"s":e=1;break;case"l":e=2}break;case Lm:if("hsv".includes(e))switch(e){case"h":e=0;break;case"s":e=1;break;case"v":e=2}break;case Om:if("cmyk".includes(e))switch(e){case"c":e=0;break;case"m":e=1;break;case"y":e=2;break;case"k":e=3}break;default:throw new Error(`Unexpected color model: ${t.colorModel}`)}if("a"===e){if(!t.alpha)throw new Error("validateChannel : the image does not contain alpha channel");e=t.components}if("string"==typeof e)throw new Error(`validateChannel : undefined channel: ${e}`)}if(e>=t.channels)throw new RangeError(`validateChannel : the channel has to be >=0 and <${t.channels}`);if(!n&&e>=t.components)throw new RangeError("validateChannel : alpha channel may not be selected");return e}function qy(t={}){let{radius:e=1,border:n="copy",channels:i}=t;if(this.checkProcessable("medianFilter",{bitDepth:[8,16]}),e<1)throw new Error("radius must be greater than 0");i=By(this,i);let r=e,s=e,o=R_.createFrom(this),a=new Array((2*r+1)*(2*s+1));for(let t=0;t<i.length;t++){let e=i[t];for(let t=s;t<this.height-s;t++)for(let n=r;n<this.width-r;n++){let i=0;for(let o=-s;o<=s;o++)for(let s=-r;s<=r;s++){let r=((t+o)*this.width+n+s)*this.channels+e;a[i++]=this.data[r]}let l=(t*this.width+n)*this.channels+e;o.data[l]=Gy()(a)}}if(this.alpha&&!i.includes(this.channels))for(let t=this.components;t<this.data.length;t+=this.channels)o.data[t]=this.data[t];return o.setBorder({size:[r,s],algorithm:n}),o}function Vy(t={}){let{radius:e=1,sigma:n,channels:i,border:r="copy"}=t;this.checkProcessable("gaussian",{bitDepth:[8,16]});const s=function(t,e){const n=2*t+1,i=new Array(n),r=e||.3*(.5*(n-1)-1)+.8,s=-.5/(r*r);let o=0;for(let e=0;e<n;e++){const n=e-t,r=Math.exp(s*n*n);i[e]=r,o+=r}for(let t=0;t<n;t++)i[t]/=o;return i}(e,n);return this.convolution([s,s],{border:r,channels:i,algorithm:"separable"})}const Yy=[[-1,0,1],[-2,0,2],[-1,0,1]],Xy=[[-1,-2,-1],[0,0,0],[1,2,1]],jy=[[3,0,-3],[10,0,-10],[3,0,-3]],Wy=[[3,10,3],[0,0,0],[-3,-10,-3]];var Hy=__webpack_require__(414),$y=__webpack_require__(8336),Zy=__webpack_require__.n($y);function Ky(t,e){return Math.round(Math.min(Math.max(t,0),e.maxValue))}function Jy(t,e,n){if(void 0===n){const i=t.length+e.length-1;n=new Array(i)}!function(t){for(var e=0;e<t.length;e++)t[e]=0}(n);for(var i=0;i<t.length;i++)for(var r=0;r<e.length;r++)n[i+r]+=t[i]*e[r];return n}function Qy(t,e,n,i){const r=new Array(t.length);let s,o,a,l;l=e[1],a=(l.length-1)/2,o=new Array(n+l.length-1),s=new Array(n);for(let e=0;e<i;e++){for(let i=0;i<n;i++)s[i]=t[e*n+i];Jy(s,l,o);for(let t=0;t<n;t++)r[e*n+t]=o[a+t]}l=e[0],a=(l.length-1)/2,o=new Array(i+l.length-1),s=new Array(i);for(let t=0;t<n;t++){for(let e=0;e<i;e++)s[e]=r[e*n+t];Jy(s,l,o);for(let e=0;e<i;e++)r[e*n+t]=o[a+e]}return r}__webpack_require__(9645),__webpack_require__(995);var tv=__webpack_require__(8406);tv.AbstractMatrix,tv.CHO,tv.CholeskyDecomposition,tv.DistanceMatrix,tv.EVD,tv.EigenvalueDecomposition,tv.LU,tv.LuDecomposition;const ev=tv.Matrix,nv=(tv.MatrixColumnSelectionView,tv.MatrixColumnView,tv.MatrixFlipColumnView,tv.MatrixFlipRowView,tv.MatrixRowSelectionView,tv.MatrixRowView,tv.MatrixSelectionView,tv.MatrixSubView,tv.MatrixTransposeView,tv.NIPALS,tv.Nipals,tv.QR,tv.QrDecomposition,tv.SVD),iv=tv.SingularValueDecomposition,rv=(tv.SymmetricMatrix,tv.WrapperMatrix1D,tv.WrapperMatrix2D,tv.correlation,tv.covariance,tv.Matrix,tv.Matrix,tv.determinant,tv.inverse),sv=(tv.linearDependencies,tv.pseudoInverse,tv.solve);function ov(t,e={}){let{channels:n,bitDepth:i,normalize:r=!1,divisor:s=1,border:o="copy",algorithm:a="auto"}=e,l={};i&&(l.bitDepth=i);let h,u,c=R_.createFrom(this,l);if(n=By(this,n),"separable"!==a)({kernel:t}=function(t){let e,n;if(!Array.isArray(t))throw new Error(`validateKernel: Invalid Kernel: ${t}`);if(Array.isArray(t[0])){if(0==(1&t.length)||0==(1&t[0].length))throw new RangeError("validateKernel: Kernel rows and columns should be odd numbers");e=Math.floor(t.length/2),n=Math.floor(t[0].length/2)}else{let i=Math.sqrt(t.length);if(!Zy()(i))throw new RangeError("validateKernel: Kernel array should be a square");n=e=Math.floor(Math.sqrt(t.length)/2);let r=new Array(i);for(let e=0;e<i;e++){r[e]=new Array(i);for(let n=0;n<i;n++)r[e][n]=t[e*i+n]}t=r}return{kernel:t,kWidth:n,kHeight:e}}(t));else if(!Array.isArray(t)||2!==t.length)throw new RangeError("separable convolution requires two arrays of numbers to represent the kernel");if("auto"===a){let e=function(t){const e=new nv(t,{autoTranspose:!0});if(1!==e.rank)return null;const n=Math.sqrt(e.s[0]);return[e.U.to2DArray().map((t=>t[0]*n)),e.V.to2DArray().map((t=>t[0]*n))]}(t);null!==e?(a="separable",t=e):a=(t.length>9||t[0].length>9)&&this.width<=4096&&this.height<=4096?"fft":"direct"}"separable"===a?(h=Math.floor(t[0].length/2),u=Math.floor(t[1].length/2)):(h=Math.floor(t.length/2),u=Math.floor(t[0].length/2));let f,d,g,p,m,y,v=c.isClamped,w=new Array(this.height*this.width);for(p=0;p<n.length;p++){for(m=n[p],g=0;g<this.height;g++)for(d=0;d<this.width;d++)f=g*this.width+d,w[f]=this.data[f*this.channels+m];if("direct"===a)y=(0,Hy.direct)(w,t,{rows:this.height,cols:this.width,normalize:r,divisor:s});else if("separable"===a){if(y=Qy(w,t,this.width,this.height),r){s=0;for(let e=0;e<t[0].length;e++)for(let n=0;n<t[1].length;n++)s+=t[0][e]*t[1][n]}if(1!==s)for(let t=0;t<y.length;t++)y[t]/=s}else y=(0,Hy.fft)(w,t,{rows:this.height,cols:this.width,normalize:r,divisor:s});for(g=0;g<this.height;g++)for(d=0;d<this.width;d++)f=g*this.width+d,c.data[f*this.channels+m]=v?Ky(y[f],c):y[f]}if(this.alpha&&!n.includes(this.channels))for(d=this.components;d<this.data.length;d+=this.channels)c.data[d]=this.data[d];return"periodic"!==o&&c.setBorder({size:[u,h],algorithm:o}),c}function av(t={}){let{direction:e="xy",border:n="copy",kernelX:i,kernelY:r,channels:s,bitDepth:o=this.bitDepth}=t;switch(this.checkProcessable("gradientFilter",{bitDepth:[8,16]}),e){case"x":if(!i)throw new Error("kernelX option is missing");return ov.call(this,i,{channels:s,border:n,bitDepth:o});case"y":if(!r)throw new Error("kernelY option is missing");return ov.call(this,r,{channels:s,border:n,bitDepth:o});case"xy":{if(!i)throw new Error("kernelX option is missing");if(!r)throw new Error("kernelY option is missing");const t=ov.call(this,i,{channels:s,border:n,bitDepth:32}),e=ov.call(this,r,{channels:s,border:n,bitDepth:32});return t.hypotenuse(e,{bitDepth:o,channels:s})}default:throw new Error(`Unknown parameter direction: ${e}`)}}function lv(t){return av.call(this,Object.assign({},t,{kernelX:Yy,kernelY:Xy}))}function hv(t){return av.call(this,Object.assign({},t,{kernelX:jy,kernelY:Wy}))}tv.wrap;var uv=__webpack_require__(2664),fv=__webpack_require__.n(uv);function dv(t={}){let{algorithm:e="range",channels:n,min:i=this.min,max:r=this.max}=t;if(this.checkProcessable("level",{bitDepth:[8,16,32]}),n=By(this,{channels:n}),n.length!==this.channel&&(Array.isArray(i)&&i.length===this.channels&&(i=i.filter(((t,e)=>n.includes(e)))),Array.isArray(r)&&r.length===this.channels&&(r=r.filter(((t,e)=>n.includes(e))))),"range"!==e)throw new Error(`level: algorithm not implement: ${e}`);return i<0&&(i=0),r>this.maxValue&&(r=this.maxValue),Array.isArray(i)||(i=fv()(n.length,i)),Array.isArray(r)||(r=fv()(n.length,r)),function(t,e,n,i){let r=1e-5,s=new Array(i.length);for(let o=0;o<i.length;o++)0===e[o]&&n[o]===t.maxValue||n[o]===e[o]?s[o]=0:s[o]=(t.maxValue+1-r)/(n[o]-e[o]),e[o]+=.499995/s[o];for(let n=0;n<i.length;n++){let r=i[n];if(0!==s[n])for(let i=0;i<t.data.length;i+=t.channels)t.data[i+r]=Math.min(Math.max(0,(t.data[i+r]-e[n])*s[n]+.5|0),t.maxValue)}}(this,i,r,n),this}var gv=__webpack_require__(7811),pv=__webpack_require__.n(gv);function mv(t){if(isNaN(t)){if(t instanceof R_)return t.data;if(!pv()(t))throw new Error("checkNumberArray: the value should be either a number, array or Image");return t}if(t<=0)throw new Error("checkNumberArray: the value must be greater than 0");return t}function yv(t,e={}){let{channels:n}=e;if(this.checkProcessable("add",{bitDepth:[8,16]}),n=By(this,{channels:n}),t=mv(t),isNaN(t)){if(this.data.length!==t.length)throw new Error("add: the data size is different");for(let e=0;e<n.length;e++){let i=n[e];for(let e=0;e<this.data.length;e+=this.channels)this.data[e+i]=Math.max(0,Math.min(this.maxValue,this.data[e+i]+t[e+i]>>0))}}else for(let e=0;e<n.length;e++){let i=n[e];for(let e=0;e<this.data.length;e+=this.channels)this.data[e+i]=Math.min(this.maxValue,this.data[e+i]+t>>0)}return this}function vv(t,e={}){let{channels:n}=e;if(this.checkProcessable("subtract",{bitDepth:[8,16]}),n=By(this,{channels:n}),t=mv(t),isNaN(t)){if(this.data.length!==t.length)throw new Error("subtract: the data size is different");for(let e=0;e<n.length;e++){let i=n[e];for(let e=0;e<this.data.length;e+=this.channels)this.data[e+i]=Math.max(0,Math.min(this.maxValue,this.data[e+i]-t[e+i]>>0))}}else for(let e=0;e<n.length;e++){let i=n[e];for(let e=0;e<this.data.length;e+=this.channels)this.data[e+i]=Math.max(0,this.data[e+i]-t>>0)}return this}function wv(t,e={}){let{channels:n,absolute:i=!1}=e;if(this.checkProcessable("subtractImage",{bitDepth:[8,16]}),this.width!==t.width||this.height!==t.height)throw new Error("subtractImage: both images must have the same size");if(this.alpha!==t.alpha||this.bitDepth!==t.bitDepth)throw new Error("subtractImage: both images must have the same alpha and bitDepth");if(this.channels!==t.channels)throw new Error("subtractImage: both images must have the same number of channels");let r=this.clone();n=By(this,{channels:n});for(let e=0;e<n.length;e++)for(let s=n[e];s<this.data.length;s+=this.channels){let e=this.data[s]-t.data[s];r.data[s]=i?Math.abs(e):Math.max(e,0)}return r}function xv(t,e={}){let{bitDepth:n=this.bitDepth,channels:i}=e;if(this.checkProcessable("hypotenuse",{bitDepth:[8,16,32]}),this.width!==t.width||this.height!==t.height)throw new Error("hypotenuse: both images must have the same size");if(this.alpha!==t.alpha||this.bitDepth!==t.bitDepth)throw new Error("hypotenuse: both images must have the same alpha and bitDepth");if(this.channels!==t.channels)throw new Error("hypotenuse: both images must have the same number of channels");let r=R_.createFrom(this,{bitDepth:n});i=By(this,{channels:i});let s=r.isClamped;for(let e=0;e<i.length;e++)for(let n=i[e];n<this.data.length;n+=this.channels){let e=Math.hypot(this.data[n],t.data[n]);r.data[n]=s?Math.min(Math.max(Math.round(e),0),r.maxValue):e}return r}function _v(t,e={}){let{channels:n}=e;if(this.checkProcessable("multiply",{bitDepth:[8,16]}),t<=0)throw new Error("multiply: the value must be greater than 0");if(n=By(this,{channels:n}),t=mv(t),isNaN(t)){if(this.data.length!==t.length)throw new Error("multiply: the data size is different");for(let e=0;e<n.length;e++){let i=n[e];for(let e=0;e<this.data.length;e+=this.channels)this.data[e+i]=Math.max(0,Math.min(this.maxValue,this.data[e+i]*t[e+i]>>0))}}else for(let e=0;e<n.length;e++){let i=n[e];for(let e=0;e<this.data.length;e+=this.channels)this.data[e+i]=Math.min(this.maxValue,this.data[e+i]*t>>0)}return this}function bv(t,e={}){let{channels:n}=e;if(this.checkProcessable("divide",{bitDepth:[8,16]}),n=By(this,{channels:n}),t=mv(t),isNaN(t)){if(this.data.length!==t.length)throw new Error("divide: the: the data size is different");for(let e=0;e<n.length;e++){let i=n[e];for(let e=0;e<this.data.length;e+=this.channels)this.data[e+i]=Math.max(0,Math.min(this.maxValue,this.data[e+i]/t[e+i]>>0))}}else for(let e=0;e<n.length;e++){let i=n[e];for(let e=0;e<this.data.length;e+=this.channels)this.data[e+i]=Math.min(this.maxValue,this.data[e+i]/t>>0)}return this}var Ev=__webpack_require__(4091);class Sv{constructor(){if(new.target===Sv)throw new Error("BaseRegression must be subclassed")}predict(t){if("number"==typeof t)return this._predict(t);if((0,Ev.isAnyArray)(t)){const e=[];for(let n=0;n<t.length;n++)e.push(this._predict(t[n]));return e}throw new TypeError("x must be a number or array")}_predict(){throw new Error("_predict must be implemented")}train(){}toString(){return""}toLaTeX(){return""}score(t,e){if(!(0,Ev.isAnyArray)(t)||!(0,Ev.isAnyArray)(e)||t.length!==e.length)throw new Error("x and y must be arrays of the same length");const n=t.length,i=new Array(n);for(let e=0;e<n;e++)i[e]=this._predict(t[e]);let r=0,s=0,o=0,a=0,l=0,h=0,u=0;for(let t=0;t<n;t++)r+=i[t],s+=e[t],l+=i[t]*i[t],h+=e[t]*e[t],u+=i[t]*e[t],0!==e[t]&&(o+=(e[t]-i[t])*(e[t]-i[t])/e[t]),a+=(e[t]-i[t])*(e[t]-i[t]);const c=(n*u-r*s)/Math.sqrt((n*l-r*r)*(n*h-s*s));return{r:c,r2:c*c,chi2:o,rmsd:Math.sqrt(a/n)}}}var Iv=__webpack_require__(6952),Cv=__webpack_require__.n(Iv);const Mv={lambda:.1,kernelType:"gaussian",kernelOptions:{},computeCoefficient:!1};class Rv extends Sv{constructor(t,e,n){if(super(),!0===t)this.alpha=e.alpha,this.inputs=e.inputs,this.kernelType=e.kernelType,this.kernelOptions=e.kernelOptions,this.kernel=new(Cv())(e.kernelType,e.kernelOptions);else{t=ev.checkMatrix(t),n=Object.assign({},Mv,n);const i=new(Cv())(n.kernelType,n.kernelOptions),r=i.compute(t),s=t.rows;r.add(ev.eye(s,s).mul(n.lambda)),this.alpha=sv(r,e),this.inputs=t,this.kernelType=n.kernelType,this.kernelOptions=n.kernelOptions,this.kernel=i}}_predict(t){return this.kernel.compute([t],this.inputs).mmul(this.alpha).getRow(0)}toJSON(){return{name:"kernelRidgeRegression",alpha:this.alpha,inputs:this.inputs,kernelType:this.kernelType,kernelOptions:this.kernelOptions}}static load(t){if("kernelRidgeRegression"!==t.name)throw new TypeError("not a KRR model");return new Rv(!0,t)}}function Pv(t,e,n){const i=new Rv(t,e,n),r=new Array(this.size);for(let t=0;t<this.width;t++)for(let e=0;e<this.height;e++)r[e*this.width+t]=[t,e];const s=i.predict(r),o=R_.createFrom(this);for(let t=0;t<this.size;t++)o.data[t]=Math.min(this.maxValue,Math.max(0,s[t][0]));return o}function Tv(t={}){let{kernel:e=[[1,1,1],[1,1,1],[1,1,1]],iterations:n=1}=t;if(this.checkProcessable("dilate",{bitDepth:[1,8,16],components:1,alpha:0}),e.columns%2==0||e.rows%2==0)throw new TypeError("dilate: The number of rows and columns of the kernel must be odd");let i=!0;t:for(const t of e)for(const e of t)if(1!==e){i=!1;break t}let r=this;for(let t=0;t<n;t++)if(1===this.bitDepth)if(i){const t=r.clone();r=Lv(r,t,e.length,e[0].length)}else r=kv(r,R_.createFrom(r),e);else r=i?Av(r,R_.createFrom(r),e.length,e[0].length):Nv(r,R_.createFrom(r),e);return r}function Nv(t,e,n){const i=n.length,r=n[0].length;let s=(i-1)/2,o=(r-1)/2;for(let a=0;a<t.height;a++)for(let l=0;l<t.width;l++){let h=0;for(let e=0;e<r;e++)for(let r=0;r<i;r++){if(1!==n[r][e])continue;let i=r-s+l,u=e-o+a;if(i<0||u<0||i>=t.width||u>=t.height)continue;const c=t.getValueXY(i,u,0);c>h&&(h=c)}e.setValueXY(l,a,0,h)}return e}function Av(t,e,n,i){const r=(n-1)/2,s=(i-1)/2,o=[];for(let e=0;e<t.width;e++)o.push(0);for(let n=0;n<t.height;n++){for(let e=0;e<t.width;e++){let i=0;for(let r=Math.max(0,n-s);r<Math.min(t.height,n+s+1);r++){const n=t.getValueXY(e,r,0);n>i&&(i=n)}o[e]=i}for(let i=0;i<t.width;i++){let s=0;for(let e=Math.max(0,i-r);e<Math.min(t.width,i+r+1);e++)o[e]>s&&(s=o[e]);e.setValueXY(i,n,0,s)}}return e}function kv(t,e,n){const i=n.length,r=n[0].length;let s=(i-1)/2,o=(r-1)/2;for(let a=0;a<t.height;a++)for(let l=0;l<t.width;l++){let h=0;t:for(let e=0;e<r;e++)for(let r=0;r<i;r++){if(1!==n[r][e])continue;let i=r-s+l,u=e-o+a;if(!(u<0||i<0||i>=t.width||u>=t.height)&&1===t.getBitXY(i,u)){h=1;break t}}1===h&&e.setBitXY(l,a)}return e}function Lv(t,e,n,i){const r=(n-1)/2,s=(i-1)/2,o=[];for(let e=0;e<t.width;e++)o.push(1);for(let n=0;n<t.height;n++){for(let e=0;e<t.width;e++){o[e]=0;for(let i=Math.max(0,n-s);i<Math.min(t.height,n+s+1);i++)if(1===t.getBitXY(e,i)){o[e]=1;break}}for(let i=0;i<t.width;i++)if(1!==e.getBitXY(i,n))for(let s=Math.max(0,i-r);s<Math.min(t.width,i+r+1);s++)if(1===o[s]){e.setBitXY(i,n);break}}return e}function Ov(t={}){let{kernel:e=[[1,1,1],[1,1,1],[1,1,1]],iterations:n=1}=t;if(this.checkProcessable("erode",{bitDepth:[1,8,16],components:1,alpha:0}),e.columns%2==0||e.rows%2==0)throw new TypeError("erode: The number of rows and columns of the kernel must be odd");let i=!0;t:for(const t of e)for(const e of t)if(1!==e){i=!1;break t}let r=this;for(let t=0;t<n;t++)if(1===this.bitDepth)if(i){const t=r.clone();r=Gv(r,t,e.length,e[0].length)}else r=zv(r,R_.createFrom(r),e);else r=i?Fv(r,R_.createFrom(r),e.length,e[0].length):Dv(r,R_.createFrom(r),e);return r}function Dv(t,e,n){const i=n.length,r=n[0].length;let s=(i-1)/2,o=(r-1)/2;for(let a=0;a<t.height;a++)for(let l=0;l<t.width;l++){let h=t.maxValue;for(let e=0;e<r;e++)for(let r=0;r<i;r++){if(1!==n[r][e])continue;let i=r-s+l,u=e-o+a;if(i<0||u<0||i>=t.width||u>=t.height)continue;const c=t.getValueXY(i,u,0);c<h&&(h=c)}e.setValueXY(l,a,0,h)}return e}function Fv(t,e,n,i){const r=(n-1)/2,s=(i-1)/2,o=[];for(let e=0;e<t.width;e++)o.push(0);for(let n=0;n<t.height;n++){for(let e=0;e<t.width;e++){let i=t.maxValue;for(let r=Math.max(0,n-s);r<Math.min(t.height,n+s+1);r++){const n=t.getValueXY(e,r,0);n<i&&(i=n)}o[e]=i}for(let i=0;i<t.width;i++){let s=t.maxValue;for(let e=Math.max(0,i-r);e<Math.min(t.width,i+r+1);e++)o[e]<s&&(s=o[e]);e.setValueXY(i,n,0,s)}}return e}function zv(t,e,n){const i=n.length,r=n[0].length;let s=(i-1)/2,o=(r-1)/2;for(let a=0;a<t.height;a++)for(let l=0;l<t.width;l++){let h=1;t:for(let e=0;e<r;e++)for(let r=0;r<i;r++){if(1!==n[r][e])continue;let i=r-s+l,u=e-o+a;if(!(u<0||i<0||i>=t.width||u>=t.height)&&0===t.getBitXY(i,u)){h=0;break t}}1===h&&e.setBitXY(l,a)}return e}function Gv(t,e,n,i){const r=(n-1)/2,s=(i-1)/2,o=[];for(let e=0;e<t.width;e++)o.push(0);for(let n=0;n<t.height;n++){for(let e=0;e<t.width;e++){o[e]=1;for(let i=Math.max(0,n-s);i<Math.min(t.height,n+s+1);i++)if(0===t.getBitXY(e,i)){o[e]=0;break}}for(let i=0;i<t.width;i++)if(0!==e.getBitXY(i,n))for(let s=Math.max(0,i-r);s<Math.min(t.width,i+r+1);s++)if(0===o[s]){e.clearBitXY(i,n);break}}return e}function Bv(t={}){let{kernel:e=[[1,1,1],[1,1,1],[1,1,1]],iterations:n=1}=t;if(this.checkProcessable("open",{bitDepth:[8,16],components:1,alpha:0}),e.columns%2==0||e.rows%2==0)throw new TypeError("open: The number of rows and columns of the kernel must be odd");let i=this;for(let t=0;t<n;t++)i=i.erode({kernel:e}),i=i.dilate({kernel:e});return i}function Uv(t={}){let{kernel:e=[[1,1,1],[1,1,1],[1,1,1]],iterations:n=1}=t;if(this.checkProcessable("close",{bitDepth:[1,8,16],components:1,alpha:0}),e.columns%2==0||e.rows%2==0)throw new TypeError("close: The number of rows and columns of the kernel must be odd");let i=this;for(let t=0;t<n;t++)i=i.dilate({kernel:e}).erode({kernel:e});return i}function qv(t={}){let{kernel:e=[[1,1,1],[1,1,1],[1,1,1]],iterations:n=1}=t;if(this.checkProcessable("topHat",{bitDepth:[8,16],components:1,alpha:0}),e.length%2==0||e[0].length%2==0)throw new TypeError("topHat: The number of rows and columns of the kernel must be odd");let i=this;for(let t=0;t<n;t++){let t=i.open({kernel:e});i=t.subtractImage(i,{absolute:!0})}return i}function Vv(t={}){let{kernel:e=[[1,1,1],[1,1,1],[1,1,1]],iterations:n=1}=t;if(this.checkProcessable("blackHat",{bitDepth:[8,16],components:1,alpha:0}),e.columns%2==0||e.rows%2==0)throw new TypeError("blackHat: The number of rows and columns of the kernel must be odd");let i=this;for(let t=0;t<n;t++){const t=i.close({kernel:e});i=t.subtractImage(i,{absolute:!0})}return i}function Yv(t={}){let{kernel:e=[[1,1,1],[1,1,1],[1,1,1]],iterations:n=1}=t;if(this.checkProcessable("morphologicalGradient",{bitDepth:[8,16],components:1,alpha:0}),e.columns%2==0||e.rows%2==0)throw new TypeError("morphologicalGradient: The number of rows and columns of the kernel must be odd");let i=this;for(let t=0;t<n;t++){let t=i.dilate({kernel:e}),n=i.erode({kernel:e});i=t.subtractImage(n,{absolute:!0})}return i}function Xv(t,e){return Math.sqrt(Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2))}function jv(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function Wv(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Hv(t,e,n,i,r,s,o,a,l,h,u,c){let[f,d]=[(n*t+i*e+r)/(l*t+h*e+1),(s*t+o*e+a)/(l*t+h*e+1)];return u.getValueXY(Math.floor(f),Math.floor(d),c)}function $v(t,e={}){let{calculateRatio:n=!0}=e;if(4!==t.length)throw new Error(`The array pts must have four elements, which are the four corners. Currently, pts have ${t.length} elements`);let i,r,[s,o,a,l]=t,h=[s,o,a,l],[u,c,f,d]=function(t){let e=0,n=0,i=0,r=0,s=t[0][0],o=0;for(let e=1;e<t.length;e++)t[e][0]<s&&(s=t[e][0],o=e);let a=t[(o+1)%t.length][0],l=(o+1)%t.length;for(let e=1;e<t.length;e++)t[e][0]<a&&e!==o&&(a=t[e][0],l=e);return t[l][1]<t[o][1]?(e=t[l],r=t[o],o!==(l+1)%4?(n=t[(l+1)%4],i=t[(l+2)%4]):(n=t[(l+2)%4],i=t[(l+3)%4])):(r=t[l],e=t[o],l!==(o+1)%4?(n=t[(o+1)%4],i=t[(o+2)%4]):(n=t[(o+2)%4],i=t[(o+3)%4])),[e,n,i,r]}(h);n?[i,r]=function(t,e,n,i,r,s){let o=Math.max(Xv(t,e),Xv(i,n)),a=Math.max(Xv(t,i),Xv(e,n)),l=0,h=0,u=Math.ceil(r/2),c=Math.ceil(s/2),f=o/a,d=[t[0],t[1],1],g=[e[0],e[1],1],p=[i[0],i[1],1],m=[n[0],n[1],1],y=Wv(jv(d,m),p)/Wv(jv(g,m),p),v=Wv(jv(d,m),g)/Wv(jv(p,m),g),w=[y*g[0]-d[0],y*g[1]-d[1],y*g[2]-d[2]],x=[v*p[0]-d[0],v*p[1]-d[1],v*p[2]-d[2]],_=w[0],b=w[1],E=w[2],S=x[0],I=x[1],C=x[2],M=1/(E*C)*(_*S-(_*C+E*S)*u+E*C*u*u+(b*I-(b*C+E*I)*c+E*C*c*c));M=M>=0?Math.sqrt(M):Math.sqrt(-M);let R=new ev([[M,0,u],[0,M,c],[0,0,1]]),P=R.transpose(),T=rv(P),N=rv(R),A=ev.rowVector(w),k=ev.rowVector(x),L=Math.sqrt(Wv(A.mmul(T).mmul(N).to1DArray(),w)/Wv(k.mmul(T).mmul(N).to1DArray(),x));return 0===L||0===f?(l=Math.ceil(o),h=Math.ceil(a)):L<f?(l=Math.ceil(o),h=Math.ceil(l/L)):(h=Math.ceil(a),l=Math.ceil(L*h)),[l,h]}(u,c,f,d,this.width,this.height):(i=Math.ceil(Math.max(Xv(u,c),Xv(d,f))),r=Math.ceil(Math.max(Xv(u,d),Xv(c,f))));let g=R_.createFrom(this,{width:i,height:r}),[p,m]=u,[y,v]=c,[w,x]=f,[_,b]=d,[E,S]=[0,0],[I,C]=[0,i-1],[M,R]=[r-1,i-1],[P,T]=[r-1,0],N=new ev([[E,S,1,0,0,0,-E*p,-S*p],[I,C,1,0,0,0,-I*y,-C*y],[M,R,1,0,0,0,-M*w,-S*w],[P,T,1,0,0,0,-P*_,-T*_],[0,0,0,E,S,1,-E*m,-S*m],[0,0,0,I,C,1,-I*v,-C*v],[0,0,0,M,R,1,-M*x,-R*x],[0,0,0,P,T,1,-P*b,-T*b]]),A=ev.columnVector([p,y,w,_,m,v,x,b]),k=new iv(N).solve(A),[L,O,D,F,z,G,B,U]=k.to1DArray(),q=new ev(r,i);for(let t=0;t<this.channels;t++){for(let e=0;e<r;e++)for(let n=0;n<i;n++)q.set(e,n,Hv(e,n,L,O,D,F,z,G,B,U,this,t));g.setMatrix(q,{channel:t})}return g}function Zv(t={}){let{x:e=0,y:n=0,width:i=this.width-e,height:r=this.height-n}=t;if(this.checkProcessable("crop",{bitDepth:[1,8,16]}),e=Math.round(e),n=Math.round(n),i=Math.round(i),r=Math.round(r),e>this.width-1||n>this.height-1)throw new RangeError(`crop: origin (x:${e}, y:${n}) out of range (${this.width-1}; ${this.height-1})`);if(i<=0||r<=0)throw new RangeError(`crop: width and height (width:${i}; height:${r}) must be positive numbers`);if(e<0||n<0)throw new RangeError(`crop: x and y (x:${e}, y:${n}) must be positive numbers`);if(i>this.width-e||r>this.height-n)throw new RangeError(`crop: (x: ${e}, y:${n}, width:${i}, height:${r}) size is out of range`);let s=this;return s=1===this.bitDepth?function(t,e,n,i,r,s){let o=r*t.channels,a=i+s,l=0,h=n*t.channels;for(let n=i;n<a;n++){let i=n*t.width*t.channels+h,r=i+o;for(;i<r;i++)t.getBit(i)&&e.setBit(l),++l}return e}(this,new R_(i,r,{kind:"BINARY",parent:this}),e,n,i,r):function(t,e,n,i,r,s){let o=r*t.channels,a=i+s,l=0,h=n*t.channels;for(let n=i;n<a;n++){let i=n*t.width*t.channels+h,r=i+o;for(;i<r;i++)e.data[l++]=t.data[i]}return e}(this,R_.createFrom(this,{width:i,height:r,position:[e,n]}),e,n,i,r),s}function Kv(t={}){this.checkProcessable("cropAlpha",{alpha:1});const{threshold:e=this.maxValue}=t;let n=function(t,e,n){for(let i=0;i<t.width;i++)for(let r=0;r<t.height;r++)if(t.getValueXY(i,r,n)>=e)return i;return-1}(this,e,this.components);if(-1===n)throw new Error("Could not find new dimensions. Threshold may be too high.");let i=function(t,e,n,i){for(let r=0;r<t.height;r++)for(let s=i;s<t.width;s++)if(t.getValueXY(s,r,n)>=e)return r;return-1}(this,e,this.components,n),r=function(t,e,n,i){for(let r=t.height-1;r>=0;r--)for(let s=i;s<t.width;s++)if(t.getValueXY(s,r,n)>=e)return r;return-1}(this,e,this.components,n),s=function(t,e,n,i,r,s){for(let o=t.width-1;o>=i;o--)for(let i=r;i<=s;i++)if(t.getValueXY(o,i,n)>=e)return o;return-1}(this,e,this.components,n,i,r);return this.crop({x:n,y:i,width:s-n+1,height:r-i+1})}function Jv(t,e){if(e<0||e>=t.channels)throw new RangeError(`channel must be included between 0 and ${t.channels-1}. Current value: ${e}`)}const Qv={nearestneighbor:"nearestNeighbor",nearestneighbour:"nearestNeighbor",bilinear:"bilinear"};function tw(t){if("string"!=typeof t)throw new TypeError("interpolation must be a string");if(t=t.toLowerCase(),!Qv[t])throw new RangeError(`invalid interpolation algorithm: ${t}`);return Qv[t]}function ew(t,e,n){const i=this.width/e,r=this.height/n;if(this.bitDepth>1)for(let s=0;s<e;s++){const e=Math.floor((s+.5)*i);for(let i=0;i<n;i++){const n=Math.floor((i+.5)*r);for(let r=0;r<this.channels;r++)t.setValueXY(s,i,r,this.getValueXY(e,n,r))}}else for(let s=0;s<e;s++){const e=Math.floor((s+.5)*i);for(let i=0;i<n;i++){const n=Math.floor((i+.5)*r);this.getBitXY(e,n)&&t.setBitXY(s,i)}}}function nw(t={}){const{factor:e=1,interpolation:n=Qv.nearestneighbor,preserveAspectRatio:i=!0}=t,r=tw(n);let s=t.width,o=t.height;if(s||(s=o&&i?Math.round(o*(this.width/this.height)):this.width),o||(o=i?Math.round(s*(this.height/this.width)):this.height),({width:s,height:o}=function(t,e,n){t=function(t){if("string"==typeof t){const e=t[t.length-1];t=parseFloat(t),"%"===e&&(t/=100)}return t}(t);let i=Math.round(t*e),r=Math.round(t*n);return i<=0&&(i=1),r<=0&&(r=1),{width:i,height:r}}(e,s,o)),s===this.width&&o===this.height){const t=this.clone();return t.position=[0,0],t}let a=Math.round((this.width-s)/2),l=Math.round((this.height-o)/2);const h=R_.createFrom(this,{width:s,height:o,position:[a,l]});if(r!==Qv.nearestneighbor)throw new Error(`unsupported resize interpolation: ${r}`);return ew.call(this,h,s,o),h}function iw(){this.checkProcessable("hsv",{bitDepth:[8,16],alpha:[0,1],colorModel:[Am]});let t=R_.createFrom(this,{colorModel:Lm}),e=0,n=this.data;for(let i=0;i<n.length;i+=this.channels){let r=n[i],s=n[i+1],o=n[i+2],a=Math.min(r,s,o),l=Math.max(r,s,o),h=l-a,u=0,c=0===l?0:h/l,f=l;if(l!==a){switch(l){case r:u=(s-o)/h+(s<o?6:0);break;case s:u=(o-r)/h+2;break;case o:u=(r-s)/h+4;break;default:throw new Error("unreachable")}u/=6}t.data[e++]=u*this.maxValue,t.data[e++]=c*this.maxValue,t.data[e++]=f,this.alpha&&(t.data[e++]=n[i+3])}return t}function rw(){this.checkProcessable("hsl",{bitDepth:[8,16],alpha:[0,1],colorModel:[Am]});let t=R_.createFrom(this,{colorModel:km}),e=Math.floor(this.maxValue/2),n=0,i=this.data;for(let r=0;r<i.length;r+=this.channels){let s=i[r],o=i[r+1],a=i[r+2],l=Math.max(s,o,a),h=Math.min(s,o,a),u=0,c=0,f=(l+h)/2;if(l!==h){let t=l-h;switch(c=f>e?t/(2-l-h):t/(l+h),l){case s:u=(o-a)/t+(o<a?6:0);break;case o:u=(a-s)/t+2;break;case a:u=(s-o)/t+4;break;default:throw new Error("unreachable")}u/=6}t.data[n++]=u*this.maxValue,t.data[n++]=c*this.maxValue,t.data[n++]=f,this.alpha&&(t.data[n++]=i[r+3])}return t}function sw(){this.checkProcessable("cmyk",{bitDepth:[8,16],alpha:[0,1],colorModel:[Am]});let t=R_.createFrom(this,{components:4,colorModel:Om}),e=0,n=this.data;for(let i=0;i<n.length;i+=this.channels){let r=n[i],s=n[i+1],o=n[i+2],a=Math.min(this.maxValue-r,this.maxValue-s,this.maxValue-o),l=(this.maxValue-r-a)/(1-a/this.maxValue),h=(this.maxValue-s-a)/(1-a/this.maxValue),u=(this.maxValue-o-a)/(1-a/this.maxValue);t.data[e++]=Math.round(l),t.data[e++]=Math.round(h),t.data[e++]=Math.round(u),t.data[e++]=Math.round(a),this.alpha&&(t.data[e++]=n[i+3])}return t}function ow(){return new R_(this.width,this.height,this.getRGBAData(),{kind:"RGBA",parent:this})}const aw={luma709:(t,e,n)=>6966*t+23436*e+2366*n>>15,luma601:(t,e,n)=>9798*t+19235*e+3735*n>>15,maximum:(t,e,n)=>Math.max(t,e,n),minimum:(t,e,n)=>Math.min(t,e,n),average:(t,e,n)=>(t+e+n)/3>>0,minmax:(t,e,n)=>(Math.max(t,e,n)+Math.min(t,e,n))/2,red:t=>t,green:(t,e)=>e,blue:(t,e,n)=>n,cyan(t,e,n,i){let r=aw.black(t,e,n,i);return(i.maxValue-t-r)/(1-r/i.maxValue)>>0},magenta(t,e,n,i){let r=aw.black(t,e,n,i);return(i.maxValue-e-r)/(1-r/i.maxValue)>>0},yellow(t,e,n,i){let r=aw.black(t,e,n,i);return(i.maxValue-n-r)/(1-r/i.maxValue)>>0},black:(t,e,n,i)=>Math.min(i.maxValue-t,i.maxValue-e,i.maxValue-n),hue(t,e,n,i){let r=aw.min(t,e,n),s=aw.max(t,e,n);if(s===r)return 0;let o=0,a=s-r;switch(s){case t:o=(e-n)/a+(e<n?6:0);break;case e:o=(n-t)/a+2;break;case n:o=(t-e)/a+4;break;default:throw new Error("unreachable")}return o/6*i.maxValue>>0},saturation(t,e,n,i){let r=aw.min(t,e,n),s=aw.max(t,e,n);return 0===s?0:(s-r)/s*i.maxValue},lightness(t,e,n){let i=aw.min(t,e,n);return(aw.max(t,e,n)+i)/2}};Object.defineProperty(aw,"luminosity",{enumerable:!1,value:aw.lightness}),Object.defineProperty(aw,"luminance",{enumerable:!1,value:aw.lightness}),Object.defineProperty(aw,"min",{enumerable:!1,value:aw.minimum}),Object.defineProperty(aw,"max",{enumerable:!1,value:aw.maximum}),Object.defineProperty(aw,"brightness",{enumerable:!1,value:aw.maximum});const lw={};function hw(t={}){let{algorithm:e="luma709",keepAlpha:n=!1,mergeAlpha:i=!0}=t;if("string"!=typeof e&&"function"!=typeof e)throw new TypeError("algorithm must be a string or a function");this.checkProcessable("grey",{bitDepth:[8,16],alpha:[0,1]}),1===this.components&&(e="red"),n&=this.alpha,i&=this.alpha,n&&(i=!1);let r,s=Ny(this,t,{components:1,alpha:n,colorModel:Nm});if("function"==typeof e)r=e;else if(r=aw[e.toLowerCase()],!r)throw new Error(`unsupported grey algorithm: ${e}`);let o=0;for(let t=0;t<this.data.length;t+=this.channels)i?s.data[o++]=Ky(r(this.data[t],this.data[t+1],this.data[t+2],this)*this.data[t+this.components]/this.maxValue,this):(s.data[o++]=Ky(r(this.data[t],this.data[t+1],this.data[t+2],this),this),s.alpha&&(s.data[o++]=this.data[t+this.components]));return s}function uw(t){let e=!1,n=0;for(let e=1;e<t.length-1;e++)if(t[e-1]<t[e]&&t[e+1]<t[e]&&(n++,n>2))return!1;return 2===n&&(e=!0),e}function cw(t,e){let n=0;for(let i=0;i<=e;i++)n+=t[i];return n}function fw(t,e){let n=0;for(let i=0;i<=e;i++)n+=i*t[i];return n}function dw(t,e){let n=0;for(let i=0;i<=e;i++)n+=i*i*t[i];return n}function gw(t){let e=new Array(t.length);for(let n=1;n<t.length-1;n++)e[n]=(t[n-1]+t[n]+t[n+1])/3;return e[0]=(t[0]+t[1])/3,e[t.length-1]=(t[t.length-2]+t[t.length-1])/3,e}function pw(t){let e=t.length,n=!1,i=0;for(let n=1;n<e-1;n++)if(t[n-1]<t[n]&&t[n+1]<t[n]&&(i++,i>2))return!1;return 2===i&&(n=!0),n}function mw(t,e){let n=0;for(let i=0;i<=e;i++)n+=t[i];return n}Object.keys(aw).forEach((t=>{lw[t]=t}));const yw={huang:function(t){let e=0;for(let n=0;n<t.length;n++)if(0!==t[n]){e=n;break}let n=t.length-1;for(let i=t.length-1;i>=e;i--)if(0!==t[i]){n=i;break}let i=1/(n-e),r=new Array(t.length),s=0,o=0;for(let n=e;n<t.length;n++)s+=n*t[n],o+=t[n],r[n]=s/o;let a=new Array(t.length);s=o=0;for(let e=n;e>0;e--)s+=e*t[e],o+=t[e],a[e-1]=s/o;let l=-1,h=Number.MAX_VALUE;for(let e=0;e<t.length;e++){let n,s=0;for(let o=0;o<=e;o++)n=1/(1+i*Math.abs(o-r[e])),n<1e-6||n>.999999||(s+=t[o]*(-n*Math.log(n)-(1-n)*Math.log(1-n)));for(let r=e+1;r<t.length;r++)n=1/(1+i*Math.abs(r-a[e])),n<1e-6||n>.999999||(s+=t[r]*(-n*Math.log(n)-(1-n)*Math.log(1-n)));s<h&&(h=s,l=e)}return l},intermodes:function(t){let e=t.slice(),n=0;for(;!uw(e);){let i=0,r=0,s=e[0];for(let n=0;n<t.length-1;n++)i=r,r=s,s=e[n+1],e[n]=(i+r+s)/3;if(e[t.length-1]=(r+s)/3,n++,n>1e4)throw new Error("Intermodes Threshold not found after 10000 iterations")}let i=0;for(let n=1;n<t.length-1;n++)e[n-1]<e[n]&&e[n+1]<e[n]&&(i+=n);return Math.floor(i/2)},isodata:function(t){let e,n,i,r,s=0;for(let e=1;e<t.length;e++)if(t[e]>0){s=e+1;break}for(;;){e=0,i=0;for(let n=0;n<s;n++)i+=t[n],e+=t[n]*n;r=0,n=0;for(let e=s+1;e<t.length;e++)n+=t[e],r+=t[e]*e;if(i>0&&n>0&&(e/=i,r/=n,s===Math.round((e+r)/2)))break;if(s++,s>t.length-2)throw new Error("Threshold not found")}return s},li:function(t,e){let n,i,r,s,o,a,l,h,u,c,f,d;f=.5,c=0;for(let e=0;e<t.length;e++)c+=e*t[e];c/=e,l=c;do{a=l,n=a+.5|0,i=0,s=0;for(let e=0;e<=n;e++)i+=e*t[e],s+=t[e];h=0===s?0:i/s,r=0,o=0;for(let e=n+1;e<t.length;e++)r+=e*t[e],o+=t[e];u=0===o?0:r/o,d=(h-u)/(Math.log(h)-Math.log(u)),l=d<-Number.EPSILON?d-.5|0:d+.5|0}while(Math.abs(l-a)>.5);return n},maxentropy:function(t,e){let n=new Array(t.length);for(let i=0;i<t.length;i++)n[i]=t[i]/e;let i=new Array(t.length),r=new Array(t.length);i[0]=n[0],r[0]=1-i[0];for(let e=1;e<t.length;e++)i[e]=i[e-1]+n[e],r[e]=1-i[e];let s=0;for(let e=0;e<t.length;e++)if(Math.abs(i[e])>=Number.EPSILON){s=e;break}let o=t.length-1;for(let e=t.length-1;e>=s;e--)if(Math.abs(r[e])>=Number.EPSILON){o=e;break}let a,l,h,u=-1,c=Number.MIN_VALUE;for(let e=s;e<=o;e++){l=0;for(let r=0;r<=e;r++)0!==t[r]&&(l-=n[r]/i[e]*Math.log(n[r]/i[e]));h=0;for(let i=e+1;i<t.length;i++)0!==t[i]&&(h-=n[i]/r[e]*Math.log(n[i]/r[e]));a=l+h,c<a&&(c=a,u=e)}return u},mean:function(t,e){let n=0;for(let e=0;e<t.length;e++)n+=e*t[e];return Math.floor(n/e)},minerror:function(t,e){let n,i,r,s,o,a,l,h,u,c,f,d,g=-2,p=0;for(let e=0;e<t.length;e++)p+=e*t[e];for(p/=e,n=p;n!==g;){let e=cw(t,n),p=cw(t,t.length-1),m=fw(t,n),y=fw(t,t.length-1),v=dw(t,n);if(i=m/e,r=(y-m)/(p-e),s=e/p,o=(p-e)/p,a=v/e-i*i,l=(dw(t,t.length-1)-v)/(p-e)-r*r,h=1/a-1/l,u=i/a-r/l,c=i*i/a-r*r/l+Math.log10(a*(o*o)/(l*(s*s))),f=u*u-h*c,f<0)return n;g=n,d=(u+Math.sqrt(f))/h,n=isNaN(d)?g:Math.floor(d)}return n},minimum:function(t){if(t.length<2)return 0;let e=0,n=-1,i=-1,r=new Array(t.length);for(let e=0;e<t.length;e++)r[e]=t[e],t[e]>0&&(i=e);for(;!pw(r);)if(r=gw(r),e++,e>1e4)return n;return n=function(t,e){let n;for(let i=1;i<e;i++)if(t[i-1]>t[i]&&t[i+1]>=t[i]){n=i;break}return n}(r,i),n},moments:function(t,e){let n,i,r,s,o,a,l=0,h=0,u=0,c=0,f=-1,d=t.length,g=new Array(d);for(let n=0;n<d;n++)g[n]=t[n]/e;for(let t=0;t<d;t++)l+=t*g[t],h+=t*t*g[t],u+=t*t*t*g[t];i=1*h-l*l,r=(-h*h+l*u)/i,s=(1*-u+h*l)/i,o=.5*(-s-Math.sqrt(s*s-4*r)),a=.5*(-s+Math.sqrt(s*s-4*r)),n=(a-l)/(a-o);for(let t=0;t<d;t++)if(c+=g[t],c>n){f=t;break}return f},otsu:function(t,e){let n=0,i=0,r=0,s=0,o=0;for(let e=0;e<t.length;e++)o+=e*t[e];for(let a=0;a<t.length;a++){i+=t[a];const l=e-i;if(0===i||0===l)continue;n+=a*t[a];const h=(o-n)/l,u=i*l*(n/i-h)*(n/i-h);u>=r&&(s=a,r=u)}return s},percentile:function(t){let e=-1,n=new Array(t.length),i=mw(t,t.length-1),r=1;for(let s=0;s<t.length;s++)n[s]=Math.abs(mw(t,s)/i-.5),n[s]<r&&(r=n[s],e=s);return e},renyientropy:function(t,e){let n,i,r,s=new Array(t.length),o=new Array(t.length),a=new Array(t.length),l=0,h=0,u=0,c=0,f=0,d=0;for(let n=0;n<t.length;n++)s[n]=t[n]/e;o[0]=s[0],a[0]=1-o[0];for(let e=1;e<t.length;e++)o[e]=o[e-1]+s[e],a[e]=1-o[e];i=0;for(let e=0;e<t.length;e++)if(Math.abs(o[e])>=Number.EPSILON){i=e;break}r=t.length-1;for(let e=t.length-1;e>=i;e--)if(Math.abs(a[e])>=Number.EPSILON){r=e;break}for(let e=i;e<=r;e++){let n=0,i=0,r=0;for(let a=0;a<=e;a++)0!==t[a]&&(n-=s[a]/o[e]*Math.log(s[a]/o[e])),i+=Math.sqrt(s[a]/o[e]),r+=s[a]*s[a]/(o[e]*o[e]);let g=0,p=0,m=0;for(let n=e+1;n<t.length;n++)0!==t[n]&&(g-=s[n]/a[e]*Math.log(s[n]/a[e])),p+=Math.sqrt(s[n]/a[e]),m+=s[n]*s[n]/(a[e]*a[e]);let y=n+g,v=2*(i*p>0?Math.log(i*p):0),w=-1*(r*m>0?Math.log(r*m):0);y>c&&(c=y,l=e),v>f&&(f=v,h=e),w>d&&(d=w,u=e)}let g,p=[l,h,u];p.sort(((t,e)=>t-e)),g=Math.abs(p[0]-p[1])<=5?Math.abs(p[1]-p[2])<=5?[1,2,1]:[0,1,3]:Math.abs(p[1]-p[2])<=5?[3,1,0]:[1,2,1];let m=o[p[2]]-o[p[0]];return n=Math.round(p[0]*(o[p[0]]+.25*m*g[0])+.25*p[1]*m*g[1]+p[2]*(a[p[2]]+.25*m*g[2])),n},shanbhag:function(t,e){let n=new Array(t.length);for(let i=0;i<t.length;i++)n[i]=t[i]/e;let i=new Array(t.length),r=new Array(t.length);i[0]=n[0],r[0]=1-i[0];for(let e=1;e<t.length;e++)i[e]=i[e-1]+n[e],r[e]=1-i[e];let s=0;for(let e=0;e<t.length;e++)if(Math.abs(i[e])>=Number.EPSILON){s=e;break}let o=t.length-1;for(let e=t.length-1;e>=s;e--)if(Math.abs(r[e])>=Number.EPSILON){o=e;break}let a,l,h,u,c=-1,f=Number.MAX_VALUE;for(let e=s;e<=o;e++){h=0,a=.5/i[e];for(let t=1;t<=e;t++)h-=n[t]*Math.log(1-a*i[t-1]);h*=a,u=0,a=.5/r[e];for(let i=e+1;i<t.length;i++)u-=n[i]*Math.log(1-a*r[i]);u*=a,l=Math.abs(h-u),l<f&&(f=l,c=e)}return c},triangle:function(t){let e=0,n=0,i=0,r=0;for(let n=0;n<t.length;n++)if(t[n]>0){e=n;break}e>0&&e--;for(let e=t.length-1;e>0;e--)if(t[e]>0){r=e;break}r<t.length-1&&r++;for(let e=0;e<t.length;e++)t[e]>n&&(i=e,n=t[e]);let s,o,a,l=!1;if(i-e<r-i){l=!0;let n=0,s=t.length-1;for(;n<s;){let e=t[n];t[n]=t[s],t[s]=e,n++,s--}e=t.length-1-r,i=t.length-1-i}if(e===i)return e;s=t[i],o=e-i,a=Math.sqrt(s*s+o*o),s/=a,o/=a,a=s*e+o*t[e];let h=e,u=0;for(let n=e+1;n<=i;n++){let e=s*n+o*t[n]-a;e>u&&(h=n,u=e)}if(h--,l){let e=0,n=t.length-1;for(;e<n;){let i=t[e];t[e]=t[n],t[n]=i,e++,n--}return t.length-1-h}return h},yen:function(t,e){let n=new Array(t.length);for(let i=0;i<t.length;i++)n[i]=t[i]/e;let i=new Array(t.length);i[0]=n[0];for(let e=1;e<t.length;e++)i[e]=i[e-1]+n[e];let r=new Array(t.length);r[0]=n[0]*n[0];for(let e=1;e<t.length;e++)r[e]=r[e-1]+n[e]*n[e];let s=new Array(t.length);s[t.length-1]=0;for(let e=t.length-2;e>=0;e--)s[e]=s[e+1]+n[e+1]*n[e+1];let o,a=-1,l=Number.MIN_VALUE;for(let e=0;e<t.length;e++)o=-1*(r[e]*s[e]>0?Math.log(r[e]*s[e]):0)+2*(i[e]*(1-i[e])>0?Math.log(i[e]*(1-i[e])):0),o>l&&(l=o,a=e);return a}},vw={};function ww(t={}){let{algorithm:e=vw.otsu}=t;this.checkProcessable("getThreshold",{components:1,bitDepth:[8,16]});let n=yw[e.toLowerCase()];if(n)return n(this.getHistogram(),this.size);throw new Error(`unknown thresholding algorithm: ${e}`)}Object.keys(yw).forEach((t=>{vw[t]=t}));const xw="threshold";function _w(t={}){let{algorithm:e=xw,threshold:n=.5,useAlpha:i=!0,invert:r=!1}=t;this.checkProcessable("mask",{components:1,bitDepth:[8,16]}),n=e===xw?function(t,e){if(!e)throw Error("getThreshold : the maxValue should be specified");if("string"==typeof t){if("%"!==t[t.length-1])throw Error("getThreshold : if the value is a string it must finish by %");return parseFloat(t)/100*e}if("number"==typeof t)return t<1?t*e:t;throw Error("getThreshold : the value is not valid")}(n,this.maxValue):ww.call(this,t);let s=new R_(this.width,this.height,{kind:"BINARY",parent:this}),o=0;if(this.alpha&&i)for(let t=0;t<this.data.length;t+=this.channels){let e=this.data[t]+(this.maxValue-this.data[t])*(this.maxValue-this.data[t+1])/this.maxValue;(r&&e<=n||!r&&e>=n)&&s.setBit(o),o++}else for(let t=0;t<this.data.length;t+=this.channels)(r&&this.data[t]<=n||!r&&this.data[t]>=n)&&s.setBit(o),o++;return s}function bw(t={}){let{size:e=0,algorithm:n="copy",color:i}=t;if(this.checkProcessable("pad",{bitDepth:[8,16]}),"set"===n){if(i.length!==this.channels)throw new Error(`pad: the color array must have the same length as the number of channels. Here: ${this.channels}`);for(let t=0;t<i.length;t++)0===i[t]&&(i[t]=.001)}else i=fv()(this.channels,null);Array.isArray(e)||(e=[e,e]);let r=this.width+2*e[0],s=this.height+2*e[1],o=this.channels,a=R_.createFrom(this,{width:r,height:s});!function(t,e,n,i){let r=t.width,s=t.height,o=e.width,a=t.channels;for(let l=0;l<r;l++)for(let h=0;h<s;h++)for(let s=0;s<a;s++){let u=(h*r+l)*a+s,c=((i+h)*o+n+l)*a+s;e.data[c]=t.data[u]}}(this,a,e[0],e[1]);for(let t=e[0];t<r-e[0];t++)for(let n=0;n<o;n++){let l=i[n]||a.data[(e[1]*r+t)*o+n];for(let i=0;i<e[1];i++)a.data[(i*r+t)*o+n]=l;l=i[n]||a.data[((s-e[1]-1)*r+t)*o+n];for(let i=s-e[1];i<s;i++)a.data[(i*r+t)*o+n]=l}for(let t=0;t<s;t++)for(let n=0;n<o;n++){let s=i[n]||a.data[(t*r+e[0])*o+n];for(let i=0;i<e[0];i++)a.data[(t*r+i)*o+n]=s;s=i[n]||a.data[(t*r+r-e[0]-1)*o+n];for(let i=r-e[0];i<r;i++)a.data[(t*r+i)*o+n]=s}return a}function Ew(t=8){if(this.checkProcessable("colorDepth",{bitDepth:[1,8,16]}),![8,16].includes(t))throw Error("You need to specify the new colorDepth as 8 or 16");if(this.bitDepth===t)return this.clone();let e=R_.createFrom(this,{bitDepth:t});switch(t){case 8:if(1===this.bitDepth)for(let t=0;t<this.size;t++)this.getBit(t)&&(e.data[t]=255);else for(let t=0;t<this.data.length;t++)e.data[t]=this.data[t]>>8;break;case 16:if(1===this.bitDepth)for(let t=0;t<this.size;t++)this.getBit(t)&&(e.data[t]=65535);else for(let t=0;t<this.data.length;t++)e.data[t]=this.data[t]<<8|this.data[t];break;default:throw new Error("colorDepth conversion unexpected case")}return e}function Sw(t,e={}){const{interpolation:n=Qv.nearestneighbor,width:i=this.width,height:r=this.height}=e;if("number"!=typeof t)throw new TypeError("degrees must be a number");const s=tw(n),o=t*Math.PI/180,a=Math.floor(Math.abs(i*Math.cos(o))+Math.abs(r*Math.sin(o))),l=Math.floor(Math.abs(r*Math.cos(o))+Math.abs(i*Math.sin(o))),h=Math.cos(-o),u=Math.sin(-o);let c=a/2,f=l/2;a%2==0?(c-=.5,l%2==0?f-=.5:f=Math.floor(f)):(c=Math.floor(c),l%2==0?f-=.5:f=Math.floor(f));const d=Math.floor(i/2-c),g=Math.floor(r/2-f);if(1===this.bitDepth){const t=new R_(a,l,{kind:"BINARY",parent:this});switch(s){case Qv.nearestneighbor:return function(t,e,n,i,r,s,o,a){for(let l=0;l<e.width;l+=1)for(let h=0;h<e.height;h+=1){let u=Math.round((l-r)*o-(h-s)*a+r)+n,c=Math.round((h-s)*o+(l-r)*a+s)+i;(u<0||u>=t.width||c<0||c>=t.height||t.getBitXY(u,c))&&e.setBitXY(l,h)}return e}(this,t,d,g,c,f,h,u);case Qv.bilinear:return function(t,e,n,i,r,s,o,a){let l=t.width;for(let h=0;h<e.height;h++)for(let u=0;u<e.width;u++){let c=(u-r)*o-(h-s)*a+r+n,f=(h-s)*o+(u-r)*a+s+i,d=0|c,g=0|f,p=c-d,m=f-g;if(c<0||c>=t.width||f<0||f>=t.height)e.setBitXY(u,h);else{let n=g*t.width+d,i=t.getBit(n),r=t.getBit(n+1),s=t.getBit(n+l);(i|p&r-i|m&s-i|p&m&i-r-s+t.getBit(n+1+l))>0&&e.setBitXY(u,h)}}return e}(this,t,d,g,c,f,h,u);default:throw new Error(`unsupported rotate interpolation: ${s}`)}}else{const t=R_.createFrom(this,{width:a,height:l});switch(s){case Qv.nearestneighbor:return function(t,e,n,i,r,s,o,a){for(let l=0;l<e.width;l+=1)for(let h=0;h<e.height;h+=1)for(let u=0;u<t.channels;u++){let c=Math.round((l-r)*o-(h-s)*a+r)+n,f=Math.round((h-s)*o+(l-r)*a+s)+i;c<0||c>=t.width||f<0||f>=t.height?1===t.alpha&&u===t.channels-1?e.setValueXY(l,h,u,0):e.setValueXY(l,h,u,t.maxValue):e.setValueXY(l,h,u,t.getValueXY(c,f,u))}return e}(this,t,d,g,c,f,h,u);case Qv.bilinear:return function(t,e,n,i,r,s,o,a){let l=t.width*t.channels;for(let h=0;h<e.height;h++)for(let u=0;u<e.width;u++){let c=(u-r)*o-(h-s)*a+r+n,f=(h-s)*o+(u-r)*a+s+i,d=0|c,g=0|f,p=c-d,m=f-g;for(let n=0;n<t.channels;n++)if(c<0||c>=t.width||f<0||f>=t.height)1===t.alpha&&n===t.channels-1?e.setValueXY(u,h,n,0):e.setValueXY(u,h,n,t.maxValue);else{let i=(g*t.width+d)*t.channels+n,r=t.data[i],s=t.data[i+t.channels],o=t.data[i+l],a=r+p*(s-r)+m*(o-r)+p*m*(r-s-o+t.data[i+l+t.channels])|0;e.setValueXY(u,h,n,a)}}return e}(this,t,d,g,c,f,h,u);default:throw new Error(`unsupported rotate interpolation: ${s}`)}}}function Iw(t,e){if(this.checkProcessable("rotate",{bitDepth:[1,8,16]}),"number"!=typeof t)throw new TypeError("angle must be a number");switch(t<0&&(t=360*Math.ceil(-t/360)+t),t%360){case 0:return this.clone();case 90:return Mw.call(this);case 180:return Rw.call(this);case 270:return Cw.call(this);default:return Sw.call(this,t,e)}}function Cw(){if(1===this.bitDepth){const t=new R_(this.height,this.width,{kind:"BINARY",parent:this}),e=t.height-1;for(let n=0;n<this.height;n++)for(let i=0;i<this.width;i++)this.getBitXY(i,n)&&t.setBitXY(n,e-i);return t}{const t=R_.createFrom(this,{width:this.height,height:this.width}),e=t.height-1;for(let n=0;n<this.height;n++)for(let i=0;i<this.width;i++)for(let r=0;r<this.channels;r++)t.setValueXY(n,e-i,r,this.getValueXY(i,n,r));return t}}function Mw(){if(1===this.bitDepth){const t=new R_(this.height,this.width,{kind:"BINARY",parent:this}),e=t.width-1;for(let n=0;n<this.height;n++)for(let i=0;i<this.width;i++)this.getBitXY(i,n)&&t.setBitXY(e-n,i);return t}{const t=R_.createFrom(this,{width:this.height,height:this.width}),e=t.width-1;for(let n=0;n<this.height;n++)for(let i=0;i<this.width;i++)for(let r=0;r<this.channels;r++)t.setValueXY(e-n,i,r,this.getValueXY(i,n,r));return t}}function Rw(){if(1===this.bitDepth){const t=new R_(this.width,this.height,{kind:"BINARY",parent:this}),e=t.width-1,n=t.height-1;for(let i=0;i<this.height;i++)for(let r=0;r<this.width;r++)this.getBitXY(r,i)&&t.setBitXY(e-r,n-i);return t}{const t=R_.createFrom(this),e=t.width-1,n=t.height-1;for(let i=0;i<this.height;i++)for(let r=0;r<this.width;r++)for(let s=0;s<this.channels;s++)t.setValueXY(e-r,n-i,s,this.getValueXY(r,i,s));return t}}function Pw(t,e={}){const n=Ty(t);this.checkProcessable("insert",n);let{x:i=0,y:r=0}=e;const s=Ay(this,e,{copy:!0}),o=Math.min(s.height,r+t.height),a=Math.min(s.width,i+t.width);if(1===s.bitDepth)for(let e=r;e<o;e++)for(let n=i;n<a;n++)t.getBitXY(n-i,e-r)?s.setBitXY(n,e):s.clearBitXY(n,e);else for(let e=r;e<o;e++)for(let n=i;n<a;n++)s.setPixelXY(n,e,t.getPixelXY(n-i,e-r));return s}function Tw(t={}){let{size:e=0,algorithm:n="copy",color:i}=t;if(this.checkProcessable("setBorder",{bitDepth:[8,16,32,64]}),"set"===n){if(i.length!==this.channels)throw new Error(`setBorder: the color array must have the same length as the number of channels. Here: ${this.channels}`);for(let t=0;t<i.length;t++)0===i[t]&&(i[t]=.001)}else i=fv()(this.channels,null);Array.isArray(e)||(e=[e,e]);let r=e[0],s=e[1],o=this.channels;for(let t=r;t<this.width-r;t++)for(let e=0;e<o;e++){let n=i[e]||this.data[(t+this.width*s)*o+e];for(let i=0;i<s;i++)this.data[(i*this.width+t)*o+e]=n;n=i[e]||this.data[(t+this.width*(this.height-s-1))*o+e];for(let i=this.height-s;i<this.height;i++)this.data[(i*this.width+t)*o+e]=n}for(let t=0;t<this.height;t++)for(let e=0;e<o;e++){let n=i[e]||this.data[(t*this.width+r)*o+e];for(let i=0;i<r;i++)this.data[(t*this.width+i)*o+e]=n;n=i[e]||this.data[(t*this.width+this.width-r-1)*o+e];for(let i=this.width-r;i<this.width;i++)this.data[(t*this.width+i)*o+e]=n}return this}function Nw(t={}){let{preserveAlpha:e=!0}=t;if(this.checkProcessable("split",{bitDepth:[8,16]}),1===this.components)return new Ey([this.clone()]);let n=new Ey,i=this.data;if(this.alpha&&e)for(let t=0;t<this.components;t++){let e=R_.createFrom(this,{components:1,alpha:!0,colorModel:Nm}),r=0;for(let n=0;n<i.length;n+=this.channels)e.data[r++]=i[n+t],e.data[r++]=i[n+this.components];n.push(e)}else for(let t=0;t<this.channels;t++){let e=R_.createFrom(this,{components:1,alpha:!1,colorModel:Nm}),r=0;for(let n=0;n<i.length;n+=this.channels)e.data[r++]=i[n+t];n.push(e)}return n}function Aw(t,e={}){let{keepAlpha:n=!1,mergeAlpha:i=!1}=e;n&=this.alpha,i&=this.alpha,this.checkProcessable("getChannel",{bitDepth:[8,16]}),t=Uy(this,t);let r=R_.createFrom(this,{components:1,alpha:n,colorModel:Nm}),s=0;for(let e=0;e<this.data.length;e+=this.channels)i?r.data[s++]=this.data[e+t]*this.data[e+this.components]/this.maxValue:(r.data[s++]=this.data[e+t],n&&(r.data[s++]=this.data[e+this.components]));return r}function kw(t=Lw,e={}){let{mergeAlpha:n=!1,keepAlpha:i=!1}=e;n&=this.alpha,i&=this.alpha,this.checkProcessable("combineChannels",{bitDepth:[8,16]});let r=R_.createFrom(this,{components:1,alpha:i,colorModel:Nm}),s=0;for(let e=0;e<this.size;e++){let o=t(this.getPixel(e));n?r.data[s++]=o*this.data[e*this.channels+this.components]/this.maxValue:(r.data[s++]=o,i&&(r.data[s++]=this.data[e*this.channels+this.components]))}return r}function Lw(t){return(t[0]+t[1]+t[2])/3}function Ow(t,e){if(this.checkProcessable("setChannel",{bitDepth:[8,16]}),e.checkProcessable("setChannel (image parameter check)",{bitDepth:[this.bitDepth],alpha:[0],components:[1]}),e.width!==this.width||e.height!==this.height)throw new Error("Images must have exactly the same width and height");let n=t=Uy(this,t);for(let t=0;t<e.data.length;t++)this.data[n]=e.data[t],n+=this.channels;return this}function Dw(t,e={}){let{shift:n=[0,0],average:i,channels:r,defaultAlpha:s,normalize:o,border:a=[0,0]}=e;if(this.checkProcessable("getSimilarity",{bitDepth:[8,16]}),Array.isArray(a)||(a=[a,a]),r=By(this,{channels:r,defaultAlpha:s}),this.bitDepth!==t.bitDepth)throw new Error("Both images must have the same bitDepth");if(this.channels!==t.channels)throw new Error("Both images must have the same number of channels");if(this.colorModel!==t.colorModel)throw new Error("Both images must have the same colorModel");void 0===i&&(i=!0);let l=Math.max(a[0],-n[0]),h=Math.min(this.width-a[0],this.width-n[0]),u=Math.max(a[1],-n[1]),c=Math.min(this.height-a[1],this.height-n[1]),f=fv()(r.length,0);for(let e=0;e<r.length;e++){let i=r[e],s=o?this.sum[i]:Math.max(this.sum[i],t.sum[i]),a=o?t.sum[i]:Math.max(this.sum[i],t.sum[i]);if(0!==s&&0!==a)for(let r=l;r<h;r++)for(let o=u;o<c;o++){let l=r*this.multiplierX+o*this.multiplierY+i,h=l+n[0]*this.multiplierX+n[1]*this.multiplierY;f[e]+=Math.min(this.data[l]/s,t.data[h]/a)}}return i?f.reduce(((t,e)=>t+e))/f.length:f}function Fw(t={}){let{sampling:e=[10,10],painted:n=!1,mask:i}=t;this.checkProcessable("getPixelsGrid",{bitDepth:[8,16],channels:1}),Array.isArray(e)||(e=[e,e]);const r=e[0],s=e[1],o=[],a=[],l=this.width/r,h=this.height/s;let u=Math.floor(l/2);for(let t=0;t<r;t++){let t=Math.floor(h/2);for(let e=0;e<s;e++){let e=Math.round(u),n=Math.round(t);i&&!i.getBitXY(e,n)||(o.push([e,n]),a.push(this.getPixelXY(e,n))),t+=h}u+=l}const c={xyS:o,zS:a};return n&&(c.painted=this.rgba8().paintPoints(o)),c}function zw(t,e,n){const i=new Array(t);for(let n=0;n<t;n++)i[n]=new Array(e);if(n)for(let r=0;r<t;r++)for(let t=0;t<e;t++)i[r][t]=n;return i.width=t,i.height=e,Object.setPrototypeOf(i,zw.prototype),i}function Gw(t,e={}){let{border:n}=e;if(this.checkProcessable("getChannel",{bitDepth:[8,16]}),this.bitDepth!==t.bitDepth)throw new Error("Both images must have the same bitDepth");if(this.channels!==t.channels)throw new Error("Both images must have the same number of channels");if(this.colorModel!==t.colorModel)throw new Error("Both images must have the same colorModel");let i=new zw(t.width,t.height,-1/0),r=Math.floor(t.width/2),s=Math.floor(t.height/2),o=r,a=s,l=!1;for(;!l;){let e=i.localSearch(r,s,-1/0);for(let r=0;r<e.length;r++){let s=e[r],l=this.getSimilarity(t,{border:n,shift:[o-s[0],a-s[1]]});i[s[0]][s[1]]=l}let h=i.localMax(r,s);h.position[0]!==r||h.position[1]!==s?(r=h.position[0],s=h.position[1]):l=!0}return[r-o,s-a]}function Bw(t,e=0){this.checkProcessable("getRow",{bitDepth:[8,16]}),function(t,e){if(e<0||e>=t.height)throw new RangeError(`row must be included between 0 and ${t.height-1}. Current value: ${e}`)}(this,t),Jv(this,e);let n=new Array(this.width),i=0,r=t*this.width*this.channels+e,s=r+this.width*this.channels;for(let t=r;t<s;t+=this.channels)n[i++]=this.data[t];return n}function Uw(t,e=0){this.checkProcessable("getColumn",{bitDepth:[8,16]}),function(t,e){if(e<0||e>=t.width)throw new RangeError(`column must be included between 0 and ${t.width-1}. Current value: ${e}`)}(this,t),Jv(this,e);let n=new Array(this.height),i=0,r=this.width*this.channels;for(let s=e+t*this.channels;s<this.data.length;s+=r)n[i++]=this.data[s];return n}function qw(t={}){let{channel:e}=t;if(this.checkProcessable("getMatrix",{bitDepth:[8,16]}),void 0===e){if(this.components>1)throw new RangeError("You need to define the channel for an image that contains more than one channel");e=0}let n=new ev(this.height,this.width);for(let t=0;t<this.height;t++)for(let i=0;i<this.width;i++)n.set(t,i,this.getValueXY(i,t,e));return n}function Vw(t,e={}){t=new ev(t);let{channel:n}=e;if(this.checkProcessable("getMatrix",{bitDepth:[8,16]}),void 0===n){if(this.components>1)throw new RangeError("You need to define the channel for an image that contains more than one channel");n=0}if(this.width!==t.columns||this.height!==t.rows)throw new RangeError("The size of the matrix must be equal to the size of the image");for(let e=0;e<this.height;e++)for(let i=0;i<this.width;i++)this.setValueXY(i,e,n,t.get(e,i));return this}function Yw(){this.checkProcessable("getPixelsArray",{bitDepth:[8,16,32]});let t=new Array(this.size),e=0;for(let n=0;n<this.data.length;n+=this.channels){let i=new Array(this.components);for(let t=0;t<this.components;t++)i[t]=this.data[n+t];t[e++]=i}return t}function Xw(t){let e=this,n=e.getClosestCommonParent(t),i=e.getRelativePosition(n,{defaultFurther:!0}),r=jw(e,i),s=t.getRelativePosition(n,{defaultFurther:!0}),o=jw(t,s),a=function(t,e){let n=0,i=0,r=[];for(;n<t.length&&i<e.length;)t[n][0]===e[i][0]&&t[n][1]===e[i][1]?(r.push(t[n]),n++,i++):t[n][0]<e[i][0]||t[n][0]===e[i][0]&&t[n][1]<e[i][1]?n++:i++;return r}(r,o),l={whitePixelsMask1:[],whitePixelsMask2:[],commonWhitePixels:[]};for(let n=0;n<a.length;n++){let r=a[n],o=[r[0]-i[0],r[1]-i[1]],h=[r[0]-s[0],r[1]-s[1]],u=e.getBitXY(o[0],o[1]),c=t.getBitXY(h[0],h[1]);1===u&&1===c&&l.commonWhitePixels.push(r)}for(let t=0;t<r.length;t++){let n,i;0!==t&&(n=Math.floor(t/e.width),i=t%e.width),1===e.getBitXY(n,i)&&l.whitePixelsMask1.push(r[t])}for(let e=0;e<o.length;e++){let n=0,i=0;0!==e&&(n=Math.floor(e/t.width),i=e%t.width),1===t.getBitXY(n,i)&&l.whitePixelsMask2.push(o[e])}return l}function jw(t,e){let n=[];for(let i=0;i<t.height;i++)for(let r=0;r<t.width;r++){let t=[i,r];n.push([t[0]+e[0],t[1]+e[1]])}return n}function Ww(t){let e,n=Hw(this),i=Hw(t);if(e=n>=i?$w(this,n):$w(t,i),0===n||0===i)return e;let r=this,s=t;for(;n!==i;)if(n>i){if(r=r.parent,null===r)return e;n-=1}else{if(s=s.parent,null===s)return e;i-=1}for(;r!==s&&null!==r&&null!==s;)if(r=r.parent,s=s.parent,null===r||null===s)return e;return r!==s?e:r}function Hw(t){let e=0,n=t;for(;null!=n.parent;)n=n.parent,e++;return e}function $w(t,e){let n=t;for(;e>0;)n=n.parent,e-=1;return n}zw.prototype.localMin=function(t,e){let n=this[t][e],i=[t,e];for(let r=Math.max(0,t-1);r<Math.min(this.length,t+2);r++)for(let t=Math.max(0,e-1);t<Math.min(this[0].length,e+2);t++)this[r][t]<n&&(n=this[r][t],i=[r,t]);return{position:i,value:n}},zw.prototype.localMax=function(t,e){let n=this[t][e],i=[t,e];for(let r=Math.max(0,t-1);r<Math.min(this.length,t+2);r++)for(let t=Math.max(0,e-1);t<Math.min(this[0].length,e+2);t++)this[r][t]>n&&(n=this[r][t],i=[r,t]);return{position:i,value:n}},zw.prototype.localSearch=function(t,e,n){let i=[];for(let r=Math.max(0,t-1);r<Math.min(this.length,t+2);r++)for(let t=Math.max(0,e-1);t<Math.min(this[0].length,e+2);t++)this[r][t]===n&&i.push([r,t]);return i};const Zw={lowThreshold:10,highThreshold:30,gaussianBlur:1.1},Kw=[[-1,0,1],[-2,0,2],[-1,0,1]],Jw=[[-1,-2,-1],[0,0,0],[1,2,1]],Qw={bitDepth:32,mode:"periodic"};function tx(t){return function(t,e){t.checkProcessable("Canny edge detector",{bitDepth:8,channels:1,components:1}),e=Object.assign({},Zw,e);const n=t.width,i=t.height,r=t.maxValue,s={sigma:e.gaussianBlur,radius:3},o=t.gaussianFilter(s),a=o.convolution(Jw,Qw),l=o.convolution(Kw,Qw),h=l.hypotenuse(a),u=t.constructor,c=new u(n,i,{kind:"GREY",bitDepth:32}),f=new u(n,i,{kind:"GREY",bitDepth:32}),d=new u(n,i,{kind:"GREY"});for(var g=1;g<n-1;g++)for(var p=1;p<i-1;p++){var m=(Math.round(Math.atan2(l.getValueXY(g,p,0),a.getValueXY(g,p,0))*(5/Math.PI))+5)%5;0===m&&(h.getValueXY(g,p,0)<=h.getValueXY(g,p-1,0)||h.getValueXY(g,p,0)<=h.getValueXY(g,p+1,0))||1===m&&(h.getValueXY(g,p,0)<=h.getValueXY(g-1,p+1,0)||h.getValueXY(g,p,0)<=h.getValueXY(g+1,p-1,0))||2===m&&(h.getValueXY(g,p,0)<=h.getValueXY(g-1,p,0)||h.getValueXY(g,p,0)<=h.getValueXY(g+1,p,0))||3===m&&(h.getValueXY(g,p,0)<=h.getValueXY(g-1,p-1,0)||h.getValueXY(g,p,0)<=h.getValueXY(g+1,p+1,0))||c.setValueXY(g,p,0,h.getValueXY(g,p,0))}for(g=0;g<n*i;++g){var y=c.data[g],v=0;y>e.highThreshold&&(v++,d.data[g]=r),y>e.lowThreshold&&v++,f.data[g]=v}var w=[];for(g=1;g<n-1;++g)for(p=1;p<i-1;++p)if(1===f.getValueXY(g,p,0))t:for(var x=g-1;x<g+2;++x)for(var _=p-1;_<p+2;++_)if(2===f.getValueXY(x,_,0)){w.push([g,p]),d.setValueXY(g,p,0,r);break t}for(;w.length>0;){var b=[];for(g=0;g<w.length;++g)for(p=-1;p<2;++p)for(x=-1;x<2;++x)if(0!==p||0!==x){var E=w[g][0]+p,S=w[g][1]+x;1===f.getValueXY(E,S,0)&&0===d.getValueXY(E,S,0)&&(b.push([E,S]),d.setValueXY(E,S,0,r))}w=b}return d}(this,t)}function ex(t,e={}){let{position:n}=e;if(this.checkProcessable("extract",{bitDepth:[1,8,16]}),!n&&(n=t.getRelativePosition(this),!n))throw new Error("extract : can not extract an image because the relative position can not be determined, try to specify manually the position as an array of 2 elements [x,y].");if(this.bitDepth>1){let e=R_.createFrom(this,{width:t.width,height:t.height,alpha:1,position:n,parent:this});for(let i=0;i<t.width;i++)for(let r=0;r<t.height;r++){for(let t=0;t<this.channels;t++){let s=this.getValueXY(i+n[0],r+n[1],t);e.setValueXY(i,r,t,s)}t.getBitXY(i,r)||e.setValueXY(i,r,this.components,0)}return e}{let e=R_.createFrom(this,{width:t.width,height:t.height,position:n,parent:this});for(let i=0;i<t.height;i++)for(let r=0;r<t.width;r++)t.getBitXY(r,i)&&this.getBitXY(r+n[0],i+n[1])&&e.setBitXY(r,i);return e}}var nx=__webpack_require__(8737),ix=__webpack_require__.n(nx);function rx(t={}){const{x:e=0,y:n=0,inPlace:i=!0}=t,r=i?this:R_.createFrom(this);if(this.checkProcessable("floodFill",{bitDepth:1}),this.getBitXY(e,n))return r;const s=new(ix());for(s.push(new sx(e,n));s.length>0;){const t=s.shift();r.setBitXY(t.x,t.y);for(let e=t.x+1;e<this.width&&!r.getBitXY(e,t.y)&&!this.getBitXY(e,t.y);e++)r.setBitXY(e,t.y),t.y+1<this.height&&!this.getBitXY(e,t.y+1)&&s.push(new sx(e,t.y+1)),t.y-1>=0&&!this.getBitXY(e,t.y-1)&&s.push(new sx(e,t.y-1));for(let e=t.x-1;e>=0&&!r.getBitXY(e,t.y)&&!this.getBitXY(e,t.y);e++)r.setBitXY(e,t.y),t.y+1<this.height&&!this.getBitXY(e,t.y+1)&&s.push(new sx(e,t.y+1)),t.y-1>=0&&!this.getBitXY(e,t.y-1)&&s.push(new sx(e,t.y-1))}return r}function sx(t,e){this.x=t,this.y=e}function ox(){return ox=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},ox.apply(this,arguments)}function ax(t,e,n){var i=function(t,e,n){return{h:t,s:2*(e*=(n<50?n:100-n)/100)/(n+e)*100,v:n+e}}(t,e,n);return function(t,e,n){var i,r=(n/=100)*(e/=100),s=t/60,o=r*(1-Math.abs(s%2-1)),a=n-r;return i=s>=0&&s<1?[r,o,0]:s>=1&&s<2?[o,r,0]:s>=2&&s<3?[0,r,o]:t>=3&&s<4?[0,o,r]:t>=4&&s<5?[o,0,r]:t>=5&&s<=6?[r,0,o]:[0,0,0],{r:Math.round(255*(i[0]+a)),g:Math.round(255*(i[1]+a)),b:Math.round(255*(i[2]+a))}}(i.h,i.s,i.v)}var lx={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]};function hx(t){let e=function(t){var e=lx[t.toLowerCase()];if(e)return{r:e[0],g:e[1],b:e[2],a:100}}(n=t)||function(t){if("#"===t[0]&&4===t.length)return{r:parseInt(t[1]+t[1],16),g:parseInt(t[2]+t[2],16),b:parseInt(t[3]+t[3],16),a:100}}(n)||function(t){if("#"===t[0]&&7===t.length)return{r:parseInt(t.slice(1,3),16),g:parseInt(t.slice(3,5),16),b:parseInt(t.slice(5,7),16),a:100}}(n)||function(t){var e=t.match(/rgb\(([^)]+)\)/);if(e){var n=e[1].split(/ *, */).map(Number);return{r:n[0],g:n[1],b:n[2],a:100}}}(n)||function(t){var e=t.match(/rgba\(([^)]+)\)/);if(e){var n=e[1].split(/ *, */).map(Number);return{r:n[0],g:n[1],b:n[2],a:100*n[3]}}}(n)||function(t){var e=t.match(/hsl\(([^)]+)\)/);if(e){var n=e[1].split(/ *, */);return ox({},ax(parseInt(n[0],10),parseInt(n[1],10),parseInt(n[2],10)),{a:100})}}(n)||function(t){var e=t.match(/hsla\(([^)]+)\)/);if(e){var n=e[1].split(/ *, */),i=parseInt(n[0],10),r=parseInt(n[1],10),s=parseInt(n[2],10),o=parseInt(100*parseFloat(n[3]),10);return ox({},ax(i,r,s),{a:o})}}(n);var n;return[e.r,e.g,e.b,Math.round(255*e.a/100)]}function ux(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+(e-t)*(2/3-n)*6:t}function cx(t,e,n){let i,r,s,o,a,l;return n/=100,0==(e/=100)?o=a=l=255*n:(r=n<=.5?n*(e+1):n+e-n*e,i=2*n-r,s=t/360,o=ux(i,r,s+1/3),a=ux(i,r,s),l=ux(i,r,s-1/3)),{r:o,g:a,b:l}}function fx(t){let{color:e,colors:n,randomColors:i,numberColors:r=50}=t;if(e&&!Array.isArray(e)&&(e=hx(e)),e)return[e];if(n)return n=n.map((function(t){return Array.isArray(t)?t:hx(t)})),n;if(i){n=new Array(r);for(let t=0;t<r;t++)n[t]=[Math.floor(256*Math.random()),Math.floor(256*Math.random()),Math.floor(256*Math.random())]}return function(t){let e=new Array(t),n=0;for(let i=0;i<360;i+=360/t){n++;let t=cx(i,100,30+n%4*15);e[n-1]=[Math.round(255*t.r),Math.round(255*t.g),Math.round(255*t.b)]}return e}(r)}function dx(t,e,n={}){let{color:i="blue",colors:r,font:s="12px Helvetica",rotate:o=0}=n;if(this.checkProcessable("paintMasks",{channels:[3,4],bitDepth:[8,16],colorModel:Am}),!Array.isArray(t))throw Error("paintLabels: labels must be an array");if(!Array.isArray(e))throw Error("paintLabels: positions must be an array");if(i&&!Array.isArray(i)&&(i=hx(i)),r=r?r.map((function(t){return Array.isArray(t)?t:hx(t)})):[i],t.length!==e.length)throw Error("paintLabels: positions and labels must be arrays from the same size");Array.isArray(s)||(s=[s]),Array.isArray(o)||(o=[o]);let a=this.getCanvas().getContext("2d");for(let n=0;n<t.length;n++){a.save();let i=r[n%r.length];a.fillStyle=`rgba(${i[0]},${i[1]},${i[2]},${i[3]/this.maxValue})`,a.font=s[n%s.length];let l=e[n];a.translate(l[0],l[1]),a.rotate(o[n%o.length]/180*Math.PI),a.fillText(t[n],0,0),a.restore()}return this.data=Uint8Array.from(a.getImageData(0,0,this.width,this.height).data),this}function gx(t,e={}){let{alpha:n=255,labels:i=[],labelsPosition:r=[],labelColor:s="blue",labelFont:o="12px Helvetica"}=e;this.checkProcessable("paintMasks",{channels:[3,4],bitDepth:[8,16],colorModel:Am});let a=fx(Object.assign({},e,{numberColors:t.length}));Array.isArray(t)||(t=[t]);for(let e=0;e<t.length;e++){let i=t[e],r=a[e%a.length];for(let t=0;t<i.width;t++)for(let e=0;e<i.height;e++)if(i.getBitXY(t,e))for(let s=0;s<Math.min(this.components,r.length);s++)if(255===n)this.setValueXY(t+i.position[0],e+i.position[1],s,r[s]);else{let o=this.getValueXY(t+i.position[0],e+i.position[1],s);o=Math.round((o*(255-n)+r[s]*n)/255),this.setValueXY(t+i.position[0],e+i.position[1],s,o)}}if(Array.isArray(i)&&i.length>0){let e=this.getCanvas().getContext("2d");e.fillStyle=s,e.font=o;for(let n=0;n<Math.min(t.length,i.length);n++){let s=r[n]?r[n]:t[n].position;e.fillText(i[n],s[0],s[1])}this.data=Uint8Array.from(e.getImageData(0,0,this.width,this.height).data)}return this}function px(t,e){let n=new Array(t);for(let i=0;i<t;i++)n[i]=new Array(e).fill(0);return n}const mx=[[0,0,1,0,0],[0,0,1,0,0],[1,1,1,1,1],[0,0,1,0,0],[0,0,1,0,0]],yx=[[0,1,0],[1,1,1],[0,1,0]];class vx{constructor(t={}){let{kind:e="cross",shape:n,size:i,width:r,height:s,filled:o=!0}=t;if(i&&(r=i,s=i),n)switch(n.toLowerCase()){case"square":case"rectangle":this.matrix=function(t,e,n){const i=px(e,t);if(n.filled)for(let n=0;n<e;n++)for(let e=0;e<t;e++)i[n][e]=1;else{for(let n of[0,e-1])for(let e=0;e<t;e++)i[n][e]=1;for(let n=0;n<e;n++)for(let e of[0,t-1])i[n][e]=1}return i}(r,s,{filled:o});break;case"circle":case"ellipse":this.matrix=function(t,e,n){const i=px(e,t);let r=1-e%2,s=1-t%2,o=Math.floor((t-1)/2),a=Math.floor((e-1)/2),l=o*o,h=a*a;if(n.filled)for(let e=0;e<=a;e++)for(let n=o-Math.floor(Math.sqrt(l-l*e*e/h));n<=o;n++)i[a-e][n]=1,i[a+e+r][n]=1,i[a-e][t-n-1]=1,i[a+e+r][t-n-1]=1;else{for(let e=0;e<=a;e++){let n=o-Math.floor(Math.sqrt(l-l*e*e/h));i[a-e][n]=1,i[a+e+r][n]=1,i[a-e][t-n-1]=1,i[a+e+r][t-n-1]=1}for(let t=0;t<=o;t++){let n=a-Math.floor(Math.sqrt(h-h*t*t/l));i[n][o-t]=1,i[n][o+t+s]=1,i[e-n-1][o-t]=1,i[e-n-1][o+t+s]=1}}return i}(r,s,{filled:o});break;case"triangle":this.matrix=function(t,e,n){if(!n.filled)throw new Error("Non filled triangle is not implemented");const i=px(e,t);for(let n=0;n<e;n++){let r=Math.floor((1-n/e)*t/2);for(let e=r;e<t-r;e++)i[n][e]=1}return i}(r,s,{filled:o});break;default:throw new Error(`Shape: unexpected shape: ${n}`)}else{if(!e)throw new Error("Shape: expected a kind or a shape option");switch(e.toLowerCase()){case"cross":this.matrix=mx;break;case"smallcross":this.matrix=yx;break;default:throw new Error(`Shape: unexpected kind: ${e}`)}}this.height=this.matrix.length,this.width=this.matrix[0].length,this.halfHeight=this.height/2>>0,this.halfWidth=this.width/2>>0}getPoints(){let t=this.matrix,e=[];for(let n=0;n<t.length;n++)for(let i=0;i<t[0].length;i++)t[n][i]&&e.push([i-this.halfWidth,n-this.halfHeight]);return e}getMask(){let t=new R_(this.width,this.height,{kind:Dm});for(let e=0;e<this.matrix.length;e++)for(let n=0;n<this.matrix[0].length;n++)this.matrix[e][n]&&t.setBitXY(n,e);return t}}function wx(t,e={}){let{shape:n}=e;this.checkProcessable("paintPoints",{bitDepth:[8,16]});let i=fx(Object.assign({},e,{numberColors:t.length})),r=new vx(n).getPoints(),s=Math.min(this.channels,i[0].length);for(let e=0;e<t.length;e++){let n=i[e%i.length],o=t[e][0],a=t[e][1];for(let t=0;t<r.length;t++){let e=r[t][0],i=r[t][1];if(o+e>=0&&a+i>=0&&o+e<this.width&&a+i<this.height){let t=(o+e+(a+i)*this.width)*this.channels;for(let e=0;e<s;e++)this.data[t+e]=n[e]}}}return this}function xx(t,e={}){let{color:n=[this.maxValue,0,0],closed:i=!1}=e;this.checkProcessable("paintPoints",{bitDepth:[1,8,16]});let r=Math.min(this.channels,n.length);for(let e=0;e<t.length-1+i;e++){let i=t[e],s=t[(e+1)%t.length],o=s[0]-i[0],a=s[1]-i[1],l=Math.max(Math.abs(o),Math.abs(a)),h=o/l,u=a/l,c=i[0],f=i[1];for(let t=0;t<=l;t++){let t=Math.round(c),e=Math.round(f);if(t>=0&&e>=0&&t<this.width&&e<this.height)if(1===this.bitDepth)this.setBitXY(t,e);else{let i=(t+e*this.width)*this.channels;for(let t=0;t<r;t++)this.data[i+t]=n[t]}c+=h,f+=u}}return this}function _x(t,e={}){let n=Object.assign({},e);this.checkProcessable("paintPolylines",{bitDepth:[8,16]});let i=fx(Object.assign({},e,{numberColors:t.length}));for(let e=0;e<t.length;e++)n.color=i[e%i.length],this.paintPolyline(t[e],n);return this}function bx(t,e={}){let{color:n=[this.maxValue,0,0],filled:i=!1}=e;this.checkProcessable("paintPoints",{bitDepth:[1,8,16]}),e.closed=!0;let r=function(t){let e=[];for(let n=0;n<t.length;n++)t[n][0]===t[(n+1)%t.length][0]&&t[n][1]===t[(n+1)%t.length][1]||t[n][0]===t[(n-1+t.length)%t.length][0]&&t[n][1]===t[(n-1+t.length)%t.length][1]||t[(n+1)%t.length][0]===t[(n-1+t.length)%t.length][0]&&t[(n-1+t.length)%t.length][1]===t[(n+1)%t.length][1]||e.push(t[n]);return e}(t);if(!1===i)return this.paintPolyline(t,e);{let i=Array(this.height);for(let t=0;t<this.height;t++){i[t]=[];for(let e=0;e<this.width;e++)i[t].push(0)}for(let t=0;t<r.length;t++){const e=Ex(r[t],r[(t+1)%r.length]);for(let t=0;t<this.height;t++)for(let n=0;n<this.width;n++)Sx(n,t,e,this.height)&&(i[t][n]=0===i[t][n]?1:0)}for(let t=0;t<this.height;t++)for(let e=0;e<this.width;e++)if(1===i[t][e])if(1===this.bitDepth)this.setBitXY(e,t);else{let i=Math.min(this.channels,n.length),r=(e+t*this.width)*this.channels;for(let t=0;t<i;t++)this.data[r+t]=n[t]}return this.paintPolyline(t,e)}}function Ex(t,e){if(t[0]===e[0])return{a:0,b:t[0],vertical:!0};{const n=(e[1]-t[1])/(e[0]-t[0]);return{a:n,b:t[1]-n*t[0],vertical:!1}}}function Sx(t,e,n,i){if(!0===n.vertical)return n.b<=t;if(0===n.a)return!1;{const r=(e-n.b)/n.a;return r<t&&r>=0&&r<=i}}function Ix(t,e={}){let n=Object.assign({},e);this.checkProcessable("paintPolygons",{bitDepth:[8,16]});let i=fx(Object.assign({},e,{numberColors:t.length}));for(let e=0;e<t.length;e++)n.color=i[e%i.length],this.paintPolygon(t[e],n);return this}function Cx(t={}){let{maxSlots:e=256,channel:n,useAlpha:i=!0}=t;if(this.checkProcessable("getHistogram",{bitDepth:[1,8,16]}),void 0===n){if(this.components>1)throw new RangeError("You need to define the channel for an image that contains more than one channel");n=0}return Rx.call(this,n,{useAlpha:i,maxSlots:e})}function Mx(t={}){const{maxSlots:e=256,useAlpha:n=!0}=t;this.checkProcessable("getHistograms",{bitDepth:[8,16]});let i=new Array(n?this.components:this.channels);for(let t=0;t<i.length;t++)i[t]=Rx.call(this,t,{useAlpha:n,maxSlots:e});return i}function Rx(t,e){let{useAlpha:n,maxSlots:i}=e;if(1===this.bitDepth){let t=[0,0];for(let e=0;e<this.height;e++)for(let n=0;n<this.width;n++){let i=this.getBitXY(e,n);0===i?t[0]+=1:1===i&&(t[1]+=1)}return t}let r=Math.log2(i);if(!Zy()(r))throw new RangeError("maxSlots must be a power of 2, for example: 64, 256, 1024");let s=0;this.bitDepth>r&&(s=this.bitDepth-r);let o=this.data,a=fv()(Math.pow(2,Math.min(this.bitDepth,r)),0);if(n&&this.alpha){let e=this.channels-t-1;for(let n=t;n<o.length;n+=this.channels)a[o[n]>>s]+=o[n+e]/this.maxValue}else for(let e=t;e<o.length;e+=this.channels)a[o[e]>>s]++;return a}function Px(t={}){let{useAlpha:e=!0,nbSlots:n=512}=t;this.checkProcessable("getColorHistogram",{bitDepth:[8,16],components:[3]});let i=Math.log(n)/Math.log(8);if(i!==Math.floor(i))throw new RangeError("nbSlots must be a power of 8. Usually 8, 64, 512 or 4096");let r=this.bitDepth-i,s=this.data,o=fv()(Math.pow(8,i),0),a=Math.pow(2,2*i),l=Math.pow(2,i);for(let t=0;t<s.length;t+=this.channels){let n=(s[t]>>r)*a+(s[t+1]>>r)*l+(s[t+2]>>r);e&&this.alpha?o[n]+=s[t+this.channels-1]/this.maxValue:o[n]++}return o}function Tx(){this.checkProcessable("min",{bitDepth:[8,16,32]});let t=fv()(this.channels,1/0);for(let e=0;e<this.data.length;e+=this.channels)for(let n=0;n<this.channels;n++)this.data[e+n]<t[n]&&(t[n]=this.data[e+n]);return t}function Nx(){this.checkProcessable("max",{bitDepth:[8,16,32]});let t=fv()(this.channels,-1/0);for(let e=0;e<this.data.length;e+=this.channels)for(let n=0;n<this.channels;n++)this.data[e+n]>t[n]&&(t[n]=this.data[e+n]);return t}function Ax(){this.checkProcessable("sum",{bitDepth:[8,16]});let t=fv()(this.channels,0);for(let e=0;e<this.data.length;e+=this.channels)for(let n=0;n<this.channels;n++)t[n]+=this.data[e+n];return t}function kx(t=0,e=0){this.checkProcessable("getMoment",{bitDepth:[1]});let n=0;for(let i=0;i<this.width;i++)for(let r=0;r<this.height;r++)1===this.getBitXY(i,r)&&(n+=i**t*r**e);return n}function Lx(t={}){let{mask:e,region:n=3,removeClosePoints:i=0,invert:r=!1,maxEquals:s=2}=t,o=this;this.checkProcessable("localMaxima",{bitDepth:[8,16],components:1}),n*=4;let a=r?0:1,l=[1,0,-1,0,1,1,-1,-1,2,0,-2,0,2,2,-2,-2],h=[0,1,0,-1,1,-1,1,-1,0,2,0,-2,2,-2,2,-2],u=n<=8?1:2,c=[];for(let t=u;t<o.height-u;t++)for(let i=u;i<o.width-u;i++){if(e&&e.getBitXY(i,t)!==a)continue;let u=0,f=0,d=o.data[i+t*o.width];for(let e=0;e<n;e++)r?o.data[i+l[e]+(t+h[e])*o.width]>d&&u++:o.data[i+l[e]+(t+h[e])*o.width]<d&&u++,o.data[i+l[e]+(t+h[e])*o.width]===d&&f++;u+f===n&&f<=s&&c.push([i,t])}if(i>0)for(let t=0;t<c.length;t++)for(let e=t+1;e<c.length;e++)Math.sqrt(Math.pow(c[t][0]-c[e][0],2)+Math.pow(c[t][1]-c[e][1],2))<i&&(c[t][0]=c[t][0]+c[e][0]>>1,c[t][1]=c[t][1]+c[e][1]>>1,c.splice(e,1),e--);return c}function Ox(){let t=this.getHistograms({maxSlots:this.maxValue+1}),e=new Array(t.length);for(let n=0;n<t.length;n++){let i=t[n];e[n]=py(i)}return e}function Dx(){let t=this.getHistograms({maxSlots:this.maxValue+1}),e=new Array(t.length);for(let n=0;n<t.length;n++){let i=t[n];e[n]=gy(i)}return e}function Fx(){this.checkProcessable("points",{bitDepth:[1]});const t=[];for(let e=0;e<this.width;e++)for(let n=0;n<this.height;n++)1===this.getBitXY(e,n)&&t.push([e,n]);return t}function zx(){this.checkProcessable("extendedPoints",{bitDepth:[1]});const t=[];for(let e=0;e<this.height;e++)for(let n=0;n<this.width;n++)if(1===this.getBitXY(n,e))for(t.push([n,e]),1!==this.getBitXY(n+1,e)?(t.push([n+1,e]),t.push([n+1,e+1]),1!==this.getBitXY(n,e+1)&&t.push([n,e+1])):1!==this.getBitXY(n,e+1)&&(t.push([n,e+1]),t.push([n+1,e+1]));n<this.width-2&&1===this.getBitXY(n+1,e)&&1===this.getBitXY(n+2,e);)n++;return t}function Gx(t,e={}){if(this===t)return[0,0];let n=[0,0],i=this;for(;i;){if(i===t)return n;i.position&&(n[0]+=i.position[0],n[1]+=i.position[1]),i=i.parent}return!!e.defaultFurther&&n}function Bx(t={}){let{alpha:e=1}=t;this.checkProcessable("countAlphaPixels",{bitDepth:[8,16],alpha:1});let n=0;if(void 0!==e){for(let t=this.components;t<this.data.length;t+=this.channels)this.data[t]===e&&n++;return n}return this.size}function Ux(t,e={}){const{sorted:n}=e;n||(t=t.slice().sort(Vx));const i=t.length,r=new Array(2*i);let s=0;for(let e=0;e<i;e++){const n=t[e];for(;s>=2&&qx(r[s-2],r[s-1],n)<=0;)s--;r[s++]=n}const o=s+1;for(let e=i-2;e>=0;e--){const n=t[e];for(;s>=o&&qx(r[s-2],r[s-1],n)<=0;)s--;r[s++]=n}return r.slice(0,s-1)}function qx(t,e,n){return(e[1]-t[1])*(n[0]-t[0])-(e[0]-t[0])*(n[1]-t[1])}function Vx(t,e){return t[0]===e[0]?t[1]-e[1]:t[0]-e[0]}function Yx(){return Ux(this.extendedPoints,{sorted:!1})}function Xx(t,e){return[t[0]-e[0],t[1]-e[1]]}function jx(t){let e=Math.sqrt(t[0]**2+t[1]**2);return[t[0]/e,t[1]/e]}function Wx(t,e,n){void 0===n&&(n=new Array(e.length));let i=Math.cos(t),r=Math.sin(t);for(let t=0;t<n.length;++t)n[t]=[i*e[t][0]-r*e[t][1],r*e[t][0]+i*e[t][1]];return n}function Hx(t){let e=0;for(let n=0;n<t.length;n++){let i=t[n][0],r=t[n][1],s=t[n===t.length-1?0:n+1][0],o=t[n===t.length-1?0:n+1][1];e+=Math.sqrt((s-i)**2+(o-r)**2)}return e}function $x(t){let e=0;for(let n=0;n<t.length;n++)e+=t[n][0]*t[n===t.length-1?0:n+1][1]*.5,e-=t[n===t.length-1?0:n+1][0]*t[n][1]*.5;return Math.abs(e)}function Zx(t){let e=1/0,n=1/0,i=-1/0,r=-1/0;for(let s=0;s<t.length;s++)t[s][0]<e&&(e=t[s][0]),t[s][0]>i&&(i=t[s][0]),t[s][1]<n&&(n=t[s][1]),t[s][1]>r&&(r=t[s][1]);return[[e,n],[i,r]]}function Kx(t={}){const{originalPoints:e=Yx.call(this)}=t;if(0===e.length)return[];if(1===e.length)return[e[0],e[0],e[0],e[0]];const n=new Array(e.length);let i,r=1/0,s=0;for(let t=0;t<n.length;t++){let o=Jx(e[t],e[(t+1)%n.length]);Wx(-o,e,n);let a=n[t][0],l=n[t][1],h=n[(t+1)%n.length][0],u=n[(t+1)%n.length][1],c=!0,f=0,d=0,g=0;for(let t=0;t<n.length;t++){let e=(n[t][0]-a)/(h-a);!0===c?(c=!1,f=e,d=e):(e<f&&(f=e),e>d&&(d=e));let i=(-(h-a)*n[t][1]+h*l-u*a)/(h-a);Math.abs(i)>Math.abs(g)&&(g=i)}let p=[a+f*(h-a),l],m=[a+d*(h-a),l],y=Math.abs(g*(f-d)*(h-a));y<r&&(s=o,r=y,i=[p,m,[m[0],m[1]-g],[p[0],p[1]-g]])}return Wx(s,i,i),i}function Jx(t,e){let n=jx(Xx(e,t)),i=Math.acos(n[0]);return n[1]<0?-i:i}var Qx=__webpack_require__(2229),t_=__webpack_require__.n(Qx),e_=__webpack_require__(4707),n_=__webpack_require__.n(e_);function i_(t,e){let n=jx(Xx(e,t)),i=Math.acos(n[0]);return n[1]<0?-i:i}class r_{constructor(t,e){this.map=t,this.id=e,this.minX=Number.POSITIVE_INFINITY,this.maxX=Number.NEGATIVE_INFINITY,this.minY=Number.POSITIVE_INFINITY,this.maxY=Number.NEGATIVE_INFINITY,this.meanX=0,this.meanY=0,this.surface=0,this.computed={}}getMask(t={}){const{scale:e=1,kind:n=""}=t;let i;switch(n){case"contour":i=this.contourMask;break;case"box":i=this.boxMask;break;case"filled":i=this.filledMask;break;case"center":i=this.centerMask;break;case"mbr":i=this.mbrFilledMask;break;case"hull":i=this.convexHullFilledMask;break;case"hullContour":i=this.convexHullMask;break;case"mbrContour":i=this.mbrMask;break;case"feret":i=this.feretMask;break;default:i=this.mask}return e<1&&(i=i.resize({factor:e}),i.parent=this.mask.parent,i.position[0]+=this.minX,i.position[1]+=this.minY),i}get mean(){throw new Error("Roi mean not implemented yet")}get center(){return this.computed.center||(this.computed.center=[this.width/2>>0,this.height/2>>0]),this.computed.center}get ratio(){return this.width/this.height}get width(){return this.maxX-this.minX+1}get height(){return this.maxY-this.minY+1}_computExternalIDs(){let t=this.borderIDs,e=this.borderLengths;this.computed.externalIDs=[],this.computed.externalLengths=[];let n=this.internalIDs;for(let i=0;i<t.length;i++)n.includes(t[i])||(this.computed.externalIDs.push(t[i]),this.computed.externalLengths.push(e[i]))}get externalIDs(){return this.computed.externalIDs||this._computExternalIDs(),this.computed.externalIDs}get externalLengths(){return this.computed.externalLengths||this._computExternalIDs(),this.computed.externalLengths}_computeBorderIDs(){let t=function(t){let e=t.map,n=e.data,i=new Set,r=new Map,s=new Set,o=[1,0,-1,0],a=[0,1,0,-1];for(let l=t.minX;l<=t.maxX;l++)for(let h=t.minY;h<=t.maxY;h++)if(n[l+h*e.width]===t.id)for(let u=0;u<4;u++){let c=l+o[u],f=h+a[u];if(c>=0&&f>=0&&c<e.width&&f<e.height){let o=c+f*e.width;if(n[o]!==t.id&&!s.has(o)){s.add(o),i.add(n[o]);let t=r.get(n[o]);t?r.set(n[o],++t):r.set(n[o],1)}}}let l=Array.from(i),h=l.map((function(t){return r.get(t)}));return{ids:l,lengths:h}}(this);this.computed.borderIDs=t.ids,this.computed.borderLengths=t.lengths}get borderIDs(){return this.computed.borderIDs||this._computeBorderIDs(),this.computed.borderIDs}get borderLengths(){return this.computed.borderLengths||this._computeBorderIDs(),this.computed.borderLengths}get boxIDs(){return this.computed.boxIDs||(this.computed.boxIDs=function(t){let e=new Set,n=t.map,i=n.data;for(let r of[0,t.height-1])for(let s=0;s<t.width;s++){let o=(r+t.minY)*n.width+s+t.minX;if(s-t.minX>0&&i[o]===t.id&&i[o-1]!==t.id){let t=i[o-1];e.add(t)}if(n.width-s-t.minX>1&&i[o]===t.id&&i[o+1]!==t.id){let t=i[o+1];e.add(t)}}for(let r of[0,t.width-1])for(let s=0;s<t.height;s++){let o=(s+t.minY)*n.width+r+t.minX;if(s-t.minY>0&&i[o]===t.id&&i[o-n.width]!==t.id){let t=i[o-n.width];e.add(t)}if(n.height-s-t.minY>1&&i[o]===t.id&&i[o+n.width]!==t.id){let t=i[o+n.width];e.add(t)}}return Array.from(e)}(this)),this.computed.boxIDs}get internalIDs(){return this.computed.internalIDs||(this.computed.internalIDs=function(t){let e=[t.id],n=t.map,i=n.data;if(t.height>2)for(let r=0;r<t.width;r++){let s=t.minY*n.width+r+t.minX;if(e.includes(i[s])){let r=i[s+n.width];e.includes(r)||t.boxIDs.includes(r)||e.push(r)}}let r=new Array(4);for(let s=1;s<t.width-1;s++)for(let o=1;o<t.height-1;o++){let a=(o+t.minY)*n.width+s+t.minX;if(e.includes(i[a])){r[0]=i[a-1],r[1]=i[a+1],r[2]=i[a-n.width],r[3]=i[a+n.width];for(let n=0;n<4;n++){let i=r[n];e.includes(i)||t.boxIDs.includes(i)||e.push(i)}}}return e}(this)),this.computed.internalIDs}get box(){return this.computed.box||(this.computed.box=function(t){let e=0,n=t.map,i=n.data,r=[0];t.height>1&&(r[1]=t.height-1);for(let s of r)for(let r=1;r<t.width-1;r++)i[(s+t.minY)*n.width+r+t.minX]===t.id&&e++;let s=[0];t.width>1&&(s[1]=t.width-1);for(let r of s)for(let s=0;s<t.height;s++)i[(s+t.minY)*n.width+r+t.minX]===t.id&&e++;return e}(this)),this.computed.box}get external(){return this.computed.external||(this.computed.external=function(t){let e=0,n=t.map,i=n.data;for(let r=1;r<t.width-1;r++)for(let s=1;s<t.height-1;s++){let o=(s+t.minY)*n.width+r+t.minX;i[o]===t.id&&(t.externalIDs.includes(i[o-1])||t.externalIDs.includes(i[o+1])||t.externalIDs.includes(i[o-n.width])||t.externalIDs.includes(i[o+n.width]))&&e++}return e+t.box}(this)),this.computed.external}get holesInfo(){return this.computed.holesInfo||(this.computed.holesInfo=function(t){let e=0,n=t.map.width,i=t.map.data;for(let r=1;r<t.width-1;r++)for(let s=1;s<t.height-1;s++){let o=(s+t.minY)*n+r+t.minX;t.internalIDs.includes(i[o])&&i[o]!==t.id&&e++}return{number:t.internalIDs.length-1,surface:e}}(this)),this.computed.holesInfo}get border(){return this.computed.border||(this.computed.border=function(t){let e=0,n=t.map,i=n.data;for(let r=1;r<t.width-1;r++)for(let s=1;s<t.height-1;s++){let o=(s+t.minY)*n.width+r+t.minX;i[o]===t.id&&(i[o-1]===t.id&&i[o+1]===t.id&&i[o-n.width]===t.id&&i[o+n.width]===t.id||e++)}return e+t.box}(this)),this.computed.border}get contourMask(){if(!this.computed.contourMask){let t=new R_(this.width,this.height,{kind:Dm,position:[this.minX,this.minY],parent:this.map.parent});for(let e=0;e<this.width;e++)for(let n=0;n<this.height;n++)this.map.data[e+this.minX+(n+this.minY)*this.map.width]===this.id&&(e>0&&e<this.width-1&&n>0&&n<this.height-1&&this.map.data[e-1+this.minX+(n+this.minY)*this.map.width]===this.id&&this.map.data[e+1+this.minX+(n+this.minY)*this.map.width]===this.id&&this.map.data[e+this.minX+(n-1+this.minY)*this.map.width]===this.id&&this.map.data[e+this.minX+(n+1+this.minY)*this.map.width]===this.id||t.setBitXY(e,n));this.computed.contourMask=t}return this.computed.contourMask}get boxMask(){if(!this.computed.boxMask){let t=new R_(this.width,this.height,{kind:Dm,position:[this.minX,this.minY],parent:this.map.parent});for(let e=0;e<this.width;e++)t.setBitXY(e,0),t.setBitXY(e,this.height-1);for(let e=0;e<this.height;e++)t.setBitXY(0,e),t.setBitXY(this.width-1,e);this.computed.boxMask=t}return this.computed.boxMask}get mask(){if(!this.computed.mask){let t=new R_(this.width,this.height,{kind:Dm,position:[this.minX,this.minY],parent:this.map.parent});for(let e=0;e<this.width;e++)for(let n=0;n<this.height;n++)this.map.data[e+this.minX+(n+this.minY)*this.map.width]===this.id&&t.setBitXY(e,n);this.computed.mask=t}return this.computed.mask}get filledMask(){if(!this.computed.filledMask){let t=new R_(this.width,this.height,{kind:Dm,position:[this.minX,this.minY],parent:this.map.parent});for(let e=0;e<this.width;e++)for(let n=0;n<this.height;n++){let i=e+this.minX+(n+this.minY)*this.map.width;this.internalIDs.includes(this.map.data[i])&&t.setBitXY(e,n)}this.computed.filledMask=t}return this.computed.filledMask}get centerMask(){if(!this.computed.centerMask){let t=new vx({kind:"smallCross"}).getMask();t.parent=this.map.parent,t.position=[this.minX+this.center[0]-1,this.minY+this.center[1]-1],this.computed.centerMask=t}return this.computed.centerMask}get convexHull(){if(!this.computed.convexHull){const t=[];for(let e=0;e<this.width;e++)for(let n=0;n<this.height;n++)this.map.data[e+this.minX+(n+this.minY)*this.map.width]===this.id&&(e>0&&e<this.width-1&&n>0&&n<this.height-1&&this.map.data[e-1+this.minX+(n+this.minY)*this.map.width]===this.id&&this.map.data[e+1+this.minX+(n+this.minY)*this.map.width]===this.id&&this.map.data[e+this.minX+(n-1+this.minY)*this.map.width]===this.id&&this.map.data[e+this.minX+(n+1+this.minY)*this.map.width]===this.id||(t.push([e,n]),t.push([e+1,n]),t.push([e,n+1]),t.push([e+1,n+1])));const e=Ux(t);this.computed.convexHull={polyline:e,surface:$x(e),perimeter:Hx(e)}}return this.computed.convexHull}get convexHullMask(){if(!this.computed.convexHullMask){const t=this.convexHull,e=new R_(this.width+1,this.height+1,{kind:Dm,position:[this.minX,this.minY],parent:this.map.parent});e.paintPolyline(t.polyline,{closed:!0}),this.computed.convexHullMask=e}return this.computed.convexHullMask}get convexHullFilledMask(){if(!this.computed.convexHullFilledMask){const t=this.convexHull,e=new R_(this.width,this.height,{kind:Dm,position:[this.minX,this.minY],parent:this.map.parent});for(let n=0;n<this.width;n++)for(let i=0;i<this.height;i++)1!==n_()(t.polyline,[n,i])&&e.setBitXY(n,i);this.computed.convexHullFilledMask=e}return this.computed.convexHullFilledMask}get mbr(){if(!this.computed.mbr){let t=Kx({originalPoints:this.convexHull.polyline});if(0===t.length)this.computed.mbr={width:0,height:0,surface:0,perimeter:0,rectangle:t};else{let e=t[0],n=t[1],i=t[2],r=Math.sqrt((e[0]-n[0])**2+(e[1]-n[1])**2),s=Math.sqrt((i[0]-n[0])**2+(i[1]-n[1])**2);this.computed.mbr={width:r,height:s,elongation:1-r/s,aspectRatio:r/s,surface:r*s,perimeter:2*(r+s),rectangle:t}}}return this.computed.mbr}get fillRatio(){return this.surface/(this.surface+this.holesInfo.surface)}get feretDiameters(){return this.computed.feretDiameters||(this.computed.feretDiameters=function(t={}){const{originalPoints:e=Yx.call(this)}=t;if(0===e.length)return{min:0,max:0,minLine:[],maxLine:[],aspectRatio:1};if(1===e.length)return{min:1,max:1,minLine:[e[0],e[0]],maxLine:[e[0],e[0]],aspectRatio:1};const n=new Array(e.length);let i=1/0,r=0,s=[];for(let t=0;t<e.length;t++){let o=i_(e[t],e[(t+1)%e.length]);Wx(-o,e,n);let a=0,l=[];for(let i=0;i<e.length;i++){let e=Math.abs(n[t][1]-n[i][1]);e>a&&(a=e,l=[],l.push([n[i][0],n[t][1]],[n[i][0],n[i][1]]))}a<i&&(i=a,r=o,s=l)}Wx(r,s,s);let o=0,a=[],l=0;for(let t=0;t<e.length-1;t++)for(let n=t+1;n<e.length;n++){let i=(e[t][0]-e[n][0])**2+(e[t][1]-e[n][1])**2;i>l&&(l=i,o=Math.sqrt(i),a=[e[t],e[n]])}return{min:i,minLine:s,max:o,maxLine:a,aspectRatio:i/o}}({originalPoints:this.convexHull.polyline})),this.computed.feretDiameters}get eqpc(){return this.computed.eqpc||(this.computed.eqpc=2*Math.sqrt(this.surface/Math.PI)),this.computed.eqpc}get perimeterInfo(){return this.computed.perimeterInfo||(this.computed.perimeterInfo=function(t){let e=t.map,n=e.data,i=0,r=0,s=0,o=0;for(let a=0;a<t.width;a++)for(let l=0;l<t.height;l++){let h=(l+t.minY)*e.width+a+t.minX;if(n[h]===t.id){let u=0;switch((0===a||t.externalIDs.includes(n[h-1]))&&u++,(a===t.width-1||t.externalIDs.includes(n[h+1]))&&u++,(0===l||t.externalIDs.includes(n[h-e.width]))&&u++,(l===t.height-1||t.externalIDs.includes(n[h+e.width]))&&u++,u){case 1:i++;break;case 2:r++;break;case 3:s++;break;case 4:o++}}}return{one:i,two:r,three:s,four:o}}(this)),this.computed.perimeterInfo}get perimeter(){let t=this.perimeterInfo,e=2-Math.sqrt(2);return t.one+2*t.two+3*t.three+4*t.four-e*(t.two+2*t.three+t.four)}get ped(){return this.computed.ped||(this.computed.ped=this.perimeter/Math.PI),this.computed.ped}get feretMask(){if(!this.computed.feretMask){const t=new R_(this.width+1,this.height+1,{kind:Dm,position:[this.minX,this.minY],parent:this.map.parent});t.paintPolyline(this.feretDiameters.minLine),t.paintPolyline(this.feretDiameters.maxLine),this.computed.feretMask=t}return this.computed.feretMask}get mbrMask(){if(!this.computed.mbrMask){let t=function(t){for(let e=0;e<t.length;e++)t[e][0]=Math.round(t[e][0]),t[e][1]=Math.round(t[e][1]);return t}(this.mbr.rectangle);if(t.length>0){const e=Zx(t),n=new R_(e[1][0]-e[0][0]+1,e[1][1]-e[0][1]+1,{kind:Dm,position:[this.minX+e[0][0],this.minY+e[0][1]],parent:this.map.parent});t=function(t,e){void 0===e&&(e=new Array(t.length).fill(0).map((()=>[])));let n=Zx(t),i=n[0][0],r=n[0][1];for(let n=0;n<t.length;n++)e[n][0]=t[n][0]-i,e[n][1]=t[n][1]-r;return e}(t),n.paintPolyline(t,{closed:!0}),this.computed.mbrMask=n}else this.computed.mbrMask=new R_(1,1,{kind:Dm,position:[this.minX,this.minY],parent:this.map.parent})}return this.computed.mbrMask}get mbrFilledMask(){if(!this.computed.mbrFilledMask){const t=new R_(this.width,this.height,{kind:Dm,position:[this.minX,this.minY],parent:this.map.parent}),e=this.mask.minimalBoundingRectangle();for(let n=0;n<this.width;n++)for(let i=0;i<this.height;i++)1!==n_()(e,[n,i])&&t.setBitXY(n,i);this.computed.mbrFilledMask=t}return this.computed.mbrFilledMask}get points(){if(!this.computed.points){let t=[];for(let e=0;e<this.height;e++)for(let n=0;n<this.width;n++){let i=(e+this.minY)*this.map.width+n+this.minX;this.map.data[i]===this.id&&t.push([n,e])}this.computed.points=t}return this.computed.points}get maxLengthPoints(){if(!this.computed.maxLengthPoints){let t,e=0;const n=this.points;for(let i=0;i<n.length;i++)for(let r=i+1;r<n.length;r++){let s=Math.pow(n[i][0]-n[r][0],2)+Math.pow(n[i][1]-n[r][1],2);s>=e&&(e=s,t=[n[i],n[r]])}this.computed.maxLengthPoints=t}return this.computed.maxLengthPoints}get maxLength(){if(!this.computed.maxLength){let t=Math.sqrt(Math.pow(this.maxLengthPoints[0][0]-this.maxLengthPoints[1][0],2)+Math.pow(this.maxLengthPoints[0][1]-this.maxLengthPoints[1][1],2));this.computed.maxLength=t}return this.computed.maxLength}get roundness(){return 4*this.surface/(Math.PI*this.feretDiameters.max**2)}get sphericity(){return 2*Math.sqrt(this.surface*Math.PI)/this.perimeter}get solidity(){return this.surface/this.convexHull.surface}get angle(){if(!this.computed.angle){let t=this.maxLengthPoints,e=180*-Math.atan2(t[0][1]-t[1][1],t[0][0]-t[1][0])/Math.PI;this.computed.angle=e}return this.computed.angle}toJSON(){return{id:this.id,minX:this.minX,maxX:this.maxX,minY:this.minY,maxY:this.maxY,meanX:this.meanX,meanY:this.meanY,height:this.height,width:this.width,surface:this.surface,mbrWidth:this.mbr.width,mbrHeight:this.mbr.height,mbrSurface:this.mbr.surface,eqpc:this.eqpc,ped:this.ped,feretDiameterMin:this.feretDiameters.min,feretDiameterMax:this.feretDiameters.max,aspectRatio:this.feretDiameters.aspectRatio,fillRatio:this.fillRatio,sphericity:this.sphericity,roundness:this.roundness,solidity:this.solidity,perimeter:this.perimeter}}}class s_{constructor(t,e){this.roiMap=t,this.options=e,this.roi=this.createRoi()}createRoi(){let t=this.roiMap.data,e={};this.roiMap.positive=0,this.roiMap.negative=0;for(let n=0;n<t.length;n++)t[n]&&!e[t[n]]&&(e[t[n]]=!0,t[n]>0?this.roiMap.positive++:this.roiMap.negative++);let n={};for(let t in e)n[t]=new r_(this.roiMap,1*t);let i=this.roiMap.width,r=this.roiMap.height;for(let e=0;e<r;e++)for(let r=0;r<i;r++){let s=e*i+r;if(0!==t[s]){const i=n[t[s]];r<i.minX&&(i.minX=r),r>i.maxX&&(i.maxX=r),e<i.minY&&(i.minY=e),e>i.maxY&&(i.maxY=e),i.meanX+=r,i.meanY+=e,i.surface++}}let s=[];for(let t in e)n[t].meanX/=n[t].surface,n[t].meanY/=n[t].surface,s.push(n[t]);return s}}function o_(t={}){const{algorithm:e="commonBorderLength",minCommonBorderLength:n=5,maxCommonBorderLength:i=100,minCommonBorderRatio:r=.3,maxCommonBorderRatio:s=1}=t;let o=function(t,e,r){return t[r]>=n&&t[r]<=i};"function"==typeof e&&(o=e),"commonborderratio"===e.toLowerCase()&&(o=function(t,e,n){let i=Math.min(t[n]/t[e],1);return i>=r&&i<=s});const a=this,l=a.commonBorderLength;let h={},u={};for(let t of Object.keys(l)){let e=l[t],n=Object.keys(e);for(let i of n)if(i!==t&&o(e,t,i)){let e=i;u[i]&&(e=u[i]);let n=t;if(u[t]&&(n=u[t]),Number(e)!==n){let t=Math.min(e,n),i=Math.max(e,n);if(h[t]||(h[t]={}),h[t][i]=!0,u[i]=t,h[i]){for(let e of Object.keys(h[i]))h[t][e]=!0,u[e]=t;delete h[i]}}}}let c=a.minMax,f=-c.min,d=c.max+f,g=new Array(d+1).fill(0);for(let t of Object.keys(u))g[Number(t)+f]=u[t];let p=a.data;for(let t=0;t<p.length;t++){let e=p[t];if(0!==e){let n=g[e+f];0!==n&&(p[t]=n)}}return a.computed={},a}class a_{constructor(t,e){this.parent=t,this.width=t.width,this.height=t.height,this.data=e,this.negative=0,this.positive=0}get total(){return this.negative+this.positive}get minMax(){let t=Number.MAX_SAFE_INTEGER,e=Number.MIN_SAFE_INTEGER;for(let n=0;n<this.data.length;n++)this.data[n]<t&&(t=this.data[n]),this.data[n]>e&&(e=this.data[n]);return{min:t,max:e}}get commonBorderLength(){return function(t){let e=t.data,n=[1,0,-1,0],i=[0,1,0,-1],r=t.minMax,s=-r.min,o=r.max+s,a=[];for(let t=0;t<=o;t++)a.push(Object.create(null));for(let r=0;r<t.width;r++)for(let o=0;o<t.height;o++){let l=e[r+o*t.width];if(0!==l){let h=Object.create(null),u=!1;for(let c=0;c<4;c++){let f=r+n[c],d=o+i[c];if(f>=0&&d>=0&&f<t.width&&d<t.height){let n=e[f+d*t.width];l!==n&&(u=!0,0!==n&&void 0===h[n]&&(h[n]=!0,a[n+s][l]?a[n+s][l]++:a[n+s][l]=1))}else u=!0}u&&(a[l+s][l]?a[l+s][l]++:a[l+s][l]=1)}}let l={};for(let t=0;t<a.length;t++)Object.keys(a[t]).length>0&&(l[t-s]=a[t]);return l}(this)}mergeRoi(t={}){return o_.call(this,t)}mergeRois(t){const e=t[0],n=t.slice(1);for(let t=0;t<this.data.length;t++)n.includes(this.data[t])&&(this.data[t]=e)}rowsInfo(){let t=new Array(this.height),e=0;for(let n=0;n<this.data.length;n+=this.width){let i={row:e,positivePixel:0,negativePixel:0,zeroPixel:0,positiveRoi:0,negativeRoi:0,medianChange:0};t[e++]=i;let r={},s={},o=[],a=this.data[n],l=0;for(let t=n;t<n+this.width;t++){let e=this.data[t];a!==e&&(a=e,o.push(l),l=0),l++,e>0?(i.positivePixel++,r[e]||(r[e]=!0)):e<0?(i.negativePixel++,s[e]||(s[e]=!0)):i.zeroPixel++}o.push(l),i.medianChange=o.sort(((t,e)=>t-e))[Math.floor(o.length/2)],i.positiveRoiIDs=Object.keys(r),i.negativeRoiIDs=Object.keys(s),i.positiveRoi=i.positiveRoiIDs.length,i.negativeRoi=i.negativeRoiIDs.length}return t}colsInfo(){let t=new Array(this.width),e=0;for(let n=0;n<this.width;n++){let i={col:e,positivePixel:0,negativePixel:0,zeroPixel:0,positiveRoi:0,negativeRoi:0,medianChange:0};t[e++]=i;let r={},s={},o=[],a=this.data[n],l=0;for(let t=n;t<n+this.data.length;t+=this.width){let e=this.data[t];a!==e&&(a=e,o.push(l),l=0),l++,e>0?(i.positivePixel++,r[e]||(r[e]=!0)):e<0?(i.negativePixel++,s[e]||(s[e]=!0)):i.zeroPixel++}o.push(l),i.medianChange=o.sort(((t,e)=>t-e))[Math.floor(o.length/2)],i.positiveRoiIDs=Object.keys(r),i.negativeRoiIDs=Object.keys(s),i.positiveRoi=i.positiveRoiIDs.length,i.negativeRoi=i.negativeRoiIDs.length}return t}}function l_(t,e={}){const{allowCorners:n=!1}=e,i=65535;let r=new Int16Array(t.size),s=0,o=0,a=new Uint16Array(65536),l=new Uint16Array(65536);for(let e=0;e<t.width;e++)for(let n=0;n<t.height;n++)0===r[n*t.width+e]&&h(e,n);function h(e,h){let u=0,c=0,f=t.getBitXY(e,h),d=f?++s:--o;if(s>32767||o<-32768)throw new Error("Too many regions of interest");for(a[0]=e,l[0]=h;u<=c;){let e=a[u&i],s=l[u&i];if(r[s*t.width+e]=d,e>0&&0===r[s*t.width+e-1]&&t.getBitXY(e-1,s)===f&&(c++,a[c&i]=e-1,l[c&i]=s,r[s*t.width+e-1]=-32768),s>0&&0===r[(s-1)*t.width+e]&&t.getBitXY(e,s-1)===f&&(c++,a[c&i]=e,l[c&i]=s-1,r[(s-1)*t.width+e]=-32768),e<t.width-1&&0===r[s*t.width+e+1]&&t.getBitXY(e+1,s)===f&&(c++,a[c&i]=e+1,l[c&i]=s,r[s*t.width+e+1]=-32768),s<t.height-1&&0===r[(s+1)*t.width+e]&&t.getBitXY(e,s+1)===f&&(c++,a[c&i]=e,l[c&i]=s+1,r[(s+1)*t.width+e]=-32768),n&&(e>0&&s>0&&0===r[(s-1)*t.width+e-1]&&t.getBitXY(e-1,s-1)===f&&(c++,a[c&i]=e-1,l[c&i]=s-1,r[(s-1)*t.width+e-1]=-32768),e<t.width-1&&s>0&&0===r[(s-1)*t.width+e+1]&&t.getBitXY(e+1,s-1)===f&&(c++,a[c&i]=e+1,l[c&i]=s-1,r[(s-1)*t.width+e+1]=-32768),e>0&&s<t.height-1&&0===r[(s+1)*t.width+e-1]&&t.getBitXY(e-1,s+1)===f&&(c++,a[c&i]=e-1,l[c&i]=s+1,r[(s+1)*t.width+e-1]=-32768),e<t.width-1&&s<t.height-1&&0===r[(s+1)*t.width+e+1]&&t.getBitXY(e+1,s+1)===f&&(c++,a[c&i]=e+1,l[c&i]=s+1,r[(s+1)*t.width+e+1]=-32768)),u++,c-u>i)throw new Error("analyseMask can not finish, the array to manage internal data is not big enough.You could improve mask by changing MAX_ARRAY")}}return new a_(t,r)}var h_=__webpack_require__(530),u_=__webpack_require__.n(h_);const c_=[-1,0],f_=[0,-1],d_=[null,null],g_=[-1,-1,0,1],p_=[0,-1,-1,-1],m_=[null,null,null,null];function y_(t,e={}){const{allowCorners:n=!1}=e;let i,r,s,o=4;if(n&&(o=8),8===o)i=g_,r=p_,s=m_;else{if(4!==o)throw new RangeError(`unsupported neighbours count: ${o}`);i=c_,r=f_,s=d_}const a=t.size,l=t.width,h=t.height,u=new Array(a),c=new Uint32Array(a),f=new(u_());let d=1;for(let e=0;e<h;e++)for(let n=0;n<l;n++){const o=n+e*l;if(t.getBit(o)){let t=null;for(let o=0;o<s.length;o++){const a=n+i[o],c=e+r[o];if(a>=0&&c>=0&&a<l&&c<h){let e=u[a+c*l];e?(s[o]=e,(!t||s[o].value<t.value)&&(t=s[o])):s[o]=null}}if(t){u[o]=t;for(let e=0;e<s.length;e++)s[e]&&s[e]!==t&&f.union(t,s[e])}else u[o]=f.add(d++)}}for(let e=0;e<h;e++)for(let n=0;n<l;n++){const i=n+e*l;t.getBit(i)&&(c[i]=f.find(u[i]).value)}return new a_(t,c)}function v_(t={}){let{allowCorner:e=!0,onlyTop:n=!1,invert:i=!1}=t,r=this;r.checkProcessable("fromMaxima",{components:[1]});const s=1,o=2;let a=0,l=0,h=new Int16Array(r.size),u=new Int8Array(r.size),c=new Float32Array(r.size),f=1048575,d=new Uint16Array(f+1),g=new Uint16Array(f+1),p=0,m=0,y=new Uint16Array(f+1),v=new Uint16Array(f+1),w=0,x=0;for(function({maxima:t=!0}){for(let n=1;n<r.height-1;n++)for(let i=1;i<r.width-1;i++){let s=i+n*r.width;if(0===u[s]){let o=t?r.data[s]:-r.data[i+n*r.width];if(r.data[n*r.width+i-1]>o)continue;if(r.data[n*r.width+i+1]>o)continue;if(r.data[(n-1)*r.width+i]>o)continue;if(r.data[(n+1)*r.width+i]>o)continue;if(e){if(r.data[(n-1)*r.width+i-1]>o)continue;if(r.data[(n-1)*r.width+i+1]>o)continue;if(r.data[(n+1)*r.width+i-1]>o)continue;if(r.data[(n+1)*r.width+i+1]>o)continue}h[s]=t?++a:--l,_(i,n)||(t?--a:++l)}}}(r);p<m;)b(d[p&f],g[p&f],o),p++;return new a_(r,h);function _(t,e){let n=m;w=0,x=1,y[0]=t,v[0]=e;let i=!0;for(;w<x;)i&=b(y[w&f],v[w&f],s),w++;if(!i){for(let t=0;t<x;t++){let e=y[t&f],n=v[t&f]*r.width+e;h[n]=0}m=n}return i}function b(t,e,i){let a=h[e*r.width+t],l=r.data[e*r.width+t];for(let p=e-1;p<=e+1;p++)for(let e=t-1;e<=t+1;e++){let t=p*r.width+e;if(0===u[t])switch(u[t]=1,c[t]=r.data[t]-l,i){case s:if(0===c[t]){if(0===e||0===p||e===r.width-1||p===r.height-1)return!1;h[t]=a,y[x&f]=e,v[x&f]=p,x++}else{if(c[t]>0)return!1;n||(h[t]=a,d[m&f]=e,g[m&f]=p,m++)}break;case o:c[t]<=0&&(h[t]=a,d[m&f]=e,g[m&f]=p,m++);break;default:throw new Error("unreachable")}}return!0}}function w_(t,e={}){let n=new vx(e),i=new Int16Array(this.size),r=0,s=n.getPoints();for(let e=0;e<t.length;e++){r++;let n=t[e][0],o=t[e][1];for(let t=0;t<s.length;t++){let e=s[t][0],a=s[t][1];n+e>=0&&o+a>=0&&n+e<this.width&&o+a<this.height&&(i[n+e+(o+a)*this.width]=r)}}return new a_(this,i)}var x_=__webpack_require__(5307),__=__webpack_require__.n(x_);const b_=[1,0,-1,0,1,1,-1,-1],E_=[0,1,0,-1,1,-1,1,-1];function S_(t={}){let{points:e,mask:n,image:i,fillMaxValue:r=this.maxValue,invert:s=!1}=t,o=i||this;o.checkProcessable("fromWaterShed",{bitDepth:[8,16],components:1}),s=!s,e||(e=o.getLocalMaxima({invert:s,mask:n}));let a=s?0:1,l=new Int16Array(o.size),h=o.width,u=o.height,c=new(__())({comparator:(t,e)=>t[2]-e[2],strategy:__().BinaryHeapStrategy});for(let t=0;t<e.length;t++){let n=e[t][0]+e[t][1]*h;l[n]=t+1;let i=o.data[n];(s&&i<=r||!s&&i>=r)&&c.queue([e[t][0],e[t][1],i])}for(;c.length>0;){let t=c.dequeue(),e=t[0]+t[1]*h;for(let i=0;i<4;i++){let f=t[0]+b_[i],d=t[1]+E_[i];if(f>=0&&d>=0&&f<h&&d<u){let u=f+d*h;if(!n||n.getBit(u)===a){let n=o.data[u];(s&&n<=r||!s&&n>=r)&&0===l[u]&&(l[u]=l[e],c.queue([t[0]+b_[i],t[1]+E_[i],n]))}}}}return new a_(o,l)}class I_{constructor(t,e={}){this._image=t,this._options=e,this._options.label||(this._options.label="default"),this._layers={},this._painted=null}fromMaxima(t={}){let e=Object.assign({},this._options,t),n=v_.call(this._image,t);this._layers[e.label]=new s_(n,e)}fromPoints(t,e={}){let n=Object.assign({},this._options,e),i=w_.call(this._image,t,e);return this._layers[n.label]=new s_(i,n),this}putMap(t,e={}){let n=new a_(this._image,t),i=Object.assign({},this._options,e);return this._layers[i.label]=new s_(n,i),this}fromWaterShed(t={}){let e=Object.assign({},this._options,t),n=S_.call(this._image,t);this._layers[e.label]=new s_(n,e)}fromMask(t,e={}){let n=Object.assign({},this._options,e),i=l_.call(this._image,t,e);return this._layers[n.label]=new s_(i,n),this}fromMaskConnectedComponentLabelingAlgorithm(t,e={}){let n=Object.assign({},this._options,e),i=y_.call(this._image,t,e);return this._layers[n.label]=new s_(i,n),this}getMap(t={}){let e=Object.assign({},this._options,t);return this._assertLayerWithLabel(e.label),this._layers[e.label].roiMap}rowsInfo(t={}){return this.getMap(t).rowsInfo()}colsInfo(t={}){return this.getMap(t).rowsInfo()}getRoiIds(t={}){let e=this.getRois(t);if(e){let t=new Array(e.length);for(let n=0;n<e.length;n++)t[n]=e[n].id;return t}throw new Error("ROIs not found")}getRois(t={}){let{label:e=this._options.label,positive:n=!0,negative:i=!0,minSurface:r=0,maxSurface:s=Number.POSITIVE_INFINITY,minWidth:o=0,maxWidth:a=Number.POSITIVE_INFINITY,minHeight:l=0,maxHeight:h=Number.POSITIVE_INFINITY,minRatio:u=0,maxRatio:c=Number.POSITIVE_INFINITY}=t;if(!this._layers[e])throw new Error(`this Roi layer (${e}) does not exist`);const f=this._layers[e].roi,d=[];for(const t of f)(t.id<0&&i||t.id>0&&n)&&t.surface>=r&&t.surface<=s&&t.width>=o&&t.width<=a&&t.height>=l&&t.height<=h&&t.ratio>=u&&t.ratio<=c&&d.push(t);return d}getRoi(t,e={}){const{label:n=this._options.label}=e;if(!this._layers[n])throw new Error(`this Roi layer (${n}) does not exist`);const i=this._layers[n].roi.find((e=>e.id===t));if(!i)throw new Error(`found no Roi with id ${t}`);return i}getMasks(t={}){let e=this.getRois(t),n=new Array(e.length);for(let i=0;i<e.length;i++)n[i]=e[i].getMask(t);return n}getAnalysisMasks(t={}){const{analysisProperty:e}=t;let n=`${e}Mask`,i=this.getRois(t);return 0!==i.length&&i[0][n]?i.map((t=>t[n])):[]}getData(t={}){let e=Object.assign({},this._options,t);return this._assertLayerWithLabel(e.label),this._layers[e.label].roiMap.data}paint(t={}){let{labelProperty:e,analysisProperty:n}=t;this._painted||(this._painted=this._image.rgba8());let i=this.getMasks(t);if(e){const n=this.getRois(t);t.labels=n.map((t=>function(t,e=""){let n=e.split(".");for(let e of n){if(void 0===t[e])return;t=t[e]}return t}(t,e)));const i=Math.max(...t.labels);let r=!1,s=!1;if(e.includes("surface")?r=!0:/(?:perimeter|min|max|external|width|height|length)/.test(e)&&(s=!0),isFinite(i)){let e="";if("pixel"!==t.unit&&t.pixelSize&&(s||r)){e=r?`${t.unit}^2`:t.unit;let n=r?"m^2":"m",i=r?t.pixelSize**2:t.pixelSize;const s=t_().swiftConverter(n,e);t.labels=t.labels.map((t=>s(i*t)))}t.labels=i>50?t.labels.map((t=>Math.round(t)+e)):i>10?t.labels.map((t=>t.toFixed(1)+e)):t.labels.map((t=>t.toFixed(2)+e))}t.labelsPosition=n.map((t=>[t.meanX,t.meanY]))}if(this._painted.paintMasks(i,t),n){let e=this.getAnalysisMasks(t);this._painted.paintMasks(e,{color:t.analysisColor,alpha:t.analysisAlpha})}return this._painted}getMask(t={}){let e=new R_(this._image.width,this._image.height,{kind:"BINARY"}),n=this.getMasks(t);for(let t=0;t<n.length;t++){let i=n[t];for(let t=0;t<i.width;t++)for(let n=0;n<i.height;n++)i.getBitXY(t,n)&&e.setBitXY(t+i.position[0],n+i.position[1])}return e}resetPainted(t={}){const{image:e}=t;this._painted=e?this.image.rgba8():this._image.rgba8()}mergeRoi(t={}){const e=this.getMap(t);return e.mergeRoi(t),this.putMap(e.data,t),this}mergeRois(t,e={}){if(!Array.isArray(t)||t.some((t=>!Number.isInteger(t))))throw new Error("Roi ids must be an array of integers");if(t.length<2)throw new Error("Roi ids must have at least two elements");if(new Set(t).size!==t.length)throw new Error("Roi ids must be all different");t.forEach((t=>this.getRoi(t)));const n=this.getMap(e);return n.mergeRois(t),this.putMap(n.data,e),this}findCorrespondingRoi(t,e={}){let n=this.getRois(e),i=[];for(let e=0;e<n.length;e++){let r=n[e],s=C_(r.minX,r.minY,r.points,t,Math.sign(r.id));i.push(s)}return i}_assertLayerWithLabel(t){if(!this._layers[t])throw new Error(`no layer with label ${t}`)}}function C_(t,e,n,i,r){let s={id:[],surface:[],roiSurfaceCovered:[],same:0,opposite:0,total:0};for(let r=0;r<n.length;r++){let o=n[r],a=o[0]+t+(o[1]+e)*i.width,l=i.data[a];(l>0||l<0)&&(s.id.includes(l)?s.surface[s.id.indexOf(l)]+=1:(s.id.push(l),s.surface.push(1)))}for(let t=0;t<s.id.length;t++)Math.sign(s.id[t])===r?s.same+=s.surface[t]:s.opposite+=s.surface[t],s.roiSurfaceCovered[t]=s.surface[t]/n.length;return s.total=s.opposite+s.same,s}const M_=Object.prototype.toString;class R_{constructor(e,n,i,r){if(1===arguments.length?(r=e,({width:e,height:n,data:i}=r)):i&&!i.length&&(r=i,({data:i}=r)),void 0===e&&(e=1),void 0===n&&(n=1),void 0===r&&(r={}),"object"!=typeof r||null===r)throw new TypeError("options must be an object");if(!Number.isInteger(e)||e<=0)throw new RangeError("width must be a positive integer");if(!Number.isInteger(n)||n<=0)throw new RangeError("height must be a positive integer");const{kind:s=Fm}=r;if("string"!=typeof s)throw new TypeError("kind must be a string");const o=function(t){const e=zm[t];if(!e)throw new RangeError(`invalid image kind: ${t}`);return e}(s),a=Object.assign({},r);for(const t in o)void 0===a[t]&&(a[t]=o[t]);!function(e){const{components:n,alpha:i,bitDepth:r,colorModel:s}=e;if(!Number.isInteger(n)||n<=0)throw new RangeError(`invalid components: ${n}. Must be a positive integer`);if(0!==i&&1!==i&&"boolean"!=typeof i)throw new TypeError(`invalid alpha: ${i}: must be a boolean, 0 or 1`);if(!Gm.includes(r))throw new RangeError(`invalid bitDepth: ${r}. Must be one of ${Gm.join(", ")}`);if(!t[s])throw new RangeError(`invalid colorModel: ${s}. Must be one of ${Object.keys(t).join(", ")}`)}(a);const{components:l,bitDepth:h,colorModel:u}=a,c=a.alpha+0,f=e*n,d=l+c,g=32===h?Number.MAX_VALUE:2**h-1;if(void 0===i)i=function(t,e,n,i,r,s){const o=i*t;let a;switch(r){case 1:a=new Uint8Array(Math.ceil(o/8));break;case 8:a=new Uint8Array(o);break;case 16:a=new Uint16Array(o);break;case 32:a=new Float32Array(o);break;default:throw new Error(`Cannot create pixel array for bit depth ${r}`)}if(n)for(let t=e;t<a.length;t+=i)a[t]=s;return a}(f,l,c,d,h,g);else{const t=function(t,e,n){let i=e*t;return 1===n&&(i=Math.ceil(i/8)),i}(f,d,h);if(i.length!==t)throw new RangeError(`incorrect data size: ${i.length}. Should be ${t}`)}this.width=e,this.height=n,this.data=i,this.size=f,this.components=l,this.alpha=c,this.bitDepth=h,this.maxValue=g,this.colorModel=u,this.channels=d,this.meta=r.meta||{},Object.defineProperty(this,"parent",{enumerable:!1,writable:!0,configurable:!0,value:r.parent||null}),this.position=r.position||[0,0],this.computed=null,this.sizes=[this.width,this.height],this.multiplierX=this.channels,this.multiplierY=this.channels*this.width,this.isClamped=this.bitDepth<32,this.borderSizes=[0,0]}get[Symbol.toStringTag](){return"IJSImage"}static isImage(t){return"[object IJSImage]"===M_.call(t)}static fromCanvas(t){const e=t.getContext("2d").getImageData(0,0,t.width,t.height);return new R_(e.width,e.height,e.data)}static createFrom(t,e){const n=Ty(t);return Object.assign(n,{parent:t,position:[0,0]},e),new R_(n)}getRoiManager(t){return new I_(this,t)}clone(){const t=this.data.slice();return new R_(this.width,this.height,t,this)}apply(t){for(let e=0;e<this.height;e++)for(let n=0;n<this.width;n++){let i=(e*this.width+n)*this.channels;t.call(this,i)}}}!function(t){for(const e in Py)t.prototype[e]=Py[e]}(R_),function(t){for(const e in Nf)t.prototype[e]=Nf[e]}(R_),function(t){for(const e in Mm)t.prototype[e]=Mm[e]}(R_),R_.prototype.checkProcessable=function(t,e={}){let{bitDepth:n,alpha:i,colorModel:r,components:s,channels:o}=e;if("string"!=typeof t||0===t.length)throw new TypeError("processName must be a string");if(n&&(Array.isArray(n)||(n=[n]),!n.includes(this.bitDepth)))throw new TypeError(`The process: ${t} can only be applied if bit depth is in: ${n}`);if(i&&(Array.isArray(i)||(i=[i]),!i.includes(this.alpha)))throw new TypeError(`The process: ${t} can only be applied if alpha is in: ${i}`);if(r&&(Array.isArray(r)||(r=[r]),!r.includes(this.colorModel)))throw new TypeError(`The process: ${t} can only be applied if color model is in: ${r}`);if(s&&(Array.isArray(s)||(s=[s]),!s.includes(this.components))){let e=`The process: ${t} can only be applied if the number of components is in: ${s}`;throw 1===s.length&&1===s[0]?new TypeError(`${e}.\rYou should transform your image using "image.grey()" before applying the algorithm.`):new TypeError(e)}if(o&&(Array.isArray(o)||(o=[o]),!o.includes(this.channels)))throw new TypeError(`The process: ${t} can only be applied if the number of channels is in: ${o}`)},R_.prototype.getRGBAData=function(t={}){const{clamped:e}=t;this.checkProcessable("getRGBAData",{components:[1,3],bitDepth:[1,8,16,32]});const n=this.width*this.height*4;let i=e?new Uint8ClampedArray(n):new Uint8Array(n);return 1===this.bitDepth?function(t,e){for(let n=0;n<t.size;n++){const i=t.getBit(n);e[4*n]=255*i,e[4*n+1]=255*i,e[4*n+2]=255*i}}(this,i):32===this.bitDepth?(this.checkProcessable("getRGBAData",{alpha:0}),1===this.components?function(t,e){const n=t.min[0],i=t.max[0]-n;for(let r=0;r<t.size;r++){const s=Math.floor(255*(t.data[r]-n)/i);e[4*r]=s,e[4*r+1]=s,e[4*r+2]=s}}(this,i):3===this.components&&(this.checkProcessable("getRGBAData",{colorModel:[Am]}),function(t,e){const n=Math.min(...t.min),i=Math.max(...t.max)-n;for(let r=0;r<t.size;r++){const s=Math.floor(255*(t.data[3*r]-n)/i),o=Math.floor(255*(t.data[3*r+1]-n)/i),a=Math.floor(255*(t.data[3*r+2]-n)/i);e[4*r]=s,e[4*r+1]=o,e[4*r+2]=a}}(this,i))):1===this.components?function(t,e){for(let n=0;n<t.size;n++)e[4*n]=t.data[n*t.channels]>>>t.bitDepth-8,e[4*n+1]=t.data[n*t.channels]>>>t.bitDepth-8,e[4*n+2]=t.data[n*t.channels]>>>t.bitDepth-8}(this,i):3===this.components&&(this.checkProcessable("getRGBAData",{colorModel:[Am]}),function(t,e){for(let n=0;n<t.size;n++)e[4*n]=t.data[n*t.channels]>>>t.bitDepth-8,e[4*n+1]=t.data[n*t.channels+1]>>>t.bitDepth-8,e[4*n+2]=t.data[n*t.channels+2]>>>t.bitDepth-8}(this,i)),1===this.alpha?(this.checkProcessable("getRGBAData",{bitDepth:[8,16]}),function(t,e){for(let n=0;n<t.size;n++)e[4*n+3]=t.data[n*t.channels+t.components]>>t.bitDepth-8}(this,i)):function(t,e){for(let n=0;n<t.size;n++)e[4*n+3]=255}(this,i),i},R_.load=function(t,e){if("string"==typeof t)return function(t,e){const n=t.slice(0,64).match(Sy);let i;return i=null!==n?Promise.resolve(function(t){let e,n,i,r,s=.75*t.length,o=t.length,a=0;"="===t[t.length-1]&&(s--,"="===t[t.length-2]&&s--);const l=new Uint8Array(s);for(let s=0;s<o;s+=4)e=xm[t.charCodeAt(s)],n=xm[t.charCodeAt(s+1)],i=xm[t.charCodeAt(s+2)],r=xm[t.charCodeAt(s+3)],l[a++]=e<<2|n>>4,l[a++]=(15&n)<<4|i>>2,l[a++]=(3&i)<<6|63&r;return l}(t.slice(n[0].length))):function(t,{withCredentials:e=!1}={}){return new Promise((function(n,i){let r=new self.XMLHttpRequest;r.open("GET",t,!0),r.responseType="arraybuffer",r.withCredentials=e,r.onload=function(t){200!==this.status?i(t):n(this.response)},r.onerror=i,r.send()}))}(t,e),i.then((i=>Iy(new Uint8Array(i),n?t:void 0,e&&e.ignorePalette)))}(t,e);if(t instanceof ArrayBuffer)return Promise.resolve(Iy(new Uint8Array(t),void 0,e&&e.ignorePalette));if(t.buffer)return Promise.resolve(Iy(t,void 0,e&&e.ignorePalette));throw new Error('argument to "load" must be a string or buffer.')},R_.extendMethod=function(t,e,n={}){let{inPlace:i=!1,returnThis:r=!0,partialArgs:s=[]}=n;return R_.prototype[t]=i?function(...t){this.computed=null;let n=e.apply(this,[...s,...t]);return r?this:n}:function(...t){return e.apply(this,[...s,...t])},R_},R_.extendProperty=function(t,e,n={}){let{partialArgs:i=[]}=n;return Tm.get=function(){if(null===this.computed)this.computed={};else if(Pm()(t,this.computed))return this.computed[t];let n=e.apply(this,i);return this.computed[t]=n,n},Object.defineProperty(R_.prototype,t,Tm),R_},function(t){let e={inPlace:!0};t.extendMethod("invert",Ly),t.extendMethod("abs",ky),t.extendMethod("level",dv,e),t.extendMethod("add",yv,e),t.extendMethod("subtract",vv,e),t.extendMethod("subtractImage",wv),t.extendMethod("multiply",_v,e),t.extendMethod("divide",bv,e),t.extendMethod("hypotenuse",xv),t.extendMethod("background",Pv),t.extendMethod("flipX",Oy),t.extendMethod("flipY",Dy),t.extendMethod("blurFilter",Fy),t.extendMethod("medianFilter",qy),t.extendMethod("gaussianFilter",Vy),t.extendMethod("sobelFilter",lv),t.extendMethod("gradientFilter",av),t.extendMethod("scharrFilter",hv),t.extendMethod("dilate",Tv),t.extendMethod("erode",Ov),t.extendMethod("open",Bv),t.extendMethod("close",Uv),t.extendMethod("topHat",qv),t.extendMethod("blackHat",Vv),t.extendMethod("morphologicalGradient",Yv),t.extendMethod("warpingFourPoints",$v),t.extendMethod("crop",Zv),t.extendMethod("cropAlpha",Kv),t.extendMethod("resize",nw).extendMethod("scale",nw),t.extendMethod("hsv",iw),t.extendMethod("hsl",rw),t.extendMethod("cmyk",sw),t.extendMethod("rgba8",ow),t.extendMethod("grey",hw).extendMethod("gray",hw),t.extendMethod("mask",_w),t.extendMethod("pad",bw),t.extendMethod("colorDepth",Ew),t.extendMethod("setBorder",Tw,e),t.extendMethod("rotate",Iw),t.extendMethod("rotateLeft",Cw),t.extendMethod("rotateRight",Mw),t.extendMethod("insert",Pw),t.extendMethod("getRow",Bw),t.extendMethod("getColumn",Uw),t.extendMethod("getMatrix",qw),t.extendMethod("setMatrix",Vw),t.extendMethod("getPixelsArray",Yw),t.extendMethod("getIntersection",Xw),t.extendMethod("getClosestCommonParent",Ww),t.extendMethod("getThreshold",ww),t.extendMethod("split",Nw),t.extendMethod("getChannel",Aw),t.extendMethod("combineChannels",kw),t.extendMethod("setChannel",Ow),t.extendMethod("getSimilarity",Dw),t.extendMethod("getPixelsGrid",Fw),t.extendMethod("getBestMatch",Gw),t.extendMethod("cannyEdge",tx),t.extendMethod("convolution",ov),t.extendMethod("extract",ex),t.extendMethod("floodFill",rx),t.extendMethod("paintLabels",dx,e),t.extendMethod("paintMasks",gx,e),t.extendMethod("paintPoints",wx,e),t.extendMethod("paintPolyline",xx,e),t.extendMethod("paintPolylines",_x,e),t.extendMethod("paintPolygon",bx,e),t.extendMethod("paintPolygons",Ix,e),t.extendMethod("countAlphaPixels",Bx),t.extendMethod("monotoneChainConvexHull",Yx),t.extendMethod("minimalBoundingRectangle",Kx),t.extendMethod("getHistogram",Cx).extendProperty("histogram",Cx),t.extendMethod("getHistograms",Mx).extendProperty("histograms",Mx),t.extendMethod("getColorHistogram",Px).extendProperty("colorHistogram",Px),t.extendMethod("getMin",Tx).extendProperty("min",Tx),t.extendMethod("getMax",Nx).extendProperty("max",Nx),t.extendMethod("getSum",Ax).extendProperty("sum",Ax),t.extendMethod("getMoment",kx).extendProperty("moment",kx),t.extendMethod("getLocalMaxima",Lx),t.extendMethod("getMedian",Dx).extendProperty("median",Dx),t.extendMethod("getMean",Ox).extendProperty("mean",Ox),t.extendMethod("getPoints",Fx).extendProperty("points",Fx),t.extendMethod("getExtendedPoints",zx).extendProperty("extendedPoints",zx),t.extendMethod("getRelativePosition",Gx)}(R_);var P_=__webpack_require__(6732),T_=__webpack_require__.n(P_);const N_={regression:{kernelType:"polynomial",kernelOptions:{degree:2,constant:1}},threshold:.02,roi:{minSurface:100,positive:!1},sampling:20,include:[]};function A_(t,e,n){return t.post("data",[e,n]).then((function(t){for(let e in t)t[e]=new R_(t[e]);return t}))}const k_={run:function(t,e,n){e=Object.assign({},N_,e);const i=this.manager;return Array.isArray(t)?Promise.all(t.map((function(t){const r=A_(i,t,e);return"function"==typeof n&&r.then(n),r}))):A_(i,t,e)},work:function(){worker.on("data",(function(t,e,n){e=new IJS(e);const i={},r=[],s=e.grey(),o=s.sobelFilter();d("sobel",o);const a=o.level().mask({threshold:n.threshold});d("mask",a);const l=o.getRoiManager();l.fromMask(a);const h=l.getMask(n.roi);d("realMask",h);const u=s.getPixelsGrid({sampling:n.sampling,mask:h}),c=e.getBackground(u.xyS,u.zS,n.regression);d("background",c);const f=e.subtract(c);function d(t,e){n.include.includes(t)&&(i[t]=e,r.push(e.data.buffer))}i.result=f,r.push(f.data.buffer),t(i,r)}))}},L_=k_;class O_{constructor(){this._url=null,this._deps=[null]}checkUrl(){if(null===this._url)throw new Error("image worker must be initialized with an URL")}get url(){return this._url}set url(t){if("string"!=typeof t)throw new TypeError("worker URL must be a string");this._url=t,this._deps[0]=t}static extendMethod(t,e){let n,i,r={};function s(...t){return n||(this.checkUrl(),i=this.url,n=new(T_())(e.work,{deps:i}),r.manager=n),e.run.call(r,...t)}s.reset=function(){n&&(n.terminate(),n=new(T_())(e.work,{deps:i}),r.manager=n)},O_.prototype[t]=s}}function D_(t,e,n){let i=[],r=0,s=new ImageData(t.width,t.height),o=[F_(e[0],e[1],e[2]),z_(e[0],e[1],e[2]),G_(e[0],e[1],e[2])];for(let e=0;e<t.data.length;e+=4){let a=t.data[e],l=t.data[e+1],h=t.data[e+2],u=[F_(a,l,h),z_(a,l,h),G_(a,l,h)],c=Math.sqrt(.5053*Math.pow(u[0]-o[0],2)+.299*Math.pow(u[1]-o[1],2)+.1957*Math.pow(u[2]-o[2],2));i.push(c),Math.abs(c)<=n?(s.data[e]=255,s.data[e+3]=255,r++):s.data[e+3]=255}return[s,r]}function F_(t,e,n){return.29889531*t+.58662247*e+.11448223*n}function z_(t,e,n){return.59597799*t-.2741761*e-.32180189*n}function G_(t,e,n){return.21147017*t-.52261711*e+.31114694*n}function B_(t,e,n,i){let r=t.contour,s=(t.color,{}),o=(i[2]-i[0])/e,a=(i[3]-i[1])/n;for(let t=0;t<r.length;t+=3){let e=r[t],n=r[t+1],i=r[t+2],o=[e,n,i];0===e&&0===n&&0===i||(o.toString()in s?s[o.toString()].push(t/3):s[o.toString()]=[t/3])}let l={type:"FeatureCollection",name:"polygonFeatures",crs:{type:"name",properties:{name:"EPSG:3857"}},features:[]},h=0;for(const t in s){h++;let n=[];for(let i=0;i<s[t].length;i++){let r=s[t][i]%e,o=Math.floor(s[t][i]/e);n.push([r,o])}if(n.length<=3)continue;let r,u=U_(n),c=[];for(let t=0;t<u.length;t++){let e=u[t][0],n=u[t][1];e=i[0]+e*o,n=i[3]-n*a,e=parseFloat(e.toFixed(2)),n=parseFloat(n.toFixed(2)),c.push([e,n]),0===t&&(r=[e,n])}c.push(r),c.length>=4&&l.features.push({type:"Feature",geometry:{type:"Polygon",coordinates:[c]},id:h})}return l}function U_(t){let e=t.slice(),n=[],i=e[0];n.push(i),e[0]=[NaN,NaN];let r=0,s=e.length-1,o=0;function a(t){return[[t[0]-1,t[1]-1],[t[0],t[1]-1],[t[0]+1,t[1]-1],[t[0]-1,t[1]],t,[t[0]+1,t[1]],[t[0]-1,t[1]+1],[t[0],t[1]+1],[t[0]+1,t[1]+1]]}for(let i=0;i<=n.length;i++){o++;let l=n.length,h=a(n[i]);t:for(let i=0;i<h.length;i++)for(let r=1;r<e.length&&4!==i;r++)if(h[i][0]===e[r][0]&&h[i][1]===e[r][1]&&NaN!=e[r][0]&&NaN!=e[r][1]){n.push(t[r]),e[r]=[NaN,NaN],s-=1;break t}if(n.length-l==0&&(n.pop(),i-=2,r+=1),o===e.length-1){console.log("breaked");break}}return n}!function(t){t.extendMethod("background",L_)}(O_),new O_;const q_=class{constructor(t){this.highWaterMark=void 0!==t?t:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}canExpireCache(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark}expireCache(t){for(;this.canExpireCache();)this.pop()}clear(){this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}containsKey(t){return this.entries_.hasOwnProperty(t)}forEach(t){let e=this.oldest_;for(;e;)t(e.value_,e.key_,this),e=e.newer}get(t,e){const n=this.entries_[t];return K(void 0!==n,"Tried to get a value for a key that does not exist in the cache"),n===this.newest_||(n===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(n.newer.older=n.older,n.older.newer=n.newer),n.newer=null,n.older=this.newest_,this.newest_.newer=n,this.newest_=n),n.value_}remove(t){const e=this.entries_[t];return K(void 0!==e,"Tried to get a value for a key that does not exist in the cache"),e===this.newest_?(this.newest_=e.older,this.newest_&&(this.newest_.newer=null)):e===this.oldest_?(this.oldest_=e.newer,this.oldest_&&(this.oldest_.older=null)):(e.newer.older=e.older,e.older.newer=e.newer),delete this.entries_[t],--this.count_,e.value_}getCount(){return this.count_}getKeys(){const t=new Array(this.count_);let e,n=0;for(e=this.newest_;e;e=e.older)t[n++]=e.key_;return t}getValues(){const t=new Array(this.count_);let e,n=0;for(e=this.newest_;e;e=e.older)t[n++]=e.value_;return t}peekLast(){return this.oldest_.value_}peekLastKey(){return this.oldest_.key_}peekFirstKey(){return this.newest_.key_}peek(t){return this.entries_[t]?.value_}pop(){const t=this.oldest_;return delete this.entries_[t.key_],t.newer&&(t.newer.older=null),this.oldest_=t.newer,this.oldest_||(this.newest_=null),--this.count_,t.value_}replace(t,e){this.get(t),this.entries_[t].value_=e}set(t,e){K(!(t in this.entries_),"Tried to set a value for a key that is used already");const n={key_:t,newer:null,older:this.newest_,value_:e};this.newest_?this.newest_.newer=n:this.oldest_=n,this.newest_=n,this.entries_[t]=n,++this.count_}setSize(t){this.highWaterMark=t}};function V_(t,e,n,i){return void 0!==i?(i[0]=t,i[1]=e,i[2]=n,i):[t,e,n]}function Y_(t,e,n){return t+"/"+e+"/"+n}function X_(t){return Y_(t[0],t[1],t[2])}function j_(t){return(t[1]<<t[0])+t[2]}const W_=class extends q_{clear(){for(;this.getCount()>0;)this.pop().release();super.clear()}expireCache(t){for(;this.canExpireCache()&&!(this.peekLast().getKey()in t);)this.pop().release()}pruneExceptNewestZ(){if(0===this.getCount())return;const t=(e=this.peekFirstKey(),e.split("/").map(Number))[0];var e;this.forEach((e=>{e.tileCoord[0]!==t&&(this.remove(X_(e.tileCoord)),e.release())}))}};function H_(t){return t?Array.isArray(t)?function(e){return t}:"function"==typeof t?t:function(e){return[t]}:null}const $_=class extends D{constructor(t){super(),this.projection=Pe(t.projection),this.attributions_=H_(t.attributions),this.attributionsCollapsible_=void 0===t.attributionsCollapsible||t.attributionsCollapsible,this.loading=!1,this.state_=void 0!==t.state?t.state:"ready",this.wrapX_=void 0!==t.wrapX&&t.wrapX,this.interpolate_=!!t.interpolate,this.viewResolver=null,this.viewRejector=null;const e=this;this.viewPromise_=new Promise((function(t,n){e.viewResolver=t,e.viewRejector=n}))}getAttributions(){return this.attributions_}getAttributionsCollapsible(){return this.attributionsCollapsible_}getProjection(){return this.projection}getResolutions(t){return null}getView(){return this.viewPromise_}getState(){return this.state_}getWrapX(){return this.wrapX_}getInterpolate(){return this.interpolate_}refresh(){this.changed()}setAttributions(t){this.attributions_=H_(t),this.changed()}setState(t){this.state_=t,this.changed()}},Z_=[0,0,0],K_=class{constructor(t){let e;if(this.minZoom=void 0!==t.minZoom?t.minZoom:0,this.resolutions_=t.resolutions,K(function(t,e,n){const i=((t,e)=>e-t)||a;return t.every((function(e,n){if(0===n)return!0;const r=i(t[n-1],e);return!(r>0||0===r)}))}(this.resolutions_),"`resolutions` must be sorted in descending order"),!t.origins)for(let t=0,n=this.resolutions_.length-1;t<n;++t)if(e){if(this.resolutions_[t]/this.resolutions_[t+1]!==e){e=void 0;break}}else e=this.resolutions_[t]/this.resolutions_[t+1];this.zoomFactor_=e,this.maxZoom=this.resolutions_.length-1,this.origin_=void 0!==t.origin?t.origin:null,this.origins_=null,void 0!==t.origins&&(this.origins_=t.origins,K(this.origins_.length==this.resolutions_.length,"Number of `origins` and `resolutions` must be equal"));const n=t.extent;void 0===n||this.origin_||this.origins_||(this.origin_=oe(n)),K(!this.origin_&&this.origins_||this.origin_&&!this.origins_,"Either `origin` or `origins` must be configured, never both"),this.tileSizes_=null,void 0!==t.tileSizes&&(this.tileSizes_=t.tileSizes,K(this.tileSizes_.length==this.resolutions_.length,"Number of `tileSizes` and `resolutions` must be equal")),this.tileSize_=void 0!==t.tileSize?t.tileSize:this.tileSizes_?null:pt,K(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,"Either `tileSize` or `tileSizes` must be configured, never both"),this.extent_=void 0!==n?n:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],void 0!==t.sizes?this.fullTileRanges_=t.sizes.map(((t,e)=>{const i=new Na(Math.min(0,t[0]),Math.max(t[0]-1,-1),Math.min(0,t[1]),Math.max(t[1]-1,-1));if(n){const t=this.getTileRangeForExtentAndZ(n,e);i.minX=Math.max(t.minX,i.minX),i.maxX=Math.min(t.maxX,i.maxX),i.minY=Math.max(t.minY,i.minY),i.maxY=Math.min(t.maxY,i.maxY)}return i})):n&&this.calculateTileRanges_(n)}forEachTileCoord(t,e,n){const i=this.getTileRangeForExtentAndZ(t,e);for(let t=i.minX,r=i.maxX;t<=r;++t)for(let r=i.minY,s=i.maxY;r<=s;++r)n([e,t,r])}forEachTileCoordParentTileRange(t,e,n,i){let r,s,o,a=null,l=t[0]-1;for(2===this.zoomFactor_?(s=t[1],o=t[2]):a=this.getTileCoordExtent(t,i);l>=this.minZoom;){if(void 0!==s&&void 0!==o?(s=Math.floor(s/2),o=Math.floor(o/2),r=Ta(s,s,o,o,n)):r=this.getTileRangeForExtentAndZ(a,l,n),e(l,r))return!0;--l}return!1}getExtent(){return this.extent_}getMaxZoom(){return this.maxZoom}getMinZoom(){return this.minZoom}getOrigin(t){return this.origin_?this.origin_:this.origins_[t]}getResolution(t){return this.resolutions_[t]}getResolutions(){return this.resolutions_}getTileCoordChildTileRange(t,e,n){if(t[0]<this.maxZoom){if(2===this.zoomFactor_){const n=2*t[1],i=2*t[2];return Ta(n,n+1,i,i+1,e)}const i=this.getTileCoordExtent(t,n||this.tmpExtent_);return this.getTileRangeForExtentAndZ(i,t[0]+1,e)}return null}getTileRangeForTileCoordAndZ(t,e,n){if(e>this.maxZoom||e<this.minZoom)return null;const i=t[0],r=t[1],s=t[2];if(e===i)return Ta(r,s,r,s,n);if(this.zoomFactor_){const t=Math.pow(this.zoomFactor_,e-i),o=Math.floor(r*t),a=Math.floor(s*t);return e<i?Ta(o,o,a,a,n):Ta(o,Math.floor(t*(r+1))-1,a,Math.floor(t*(s+1))-1,n)}const o=this.getTileCoordExtent(t,this.tmpExtent_);return this.getTileRangeForExtentAndZ(o,e,n)}getTileRangeForExtentAndZ(t,e,n){this.getTileCoordForXYAndZ_(t[0],t[3],e,!1,Z_);const i=Z_[1],r=Z_[2];return this.getTileCoordForXYAndZ_(t[2],t[1],e,!0,Z_),Ta(i,Z_[1],r,Z_[2],n)}getTileCoordCenter(t){const e=this.getOrigin(t[0]),n=this.getResolution(t[0]),i=wi(this.getTileSize(t[0]),this.tmpSize_);return[e[0]+(t[1]+.5)*i[0]*n,e[1]-(t[2]+.5)*i[1]*n]}getTileCoordExtent(t,e){const n=this.getOrigin(t[0]),i=this.getResolution(t[0]),r=wi(this.getTileSize(t[0]),this.tmpSize_),s=n[0]+t[1]*r[0]*i,o=n[1]-(t[2]+1)*r[1]*i;return Ut(s,o,s+r[0]*i,o+r[1]*i,e)}getTileCoordForCoordAndResolution(t,e,n){return this.getTileCoordForXYAndResolution_(t[0],t[1],e,!1,n)}getTileCoordForXYAndResolution_(t,e,n,i,r){const s=this.getZForResolution(n),o=n/this.getResolution(s),a=this.getOrigin(s),l=wi(this.getTileSize(s),this.tmpSize_);let h=o*(t-a[0])/n/l[0],u=o*(a[1]-e)/n/l[1];return i?(h=at(h,5)-1,u=at(u,5)-1):(h=ot(h,5),u=ot(u,5)),V_(s,h,u,r)}getTileCoordForXYAndZ_(t,e,n,i,r){const s=this.getOrigin(n),o=this.getResolution(n),a=wi(this.getTileSize(n),this.tmpSize_);let l=(t-s[0])/o/a[0],h=(s[1]-e)/o/a[1];return i?(l=at(l,5)-1,h=at(h,5)-1):(l=ot(l,5),h=ot(h,5)),V_(n,l,h,r)}getTileCoordForCoordAndZ(t,e,n){return this.getTileCoordForXYAndZ_(t[0],t[1],e,!1,n)}getTileCoordResolution(t){return this.resolutions_[t[0]]}getTileSize(t){return this.tileSize_?this.tileSize_:this.tileSizes_[t]}getFullTileRange(t){return this.fullTileRanges_?this.fullTileRanges_[t]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,t):null}getZForResolution(t,e){return J(l(this.resolutions_,t,e||0),this.minZoom,this.maxZoom)}tileCoordIntersectsViewport(t,e){return Hn(e,0,e.length,2,this.getTileCoordExtent(t))}calculateTileRanges_(t){const e=this.resolutions_.length,n=new Array(e);for(let i=this.minZoom;i<e;++i)n[i]=this.getTileRangeForExtentAndZ(t,i);this.fullTileRanges_=n}};function J_(t){let e=t.getDefaultTileGrid();return e||(e=function(t,e,n,i){return function(t,e,n,i){i=void 0!==i?i:"top-left";const r=tb(t,undefined,n);return new K_({extent:t,origin:ee(t,i),resolutions:r,tileSize:n})}(eb(t),0,void 0,void 0)}(t),t.setDefaultTileGrid(e)),e}function Q_(t){const e=t||{},n=e.extent||Pe("EPSG:3857").getExtent(),i={extent:n,minZoom:e.minZoom,tileSize:e.tileSize,resolutions:tb(n,e.maxZoom,e.tileSize,e.maxResolution)};return new K_(i)}function tb(t,e,n,i){e=void 0!==e?e:gt,n=wi(void 0!==n?n:pt);const r=re(t),s=le(t);i=i>0?i:Math.max(s/n[0],r/n[1]);const o=e+1,a=new Array(o);for(let t=0;t<o;++t)a[t]=i/Math.pow(2,t);return a}function eb(t){let e=(t=Pe(t)).getExtent();if(!e){const n=180*mt.degrees/t.getMetersPerUnit();e=Ut(-n,-n,n,n)}return e}class nb extends r{constructor(t,e){super(t),this.tile=e}}const ib=class extends $_{constructor(t){super({attributions:t.attributions,attributionsCollapsible:t.attributionsCollapsible,projection:t.projection,state:t.state,wrapX:t.wrapX,interpolate:t.interpolate}),this.on,this.once,this.un,this.opaque_=void 0!==t.opaque&&t.opaque,this.tilePixelRatio_=void 0!==t.tilePixelRatio?t.tilePixelRatio:1,this.tileGrid=void 0!==t.tileGrid?t.tileGrid:null;this.tileGrid&&wi(this.tileGrid.getTileSize(this.tileGrid.getMinZoom()),[256,256]),this.tileCache=new W_(t.cacheSize||0),this.tmpSize=[0,0],this.key_=t.key||"",this.tileOptions={transition:t.transition,interpolate:t.interpolate},this.zDirection=t.zDirection?t.zDirection:0}canExpireCache(){return this.tileCache.canExpireCache()}expireCache(t,e){const n=this.getTileCacheForProjection(t);n&&n.expireCache(e)}forEachLoadedTile(t,e,n,i){const r=this.getTileCacheForProjection(t);if(!r)return!1;let s,o,a,l=!0;for(let t=n.minX;t<=n.maxX;++t)for(let h=n.minY;h<=n.maxY;++h)o=Y_(e,t,h),a=!1,r.containsKey(o)&&(s=r.get(o),a=s.getState()===Eo,a&&(a=!1!==i(s))),a||(l=!1);return l}getGutterForProjection(t){return 0}getKey(){return this.key_}setKey(t){this.key_!==t&&(this.key_=t,this.changed())}getOpaque(t){return this.opaque_}getResolutions(t){const e=t?this.getTileGridForProjection(t):this.tileGrid;return e?e.getResolutions():null}getTile(t,e,n,i,r){return A()}getTileGrid(){return this.tileGrid}getTileGridForProjection(t){return this.tileGrid?this.tileGrid:J_(t)}getTileCacheForProjection(t){const e=this.getProjection();return K(null===e||Le(e,t),"A VectorTile source can only be rendered if it has a projection compatible with the view projection."),this.tileCache}getTilePixelRatio(t){return this.tilePixelRatio_}getTilePixelSize(t,e,n){const i=this.getTileGridForProjection(n),r=this.getTilePixelRatio(e),s=wi(i.getTileSize(t),this.tmpSize);return 1==r?s:vi(s,r,this.tmpSize)}getTileCoordForTileUrlFunction(t,e){e=void 0!==e?e:this.getProjection();const n=this.getTileGridForProjection(e);return this.getWrapX()&&e.isGlobal()&&(t=function(t,e,n){const i=e[0],r=t.getTileCoordCenter(e),s=eb(n);if(!Ft(s,r)){const e=le(s),n=Math.ceil((s[0]-r[0])/e);return r[0]+=e*n,t.getTileCoordForCoordAndZ(r,i)}return e}(n,t,e)),function(t,e){const n=t[0],i=t[1],r=t[2];if(e.getMinZoom()>n||n>e.getMaxZoom())return!1;const s=e.getFullTileRange(n);return!s||s.containsXY(i,r)}(t,n)?t:null}clear(){this.tileCache.clear()}refresh(){this.clear(),super.refresh()}updateCacheSize(t,e){const n=this.getTileCacheForProjection(e);t>n.highWaterMark&&(n.highWaterMark=t)}useTile(t,e,n,i){}};function rb(t,e){const n=/\{z\}/g,i=/\{x\}/g,r=/\{y\}/g,s=/\{-y\}/g;return function(o,a,l){if(o)return t.replace(n,o[0].toString()).replace(i,o[1].toString()).replace(r,o[2].toString()).replace(s,(function(){const t=o[0],n=e.getFullTileRange(t);if(!n)throw new Error("The {-y} placeholder requires a tile grid with extent");return(n.getHeight()-o[2]-1).toString()}))}}function sb(t){return 1===t.length?t[0]:function(e,n,i){if(!e)return;const r=nt(j_(e),t.length);return t[r](e,n,i)}}function ob(t){const e=[];let n=/\{([a-z])-([a-z])\}/.exec(t);if(n){const i=n[1].charCodeAt(0),r=n[2].charCodeAt(0);let s;for(s=i;s<=r;++s)e.push(t.replace(n[0],String.fromCharCode(s)));return e}if(n=/\{(\d+)-(\d+)\}/.exec(t),n){const i=parseInt(n[2],10);for(let r=parseInt(n[1],10);r<=i;r++)e.push(t.replace(n[0],r.toString()));return e}return e.push(t),e}class ab extends ib{constructor(t){super({attributions:t.attributions,cacheSize:t.cacheSize,opaque:t.opaque,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tilePixelRatio:t.tilePixelRatio,wrapX:t.wrapX,transition:t.transition,interpolate:t.interpolate,key:t.key,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection}),this.generateTileUrlFunction_=this.tileUrlFunction===ab.prototype.tileUrlFunction,this.tileLoadFunction=t.tileLoadFunction,t.tileUrlFunction&&(this.tileUrlFunction=t.tileUrlFunction),this.urls=null,t.urls?this.setUrls(t.urls):t.url&&this.setUrl(t.url),this.tileLoadingKeys_={}}getTileLoadFunction(){return this.tileLoadFunction}getTileUrlFunction(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction}getUrls(){return this.urls}handleTileChange(t){const e=t.target,n=L(e),i=e.getState();let r;i==bo?(this.tileLoadingKeys_[n]=!0,r="tileloadstart"):n in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[n],r=i==So?"tileloaderror":i==Eo?"tileloadend":void 0),null!=r&&this.dispatchEvent(new nb(r,e))}setTileLoadFunction(t){this.tileCache.clear(),this.tileLoadFunction=t,this.changed()}setTileUrlFunction(t,e){this.tileUrlFunction=t,this.tileCache.pruneExceptNewestZ(),void 0!==e?this.setKey(e):this.changed()}setUrl(t){const e=ob(t);this.urls=e,this.setUrls(e)}setUrls(t){this.urls=t;const e=t.join("\n");this.generateTileUrlFunction_?this.setTileUrlFunction(function(t,e){const n=t.length,i=new Array(n);for(let r=0;r<n;++r)i[r]=rb(t[r],e);return sb(i)}(t,this.tileGrid),e):this.setKey(e)}tileUrlFunction(t,e,n){}useTile(t,e,n){const i=Y_(t,e,n);this.tileCache.containsKey(i)&&this.tileCache.get(i)}}const lb=ab;function hb(t,e){t.getImage().src=e}const ub=class extends lb{constructor(t){super({attributions:t.attributions,cacheSize:t.cacheSize,opaque:t.opaque,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tileLoadFunction:t.tileLoadFunction?t.tileLoadFunction:hb,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:t.wrapX,transition:t.transition,interpolate:void 0===t.interpolate||t.interpolate,key:t.key,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection}),this.crossOrigin=void 0!==t.crossOrigin?t.crossOrigin:null,this.tileClass=void 0!==t.tileClass?t.tileClass:xa,this.tileCacheForProjection={},this.tileGridForProjection={},this.reprojectionErrorThreshold_=t.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1}canExpireCache(){if(this.tileCache.canExpireCache())return!0;for(const t in this.tileCacheForProjection)if(this.tileCacheForProjection[t].canExpireCache())return!0;return!1}expireCache(t,e){const n=this.getTileCacheForProjection(t);this.tileCache.expireCache(this.tileCache==n?e:{});for(const t in this.tileCacheForProjection){const i=this.tileCacheForProjection[t];i.expireCache(i==n?e:{})}}getGutterForProjection(t){return this.getProjection()&&t&&!Le(this.getProjection(),t)?0:this.getGutter()}getGutter(){return 0}getKey(){let t=super.getKey();return this.getInterpolate()||(t+=":disable-interpolation"),t}getOpaque(t){return!(this.getProjection()&&t&&!Le(this.getProjection(),t))&&super.getOpaque(t)}getTileGridForProjection(t){const e=this.getProjection();if(this.tileGrid&&(!e||Le(e,t)))return this.tileGrid;const n=L(t);return n in this.tileGridForProjection||(this.tileGridForProjection[n]=J_(t)),this.tileGridForProjection[n]}getTileCacheForProjection(t){const e=this.getProjection();if(!e||Le(e,t))return this.tileCache;const n=L(t);return n in this.tileCacheForProjection||(this.tileCacheForProjection[n]=new W_(this.tileCache.highWaterMark)),this.tileCacheForProjection[n]}createTile_(t,e,n,i,r,s){const o=[t,e,n],a=this.getTileCoordForTileUrlFunction(o,r),l=a?this.tileUrlFunction(a,i,r):void 0,h=new this.tileClass(o,void 0!==l?_o:Io,void 0!==l?l:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return h.key=s,h.addEventListener(x,this.handleTileChange.bind(this)),h}getTile(t,e,n,i,r){const s=this.getProjection();if(!s||!r||Le(s,r))return this.getTileInternal(t,e,n,i,s||r);const o=this.getTileCacheForProjection(r),a=[t,e,n];let l;const h=X_(a);o.containsKey(h)&&(l=o.get(h));const u=this.getKey();if(l&&l.key==u)return l;const c=this.getTileGridForProjection(s),f=this.getTileGridForProjection(r),d=this.getTileCoordForTileUrlFunction(a,r),g=new Ra(s,c,r,f,a,d,this.getTilePixelRatio(i),this.getGutter(),((t,e,n,i)=>this.getTileInternal(t,e,n,i,s)),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.tileOptions);return g.key=u,l?(g.interimTile=l,g.refreshInterimChain(),o.replace(h,g)):o.set(h,g),g}getTileInternal(t,e,n,i,r){let s=null;const o=Y_(t,e,n),a=this.getKey();if(this.tileCache.containsKey(o)){if(s=this.tileCache.get(o),s.key!=a){const l=s;s=this.createTile_(t,e,n,i,r,a),l.getState()==_o?s.interimTile=l.interimTile:s.interimTile=l,s.refreshInterimChain(),this.tileCache.replace(o,s)}}else s=this.createTile_(t,e,n,i,r,a),this.tileCache.set(o,s);return s}setRenderReprojectionEdges(t){if(this.renderReprojectionEdges_!=t){this.renderReprojectionEdges_=t;for(const t in this.tileCacheForProjection)this.tileCacheForProjection[t].clear();this.changed()}}setTileGridForProjection(t,e){const n=Pe(t);if(n){const t=L(n);t in this.tileGridForProjection||(this.tileGridForProjection[t]=e)}}clear(){super.clear();for(const t in this.tileCacheForProjection)this.tileCacheForProjection[t].clear()}},cb=class extends ub{constructor(t){const e=void 0!==(t=t||{}).projection?t.projection:"EPSG:3857",n=void 0!==t.tileGrid?t.tileGrid:Q_({extent:eb(e),maxResolution:t.maxResolution,maxZoom:t.maxZoom,minZoom:t.minZoom,tileSize:t.tileSize});super({attributions:t.attributions,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,interpolate:t.interpolate,opaque:t.opaque,projection:e,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileGrid:n,tileLoadFunction:t.tileLoadFunction,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:void 0===t.wrapX||t.wrapX,transition:t.transition,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection}),this.gutter_=void 0!==t.gutter?t.gutter:0}getGutter(){return this.gutter_}},fb=class extends cb{constructor(t){let e;e=void 0!==(t=t||{}).attributions?t.attributions:['&#169; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors.'];const n=void 0!==t.crossOrigin?t.crossOrigin:"anonymous",i=void 0!==t.url?t.url:"https://tile.openstreetmap.org/{z}/{x}/{y}.png";super({attributions:e,attributionsCollapsible:!1,cacheSize:t.cacheSize,crossOrigin:n,interpolate:t.interpolate,maxZoom:void 0!==t.maxZoom?t.maxZoom:19,opaque:void 0===t.opaque||t.opaque,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileLoadFunction:t.tileLoadFunction,transition:t.transition,url:i,wrapX:t.wrapX,zDirection:t.zDirection})}},db=class extends ub{constructor(t){const e=void 0!==t.hidpi&&t.hidpi;super({cacheSize:t.cacheSize,crossOrigin:"anonymous",interpolate:t.interpolate,opaque:!0,projection:Pe("EPSG:3857"),reprojectionErrorThreshold:t.reprojectionErrorThreshold,state:"loading",tileLoadFunction:t.tileLoadFunction,tilePixelRatio:e?2:1,wrapX:void 0===t.wrapX||t.wrapX,transition:t.transition,zDirection:t.zDirection}),this.hidpi_=e,this.culture_=void 0!==t.culture?t.culture:"en-us",this.maxZoom_=void 0!==t.maxZoom?t.maxZoom:-1,this.apiKey_=t.key,this.imagerySet_=t.imagerySet,this.placeholderTiles_=t.placeholderTiles;const n="https://dev.virtualearth.net/REST/v1/Imagery/Metadata/"+this.imagerySet_+"?uriScheme=https&include=ImageryProviders&key="+this.apiKey_+"&c="+this.culture_;fetch(n).then((t=>t.json())).then((t=>this.handleImageryMetadataResponse(t)))}getApiKey(){return this.apiKey_}getImagerySet(){return this.imagerySet_}handleImageryMetadataResponse(t){if(200!=t.statusCode||"OK"!=t.statusDescription||"ValidCredentials"!=t.authenticationResultCode||1!=t.resourceSets.length||1!=t.resourceSets[0].resources.length)return void this.setState("error");const e=t.resourceSets[0].resources[0],n=-1==this.maxZoom_?e.zoomMax:this.maxZoom_,i=eb(this.getProjection()),r=this.hidpi_?2:1,s=e.imageWidth==e.imageHeight?e.imageWidth/r:[e.imageWidth/r,e.imageHeight/r],o=Q_({extent:i,minZoom:e.zoomMin,maxZoom:n,tileSize:s});this.tileGrid=o;const a=this.culture_,l=this.hidpi_,h=this.placeholderTiles_;if(this.tileUrlFunction=sb(e.imageUrlSubdomains.map((function(t){const n=[0,0,0],i=e.imageUrl.replace("{subdomain}",t).replace("{culture}",a);return function(t,e,r){if(!t)return;V_(t[0],t[1],t[2],n);const s=new URL(i.replace("{quadkey}",function(t){const e=t[0],n=new Array(e);let i,r,s=1<<e-1;for(i=0;i<e;++i)r=48,t[1]&s&&(r+=1),t[2]&s&&(r+=2),n[i]=String.fromCharCode(r),s>>=1;return n.join("")}(n))),o=s.searchParams;return l&&(o.set("dpi","d1"),o.set("device","mobile")),!0===h?o.delete("n"):!1===h&&o.set("n","z"),s.toString()}}))),e.imageryProviders){const t=Oe(Pe("EPSG:4326"),this.getProjection());this.setAttributions((n=>{const i=[],r=n.viewState,s=this.getTileGrid(),o=s.getZForResolution(r.resolution,this.zDirection),a=s.getTileCoordForCoordAndZ(r.center,o)[0];return e.imageryProviders.map((function(e){let r=!1;const s=e.coverageAreas;for(let e=0,i=s.length;e<i;++e){const i=s[e];if(a>=i.zoomMin&&a<=i.zoomMax){const e=i.bbox;if(he(ce([e[1],e[0],e[3],e[2]],t),n.extent)){r=!0;break}}}r&&i.push(e.attribution)})),i.push('<a class="ol-attribution-bing-tos" href="https://www.microsoft.com/maps/product/terms.html" target="_blank">Terms of Use</a>'),i}))}this.setState("ready")}};function gb(t,e){const n=[];Object.keys(e).forEach((function(t){null!==e[t]&&void 0!==e[t]&&n.push(t+"="+encodeURIComponent(e[t]))}));const i=n.join("&");return t=t.replace(/[?&]$/,""),(t+=t.includes("?")?"&":"?")+i}const pb=class extends ub{constructor(t){super({attributions:(t=t||{}).attributions,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,interpolate:t.interpolate,projection:t.projection,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileGrid:t.tileGrid,tileLoadFunction:t.tileLoadFunction,url:t.url,urls:t.urls,wrapX:void 0===t.wrapX||t.wrapX,transition:t.transition,zDirection:t.zDirection}),this.params_=Object.assign({},t.params),this.hidpi_=void 0===t.hidpi||t.hidpi,this.tmpExtent_=[1/0,1/0,-1/0,-1/0],this.setKey(this.getKeyForParams_())}getKeyForParams_(){let t=0;const e=[];for(const n in this.params_)e[t++]=n+"-"+this.params_[n];return e.join("/")}getParams(){return this.params_}getRequestUrl_(t,e,n,i,r,s){const o=this.urls;if(!o)return;let a;return a=1==o.length?o[0]:o[nt(j_(t),o.length)],function(t,e,n,i,r,s){const o=r.getCode().split(/:(?=\d+$)/).pop(),a=n/i,l=[st(le(e)/a,4),st(re(e)/a,4)];return s.SIZE=l[0]+","+l[1],s.BBOX=e.join(","),s.BBOXSR=o,s.IMAGESR=o,s.DPI=Math.round(s.DPI?s.DPI*i:90*i),gb(t.replace(/MapServer\/?$/,"MapServer/export").replace(/ImageServer\/?$/,"ImageServer/exportImage"),s)}(a,n,(this.tileGrid||this.getTileGridForProjection(r)).getResolution(t[0]),i,r,s)}getTilePixelRatio(t){return this.hidpi_?t:1}updateParams(t){Object.assign(this.params_,t),this.setKey(this.getKeyForParams_())}tileUrlFunction(t,e,n){let i=this.getTileGrid();if(i||(i=this.getTileGridForProjection(n)),i.getResolutions().length<=t[0])return;1==e||this.hidpi_||(e=1);const r=i.getTileCoordExtent(t,this.tmpExtent_);let s=wi(i.getTileSize(t[0]),this.tmpSize);1!=e&&(s=vi(s,e,this.tmpSize));const o={F:"image",FORMAT:"PNG32",TRANSPARENT:!0};return Object.assign(o,this.params_),this.getRequestUrl_(t,s,r,e,n,o)}},mb=class extends ub{constructor(t){const e=!!t.highDpi,n=!(!0===t.overlay);super({attributionsCollapsible:t.attributionsCollapsible,cacheSize:t.cacheSize,crossOrigin:"anonymous",interpolate:t.interpolate,opaque:n,projection:"EPSG:3857",reprojectionErrorThreshold:t.reprojectionErrorThreshold,state:"loading",tileLoadFunction:t.tileLoadFunction,tilePixelRatio:e?2:1,wrapX:void 0===t.wrapX||t.wrapX,transition:t.transition,zDirection:t.zDirection}),this.apiKey_=t.key,this.error_=null;const i={mapType:t.mapType||"roadmap",language:t.language||"en-US",region:t.region||"US"};t.imageFormat&&(i.imageFormat=t.imageFormat),t.scale&&(i.scale=t.scale),e&&(i.highDpi=!0),t.layerTypes&&(i.layerTypes=t.layerTypes),t.styles&&(i.styles=t.styles),!0===t.overlay&&(i.overlay=!0),this.sessionTokenRequest_=i,this.sessionTokenValue_,this.sessionRefreshId_,this.previousViewportAttribution_,this.previousViewportExtent_,this.createSession_()}getError(){return this.error_}fetchSessionToken(t,e){return fetch(t,e)}async createSession_(){const t="https://tile.googleapis.com/v1/createSession?key="+this.apiKey_,e={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(this.sessionTokenRequest_)},n=await this.fetchSessionToken(t,e);if(!n.ok){try{const t=await n.json();this.error_=new Error(t.error.message)}catch{this.error_=new Error("Error fetching session token")}return void this.setState("error")}const i=await n.json(),r=this.getTilePixelRatio(1),s=[i.tileWidth/r,i.tileHeight/r];this.tileGrid=Q_({extent:eb(this.getProjection()),maxZoom:22,tileSize:s});const o=i.session;this.sessionTokenValue_=o;const a=this.apiKey_;this.tileUrlFunction=function(t,e,n){return`https://tile.googleapis.com/v1/2dtiles/${t[0]}/${t[1]}/${t[2]}?session=${o}&key=${a}`};const l=1e3*parseInt(i.expiry,10),h=Math.max(l-Date.now()-6e4,1);this.sessionRefreshId_=setTimeout((()=>this.createSession_()),h),this.setAttributions(this.fetchAttributions_.bind(this)),this.setState("ready")}async fetchAttributions_(t){if(t.viewHints[0]||t.viewHints[1]||t.animate)return this.previousViewportAttribution_;const[e,n]=ke(Jt(t.extent),t.viewState.projection),[i,r]=ke(ae(t.extent),t.viewState.projection),s=`zoom=${this.getTileGrid().getZForResolution(t.viewState.resolution,this.zDirection)}&north=${r}&south=${n}&east=${i}&west=${e}`;if(this.previousViewportExtent_==s)return this.previousViewportAttribution_;this.previousViewportExtent_=s;const o=`https://tile.googleapis.com/tile/v1/viewport?session=${this.sessionTokenValue_}&key=${this.apiKey_}&${s}`;return this.previousViewportAttribution_=await fetch(o).then((t=>t.json())).then((t=>t.copyright)),this.previousViewportAttribution_}disposeInternal(){clearTimeout(this.sessionRefreshId_),super.disposeInternal()}},yb=class extends ub{constructor(t){const e=void 0!==t.requestEncoding?t.requestEncoding:"KVP",n=t.tileGrid;let i=t.urls;void 0===i&&void 0!==t.url&&(i=ob(t.url)),super({attributions:t.attributions,attributionsCollapsible:t.attributionsCollapsible,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,interpolate:t.interpolate,projection:t.projection,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileClass:t.tileClass,tileGrid:n,tileLoadFunction:t.tileLoadFunction,tilePixelRatio:t.tilePixelRatio,urls:i,wrapX:void 0!==t.wrapX&&t.wrapX,transition:t.transition,zDirection:t.zDirection}),this.version_=void 0!==t.version?t.version:"1.0.0",this.format_=void 0!==t.format?t.format:"image/jpeg",this.dimensions_=void 0!==t.dimensions?t.dimensions:{},this.layer_=t.layer,this.matrixSet_=t.matrixSet,this.style_=t.style,this.requestEncoding_=e,this.setKey(this.getKeyForDimensions_()),i&&i.length>0&&(this.tileUrlFunction=sb(i.map(this.createFromWMTSTemplate.bind(this))))}setUrls(t){this.urls=t;const e=t.join("\n");this.setTileUrlFunction(sb(t.map(this.createFromWMTSTemplate.bind(this))),e)}getDimensions(){return this.dimensions_}getFormat(){return this.format_}getLayer(){return this.layer_}getMatrixSet(){return this.matrixSet_}getRequestEncoding(){return this.requestEncoding_}getStyle(){return this.style_}getVersion(){return this.version_}getKeyForDimensions_(){const t=this.urls?this.urls.slice(0):[];for(const e in this.dimensions_)t.push(e+"-"+this.dimensions_[e]);return t.join("/")}updateDimensions(t){Object.assign(this.dimensions_,t),this.setKey(this.getKeyForDimensions_())}createFromWMTSTemplate(t){const e=this.requestEncoding_,n={layer:this.layer_,style:this.style_,tilematrixset:this.matrixSet_};"KVP"==e&&Object.assign(n,{Service:"WMTS",Request:"GetTile",Version:this.version_,Format:this.format_}),t="KVP"==e?gb(t,n):t.replace(/\{(\w+?)\}/g,(function(t,e){return e.toLowerCase()in n?n[e.toLowerCase()]:t}));const i=this.tileGrid,r=this.dimensions_;return function(n,s,o){if(!n)return;const a={TileMatrix:i.getMatrixId(n[0]),TileCol:n[1],TileRow:n[2]};Object.assign(a,r);let l=t;return l="KVP"==e?gb(l,a):l.replace(/\{(\w+?)\}/g,(function(t,e){return a[e]})),l}}};function vb(t,e){const n=(""+t).split("."),i=(""+e).split(".");for(let t=0;t<Math.max(n.length,i.length);t++){const e=parseInt(n[t]||"0",10),r=parseInt(i[t]||"0",10);if(e>r)return 1;if(r>e)return-1}return 0}const wb="1.3.0";function xb(t,e,n,i,r,s,o){s=Object.assign({REQUEST:"GetMap"},s);const a=e/n,l=[st(le(t)/a,4),st(re(t)/a,4)];if(1!=n)switch(o){case"geoserver":const t=90*n+.5|0;"FORMAT_OPTIONS"in s?s.FORMAT_OPTIONS+=";dpi:"+t:s.FORMAT_OPTIONS="dpi:"+t;break;case"mapserver":s.MAP_RESOLUTION=90*n;break;case"carmentaserver":case"qgis":s.DPI=90*n;break;default:throw new Error("Unknown `serverType` configured")}return function(t,e,n,i,r){r.WIDTH=n[0],r.HEIGHT=n[1];const s=i.getAxisOrientation();let o;const a=vb(r.VERSION,"1.3")>=0;return r[a?"CRS":"SRS"]=i.getCode(),o=a&&"ne"==s.substr(0,2)?[e[1],e[0],e[3],e[2]]:e,r.BBOX=o.join(","),gb(t,r)}(r,t,l,i,s)}function _b(t,e){return Object.assign({REQUEST:e,SERVICE:"WMS",VERSION:wb,FORMAT:"image/png",STYLES:"",TRANSPARENT:!0},t)}const bb=class extends ub{constructor(t){t=t||{};const e=Object.assign({},t.params),n=!("TRANSPARENT"in e)||e.TRANSPARENT;super({attributions:t.attributions,attributionsCollapsible:t.attributionsCollapsible,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,interpolate:t.interpolate,opaque:!n,projection:t.projection,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileClass:t.tileClass,tileGrid:t.tileGrid,tileLoadFunction:t.tileLoadFunction,url:t.url,urls:t.urls,wrapX:void 0===t.wrapX||t.wrapX,transition:t.transition,zDirection:t.zDirection}),this.gutter_=void 0!==t.gutter?t.gutter:0,this.params_=e,this.v13_=!0,this.serverType_=t.serverType,this.hidpi_=void 0===t.hidpi||t.hidpi,this.tmpExtent_=[1/0,1/0,-1/0,-1/0],this.updateV13_(),this.setKey(this.getKeyForParams_())}getFeatureInfoUrl(t,e,n,i){const r=Pe(n),s=this.getProjection()||r;let o=this.getTileGrid();o||(o=this.getTileGridForProjection(s));const a=Fe(t,r,s),l=Ca(s,r,t,e),h=o.getZForResolution(l,this.zDirection),u=o.getResolution(h),c=o.getTileCoordForCoordAndZ(a,h);if(o.getResolutions().length<=c[0])return;let f=o.getTileCoordExtent(c,this.tmpExtent_);const d=this.gutter_;0!==d&&(f=Lt(f,u*d,f));const g={QUERY_LAYERS:this.params_.LAYERS};Object.assign(g,_b(this.params_,"GetFeatureInfo"),i);const p=Math.floor((a[0]-f[0])/u),m=Math.floor((f[3]-a[1])/u);return g[this.v13_?"I":"X"]=p,g[this.v13_?"J":"Y"]=m,this.getRequestUrl_(c,f,1,s||r,g)}getLegendUrl(t,e){if(void 0===this.urls[0])return;const n={SERVICE:"WMS",VERSION:wb,REQUEST:"GetLegendGraphic",FORMAT:"image/png"};if(void 0===e||void 0===e.LAYER){const t=this.params_.LAYERS;if(Array.isArray(t)&&1!==t.length)return;n.LAYER=t}if(void 0!==t){const e=this.getProjection()?this.getProjection().getMetersPerUnit():1,i=28e-5;n.SCALE=t*e/i}return Object.assign(n,e),gb(this.urls[0],n)}getGutter(){return this.gutter_}getParams(){return this.params_}getRequestUrl_(t,e,n,i,r){const s=this.urls;if(!s)return;let o;return o=1==s.length?s[0]:s[nt(j_(t),s.length)],xb(e,(this.tileGrid||this.getTileGridForProjection(i)).getResolution(t[0]),n,i,o,r,this.serverType_)}getTilePixelRatio(t){return this.hidpi_&&void 0!==this.serverType_?t:1}getKeyForParams_(){let t=0;const e=[];for(const n in this.params_)e[t++]=n+"-"+this.params_[n];return e.join("/")}updateParams(t){Object.assign(this.params_,t),this.updateV13_(),this.setKey(this.getKeyForParams_())}updateV13_(){const t=this.params_.VERSION||wb;this.v13_=vb(t,"1.3")>=0}tileUrlFunction(t,e,n){let i=this.getTileGrid();if(i||(i=this.getTileGridForProjection(n)),i.getResolutions().length<=t[0])return;1==e||this.hidpi_&&void 0!==this.serverType_||(e=1);const r=i.getResolution(t[0]);let s=i.getTileCoordExtent(t,this.tmpExtent_);const o=this.gutter_;0!==o&&(s=Lt(s,r*o,s));const a=Object.assign({},_b(this.params_,"GetMap"));return this.getRequestUrl_(t,s,e,n,a)}},Eb=class{constructor(){this.apikeys={BingMapKey:"AoTrgwP6rdBDsqtY-wq-Z5aA31YHoSzOyKStmu8t0-ZLUbO2LS4PbYoNYNe2SPSx",ArcGISKey:"AAPK3890bdd7605a4e3d9adb68f5790780eczWSlc-Uyepn0n8XMnNwNaiymNVrEy4ihJruVsf2PVK_lD086faryQVtQkssjkq84",GoogleMapKey:"AIzaSyDs7BWib3HEzlzB9EXV3dqtc7iNWCLxgaU"}}getKeys(){return this.apikeys}};const Sb=class extends K_{constructor(t){super({extent:t.extent,origin:t.origin,origins:t.origins,resolutions:t.resolutions,tileSize:t.tileSize,tileSizes:t.tileSizes,sizes:t.sizes}),this.matrixIds_=t.matrixIds}getMatrixId(t){return this.matrixIds_[t]}getMatrixIds(){return this.matrixIds_}},Ib=Pe("EPSG:3857"),Cb=Ib.getExtent(),Mb=le(Cb)/256,Rb=new Array(19),Pb=new Array(19);for(let t=0;t<19;++t)Rb[t]=Mb/Math.pow(2,t),Pb[t]="EPSG:3857:"+t;const Tb=le(Pe("EPSG:4326").getExtent())/256,Nb=new Array(19),Ab=new Array(19);for(let t=0;t<19;++t)Nb[t]=Tb/Math.pow(2,t),Ab[t]="EPSG:4326:"+t;async function kb(t,e,n){t.once("rendercomplete",(function(){const i=t.getSize();e.width=i[0],e.height=i[1];const r=n;Array.prototype.forEach.call(t.getViewport().querySelectorAll(".ol-layer canvas, canvas.ol-layer"),(function(t){if(t.width>0){const e=t.parentNode.style.opacity||t.style.opacity;let n;r.globalAlpha=""===e?1:Number(e);const i=t.style.transform;n=i?i.match(/^matrix\(([^\(]*)\)$/)[1].split(",").map(Number):[parseFloat(t.style.width)/t.width,0,0,parseFloat(t.style.height)/t.height,0,0],CanvasRenderingContext2D.prototype.setTransform.apply(r,n);const s=t.parentNode.style.backgroundColor;s&&(r.fillStyle=s,r.fillRect(0,0,t.width,t.height)),r.drawImage(t,0,0)}})),r.globalAlpha=1,r.setTransform(1,0,0,1,0,0)})),t.renderSync()}let Lb=document.createElement("div");Lb.style.width="300px",Lb.style.background="white";let Ob=document.createElement("h3");Ob.textContent="Select features from both map",Ob.style.color="#32a852",Ob.style.fontWeight="bold";let Db=document.createElement("h3");Db.className="h3",Db.textContent="Enter parameters for Map 1";let Fb=document.createElement("h3");function zb(t,e,n){let i=document.createElement("div"),r=document.createElement("input");return r.setAttribute("id",t),r.placeholder=n,r.style.marginLeft="10px",r.style.marginBottom="10px",r.className="input",r.value=e,sessionStorage.setItem(t,e),r.addEventListener("input",(t=>{sessionStorage.setItem(r.id,r.value)})),r.value,i.append(r),i}function Gb(t,e,n){let i=document.createElement("p");i.textContent=n;let r=document.createElement("br");t.append(i,r),e.forEach((e=>{let n=Object.keys(e).toString(),i=document.createElement("img");i.style.width="20px",i.style.height="20px",i.style.background="rgba("+n+")",t.append(i)}))}function Bb(t){for(;t.firstChild;)t.removeChild(t.firstChild)}function Ub(t,e){const n=t;let i=e.pixel,r=[];const s=parseInt(e.delta);if(!i)return n;i=i.map(Math.round);const o=n.width,a=n.height,l=n.data,h=new Uint8ClampedArray(l),u=4*(i[1]*o+i[0]),c=l[u],f=l[u+1],d=l[u+2];let g=[i];for(;g.length;){const t=[];for(let e=0,n=g.length;e<n;e++){const n=qb(g[e]);for(let e=0,i=n.length;e<i;e++){const i=n[e][0],r=n[e][1];if(i>=0&&i<o&&r>=0&&r<a){const e=4*(r*o+i),n=l[e],a=l[e+1],u=l[e+2];if(0===l[e+3])continue;Math.abs(c-n)<s&&Math.abs(f-a)<s&&Math.abs(d-u)<s&&(h[e]=255,h[e+1]=0,h[e+2]=0,h[e+3]=255,t.push([i,r])),l[e+3]=0}}}r.push(t),g=t}for(let t=0;t<h.length;t+=4)255===h[t]&&0===h[t+1]&&0===h[t+2]&&255===h[t+3]||(h[t]=0,h[t+1]=0,h[t+2]=0,h[t+3]=255);return{data:h,width:o,height:a}}function qb(t){const e=t[0],n=t[1];return[[e+1,n],[e-1,n],[e,n+1],[e,n-1]]}Fb.className="h3",Fb.textContent="Enter parameters for Map 2";var Vb=__webpack_require__(9152);class Yb extends D{constructor(t){if(super(),this.on,this.once,this.un,this.id_=void 0,this.geometryName_="geometry",this.style_=null,this.styleFunction_=void 0,this.geometryChangeKey_=null,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),t)if("function"==typeof t.getSimplifiedGeometry){const e=t;this.setGeometry(e)}else{const e=t;this.setProperties(e)}}clone(){const t=new Yb(this.hasProperties()?this.getProperties():null);t.setGeometryName(this.getGeometryName());const e=this.getGeometry();e&&t.setGeometry(e.clone());const n=this.getStyle();return n&&t.setStyle(n),t}getGeometry(){return this.get(this.geometryName_)}getId(){return this.id_}getGeometryName(){return this.geometryName_}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}handleGeometryChange_(){this.changed()}handleGeometryChanged_(){this.geometryChangeKey_&&(P(this.geometryChangeKey_),this.geometryChangeKey_=null);const t=this.getGeometry();t&&(this.geometryChangeKey_=M(t,x,this.handleGeometryChange_,this)),this.changed()}setGeometry(t){this.set(this.geometryName_,t)}setStyle(t){this.style_=t,this.styleFunction_=t?function(t){if("function"==typeof t)return t;let e;return Array.isArray(t)?e=t:(K("function"==typeof t.getZIndex,"Expected an `ol/style/Style` or an array of `ol/style/Style.js`"),e=[t]),function(){return e}}(t):void 0,this.changed()}setId(t){this.id_=t,this.changed()}setGeometryName(t){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_),this.geometryName_=t,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),this.handleGeometryChanged_()}}const Xb=Yb,jb={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},Wb=[jb.FILL],Hb=[jb.STROKE],$b=[jb.BEGIN_PATH],Zb=[jb.CLOSE_PATH],Kb=jb,Jb=class{drawCustom(t,e,n,i,r){}drawGeometry(t){}setStyle(t){}drawCircle(t,e,n){}drawFeature(t,e,n){}drawGeometryCollection(t,e,n){}drawLineString(t,e,n){}drawMultiLineString(t,e,n){}drawMultiPoint(t,e,n){}drawMultiPolygon(t,e,n){}drawPoint(t,e,n){}drawPolygon(t,e,n){}drawText(t,e,n){}setFillStrokeStyle(t,e){}setImageStyle(t,e){}setTextStyle(t,e){}},Qb=class extends Jb{constructor(t,e,n,i){super(),this.tolerance=t,this.maxExtent=e,this.pixelRatio=i,this.maxLineWidth=0,this.resolution=n,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_=null,this.bufferedMaxExtent_=null,this.instructions=[],this.coordinates=[],this.tmpCoordinate_=[],this.hitDetectionInstructions=[],this.state={}}applyPixelRatio(t){const e=this.pixelRatio;return 1==e?t:t.map((function(t){return t*e}))}appendFlatPointCoordinates(t,e){const n=this.getBufferedMaxExtent(),i=this.tmpCoordinate_,r=this.coordinates;let s=r.length;for(let o=0,a=t.length;o<a;o+=e)i[0]=t[o],i[1]=t[o+1],Ft(n,i)&&(r[s++]=i[0],r[s++]=i[1]);return s}appendFlatLineCoordinates(t,e,n,i,r,s){const o=this.coordinates;let a=o.length;const l=this.getBufferedMaxExtent();s&&(e+=i);let h=t[e],u=t[e+1];const c=this.tmpCoordinate_;let f,d,g,p=!0;for(f=e+i;f<n;f+=i)c[0]=t[f],c[1]=t[f+1],g=Bt(l,c),g!==d?(p&&(o[a++]=h,o[a++]=u,p=!1),o[a++]=c[0],o[a++]=c[1]):g===At.INTERSECTING?(o[a++]=c[0],o[a++]=c[1],p=!1):p=!0,h=c[0],u=c[1],d=g;return(r&&p||f===e+i)&&(o[a++]=h,o[a++]=u),a}drawCustomCoordinates_(t,e,n,i,r){for(let s=0,o=n.length;s<o;++s){const o=n[s],a=this.appendFlatLineCoordinates(t,e,o,i,!1,!1);r.push(a),e=o}return e}drawCustom(t,e,n,i,r){this.beginGeometry(t,e,r);const s=t.getType(),o=t.getStride(),a=this.coordinates.length;let l,h,u,c,f;switch(s){case"MultiPolygon":l=t.getOrientedFlatCoordinates(),c=[];const e=t.getEndss();f=0;for(let t=0,n=e.length;t<n;++t){const n=[];f=this.drawCustomCoordinates_(l,f,e[t],o,n),c.push(n)}this.instructions.push([Kb.CUSTOM,a,c,t,n,Ln,r]),this.hitDetectionInstructions.push([Kb.CUSTOM,a,c,t,i||n,Ln,r]);break;case"Polygon":case"MultiLineString":u=[],l="Polygon"==s?t.getOrientedFlatCoordinates():t.getFlatCoordinates(),f=this.drawCustomCoordinates_(l,0,t.getEnds(),o,u),this.instructions.push([Kb.CUSTOM,a,u,t,n,kn,r]),this.hitDetectionInstructions.push([Kb.CUSTOM,a,u,t,i||n,kn,r]);break;case"LineString":case"Circle":l=t.getFlatCoordinates(),h=this.appendFlatLineCoordinates(l,0,l.length,o,!1,!1),this.instructions.push([Kb.CUSTOM,a,h,t,n,An,r]),this.hitDetectionInstructions.push([Kb.CUSTOM,a,h,t,i||n,An,r]);break;case"MultiPoint":l=t.getFlatCoordinates(),h=this.appendFlatPointCoordinates(l,o),h>a&&(this.instructions.push([Kb.CUSTOM,a,h,t,n,An,r]),this.hitDetectionInstructions.push([Kb.CUSTOM,a,h,t,i||n,An,r]));break;case"Point":l=t.getFlatCoordinates(),this.coordinates.push(l[0],l[1]),h=this.coordinates.length,this.instructions.push([Kb.CUSTOM,a,h,t,n,void 0,r]),this.hitDetectionInstructions.push([Kb.CUSTOM,a,h,t,i||n,void 0,r])}this.endGeometry(e)}beginGeometry(t,e,n){this.beginGeometryInstruction1_=[Kb.BEGIN_GEOMETRY,e,0,t,n],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[Kb.BEGIN_GEOMETRY,e,0,t,n],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)}finish(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}}reverseHitDetectionInstructions(){const t=this.hitDetectionInstructions;let e;t.reverse();const n=t.length;let i,r,s=-1;for(e=0;e<n;++e)i=t[e],r=i[0],r==Kb.END_GEOMETRY?s=e:r==Kb.BEGIN_GEOMETRY&&(i[2]=e,h(this.hitDetectionInstructions,s,e),s=-1)}setFillStrokeStyle(t,e){const n=this.state;if(t){const e=t.getColor();n.fillPatternScale=e&&"object"==typeof e&&"src"in e?this.pixelRatio:1,n.fillStyle=ar(e||mr)}else n.fillStyle=void 0;if(e){const t=e.getColor();n.strokeStyle=ar(t||xr);const i=e.getLineCap();n.lineCap=void 0!==i?i:yr;const r=e.getLineDash();n.lineDash=r?r.slice():vr;const s=e.getLineDashOffset();n.lineDashOffset=s||0;const o=e.getLineJoin();n.lineJoin=void 0!==o?o:wr;const a=e.getWidth();n.lineWidth=void 0!==a?a:1;const l=e.getMiterLimit();n.miterLimit=void 0!==l?l:10,n.lineWidth>this.maxLineWidth&&(this.maxLineWidth=n.lineWidth,this.bufferedMaxExtent_=null)}else n.strokeStyle=void 0,n.lineCap=void 0,n.lineDash=null,n.lineDashOffset=void 0,n.lineJoin=void 0,n.lineWidth=void 0,n.miterLimit=void 0}createFill(t){const e=t.fillStyle,n=[Kb.SET_FILL_STYLE,e];return"string"!=typeof e&&n.push(t.fillPatternScale),n}applyStroke(t){this.instructions.push(this.createStroke(t))}createStroke(t){return[Kb.SET_STROKE_STYLE,t.strokeStyle,t.lineWidth*this.pixelRatio,t.lineCap,t.lineJoin,t.miterLimit,this.applyPixelRatio(t.lineDash),t.lineDashOffset*this.pixelRatio]}updateFillStyle(t,e){const n=t.fillStyle;"string"==typeof n&&t.currentFillStyle==n||(void 0!==n&&this.instructions.push(e.call(this,t)),t.currentFillStyle=n)}updateStrokeStyle(t,e){const n=t.strokeStyle,i=t.lineCap,r=t.lineDash,s=t.lineDashOffset,o=t.lineJoin,a=t.lineWidth,l=t.miterLimit;(t.currentStrokeStyle!=n||t.currentLineCap!=i||r!=t.currentLineDash&&!c(t.currentLineDash,r)||t.currentLineDashOffset!=s||t.currentLineJoin!=o||t.currentLineWidth!=a||t.currentMiterLimit!=l)&&(void 0!==n&&e.call(this,t),t.currentStrokeStyle=n,t.currentLineCap=i,t.currentLineDash=r,t.currentLineDashOffset=s,t.currentLineJoin=o,t.currentLineWidth=a,t.currentMiterLimit=l)}endGeometry(t){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;const e=[Kb.END_GEOMETRY,t];this.instructions.push(e),this.hitDetectionInstructions.push(e)}getBufferedMaxExtent(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=Ot(this.maxExtent),this.maxLineWidth>0)){const t=this.resolution*(this.maxLineWidth+1)/2;Lt(this.bufferedMaxExtent_,t,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_}},tE=class extends Qb{constructor(t,e,n,i){super(t,e,n,i)}drawFlatCoordinatess_(t,e,n,i){const r=this.state,s=void 0!==r.fillStyle,o=void 0!==r.strokeStyle,a=n.length;this.instructions.push($b),this.hitDetectionInstructions.push($b);for(let r=0;r<a;++r){const s=n[r],a=this.coordinates.length,l=this.appendFlatLineCoordinates(t,e,s,i,!0,!o),h=[Kb.MOVE_TO_LINE_TO,a,l];this.instructions.push(h),this.hitDetectionInstructions.push(h),o&&(this.instructions.push(Zb),this.hitDetectionInstructions.push(Zb)),e=s}return s&&(this.instructions.push(Wb),this.hitDetectionInstructions.push(Wb)),o&&(this.instructions.push(Hb),this.hitDetectionInstructions.push(Hb)),e}drawCircle(t,e,n){const i=this.state,r=i.fillStyle,s=i.strokeStyle;if(void 0===r&&void 0===s)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e,n),void 0!==i.fillStyle&&this.hitDetectionInstructions.push([Kb.SET_FILL_STYLE,mr]),void 0!==i.strokeStyle&&this.hitDetectionInstructions.push([Kb.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,vr,0]);const o=t.getFlatCoordinates(),a=t.getStride(),l=this.coordinates.length;this.appendFlatLineCoordinates(o,0,o.length,a,!1,!1);const h=[Kb.CIRCLE,l];this.instructions.push($b,h),this.hitDetectionInstructions.push($b,h),void 0!==i.fillStyle&&(this.instructions.push(Wb),this.hitDetectionInstructions.push(Wb)),void 0!==i.strokeStyle&&(this.instructions.push(Hb),this.hitDetectionInstructions.push(Hb)),this.endGeometry(e)}drawPolygon(t,e,n){const i=this.state,r=i.fillStyle,s=i.strokeStyle;if(void 0===r&&void 0===s)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e,n),void 0!==i.fillStyle&&this.hitDetectionInstructions.push([Kb.SET_FILL_STYLE,mr]),void 0!==i.strokeStyle&&this.hitDetectionInstructions.push([Kb.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,vr,0]);const o=t.getEnds(),a=t.getOrientedFlatCoordinates(),l=t.getStride();this.drawFlatCoordinatess_(a,0,o,l),this.endGeometry(e)}drawMultiPolygon(t,e,n){const i=this.state,r=i.fillStyle,s=i.strokeStyle;if(void 0===r&&void 0===s)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e,n),void 0!==i.fillStyle&&this.hitDetectionInstructions.push([Kb.SET_FILL_STYLE,mr]),void 0!==i.strokeStyle&&this.hitDetectionInstructions.push([Kb.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,vr,0]);const o=t.getEndss(),a=t.getOrientedFlatCoordinates(),l=t.getStride();let h=0;for(let t=0,e=o.length;t<e;++t)h=this.drawFlatCoordinatess_(a,h,o[t],l);this.endGeometry(e)}finish(){this.reverseHitDetectionInstructions(),this.state=null;const t=this.tolerance;if(0!==t){const e=this.coordinates;for(let n=0,i=e.length;n<i;++n)e[n]=Pn(e[n],t)}return super.finish()}setFillStrokeStyles_(){const t=this.state;void 0!==t.fillStyle&&this.updateFillStyle(t,this.createFill),void 0!==t.strokeStyle&&this.updateStrokeStyle(t,this.applyStroke)}};function eE(t,e,n,i,r){const s=[];let o=n,a=0,l=e.slice(n,2);for(;a<t&&o+r<i;){const[n,i]=l.slice(-2),h=e[o+r],u=e[o+r+1],c=Math.sqrt((h-n)*(h-n)+(u-i)*(u-i));if(a+=c,a>=t){const e=(t-a+c)/c,f=it(n,h,e),d=it(i,u,e);l.push(f,d),s.push(l),l=[f,d],a==t&&(o+=r),a=0}else if(a<t)l.push(e[o+r],e[o+r+1]),o+=r;else{const t=c-a,e=it(n,h,t/c),f=it(i,u,t/c);l.push(e,f),s.push(l),l=[e,f],a=0,o+=r}}return a>0&&s.push(l),s}function nE(t,e,n,i,r){let s,o,a,l,h,u,c,f,d,g,p=n,m=n,y=0,v=0,w=n;for(o=n;o<i;o+=r){const n=e[o],i=e[o+1];void 0!==h&&(d=n-h,g=i-u,l=Math.sqrt(d*d+g*g),void 0!==c&&(v+=a,s=Math.acos((c*d+f*g)/(a*l)),s>t&&(v>y&&(y=v,p=w,m=o),v=0,w=o-r)),a=l,c=d,f=g),h=n,u=i}return v+=l,v>y?[w,o]:[p,m]}const iE={left:0,center:.5,right:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1},rE={Circle:tE,Default:Qb,Image:class extends Qb{constructor(t,e,n,i){super(t,e,n,i),this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.anchorX_=void 0,this.anchorY_=void 0,this.height_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.scale_=void 0,this.width_=void 0,this.declutterMode_=void 0,this.declutterImageWithText_=void 0}drawPoint(t,e,n){if(!this.image_||this.maxExtent&&!Ft(this.maxExtent,t.getFlatCoordinates()))return;this.beginGeometry(t,e,n);const i=t.getFlatCoordinates(),r=t.getStride(),s=this.coordinates.length,o=this.appendFlatPointCoordinates(i,r);this.instructions.push([Kb.DRAW_IMAGE,s,o,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([Kb.DRAW_IMAGE,s,o,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(e)}drawMultiPoint(t,e,n){if(!this.image_)return;this.beginGeometry(t,e,n);const i=t.getFlatCoordinates(),r=[];for(let e=0,n=i.length;e<n;e+=t.getStride())this.maxExtent&&!Ft(this.maxExtent,i.slice(e,e+2))||r.push(i[e],i[e+1]);const s=this.coordinates.length,o=this.appendFlatPointCoordinates(r,2);this.instructions.push([Kb.DRAW_IMAGE,s,o,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([Kb.DRAW_IMAGE,s,o,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(e)}finish(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,super.finish()}setImageStyle(t,e){const n=t.getAnchor(),i=t.getSize(),r=t.getOrigin();this.imagePixelRatio_=t.getPixelRatio(this.pixelRatio),this.anchorX_=n[0],this.anchorY_=n[1],this.hitDetectionImage_=t.getHitDetectionImage(),this.image_=t.getImage(this.pixelRatio),this.height_=i[1],this.opacity_=t.getOpacity(),this.originX_=r[0],this.originY_=r[1],this.rotateWithView_=t.getRotateWithView(),this.rotation_=t.getRotation(),this.scale_=t.getScaleArray(),this.width_=i[0],this.declutterMode_=t.getDeclutterMode(),this.declutterImageWithText_=e}},LineString:class extends Qb{constructor(t,e,n,i){super(t,e,n,i)}drawFlatCoordinates_(t,e,n,i){const r=this.coordinates.length,s=this.appendFlatLineCoordinates(t,e,n,i,!1,!1),o=[Kb.MOVE_TO_LINE_TO,r,s];return this.instructions.push(o),this.hitDetectionInstructions.push(o),n}drawLineString(t,e,n){const i=this.state,r=i.strokeStyle,s=i.lineWidth;if(void 0===r||void 0===s)return;this.updateStrokeStyle(i,this.applyStroke),this.beginGeometry(t,e,n),this.hitDetectionInstructions.push([Kb.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,vr,0],$b);const o=t.getFlatCoordinates(),a=t.getStride();this.drawFlatCoordinates_(o,0,o.length,a),this.hitDetectionInstructions.push(Hb),this.endGeometry(e)}drawMultiLineString(t,e,n){const i=this.state,r=i.strokeStyle,s=i.lineWidth;if(void 0===r||void 0===s)return;this.updateStrokeStyle(i,this.applyStroke),this.beginGeometry(t,e,n),this.hitDetectionInstructions.push([Kb.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,vr,0],$b);const o=t.getEnds(),a=t.getFlatCoordinates(),l=t.getStride();let h=0;for(let t=0,e=o.length;t<e;++t)h=this.drawFlatCoordinates_(a,h,o[t],l);this.hitDetectionInstructions.push(Hb),this.endGeometry(e)}finish(){const t=this.state;return null!=t.lastStroke&&t.lastStroke!=this.coordinates.length&&this.instructions.push(Hb),this.reverseHitDetectionInstructions(),this.state=null,super.finish()}applyStroke(t){null!=t.lastStroke&&t.lastStroke!=this.coordinates.length&&(this.instructions.push(Hb),t.lastStroke=this.coordinates.length),t.lastStroke=0,super.applyStroke(t),this.instructions.push($b)}},Polygon:tE,Text:class extends Qb{constructor(t,e,n,i){super(t,e,n,i),this.labels_=null,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=void 0,this.textRotation_=0,this.textFillState_=null,this.fillStates={},this.fillStates[mr]={fillStyle:mr},this.textStrokeState_=null,this.strokeStates={},this.textState_={},this.textStates={},this.textKey_="",this.fillKey_="",this.strokeKey_="",this.declutterMode_=void 0,this.declutterImageWithText_=void 0}finish(){const t=super.finish();return t.textStates=this.textStates,t.fillStates=this.fillStates,t.strokeStates=this.strokeStates,t}drawText(t,e,n){const i=this.textFillState_,r=this.textStrokeState_,s=this.textState_;if(""===this.text_||!s||!i&&!r)return;const o=this.coordinates;let a=o.length;const l=t.getType();let h=null,u=t.getStride();if("line"!==s.placement||"LineString"!=l&&"MultiLineString"!=l&&"Polygon"!=l&&"MultiPolygon"!=l){let i=s.overflow?null:[];switch(l){case"Point":case"MultiPoint":h=t.getFlatCoordinates();break;case"LineString":h=t.getFlatMidpoint();break;case"Circle":h=t.getCenter();break;case"MultiLineString":h=t.getFlatMidpoints(),u=2;break;case"Polygon":h=t.getFlatInteriorPoint(),s.overflow||i.push(h[2]/this.resolution),u=3;break;case"MultiPolygon":const e=t.getFlatInteriorPoints();h=[];for(let t=0,n=e.length;t<n;t+=3)s.overflow||i.push(e[t+2]/this.resolution),h.push(e[t],e[t+1]);if(0===h.length)return;u=2}const r=this.appendFlatPointCoordinates(h,u);if(r===a)return;if(i&&(r-a)/2!=h.length/u){let t=a/2;i=i.filter(((e,n)=>{const i=o[2*(t+n)]===h[n*u]&&o[2*(t+n)+1]===h[n*u+1];return i||--t,i}))}this.saveTextStates_(),(s.backgroundFill||s.backgroundStroke)&&(this.setFillStrokeStyle(s.backgroundFill,s.backgroundStroke),s.backgroundFill&&this.updateFillStyle(this.state,this.createFill),s.backgroundStroke&&(this.updateStrokeStyle(this.state,this.applyStroke),this.hitDetectionInstructions.push(this.createStroke(this.state)))),this.beginGeometry(t,e,n);let c=s.padding;if(c!=Er&&(s.scale[0]<0||s.scale[1]<0)){let t=s.padding[0],e=s.padding[1],n=s.padding[2],i=s.padding[3];s.scale[0]<0&&(e=-e,i=-i),s.scale[1]<0&&(t=-t,n=-n),c=[t,e,n,i]}const f=this.pixelRatio;this.instructions.push([Kb.DRAW_IMAGE,a,r,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,this.declutterMode_,this.declutterImageWithText_,c==Er?Er:c.map((function(t){return t*f})),!!s.backgroundFill,!!s.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,i]);const d=1/f,g=this.state.fillStyle;s.backgroundFill&&(this.state.fillStyle=mr,this.hitDetectionInstructions.push(this.createFill(this.state))),this.hitDetectionInstructions.push([Kb.DRAW_IMAGE,a,r,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[d,d],NaN,this.declutterMode_,this.declutterImageWithText_,c,!!s.backgroundFill,!!s.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_?mr:this.fillKey_,this.textOffsetX_,this.textOffsetY_,i]),s.backgroundFill&&(this.state.fillStyle=g,this.hitDetectionInstructions.push(this.createFill(this.state))),this.endGeometry(e)}else{if(!he(this.maxExtent,t.getExtent()))return;let i;if(h=t.getFlatCoordinates(),"LineString"==l)i=[h.length];else if("MultiLineString"==l)i=t.getEnds();else if("Polygon"==l)i=t.getEnds().slice(0,1);else if("MultiPolygon"==l){const e=t.getEndss();i=[];for(let t=0,n=e.length;t<n;++t)i.push(e[t][0])}this.beginGeometry(t,e,n);const r=s.repeat,c=r?void 0:s.textAlign;let f=0;for(let t=0,e=i.length;t<e;++t){let e;e=r?eE(r*this.resolution,h,f,i[t],u):[h.slice(f,i[t])];for(let n=0,r=e.length;n<r;++n){const r=e[n];let l=0,h=r.length;if(null==c){const t=nE(s.maxAngle,r,0,r.length,2);l=t[0],h=t[1]}for(let t=l;t<h;t+=u)o.push(r[t],r[t+1]);const d=o.length;f=i[t],this.drawChars_(a,d),a=d}}this.endGeometry(e)}}saveTextStates_(){const t=this.textStrokeState_,e=this.textState_,n=this.textFillState_,i=this.strokeKey_;t&&(i in this.strokeStates||(this.strokeStates[i]={strokeStyle:t.strokeStyle,lineCap:t.lineCap,lineDashOffset:t.lineDashOffset,lineWidth:t.lineWidth,lineJoin:t.lineJoin,miterLimit:t.miterLimit,lineDash:t.lineDash}));const r=this.textKey_;r in this.textStates||(this.textStates[r]={font:e.font,textAlign:e.textAlign||_r,justify:e.justify,textBaseline:e.textBaseline||br,scale:e.scale});const s=this.fillKey_;n&&(s in this.fillStates||(this.fillStates[s]={fillStyle:n.fillStyle}))}drawChars_(t,e){const n=this.textStrokeState_,i=this.textState_,r=this.strokeKey_,s=this.textKey_,o=this.fillKey_;this.saveTextStates_();const a=this.pixelRatio,l=iE[i.textBaseline],h=this.textOffsetY_*a,u=this.text_,c=n?n.lineWidth*Math.abs(i.scale[0])/2:0;this.instructions.push([Kb.DRAW_CHARS,t,e,l,i.overflow,o,i.maxAngle,a,h,r,c*a,u,s,1,this.declutterMode_]),this.hitDetectionInstructions.push([Kb.DRAW_CHARS,t,e,l,i.overflow,o?mr:o,i.maxAngle,a,h,r,c*a,u,s,1/a,this.declutterMode_])}setTextStyle(t,e){let n,i,r;if(t){const e=t.getFill();e?(i=this.textFillState_,i||(i={},this.textFillState_=i),i.fillStyle=ar(e.getColor()||mr)):(i=null,this.textFillState_=i);const s=t.getStroke();if(s){r=this.textStrokeState_,r||(r={},this.textStrokeState_=r);const t=s.getLineDash(),e=s.getLineDashOffset(),n=s.getWidth(),i=s.getMiterLimit();r.lineCap=s.getLineCap()||yr,r.lineDash=t?t.slice():vr,r.lineDashOffset=void 0===e?0:e,r.lineJoin=s.getLineJoin()||wr,r.lineWidth=void 0===n?1:n,r.miterLimit=void 0===i?10:i,r.strokeStyle=ar(s.getColor()||xr)}else r=null,this.textStrokeState_=r;n=this.textState_;const o=t.getFont()||pr;Rr(o);const a=t.getScaleArray();n.overflow=t.getOverflow(),n.font=o,n.maxAngle=t.getMaxAngle(),n.placement=t.getPlacement(),n.textAlign=t.getTextAlign(),n.repeat=t.getRepeat(),n.justify=t.getJustify(),n.textBaseline=t.getTextBaseline()||br,n.backgroundFill=t.getBackgroundFill(),n.backgroundStroke=t.getBackgroundStroke(),n.padding=t.getPadding()||Er,n.scale=void 0===a?[1,1]:a;const l=t.getOffsetX(),h=t.getOffsetY(),u=t.getRotateWithView(),c=t.getRotation();this.text_=t.getText()||"",this.textOffsetX_=void 0===l?0:l,this.textOffsetY_=void 0===h?0:h,this.textRotateWithView_=void 0!==u&&u,this.textRotation_=void 0===c?0:c,this.strokeKey_=r?("string"==typeof r.strokeStyle?r.strokeStyle:L(r.strokeStyle))+r.lineCap+r.lineDashOffset+"|"+r.lineWidth+r.lineJoin+r.miterLimit+"["+r.lineDash.join()+"]":"",this.textKey_=n.font+n.scale+(n.textAlign||"?")+(n.repeat||"?")+(n.justify||"?")+(n.textBaseline||"?"),this.fillKey_=i&&i.fillStyle?"string"==typeof i.fillStyle?i.fillStyle:"|"+L(i.fillStyle):""}else this.text_="";this.declutterMode_=t.getDeclutterMode(),this.declutterImageWithText_=e}}},sE=class{constructor(t,e,n,i){this.tolerance_=t,this.maxExtent_=e,this.pixelRatio_=i,this.resolution_=n,this.buildersByZIndex_={}}finish(){const t={};for(const e in this.buildersByZIndex_){t[e]=t[e]||{};const n=this.buildersByZIndex_[e];for(const i in n){const r=n[i].finish();t[e][i]=r}}return t}getBuilder(t,e){const n=void 0!==t?t.toString():"0";let i=this.buildersByZIndex_[n];void 0===i&&(i={},this.buildersByZIndex_[n]=i);let r=i[e];return void 0===r&&(r=new(0,rE[e])(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),i[e]=r),r}};function oE(t,e,n,i,r,s,o,a,l,h,u,c){let f=t[e],d=t[e+1],g=0,p=0,m=0,y=0;function v(){g=f,p=d,f=t[e+=i],d=t[e+1],y+=m,m=Math.sqrt((f-g)*(f-g)+(d-p)*(d-p))}do{v()}while(e<n-i&&y+m<s);let w=0===m?0:(s-y)/m;const x=it(g,f,w),_=it(p,d,w),b=e-i,E=y,S=s+a*l(h,r,u);for(;e<n-i&&y+m<S;)v();w=0===m?0:(S-y)/m;const I=it(g,f,w),C=it(p,d,w);let M;if(c){const t=[x,_,I,C];dn(t,0,4,2,c,t,t),M=t[0]>t[2]}else M=x>I;const R=Math.PI,P=[],T=b+i===e;let N;if(m=0,y=E,f=t[e=b],d=t[e+1],T){v(),N=Math.atan2(d-p,f-g),M&&(N+=N>0?-R:R);const t=(I+x)/2,e=(C+_)/2;return P[0]=[t,e,(S-s)/2,N,r],P}for(let t=0,c=(r=r.replace(/\n/g," ")).length;t<c;){v();let x=Math.atan2(d-p,f-g);if(M&&(x+=x>0?-R:R),void 0!==N){let t=x-N;if(t+=t>R?-2*R:t<-R?2*R:0,Math.abs(t)>o)return null}N=x;const _=t;let b=0;for(;t<c;++t){const o=a*l(h,r[M?c-t-1:t],u);if(e+i<n&&y+m<s+b+o/2)break;b+=o}if(t===_)continue;const E=M?r.substring(c-_,c-t):r.substring(_,t);w=0===m?0:(s+b/2-y)/m;const S=it(g,f,w),I=it(p,d,w);P.push([S,I,b/2,x,E]),s+=b}return P}function aE(t,e,n,i){let r=t[e],s=t[e+1],o=0;for(let a=e+i;a<n;a+=i){const e=t[a],n=t[a+1];o+=Math.sqrt((e-r)*(e-r)+(n-s)*(n-s)),r=e,s=n}return o}const lE=[1/0,1/0,-1/0,-1/0],hE=[],uE=[],cE=[],fE=[];function dE(t){return t[3].declutterBox}const gE=new RegExp("["+String.fromCharCode(1425)+"-"+String.fromCharCode(2303)+String.fromCharCode(64285)+"-"+String.fromCharCode(65023)+String.fromCharCode(65136)+"-"+String.fromCharCode(65276)+String.fromCharCode(67584)+"-"+String.fromCharCode(69631)+String.fromCharCode(124928)+"-"+String.fromCharCode(126975)+"]");function pE(t,e){return"start"===e?e=gE.test(t)?"right":"left":"end"===e&&(e=gE.test(t)?"left":"right"),iE[e]}function mE(t,e,n){return n>0&&t.push("\n",""),t.push(e,""),t}const yE=class{constructor(t,e,n,i,r){this.overlaps=n,this.pixelRatio=e,this.resolution=t,this.alignAndScaleFill_,this.instructions=i.instructions,this.coordinates=i.coordinates,this.coordinateCache_={},this.renderedTransform_=[1,0,0,1,0,0],this.hitDetectionInstructions=i.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=i.fillStates||{},this.strokeStates=i.strokeStates||{},this.textStates=i.textStates||{},this.widths_={},this.labels_={},this.zIndexContext_=r?new pa:null}getZIndexContext(){return this.zIndexContext_}createLabel(t,e,n,i){const r=t+e+n+i;if(this.labels_[r])return this.labels_[r];const s=i?this.strokeStates[i]:null,o=n?this.fillStates[n]:null,a=this.textStates[e],l=this.pixelRatio,h=[a.scale[0]*l,a.scale[1]*l],u=Array.isArray(t),c=a.justify?iE[a.justify]:pE(Array.isArray(t)?t[0]:t,a.textAlign||_r),f=i&&s.lineWidth?s.lineWidth:0,d=u?t:t.split("\n").reduce(mE,[]),{width:g,height:p,widths:m,heights:y,lineWidths:v}=function(t,e){const n=[],i=[],r=[];let s=0,o=0,a=0,l=0;for(let h=0,u=e.length;h<=u;h+=2){const c=e[h];if("\n"===c||h===u){s=Math.max(s,o),r.push(o),o=0,a+=l;continue}const f=e[h+1]||t.font,d=Nr(f,c);n.push(d),o+=d;const g=Pr(f);i.push(g),l=Math.max(l,g)}return{width:s,height:a,widths:n,heights:i,lineWidths:r}}(a,d),w=g+f,x=[],_=(w+2)*h[0],b=(p+f)*h[1],E={width:_<0?Math.floor(_):Math.ceil(_),height:b<0?Math.floor(b):Math.ceil(b),contextInstructions:x};1==h[0]&&1==h[1]||x.push("scale",h),i&&(x.push("strokeStyle",s.strokeStyle),x.push("lineWidth",f),x.push("lineCap",s.lineCap),x.push("lineJoin",s.lineJoin),x.push("miterLimit",s.miterLimit),x.push("setLineDash",[s.lineDash]),x.push("lineDashOffset",s.lineDashOffset)),n&&x.push("fillStyle",o.fillStyle),x.push("textBaseline","middle"),x.push("textAlign","center");const S=.5-c;let I=c*w+S*f;const C=[],M=[];let R,P=0,T=0,N=0,A=0;for(let t=0,e=d.length;t<e;t+=2){const e=d[t];if("\n"===e){T+=P,P=0,I=c*w+S*f,++A;continue}const r=d[t+1]||a.font;r!==R&&(i&&C.push("font",r),n&&M.push("font",r),R=r),P=Math.max(P,y[N]);const s=[e,I+S*m[N]+c*(m[N]-v[A]),.5*(f+P)+T];I+=m[N],i&&C.push("strokeText",s),n&&M.push("fillText",s),++N}return Array.prototype.push.apply(x,C),Array.prototype.push.apply(x,M),this.labels_[r]=E,E}replayTextBackground_(t,e,n,i,r,s,o){t.beginPath(),t.moveTo.apply(t,e),t.lineTo.apply(t,n),t.lineTo.apply(t,i),t.lineTo.apply(t,r),t.lineTo.apply(t,e),s&&(this.alignAndScaleFill_=s[2],this.fill_(t)),o&&(this.setStrokeStyle_(t,o),t.stroke())}calculateImageOrLabelDimensions_(t,e,n,i,r,s,o,a,l,h,u,c,f,d,g,p){let m=n-(o*=c[0]),y=i-(a*=c[1]);const v=r+l>t?t-l:r,w=s+h>e?e-h:s,x=d[3]+v*c[0]+d[1],_=d[0]+w*c[1]+d[2],b=m-d[3],E=y-d[0];let S;return(g||0!==u)&&(hE[0]=b,fE[0]=b,hE[1]=E,uE[1]=E,uE[0]=b+x,cE[0]=uE[0],cE[1]=E+_,fE[1]=cE[1]),0!==u?(S=ln([1,0,0,1,0,0],n,i,1,1,u,-n,-i),an(S,hE),an(S,uE),an(S,cE),an(S,fE),Ut(Math.min(hE[0],uE[0],cE[0],fE[0]),Math.min(hE[1],uE[1],cE[1],fE[1]),Math.max(hE[0],uE[0],cE[0],fE[0]),Math.max(hE[1],uE[1],cE[1],fE[1]),lE)):Ut(Math.min(b,b+x),Math.min(E,E+_),Math.max(b,b+x),Math.max(E,E+_),lE),f&&(m=Math.round(m),y=Math.round(y)),{drawImageX:m,drawImageY:y,drawImageW:v,drawImageH:w,originX:l,originY:h,declutterBox:{minX:lE[0],minY:lE[1],maxX:lE[2],maxY:lE[3],value:p},canvasTransform:S,scale:c}}replayImageOrLabel_(t,e,n,i,r,s,o){const a=!(!s&&!o),l=i.declutterBox,h=o?o[2]*i.scale[0]/2:0;return l.minX-h<=e[0]&&l.maxX+h>=0&&l.minY-h<=e[1]&&l.maxY+h>=0&&(a&&this.replayTextBackground_(t,hE,uE,cE,fE,s,o),function(t,e,n,i,r,s,o,a,l,h,u){t.save(),1!==n&&(void 0===t.globalAlpha?t.globalAlpha=t=>t.globalAlpha*=n:t.globalAlpha*=n),e&&t.transform.apply(t,e),i.contextInstructions?(t.translate(l,h),t.scale(u[0],u[1]),function(t,e){const n=t.contextInstructions;for(let t=0,i=n.length;t<i;t+=2)Array.isArray(n[t+1])?e[n[t]].apply(e,n[t+1]):e[n[t]]=n[t+1]}(i,t)):u[0]<0||u[1]<0?(t.translate(l,h),t.scale(u[0],u[1]),t.drawImage(i,r,s,o,a,0,0,o,a)):t.drawImage(i,r,s,o,a,l,h,o*u[0],a*u[1]),t.restore()}(t,i.canvasTransform,r,n,i.originX,i.originY,i.drawImageW,i.drawImageH,i.drawImageX,i.drawImageY,i.scale)),!0}fill_(t){const e=this.alignAndScaleFill_;if(e){const n=an(this.renderedTransform_,[0,0]),i=512*this.pixelRatio;t.save(),t.translate(n[0]%i,n[1]%i),1!==e&&t.scale(e,e),t.rotate(this.viewRotation_)}t.fill(),e&&t.restore()}setStrokeStyle_(t,e){t.strokeStyle=e[1],t.lineWidth=e[2],t.lineCap=e[3],t.lineJoin=e[4],t.miterLimit=e[5],t.lineDashOffset=e[7],t.setLineDash(e[6])}drawLabelWithPointPlacement_(t,e,n,i){const r=this.textStates[e],s=this.createLabel(t,e,i,n),o=this.strokeStates[n],a=this.pixelRatio,l=pE(Array.isArray(t)?t[0]:t,r.textAlign||_r),h=iE[r.textBaseline||br],u=o&&o.lineWidth?o.lineWidth:0;return{label:s,anchorX:l*(s.width/a-2*r.scale[0])+2*(.5-l)*u,anchorY:h*s.height/a+2*(.5-h)*u}}execute_(t,e,n,i,r,s,o,a){const l=this.zIndexContext_;let h;var u,f;this.pixelCoordinates_&&c(n,this.renderedTransform_)?h=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),h=fn(this.coordinates,0,this.coordinates.length,2,n,this.pixelCoordinates_),f=n,(u=this.renderedTransform_)[0]=f[0],u[1]=f[1],u[2]=f[2],u[3]=f[3],u[4]=f[4],u[5]=f[5]);let d=0;const g=i.length;let p,m,y,v,w,x,_,b,E,S,I,C,M,R=0,P=0,T=0,N=null,A=null;const k=this.coordinateCache_,L=this.viewRotation_,O=Math.round(1e12*Math.atan2(-n[1],n[0]))/1e12,D={context:t,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:L},F=this.instructions!=i||this.overlaps?0:200;let z,G,B,U;for(;d<g;){const n=i[d];switch(n[0]){case Kb.BEGIN_GEOMETRY:z=n[1],U=n[3],z.getGeometry()?void 0===o||he(o,U.getExtent())?++d:d=n[2]+1:d=n[2],l&&(l.zIndex=n[4]);break;case Kb.BEGIN_PATH:P>F&&(this.fill_(t),P=0),T>F&&(t.stroke(),T=0),P||T||(t.beginPath(),w=NaN,x=NaN),++d;break;case Kb.CIRCLE:R=n[1];const i=h[R],u=h[R+1],c=h[R+2]-i,f=h[R+3]-u,g=Math.sqrt(c*c+f*f);t.moveTo(i+g,u),t.arc(i,u,g,0,2*Math.PI,!0),++d;break;case Kb.CLOSE_PATH:t.closePath(),++d;break;case Kb.CUSTOM:R=n[1],p=n[2];const q=n[3],V=n[4],Y=n[5];D.geometry=q,D.feature=z,d in k||(k[d]=[]);const X=k[d];Y?Y(h,R,p,2,X):(X[0]=h[R],X[1]=h[R+1],X.length=2),l&&(l.zIndex=n[6]),V(X,D),++d;break;case Kb.DRAW_IMAGE:R=n[1],p=n[2],E=n[3],m=n[4],y=n[5];let j=n[6];const W=n[7],H=n[8],$=n[9],Z=n[10];let K=n[11];const J=n[12];let Q=n[13];v=n[14]||"declutter";const tt=n[15];if(!E&&n.length>=20){S=n[19],I=n[20],C=n[21],M=n[22];const t=this.drawLabelWithPointPlacement_(S,I,C,M);E=t.label,n[3]=E;const e=n[23];m=(t.anchorX-e)*this.pixelRatio,n[4]=m;const i=n[24];y=(t.anchorY-i)*this.pixelRatio,n[5]=y,j=E.height,n[6]=j,Q=E.width,n[13]=Q}let et,nt,it,rt;n.length>25&&(et=n[25]),n.length>17?(nt=n[16],it=n[17],rt=n[18]):(nt=Er,it=!1,rt=!1),Z&&O?K+=L:Z||O||(K-=L);let st=0;for(;R<p;R+=2){if(et&&et[st++]<Q/this.pixelRatio)continue;const n=this.calculateImageOrLabelDimensions_(E.width,E.height,h[R],h[R+1],Q,j,m,y,H,$,K,J,r,nt,it||rt,z),i=[t,e,E,n,W,it?N:null,rt?A:null];if(a){let t,e,r,s,o;if(tt){const n=p-R;if(!tt[n]){tt[n]={args:i,declutterMode:v};continue}const s=tt[n];t=s.args,e=s.declutterMode,delete tt[n],r=dE(t)}if(!t||"declutter"===e&&a.collides(r)||(s=!0),"declutter"===v&&a.collides(n.declutterBox)||(o=!0),"declutter"===e&&"declutter"===v){const t=s&&o;s=t,o=t}s&&("none"!==e&&a.insert(r),this.replayImageOrLabel_.apply(this,t)),o&&("none"!==v&&a.insert(n.declutterBox),this.replayImageOrLabel_.apply(this,i))}else this.replayImageOrLabel_.apply(this,i)}++d;break;case Kb.DRAW_CHARS:const ot=n[1],at=n[2],lt=n[3],ht=n[4];M=n[5];const ut=n[6],ct=n[7],ft=n[8];C=n[9];const dt=n[10];S=n[11],I=n[12];const gt=[n[13],n[13]];v=n[14]||"declutter";const pt=this.textStates[I],mt=pt.font,yt=[pt.scale[0]*ct,pt.scale[1]*ct];let vt;mt in this.widths_?vt=this.widths_[mt]:(vt={},this.widths_[mt]=vt);const wt=aE(h,ot,at,2),xt=Math.abs(yt[0])*Ar(mt,S,vt);if(ht||xt<=wt){const n=oE(h,ot,at,2,S,(wt-xt)*pE(S,this.textStates[I].textAlign),ut,Math.abs(yt[0]),Ar,mt,vt,O?0:this.viewRotation_);t:if(n){const i=[];let r,s,o,l,h;if(C)for(r=0,s=n.length;r<s;++r){h=n[r],o=h[4],l=this.createLabel(o,I,"",C),m=h[2]+(yt[0]<0?-dt:dt),y=lt*l.height+2*(.5-lt)*dt*yt[1]/yt[0]-ft;const s=this.calculateImageOrLabelDimensions_(l.width,l.height,h[0],h[1],l.width,l.height,m,y,0,0,h[3],gt,!1,Er,!1,z);if(a&&"declutter"===v&&a.collides(s.declutterBox))break t;i.push([t,e,l,s,1,null,null])}if(M)for(r=0,s=n.length;r<s;++r){h=n[r],o=h[4],l=this.createLabel(o,I,M,""),m=h[2],y=lt*l.height-ft;const s=this.calculateImageOrLabelDimensions_(l.width,l.height,h[0],h[1],l.width,l.height,m,y,0,0,h[3],gt,!1,Er,!1,z);if(a&&"declutter"===v&&a.collides(s.declutterBox))break t;i.push([t,e,l,s,1,null,null])}a&&"none"!==v&&a.load(i.map(dE));for(let t=0,e=i.length;t<e;++t)this.replayImageOrLabel_.apply(this,i[t])}}++d;break;case Kb.END_GEOMETRY:if(void 0!==s){z=n[1];const t=s(z,U);if(t)return t}++d;break;case Kb.FILL:F?P++:this.fill_(t),++d;break;case Kb.MOVE_TO_LINE_TO:for(R=n[1],p=n[2],G=h[R],B=h[R+1],_=G+.5|0,b=B+.5|0,_===w&&b===x||(t.moveTo(G,B),w=_,x=b),R+=2;R<p;R+=2)G=h[R],B=h[R+1],_=G+.5|0,b=B+.5|0,R!=p-2&&_===w&&b===x||(t.lineTo(G,B),w=_,x=b);++d;break;case Kb.SET_FILL_STYLE:N=n,this.alignAndScaleFill_=n[2],P&&(this.fill_(t),P=0,T&&(t.stroke(),T=0)),t.fillStyle=n[1],++d;break;case Kb.SET_STROKE_STYLE:A=n,T&&(t.stroke(),T=0),this.setStrokeStyle_(t,n),++d;break;case Kb.STROKE:F?T++:t.stroke(),++d;break;default:++d}}P&&this.fill_(t),T&&t.stroke()}execute(t,e,n,i,r,s){this.viewRotation_=i,this.execute_(t,e,n,this.instructions,r,void 0,void 0,s)}executeHitDetection(t,e,n,i,r){return this.viewRotation_=n,this.execute_(t,[t.canvas.width,t.canvas.height],e,this.hitDetectionInstructions,!0,i,r)}},vE=["Polygon","Circle","LineString","Image","Text","Default"],wE=["Image","Text"],xE=vE.filter((t=>!wE.includes(t))),_E={},bE=class{constructor(t,e,n,i,r,s,o){this.maxExtent_=t,this.overlaps_=i,this.pixelRatio_=n,this.resolution_=e,this.renderBuffer_=s,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=[1,0,0,1,0,0],this.renderedContext_=null,this.deferredZIndexContexts_={},this.createExecutors_(r,o)}clip(t,e){const n=this.getClipCoords(e);t.beginPath(),t.moveTo(n[0],n[1]),t.lineTo(n[2],n[3]),t.lineTo(n[4],n[5]),t.lineTo(n[6],n[7]),t.clip()}createExecutors_(t,e){for(const n in t){let i=this.executorsByZIndex_[n];void 0===i&&(i={},this.executorsByZIndex_[n]=i);const r=t[n];for(const t in r){const n=r[t];i[t]=new yE(this.resolution_,this.pixelRatio_,this.overlaps_,n,e)}}}hasExecutors(t){for(const e in this.executorsByZIndex_){const n=this.executorsByZIndex_[e];for(let e=0,i=t.length;e<i;++e)if(t[e]in n)return!0}return!1}forEachFeatureAtCoordinate(t,e,n,i,r,s){const o=2*(i=Math.round(i))+1,l=ln(this.hitDetectionTransform_,i+.5,i+.5,1/e,-1/e,-n,-t[0],-t[1]),h=!this.hitDetectionContext_;h&&(this.hitDetectionContext_=$i(o,o,void 0,{willReadFrequently:!0}));const u=this.hitDetectionContext_;let c;u.canvas.width!==o||u.canvas.height!==o?(u.canvas.width=o,u.canvas.height=o):h||u.clearRect(0,0,o,o),void 0!==this.renderBuffer_&&(c=[1/0,1/0,-1/0,-1/0],Wt(c,t),Lt(c,e*(this.renderBuffer_+i),c));const f=function(t){if(void 0!==_E[t])return _E[t];const e=2*t+1,n=t*t,i=new Array(n+1);for(let r=0;r<=t;++r)for(let s=0;s<=t;++s){const o=r*r+s*s;if(o>n)break;let a=i[o];a||(a=[],i[o]=a),a.push(4*((t+r)*e+(t+s))+3),r>0&&a.push(4*((t-r)*e+(t+s))+3),s>0&&(a.push(4*((t+r)*e+(t-s))+3),r>0&&a.push(4*((t-r)*e+(t-s))+3))}const r=[];for(let t=0,e=i.length;t<e;++t)i[t]&&r.push(...i[t]);return _E[t]=r,r}(i);let d;function g(t,e){const n=u.getImageData(0,0,o,o).data;for(let a=0,l=f.length;a<l;a++)if(n[f[a]]>0){if(!s||"Image"!==d&&"Text"!==d||s.includes(t)){const n=(f[a]-3)/4,s=i-n%o,l=i-(n/o|0),h=r(t,e,s*s+l*l);if(h)return h}u.clearRect(0,0,o,o);break}}const p=Object.keys(this.executorsByZIndex_).map(Number);let m,y,v,w,x;for(p.sort(a),m=p.length-1;m>=0;--m){const t=p[m].toString();for(v=this.executorsByZIndex_[t],y=vE.length-1;y>=0;--y)if(d=vE[y],w=v[d],void 0!==w&&(x=w.executeHitDetection(u,l,n,g,c),x))return x}}getClipCoords(t){const e=this.maxExtent_;if(!e)return null;const n=e[0],i=e[1],r=e[2],s=e[3],o=[n,i,n,s,r,s,r,i];return fn(o,0,8,2,t,o),o}isEmpty(){return v(this.executorsByZIndex_)}execute(t,e,n,i,r,s,o){const l=Object.keys(this.executorsByZIndex_).map(Number);let h,u,c,f,d,g;for(l.sort(a),s=s||vE,o&&l.reverse(),h=0,u=l.length;h<u;++h){const a=l[h].toString();for(d=this.executorsByZIndex_[a],c=0,f=s.length;c<f;++c){const a=s[c];if(g=d[a],void 0!==g){const s=null===o?void 0:g.getZIndexContext(),u=s?s.getContext():t,c=this.maxExtent_&&"Image"!==a&&"Text"!==a;if(c&&(u.save(),this.clip(u,n)),g.execute(u,e,n,i,r,o),c&&u.restore(),s){s.offset();const t=l[h];this.deferredZIndexContexts_[t]||(this.deferredZIndexContexts_[t]=[]),this.deferredZIndexContexts_[t].push(s)}}}}this.renderedContext_=t}getDeferredZIndexContexts(){return this.deferredZIndexContexts_}getRenderedContext(){return this.renderedContext_}renderDeferred(){const t=this.deferredZIndexContexts_,e=Object.keys(t).map(Number).sort(a);for(let n=0,i=e.length;n<i;++n)t[e[n]].forEach((t=>{t.draw(this.renderedContext_),t.clear()}))}},EE=class extends Jb{constructor(t,e,n,i,r,s,o){super(),this.context_=t,this.pixelRatio_=e,this.extent_=n,this.transform_=i,this.transformRotation_=i?rt(Math.atan2(i[1],i[0]),10):0,this.viewRotation_=r,this.squaredTolerance_=s,this.userTransform_=o,this.contextFillState_=null,this.contextStrokeState_=null,this.contextTextState_=null,this.fillState_=null,this.strokeState_=null,this.image_=null,this.imageAnchorX_=0,this.imageAnchorY_=0,this.imageHeight_=0,this.imageOpacity_=0,this.imageOriginX_=0,this.imageOriginY_=0,this.imageRotateWithView_=!1,this.imageRotation_=0,this.imageScale_=[0,0],this.imageWidth_=0,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=!1,this.textRotation_=0,this.textScale_=[0,0],this.textFillState_=null,this.textStrokeState_=null,this.textState_=null,this.pixelCoordinates_=[],this.tmpLocalTransform_=[1,0,0,1,0,0]}drawImages_(t,e,n,i){if(!this.image_)return;const r=fn(t,e,n,i,this.transform_,this.pixelCoordinates_),s=this.context_,o=this.tmpLocalTransform_,a=s.globalAlpha;1!=this.imageOpacity_&&(s.globalAlpha=a*this.imageOpacity_);let l=this.imageRotation_;0===this.transformRotation_&&(l-=this.viewRotation_),this.imageRotateWithView_&&(l+=this.viewRotation_);for(let t=0,e=r.length;t<e;t+=2){const e=r[t]-this.imageAnchorX_,n=r[t+1]-this.imageAnchorY_;if(0!==l||1!=this.imageScale_[0]||1!=this.imageScale_[1]){const t=e+this.imageAnchorX_,i=n+this.imageAnchorY_;ln(o,t,i,1,1,l,-t,-i),s.save(),s.transform.apply(s,o),s.translate(t,i),s.scale(this.imageScale_[0],this.imageScale_[1]),s.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),s.restore()}else s.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,e,n,this.imageWidth_,this.imageHeight_)}1!=this.imageOpacity_&&(s.globalAlpha=a)}drawText_(t,e,n,i){if(!this.textState_||""===this.text_)return;this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);const r=fn(t,e,n,i,this.transform_,this.pixelCoordinates_),s=this.context_;let o=this.textRotation_;for(0===this.transformRotation_&&(o-=this.viewRotation_),this.textRotateWithView_&&(o+=this.viewRotation_);e<n;e+=i){const t=r[e]+this.textOffsetX_,n=r[e+1]+this.textOffsetY_;0!==o||1!=this.textScale_[0]||1!=this.textScale_[1]?(s.save(),s.translate(t-this.textOffsetX_,n-this.textOffsetY_),s.rotate(o),s.translate(this.textOffsetX_,this.textOffsetY_),s.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&s.strokeText(this.text_,0,0),this.textFillState_&&s.fillText(this.text_,0,0),s.restore()):(this.textStrokeState_&&s.strokeText(this.text_,t,n),this.textFillState_&&s.fillText(this.text_,t,n))}}moveToLineTo_(t,e,n,i,r){const s=this.context_,o=fn(t,e,n,i,this.transform_,this.pixelCoordinates_);s.moveTo(o[0],o[1]);let a=o.length;r&&(a-=2);for(let t=2;t<a;t+=2)s.lineTo(o[t],o[t+1]);return r&&s.closePath(),n}drawRings_(t,e,n,i){for(let r=0,s=n.length;r<s;++r)e=this.moveToLineTo_(t,e,n[r],i,!0);return e}drawCircle(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),he(this.extent_,t.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=function(t,e,n){const i=t.getFlatCoordinates();if(!i)return null;const r=t.getStride();return fn(i,0,i.length,r,e,n)}(t,this.transform_,this.pixelCoordinates_),n=e[2]-e[0],i=e[3]-e[1],r=Math.sqrt(n*n+i*i),s=this.context_;s.beginPath(),s.arc(e[0],e[1],r,0,2*Math.PI),this.fillState_&&s.fill(),this.strokeState_&&s.stroke()}""!==this.text_&&this.drawText_(t.getCenter(),0,2,2)}}setStyle(t){this.setFillStrokeStyle(t.getFill(),t.getStroke()),this.setImageStyle(t.getImage()),this.setTextStyle(t.getText())}setTransform(t){this.transform_=t}drawGeometry(t){switch(t.getType()){case"Point":this.drawPoint(t);break;case"LineString":this.drawLineString(t);break;case"Polygon":this.drawPolygon(t);break;case"MultiPoint":this.drawMultiPoint(t);break;case"MultiLineString":this.drawMultiLineString(t);break;case"MultiPolygon":this.drawMultiPolygon(t);break;case"GeometryCollection":this.drawGeometryCollection(t);break;case"Circle":this.drawCircle(t)}}drawFeature(t,e){const n=e.getGeometryFunction()(t);n&&(this.setStyle(e),this.drawGeometry(n))}drawGeometryCollection(t){const e=t.getGeometriesArray();for(let t=0,n=e.length;t<n;++t)this.drawGeometry(e[t])}drawPoint(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const e=t.getFlatCoordinates(),n=t.getStride();this.image_&&this.drawImages_(e,0,e.length,n),""!==this.text_&&this.drawText_(e,0,e.length,n)}drawMultiPoint(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const e=t.getFlatCoordinates(),n=t.getStride();this.image_&&this.drawImages_(e,0,e.length,n),""!==this.text_&&this.drawText_(e,0,e.length,n)}drawLineString(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),he(this.extent_,t.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const e=this.context_,n=t.getFlatCoordinates();e.beginPath(),this.moveToLineTo_(n,0,n.length,t.getStride(),!1),e.stroke()}if(""!==this.text_){const e=t.getFlatMidpoint();this.drawText_(e,0,2,2)}}}drawMultiLineString(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const e=t.getExtent();if(he(this.extent_,e)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const e=this.context_,n=t.getFlatCoordinates();let i=0;const r=t.getEnds(),s=t.getStride();e.beginPath();for(let t=0,e=r.length;t<e;++t)i=this.moveToLineTo_(n,i,r[t],s,!1);e.stroke()}if(""!==this.text_){const e=t.getFlatMidpoints();this.drawText_(e,0,e.length,2)}}}drawPolygon(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),he(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=this.context_;e.beginPath(),this.drawRings_(t.getOrientedFlatCoordinates(),0,t.getEnds(),t.getStride()),this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(""!==this.text_){const e=t.getFlatInteriorPoint();this.drawText_(e,0,2,2)}}}drawMultiPolygon(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),he(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=this.context_,n=t.getOrientedFlatCoordinates();let i=0;const r=t.getEndss(),s=t.getStride();e.beginPath();for(let t=0,e=r.length;t<e;++t){const e=r[t];i=this.drawRings_(n,i,e,s)}this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(""!==this.text_){const e=t.getFlatInteriorPoints();this.drawText_(e,0,e.length,2)}}}setContextFillState_(t){const e=this.context_,n=this.contextFillState_;n?n.fillStyle!=t.fillStyle&&(n.fillStyle=t.fillStyle,e.fillStyle=t.fillStyle):(e.fillStyle=t.fillStyle,this.contextFillState_={fillStyle:t.fillStyle})}setContextStrokeState_(t){const e=this.context_,n=this.contextStrokeState_;n?(n.lineCap!=t.lineCap&&(n.lineCap=t.lineCap,e.lineCap=t.lineCap),c(n.lineDash,t.lineDash)||e.setLineDash(n.lineDash=t.lineDash),n.lineDashOffset!=t.lineDashOffset&&(n.lineDashOffset=t.lineDashOffset,e.lineDashOffset=t.lineDashOffset),n.lineJoin!=t.lineJoin&&(n.lineJoin=t.lineJoin,e.lineJoin=t.lineJoin),n.lineWidth!=t.lineWidth&&(n.lineWidth=t.lineWidth,e.lineWidth=t.lineWidth),n.miterLimit!=t.miterLimit&&(n.miterLimit=t.miterLimit,e.miterLimit=t.miterLimit),n.strokeStyle!=t.strokeStyle&&(n.strokeStyle=t.strokeStyle,e.strokeStyle=t.strokeStyle)):(e.lineCap=t.lineCap,e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset,e.lineJoin=t.lineJoin,e.lineWidth=t.lineWidth,e.miterLimit=t.miterLimit,e.strokeStyle=t.strokeStyle,this.contextStrokeState_={lineCap:t.lineCap,lineDash:t.lineDash,lineDashOffset:t.lineDashOffset,lineJoin:t.lineJoin,lineWidth:t.lineWidth,miterLimit:t.miterLimit,strokeStyle:t.strokeStyle})}setContextTextState_(t){const e=this.context_,n=this.contextTextState_,i=t.textAlign?t.textAlign:_r;n?(n.font!=t.font&&(n.font=t.font,e.font=t.font),n.textAlign!=i&&(n.textAlign=i,e.textAlign=i),n.textBaseline!=t.textBaseline&&(n.textBaseline=t.textBaseline,e.textBaseline=t.textBaseline)):(e.font=t.font,e.textAlign=i,e.textBaseline=t.textBaseline,this.contextTextState_={font:t.font,textAlign:i,textBaseline:t.textBaseline})}setFillStrokeStyle(t,e){if(t){const e=t.getColor();this.fillState_={fillStyle:ar(e||mr)}}else this.fillState_=null;if(e){const t=e.getColor(),n=e.getLineCap(),i=e.getLineDash(),r=e.getLineDashOffset(),s=e.getLineJoin(),o=e.getWidth(),a=e.getMiterLimit(),l=i||vr;this.strokeState_={lineCap:void 0!==n?n:yr,lineDash:1===this.pixelRatio_?l:l.map((t=>t*this.pixelRatio_)),lineDashOffset:(r||0)*this.pixelRatio_,lineJoin:void 0!==s?s:wr,lineWidth:(void 0!==o?o:1)*this.pixelRatio_,miterLimit:void 0!==a?a:10,strokeStyle:ar(t||xr)}}else this.strokeState_=null}setImageStyle(t){let e;if(!t||!(e=t.getSize()))return void(this.image_=null);const n=t.getPixelRatio(this.pixelRatio_),i=t.getAnchor(),r=t.getOrigin();this.image_=t.getImage(this.pixelRatio_),this.imageAnchorX_=i[0]*n,this.imageAnchorY_=i[1]*n,this.imageHeight_=e[1]*n,this.imageOpacity_=t.getOpacity(),this.imageOriginX_=r[0],this.imageOriginY_=r[1],this.imageRotateWithView_=t.getRotateWithView(),this.imageRotation_=t.getRotation();const s=t.getScaleArray();this.imageScale_=[s[0]*this.pixelRatio_/n,s[1]*this.pixelRatio_/n],this.imageWidth_=e[0]*n}setTextStyle(t){if(t){const e=t.getFill();if(e){const t=e.getColor();this.textFillState_={fillStyle:ar(t||mr)}}else this.textFillState_=null;const n=t.getStroke();if(n){const t=n.getColor(),e=n.getLineCap(),i=n.getLineDash(),r=n.getLineDashOffset(),s=n.getLineJoin(),o=n.getWidth(),a=n.getMiterLimit();this.textStrokeState_={lineCap:void 0!==e?e:yr,lineDash:i||vr,lineDashOffset:r||0,lineJoin:void 0!==s?s:wr,lineWidth:void 0!==o?o:1,miterLimit:void 0!==a?a:10,strokeStyle:ar(t||xr)}}else this.textStrokeState_=null;const i=t.getFont(),r=t.getOffsetX(),s=t.getOffsetY(),o=t.getRotateWithView(),a=t.getRotation(),l=t.getScaleArray(),h=t.getText(),u=t.getTextAlign(),c=t.getTextBaseline();this.textState_={font:void 0!==i?i:pr,textAlign:void 0!==u?u:_r,textBaseline:void 0!==c?c:br},this.text_=void 0!==h?Array.isArray(h)?h.reduce(((t,e,n)=>t+(n%2?" ":e)),""):h:"",this.textOffsetX_=void 0!==r?this.pixelRatio_*r:0,this.textOffsetY_=void 0!==s?this.pixelRatio_*s:0,this.textRotateWithView_=void 0!==o&&o,this.textRotation_=void 0!==a?a:0,this.textScale_=[this.pixelRatio_*l[0],this.pixelRatio_*l[1]]}else this.text_=""}},SE=.5;const IE=.5,CE={Point:function(t,e,n,i,r,s){const o=n.getImage(),a=n.getText(),l=a&&a.getText(),h=s&&o&&l?{}:void 0;if(o){if(o.getImageState()!=gi)return;const s=t.getBuilder(n.getZIndex(),"Image");s.setImageStyle(o,h),s.drawPoint(e,i,r)}if(l){const s=t.getBuilder(n.getZIndex(),"Text");s.setTextStyle(a,h),s.drawText(e,i,r)}},LineString:function(t,e,n,i,r){const s=n.getStroke();if(s){const o=t.getBuilder(n.getZIndex(),"LineString");o.setFillStrokeStyle(null,s),o.drawLineString(e,i,r)}const o=n.getText();if(o&&o.getText()){const s=t.getBuilder(n.getZIndex(),"Text");s.setTextStyle(o),s.drawText(e,i,r)}},Polygon:function(t,e,n,i,r){const s=n.getFill(),o=n.getStroke();if(s||o){const a=t.getBuilder(n.getZIndex(),"Polygon");a.setFillStrokeStyle(s,o),a.drawPolygon(e,i,r)}const a=n.getText();if(a&&a.getText()){const s=t.getBuilder(n.getZIndex(),"Text");s.setTextStyle(a),s.drawText(e,i,r)}},MultiPoint:function(t,e,n,i,r,s){const o=n.getImage(),a=o&&0!==o.getOpacity(),l=n.getText(),h=l&&l.getText(),u=s&&a&&h?{}:void 0;if(a){if(o.getImageState()!=gi)return;const s=t.getBuilder(n.getZIndex(),"Image");s.setImageStyle(o,u),s.drawMultiPoint(e,i,r)}if(h){const s=t.getBuilder(n.getZIndex(),"Text");s.setTextStyle(l,u),s.drawText(e,i,r)}},MultiLineString:function(t,e,n,i,r){const s=n.getStroke();if(s){const o=t.getBuilder(n.getZIndex(),"LineString");o.setFillStrokeStyle(null,s),o.drawMultiLineString(e,i,r)}const o=n.getText();if(o&&o.getText()){const s=t.getBuilder(n.getZIndex(),"Text");s.setTextStyle(o),s.drawText(e,i,r)}},MultiPolygon:function(t,e,n,i,r){const s=n.getFill(),o=n.getStroke();if(o||s){const a=t.getBuilder(n.getZIndex(),"Polygon");a.setFillStrokeStyle(s,o),a.drawMultiPolygon(e,i,r)}const a=n.getText();if(a&&a.getText()){const s=t.getBuilder(n.getZIndex(),"Text");s.setTextStyle(a),s.drawText(e,i,r)}},GeometryCollection:function(t,e,n,i,r,s){const o=e.getGeometriesArray();let a,l;for(a=0,l=o.length;a<l;++a)(0,CE[o[a].getType()])(t,o[a],n,i,r,s)},Circle:function(t,e,n,i,r){const s=n.getFill(),o=n.getStroke();if(s||o){const a=t.getBuilder(n.getZIndex(),"Circle");a.setFillStrokeStyle(s,o),a.drawCircle(e,i,r)}const a=n.getText();if(a&&a.getText()){const r=t.getBuilder(n.getZIndex(),"Text");r.setTextStyle(a),r.drawText(e,i)}}};function ME(t,e){return parseInt(L(t),10)-parseInt(L(e),10)}function RE(t,e){const n=PE(t,e);return n*n}function PE(t,e){return IE*t/e}function TE(t,e,n,i,r,s,o,a){const l=[],h=n.getImage();if(h){let t=!0;const e=h.getImageState();e==gi||e==pi?t=!1:e==fi&&h.load(),t&&l.push(h.ready())}const u=n.getFill();u&&u.loading()&&l.push(u.ready());const c=l.length>0;return c&&Promise.all(l).then((()=>r(null))),function(t,e,n,i,r,s,o){const a=n.getGeometryFunction()(e);if(!a)return;const l=a.simplifyTransformed(i,r);n.getRenderer()?NE(t,l,n,e,o):(0,CE[l.getType()])(t,l,n,e,o,s)}(t,e,n,i,s,o,a),c}function NE(t,e,n,i,r){if("GeometryCollection"!=e.getType())t.getBuilder(n.getZIndex(),"Default").drawCustom(e,i,n.getRenderer(),n.getHitDetectionRenderer(),r);else{const s=e.getGeometries();for(let e=0,o=s.length;e<o;++e)NE(t,s[e],n,i,r)}}const AE=class extends va{constructor(t){super(t),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.animatingOrInteracting_,this.hitDetectionImageData_=null,this.renderedFeatures_=null,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=[1/0,1/0,-1/0,-1/0],this.wrappedRenderedExtent_=[1/0,1/0,-1/0,-1/0],this.renderedRotation_,this.renderedCenter_=null,this.renderedProjection_=null,this.renderedPixelRatio_=1,this.renderedRenderOrder_=null,this.replayGroup_=null,this.replayGroupChanged=!0,this.clipping=!0,this.targetContext_=null,this.opacity_=1}renderWorlds(t,e,n){const i=e.extent,r=e.viewState,s=r.center,o=r.resolution,a=r.projection,l=r.rotation,h=a.getExtent(),u=this.getLayer().getSource(),c=this.getLayer().getDeclutter(),f=e.pixelRatio,d=e.viewHints,g=!(d[0]||d[1]),p=this.context,m=Math.round(le(i)/o*f),y=Math.round(re(i)/o*f),v=u.getWrapX()&&a.canWrapX(),w=v?le(h):null,x=v?Math.ceil((i[2]-h[2])/w)+1:1;let _=v?Math.floor((i[0]-h[0])/w):0;do{const i=this.getRenderTransform(s,o,l,f,m,y,_*w);t.execute(p,[p.canvas.width,p.canvas.height],i,l,g,void 0===n?vE:n?wE:xE,n?c&&e.declutter[c]:void 0)}while(++_<x)}setDrawContext_(){1!==this.opacity_&&(this.targetContext_=this.context,this.context=$i(this.context.canvas.width,this.context.canvas.height,ma))}resetDrawContext_(){if(1!==this.opacity_){const t=this.targetContext_.globalAlpha;this.targetContext_.globalAlpha=this.opacity_,this.targetContext_.drawImage(this.context.canvas,0,0),this.targetContext_.globalAlpha=t,Ji(this.context),ma.push(this.context.canvas),this.context=this.targetContext_,this.targetContext_=null}}renderDeclutter(t){this.replayGroup_&&this.getLayer().getDeclutter()&&this.renderWorlds(this.replayGroup_,t,!0)}renderDeferredInternal(t){this.replayGroup_&&(this.replayGroup_.renderDeferred(),this.resetDrawContext_())}renderFrame(t,e){const n=t.pixelRatio,i=t.layerStatesArray[t.layerIndex];this.opacity_=i.opacity;const r=t.extent,s=t.viewState.resolution,o=Math.round(le(r)/s*n),a=Math.round(re(r)/s*n);ln(this.pixelTransform,t.size[0]/2,t.size[1]/2,1/n,1/n,0,-o/2,-a/2),hn(this.inversePixelTransform,this.pixelTransform);const l=cn(this.pixelTransform);this.useContainer(e,l,this.getBackground(t));const h=this.context,u=h.canvas,c=this.replayGroup_;let f=c&&!c.isEmpty();if(!f&&!this.getLayer().hasListener(ht)&&!this.getLayer().hasListener(ut))return null;u.width!=o||u.height!=a?(u.width=o,u.height=a,u.style.transform!==l&&(u.style.transform=l)):this.containerReused||h.clearRect(0,0,o,a),this.setDrawContext_(),this.preRender(h,t);const d=t.viewState,g=d.projection;let p=!1;if(f&&i.extent&&this.clipping){const e=Ye(i.extent,g);f=he(e,t.extent),p=f&&!zt(e,t.extent),p&&this.clipUnrotated(h,t,e)}return f&&this.renderWorlds(c,t,!this.getLayer().getDeclutter()&&void 0),p&&h.restore(),this.postRender(h,t),this.renderedRotation_!==d.rotation&&(this.renderedRotation_=d.rotation,this.hitDetectionImageData_=null),t.declutter||this.resetDrawContext_(),this.container}getFeatures(t){return new Promise((e=>{if(!this.hitDetectionImageData_&&!this.animatingOrInteracting_){const t=[this.context.canvas.width,this.context.canvas.height];an(this.pixelTransform,t);const e=this.renderedCenter_,n=this.renderedResolution_,i=this.renderedRotation_,r=this.renderedProjection_,s=this.wrappedRenderedExtent_,o=this.getLayer(),l=[],h=t[0]*SE,u=t[1]*SE;l.push(this.getRenderTransform(e,n,i,SE,h,u,0).slice());const c=o.getSource(),f=r.getExtent();if(c.getWrapX()&&r.canWrapX()&&!zt(f,s)){let t=s[0];const r=le(f);let o,a=0;for(;t<f[0];)--a,o=r*a,l.push(this.getRenderTransform(e,n,i,SE,h,u,o).slice()),t+=r;for(a=0,t=s[2];t>f[2];)++a,o=r*a,l.push(this.getRenderTransform(e,n,i,SE,h,u,o).slice()),t-=r}const d=Be();this.hitDetectionImageData_=function(t,e,n,i,r,s,o,l,h){const u=h?Ve(r,h):r,c=$i(t[0]*SE,t[1]*SE);c.imageSmoothingEnabled=!1;const f=c.canvas,d=new EE(c,SE,r,null,o,l,h?Oe(Be(),h):null),g=n.length,p=Math.floor(16777215/g),m={};for(let t=1;t<=g;++t){const e=n[t-1],r=e.getStyleFunction()||i;if(!r)continue;let o=r(e,s);if(!o)continue;Array.isArray(o)||(o=[o]);const a=(t*p).toString(16).padStart(7,"#00000");for(let t=0,n=o.length;t<n;++t){const n=o[t],i=n.getGeometryFunction()(e);if(!i||!he(u,i.getExtent()))continue;const r=n.clone(),s=r.getFill();s&&s.setColor(a);const l=r.getStroke();l&&(l.setColor(a),l.setLineDash(null)),r.setText(void 0);const h=n.getImage();if(h){const t=h.getImageSize();if(!t)continue;const e=$i(t[0],t[1],void 0,{alpha:!1}),n=e.canvas;e.fillStyle=a,e.fillRect(0,0,n.width,n.height),r.setImage(new Hr({img:n,anchor:h.getAnchor(),anchorXUnits:"pixels",anchorYUnits:"pixels",offset:h.getOrigin(),opacity:1,size:h.getSize(),scale:h.getScale(),rotation:h.getRotation(),rotateWithView:h.getRotateWithView()}))}const c=r.getZIndex()||0;let f=m[c];f||(f={},m[c]=f,f.Polygon=[],f.Circle=[],f.LineString=[],f.Point=[]);const d=i.getType();if("GeometryCollection"===d){const t=i.getGeometriesArrayRecursive();for(let e=0,n=t.length;e<n;++e){const n=t[e];f[n.getType().replace("Multi","")].push(n,r)}}else f[d.replace("Multi","")].push(i,r)}}const y=Object.keys(m).map(Number).sort(a);for(let t=0,n=y.length;t<n;++t){const n=m[y[t]];for(const t in n){const i=n[t];for(let t=0,n=i.length;t<n;t+=2){d.setStyle(i[t+1]);for(let n=0,r=e.length;n<r;++n)d.setTransform(e[n]),d.drawGeometry(i[t])}}}return c.getImageData(0,0,f.width,f.height)}(t,l,this.renderedFeatures_,o.getStyleFunction(),s,n,i,RE(n,this.renderedPixelRatio_),d?r:null)}e(function(t,e,n){const i=[];if(n){const r=Math.floor(Math.round(t[0])*SE),s=Math.floor(Math.round(t[1])*SE),o=4*(J(r,0,n.width-1)+J(s,0,n.height-1)*n.width),a=n.data[o],l=n.data[o+1],h=n.data[o+2]+256*(l+256*a),u=Math.floor(16777215/e.length);h&&h%u==0&&i.push(e[h/u-1])}return i}(t,this.renderedFeatures_,this.hitDetectionImageData_))}))}forEachFeatureAtCoordinate(t,e,n,i,r){if(!this.replayGroup_)return;const s=e.viewState.resolution,o=e.viewState.rotation,a=this.getLayer(),l={},h=function(t,e,n){const s=L(t),o=l[s];if(o){if(!0!==o&&n<o.distanceSq){if(0===n)return l[s]=!0,r.splice(r.lastIndexOf(o),1),i(t,a,e);o.geometry=e,o.distanceSq=n}}else{if(0===n)return l[s]=!0,i(t,a,e);r.push(l[s]={feature:t,layer:a,geometry:e,distanceSq:n,callback:i})}};let u;const c=[this.replayGroup_],f=this.getLayer().getDeclutter();return c.some((i=>u=i.forEachFeatureAtCoordinate(t,s,o,n,h,f&&e.declutter[f]?e.declutter[f].all().map((t=>t.value)):null))),u}handleFontsChanged(){const t=this.getLayer();t.getVisible()&&this.replayGroup_&&t.changed()}handleStyleImageChange_(t){this.renderIfReadyAndVisible()}prepareFrame(t){const e=this.getLayer(),n=e.getSource();if(!n)return!1;const i=t.viewHints[0],r=t.viewHints[1],s=e.getUpdateWhileAnimating(),o=e.getUpdateWhileInteracting();if(this.ready&&!s&&i||!o&&r)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;const a=t.extent,l=t.viewState,h=l.projection,u=l.resolution,f=t.pixelRatio,d=e.getRevision(),g=e.getRenderBuffer();let p=e.getRenderOrder();void 0===p&&(p=ME);const m=l.center.slice(),y=Lt(a,g*u),v=y.slice(),w=[y.slice()],x=h.getExtent();if(n.getWrapX()&&h.canWrapX()&&!zt(x,t.extent)){const t=le(x),e=Math.max(le(y)/2,t);y[0]=x[0]-e,y[2]=x[2]+e,pe(m,h);const n=fe(w[0],h);n[0]<x[0]&&n[2]<x[2]?w.push([n[0]+t,n[1],n[2]+t,n[3]]):n[0]>x[0]&&n[2]>x[2]&&w.push([n[0]-t,n[1],n[2]-t,n[3]])}if(this.ready&&this.renderedResolution_==u&&this.renderedRevision_==d&&this.renderedRenderOrder_==p&&zt(this.wrappedRenderedExtent_,y))return c(this.renderedExtent_,v)||(this.hitDetectionImageData_=null,this.renderedExtent_=v),this.renderedCenter_=m,this.replayGroupChanged=!1,!0;this.replayGroup_=null;const _=new sE(PE(u,f),y,u,f),b=Be();let E;if(b){for(let t=0,e=w.length;t<e;++t){const e=Ve(w[t],h);n.loadFeatures(e,Xe(u,h),b)}E=Oe(b,h)}else for(let t=0,e=w.length;t<e;++t)n.loadFeatures(w[t],u,h);const S=RE(u,f);let I=!0;const C=(t,n)=>{let i;const r=t.getStyleFunction()||e.getStyleFunction();if(r&&(i=r(t,u)),i){const e=this.renderFeature(t,S,i,_,E,this.getLayer().getDeclutter(),n);I=I&&!e}},M=Ve(y,h),R=n.getFeaturesInExtent(M);p&&R.sort(p);for(let t=0,e=R.length;t<e;++t)C(R[t],t);this.renderedFeatures_=R,this.ready=I;const P=_.finish(),T=new bE(y,u,f,n.getOverlaps(),P,e.getRenderBuffer(),!!t.declutter);return this.renderedResolution_=u,this.renderedRevision_=d,this.renderedRenderOrder_=p,this.renderedExtent_=v,this.wrappedRenderedExtent_=y,this.renderedCenter_=m,this.renderedProjection_=h,this.renderedPixelRatio_=f,this.replayGroup_=T,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0}renderFeature(t,e,n,i,r,s,o){if(!n)return!1;let a=!1;if(Array.isArray(n))for(let l=0,h=n.length;l<h;++l)a=TE(i,t,n[l],e,this.boundHandleStyleImageChange_,r,s,o)||a;else a=TE(i,t,n,e,this.boundHandleStyleImageChange_,r,s,o);return a}},kE=class extends Ks{constructor(t){super(t)}createRenderer(){return new AE(this)}},LE=class{constructor(t){this.rbush_=new ci(t),this.items_={}}insert(t,e){const n={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3],value:e};this.rbush_.insert(n),this.items_[L(e)]=n}load(t,e){const n=new Array(e.length);for(let i=0,r=e.length;i<r;i++){const r=t[i],s=e[i],o={minX:r[0],minY:r[1],maxX:r[2],maxY:r[3],value:s};n[i]=o,this.items_[L(s)]=o}this.rbush_.load(n)}remove(t){const e=L(t),n=this.items_[e];return delete this.items_[e],null!==this.rbush_.remove(n)}update(t,e){const n=this.items_[L(e)];Xt([n.minX,n.minY,n.maxX,n.maxY],t)||(this.remove(e),this.insert(t,e))}getAll(){return this.rbush_.all().map((function(t){return t.value}))}getInExtent(t){const e={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]};return this.rbush_.search(e).map((function(t){return t.value}))}forEach(t){return this.forEach_(this.getAll(),t)}forEachInExtent(t,e){return this.forEach_(this.getInExtent(t),e)}forEach_(t,e){let n;for(let i=0,r=t.length;i<r;i++)if(n=e(t[i]),n)return n;return n}isEmpty(){return v(this.items_)}clear(){this.rbush_.clear(),this.items_={}}getExtent(t){const e=this.rbush_.toJSON();return Ut(e.minX,e.minY,e.maxX,e.maxY,t)}concat(t){this.rbush_.load(t.rbush_.all());for(const e in t.items_)this.items_[e]=t.items_[e]}};function OE(t,e,n,i,r,s,o){let l,h;const u=(n-e)/i;if(1===u)l=e;else if(2===u)l=e,h=r;else if(0!==u){let s=t[e],o=t[e+1],u=0;const c=[0];for(let r=e+i;r<n;r+=i){const e=t[r],n=t[r+1];u+=Math.sqrt((e-s)*(e-s)+(n-o)*(n-o)),c.push(u),s=e,o=n}const f=r*u,d=function(t,e,n){let i,r;n=n||a;let s=0,o=t.length,l=!1;for(;s<o;)i=s+(o-s>>1),r=+n(t[i],e),r<0?s=i+1:(o=i,l=!r);return l?s:~s}(c,f);d<0?(h=(f-c[-d-2])/(c[-d-1]-c[-d-2]),l=e+(-d-2)*i):l=e+d*i}o=o>1?o:2,s=s||new Array(o);for(let e=0;e<o;++e)s[e]=void 0===l?NaN:void 0===h?t[l+e]:it(t[l+e],t[l+i+e],h);return s}function DE(t,e,n,i,r,s){if(n==e)return null;let o;if(r<t[e+i-1])return s?(o=t.slice(e,e+i),o[i-1]=r,o):null;if(t[n-1]<r)return s?(o=t.slice(n-i,n),o[i-1]=r,o):null;if(r==t[e+i-1])return t.slice(e,e+i);let a=e/i,l=n/i;for(;a<l;){const e=a+l>>1;r<t[(e+1)*i-1]?l=e:a=e+1}const h=t[a*i-1];if(r==h)return t.slice((a-1)*i,(a-1)*i+i);const u=(r-h)/(t[(a+1)*i-1]-h);o=[];for(let e=0;e<i-1;++e)o.push(it(t[(a-1)*i+e],t[a*i+e],u));return o.push(r),o}function FE(t,e,n,i){const r=[];let s=[1/0,1/0,-1/0,-1/0];for(let o=0,a=n.length;o<a;++o){const a=n[o];s=Yt(t,e,a[0],i),r.push((s[0]+s[2])/2,(s[1]+s[3])/2),e=a[a.length-1]}return r}const zE=[1,0,0,1,0,0];class GE{constructor(t,e,n,i,r,s){this.styleFunction,this.extent_,this.id_=s,this.type_=t,this.flatCoordinates_=e,this.flatInteriorPoints_=null,this.flatMidpoints_=null,this.ends_=n||null,this.properties_=r,this.squaredTolerance_,this.stride_=i,this.simplifiedGeometry_}get(t){return this.properties_[t]}getExtent(){return this.extent_||(this.extent_="Point"===this.type_?Vt(this.flatCoordinates_):Yt(this.flatCoordinates_,0,this.flatCoordinates_.length,2)),this.extent_}getFlatInteriorPoint(){if(!this.flatInteriorPoints_){const t=te(this.getExtent());this.flatInteriorPoints_=Yn(this.flatCoordinates_,0,this.ends_,2,t,0)}return this.flatInteriorPoints_}getFlatInteriorPoints(){if(!this.flatInteriorPoints_){const t=function(t,e){const n=[];let i,r=0,s=0;for(let o=0,a=e.length;o<a;++o){const a=e[o],l=Kn(t,r,a,2);if(void 0===i&&(i=l),l===i)n.push(e.slice(s,o+1));else{if(0===n.length)continue;n[n.length-1].push(e[s])}s=o+1,r=a}return n}(this.flatCoordinates_,this.ends_),e=FE(this.flatCoordinates_,0,t,2);this.flatInteriorPoints_=Xn(this.flatCoordinates_,0,t,2,e)}return this.flatInteriorPoints_}getFlatMidpoint(){return this.flatMidpoints_||(this.flatMidpoints_=OE(this.flatCoordinates_,0,this.flatCoordinates_.length,2,.5)),this.flatMidpoints_}getFlatMidpoints(){if(!this.flatMidpoints_){this.flatMidpoints_=[];const t=this.flatCoordinates_;let e=0;const n=this.ends_;for(let i=0,r=n.length;i<r;++i){const r=n[i],s=OE(t,e,r,2,.5);u(this.flatMidpoints_,s),e=r}}return this.flatMidpoints_}getId(){return this.id_}getOrientedFlatCoordinates(){return this.flatCoordinates_}getGeometry(){return this}getSimplifiedGeometry(t){return this}simplifyTransformed(t,e){return this}getProperties(){return this.properties_}getPropertiesInternal(){return this.properties_}getStride(){return this.stride_}getStyleFunction(){return this.styleFunction}getType(){return this.type_}transform(t){const e=(t=Pe(t)).getExtent(),n=t.getWorldExtent();if(e&&n){const t=re(n)/re(e);ln(zE,n[0],n[3],t,-t,0,0,0),fn(this.flatCoordinates_,0,this.flatCoordinates_.length,2,zE,this.flatCoordinates_)}}applyTransform(t){t(this.flatCoordinates_,this.flatCoordinates_,this.stride_)}clone(){return new GE(this.type_,this.flatCoordinates_.slice(),this.ends_?.slice(),this.stride_,Object.assign({},this.properties_),this.id_)}getEnds(){return this.ends_}enableSimplifyTransformed(){return this.simplifyTransformed=p(((t,e)=>{if(t===this.squaredTolerance_)return this.simplifiedGeometry_;this.simplifiedGeometry_=this.clone(),e&&this.simplifiedGeometry_.applyTransform(e);const n=this.simplifiedGeometry_.getFlatCoordinates();let i;switch(this.type_){case"LineString":n.length=Mn(n,0,this.simplifiedGeometry_.flatCoordinates_.length,this.simplifiedGeometry_.stride_,t,n,0),i=[n.length];break;case"MultiLineString":i=[],n.length=Rn(n,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,t,n,0,i);break;case"Polygon":i=[],n.length=Nn(n,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,Math.sqrt(t),n,0,i)}return i&&(this.simplifiedGeometry_=new GE(this.type_,n,i,2,this.properties_,this.id_)),this.squaredTolerance_=t,this.simplifiedGeometry_})),this}}GE.prototype.getFlatCoordinates=GE.prototype.getOrientedFlatCoordinates;const BE=GE,UE="addfeature",qE="removefeature";function VE(t,e){return[[-1/0,-1/0,1/0,1/0]]}let YE=!1;function XE(t,e){return function(n,i,r,s,o){const a=this;!function(t,e,n,i,r,s,o){const a=new XMLHttpRequest;a.open("GET","function"==typeof t?t(n,i,r):t,!0),"arraybuffer"==e.getType()&&(a.responseType="arraybuffer"),a.withCredentials=YE,a.onload=function(t){if(!a.status||a.status>=200&&a.status<300){const t=e.getType();let i;"json"==t?i=JSON.parse(a.responseText):"text"==t?i=a.responseText:"xml"==t?(i=a.responseXML,i||(i=(new DOMParser).parseFromString(a.responseText,"application/xml"))):"arraybuffer"==t&&(i=a.response),i?s(e.readFeatures(i,{extent:n,featureProjection:r}),e.readProjection(i)):o()}else o()},a.onerror=o,a.send()}(t,e,n,i,r,(function(t,e){a.addFeatures(t),void 0!==s&&s(t)}),o||g)}}class jE extends r{constructor(t,e,n){super(t),this.feature=e,this.features=n}}const WE=class extends $_{constructor(t){super({attributions:(t=t||{}).attributions,interpolate:!0,projection:void 0,state:"ready",wrapX:void 0===t.wrapX||t.wrapX}),this.on,this.once,this.un,this.loader_=g,this.format_=t.format,this.overlaps_=void 0===t.overlaps||t.overlaps,this.url_=t.url,void 0!==t.loader?this.loader_=t.loader:void 0!==this.url_&&(K(this.format_,"`format` must be set when `url` is set"),this.loader_=XE(this.url_,this.format_)),this.strategy_=void 0!==t.strategy?t.strategy:VE;const e=void 0===t.useSpatialIndex||t.useSpatialIndex;let n,i;this.featuresRtree_=e?new LE:null,this.loadedExtentsRtree_=new LE,this.loadingExtentsCount_=0,this.nullGeometryFeatures_={},this.idIndex_={},this.uidIndex_={},this.featureChangeKeys_={},this.featuresCollection_=null,Array.isArray(t.features)?i=t.features:t.features&&(n=t.features,i=n.getArray()),e||void 0!==n||(n=new U(i)),void 0!==i&&this.addFeaturesInternal(i),void 0!==n&&this.bindFeaturesCollection_(n)}addFeature(t){this.addFeatureInternal(t),this.changed()}addFeatureInternal(t){const e=L(t);if(!this.addToIndex_(e,t))return void(this.featuresCollection_&&this.featuresCollection_.remove(t));this.setupChangeEvents_(e,t);const n=t.getGeometry();if(n){const e=n.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(e,t)}else this.nullGeometryFeatures_[e]=t;this.dispatchEvent(new jE(UE,t))}setupChangeEvents_(t,e){e instanceof BE||(this.featureChangeKeys_[t]=[M(e,x,this.handleFeatureChange_,this),M(e,s,this.handleFeatureChange_,this)])}addToIndex_(t,e){let n=!0;if(void 0!==e.getId()){const t=String(e.getId());if(t in this.idIndex_)if(e instanceof BE){const i=this.idIndex_[t];i instanceof BE?Array.isArray(i)?i.push(e):this.idIndex_[t]=[i,e]:n=!1}else n=!1;else this.idIndex_[t]=e}return n&&(K(!(t in this.uidIndex_),"The passed `feature` was already added to the source"),this.uidIndex_[t]=e),n}addFeatures(t){this.addFeaturesInternal(t),this.changed()}addFeaturesInternal(t){const e=[],n=[],i=[];for(let e=0,i=t.length;e<i;e++){const i=t[e],r=L(i);this.addToIndex_(r,i)&&n.push(i)}for(let t=0,r=n.length;t<r;t++){const r=n[t],s=L(r);this.setupChangeEvents_(s,r);const o=r.getGeometry();if(o){const t=o.getExtent();e.push(t),i.push(r)}else this.nullGeometryFeatures_[s]=r}if(this.featuresRtree_&&this.featuresRtree_.load(e,i),this.hasListener(UE))for(let t=0,e=n.length;t<e;t++)this.dispatchEvent(new jE(UE,n[t]))}bindFeaturesCollection_(t){let e=!1;this.addEventListener(UE,(function(n){e||(e=!0,t.push(n.feature),e=!1)})),this.addEventListener(qE,(function(n){e||(e=!0,t.remove(n.feature),e=!1)})),t.addEventListener(F,(t=>{e||(e=!0,this.addFeature(t.element),e=!1)})),t.addEventListener(z,(t=>{e||(e=!0,this.removeFeature(t.element),e=!1)})),this.featuresCollection_=t}clear(t){if(t){for(const t in this.featureChangeKeys_)this.featureChangeKeys_[t].forEach(P);this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_){const t=t=>{this.removeFeatureInternal(t)};this.featuresRtree_.forEach(t);for(const t in this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[t])}this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};const e=new jE("clear");this.dispatchEvent(e),this.changed()}forEachFeature(t){if(this.featuresRtree_)return this.featuresRtree_.forEach(t);this.featuresCollection_&&this.featuresCollection_.forEach(t)}forEachFeatureAtCoordinateDirect(t,e){const n=[t[0],t[1],t[0],t[1]];return this.forEachFeatureInExtent(n,(function(n){const i=n.getGeometry();if(i instanceof BE||i.intersectsCoordinate(t))return e(n)}))}forEachFeatureInExtent(t,e){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(t,e);this.featuresCollection_&&this.featuresCollection_.forEach(e)}forEachFeatureIntersectingExtent(t,e){return this.forEachFeatureInExtent(t,(function(n){const i=n.getGeometry();if(i instanceof BE||i.intersectsExtent(t)){const t=e(n);if(t)return t}}))}getFeaturesCollection(){return this.featuresCollection_}getFeatures(){let t;return this.featuresCollection_?t=this.featuresCollection_.getArray().slice(0):this.featuresRtree_&&(t=this.featuresRtree_.getAll(),v(this.nullGeometryFeatures_)||u(t,Object.values(this.nullGeometryFeatures_))),t}getFeaturesAtCoordinate(t){const e=[];return this.forEachFeatureAtCoordinateDirect(t,(function(t){e.push(t)})),e}getFeaturesInExtent(t,e){if(this.featuresRtree_){if(!(e&&e.canWrapX()&&this.getWrapX()))return this.featuresRtree_.getInExtent(t);const n=function(t,e){if(e.canWrapX()){const n=e.getExtent();if(!isFinite(t[0])||!isFinite(t[2]))return[[n[0],t[1],n[2],t[3]]];fe(t,e);const i=le(n);if(le(t)>i)return[[n[0],t[1],n[2],t[3]]];if(t[0]<n[0])return[[t[0]+i,t[1],n[2],t[3]],[n[0],t[1],t[2],t[3]]];if(t[2]>n[2])return[[t[0],t[1],n[2],t[3]],[n[0],t[1],t[2]-i,t[3]]]}return[t]}(t,e);return[].concat(...n.map((t=>this.featuresRtree_.getInExtent(t))))}return this.featuresCollection_?this.featuresCollection_.getArray().slice(0):[]}getClosestFeatureToCoordinate(t,e){const n=t[0],i=t[1];let r=null;const s=[NaN,NaN];let o=1/0;const a=[-1/0,-1/0,1/0,1/0];return e=e||f,this.featuresRtree_.forEachInExtent(a,(function(t){if(e(t)){const e=t.getGeometry(),l=o;if(o=e instanceof BE?0:e.closestPointXY(n,i,s,o),o<l){r=t;const e=Math.sqrt(o);a[0]=n-e,a[1]=i-e,a[2]=n+e,a[3]=i+e}}})),r}getExtent(t){return this.featuresRtree_.getExtent(t)}getFeatureById(t){const e=this.idIndex_[t.toString()];return void 0!==e?e:null}getFeatureByUid(t){const e=this.uidIndex_[t];return void 0!==e?e:null}getFormat(){return this.format_}getOverlaps(){return this.overlaps_}getUrl(){return this.url_}handleFeatureChange_(t){const e=t.target,n=L(e),i=e.getGeometry();if(i){const t=i.getExtent();n in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[n],this.featuresRtree_&&this.featuresRtree_.insert(t,e)):this.featuresRtree_&&this.featuresRtree_.update(t,e)}else n in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(e),this.nullGeometryFeatures_[n]=e);const r=e.getId();if(void 0!==r){const t=r.toString();this.idIndex_[t]!==e&&(this.removeFromIdIndex_(e),this.idIndex_[t]=e)}else this.removeFromIdIndex_(e),this.uidIndex_[n]=e;this.changed(),this.dispatchEvent(new jE("changefeature",e))}hasFeature(t){const e=t.getId();return void 0!==e?e in this.idIndex_:L(t)in this.uidIndex_}isEmpty(){return this.featuresRtree_?this.featuresRtree_.isEmpty()&&v(this.nullGeometryFeatures_):!this.featuresCollection_||0===this.featuresCollection_.getLength()}loadFeatures(t,e,n){const i=this.loadedExtentsRtree_,r=this.strategy_(t,e,n);for(let t=0,s=r.length;t<s;++t){const s=r[t],o=i.forEachInExtent(s,(function(t){return zt(t.extent,s)}));o||(++this.loadingExtentsCount_,this.dispatchEvent(new jE("featuresloadstart")),this.loader_.call(this,s,e,n,(t=>{--this.loadingExtentsCount_,this.dispatchEvent(new jE("featuresloadend",void 0,t))}),(()=>{--this.loadingExtentsCount_,this.dispatchEvent(new jE("featuresloaderror"))})),i.insert(s,{extent:s.slice()}))}this.loading=!(this.loader_.length<4)&&this.loadingExtentsCount_>0}refresh(){this.clear(!0),this.loadedExtentsRtree_.clear(),super.refresh()}removeLoadedExtent(t){const e=this.loadedExtentsRtree_;let n;e.forEachInExtent(t,(function(e){if(Xt(e.extent,t))return n=e,!0})),n&&e.remove(n)}removeFeatures(t){const e=[];for(let n=0,i=t.length;n<i;++n){const i=t[n],r=this.removeFeatureInternal(i);r&&e.push(r)}e.length>0&&this.changed()}removeFeature(t){t&&this.removeFeatureInternal(t)&&this.changed()}removeFeatureInternal(t){const e=L(t);e in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[e]:this.featuresRtree_&&this.featuresRtree_.remove(t);const n=this.featureChangeKeys_[e];if(!n)return;n.forEach(P),delete this.featureChangeKeys_[e];const i=t.getId();return void 0!==i&&delete this.idIndex_[i.toString()],delete this.uidIndex_[e],this.hasListener(qE)&&this.dispatchEvent(new jE(qE,t)),t}removeFromIdIndex_(t){let e=!1;for(const n in this.idIndex_){const i=this.idIndex_[n];if(t instanceof BE&&Array.isArray(i)&&i.includes(t))i.splice(i.indexOf(t),1);else if(this.idIndex_[n]===t){delete this.idIndex_[n],e=!0;break}}return e}setLoader(t){this.loader_=t}setUrl(t){K(this.format_,"`format` must be set when `url` is set"),this.url_=t,this.setLoader(XE(t,this.format_))}};class HE extends vn{constructor(t,e){super(),this.flatMidpoint_=null,this.flatMidpointRevision_=-1,this.maxDelta_=-1,this.maxDeltaRevision_=-1,void 0===e||Array.isArray(t[0])?this.setCoordinates(t,e):this.setFlatCoordinates(e,t)}appendCoordinate(t){u(this.flatCoordinates,t),this.changed()}clone(){const t=new HE(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(t,e,n,i){return i<Dt(this.getExtent(),t,e)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(xn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),bn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!1,t,e,n,i))}forEachSegment(t){return jn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}getCoordinateAtM(t,e){return"XYM"!=this.layout&&"XYZM"!=this.layout?null:(e=void 0!==e&&e,DE(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e))}getCoordinates(){return An(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinateAt(t,e){return OE(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,this.stride)}getLength(){return aE(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getFlatMidpoint(){return this.flatMidpointRevision_!=this.getRevision()&&(this.flatMidpoint_=this.getCoordinateAt(.5,this.flatMidpoint_??void 0),this.flatMidpointRevision_=this.getRevision()),this.flatMidpoint_}getSimplifiedGeometryInternal(t){const e=[];return e.length=Mn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,0),new HE(e,"XY")}getType(){return"LineString"}intersectsExtent(t){return Wn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Sn(this.flatCoordinates,0,t,this.stride),this.changed()}}const $E=HE;class ZE extends vn{constructor(t,e){super(),e&&!Array.isArray(t[0])?this.setFlatCoordinates(e,t):this.setCoordinates(t,e)}appendPoint(t){u(this.flatCoordinates,t.getFlatCoordinates()),this.changed()}clone(){const t=new ZE(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(t,e,n,i){if(i<Dt(this.getExtent(),t,e))return i;const r=this.flatCoordinates,s=this.stride;for(let o=0,a=r.length;o<a;o+=s){const a=tt(t,e,r[o],r[o+1]);if(a<i){i=a;for(let t=0;t<s;++t)n[t]=r[o+t];n.length=s}}return i}getCoordinates(){return An(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getPoint(t){const e=this.flatCoordinates.length/this.stride;return t<0||e<=t?null:new Bn(this.flatCoordinates.slice(t*this.stride,(t+1)*this.stride),this.layout)}getPoints(){const t=this.flatCoordinates,e=this.layout,n=this.stride,i=[];for(let r=0,s=t.length;r<s;r+=n){const s=new Bn(t.slice(r,r+n),e);i.push(s)}return i}getType(){return"MultiPoint"}intersectsExtent(t){const e=this.flatCoordinates,n=this.stride;for(let i=0,r=e.length;i<r;i+=n)if(Gt(t,e[i],e[i+1]))return!0;return!1}setCoordinates(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Sn(this.flatCoordinates,0,t,this.stride),this.changed()}}const KE=ZE;class JE extends vn{constructor(t,e,n){if(super(),this.ends_=[],this.maxDelta_=-1,this.maxDeltaRevision_=-1,Array.isArray(t[0]))this.setCoordinates(t,e);else if(void 0!==e&&n)this.setFlatCoordinates(e,t),this.ends_=n;else{const e=t,n=[],i=[];for(let t=0,r=e.length;t<r;++t)u(n,e[t].getFlatCoordinates()),i.push(n.length);const r=0===e.length?this.getLayout():e[0].getLayout();this.setFlatCoordinates(r,n),this.ends_=i}}appendLineString(t){u(this.flatCoordinates,t.getFlatCoordinates().slice()),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const t=new JE(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return t.applyProperties(this),t}closestPointXY(t,e,n,i){return i<Dt(this.getExtent(),t,e)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(_n(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),En(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!1,t,e,n,i))}getCoordinateAtM(t,e,n){return"XYM"!=this.layout&&"XYZM"!=this.layout||0===this.flatCoordinates.length?null:(e=void 0!==e&&e,n=void 0!==n&&n,function(t,e,n,i,r,s,o){if(o)return DE(t,e,n[n.length-1],i,r,s);let a;if(r<t[i-1])return s?(a=t.slice(0,i),a[i-1]=r,a):null;if(t[t.length-1]<r)return s?(a=t.slice(t.length-i),a[i-1]=r,a):null;for(let s=0,o=n.length;s<o;++s){const o=n[s];if(e!=o){if(r<t[e+i-1])return null;if(r<=t[o-1])return DE(t,e,o,i,r,!1);e=o}}return null}(this.flatCoordinates,0,this.ends_,this.stride,t,e,n))}getCoordinates(){return kn(this.flatCoordinates,0,this.ends_,this.stride)}getEnds(){return this.ends_}getLineString(t){return t<0||this.ends_.length<=t?null:new $E(this.flatCoordinates.slice(0===t?0:this.ends_[t-1],this.ends_[t]),this.layout)}getLineStrings(){const t=this.flatCoordinates,e=this.ends_,n=this.layout,i=[];let r=0;for(let s=0,o=e.length;s<o;++s){const o=e[s],a=new $E(t.slice(r,o),n);i.push(a),r=o}return i}getFlatMidpoints(){const t=[],e=this.flatCoordinates;let n=0;const i=this.ends_,r=this.stride;for(let s=0,o=i.length;s<o;++s){const o=i[s];u(t,OE(e,n,o,r,.5)),n=o}return t}getSimplifiedGeometryInternal(t){const e=[],n=[];return e.length=Rn(this.flatCoordinates,0,this.ends_,this.stride,t,e,0,n),new JE(e,"XY",n)}getType(){return"MultiLineString"}intersectsExtent(t){return function(t,e,n,i,r){for(let s=0,o=n.length;s<o;++s){if(Wn(t,e,n[s],i,r))return!0;e=n[s]}return!1}(this.flatCoordinates,0,this.ends_,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);const n=In(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=0===n.length?0:n[n.length-1],this.changed()}}const QE=JE;class tS extends vn{constructor(t,e,n){if(super(),this.endss_=[],this.flatInteriorPointsRevision_=-1,this.flatInteriorPoints_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,!n&&!Array.isArray(t[0])){const i=t,r=[],s=[];for(let t=0,e=i.length;t<e;++t){const e=i[t],n=r.length,o=e.getEnds();for(let t=0,e=o.length;t<e;++t)o[t]+=n;u(r,e.getFlatCoordinates()),s.push(o)}e=0===i.length?this.getLayout():i[0].getLayout(),t=r,n=s}void 0!==e&&n?(this.setFlatCoordinates(e,t),this.endss_=n):this.setCoordinates(t,e)}appendPolygon(t){let e;if(this.flatCoordinates){const n=this.flatCoordinates.length;u(this.flatCoordinates,t.getFlatCoordinates()),e=t.getEnds().slice();for(let t=0,i=e.length;t<i;++t)e[t]+=n}else this.flatCoordinates=t.getFlatCoordinates().slice(),e=t.getEnds().slice(),this.endss_.push();this.endss_.push(e),this.changed()}clone(){const t=this.endss_.length,e=new Array(t);for(let n=0;n<t;++n)e[n]=this.endss_[n].slice();const n=new tS(this.flatCoordinates.slice(),this.layout,e);return n.applyProperties(this),n}closestPointXY(t,e,n,i){return i<Dt(this.getExtent(),t,e)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(function(t,e,n,i,r){for(let s=0,o=n.length;s<o;++s){const o=n[s];r=_n(t,e,o,i,r),e=o[o.length-1]}return r}(this.flatCoordinates,0,this.endss_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),function(t,e,n,i,r,s,o,a,l,h,u){u=u||[NaN,NaN];for(let s=0,c=n.length;s<c;++s){const c=n[s];h=En(t,e,c,i,r,true,o,a,l,h,u),e=c[c.length-1]}return h}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,this.maxDelta_,0,t,e,n,i))}containsXY(t,e){return function(t,e,n,i,r,s){if(0===n.length)return!1;for(let o=0,a=n.length;o<a;++o){const a=n[o];if(Vn(t,e,a,i,r,s))return!0;e=a[a.length-1]}return!1}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t,e)}getArea(){return function(t,e,n,i){let r=0;for(let s=0,o=n.length;s<o;++s){const o=n[s];r+=Dn(t,e,o,i),e=o[o.length-1]}return r}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride)}getCoordinates(t){let e;return void 0!==t?(e=this.getOrientedFlatCoordinates().slice(),ei(e,0,this.endss_,this.stride,t)):e=this.flatCoordinates,Ln(e,0,this.endss_,this.stride)}getEndss(){return this.endss_}getFlatInteriorPoints(){if(this.flatInteriorPointsRevision_!=this.getRevision()){const t=FE(this.flatCoordinates,0,this.endss_,this.stride);this.flatInteriorPoints_=Xn(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t),this.flatInteriorPointsRevision_=this.getRevision()}return this.flatInteriorPoints_}getInteriorPoints(){return new KE(this.getFlatInteriorPoints().slice(),"XYM")}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const t=this.flatCoordinates;Qn(t,0,this.endss_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=ei(this.orientedFlatCoordinates_,0,this.endss_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(t){const e=[],n=[];return e.length=function(t,e,n,i,r,s,o,a){for(let l=0,h=n.length;l<h;++l){const h=n[l],u=[];o=Nn(t,e,h,i,r,s,o,u),a.push(u),e=h[h.length-1]}return o}(this.flatCoordinates,0,this.endss_,this.stride,Math.sqrt(t),e,0,n),new tS(e,"XY",n)}getPolygon(t){if(t<0||this.endss_.length<=t)return null;let e;if(0===t)e=0;else{const n=this.endss_[t-1];e=n[n.length-1]}const n=this.endss_[t].slice(),i=n[n.length-1];if(0!==e)for(let t=0,i=n.length;t<i;++t)n[t]-=e;return new ii(this.flatCoordinates.slice(e,i),this.layout,n)}getPolygons(){const t=this.layout,e=this.flatCoordinates,n=this.endss_,i=[];let r=0;for(let s=0,o=n.length;s<o;++s){const o=n[s].slice(),a=o[o.length-1];if(0!==r)for(let t=0,e=o.length;t<e;++t)o[t]-=r;const l=new ii(e.slice(r,a),t,o);i.push(l),r=a}return i}getType(){return"MultiPolygon"}intersectsExtent(t){return function(t,e,n,i,r){for(let s=0,o=n.length;s<o;++s){const o=n[s];if($n(t,e,o,i,r))return!0;e=o[o.length-1]}return!1}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,3),this.flatCoordinates||(this.flatCoordinates=[]);const n=Cn(this.flatCoordinates,0,t,this.stride,this.endss_);if(0===n.length)this.flatCoordinates.length=0;else{const t=n[n.length-1];this.flatCoordinates.length=0===t.length?0:t[t.length-1]}this.changed()}}const eS=tS;class nS extends pn{constructor(t){super(),this.geometries_=t,this.changeEventsKeys_=[],this.listenGeometriesChange_()}unlistenGeometriesChange_(){this.changeEventsKeys_.forEach(P),this.changeEventsKeys_.length=0}listenGeometriesChange_(){const t=this.geometries_;for(let e=0,n=t.length;e<n;++e)this.changeEventsKeys_.push(M(t[e],x,this.changed,this))}clone(){const t=new nS(iS(this.geometries_));return t.applyProperties(this),t}closestPointXY(t,e,n,i){if(i<Dt(this.getExtent(),t,e))return i;const r=this.geometries_;for(let s=0,o=r.length;s<o;++s)i=r[s].closestPointXY(t,e,n,i);return i}containsXY(t,e){const n=this.geometries_;for(let i=0,r=n.length;i<r;++i)if(n[i].containsXY(t,e))return!0;return!1}computeExtent(t){qt(t);const e=this.geometries_;for(let n=0,i=e.length;n<i;++n)jt(t,e[n].getExtent());return t}getGeometries(){return iS(this.geometries_)}getGeometriesArray(){return this.geometries_}getGeometriesArrayRecursive(){let t=[];const e=this.geometries_;for(let n=0,i=e.length;n<i;++n)e[n].getType()===this.getType()?t=t.concat(e[n].getGeometriesArrayRecursive()):t.push(e[n]);return t}getSimplifiedGeometry(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&t<this.simplifiedGeometryMaxMinSquaredTolerance)return this;const e=[],n=this.geometries_;let i=!1;for(let r=0,s=n.length;r<s;++r){const s=n[r],o=s.getSimplifiedGeometry(t);e.push(o),o!==s&&(i=!0)}return i?new nS(e):(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)}getType(){return"GeometryCollection"}intersectsExtent(t){const e=this.geometries_;for(let n=0,i=e.length;n<i;++n)if(e[n].intersectsExtent(t))return!0;return!1}isEmpty(){return 0===this.geometries_.length}rotate(t,e){const n=this.geometries_;for(let i=0,r=n.length;i<r;++i)n[i].rotate(t,e);this.changed()}scale(t,e,n){n||(n=te(this.getExtent()));const i=this.geometries_;for(let r=0,s=i.length;r<s;++r)i[r].scale(t,e,n);this.changed()}setGeometries(t){this.setGeometriesArray(iS(t))}setGeometriesArray(t){this.unlistenGeometriesChange_(),this.geometries_=t,this.listenGeometriesChange_(),this.changed()}applyTransform(t){const e=this.geometries_;for(let n=0,i=e.length;n<i;++n)e[n].applyTransform(t);this.changed()}translate(t,e){const n=this.geometries_;for(let i=0,r=n.length;i<r;++i)n[i].translate(t,e);this.changed()}disposeInternal(){this.unlistenGeometriesChange_(),super.disposeInternal()}}function iS(t){return t.map((t=>t.clone()))}const rS=nS,sS=class{constructor(){this.dataProjection=void 0,this.defaultFeatureProjection=void 0,this.featureClass=Xb,this.supportedMediaTypes=null}getReadOptions(t,e){if(e){let n=e.dataProjection?Pe(e.dataProjection):this.readProjection(t);e.extent&&n&&"tile-pixels"===n.getUnits()&&(n=Pe(n),n.setWorldExtent(e.extent)),e={dataProjection:n,featureProjection:e.featureProjection}}return this.adaptOptions(e)}adaptOptions(t){return Object.assign({dataProjection:this.dataProjection,featureProjection:this.defaultFeatureProjection,featureClass:this.featureClass},t)}getType(){return A()}readFeature(t,e){return A()}readFeatures(t,e){return A()}readGeometry(t,e){return A()}readProjection(t){return A()}writeFeature(t,e){return A()}writeFeatures(t,e){return A()}writeGeometry(t,e){return A()}};function oS(t,e,n){const i=n?Pe(n.featureProjection):null,r=n?Pe(n.dataProjection):null;let s=t;if(i&&r&&!Le(i,r)){e&&(s=t.clone());const n=e?i:r,o=e?r:i;"tile-pixels"===n.getUnits()?s.transform(n,o):s.applyTransform(De(n,o))}if(e&&n&&void 0!==n.decimals){const e=Math.pow(10,n.decimals),i=function(t){for(let n=0,i=t.length;n<i;++n)t[n]=Math.round(t[n]*e)/e;return t};s===t&&(s=t.clone()),s.applyTransform(i)}return s}const aS={Point:Bn,LineString:$E,Polygon:ii,MultiPoint:KE,MultiLineString:QE,MultiPolygon:eS};function lS(t,e){const n=t.geometry;if(!n)return[];if(Array.isArray(n))return n.map((e=>lS({...t,geometry:e}))).flat();const i="MultiPolygon"===n.type?"Polygon":n.type;if("GeometryCollection"===i||"Circle"===i)throw new Error("Unsupported geometry type: "+i);const r=n.layout.length;return oS(new BE(i,"Polygon"===i?function(t,e,n){return Array.isArray(e[0])?(Qn(t,0,e,n)||ei(t=t.slice(),0,e,n),t):(Jn(t,0,e,n)||ti(t=t.slice(),0,e,n),t)}(n.flatCoordinates,n.ends,r):n.flatCoordinates,n.ends?.flat(),r,t.properties||{},t.id).enableSimplifyTransformed(),!1,e)}function hS(t,e){if(!t)return null;if(Array.isArray(t)){const n=t.map((t=>hS(t,e)));return new rS(n)}return oS(new(0,aS[t.type])(t.flatCoordinates,t.layout,t.ends),!1,e)}function uS(t){if("string"==typeof t){return JSON.parse(t)||null}return null!==t?t:null}const cS=class extends sS{constructor(){super()}getType(){return"json"}readFeature(t,e){return this.readFeatureFromObject(uS(t),this.getReadOptions(t,e))}readFeatures(t,e){return this.readFeaturesFromObject(uS(t),this.getReadOptions(t,e))}readFeatureFromObject(t,e){return A()}readFeaturesFromObject(t,e){return A()}readGeometry(t,e){return this.readGeometryFromObject(uS(t),this.getReadOptions(t,e))}readGeometryFromObject(t,e){return A()}readProjection(t){return this.readProjectionFromObject(uS(t))}readProjectionFromObject(t){return A()}writeFeature(t,e){return JSON.stringify(this.writeFeatureObject(t,e))}writeFeatureObject(t,e){return A()}writeFeatures(t,e){return JSON.stringify(this.writeFeaturesObject(t,e))}writeFeaturesObject(t,e){return A()}writeGeometry(t,e){return JSON.stringify(this.writeGeometryObject(t,e))}writeGeometryObject(t,e){return A()}};function fS(t,e){if(!t)return null;let n;switch(t.type){case"Point":n=function(t){const e=t.coordinates;return{type:"Point",flatCoordinates:e,layout:mn(e.length)}}(t);break;case"LineString":n=function(t){const e=t.coordinates,n=e.flat();return{type:"LineString",flatCoordinates:n,ends:[n.length],layout:mn(e[0]?.length||2)}}(t);break;case"Polygon":n=function(t){const e=t.coordinates,n=[],i=e[0]?.[0]?.length;return{type:"Polygon",flatCoordinates:n,ends:In(n,0,e,i),layout:mn(i)}}(t);break;case"MultiPoint":n=function(t){const e=t.coordinates;return{type:"MultiPoint",flatCoordinates:e.flat(),layout:mn(e[0]?.length||2)}}(t);break;case"MultiLineString":n=function(t){const e=t.coordinates,n=e[0]?.[0]?.length||2,i=[];return{type:"MultiLineString",flatCoordinates:i,ends:In(i,0,e,n),layout:mn(n)}}(t);break;case"MultiPolygon":n=function(t){const e=t.coordinates,n=[],i=e[0]?.[0]?.[0].length||2;return{type:"MultiPolygon",flatCoordinates:n,ends:Cn(n,0,e,i),layout:mn(i)}}(t);break;case"GeometryCollection":n=function(t,e){const n=t.geometries.map((function(t){return fS(t)}));return n}(t);break;default:throw new Error("Unsupported GeoJSON type: "+t.type)}return n}function dS(t,e){const n=(t=oS(t,!0,e)).getType();let i;switch(n){case"Point":i=function(t,e){return{type:"Point",coordinates:t.getCoordinates()}}(t);break;case"LineString":i=function(t,e){return{type:"LineString",coordinates:t.getCoordinates()}}(t);break;case"Polygon":i=function(t,e){let n;return e&&(n=e.rightHanded),{type:"Polygon",coordinates:t.getCoordinates(n)}}(t,e);break;case"MultiPoint":i=function(t,e){return{type:"MultiPoint",coordinates:t.getCoordinates()}}(t);break;case"MultiLineString":i=function(t,e){return{type:"MultiLineString",coordinates:t.getCoordinates()}}(t);break;case"MultiPolygon":i=function(t,e){let n;return e&&(n=e.rightHanded),{type:"MultiPolygon",coordinates:t.getCoordinates(n)}}(t,e);break;case"GeometryCollection":i=function(t,e){delete(e=Object.assign({},e)).featureProjection;return{type:"GeometryCollection",geometries:t.getGeometriesArray().map((function(t){return dS(t,e)}))}}(t,e);break;case"Circle":i={type:"GeometryCollection",geometries:[]};break;default:throw new Error("Unsupported geometry type: "+n)}return i}const gS=class extends cS{constructor(t){t=t||{},super(),this.dataProjection=Pe(t.dataProjection?t.dataProjection:"EPSG:4326"),t.featureProjection&&(this.defaultFeatureProjection=Pe(t.featureProjection)),t.featureClass&&(this.featureClass=t.featureClass),this.geometryName_=t.geometryName,this.extractGeometryName_=t.extractGeometryName,this.supportedMediaTypes=["application/geo+json","application/vnd.geo+json"]}readFeatureFromObject(t,e){let n=null;n="Feature"===t.type?t:{type:"Feature",geometry:t,properties:null};const i=fS(n.geometry);if(this.featureClass===BE)return lS({geometry:i,id:n.id,properties:n.properties},e);const r=new Xb;return this.geometryName_?r.setGeometryName(this.geometryName_):this.extractGeometryName_&&n.geometry_name&&r.setGeometryName(n.geometry_name),r.setGeometry(hS(i,e)),"id"in n&&r.setId(n.id),n.properties&&r.setProperties(n.properties,!0),r}readFeaturesFromObject(t,e){let n=null;if("FeatureCollection"===t.type){n=[];const i=t.features;for(let t=0,r=i.length;t<r;++t){const r=this.readFeatureFromObject(i[t],e);r&&n.push(r)}}else n=[this.readFeatureFromObject(t,e)];return n.flat()}readGeometryFromObject(t,e){return function(t,e){return hS(fS(t),e)}(t,e)}readProjectionFromObject(t){const e=t.crs;let n;if(e)if("name"==e.type)n=Pe(e.properties.name);else{if("EPSG"!==e.type)throw new Error("Unknown SRS type");n=Pe("EPSG:"+e.properties.code)}else n=this.dataProjection;return n}writeFeatureObject(t,e){e=this.adaptOptions(e);const n={type:"Feature",geometry:null,properties:null},i=t.getId();if(void 0!==i&&(n.id=i),!t.hasProperties())return n;const r=t.getProperties(),s=t.getGeometry();return s&&(n.geometry=dS(s,e),delete r[t.getGeometryName()]),v(r)||(n.properties=r),n}writeFeaturesObject(t,e){e=this.adaptOptions(e);const n=[];for(let i=0,r=t.length;i<r;++i)n.push(this.writeFeatureObject(t[i],e));return{type:"FeatureCollection",features:n}}writeGeometryObject(t,e){return dS(t,this.adaptOptions(e))}};var pS=__webpack_require__(2796),mS=6371008.8,yS={centimeters:637100880,centimetres:637100880,degrees:57.22891354143274,feet:20902260.511392,inches:39.37*mS,kilometers:6371.0088,kilometres:6371.0088,meters:mS,metres:mS,miles:3958.761333810546,millimeters:6371008800,millimetres:6371008800,nauticalmiles:mS/1852,radians:1,yards:6967335.223679999};function vS(t,e,n){void 0===n&&(n={});var i={type:"Feature"};return(0===n.id||n.id)&&(i.id=n.id),n.bbox&&(i.bbox=n.bbox),i.properties=e||{},i.geometry=t,i}function wS(t,e,n){if(void 0===n&&(n={}),!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!CS(t[0])||!CS(t[1]))throw new Error("coordinates must contain numbers");return vS({type:"Point",coordinates:t},e,n)}function xS(t,e,n){void 0===n&&(n={});for(var i=0,r=t;i<r.length;i++){var s=r[i];if(s.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var o=0;o<s[s.length-1].length;o++)if(s[s.length-1][o]!==s[0][o])throw new Error("First and last Position are not equivalent.")}return vS({type:"Polygon",coordinates:t},e,n)}function _S(t,e,n){if(void 0===n&&(n={}),t.length<2)throw new Error("coordinates must be an array of two or more positions");return vS({type:"LineString",coordinates:t},e,n)}function bS(t,e){void 0===e&&(e={});var n={type:"FeatureCollection"};return e.id&&(n.id=e.id),e.bbox&&(n.bbox=e.bbox),n.features=t,n}function ES(t,e,n){return void 0===n&&(n={}),vS({type:"MultiPolygon",coordinates:t},e,n)}function SS(t){return t%(2*Math.PI)*180/Math.PI}function IS(t){return t%360*Math.PI/180}function CS(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}function MS(t){if(!t)throw new Error("coord is required");if(!Array.isArray(t)){if("Feature"===t.type&&null!==t.geometry&&"Point"===t.geometry.type)return t.geometry.coordinates;if("Point"===t.type)return t.coordinates}if(Array.isArray(t)&&t.length>=2&&!Array.isArray(t[0])&&!Array.isArray(t[1]))return t;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function RS(t){if(Array.isArray(t))return t;if("Feature"===t.type){if(null!==t.geometry)return t.geometry.coordinates}else if(t.coordinates)return t.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function PS(t){return"Feature"===t.type?t.geometry:t}function TS(t,e){return"FeatureCollection"===t.type?"FeatureCollection":"GeometryCollection"===t.type?"GeometryCollection":"Feature"===t.type&&null!==t.geometry?t.geometry.type:t.type}function NS(t,e,n){if(void 0===n&&(n={}),!0===n.final)return function(t,e){var n=NS(e,t);return(n+180)%360}(t,e);var i=MS(t),r=MS(e),s=IS(i[0]),o=IS(r[0]),a=IS(i[1]),l=IS(r[1]),h=Math.sin(o-s)*Math.cos(l),u=Math.cos(a)*Math.sin(l)-Math.sin(a)*Math.cos(l)*Math.cos(o-s);return SS(Math.atan2(h,u))}const AS=function(t,e,n){void 0===n&&(n={});var i=MS(t),r=MS(e),s=IS(r[1]-i[1]),o=IS(r[0]-i[0]),a=IS(i[1]),l=IS(r[1]),h=Math.pow(Math.sin(s/2),2)+Math.pow(Math.sin(o/2),2)*Math.cos(a)*Math.cos(l);return function(t,e){void 0===e&&(e="kilometers");var n=yS[e];if(!n)throw new Error(e+" units is invalid");return t*n}(2*Math.atan2(Math.sqrt(h),Math.sqrt(1-h)),n.units)};function kS(t,e,n,i){void 0===i&&(i={});var r=MS(t),s=IS(r[0]),o=IS(r[1]),a=IS(n),l=function(t,e){void 0===e&&(e="kilometers");var n=yS[e];if(!n)throw new Error(e+" units is invalid");return t/n}(e,i.units),h=Math.asin(Math.sin(o)*Math.cos(l)+Math.cos(o)*Math.sin(l)*Math.cos(a));return wS([SS(s+Math.atan2(Math.sin(a)*Math.sin(l)*Math.cos(o),Math.cos(l)-Math.sin(o)*Math.sin(h))),SS(h)],i.properties)}function LS(t,e,n){if(null!==t)for(var i,r,s,o,a,l,h,u,c=0,f=0,d=t.type,g="FeatureCollection"===d,p="Feature"===d,m=g?t.features.length:1,y=0;y<m;y++){a=(u=!!(h=g?t.features[y].geometry:p?t.geometry:t)&&"GeometryCollection"===h.type)?h.geometries.length:1;for(var v=0;v<a;v++){var w=0,x=0;if(null!==(o=u?h.geometries[v]:h)){l=o.coordinates;var _=o.type;switch(c=!n||"Polygon"!==_&&"MultiPolygon"!==_?0:1,_){case null:break;case"Point":if(!1===e(l,f,y,w,x))return!1;f++,w++;break;case"LineString":case"MultiPoint":for(i=0;i<l.length;i++){if(!1===e(l[i],f,y,w,x))return!1;f++,"MultiPoint"===_&&w++}"LineString"===_&&w++;break;case"Polygon":case"MultiLineString":for(i=0;i<l.length;i++){for(r=0;r<l[i].length-c;r++){if(!1===e(l[i][r],f,y,w,x))return!1;f++}"MultiLineString"===_&&w++,"Polygon"===_&&x++}"Polygon"===_&&w++;break;case"MultiPolygon":for(i=0;i<l.length;i++){for(x=0,r=0;r<l[i].length;r++){for(s=0;s<l[i][r].length-c;s++){if(!1===e(l[i][r][s],f,y,w,x))return!1;f++}x++}w++}break;case"GeometryCollection":for(i=0;i<o.geometries.length;i++)if(!1===LS(o.geometries[i],e,n))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function OS(t,e){if("Feature"===t.type)e(t,0);else if("FeatureCollection"===t.type)for(var n=0;n<t.features.length&&!1!==e(t.features[n],n);n++);}function DS(t,e){var n,i,r,s,o,a,l,h,u,c,f=0,d="FeatureCollection"===t.type,g="Feature"===t.type,p=d?t.features.length:1;for(n=0;n<p;n++){for(a=d?t.features[n].geometry:g?t.geometry:t,h=d?t.features[n].properties:g?t.properties:{},u=d?t.features[n].bbox:g?t.bbox:void 0,c=d?t.features[n].id:g?t.id:void 0,o=(l=!!a&&"GeometryCollection"===a.type)?a.geometries.length:1,r=0;r<o;r++)if(null!==(s=l?a.geometries[r]:a))switch(s.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===e(s,f,h,u,c))return!1;break;case"GeometryCollection":for(i=0;i<s.geometries.length;i++)if(!1===e(s.geometries[i],f,h,u,c))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===e(null,f,h,u,c))return!1;f++}}function FS(t,e){DS(t,(function(t,n,i,r,s){var o,a=null===t?null:t.type;switch(a){case null:case"Point":case"LineString":case"Polygon":return!1!==e(vS(t,i,{bbox:r,id:s}),n,0)&&void 0}switch(a){case"MultiPoint":o="Point";break;case"MultiLineString":o="LineString";break;case"MultiPolygon":o="Polygon"}for(var l=0;l<t.coordinates.length;l++){var h=t.coordinates[l];if(!1===e(vS({type:o,coordinates:h},i),n,l))return!1}}))}const zS=function(t){if(!t)throw new Error("geojson is required");var e=[];return FS(t,(function(t){!function(t,e){var n=[],i=t.geometry;if(null!==i){switch(i.type){case"Polygon":n=RS(i);break;case"LineString":n=[RS(i)]}n.forEach((function(n){var i=function(t,e){var n=[];return t.reduce((function(t,i){var r,s,o,a,l,h,u=_S([t,i],e);return u.bbox=(s=i,o=(r=t)[0],a=r[1],[o<(l=s[0])?o:l,a<(h=s[1])?a:h,o>l?o:l,a>h?a:h]),n.push(u),i})),n}(n,t.properties);i.forEach((function(t){t.id=e.length,e.push(t)}))}))}}(t,e)})),bS(e)};var GS=__webpack_require__(1787);function BS(t,e){var n=RS(t),i=RS(e);if(2!==n.length)throw new Error("<intersects> line1 must only contain 2 coordinates");if(2!==i.length)throw new Error("<intersects> line2 must only contain 2 coordinates");var r=n[0][0],s=n[0][1],o=n[1][0],a=n[1][1],l=i[0][0],h=i[0][1],u=i[1][0],c=i[1][1],f=(c-h)*(o-r)-(u-l)*(a-s);if(0===f)return null;var d=((u-l)*(s-h)-(c-h)*(r-l))/f,g=((o-r)*(s-h)-(a-s)*(r-l))/f;return d>=0&&d<=1&&g>=0&&g<=1?wS([r+d*(o-r),s+d*(a-s)]):null}const US=function(t,e){var n={},i=[];if("LineString"===t.type&&(t=vS(t)),"LineString"===e.type&&(e=vS(e)),"Feature"===t.type&&"Feature"===e.type&&null!==t.geometry&&null!==e.geometry&&"LineString"===t.geometry.type&&"LineString"===e.geometry.type&&2===t.geometry.coordinates.length&&2===e.geometry.coordinates.length){var r=BS(t,e);return r&&i.push(r),bS(i)}var s=GS();return s.load(zS(e)),OS(zS(t),(function(t){OS(s.search(t),(function(e){var r=BS(t,e);if(r){var s=RS(r).join(",");n[s]||(n[s]=!0,i.push(r))}}))})),bS(i)},qS=function(t,e,n){void 0===n&&(n={});var i=wS([1/0,1/0],{dist:1/0}),r=0;return FS(t,(function(t){for(var s=RS(t),o=0;o<s.length-1;o++){var a=wS(s[o]);a.properties.dist=AS(e,a,n);var l=wS(s[o+1]);l.properties.dist=AS(e,l,n);var h=AS(a,l,n),u=Math.max(a.properties.dist,l.properties.dist),c=NS(a,l),f=kS(e,u,c+90,n),d=kS(e,u,c-90,n),g=US(_S([f.geometry.coordinates,d.geometry.coordinates]),_S([a.geometry.coordinates,l.geometry.coordinates])),p=null;g.features.length>0&&((p=g.features[0]).properties.dist=AS(e,p,n),p.properties.location=r+AS(a,p,n)),a.properties.dist<i.properties.dist&&((i=a).properties.index=o,i.properties.location=r),l.properties.dist<i.properties.dist&&((i=l).properties.index=o+1,i.properties.location=r+h),p&&p.properties.dist<i.properties.dist&&((i=p).properties.index=o),r+=h}})),i};var VS=__webpack_require__(4860),YS=6378137;function XS(t){return function(t,e,n){var i=0;return DS(t,(function(t,e,n,r,s){i=function(t,e){return t+function(t){var e,n=0;switch(t.type){case"Polygon":return jS(t.coordinates);case"MultiPolygon":for(e=0;e<t.coordinates.length;e++)n+=jS(t.coordinates[e]);return n;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}(e)}(i,t)})),i}(t)}function jS(t){var e=0;if(t&&t.length>0){e+=Math.abs(WS(t[0]));for(var n=1;n<t.length;n++)e-=Math.abs(WS(t[n]))}return e}function WS(t){var e,n,i,r,s,o,a=0,l=t.length;if(l>2){for(o=0;o<l;o++)o===l-2?(i=l-2,r=l-1,s=0):o===l-1?(i=l-1,r=0,s=1):(i=o,r=o+1,s=o+2),e=t[i],n=t[r],a+=(HS(t[s][0])-HS(e[0]))*Math.sin(HS(n[1]));a=a*YS*YS/2}return a}function HS(t){return t*Math.PI/180}function $S(t,e,n){if(void 0===n&&(n={}),!t)throw new Error("point is required");if(!e)throw new Error("polygon is required");var i=MS(t),r=PS(e),s=r.type,o=e.bbox,a=r.coordinates;if(o&&!1===function(t,e){return e[0]<=t[0]&&e[1]<=t[1]&&e[2]>=t[0]&&e[3]>=t[1]}(i,o))return!1;"Polygon"===s&&(a=[a]);for(var l=!1,h=0;h<a.length&&!l;h++)if(ZS(i,a[h][0],n.ignoreBoundary)){for(var u=!1,c=1;c<a[h].length&&!u;)ZS(i,a[h][c],!n.ignoreBoundary)&&(u=!0),c++;u||(l=!0)}return l}function ZS(t,e,n){var i=!1;e[0][0]===e[e.length-1][0]&&e[0][1]===e[e.length-1][1]&&(e=e.slice(0,e.length-1));for(var r=0,s=e.length-1;r<e.length;s=r++){var o=e[r][0],a=e[r][1],l=e[s][0],h=e[s][1];if(t[1]*(o-l)+a*(l-t[0])+h*(t[0]-o)==0&&(o-t[0])*(l-t[0])<=0&&(a-t[1])*(h-t[1])<=0)return!n;a>t[1]!=h>t[1]&&t[0]<(l-o)*(t[1]-a)/(h-a)+o&&(i=!i)}return i}function KS(t,e){if(!t||!e)return!1;if(t.length!==e.length)return!1;for(var n=0,i=t.length;n<i;n++)if(t[n]instanceof Array&&e[n]instanceof Array){if(!KS(t[n],e[n]))return!1}else if(t[n]!==e[n])return!1;return!0}function JS(t){if("Feature"!=t.type)throw new Error("The input must a geojson object of type Feature");if(void 0===t.geometry||null==t.geometry)throw new Error("The input must a geojson object with a non-empty geometry");if("Polygon"!=t.geometry.type)throw new Error("The input must be a geojson Polygon");for(var e=t.geometry.coordinates.length,n=[],i=0;i<e;i++){var r=t.geometry.coordinates[i];iI(r[0],r[r.length-1])||r.push(r[0]),n.push.apply(n,r.slice(0,r.length-1))}if(!function(t){for(var e={},n=1,i=0,r=t.length;i<r;++i){if(Object.prototype.hasOwnProperty.call(e,t[i])){n=0;break}e[t[i]]=1}return n}(n))throw new Error("The input polygon may not have duplicate vertices (except for the first and last vertex of each ring)");var s=n.length,o=function(t,e,n){if("Polygon"!==t.geometry.type)throw new Error("The input feature must be a Polygon");void 0===n&&(n=1);var i=t.geometry.coordinates,r=[],s={};if(n){for(var o=[],a=0;a<i.length;a++)for(var l=0;l<i[a].length-1;l++)o.push(p(a,l));var h=VS();h.load(o)}for(var u=0;u<i.length;u++)for(var c=0;c<i[u].length-1;c++)if(n)h.search(p(u,c)).forEach((function(t){var e=t.ring,n=t.edge;g(u,c,e,n)}));else for(var f=0;f<i.length;f++)for(var d=0;d<i[f].length-1;d++)g(u,c,f,d);return e||(r={type:"Feature",geometry:{type:"MultiPoint",coordinates:r}}),r;function g(t,n,o,a){var l,h,u=i[t][n],c=i[t][n+1],f=i[o][a],d=i[o][a+1],g=function(t,e,n,i){if(KS(t,n)||KS(t,i)||KS(e,n)||KS(i,n))return null;var r=t[0],s=t[1],o=e[0],a=e[1],l=n[0],h=n[1],u=i[0],c=i[1],f=(r-o)*(h-c)-(s-a)*(l-u);return 0===f?null:[((r*a-s*o)*(l-u)-(r-o)*(l*c-h*u))/f,((r*a-s*o)*(h-c)-(s-a)*(l*c-h*u))/f]}(u,c,f,d);if(null!==g&&(l=c[0]!==u[0]?(g[0]-u[0])/(c[0]-u[0]):(g[1]-u[1])/(c[1]-u[1]),h=d[0]!==f[0]?(g[0]-f[0])/(d[0]-f[0]):(g[1]-f[1])/(d[1]-f[1]),!(l>=1||l<=0||h>=1||h<=0))){var p=g,m=!s[p];m&&(s[p]=!0),e?r.push(e(g,t,n,u,c,l,o,a,f,d,h,m)):r.push(g)}}function p(t,e){var n,r,s,o,a=i[t][e],l=i[t][e+1];return a[0]<l[0]?(n=a[0],r=l[0]):(n=l[0],r=a[0]),a[1]<l[1]?(s=a[1],o=l[1]):(s=l[1],o=a[1]),{minX:n,minY:s,maxX:r,maxY:o,ring:t,edge:e}}}(t,(function(t,e,n,i,r,s,o,a,l,h,u,c){return[t,e,n,i,r,s,o,a,l,h,u,c]})),a=o.length;if(0==a){var l=[];for(i=0;i<e;i++)l.push(xS([t.geometry.coordinates[i]],{parent:-1,winding:nI(t.geometry.coordinates[i])}));var h=bS(l);return D(),F(),h}var u=[],c=[];for(i=0;i<e;i++){u.push([]);for(var f=0;f<t.geometry.coordinates[i].length-1;f++)u[i].push([new QS(t.geometry.coordinates[i][rI(f+1,t.geometry.coordinates[i].length-1)],1,[i,f],[i,rI(f+1,t.geometry.coordinates[i].length-1)],void 0)]),c.push(new tI(t.geometry.coordinates[i][f],[i,rI(f-1,t.geometry.coordinates[i].length-1)],[i,f],void 0,void 0,!1,!0))}for(i=0;i<a;i++)u[o[i][1]][o[i][2]].push(new QS(o[i][0],o[i][5],[o[i][1],o[i][2]],[o[i][6],o[i][7]],void 0)),o[i][11]&&c.push(new tI(o[i][0],[o[i][1],o[i][2]],[o[i][6],o[i][7]],void 0,void 0,!0,!0));var d=c.length;for(i=0;i<u.length;i++)for(f=0;f<u[i].length;f++)u[i][f].sort((function(t,e){return t.param<e.param?-1:1}));var g=[];for(i=0;i<d;i++)g.push({minX:c[i].coord[0],minY:c[i].coord[1],maxX:c[i].coord[0],maxY:c[i].coord[1],index:i});var p=VS();for(p.load(g),i=0;i<u.length;i++)for(f=0;f<u[i].length;f++)for(var m=0;m<u[i][f].length;m++){v=m==u[i][f].length-1?u[i][rI(f+1,t.geometry.coordinates[i].length-1)][0].coord:u[i][f][m+1].coord;var y=p.search({minX:v[0],minY:v[1],maxX:v[0],maxY:v[1]})[0];u[i][f][m].nxtIsectAlongEdgeIn=y.index}for(i=0;i<u.length;i++)for(f=0;f<u[i].length;f++)for(m=0;m<u[i][f].length;m++){var v=u[i][f][m].coord,w=(y=p.search({minX:v[0],minY:v[1],maxX:v[0],maxY:v[1]})[0]).index;w<s?c[w].nxtIsectAlongRingAndEdge2=u[i][f][m].nxtIsectAlongEdgeIn:iI(c[w].ringAndEdge1,u[i][f][m].ringAndEdgeIn)?c[w].nxtIsectAlongRingAndEdge1=u[i][f][m].nxtIsectAlongEdgeIn:c[w].nxtIsectAlongRingAndEdge2=u[i][f][m].nxtIsectAlongEdgeIn}var x=[];for(i=0,f=0;f<e;f++){var _=i;for(m=0;m<t.geometry.coordinates[f].length-1;m++)c[i].coord[0]<c[_].coord[0]&&(_=i),i++;var b=c[_].nxtIsectAlongRingAndEdge2;for(m=0;m<c.length;m++)if(c[m].nxtIsectAlongRingAndEdge1==_||c[m].nxtIsectAlongRingAndEdge2==_){var E=m;break}var S=eI([c[E].coord,c[_].coord,c[b].coord],!0)?1:-1;x.push({isect:_,parent:-1,winding:S})}for(x.sort((function(t,e){return c[t.isect].coord>c[e.isect].coord?-1:1})),l=[];x.length>0;){var I=x.pop(),C=I.isect,M=I.parent,R=I.winding,P=l.length,T=[c[C].coord],N=C;if(c[C].ringAndEdge1Walkable)var A=c[C].ringAndEdge1,k=c[C].nxtIsectAlongRingAndEdge1;else A=c[C].ringAndEdge2,k=c[C].nxtIsectAlongRingAndEdge2;for(;!iI(c[C].coord,c[k].coord);){T.push(c[k].coord);var L=void 0;for(i=0;i<x.length;i++)if(x[i].isect==k){L=i;break}if(null!=L&&x.splice(L,1),iI(A,c[k].ringAndEdge1)){if(A=c[k].ringAndEdge2,c[k].ringAndEdge2Walkable=!1,c[k].ringAndEdge1Walkable){var O={isect:k};eI([c[N].coord,c[k].coord,c[c[k].nxtIsectAlongRingAndEdge2].coord],1==R)?(O.parent=M,O.winding=-R):(O.parent=P,O.winding=R),x.push(O)}N=k,k=c[k].nxtIsectAlongRingAndEdge2}else A=c[k].ringAndEdge1,c[k].ringAndEdge1Walkable=!1,c[k].ringAndEdge2Walkable&&(O={isect:k},eI([c[N].coord,c[k].coord,c[c[k].nxtIsectAlongRingAndEdge1].coord],1==R)?(O.parent=M,O.winding=-R):(O.parent=P,O.winding=R),x.push(O)),N=k,k=c[k].nxtIsectAlongRingAndEdge1}T.push(c[k].coord),l.push(xS([T],{index:P,parent:M,winding:R,netWinding:void 0}))}function D(){for(var t=[],e=0;e<h.features.length;e++)-1==h.features[e].properties.parent&&t.push(e);if(t.length>1)for(e=0;e<t.length;e++){for(var n=-1,i=0;i<h.features.length;i++)t[e]!=i&&$S(h.features[t[e]].geometry.coordinates[0][0],h.features[i],{ignoreBoundary:!0})&&XS(h.features[i])<1/0&&(n=i);h.features[t[e]].properties.parent=n}}function F(){for(var t=0;t<h.features.length;t++)if(-1==h.features[t].properties.parent){var e=h.features[t].properties.winding;h.features[t].properties.netWinding=e,z(t,e)}}function z(t,e){for(var n=0;n<h.features.length;n++)if(h.features[n].properties.parent==t){var i=e+h.features[n].properties.winding;h.features[n].properties.netWinding=i,z(n,i)}}return h=bS(l),D(),F(),h}var QS=function(t,e,n,i,r){this.coord=t,this.param=e,this.ringAndEdgeIn=n,this.ringAndEdgeOut=i,this.nxtIsectAlongEdgeIn=r},tI=function(t,e,n,i,r,s,o){this.coord=t,this.ringAndEdge1=e,this.ringAndEdge2=n,this.nxtIsectAlongRingAndEdge1=i,this.nxtIsectAlongRingAndEdge2=r,this.ringAndEdge1Walkable=s,this.ringAndEdge2Walkable=o};function eI(t,e){if(void 0===e&&(e=!0),3!=t.length)throw new Error("This function requires an array of three points [x,y]");return(t[1][0]-t[0][0])*(t[2][1]-t[0][1])-(t[1][1]-t[0][1])*(t[2][0]-t[0][0])>=0==e}function nI(t){for(var e=0,n=0;n<t.length-1;n++)t[n][0]<t[e][0]&&(e=n);if(eI([t[rI(e-1,t.length-1)],t[e],t[rI(e+1,t.length-1)]],!0))var i=1;else i=-1;return i}function iI(t,e){if(!t||!e)return!1;if(t.length!=e.length)return!1;for(var n=0,i=t.length;n<i;n++)if(t[n]instanceof Array&&e[n]instanceof Array){if(!iI(t[n],e[n]))return!1}else if(t[n]!=e[n])return!1;return!0}function rI(t,e){return(t%e+e)%e}function sI(t){var e=RS(t);if(2===e.length&&!oI(e[0],e[1]))return e;var n=[],i=e.length-1,r=n.length;n.push(e[0]);for(var s=1;s<i;s++){var o=n[n.length-1];e[s][0]===o[0]&&e[s][1]===o[1]||(n.push(e[s]),(r=n.length)>2&&aI(n[r-3],n[r-1],n[r-2])&&n.splice(n.length-2,1))}if(n.push(e[e.length-1]),r=n.length,oI(e[0],e[e.length-1])&&r<4)throw new Error("invalid polygon");return aI(n[r-3],n[r-1],n[r-2])&&n.splice(n.length-2,1),n}function oI(t,e){return t[0]===e[0]&&t[1]===e[1]}function aI(t,e,n){var i=n[0],r=n[1],s=t[0],o=t[1],a=e[0],l=e[1],h=a-s,u=l-o;return 0==(i-s)*u-(r-o)*h&&(Math.abs(h)>=Math.abs(u)?h>0?s<=i&&i<=a:a<=i&&i<=s:u>0?o<=r&&r<=l:l<=r&&r<=o)}let lI=0;function hI(t){const e=new WE({features:new gS({dataProjection:"EPSG:3857"}).readFeatures(t)});let n=new kE;if("lines"===t.name){let t=[];e.forEachFeature((e=>{let n=e.getGeometry().simplify(3);if(n.getCoordinates().length>=2){let e=new Xb({geometry:n});t.push(e)}}));let i=new WE({features:t});i.forEachFeature((t=>{t.getGeometry().transform("EPSG:3857","EPSG:4326")})),n.setSource(i),lI=t.length}else if("polygonFeatures"===t.name){let t=[];e.forEachFeature((e=>{let n=e.clone();n.getGeometry().transform("EPSG:3857","EPSG:4326");let i,r=n.getGeometry().getCoordinates()[0];r.length>=4&&(i=(0,pS.polygon)([r]));let s=function(t,e){void 0===e&&(e={});var n="object"==typeof e?e.mutate:e;if(!t)throw new Error("geojson is required");var i=TS(t),r=[];switch(i){case"LineString":r=sI(t);break;case"MultiLineString":case"Polygon":RS(t).forEach((function(t){r.push(sI(t))}));break;case"MultiPolygon":RS(t).forEach((function(t){var e=[];t.forEach((function(t){e.push(sI(t))})),r.push(e)}));break;case"Point":return t;case"MultiPoint":var s={};RS(t).forEach((function(t){var e=t.join("-");Object.prototype.hasOwnProperty.call(s,e)||(r.push(t),s[e]=!0)}));break;default:throw new Error(i+" geometry not supported")}return t.coordinates?!0===n?(t.coordinates=r,t):{type:i,coordinates:r}:!0===n?(t.geometry.coordinates=r,t):vS({type:i,coordinates:r},t.properties,{bbox:t.bbox,id:t.id})}((0,pS.simplify)(i,5e-6,!0));if((0,pS.kinks)(s).features.length)(o=s,a=[],FS(o,(function(t){"Polygon"===t.geometry.type&&OS(JS(t),(function(e){a.push(xS(e.geometry.coordinates,t.properties))}))})),bS(a)).features.forEach((e=>{let n=new gS({dataProjection:"EPSG:4326"}).readFeature(e);t.push(n)}));else{let e=new gS({dataProjection:"EPSG:4326"}).readFeature(s);t.push(e)}var o,a}));let i=new WE({features:t});n.setSource(i),lI=t.length}else lI=t.features.length,n.setSource(e);return"junctions"===t.name&&n.setStyle(new Xr({image:new Hr({src:"https://maps.google.com/mapfiles/kml/paddle/red-blank.png",anchor:[.5,1],scale:.5})})),n}function uI(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}__webpack_require__(3614),Error,Error;var cI,fI={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function dI(t){return(t=Math.round(t))<0?0:t>255?255:t}function gI(t){return t<0?0:t>1?1:t}function pI(t){return"%"===t[t.length-1]?dI(parseFloat(t)/100*255):dI(parseInt(t))}function mI(t){return"%"===t[t.length-1]?gI(parseFloat(t)/100):gI(parseFloat(t))}function yI(t,e,n){return n<0?n+=1:n>1&&(n-=1),6*n<1?t+(e-t)*n*6:2*n<1?e:3*n<2?t+(e-t)*(2/3-n)*6:t}try{cI={}.parseCSSColor=function(t){var e,n=t.replace(/ /g,"").toLowerCase();if(n in fI)return fI[n].slice();if("#"===n[0])return 4===n.length?(e=parseInt(n.substr(1),16))>=0&&e<=4095?[(3840&e)>>4|(3840&e)>>8,240&e|(240&e)>>4,15&e|(15&e)<<4,1]:null:7===n.length&&(e=parseInt(n.substr(1),16))>=0&&e<=16777215?[(16711680&e)>>16,(65280&e)>>8,255&e,1]:null;var i=n.indexOf("("),r=n.indexOf(")");if(-1!==i&&r+1===n.length){var s=n.substr(0,i),o=n.substr(i+1,r-(i+1)).split(","),a=1;switch(s){case"rgba":if(4!==o.length)return null;a=mI(o.pop());case"rgb":return 3!==o.length?null:[pI(o[0]),pI(o[1]),pI(o[2]),a];case"hsla":if(4!==o.length)return null;a=mI(o.pop());case"hsl":if(3!==o.length)return null;var l=(parseFloat(o[0])%360+360)%360/360,h=mI(o[1]),u=mI(o[2]),c=u<=.5?u*(h+1):u+h-u*h,f=2*u-c;return[dI(255*yI(f,c,l+1/3)),dI(255*yI(f,c,l)),dI(255*yI(f,c,l-1/3)),a];default:return null}}return null}}catch(t){}class vI{constructor(t,e,n,i=1){this.r=t,this.g=e,this.b=n,this.a=i}static parse(t){if(!t)return;if(t instanceof vI)return t;if("string"!=typeof t)return;const e=cI(t);return e?new vI(e[0]/255*e[3],e[1]/255*e[3],e[2]/255*e[3],e[3]):void 0}toString(){const[t,e,n,i]=this.toArray();return`rgba(${Math.round(t)},${Math.round(e)},${Math.round(n)},${i})`}toArray(){const{r:t,g:e,b:n,a:i}=this;return 0===i?[0,0,0,0]:[255*t/i,255*e/i,255*n/i,i]}toArray01(){const{r:t,g:e,b:n,a:i}=this;return 0===i?[0,0,0,0]:[t/i,e/i,n/i,i]}toArray01PremultipliedAlpha(){const{r:t,g:e,b:n,a:i}=this;return[t,e,n,i]}}vI.black=new vI(0,0,0,1),vI.white=new vI(1,1,1,1),vI.transparent=new vI(0,0,0,0),vI.red=new vI(1,0,0,1),vI.blue=new vI(0,0,1,1);var wI=vI;class xI extends Error{constructor(t,e){super(e),this.message=e,this.key=t}}var _I=xI;class bI{constructor(t,e=[]){this.parent=t,this.bindings={};for(const[t,n]of e)this.bindings[t]=n}concat(t){return new bI(this,t)}get(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(`${t} not found in scope.`)}has(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)}}var EI=bI;const SI={kind:"null"},II={kind:"number"},CI={kind:"string"},MI={kind:"boolean"},RI={kind:"color"},PI={kind:"object"},TI={kind:"value"},NI={kind:"collator"},AI={kind:"formatted"},kI={kind:"resolvedImage"};function LI(t,e){return{kind:"array",itemType:t,N:e}}function OI(t){if("array"===t.kind){const e=OI(t.itemType);return"number"==typeof t.N?`array<${e}, ${t.N}>`:"value"===t.itemType.kind?"array":`array<${e}>`}return t.kind}const DI=[SI,II,CI,MI,RI,AI,PI,LI(TI),kI];function FI(t,e){if("error"===e.kind)return null;if("array"===t.kind){if("array"===e.kind&&(0===e.N&&"value"===e.itemType.kind||!FI(t.itemType,e.itemType))&&("number"!=typeof t.N||t.N===e.N))return null}else{if(t.kind===e.kind)return null;if("value"===t.kind)for(const t of DI)if(!FI(t,e))return null}return`Expected ${OI(t)} but found ${OI(e)} instead.`}function zI(t,e){return e.some((e=>e.kind===t.kind))}function GI(t,e){return e.some((e=>"null"===e?null===t:"array"===e?Array.isArray(t):"object"===e?t&&!Array.isArray(t)&&"object"==typeof t:e===typeof t))}class BI{constructor(t,e,n){this.sensitivity=t?e?"variant":"case":e?"accent":"base",this.locale=n,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(t,e){return this.collator.compare(t,e)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class UI{constructor(t,e,n,i,r){this.text=t.normalize?t.normalize():t,this.image=e,this.scale=n,this.fontStack=i,this.textColor=r}}class qI{constructor(t){this.sections=t}static fromString(t){return new qI([new UI(t,null,null,null,null)])}isEmpty(){return 0===this.sections.length||!this.sections.some((t=>0!==t.text.length||t.image&&0!==t.image.name.length))}static factory(t){return t instanceof qI?t:qI.fromString(t)}toString(){return 0===this.sections.length?"":this.sections.map((t=>t.text)).join("")}serialize(){const t=["format"];for(const e of this.sections){if(e.image){t.push(["image",e.image.name]);continue}t.push(e.text);const n={};e.fontStack&&(n["text-font"]=["literal",e.fontStack.split(",")]),e.scale&&(n["font-scale"]=e.scale),e.textColor&&(n["text-color"]=["rgba"].concat(e.textColor.toArray())),t.push(n)}return t}}class VI{constructor(t){this.name=t.name,this.available=t.available}toString(){return this.name}static fromString(t){return t?new VI({name:t,available:!1}):null}serialize(){return["image",this.name]}}function YI(t,e,n,i){return"number"==typeof t&&t>=0&&t<=255&&"number"==typeof e&&e>=0&&e<=255&&"number"==typeof n&&n>=0&&n<=255?void 0===i||"number"==typeof i&&i>=0&&i<=1?null:`Invalid rgba value [${[t,e,n,i].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${("number"==typeof i?[t,e,n,i]:[t,e,n]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function XI(t){if(null===t)return!0;if("string"==typeof t)return!0;if("boolean"==typeof t)return!0;if("number"==typeof t)return!0;if(t instanceof wI)return!0;if(t instanceof BI)return!0;if(t instanceof qI)return!0;if(t instanceof VI)return!0;if(Array.isArray(t)){for(const e of t)if(!XI(e))return!1;return!0}if("object"==typeof t){for(const e in t)if(!XI(t[e]))return!1;return!0}return!1}function jI(t){if(null===t)return SI;if("string"==typeof t)return CI;if("boolean"==typeof t)return MI;if("number"==typeof t)return II;if(t instanceof wI)return RI;if(t instanceof BI)return NI;if(t instanceof qI)return AI;if(t instanceof VI)return kI;if(Array.isArray(t)){const e=t.length;let n;for(const e of t){const t=jI(e);if(n){if(n===t)continue;n=TI;break}n=t}return LI(n||TI,e)}return PI}function WI(t){const e=typeof t;return null===t?"":"string"===e||"number"===e||"boolean"===e?String(t):t instanceof wI||t instanceof qI||t instanceof VI?t.toString():JSON.stringify(t)}class HI{constructor(t,e){this.type=t,this.value=e}static parse(t,e){if(2!==t.length)return e.error(`'literal' expression requires exactly one argument, but found ${t.length-1} instead.`);if(!XI(t[1]))return e.error("invalid value");const n=t[1];let i=jI(n);const r=e.expectedType;return"array"!==i.kind||0!==i.N||!r||"array"!==r.kind||"number"==typeof r.N&&0!==r.N||(i=r),new HI(i,n)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof wI?["rgba"].concat(this.value.toArray()):this.value instanceof qI?this.value.serialize():this.value}}var $I=HI,ZI=class{constructor(t){this.name="ExpressionEvaluationError",this.message=t}toJSON(){return this.message}};const KI={string:CI,number:II,boolean:MI,object:PI};class JI{constructor(t,e){this.type=t,this.args=e}static parse(t,e){if(t.length<2)return e.error("Expected at least one argument.");let n,i=1;const r=t[0];if("array"===r){let r,s;if(t.length>2){const n=t[1];if("string"!=typeof n||!(n in KI)||"object"===n)return e.error('The item type argument of "array" must be one of string, number, boolean',1);r=KI[n],i++}else r=TI;if(t.length>3){if(null!==t[2]&&("number"!=typeof t[2]||t[2]<0||t[2]!==Math.floor(t[2])))return e.error('The length argument to "array" must be a positive integer literal',2);s=t[2],i++}n=LI(r,s)}else n=KI[r];const s=[];for(;i<t.length;i++){const n=e.parse(t[i],i,TI);if(!n)return null;s.push(n)}return new JI(n,s)}evaluate(t){for(let e=0;e<this.args.length;e++){const n=this.args[e].evaluate(t);if(!FI(this.type,jI(n)))return n;if(e===this.args.length-1)throw new ZI(`Expected value to be of type ${OI(this.type)}, but found ${OI(jI(n))} instead.`)}return null}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every((t=>t.outputDefined()))}serialize(){const t=this.type,e=[t.kind];if("array"===t.kind){const n=t.itemType;if("string"===n.kind||"number"===n.kind||"boolean"===n.kind){e.push(n.kind);const i=t.N;("number"==typeof i||this.args.length>1)&&e.push(i)}}return e.concat(this.args.map((t=>t.serialize())))}}var QI=JI;class tC{constructor(t){this.type=AI,this.sections=t}static parse(t,e){if(t.length<2)return e.error("Expected at least one argument.");const n=t[1];if(!Array.isArray(n)&&"object"==typeof n)return e.error("First argument must be an image or text section.");const i=[];let r=!1;for(let n=1;n<=t.length-1;++n){const s=t[n];if(r&&"object"==typeof s&&!Array.isArray(s)){r=!1;let t=null;if(s["font-scale"]&&(t=e.parse(s["font-scale"],1,II),!t))return null;let n=null;if(s["text-font"]&&(n=e.parse(s["text-font"],1,LI(CI)),!n))return null;let o=null;if(s["text-color"]&&(o=e.parse(s["text-color"],1,RI),!o))return null;const a=i[i.length-1];a.scale=t,a.font=n,a.textColor=o}else{const s=e.parse(t[n],1,TI);if(!s)return null;const o=s.type.kind;if("string"!==o&&"value"!==o&&"null"!==o&&"resolvedImage"!==o)return e.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");r=!0,i.push({content:s,scale:null,font:null,textColor:null})}}return new tC(i)}evaluate(t){return new qI(this.sections.map((e=>{const n=e.content.evaluate(t);return jI(n)===kI?new UI("",n,null,null,null):new UI(WI(n),null,e.scale?e.scale.evaluate(t):null,e.font?e.font.evaluate(t).join(","):null,e.textColor?e.textColor.evaluate(t):null)})))}eachChild(t){for(const e of this.sections)t(e.content),e.scale&&t(e.scale),e.font&&t(e.font),e.textColor&&t(e.textColor)}outputDefined(){return!1}serialize(){const t=["format"];for(const e of this.sections){t.push(e.content.serialize());const n={};e.scale&&(n["font-scale"]=e.scale.serialize()),e.font&&(n["text-font"]=e.font.serialize()),e.textColor&&(n["text-color"]=e.textColor.serialize()),t.push(n)}return t}}class eC{constructor(t){this.type=kI,this.input=t}static parse(t,e){if(2!==t.length)return e.error("Expected two arguments.");const n=e.parse(t[1],1,CI);return n?new eC(n):e.error("No image name provided.")}evaluate(t){const e=this.input.evaluate(t),n=VI.fromString(e);return n&&t.availableImages&&(n.available=t.availableImages.indexOf(e)>-1),n}eachChild(t){t(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const nC={"to-boolean":MI,"to-color":RI,"to-number":II,"to-string":CI};class iC{constructor(t,e){this.type=t,this.args=e}static parse(t,e){if(t.length<2)return e.error("Expected at least one argument.");const n=t[0];if(("to-boolean"===n||"to-string"===n)&&2!==t.length)return e.error("Expected one argument.");const i=nC[n],r=[];for(let n=1;n<t.length;n++){const i=e.parse(t[n],n,TI);if(!i)return null;r.push(i)}return new iC(i,r)}evaluate(t){if("boolean"===this.type.kind)return Boolean(this.args[0].evaluate(t));if("color"===this.type.kind){let e,n;for(const i of this.args){if(e=i.evaluate(t),n=null,e instanceof wI)return e;if("string"==typeof e){const n=t.parseColor(e);if(n)return n}else if(Array.isArray(e)&&(n=e.length<3||e.length>4?`Invalid rbga value ${JSON.stringify(e)}: expected an array containing either three or four numeric values.`:YI(e[0],e[1],e[2],e[3]),!n))return new wI(e[0]/255,e[1]/255,e[2]/255,e[3])}throw new ZI(n||`Could not parse color from value '${"string"==typeof e?e:String(JSON.stringify(e))}'`)}if("number"===this.type.kind){let e=null;for(const n of this.args){if(e=n.evaluate(t),null===e)return 0;const i=Number(e);if(!isNaN(i))return i}throw new ZI(`Could not convert ${JSON.stringify(e)} to number.`)}return"formatted"===this.type.kind?qI.fromString(WI(this.args[0].evaluate(t))):"resolvedImage"===this.type.kind?VI.fromString(WI(this.args[0].evaluate(t))):WI(this.args[0].evaluate(t))}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every((t=>t.outputDefined()))}serialize(){if("formatted"===this.type.kind)return new tC([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new eC(this.args[0]).serialize();const t=[`to-${this.type.kind}`];return this.eachChild((e=>{t.push(e.serialize())})),t}}var rC=iC;const sC=["Unknown","Point","LineString","Polygon"];var oC=class{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&void 0!==this.feature.id?this.feature.id:null}geometryType(){return this.feature?"number"==typeof this.feature.type?sC[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const t=this.featureDistanceData.center,e=this.featureDistanceData.scale,{x:n,y:i}=this.featureTileCoord,r=n*e-t[0],s=i*e-t[1];return this.featureDistanceData.bearing[0]*r+this.featureDistanceData.bearing[1]*s}return 0}parseColor(t){let e=this._parseColorCache[t];return e||(e=this._parseColorCache[t]=wI.parse(t)),e}};class aC{constructor(t,e,n,i){this.name=t,this.type=e,this._evaluate=n,this.args=i}evaluate(t){return this._evaluate(t,this.args)}eachChild(t){this.args.forEach(t)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map((t=>t.serialize())))}static parse(t,e){const n=t[0],i=aC.definitions[n];if(!i)return e.error(`Unknown expression "${n}". If you wanted a literal array, use ["literal", [...]].`,0);const r=Array.isArray(i)?i[0]:i.type,s=Array.isArray(i)?[[i[1],i[2]]]:i.overloads,o=s.filter((([e])=>!Array.isArray(e)||e.length===t.length-1));let a=null;for(const[i,s]of o){a=new OC(e.registry,e.path,null,e.scope);const o=[];let l=!1;for(let e=1;e<t.length;e++){const n=t[e],r=Array.isArray(i)?i[e-1]:i.type,s=a.parse(n,1+o.length,r);if(!s){l=!0;break}o.push(s)}if(!l)if(Array.isArray(i)&&i.length!==o.length)a.error(`Expected ${i.length} arguments, but found ${o.length} instead.`);else{for(let t=0;t<o.length;t++){const e=Array.isArray(i)?i[t]:i.type,n=o[t];a.concat(t+1).checkSubtype(e,n.type)}if(0===a.errors.length)return new aC(n,r,s,o)}}if(1===o.length)e.errors.push(...a.errors);else{const n=(o.length?o:s).map((([t])=>{return e=t,Array.isArray(e)?`(${e.map(OI).join(", ")})`:`(${OI(e.type)}...)`;var e})).join(" | "),i=[];for(let n=1;n<t.length;n++){const r=e.parse(t[n],1+i.length);if(!r)return null;i.push(OI(r.type))}e.error(`Expected arguments of type ${n}, but found (${i.join(", ")}) instead.`)}return null}static register(t,e){aC.definitions=e;for(const n in e)t[n]=aC}}var lC=aC;class hC{constructor(t,e,n){this.type=NI,this.locale=n,this.caseSensitive=t,this.diacriticSensitive=e}static parse(t,e){if(2!==t.length)return e.error("Expected one argument.");const n=t[1];if("object"!=typeof n||Array.isArray(n))return e.error("Collator options argument must be an object.");const i=e.parse(void 0!==n["case-sensitive"]&&n["case-sensitive"],1,MI);if(!i)return null;const r=e.parse(void 0!==n["diacritic-sensitive"]&&n["diacritic-sensitive"],1,MI);if(!r)return null;let s=null;return n.locale&&(s=e.parse(n.locale,1,CI),!s)?null:new hC(i,r,s)}evaluate(t){return new BI(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)}eachChild(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)}outputDefined(){return!1}serialize(){const t={};return t["case-sensitive"]=this.caseSensitive.serialize(),t["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(t.locale=this.locale.serialize()),["collator",t]}}const uC=8192;function cC(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.max(t[2],e[0]),t[3]=Math.max(t[3],e[1])}function fC(t,e){return!(t[0]<=e[0]||t[2]>=e[2]||t[1]<=e[1]||t[3]>=e[3])}function dC(t,e){const n=(180+t[0])/360,i=(r=t[1],(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+r*Math.PI/360)))/360);var r;const s=Math.pow(2,e.z);return[Math.round(n*s*uC),Math.round(i*s*uC)]}function gC(t,e,n){const i=t[0]-e[0],r=t[1]-e[1],s=t[0]-n[0],o=t[1]-n[1];return i*o-s*r==0&&i*s<=0&&r*o<=0}function pC(t,e,n){return e[1]>t[1]!=n[1]>t[1]&&t[0]<(n[0]-e[0])*(t[1]-e[1])/(n[1]-e[1])+e[0]}function mC(t,e){let n=!1;for(let i=0,r=e.length;i<r;i++){const r=e[i];for(let e=0,i=r.length;e<i-1;e++){if(gC(t,r[e],r[e+1]))return!1;pC(t,r[e],r[e+1])&&(n=!n)}}return n}function yC(t,e){for(let n=0;n<e.length;n++)if(mC(t,e[n]))return!0;return!1}function vC(t,e,n,i){const r=t[0]-n[0],s=t[1]-n[1],o=e[0]-n[0],a=e[1]-n[1],l=i[0]-n[0],h=i[1]-n[1],u=r*h-l*s,c=o*h-l*a;return u>0&&c<0||u<0&&c>0}function wC(t,e,n,i){const r=[e[0]-t[0],e[1]-t[1]];return 0!=(s=[i[0]-n[0],i[1]-n[1]])[0]*(o=r)[1]-s[1]*o[0]&&!(!vC(t,e,n,i)||!vC(n,i,t,e));var s,o}function xC(t,e,n){for(const i of n)for(let n=0;n<i.length-1;++n)if(wC(t,e,i[n],i[n+1]))return!0;return!1}function _C(t,e){for(let n=0;n<t.length;++n)if(!mC(t[n],e))return!1;for(let n=0;n<t.length-1;++n)if(xC(t[n],t[n+1],e))return!1;return!0}function bC(t,e){for(let n=0;n<e.length;n++)if(_C(t,e[n]))return!0;return!1}function EC(t,e,n){const i=[];for(let r=0;r<t.length;r++){const s=[];for(let i=0;i<t[r].length;i++){const o=dC(t[r][i],n);cC(e,o),s.push(o)}i.push(s)}return i}function SC(t,e,n){const i=[];for(let r=0;r<t.length;r++){const s=EC(t[r],e,n);i.push(s)}return i}function IC(t,e,n,i){if(t[0]<n[0]||t[0]>n[2]){const e=.5*i;let r=t[0]-n[0]>e?-i:n[0]-t[0]>e?i:0;0===r&&(r=t[0]-n[2]>e?-i:n[2]-t[0]>e?i:0),t[0]+=r}cC(e,t)}function CC(t,e,n,i){const r=Math.pow(2,i.z)*uC,s=[i.x*uC,i.y*uC],o=[];if(!t)return o;for(const i of t)for(const t of i){const i=[t.x+s[0],t.y+s[1]];IC(i,e,n,r),o.push(i)}return o}function MC(t,e,n,i){const r=Math.pow(2,i.z)*uC,s=[i.x*uC,i.y*uC],o=[];if(!t)return o;for(const n of t){const t=[];for(const i of n){const n=[i.x+s[0],i.y+s[1]];cC(e,n),t.push(n)}o.push(t)}if(e[2]-e[0]<=r/2){(a=e)[0]=a[1]=1/0,a[2]=a[3]=-1/0;for(const t of o)for(const i of t)IC(i,e,n,r)}var a;return o}class RC{constructor(t,e){this.type=MI,this.geojson=t,this.geometries=e}static parse(t,e){if(2!==t.length)return e.error(`'within' expression requires exactly one argument, but found ${t.length-1} instead.`);if(XI(t[1])){const e=t[1];if("FeatureCollection"===e.type)for(let t=0;t<e.features.length;++t){const n=e.features[t].geometry.type;if("Polygon"===n||"MultiPolygon"===n)return new RC(e,e.features[t].geometry)}else if("Feature"===e.type){const t=e.geometry.type;if("Polygon"===t||"MultiPolygon"===t)return new RC(e,e.geometry)}else if("Polygon"===e.type||"MultiPolygon"===e.type)return new RC(e,e)}return e.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(null!=t.geometry()&&null!=t.canonicalID()){if("Point"===t.geometryType())return function(t,e){const n=[1/0,1/0,-1/0,-1/0],i=[1/0,1/0,-1/0,-1/0],r=t.canonicalID();if(!r)return!1;if("Polygon"===e.type){const s=EC(e.coordinates,i,r),o=CC(t.geometry(),n,i,r);if(!fC(n,i))return!1;for(const t of o)if(!mC(t,s))return!1}if("MultiPolygon"===e.type){const s=SC(e.coordinates,i,r),o=CC(t.geometry(),n,i,r);if(!fC(n,i))return!1;for(const t of o)if(!yC(t,s))return!1}return!0}(t,this.geometries);if("LineString"===t.geometryType())return function(t,e){const n=[1/0,1/0,-1/0,-1/0],i=[1/0,1/0,-1/0,-1/0],r=t.canonicalID();if(!r)return!1;if("Polygon"===e.type){const s=EC(e.coordinates,i,r),o=MC(t.geometry(),n,i,r);if(!fC(n,i))return!1;for(const t of o)if(!_C(t,s))return!1}if("MultiPolygon"===e.type){const s=SC(e.coordinates,i,r),o=MC(t.geometry(),n,i,r);if(!fC(n,i))return!1;for(const t of o)if(!bC(t,s))return!1}return!0}(t,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var PC=RC;function TC(t){if(t instanceof lC){if("get"===t.name&&1===t.args.length)return!1;if("feature-state"===t.name)return!1;if("has"===t.name&&1===t.args.length)return!1;if("properties"===t.name||"geometry-type"===t.name||"id"===t.name)return!1;if(/^filter-/.test(t.name))return!1}if(t instanceof PC)return!1;let e=!0;return t.eachChild((t=>{e&&!TC(t)&&(e=!1)})),e}function NC(t,e){if(t instanceof lC&&e.indexOf(t.name)>=0)return!1;let n=!0;return t.eachChild((t=>{n&&!NC(t,e)&&(n=!1)})),n}class AC{constructor(t,e){this.type=e.type,this.name=t,this.boundExpression=e}static parse(t,e){if(2!==t.length||"string"!=typeof t[1])return e.error("'var' expression requires exactly one string literal argument.");const n=t[1];return e.scope.has(n)?new AC(n,e.scope.get(n)):e.error(`Unknown variable "${n}". Make sure "${n}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(t){return this.boundExpression.evaluate(t)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var kC=AC;class LC{constructor(t,e=[],n,i=new EI,r=[]){this.registry=t,this.path=e,this.key=e.map((t=>`[${t}]`)).join(""),this.scope=i,this.errors=r,this.expectedType=n}parse(t,e,n,i,r={}){return e?this.concat(e,n,i)._parse(t,r):this._parse(t,r)}_parse(t,e){function n(t,e,n){return"assert"===n?new QI(e,[t]):"coerce"===n?new rC(e,[t]):t}if(null!==t&&"string"!=typeof t&&"boolean"!=typeof t&&"number"!=typeof t||(t=["literal",t]),Array.isArray(t)){if(0===t.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const i=t[0];if("string"!=typeof i)return this.error(`Expression name must be a string, but found ${typeof i} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const r=this.registry[i];if(r){let i=r.parse(t,this);if(!i)return null;if(this.expectedType){const t=this.expectedType,r=i.type;if("string"!==t.kind&&"number"!==t.kind&&"boolean"!==t.kind&&"object"!==t.kind&&"array"!==t.kind||"value"!==r.kind)if("color"!==t.kind&&"formatted"!==t.kind&&"resolvedImage"!==t.kind||"value"!==r.kind&&"string"!==r.kind){if(this.checkSubtype(t,r))return null}else i=n(i,t,e.typeAnnotation||"coerce");else i=n(i,t,e.typeAnnotation||"assert")}if(!(i instanceof $I)&&"resolvedImage"!==i.type.kind&&DC(i)){const t=new oC;try{i=new $I(i.type,i.evaluate(t))}catch(t){return this.error(t.message),null}}return i}return this.error(`Unknown expression "${i}". If you wanted a literal array, use ["literal", [...]].`,0)}return void 0===t?this.error("'undefined' value invalid. Use null instead."):"object"==typeof t?this.error('Bare objects invalid. Use ["literal", {...}] instead.'):this.error(`Expected an array, but found ${typeof t} instead.`)}concat(t,e,n){const i="number"==typeof t?this.path.concat(t):this.path,r=n?this.scope.concat(n):this.scope;return new LC(this.registry,i,e||null,r,this.errors)}error(t,...e){const n=`${this.key}${e.map((t=>`[${t}]`)).join("")}`;this.errors.push(new _I(n,t))}checkSubtype(t,e){const n=FI(t,e);return n&&this.error(n),n}}var OC=LC;function DC(t){if(t instanceof kC)return DC(t.boundExpression);if(t instanceof lC&&"error"===t.name)return!1;if(t instanceof hC)return!1;if(t instanceof PC)return!1;const e=t instanceof rC||t instanceof QI;let n=!0;return t.eachChild((t=>{n=e?n&&DC(t):n&&t instanceof $I})),!!n&&TC(t)&&NC(t,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}function FC(t,e){const n=t.length-1;let i,r,s=0,o=n,a=0;for(;s<=o;)if(a=Math.floor((s+o)/2),i=t[a],r=t[a+1],i<=e){if(a===n||e<r)return a;s=a+1}else{if(!(i>e))throw new ZI("Input is not a number.");o=a-1}return 0}class zC{constructor(t,e,n){this.type=t,this.input=e,this.labels=[],this.outputs=[];for(const[t,e]of n)this.labels.push(t),this.outputs.push(e)}static parse(t,e){if(t.length-1<4)return e.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return e.error("Expected an even number of arguments.");const n=e.parse(t[1],1,II);if(!n)return null;const i=[];let r=null;e.expectedType&&"value"!==e.expectedType.kind&&(r=e.expectedType);for(let n=1;n<t.length;n+=2){const s=1===n?-1/0:t[n],o=t[n+1],a=n,l=n+1;if("number"!=typeof s)return e.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',a);if(i.length&&i[i.length-1][0]>=s)return e.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',a);const h=e.parse(o,l,r);if(!h)return null;r=r||h.type,i.push([s,h])}return new zC(r,n,i)}evaluate(t){const e=this.labels,n=this.outputs;if(1===e.length)return n[0].evaluate(t);const i=this.input.evaluate(t);if(i<=e[0])return n[0].evaluate(t);const r=e.length;return i>=e[r-1]?n[r-1].evaluate(t):n[FC(e,i)].evaluate(t)}eachChild(t){t(this.input);for(const e of this.outputs)t(e)}outputDefined(){return this.outputs.every((t=>t.outputDefined()))}serialize(){const t=["step",this.input.serialize()];for(let e=0;e<this.labels.length;e++)e>0&&t.push(this.labels[e]),t.push(this.outputs[e].serialize());return t}}var GC=zC,BC=UC;function UC(t,e,n,i){this.cx=3*t,this.bx=3*(n-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(i-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=i,this.p2x=n,this.p2y=i}UC.prototype.sampleCurveX=function(t){return((this.ax*t+this.bx)*t+this.cx)*t},UC.prototype.sampleCurveY=function(t){return((this.ay*t+this.by)*t+this.cy)*t},UC.prototype.sampleCurveDerivativeX=function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},UC.prototype.solveCurveX=function(t,e){var n,i,r,s,o;for(void 0===e&&(e=1e-6),r=t,o=0;o<8;o++){if(s=this.sampleCurveX(r)-t,Math.abs(s)<e)return r;var a=this.sampleCurveDerivativeX(r);if(Math.abs(a)<1e-6)break;r-=s/a}if((r=t)<(n=0))return n;if(r>(i=1))return i;for(;n<i;){if(s=this.sampleCurveX(r),Math.abs(s-t)<e)return r;t>s?n=r:i=r,r=.5*(i-n)+n}return r},UC.prototype.solve=function(t,e){return this.sampleCurveY(this.solveCurveX(t,e))};var qC=uI(BC);function VC(t,e,n){return t*(1-n)+e*n}var YC=Object.freeze({__proto__:null,number:VC,color:function(t,e,n){return new wI(VC(t.r,e.r,n),VC(t.g,e.g,n),VC(t.b,e.b,n),VC(t.a,e.a,n))},array:function(t,e,n){return t.map(((t,i)=>VC(t,e[i],n)))}});const XC=.95047,jC=1.08883,WC=4/29,HC=6/29,$C=3*HC*HC,ZC=HC*HC*HC,KC=Math.PI/180,JC=180/Math.PI;function QC(t){return t>ZC?Math.pow(t,1/3):t/$C+WC}function tM(t){return t>HC?t*t*t:$C*(t-WC)}function eM(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function nM(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function iM(t){const e=nM(t.r),n=nM(t.g),i=nM(t.b),r=QC((.4124564*e+.3575761*n+.1804375*i)/XC),s=QC((.2126729*e+.7151522*n+.072175*i)/1);return{l:116*s-16,a:500*(r-s),b:200*(s-QC((.0193339*e+.119192*n+.9503041*i)/jC)),alpha:t.a}}function rM(t){let e=(t.l+16)/116,n=isNaN(t.a)?e:e+t.a/500,i=isNaN(t.b)?e:e-t.b/200;return e=1*tM(e),n=XC*tM(n),i=jC*tM(i),new wI(eM(3.2404542*n-1.5371385*e-.4985314*i),eM(-.969266*n+1.8760108*e+.041556*i),eM(.0556434*n-.2040259*e+1.0572252*i),t.alpha)}function sM(t,e,n){const i=e-t;return t+n*(i>180||i<-180?i-360*Math.round(i/360):i)}const oM={forward:iM,reverse:rM,interpolate:function(t,e,n){return{l:VC(t.l,e.l,n),a:VC(t.a,e.a,n),b:VC(t.b,e.b,n),alpha:VC(t.alpha,e.alpha,n)}}},aM=function(t){const{l:e,a:n,b:i}=iM(t),r=Math.atan2(i,n)*JC;return{h:r<0?r+360:r,c:Math.sqrt(n*n+i*i),l:e,alpha:t.a}},lM=function(t){const e=t.h*KC,n=t.c;return rM({l:t.l,a:Math.cos(e)*n,b:Math.sin(e)*n,alpha:t.alpha})},hM=function(t,e,n){return{h:sM(t.h,e.h,n),c:VC(t.c,e.c,n),l:VC(t.l,e.l,n),alpha:VC(t.alpha,e.alpha,n)}};class uM{constructor(t,e,n,i,r){this.type=t,this.operator=e,this.interpolation=n,this.input=i,this.labels=[],this.outputs=[];for(const[t,e]of r)this.labels.push(t),this.outputs.push(e)}static interpolationFactor(t,e,n,i){let r=0;if("exponential"===t.name)r=cM(e,t.base,n,i);else if("linear"===t.name)r=cM(e,1,n,i);else if("cubic-bezier"===t.name){const s=t.controlPoints;r=new qC(s[0],s[1],s[2],s[3]).solve(cM(e,1,n,i))}return r}static parse(t,e){let[n,i,r,...s]=t;if(!Array.isArray(i)||0===i.length)return e.error("Expected an interpolation type expression.",1);if("linear"===i[0])i={name:"linear"};else if("exponential"===i[0]){const t=i[1];if("number"!=typeof t)return e.error("Exponential interpolation requires a numeric base.",1,1);i={name:"exponential",base:t}}else{if("cubic-bezier"!==i[0])return e.error(`Unknown interpolation type ${String(i[0])}`,1,0);{const t=i.slice(1);if(4!==t.length||t.some((t=>"number"!=typeof t||t<0||t>1)))return e.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);i={name:"cubic-bezier",controlPoints:t}}}if(t.length-1<4)return e.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return e.error("Expected an even number of arguments.");if(r=e.parse(r,2,II),!r)return null;const o=[];let a=null;"interpolate-hcl"===n||"interpolate-lab"===n?a=RI:e.expectedType&&"value"!==e.expectedType.kind&&(a=e.expectedType);for(let t=0;t<s.length;t+=2){const n=s[t],i=s[t+1],r=t+3,l=t+4;if("number"!=typeof n)return e.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',r);if(o.length&&o[o.length-1][0]>=n)return e.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',r);const h=e.parse(i,l,a);if(!h)return null;a=a||h.type,o.push([n,h])}return"number"===a.kind||"color"===a.kind||"array"===a.kind&&"number"===a.itemType.kind&&"number"==typeof a.N?new uM(a,n,i,r,o):e.error(`Type ${OI(a)} is not interpolatable.`)}evaluate(t){const e=this.labels,n=this.outputs;if(1===e.length)return n[0].evaluate(t);const i=this.input.evaluate(t);if(i<=e[0])return n[0].evaluate(t);const r=e.length;if(i>=e[r-1])return n[r-1].evaluate(t);const s=FC(e,i),o=e[s],a=e[s+1],l=uM.interpolationFactor(this.interpolation,i,o,a),h=n[s].evaluate(t),u=n[s+1].evaluate(t);return"interpolate"===this.operator?YC[this.type.kind.toLowerCase()](h,u,l):"interpolate-hcl"===this.operator?lM(hM(aM(h),aM(u),l)):oM.reverse(oM.interpolate(oM.forward(h),oM.forward(u),l))}eachChild(t){t(this.input);for(const e of this.outputs)t(e)}outputDefined(){return this.outputs.every((t=>t.outputDefined()))}serialize(){let t;t="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const e=[this.operator,t,this.input.serialize()];for(let t=0;t<this.labels.length;t++)e.push(this.labels[t],this.outputs[t].serialize());return e}}function cM(t,e,n,i){const r=i-n,s=t-n;return 0===r?0:1===e?s/r:(Math.pow(e,s)-1)/(Math.pow(e,r)-1)}var fM=uM;class dM{constructor(t,e){this.type=t,this.args=e}static parse(t,e){if(t.length<2)return e.error("Expectected at least one argument.");let n=null;const i=e.expectedType;i&&"value"!==i.kind&&(n=i);const r=[];for(const i of t.slice(1)){const t=e.parse(i,1+r.length,n,void 0,{typeAnnotation:"omit"});if(!t)return null;n=n||t.type,r.push(t)}const s=i&&r.some((t=>FI(i,t.type)));return new dM(s?TI:n,r)}evaluate(t){let e,n=null,i=0;for(const r of this.args){if(i++,n=r.evaluate(t),n&&n instanceof VI&&!n.available&&(e||(e=n),n=null,i===this.args.length))return e;if(null!==n)break}return n}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every((t=>t.outputDefined()))}serialize(){const t=["coalesce"];return this.eachChild((e=>{t.push(e.serialize())})),t}}var gM=dM;class pM{constructor(t,e){this.type=e.type,this.bindings=[].concat(t),this.result=e}evaluate(t){return this.result.evaluate(t)}eachChild(t){for(const e of this.bindings)t(e[1]);t(this.result)}static parse(t,e){if(t.length<4)return e.error(`Expected at least 3 arguments, but found ${t.length-1} instead.`);const n=[];for(let i=1;i<t.length-1;i+=2){const r=t[i];if("string"!=typeof r)return e.error(`Expected string, but found ${typeof r} instead.`,i);if(/[^a-zA-Z0-9_]/.test(r))return e.error("Variable names must contain only alphanumeric characters or '_'.",i);const s=e.parse(t[i+1],i+1);if(!s)return null;n.push([r,s])}const i=e.parse(t[t.length-1],t.length-1,e.expectedType,n);return i?new pM(n,i):null}outputDefined(){return this.result.outputDefined()}serialize(){const t=["let"];for(const[e,n]of this.bindings)t.push(e,n.serialize());return t.push(this.result.serialize()),t}}var mM=pM;class yM{constructor(t,e,n){this.type=t,this.index=e,this.input=n}static parse(t,e){if(3!==t.length)return e.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const n=e.parse(t[1],1,II),i=e.parse(t[2],2,LI(e.expectedType||TI));if(!n||!i)return null;const r=i.type;return new yM(r.itemType,n,i)}evaluate(t){const e=this.index.evaluate(t),n=this.input.evaluate(t);if(e<0)throw new ZI(`Array index out of bounds: ${e} < 0.`);if(e>=n.length)throw new ZI(`Array index out of bounds: ${e} > ${n.length-1}.`);if(e!==Math.floor(e))throw new ZI(`Array index must be an integer, but found ${e} instead.`);return n[e]}eachChild(t){t(this.index),t(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var vM=yM;class wM{constructor(t,e){this.type=MI,this.needle=t,this.haystack=e}static parse(t,e){if(3!==t.length)return e.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const n=e.parse(t[1],1,TI),i=e.parse(t[2],2,TI);return n&&i?zI(n.type,[MI,CI,II,SI,TI])?new wM(n,i):e.error(`Expected first argument to be of type boolean, string, number or null, but found ${OI(n.type)} instead`):null}evaluate(t){const e=this.needle.evaluate(t),n=this.haystack.evaluate(t);if(null==n)return!1;if(!GI(e,["boolean","string","number","null"]))throw new ZI(`Expected first argument to be of type boolean, string, number or null, but found ${OI(jI(e))} instead.`);if(!GI(n,["string","array"]))throw new ZI(`Expected second argument to be of type array or string, but found ${OI(jI(n))} instead.`);return n.indexOf(e)>=0}eachChild(t){t(this.needle),t(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var xM=wM;class _M{constructor(t,e,n){this.type=II,this.needle=t,this.haystack=e,this.fromIndex=n}static parse(t,e){if(t.length<=2||t.length>=5)return e.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const n=e.parse(t[1],1,TI),i=e.parse(t[2],2,TI);if(!n||!i)return null;if(!zI(n.type,[MI,CI,II,SI,TI]))return e.error(`Expected first argument to be of type boolean, string, number or null, but found ${OI(n.type)} instead`);if(4===t.length){const r=e.parse(t[3],3,II);return r?new _M(n,i,r):null}return new _M(n,i)}evaluate(t){const e=this.needle.evaluate(t),n=this.haystack.evaluate(t);if(!GI(e,["boolean","string","number","null"]))throw new ZI(`Expected first argument to be of type boolean, string, number or null, but found ${OI(jI(e))} instead.`);if(!GI(n,["string","array"]))throw new ZI(`Expected second argument to be of type array or string, but found ${OI(jI(n))} instead.`);if(this.fromIndex){const i=this.fromIndex.evaluate(t);return n.indexOf(e,i)}return n.indexOf(e)}eachChild(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)}outputDefined(){return!1}serialize(){if(null!=this.fromIndex&&void 0!==this.fromIndex){const t=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),t]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var bM=_M;class EM{constructor(t,e,n,i,r,s){this.inputType=t,this.type=e,this.input=n,this.cases=i,this.outputs=r,this.otherwise=s}static parse(t,e){if(t.length<5)return e.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(t.length%2!=1)return e.error("Expected an even number of arguments.");let n,i;e.expectedType&&"value"!==e.expectedType.kind&&(i=e.expectedType);const r={},s=[];for(let o=2;o<t.length-1;o+=2){let a=t[o];const l=t[o+1];Array.isArray(a)||(a=[a]);const h=e.concat(o);if(0===a.length)return h.error("Expected at least one branch label.");for(const t of a){if("number"!=typeof t&&"string"!=typeof t)return h.error("Branch labels must be numbers or strings.");if("number"==typeof t&&Math.abs(t)>Number.MAX_SAFE_INTEGER)return h.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if("number"==typeof t&&Math.floor(t)!==t)return h.error("Numeric branch labels must be integer values.");if(n){if(h.checkSubtype(n,jI(t)))return null}else n=jI(t);if(void 0!==r[String(t)])return h.error("Branch labels must be unique.");r[String(t)]=s.length}const u=e.parse(l,o,i);if(!u)return null;i=i||u.type,s.push(u)}const o=e.parse(t[1],1,TI);if(!o)return null;const a=e.parse(t[t.length-1],t.length-1,i);return a?"value"!==o.type.kind&&e.concat(1).checkSubtype(n,o.type)?null:new EM(n,i,o,r,s,a):null}evaluate(t){const e=this.input.evaluate(t);return(jI(e)===this.inputType&&this.outputs[this.cases[e]]||this.otherwise).evaluate(t)}eachChild(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)}outputDefined(){return this.outputs.every((t=>t.outputDefined()))&&this.otherwise.outputDefined()}serialize(){const t=["match",this.input.serialize()],e=Object.keys(this.cases).sort(),n=[],i={};for(const t of e){const e=i[this.cases[t]];void 0===e?(i[this.cases[t]]=n.length,n.push([this.cases[t],[t]])):n[e][1].push(t)}const r=t=>"number"===this.inputType.kind?Number(t):t;for(const[e,i]of n)1===i.length?t.push(r(i[0])):t.push(i.map(r)),t.push(this.outputs[e].serialize());return t.push(this.otherwise.serialize()),t}}var SM=EM;class IM{constructor(t,e,n){this.type=t,this.branches=e,this.otherwise=n}static parse(t,e){if(t.length<4)return e.error(`Expected at least 3 arguments, but found only ${t.length-1}.`);if(t.length%2!=0)return e.error("Expected an odd number of arguments.");let n;e.expectedType&&"value"!==e.expectedType.kind&&(n=e.expectedType);const i=[];for(let r=1;r<t.length-1;r+=2){const s=e.parse(t[r],r,MI);if(!s)return null;const o=e.parse(t[r+1],r+1,n);if(!o)return null;i.push([s,o]),n=n||o.type}const r=e.parse(t[t.length-1],t.length-1,n);return r?new IM(n,i,r):null}evaluate(t){for(const[e,n]of this.branches)if(e.evaluate(t))return n.evaluate(t);return this.otherwise.evaluate(t)}eachChild(t){for(const[e,n]of this.branches)t(e),t(n);t(this.otherwise)}outputDefined(){return this.branches.every((([t,e])=>e.outputDefined()))&&this.otherwise.outputDefined()}serialize(){const t=["case"];return this.eachChild((e=>{t.push(e.serialize())})),t}}var CM=IM;class MM{constructor(t,e,n,i){this.type=t,this.input=e,this.beginIndex=n,this.endIndex=i}static parse(t,e){if(t.length<=2||t.length>=5)return e.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const n=e.parse(t[1],1,TI),i=e.parse(t[2],2,II);if(!n||!i)return null;if(!zI(n.type,[LI(TI),CI,TI]))return e.error(`Expected first argument to be of type array or string, but found ${OI(n.type)} instead`);if(4===t.length){const r=e.parse(t[3],3,II);return r?new MM(n.type,n,i,r):null}return new MM(n.type,n,i)}evaluate(t){const e=this.input.evaluate(t),n=this.beginIndex.evaluate(t);if(!GI(e,["string","array"]))throw new ZI(`Expected first argument to be of type array or string, but found ${OI(jI(e))} instead.`);if(this.endIndex){const i=this.endIndex.evaluate(t);return e.slice(n,i)}return e.slice(n)}eachChild(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)}outputDefined(){return!1}serialize(){if(null!=this.endIndex&&void 0!==this.endIndex){const t=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),t]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var RM=MM;function PM(t,e){return"=="===t||"!="===t?"boolean"===e.kind||"string"===e.kind||"number"===e.kind||"null"===e.kind||"value"===e.kind:"string"===e.kind||"number"===e.kind||"value"===e.kind}function TM(t,e,n,i){return 0===i.compare(e,n)}function NM(t,e,n){const i="=="!==t&&"!="!==t;return class r{constructor(t,e,n){this.type=MI,this.lhs=t,this.rhs=e,this.collator=n,this.hasUntypedArgument="value"===t.type.kind||"value"===e.type.kind}static parse(t,e){if(3!==t.length&&4!==t.length)return e.error("Expected two or three arguments.");const n=t[0];let s=e.parse(t[1],1,TI);if(!s)return null;if(!PM(n,s.type))return e.concat(1).error(`"${n}" comparisons are not supported for type '${OI(s.type)}'.`);let o=e.parse(t[2],2,TI);if(!o)return null;if(!PM(n,o.type))return e.concat(2).error(`"${n}" comparisons are not supported for type '${OI(o.type)}'.`);if(s.type.kind!==o.type.kind&&"value"!==s.type.kind&&"value"!==o.type.kind)return e.error(`Cannot compare types '${OI(s.type)}' and '${OI(o.type)}'.`);i&&("value"===s.type.kind&&"value"!==o.type.kind?s=new QI(o.type,[s]):"value"!==s.type.kind&&"value"===o.type.kind&&(o=new QI(s.type,[o])));let a=null;if(4===t.length){if("string"!==s.type.kind&&"string"!==o.type.kind&&"value"!==s.type.kind&&"value"!==o.type.kind)return e.error("Cannot use collator to compare non-string types.");if(a=e.parse(t[3],3,NI),!a)return null}return new r(s,o,a)}evaluate(r){const s=this.lhs.evaluate(r),o=this.rhs.evaluate(r);if(i&&this.hasUntypedArgument){const e=jI(s),n=jI(o);if(e.kind!==n.kind||"string"!==e.kind&&"number"!==e.kind)throw new ZI(`Expected arguments for "${t}" to be (string, string) or (number, number), but found (${e.kind}, ${n.kind}) instead.`)}if(this.collator&&!i&&this.hasUntypedArgument){const t=jI(s),n=jI(o);if("string"!==t.kind||"string"!==n.kind)return e(r,s,o)}return this.collator?n(r,s,o,this.collator.evaluate(r)):e(r,s,o)}eachChild(t){t(this.lhs),t(this.rhs),this.collator&&t(this.collator)}outputDefined(){return!0}serialize(){const e=[t];return this.eachChild((t=>{e.push(t.serialize())})),e}}}const AM=NM("==",(function(t,e,n){return e===n}),TM),kM=NM("!=",(function(t,e,n){return e!==n}),(function(t,e,n,i){return!TM(0,e,n,i)})),LM=NM("<",(function(t,e,n){return e<n}),(function(t,e,n,i){return i.compare(e,n)<0})),OM=NM(">",(function(t,e,n){return e>n}),(function(t,e,n,i){return i.compare(e,n)>0})),DM=NM("<=",(function(t,e,n){return e<=n}),(function(t,e,n,i){return i.compare(e,n)<=0})),FM=NM(">=",(function(t,e,n){return e>=n}),(function(t,e,n,i){return i.compare(e,n)>=0}));class zM{constructor(t,e,n,i,r,s){this.type=CI,this.number=t,this.locale=e,this.currency=n,this.unit=i,this.minFractionDigits=r,this.maxFractionDigits=s}static parse(t,e){if(3!==t.length)return e.error("Expected two arguments.");const n=e.parse(t[1],1,II);if(!n)return null;const i=t[2];if("object"!=typeof i||Array.isArray(i))return e.error("NumberFormat options argument must be an object.");let r=null;if(i.locale&&(r=e.parse(i.locale,1,CI),!r))return null;let s=null;if(i.currency&&(s=e.parse(i.currency,1,CI),!s))return null;let o=null;if(i.unit&&(o=e.parse(i.unit,1,CI),!o))return null;let a=null;if(i["min-fraction-digits"]&&(a=e.parse(i["min-fraction-digits"],1,II),!a))return null;let l=null;return i["max-fraction-digits"]&&(l=e.parse(i["max-fraction-digits"],1,II),!l)?null:new zM(n,r,s,o,a,l)}evaluate(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(t):void 0,unit:this.unit?this.unit.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))}eachChild(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.unit&&t(this.unit),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const t={};return this.locale&&(t.locale=this.locale.serialize()),this.currency&&(t.currency=this.currency.serialize()),this.unit&&(t.unit=this.unit.serialize()),this.minFractionDigits&&(t["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(t["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),t]}}class GM{constructor(t){this.type=II,this.input=t}static parse(t,e){if(2!==t.length)return e.error(`Expected 1 argument, but found ${t.length-1} instead.`);const n=e.parse(t[1],1);return n?"array"!==n.type.kind&&"string"!==n.type.kind&&"value"!==n.type.kind?e.error(`Expected argument of type string or array, but found ${OI(n.type)} instead.`):new GM(n):null}evaluate(t){const e=this.input.evaluate(t);if("string"==typeof e)return e.length;if(Array.isArray(e))return e.length;throw new ZI(`Expected value to be of type string or array, but found ${OI(jI(e))} instead.`)}eachChild(t){t(this.input)}outputDefined(){return!1}serialize(){const t=["length"];return this.eachChild((e=>{t.push(e.serialize())})),t}}const BM={"==":AM,"!=":kM,">":OM,"<":LM,">=":FM,"<=":DM,array:QI,at:vM,boolean:QI,case:CM,coalesce:gM,collator:hC,format:tC,image:eC,in:xM,"index-of":bM,interpolate:fM,"interpolate-hcl":fM,"interpolate-lab":fM,length:GM,let:mM,literal:$I,match:SM,number:QI,"number-format":zM,object:QI,slice:RM,step:GC,string:QI,"to-boolean":rC,"to-color":rC,"to-number":rC,"to-string":rC,var:kC,within:PC};function UM(t,[e,n,i,r]){e=e.evaluate(t),n=n.evaluate(t),i=i.evaluate(t);const s=r?r.evaluate(t):1,o=YI(e,n,i,s);if(o)throw new ZI(o);return new wI(e/255*s,n/255*s,i/255*s,s)}function qM(t,e){return t in e}function VM(t,e){const n=e[t];return void 0===n?null:n}function YM(t){return{type:t}}function XM(t){let e=t.getSource(),n=[];return e.forEachFeature((t=>{n.push(t)})),(new gS).writeFeaturesObject(n)}function jM(t,e,n){let i=t.getSource(),r=new kE,s=[];i.forEachFeature((t=>{let i=t.clone();i.getGeometry().transform(e,n),s.push(i)}));let o=new WE({features:s});return r.setSource(o),r}function WM(t){return _e(t,{projection:"EPSG:4326"})}function HM(t){return we(t,{projection:"EPSG:4326"})}function $M(t,e){let n=t.getSource(),i=0;return"LineString"===e?n.forEachFeature((t=>{i+=HM(t.getGeometry())})):"Polygon"===e&&n.forEachFeature((t=>{i+=WM(t.getGeometry())})),i}function ZM(t){let e=XM(t);return(0,pS.area)(e)}function KM(t,e){let n=0,i=t.data;for(let t=0;t<i.length;t+=4)255===i[t]&&255===i[t+3]&&n++;return n*e}function JM(t){let e=0;return t.getSource().forEachFeature((t=>{e++})),e}function QM(t,e,n){let i=KM(t,n),r=KM(e,n),s=function(t,e,n){let i=0,r=t.data,s=e.data;for(let t=0;t<r.length;t+=4)255===r[t]&&255===r[t+3]&&255===s[t]&&255===s[t+3]&&i++;return i*n}(t,e,n),o=s/(i+r-s);console.log(o,"Pixel based Jaccard Index")}lC.register(BM,{error:[{kind:"error"},[CI],(t,[e])=>{throw new ZI(e.evaluate(t))}],typeof:[CI,[TI],(t,[e])=>OI(jI(e.evaluate(t)))],"to-rgba":[LI(II,4),[RI],(t,[e])=>e.evaluate(t).toArray()],rgb:[RI,[II,II,II],UM],rgba:[RI,[II,II,II,II],UM],has:{type:MI,overloads:[[[CI],(t,[e])=>qM(e.evaluate(t),t.properties())],[[CI,PI],(t,[e,n])=>qM(e.evaluate(t),n.evaluate(t))]]},get:{type:TI,overloads:[[[CI],(t,[e])=>VM(e.evaluate(t),t.properties())],[[CI,PI],(t,[e,n])=>VM(e.evaluate(t),n.evaluate(t))]]},"feature-state":[TI,[CI],(t,[e])=>VM(e.evaluate(t),t.featureState||{})],properties:[PI,[],t=>t.properties()],"geometry-type":[CI,[],t=>t.geometryType()],id:[TI,[],t=>t.id()],zoom:[II,[],t=>t.globals.zoom],pitch:[II,[],t=>t.globals.pitch||0],"distance-from-center":[II,[],t=>t.distanceFromCenter()],"heatmap-density":[II,[],t=>t.globals.heatmapDensity||0],"line-progress":[II,[],t=>t.globals.lineProgress||0],"sky-radial-progress":[II,[],t=>t.globals.skyRadialProgress||0],accumulated:[TI,[],t=>void 0===t.globals.accumulated?null:t.globals.accumulated],"+":[II,YM(II),(t,e)=>{let n=0;for(const i of e)n+=i.evaluate(t);return n}],"*":[II,YM(II),(t,e)=>{let n=1;for(const i of e)n*=i.evaluate(t);return n}],"-":{type:II,overloads:[[[II,II],(t,[e,n])=>e.evaluate(t)-n.evaluate(t)],[[II],(t,[e])=>-e.evaluate(t)]]},"/":[II,[II,II],(t,[e,n])=>e.evaluate(t)/n.evaluate(t)],"%":[II,[II,II],(t,[e,n])=>e.evaluate(t)%n.evaluate(t)],ln2:[II,[],()=>Math.LN2],pi:[II,[],()=>Math.PI],e:[II,[],()=>Math.E],"^":[II,[II,II],(t,[e,n])=>Math.pow(e.evaluate(t),n.evaluate(t))],sqrt:[II,[II],(t,[e])=>Math.sqrt(e.evaluate(t))],log10:[II,[II],(t,[e])=>Math.log(e.evaluate(t))/Math.LN10],ln:[II,[II],(t,[e])=>Math.log(e.evaluate(t))],log2:[II,[II],(t,[e])=>Math.log(e.evaluate(t))/Math.LN2],sin:[II,[II],(t,[e])=>Math.sin(e.evaluate(t))],cos:[II,[II],(t,[e])=>Math.cos(e.evaluate(t))],tan:[II,[II],(t,[e])=>Math.tan(e.evaluate(t))],asin:[II,[II],(t,[e])=>Math.asin(e.evaluate(t))],acos:[II,[II],(t,[e])=>Math.acos(e.evaluate(t))],atan:[II,[II],(t,[e])=>Math.atan(e.evaluate(t))],min:[II,YM(II),(t,e)=>Math.min(...e.map((e=>e.evaluate(t))))],max:[II,YM(II),(t,e)=>Math.max(...e.map((e=>e.evaluate(t))))],abs:[II,[II],(t,[e])=>Math.abs(e.evaluate(t))],round:[II,[II],(t,[e])=>{const n=e.evaluate(t);return n<0?-Math.round(-n):Math.round(n)}],floor:[II,[II],(t,[e])=>Math.floor(e.evaluate(t))],ceil:[II,[II],(t,[e])=>Math.ceil(e.evaluate(t))],"filter-==":[MI,[CI,TI],(t,[e,n])=>t.properties()[e.value]===n.value],"filter-id-==":[MI,[TI],(t,[e])=>t.id()===e.value],"filter-type-==":[MI,[CI],(t,[e])=>t.geometryType()===e.value],"filter-<":[MI,[CI,TI],(t,[e,n])=>{const i=t.properties()[e.value],r=n.value;return typeof i==typeof r&&i<r}],"filter-id-<":[MI,[TI],(t,[e])=>{const n=t.id(),i=e.value;return typeof n==typeof i&&n<i}],"filter->":[MI,[CI,TI],(t,[e,n])=>{const i=t.properties()[e.value],r=n.value;return typeof i==typeof r&&i>r}],"filter-id->":[MI,[TI],(t,[e])=>{const n=t.id(),i=e.value;return typeof n==typeof i&&n>i}],"filter-<=":[MI,[CI,TI],(t,[e,n])=>{const i=t.properties()[e.value],r=n.value;return typeof i==typeof r&&i<=r}],"filter-id-<=":[MI,[TI],(t,[e])=>{const n=t.id(),i=e.value;return typeof n==typeof i&&n<=i}],"filter->=":[MI,[CI,TI],(t,[e,n])=>{const i=t.properties()[e.value],r=n.value;return typeof i==typeof r&&i>=r}],"filter-id->=":[MI,[TI],(t,[e])=>{const n=t.id(),i=e.value;return typeof n==typeof i&&n>=i}],"filter-has":[MI,[TI],(t,[e])=>e.value in t.properties()],"filter-has-id":[MI,[],t=>null!==t.id()&&void 0!==t.id()],"filter-type-in":[MI,[LI(CI)],(t,[e])=>e.value.indexOf(t.geometryType())>=0],"filter-id-in":[MI,[LI(TI)],(t,[e])=>e.value.indexOf(t.id())>=0],"filter-in-small":[MI,[CI,LI(TI)],(t,[e,n])=>n.value.indexOf(t.properties()[e.value])>=0],"filter-in-large":[MI,[CI,LI(TI)],(t,[e,n])=>function(t,e,n,i){for(;n<=i;){const r=n+i>>1;if(e[r]===t)return!0;e[r]>t?i=r-1:n=r+1}return!1}(t.properties()[e.value],n.value,0,n.value.length-1)],all:{type:MI,overloads:[[[MI,MI],(t,[e,n])=>e.evaluate(t)&&n.evaluate(t)],[YM(MI),(t,e)=>{for(const n of e)if(!n.evaluate(t))return!1;return!0}]]},any:{type:MI,overloads:[[[MI,MI],(t,[e,n])=>e.evaluate(t)||n.evaluate(t)],[YM(MI),(t,e)=>{for(const n of e)if(n.evaluate(t))return!0;return!1}]]},"!":[MI,[MI],(t,[e])=>!e.evaluate(t)],"is-supported-script":[MI,[CI],(t,[e])=>{const n=t.globals&&t.globals.isSupportedScript;return!n||n(e.evaluate(t))}],upcase:[CI,[CI],(t,[e])=>e.evaluate(t).toUpperCase()],downcase:[CI,[CI],(t,[e])=>e.evaluate(t).toLowerCase()],concat:[CI,YM(TI),(t,e)=>e.map((e=>WI(e.evaluate(t)))).join("")],"resolved-locale":[CI,[NI],(t,[e])=>e.evaluate(t).resolvedLocale()]}),new Set(["in","==","!=",">",">=","<","<=","to-boolean"]),function(){const t=[];for(let e=78271.51696402048;t.length<=24;e/=2)t.push(e)}(),Array(256).join("");var tR=__webpack_require__(148),eR=__webpack_require__.n(tR);function nR(t,e){let n=function(t){let e=0,n=new Uint8ClampedArray(36e4),i=new ImageData(n,300,300);const r=new ImageData(300,300);eR()(t.data,i.data,r.data,300,300,{threshold:0,includeAA:!1,aaColor:[255,0,0],diffColor:[0,0,0]});for(let n=0;n<t.data.length;n+=4)255===r.data[n]&&0===r.data[n+1]&&0===r.data[n+2]&&255===r.data[n+3]&&(e++,t.data[n]=0,t.data[n+1]=0,t.data[n+2]=0,t.data[n+3]=255);return console.log("no of anti-aliased pixels: ",e),t}(t),i=new ImageData(n.data.slice(),300,300),r=[];for(let t=0;t<n.data.length;t+=4)if(0!==n.data[t]||0!==n.data[t+1]||0!==n.data[t+2]||255!==n.data[t+3]){let e=[n.data[t],n.data[t+1],n.data[t+2]],i=[n.data[t],n.data[t+1],n.data[t+2]],s=D_(n,e,10),o=s[0],a=s[1];if(a>=100){let t={};t[i.toString()]=[o.data,a],r.push(t)}for(let t=0;t<o.data.length;t+=4)255===o.data[t]&&0===o.data[t+1]&&0===o.data[t+2]&&255===o.data[t+3]&&(n.data[t]=0,n.data[t+1]=0,n.data[t+2]=0,n.data[t+3]=255)}return console.log(r,"class"),[r,i]}const iR=class extends er{constructor(t,e,n,i,r){super(t,e,n,void 0!==r?fi:gi),this.loader_=void 0!==r?r:null,this.canvas_=i,this.error_=null}getError(){return this.error_}handleLoad_(t){t?(this.error_=t,this.state=pi):this.state=gi,this.changed()}load(){this.state==fi&&(this.state=di,this.changed(),this.loader_(this.handleLoad_.bind(this)))}getImage(){return this.canvas_}},rR=class extends ui{constructor(t){super(t=t||{})}},sR=class extends va{constructor(t){super(t),this.image_=null}getImage(){return this.image_?this.image_.getImage():null}prepareFrame(t){const e=t.layerStatesArray[t.layerIndex],n=t.pixelRatio,i=t.viewState,r=i.resolution,s=this.getLayer().getSource(),o=t.viewHints;let a=t.extent;if(void 0!==e.extent&&(a=se(a,Ye(e.extent,i.projection))),!o[0]&&!o[1]&&!ue(a))if(s){const t=i.projection,e=s.getImage(a,r,n,t);e&&(this.loadImage(e)?this.image_=e:e.getState()===mi&&(this.image_=null))}else this.image_=null;return!!this.image_}getData(t){const e=this.frameState;if(!e)return null;const n=this.getLayer(),i=an(e.pixelToCoordinateTransform,t.slice()),r=n.getExtent();if(r&&!Ft(r,i))return null;const s=this.image_.getExtent(),o=this.image_.getImage(),a=le(s),l=Math.floor(o.width*((i[0]-s[0])/a));if(l<0||l>=o.width)return null;const h=re(s),u=Math.floor(o.height*((s[3]-i[1])/h));return u<0||u>=o.height?null:this.getImageData(o,l,u)}renderFrame(t,e){const n=this.image_,i=n.getExtent(),r=n.getResolution(),[s,o]=Array.isArray(r)?r:[r,r],a=n.getPixelRatio(),l=t.layerStatesArray[t.layerIndex],h=t.pixelRatio,u=t.viewState,c=u.center,f=u.resolution,d=h*s/(f*a),g=h*o/(f*a),p=t.extent,m=u.resolution,y=u.rotation,v=Math.round(le(p)/m*h),w=Math.round(re(p)/m*h);ln(this.pixelTransform,t.size[0]/2,t.size[1]/2,1/h,1/h,y,-v/2,-w/2),hn(this.inversePixelTransform,this.pixelTransform);const x=cn(this.pixelTransform);this.useContainer(e,x,this.getBackground(t));const _=this.getRenderContext(t),b=this.context.canvas;b.width!=v||b.height!=w?(b.width=v,b.height=w):this.containerReused||_.clearRect(0,0,v,w);let E=!1,S=!0;if(l.extent){const e=Ye(l.extent,u.projection);S=he(e,t.extent),E=S&&!zt(e,t.extent),E&&this.clipUnrotated(_,t,e)}const I=n.getImage(),C=ln(this.tempTransform,v/2,w/2,d,g,0,a*(i[0]-c[0])/s,a*(c[1]-i[3])/o);this.renderedResolution=o*h/a;const M=I.width*C[0],R=I.height*C[3];if(this.getLayer().getSource().getInterpolate()||(_.imageSmoothingEnabled=!1),this.preRender(_,t),S&&M>=.5&&R>=.5){const t=C[4],e=C[5],n=l.opacity;1!==n&&(_.save(),_.globalAlpha=n),_.drawImage(I,0,0,+I.width,+I.height,t,e,M,R),1!==n&&_.restore()}return this.postRender(this.context,t),E&&_.restore(),_.imageSmoothingEnabled=!0,x!==b.style.transform&&(b.style.transform=x),this.container}},oR=class extends rR{constructor(t){super(t)}createRenderer(){return new sR(this)}getData(t){return super.getData(t)}};function aR(t){return Array.isArray(t)?Math.min(...t):t}const lR=class extends er{constructor(t,e,n,i,r,s,o){let a=t.getExtent();a&&t.canWrapX()&&(a=a.slice(),a[0]=-1/0,a[2]=1/0);let l=e.getExtent();l&&e.canWrapX()&&(l=l.slice(),l[0]=-1/0,l[2]=1/0);const h=l?se(n,l):n,u=Ca(t,e,te(h),i),c=new _a(t,e,h,a,.5*u,i),f=c.calculateSourceExtent(),d=ue(f)?null:s(f,u,r),g=d?fi:mi,p=d?d.getPixelRatio():1;super(n,i,p,g),this.targetProj_=e,this.maxSourceExtent_=a,this.triangulation_=c,this.targetResolution_=i,this.targetExtent_=n,this.sourceImage_=d,this.sourcePixelRatio_=p,this.interpolate_=o,this.canvas_=null,this.sourceListenerKey_=null}disposeInternal(){this.state==di&&this.unlistenSource_(),super.disposeInternal()}getImage(){return this.canvas_}getProjection(){return this.targetProj_}reproject_(){const t=this.sourceImage_.getState();if(t==gi){const t=le(this.targetExtent_)/this.targetResolution_,e=re(this.targetExtent_)/this.targetResolution_;this.canvas_=Ma(t,e,this.sourcePixelRatio_,aR(this.sourceImage_.getResolution()),this.maxSourceExtent_,this.targetResolution_,this.targetExtent_,this.triangulation_,[{extent:this.sourceImage_.getExtent(),image:this.sourceImage_.getImage()}],0,void 0,this.interpolate_,!0)}this.state=t,this.changed()}load(){if(this.state==fi){this.state=di,this.changed();const t=this.sourceImage_.getState();t==gi||t==pi?this.reproject_():(this.sourceListenerKey_=M(this.sourceImage_,x,(function(t){const e=this.sourceImage_.getState();e!=gi&&e!=pi||(this.unlistenSource_(),this.reproject_())}),this),this.sourceImage_.load())}}unlistenSource_(){P(this.sourceListenerKey_),this.sourceListenerKey_=null}};class hR extends r{constructor(t,e){super(t),this.image=e}}const uR=class extends $_{constructor(t){super({attributions:t.attributions,projection:t.projection,state:t.state,interpolate:void 0===t.interpolate||t.interpolate}),this.on,this.once,this.un,this.loader=t.loader||null,this.resolutions_=void 0!==t.resolutions?t.resolutions:null,this.reprojectedImage_=null,this.reprojectedRevision_=0,this.image=null,this.wantedExtent_,this.wantedResolution_,this.static_=!!t.loader&&0===t.loader.length,this.wantedProjection_=null}getResolutions(){return this.resolutions_}setResolutions(t){this.resolutions_=t}findNearestResolution(t){const e=this.getResolutions();return e&&(t=e[l(e,t,0)]),t}getImage(t,e,n,i){const r=this.getProjection();if(!r||!i||Le(r,i))return r&&(i=r),this.getImageInternal(t,e,n,i);if(this.reprojectedImage_){if(this.reprojectedRevision_==this.getRevision()&&Le(this.reprojectedImage_.getProjection(),i)&&this.reprojectedImage_.getResolution()==e&&Xt(this.reprojectedImage_.getExtent(),t))return this.reprojectedImage_;this.reprojectedImage_.dispose(),this.reprojectedImage_=null}return this.reprojectedImage_=new lR(r,i,t,e,n,((t,e,n)=>this.getImageInternal(t,e,n,r)),this.getInterpolate()),this.reprojectedRevision_=this.getRevision(),this.reprojectedImage_}getImageInternal(t,e,n,i){if(this.loader){const r=function(t,e,n,i){const r=e/n,s=te(t),o=at(le(t)/r,4),a=at(re(t)/r,4);return ne(s,r,0,[o+2*at(0*o/2,4),a+2*at(0*a/2,4)])}(t,e,n),s=this.findNearestResolution(e);if(this.image&&(this.static_||this.wantedProjection_===i&&(this.wantedExtent_&&zt(this.wantedExtent_,r)||zt(this.image.getExtent(),r))&&(this.wantedResolution_&&aR(this.wantedResolution_)===s||aR(this.image.getResolution())===s)))return this.image;this.wantedProjection_=i,this.wantedExtent_=r,this.wantedResolution_=s,this.image=new er(r,s,n,this.loader),this.image.addEventListener(x,this.handleImageChange.bind(this))}return this.image}handleImageChange(t){const e=t.target;let n;switch(e.getState()){case di:this.loading=!0,n="imageloadstart";break;case gi:this.loading=!1,n="imageloadend";break;case pi:this.loading=!1,n="imageloaderror";break;default:return}this.hasListener(n)&&this.dispatchEvent(new hR(n,e))}};let cR,fR=!0;try{new ImageData(10,10)}catch(t){fR=!1}function dR(t){let e=!0;try{new ImageData(10,10)}catch(t){e=!1}function n(t,n,i){return e?new ImageData(t,n,i):{data:t,width:n,height:i}}return function(e){const i=e.buffers,r=e.meta,s=e.imageOps,o=e.width,a=e.height,l=i.length,h=i[0].byteLength;if(s){const e=new Array(l);for(let t=0;t<l;++t)e[t]=n(new Uint8ClampedArray(i[t]),o,a);return t(e,r).data.buffer}const u=new Uint8ClampedArray(h),c=new Array(l),f=new Array(l);for(let t=0;t<l;++t)c[t]=new Uint8ClampedArray(i[t]),f[t]=[0,0,0,0];for(let e=0;e<h;e+=4){for(let t=0;t<l;++t){const n=c[t];f[t][0]=n[e],f[t][1]=n[e+1],f[t][2]=n[e+2],f[t][3]=n[e+3]}const n=t(f,r);u[e]=n[0],u[e+1]=n[1],u[e+2]=n[2],u[e+3]=n[3]}return u.buffer}}function gR(t,e){const n=Object.keys(t.lib||{}).map((function(e){return"const "+e+" = "+t.lib[e].toString()+";"})).concat(["const __minion__ = ("+dR.toString()+")(",t.operation.toString(),");",'self.addEventListener("message", function(event) {',"  const buffer = __minion__(event.data);","  self.postMessage({buffer: buffer, meta: event.data.meta}, [buffer]);","});"]),i=new Worker("undefined"==typeof Blob?"data:text/javascript;base64,"+Buffer.from(n.join("\n"),"binary").toString("base64"):URL.createObjectURL(new Blob(n,{type:"text/javascript"})));return i.addEventListener("message",e),i}class pR extends o{constructor(t){let e;super(),this._imageOps=!!t.imageOps,e=0===t.threads?0:this._imageOps?1:t.threads||1;const n=new Array(e);if(e)for(let i=0;i<e;++i)n[i]=gR(t,this._onWorkerMessage.bind(this,i));else n[0]=function(t,e){const n=dR(t.operation);let i=!1;return{postMessage:function(t){setTimeout((function(){i||e({data:{buffer:n(t),meta:t.meta}})}),0)},terminate:function(){i=!0}}}(t,this._onWorkerMessage.bind(this,0));this._workers=n,this._queue=[],this._maxQueueLength=t.queue||1/0,this._running=0,this._dataLookup={},this._job=null}process(t,e,n){this._enqueue({inputs:t,meta:e,callback:n}),this._dispatch()}_enqueue(t){for(this._queue.push(t);this._queue.length>this._maxQueueLength;)this._queue.shift().callback(null,null)}_dispatch(){if(this._running||0===this._queue.length)return;const t=this._queue.shift();this._job=t;const e=t.inputs[0].width,n=t.inputs[0].height,i=t.inputs.map((function(t){return t.data.buffer})),r=this._workers.length;if(this._running=r,1===r)return void this._workers[0].postMessage({buffers:i,meta:t.meta,imageOps:this._imageOps,width:e,height:n},i);const s=t.inputs[0].data.length,o=4*Math.ceil(s/4/r);for(let s=0;s<r;++s){const r=s*o,a=[];for(let t=0,e=i.length;t<e;++t)a.push(i[t].slice(r,r+o));this._workers[s].postMessage({buffers:a,meta:t.meta,imageOps:this._imageOps,width:e,height:n},a)}}_onWorkerMessage(t,e){this.disposed||(this._dataLookup[t]=e.data,--this._running,0===this._running&&this._resolveJob())}_resolveJob(){const t=this._job,e=this._workers.length;let n,i;if(1===e)n=new Uint8ClampedArray(this._dataLookup[0].buffer),i=this._dataLookup[0].meta;else{const r=t.inputs[0].data.length;n=new Uint8ClampedArray(r),i=new Array(e);const s=4*Math.ceil(r/4/e);for(let t=0;t<e;++t){const e=this._dataLookup[t].buffer,r=t*s;n.set(new Uint8ClampedArray(e),r),i[t]=this._dataLookup[t].meta}}this._job=null,this._dataLookup={},t.callback(null,function(t,e,n){if(fR)return new ImageData(t,e,n);cR||(cR=document.createElement("canvas").getContext("2d"));const i=cR.createImageData(e,n);return i.data.set(t),i}(n,t.inputs[0].width,t.inputs[0].height),i),this._dispatch()}disposeInternal(){for(let t=0;t<this._workers.length;++t)this._workers[t].terminate();this._workers.length=0}}class mR extends r{constructor(t,e,n){super(t),this.extent=e.extent,this.resolution=e.viewState.resolution/e.pixelRatio,this.data=n}}class yR extends uR{constructor(t){super({projection:null}),this.on,this.once,this.un,this.processor_=null,this.operationType_=void 0!==t.operationType?t.operationType:"pixel",this.threads_=void 0!==t.threads?t.threads:1,this.layers_=function(t){const e=t.length,n=new Array(e);for(let i=0;i<e;++i)n[i]=xR(t[i]);return n}(t.sources);const e=this.changed.bind(this);for(let t=0,n=this.layers_.length;t<n;++t)this.layers_[t].addEventListener(x,e);var n;this.useResolutions_=null!==t.resolutions,this.tileQueue_=new Co((function(){return 1}),this.processSources_.bind(this)),this.requestedFrameState_,this.renderedImageCanvas_=null,this.renderedRevision_,this.frameState_={animate:!1,coordinateToPixelTransform:[1,0,0,1,0,0],declutter:null,extent:null,index:0,layerIndex:0,layerStatesArray:(n=this.layers_,n.map((function(t){return t.getLayerState()}))),pixelRatio:1,pixelToCoordinateTransform:[1,0,0,1,0,0],postRenderFunctions:[],size:[0,0],tileQueue:this.tileQueue_,time:Date.now(),usedTiles:{},viewState:{rotation:0},viewHints:[],wantedTiles:{},mapId:L(this),renderTargets:{}},this.setAttributions((function(e){const n=[];for(let i=0,r=t.sources.length;i<r;++i){const r=t.sources[i],s=r instanceof $_?r:r.getSource();if(!s)continue;const o=s.getAttributions();if("function"==typeof o){const t=o(e);n.push.apply(n,t)}}return 0!==n.length?n:null})),void 0!==t.operation&&this.setOperation(t.operation,t.lib)}setOperation(t,e){this.processor_&&this.processor_.dispose(),this.processor_=new pR({operation:t,imageOps:"image"===this.operationType_,queue:1,lib:e,threads:this.threads_}),this.changed()}updateFrameState_(t,e,n){const i=Object.assign({},this.frameState_);i.viewState=Object.assign({},i.viewState);const r=te(t);i.size[0]=Math.ceil(le(t)/e),i.size[1]=Math.ceil(re(t)/e),i.extent=[r[0]-i.size[0]*e/2,r[1]-i.size[1]*e/2,r[0]+i.size[0]*e/2,r[1]+i.size[1]*e/2],i.time=Date.now();const s=i.viewState;return s.center=r,s.projection=n,s.resolution=e,i}allSourcesReady_(){let t,e=!0;for(let n=0,i=this.layers_.length;n<i;++n)if(t=this.layers_[n].getSource(),!t||"ready"!==t.getState()){e=!1;break}return e}getImage(t,e,n,i){if(!this.allSourcesReady_())return null;this.tileQueue_.loadMoreTiles(16,16),e=this.findNearestResolution(e);const r=this.updateFrameState_(t,e,i);if(this.requestedFrameState_=r,this.renderedImageCanvas_){const t=this.renderedImageCanvas_.getResolution(),n=this.renderedImageCanvas_.getExtent();e===t&&Xt(r.extent,n)||(this.renderedImageCanvas_=null)}return this.renderedImageCanvas_&&this.getRevision()===this.renderedRevision_||this.processSources_(),r.animate&&requestAnimationFrame(this.changed.bind(this)),this.renderedImageCanvas_}processSources_(){const t=this.requestedFrameState_,e=this.layers_.length,n=new Array(e);for(let i=0;i<e;++i){t.layerIndex=i,t.renderTargets={};const e=wR(this.layers_[i],t);if(!e)return;n[i]=e}const i={};this.dispatchEvent(new mR("beforeoperations",t,i)),this.processor_.process(n,i,this.onWorkerComplete_.bind(this,t))}onWorkerComplete_(t,e,n,i){if(e||!n)return;const r=t.extent,s=t.viewState.resolution;if(s!==this.requestedFrameState_.viewState.resolution||!Xt(r,this.requestedFrameState_.extent))return;let o;this.renderedImageCanvas_?o=this.renderedImageCanvas_.getImage().getContext("2d"):(o=$i(Math.round(le(r)/s),Math.round(re(r)/s)),this.renderedImageCanvas_=new iR(r,s,1,o.canvas)),o.putImageData(n,0,0),t.animate?requestAnimationFrame(this.changed.bind(this)):this.changed(),this.renderedRevision_=this.getRevision(),this.dispatchEvent(new mR("afteroperations",t,i))}getResolutions(t){if(!this.useResolutions_)return null;let e=super.getResolutions();if(!e)for(let n=0,i=this.layers_.length;n<i&&(e=this.layers_[n].getSource().getResolutions(t),!e);++n);return e}disposeInternal(){this.processor_&&this.processor_.dispose(),super.disposeInternal()}}yR.prototype.dispose;let vR=null;function wR(t,e){const n=t.getRenderer();if(!n)throw new Error("Unsupported layer type: "+t);if(!n.prepareFrame(e))return null;const i=e.size[0],r=e.size[1];if(0===i||0===r)return null;const s=n.renderFrame(e,null);let o;if(s instanceof HTMLCanvasElement)o=s;else{if(s&&(o=s.firstElementChild),!(o instanceof HTMLCanvasElement))throw new Error("Unsupported rendered element: "+o);if(o.width===i&&o.height===r)return o.getContext("2d").getImageData(0,0,i,r)}if(vR){const t=vR.canvas;t.width!==i||t.height!==r?vR=$i(i,r,void 0,{willReadFrequently:!0}):vR.clearRect(0,0,i,r)}else vR=$i(i,r,void 0,{willReadFrequently:!0});return vR.drawImage(o,0,0,i,r),vR.getImageData(0,0,i,r)}function xR(t){let e;return t instanceof $_?t instanceof ib?e=new ka({source:t}):t instanceof uR&&(e=new oR({source:t})):e=t,e}const _R=yR;function bR(t,e,n,i){let r,s=[],o=!0,a=[],l=[],h=0,u=[],c=[],f=(i[2]-i[0])/e,d=(i[3]-i[1])/n;for(let e=0;e<t.length;e+=4)s.push(t[e]),u.push(t[e+1]);for(let t=0;t<s.length;t++)if(255===s[t]){let n=t%e,i=Math.floor(t/e);t:for(let r=25;r<=31;r+=2){let o=[],a=r,l=0,h=CR(r);for(let t=0-Math.floor(a/2);t<=Math.floor(a/2);t++){let r,s;for(let l=0-Math.floor(a/2);l<=Math.floor(a/2);l++){r=n+t,s=i+l;let a=s*e+r;o.push(u[a])}}for(let t=0;t<r;t++)for(let e=0;e<r;e++)h[t][e]*o[t*r+e]==255&&(l+=1);if(l>=8){c.push(t),s[t]=0;break t}}}let g=new Uint8ClampedArray(t.length);for(let t=0,e=0;t<g.length;t+=4,e++)g[t]=s[e],g[t+1]=0,g[t+2]=0,g[t+3]=255;let p=new ImageData(g,e,n),m=0;for(let t=0;t<s.length;t++)255===s[t]&&(m+=1);function y(){let t;for(let n=0;n<s.length;n++)if(255===s[n]){t=[n%e,Math.floor(n/e)];break}return t}function v(t){a.push(t);for(let t=0;t<m&&void 0!==a[t];t++){let n=a[t][0],i=a[t][1],r=i*e+n,o=IR([n,i],3),l=[];for(let t=0;t<o.length;t++){let n,i=o[t][0],a=o[t][1];i>=0&&a>=0&&(n=a*e+i),255===s[n]&&(l.push([i,a]),s[r]=0)}for(let t=0;t<l.length;t++){let e=!1;for(let n=0;n<a.length;n++){if(l[t][0]===a[n][0]&&l[t][1]===a[n][1]){e=!0;break}e=!1}!1===e&&a.push(l[t])}}a.length>=10?(l.push(a),h+=1,a=[]):a=[]}for(;o;){if(r=y(),void 0===r){o=!1;break}v(r)}let w=function(t,e,n,i,r){let s={type:"FeatureCollection",name:"junctions",crs:{type:"name",properties:{name:"EPSG:3857"}},features:[]},o=new Array(t.length);for(let s in t){let a=t[s]%e,l=Math.floor(t[s]/e),h=n[0]+a*i,u=n[3]-l*r;o[s]={x:h,y:u}}let a=(0,Vb.b)().eps(10).minPts(1).distance("EUCLIDEAN").data(o),l=(a(),a.getClusters()),h=0;for(let t=0;t<l.length;t++){h++;let e=[l[t].x,l[t].y];s.features.push({type:"Feature",geometry:{type:"Point",coordinates:e},id:h})}return s}(c,e,i,f,d),x=function(t,e,n,i,r){let s=function(t){let e=[];for(let n=0;n<t.length;n++)SR(t[n])?e.push(t[n]):ER(t[n]).forEach((t=>{e.push(t)}));return e}(t),o={type:"FeatureCollection",name:"lines",crs:{type:"name",properties:{name:"EPSG:3857"}},features:[]},a=0;for(let t=0;t<s.length;t++){a++;let e=[];for(let o=0;o<s[t].length;o+=3){let a=s[t][o][0],l=s[t][o][1],h=[n[0]+a*i,n[3]-l*r];e.push(h)}o.features.push({type:"Feature",geometry:{type:"LineString",coordinates:e},id:a})}return o}(l,0,i,f,d);return[w,x,p]}function ER(t){let e,n=[];for(let i=0;i<t.length;i++){let r=t[i];if(e=[],0!=r){0===e.length&&(e.push(r),t[i]=0);for(let n=0;n<e.length;n++){let n=IR(e[e.length-1],3);for(let i=0;i<n.length;i++)for(let r=0;r<t.length;r++)n[i][0]===t[r][0]&&n[i][1]===t[r][1]&&(e.push(t[r]),t[r]=0)}n.push(e)}}return n}function SR(t){let e=!0;for(let n=1;n<t.length;n++)if(!Math.abs(Tf(t[n],t[n-1])<10)){e=!1;break}return e}function IR(t,e){let n=Math.floor(e/2),i=[];for(let e=t[0]-n;e<=t[0]+n;e++)for(let r=t[1]-n;r<=t[1]+n;r++)i.push([e,r]);return i}function CR(t){let e=t/2,n=[],i=Math.floor(e);for(let e=0;e<t;e++){let e=[];for(let n=0;n<t;n++)e.push(0);n.push(e)}for(let r=0;r<t;r++)for(let s=0;s<t;s++){let o,a=i-r,l=i-s,h=Math.sqrt(Math.pow(a,2)+Math.pow(l,2)),u=i-1;if(Math.sqrt(Math.pow(u,2)+Math.pow(u,2)),h<=e&&0===r|r===t-1)n[r][s]=1;else if(h<=e){n[r][s]=1,o=s,n[r][t-1-o]=1;break}}return n}const MR=function(t){if(!t)throw new Error("geojson is required");var e=[];return FS(t,(function(t){e.push(t)})),bS(e)};var RR=__webpack_require__(2676);function PR(t,e,n,i,r){var s=n[0],o=n[1],a=t[0],l=t[1],h=e[0],u=e[1],c=h-a,f=u-l,d=(n[0]-a)*f-(n[1]-l)*c;if(null!==r){if(Math.abs(d)>r)return!1}else if(0!==d)return!1;return i?"start"===i?Math.abs(c)>=Math.abs(f)?c>0?a<s&&s<=h:h<=s&&s<a:f>0?l<o&&o<=u:u<=o&&o<l:"end"===i?Math.abs(c)>=Math.abs(f)?c>0?a<=s&&s<h:h<s&&s<=a:f>0?l<=o&&o<u:u<o&&o<=l:"both"===i&&(Math.abs(c)>=Math.abs(f)?c>0?a<s&&s<h:h<s&&s<a:f>0?l<o&&o<u:u<o&&o<l):Math.abs(c)>=Math.abs(f)?c>0?a<=s&&s<=h:h<=s&&s<=a:f>0?l<=o&&o<=u:u<=o&&o<=l}const TR=function(t,e,n){void 0===n&&(n={});for(var i=MS(t),r=RS(e),s=0;s<r.length-1;s++){var o=!1;if(n.ignoreEndVertices&&(0===s&&(o="start"),s===r.length-2&&(o="end"),0===s&&s+1===r.length-1&&(o="both")),PR(r[s],r[s+1],i,o,void 0===n.epsilon?null:n.epsilon))return!0}return!1};function NR(t,e){void 0===e&&(e={});var n=PS(t);switch(e.properties||"Feature"!==t.type||(e.properties=t.properties),n.type){case"Polygon":return function(t,e){return void 0===e&&(e={}),AR(PS(t).coordinates,e.properties?e.properties:"Feature"===t.type?t.properties:{})}(n,e);case"MultiPolygon":return function(t,e){void 0===e&&(e={});var n=PS(t).coordinates,i=e.properties?e.properties:"Feature"===t.type?t.properties:{},r=[];return n.forEach((function(t){r.push(AR(t,i))})),bS(r)}(n,e);default:throw new Error("invalid poly")}}function AR(t,e){return t.length>1?function(t,e,n){return void 0===n&&(n={}),vS({type:"MultiLineString",coordinates:t},e,n)}(t,e):_S(t[0],e)}function kR(t,e){for(var n=0;n<t.coordinates.length-1;n++)if(OR(t.coordinates[n],t.coordinates[n+1],e.coordinates))return!0;return!1}function LR(t,e){for(var n=0,i=e.coordinates;n<i.length;n++)if($S(i[n],t))return!0;return US(e,NR(t)).features.length>0}function OR(t,e,n){var i=n[0]-t[0],r=n[1]-t[1],s=e[0]-t[0],o=e[1]-t[1];return 0==i*o-r*s&&(Math.abs(s)>=Math.abs(o)?s>0?t[0]<=n[0]&&n[0]<=e[0]:e[0]<=n[0]&&n[0]<=t[0]:o>0?t[1]<=n[1]&&n[1]<=e[1]:e[1]<=n[1]&&n[1]<=t[1])}__webpack_require__(251);const DR=function(t,e){var n=!0;return FS(t,(function(t){FS(e,(function(e){if(!1===n)return!1;n=function(t,e){switch(t.type){case"Point":switch(e.type){case"Point":return n=t.coordinates,i=e.coordinates,!(n[0]===i[0]&&n[1]===i[1]);case"LineString":return!kR(e,t);case"Polygon":return!$S(t,e)}break;case"LineString":switch(e.type){case"Point":return!kR(t,e);case"LineString":return!(US(t,e).features.length>0);case"Polygon":return!LR(e,t)}break;case"Polygon":switch(e.type){case"Point":return!$S(e,t);case"LineString":return!LR(t,e);case"Polygon":return!function(t,e){for(var n=0,i=t.coordinates[0];n<i.length;n++)if($S(i[n],e))return!0;for(var r=0,s=e.coordinates[0];r<s.length;r++)if($S(s[r],t))return!0;return US(NR(t),NR(e)).features.length>0}(e,t)}}var n,i;return!1}(t.geometry,e.geometry)}))})),n};function FR(t,e){var n=!1;return FS(t,(function(t){FS(e,(function(e){if(!0===n)return!0;n=!DR(t.geometry,e.geometry)}))})),n}function zR(t){var e=[1/0,1/0,-1/0,-1/0];return LS(t,(function(t){e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]<t[0]&&(e[2]=t[0]),e[3]<t[1]&&(e[3]=t[1])})),e}zR.default=zR;const GR=zR;function BR(t,e){var n=[],i=GS();return FS(e,(function(e){if(n.forEach((function(t,e){t.id=e})),n.length){var r=i.search(e);if(r.features.length){var s=qR(e,r);n=n.filter((function(t){return t.id!==s.id})),i.remove(s),OS(UR(s,e),(function(t){n.push(t),i.insert(t)}))}}else(n=UR(t,e).features).forEach((function(t){t.bbox||(t.bbox=function(t){var e=t[0],n=t[1],i=t[2],r=t[3];if(AS(t.slice(0,2),[i,n])>=AS(t.slice(0,2),[e,r])){var s=(n+r)/2;return[e,s-(i-e)/2,i,s+(i-e)/2]}var o=(e+i)/2;return[o-(r-n)/2,n,o+(r-n)/2,r]}(GR(t)))})),i.load(bS(n))})),bS(n)}function UR(t,e){var n=[],i=RS(t)[0],r=RS(t)[t.geometry.coordinates.length-1];if(VR(i,MS(e))||VR(r,MS(e)))return bS([t]);var s=GS(),o=zS(t);s.load(o);var a=s.search(e);if(!a.features.length)return bS([t]);var l,h,u=qR(e,a),c=(h=l=[i],OS(o,(function(t,i){var r,s,o,a;h=0===i&&void 0===l?t:(r=h,s=i,o=RS(t)[1],a=MS(e),s===u.id?(r.push(a),n.push(_S(r)),VR(a,o)?[a]:[a,o]):(r.push(o),r))})),h);return c.length>1&&n.push(_S(c)),bS(n)}function qR(t,e){if(!e.features.length)throw new Error("lines must contain features");if(1===e.features.length)return e.features[0];var n,i=1/0;return OS(e,(function(e){var r=qS(e,t).properties.dist;r<i&&(n=e,i=r)})),n}function VR(t,e){return t[0]===e[0]&&t[1]===e[1]}const YR=function(t,e){if(!t)throw new Error("line is required");if(!e)throw new Error("splitter is required");var n=TS(t),i=TS(e);if("LineString"!==n)throw new Error("line must be LineString");if("FeatureCollection"===i)throw new Error("splitter cannot be a FeatureCollection");if("GeometryCollection"===i)throw new Error("splitter cannot be a GeometryCollection");var r=function(t,e){void 0===e&&(e={});var n=e.precision,i=e.coordinates,r=e.mutate;if(n=null==n||isNaN(n)?6:n,i=null==i||isNaN(i)?3:i,!t)throw new Error("<geojson> is required");if("number"!=typeof n)throw new Error("<precision> must be a number");if("number"!=typeof i)throw new Error("<coordinates> must be a number");!1!==r&&void 0!==r||(t=JSON.parse(JSON.stringify(t)));var s=Math.pow(10,n);return LS(t,(function(t){!function(t,e,n){t.length>n&&t.splice(n,t.length);for(var i=0;i<t.length;i++)t[i]=Math.round(t[i]*e)/e}(t,s,i)})),t}(e,{precision:7});switch(i){case"Point":return UR(t,r);case"MultiPoint":return BR(t,r);case"LineString":case"MultiLineString":case"Polygon":case"MultiPolygon":return BR(t,US(t,r))}};function XR(t,e){return!(t[0]>e[0]||t[2]<e[2]||t[1]>e[1]||t[3]<e[3])}function jR(t,e){return t[0]===e[0]&&t[1]===e[1]}const WR=function(t,e){var n=PS(t),i=PS(e),r=n.type,s=i.type;switch(r){case"Point":switch(s){case"MultiPoint":return function(t,e){var n,i=!1;for(n=0;n<e.coordinates.length;n++)if(jR(e.coordinates[n],t.coordinates)){i=!0;break}return i}(n,i);case"LineString":return TR(n,i,{ignoreEndVertices:!0});case"Polygon":case"MultiPolygon":return $S(n,i,{ignoreBoundary:!0});default:throw new Error("feature2 "+s+" geometry not supported")}case"MultiPoint":switch(s){case"MultiPoint":return function(t,e){for(var n=0;n<t.coordinates.length;n++){for(var i=!1,r=0;r<e.coordinates.length;r++)jR(t.coordinates[n],e.coordinates[r])&&(i=!0);if(!i)return!1}return!0}(n,i);case"LineString":return function(t,e){for(var n=!1,i=0;i<t.coordinates.length;i++){if(!TR(t.coordinates[i],e))return!1;n||(n=TR(t.coordinates[i],e,{ignoreEndVertices:!0}))}return n}(n,i);case"Polygon":case"MultiPolygon":return function(t,e){for(var n=!0,i=!1,r=0;r<t.coordinates.length;r++){if(!(i=$S(t.coordinates[1],e))){n=!1;break}i=$S(t.coordinates[1],e,{ignoreBoundary:!0})}return n&&i}(n,i);default:throw new Error("feature2 "+s+" geometry not supported")}case"LineString":switch(s){case"LineString":return function(t,e){for(var n=0;n<t.coordinates.length;n++)if(!TR(t.coordinates[n],e))return!1;return!0}(n,i);case"Polygon":case"MultiPolygon":return function(t,e){var n,i;if(!XR(GR(e),GR(t)))return!1;for(var r=!1,s=0;s<t.coordinates.length-1;s++){if(!$S(t.coordinates[s],e))return!1;r||(r=$S(t.coordinates[s],e,{ignoreBoundary:!0})),r||(r=$S((n=t.coordinates[s],i=t.coordinates[s+1],[(n[0]+i[0])/2,(n[1]+i[1])/2]),e,{ignoreBoundary:!0}))}return r}(n,i);default:throw new Error("feature2 "+s+" geometry not supported")}case"Polygon":switch(s){case"Polygon":case"MultiPolygon":return function(t,e){var n=GR(t);if(!XR(GR(e),n))return!1;for(var i=0;i<t.coordinates[0].length;i++)if(!$S(t.coordinates[0][i],e))return!1;return!0}(n,i);default:throw new Error("feature2 "+s+" geometry not supported")}default:throw new Error("feature1 "+r+" geometry not supported")}};let HR;function $R(t,e,n,i){let r=(new gS).writeFeaturesObject(t),s=(0,pS.buffer)(r,n,"kilometers"),o=(new gS).writeFeaturesObject(e),a=function(t,e){if(!(n=e=e||{})||n.constructor!==Object)throw new Error("options is invalid");var n,i=e.propertyName;!function(t,e,n){if(!t)throw new Error("No featureCollection passed");if(!t||"FeatureCollection"!==t.type)throw new Error("Invalid input to "+n+", FeatureCollection required");for(var i=0,r=t.features;i<r.length;i++){var s=r[i];if(!s||"Feature"!==s.type||!s.geometry)throw new Error("Invalid input to "+n+", Feature with geometry required");if(!s.geometry||s.geometry.type!==e)throw new Error("Invalid input to "+n+": must be a "+e+", given "+s.geometry.type)}}(t,"Polygon","dissolve");var r=[];if(!e.propertyName)return MR(ES(RR.union.apply(null,t.features.map((function(t){return t.geometry.coordinates})))));var s={};OS(t,(function(t){Object.prototype.hasOwnProperty.call(s,t.properties[i])||(s[t.properties[i]]=[]),s[t.properties[i]].push(t)}));for(var o=Object.keys(s),a=0;a<o.length;a++){var l=ES(RR.union.apply(null,s[o[a]].map((function(t){return t.geometry.coordinates}))));l.properties[i]=o[a],r.push(l)}return MR(bS(r))}(s),l=a.features,h=o.features,u=[],c=[],f=[];for(let t=0;t<l.length;t++){let e=l[t].geometry.coordinates,n=(0,pS.polygon)(e);for(let t=0;t<h.length;t++){let e=h[t].geometry.coordinates,i=(0,pS.lineString)(e);if(WR(i,n)&&u.push(i),FR(i,n)){let t=YR(i,n);c.push(t),t.features.forEach((t=>{WR(t,n)&&(f.push(t),u.push(t))}))}}}let d=(0,pS.featureCollection)(u);const g=new WE({features:new gS({dataProjection:"EPSG:4326",featureProjection:"EPSG:4326"}).readFeatures(a)}),p=new kE;p.setSource(g);const m=new WE({features:new gS({dataProjection:"EPSG:4326",featureProjection:"EPSG:4326"}).readFeatures(d)}),y=new kE;y.setSource(m);let v=$M(y,"LineString"),w=$M(i,"LineString");return.005===n&&(HR=[p,y]),v/w*100}var ZR=__webpack_require__(556),KR=__webpack_require__.n(ZR);function JR(t,e){let n=0;for(let e=0;e<t.length;e++)1===t[e]&&(n+=1);return n*e}function QR(t,e,n){let i=0;for(let n=0;n<t.length;n++)t[n]+e[n]===2&&(i+=1);return i*=n,i}let tP=new class{constructor(){let t=new Eb;this.OSM_Standard=new fb,this.Bing_RoadsOnDemand=new db({key:t.apikeys.BingMapKey,imagerySet:"RoadOnDemand"}),this.ArcGIS_sample=new pb({url:`https://basemapstyles-api.arcgis.com/arcgis/rest/services/styles/v2/styles/arcgis/streets?token=${t.apikeys.ArcGISKey}`,crossOrigin:"Anonymous"}),this.EsriXYZ=new cb({attributions:'Tiles  <a href="https://services.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer">ArcGIS</a>',url:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer/tile/{z}/{y}/{x}",maxZoom:19,crossOrigin:"Anonymous"}),this.EsriMaps=new cb({url:"https://services.arcgisonline.com/arcgis/rest/services/World_Imagery/MapServer/MapServer/tile/{z}/{y}/{x}"}),this.googleMaps=new mb({key:t.apikeys.GoogleMapKey,scale:"scaleFactor2x",highDpi:!0}),this.ESA_WORLDCOVER2020=new yb({url:"https://services.terrascope.be/wmts/v2",layer:"WORLDCOVER_2020_MAP",matrixSet:"EPSG:3857",format:"image/png",projection:Ib,tileGrid:new Sb({origin:oe(Cb),resolutions:Rb,matrixIds:Pb}),wrapX:!0}),this.ESA_WORLDCOVER2021=new yb({url:"https://services.terrascope.be/wmts/v2",layer:"WORLDCOVER_2021_MAP",matrixSet:"EPSG:3857",format:"image/png",projection:Ib,tileGrid:new Sb({origin:oe(Cb),resolutions:Rb,matrixIds:Pb}),wrapX:!0}),this.BhuvanLULC1=new bb({url:"https://bhuvan-vec2.nrsc.gov.in/bhuvan/gwc/service/wms",params:{LAYERS:"lulc:UK_LULC50K_0506",TILED:!0,VERSION:"1.1.1",BBOX:"77.575,28.715,81.043,31.467",SRS:"EPSG:4326",WIDTH:256,HEIGHT:256,FORMAT:"image/png"},serverType:"geoserver",crossOrigin:"Anonymous"}),this.BhuvanLULC2=new bb({url:"https://bhuvan-vec2.nrsc.gov.in/bhuvan/gwc/service/wms",params:{LAYERS:"lulc:UK_LULC50K_1112",TILED:!0,VERSION:"1.1.1",BBOX:"77.575,28.715,81.043,31.467",SRS:"EPSG:4326",WIDTH:256,HEIGHT:256,FORMAT:"image/png"},serverType:"geoserver",crossOrigin:"Anonymous"})}};const eP=document.getElementById("imgCanvas1"),nP=document.getElementById("imgCanvas2"),iP=eP.getContext("2d",{willReadFrequently:!0}),rP=nP.getContext("2d",{willReadFrequently:!0});var sP=document.createElement("canvas"),oP=document.createElement("canvas");sP.getContext("2d"),oP.getContext("2d"),new R_,new R_;const aP=document.getElementById("processImgBtn"),lP=document.getElementById("vectorizeBtn"),hP=document.getElementById("compareBtn"),uP=document.getElementById("downloadVector"),cP=document.getElementById("imageCov"),fP=document.getElementById("mapGOF"),dP=document.getElementById("extentBox"),gP=document.getElementById("zoomLevel"),pP=document.getElementById("FeatureType"),mP=document.getElementById("SelectionType"),yP=document.getElementById("MapType1"),vP=document.getElementById("MapType2"),wP=document.getElementById("processOptions"),xP=document.getElementById("colorArea1"),_P=document.getElementById("colorArea2");let bP,EP,SP,IP,CP,MP,RP,PP,TP,NP,AP,kP,LP,OP,DP,FP,zP,GP=!1,BP=!1,UP=!1,qP=!1,VP=!1,YP=!1,XP="YIQ";function jP(t,e){var n=document.createElement("a");n.setAttribute("href","data:application/json;charset=utf-8, "+encodeURIComponent(e)),n.setAttribute("download",t),document.body.appendChild(n),n.click(),document.body.removeChild(n)}let WP={1:tP.OSM_Standard,2:tP.Bing_RoadsOnDemand,3:tP.EsriXYZ,4:tP.ArcGIS_sample,5:tP.googleMaps,6:tP.EsriMaps,7:tP.ESA_WORLDCOVER2020,8:tP.ESA_WORLDCOVER2021,9:tP.BhuvanLULC1,10:tP.BhuvanLULC2};!function(t,e){pP.addEventListener("change",(t=>{"1"===pP.value?Bb(wP):"2"===pP.value?(Bb(wP),function(t){Lb.append(Ob,Db,Fb),t.append(Lb)}(wP)):"3"===pP.value?(Bb(wP),function(t){let e=zb("ER_KER_SIZ_1",3,""),n=zb("ER_ITER_1",3,""),i=zb("WIN_MIN_SIZ_1",25,""),r=zb("WIN_MAX_SIZ_1",31,""),s=zb("ER_KER_SIZ_2",3,""),o=zb("ER_ITER_2",3,""),a=zb("WIN_MIN_SIZ_2",25,""),l=zb("WIN_MAX_SIZ_2",31,"");Lb.append(Ob,Db,e,n,i,r,Fb,s,o,a,l),t.append(Lb)}(wP)):"4"===pP.value&&(fP.disabled=!1)})),mP.addEventListener("change",(t=>{"1"===mP.value?XP="YIQ":"2"===mP.value&&(XP="RG")}));const n=new li({center:[8687373.06,3544749.53],zoom:13,constrainResolution:!0}),i=new _R({sources:[t],operation:function(t,e){console.log(t,"pixels")}});i.on("beforeoperations",(function(t){console.log(t.data,"eventdata")})),i.on("afteroperations",(function(t){console.log(t.data,"afterevent")})),LP=new ua({layers:[new ka({source:t})],view:n,target:"map1"}),OP=new ua({layers:[new ka({source:e})],view:n,target:"map2"}),dP.textContent="Extent: "+LP.getView().calculateExtent(LP.getSize()),gP.textContent="Zoom Level: "+LP.getView().getZoom(),LP.on("moveend",(t=>{kb(LP,eP,iP),!0===VP&&(bP=void 0,CP=void 0,VP=!1),DP=LP.getView().calculateExtent(LP.getSize()),FP=(DP[2]-DP[0])/eP.width,zP=(DP[3]-DP[1])/eP.height,dP.textContent="Extent: "+DP,gP.textContent="Zoom Level: "+LP.getView().getZoom()})),OP.on("moveend",(t=>{kb(OP,nP,rP),!0===YP&&(EP=void 0,MP=void 0,YP=!1)})),LP.on("click",(t=>{let e=iP.getImageData(0,0,eP.width,eP.height);if("YIQ"===XP)RP=D_(e,Pf(t.pixel,e.data,300),0)[0],console.log(Pf(t.pixel,e.data,300)),iP.putImageData(RP,0,0);else if("RG"===XP){let n=Ub(e,{delta:20,pixel:t.pixel});RP=new ImageData(n.data,300,300),iP.putImageData(RP,0,0)}GP=!0})),OP.on("click",(t=>{let e=rP.getImageData(0,0,nP.width,nP.height);if("YIQ"===XP)PP=D_(e,Pf(t.pixel,e.data,300),0)[0],rP.putImageData(PP,0,0);else if("RG"===XP){let n=Ub(e,{delta:20,pixel:t.pixel});PP=new ImageData(n.data,300,300),rP.putImageData(PP,0,0)}BP=!0}))}(WP[9],WP[10]),new class{constructor(t,e,n){this.mapWidth=t,this.mapHeight=e,this.mapExtent=n}get pixelWidth(){return(this.mapExtent[2]-this.mapExtent[0])/this.mapWidth}get pixelHeight(){return(this.mapExtent[3]-this.mapExtent[1])/this.mapHeight}get areaPerPixel(){return this.pixelHeight*this.pixelWidth}}(eP.width,eP.height,LP.getView().calculateExtent(LP.getSize())),yP.addEventListener("change",(t=>{})),vP.addEventListener("change",(t=>{})),aP.addEventListener("click",(t=>{if("1"===pP.value)alert("Choose a feature type from drop down");else if("2"===pP.value){if(!0===GP){let t=iP.getImageData(0,0,eP.width,eP.height);bP=Za(t,eP),UP=!0}if(!0===BP){let t=rP.getImageData(0,0,nP.width,nP.height);EP=Za(t,nP),qP=!0}QM(RP,PP,FP*zP);const{mssim:t}=KR()(RP,PP);console.log(`SSIM: ${t}`)}else if("3"===pP.value){if(!0===GP){let t=parseInt(sessionStorage.getItem("ER_KER_SIZ_1")),e=parseInt(sessionStorage.getItem("ER_ITER_1")),n=iP.getImageData(0,0,eP.width,eP.height);SP=Ja(n,t,e),UP=!0,iP.putImageData(SP,0,0)}if(!0===BP){let t=parseInt(sessionStorage.getItem("ER_KER_SIZ_2")),e=parseInt(sessionStorage.getItem("ER_ITER_2")),n=rP.getImageData(0,0,nP.width,nP.height);IP=Ja(n,t,e),qP=!0,rP.putImageData(IP,0,0)}QM(RP,PP,FP*zP);const{mssim:t}=KR()(RP,PP);console.log(`SSIM: ${t}`)}})),lP.addEventListener("click",(t=>{if("2"===pP.value){if(!0===UP){let t=LP.getView().calculateExtent(LP.getSize());CP=B_(bP,eP.width,eP.height,t),VP=!0,TP=hI(CP);let e=jM(TP,"EPSG:4326","EPSG:3857");LP.addLayer(e),CP=XM(TP),UP=!1}else alert("Process image from map1 before vectorizing");if(!0===qP){let t=OP.getView().calculateExtent(OP.getSize());MP=B_(EP,nP.width,nP.height,t),YP=!0,NP=hI(MP);let e=jM(NP,"EPSG:4326","EPSG:3857");OP.addLayer(e),MP=XM(NP),qP=!1}console.log("Feature count in reference map : ",JM(TP)),console.log("Feature count in comparison map : ",JM(NP)),console.log("Area Completeness: ",function(t,e){let n=$M(t,"Polygon"),i=$M(e,"Polygon"),r=i/n*100;return console.log("reference area: ",n,"m^2","\n","comparison area: ",i,"m^2"),r}(TP,NP)),function(t,e){let n=ZM(t),i=ZM(e),r=function(t,e){let n=t.getSource(),i=e.getSource(),r=[],s=[];n.forEachFeature((t=>{let e=t.clone().getGeometry().getCoordinates();r.push(e)})),i.forEachFeature((t=>{let e=t.clone().getGeometry().getCoordinates();s.push(e)}));let o=(0,pS.multiPolygon)(r),a=(0,pS.multiPolygon)(s),l=(0,pS.intersect)(o,a);return(0,pS.area)(l)}(t,e),s=r/(n+i-r);console.log(Math.abs(s).toFixed(2),"Geometry based Jaccard Index")}(TP,NP)}else if("3"===pP.value){if(!0===UP){let t=LP.getView().calculateExtent(LP.getSize()),e=bR(SP.data,300,300,t);CP=e[1],VP=!0;let n=hI(e[0]);AP=hI(CP);let i=jM(AP,"EPSG:4326","EPSG:3857");LP.addLayer(n),LP.addLayer(i),CP=XM(AP),UP=!1,Bb(wP)}else alert("Process image from map1 before vectorizing");if(!0===qP){let t=OP.getView().calculateExtent(OP.getSize()),e=bR(IP.data,300,300,t);MP=e[0],YP=!0;let n=hI(MP);kP=hI(e[1]);let i=jM(kP,"EPSG:4326","EPSG:3857");OP.addLayer(n),OP.addLayer(i),MP=XM(kP),qP=!1,Bb(wP)}else alert("Process image from map1 before vectorizing");console.log(function(t,e){let n=$M(t,"LineString"),i=$M(e,"LineString"),r=i/n*100;return console.log("reference length: ",n,"m","\n","comp length: ",i,"m"),r}(AP,kP),"lineCompleteness")}})),uP.addEventListener("click",(t=>{if(!0===VP){let t=JSON.stringify(CP),e=JSON.stringify(MP);jP("layer1.geojson",t),jP("layer2.geojson",e)}else alert("Generate vector file before downloading")})),cP.addEventListener("click",(t=>{if(!0===GP&&!0===GP){let t=iP.getImageData(0,0,eP.width,eP.height),e=rP.getImageData(0,0,nP.width,nP.height);Ka(t),Ka(e);let n=iP.getImageData(0,0,eP.width,eP.height),i=rP.getImageData(0,0,nP.width,nP.height);console.log(n,i),function(t,e){let n=Rf(t.data,!1),i=Rf(e.data,!1),r=new Array(n.length),s=new Array(i.length);for(let t=0;t<n.length;t++)n[t][0]&&n[t][1]&&255===n[t][2]?r[t]=255:r[t]=0;for(let t=0;t<i.length;t++)i[t][0]&&i[t][1]&&255===i[t][2]?s[t]=255:s[t]=0;let o=[r,s],a=o.length,l=new Array(a*a);for(let t=0;t<a;t++)for(let e=0;e<a;e++){let n=0,i=o[t],r=o[e],s=i.length,a=i.reduce(((t,e)=>t+e))/s,h=r.reduce(((t,e)=>t+e))/s;for(let t=0;t<s;t++)n+=(i[t]-a)*(r[t]-h)/s;l.push(n)}let h=Math.min(...l),u=Math.max(...l);console.log(h,u,l)}(n,i)}else alert("Select features from both maps")})),hP.addEventListener("click",(t=>{let e=function(t,e){let n=[],i=t.getSource(),r=e.getSource(),s=[],o=[];i.forEachFeature((t=>{s.push(t)})),r.forEachFeature((t=>{o.push(t)}));for(let t=1;t<=20;t++){let i=$R(s,o,.001*t,e);n.push({bufferWidth:t,percentageInBuffer:i})}return{layers:HR,data:n}}(AP,kP),n=e.layers,i=e.data;console.log(i);let r=jM(n[0],"EPSG:4326","EPSG:3857"),s=jM(n[1],"EPSG:4326","EPSG:3857");s.setStyle([new Xr({fill:new zr({color:"rgba(255,0,0,1.0)"}),stroke:new Br({})})]),LP.addLayer(r),LP.addLayer(s),Mf(i)})),fP.addEventListener("click",(t=>{let e=nR(iP.getImageData(0,0,eP.width,eP.height));iP.putImageData(e[1],0,0),Gb(xP,e[0],"map-1 classes");let n=nR(rP.getImageData(0,0,eP.width,eP.height));rP.putImageData(n[1],0,0),Gb(_P,n[0],"map-2 classes");let i=function(t,e,n){console.log(n,"app");let i=t.length,r=e.length,s=[],o=[];t.forEach((t=>{let e=Object.keys(t),n=(e.toString(),t[e][0]),i=new Array(n.length/4);for(let t=0;t<n.length;t+=4)255===n[t]&&0===n[t+1]&&0===n[t+2]&&255===n[t+3]?i[Math.floor(t/4)]=1:i[Math.floor(t/4)]=0;s.push(i)})),e.forEach((t=>{let e=Object.keys(t),n=(e.toString(),t[e][0]),i=new Array(n.length/4);for(let t=0;t<n.length;t+=4)255===n[t]&&0===n[t+1]&&0===n[t+2]&&255===n[t+3]?i[Math.floor(t/4)]=1:i[Math.floor(t/4)]=0;o.push(i)}));let a=0;for(let t=0;t<i;t++){let e=s[t],i=JR(e,n),l=0;for(let t=0;t<r;t++)l+=QR(o[t],e,n)+i;a+=i/l*(i/(2*i))}return a}(e[0],n[0],FP*zP);console.log(`Goodness of fit is: ${i}`)}))})()})();