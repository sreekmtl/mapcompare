(()=>{var __webpack_modules__={8874:t=>{"use strict";t.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},1788:(t,e,i)=>{"use strict";i.d(e,{Z:()=>a});var n=i(8081),r=i.n(n),s=i(3645),o=i.n(s)()(r());o.push([t.id,':root,\n:host {\n  --ol-background-color: white;\n  --ol-accent-background-color: #F5F5F5;\n  --ol-subtle-background-color: rgba(128, 128, 128, 0.25);\n  --ol-partial-background-color: rgba(255, 255, 255, 0.75);\n  --ol-foreground-color: #333333;\n  --ol-subtle-foreground-color: #666666;\n  --ol-brand-color: #00AAFF;\n}\n\n.ol-box {\n  box-sizing: border-box;\n  border-radius: 2px;\n  border: 1.5px solid var(--ol-background-color);\n  background-color: var(--ol-partial-background-color);\n}\n\n.ol-mouse-position {\n  top: 8px;\n  right: 8px;\n  position: absolute;\n}\n\n.ol-scale-line {\n  background: var(--ol-partial-background-color);\n  border-radius: 4px;\n  bottom: 8px;\n  left: 8px;\n  padding: 2px;\n  position: absolute;\n}\n\n.ol-scale-line-inner {\n  border: 1px solid var(--ol-subtle-foreground-color);\n  border-top: none;\n  color: var(--ol-foreground-color);\n  font-size: 10px;\n  text-align: center;\n  margin: 1px;\n  will-change: contents, width;\n  transition: all 0.25s;\n}\n\n.ol-scale-bar {\n  position: absolute;\n  bottom: 8px;\n  left: 8px;\n}\n\n.ol-scale-bar-inner {\n  display: flex;\n}\n\n.ol-scale-step-marker {\n  width: 1px;\n  height: 15px;\n  background-color: var(--ol-foreground-color);\n  float: right;\n  z-index: 10;\n}\n\n.ol-scale-step-text {\n  position: absolute;\n  bottom: -5px;\n  font-size: 10px;\n  z-index: 11;\n  color: var(--ol-foreground-color);\n  text-shadow: -1.5px 0 var(--ol-partial-background-color), 0 1.5px var(--ol-partial-background-color), 1.5px 0 var(--ol-partial-background-color), 0 -1.5px var(--ol-partial-background-color);\n}\n\n.ol-scale-text {\n  position: absolute;\n  font-size: 12px;\n  text-align: center;\n  bottom: 25px;\n  color: var(--ol-foreground-color);\n  text-shadow: -1.5px 0 var(--ol-partial-background-color), 0 1.5px var(--ol-partial-background-color), 1.5px 0 var(--ol-partial-background-color), 0 -1.5px var(--ol-partial-background-color);\n}\n\n.ol-scale-singlebar {\n  position: relative;\n  height: 10px;\n  z-index: 9;\n  box-sizing: border-box;\n  border: 1px solid var(--ol-foreground-color);\n}\n\n.ol-scale-singlebar-even {\n  background-color: var(--ol-subtle-foreground-color);\n}\n\n.ol-scale-singlebar-odd {\n  background-color: var(--ol-background-color);\n}\n\n.ol-unsupported {\n  display: none;\n}\n\n.ol-viewport,\n.ol-unselectable {\n  -webkit-touch-callout: none;\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  user-select: none;\n  -webkit-tap-highlight-color: transparent;\n}\n\n.ol-viewport canvas {\n  all: unset;\n  overflow: hidden;\n}\n\n.ol-viewport {\n  touch-action: pan-x pan-y;\n}\n\n.ol-selectable {\n  -webkit-touch-callout: default;\n  -webkit-user-select: text;\n  -moz-user-select: text;\n  user-select: text;\n}\n\n.ol-grabbing {\n  cursor: -webkit-grabbing;\n  cursor: -moz-grabbing;\n  cursor: grabbing;\n}\n\n.ol-grab {\n  cursor: move;\n  cursor: -webkit-grab;\n  cursor: -moz-grab;\n  cursor: grab;\n}\n\n.ol-control {\n  position: absolute;\n  background-color: var(--ol-subtle-background-color);\n  border-radius: 4px;\n}\n\n.ol-zoom {\n  top: .5em;\n  left: .5em;\n}\n\n.ol-rotate {\n  top: .5em;\n  right: .5em;\n  transition: opacity .25s linear, visibility 0s linear;\n}\n\n.ol-rotate.ol-hidden {\n  opacity: 0;\n  visibility: hidden;\n  transition: opacity .25s linear, visibility 0s linear .25s;\n}\n\n.ol-zoom-extent {\n  top: 4.643em;\n  left: .5em;\n}\n\n.ol-full-screen {\n  right: .5em;\n  top: .5em;\n}\n\n.ol-control button {\n  display: block;\n  margin: 1px;\n  padding: 0;\n  color: var(--ol-subtle-foreground-color);\n  font-weight: bold;\n  text-decoration: none;\n  font-size: inherit;\n  text-align: center;\n  height: 1.375em;\n  width: 1.375em;\n  line-height: .4em;\n  background-color: var(--ol-background-color);\n  border: none;\n  border-radius: 2px;\n}\n\n.ol-control button::-moz-focus-inner {\n  border: none;\n  padding: 0;\n}\n\n.ol-zoom-extent button {\n  line-height: 1.4em;\n}\n\n.ol-compass {\n  display: block;\n  font-weight: normal;\n  will-change: transform;\n}\n\n.ol-touch .ol-control button {\n  font-size: 1.5em;\n}\n\n.ol-touch .ol-zoom-extent {\n  top: 5.5em;\n}\n\n.ol-control button:hover,\n.ol-control button:focus {\n  text-decoration: none;\n  outline: 1px solid var(--ol-subtle-foreground-color);\n  color: var(--ol-foreground-color);\n}\n\n.ol-zoom .ol-zoom-in {\n  border-radius: 2px 2px 0 0;\n}\n\n.ol-zoom .ol-zoom-out {\n  border-radius: 0 0 2px 2px;\n}\n\n.ol-attribution {\n  text-align: right;\n  bottom: .5em;\n  right: .5em;\n  max-width: calc(100% - 1.3em);\n  display: flex;\n  flex-flow: row-reverse;\n  align-items: center;\n}\n\n.ol-attribution a {\n  color: var(--ol-subtle-foreground-color);\n  text-decoration: none;\n}\n\n.ol-attribution ul {\n  margin: 0;\n  padding: 1px .5em;\n  color: var(--ol-foreground-color);\n  text-shadow: 0 0 2px var(--ol-background-color);\n  font-size: 12px;\n}\n\n.ol-attribution li {\n  display: inline;\n  list-style: none;\n}\n\n.ol-attribution li:not(:last-child):after {\n  content: " ";\n}\n\n.ol-attribution img {\n  max-height: 2em;\n  max-width: inherit;\n  vertical-align: middle;\n}\n\n.ol-attribution button {\n  flex-shrink: 0;\n}\n\n.ol-attribution.ol-collapsed ul {\n  display: none;\n}\n\n.ol-attribution:not(.ol-collapsed) {\n  background: var(--ol-partial-background-color);\n}\n\n.ol-attribution.ol-uncollapsible {\n  bottom: 0;\n  right: 0;\n  border-radius: 4px 0 0;\n}\n\n.ol-attribution.ol-uncollapsible img {\n  margin-top: -.2em;\n  max-height: 1.6em;\n}\n\n.ol-attribution.ol-uncollapsible button {\n  display: none;\n}\n\n.ol-zoomslider {\n  top: 4.5em;\n  left: .5em;\n  height: 200px;\n}\n\n.ol-zoomslider button {\n  position: relative;\n  height: 10px;\n}\n\n.ol-touch .ol-zoomslider {\n  top: 5.5em;\n}\n\n.ol-overviewmap {\n  left: 0.5em;\n  bottom: 0.5em;\n}\n\n.ol-overviewmap.ol-uncollapsible {\n  bottom: 0;\n  left: 0;\n  border-radius: 0 4px 0 0;\n}\n\n.ol-overviewmap .ol-overviewmap-map,\n.ol-overviewmap button {\n  display: block;\n}\n\n.ol-overviewmap .ol-overviewmap-map {\n  border: 1px solid var(--ol-subtle-foreground-color);\n  height: 150px;\n  width: 150px;\n}\n\n.ol-overviewmap:not(.ol-collapsed) button {\n  bottom: 0;\n  left: 0;\n  position: absolute;\n}\n\n.ol-overviewmap.ol-collapsed .ol-overviewmap-map,\n.ol-overviewmap.ol-uncollapsible button {\n  display: none;\n}\n\n.ol-overviewmap:not(.ol-collapsed) {\n  background: var(--ol-subtle-background-color);\n}\n\n.ol-overviewmap-box {\n  border: 1.5px dotted var(--ol-subtle-foreground-color);\n}\n\n.ol-overviewmap .ol-overviewmap-box:hover {\n  cursor: move;\n}\n',""]);const a=o},1828:(t,e,i)=>{"use strict";i.d(e,{Z:()=>a});var n=i(8081),r=i.n(n),s=i(3645),o=i.n(s)()(r());o.push([t.id,'* {\n    box-sizing: border-box;\n  }\n.column {\n    float: left;\n    width: 30%;\n    height: 680px; /* Should be removed. Only for demonstration */\n}\n  \n  /* Clear floats after the columns */\n  .row:after {\n    content: "";\n    display: table;\n    clear: both;\n}\n\n\n\np{\n    color: #000000;\n    font-family: monospace;\n    font-size: medium;\n    padding-left: 10px;\n  \n}\n\nh3{\n\n    color: #000000;\n    font-family: monospace;\n    font-size: large;\n    font-weight: bold;\n    padding-left: 10px;\n\n}\n\n\ninput[type="text"] {\n  width:500px;\n  color: #000000;\n  font-family: monospace;\n  font-size: large;\n  padding-left: 20px;\n}\n\nbutton{\n  font-family:monospace;\n  font-size: 12px;\n}\n\nlabel{\n  font-family:monospace;\n}\n\nselect{\n  font-family:monospace;\n}\n\n.article{\n  color: white;\n}',""]);const a=o},3645:t=>{"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var i="",n=void 0!==e[5];return e[4]&&(i+="@supports (".concat(e[4],") {")),e[2]&&(i+="@media ".concat(e[2]," {")),n&&(i+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),i+=t(e),n&&(i+="}"),e[2]&&(i+="}"),e[4]&&(i+="}"),i})).join("")},e.i=function(t,i,n,r,s){"string"==typeof t&&(t=[[null,t,void 0]]);var o={};if(n)for(var a=0;a<this.length;a++){var l=this[a][0];null!=l&&(o[l]=!0)}for(var h=0;h<t.length;h++){var c=[].concat(t[h]);n&&o[c[0]]||(void 0!==s&&(void 0===c[5]||(c[1]="@layer".concat(c[5].length>0?" ".concat(c[5]):""," {").concat(c[1],"}")),c[5]=s),i&&(c[2]?(c[1]="@media ".concat(c[2]," {").concat(c[1],"}"),c[2]=i):c[2]=i),r&&(c[4]?(c[1]="@supports (".concat(c[4],") {").concat(c[1],"}"),c[4]=r):c[4]="".concat(r)),e.push(c))}},e}},8081:t=>{"use strict";t.exports=function(t){return t[1]}},7060:(t,e,i)=>{"use strict";const{IOBuffer:n}=i(2155),r=i(5578),s=[];for(let t=0;t<=8;t++)s.push(255<<t);t.exports=class extends n{constructor(t){if(1!==t.bitDepth)throw new Error("Only bitDepth of 1 is supported");if(!t.height||!t.width)throw new Error("ImageData width and height are required");super(t.data),this.width=t.width,this.height=t.height,this.bitDepth=t.bitDepth,this.channels=t.channels,this.components=t.components}encode(){this.encoded=new n,this.encoded.skip(14),this.writeBitmapV5Header(),this.writeColorTable();const t=this.encoded.offset;return this.writePixelArray(),this.encoded.rewind(),this.writeBitmapFileHeader(t),this.encoded.toArray()}writePixelArray(){let t=this.encoded;const e=4*Math.floor((this.bitDepth*this.width+31)/32),i=Math.ceil(this.bitDepth*this.width/8),n=e-i,r=this.bitDepth*this.width%8,o=0===r?0:8-r,a=e*this.height;let l,h,c=0,u=0,d=8;t.mark(),h=this.readUint8();for(let a=this.height-1;a>=0;a--){const g=0===a;t.reset(),t.skip(a*e);for(let e=0;e<i;e++){const a=e===i-1;u<=o&&a?(t.writeByte(h<<u),0!==o&&o!==u||g||(l=h,h=this.readByte())):0===u?(l=h,h=this.readUint8(),t.writeByte(l)):(l=h,h=this.readUint8(),t.writeByte(l<<u&s[u]|h>>d)),a&&(c+=r||0,t.skip(n),u=c%8,d=8-u)}}e>i&&(t.reset(),t.skip(a-1),t.writeUint8(0))}writeColorTable(){this.encoded.writeUint32(0).writeUint32(16777215)}writeBitmapFileHeader(t){this.encoded.writeChars("BM").writeInt32(this.encoded.lastWrittenByte).writeUint16(0).writeUint16(0).writeUint32(t)}writeBitmapV5Header(){const t=4*Math.floor((this.bitDepth*this.width+31)/32)*this.height;this.encoded.writeUint32(124).writeInt32(this.width).writeInt32(this.height).writeUint16(1).writeUint16(this.bitDepth).writeUint32(r.BITMAPV5HEADER.Compression.BI_RGB).writeUint32(t).writeInt32(0).writeInt32(0).writeUint32(Math.pow(2,this.bitDepth)).writeUint32(Math.pow(2,this.bitDepth)).writeUint32(4278190080).writeUint32(16711680).writeUint32(65280).writeUint32(255).writeUint32(r.BITMAPV5HEADER.LogicalColorSpace.LCS_sRGB).skip(36).skip(12).writeUint32(r.BITMAPV5HEADER.GamutMappingIntent.LCS_GM_IMAGES).skip(12)}}},5578:t=>{"use strict";t.exports={BITMAPV5HEADER:{LogicalColorSpace:{LCS_CALIBRATED_RGB:0,LCS_sRGB:1934772034,LCS_WINDOWS_COLOR_SPACE:1466527264},Compression:{BI_RGB:0,BI_RLE8:1,BI_RLE4:2,BI_BITFIELDS:3,BI_JPEG:4,BI_PNG:5,BI_CMYK:11,BI_CMYKRLE8:12,BI_CMYKRLE4:13},GamutMappingIntent:{LCS_GM_ABS_COLORIMETRIC:8,LCS_GM_BUSINESS:1,LCS_GM_GRAPHICS:2,LCS_GM_IMAGES:4}}}},4665:(t,e,i)=>{"use strict";const n=i(7060);e.c=function(t){return new n(t).encode()}},7909:t=>{"use strict";const e=[];t.exports=class{constructor(t,e){e=e||{},void 0===t&&(t=8192),"number"==typeof t&&(t=new ArrayBuffer(t));let i=t.byteLength;const n=e.offset?e.offset>>>0:0;t.buffer&&(i=t.byteLength-n,t=t.byteLength!==t.buffer.byteLength?t.buffer.slice(t.byteOffset+n,t.byteOffset+t.byteLength):n?t.buffer.slice(n):t.buffer),this.buffer=t,this.length=i,this.byteLength=i,this.byteOffset=0,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer),this._increment=i||8192,this._mark=0}available(t){return void 0===t&&(t=1),this.offset+t<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){this.littleEndian=!0}isBigEndian(){return!this.littleEndian}setBigEndian(){this.littleEndian=!1}skip(t){void 0===t&&(t=1),this.offset+=t}seek(t){this.offset=t}mark(){this._mark=this.offset}reset(){this.offset=this._mark}rewind(){this.offset=0}ensureAvailable(t){if(void 0===t&&(t=1),!this.available(t)){const t=this._increment+this._increment;this._increment=t;const e=this.length+t,i=new Uint8Array(e);i.set(new Uint8Array(this.buffer)),this.buffer=i.buffer,this.length=e,this._data=new DataView(this.buffer)}}readBoolean(){return 0!==this.readUint8()}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(t){void 0===t&&(t=1);for(var e=new Uint8Array(t),i=0;i<t;i++)e[i]=this.readByte();return e}readInt16(){var t=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,t}readUint16(){var t=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,t}readInt32(){var t=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,t}readUint32(){var t=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat32(){var t=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat64(){var t=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,t}readChar(){return String.fromCharCode(this.readInt8())}readChars(t){void 0===t&&(t=1),e.length=t;for(var i=0;i<t;i++)e[i]=this.readChar();return e.join("")}writeBoolean(t){this.writeUint8(t?255:0)}writeInt8(t){this.ensureAvailable(1),this._data.setInt8(this.offset++,t)}writeUint8(t){this.ensureAvailable(1),this._data.setUint8(this.offset++,t)}writeByte(t){this.writeUint8(t)}writeBytes(t){this.ensureAvailable(t.length);for(var e=0;e<t.length;e++)this._data.setUint8(this.offset++,t[e])}writeInt16(t){this.ensureAvailable(2),this._data.setInt16(this.offset,t,this.littleEndian),this.offset+=2}writeUint16(t){this.ensureAvailable(2),this._data.setUint16(this.offset,t,this.littleEndian),this.offset+=2}writeInt32(t){this.ensureAvailable(4),this._data.setInt32(this.offset,t,this.littleEndian),this.offset+=4}writeUint32(t){this.ensureAvailable(4),this._data.setUint32(this.offset,t,this.littleEndian),this.offset+=4}writeFloat32(t){this.ensureAvailable(4),this._data.setFloat32(this.offset,t,this.littleEndian),this.offset+=4}writeFloat64(t){this.ensureAvailable(8),this._data.setFloat64(this.offset,t,this.littleEndian),this.offset+=8}writeChar(t){this.writeUint8(t.charCodeAt(0))}writeChars(t){for(var e=0;e<t.length;e++)this.writeUint8(t.charCodeAt(e))}toArray(){return new Uint8Array(this.buffer,0,this.offset)}}},3311:(t,e,i)=>{"use strict";const n=i(6752);t.exports=function(t,e){return new n(t,e).decode(e)}},8029:(t,e,i)=>{"use strict";const n={standard:i(4263),exif:i(9640),gps:i(5367)};t.exports=class{constructor(t){if(!t)throw new Error("missing kind");this.data=null,this.fields=new Map,this.kind=t,this._map=null}get(t){if("number"==typeof t)return this.fields.get(t);if("string"==typeof t)return this.fields.get(n[this.kind].tagsByName[t]);throw new Error("expected a number or string")}get map(){if(!this._map){this._map={};const e=n[this.kind].tagsById;for(var t of this.fields.keys())e[t]&&(this._map[e[t]]=this.fields.get(t))}return this._map}}},6486:(t,e)=>{"use strict";var i=new Map([[1,[1,n]],[2,[1,function(t,e){for(var i=[],n="",r=0;r<e;r++){var s=String.fromCharCode(t.readUint8());"\0"===s?(i.push(n),n=""):n+=s}return 1===i.length?i[0]:i}]],[3,[2,function(t,e){if(1===e)return t.readUint16();for(var i=new Uint16Array(e),n=0;n<e;n++)i[n]=t.readUint16();return i}]],[4,[4,function(t,e){if(1===e)return t.readUint32();for(var i=new Uint32Array(e),n=0;n<e;n++)i[n]=t.readUint32();return i}]],[5,[8,function(t,e){if(1===e)return t.readUint32()/t.readUint32();for(var i=new Array(e),n=0;n<e;n++)i[n]=t.readUint32()/t.readUint32();return i}]],[6,[1,function(t,e){if(1===e)return t.readInt8();for(var i=new Int8Array(e),n=0;n<e;n++)i[n]=t.readInt8();return i}]],[7,[1,n]],[8,[2,function(t,e){if(1===e)return t.readInt16();for(var i=new Int16Array(e),n=0;n<e;n++)i[n]=t.readInt16();return i}]],[9,[4,function(t,e){if(1===e)return t.readInt32();for(var i=new Int32Array(e),n=0;n<e;n++)i[n]=t.readInt32();return i}]],[10,[8,function(t,e){if(1===e)return t.readInt32()/t.readInt32();for(var i=new Array(e),n=0;n<e;n++)i[n]=t.readInt32()/t.readInt32();return i}]],[11,[4,function(t,e){if(1===e)return t.readFloat32();for(var i=new Float32Array(e),n=0;n<e;n++)i[n]=t.readFloat32();return i}]],[12,[8,function(t,e){if(1===e)return t.readFloat64();for(var i=new Float64Array(e),n=0;n<e;n++)i[n]=t.readFloat64();return i}]]]);function n(t,e){if(1===e)return t.readUint8();for(var i=new Uint8Array(e),n=0;n<e;n++)i[n]=t.readUint8();return i}e.getByteLength=function(t,e){return i.get(t)[0]*e},e.readData=function(t,e,n){return i.get(e)[1](t,n)}},9469:(t,e,i)=>{"use strict";e.decode=i(3311)},9640:t=>{"use strict";const e={33434:"ExposureTime",33437:"FNumber",34850:"ExposureProgram",34852:"SpectralSensitivity",34855:"ISOSpeedRatings",34856:"OECF",34864:"SensitivityType",34865:"StandardOutputSensitivity",34866:"RecommendedExposureIndex",34867:"ISOSpeed",34868:"ISOSpeedLatitudeyyy",34869:"ISOSpeedLatitudezzz",36864:"ExifVersion",36867:"DateTimeOriginal",36868:"DateTimeDigitized",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureBiasValue",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37386:"FocalLength",37396:"SubjectArea",37500:"MakerNote",37510:"UserComment",37520:"SubsecTime",37521:"SubsecTimeOriginal",37522:"SubsecTimeDigitized",40960:"FlashpixVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",40964:"RelatedSoundFile",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41492:"SubjectLocation",41493:"ExposureIndex",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRatio",41989:"FocalLengthIn35mmFilm",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",42016:"ImageUniqueID",42032:"CameraOwnerName",42033:"BodySerialNumber",42034:"LensSpecification",42035:"LensMake",42036:"LensModel",42037:"LensSerialNumber",42240:"Gamma"},i={};for(var n in e)i[e[n]]=n;t.exports={tagsById:e,tagsByName:i}},5367:t=>{"use strict";const e={0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential",31:"GPSHPositioningError"},i={};for(var n in e)i[e[n]]=n;t.exports={tagsById:e,tagsByName:i}},4263:t=>{"use strict";const e={254:"NewSubfileType",255:"SubfileType",256:"ImageWidth",257:"ImageLength",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",263:"Threshholding",264:"CellWidth",265:"CellLength",266:"FillOrder",270:"ImageDescription",271:"Make",272:"Model",273:"StripOffsets",274:"Orientation",277:"SamplesPerPixel",278:"RowsPerStrip",279:"StripByteCounts",280:"MinSampleValue",281:"MaxSampleValue",282:"XResolution",283:"YResolution",284:"PlanarConfiguration",288:"FreeOffsets",289:"FreeByteCounts",290:"GrayResponseUnit",291:"GrayResponseCurve",296:"ResolutionUnit",305:"Software",306:"DateTime",315:"Artist",316:"HostComputer",320:"ColorMap",338:"ExtraSamples",33432:"Copyright",269:"DocumentName",285:"PageName",286:"XPosition",287:"YPosition",292:"T4Options",293:"T6Options",297:"PageNumber",301:"TransferFunction",317:"Predictor",318:"WhitePoint",319:"PrimaryChromaticities",321:"HalftoneHints",322:"TileWidth",323:"TileLength",324:"TileOffsets",325:"TileByteCounts",326:"BadFaxLines",327:"CleanFaxData",328:"ConsecutiveBadFaxLines",330:"SubIFDs",332:"InkSet",333:"InkNames",334:"NumberOfInks",336:"DotRange",337:"TargetPrinter",339:"SampleFormat",340:"SMinSampleValue",341:"SMaxSampleValue",342:"TransferRange",343:"ClipPath",344:"XClipPathUnits",345:"YClipPathUnits",346:"Indexed",347:"JPEGTables",351:"OPIProxy",400:"GlobalParametersIFD",401:"ProfileType",402:"FaxProfile",403:"CodingMethods",404:"VersionYear",405:"ModeNumber",433:"Decode",434:"DefaultImageColor",512:"JPEGProc",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",515:"JPEGRestartInterval",517:"JPEGLosslessPredictors",518:"JPEGPointTransforms",519:"JPEGQTables",520:"JPEGDCTables",521:"JPEGACTables",529:"YCbCrCoefficients",530:"YCbCrSubSampling",531:"YCbCrPositioning",532:"ReferenceBlackWhite",559:"StripRowCounts",700:"XMP",32781:"ImageID",34732:"ImageLayer",32932:"WangAnnotatio",33445:"MDFileTag",33446:"MDScalePixel",33447:"MDColorTable",33448:"MDLabName",33449:"MDSampleInfo",33450:"MDPrepDate",33451:"MDPrepTime",33452:"MDFileUnits",33550:"ModelPixelScaleTag",33723:"IPTC",33918:"INGRPacketDataTag",33919:"INGRFlagRegisters",33920:"IrasBTransformationMatrix",33922:"ModelTiepointTag",34264:"ModelTransformationTag",34377:"Photoshop",34665:"ExifIFD",34675:"ICCProfile",34735:"GeoKeyDirectoryTag",34736:"GeoDoubleParamsTag",34737:"GeoAsciiParamsTag",34853:"GPSIFD",34908:"HylaFAXFaxRecvParams",34909:"HylaFAXFaxSubAddress",34910:"HylaFAXFaxRecvTime",37724:"ImageSourceData",40965:"InteroperabilityIFD",42112:"GDAL_METADATA",42113:"GDAL_NODATA",50215:"OceScanjobDescription",50216:"OceApplicationSelector",50217:"OceIdentificationNumber",50218:"OceImageLogicCharacteristics",50706:"DNGVersion",50707:"DNGBackwardVersion",50708:"UniqueCameraModel",50709:"LocalizedCameraModel",50710:"CFAPlaneColor",50711:"CFALayout",50712:"LinearizationTable",50713:"BlackLevelRepeatDim",50714:"BlackLevel",50715:"BlackLevelDeltaH",50716:"BlackLevelDeltaV",50717:"WhiteLevel",50718:"DefaultScale",50719:"DefaultCropOrigin",50720:"DefaultCropSize",50721:"ColorMatrix1",50722:"ColorMatrix2",50723:"CameraCalibration1",50724:"CameraCalibration2",50725:"ReductionMatrix1",50726:"ReductionMatrix2",50727:"AnalogBalance",50728:"AsShotNeutral",50729:"AsShotWhiteXY",50730:"BaselineExposure",50731:"BaselineNoise",50732:"BaselineSharpness",50733:"BayerGreenSplit",50734:"LinearResponseLimit",50735:"CameraSerialNumber",50736:"LensInfo",50737:"ChromaBlurRadius",50738:"AntiAliasStrength",50740:"DNGPrivateData",50741:"MakerNoteSafety",50778:"CalibrationIlluminant1",50779:"CalibrationIlluminant2",50780:"BestQualityScale",50784:"AliasLayerMetadata"},i={};for(var n in e)i[e[n]]=n;t.exports={tagsById:e,tagsByName:i}},6752:(t,e,i)=>{"use strict";const n=i(7909),r=i(8029),s=i(8353),o=i(6486),a={ignoreImageData:!1,onlyFirst:!1};function l(t,e,i,n){for(var r=0;r<n;r++)t[i++]=e.getUint8(r);return i}function h(t,e,i,n,r){for(var s=0;s<2*n;s+=2)t[i++]=e.getUint16(s,r);return i}function c(t,e,i,n,r){for(var s=0;s<4*n;s+=4)t[i++]=e.getFloat32(s,r);return i}function u(t,e){throw new Error("Unsupported "+t+": "+e)}t.exports=class extends n{constructor(t,e){super(t,e),this._nextIFD=0}decode(t){t=Object.assign({},a,t);const e=[];for(this.decodeHeader();this._nextIFD;)if(e.push(this.decodeIFD(t)),t.onlyFirst)return e[0];return e}decodeHeader(){let t=this.readUint16();if(18761===t)this.setLittleEndian();else{if(19789!==t)throw new Error("invalid byte order: 0x"+t.toString(16));this.setBigEndian()}if(t=this.readUint16(),42!==t)throw new Error("not a TIFF file");this._nextIFD=this.readUint32()}decodeIFD(t){var e;this.seek(this._nextIFD),e=t.kind?new r(t.kind):new s;const i=this.readUint16();for(var n=0;n<i;n++)this.decodeIFDEntry(e);return t.ignoreImageData||this.decodeImageData(e),this._nextIFD=this.readUint32(),e}decodeIFDEntry(t){const e=this.offset,i=this.readUint16(),n=this.readUint16(),r=this.readUint32();if(n<1||n>12)return void this.skip(4);o.getByteLength(n,r)>4&&this.seek(this.readUint32());const s=o.readData(this,n,r);if(t.fields.set(i,s),34665===i||34853===i){let e,n=this.offset;34665===i?e="exif":34853===i&&(e="gps"),this._nextIFD=s,t[e]=this.decodeIFD({kind:e,ignoreImageData:!0}),this.offset=n}this.seek(e),this.skip(12)}decodeImageData(t){const e=t.orientation;switch(e&&1!==e&&u("orientation",e),t.type){case 1:case 2:this.readStripData(t);break;default:u("image type",t.type)}}readStripData(t){const e=t.width,i=t.height,n=function(t){if(t.length){const i=t;t=i[0];for(var e=0;e<i.length;e++)i[e]!==t&&u("bit depth",i)}return t}(t.bitsPerSample),r=t.sampleFormat;let s=e*i;const o=function(t,e,i,n){return 8===i?new Uint8Array(1*t):16===i?new Uint16Array(1*t):32===i&&3===n?new Float32Array(1*t):u("bit depth / sample format",i+" / "+n)}(s,0,n,r),a=t.compression,d=t.rowsPerStrip*e,g=t.stripOffsets,f=t.stripByteCounts;for(var p=0,m=0;m<g.length;m++){var _=this.getStripData(a,g[m],f[m]),y=s>d?d:s;s-=y,8===n?p=l(o,_,p,y):16===n?p=h(o,_,p,y,this.isLittleEndian()):32===n&&3===r?p=c(o,_,p,y,this.isLittleEndian()):u("bitDepth",n)}t.data=o}getStripData(t,e,i){switch(t){case 1:return new DataView(this.buffer,e,i);case 2:case 32773:return u("Compression",t);default:throw new Error("invalid compression: "+t)}}}},8353:(t,e,i)=>{"use strict";const n=i(8029),r=/^(\d{4}):(\d{2}):(\d{2}) (\d{2}):(\d{2}):(\d{2})$/;function s(t){return"number"==typeof t?[t]:t}t.exports=class extends n{constructor(){super("standard")}get size(){return this.width*this.height}get width(){return this.imageWidth}get height(){return this.imageLength}get components(){return this.samplesPerPixel}get date(){var t=new Date,e=r.exec(this.dateTime);return t.setFullYear(e[1],e[2]-1,e[3]),t.setHours(e[4],e[5],e[6]),t}get newSubfileType(){return this.get(254)}get imageWidth(){return this.get(256)}get imageLength(){return this.get(257)}get bitsPerSample(){return this.get(258)}get compression(){return this.get(259)||1}get type(){return this.get(262)}get fillOrder(){return this.get(266)||1}get documentName(){return this.get(269)}get imageDescription(){return this.get(270)}get stripOffsets(){return s(this.get(273))}get orientation(){return this.get(274)}get samplesPerPixel(){return this.get(277)}get rowsPerStrip(){return this.get(278)}get stripByteCounts(){return s(this.get(279))}get minSampleValue(){return this.get(280)||0}get maxSampleValue(){return this.get(281)||Math.pow(2,this.bitsPerSample)-1}get xResolution(){return this.get(282)}get yResolution(){return this.get(283)}get planarConfiguration(){return this.get(284)||1}get resolutionUnit(){return this.get(296)||2}get dateTime(){return this.get(306)}get predictor(){return this.get(317)||1}get sampleFormat(){return this.get(339)||1}get sMinSampleValue(){return this.get(340)||this.minSampleValue}get sMaxSampleValue(){return this.get(341)||this.maxSampleValue}}},9698:(t,e,i)=>{"use strict";const n=i(7909),r=i(9469);t.exports=function(t){const e=new n(t),i={};if(e.setBigEndian(),65496!==e.readUint16())throw new Error("SOI marker not found. Not a valid JPEG file");if(65505===e.readUint16()){e.readUint16();const t=e.readBytes(6);if(69===t[0]&&120===t[1]&&105===t[2]&&102===t[3]&&0===t[4]&&0===t[5]){const t=r.decode(e,{onlyFirst:!0,ignoreImageData:!0,offset:e.offset});i.exif=t}}return i}},9464:(t,e,i)=>{"use strict";e.decode=i(9698)},8737:t=>{!function(){function e(t,e,i){this.next=i,i&&(i.prev=this),this.prev=e,e&&(e.next=this),this.data=t}function i(){if(!(this instanceof i))return new i;this._head=null,this._tail=null,this.length=0}i.prototype={push:function(t){this._tail=new e(t,this._tail,null),this._head||(this._head=this._tail),this.length++},pop:function(){if(0!==this.length){var t=this._tail;return this._tail=t.prev,t.prev&&(t.prev=this._tail.next=null),this.length--,1===this.length?this._head=this._tail:0===this.length&&(this._head=this._tail=null),t.data}},unshift:function(t){this._head=new e(t,null,this._head),this._tail||(this._tail=this._head),this.length++},shift:function(){if(0!==this.length){var t=this._head;return this._head=t.next,t.next&&(t.next=this._head.prev=null),this.length--,1===this.length?this._tail=this._head:0===this.length&&(this._head=this._tail=null),t.data}},item:function(t){t<0&&(t=this.length+t);for(var e=this._head;t-- >0&&e;)e=e.next;return e?e.data:void 0},slice:function(t,e){if(t||(t=0),e||(e=this.length),e<0&&(e=this.length+e),t<0&&(t=this.length+t),e===t)return[];if(e<t)throw new Error("invalid offset: "+t+","+e+" (length="+this.length+")");for(var i=e-t,n=new Array(i),r=0,s=this._head;t-- >0&&s;)s=s.next;for(;r<i&&s;)n[r++]=s.data,s=s.next;return n},drop:function(){i.call(this)},forEach:function(t,e){for(var i=this._head,n=0,r=this.length;n<r&&i;)t.call(e||this,i.data,n,this),i=i.next,n++},map:function(t,e){var n=new i;return this.forEach((function(i,r,s){n.push(t.call(e||s,i,r,s))})),n},filter:function(t,e){var n=new i;return this.forEach((function(i,r,s){t.call(e||s,i,r,s)&&n.push(i)})),n},reduce:function(t,e,i){var n=0,r=this._head,s=this.length;for(e||(n=1,e=r&&r.data,r=r&&r.next);n<s&&r;)e=t.call(i||this,e,r.data,this),n++,r=r.next;return e}},t.exports=i}()},9645:t=>{"use strict";function e(t){if(this.size=0|t,this.size<=1||0!=(this.size&this.size-1))throw new Error("FFT size must be a power of two and bigger than 1");this._csize=t<<1;for(var e=new Array(2*this.size),i=0;i<e.length;i+=2){const t=Math.PI*i/this.size;e[i]=Math.cos(t),e[i+1]=-Math.sin(t)}this.table=e;for(var n=0,r=1;this.size>r;r<<=1)n++;this._width=n%2==0?n-1:n,this._bitrev=new Array(1<<this._width);for(var s=0;s<this._bitrev.length;s++){this._bitrev[s]=0;for(var o=0;o<this._width;o+=2){var a=this._width-o-2;this._bitrev[s]|=(s>>>o&3)<<a}}this._out=null,this._data=null,this._inv=0}t.exports=e,e.prototype.fromComplexArray=function(t,e){for(var i=e||new Array(t.length>>>1),n=0;n<t.length;n+=2)i[n>>>1]=t[n];return i},e.prototype.createComplexArray=function(){const t=new Array(this._csize);for(var e=0;e<t.length;e++)t[e]=0;return t},e.prototype.toComplexArray=function(t,e){for(var i=e||this.createComplexArray(),n=0;n<i.length;n+=2)i[n]=t[n>>>1],i[n+1]=0;return i},e.prototype.completeSpectrum=function(t){for(var e=this._csize,i=e>>>1,n=2;n<i;n+=2)t[e-n]=t[n],t[e-n+1]=-t[n+1]},e.prototype.transform=function(t,e){if(t===e)throw new Error("Input and output buffers must be different");this._out=t,this._data=e,this._inv=0,this._transform4(),this._out=null,this._data=null},e.prototype.realTransform=function(t,e){if(t===e)throw new Error("Input and output buffers must be different");this._out=t,this._data=e,this._inv=0,this._realTransform4(),this._out=null,this._data=null},e.prototype.inverseTransform=function(t,e){if(t===e)throw new Error("Input and output buffers must be different");this._out=t,this._data=e,this._inv=1,this._transform4();for(var i=0;i<t.length;i++)t[i]/=this.size;this._out=null,this._data=null},e.prototype._transform4=function(){var t,e,i=this._out,n=this._csize,r=1<<this._width,s=n/r<<1,o=this._bitrev;if(4===s)for(t=0,e=0;t<n;t+=s,e++){const i=o[e];this._singleTransform2(t,i,r)}else for(t=0,e=0;t<n;t+=s,e++){const i=o[e];this._singleTransform4(t,i,r)}var a=this._inv?-1:1,l=this.table;for(r>>=2;r>=2;r>>=2){var h=(s=n/r<<1)>>>2;for(t=0;t<n;t+=s)for(var c=t+h,u=t,d=0;u<c;u+=2,d+=r){const t=u,e=t+h,n=e+h,r=n+h,s=i[t],o=i[t+1],c=i[e],g=i[e+1],f=i[n],p=i[n+1],m=i[r],_=i[r+1],y=s,w=o,x=l[d],b=a*l[d+1],v=c*x-g*b,E=c*b+g*x,S=l[2*d],I=a*l[2*d+1],M=f*S-p*I,C=f*I+p*S,T=l[3*d],R=a*l[3*d+1],A=m*T-_*R,k=m*R+_*T,P=y+M,L=w+C,N=y-M,D=w-C,O=v+A,F=E+k,z=a*(v-A),B=a*(E-k),G=P+O,Y=L+F,U=P-O,X=L-F,q=N+B,V=D-z,j=N-B,W=D+z;i[t]=G,i[t+1]=Y,i[e]=q,i[e+1]=V,i[n]=U,i[n+1]=X,i[r]=j,i[r+1]=W}}},e.prototype._singleTransform2=function(t,e,i){const n=this._out,r=this._data,s=r[e],o=r[e+1],a=r[e+i],l=r[e+i+1],h=s+a,c=o+l,u=s-a,d=o-l;n[t]=h,n[t+1]=c,n[t+2]=u,n[t+3]=d},e.prototype._singleTransform4=function(t,e,i){const n=this._out,r=this._data,s=this._inv?-1:1,o=2*i,a=3*i,l=r[e],h=r[e+1],c=r[e+i],u=r[e+i+1],d=r[e+o],g=r[e+o+1],f=r[e+a],p=r[e+a+1],m=l+d,_=h+g,y=l-d,w=h-g,x=c+f,b=u+p,v=s*(c-f),E=s*(u-p),S=m+x,I=_+b,M=y+E,C=w-v,T=m-x,R=_-b,A=y-E,k=w+v;n[t]=S,n[t+1]=I,n[t+2]=M,n[t+3]=C,n[t+4]=T,n[t+5]=R,n[t+6]=A,n[t+7]=k},e.prototype._realTransform4=function(){var t,e,i=this._out,n=this._csize,r=1<<this._width,s=n/r<<1,o=this._bitrev;if(4===s)for(t=0,e=0;t<n;t+=s,e++){const i=o[e];this._singleRealTransform2(t,i>>>1,r>>>1)}else for(t=0,e=0;t<n;t+=s,e++){const i=o[e];this._singleRealTransform4(t,i>>>1,r>>>1)}var a=this._inv?-1:1,l=this.table;for(r>>=2;r>=2;r>>=2){var h=(s=n/r<<1)>>>1,c=h>>>1,u=c>>>1;for(t=0;t<n;t+=s)for(var d=0,g=0;d<=u;d+=2,g+=r){var f=t+d,p=f+c,m=p+c,_=m+c,y=i[f],w=i[f+1],x=i[p],b=i[p+1],v=i[m],E=i[m+1],S=i[_],I=i[_+1],M=y,C=w,T=l[g],R=a*l[g+1],A=x*T-b*R,k=x*R+b*T,P=l[2*g],L=a*l[2*g+1],N=v*P-E*L,D=v*L+E*P,O=l[3*g],F=a*l[3*g+1],z=S*O-I*F,B=S*F+I*O,G=M+N,Y=C+D,U=M-N,X=C-D,q=A+z,V=k+B,j=a*(A-z),W=a*(k-B),Z=G+q,H=Y+V,K=U+W,$=X-j;if(i[f]=Z,i[f+1]=H,i[p]=K,i[p+1]=$,0!==d){if(d!==u){var J=U+-a*W,Q=-a*j-X,tt=G+-a*q,et=-Y- -a*V,it=t+c-d,nt=t+h-d;i[it]=J,i[it+1]=Q,i[nt]=tt,i[nt+1]=et}}else{var rt=G-q,st=Y-V;i[m]=rt,i[m+1]=st}}}},e.prototype._singleRealTransform2=function(t,e,i){const n=this._out,r=this._data,s=r[e],o=r[e+i],a=s+o,l=s-o;n[t]=a,n[t+1]=0,n[t+2]=l,n[t+3]=0},e.prototype._singleRealTransform4=function(t,e,i){const n=this._out,r=this._data,s=this._inv?-1:1,o=2*i,a=3*i,l=r[e],h=r[e+i],c=r[e+o],u=r[e+a],d=l+c,g=l-c,f=h+u,p=s*(h-u),m=d+f,_=g,y=-p,w=d-f,x=g,b=p;n[t]=m,n[t+1]=0,n[t+2]=_,n[t+3]=y,n[t+4]=w,n[t+5]=0,n[t+6]=x,n[t+7]=b}},7769:module=>{"use strict";const toBytes=t=>[...t].map((t=>t.charCodeAt(0))),xpiZipFilename=toBytes("META-INF/mozilla.rsa"),oxmlContentTypes=toBytes("[Content_Types].xml"),oxmlRels=toBytes("_rels/.rels");function readUInt64LE(t,e=0){let i=t[e],n=1,r=0;for(;++r<8;)n*=256,i+=t[e+r]*n;return i}const fileType=t=>{if(!(t instanceof Uint8Array||t instanceof ArrayBuffer||Buffer.isBuffer(t)))throw new TypeError(`Expected the \`input\` argument to be of type \`Uint8Array\` or \`Buffer\` or \`ArrayBuffer\`, got \`${typeof t}\``);const e=t instanceof Uint8Array?t:new Uint8Array(t);if(!(e&&e.length>1))return null;const i=(t,i)=>{i=Object.assign({offset:0},i);for(let n=0;n<t.length;n++)if(i.mask){if(t[n]!==(i.mask[n]&e[n+i.offset]))return!1}else if(t[n]!==e[n+i.offset])return!1;return!0},n=(t,e)=>i(toBytes(t),e);if(i([255,216,255]))return{ext:"jpg",mime:"image/jpeg"};if(i([137,80,78,71,13,10,26,10]))return{ext:"png",mime:"image/png"};if(i([71,73,70]))return{ext:"gif",mime:"image/gif"};if(i([87,69,66,80],{offset:8}))return{ext:"webp",mime:"image/webp"};if(i([70,76,73,70]))return{ext:"flif",mime:"image/flif"};if((i([73,73,42,0])||i([77,77,0,42]))&&i([67,82],{offset:8}))return{ext:"cr2",mime:"image/x-canon-cr2"};if(i([73,73,42,0])||i([77,77,0,42]))return{ext:"tif",mime:"image/tiff"};if(i([66,77]))return{ext:"bmp",mime:"image/bmp"};if(i([73,73,188]))return{ext:"jxr",mime:"image/vnd.ms-photo"};if(i([56,66,80,83]))return{ext:"psd",mime:"image/vnd.adobe.photoshop"};if(i([80,75,3,4])){if(i([109,105,109,101,116,121,112,101,97,112,112,108,105,99,97,116,105,111,110,47,101,112,117,98,43,122,105,112],{offset:30}))return{ext:"epub",mime:"application/epub+zip"};if(i(xpiZipFilename,{offset:30}))return{ext:"xpi",mime:"application/x-xpinstall"};if(n("mimetypeapplication/vnd.oasis.opendocument.text",{offset:30}))return{ext:"odt",mime:"application/vnd.oasis.opendocument.text"};if(n("mimetypeapplication/vnd.oasis.opendocument.spreadsheet",{offset:30}))return{ext:"ods",mime:"application/vnd.oasis.opendocument.spreadsheet"};if(n("mimetypeapplication/vnd.oasis.opendocument.presentation",{offset:30}))return{ext:"odp",mime:"application/vnd.oasis.opendocument.presentation"};const t=(t,e=0)=>t.findIndex(((t,i,n)=>i>=e&&80===n[i]&&75===n[i+1]&&3===n[i+2]&&4===n[i+3]));let r=0,s=!1,o=null;do{const a=r+30;if(s||(s=i(oxmlContentTypes,{offset:a})||i(oxmlRels,{offset:a})),o||(n("word/",{offset:a})?o={ext:"docx",mime:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"}:n("ppt/",{offset:a})?o={ext:"pptx",mime:"application/vnd.openxmlformats-officedocument.presentationml.presentation"}:n("xl/",{offset:a})&&(o={ext:"xlsx",mime:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"})),s&&o)return o;r=t(e,a)}while(r>=0);if(o)return o}if(i([80,75])&&(3===e[2]||5===e[2]||7===e[2])&&(4===e[3]||6===e[3]||8===e[3]))return{ext:"zip",mime:"application/zip"};if(i([117,115,116,97,114],{offset:257}))return{ext:"tar",mime:"application/x-tar"};if(i([82,97,114,33,26,7])&&(0===e[6]||1===e[6]))return{ext:"rar",mime:"application/x-rar-compressed"};if(i([31,139,8]))return{ext:"gz",mime:"application/gzip"};if(i([66,90,104]))return{ext:"bz2",mime:"application/x-bzip2"};if(i([55,122,188,175,39,28]))return{ext:"7z",mime:"application/x-7z-compressed"};if(i([120,1]))return{ext:"dmg",mime:"application/x-apple-diskimage"};if(i([51,103,112,53])||i([0,0,0])&&i([102,116,121,112],{offset:4})&&(i([109,112,52,49],{offset:8})||i([109,112,52,50],{offset:8})||i([105,115,111,109],{offset:8})||i([105,115,111,50],{offset:8})||i([109,109,112,52],{offset:8})||i([77,52,86],{offset:8})||i([100,97,115,104],{offset:8})))return{ext:"mp4",mime:"video/mp4"};if(i([77,84,104,100]))return{ext:"mid",mime:"audio/midi"};if(i([26,69,223,163])){const t=e.subarray(4,4100),i=t.findIndex(((t,e,i)=>66===i[e]&&130===i[e+1]));if(-1!==i){const e=i+3,n=i=>[...i].every(((i,n)=>t[e+n]===i.charCodeAt(0)));if(n("matroska"))return{ext:"mkv",mime:"video/x-matroska"};if(n("webm"))return{ext:"webm",mime:"video/webm"}}}if(i([0,0,0,20,102,116,121,112,113,116,32,32])||i([102,114,101,101],{offset:4})||i([102,116,121,112,113,116,32,32],{offset:4})||i([109,100,97,116],{offset:4})||i([109,111,111,118],{offset:4})||i([119,105,100,101],{offset:4}))return{ext:"mov",mime:"video/quicktime"};if(i([82,73,70,70])){if(i([65,86,73],{offset:8}))return{ext:"avi",mime:"video/vnd.avi"};if(i([87,65,86,69],{offset:8}))return{ext:"wav",mime:"audio/vnd.wave"};if(i([81,76,67,77],{offset:8}))return{ext:"qcp",mime:"audio/qcelp"}}if(i([48,38,178,117,142,102,207,17,166,217])){let t=30;do{const n=readUInt64LE(e,t+16);if(i([145,7,220,183,183,169,207,17,142,230,0,192,12,32,83,101],{offset:t})){if(i([64,158,105,248,77,91,207,17,168,253,0,128,95,92,68,43],{offset:t+24}))return{ext:"wma",mime:"audio/x-ms-wma"};if(i([192,239,25,188,77,91,207,17,168,253,0,128,95,92,68,43],{offset:t+24}))return{ext:"wmv",mime:"video/x-ms-asf"};break}t+=n}while(t+24<=e.length);return{ext:"asf",mime:"application/vnd.ms-asf"}}if(i([0,0,1,186])||i([0,0,1,179]))return{ext:"mpg",mime:"video/mpeg"};if(i([102,116,121,112,51,103],{offset:4}))return{ext:"3gp",mime:"video/3gpp"};for(let t=0;t<2&&t<e.length-16;t++){if(i([73,68,51],{offset:t})||i([255,226],{offset:t,mask:[255,226]}))return{ext:"mp3",mime:"audio/mpeg"};if(i([255,228],{offset:t,mask:[255,228]}))return{ext:"mp2",mime:"audio/mpeg"};if(i([255,248],{offset:t,mask:[255,252]}))return{ext:"mp2",mime:"audio/mpeg"};if(i([255,240],{offset:t,mask:[255,252]}))return{ext:"mp4",mime:"audio/mpeg"}}if(i([102,116,121,112,77,52,65],{offset:4}))return{ext:"m4a",mime:"audio/mp4"};if(i([79,112,117,115,72,101,97,100],{offset:28}))return{ext:"opus",mime:"audio/opus"};if(i([79,103,103,83]))return i([128,116,104,101,111,114,97],{offset:28})?{ext:"ogv",mime:"video/ogg"}:i([1,118,105,100,101,111,0],{offset:28})?{ext:"ogm",mime:"video/ogg"}:i([127,70,76,65,67],{offset:28})?{ext:"oga",mime:"audio/ogg"}:i([83,112,101,101,120,32,32],{offset:28})?{ext:"spx",mime:"audio/ogg"}:i([1,118,111,114,98,105,115],{offset:28})?{ext:"ogg",mime:"audio/ogg"}:{ext:"ogx",mime:"application/ogg"};if(i([102,76,97,67]))return{ext:"flac",mime:"audio/x-flac"};if(i([77,65,67,32]))return{ext:"ape",mime:"audio/ape"};if(i([119,118,112,107]))return{ext:"wv",mime:"audio/wavpack"};if(i([35,33,65,77,82,10]))return{ext:"amr",mime:"audio/amr"};if(i([37,80,68,70]))return{ext:"pdf",mime:"application/pdf"};if(i([77,90]))return{ext:"exe",mime:"application/x-msdownload"};if((67===e[0]||70===e[0])&&i([87,83],{offset:1}))return{ext:"swf",mime:"application/x-shockwave-flash"};if(i([123,92,114,116,102]))return{ext:"rtf",mime:"application/rtf"};if(i([0,97,115,109]))return{ext:"wasm",mime:"application/wasm"};if(i([119,79,70,70])&&(i([0,1,0,0],{offset:4})||i([79,84,84,79],{offset:4})))return{ext:"woff",mime:"font/woff"};if(i([119,79,70,50])&&(i([0,1,0,0],{offset:4})||i([79,84,84,79],{offset:4})))return{ext:"woff2",mime:"font/woff2"};if(i([76,80],{offset:34})&&(i([0,0,1],{offset:8})||i([1,0,2],{offset:8})||i([2,0,2],{offset:8})))return{ext:"eot",mime:"application/vnd.ms-fontobject"};if(i([0,1,0,0,0]))return{ext:"ttf",mime:"font/ttf"};if(i([79,84,84,79,0]))return{ext:"otf",mime:"font/otf"};if(i([0,0,1,0]))return{ext:"ico",mime:"image/x-icon"};if(i([0,0,2,0]))return{ext:"cur",mime:"image/x-icon"};if(i([70,76,86,1]))return{ext:"flv",mime:"video/x-flv"};if(i([37,33]))return{ext:"ps",mime:"application/postscript"};if(i([253,55,122,88,90,0]))return{ext:"xz",mime:"application/x-xz"};if(i([83,81,76,105]))return{ext:"sqlite",mime:"application/x-sqlite3"};if(i([78,69,83,26]))return{ext:"nes",mime:"application/x-nintendo-nes-rom"};if(i([67,114,50,52]))return{ext:"crx",mime:"application/x-google-chrome-extension"};if(i([77,83,67,70])||i([73,83,99,40]))return{ext:"cab",mime:"application/vnd.ms-cab-compressed"};if(i([33,60,97,114,99,104,62,10,100,101,98,105,97,110,45,98,105,110,97,114,121]))return{ext:"deb",mime:"application/x-deb"};if(i([33,60,97,114,99,104,62]))return{ext:"ar",mime:"application/x-unix-archive"};if(i([237,171,238,219]))return{ext:"rpm",mime:"application/x-rpm"};if(i([31,160])||i([31,157]))return{ext:"Z",mime:"application/x-compress"};if(i([76,90,73,80]))return{ext:"lz",mime:"application/x-lzip"};if(i([208,207,17,224,161,177,26,225]))return{ext:"msi",mime:"application/x-msi"};if(i([6,14,43,52,2,5,1,1,13,1,2,1,1,2]))return{ext:"mxf",mime:"application/mxf"};if(i([71],{offset:4})&&(i([71],{offset:192})||i([71],{offset:196})))return{ext:"mts",mime:"video/mp2t"};if(i([66,76,69,78,68,69,82]))return{ext:"blend",mime:"application/x-blender"};if(i([66,80,71,251]))return{ext:"bpg",mime:"image/bpg"};if(i([0,0,0,12,106,80,32,32,13,10,135,10])){if(i([106,112,50,32],{offset:20}))return{ext:"jp2",mime:"image/jp2"};if(i([106,112,120,32],{offset:20}))return{ext:"jpx",mime:"image/jpx"};if(i([106,112,109,32],{offset:20}))return{ext:"jpm",mime:"image/jpm"};if(i([109,106,112,50],{offset:20}))return{ext:"mj2",mime:"image/mj2"}}if(i([70,79,82,77]))return{ext:"aif",mime:"audio/aiff"};if(n("<?xml "))return{ext:"xml",mime:"application/xml"};if(i([66,79,79,75,77,79,66,73],{offset:60}))return{ext:"mobi",mime:"application/x-mobipocket-ebook"};if(i([102,116,121,112],{offset:4})){if(i([109,105,102,49],{offset:8}))return{ext:"heic",mime:"image/heif"};if(i([109,115,102,49],{offset:8}))return{ext:"heic",mime:"image/heif-sequence"};if(i([104,101,105,99],{offset:8})||i([104,101,105,120],{offset:8}))return{ext:"heic",mime:"image/heic"};if(i([104,101,118,99],{offset:8})||i([104,101,118,120],{offset:8}))return{ext:"heic",mime:"image/heic-sequence"}}return i([171,75,84,88,32,49,49,187,13,10,26,10])?{ext:"ktx",mime:"image/ktx"}:i([68,73,67,77],{offset:128})?{ext:"dcm",mime:"application/dicom"}:i([77,80,43])||i([77,80,67,75])?{ext:"mpc",mime:"audio/x-musepack"}:i([66,69,71,73,78,58])?{ext:"ics",mime:"text/calendar"}:i([103,108,84,70,2,0,0,0])?{ext:"glb",mime:"model/gltf-binary"}:i([212,195,178,161])||i([161,178,195,212])?{ext:"pcap",mime:"application/vnd.tcpdump.pcap"}:null};module.exports=fileType,module.exports.default=fileType,Object.defineProperty(fileType,"minimumBytes",{value:4100}),module.exports.stream=readableStream=>new Promise(((resolve,reject)=>{const stream=eval("require")("stream");readableStream.once("readable",(()=>{const t=new stream.PassThrough,e=readableStream.read(module.exports.minimumBytes)||readableStream.read();try{t.fileType=fileType(e)}catch(t){reject(t)}readableStream.unshift(e),stream.pipeline?resolve(stream.pipeline(readableStream,t,(()=>{}))):resolve(readableStream.pipe(t))}))}))},2251:(t,e,i)=>{var n=Object.prototype.hasOwnProperty;t.exports=e=function(t,e){return n.call(e,t)},e.version=i(2898).version},9184:(t,e,i)=>{"use strict";const n=i(7769),r=new Set(["jpg","png","gif","webp","flif","cr2","tif","bmp","jxr","psd","ico","bpg","jp2","jpm","jpx","heic","cur","dcm"]),s=t=>{const e=n(t);return r.has(e&&e.ext)?e:null};t.exports=s,t.exports.default=s,Object.defineProperty(s,"minimumBytes",{value:n.minimumBytes})},2155:(t,e,i)=>{"use strict";function n(t,e="utf8"){return new TextDecoder(e).decode(t)}i.r(e),i.d(e,{IOBuffer:()=>a}),i(7396);const r=new TextEncoder,s=(()=>{const t=new Uint8Array(4);return!((new Uint32Array(t.buffer)[0]=1)&t[0])})(),o={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class a{constructor(t=8192,e={}){let i=!1;"number"==typeof t?t=new ArrayBuffer(t):(i=!0,this.lastWrittenByte=t.byteLength);const n=e.offset?e.offset>>>0:0,r=t.byteLength-n;let s=n;(ArrayBuffer.isView(t)||t instanceof a)&&(t.byteLength!==t.buffer.byteLength&&(s=t.byteOffset+n),t=t.buffer),this.lastWrittenByte=i?r:0,this.buffer=t,this.length=r,this.byteLength=r,this.byteOffset=s,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,s,r),this._mark=0,this._marks=[]}available(t=1){return this.offset+t<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(t=1){return this.offset+=t,this}back(t=1){return this.offset-=t,this}seek(t){return this.offset=t,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const t=this._marks.pop();if(void 0===t)throw new Error("Mark stack empty");return this.seek(t),this}rewind(){return this.offset=0,this}ensureAvailable(t=1){if(!this.available(t)){const e=2*(this.offset+t),i=new Uint8Array(e);i.set(new Uint8Array(this.buffer)),this.buffer=i.buffer,this.length=this.byteLength=e,this._data=new DataView(this.buffer)}return this}readBoolean(){return 0!==this.readUint8()}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(t=1){return this.readArray(t,"uint8")}readArray(t,e){const i=o[e].BYTES_PER_ELEMENT*t,n=this.byteOffset+this.offset,r=this.buffer.slice(n,n+i);if(this.littleEndian===s&&"uint8"!==e&&"int8"!==e){const t=new Uint8Array(this.buffer.slice(n,n+i));t.reverse();const r=new o[e](t.buffer);return this.offset+=i,r.reverse(),r}const a=new o[e](r);return this.offset+=i,a}readInt16(){const t=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,t}readUint16(){const t=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,t}readInt32(){const t=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,t}readUint32(){const t=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat32(){const t=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat64(){const t=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,t}readBigInt64(){const t=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,t}readBigUint64(){const t=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,t}readChar(){return String.fromCharCode(this.readInt8())}readChars(t=1){let e="";for(let i=0;i<t;i++)e+=this.readChar();return e}readUtf8(t=1){return n(this.readBytes(t))}decodeText(t=1,e="utf-8"){return n(this.readBytes(t),e)}writeBoolean(t){return this.writeUint8(t?255:0),this}writeInt8(t){return this.ensureAvailable(1),this._data.setInt8(this.offset++,t),this._updateLastWrittenByte(),this}writeUint8(t){return this.ensureAvailable(1),this._data.setUint8(this.offset++,t),this._updateLastWrittenByte(),this}writeByte(t){return this.writeUint8(t)}writeBytes(t){this.ensureAvailable(t.length);for(let e=0;e<t.length;e++)this._data.setUint8(this.offset++,t[e]);return this._updateLastWrittenByte(),this}writeInt16(t){return this.ensureAvailable(2),this._data.setInt16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(t){return this.ensureAvailable(2),this._data.setUint16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(t){return this.ensureAvailable(4),this._data.setInt32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(t){return this.ensureAvailable(4),this._data.setUint32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(t){return this.ensureAvailable(4),this._data.setFloat32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(t){return this.ensureAvailable(8),this._data.setFloat64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(t){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(t){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(t){return this.writeUint8(t.charCodeAt(0))}writeChars(t){for(let e=0;e<t.length;e++)this.writeUint8(t.charCodeAt(e));return this}writeUtf8(t){return this.writeBytes(function(t){return r.encode(t)}(t))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}},7396:function(){"use strict";!function(t){if(t.TextEncoder&&t.TextDecoder)return!1;function e(t="utf-8"){if("utf-8"!==t)throw new RangeError(`Failed to construct 'TextEncoder': The encoding label provided ('${t}') is invalid.`)}function i(t="utf-8",e={fatal:!1}){if("utf-8"!==t)throw new RangeError(`Failed to construct 'TextDecoder': The encoding label provided ('${t}') is invalid.`);if(e.fatal)throw new Error("Failed to construct 'TextDecoder': the 'fatal' option is unsupported.")}Object.defineProperty(e.prototype,"encoding",{value:"utf-8"}),e.prototype.encode=function(t,e={stream:!1}){if(e.stream)throw new Error("Failed to encode: the 'stream' option is unsupported.");let i=0;const n=t.length;let r=0,s=Math.max(32,n+(n>>1)+7),o=new Uint8Array(s>>3<<3);for(;i<n;){let e=t.charCodeAt(i++);if(e>=55296&&e<=56319){if(i<n){const n=t.charCodeAt(i);56320==(64512&n)&&(++i,e=((1023&e)<<10)+(1023&n)+65536)}if(e>=55296&&e<=56319)continue}if(r+4>o.length){s+=8,s*=1+i/t.length*2,s=s>>3<<3;const e=new Uint8Array(s);e.set(o),o=e}if(0!=(4294967168&e)){if(0==(4294965248&e))o[r++]=e>>6&31|192;else if(0==(4294901760&e))o[r++]=e>>12&15|224,o[r++]=e>>6&63|128;else{if(0!=(4292870144&e))continue;o[r++]=e>>18&7|240,o[r++]=e>>12&63|128,o[r++]=e>>6&63|128}o[r++]=63&e|128}else o[r++]=e}return o.slice(0,r)},Object.defineProperty(i.prototype,"encoding",{value:"utf-8"}),Object.defineProperty(i.prototype,"fatal",{value:!1}),Object.defineProperty(i.prototype,"ignoreBOM",{value:!1}),i.prototype.decode=function(t,e={stream:!1}){if(e.stream)throw new Error("Failed to decode: the 'stream' option is unsupported.");const i=new Uint8Array(t);let n=0;const r=i.length,s=[];for(;n<r;){const t=i[n++];if(0===t)break;if(0==(128&t))s.push(t);else if(192==(224&t)){const e=63&i[n++];s.push((31&t)<<6|e)}else if(224==(240&t)){const e=63&i[n++],r=63&i[n++];s.push((31&t)<<12|e<<6|r)}else if(240==(248&t)){let e=(7&t)<<18|(63&i[n++])<<12|(63&i[n++])<<6|63&i[n++];e>65535&&(e-=65536,s.push(e>>>10&1023|55296),e=56320|1023&e),s.push(e)}}return String.fromCharCode.apply(null,s)},t.TextEncoder=e,t.TextDecoder=i}("undefined"!=typeof window?window:"undefined"!=typeof self?self:this)},4091:(t,e,i)=>{"use strict";i.r(e),i.d(e,{isAnyArray:()=>r});const n=Object.prototype.toString;function r(t){const e=n.call(t);return e.endsWith("Array]")&&!e.includes("Big")}},7811:t=>{"use strict";var e=Object.prototype.toString;t.exports=function(t){return"Array"===e.call(t).substr(-6,5)}},1867:t=>{"use strict";t.exports=Number.isFinite||function(t){return!("number"!=typeof t||t!=t||t===1/0||t===-1/0)}},8336:(t,e,i)=>{var n=i(1867);t.exports=Number.isInteger||function(t){return"number"==typeof t&&n(t)&&Math.floor(t)===t}},7870:(t,e,i)=>{var n=i(587),r=i(914);t.exports={encode:n,decode:r}},914:t=>{var e=function(){"use strict";var t=new Int32Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]),e=4017,i=799,n=3406,r=2276,s=1567,o=3784,a=5793,l=2896;function h(){}function c(t,e){for(var i,n,r=0,s=[],o=16;o>0&&!t[o-1];)o--;s.push({children:[],index:0});var a,l=s[0];for(i=0;i<o;i++){for(n=0;n<t[i];n++){for((l=s.pop()).children[l.index]=e[r];l.index>0;){if(0===s.length)throw new Error("Could not recreate Huffman Table");l=s.pop()}for(l.index++,s.push(l);s.length<=i;)s.push(a={children:[],index:0}),l.children[l.index]=a.children,l=a;r++}i+1<o&&(s.push(a={children:[],index:0}),l.children[l.index]=a.children,l=a)}return s[0].children}function u(e,i,n,r,s,o,a,l,h,c){n.precision,n.samplesPerLine,n.scanLines;var u=n.mcusPerLine,d=n.progressive,g=(n.maxH,n.maxV,i),f=0,p=0;function m(){if(p>0)return p--,f>>p&1;if(255==(f=e[i++])){var t=e[i++];if(t)throw new Error("unexpected marker: "+(f<<8|t).toString(16))}return p=7,f>>>7}function _(t){for(var e,i=t;null!==(e=m());){if("number"==typeof(i=i[e]))return i;if("object"!=typeof i)throw new Error("invalid huffman sequence")}return null}function y(t){for(var e=0;t>0;){var i=m();if(null===i)return;e=e<<1|i,t--}return e}function w(t){var e=y(t);return e>=1<<t-1?e:e+(-1<<t)+1}var x,b=0,v=0;function E(t,e,i,n,r){var s=i%u,o=(i/u|0)*t.v+n,a=s*t.h+r;void 0===t.blocks[o]&&c.tolerantDecoding||e(t,t.blocks[o][a])}function S(t,e,i){var n=i/t.blocksPerLine|0,r=i%t.blocksPerLine;void 0===t.blocks[n]&&c.tolerantDecoding||e(t,t.blocks[n][r])}var I,M,C,T,R,A,k=r.length;A=d?0===o?0===l?function(t,e){var i=_(t.huffmanTableDC),n=0===i?0:w(i)<<h;e[0]=t.pred+=n}:function(t,e){e[0]|=m()<<h}:0===l?function(e,i){if(b>0)b--;else for(var n=o,r=a;n<=r;){var s=_(e.huffmanTableAC),l=15&s,c=s>>4;if(0!==l)i[t[n+=c]]=w(l)*(1<<h),n++;else{if(c<15){b=y(c)+(1<<c)-1;break}n+=16}}}:function(e,i){for(var n=o,r=a,s=0;n<=r;){var l=t[n],c=i[l]<0?-1:1;switch(v){case 0:var u=_(e.huffmanTableAC),d=15&u;if(s=u>>4,0===d)s<15?(b=y(s)+(1<<s),v=4):(s=16,v=1);else{if(1!==d)throw new Error("invalid ACn encoding");x=w(d),v=s?2:3}continue;case 1:case 2:i[l]?i[l]+=(m()<<h)*c:0==--s&&(v=2==v?3:0);break;case 3:i[l]?i[l]+=(m()<<h)*c:(i[l]=x<<h,v=0);break;case 4:i[l]&&(i[l]+=(m()<<h)*c)}n++}4===v&&0==--b&&(v=0)}:function(e,i){var n=_(e.huffmanTableDC),r=0===n?0:w(n);i[0]=e.pred+=r;for(var s=1;s<64;){var o=_(e.huffmanTableAC),a=15&o,l=o>>4;if(0!==a)i[t[s+=l]]=w(a),s++;else{if(l<15)break;s+=16}}};var P,L,N,D,O=0;for(L=1==k?r[0].blocksPerLine*r[0].blocksPerColumn:u*n.mcusPerColumn,s||(s=L);O<L;){for(M=0;M<k;M++)r[M].pred=0;if(b=0,1==k)for(I=r[0],R=0;R<s;R++)S(I,A,O),O++;else for(R=0;R<s;R++){for(M=0;M<k;M++)for(N=(I=r[M]).h,D=I.v,C=0;C<D;C++)for(T=0;T<N;T++)E(I,A,O,C,T);if(++O===L)break}if(O===L)do{if(255===e[i]&&0!==e[i+1])break;i+=1}while(i<e.length-2);if(p=0,(P=e[i]<<8|e[i+1])<65280)throw new Error("marker was not found");if(!(P>=65488&&P<=65495))break;i+=2}return i-g}function d(t,h){var c,u,d=[],g=h.blocksPerLine,f=h.blocksPerColumn,p=g<<3,_=new Int32Array(64),y=new Uint8Array(64);function w(t,c,u){var d,g,f,p,m,_,y,w,x,b,v=h.quantizationTable,E=u;for(b=0;b<64;b++)E[b]=t[b]*v[b];for(b=0;b<8;++b){var S=8*b;0!=E[1+S]||0!=E[2+S]||0!=E[3+S]||0!=E[4+S]||0!=E[5+S]||0!=E[6+S]||0!=E[7+S]?(d=a*E[0+S]+128>>8,g=a*E[4+S]+128>>8,f=E[2+S],p=E[6+S],m=l*(E[1+S]-E[7+S])+128>>8,w=l*(E[1+S]+E[7+S])+128>>8,_=E[3+S]<<4,y=E[5+S]<<4,x=d-g+1>>1,d=d+g+1>>1,g=x,x=f*o+p*s+128>>8,f=f*s-p*o+128>>8,p=x,x=m-y+1>>1,m=m+y+1>>1,y=x,x=w+_+1>>1,_=w-_+1>>1,w=x,x=d-p+1>>1,d=d+p+1>>1,p=x,x=g-f+1>>1,g=g+f+1>>1,f=x,x=m*r+w*n+2048>>12,m=m*n-w*r+2048>>12,w=x,x=_*i+y*e+2048>>12,_=_*e-y*i+2048>>12,y=x,E[0+S]=d+w,E[7+S]=d-w,E[1+S]=g+y,E[6+S]=g-y,E[2+S]=f+_,E[5+S]=f-_,E[3+S]=p+m,E[4+S]=p-m):(x=a*E[0+S]+512>>10,E[0+S]=x,E[1+S]=x,E[2+S]=x,E[3+S]=x,E[4+S]=x,E[5+S]=x,E[6+S]=x,E[7+S]=x)}for(b=0;b<8;++b){var I=b;0!=E[8+I]||0!=E[16+I]||0!=E[24+I]||0!=E[32+I]||0!=E[40+I]||0!=E[48+I]||0!=E[56+I]?(d=a*E[0+I]+2048>>12,g=a*E[32+I]+2048>>12,f=E[16+I],p=E[48+I],m=l*(E[8+I]-E[56+I])+2048>>12,w=l*(E[8+I]+E[56+I])+2048>>12,_=E[24+I],y=E[40+I],x=d-g+1>>1,d=d+g+1>>1,g=x,x=f*o+p*s+2048>>12,f=f*s-p*o+2048>>12,p=x,x=m-y+1>>1,m=m+y+1>>1,y=x,x=w+_+1>>1,_=w-_+1>>1,w=x,x=d-p+1>>1,d=d+p+1>>1,p=x,x=g-f+1>>1,g=g+f+1>>1,f=x,x=m*r+w*n+2048>>12,m=m*n-w*r+2048>>12,w=x,x=_*i+y*e+2048>>12,_=_*e-y*i+2048>>12,y=x,E[0+I]=d+w,E[56+I]=d-w,E[8+I]=g+y,E[48+I]=g-y,E[16+I]=f+_,E[40+I]=f-_,E[24+I]=p+m,E[32+I]=p-m):(x=a*u[b+0]+8192>>14,E[0+I]=x,E[8+I]=x,E[16+I]=x,E[24+I]=x,E[32+I]=x,E[40+I]=x,E[48+I]=x,E[56+I]=x)}for(b=0;b<64;++b){var M=128+(E[b]+8>>4);c[b]=M<0?0:M>255?255:M}}m(p*f*8);for(var x=0;x<f;x++){var b=x<<3;for(c=0;c<8;c++)d.push(new Uint8Array(p));for(var v=0;v<g;v++){w(h.blocks[x][v],y,_);var E=0,S=v<<3;for(u=0;u<8;u++){var I=d[b+u];for(c=0;c<8;c++)I[S+c]=y[E++]}}}return d}function g(t){return t<0?0:t>255?255:t}h.prototype={load:function(t){var e=new XMLHttpRequest;e.open("GET",t,!0),e.responseType="arraybuffer",e.onload=function(){var t=new Uint8Array(e.response||e.mozResponseArrayBuffer);this.parse(t),this.onload&&this.onload()}.bind(this),e.send(null)},parse:function(e){var i=1e3*this.opts.maxResolutionInMP*1e3,n=0;function r(){var t=e[n]<<8|e[n+1];return n+=2,t}function s(t){var e,i,n=1,r=1;for(i in t.components)t.components.hasOwnProperty(i)&&(n<(e=t.components[i]).h&&(n=e.h),r<e.v&&(r=e.v));var s=Math.ceil(t.samplesPerLine/8/n),o=Math.ceil(t.scanLines/8/r);for(i in t.components)if(t.components.hasOwnProperty(i)){e=t.components[i];var a=Math.ceil(Math.ceil(t.samplesPerLine/8)*e.h/n),l=Math.ceil(Math.ceil(t.scanLines/8)*e.v/r),h=s*e.h,c=o*e.v,u=[];m(c*h*256);for(var d=0;d<c;d++){for(var g=[],f=0;f<h;f++)g.push(new Int32Array(64));u.push(g)}e.blocksPerLine=a,e.blocksPerColumn=l,e.blocks=u}t.maxH=n,t.maxV=r,t.mcusPerLine=s,t.mcusPerColumn=o}e.length;var o,a,l,h,g=null,f=null,p=[],_=[],y=[],w=[],x=r(),b=-1;if(this.comments=[],65496!=x)throw new Error("SOI not found");for(x=r();65497!=x;){switch(x){case 65280:break;case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:var v=(l=void 0,h=void 0,l=r(),h=e.subarray(n,n+l-2),n+=h.length,h);if(65534===x){var E=String.fromCharCode.apply(null,v);this.comments.push(E)}65504===x&&74===v[0]&&70===v[1]&&73===v[2]&&70===v[3]&&0===v[4]&&(g={version:{major:v[5],minor:v[6]},densityUnits:v[7],xDensity:v[8]<<8|v[9],yDensity:v[10]<<8|v[11],thumbWidth:v[12],thumbHeight:v[13],thumbData:v.subarray(14,14+3*v[12]*v[13])}),65505===x&&69===v[0]&&120===v[1]&&105===v[2]&&102===v[3]&&0===v[4]&&(this.exifBuffer=v.subarray(5,v.length)),65518===x&&65===v[0]&&100===v[1]&&111===v[2]&&98===v[3]&&101===v[4]&&0===v[5]&&(f={version:v[6],flags0:v[7]<<8|v[8],flags1:v[9]<<8|v[10],transformCode:v[11]});break;case 65499:for(var S=r()+n-2;n<S;){var I=e[n++];m(256);var M=new Int32Array(64);if(I>>4==0)for(Z=0;Z<64;Z++)M[t[Z]]=e[n++];else{if(I>>4!=1)throw new Error("DQT: invalid table spec");for(Z=0;Z<64;Z++)M[t[Z]]=r()}p[15&I]=M}break;case 65472:case 65473:case 65474:r(),(o={}).extended=65473===x,o.progressive=65474===x,o.precision=e[n++],o.scanLines=r(),o.samplesPerLine=r(),o.components={},o.componentsOrder=[];var C=o.scanLines*o.samplesPerLine;if(C>i){var T=Math.ceil((C-i)/1e6);throw new Error(`maxResolutionInMP limit exceeded by ${T}MP`)}var R,A=e[n++];for(j=0;j<A;j++){R=e[n];var k=e[n+1]>>4,P=15&e[n+1],L=e[n+2];if(k<=0||P<=0)throw new Error("Invalid sampling factor, expected values above 0");o.componentsOrder.push(R),o.components[R]={h:k,v:P,quantizationIdx:L},n+=3}s(o),_.push(o);break;case 65476:var N=r();for(j=2;j<N;){var D=e[n++],O=new Uint8Array(16),F=0;for(Z=0;Z<16;Z++,n++)F+=O[Z]=e[n];m(16+F);var z=new Uint8Array(F);for(Z=0;Z<F;Z++,n++)z[Z]=e[n];j+=17+F,(D>>4==0?w:y)[15&D]=c(O,z)}break;case 65501:r(),a=r();break;case 65500:r(),r();break;case 65498:r();var B=e[n++],G=[];for(j=0;j<B;j++){H=o.components[e[n++]];var Y=e[n++];H.huffmanTableDC=w[Y>>4],H.huffmanTableAC=y[15&Y],G.push(H)}var U=e[n++],X=e[n++],q=e[n++],V=u(e,n,o,G,a,U,X,q>>4,15&q,this.opts);n+=V;break;case 65535:255!==e[n]&&n--;break;default:if(255==e[n-3]&&e[n-2]>=192&&e[n-2]<=254){n-=3;break}if(224===x||225==x){if(-1!==b)throw new Error(`first unknown JPEG marker at offset ${b.toString(16)}, second unknown JPEG marker ${x.toString(16)} at offset ${(n-1).toString(16)}`);b=n-1;const t=r();if(255===e[n+t-2]){n+=t-2;break}}throw new Error("unknown JPEG marker "+x.toString(16))}x=r()}if(1!=_.length)throw new Error("only single frame JPEGs supported");for(var j=0;j<_.length;j++){var W=_[j].components;for(var Z in W)W[Z].quantizationTable=p[W[Z].quantizationIdx],delete W[Z].quantizationIdx}for(this.width=o.samplesPerLine,this.height=o.scanLines,this.jfif=g,this.adobe=f,this.components=[],j=0;j<o.componentsOrder.length;j++){var H=o.components[o.componentsOrder[j]];this.components.push({lines:d(0,H),scaleX:H.h/o.maxH,scaleY:H.v/o.maxV})}},getData:function(t,e){var i,n,r,s,o,a,l,h,c,u,d,f,p,_,y,w,x,b,v,E,S,I=this.width/t,M=this.height/e,C=0,T=t*e*this.components.length;m(T);var R=new Uint8Array(T);switch(this.components.length){case 1:for(i=this.components[0],u=0;u<e;u++)for(o=i.lines[0|u*i.scaleY*M],c=0;c<t;c++)d=o[0|c*i.scaleX*I],R[C++]=d;break;case 2:for(i=this.components[0],n=this.components[1],u=0;u<e;u++)for(o=i.lines[0|u*i.scaleY*M],a=n.lines[0|u*n.scaleY*M],c=0;c<t;c++)d=o[0|c*i.scaleX*I],R[C++]=d,d=a[0|c*n.scaleX*I],R[C++]=d;break;case 3:for(S=!0,this.adobe&&this.adobe.transformCode?S=!0:void 0!==this.opts.colorTransform&&(S=!!this.opts.colorTransform),i=this.components[0],n=this.components[1],r=this.components[2],u=0;u<e;u++)for(o=i.lines[0|u*i.scaleY*M],a=n.lines[0|u*n.scaleY*M],l=r.lines[0|u*r.scaleY*M],c=0;c<t;c++)S?(d=o[0|c*i.scaleX*I],f=a[0|c*n.scaleX*I],b=g(d+1.402*((p=l[0|c*r.scaleX*I])-128)),v=g(d-.3441363*(f-128)-.71413636*(p-128)),E=g(d+1.772*(f-128))):(b=o[0|c*i.scaleX*I],v=a[0|c*n.scaleX*I],E=l[0|c*r.scaleX*I]),R[C++]=b,R[C++]=v,R[C++]=E;break;case 4:if(!this.adobe)throw new Error("Unsupported color mode (4 components)");for(S=!1,this.adobe&&this.adobe.transformCode?S=!0:void 0!==this.opts.colorTransform&&(S=!!this.opts.colorTransform),i=this.components[0],n=this.components[1],r=this.components[2],s=this.components[3],u=0;u<e;u++)for(o=i.lines[0|u*i.scaleY*M],a=n.lines[0|u*n.scaleY*M],l=r.lines[0|u*r.scaleY*M],h=s.lines[0|u*s.scaleY*M],c=0;c<t;c++)S?(d=o[0|c*i.scaleX*I],f=a[0|c*n.scaleX*I],p=l[0|c*r.scaleX*I],_=h[0|c*s.scaleX*I],y=255-g(d+1.402*(p-128)),w=255-g(d-.3441363*(f-128)-.71413636*(p-128)),x=255-g(d+1.772*(f-128))):(y=o[0|c*i.scaleX*I],w=a[0|c*n.scaleX*I],x=l[0|c*r.scaleX*I],_=h[0|c*s.scaleX*I]),R[C++]=255-y,R[C++]=255-w,R[C++]=255-x,R[C++]=255-_;break;default:throw new Error("Unsupported color mode")}return R},copyToImageData:function(t,e){var i,n,r,s,o,a,l,h,c,u=t.width,d=t.height,f=t.data,p=this.getData(u,d),m=0,_=0;switch(this.components.length){case 1:for(n=0;n<d;n++)for(i=0;i<u;i++)r=p[m++],f[_++]=r,f[_++]=r,f[_++]=r,e&&(f[_++]=255);break;case 3:for(n=0;n<d;n++)for(i=0;i<u;i++)l=p[m++],h=p[m++],c=p[m++],f[_++]=l,f[_++]=h,f[_++]=c,e&&(f[_++]=255);break;case 4:for(n=0;n<d;n++)for(i=0;i<u;i++)o=p[m++],a=p[m++],r=p[m++],l=255-g(o*(1-(s=p[m++])/255)+s),h=255-g(a*(1-s/255)+s),c=255-g(r*(1-s/255)+s),f[_++]=l,f[_++]=h,f[_++]=c,e&&(f[_++]=255);break;default:throw new Error("Unsupported color mode")}}};var f=0,p=0;function m(t=0){var e=f+t;if(e>p){var i=Math.ceil((e-p)/1024/1024);throw new Error(`maxMemoryUsageInMB limit exceeded by at least ${i}MB`)}f=e}return h.resetMaxMemoryUsage=function(t){f=0,p=t},h.getBytesAllocated=function(){return f},h.requestMemoryAllocation=m,h}();t.exports=function(t,i={}){var n={colorTransform:void 0,useTArray:!1,formatAsRGBA:!0,tolerantDecoding:!0,maxResolutionInMP:100,maxMemoryUsageInMB:512,...i},r=new Uint8Array(t),s=new e;s.opts=n,e.resetMaxMemoryUsage(1024*n.maxMemoryUsageInMB*1024),s.parse(r);var o=n.formatAsRGBA?4:3,a=s.width*s.height*o;try{e.requestMemoryAllocation(a);var l={width:s.width,height:s.height,exifBuffer:s.exifBuffer,data:n.useTArray?new Uint8Array(a):Buffer.alloc(a)};s.comments.length>0&&(l.comments=s.comments)}catch(t){if(t instanceof RangeError)throw new Error("Could not allocate enough memory for the image. Required: "+a);if(t instanceof ReferenceError&&"Buffer is not defined"===t.message)throw new Error("Buffer is not globally defined in this environment. Consider setting useTArray to true");throw t}return s.copyToImageData(l,n.formatAsRGBA),l}},587:t=>{function e(t){Math.round;var e,i,n,r,s,o=Math.floor,a=new Array(64),l=new Array(64),h=new Array(64),c=new Array(64),u=new Array(65535),d=new Array(65535),g=new Array(64),f=new Array(64),p=[],m=0,_=7,y=new Array(64),w=new Array(64),x=new Array(64),b=new Array(256),v=new Array(2048),E=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],S=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],I=[0,1,2,3,4,5,6,7,8,9,10,11],M=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],C=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],T=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],R=[0,1,2,3,4,5,6,7,8,9,10,11],A=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],k=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function P(t,e){for(var i=0,n=0,r=new Array,s=1;s<=16;s++){for(var o=1;o<=t[s];o++)r[e[n]]=[],r[e[n]][0]=i,r[e[n]][1]=s,n++,i++;i*=2}return r}function L(t){for(var e=t[0],i=t[1]-1;i>=0;)e&1<<i&&(m|=1<<_),i--,--_<0&&(255==m?(N(255),N(0)):N(m),_=7,m=0)}function N(t){p.push(t)}function D(t){N(t>>8&255),N(255&t)}function O(t,e,i,n,r){for(var s,o=r[0],a=r[240],l=function(t,e){var i,n,r,s,o,a,l,h,c,u,d=0;for(c=0;c<8;++c){i=t[d],n=t[d+1],r=t[d+2],s=t[d+3],o=t[d+4],a=t[d+5],l=t[d+6];var f=i+(h=t[d+7]),p=i-h,m=n+l,_=n-l,y=r+a,w=r-a,x=s+o,b=s-o,v=f+x,E=f-x,S=m+y,I=m-y;t[d]=v+S,t[d+4]=v-S;var M=.707106781*(I+E);t[d+2]=E+M,t[d+6]=E-M;var C=.382683433*((v=b+w)-(I=_+p)),T=.5411961*v+C,R=1.306562965*I+C,A=.707106781*(S=w+_),k=p+A,P=p-A;t[d+5]=P+T,t[d+3]=P-T,t[d+1]=k+R,t[d+7]=k-R,d+=8}for(d=0,c=0;c<8;++c){i=t[d],n=t[d+8],r=t[d+16],s=t[d+24],o=t[d+32],a=t[d+40],l=t[d+48];var L=i+(h=t[d+56]),N=i-h,D=n+l,O=n-l,F=r+a,z=r-a,B=s+o,G=s-o,Y=L+B,U=L-B,X=D+F,q=D-F;t[d]=Y+X,t[d+32]=Y-X;var V=.707106781*(q+U);t[d+16]=U+V,t[d+48]=U-V;var j=.382683433*((Y=G+z)-(q=O+N)),W=.5411961*Y+j,Z=1.306562965*q+j,H=.707106781*(X=z+O),K=N+H,$=N-H;t[d+40]=$+W,t[d+24]=$-W,t[d+8]=K+Z,t[d+56]=K-Z,d++}for(c=0;c<64;++c)u=t[c]*e[c],g[c]=u>0?u+.5|0:u-.5|0;return g}(t,e),h=0;h<64;++h)f[E[h]]=l[h];var c=f[0]-i;i=f[0],0==c?L(n[0]):(L(n[d[s=32767+c]]),L(u[s]));for(var p=63;p>0&&0==f[p];p--);if(0==p)return L(o),i;for(var m,_=1;_<=p;){for(var y=_;0==f[_]&&_<=p;++_);var w=_-y;if(w>=16){m=w>>4;for(var x=1;x<=m;++x)L(a);w&=15}s=32767+f[_],L(r[(w<<4)+d[s]]),L(u[s]),_++}return 63!=p&&L(o),i}function F(t){t<=0&&(t=1),t>100&&(t=100),s!=t&&(function(t){for(var e=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],i=0;i<64;i++){var n=o((e[i]*t+50)/100);n<1?n=1:n>255&&(n=255),a[E[i]]=n}for(var r=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],s=0;s<64;s++){var u=o((r[s]*t+50)/100);u<1?u=1:u>255&&(u=255),l[E[s]]=u}for(var d=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],g=0,f=0;f<8;f++)for(var p=0;p<8;p++)h[g]=1/(a[E[g]]*d[f]*d[p]*8),c[g]=1/(l[E[g]]*d[f]*d[p]*8),g++}(t<50?Math.floor(5e3/t):Math.floor(200-2*t)),s=t)}this.encode=function(t,s){var o;(new Date).getTime(),s&&F(s),p=new Array,m=0,_=7,D(65496),D(65504),D(16),N(74),N(70),N(73),N(70),N(0),N(1),N(1),N(0),D(1),D(1),N(0),N(0),void 0!==(o=t.comments)&&o.constructor===Array&&o.forEach((t=>{if("string"==typeof t){D(65534);var e,i=t.length;for(D(i+2),e=0;e<i;e++)N(t.charCodeAt(e))}})),function(t){if(t){D(65505),69===t[0]&&120===t[1]&&105===t[2]&&102===t[3]?D(t.length+2):(D(t.length+5+2),N(69),N(120),N(105),N(102),N(0));for(var e=0;e<t.length;e++)N(t[e])}}(t.exifBuffer),function(){D(65499),D(132),N(0);for(var t=0;t<64;t++)N(a[t]);N(1);for(var e=0;e<64;e++)N(l[e])}(),function(t,e){D(65472),D(17),N(8),D(e),D(t),N(3),N(1),N(17),N(0),N(2),N(17),N(1),N(3),N(17),N(1)}(t.width,t.height),function(){D(65476),D(418),N(0);for(var t=0;t<16;t++)N(S[t+1]);for(var e=0;e<=11;e++)N(I[e]);N(16);for(var i=0;i<16;i++)N(M[i+1]);for(var n=0;n<=161;n++)N(C[n]);N(1);for(var r=0;r<16;r++)N(T[r+1]);for(var s=0;s<=11;s++)N(R[s]);N(17);for(var o=0;o<16;o++)N(A[o+1]);for(var a=0;a<=161;a++)N(k[a])}(),D(65498),D(12),N(3),N(1),N(0),N(2),N(17),N(3),N(17),N(0),N(63),N(0);var u=0,d=0,g=0;m=0,_=7,this.encode.displayName="_encode_";for(var f,b,E,P,z,B,G,Y,U,X=t.data,q=t.width,V=t.height,j=4*q,W=0;W<V;){for(f=0;f<j;){for(B=z=j*W+f,G=-1,Y=0,U=0;U<64;U++)B=z+(Y=U>>3)*j+(G=4*(7&U)),W+Y>=V&&(B-=j*(W+1+Y-V)),f+G>=j&&(B-=f+G-j+4),b=X[B++],E=X[B++],P=X[B++],y[U]=(v[b]+v[E+256>>0]+v[P+512>>0]>>16)-128,w[U]=(v[b+768>>0]+v[E+1024>>0]+v[P+1280>>0]>>16)-128,x[U]=(v[b+1280>>0]+v[E+1536>>0]+v[P+1792>>0]>>16)-128;u=O(y,h,u,e,n),d=O(w,c,d,i,r),g=O(x,c,g,i,r),f+=32}W+=8}if(_>=0){var Z=[];Z[1]=_+1,Z[0]=(1<<_+1)-1,L(Z)}return D(65497),Buffer.from(p)},(new Date).getTime(),t||(t=50),function(){for(var t=String.fromCharCode,e=0;e<256;e++)b[e]=t(e)}(),e=P(S,I),i=P(T,R),n=P(M,C),r=P(A,k),function(){for(var t=1,e=2,i=1;i<=15;i++){for(var n=t;n<e;n++)d[32767+n]=i,u[32767+n]=[],u[32767+n][1]=i,u[32767+n][0]=n;for(var r=-(e-1);r<=-t;r++)d[32767+r]=i,u[32767+r]=[],u[32767+r][1]=i,u[32767+r][0]=e-1+r;t<<=1,e<<=1}}(),function(){for(var t=0;t<256;t++)v[t]=19595*t,v[t+256>>0]=38470*t,v[t+512>>0]=7471*t+32768,v[t+768>>0]=-11059*t,v[t+1024>>0]=-21709*t,v[t+1280>>0]=32768*t+8421375,v[t+1536>>0]=-27439*t,v[t+1792>>0]=-5329*t}(),F(t),(new Date).getTime()}t.exports=function(t,i){return void 0===i&&(i=50),{data:new e(i).encode(t,i),width:t.width,height:t.height}}},5307:t=>{t.exports=function t(e,i,n){function r(o,a){if(!i[o]){if(!e[o]){if(s)return s(o,!0);var l=new Error("Cannot find module '"+o+"'");throw l.code="MODULE_NOT_FOUND",l}var h=i[o]={exports:{}};e[o][0].call(h.exports,(function(t){return r(e[o][1][t]||t)}),h,h.exports,t,e,i,n)}return i[o].exports}for(var s=void 0,o=0;o<n.length;o++)r(n[o]);return r}({1:[function(t,e,i){var n,r,s,o,a,l={}.hasOwnProperty;n=t("./PriorityQueue/AbstractPriorityQueue"),r=t("./PriorityQueue/ArrayStrategy"),o=t("./PriorityQueue/BinaryHeapStrategy"),s=t("./PriorityQueue/BHeapStrategy"),(a=function(t){function e(t){t||(t={}),t.strategy||(t.strategy=o),t.comparator||(t.comparator=function(t,e){return(t||0)-(e||0)}),e.__super__.constructor.call(this,t)}return function(t,e){for(var i in e)l.call(e,i)&&(t[i]=e[i]);function n(){this.constructor=t}n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype}(e,t),e}(n)).ArrayStrategy=r,a.BinaryHeapStrategy=o,a.BHeapStrategy=s,e.exports=a},{"./PriorityQueue/AbstractPriorityQueue":2,"./PriorityQueue/ArrayStrategy":3,"./PriorityQueue/BHeapStrategy":4,"./PriorityQueue/BinaryHeapStrategy":5}],2:[function(t,e,i){e.exports=function(){function t(t){var e;if(null==(null!=t?t.strategy:void 0))throw"Must pass options.strategy, a strategy";if(null==(null!=t?t.comparator:void 0))throw"Must pass options.comparator, a comparator";this.priv=new t.strategy(t),this.length=(null!=t&&null!=(e=t.initialValues)?e.length:void 0)||0}return t.prototype.queue=function(t){this.length++,this.priv.queue(t)},t.prototype.dequeue=function(t){if(!this.length)throw"Empty queue";return this.length--,this.priv.dequeue()},t.prototype.peek=function(t){if(!this.length)throw"Empty queue";return this.priv.peek()},t.prototype.clear=function(){return this.length=0,this.priv.clear()},t}()},{}],3:[function(t,e,i){var n;n=function(t,e,i){var n,r,s;for(r=0,n=t.length;r<n;)i(t[s=r+n>>>1],e)>=0?r=s+1:n=s;return r},e.exports=function(){function t(t){var e;this.options=t,this.comparator=this.options.comparator,this.data=(null!=(e=this.options.initialValues)?e.slice(0):void 0)||[],this.data.sort(this.comparator).reverse()}return t.prototype.queue=function(t){var e;e=n(this.data,t,this.comparator),this.data.splice(e,0,t)},t.prototype.dequeue=function(){return this.data.pop()},t.prototype.peek=function(){return this.data[this.data.length-1]},t.prototype.clear=function(){this.data.length=0},t}()},{}],4:[function(t,e,i){e.exports=function(){function t(t){var e,i,n,r,s,o,a,l;for(this.comparator=(null!=t?t.comparator:void 0)||function(t,e){return t-e},this.pageSize=(null!=t?t.pageSize:void 0)||512,this.length=0,a=0;1<<a<this.pageSize;)a+=1;if(1<<a!==this.pageSize)throw"pageSize must be a power of two";for(this._shift=a,this._emptyMemoryPageTemplate=e=[],i=0,s=this.pageSize;0<=s?i<s:i>s;0<=s?++i:--i)e.push(null);if(this._memory=[],this._mask=this.pageSize-1,t.initialValues)for(n=0,r=(o=t.initialValues).length;n<r;n++)l=o[n],this.queue(l)}return t.prototype.queue=function(t){this.length+=1,this._write(this.length,t),this._bubbleUp(this.length,t)},t.prototype.dequeue=function(){var t,e;return t=this._read(1),e=this._read(this.length),this.length-=1,this.length>0&&(this._write(1,e),this._bubbleDown(1,e)),t},t.prototype.peek=function(){return this._read(1)},t.prototype.clear=function(){this.length=0,this._memory.length=0},t.prototype._write=function(t,e){var i;for(i=t>>this._shift;i>=this._memory.length;)this._memory.push(this._emptyMemoryPageTemplate.slice(0));return this._memory[i][t&this._mask]=e},t.prototype._read=function(t){return this._memory[t>>this._shift][t&this._mask]},t.prototype._bubbleUp=function(t,e){var i,n,r,s;for(i=this.comparator;t>1&&(n=t&this._mask,t<this.pageSize||n>3?r=t&~this._mask|n>>1:n<2?(r=t-this.pageSize>>this._shift,r+=r&~(this._mask>>1),r|=this.pageSize>>1):r=t-2,!(i(s=this._read(r),e)<0));)this._write(r,e),this._write(t,s),t=r},t.prototype._bubbleDown=function(t,e){var i,n,r,s,o;for(o=this.comparator;t<this.length;)if(t>this._mask&&!(t&this._mask-1)?i=n=t+2:t&this.pageSize>>1?(i=(t&~this._mask)>>1,n=1+(i=1+(i|=t&this._mask>>1)<<this._shift)):n=(i=t+(t&this._mask))+1,i!==n&&n<=this.length)if(r=this._read(i),s=this._read(n),o(r,e)<0&&o(r,s)<=0)this._write(i,e),this._write(t,r),t=i;else{if(!(o(s,e)<0))break;this._write(n,e),this._write(t,s),t=n}else{if(!(i<=this.length))break;if(!(o(r=this._read(i),e)<0))break;this._write(i,e),this._write(t,r),t=i}},t}()},{}],5:[function(t,e,i){e.exports=function(){function t(t){var e;this.comparator=(null!=t?t.comparator:void 0)||function(t,e){return t-e},this.length=0,this.data=(null!=(e=t.initialValues)?e.slice(0):void 0)||[],this._heapify()}return t.prototype._heapify=function(){var t,e,i;if(this.data.length>0)for(t=e=1,i=this.data.length;1<=i?e<i:e>i;t=1<=i?++e:--e)this._bubbleUp(t)},t.prototype.queue=function(t){this.data.push(t),this._bubbleUp(this.data.length-1)},t.prototype.dequeue=function(){var t,e;return e=this.data[0],t=this.data.pop(),this.data.length>0&&(this.data[0]=t,this._bubbleDown(0)),e},t.prototype.peek=function(){return this.data[0]},t.prototype.clear=function(){this.length=0,this.data.length=0},t.prototype._bubbleUp=function(t){for(var e,i;t>0&&(e=t-1>>>1,this.comparator(this.data[t],this.data[e])<0);)i=this.data[e],this.data[e]=this.data[t],this.data[t]=i,t=e},t.prototype._bubbleDown=function(t){var e,i,n,r,s;for(e=this.data.length-1;r=1+(i=1+(t<<1)),n=t,i<=e&&this.comparator(this.data[i],this.data[n])<0&&(n=i),r<=e&&this.comparator(this.data[r],this.data[n])<0&&(n=r),n!==t;)s=this.data[n],this.data[n]=this.data[t],this.data[t]=s,t=n},t}()},{}]},{},[1])(1)},2229:function(t){t.exports=function(){"use strict";function t(t){return"string"==typeof t||t instanceof String}var e=Number.isFinite||window.isFinite;function i(t){return e(t)}function n(t){return t}function r(t,e){if(e.length!==t.length)return!1;for(var i=0;i<t.length;i++){if(e[i].compareArray&&!e[i].compareArray(t[i]))return!1;if(e[i]!==t[i])return!1}return!0}function s(t,e){Object.keys(e).forEach((function(i){t[i]=e[i]}))}function o(){for(var t=1,e=0,i=0;i<arguments.length;i++){var n=arguments[i];e+=h(n),t*=n}return 0!==e?l(t,e):t}function a(t,e){if(0===e)throw new Error("Divide by zero");var i=Math.pow(10,h(e));return o(t,i/(i*e))}function l(t,e){return Math.round(t*Math.pow(10,e))/Math.pow(10,e)}function h(t){if(!isFinite(t))return 0;for(var e=0;t%1!=0;)t*=10,e++;return e}function c(){var t;if(!this)return t=Object.create(c.prototype),c.apply(t,arguments),t;t=Error.apply(this,arguments),this.name="QtyError",this.message=t.message,this.stack=t.stack}function u(t,e){throw new c("Incompatible units: "+t+" and "+e)}c.prototype=Object.create(Error.prototype,{constructor:{value:c}});var d={"<googol>":[["googol"],1e100,"prefix"],"<kibi>":[["Ki","Kibi","kibi"],Math.pow(2,10),"prefix"],"<mebi>":[["Mi","Mebi","mebi"],Math.pow(2,20),"prefix"],"<gibi>":[["Gi","Gibi","gibi"],Math.pow(2,30),"prefix"],"<tebi>":[["Ti","Tebi","tebi"],Math.pow(2,40),"prefix"],"<pebi>":[["Pi","Pebi","pebi"],Math.pow(2,50),"prefix"],"<exi>":[["Ei","Exi","exi"],Math.pow(2,60),"prefix"],"<zebi>":[["Zi","Zebi","zebi"],Math.pow(2,70),"prefix"],"<yebi>":[["Yi","Yebi","yebi"],Math.pow(2,80),"prefix"],"<yotta>":[["Y","Yotta","yotta"],1e24,"prefix"],"<zetta>":[["Z","Zetta","zetta"],1e21,"prefix"],"<exa>":[["E","Exa","exa"],1e18,"prefix"],"<peta>":[["P","Peta","peta"],1e15,"prefix"],"<tera>":[["T","Tera","tera"],1e12,"prefix"],"<giga>":[["G","Giga","giga"],1e9,"prefix"],"<mega>":[["M","Mega","mega"],1e6,"prefix"],"<kilo>":[["k","kilo"],1e3,"prefix"],"<hecto>":[["h","Hecto","hecto"],100,"prefix"],"<deca>":[["da","Deca","deca","deka"],10,"prefix"],"<deci>":[["d","Deci","deci"],.1,"prefix"],"<centi>":[["c","Centi","centi"],.01,"prefix"],"<milli>":[["m","Milli","milli"],.001,"prefix"],"<micro>":[["u","","","Micro","mc","micro"],1e-6,"prefix"],"<nano>":[["n","Nano","nano"],1e-9,"prefix"],"<pico>":[["p","Pico","pico"],1e-12,"prefix"],"<femto>":[["f","Femto","femto"],1e-15,"prefix"],"<atto>":[["a","Atto","atto"],1e-18,"prefix"],"<zepto>":[["z","Zepto","zepto"],1e-21,"prefix"],"<yocto>":[["y","Yocto","yocto"],1e-24,"prefix"],"<1>":[["1","<1>"],1,""],"<meter>":[["m","meter","meters","metre","metres"],1,"length",["<meter>"]],"<inch>":[["in","inch","inches",'"'],.0254,"length",["<meter>"]],"<foot>":[["ft","foot","feet","'"],.3048,"length",["<meter>"]],"<yard>":[["yd","yard","yards"],.9144,"length",["<meter>"]],"<mile>":[["mi","mile","miles"],1609.344,"length",["<meter>"]],"<naut-mile>":[["nmi","naut-mile"],1852,"length",["<meter>"]],"<league>":[["league","leagues"],4828,"length",["<meter>"]],"<furlong>":[["furlong","furlongs"],201.2,"length",["<meter>"]],"<rod>":[["rd","rod","rods"],5.029,"length",["<meter>"]],"<mil>":[["mil","mils"],254e-7,"length",["<meter>"]],"<angstrom>":[["ang","angstrom","angstroms"],1e-10,"length",["<meter>"]],"<fathom>":[["fathom","fathoms"],1.829,"length",["<meter>"]],"<pica>":[["pica","picas"],.00423333333,"length",["<meter>"]],"<point>":[["pt","point","points"],.000352777778,"length",["<meter>"]],"<redshift>":[["z","red-shift","redshift"],1302773e20,"length",["<meter>"]],"<AU>":[["AU","astronomical-unit"],1495979e5,"length",["<meter>"]],"<light-second>":[["ls","light-second"],299792500,"length",["<meter>"]],"<light-minute>":[["lmin","light-minute"],1798755e4,"length",["<meter>"]],"<light-year>":[["ly","light-year"],9460528e9,"length",["<meter>"]],"<parsec>":[["pc","parsec","parsecs"],3085678e10,"length",["<meter>"]],"<datamile>":[["DM","datamile"],1828.8,"length",["<meter>"]],"<kilogram>":[["kg","kilogram","kilograms"],1,"mass",["<kilogram>"]],"<AMU>":[["u","AMU","amu"],1660538921e-36,"mass",["<kilogram>"]],"<dalton>":[["Da","Dalton","Daltons","dalton","daltons"],1660538921e-36,"mass",["<kilogram>"]],"<slug>":[["slug","slugs"],14.5939029,"mass",["<kilogram>"]],"<short-ton>":[["tn","ton","short-ton"],907.18474,"mass",["<kilogram>"]],"<metric-ton>":[["t","tonne","metric-ton"],1e3,"mass",["<kilogram>"]],"<carat>":[["ct","carat","carats"],2e-4,"mass",["<kilogram>"]],"<pound>":[["lbs","lb","pound","pounds","#"],.45359237,"mass",["<kilogram>"]],"<ounce>":[["oz","ounce","ounces"],.0283495231,"mass",["<kilogram>"]],"<gram>":[["g","gram","grams","gramme","grammes"],.001,"mass",["<kilogram>"]],"<grain>":[["grain","grains","gr"],6479891e-11,"mass",["<kilogram>"]],"<dram>":[["dram","drams","dr"],.0017718452,"mass",["<kilogram>"]],"<stone>":[["stone","stones","st"],6.35029318,"mass",["<kilogram>"]],"<hectare>":[["hectare"],1e4,"area",["<meter>","<meter>"]],"<acre>":[["acre","acres"],4046.85642,"area",["<meter>","<meter>"]],"<sqft>":[["sqft"],1,"area",["<foot>","<foot>"]],"<liter>":[["l","L","liter","liters","litre","litres"],.001,"volume",["<meter>","<meter>","<meter>"]],"<gallon>":[["gal","gallon","gallons"],.0037854118,"volume",["<meter>","<meter>","<meter>"]],"<gallon-imp>":[["galimp","gallon-imp","gallons-imp"],.00454609,"volume",["<meter>","<meter>","<meter>"]],"<quart>":[["qt","quart","quarts"],.00094635295,"volume",["<meter>","<meter>","<meter>"]],"<pint>":[["pt","pint","pints"],.000473176475,"volume",["<meter>","<meter>","<meter>"]],"<pint-imp>":[["ptimp","pint-imp","pints-imp"],.00056826125,"volume",["<meter>","<meter>","<meter>"]],"<cup>":[["cu","cup","cups"],.000236588238,"volume",["<meter>","<meter>","<meter>"]],"<fluid-ounce>":[["floz","fluid-ounce","fluid-ounces"],295735297e-13,"volume",["<meter>","<meter>","<meter>"]],"<fluid-ounce-imp>":[["flozimp","floz-imp","fluid-ounce-imp","fluid-ounces-imp"],284130625e-13,"volume",["<meter>","<meter>","<meter>"]],"<tablespoon>":[["tb","tbsp","tbs","tablespoon","tablespoons"],147867648e-13,"volume",["<meter>","<meter>","<meter>"]],"<teaspoon>":[["tsp","teaspoon","teaspoons"],492892161e-14,"volume",["<meter>","<meter>","<meter>"]],"<bushel>":[["bu","bsh","bushel","bushels"],.035239072,"volume",["<meter>","<meter>","<meter>"]],"<oilbarrel>":[["bbl","oilbarrel","oilbarrels","oil-barrel","oil-barrels"],.158987294928,"volume",["<meter>","<meter>","<meter>"]],"<beerbarrel>":[["bl","bl-us","beerbarrel","beerbarrels","beer-barrel","beer-barrels"],.1173477658,"volume",["<meter>","<meter>","<meter>"]],"<beerbarrel-imp>":[["blimp","bl-imp","beerbarrel-imp","beerbarrels-imp","beer-barrel-imp","beer-barrels-imp"],.16365924,"volume",["<meter>","<meter>","<meter>"]],"<kph>":[["kph"],.277777778,"speed",["<meter>"],["<second>"]],"<mph>":[["mph"],.44704,"speed",["<meter>"],["<second>"]],"<knot>":[["kt","kn","kts","knot","knots"],.514444444,"speed",["<meter>"],["<second>"]],"<fps>":[["fps"],.3048,"speed",["<meter>"],["<second>"]],"<gee>":[["gee"],9.80665,"acceleration",["<meter>"],["<second>","<second>"]],"<Gal>":[["Gal"],.01,"acceleration",["<meter>"],["<second>","<second>"]],"<kelvin>":[["degK","kelvin"],1,"temperature",["<kelvin>"]],"<celsius>":[["degC","celsius","celsius","centigrade"],1,"temperature",["<kelvin>"]],"<fahrenheit>":[["degF","fahrenheit"],5/9,"temperature",["<kelvin>"]],"<rankine>":[["degR","rankine"],5/9,"temperature",["<kelvin>"]],"<temp-K>":[["tempK","temp-K"],1,"temperature",["<temp-K>"]],"<temp-C>":[["tempC","temp-C"],1,"temperature",["<temp-K>"]],"<temp-F>":[["tempF","temp-F"],5/9,"temperature",["<temp-K>"]],"<temp-R>":[["tempR","temp-R"],5/9,"temperature",["<temp-K>"]],"<second>":[["s","sec","secs","second","seconds"],1,"time",["<second>"]],"<minute>":[["min","mins","minute","minutes"],60,"time",["<second>"]],"<hour>":[["h","hr","hrs","hour","hours"],3600,"time",["<second>"]],"<day>":[["d","day","days"],86400,"time",["<second>"]],"<week>":[["wk","week","weeks"],604800,"time",["<second>"]],"<fortnight>":[["fortnight","fortnights"],1209600,"time",["<second>"]],"<year>":[["y","yr","year","years","annum"],31556926,"time",["<second>"]],"<decade>":[["decade","decades"],315569260,"time",["<second>"]],"<century>":[["century","centuries"],3155692600,"time",["<second>"]],"<pascal>":[["Pa","pascal","Pascal"],1,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<bar>":[["bar","bars"],1e5,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<mmHg>":[["mmHg"],133.322368,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<inHg>":[["inHg"],3386.3881472,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<torr>":[["torr"],133.322368,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<atm>":[["atm","ATM","atmosphere","atmospheres"],101325,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<psi>":[["psi"],6894.76,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<cmh2o>":[["cmH2O","cmh2o"],98.0638,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<inh2o>":[["inH2O","inh2o"],249.082052,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<poise>":[["P","poise"],.1,"viscosity",["<kilogram>"],["<meter>","<second>"]],"<stokes>":[["St","stokes"],1e-4,"viscosity",["<meter>","<meter>"],["<second>"]],"<mole>":[["mol","mole"],1,"substance",["<mole>"]],"<molar>":[["M","molar"],1e3,"molar_concentration",["<mole>"],["<meter>","<meter>","<meter>"]],"<wtpercent>":[["wt%","wtpercent"],10,"molar_concentration",["<kilogram>"],["<meter>","<meter>","<meter>"]],"<katal>":[["kat","katal","Katal"],1,"activity",["<mole>"],["<second>"]],"<unit>":[["U","enzUnit","unit"],16667e-19,"activity",["<mole>"],["<second>"]],"<farad>":[["F","farad","Farad"],1,"capacitance",["<second>","<second>","<second>","<second>","<ampere>","<ampere>"],["<meter>","<meter>","<kilogram>"]],"<coulomb>":[["C","coulomb","Coulomb"],1,"charge",["<ampere>","<second>"]],"<Ah>":[["Ah"],3600,"charge",["<ampere>","<second>"]],"<ampere>":[["A","Ampere","ampere","amp","amps"],1,"current",["<ampere>"]],"<siemens>":[["S","Siemens","siemens"],1,"conductance",["<second>","<second>","<second>","<ampere>","<ampere>"],["<kilogram>","<meter>","<meter>"]],"<henry>":[["H","Henry","henry"],1,"inductance",["<meter>","<meter>","<kilogram>"],["<second>","<second>","<ampere>","<ampere>"]],"<volt>":[["V","Volt","volt","volts"],1,"potential",["<meter>","<meter>","<kilogram>"],["<second>","<second>","<second>","<ampere>"]],"<ohm>":[["Ohm","ohm","",""],1,"resistance",["<meter>","<meter>","<kilogram>"],["<second>","<second>","<second>","<ampere>","<ampere>"]],"<weber>":[["Wb","weber","webers"],1,"magnetism",["<meter>","<meter>","<kilogram>"],["<second>","<second>","<ampere>"]],"<tesla>":[["T","tesla","teslas"],1,"magnetism",["<kilogram>"],["<second>","<second>","<ampere>"]],"<gauss>":[["G","gauss"],1e-4,"magnetism",["<kilogram>"],["<second>","<second>","<ampere>"]],"<maxwell>":[["Mx","maxwell","maxwells"],1e-8,"magnetism",["<meter>","<meter>","<kilogram>"],["<second>","<second>","<ampere>"]],"<oersted>":[["Oe","oersted","oersteds"],250/Math.PI,"magnetism",["<ampere>"],["<meter>"]],"<joule>":[["J","joule","Joule","joules","Joules"],1,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<erg>":[["erg","ergs"],1e-7,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<btu>":[["BTU","btu","BTUs"],1055.056,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<calorie>":[["cal","calorie","calories"],4.184,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<Calorie>":[["Cal","Calorie","Calories"],4184,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<therm-US>":[["th","therm","therms","Therm","therm-US"],105480400,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<Wh>":[["Wh"],3600,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<electronvolt>":[["eV","electronvolt","electronvolts"],1602176634e-28,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<newton>":[["N","Newton","newton"],1,"force",["<kilogram>","<meter>"],["<second>","<second>"]],"<dyne>":[["dyn","dyne"],1e-5,"force",["<kilogram>","<meter>"],["<second>","<second>"]],"<pound-force>":[["lbf","pound-force"],4.448222,"force",["<kilogram>","<meter>"],["<second>","<second>"]],"<hertz>":[["Hz","hertz","Hertz"],1,"frequency",["<1>"],["<second>"]],"<radian>":[["rad","radian","radians"],1,"angle",["<radian>"]],"<degree>":[["deg","degree","degrees"],Math.PI/180,"angle",["<radian>"]],"<arcminute>":[["arcmin","arcminute","arcminutes"],Math.PI/10800,"angle",["<radian>"]],"<arcsecond>":[["arcsec","arcsecond","arcseconds"],Math.PI/648e3,"angle",["<radian>"]],"<gradian>":[["gon","grad","gradian","grads"],Math.PI/200,"angle",["<radian>"]],"<steradian>":[["sr","steradian","steradians"],1,"solid_angle",["<steradian>"]],"<rotation>":[["rotation"],2*Math.PI,"angle",["<radian>"]],"<rpm>":[["rpm"],2*Math.PI/60,"angular_velocity",["<radian>"],["<second>"]],"<byte>":[["B","byte","bytes"],1,"information",["<byte>"]],"<bit>":[["b","bit","bits"],.125,"information",["<byte>"]],"<Bps>":[["Bps"],1,"information_rate",["<byte>"],["<second>"]],"<bps>":[["bps"],.125,"information_rate",["<byte>"],["<second>"]],"<dollar>":[["USD","dollar"],1,"currency",["<dollar>"]],"<cents>":[["cents"],.01,"currency",["<dollar>"]],"<candela>":[["cd","candela"],1,"luminosity",["<candela>"]],"<lumen>":[["lm","lumen"],1,"luminous_power",["<candela>","<steradian>"]],"<lux>":[["lux"],1,"illuminance",["<candela>","<steradian>"],["<meter>","<meter>"]],"<watt>":[["W","watt","watts"],1,"power",["<kilogram>","<meter>","<meter>"],["<second>","<second>","<second>"]],"<volt-ampere>":[["VA","volt-ampere"],1,"power",["<kilogram>","<meter>","<meter>"],["<second>","<second>","<second>"]],"<volt-ampere-reactive>":[["var","Var","VAr","VAR","volt-ampere-reactive"],1,"power",["<kilogram>","<meter>","<meter>"],["<second>","<second>","<second>"]],"<horsepower>":[["hp","horsepower"],745.699872,"power",["<kilogram>","<meter>","<meter>"],["<second>","<second>","<second>"]],"<gray>":[["Gy","gray","grays"],1,"radiation",["<meter>","<meter>"],["<second>","<second>"]],"<roentgen>":[["R","roentgen"],.00933,"radiation",["<meter>","<meter>"],["<second>","<second>"]],"<sievert>":[["Sv","sievert","sieverts"],1,"radiation",["<meter>","<meter>"],["<second>","<second>"]],"<becquerel>":[["Bq","becquerel","becquerels"],1,"radiation",["<1>"],["<second>"]],"<curie>":[["Ci","curie","curies"],37e9,"radiation",["<1>"],["<second>"]],"<cpm>":[["cpm"],1/60,"rate",["<count>"],["<second>"]],"<dpm>":[["dpm"],1/60,"rate",["<count>"],["<second>"]],"<bpm>":[["bpm"],1/60,"rate",["<count>"],["<second>"]],"<dot>":[["dot","dots"],1,"resolution",["<each>"]],"<pixel>":[["pixel","px"],1,"resolution",["<each>"]],"<ppi>":[["ppi"],1,"resolution",["<pixel>"],["<inch>"]],"<dpi>":[["dpi"],1,"typography",["<dot>"],["<inch>"]],"<cell>":[["cells","cell"],1,"counting",["<each>"]],"<each>":[["each"],1,"counting",["<each>"]],"<count>":[["count"],1,"counting",["<each>"]],"<base-pair>":[["bp","base-pair"],1,"counting",["<each>"]],"<nucleotide>":[["nt","nucleotide"],1,"counting",["<each>"]],"<molecule>":[["molecule","molecules"],1,"counting",["<1>"]],"<dozen>":[["doz","dz","dozen"],12,"prefix_only",["<each>"]],"<percent>":[["%","percent"],.01,"prefix_only",["<1>"]],"<ppm>":[["ppm"],1e-6,"prefix_only",["<1>"]],"<ppb>":[["ppb"],1e-9,"prefix_only",["<1>"]],"<ppt>":[["ppt"],1e-12,"prefix_only",["<1>"]],"<ppq>":[["ppq"],1e-15,"prefix_only",["<1>"]],"<gross>":[["gr","gross"],144,"prefix_only",["<dozen>","<dozen>"]],"<decibel>":[["dB","decibel","decibels"],1,"logarithmic",["<decibel>"]]},g=["<meter>","<kilogram>","<second>","<mole>","<ampere>","<radian>","<kelvin>","<temp-K>","<byte>","<dollar>","<candela>","<each>","<steradian>","<decibel>"],f="<1>",p=[f];function m(t,e){var n=e[1],r=e[3]||[],s=e[4]||[];if(!i(n))throw new c(t+": Invalid unit definition. 'scalar' must be a number");r.forEach((function(e){if(void 0===d[e])throw new c(t+": Invalid unit definition. Unit "+e+" in 'numerator' is not recognized")})),s.forEach((function(e){if(void 0===d[e])throw new c(t+": Invalid unit definition. Unit "+e+" in 'denominator' is not recognized")}))}var _={},y={},w={},x={},b={};for(var v in d)if(d.hasOwnProperty(v)){var E=d[v];if("prefix"===E[2]){_[v]=E[1];for(var S=0;S<E[0].length;S++)y[E[0][S]]=v}else{m(v,E),w[v]={scalar:E[1],numerator:E[3],denominator:E[4]};for(var I=0;I<E[0].length;I++)x[E[0][I]]=v}b[v]=E[0][0]}var M=["length","time","temperature","mass","current","substance","luminosity","currency","information","angle"];function C(){if(this.signature)return this.signature;for(var t=T.call(this),e=0;e<t.length;e++)t[e]*=Math.pow(20,e);return t.reduce((function(t,e){return t+e}),0)}function T(){if(!this.isBase())return T.call(this.toBase());for(var t,e,i=new Array(M.length),n=0;n<i.length;n++)i[n]=0;for(var r=0;r<this.numerator.length;r++)(t=d[this.numerator[r]])&&(e=M.indexOf(t[2]))>=0&&(i[e]=i[e]+1);for(var s=0;s<this.denominator.length;s++)(t=d[this.denominator[s]])&&(e=M.indexOf(t[2]))>=0&&(i[e]=i[e]-1);return i}var R=new RegExp("^([+-]?\\s*(?:(?:\\d+(?:\\.\\d+)?)|(?:\\.\\d+))(?:[Ee][+-]?\\d+)?)?\\s*([^/]*)(?:/(.+))?$"),A="\\^|\\*{2}",k="[01234]",P=new RegExp("([^ \\*\\d]+?)(?:"+A+")?(-?"+k+"(?![a-zA-Z]))"),L=new RegExp("([^ \\*\\d]+?)(?:"+A+")?("+k+"(?![a-zA-Z]))");function N(e){t(e)||(e=e.toString()),e=e.trim();var i=R.exec(e);if(!i)throw new c(e+": Quantity not recognized");var n=i[1];n?(n=n.replace(/\s/g,""),this.scalar=parseFloat(n)):this.scalar=1;for(var r,s,o,a=i[2],l=i[3];i=P.exec(a);){if(r=parseFloat(i[2]),isNaN(r))throw new c("Unit exponent is not a number");if(0===r&&!O.test(i[1]))throw new c("Unit not recognized");s=i[1]+" ",o="";for(var h=0;h<Math.abs(r);h++)o+=s;r>=0?a=a.replace(i[0],o):(l=l?l+o:o,a=a.replace(i[0],""))}for(;i=L.exec(l);){if(r=parseFloat(i[2]),isNaN(r))throw new c("Unit exponent is not a number");if(0===r&&!O.test(i[1]))throw new c("Unit not recognized");s=i[1]+" ",o="";for(var u=0;u<r;u++)o+=s;l=l.replace(i[0],o)}a&&(this.numerator=B(a.trim())),l&&(this.denominator=B(l.trim()))}var D="("+Object.keys(y).sort((function(t,e){return e.length-t.length})).join("|")+")??("+Object.keys(x).sort((function(t,e){return e.length-t.length})).join("|")+")(?:\\b|$)",O=new RegExp("^\\s*("+D+"[\\s\\*]*)+$"),F=new RegExp(D,"g"),z={};function B(t){var e=z[t];if(e)return e;var i,n=[];if(!O.test(t))throw new c("Unit not recognized");for(;i=F.exec(t);)n.push(i.slice(1));return n=(n=(n=n.map((function(t){return y[t[0]]?[y[t[0]],x[t[1]]]:[x[t[1]]]}))).reduce((function(t,e){return t.concat(e)}),[])).filter((function(t){return t})),z[t]=n,n}function G(t){return t instanceof Y}function Y(t,e){if(U.apply(null,arguments),!G(this))return new Y(t,e);if(this.scalar=null,this.baseScalar=null,this.signature=null,this._conversionCache={},this.numerator=p,this.denominator=p,X(t)?(this.scalar=t.scalar,this.numerator=t.numerator&&0!==t.numerator.length?t.numerator:p,this.denominator=t.denominator&&0!==t.denominator.length?t.denominator:p):e?(N.call(this,e),this.scalar=t):N.call(this,t),this.denominator.join("*").indexOf("temp")>=0)throw new c("Cannot divide with temperatures");if(this.numerator.join("*").indexOf("temp")>=0){if(this.numerator.length>1)throw new c("Cannot multiply by temperatures");if(!r(this.denominator,p))throw new c("Cannot divide with temperatures")}if(this.initValue=t,q.call(this),this.isTemperature()&&this.baseScalar<0)throw new c("Temperatures must not be less than absolute zero")}function U(e,n){if(n){if(!i(e)||!t(n))throw new c("Only number accepted as initialization value when units are explicitly provided")}else if(!(t(e)||i(e)||G(e)||X(e)))throw new c("Only string, number or quantity accepted as single initialization value")}function X(t){return t&&"object"==typeof t&&t.hasOwnProperty("scalar")}function q(){if(this.baseScalar)return this.baseScalar;if(this.isBase())this.baseScalar=this.scalar,this.signature=C.call(this);else{var t=this.toBase();this.baseScalar=t.scalar,this.signature=t.signature}}Y.prototype={constructor:Y};var V={"-312078":"elastance","-312058":"resistance","-312038":"inductance","-152058":"potential","-152040":"magnetism","-152038":"magnetism","-7997":"specific_volume","-79":"snap","-59":"jolt","-39":"acceleration","-38":"radiation","-20":"frequency","-19":"speed","-18":"viscosity","-17":"volumetric_flow","-1":"wavenumber",0:"unitless",1:"length",2:"area",3:"volume",20:"time",400:"temperature",7941:"yank",7942:"power",7959:"pressure",7961:"force",7962:"energy",7979:"viscosity",7981:"momentum",7982:"angular_momentum",7997:"density",7998:"area_density",8e3:"mass",152020:"radiation_exposure",159999:"magnetism",16e4:"current",160020:"charge",312058:"conductance",312078:"capacitance",3199980:"activity",3199997:"molar_concentration",32e5:"substance",63999998:"illuminance",64e6:"luminous_power",128e7:"currency",25599999980:"information_rate",256e8:"information",511999999980:"angular_velocity",512e9:"angle"};function j(t,e){var i=e.to(W(t.units()));return Y({scalar:t.scalar+i.scalar,numerator:t.numerator,denominator:t.denominator})}function W(t){if("tempK"===t)return"degK";if("tempC"===t)return"degC";if("tempF"===t)return"degF";if("tempR"===t)return"degR";throw new c("Unknown type for temp conversion from: "+t)}function Z(t,e){var i,n=function(t){var e,i=t.units();if(i.match(/(deg)[CFRK]/))e=t.baseScalar;else if("tempK"===i)e=t.scalar;else if("tempC"===i)e=t.scalar;else if("tempF"===i)e=5*t.scalar/9;else{if("tempR"!==i)throw new c("Unknown type for temp conversion from: "+i);e=5*t.scalar/9}return Y({scalar:e,numerator:["<kelvin>"],denominator:p})}(t),r=e.units();if("degK"===r)i=n.scalar;else if("degC"===r)i=n.scalar;else if("degF"===r)i=9*n.scalar/5;else{if("degR"!==r)throw new c("Unknown type for degree conversion to: "+r);i=9*n.scalar/5}return Y({scalar:i,numerator:e.numerator,denominator:e.denominator})}Y.prototype.kind=function(){return V[this.signature.toString()]},s(Y.prototype,{isDegrees:function(){return(null===this.signature||400===this.signature)&&1===this.numerator.length&&r(this.denominator,p)&&(this.numerator[0].match(/<temp-[CFRK]>/)||this.numerator[0].match(/<(kelvin|celsius|rankine|fahrenheit)>/))},isTemperature:function(){return this.isDegrees()&&this.numerator[0].match(/<temp-[CFRK]>/)}}),s(Y.prototype,{to:function(e){var i,n;return null==e?this:t(e)?(i=this._conversionCache[e])?i:(n=Y(e)).units()===this.units()?this:(this.isCompatible(n)?n=n.isTemperature()?function(t,e){var i,n=e.units();if("tempK"===n)i=t.baseScalar;else if("tempC"===n)i=t.baseScalar-273.15;else if("tempF"===n)i=9*t.baseScalar/5-459.67;else{if("tempR"!==n)throw new c("Unknown type for temp conversion to: "+n);i=9*t.baseScalar/5}return Y({scalar:i,numerator:e.numerator,denominator:e.denominator})}(this,n):n.isDegrees()?Z(this,n):Y({scalar:a(this.baseScalar,n.baseScalar),numerator:n.numerator,denominator:n.denominator}):this.isInverse(n)?n=this.inverse().to(e):u(this.units(),n.units()),this._conversionCache[e]=n,n):this.to(e.units())},toBase:function(){if(this.isBase())return this;if(this.isTemperature())return function(t){var e,i=t.units();if(i.match(/(deg)[CFRK]/))e=t.baseScalar;else if("tempK"===i)e=t.scalar;else if("tempC"===i)e=t.scalar+273.15;else if("tempF"===i)e=5*(t.scalar+459.67)/9;else{if("tempR"!==i)throw new c("Unknown type for temp conversion from: "+i);e=5*t.scalar/9}return Y({scalar:e,numerator:["<temp-K>"],denominator:p})}(this);var t=H[this.units()];return t||(t=function(t,e){for(var i,n=[],r=[],s=1,a=0;a<t.length;a++)i=t[a],_[i]?s=o(s,_[i]):w[i]&&(s*=w[i].scalar,w[i].numerator&&n.push(w[i].numerator),w[i].denominator&&r.push(w[i].denominator));for(var l=0;l<e.length;l++)i=e[l],_[i]?s/=_[i]:w[i]&&(s/=w[i].scalar,w[i].numerator&&r.push(w[i].numerator),w[i].denominator&&n.push(w[i].denominator));return Y({scalar:s,numerator:n=n.reduce((function(t,e){return t.concat(e)}),[]),denominator:r=r.reduce((function(t,e){return t.concat(e)}),[])})}(this.numerator,this.denominator),H[this.units()]=t),t.mul(this.scalar)},toFloat:function(){if(this.isUnitless())return this.scalar;throw new c("Can't convert to Float unless unitless.  Use Unit#scalar")},toPrec:function(e){if(t(e)&&(e=Y(e)),i(e)&&(e=Y(e+" "+this.units())),this.isUnitless()?e.isUnitless()||u(this.units(),e.units()):e=e.to(this.units()),0===e.scalar)throw new c("Divide by zero");return Y(o(Math.round(this.scalar/e.scalar),e.scalar)+this.units())}});var H={};function K(t,e,i,n){function r(t){return t!==f}t=t.filter(r),i=i.filter(r),e=e.filter(r),n=n.filter(r);var s={};function o(t,e){for(var i,n,r,o=0;o<t.length;o++)if(_[t[o]]?(i=t[o+1],n=t[o],r=_[n],o++):(i=t[o],n=null,r=1),i&&i!==f)if(s[i]){s[i][0]+=e;var l=s[i][2]?_[s[i][2]]:1;s[i][1===e?3:4]*=a(r,l)}else s[i]=[e,i,n,1,1]}o(t,1),o(e,-1),o(i,1),o(n,-1);var l=[],h=[],c=1;for(var u in s)if(s.hasOwnProperty(u)){var d,g=s[u];if(g[0]>0)for(d=0;d<g[0];d++)l.push(null===g[2]?g[1]:[g[2],g[1]]);else if(g[0]<0)for(d=0;d<-g[0];d++)h.push(null===g[2]?g[1]:[g[2],g[1]]);c*=a(g[3],g[4])}return 0===l.length&&(l=p),0===h.length&&(h=p),[l=l.reduce((function(t,e){return t.concat(e)}),[]),h=h.reduce((function(t,e){return t.concat(e)}),[]),c]}function $(){}Y.parse=function(e){if(!t(e))throw new c("Argument should be a string");try{return this(e)}catch(t){return null}},Y.getUnits=function(t){var e,i=[],n=Object.keys(d);if(void 0===t)for(e=0;e<n.length;e++)-1===["","prefix"].indexOf(d[n[e]][2])&&i.push(n[e].substr(1,n[e].length-2));else{if(-1===this.getKinds().indexOf(t))throw new c("Kind not recognized");for(e=0;e<n.length;e++)d[n[e]][2]===t&&i.push(n[e].substr(1,n[e].length-2))}return i.sort((function(t,e){return t.toLowerCase()<e.toLowerCase()?-1:t.toLowerCase()>e.toLowerCase()?1:0}))},Y.getAliases=function(t){if(!x[t])throw new c("Unit not recognized");return d[x[t]][0]},Y.mulSafe=o,Y.divSafe=a,Y.getKinds=function(){return t=Object.keys(V).map((function(t){return V[t]})),e={},t.filter((function(t){return!e.hasOwnProperty(t)&&(e[t]=!0)}));var t,e},Y.swiftConverter=function(t,e){var i,r=Y(t),s=Y(e);return r.eq(s)?n:(i=r.isTemperature()?function(t){return r.mul(t).to(s).scalar}:function(t){return t*r.baseScalar/s.baseScalar},function(t){var e,n,r;if(Array.isArray(t)){for(n=t.length,r=[],e=0;e<n;e++)r.push(i(t[e]));return r}return i(t)})},Y.Error=c,s(Y.prototype,{add:function(e){if(t(e)&&(e=Y(e)),this.isCompatible(e)||u(this.units(),e.units()),this.isTemperature()&&e.isTemperature())throw new c("Cannot add two temperatures");return this.isTemperature()?j(this,e):e.isTemperature()?j(e,this):Y({scalar:this.scalar+e.to(this).scalar,numerator:this.numerator,denominator:this.denominator})},sub:function(e){if(t(e)&&(e=Y(e)),this.isCompatible(e)||u(this.units(),e.units()),this.isTemperature()&&e.isTemperature())return n=e,r=(i=this).units(),s=n.to(r),o=Y(W(r)),Y({scalar:i.scalar-s.scalar,numerator:o.numerator,denominator:o.denominator});var i,n,r,s,o,a,l;if(this.isTemperature())return a=this,l=e.to(W(a.units())),Y({scalar:a.scalar-l.scalar,numerator:a.numerator,denominator:a.denominator});if(e.isTemperature())throw new c("Cannot subtract a temperature from a differential degree unit");return Y({scalar:this.scalar-e.to(this).scalar,numerator:this.numerator,denominator:this.denominator})},mul:function(e){if(i(e))return Y({scalar:o(this.scalar,e),numerator:this.numerator,denominator:this.denominator});if(t(e)&&(e=Y(e)),(this.isTemperature()||e.isTemperature())&&!this.isUnitless()&&!e.isUnitless())throw new c("Cannot multiply by temperatures");var n=this,r=e;n.isCompatible(r)&&400!==n.signature&&(r=r.to(n));var s=K(n.numerator,n.denominator,r.numerator,r.denominator);return Y({scalar:o(n.scalar,r.scalar,s[2]),numerator:s[0],denominator:s[1]})},div:function(e){if(i(e)){if(0===e)throw new c("Divide by zero");return Y({scalar:this.scalar/e,numerator:this.numerator,denominator:this.denominator})}if(t(e)&&(e=Y(e)),0===e.scalar)throw new c("Divide by zero");if(e.isTemperature())throw new c("Cannot divide with temperatures");if(this.isTemperature()&&!e.isUnitless())throw new c("Cannot divide with temperatures");var n=this,r=e;n.isCompatible(r)&&400!==n.signature&&(r=r.to(n));var s=K(n.numerator,n.denominator,r.denominator,r.numerator);return Y({scalar:o(n.scalar,s[2])/r.scalar,numerator:s[0],denominator:s[1]})},inverse:function(){if(this.isTemperature())throw new c("Cannot divide with temperatures");if(0===this.scalar)throw new c("Divide by zero");return Y({scalar:1/this.scalar,numerator:this.denominator,denominator:this.numerator})}}),s(Y.prototype,{eq:function(t){return 0===this.compareTo(t)},lt:function(t){return-1===this.compareTo(t)},lte:function(t){return this.eq(t)||this.lt(t)},gt:function(t){return 1===this.compareTo(t)},gte:function(t){return this.eq(t)||this.gt(t)},compareTo:function(e){return t(e)?this.compareTo(Y(e)):(this.isCompatible(e)||u(this.units(),e.units()),this.baseScalar<e.baseScalar?-1:this.baseScalar===e.baseScalar?0:this.baseScalar>e.baseScalar?1:void 0)},same:function(t){return this.scalar===t.scalar&&this.units()===t.units()}}),s(Y.prototype,{isUnitless:function(){return[this.numerator,this.denominator].every((function(t){return r(t,p)}))},isCompatible:function(e){return t(e)?this.isCompatible(Y(e)):!!G(e)&&void 0!==e.signature&&this.signature===e.signature},isInverse:function(t){return this.inverse().isCompatible(t)},isBase:function(){return void 0!==this._isBase?this._isBase:this.isDegrees()&&this.numerator[0].match(/<(kelvin|temp-K)>/)?(this._isBase=!0,this._isBase):(this.numerator.concat(this.denominator).forEach((function(t){t!==f&&-1===g.indexOf(t)&&(this._isBase=!1)}),this),!1===this._isBase||(this._isBase=!0),this._isBase)}}),$.prototype.get=function(t){return arguments.length>1&&(t=Array.apply(null,arguments)),t.reduce((function(e,i,n){if(e){var r=e[i];return n===t.length-1?r?r.data:void 0:r}}),this)},$.prototype.set=function(t,e){return arguments.length>2&&(t=Array.prototype.slice.call(arguments,0,-1),e=arguments[arguments.length-1]),t.reduce((function(i,n,r){var s=i[n];return void 0===s&&(s=i[n]={}),r===t.length-1?(s.data=e,e):s}),this)},Y.formatter=function(t,e){return(t+" "+e).trim()},s(Y.prototype,{units:function(){if(void 0!==this._units)return this._units;var t=r(this.numerator,p),e=r(this.denominator,p);if(t&&e)return this._units="",this._units;var i=Q(this.numerator),n=Q(this.denominator);return this._units=i+(e?"":"/"+n),this._units},toString:function(e,n){var r;if(i(e))r=this.units(),n=e;else if(t(e))r=e;else if(G(e))return this.toPrec(e).toString(n);var s=this.to(r);return((void 0!==n?l(s.scalar,n):s.scalar)+" "+s.units()).trim()},format:function(t,e){1===arguments.length&&"function"==typeof t&&(e=t,t=void 0),e=e||Y.formatter;var i=this.to(t);return e.call(this,i.scalar,i.units())}});var J=new $;function Q(t){var e=J.get(t);return e||(e=r(t,p)?"1":function(t){return t.reduce((function(t,e){var i=t[e];return i||t.push(i=t[e]=[e,0]),i[1]++,t}),[]).map((function(t){return t[0]+(t[1]>1?t[1]:"")}))}(function(t){for(var e,i,n=[],r=0;r<t.length;r++)e=t[r],i=t[r+1],_[e]?(n.push(b[e]+b[i]),r++):n.push(b[e]);return n}(t)).join("*"),J.set(t,e),e)}return Y.version="1.8.0",Y}()},5520:t=>{!function(){function e(t){for(var e=0,r=t.length-1,s=void 0,o=void 0,a=void 0,l=n(e,r);;){if(r<=e)return t[l];if(r==e+1)return t[e]>t[r]&&i(t,e,r),t[l];for(t[s=n(e,r)]>t[r]&&i(t,s,r),t[e]>t[r]&&i(t,e,r),t[s]>t[e]&&i(t,s,e),i(t,s,e+1),o=e+1,a=r;;){do{o++}while(t[e]>t[o]);do{a--}while(t[a]>t[e]);if(a<o)break;i(t,o,a)}i(t,e,a),a<=l&&(e=o),a>=l&&(r=a-1)}}var i=function(t,e,i){var n;return n=[t[i],t[e]],t[e]=n[0],t[i]=n[1],n},n=function(t,e){return~~((t+e)/2)};t.exports?t.exports=e:window.median=e}()},4805:(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>r});var n=i(4091);function r(t){var e,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!(0,n.isAnyArray)(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");if(void 0!==i.output){if(!(0,n.isAnyArray)(i.output))throw new TypeError("output option must be an array if specified");e=i.output}else e=new Array(t.length);var r=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!(0,n.isAnyArray)(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");var i=e.fromIndex,r=void 0===i?0:i,s=e.toIndex,o=void 0===s?t.length:s;if(r<0||r>=t.length||!Number.isInteger(r))throw new Error("fromIndex must be a positive integer smaller than length");if(o<=r||o>t.length||!Number.isInteger(o))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var a=t[r],l=r+1;l<o;l++)t[l]<a&&(a=t[l]);return a}(t),s=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!(0,n.isAnyArray)(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");var i=e.fromIndex,r=void 0===i?0:i,s=e.toIndex,o=void 0===s?t.length:s;if(r<0||r>=t.length||!Number.isInteger(r))throw new Error("fromIndex must be a positive integer smaller than length");if(o<=r||o>t.length||!Number.isInteger(o))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var a=t[r],l=r+1;l<o;l++)t[l]>a&&(a=t[l]);return a}(t);if(r===s)throw new RangeError("minimum and maximum input values are equal. Cannot rescale a constant array");var o=i.min,a=void 0===o?i.autoMinMax?r:0:o,l=i.max,h=void 0===l?i.autoMinMax?s:1:l;if(a>=h)throw new RangeError("min option must be smaller than max option");for(var c=(h-a)/(s-r),u=0;u<t.length;u++)e[u]=(t[u]-r)*c+a;return e}},530:t=>{"use strict";function e(t){this.value=t,this.parent=null,this.rank=0}t.exports=class{constructor(){this.nodes=new Map}add(t){var i=this.nodes.get(t);return i||(i=new e(t),this.nodes.set(t,i)),i}union(t,e){const i=this.find(t),n=this.find(e);i!==n&&(i.rank<n.rank?i.parent=n:i.rank>n.rank?n.parent=i:(n.parent=i,i.rank++))}find(t){for(var e=t;null!==e.parent;)e=e.parent;for(var i=t;null!==i.parent;){var n=i;i=i.parent,n.parent=e}return e}connected(t,e){return this.find(t)===this.find(e)}}},4953:(t,e,i)=>{"use strict";function n(t,e){let i=0;for(let n=0;n<t.length;n++)i+=(t[n]-e[n])*(t[n]-e[n]);return i}function r(t,e){return Math.sqrt(n(t,e))}i.r(e),i.d(e,{euclidean:()=>r,squaredEuclidean:()=>n})},7345:(t,e,i)=>{"use strict";var n=i(5571),r={DEBUG:!1,ifft2DArray:function(t,e,i){var r=new Array(e*i),s=e/2,o=2*(i-1);n.init(s);for(var a={re:new Array(s),im:new Array(s)},l=0;l<i;l++){for(var h=s-1;h>=0;h--)a.re[h]=t[2*h*i+l],a.im[h]=t[(2*h+1)*i+l];for(n.bt(a.re,a.im),h=s-1;h>=0;h--)r[2*h*i+l]=a.re[h],r[(2*h+1)*i+l]=a.im[h]}var c=new Array(s*o);n.init(o);var u={re:new Array(o),im:new Array(o)},d=o*s;for(h=0;h<e;h+=2){for(u.re[0]=r[h*i],u.im[0]=r[(h+1)*i],l=1;l<i;l++)u.re[l]=r[h*i+l],u.im[l]=r[(h+1)*i+l],u.re[o-l]=r[h*i+l],u.im[o-l]=-r[(h+1)*i+l];n.bt(u.re,u.im);var g=h/2*o;for(l=o-1;l>=0;l--)c[g+l]=u.re[l]/d}return c},fft2DArray:function(t,e,i,r){Object.assign({},{inplace:!0});var s=i/2+1,o=2*e,a=new Array(o*s);n.init(i);for(var l,h,c,u,d,g={re:new Array(i),im:new Array(i)},f={re:new Array(i),im:new Array(i)},p={re:new Array(i),im:new Array(i)},m=0;m<e/2;m++){l=2*m*i,g.re=t.slice(l,l+i),l=(2*m+1)*i,g.im=t.slice(l,l+i),n.fft1d(g.re,g.im),this.reconstructTwoRealFFT(g,f,p),h=4*m*s,c=(4*m+1)*s,u=(4*m+2)*s,d=(4*m+3)*s;for(var _=s-1;_>=0;_--)a[h+_]=f.re[_],a[c+_]=f.im[_],a[u+_]=p.re[_],a[d+_]=p.im[_]}f=null,p=null;var y=new Array(o*s);n.init(e);for(var w={re:new Array(e),im:new Array(e)},x=s-1;x>=0;x--){for(m=e-1;m>=0;m--)w.re[m]=a[2*m*s+x],w.im[m]=a[(2*m+1)*s+x],isNaN(w.re[m])&&(w.re[m]=0),isNaN(w.im[m])&&(w.im[m]=0);for(n.fft1d(w.re,w.im),m=e-1;m>=0;m--)y[2*m*s+x]=w.re[m],y[(2*m+1)*s+x]=w.im[m]}return y},reconstructTwoRealFFT:function(t,e,i){var n,r,s,o,a,l=t.re.length;e.re[0]=t.re[0],e.im[0]=0,i.re[0]=t.im[0],i.im[0]=0;for(var h=l/2;h>0;h--)a=l-h,n=.5*(t.re[h]-t.re[a]),r=.5*(t.re[h]+t.re[a]),s=.5*(t.im[h]-t.im[a]),o=.5*(t.im[h]+t.im[a]),e.re[h]=r,e.im[h]=s,e.re[a]=r,e.im[a]=-s,i.re[h]=o,i.im[h]=-n,i.re[a]=o,i.im[a]=n},convolute2DI:function(t,e,i,n){for(var r,s,o=0;o<i/2;o++)for(var a=0;a<n;a++)r=t[2*o*n+a]*e[2*o*n+a]-t[(2*o+1)*n+a]*e[(2*o+1)*n+a],s=t[2*o*n+a]*e[(2*o+1)*n+a]+t[(2*o+1)*n+a]*e[2*o*n+a],t[2*o*n+a]=r,t[(2*o+1)*n+a]=s},convolute:function(t,e,i,n,r){for(var s=new Array(n*i),o=0;o<i*n;o++)s[o]=t[o];s=this.fft2DArray(s,i,n);var a,l=e.length,h=e[0].length,c=new Array(n*i);for(o=0;o<n*i;o++)c[o]=0;for(var u=Math.floor((l-1)/2),d=Math.floor((h-1)/2),g=0;g<l;g++){a=(g-u+i)%i;for(var f=0;f<h;f++)c[a*n+(f-d+n)%n]=e[g][f]}c=this.fft2DArray(c,i,n);var p=2*i,m=n/2+1;return this.convolute2DI(s,c,p,m),this.ifft2DArray(s,p,m)},toRadix2:function(t,e,i){var n,r,s,o,a=i,l=e;if(0===i||0!=(i&i-1)){for(a=0;i>>++a!=0;);a=1<<a}if(0===e||0!=(e&e-1)){for(l=0;e>>++l!=0;);l=1<<l}if(l==e&&a==i)return{data:t,rows:e,cols:i};var h=new Array(l*a),c=Math.floor((l-e)/2)-e,u=Math.floor((a-i)/2)-i;for(n=0;n<l;n++)for(s=n*a,o=(n-c)%e*i,r=0;r<a;r++)h[s+r]=t[o+(r-u)%i];return{data:h,rows:l,cols:a}},crop:function(t,e,i,n,r,s){if(e==n&&i==r)return t;Object.assign({},s);var o,a,l,h,c=new Array(r*n),u=Math.floor((e-n)/2),d=Math.floor((i-r)/2);for(l=0;l<n;l++)for(o=l*r,a=(l+u)*i,h=0;h<r;h++)c[o+h]=t[a+(h+d)];return c}};t.exports=r},5571:function(t,e){(function(){var t;(t=e).toString=function(){return"version 0.3.0, released 2013-03"};for(var i=0,n=null,r=null,s={init:function(t){if(0===t||0!=(t&t-1))throw new Error("init: radix-2 required");i=t,s._initArray(),s._makeBitReversalTable(),s._makeCosSinTable()},fft1d:function(t,e){s.fft(t,e,1)},ifft1d:function(t,e){var n=1/i;s.fft(t,e,-1);for(var r=0;r<i;r++)t[r]*=n,e[r]*=n},bt1d:function(t,e){s.fft(t,e,-1)},fft2d:function(t,e){for(var n=[],r=[],o=0,a=0;a<i;a++){o=a*i;for(var l=0;l<i;l++)n[l]=t[l+o],r[l]=e[l+o];s.fft1d(n,r);for(var h=0;h<i;h++)t[h+o]=n[h],e[h+o]=r[h]}for(var c=0;c<i;c++){for(var u=0;u<i;u++)o=c+u*i,n[u]=t[o],r[u]=e[o];s.fft1d(n,r);for(var d=0;d<i;d++)t[o=c+d*i]=n[d],e[o]=r[d]}},ifft2d:function(t,e){for(var n=[],r=[],o=0,a=0;a<i;a++){o=a*i;for(var l=0;l<i;l++)n[l]=t[l+o],r[l]=e[l+o];s.ifft1d(n,r);for(var h=0;h<i;h++)t[h+o]=n[h],e[h+o]=r[h]}for(var c=0;c<i;c++){for(var u=0;u<i;u++)o=c+u*i,n[u]=t[o],r[u]=e[o];s.ifft1d(n,r);for(var d=0;d<i;d++)t[o=c+d*i]=n[d],e[o]=r[d]}},fft:function(t,e,s){for(var o,a,l,h,c,u,d,g,f,p=i>>2,m=0;m<i;m++)m<(h=n[m])&&(c=t[m],t[m]=t[h],t[h]=c,c=e[m],e[m]=e[h],e[h]=c);for(var _=1;_<i;_<<=1){a=0,o=i/(_<<1);for(var y=0;y<_;y++){u=r[a+p],d=s*r[a];for(var w=y;w<i;w+=_<<1)g=u*t[l=w+_]+d*e[l],f=u*e[l]-d*t[l],t[l]=t[w]-g,t[w]+=g,e[l]=e[w]-f,e[w]+=f;a+=o}}},_initArray:function(){n="undefined"!=typeof Uint32Array?new Uint32Array(i):[],r="undefined"!=typeof Float64Array?new Float64Array(1.25*i):[]},_paddingZero:function(){},_makeBitReversalTable:function(){var t=0,e=0,r=0;for(n[0]=0;++t<i;){for(r=i>>1;r<=e;)e-=r,r>>=1;e+=r,n[t]=e}},_makeCosSinTable:function(){var t=i>>1,e=i>>2,n=i>>3,s=t+e,o=Math.sin(Math.PI/i),a=2*o*o,l=Math.sqrt(a*(2-a)),h=r[e]=1,c=r[0]=0;o=2*a;for(var u=1;u<n;u++)a+=o*(h-=a),l-=o*(c+=l),r[u]=c,r[e-u]=h;0!==n&&(r[n]=Math.sqrt(.5));for(var d=0;d<e;d++)r[t-d]=r[d];for(var g=0;g<s;g++)r[g+t]=-r[g]}},o=["init","fft1d","ifft1d","fft2d","ifft2d"],a=0;a<o.length;a++)t[o[a]]=s[o[a]];return t.bt=s.bt1d,t.fft=s.fft1d,t.ifft=s.ifft1d,t}).call(this)},3910:(t,e,i)=>{"use strict";e.FFTUtils=i(7345),i(5571)},8881:(t,e,i)=>{"use strict";const{squaredEuclidean:n}=i(4953),r={sigma:1};t.exports=class{constructor(t){t=Object.assign({},r,t),this.sigma=t.sigma,this.divisor=2*t.sigma*t.sigma}compute(t,e){const i=n(t,e);return Math.exp(-i/this.divisor)}}},4229:t=>{"use strict";const e={degree:1,constant:1,scale:1};t.exports=class{constructor(t){t=Object.assign({},e,t),this.degree=t.degree,this.constant=t.constant,this.scale=t.scale}compute(t,e){for(var i=0,n=0;n<t.length;n++)i+=t[n]*e[n];return Math.pow(this.scale*i+this.constant,this.degree)}}},7613:t=>{"use strict";const e={alpha:.01,constant:-Math.E};t.exports=class{constructor(t){t=Object.assign({},e,t),this.alpha=t.alpha,this.constant=t.constant}compute(t,e){for(var i=0,n=0;n<t.length;n++)i+=t[n]*e[n];return Math.tanh(this.alpha*i+this.constant)}}},6952:(t,e,i)=>{"use strict";const{Matrix:n,MatrixTransposeView:r}=i(8406),s=i(8881),o=i(4229),a=i(7613),l=i(8541),h=i(9176),c=i(3316),u=i(1960),d={gaussian:s,rbf:s,polynomial:o,poly:o,anova:l,cauchy:h,exponential:c,histogram:u,min:u,laplacian:i(8557),multiquadratic:i(8609),rational:i(3029),sigmoid:a,mlp:a};t.exports=class{constructor(t,e){if(this.kernelType=t,"linear"!==t)if("string"==typeof t){t=t.toLowerCase();var i=d[t];if(!i)throw new Error(`unsupported kernel type: ${t}`);this.kernelFunction=new i(e)}else{if("object"!=typeof t||"function"!=typeof t.compute)throw new TypeError("first argument must be a valid kernel type or instance");this.kernelFunction=t}}compute(t,e){if(t=n.checkMatrix(t),e=void 0===e?t:n.checkMatrix(e),"linear"===this.kernelType)return t.mmul(new r(e));const i=new n(t.rows,e.rows);if(t===e)for(let e=0;e<t.rows;e++)for(let n=e;n<t.rows;n++){const r=this.kernelFunction.compute(t.getRow(e),t.getRow(n));i.set(e,n,r),i.set(n,e,r)}else for(let n=0;n<t.rows;n++)for(let r=0;r<e.rows;r++)i.set(n,r,this.kernelFunction.compute(t.getRow(n),e.getRow(r)));return i}}},8541:t=>{"use strict";const e={sigma:1,degree:1};t.exports=class{constructor(t){t=Object.assign({},e,t),this.sigma=t.sigma,this.degree=t.degree}compute(t,e){for(var i=0,n=Math.min(t.length,e.length),r=1;r<=n;++r)i+=Math.pow(Math.exp(-this.sigma*Math.pow(Math.pow(t[r-1],r)-Math.pow(e[r-1],r),2)),this.degree);return i}}},9176:(t,e,i)=>{"use strict";const{squaredEuclidean:n}=i(4953),r={sigma:1};t.exports=class{constructor(t){t=Object.assign({},r,t),this.sigma=t.sigma}compute(t,e){return 1/(1+n(t,e)/(this.sigma*this.sigma))}}},3316:(t,e,i)=>{"use strict";const{euclidean:n}=i(4953),r={sigma:1};t.exports=class{constructor(t){t=Object.assign({},r,t),this.sigma=t.sigma,this.divisor=2*t.sigma*t.sigma}compute(t,e){const i=n(t,e);return Math.exp(-i/this.divisor)}}},1960:t=>{"use strict";t.exports=class{compute(t,e){for(var i=Math.min(t.length,e.length),n=0,r=0;r<i;++r)n+=Math.min(t[r],e[r]);return n}}},8557:(t,e,i)=>{"use strict";const{euclidean:n}=i(4953),r={sigma:1};t.exports=class{constructor(t){t=Object.assign({},r,t),this.sigma=t.sigma}compute(t,e){const i=n(t,e);return Math.exp(-i/this.sigma)}}},8609:(t,e,i)=>{"use strict";const{squaredEuclidean:n}=i(4953),r={constant:1};t.exports=class{constructor(t){t=Object.assign({},r,t),this.constant=t.constant}compute(t,e){return Math.sqrt(n(t,e)+this.constant*this.constant)}}},3029:(t,e,i)=>{"use strict";const{squaredEuclidean:n}=i(4953),r={constant:1};t.exports=class{constructor(t){t=Object.assign({},r,t),this.constant=t.constant}compute(t,e){const i=n(t,e);return 1-i/(i+this.constant)}}},414:(t,e,i)=>{var n=i(3910).FFTUtils;function r(t){var e,i,n=t;if("number"!=typeof t[0]){e=t.length,i=t[0].length,n=new Array(e*i);for(var r=0;r<e;r++)for(var s=0;s<i;s++)n[r*i+s]=t[r][s]}else{var o=Math.sqrt(t.length);Number.isInteger(o)&&(e=o,i=o)}return{data:n,rows:e,cols:i}}t.exports={fft:function(t,e,i){var s,o,a=r(t),l=a.data,h=Object.assign({normalize:!1,divisor:1,rows:a.rows,cols:a.cols},i);if(!h.rows||!h.cols)throw new Error("Invalid number of rows or columns "+s+" "+o);s=h.rows,o=h.cols;var c,u,d=h.divisor,g=e.length,f=e[0].length;if(h.normalize)for(d=0,c=0;c<g;c++)for(u=0;u<f;u++)d+=e[c][u];if(0===d)throw new RangeError("convolution: The divisor is equal to zero");var p=n.toRadix2(l,s,o),m=n.convolute(p.data,e,p.rows,p.cols);if(m=n.crop(m,p.rows,p.cols,s,o),0!=d&&1!=d)for(c=0;c<m.length;c++)m[c]/=d;return m},direct:function(t,e,i){var n,s,o=r(t),a=o.data,l=Object.assign({normalize:!1,divisor:1,rows:o.rows,cols:o.cols},i);if(!l.rows||!l.cols)throw new Error("Invalid number of rows or columns "+n+" "+s);n=l.rows,s=l.cols;var h,c,u,d,g,f,p=l.divisor,m=e.length,_=e[0].length;if(l.normalize)for(p=0,h=0;h<m;h++)for(c=0;c<_;c++)p+=e[h][c];if(0===p)throw new RangeError("convolution: The divisor is equal to zero");var y=new Array(n*s),w=Math.floor(m/2),x=Math.floor(_/2);for(d=0;d<n;d++)for(u=0;u<s;u++){for(g=0,c=0;c<m;c++)for(h=0;h<_;h++)f=e[m-c-1][_-h-1],g+=a[(d+c-w+n)%n*s+(u+h-x+s)%s]*f;y[d*s+u]=g/p}return y},kernelFactory:{LoG:function(t,e,i){var n=1e3;i&&i.factor&&(n=i.factor);var r,s,o,a,l=new Array(e);n*=-1;var h=(e-1)/2,c=2*t*t;for(r=0;r<e;r++)for(l[r]=new Array(e),a=(r-h)*(r-h),s=0;s<e;s++)o=-((s-h)*(s-h)+a)/c,l[r][s]=Math.round(n*(1+o)*Math.exp(o));return l}},matrix2Array:r}},8406:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(4091),r=i(4805);const s=" ".repeat(2),o=" ".repeat(4);function a(t,e={}){const{maxRows:i=15,maxColumns:n=10,maxNumSize:r=8,padMinus:a="auto"}=e;return`${t.constructor.name} {\n${s}[\n${o}${function(t,e,i,n,r){const{rows:s,columns:a}=t,h=Math.min(s,e),c=Math.min(a,i),u=[];if("auto"===r){r=!1;t:for(let e=0;e<h;e++)for(let i=0;i<c;i++)if(t.get(e,i)<0){r=!0;break t}}for(let e=0;e<h;e++){let i=[];for(let s=0;s<c;s++)i.push(l(t.get(e,s),n,r));u.push(`${i.join(" ")}`)}return c!==a&&(u[u.length-1]+=` ... ${a-i} more columns`),h!==s&&u.push(`... ${s-e} more rows`),u.join(`\n${o}`)}(t,i,n,r,a)}\n${s}]\n${s}rows: ${t.rows}\n${s}columns: ${t.columns}\n}`}function l(t,e,i){return(t>=0&&i?` ${h(t,e-1)}`:h(t,e)).padEnd(e)}function h(t,e){let i=t.toString();if(i.length<=e)return i;let n=t.toFixed(e);if(n.length>e&&(n=t.toFixed(Math.max(0,e-(n.length-e)))),n.length<=e&&!n.startsWith("0.000")&&!n.startsWith("-0.000"))return n;let r=t.toExponential(e);return r.length>e&&(r=t.toExponential(Math.max(0,e-(r.length-e)))),r.slice(0)}function c(t,e,i){let n=i?t.rows:t.rows-1;if(e<0||e>n)throw new RangeError("Row index out of range")}function u(t,e,i){let n=i?t.columns:t.columns-1;if(e<0||e>n)throw new RangeError("Column index out of range")}function d(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.columns)throw new RangeError("vector size must be the same as the number of columns");return e}function g(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.rows)throw new RangeError("vector size must be the same as the number of rows");return e}function f(t,e){if(!n.isAnyArray(e))throw new TypeError("row indices must be an array");for(let i=0;i<e.length;i++)if(e[i]<0||e[i]>=t.rows)throw new RangeError("row indices are out of range")}function p(t,e){if(!n.isAnyArray(e))throw new TypeError("column indices must be an array");for(let i=0;i<e.length;i++)if(e[i]<0||e[i]>=t.columns)throw new RangeError("column indices are out of range")}function m(t,e,i,n,r){if(5!==arguments.length)throw new RangeError("expected 4 arguments");if(y("startRow",e),y("endRow",i),y("startColumn",n),y("endColumn",r),e>i||n>r||e<0||e>=t.rows||i<0||i>=t.rows||n<0||n>=t.columns||r<0||r>=t.columns)throw new RangeError("Submatrix indices are out of range")}function _(t,e=0){let i=[];for(let n=0;n<t;n++)i.push(e);return i}function y(t,e){if("number"!=typeof e)throw new TypeError(`${t} must be a number`)}function w(t){if(t.isEmpty())throw new Error("Empty matrix has no elements to index")}class x{static from1DArray(t,e,i){if(t*e!==i.length)throw new RangeError("data length does not match given dimensions");let n=new v(t,e);for(let r=0;r<t;r++)for(let t=0;t<e;t++)n.set(r,t,i[r*e+t]);return n}static rowVector(t){let e=new v(1,t.length);for(let i=0;i<t.length;i++)e.set(0,i,t[i]);return e}static columnVector(t){let e=new v(t.length,1);for(let i=0;i<t.length;i++)e.set(i,0,t[i]);return e}static zeros(t,e){return new v(t,e)}static ones(t,e){return new v(t,e).fill(1)}static rand(t,e,i={}){if("object"!=typeof i)throw new TypeError("options must be an object");const{random:n=Math.random}=i;let r=new v(t,e);for(let i=0;i<t;i++)for(let t=0;t<e;t++)r.set(i,t,n());return r}static randInt(t,e,i={}){if("object"!=typeof i)throw new TypeError("options must be an object");const{min:n=0,max:r=1e3,random:s=Math.random}=i;if(!Number.isInteger(n))throw new TypeError("min must be an integer");if(!Number.isInteger(r))throw new TypeError("max must be an integer");if(n>=r)throw new RangeError("min must be smaller than max");let o=r-n,a=new v(t,e);for(let i=0;i<t;i++)for(let t=0;t<e;t++){let e=n+Math.round(s()*o);a.set(i,t,e)}return a}static eye(t,e,i){void 0===e&&(e=t),void 0===i&&(i=1);let n=Math.min(t,e),r=this.zeros(t,e);for(let t=0;t<n;t++)r.set(t,t,i);return r}static diag(t,e,i){let n=t.length;void 0===e&&(e=n),void 0===i&&(i=e);let r=Math.min(n,e,i),s=this.zeros(e,i);for(let e=0;e<r;e++)s.set(e,e,t[e]);return s}static min(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);let i=t.rows,n=t.columns,r=new v(i,n);for(let s=0;s<i;s++)for(let i=0;i<n;i++)r.set(s,i,Math.min(t.get(s,i),e.get(s,i)));return r}static max(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);let i=t.rows,n=t.columns,r=new this(i,n);for(let s=0;s<i;s++)for(let i=0;i<n;i++)r.set(s,i,Math.max(t.get(s,i),e.get(s,i)));return r}static checkMatrix(t){return x.isMatrix(t)?t:new v(t)}static isMatrix(t){return null!=t&&"Matrix"===t.klass}get size(){return this.rows*this.columns}apply(t){if("function"!=typeof t)throw new TypeError("callback must be a function");for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)t.call(this,e,i);return this}to1DArray(){let t=[];for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)t.push(this.get(e,i));return t}to2DArray(){let t=[];for(let e=0;e<this.rows;e++){t.push([]);for(let i=0;i<this.columns;i++)t[e].push(this.get(e,i))}return t}toJSON(){return this.to2DArray()}isRowVector(){return 1===this.rows}isColumnVector(){return 1===this.columns}isVector(){return 1===this.rows||1===this.columns}isSquare(){return this.rows===this.columns}isEmpty(){return 0===this.rows||0===this.columns}isSymmetric(){if(this.isSquare()){for(let t=0;t<this.rows;t++)for(let e=0;e<=t;e++)if(this.get(t,e)!==this.get(e,t))return!1;return!0}return!1}isDistance(){if(!this.isSymmetric())return!1;for(let t=0;t<this.rows;t++)if(0!==this.get(t,t))return!1;return!0}isEchelonForm(){let t=0,e=0,i=-1,n=!0,r=!1;for(;t<this.rows&&n;){for(e=0,r=!1;e<this.columns&&!1===r;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>i?(r=!0,i=e):(n=!1,r=!0);t++}return n}isReducedEchelonForm(){let t=0,e=0,i=-1,n=!0,r=!1;for(;t<this.rows&&n;){for(e=0,r=!1;e<this.columns&&!1===r;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>i?(r=!0,i=e):(n=!1,r=!0);for(let i=e+1;i<this.rows;i++)0!==this.get(t,i)&&(n=!1);t++}return n}echelonForm(){let t=this.clone(),e=0,i=0;for(;e<t.rows&&i<t.columns;){let n=e;for(let r=e;r<t.rows;r++)t.get(r,i)>t.get(n,i)&&(n=r);if(0===t.get(n,i))i++;else{t.swapRows(e,n);let r=t.get(e,i);for(let n=i;n<t.columns;n++)t.set(e,n,t.get(e,n)/r);for(let n=e+1;n<t.rows;n++){let r=t.get(n,i)/t.get(e,i);t.set(n,i,0);for(let s=i+1;s<t.columns;s++)t.set(n,s,t.get(n,s)-t.get(e,s)*r)}e++,i++}}return t}reducedEchelonForm(){let t=this.echelonForm(),e=t.columns,i=t.rows,n=i-1;for(;n>=0;)if(0===t.maxRow(n))n--;else{let r=0,s=!1;for(;r<i&&!1===s;)1===t.get(n,r)?s=!0:r++;for(let i=0;i<n;i++){let s=t.get(i,r);for(let o=r;o<e;o++){let e=t.get(i,o)-s*t.get(n,o);t.set(i,o,e)}}n--}return t}set(){throw new Error("set method is unimplemented")}get(){throw new Error("get method is unimplemented")}repeat(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{rows:e=1,columns:i=1}=t;if(!Number.isInteger(e)||e<=0)throw new TypeError("rows must be a positive integer");if(!Number.isInteger(i)||i<=0)throw new TypeError("columns must be a positive integer");let n=new v(this.rows*e,this.columns*i);for(let t=0;t<e;t++)for(let e=0;e<i;e++)n.setSubMatrix(this,this.rows*t,this.columns*e);return n}fill(t){for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.set(e,i,t);return this}neg(){return this.mulS(-1)}getRow(t){c(this,t);let e=[];for(let i=0;i<this.columns;i++)e.push(this.get(t,i));return e}getRowVector(t){return v.rowVector(this.getRow(t))}setRow(t,e){c(this,t),e=d(this,e);for(let i=0;i<this.columns;i++)this.set(t,i,e[i]);return this}swapRows(t,e){c(this,t),c(this,e);for(let i=0;i<this.columns;i++){let n=this.get(t,i);this.set(t,i,this.get(e,i)),this.set(e,i,n)}return this}getColumn(t){u(this,t);let e=[];for(let i=0;i<this.rows;i++)e.push(this.get(i,t));return e}getColumnVector(t){return v.columnVector(this.getColumn(t))}setColumn(t,e){u(this,t),e=g(this,e);for(let i=0;i<this.rows;i++)this.set(i,t,e[i]);return this}swapColumns(t,e){u(this,t),u(this,e);for(let i=0;i<this.rows;i++){let n=this.get(i,t);this.set(i,t,this.get(i,e)),this.set(i,e,n)}return this}addRowVector(t){t=d(this,t);for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.set(e,i,this.get(e,i)+t[i]);return this}subRowVector(t){t=d(this,t);for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.set(e,i,this.get(e,i)-t[i]);return this}mulRowVector(t){t=d(this,t);for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.set(e,i,this.get(e,i)*t[i]);return this}divRowVector(t){t=d(this,t);for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.set(e,i,this.get(e,i)/t[i]);return this}addColumnVector(t){t=g(this,t);for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.set(e,i,this.get(e,i)+t[e]);return this}subColumnVector(t){t=g(this,t);for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.set(e,i,this.get(e,i)-t[e]);return this}mulColumnVector(t){t=g(this,t);for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.set(e,i,this.get(e,i)*t[e]);return this}divColumnVector(t){t=g(this,t);for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.set(e,i,this.get(e,i)/t[e]);return this}mulRow(t,e){c(this,t);for(let i=0;i<this.columns;i++)this.set(t,i,this.get(t,i)*e);return this}mulColumn(t,e){u(this,t);for(let i=0;i<this.rows;i++)this.set(i,t,this.get(i,t)*e);return this}max(t){if(this.isEmpty())return NaN;switch(t){case"row":{const t=new Array(this.rows).fill(Number.NEGATIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.get(e,i)>t[e]&&(t[e]=this.get(e,i));return t}case"column":{const t=new Array(this.columns).fill(Number.NEGATIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.get(e,i)>t[i]&&(t[i]=this.get(e,i));return t}case void 0:{let t=this.get(0,0);for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.get(e,i)>t&&(t=this.get(e,i));return t}default:throw new Error(`invalid option: ${t}`)}}maxIndex(){w(this);let t=this.get(0,0),e=[0,0];for(let i=0;i<this.rows;i++)for(let n=0;n<this.columns;n++)this.get(i,n)>t&&(t=this.get(i,n),e[0]=i,e[1]=n);return e}min(t){if(this.isEmpty())return NaN;switch(t){case"row":{const t=new Array(this.rows).fill(Number.POSITIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.get(e,i)<t[e]&&(t[e]=this.get(e,i));return t}case"column":{const t=new Array(this.columns).fill(Number.POSITIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.get(e,i)<t[i]&&(t[i]=this.get(e,i));return t}case void 0:{let t=this.get(0,0);for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.get(e,i)<t&&(t=this.get(e,i));return t}default:throw new Error(`invalid option: ${t}`)}}minIndex(){w(this);let t=this.get(0,0),e=[0,0];for(let i=0;i<this.rows;i++)for(let n=0;n<this.columns;n++)this.get(i,n)<t&&(t=this.get(i,n),e[0]=i,e[1]=n);return e}maxRow(t){if(c(this,t),this.isEmpty())return NaN;let e=this.get(t,0);for(let i=1;i<this.columns;i++)this.get(t,i)>e&&(e=this.get(t,i));return e}maxRowIndex(t){c(this,t),w(this);let e=this.get(t,0),i=[t,0];for(let n=1;n<this.columns;n++)this.get(t,n)>e&&(e=this.get(t,n),i[1]=n);return i}minRow(t){if(c(this,t),this.isEmpty())return NaN;let e=this.get(t,0);for(let i=1;i<this.columns;i++)this.get(t,i)<e&&(e=this.get(t,i));return e}minRowIndex(t){c(this,t),w(this);let e=this.get(t,0),i=[t,0];for(let n=1;n<this.columns;n++)this.get(t,n)<e&&(e=this.get(t,n),i[1]=n);return i}maxColumn(t){if(u(this,t),this.isEmpty())return NaN;let e=this.get(0,t);for(let i=1;i<this.rows;i++)this.get(i,t)>e&&(e=this.get(i,t));return e}maxColumnIndex(t){u(this,t),w(this);let e=this.get(0,t),i=[0,t];for(let n=1;n<this.rows;n++)this.get(n,t)>e&&(e=this.get(n,t),i[0]=n);return i}minColumn(t){if(u(this,t),this.isEmpty())return NaN;let e=this.get(0,t);for(let i=1;i<this.rows;i++)this.get(i,t)<e&&(e=this.get(i,t));return e}minColumnIndex(t){u(this,t),w(this);let e=this.get(0,t),i=[0,t];for(let n=1;n<this.rows;n++)this.get(n,t)<e&&(e=this.get(n,t),i[0]=n);return i}diag(){let t=Math.min(this.rows,this.columns),e=[];for(let i=0;i<t;i++)e.push(this.get(i,i));return e}norm(t="frobenius"){switch(t){case"max":return this.max();case"frobenius":return Math.sqrt(this.dot(this));default:throw new RangeError(`unknown norm type: ${t}`)}}cumulativeSum(){let t=0;for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)t+=this.get(e,i),this.set(e,i,t);return this}dot(t){x.isMatrix(t)&&(t=t.to1DArray());let e=this.to1DArray();if(e.length!==t.length)throw new RangeError("vectors do not have the same size");let i=0;for(let n=0;n<e.length;n++)i+=e[n]*t[n];return i}mmul(t){t=v.checkMatrix(t);let e=this.rows,i=this.columns,n=t.columns,r=new v(e,n),s=new Float64Array(i);for(let o=0;o<n;o++){for(let e=0;e<i;e++)s[e]=t.get(e,o);for(let t=0;t<e;t++){let e=0;for(let n=0;n<i;n++)e+=this.get(t,n)*s[n];r.set(t,o,e)}}return r}strassen2x2(t){t=v.checkMatrix(t);let e=new v(2,2);const i=this.get(0,0),n=t.get(0,0),r=this.get(0,1),s=t.get(0,1),o=this.get(1,0),a=t.get(1,0),l=this.get(1,1),h=t.get(1,1),c=(i+l)*(n+h),u=(o+l)*n,d=i*(s-h),g=l*(a-n),f=(i+r)*h,p=c+g-f+(r-l)*(a+h),m=d+f,_=u+g,y=c-u+d+(o-i)*(n+s);return e.set(0,0,p),e.set(0,1,m),e.set(1,0,_),e.set(1,1,y),e}strassen3x3(t){t=v.checkMatrix(t);let e=new v(3,3);const i=this.get(0,0),n=this.get(0,1),r=this.get(0,2),s=this.get(1,0),o=this.get(1,1),a=this.get(1,2),l=this.get(2,0),h=this.get(2,1),c=this.get(2,2),u=t.get(0,0),d=t.get(0,1),g=t.get(0,2),f=t.get(1,0),p=t.get(1,1),m=t.get(1,2),_=t.get(2,0),y=t.get(2,1),w=t.get(2,2),x=(i-s)*(-d+p),b=(-i+s+o)*(u-d+p),E=(s+o)*(-u+d),S=i*u,I=(-i+l+h)*(u-g+m),M=(-i+l)*(g-m),C=(l+h)*(-u+g),T=(-r+h+c)*(p+_-y),R=(r-c)*(p-y),A=r*_,k=(h+c)*(-_+y),P=(-r+o+a)*(m+_-w),L=(r-a)*(m-w),N=(o+a)*(-_+w),D=S+A+n*f,O=(i+n+r-s-o-h-c)*p+b+E+S+T+A+k,F=S+I+C+(i+n+r-o-a-l-h)*m+A+P+N,z=x+o*(-u+d+f-p-m-_+w)+b+S+A+P+L,B=x+b+E+S+a*y,G=A+P+L+N+s*g,Y=S+I+M+h*(-u+g+f-p-m-_+y)+T+R+A,U=T+R+A+k+l*d,X=S+I+M+C+c*w;return e.set(0,0,D),e.set(0,1,O),e.set(0,2,F),e.set(1,0,z),e.set(1,1,B),e.set(1,2,G),e.set(2,0,Y),e.set(2,1,U),e.set(2,2,X),e}mmulStrassen(t){t=v.checkMatrix(t);let e=this.clone(),i=e.rows,n=e.columns,r=t.rows,s=t.columns;function o(t,e,i){let n=t.rows,r=t.columns;if(n===e&&r===i)return t;{let n=x.zeros(e,i);return n=n.setSubMatrix(t,0,0),n}}n!==r&&console.warn(`Multiplying ${i} x ${n} and ${r} x ${s} matrix: dimensions do not match.`);let a=Math.max(i,r),l=Math.max(n,s);return e=o(e,a,l),function t(e,i,n,r){if(n<=512||r<=512)return e.mmul(i);n%2==1&&r%2==1?(e=o(e,n+1,r+1),i=o(i,n+1,r+1)):n%2==1?(e=o(e,n+1,r),i=o(i,n+1,r)):r%2==1&&(e=o(e,n,r+1),i=o(i,n,r+1));let s=parseInt(e.rows/2,10),a=parseInt(e.columns/2,10),l=e.subMatrix(0,s-1,0,a-1),h=i.subMatrix(0,s-1,0,a-1),c=e.subMatrix(0,s-1,a,e.columns-1),u=i.subMatrix(0,s-1,a,i.columns-1),d=e.subMatrix(s,e.rows-1,0,a-1),g=i.subMatrix(s,i.rows-1,0,a-1),f=e.subMatrix(s,e.rows-1,a,e.columns-1),p=i.subMatrix(s,i.rows-1,a,i.columns-1),m=t(x.add(l,f),x.add(h,p),s,a),_=t(x.add(d,f),h,s,a),y=t(l,x.sub(u,p),s,a),w=t(f,x.sub(g,h),s,a),b=t(x.add(l,c),p,s,a),v=t(x.sub(d,l),x.add(h,u),s,a),E=t(x.sub(c,f),x.add(g,p),s,a),S=x.add(m,w);S.sub(b),S.add(E);let I=x.add(y,b),M=x.add(_,w),C=x.sub(m,_);C.add(y),C.add(v);let T=x.zeros(2*S.rows,2*S.columns);return T=T.setSubMatrix(S,0,0),T=T.setSubMatrix(I,S.rows,0),T=T.setSubMatrix(M,0,S.columns),T=T.setSubMatrix(C,S.rows,S.columns),T.subMatrix(0,n-1,0,r-1)}(e,t=o(t,a,l),a,l)}scaleRows(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{min:e=0,max:i=1}=t;if(!Number.isFinite(e))throw new TypeError("min must be a number");if(!Number.isFinite(i))throw new TypeError("max must be a number");if(e>=i)throw new RangeError("min must be smaller than max");let n=new v(this.rows,this.columns);for(let t=0;t<this.rows;t++){const s=this.getRow(t);s.length>0&&r(s,{min:e,max:i,output:s}),n.setRow(t,s)}return n}scaleColumns(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{min:e=0,max:i=1}=t;if(!Number.isFinite(e))throw new TypeError("min must be a number");if(!Number.isFinite(i))throw new TypeError("max must be a number");if(e>=i)throw new RangeError("min must be smaller than max");let n=new v(this.rows,this.columns);for(let t=0;t<this.columns;t++){const s=this.getColumn(t);s.length&&r(s,{min:e,max:i,output:s}),n.setColumn(t,s)}return n}flipRows(){const t=Math.ceil(this.columns/2);for(let e=0;e<this.rows;e++)for(let i=0;i<t;i++){let t=this.get(e,i),n=this.get(e,this.columns-1-i);this.set(e,i,n),this.set(e,this.columns-1-i,t)}return this}flipColumns(){const t=Math.ceil(this.rows/2);for(let e=0;e<this.columns;e++)for(let i=0;i<t;i++){let t=this.get(i,e),n=this.get(this.rows-1-i,e);this.set(i,e,n),this.set(this.rows-1-i,e,t)}return this}kroneckerProduct(t){t=v.checkMatrix(t);let e=this.rows,i=this.columns,n=t.rows,r=t.columns,s=new v(e*n,i*r);for(let o=0;o<e;o++)for(let e=0;e<i;e++)for(let i=0;i<n;i++)for(let a=0;a<r;a++)s.set(n*o+i,r*e+a,this.get(o,e)*t.get(i,a));return s}kroneckerSum(t){if(t=v.checkMatrix(t),!this.isSquare()||!t.isSquare())throw new Error("Kronecker Sum needs two Square Matrices");let e=this.rows,i=t.rows,n=this.kroneckerProduct(v.eye(i,i)),r=v.eye(e,e).kroneckerProduct(t);return n.add(r)}transpose(){let t=new v(this.columns,this.rows);for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)t.set(i,e,this.get(e,i));return t}sortRows(t=b){for(let e=0;e<this.rows;e++)this.setRow(e,this.getRow(e).sort(t));return this}sortColumns(t=b){for(let e=0;e<this.columns;e++)this.setColumn(e,this.getColumn(e).sort(t));return this}subMatrix(t,e,i,n){m(this,t,e,i,n);let r=new v(e-t+1,n-i+1);for(let s=t;s<=e;s++)for(let e=i;e<=n;e++)r.set(s-t,e-i,this.get(s,e));return r}subMatrixRow(t,e,i){if(void 0===e&&(e=0),void 0===i&&(i=this.columns-1),e>i||e<0||e>=this.columns||i<0||i>=this.columns)throw new RangeError("Argument out of range");let n=new v(t.length,i-e+1);for(let r=0;r<t.length;r++)for(let s=e;s<=i;s++){if(t[r]<0||t[r]>=this.rows)throw new RangeError(`Row index out of range: ${t[r]}`);n.set(r,s-e,this.get(t[r],s))}return n}subMatrixColumn(t,e,i){if(void 0===e&&(e=0),void 0===i&&(i=this.rows-1),e>i||e<0||e>=this.rows||i<0||i>=this.rows)throw new RangeError("Argument out of range");let n=new v(i-e+1,t.length);for(let r=0;r<t.length;r++)for(let s=e;s<=i;s++){if(t[r]<0||t[r]>=this.columns)throw new RangeError(`Column index out of range: ${t[r]}`);n.set(s-e,r,this.get(s,t[r]))}return n}setSubMatrix(t,e,i){if((t=v.checkMatrix(t)).isEmpty())return this;m(this,e,e+t.rows-1,i,i+t.columns-1);for(let n=0;n<t.rows;n++)for(let r=0;r<t.columns;r++)this.set(e+n,i+r,t.get(n,r));return this}selection(t,e){f(this,t),p(this,e);let i=new v(t.length,e.length);for(let n=0;n<t.length;n++){let r=t[n];for(let t=0;t<e.length;t++){let s=e[t];i.set(n,t,this.get(r,s))}}return i}trace(){let t=Math.min(this.rows,this.columns),e=0;for(let i=0;i<t;i++)e+=this.get(i,i);return e}clone(){return this.constructor.copy(this,new v(this.rows,this.columns))}static copy(t,e){for(const[i,n,r]of t.entries())e.set(i,n,r);return e}sum(t){switch(t){case"row":return function(t){let e=_(t.rows);for(let i=0;i<t.rows;++i)for(let n=0;n<t.columns;++n)e[i]+=t.get(i,n);return e}(this);case"column":return function(t){let e=_(t.columns);for(let i=0;i<t.rows;++i)for(let n=0;n<t.columns;++n)e[n]+=t.get(i,n);return e}(this);case void 0:return function(t){let e=0;for(let i=0;i<t.rows;i++)for(let n=0;n<t.columns;n++)e+=t.get(i,n);return e}(this);default:throw new Error(`invalid option: ${t}`)}}product(t){switch(t){case"row":return function(t){let e=_(t.rows,1);for(let i=0;i<t.rows;++i)for(let n=0;n<t.columns;++n)e[i]*=t.get(i,n);return e}(this);case"column":return function(t){let e=_(t.columns,1);for(let i=0;i<t.rows;++i)for(let n=0;n<t.columns;++n)e[n]*=t.get(i,n);return e}(this);case void 0:return function(t){let e=1;for(let i=0;i<t.rows;i++)for(let n=0;n<t.columns;n++)e*=t.get(i,n);return e}(this);default:throw new Error(`invalid option: ${t}`)}}mean(t){const e=this.sum(t);switch(t){case"row":for(let t=0;t<this.rows;t++)e[t]/=this.columns;return e;case"column":for(let t=0;t<this.columns;t++)e[t]/=this.rows;return e;case void 0:return e/this.size;default:throw new Error(`invalid option: ${t}`)}}variance(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw new TypeError("options must be an object");const{unbiased:i=!0,mean:r=this.mean(t)}=e;if("boolean"!=typeof i)throw new TypeError("unbiased must be a boolean");switch(t){case"row":if(!n.isAnyArray(r))throw new TypeError("mean must be an array");return function(t,e,i){const n=t.rows,r=t.columns,s=[];for(let o=0;o<n;o++){let n=0,a=0,l=0;for(let e=0;e<r;e++)l=t.get(o,e)-i[o],n+=l,a+=l*l;e?s.push((a-n*n/r)/(r-1)):s.push((a-n*n/r)/r)}return s}(this,i,r);case"column":if(!n.isAnyArray(r))throw new TypeError("mean must be an array");return function(t,e,i){const n=t.rows,r=t.columns,s=[];for(let o=0;o<r;o++){let r=0,a=0,l=0;for(let e=0;e<n;e++)l=t.get(e,o)-i[o],r+=l,a+=l*l;e?s.push((a-r*r/n)/(n-1)):s.push((a-r*r/n)/n)}return s}(this,i,r);case void 0:if("number"!=typeof r)throw new TypeError("mean must be a number");return function(t,e,i){const n=t.rows,r=t.columns,s=n*r;let o=0,a=0,l=0;for(let e=0;e<n;e++)for(let n=0;n<r;n++)l=t.get(e,n)-i,o+=l,a+=l*l;return e?(a-o*o/s)/(s-1):(a-o*o/s)/s}(this,i,r);default:throw new Error(`invalid option: ${t}`)}}standardDeviation(t,e){"object"==typeof t&&(e=t,t=void 0);const i=this.variance(t,e);if(void 0===t)return Math.sqrt(i);for(let t=0;t<i.length;t++)i[t]=Math.sqrt(i[t]);return i}center(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw new TypeError("options must be an object");const{center:i=this.mean(t)}=e;switch(t){case"row":if(!n.isAnyArray(i))throw new TypeError("center must be an array");return function(t,e){for(let i=0;i<t.rows;i++)for(let n=0;n<t.columns;n++)t.set(i,n,t.get(i,n)-e[i])}(this,i),this;case"column":if(!n.isAnyArray(i))throw new TypeError("center must be an array");return function(t,e){for(let i=0;i<t.rows;i++)for(let n=0;n<t.columns;n++)t.set(i,n,t.get(i,n)-e[n])}(this,i),this;case void 0:if("number"!=typeof i)throw new TypeError("center must be a number");return function(t,e){for(let i=0;i<t.rows;i++)for(let n=0;n<t.columns;n++)t.set(i,n,t.get(i,n)-e)}(this,i),this;default:throw new Error(`invalid option: ${t}`)}}scale(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw new TypeError("options must be an object");let i=e.scale;switch(t){case"row":if(void 0===i)i=function(t){const e=[];for(let i=0;i<t.rows;i++){let n=0;for(let e=0;e<t.columns;e++)n+=Math.pow(t.get(i,e),2)/(t.columns-1);e.push(Math.sqrt(n))}return e}(this);else if(!n.isAnyArray(i))throw new TypeError("scale must be an array");return function(t,e){for(let i=0;i<t.rows;i++)for(let n=0;n<t.columns;n++)t.set(i,n,t.get(i,n)/e[i])}(this,i),this;case"column":if(void 0===i)i=function(t){const e=[];for(let i=0;i<t.columns;i++){let n=0;for(let e=0;e<t.rows;e++)n+=Math.pow(t.get(e,i),2)/(t.rows-1);e.push(Math.sqrt(n))}return e}(this);else if(!n.isAnyArray(i))throw new TypeError("scale must be an array");return function(t,e){for(let i=0;i<t.rows;i++)for(let n=0;n<t.columns;n++)t.set(i,n,t.get(i,n)/e[n])}(this,i),this;case void 0:if(void 0===i)i=function(t){const e=t.size-1;let i=0;for(let n=0;n<t.columns;n++)for(let r=0;r<t.rows;r++)i+=Math.pow(t.get(r,n),2)/e;return Math.sqrt(i)}(this);else if("number"!=typeof i)throw new TypeError("scale must be a number");return function(t,e){for(let i=0;i<t.rows;i++)for(let n=0;n<t.columns;n++)t.set(i,n,t.get(i,n)/e)}(this,i),this;default:throw new Error(`invalid option: ${t}`)}}toString(t){return a(this,t)}[Symbol.iterator](){return this.entries()}*entries(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)yield[t,e,this.get(t,e)]}*values(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)yield this.get(t,e)}}function b(t,e){return t-e}x.prototype.klass="Matrix","undefined"!=typeof Symbol&&(x.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return a(this)}),x.random=x.rand,x.randomInt=x.randInt,x.diagonal=x.diag,x.prototype.diagonal=x.prototype.diag,x.identity=x.eye,x.prototype.negate=x.prototype.neg,x.prototype.tensorProduct=x.prototype.kroneckerProduct;class v extends x{data;#t(t,e){if(this.data=[],!(Number.isInteger(e)&&e>=0))throw new TypeError("nColumns must be a positive integer");for(let i=0;i<t;i++)this.data.push(new Float64Array(e));this.rows=t,this.columns=e}constructor(t,e){if(super(),v.isMatrix(t))this.#t(t.rows,t.columns),v.copy(t,this);else if(Number.isInteger(t)&&t>=0)this.#t(t,e);else{if(!n.isAnyArray(t))throw new TypeError("First argument must be a positive number or an array");{const i=t;if("number"!=typeof(e=(t=i.length)?i[0].length:0))throw new TypeError("Data must be a 2D array with at least one element");this.data=[];for(let n=0;n<t;n++){if(i[n].length!==e)throw new RangeError("Inconsistent array dimensions");if(!i[n].every((t=>"number"==typeof t)))throw new TypeError("Input data contains non-numeric values");this.data.push(Float64Array.from(i[n]))}this.rows=t,this.columns=e}}}set(t,e,i){return this.data[t][e]=i,this}get(t,e){return this.data[t][e]}removeRow(t){return c(this,t),this.data.splice(t,1),this.rows-=1,this}addRow(t,e){return void 0===e&&(e=t,t=this.rows),c(this,t,!0),e=Float64Array.from(d(this,e)),this.data.splice(t,0,e),this.rows+=1,this}removeColumn(t){u(this,t);for(let e=0;e<this.rows;e++){const i=new Float64Array(this.columns-1);for(let n=0;n<t;n++)i[n]=this.data[e][n];for(let n=t+1;n<this.columns;n++)i[n-1]=this.data[e][n];this.data[e]=i}return this.columns-=1,this}addColumn(t,e){void 0===e&&(e=t,t=this.columns),u(this,t,!0),e=g(this,e);for(let i=0;i<this.rows;i++){const n=new Float64Array(this.columns+1);let r=0;for(;r<t;r++)n[r]=this.data[i][r];for(n[r++]=e[i];r<this.columns+1;r++)n[r]=this.data[i][r-1];this.data[i]=n}return this.columns+=1,this}}!function(t,e){t.prototype.add=function(t){return"number"==typeof t?this.addS(t):this.addM(t)},t.prototype.addS=function(t){for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.set(e,i,this.get(e,i)+t);return this},t.prototype.addM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.set(e,i,this.get(e,i)+t.get(e,i));return this},t.add=function(t,i){return new e(t).add(i)},t.prototype.sub=function(t){return"number"==typeof t?this.subS(t):this.subM(t)},t.prototype.subS=function(t){for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.set(e,i,this.get(e,i)-t);return this},t.prototype.subM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.set(e,i,this.get(e,i)-t.get(e,i));return this},t.sub=function(t,i){return new e(t).sub(i)},t.prototype.subtract=t.prototype.sub,t.prototype.subtractS=t.prototype.subS,t.prototype.subtractM=t.prototype.subM,t.subtract=t.sub,t.prototype.mul=function(t){return"number"==typeof t?this.mulS(t):this.mulM(t)},t.prototype.mulS=function(t){for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.set(e,i,this.get(e,i)*t);return this},t.prototype.mulM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.set(e,i,this.get(e,i)*t.get(e,i));return this},t.mul=function(t,i){return new e(t).mul(i)},t.prototype.multiply=t.prototype.mul,t.prototype.multiplyS=t.prototype.mulS,t.prototype.multiplyM=t.prototype.mulM,t.multiply=t.mul,t.prototype.div=function(t){return"number"==typeof t?this.divS(t):this.divM(t)},t.prototype.divS=function(t){for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.set(e,i,this.get(e,i)/t);return this},t.prototype.divM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.set(e,i,this.get(e,i)/t.get(e,i));return this},t.div=function(t,i){return new e(t).div(i)},t.prototype.divide=t.prototype.div,t.prototype.divideS=t.prototype.divS,t.prototype.divideM=t.prototype.divM,t.divide=t.div,t.prototype.mod=function(t){return"number"==typeof t?this.modS(t):this.modM(t)},t.prototype.modS=function(t){for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.set(e,i,this.get(e,i)%t);return this},t.prototype.modM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.set(e,i,this.get(e,i)%t.get(e,i));return this},t.mod=function(t,i){return new e(t).mod(i)},t.prototype.modulus=t.prototype.mod,t.prototype.modulusS=t.prototype.modS,t.prototype.modulusM=t.prototype.modM,t.modulus=t.mod,t.prototype.and=function(t){return"number"==typeof t?this.andS(t):this.andM(t)},t.prototype.andS=function(t){for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.set(e,i,this.get(e,i)&t);return this},t.prototype.andM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.set(e,i,this.get(e,i)&t.get(e,i));return this},t.and=function(t,i){return new e(t).and(i)},t.prototype.or=function(t){return"number"==typeof t?this.orS(t):this.orM(t)},t.prototype.orS=function(t){for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.set(e,i,this.get(e,i)|t);return this},t.prototype.orM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.set(e,i,this.get(e,i)|t.get(e,i));return this},t.or=function(t,i){return new e(t).or(i)},t.prototype.xor=function(t){return"number"==typeof t?this.xorS(t):this.xorM(t)},t.prototype.xorS=function(t){for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.set(e,i,this.get(e,i)^t);return this},t.prototype.xorM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.set(e,i,this.get(e,i)^t.get(e,i));return this},t.xor=function(t,i){return new e(t).xor(i)},t.prototype.leftShift=function(t){return"number"==typeof t?this.leftShiftS(t):this.leftShiftM(t)},t.prototype.leftShiftS=function(t){for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.set(e,i,this.get(e,i)<<t);return this},t.prototype.leftShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.set(e,i,this.get(e,i)<<t.get(e,i));return this},t.leftShift=function(t,i){return new e(t).leftShift(i)},t.prototype.signPropagatingRightShift=function(t){return"number"==typeof t?this.signPropagatingRightShiftS(t):this.signPropagatingRightShiftM(t)},t.prototype.signPropagatingRightShiftS=function(t){for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.set(e,i,this.get(e,i)>>t);return this},t.prototype.signPropagatingRightShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.set(e,i,this.get(e,i)>>t.get(e,i));return this},t.signPropagatingRightShift=function(t,i){return new e(t).signPropagatingRightShift(i)},t.prototype.rightShift=function(t){return"number"==typeof t?this.rightShiftS(t):this.rightShiftM(t)},t.prototype.rightShiftS=function(t){for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.set(e,i,this.get(e,i)>>>t);return this},t.prototype.rightShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.set(e,i,this.get(e,i)>>>t.get(e,i));return this},t.rightShift=function(t,i){return new e(t).rightShift(i)},t.prototype.zeroFillRightShift=t.prototype.rightShift,t.prototype.zeroFillRightShiftS=t.prototype.rightShiftS,t.prototype.zeroFillRightShiftM=t.prototype.rightShiftM,t.zeroFillRightShift=t.rightShift,t.prototype.not=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,~this.get(t,e));return this},t.not=function(t){return new e(t).not()},t.prototype.abs=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.abs(this.get(t,e)));return this},t.abs=function(t){return new e(t).abs()},t.prototype.acos=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.acos(this.get(t,e)));return this},t.acos=function(t){return new e(t).acos()},t.prototype.acosh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.acosh(this.get(t,e)));return this},t.acosh=function(t){return new e(t).acosh()},t.prototype.asin=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.asin(this.get(t,e)));return this},t.asin=function(t){return new e(t).asin()},t.prototype.asinh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.asinh(this.get(t,e)));return this},t.asinh=function(t){return new e(t).asinh()},t.prototype.atan=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.atan(this.get(t,e)));return this},t.atan=function(t){return new e(t).atan()},t.prototype.atanh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.atanh(this.get(t,e)));return this},t.atanh=function(t){return new e(t).atanh()},t.prototype.cbrt=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cbrt(this.get(t,e)));return this},t.cbrt=function(t){return new e(t).cbrt()},t.prototype.ceil=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.ceil(this.get(t,e)));return this},t.ceil=function(t){return new e(t).ceil()},t.prototype.clz32=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.clz32(this.get(t,e)));return this},t.clz32=function(t){return new e(t).clz32()},t.prototype.cos=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cos(this.get(t,e)));return this},t.cos=function(t){return new e(t).cos()},t.prototype.cosh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cosh(this.get(t,e)));return this},t.cosh=function(t){return new e(t).cosh()},t.prototype.exp=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.exp(this.get(t,e)));return this},t.exp=function(t){return new e(t).exp()},t.prototype.expm1=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.expm1(this.get(t,e)));return this},t.expm1=function(t){return new e(t).expm1()},t.prototype.floor=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.floor(this.get(t,e)));return this},t.floor=function(t){return new e(t).floor()},t.prototype.fround=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.fround(this.get(t,e)));return this},t.fround=function(t){return new e(t).fround()},t.prototype.log=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log(this.get(t,e)));return this},t.log=function(t){return new e(t).log()},t.prototype.log1p=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log1p(this.get(t,e)));return this},t.log1p=function(t){return new e(t).log1p()},t.prototype.log10=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log10(this.get(t,e)));return this},t.log10=function(t){return new e(t).log10()},t.prototype.log2=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log2(this.get(t,e)));return this},t.log2=function(t){return new e(t).log2()},t.prototype.round=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.round(this.get(t,e)));return this},t.round=function(t){return new e(t).round()},t.prototype.sign=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sign(this.get(t,e)));return this},t.sign=function(t){return new e(t).sign()},t.prototype.sin=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sin(this.get(t,e)));return this},t.sin=function(t){return new e(t).sin()},t.prototype.sinh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sinh(this.get(t,e)));return this},t.sinh=function(t){return new e(t).sinh()},t.prototype.sqrt=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sqrt(this.get(t,e)));return this},t.sqrt=function(t){return new e(t).sqrt()},t.prototype.tan=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.tan(this.get(t,e)));return this},t.tan=function(t){return new e(t).tan()},t.prototype.tanh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.tanh(this.get(t,e)));return this},t.tanh=function(t){return new e(t).tanh()},t.prototype.trunc=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.trunc(this.get(t,e)));return this},t.trunc=function(t){return new e(t).trunc()},t.pow=function(t,i){return new e(t).pow(i)},t.prototype.pow=function(t){return"number"==typeof t?this.powS(t):this.powM(t)},t.prototype.powS=function(t){for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.set(e,i,Math.pow(this.get(e,i),t));return this},t.prototype.powM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.set(e,i,Math.pow(this.get(e,i),t.get(e,i)));return this}}(x,v);class E extends x{#e;get size(){return this.#e.size}get rows(){return this.#e.rows}get columns(){return this.#e.columns}get diagonalSize(){return this.rows}static isSymmetricMatrix(t){return v.isMatrix(t)&&"SymmetricMatrix"===t.klassType}static zeros(t){return new this(t)}static ones(t){return new this(t).fill(1)}constructor(t){if(super(),v.isMatrix(t)){if(!t.isSymmetric())throw new TypeError("not symmetric data");this.#e=v.copy(t,new v(t.rows,t.rows))}else if(Number.isInteger(t)&&t>=0)this.#e=new v(t,t);else if(this.#e=new v(t),!this.isSymmetric())throw new TypeError("not symmetric data")}clone(){const t=new E(this.diagonalSize);for(const[e,i,n]of this.upperRightEntries())t.set(e,i,n);return t}toMatrix(){return new v(this)}get(t,e){return this.#e.get(t,e)}set(t,e,i){return this.#e.set(t,e,i),this.#e.set(e,t,i),this}removeCross(t){return this.#e.removeRow(t),this.#e.removeColumn(t),this}addCross(t,e){void 0===e&&(e=t,t=this.diagonalSize);const i=e.slice();return i.splice(t,1),this.#e.addRow(t,i),this.#e.addColumn(t,e),this}applyMask(t){if(t.length!==this.diagonalSize)throw new RangeError("Mask size do not match with matrix size");const e=[];for(const[i,n]of t.entries())n||e.push(i);e.reverse();for(const t of e)this.removeCross(t);return this}toCompact(){const{diagonalSize:t}=this,e=new Array(t*(t+1)/2);for(let i=0,n=0,r=0;r<e.length;r++)e[r]=this.get(n,i),++i>=t&&(i=++n);return e}static fromCompact(t){const e=t.length,i=(Math.sqrt(8*e+1)-1)/2;if(!Number.isInteger(i))throw new TypeError(`This array is not a compact representation of a Symmetric Matrix, ${JSON.stringify(t)}`);const n=new E(i);for(let r=0,s=0,o=0;o<e;o++)n.set(r,s,t[o]),++r>=i&&(r=++s);return n}*upperRightEntries(){for(let t=0,e=0;t<this.diagonalSize;void 0){const i=this.get(t,e);yield[t,e,i],++e>=this.diagonalSize&&(e=++t)}}*upperRightValues(){for(let t=0,e=0;t<this.diagonalSize;void 0){const i=this.get(t,e);yield i,++e>=this.diagonalSize&&(e=++t)}}}E.prototype.klassType="SymmetricMatrix";class S extends E{static isDistanceMatrix(t){return E.isSymmetricMatrix(t)&&"DistanceMatrix"===t.klassSubType}constructor(t){if(super(t),!this.isDistance())throw new TypeError("Provided arguments do no produce a distance matrix")}set(t,e,i){return t===e&&(i=0),super.set(t,e,i)}addCross(t,e){return void 0===e&&(e=t,t=this.diagonalSize),(e=e.slice())[t]=0,super.addCross(t,e)}toSymmetricMatrix(){return new E(this)}clone(){const t=new S(this.diagonalSize);for(const[e,i,n]of this.upperRightEntries())e!==i&&t.set(e,i,n);return t}toCompact(){const{diagonalSize:t}=this,e=new Array((t-1)*t/2);for(let i=1,n=0,r=0;r<e.length;r++)e[r]=this.get(n,i),++i>=t&&(i=1+ ++n);return e}static fromCompact(t){const e=t.length,i=(Math.sqrt(8*e+1)+1)/2;if(!Number.isInteger(i))throw new TypeError(`This array is not a compact representation of a DistanceMatrix, ${JSON.stringify(t)}`);const n=new this(i);for(let r=1,s=0,o=0;o<e;o++)n.set(r,s,t[o]),++r>=i&&(r=1+ ++s);return n}}S.prototype.klassSubType="DistanceMatrix";class I extends x{constructor(t,e,i){super(),this.matrix=t,this.rows=e,this.columns=i}}class M extends I{constructor(t,e,i){f(t,e),p(t,i),super(t,e.length,i.length),this.rowIndices=e,this.columnIndices=i}set(t,e,i){return this.matrix.set(this.rowIndices[t],this.columnIndices[e],i),this}get(t,e){return this.matrix.get(this.rowIndices[t],this.columnIndices[e])}}class C extends x{constructor(t,e={}){const{rows:i=1}=e;if(t.length%i!=0)throw new Error("the data length is not divisible by the number of rows");super(),this.rows=i,this.columns=t.length/i,this.data=t}set(t,e,i){let n=this._calculateIndex(t,e);return this.data[n]=i,this}get(t,e){let i=this._calculateIndex(t,e);return this.data[i]}_calculateIndex(t,e){return t*this.columns+e}}class T extends x{constructor(t){super(),this.data=t,this.rows=t.length,this.columns=t[0].length}set(t,e,i){return this.data[t][e]=i,this}get(t,e){return this.data[t][e]}}class R{constructor(t){let e,i,n,r,s,o,a,l,h,c=(t=T.checkMatrix(t)).clone(),u=c.rows,d=c.columns,g=new Float64Array(u),f=1;for(e=0;e<u;e++)g[e]=e;for(l=new Float64Array(u),i=0;i<d;i++){for(e=0;e<u;e++)l[e]=c.get(e,i);for(e=0;e<u;e++){for(h=Math.min(e,i),s=0,n=0;n<h;n++)s+=c.get(e,n)*l[n];l[e]-=s,c.set(e,i,l[e])}for(r=i,e=i+1;e<u;e++)Math.abs(l[e])>Math.abs(l[r])&&(r=e);if(r!==i){for(n=0;n<d;n++)o=c.get(r,n),c.set(r,n,c.get(i,n)),c.set(i,n,o);a=g[r],g[r]=g[i],g[i]=a,f=-f}if(i<u&&0!==c.get(i,i))for(e=i+1;e<u;e++)c.set(e,i,c.get(e,i)/c.get(i,i))}this.LU=c,this.pivotVector=g,this.pivotSign=f}isSingular(){let t=this.LU,e=t.columns;for(let i=0;i<e;i++)if(0===t.get(i,i))return!0;return!1}solve(t){t=v.checkMatrix(t);let e=this.LU;if(e.rows!==t.rows)throw new Error("Invalid matrix dimensions");if(this.isSingular())throw new Error("LU matrix is singular");let i,n,r,s=t.columns,o=t.subMatrixRow(this.pivotVector,0,s-1),a=e.columns;for(r=0;r<a;r++)for(i=r+1;i<a;i++)for(n=0;n<s;n++)o.set(i,n,o.get(i,n)-o.get(r,n)*e.get(i,r));for(r=a-1;r>=0;r--){for(n=0;n<s;n++)o.set(r,n,o.get(r,n)/e.get(r,r));for(i=0;i<r;i++)for(n=0;n<s;n++)o.set(i,n,o.get(i,n)-o.get(r,n)*e.get(i,r))}return o}get determinant(){let t=this.LU;if(!t.isSquare())throw new Error("Matrix must be square");let e=this.pivotSign,i=t.columns;for(let n=0;n<i;n++)e*=t.get(n,n);return e}get lowerTriangularMatrix(){let t=this.LU,e=t.rows,i=t.columns,n=new v(e,i);for(let r=0;r<e;r++)for(let e=0;e<i;e++)r>e?n.set(r,e,t.get(r,e)):r===e?n.set(r,e,1):n.set(r,e,0);return n}get upperTriangularMatrix(){let t=this.LU,e=t.rows,i=t.columns,n=new v(e,i);for(let r=0;r<e;r++)for(let e=0;e<i;e++)r<=e?n.set(r,e,t.get(r,e)):n.set(r,e,0);return n}get pivotPermutationVector(){return Array.from(this.pivotVector)}}function A(t,e){let i=0;return Math.abs(t)>Math.abs(e)?(i=e/t,Math.abs(t)*Math.sqrt(1+i*i)):0!==e?(i=t/e,Math.abs(e)*Math.sqrt(1+i*i)):0}class k{constructor(t){let e,i,n,r,s=(t=T.checkMatrix(t)).clone(),o=t.rows,a=t.columns,l=new Float64Array(a);for(n=0;n<a;n++){let t=0;for(e=n;e<o;e++)t=A(t,s.get(e,n));if(0!==t){for(s.get(n,n)<0&&(t=-t),e=n;e<o;e++)s.set(e,n,s.get(e,n)/t);for(s.set(n,n,s.get(n,n)+1),i=n+1;i<a;i++){for(r=0,e=n;e<o;e++)r+=s.get(e,n)*s.get(e,i);for(r=-r/s.get(n,n),e=n;e<o;e++)s.set(e,i,s.get(e,i)+r*s.get(e,n))}}l[n]=-t}this.QR=s,this.Rdiag=l}solve(t){t=v.checkMatrix(t);let e=this.QR,i=e.rows;if(t.rows!==i)throw new Error("Matrix row dimensions must agree");if(!this.isFullRank())throw new Error("Matrix is rank deficient");let n,r,s,o,a=t.columns,l=t.clone(),h=e.columns;for(s=0;s<h;s++)for(r=0;r<a;r++){for(o=0,n=s;n<i;n++)o+=e.get(n,s)*l.get(n,r);for(o=-o/e.get(s,s),n=s;n<i;n++)l.set(n,r,l.get(n,r)+o*e.get(n,s))}for(s=h-1;s>=0;s--){for(r=0;r<a;r++)l.set(s,r,l.get(s,r)/this.Rdiag[s]);for(n=0;n<s;n++)for(r=0;r<a;r++)l.set(n,r,l.get(n,r)-l.get(s,r)*e.get(n,s))}return l.subMatrix(0,h-1,0,a-1)}isFullRank(){let t=this.QR.columns;for(let e=0;e<t;e++)if(0===this.Rdiag[e])return!1;return!0}get upperTriangularMatrix(){let t,e,i=this.QR,n=i.columns,r=new v(n,n);for(t=0;t<n;t++)for(e=0;e<n;e++)t<e?r.set(t,e,i.get(t,e)):t===e?r.set(t,e,this.Rdiag[t]):r.set(t,e,0);return r}get orthogonalMatrix(){let t,e,i,n,r=this.QR,s=r.rows,o=r.columns,a=new v(s,o);for(i=o-1;i>=0;i--){for(t=0;t<s;t++)a.set(t,i,0);for(a.set(i,i,1),e=i;e<o;e++)if(0!==r.get(i,i)){for(n=0,t=i;t<s;t++)n+=r.get(t,i)*a.get(t,e);for(n=-n/r.get(i,i),t=i;t<s;t++)a.set(t,e,a.get(t,e)+n*r.get(t,i))}}return a}}class P{constructor(t,e={}){if((t=T.checkMatrix(t)).isEmpty())throw new Error("Matrix must be non-empty");let i=t.rows,n=t.columns;const{computeLeftSingularVectors:r=!0,computeRightSingularVectors:s=!0,autoTranspose:o=!1}=e;let a,l=Boolean(r),h=Boolean(s),c=!1;if(i<n)if(o){a=t.transpose(),i=a.rows,n=a.columns,c=!0;let e=l;l=h,h=e}else a=t.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else a=t.clone();let u=Math.min(i,n),d=Math.min(i+1,n),g=new Float64Array(d),f=new v(i,u),p=new v(n,n),m=new Float64Array(n),_=new Float64Array(i),y=new Float64Array(d);for(let t=0;t<d;t++)y[t]=t;let w=Math.min(i-1,n),x=Math.max(0,Math.min(n-2,i)),b=Math.max(w,x);for(let t=0;t<b;t++){if(t<w){g[t]=0;for(let e=t;e<i;e++)g[t]=A(g[t],a.get(e,t));if(0!==g[t]){a.get(t,t)<0&&(g[t]=-g[t]);for(let e=t;e<i;e++)a.set(e,t,a.get(e,t)/g[t]);a.set(t,t,a.get(t,t)+1)}g[t]=-g[t]}for(let e=t+1;e<n;e++){if(t<w&&0!==g[t]){let n=0;for(let r=t;r<i;r++)n+=a.get(r,t)*a.get(r,e);n=-n/a.get(t,t);for(let r=t;r<i;r++)a.set(r,e,a.get(r,e)+n*a.get(r,t))}m[e]=a.get(t,e)}if(l&&t<w)for(let e=t;e<i;e++)f.set(e,t,a.get(e,t));if(t<x){m[t]=0;for(let e=t+1;e<n;e++)m[t]=A(m[t],m[e]);if(0!==m[t]){m[t+1]<0&&(m[t]=0-m[t]);for(let e=t+1;e<n;e++)m[e]/=m[t];m[t+1]+=1}if(m[t]=-m[t],t+1<i&&0!==m[t]){for(let e=t+1;e<i;e++)_[e]=0;for(let e=t+1;e<i;e++)for(let i=t+1;i<n;i++)_[e]+=m[i]*a.get(e,i);for(let e=t+1;e<n;e++){let n=-m[e]/m[t+1];for(let r=t+1;r<i;r++)a.set(r,e,a.get(r,e)+n*_[r])}}if(h)for(let e=t+1;e<n;e++)p.set(e,t,m[e])}}let E=Math.min(n,i+1);if(w<n&&(g[w]=a.get(w,w)),i<E&&(g[E-1]=0),x+1<E&&(m[x]=a.get(x,E-1)),m[E-1]=0,l){for(let t=w;t<u;t++){for(let e=0;e<i;e++)f.set(e,t,0);f.set(t,t,1)}for(let t=w-1;t>=0;t--)if(0!==g[t]){for(let e=t+1;e<u;e++){let n=0;for(let r=t;r<i;r++)n+=f.get(r,t)*f.get(r,e);n=-n/f.get(t,t);for(let r=t;r<i;r++)f.set(r,e,f.get(r,e)+n*f.get(r,t))}for(let e=t;e<i;e++)f.set(e,t,-f.get(e,t));f.set(t,t,1+f.get(t,t));for(let e=0;e<t-1;e++)f.set(e,t,0)}else{for(let e=0;e<i;e++)f.set(e,t,0);f.set(t,t,1)}}if(h)for(let t=n-1;t>=0;t--){if(t<x&&0!==m[t])for(let e=t+1;e<n;e++){let i=0;for(let r=t+1;r<n;r++)i+=p.get(r,t)*p.get(r,e);i=-i/p.get(t+1,t);for(let r=t+1;r<n;r++)p.set(r,e,p.get(r,e)+i*p.get(r,t))}for(let e=0;e<n;e++)p.set(e,t,0);p.set(t,t,1)}let S=E-1,I=Number.EPSILON;for(;E>0;){let t,e;for(t=E-2;t>=-1&&-1!==t;t--){const e=Number.MIN_VALUE+I*Math.abs(g[t]+Math.abs(g[t+1]));if(Math.abs(m[t])<=e||Number.isNaN(m[t])){m[t]=0;break}}if(t===E-2)e=4;else{let i;for(i=E-1;i>=t&&i!==t;i--){let e=(i!==E?Math.abs(m[i]):0)+(i!==t+1?Math.abs(m[i-1]):0);if(Math.abs(g[i])<=I*e){g[i]=0;break}}i===t?e=3:i===E-1?e=1:(e=2,t=i)}switch(t++,e){case 1:{let e=m[E-2];m[E-2]=0;for(let i=E-2;i>=t;i--){let r=A(g[i],e),s=g[i]/r,o=e/r;if(g[i]=r,i!==t&&(e=-o*m[i-1],m[i-1]=s*m[i-1]),h)for(let t=0;t<n;t++)r=s*p.get(t,i)+o*p.get(t,E-1),p.set(t,E-1,-o*p.get(t,i)+s*p.get(t,E-1)),p.set(t,i,r)}break}case 2:{let e=m[t-1];m[t-1]=0;for(let n=t;n<E;n++){let r=A(g[n],e),s=g[n]/r,o=e/r;if(g[n]=r,e=-o*m[n],m[n]=s*m[n],l)for(let e=0;e<i;e++)r=s*f.get(e,n)+o*f.get(e,t-1),f.set(e,t-1,-o*f.get(e,n)+s*f.get(e,t-1)),f.set(e,n,r)}break}case 3:{const e=Math.max(Math.abs(g[E-1]),Math.abs(g[E-2]),Math.abs(m[E-2]),Math.abs(g[t]),Math.abs(m[t])),r=g[E-1]/e,s=g[E-2]/e,o=m[E-2]/e,a=g[t]/e,c=m[t]/e,u=((s+r)*(s-r)+o*o)/2,d=r*o*(r*o);let _=0;0===u&&0===d||(_=u<0?0-Math.sqrt(u*u+d):Math.sqrt(u*u+d),_=d/(u+_));let y=(a+r)*(a-r)+_,w=a*c;for(let e=t;e<E-1;e++){let r=A(y,w);0===r&&(r=Number.MIN_VALUE);let s=y/r,o=w/r;if(e!==t&&(m[e-1]=r),y=s*g[e]+o*m[e],m[e]=s*m[e]-o*g[e],w=o*g[e+1],g[e+1]=s*g[e+1],h)for(let t=0;t<n;t++)r=s*p.get(t,e)+o*p.get(t,e+1),p.set(t,e+1,-o*p.get(t,e)+s*p.get(t,e+1)),p.set(t,e,r);if(r=A(y,w),0===r&&(r=Number.MIN_VALUE),s=y/r,o=w/r,g[e]=r,y=s*m[e]+o*g[e+1],g[e+1]=-o*m[e]+s*g[e+1],w=o*m[e+1],m[e+1]=s*m[e+1],l&&e<i-1)for(let t=0;t<i;t++)r=s*f.get(t,e)+o*f.get(t,e+1),f.set(t,e+1,-o*f.get(t,e)+s*f.get(t,e+1)),f.set(t,e,r)}m[E-2]=y;break}case 4:if(g[t]<=0&&(g[t]=g[t]<0?-g[t]:0,h))for(let e=0;e<=S;e++)p.set(e,t,-p.get(e,t));for(;t<S&&!(g[t]>=g[t+1]);){let e=g[t];if(g[t]=g[t+1],g[t+1]=e,h&&t<n-1)for(let i=0;i<n;i++)e=p.get(i,t+1),p.set(i,t+1,p.get(i,t)),p.set(i,t,e);if(l&&t<i-1)for(let n=0;n<i;n++)e=f.get(n,t+1),f.set(n,t+1,f.get(n,t)),f.set(n,t,e);t++}E--}}if(c){let t=p;p=f,f=t}this.m=i,this.n=n,this.s=g,this.U=f,this.V=p}solve(t){let e=t,i=this.threshold,n=this.s.length,r=v.zeros(n,n);for(let t=0;t<n;t++)Math.abs(this.s[t])<=i?r.set(t,t,0):r.set(t,t,1/this.s[t]);let s=this.U,o=this.rightSingularVectors,a=o.mmul(r),l=o.rows,h=s.rows,c=v.zeros(l,h);for(let t=0;t<l;t++)for(let e=0;e<h;e++){let i=0;for(let r=0;r<n;r++)i+=a.get(t,r)*s.get(e,r);c.set(t,e,i)}return c.mmul(e)}solveForDiagonal(t){return this.solve(v.diag(t))}inverse(){let t=this.V,e=this.threshold,i=t.rows,n=t.columns,r=new v(i,this.s.length);for(let s=0;s<i;s++)for(let i=0;i<n;i++)Math.abs(this.s[i])>e&&r.set(s,i,t.get(s,i)/this.s[i]);let s=this.U,o=s.rows,a=s.columns,l=new v(i,o);for(let t=0;t<i;t++)for(let e=0;e<o;e++){let i=0;for(let n=0;n<a;n++)i+=r.get(t,n)*s.get(e,n);l.set(t,e,i)}return l}get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]}get norm2(){return this.s[0]}get rank(){let t=Math.max(this.m,this.n)*this.s[0]*Number.EPSILON,e=0,i=this.s;for(let n=0,r=i.length;n<r;n++)i[n]>t&&e++;return e}get diagonal(){return Array.from(this.s)}get threshold(){return Number.EPSILON/2*Math.max(this.m,this.n)*this.s[0]}get leftSingularVectors(){return this.U}get rightSingularVectors(){return this.V}get diagonalMatrix(){return v.diag(this.s)}}function L(t,e,i=!1){return t=T.checkMatrix(t),e=T.checkMatrix(e),i?new P(t).solve(e):t.isSquare()?new R(t).solve(e):new k(t).solve(e)}function N(t,e){let i=[];for(let n=0;n<t;n++)n!==e&&i.push(n);return i}function D(t,e,i,n=1e-9,r=1e-9){if(t>r)return new Array(e.rows+1).fill(0);{let t=e.addRow(i,[0]);for(let e=0;e<t.rows;e++)Math.abs(t.get(e,0))<n&&t.set(e,0,0);return t.to1DArray()}}class O{constructor(t,e={}){const{assumeSymmetric:i=!1}=e;if(!(t=T.checkMatrix(t)).isSquare())throw new Error("Matrix is not a square matrix");if(t.isEmpty())throw new Error("Matrix must be non-empty");let n,r,s=t.columns,o=new v(s,s),a=new Float64Array(s),l=new Float64Array(s),h=t,c=!1;if(c=!!i||t.isSymmetric(),c){for(n=0;n<s;n++)for(r=0;r<s;r++)o.set(n,r,h.get(n,r));!function(t,e,i,n){let r,s,o,a,l,h,c,u;for(l=0;l<t;l++)i[l]=n.get(t-1,l);for(a=t-1;a>0;a--){for(u=0,o=0,h=0;h<a;h++)u+=Math.abs(i[h]);if(0===u)for(e[a]=i[a-1],l=0;l<a;l++)i[l]=n.get(a-1,l),n.set(a,l,0),n.set(l,a,0);else{for(h=0;h<a;h++)i[h]/=u,o+=i[h]*i[h];for(r=i[a-1],s=Math.sqrt(o),r>0&&(s=-s),e[a]=u*s,o-=r*s,i[a-1]=r-s,l=0;l<a;l++)e[l]=0;for(l=0;l<a;l++){for(r=i[l],n.set(l,a,r),s=e[l]+n.get(l,l)*r,h=l+1;h<=a-1;h++)s+=n.get(h,l)*i[h],e[h]+=n.get(h,l)*r;e[l]=s}for(r=0,l=0;l<a;l++)e[l]/=o,r+=e[l]*i[l];for(c=r/(o+o),l=0;l<a;l++)e[l]-=c*i[l];for(l=0;l<a;l++){for(r=i[l],s=e[l],h=l;h<=a-1;h++)n.set(h,l,n.get(h,l)-(r*e[h]+s*i[h]));i[l]=n.get(a-1,l),n.set(a,l,0)}}i[a]=o}for(a=0;a<t-1;a++){if(n.set(t-1,a,n.get(a,a)),n.set(a,a,1),o=i[a+1],0!==o){for(h=0;h<=a;h++)i[h]=n.get(h,a+1)/o;for(l=0;l<=a;l++){for(s=0,h=0;h<=a;h++)s+=n.get(h,a+1)*n.get(h,l);for(h=0;h<=a;h++)n.set(h,l,n.get(h,l)-s*i[h])}}for(h=0;h<=a;h++)n.set(h,a+1,0)}for(l=0;l<t;l++)i[l]=n.get(t-1,l),n.set(t-1,l,0);n.set(t-1,t-1,1),e[0]=0}(s,l,a,o),function(t,e,i,n){let r,s,o,a,l,h,c,u,d,g,f,p,m,_,y,w;for(o=1;o<t;o++)e[o-1]=e[o];e[t-1]=0;let x=0,b=0,v=Number.EPSILON;for(h=0;h<t;h++){for(b=Math.max(b,Math.abs(i[h])+Math.abs(e[h])),c=h;c<t&&!(Math.abs(e[c])<=v*b);)c++;if(c>h)do{for(r=i[h],u=(i[h+1]-r)/(2*e[h]),d=A(u,1),u<0&&(d=-d),i[h]=e[h]/(u+d),i[h+1]=e[h]*(u+d),g=i[h+1],s=r-i[h],o=h+2;o<t;o++)i[o]-=s;for(x+=s,u=i[c],f=1,p=f,m=f,_=e[h+1],y=0,w=0,o=c-1;o>=h;o--)for(m=p,p=f,w=y,r=f*e[o],s=f*u,d=A(u,e[o]),e[o+1]=y*d,y=e[o]/d,f=u/d,u=f*i[o]-y*r,i[o+1]=s+y*(f*r+y*i[o]),l=0;l<t;l++)s=n.get(l,o+1),n.set(l,o+1,y*n.get(l,o)+f*s),n.set(l,o,f*n.get(l,o)-y*s);u=-y*w*m*_*e[h]/g,e[h]=y*u,i[h]=f*u}while(Math.abs(e[h])>v*b);i[h]=i[h]+x,e[h]=0}for(o=0;o<t-1;o++){for(l=o,u=i[o],a=o+1;a<t;a++)i[a]<u&&(l=a,u=i[a]);if(l!==o)for(i[l]=i[o],i[o]=u,a=0;a<t;a++)u=n.get(a,o),n.set(a,o,n.get(a,l)),n.set(a,l,u)}}(s,l,a,o)}else{let t=new v(s,s),e=new Float64Array(s);for(r=0;r<s;r++)for(n=0;n<s;n++)t.set(n,r,h.get(n,r));!function(t,e,i,n){let r,s,o,a,l,h,c,u=t-1;for(h=1;h<=u-1;h++){for(c=0,a=h;a<=u;a++)c+=Math.abs(e.get(a,h-1));if(0!==c){for(o=0,a=u;a>=h;a--)i[a]=e.get(a,h-1)/c,o+=i[a]*i[a];for(s=Math.sqrt(o),i[h]>0&&(s=-s),o-=i[h]*s,i[h]=i[h]-s,l=h;l<t;l++){for(r=0,a=u;a>=h;a--)r+=i[a]*e.get(a,l);for(r/=o,a=h;a<=u;a++)e.set(a,l,e.get(a,l)-r*i[a])}for(a=0;a<=u;a++){for(r=0,l=u;l>=h;l--)r+=i[l]*e.get(a,l);for(r/=o,l=h;l<=u;l++)e.set(a,l,e.get(a,l)-r*i[l])}i[h]=c*i[h],e.set(h,h-1,c*s)}}for(a=0;a<t;a++)for(l=0;l<t;l++)n.set(a,l,a===l?1:0);for(h=u-1;h>=1;h--)if(0!==e.get(h,h-1)){for(a=h+1;a<=u;a++)i[a]=e.get(a,h-1);for(l=h;l<=u;l++){for(s=0,a=h;a<=u;a++)s+=i[a]*n.get(a,l);for(s=s/i[h]/e.get(h,h-1),a=h;a<=u;a++)n.set(a,l,n.get(a,l)+s*i[a])}}}(s,t,e,o),function(t,e,i,n,r){let s,o,a,l,h,c,u,d,g,f,p,m,_,y,w,x=t-1,b=t-1,v=Number.EPSILON,E=0,S=0,I=0,M=0,C=0,T=0,R=0,A=0;for(s=0;s<t;s++)for((s<0||s>b)&&(i[s]=r.get(s,s),e[s]=0),o=Math.max(s-1,0);o<t;o++)S+=Math.abs(r.get(s,o));for(;x>=0;){for(l=x;l>0&&(T=Math.abs(r.get(l-1,l-1))+Math.abs(r.get(l,l)),0===T&&(T=S),!(Math.abs(r.get(l,l-1))<v*T));)l--;if(l===x)r.set(x,x,r.get(x,x)+E),i[x]=r.get(x,x),e[x]=0,x--,A=0;else if(l===x-1){if(u=r.get(x,x-1)*r.get(x-1,x),I=(r.get(x-1,x-1)-r.get(x,x))/2,M=I*I+u,R=Math.sqrt(Math.abs(M)),r.set(x,x,r.get(x,x)+E),r.set(x-1,x-1,r.get(x-1,x-1)+E),d=r.get(x,x),M>=0){for(R=I>=0?I+R:I-R,i[x-1]=d+R,i[x]=i[x-1],0!==R&&(i[x]=d-u/R),e[x-1]=0,e[x]=0,d=r.get(x,x-1),T=Math.abs(d)+Math.abs(R),I=d/T,M=R/T,C=Math.sqrt(I*I+M*M),I/=C,M/=C,o=x-1;o<t;o++)R=r.get(x-1,o),r.set(x-1,o,M*R+I*r.get(x,o)),r.set(x,o,M*r.get(x,o)-I*R);for(s=0;s<=x;s++)R=r.get(s,x-1),r.set(s,x-1,M*R+I*r.get(s,x)),r.set(s,x,M*r.get(s,x)-I*R);for(s=0;s<=b;s++)R=n.get(s,x-1),n.set(s,x-1,M*R+I*n.get(s,x)),n.set(s,x,M*n.get(s,x)-I*R)}else i[x-1]=d+I,i[x]=d+I,e[x-1]=R,e[x]=-R;x-=2,A=0}else{if(d=r.get(x,x),g=0,u=0,l<x&&(g=r.get(x-1,x-1),u=r.get(x,x-1)*r.get(x-1,x)),10===A){for(E+=d,s=0;s<=x;s++)r.set(s,s,r.get(s,s)-d);T=Math.abs(r.get(x,x-1))+Math.abs(r.get(x-1,x-2)),d=g=.75*T,u=-.4375*T*T}if(30===A&&(T=(g-d)/2,T=T*T+u,T>0)){for(T=Math.sqrt(T),g<d&&(T=-T),T=d-u/((g-d)/2+T),s=0;s<=x;s++)r.set(s,s,r.get(s,s)-T);E+=T,d=g=u=.964}for(A+=1,h=x-2;h>=l&&(R=r.get(h,h),C=d-R,T=g-R,I=(C*T-u)/r.get(h+1,h)+r.get(h,h+1),M=r.get(h+1,h+1)-R-C-T,C=r.get(h+2,h+1),T=Math.abs(I)+Math.abs(M)+Math.abs(C),I/=T,M/=T,C/=T,h!==l)&&!(Math.abs(r.get(h,h-1))*(Math.abs(M)+Math.abs(C))<v*(Math.abs(I)*(Math.abs(r.get(h-1,h-1))+Math.abs(R)+Math.abs(r.get(h+1,h+1)))));)h--;for(s=h+2;s<=x;s++)r.set(s,s-2,0),s>h+2&&r.set(s,s-3,0);for(a=h;a<=x-1&&(y=a!==x-1,a!==h&&(I=r.get(a,a-1),M=r.get(a+1,a-1),C=y?r.get(a+2,a-1):0,d=Math.abs(I)+Math.abs(M)+Math.abs(C),0!==d&&(I/=d,M/=d,C/=d)),0!==d);a++)if(T=Math.sqrt(I*I+M*M+C*C),I<0&&(T=-T),0!==T){for(a!==h?r.set(a,a-1,-T*d):l!==h&&r.set(a,a-1,-r.get(a,a-1)),I+=T,d=I/T,g=M/T,R=C/T,M/=I,C/=I,o=a;o<t;o++)I=r.get(a,o)+M*r.get(a+1,o),y&&(I+=C*r.get(a+2,o),r.set(a+2,o,r.get(a+2,o)-I*R)),r.set(a,o,r.get(a,o)-I*d),r.set(a+1,o,r.get(a+1,o)-I*g);for(s=0;s<=Math.min(x,a+3);s++)I=d*r.get(s,a)+g*r.get(s,a+1),y&&(I+=R*r.get(s,a+2),r.set(s,a+2,r.get(s,a+2)-I*C)),r.set(s,a,r.get(s,a)-I),r.set(s,a+1,r.get(s,a+1)-I*M);for(s=0;s<=b;s++)I=d*n.get(s,a)+g*n.get(s,a+1),y&&(I+=R*n.get(s,a+2),n.set(s,a+2,n.get(s,a+2)-I*C)),n.set(s,a,n.get(s,a)-I),n.set(s,a+1,n.get(s,a+1)-I*M)}}}if(0!==S){for(x=t-1;x>=0;x--)if(I=i[x],M=e[x],0===M)for(l=x,r.set(x,x,1),s=x-1;s>=0;s--){for(u=r.get(s,s)-I,C=0,o=l;o<=x;o++)C+=r.get(s,o)*r.get(o,x);if(e[s]<0)R=u,T=C;else if(l=s,0===e[s]?r.set(s,x,0!==u?-C/u:-C/(v*S)):(d=r.get(s,s+1),g=r.get(s+1,s),M=(i[s]-I)*(i[s]-I)+e[s]*e[s],c=(d*T-R*C)/M,r.set(s,x,c),r.set(s+1,x,Math.abs(d)>Math.abs(R)?(-C-u*c)/d:(-T-g*c)/R)),c=Math.abs(r.get(s,x)),v*c*c>1)for(o=s;o<=x;o++)r.set(o,x,r.get(o,x)/c)}else if(M<0)for(l=x-1,Math.abs(r.get(x,x-1))>Math.abs(r.get(x-1,x))?(r.set(x-1,x-1,M/r.get(x,x-1)),r.set(x-1,x,-(r.get(x,x)-I)/r.get(x,x-1))):(w=F(0,-r.get(x-1,x),r.get(x-1,x-1)-I,M),r.set(x-1,x-1,w[0]),r.set(x-1,x,w[1])),r.set(x,x-1,0),r.set(x,x,1),s=x-2;s>=0;s--){for(f=0,p=0,o=l;o<=x;o++)f+=r.get(s,o)*r.get(o,x-1),p+=r.get(s,o)*r.get(o,x);if(u=r.get(s,s)-I,e[s]<0)R=u,C=f,T=p;else if(l=s,0===e[s]?(w=F(-f,-p,u,M),r.set(s,x-1,w[0]),r.set(s,x,w[1])):(d=r.get(s,s+1),g=r.get(s+1,s),m=(i[s]-I)*(i[s]-I)+e[s]*e[s]-M*M,_=2*(i[s]-I)*M,0===m&&0===_&&(m=v*S*(Math.abs(u)+Math.abs(M)+Math.abs(d)+Math.abs(g)+Math.abs(R))),w=F(d*C-R*f+M*p,d*T-R*p-M*f,m,_),r.set(s,x-1,w[0]),r.set(s,x,w[1]),Math.abs(d)>Math.abs(R)+Math.abs(M)?(r.set(s+1,x-1,(-f-u*r.get(s,x-1)+M*r.get(s,x))/d),r.set(s+1,x,(-p-u*r.get(s,x)-M*r.get(s,x-1))/d)):(w=F(-C-g*r.get(s,x-1),-T-g*r.get(s,x),R,M),r.set(s+1,x-1,w[0]),r.set(s+1,x,w[1]))),c=Math.max(Math.abs(r.get(s,x-1)),Math.abs(r.get(s,x))),v*c*c>1)for(o=s;o<=x;o++)r.set(o,x-1,r.get(o,x-1)/c),r.set(o,x,r.get(o,x)/c)}for(s=0;s<t;s++)if(s<0||s>b)for(o=s;o<t;o++)n.set(s,o,r.get(s,o));for(o=t-1;o>=0;o--)for(s=0;s<=b;s++){for(R=0,a=0;a<=Math.min(o,b);a++)R+=n.get(s,a)*r.get(a,o);n.set(s,o,R)}}}(s,l,a,o,t)}this.n=s,this.e=l,this.d=a,this.V=o}get realEigenvalues(){return Array.from(this.d)}get imaginaryEigenvalues(){return Array.from(this.e)}get eigenvectorMatrix(){return this.V}get diagonalMatrix(){let t,e,i=this.n,n=this.e,r=this.d,s=new v(i,i);for(t=0;t<i;t++){for(e=0;e<i;e++)s.set(t,e,0);s.set(t,t,r[t]),n[t]>0?s.set(t,t+1,n[t]):n[t]<0&&s.set(t,t-1,n[t])}return s}}function F(t,e,i,n){let r,s;return Math.abs(i)>Math.abs(n)?(r=n/i,s=i+r*n,[(t+r*e)/s,(e-r*t)/s]):(r=i/n,s=n+r*i,[(r*t+e)/s,(r*e-t)/s])}class z{constructor(t){if(!(t=T.checkMatrix(t)).isSymmetric())throw new Error("Matrix is not symmetric");let e,i,n,r=t,s=r.rows,o=new v(s,s),a=!0;for(i=0;i<s;i++){let t=0;for(n=0;n<i;n++){let s=0;for(e=0;e<n;e++)s+=o.get(n,e)*o.get(i,e);s=(r.get(i,n)-s)/o.get(n,n),o.set(i,n,s),t+=s*s}for(t=r.get(i,i)-t,a&=t>0,o.set(i,i,Math.sqrt(Math.max(t,0))),n=i+1;n<s;n++)o.set(i,n,0)}this.L=o,this.positiveDefinite=Boolean(a)}isPositiveDefinite(){return this.positiveDefinite}solve(t){t=T.checkMatrix(t);let e=this.L,i=e.rows;if(t.rows!==i)throw new Error("Matrix dimensions do not match");if(!1===this.isPositiveDefinite())throw new Error("Matrix is not positive definite");let n,r,s,o=t.columns,a=t.clone();for(s=0;s<i;s++)for(r=0;r<o;r++){for(n=0;n<s;n++)a.set(s,r,a.get(s,r)-a.get(n,r)*e.get(s,n));a.set(s,r,a.get(s,r)/e.get(s,s))}for(s=i-1;s>=0;s--)for(r=0;r<o;r++){for(n=s+1;n<i;n++)a.set(s,r,a.get(s,r)-a.get(n,r)*e.get(n,s));a.set(s,r,a.get(s,r)/e.get(s,s))}return a}get lowerTriangularMatrix(){return this.L}}class B{constructor(t,e={}){t=T.checkMatrix(t);let{Y:i}=e;const{scaleScores:r=!1,maxIterations:s=1e3,terminationCriteria:o=1e-10}=e;let a;if(i){if(i=n.isAnyArray(i)&&"number"==typeof i[0]?v.columnVector(i):T.checkMatrix(i),i.rows!==t.rows)throw new Error("Y should have the same number of rows as X");a=i.getColumnVector(0)}else a=t.getColumnVector(0);let l,h,c,u,d=1;for(let e=0;e<s&&d>o;e++)c=t.transpose().mmul(a).div(a.transpose().mmul(a).get(0,0)),c=c.div(c.norm()),l=t.mmul(c).div(c.transpose().mmul(c).get(0,0)),e>0&&(d=l.clone().sub(u).pow(2).sum()),u=l.clone(),i?(h=i.transpose().mmul(l).div(l.transpose().mmul(l).get(0,0)),h=h.div(h.norm()),a=i.mmul(h).div(h.transpose().mmul(h).get(0,0))):a=l;if(i){let e=t.transpose().mmul(l).div(l.transpose().mmul(l).get(0,0));e=e.div(e.norm());let n=t.clone().sub(l.clone().mmul(e.transpose())),r=a.transpose().mmul(l).div(l.transpose().mmul(l).get(0,0)),s=i.clone().sub(l.clone().mulS(r.get(0,0)).mmul(h.transpose()));this.t=l,this.p=e.transpose(),this.w=c.transpose(),this.q=h,this.u=a,this.s=l.transpose().mmul(l),this.xResidual=n,this.yResidual=s,this.betas=r}else this.w=c.transpose(),this.s=l.transpose().mmul(l).sqrt(),this.t=r?l.clone().div(this.s.get(0,0)):l,this.xResidual=t.sub(l.mmul(c.transpose()))}}e.AbstractMatrix=x,e.CHO=z,e.CholeskyDecomposition=z,e.DistanceMatrix=S,e.EVD=O,e.EigenvalueDecomposition=O,e.LU=R,e.LuDecomposition=R,e.Matrix=v,e.MatrixColumnSelectionView=class extends I{constructor(t,e){p(t,e),super(t,t.rows,e.length),this.columnIndices=e}set(t,e,i){return this.matrix.set(t,this.columnIndices[e],i),this}get(t,e){return this.matrix.get(t,this.columnIndices[e])}},e.MatrixColumnView=class extends I{constructor(t,e){u(t,e),super(t,t.rows,1),this.column=e}set(t,e,i){return this.matrix.set(t,this.column,i),this}get(t){return this.matrix.get(t,this.column)}},e.MatrixFlipColumnView=class extends I{constructor(t){super(t,t.rows,t.columns)}set(t,e,i){return this.matrix.set(t,this.columns-e-1,i),this}get(t,e){return this.matrix.get(t,this.columns-e-1)}},e.MatrixFlipRowView=class extends I{constructor(t){super(t,t.rows,t.columns)}set(t,e,i){return this.matrix.set(this.rows-t-1,e,i),this}get(t,e){return this.matrix.get(this.rows-t-1,e)}},e.MatrixRowSelectionView=class extends I{constructor(t,e){f(t,e),super(t,e.length,t.columns),this.rowIndices=e}set(t,e,i){return this.matrix.set(this.rowIndices[t],e,i),this}get(t,e){return this.matrix.get(this.rowIndices[t],e)}},e.MatrixRowView=class extends I{constructor(t,e){c(t,e),super(t,1,t.columns),this.row=e}set(t,e,i){return this.matrix.set(this.row,e,i),this}get(t,e){return this.matrix.get(this.row,e)}},e.MatrixSelectionView=M,e.MatrixSubView=class extends I{constructor(t,e,i,n,r){m(t,e,i,n,r),super(t,i-e+1,r-n+1),this.startRow=e,this.startColumn=n}set(t,e,i){return this.matrix.set(this.startRow+t,this.startColumn+e,i),this}get(t,e){return this.matrix.get(this.startRow+t,this.startColumn+e)}},e.MatrixTransposeView=class extends I{constructor(t){super(t,t.columns,t.rows)}set(t,e,i){return this.matrix.set(e,t,i),this}get(t,e){return this.matrix.get(e,t)}},e.NIPALS=B,e.Nipals=B,e.QR=k,e.QrDecomposition=k,e.SVD=P,e.SingularValueDecomposition=P,e.SymmetricMatrix=E,e.WrapperMatrix1D=C,e.WrapperMatrix2D=T,e.correlation=function(t,e=t,i={}){t=new v(t);let r=!1;if("object"!=typeof e||v.isMatrix(e)||n.isAnyArray(e)?e=new v(e):(i=e,e=t,r=!0),t.rows!==e.rows)throw new TypeError("Both matrices must have the same number of rows");const{center:s=!0,scale:o=!0}=i;s&&(t.center("column"),r||e.center("column")),o&&(t.scale("column"),r||e.scale("column"));const a=t.standardDeviation("column",{unbiased:!0}),l=r?a:e.standardDeviation("column",{unbiased:!0}),h=t.transpose().mmul(e);for(let e=0;e<h.rows;e++)for(let i=0;i<h.columns;i++)h.set(e,i,h.get(e,i)*(1/(a[e]*l[i]))*(1/(t.rows-1)));return h},e.covariance=function(t,e=t,i={}){t=new v(t);let r=!1;if("object"!=typeof e||v.isMatrix(e)||n.isAnyArray(e)?e=new v(e):(i=e,e=t,r=!0),t.rows!==e.rows)throw new TypeError("Both matrices must have the same number of rows");const{center:s=!0}=i;s&&(t=t.center("column"),r||(e=e.center("column")));const o=t.transpose().mmul(e);for(let e=0;e<o.rows;e++)for(let i=0;i<o.columns;i++)o.set(e,i,o.get(e,i)*(1/(t.rows-1)));return o},e.default=v,e.determinant=function t(e){if((e=v.checkMatrix(e)).isSquare()){if(0===e.columns)return 1;let i,n,r,s;if(2===e.columns)return i=e.get(0,0),n=e.get(0,1),r=e.get(1,0),s=e.get(1,1),i*s-n*r;if(3===e.columns){let s,o,a;return s=new M(e,[1,2],[1,2]),o=new M(e,[1,2],[0,2]),a=new M(e,[1,2],[0,1]),i=e.get(0,0),n=e.get(0,1),r=e.get(0,2),i*t(s)-n*t(o)+r*t(a)}return new R(e).determinant}throw Error("determinant can only be calculated for a square matrix")},e.inverse=function(t,e=!1){return t=T.checkMatrix(t),e?new P(t).inverse():L(t,v.eye(t.rows))},e.linearDependencies=function(t,e={}){const{thresholdValue:i=1e-9,thresholdError:n=1e-9}=e;let r=(t=v.checkMatrix(t)).rows,s=new v(r,r);for(let e=0;e<r;e++){let o=v.columnVector(t.getRow(e)),a=t.subMatrixRow(N(r,e)).transpose(),l=new P(a).solve(o),h=v.sub(o,a.mmul(l)).abs().max();s.setRow(e,D(h,l,e,i,n))}return s},e.pseudoInverse=function(t,e=Number.EPSILON){if((t=v.checkMatrix(t)).isEmpty())return t.transpose();let i=new P(t,{autoTranspose:!0}),n=i.leftSingularVectors,r=i.rightSingularVectors,s=i.diagonal;for(let t=0;t<s.length;t++)Math.abs(s[t])>e?s[t]=1/s[t]:s[t]=0;return r.mmul(v.diag(s).mmul(n.transpose()))},e.solve=L,e.wrap=function(t,e){if(n.isAnyArray(t))return t[0]&&n.isAnyArray(t[0])?new T(t):new C(t,e);throw new Error("the argument is not an array")}},2664:t=>{t.exports=function(t,e){t=t||0;for(var i=new Array(t),n=0;n<t;n++)i[n]=e;return i}},995:t=>{t.exports=function(t){return 0===t?1:(t--,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,1+(t|=t>>16))}},2582:function(t){t.exports=function(){"use strict";function t(t,n,r,s,o){!function t(i,n,r,s,o){for(;s>r;){if(s-r>600){var a=s-r+1,l=n-r+1,h=Math.log(a),c=.5*Math.exp(2*h/3),u=.5*Math.sqrt(h*c*(a-c)/a)*(l-a/2<0?-1:1);t(i,n,Math.max(r,Math.floor(n-l*c/a+u)),Math.min(s,Math.floor(n+(a-l)*c/a+u)),o)}var d=i[n],g=r,f=s;for(e(i,r,n),o(i[s],d)>0&&e(i,r,s);g<f;){for(e(i,g,f),g++,f--;o(i[g],d)<0;)g++;for(;o(i[f],d)>0;)f--}0===o(i[r],d)?e(i,r,f):e(i,++f,s),f<=n&&(r=f+1),n<=f&&(s=f-1)}}(t,n,r||0,s||t.length-1,o||i)}function e(t,e,i){var n=t[e];t[e]=t[i],t[i]=n}function i(t,e){return t<e?-1:t>e?1:0}var n=function(t){void 0===t&&(t=9),this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function r(t,e,i){if(!i)return e.indexOf(t);for(var n=0;n<e.length;n++)if(i(t,e[n]))return n;return-1}function s(t,e){o(t,0,t.children.length,e,t)}function o(t,e,i,n,r){r||(r=f(null)),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(var s=e;s<i;s++){var o=t.children[s];a(r,t.leaf?n(o):o)}return r}function a(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function l(t,e){return t.minX-e.minX}function h(t,e){return t.minY-e.minY}function c(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function u(t){return t.maxX-t.minX+(t.maxY-t.minY)}function d(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function g(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function f(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function p(e,i,n,r,s){for(var o=[i,n];o.length;)if(!((n=o.pop())-(i=o.pop())<=r)){var a=i+Math.ceil((n-i)/r/2)*r;t(e,a,i,n,s),o.push(i,a,a,n)}}return n.prototype.all=function(){return this._all(this.data,[])},n.prototype.search=function(t){var e=this.data,i=[];if(!g(t,e))return i;for(var n=this.toBBox,r=[];e;){for(var s=0;s<e.children.length;s++){var o=e.children[s],a=e.leaf?n(o):o;g(t,a)&&(e.leaf?i.push(o):d(t,a)?this._all(o,i):r.push(o))}e=r.pop()}return i},n.prototype.collides=function(t){var e=this.data;if(!g(t,e))return!1;for(var i=[];e;){for(var n=0;n<e.children.length;n++){var r=e.children[n],s=e.leaf?this.toBBox(r):r;if(g(t,s)){if(e.leaf||d(t,s))return!0;i.push(r)}}e=i.pop()}return!1},n.prototype.load=function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0;e<t.length;e++)this.insert(t[e]);return this}var i=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===i.height)this._splitRoot(this.data,i);else{if(this.data.height<i.height){var n=this.data;this.data=i,i=n}this._insert(i,this.data.height-i.height-1,!0)}else this.data=i;return this},n.prototype.insert=function(t){return t&&this._insert(t,this.data.height-1),this},n.prototype.clear=function(){return this.data=f([]),this},n.prototype.remove=function(t,e){if(!t)return this;for(var i,n,s,o=this.data,a=this.toBBox(t),l=[],h=[];o||l.length;){if(o||(o=l.pop(),n=l[l.length-1],i=h.pop(),s=!0),o.leaf){var c=r(t,o.children,e);if(-1!==c)return o.children.splice(c,1),l.push(o),this._condense(l),this}s||o.leaf||!d(o,a)?n?(i++,o=n.children[i],s=!1):o=null:(l.push(o),h.push(i),i=0,n=o,o=o.children[0])}return this},n.prototype.toBBox=function(t){return t},n.prototype.compareMinX=function(t,e){return t.minX-e.minX},n.prototype.compareMinY=function(t,e){return t.minY-e.minY},n.prototype.toJSON=function(){return this.data},n.prototype.fromJSON=function(t){return this.data=t,this},n.prototype._all=function(t,e){for(var i=[];t;)t.leaf?e.push.apply(e,t.children):i.push.apply(i,t.children),t=i.pop();return e},n.prototype._build=function(t,e,i,n){var r,o=i-e+1,a=this._maxEntries;if(o<=a)return s(r=f(t.slice(e,i+1)),this.toBBox),r;n||(n=Math.ceil(Math.log(o)/Math.log(a)),a=Math.ceil(o/Math.pow(a,n-1))),(r=f([])).leaf=!1,r.height=n;var l=Math.ceil(o/a),h=l*Math.ceil(Math.sqrt(a));p(t,e,i,h,this.compareMinX);for(var c=e;c<=i;c+=h){var u=Math.min(c+h-1,i);p(t,c,u,l,this.compareMinY);for(var d=c;d<=u;d+=l){var g=Math.min(d+l-1,u);r.children.push(this._build(t,d,g,n-1))}}return s(r,this.toBBox),r},n.prototype._chooseSubtree=function(t,e,i,n){for(;n.push(e),!e.leaf&&n.length-1!==i;){for(var r=1/0,s=1/0,o=void 0,a=0;a<e.children.length;a++){var l=e.children[a],h=c(l),u=(d=t,g=l,(Math.max(g.maxX,d.maxX)-Math.min(g.minX,d.minX))*(Math.max(g.maxY,d.maxY)-Math.min(g.minY,d.minY))-h);u<s?(s=u,r=h<r?h:r,o=l):u===s&&h<r&&(r=h,o=l)}e=o||e.children[0]}var d,g;return e},n.prototype._insert=function(t,e,i){var n=i?t:this.toBBox(t),r=[],s=this._chooseSubtree(n,this.data,e,r);for(s.children.push(t),a(s,n);e>=0&&r[e].children.length>this._maxEntries;)this._split(r,e),e--;this._adjustParentBBoxes(n,r,e)},n.prototype._split=function(t,e){var i=t[e],n=i.children.length,r=this._minEntries;this._chooseSplitAxis(i,r,n);var o=this._chooseSplitIndex(i,r,n),a=f(i.children.splice(o,i.children.length-o));a.height=i.height,a.leaf=i.leaf,s(i,this.toBBox),s(a,this.toBBox),e?t[e-1].children.push(a):this._splitRoot(i,a)},n.prototype._splitRoot=function(t,e){this.data=f([t,e]),this.data.height=t.height+1,this.data.leaf=!1,s(this.data,this.toBBox)},n.prototype._chooseSplitIndex=function(t,e,i){for(var n,r,s,a,l,h,u,d=1/0,g=1/0,f=e;f<=i-e;f++){var p=o(t,0,f,this.toBBox),m=o(t,f,i,this.toBBox),_=(r=p,s=m,void 0,void 0,void 0,void 0,a=Math.max(r.minX,s.minX),l=Math.max(r.minY,s.minY),h=Math.min(r.maxX,s.maxX),u=Math.min(r.maxY,s.maxY),Math.max(0,h-a)*Math.max(0,u-l)),y=c(p)+c(m);_<d?(d=_,n=f,g=y<g?y:g):_===d&&y<g&&(g=y,n=f)}return n||i-e},n.prototype._chooseSplitAxis=function(t,e,i){var n=t.leaf?this.compareMinX:l,r=t.leaf?this.compareMinY:h;this._allDistMargin(t,e,i,n)<this._allDistMargin(t,e,i,r)&&t.children.sort(n)},n.prototype._allDistMargin=function(t,e,i,n){t.children.sort(n);for(var r=this.toBBox,s=o(t,0,e,r),l=o(t,i-e,i,r),h=u(s)+u(l),c=e;c<i-e;c++){var d=t.children[c];a(s,t.leaf?r(d):d),h+=u(s)}for(var g=i-e-1;g>=e;g--){var f=t.children[g];a(l,t.leaf?r(f):f),h+=u(l)}return h},n.prototype._adjustParentBBoxes=function(t,e,i){for(var n=i;n>=0;n--)a(e[n],t)},n.prototype._condense=function(t){for(var e=t.length-1,i=void 0;e>=0;e--)0===t[e].children.length?e>0?(i=t[e-1].children).splice(i.indexOf(t[e]),1):this.clear():s(t[e],this.toBBox)},n}()},146:(t,e,i)=>{"use strict";var n=i(8005),r=i(6740),s=i(5442),o=i(7972);function a(t,e,i,n){return function(i,r,s){var o=t(t(e(r[1],s[0]),e(-s[1],r[0])),t(e(i[1],r[0]),e(-r[1],i[0]))),a=t(e(i[1],s[0]),e(-s[1],i[0])),l=n(o,a);return l[l.length-1]}}function l(t,e,i,n){return function(r,s,o,a){var l=t(t(i(t(e(o[1],a[0]),e(-a[1],o[0])),s[2]),t(i(t(e(s[1],a[0]),e(-a[1],s[0])),-o[2]),i(t(e(s[1],o[0]),e(-o[1],s[0])),a[2]))),t(i(t(e(s[1],a[0]),e(-a[1],s[0])),r[2]),t(i(t(e(r[1],a[0]),e(-a[1],r[0])),-s[2]),i(t(e(r[1],s[0]),e(-s[1],r[0])),a[2])))),h=t(t(i(t(e(o[1],a[0]),e(-a[1],o[0])),r[2]),t(i(t(e(r[1],a[0]),e(-a[1],r[0])),-o[2]),i(t(e(r[1],o[0]),e(-o[1],r[0])),a[2]))),t(i(t(e(s[1],o[0]),e(-o[1],s[0])),r[2]),t(i(t(e(r[1],o[0]),e(-o[1],r[0])),-s[2]),i(t(e(r[1],s[0]),e(-s[1],r[0])),o[2])))),c=n(l,h);return c[c.length-1]}}function h(t,e,i,n){return function(r,s,o,a,l){var h=t(t(t(i(t(i(t(e(a[1],l[0]),e(-l[1],a[0])),o[2]),t(i(t(e(o[1],l[0]),e(-l[1],o[0])),-a[2]),i(t(e(o[1],a[0]),e(-a[1],o[0])),l[2]))),s[3]),t(i(t(i(t(e(a[1],l[0]),e(-l[1],a[0])),s[2]),t(i(t(e(s[1],l[0]),e(-l[1],s[0])),-a[2]),i(t(e(s[1],a[0]),e(-a[1],s[0])),l[2]))),-o[3]),i(t(i(t(e(o[1],l[0]),e(-l[1],o[0])),s[2]),t(i(t(e(s[1],l[0]),e(-l[1],s[0])),-o[2]),i(t(e(s[1],o[0]),e(-o[1],s[0])),l[2]))),a[3]))),t(i(t(i(t(e(o[1],a[0]),e(-a[1],o[0])),s[2]),t(i(t(e(s[1],a[0]),e(-a[1],s[0])),-o[2]),i(t(e(s[1],o[0]),e(-o[1],s[0])),a[2]))),-l[3]),t(i(t(i(t(e(a[1],l[0]),e(-l[1],a[0])),s[2]),t(i(t(e(s[1],l[0]),e(-l[1],s[0])),-a[2]),i(t(e(s[1],a[0]),e(-a[1],s[0])),l[2]))),r[3]),i(t(i(t(e(a[1],l[0]),e(-l[1],a[0])),r[2]),t(i(t(e(r[1],l[0]),e(-l[1],r[0])),-a[2]),i(t(e(r[1],a[0]),e(-a[1],r[0])),l[2]))),-s[3])))),t(t(i(t(i(t(e(s[1],l[0]),e(-l[1],s[0])),r[2]),t(i(t(e(r[1],l[0]),e(-l[1],r[0])),-s[2]),i(t(e(r[1],s[0]),e(-s[1],r[0])),l[2]))),a[3]),t(i(t(i(t(e(s[1],a[0]),e(-a[1],s[0])),r[2]),t(i(t(e(r[1],a[0]),e(-a[1],r[0])),-s[2]),i(t(e(r[1],s[0]),e(-s[1],r[0])),a[2]))),-l[3]),i(t(i(t(e(o[1],a[0]),e(-a[1],o[0])),s[2]),t(i(t(e(s[1],a[0]),e(-a[1],s[0])),-o[2]),i(t(e(s[1],o[0]),e(-o[1],s[0])),a[2]))),r[3]))),t(i(t(i(t(e(o[1],a[0]),e(-a[1],o[0])),r[2]),t(i(t(e(r[1],a[0]),e(-a[1],r[0])),-o[2]),i(t(e(r[1],o[0]),e(-o[1],r[0])),a[2]))),-s[3]),t(i(t(i(t(e(s[1],a[0]),e(-a[1],s[0])),r[2]),t(i(t(e(r[1],a[0]),e(-a[1],r[0])),-s[2]),i(t(e(r[1],s[0]),e(-s[1],r[0])),a[2]))),o[3]),i(t(i(t(e(s[1],o[0]),e(-o[1],s[0])),r[2]),t(i(t(e(r[1],o[0]),e(-o[1],r[0])),-s[2]),i(t(e(r[1],s[0]),e(-s[1],r[0])),o[2]))),-a[3]))))),c=t(t(t(i(t(i(t(e(a[1],l[0]),e(-l[1],a[0])),o[2]),t(i(t(e(o[1],l[0]),e(-l[1],o[0])),-a[2]),i(t(e(o[1],a[0]),e(-a[1],o[0])),l[2]))),r[3]),i(t(i(t(e(a[1],l[0]),e(-l[1],a[0])),r[2]),t(i(t(e(r[1],l[0]),e(-l[1],r[0])),-a[2]),i(t(e(r[1],a[0]),e(-a[1],r[0])),l[2]))),-o[3])),t(i(t(i(t(e(o[1],l[0]),e(-l[1],o[0])),r[2]),t(i(t(e(r[1],l[0]),e(-l[1],r[0])),-o[2]),i(t(e(r[1],o[0]),e(-o[1],r[0])),l[2]))),a[3]),i(t(i(t(e(o[1],a[0]),e(-a[1],o[0])),r[2]),t(i(t(e(r[1],a[0]),e(-a[1],r[0])),-o[2]),i(t(e(r[1],o[0]),e(-o[1],r[0])),a[2]))),-l[3]))),t(t(i(t(i(t(e(o[1],l[0]),e(-l[1],o[0])),s[2]),t(i(t(e(s[1],l[0]),e(-l[1],s[0])),-o[2]),i(t(e(s[1],o[0]),e(-o[1],s[0])),l[2]))),r[3]),i(t(i(t(e(o[1],l[0]),e(-l[1],o[0])),r[2]),t(i(t(e(r[1],l[0]),e(-l[1],r[0])),-o[2]),i(t(e(r[1],o[0]),e(-o[1],r[0])),l[2]))),-s[3])),t(i(t(i(t(e(s[1],l[0]),e(-l[1],s[0])),r[2]),t(i(t(e(r[1],l[0]),e(-l[1],r[0])),-s[2]),i(t(e(r[1],s[0]),e(-s[1],r[0])),l[2]))),o[3]),i(t(i(t(e(s[1],o[0]),e(-o[1],s[0])),r[2]),t(i(t(e(r[1],o[0]),e(-o[1],r[0])),-s[2]),i(t(e(r[1],s[0]),e(-s[1],r[0])),o[2]))),-l[3])))),u=n(h,c);return u[u.length-1]}}function c(t){return(3===t?a:4===t?l:h)(r,n,s,o)}var u=c(3),d=c(4),g=[function(){return 0},function(){return 0},function(t,e){return e[0]-t[0]},function(t,e,i){var n,r=(t[1]-i[1])*(e[0]-i[0]),s=(t[0]-i[0])*(e[1]-i[1]),o=r-s;if(r>0){if(s<=0)return o;n=r+s}else{if(!(r<0))return o;if(s>=0)return o;n=-(r+s)}var a=33306690738754716e-32*n;return o>=a||o<=-a?o:u(t,e,i)},function(t,e,i,n){var r=t[0]-n[0],s=e[0]-n[0],o=i[0]-n[0],a=t[1]-n[1],l=e[1]-n[1],h=i[1]-n[1],c=t[2]-n[2],u=e[2]-n[2],g=i[2]-n[2],f=s*h,p=o*l,m=o*a,_=r*h,y=r*l,w=s*a,x=c*(f-p)+u*(m-_)+g*(y-w),b=7771561172376103e-31*((Math.abs(f)+Math.abs(p))*Math.abs(c)+(Math.abs(m)+Math.abs(_))*Math.abs(u)+(Math.abs(y)+Math.abs(w))*Math.abs(g));return x>b||-x>b?x:d(t,e,i,n)}];function f(t){var e=g[t.length];return e||(e=g[t.length]=c(t.length)),e.apply(void 0,t)}function p(t,e,i,n,r,s,o){return function(e,i,a,l,h){switch(arguments.length){case 0:case 1:return 0;case 2:return n(e,i);case 3:return r(e,i,a);case 4:return s(e,i,a,l);case 5:return o(e,i,a,l,h)}for(var c=new Array(arguments.length),u=0;u<arguments.length;++u)c[u]=arguments[u];return t(c)}}!function(){for(;g.length<=5;)g.push(c(g.length));t.exports=p.apply(void 0,[f].concat(g));for(var e=0;e<=5;++e)t.exports[e]=g[e]}()},4707:(t,e,i)=>{t.exports=function(t,e){for(var i=e[0],r=e[1],s=t.length,o=1,a=s,l=0,h=s-1;l<a;h=l++){var c=t[l],u=t[h],d=c[1],g=u[1];if(g<d){if(g<r&&r<d){if(0===(f=n(c,u,e)))return 0;o^=0<f|0}else if(r===d&&d<t[(l+1)%s][1]){if(0===(f=n(c,u,e)))return 0;o^=0<f|0}}else if(d<g){if(d<r&&r<g){if(0===(f=n(c,u,e)))return 0;o^=f<0|0}else if(r===d&&t[(l+1)%s][1]<d){var f;if(0===(f=n(c,u,e)))return 0;o^=f<0|0}}else if(r===d){var p=Math.min(c[0],u[0]),m=Math.max(c[0],u[0]);if(0===l){for(;h>0;){var _=(h+s-1)%s;if((x=t[_])[1]!==r)break;var y=x[0];p=Math.min(p,y),m=Math.max(m,y),h=_}if(0===h)return p<=i&&i<=m?0:1;a=h+1}for(var w=t[(h+s-1)%s][1];l+1<a;){var x;if((x=t[l+1])[1]!==r)break;y=x[0],p=Math.min(p,y),m=Math.max(m,y),l+=1}if(p<=i&&i<=m)return 0;var b=t[(l+1)%s][1];i<p&&w<r!=b<r&&(o^=1)}}return 2*o-1};var n=i(146)},5442:(t,e,i)=>{"use strict";var n=i(8005),r=i(6359);t.exports=function(t,e){var i=t.length;if(1===i){var s=n(t[0],e);return s[0]?s:[s[1]]}var o=new Array(2*i),a=[.1,.1],l=[.1,.1],h=0;n(t[0],e,a),a[0]&&(o[h++]=a[0]);for(var c=1;c<i;++c){n(t[c],e,l);var u=a[1];r(u,l[0],a),a[0]&&(o[h++]=a[0]);var d=l[1],g=a[1],f=d+g,p=g-(f-d);a[1]=f,p&&(o[h++]=p)}return a[1]&&(o[h++]=a[1]),0===h&&(o[h++]=0),o.length=h,o}},7972:t=>{"use strict";t.exports=function(t,e){var i=0|t.length,n=0|e.length;if(1===i&&1===n)return function(t,e){var i=t+e,n=i-t,r=t-(i-n)+(e-n);return r?[r,i]:[i]}(t[0],-e[0]);var r,s,o=new Array(i+n),a=0,l=0,h=0,c=Math.abs,u=t[l],d=c(u),g=-e[h],f=c(g);d<f?(s=u,(l+=1)<i&&(d=c(u=t[l]))):(s=g,(h+=1)<n&&(f=c(g=-e[h]))),l<i&&d<f||h>=n?(r=u,(l+=1)<i&&(d=c(u=t[l]))):(r=g,(h+=1)<n&&(f=c(g=-e[h])));for(var p,m,_=r+s,y=_-r,w=s-y,x=w,b=_;l<i&&h<n;)d<f?(r=u,(l+=1)<i&&(d=c(u=t[l]))):(r=g,(h+=1)<n&&(f=c(g=-e[h]))),(w=(s=x)-(y=(_=r+s)-r))&&(o[a++]=w),x=b-((p=b+_)-(m=p-b))+(_-m),b=p;for(;l<i;)(w=(s=x)-(y=(_=(r=u)+s)-r))&&(o[a++]=w),x=b-((p=b+_)-(m=p-b))+(_-m),b=p,(l+=1)<i&&(u=t[l]);for(;h<n;)(w=(s=x)-(y=(_=(r=g)+s)-r))&&(o[a++]=w),x=b-((p=b+_)-(m=p-b))+(_-m),b=p,(h+=1)<n&&(g=-e[h]);return x&&(o[a++]=x),b&&(o[a++]=b),a||(o[a++]=0),o.length=a,o}},6740:t=>{"use strict";t.exports=function(t,e){var i=0|t.length,n=0|e.length;if(1===i&&1===n)return function(t,e){var i=t+e,n=i-t,r=t-(i-n)+(e-n);return r?[r,i]:[i]}(t[0],e[0]);var r,s,o=new Array(i+n),a=0,l=0,h=0,c=Math.abs,u=t[l],d=c(u),g=e[h],f=c(g);d<f?(s=u,(l+=1)<i&&(d=c(u=t[l]))):(s=g,(h+=1)<n&&(f=c(g=e[h]))),l<i&&d<f||h>=n?(r=u,(l+=1)<i&&(d=c(u=t[l]))):(r=g,(h+=1)<n&&(f=c(g=e[h])));for(var p,m,_=r+s,y=_-r,w=s-y,x=w,b=_;l<i&&h<n;)d<f?(r=u,(l+=1)<i&&(d=c(u=t[l]))):(r=g,(h+=1)<n&&(f=c(g=e[h]))),(w=(s=x)-(y=(_=r+s)-r))&&(o[a++]=w),x=b-((p=b+_)-(m=p-b))+(_-m),b=p;for(;l<i;)(w=(s=x)-(y=(_=(r=u)+s)-r))&&(o[a++]=w),x=b-((p=b+_)-(m=p-b))+(_-m),b=p,(l+=1)<i&&(u=t[l]);for(;h<n;)(w=(s=x)-(y=(_=(r=g)+s)-r))&&(o[a++]=w),x=b-((p=b+_)-(m=p-b))+(_-m),b=p,(h+=1)<n&&(g=e[h]);return x&&(o[a++]=x),b&&(o[a++]=b),a||(o[a++]=0),o.length=a,o}},3379:t=>{"use strict";var e=[];function i(t){for(var i=-1,n=0;n<e.length;n++)if(e[n].identifier===t){i=n;break}return i}function n(t,n){for(var s={},o=[],a=0;a<t.length;a++){var l=t[a],h=n.base?l[0]+n.base:l[0],c=s[h]||0,u="".concat(h," ").concat(c);s[h]=c+1;var d=i(u),g={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==d)e[d].references++,e[d].updater(g);else{var f=r(g,n);n.byIndex=a,e.splice(a,0,{identifier:u,updater:f,references:1})}o.push(u)}return o}function r(t,e){var i=e.domAPI(e);return i.update(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap&&e.supports===t.supports&&e.layer===t.layer)return;i.update(t=e)}else i.remove()}}t.exports=function(t,r){var s=n(t=t||[],r=r||{});return function(t){t=t||[];for(var o=0;o<s.length;o++){var a=i(s[o]);e[a].references--}for(var l=n(t,r),h=0;h<s.length;h++){var c=i(s[h]);0===e[c].references&&(e[c].updater(),e.splice(c,1))}s=l}}},569:t=>{"use strict";var e={};t.exports=function(t,i){var n=function(t){if(void 0===e[t]){var i=document.querySelector(t);if(window.HTMLIFrameElement&&i instanceof window.HTMLIFrameElement)try{i=i.contentDocument.head}catch(t){i=null}e[t]=i}return e[t]}(t);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");n.appendChild(i)}},9216:t=>{"use strict";t.exports=function(t){var e=document.createElement("style");return t.setAttributes(e,t.attributes),t.insert(e,t.options),e}},3565:(t,e,i)=>{"use strict";t.exports=function(t){var e=i.nc;e&&t.setAttribute("nonce",e)}},7795:t=>{"use strict";t.exports=function(t){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var e=t.insertStyleElement(t);return{update:function(i){!function(t,e,i){var n="";i.supports&&(n+="@supports (".concat(i.supports,") {")),i.media&&(n+="@media ".concat(i.media," {"));var r=void 0!==i.layer;r&&(n+="@layer".concat(i.layer.length>0?" ".concat(i.layer):""," {")),n+=i.css,r&&(n+="}"),i.media&&(n+="}"),i.supports&&(n+="}");var s=i.sourceMap;s&&"undefined"!=typeof btoa&&(n+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(s))))," */")),e.styleTagTransform(n,t,e.options)}(e,t,i)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)}}}},4589:t=>{"use strict";t.exports=function(t,e){if(e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}},8005:t=>{"use strict";t.exports=function(t,i,n){var r=t*i,s=e*t,o=s-(s-t),a=t-o,l=e*i,h=l-(l-i),c=i-h,u=a*c-(r-o*h-a*h-o*c);return n?(n[0]=u,n[1]=r,n):[u,r]};var e=+(Math.pow(2,27)+1)},6359:t=>{"use strict";t.exports=function(t,e,i){var n=t+e,r=n-t,s=e-r,o=t-(n-r);return i?(i[0]=o+s,i[1]=n,i):[o+s,n]}},6732:(t,e,i)=>{"use strict";var n=i(7963),r=navigator.hardwareConcurrency||1;function s(t,e){if("string"!=typeof t&&"function"!=typeof t)throw new TypeError("func argument must be a function");if(void 0===e&&(e={}),"object"!=typeof e||null===e)throw new TypeError("options argument must be an object");this._workerCode=t.toString(),void 0===e.maxWorkers||"auto"===e.maxWorkers?this._numWorkers=Math.min(r-1,1):e.maxWorkers>0?this._numWorkers=Math.min(e.maxWorkers,r):this._numWorkers=r,this._workers=new Map,this._timeout=e.timeout||0,this._terminateOnError=!!e.terminateOnError;var i=e.deps;"string"==typeof i&&(i=[i]),Array.isArray(i)||(i=void 0),this._id=0,this._terminated=!1,this._working=0,this._waiting=[],this._init(i)}Function.prototype,s.prototype._init=function(t){for(var e=n.newWorkerURL(this._workerCode,t),i=0;i<this._numWorkers;i++){var r=new Worker(e);r.onmessage=this._onmessage.bind(this,r),r.onerror=this._onerror.bind(this,r),r.running=!1,r.id=i,this._workers.set(r,null)}URL.revokeObjectURL(e)},s.prototype._onerror=function(t,e){if(!this._terminated){this._working--,t.running=!1;var i=this._workers.get(t);i&&i[1](e.message),this._workers.set(t,null),this._terminateOnError?this.terminate():this._exec()}},s.prototype._onmessage=function(t,e){if(!this._terminated){this._working--,t.running=!1;var i=this._workers.get(t);i&&i[0](e.data.data),this._workers.set(t,null),this._exec()}},s.prototype._exec=function(){for(var t of this._workers.keys()){if(this._working===this._numWorkers||0===this._waiting.length)return;if(!t.running)for(var e=0;e<this._waiting.length;e++){var i=this._waiting[e];if("number"!=typeof i[4]||i[4]===t.id){this._waiting.splice(e,1),t.postMessage({action:"exec",event:i[0],args:i[1]},i[2]),t.running=!0,t.time=Date.now(),this._workers.set(t,i[3]),this._working++;break}}}},s.prototype.terminate=function(){if(!this._terminated){for(var t of this._workers)t[0].terminate(),t[1]&&t[1][1](new Error("Terminated"));this._workers.clear(),this._waiting=[],this._working=0,this._terminated=!0}},s.prototype.postAll=function(t,e){if(this._terminated)throw new Error("Cannot post (terminated)");var i=[];for(var n of this._workers.keys())i.push(this.post(t,e,[],n.id));return Promise.all(i)},s.prototype.post=function(t,e,i,n){void 0===e&&(e=[]),void 0===i&&(i=[]),Array.isArray(e)||(e=[e]),Array.isArray(i)||(i=[i]);var r=this;return new Promise((function(s,o){if(r._terminated)throw new Error("Cannot post (terminated)");r._waiting.push([t,e,i,[s,o],n]),r._exec()}))},t.exports=s},7963:(t,e)=>{"use strict";var i=function(){function t(){this._listeners={}}self.window=self,t.prototype.on=function(t,e){if(this._listeners[t])throw new RangeError("there is already a listener for "+t);if("function"!=typeof e)throw new TypeError("callback argument must be a function");this._listeners[t]=e},t.prototype._send=function(t,e,i){void 0===i?i=[]:Array.isArray(i)||(i=[i]),self.postMessage({id:t,data:e},i)},t.prototype._trigger=function(t,e){if(!this._listeners[t])throw new Error("event "+t+" is not defined");this._listeners[t].apply(null,e)};var e=new t;self.onmessage=function(t){switch(t.data.action){case"exec":t.data.args.unshift((function(i,n){e._send(t.data.id,i,n)})),e._trigger(t.data.event,t.data.args);break;case"ping":e._send(t.data.id,"pong");break;default:throw new Error("unexpected action: "+t.data.action)}}}.toString().split('"CODE";');e.newWorkerURL=function(t,e){var n=new Blob(["(",i[0],"importScripts.apply(self, "+JSON.stringify(e)+");\n","(",t,")();",i[1],")();"],{type:"application/javascript"});return URL.createObjectURL(n)}},9152:(t,e,i)=>{"use strict";i.d(e,{b:()=>n}),t=i.hmd(t);const n=function(){let t,e,i,n=[],r=[],s=[],o=c,a=function(t,e){return Math.abs(e.timestamp-t.timestamp)};function l(t,e){let i,n,r=-1,s=t.length;if(1===arguments.length){for(;++r<s&&!(null!=(i=t[r])&&i<=i);)i=void 0;for(;++r<s;)null!=(n=t[r])&&i>n&&(i=n)}else{for(;++r<s&&!(null!=(i=e.call(t,t[r],r))&&i<=i);)i=void 0;for(;++r<s;)null!=(n=e.call(t,t[r],r))&&i>n&&(i=n)}return i}function h(t,e){let i,n,r=-1,s=t.length;if(1===arguments.length){for(;++r<s&&!(null!=(i=t[r])&&i<=i);)i=void 0;for(;++r<s;)null!=(n=t[r])&&n>i&&(i=n)}else{for(;++r<s&&!(null!=(i=e.call(t,t[r],r))&&i<=i);)i=void 0;for(;++r<s;)null!=(n=e.call(t,t[r],r))&&n>i&&(i=n)}return i}function c(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function u(t,e){return Math.abs(e.x-t.x)+Math.abs(e.y-t.y)}function d(t,e){const i=t.location.latitude*Math.PI/180,n=t.location.longitude*Math.PI/180,r=e.location.latitude*Math.PI/180,s=r-i,o=e.location.longitude*Math.PI/180-n,a=Math.sin(s/2)*Math.sin(s/2)+Math.cos(i)*Math.cos(r)*Math.sin(o/2)*Math.sin(o/2);return(2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a))*6371).toPrecision(4)}function g(i){const r=[];let s=n[i];for(let l=0;l<n.length;l++)i!==l&&(e&&a(n[l],s)<=e&&o(n[l],s)<=t||o(n[l],s)<=t)&&r.push(l);return r}function f(t,e,n){r[n-1].push(t),s[t]=n;for(let t=0;t<e.length;t++){const o=e[t];if(void 0===s[o]){s[o]=0;let t=g(o);t.length>=i&&f(o,t,n)}s[o]<1&&(s[o]=n,r[n-1].push(o))}}let p=function(){s=[],r=[];for(let t=0;t<n.length;t++)if(void 0===s[t]){s[t]=0;const e=g(t);e.length<i?s[t]=0:(r.push([]),f(t,e,r.length))}return s};return p.getClusters=function(){const t=r.length,i=[];for(let s=0;s<t;s++){if(o===c||o===u){i[s]={x:0,y:0};for(let t=0;t<r[s].length;t++)i[s].x+=n[r[s][t]].x,i[s].y+=n[r[s][t]].y;i[s].x/=r[s].length,i[s].y/=r[s].length,i[s].dimension=r[s].length,i[s].parts=r[s]}if(o===d){i[s]={location:{latitude:0,longitude:0,accuracy:0}};for(let t=0;t<r[s].length;t++)i[s].location.latitude+=n[r[s][t]].location.latitude,i[s].location.longitude+=n[r[s][t]].location.longitude,i[s].location.accuracy+=n[r[s][t]].location.accuracy;i[s].dimension=r[s].length,i[s].parts=r[s],i[s].location.latitude/=r[s].length,i[s].location.longitude/=r[s].length,i[s].location.accuracy/=r[s].length}e&&(i[s].duration={},i[s].duration.start=l(r[s],(function(t){return n[t].timestamp})),i[s].duration.end=h(r[s],(function(t){return n[t].timestamp})),i[s].duration.span=i[s].duration.end-i[s].duration.start)}return i},p.data=function(t){return 0===arguments.length?n:(Array.isArray(t)&&(n=t),p)},p.eps=function(e){return 0===arguments.length?t:("number"==typeof e&&(t=e),p)},p.timeEps=function(t){return 0===arguments.length?e:("number"==typeof t&&(e=t),p)},p.minPts=function(t){return 0===arguments.length?i:("number"==typeof t&&(i=t),p)},p.distance=function(t){if(1===arguments.length)if("string"==typeof t)switch(t){case"HAVERSINE":o=d;break;case"EUCLIDEAN":default:o=c;break;case"MANHATTAN":o=u}else"function"==typeof t&&(o=t);return p},p.timeDistance=function(t){return 1===arguments.length&&(a=t),p},p};var r,s;r="undefined"!=typeof self?self:void 0,s=function(){return n},"function"==typeof define&&i.amdO?define([],s):t.exports?t.exports=s():r.jDBSCAN=s()},2898:t=>{"use strict";t.exports={version:"1.0.1"}}},__webpack_module_cache__={};function __webpack_require__(t){var e=__webpack_module_cache__[t];if(void 0!==e)return e.exports;var i=__webpack_module_cache__[t]={id:t,loaded:!1,exports:{}};return __webpack_modules__[t].call(i.exports,i,i.exports,__webpack_require__),i.loaded=!0,i.exports}__webpack_require__.amdO={},__webpack_require__.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return __webpack_require__.d(e,{a:e}),e},__webpack_require__.d=(t,e)=>{for(var i in e)__webpack_require__.o(e,i)&&!__webpack_require__.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},__webpack_require__.hmd=t=>((t=Object.create(t)).children||(t.children=[]),Object.defineProperty(t,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+t.id)}}),t),__webpack_require__.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),__webpack_require__.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},__webpack_require__.nc=void 0;var __webpack_exports__={};(()=>{"use strict";var t={};__webpack_require__.r(t),__webpack_require__.d(t,{CMYK:()=>lp,GREY:()=>rp,HSL:()=>op,HSV:()=>ap,RGB:()=>sp});var e={};__webpack_require__.r(e),__webpack_require__.d(e,{tagsById:()=>mp,tagsByName:()=>_p});var i={};__webpack_require__.r(i),__webpack_require__.d(i,{tagsById:()=>yp,tagsByName:()=>wp});var n={};__webpack_require__.r(n),__webpack_require__.d(n,{tagsById:()=>xp,tagsByName:()=>bp});const r=class{constructor(t){this.propagationStopped,this.defaultPrevented,this.type=t,this.target=null}preventDefault(){this.defaultPrevented=!0}stopPropagation(){this.propagationStopped=!0}},s="propertychange",o=class{constructor(){this.disposed=!1}dispose(){this.disposed||(this.disposed=!0,this.disposeInternal())}disposeInternal(){}};function a(t,e){return t>e?1:t<e?-1:0}function l(t,e,i){if(t[0]<=e)return 0;const n=t.length;if(e<=t[n-1])return n-1;if("function"==typeof i){for(let r=1;r<n;++r){const n=t[r];if(n===e)return r;if(n<e)return i(e,t[r-1],n)>0?r-1:r}return n-1}if(i>0){for(let i=1;i<n;++i)if(t[i]<e)return i-1;return n-1}if(i<0){for(let i=1;i<n;++i)if(t[i]<=e)return i;return n-1}for(let i=1;i<n;++i){if(t[i]==e)return i;if(t[i]<e)return t[i-1]-e<e-t[i]?i-1:i}return n-1}function h(t,e,i){for(;e<i;){const n=t[e];t[e]=t[i],t[i]=n,++e,--i}}function c(t,e){const i=Array.isArray(e)?e:[e],n=i.length;for(let e=0;e<n;e++)t[t.length]=i[e]}function u(t,e){const i=t.length;if(i!==e.length)return!1;for(let n=0;n<i;n++)if(t[n]!==e[n])return!1;return!0}function d(){return!0}function g(){return!1}function f(){}function p(t){let e,i,n,r=!1;return function(){const s=Array.prototype.slice.call(arguments);return r&&this===n&&u(s,i)||(r=!0,n=this,i=s,e=t.apply(this,arguments)),e}}function m(t){for(const e in t)delete t[e]}function _(t){let e;for(e in t)return!1;return!e}const y=class extends o{constructor(t){super(),this.eventTarget_=t,this.pendingRemovals_=null,this.dispatching_=null,this.listeners_=null}addEventListener(t,e){if(!t||!e)return;const i=this.listeners_||(this.listeners_={}),n=i[t]||(i[t]=[]);n.includes(e)||n.push(e)}dispatchEvent(t){const e="string"==typeof t,i=e?t:t.type,n=this.listeners_&&this.listeners_[i];if(!n)return;const s=e?new r(t):t;s.target||(s.target=this.eventTarget_||this);const o=this.dispatching_||(this.dispatching_={}),a=this.pendingRemovals_||(this.pendingRemovals_={});let l;i in o||(o[i]=0,a[i]=0),++o[i];for(let t=0,e=n.length;t<e;++t)if(l="handleEvent"in n[t]?n[t].handleEvent(s):n[t].call(this,s),!1===l||s.propagationStopped){l=!1;break}if(0==--o[i]){let t=a[i];for(delete a[i];t--;)this.removeEventListener(i,f);delete o[i]}return l}disposeInternal(){this.listeners_&&m(this.listeners_)}getListeners(t){return this.listeners_&&this.listeners_[t]||void 0}hasListener(t){return!!this.listeners_&&(t?t in this.listeners_:Object.keys(this.listeners_).length>0)}removeEventListener(t,e){if(!this.listeners_)return;const i=this.listeners_[t];if(!i)return;const n=i.indexOf(e);-1!==n&&(this.pendingRemovals_&&t in this.pendingRemovals_?(i[n]=f,++this.pendingRemovals_[t]):(i.splice(n,1),0===i.length&&delete this.listeners_[t]))}},w="change",x="contextmenu",b="click",v="keydown",E="keypress",S="touchmove",I="wheel";function M(t,e,i,n,r){if(n&&n!==t&&(i=i.bind(n)),r){const n=i;i=function(){t.removeEventListener(e,i),n.apply(this,arguments)}}const s={target:t,type:e,listener:i};return t.addEventListener(e,i),s}function C(t,e,i,n){return M(t,e,i,n,!0)}function T(t){t&&t.target&&(t.target.removeEventListener(t.type,t.listener),m(t))}class R extends y{constructor(){super(),this.on=this.onInternal,this.once=this.onceInternal,this.un=this.unInternal,this.revision_=0}changed(){++this.revision_,this.dispatchEvent(w)}getRevision(){return this.revision_}onInternal(t,e){if(Array.isArray(t)){const i=t.length,n=new Array(i);for(let r=0;r<i;++r)n[r]=M(this,t[r],e);return n}return M(this,t,e)}onceInternal(t,e){let i;if(Array.isArray(t)){const n=t.length;i=new Array(n);for(let r=0;r<n;++r)i[r]=C(this,t[r],e)}else i=C(this,t,e);return e.ol_key=i,i}unInternal(t,e){const i=e.ol_key;if(i)!function(t){if(Array.isArray(t))for(let e=0,i=t.length;e<i;++e)T(t[e]);else T(t)}(i);else if(Array.isArray(t))for(let i=0,n=t.length;i<n;++i)this.removeEventListener(t[i],e);else this.removeEventListener(t,e)}}R.prototype.on,R.prototype.once,R.prototype.un;const A=R;function k(){throw new Error("Unimplemented abstract method.")}let P=0;function L(t){return t.ol_uid||(t.ol_uid=String(++P))}class N extends r{constructor(t,e,i){super(t),this.key=e,this.oldValue=i}}const D=class extends A{constructor(t){super(),this.on,this.once,this.un,L(this),this.values_=null,void 0!==t&&this.setProperties(t)}get(t){let e;return this.values_&&this.values_.hasOwnProperty(t)&&(e=this.values_[t]),e}getKeys(){return this.values_&&Object.keys(this.values_)||[]}getProperties(){return this.values_&&Object.assign({},this.values_)||{}}getPropertiesInternal(){return this.values_}hasProperties(){return!!this.values_}notify(t,e){let i;i=`change:${t}`,this.hasListener(i)&&this.dispatchEvent(new N(i,t,e)),i=s,this.hasListener(i)&&this.dispatchEvent(new N(i,t,e))}addChangeListener(t,e){this.addEventListener(`change:${t}`,e)}removeChangeListener(t,e){this.removeEventListener(`change:${t}`,e)}set(t,e,i){const n=this.values_||(this.values_={});if(i)n[t]=e;else{const i=n[t];n[t]=e,i!==e&&this.notify(t,i)}}setProperties(t,e){for(const i in t)this.set(i,t[i],e)}applyProperties(t){t.values_&&Object.assign(this.values_||(this.values_={}),t.values_)}unset(t,e){if(this.values_&&t in this.values_){const i=this.values_[t];delete this.values_[t],_(this.values_)&&(this.values_=null),e||this.notify(t,i)}}},O="add",F="remove",z="length";class B extends r{constructor(t,e,i){super(t),this.element=e,this.index=i}}const G=class extends D{constructor(t,e){if(super(),this.on,this.once,this.un,e=e||{},this.unique_=!!e.unique,this.array_=t||[],this.unique_)for(let t=0,e=this.array_.length;t<e;++t)this.assertUnique_(this.array_[t],t);this.updateLength_()}clear(){for(;this.getLength()>0;)this.pop()}extend(t){for(let e=0,i=t.length;e<i;++e)this.push(t[e]);return this}forEach(t){const e=this.array_;for(let i=0,n=e.length;i<n;++i)t(e[i],i,e)}getArray(){return this.array_}item(t){return this.array_[t]}getLength(){return this.get(z)}insertAt(t,e){if(t<0||t>this.getLength())throw new Error("Index out of bounds: "+t);this.unique_&&this.assertUnique_(e),this.array_.splice(t,0,e),this.updateLength_(),this.dispatchEvent(new B(O,e,t))}pop(){return this.removeAt(this.getLength()-1)}push(t){this.unique_&&this.assertUnique_(t);const e=this.getLength();return this.insertAt(e,t),this.getLength()}remove(t){const e=this.array_;for(let i=0,n=e.length;i<n;++i)if(e[i]===t)return this.removeAt(i)}removeAt(t){if(t<0||t>=this.getLength())return;const e=this.array_[t];return this.array_.splice(t,1),this.updateLength_(),this.dispatchEvent(new B(F,e,t)),e}setAt(t,e){if(t>=this.getLength())return void this.insertAt(t,e);if(t<0)throw new Error("Index out of bounds: "+t);this.unique_&&this.assertUnique_(e,t);const i=this.array_[t];this.array_[t]=e,this.dispatchEvent(new B(F,i,t)),this.dispatchEvent(new B(O,e,t))}updateLength_(){this.set(z,this.array_.length)}assertUnique_(t,e){for(let i=0,n=this.array_.length;i<n;++i)if(this.array_[i]===t&&i!==e)throw new Error("Duplicate item added to a unique collection")}},Y="opacity",U="visible",X="extent",q="zIndex",V="maxResolution",j="minResolution",W="maxZoom",Z="minZoom",H="source";function K(t,e){if(!t)throw new Error(e)}function $(t,e,i){return Math.min(Math.max(t,e),i)}function J(t,e,i,n,r,s){const o=r-i,a=s-n;if(0!==o||0!==a){const l=((t-i)*o+(e-n)*a)/(o*o+a*a);l>1?(i=r,n=s):l>0&&(i+=o*l,n+=a*l)}return Q(t,e,i,n)}function Q(t,e,i,n){const r=i-t,s=n-e;return r*r+s*s}function tt(t){return t*Math.PI/180}function et(t,e){const i=t%e;return i*e<0?i+e:i}function it(t,e,i){return t+i*(e-t)}function nt(t,e){const i=Math.pow(10,e);return Math.round(t*i)/i}function rt(t,e){return Math.round(nt(t,e))}function st(t,e){return Math.floor(nt(t,e))}function ot(t,e){return Math.ceil(nt(t,e))}const at=class extends D{constructor(t){super(),this.on,this.once,this.un,this.background_=t.background;const e=Object.assign({},t);"object"==typeof t.properties&&(delete e.properties,Object.assign(e,t.properties)),e[Y]=void 0!==t.opacity?t.opacity:1,K("number"==typeof e[Y],"Layer opacity must be a number"),e[U]=void 0===t.visible||t.visible,e[q]=t.zIndex,e[V]=void 0!==t.maxResolution?t.maxResolution:1/0,e[j]=void 0!==t.minResolution?t.minResolution:0,e[Z]=void 0!==t.minZoom?t.minZoom:-1/0,e[W]=void 0!==t.maxZoom?t.maxZoom:1/0,this.className_=void 0!==e.className?e.className:"ol-layer",delete e.className,this.setProperties(e),this.state_=null}getBackground(){return this.background_}getClassName(){return this.className_}getLayerState(t){const e=this.state_||{layer:this,managed:void 0===t||t},i=this.getZIndex();return e.opacity=$(Math.round(100*this.getOpacity())/100,0,1),e.visible=this.getVisible(),e.extent=this.getExtent(),e.zIndex=void 0!==i||e.managed?i:1/0,e.maxResolution=this.getMaxResolution(),e.minResolution=Math.max(this.getMinResolution(),0),e.minZoom=this.getMinZoom(),e.maxZoom=this.getMaxZoom(),this.state_=e,e}getLayersArray(t){return k()}getLayerStatesArray(t){return k()}getExtent(){return this.get(X)}getMaxResolution(){return this.get(V)}getMinResolution(){return this.get(j)}getMinZoom(){return this.get(Z)}getMaxZoom(){return this.get(W)}getOpacity(){return this.get(Y)}getSourceState(){return k()}getVisible(){return this.get(U)}getZIndex(){return this.get(q)}setBackground(t){this.background_=t,this.changed()}setExtent(t){this.set(X,t)}setMaxResolution(t){this.set(V,t)}setMinResolution(t){this.set(j,t)}setMaxZoom(t){this.set(W,t)}setMinZoom(t){this.set(Z,t)}setOpacity(t){K("number"==typeof t,"Layer opacity must be a number"),this.set(Y,t)}setVisible(t){this.set(U,t)}setZIndex(t){this.set(q,t)}disposeInternal(){this.state_&&(this.state_.layer=null,this.state_=null),super.disposeInternal()}},lt="prerender",ht="postrender",ct="precompose",ut="rendercomplete",dt={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"},gt=42,ft=256,pt={radians:6370997/(2*Math.PI),degrees:2*Math.PI*6370997/360,ft:.3048,m:1,"us-ft":1200/3937},mt=class{constructor(t){this.code_=t.code,this.units_=t.units,this.extent_=void 0!==t.extent?t.extent:null,this.worldExtent_=void 0!==t.worldExtent?t.worldExtent:null,this.axisOrientation_=void 0!==t.axisOrientation?t.axisOrientation:"enu",this.global_=void 0!==t.global&&t.global,this.canWrapX_=!(!this.global_||!this.extent_),this.getPointResolutionFunc_=t.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=t.metersPerUnit}canWrapX(){return this.canWrapX_}getCode(){return this.code_}getExtent(){return this.extent_}getUnits(){return this.units_}getMetersPerUnit(){return this.metersPerUnit_||pt[this.units_]}getWorldExtent(){return this.worldExtent_}getAxisOrientation(){return this.axisOrientation_}isGlobal(){return this.global_}setGlobal(t){this.global_=t,this.canWrapX_=!(!t||!this.extent_)}getDefaultTileGrid(){return this.defaultTileGrid_}setDefaultTileGrid(t){this.defaultTileGrid_=t}setExtent(t){this.extent_=t,this.canWrapX_=!(!this.global_||!t)}setWorldExtent(t){this.worldExtent_=t}setGetPointResolution(t){this.getPointResolutionFunc_=t}getPointResolutionFunc(){return this.getPointResolutionFunc_}},_t=6378137,yt=Math.PI*_t,wt=[-yt,-yt,yt,yt],xt=[-180,-85,180,85],bt=_t*Math.log(Math.tan(Math.PI/2));class vt extends mt{constructor(t){super({code:t,units:"m",extent:wt,global:!0,worldExtent:xt,getPointResolution:function(t,e){return t/Math.cosh(e[1]/_t)}})}}const Et=[new vt("EPSG:3857"),new vt("EPSG:102100"),new vt("EPSG:102113"),new vt("EPSG:900913"),new vt("http://www.opengis.net/def/crs/EPSG/0/3857"),new vt("http://www.opengis.net/gml/srs/epsg.xml#3857")];const St=[-180,-90,180,90],It=6378137*Math.PI/180;class Mt extends mt{constructor(t,e){super({code:t,units:"degrees",extent:St,axisOrientation:e,global:!0,metersPerUnit:It,worldExtent:St})}}const Ct=[new Mt("CRS:84"),new Mt("EPSG:4326","neu"),new Mt("urn:ogc:def:crs:OGC:1.3:CRS84"),new Mt("urn:ogc:def:crs:OGC:2:84"),new Mt("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new Mt("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new Mt("http://www.opengis.net/def/crs/EPSG/0/4326","neu")];let Tt={},Rt={};function At(t,e,i){const n=t.getCode(),r=e.getCode();n in Rt||(Rt[n]={}),Rt[n][r]=i}const kt={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};function Pt(t){const e=[1/0,1/0,-1/0,-1/0];for(let i=0,n=t.length;i<n;++i)jt(e,t[i]);return e}function Lt(t,e,i){return i?(i[0]=t[0]-e,i[1]=t[1]-e,i[2]=t[2]+e,i[3]=t[3]+e,i):[t[0]-e,t[1]-e,t[2]+e,t[3]+e]}function Nt(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t.slice()}function Dt(t,e,i){let n,r;return n=e<t[0]?t[0]-e:t[2]<e?e-t[2]:0,r=i<t[1]?t[1]-i:t[3]<i?i-t[3]:0,n*n+r*r}function Ot(t,e){return zt(t,e[0],e[1])}function Ft(t,e){return t[0]<=e[0]&&e[2]<=t[2]&&t[1]<=e[1]&&e[3]<=t[3]}function zt(t,e,i){return t[0]<=e&&e<=t[2]&&t[1]<=i&&i<=t[3]}function Bt(t,e){const i=t[0],n=t[1],r=t[2],s=t[3],o=e[0],a=e[1];let l=kt.UNKNOWN;return o<i?l|=kt.LEFT:o>r&&(l|=kt.RIGHT),a<n?l|=kt.BELOW:a>s&&(l|=kt.ABOVE),l===kt.UNKNOWN&&(l=kt.INTERSECTING),l}function Gt(t,e,i,n,r){return r?(r[0]=t,r[1]=e,r[2]=i,r[3]=n,r):[t,e,i,n]}function Yt(t){return Gt(1/0,1/0,-1/0,-1/0,t)}function Ut(t,e){const i=t[0],n=t[1];return Gt(i,n,i,n,e)}function Xt(t,e,i,n,r){return Wt(Yt(r),t,e,i,n)}function qt(t,e){return t[0]==e[0]&&t[2]==e[2]&&t[1]==e[1]&&t[3]==e[3]}function Vt(t,e){return e[0]<t[0]&&(t[0]=e[0]),e[2]>t[2]&&(t[2]=e[2]),e[1]<t[1]&&(t[1]=e[1]),e[3]>t[3]&&(t[3]=e[3]),t}function jt(t,e){e[0]<t[0]&&(t[0]=e[0]),e[0]>t[2]&&(t[2]=e[0]),e[1]<t[1]&&(t[1]=e[1]),e[1]>t[3]&&(t[3]=e[1])}function Wt(t,e,i,n,r){for(;i<n;i+=r)Zt(t,e[i],e[i+1]);return t}function Zt(t,e,i){t[0]=Math.min(t[0],e),t[1]=Math.min(t[1],i),t[2]=Math.max(t[2],e),t[3]=Math.max(t[3],i)}function Ht(t,e){let i;return i=e($t(t)),i||(i=e(Jt(t)),i||(i=e(oe(t)),i||(i=e(se(t)),i||!1)))}function Kt(t){let e=0;return he(t)||(e=ae(t)*ne(t)),e}function $t(t){return[t[0],t[1]]}function Jt(t){return[t[2],t[1]]}function Qt(t){return[(t[0]+t[2])/2,(t[1]+t[3])/2]}function te(t,e){let i;if("bottom-left"===e)i=$t(t);else if("bottom-right"===e)i=Jt(t);else if("top-left"===e)i=se(t);else{if("top-right"!==e)throw new Error("Invalid corner");i=oe(t)}return i}function ee(t,e,i,n,r){const[s,o,a,l,h,c,u,d]=ie(t,e,i,n);return Gt(Math.min(s,a,h,u),Math.min(o,l,c,d),Math.max(s,a,h,u),Math.max(o,l,c,d),r)}function ie(t,e,i,n){const r=e*n[0]/2,s=e*n[1]/2,o=Math.cos(i),a=Math.sin(i),l=r*o,h=r*a,c=s*o,u=s*a,d=t[0],g=t[1];return[d-l+u,g-h-c,d-l-u,g-h+c,d+l-u,g+h+c,d+l+u,g+h-c,d-l+u,g-h-c]}function ne(t){return t[3]-t[1]}function re(t,e,i){const n=i||[1/0,1/0,-1/0,-1/0];return le(t,e)?(t[0]>e[0]?n[0]=t[0]:n[0]=e[0],t[1]>e[1]?n[1]=t[1]:n[1]=e[1],t[2]<e[2]?n[2]=t[2]:n[2]=e[2],t[3]<e[3]?n[3]=t[3]:n[3]=e[3]):Yt(n),n}function se(t){return[t[0],t[3]]}function oe(t){return[t[2],t[3]]}function ae(t){return t[2]-t[0]}function le(t,e){return t[0]<=e[2]&&t[2]>=e[0]&&t[1]<=e[3]&&t[3]>=e[1]}function he(t){return t[2]<t[0]||t[3]<t[1]}function ce(t,e,i,n){if(he(t))return Yt(i);let r=[];if(n>1){const e=t[2]-t[0],i=t[3]-t[1];for(let s=0;s<n;++s)r.push(t[0]+e*s/n,t[1],t[2],t[1]+i*s/n,t[2]-e*s/n,t[3],t[0],t[3]-i*s/n)}else r=[t[0],t[1],t[2],t[1],t[2],t[3],t[0],t[3]];e(r,r,2);const s=[],o=[];for(let t=0,e=r.length;t<e;t+=2)s.push(r[t]),o.push(r[t+1]);return function(t,e,i){return Gt(Math.min.apply(null,t),Math.min.apply(null,e),Math.max.apply(null,t),Math.max.apply(null,e),i)}(s,o,i)}function ue(t,e){const i=e.getExtent(),n=Qt(t);if(e.canWrapX()&&(n[0]<i[0]||n[0]>=i[2])){const e=ae(i),r=Math.floor((n[0]-i[0])/e)*e;t[0]-=r,t[2]-=r}return t}function de(t,e){let i=!0;for(let n=t.length-1;n>=0;--n)if(t[n]!=e[n]){i=!1;break}return i}function ge(t,e){const i=Math.cos(e),n=Math.sin(e),r=t[0]*i-t[1]*n,s=t[1]*i+t[0]*n;return t[0]=r,t[1]=s,t}function fe(t,e){if(e.canWrapX()){const i=ae(e.getExtent()),n=function(t,e,i){const n=e.getExtent();let r=0;return e.canWrapX()&&(t[0]<n[0]||t[0]>n[2])&&(i=i||ae(n),r=Math.floor((t[0]-n[0])/i)),r}(t,e,i);n&&(t[0]-=n*i)}return t}const pe=6371008.8;function me(t,e,i){i=i||pe;const n=tt(t[1]),r=tt(e[1]),s=(r-n)/2,o=tt(e[0]-t[0])/2,a=Math.sin(s)*Math.sin(s)+Math.sin(o)*Math.sin(o)*Math.cos(n)*Math.cos(r);return 2*i*Math.atan2(Math.sqrt(a),Math.sqrt(1-a))}const _e={info:1,warn:2,error:3,none:4};let ye=_e.info;function we(...t){ye>_e.warn||console.warn(...t)}let xe=!0;function be(t,e){if(void 0!==e)for(let i=0,n=t.length;i<n;++i)e[i]=t[i];else e=t.slice();return e}function ve(t,e){if(void 0!==e&&t!==e){for(let i=0,n=t.length;i<n;++i)e[i]=t[i];t=e}return t}function Ee(t){!function(t,e){Tt[t]=e}(t.getCode(),t),At(t,t,be)}function Se(t){return"string"==typeof t?Tt[e=t]||Tt[e.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null:t||null;var e}function Ie(t,e,i,n){let r;const s=(t=Se(t)).getPointResolutionFunc();if(s){if(r=s(e,i),n&&n!==t.getUnits()){const e=t.getMetersPerUnit();e&&(r=r*e/pt[n])}}else{const s=t.getUnits();if("degrees"==s&&!n||"degrees"==n)r=e;else{const o=Re(t,Se("EPSG:4326"));if(o===ve&&"degrees"!==s)r=e*t.getMetersPerUnit();else{let t=[i[0]-e/2,i[1],i[0]+e/2,i[1],i[0],i[1]-e/2,i[0],i[1]+e/2];t=o(t,t,2),r=(me(t.slice(0,2),t.slice(2,4))+me(t.slice(4,6),t.slice(6,8)))/2}const a=n?pt[n]:t.getMetersPerUnit();void 0!==a&&(r/=a)}}return r}function Me(t){!function(t){t.forEach(Ee)}(t),t.forEach((function(e){t.forEach((function(t){e!==t&&At(e,t,be)}))}))}function Ce(t,e){return t?"string"==typeof t?Se(t):t:Se(e)}function Te(t,e){if(t===e)return!0;const i=t.getUnits()===e.getUnits();return(t.getCode()===e.getCode()||Re(t,e)===be)&&i}function Re(t,e){let i=function(t,e){let i;return t in Rt&&e in Rt[t]&&(i=Rt[t][e]),i}(t.getCode(),e.getCode());return i||(i=ve),i}function Ae(t,e){return Re(Se(t),Se(e))}function ke(t,e,i){return Ae(e,i)(t,void 0,t.length)}let Pe=null;function Le(){return Pe}function Ne(t,e){return t}function De(t,e){return xe&&!de(t,[0,0])&&t[0]>=-180&&t[0]<=180&&t[1]>=-90&&t[1]<=90&&(xe=!1,we("Call useGeographic() from ol/proj once to work with [longitude, latitude] coordinates.")),t}function Oe(t,e){return t}function Fe(t,e){return t}function ze(t,e){return t}var Be,Ge,Ye;function Ue(t,e,i){return function(n,r,s,o,a){if(!n)return;if(!r&&!e)return n;const l=e?0:s[0]*r,h=e?0:s[1]*r,c=a?a[0]:0,u=a?a[1]:0;let d=t[0]+l/2+c,g=t[2]-l/2+c,f=t[1]+h/2+u,p=t[3]-h/2+u;d>g&&(d=(g+d)/2,g=d),f>p&&(f=(p+f)/2,p=f);let m=$(n[0],d,g),_=$(n[1],f,p);if(o&&i&&r){const t=30*r;m+=-t*Math.log(1+Math.max(0,d-n[0])/t)+t*Math.log(1+Math.max(0,n[0]-g)/t),_+=-t*Math.log(1+Math.max(0,f-n[1])/t)+t*Math.log(1+Math.max(0,n[1]-p)/t)}return[m,_]}}function Xe(t){return t}function qe(t,e,i,n){const r=ae(e)/i[0],s=ne(e)/i[1];return n?Math.min(t,Math.max(r,s)):Math.min(t,Math.min(r,s))}function Ve(t,e,i){let n=Math.min(t,e);return n*=Math.log(1+50*Math.max(0,t/e-1))/50+1,i&&(n=Math.max(n,i),n/=Math.log(1+50*Math.max(0,i/t-1))/50+1),$(n,i/2,2*e)}function je(t,e,i,n,r){return i=void 0===i||i,function(s,o,a,l){if(void 0!==s){const o=n?qe(t,n,a,r):t;return i&&l?Ve(s,o,e):$(s,e,o)}}}function We(t){if(void 0!==t)return 0}function Ze(t){if(void 0!==t)return t}function He(t){return Math.pow(t,3)}function Ke(t){return 1-He(1-t)}function $e(t){return 3*t*t-2*t*t*t}function Je(t){return t}function Qe(t,e){const i=e[0],n=e[1];return e[0]=t[0]*i+t[2]*n+t[4],e[1]=t[1]*i+t[3]*n+t[5],e}function ti(t,e,i,n,r,s,o,a){const l=Math.sin(s),h=Math.cos(s);return t[0]=n*h,t[1]=r*l,t[2]=-n*l,t[3]=r*h,t[4]=o*n*h-a*n*l+e,t[5]=o*r*l+a*r*h+i,t}function ei(t,e){const i=(n=e)[0]*n[3]-n[1]*n[2];var n;K(0!==i,"Transformation matrix cannot be inverted");const r=e[0],s=e[1],o=e[2],a=e[3],l=e[4],h=e[5];return t[0]=a/i,t[1]=-s/i,t[2]=-o/i,t[3]=r/i,t[4]=(o*h-a*l)/i,t[5]=-(r*h-s*l)/i,t}Me(Et),Me(Ct),Be=Et,Ge=function(t,e,i){const n=t.length;i=i>1?i:2,void 0===e&&(e=i>2?t.slice():new Array(n));for(let r=0;r<n;r+=i){e[r]=yt*t[r]/180;let i=_t*Math.log(Math.tan(Math.PI*(+t[r+1]+90)/360));i>bt?i=bt:i<-bt&&(i=-bt),e[r+1]=i}return e},Ye=function(t,e,i){const n=t.length;i=i>1?i:2,void 0===e&&(e=i>2?t.slice():new Array(n));for(let r=0;r<n;r+=i)e[r]=180*t[r]/yt,e[r+1]=360*Math.atan(Math.exp(t[r+1]/_t))/Math.PI-90;return e},Ct.forEach((function(t){Be.forEach((function(e){At(t,e,Ge),At(e,t,Ye)}))})),new Array(6);const ii=[1e6,1e6,1e6,1e6,2,2];function ni(t){return"matrix("+t.map(((t,e)=>Math.round(t*ii[e])/ii[e])).join(", ")+")"}function ri(t,e,i,n,r,s){s=s||[];let o=0;for(let a=e;a<i;a+=n){const e=t[a],i=t[a+1];s[o++]=r[0]*e+r[2]*i+r[4],s[o++]=r[1]*e+r[3]*i+r[5]}return s&&s.length!=o&&(s.length=o),s}function si(t,e,i,n,r,s,o){o=o||[];const a=Math.cos(r),l=Math.sin(r),h=s[0],c=s[1];let u=0;for(let r=e;r<i;r+=n){const e=t[r]-h,i=t[r+1]-c;o[u++]=h+e*a-i*l,o[u++]=c+e*l+i*a;for(let e=r+2;e<r+n;++e)o[u++]=t[e]}return o&&o.length!=u&&(o.length=u),o}const oi=[1,0,0,1,0,0],ai=class extends D{constructor(){super(),this.extent_=[1/0,1/0,-1/0,-1/0],this.extentRevision_=-1,this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0,this.simplifyTransformedInternal=p(((t,e,i)=>{if(!i)return this.getSimplifiedGeometry(e);const n=this.clone();return n.applyTransform(i),n.getSimplifiedGeometry(e)}))}simplifyTransformed(t,e){return this.simplifyTransformedInternal(this.getRevision(),t,e)}clone(){return k()}closestPointXY(t,e,i,n){return k()}containsXY(t,e){const i=this.getClosestPoint([t,e]);return i[0]===t&&i[1]===e}getClosestPoint(t,e){return e=e||[NaN,NaN],this.closestPointXY(t[0],t[1],e,1/0),e}intersectsCoordinate(t){return this.containsXY(t[0],t[1])}computeExtent(t){return k()}getExtent(t){if(this.extentRevision_!=this.getRevision()){const t=this.computeExtent(this.extent_);(isNaN(t[0])||isNaN(t[1]))&&Yt(t),this.extentRevision_=this.getRevision()}return function(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t}(this.extent_,t)}rotate(t,e){k()}scale(t,e,i){k()}simplify(t){return this.getSimplifiedGeometry(t*t)}getSimplifiedGeometry(t){return k()}getType(){return k()}applyTransform(t){k()}intersectsExtent(t){return k()}translate(t,e){k()}transform(t,e){const i=Se(t),n="tile-pixels"==i.getUnits()?function(t,n,r){const s=i.getExtent(),o=i.getWorldExtent(),a=ne(o)/ne(s);return ti(oi,o[0],o[3],a,-a,0,0,0),ri(t,0,t.length,r,oi,n),Ae(i,e)(t,n,r)}:Ae(i,e);return this.applyTransform(n),this}};function li(t){let e;return 2==t?e="XY":3==t?e="XYZ":4==t&&(e="XYZM"),e}function hi(t){let e;return"XY"==t?e=2:"XYZ"==t||"XYM"==t?e=3:"XYZM"==t&&(e=4),e}const ci=class extends ai{constructor(){super(),this.layout="XY",this.stride=2,this.flatCoordinates}computeExtent(t){return Xt(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}getCoordinates(){return k()}getFirstCoordinate(){return this.flatCoordinates.slice(0,this.stride)}getFlatCoordinates(){return this.flatCoordinates}getLastCoordinate(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}getLayout(){return this.layout}getSimplifiedGeometry(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&t<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;const e=this.getSimplifiedGeometryInternal(t);return e.getFlatCoordinates().length<this.flatCoordinates.length?e:(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)}getSimplifiedGeometryInternal(t){return this}getStride(){return this.stride}setFlatCoordinates(t,e){this.stride=hi(t),this.layout=t,this.flatCoordinates=e}setCoordinates(t,e){k()}setLayout(t,e,i){let n;if(t)n=hi(t);else{for(let t=0;t<i;++t){if(0===e.length)return this.layout="XY",void(this.stride=2);e=e[0]}n=e.length,t=li(n)}this.layout=t,this.stride=n}applyTransform(t){this.flatCoordinates&&(t(this.flatCoordinates,this.flatCoordinates,this.stride),this.changed())}rotate(t,e){const i=this.getFlatCoordinates();if(i){const n=this.getStride();si(i,0,i.length,n,t,e,i),this.changed()}}scale(t,e,i){void 0===e&&(e=t),i||(i=Qt(this.getExtent()));const n=this.getFlatCoordinates();if(n){const r=this.getStride();!function(t,e,i,n,r,s,o,a){a=a||[];const l=o[0],h=o[1];let c=0;for(let e=0;e<i;e+=n){const i=t[e]-l,o=t[e+1]-h;a[c++]=l+r*i,a[c++]=h+s*o;for(let i=e+2;i<e+n;++i)a[c++]=t[i]}a&&a.length!=c&&(a.length=c)}(n,0,n.length,r,t,e,i,n),this.changed()}}translate(t,e){const i=this.getFlatCoordinates();if(i){const n=this.getStride();!function(t,e,i,n,r,s,o){o=o||[];let a=0;for(let e=0;e<i;e+=n){o[a++]=t[e]+r,o[a++]=t[e+1]+s;for(let i=e+2;i<e+n;++i)o[a++]=t[i]}o&&o.length!=a&&(o.length=a)}(i,0,i.length,n,t,e,i),this.changed()}}};function ui(t,e,i,n,r,s,o){const a=t[e],l=t[e+1],h=t[i]-a,c=t[i+1]-l;let u;if(0===h&&0===c)u=e;else{const d=((r-a)*h+(s-l)*c)/(h*h+c*c);if(d>1)u=i;else{if(d>0){for(let r=0;r<n;++r)o[r]=it(t[e+r],t[i+r],d);return void(o.length=n)}u=e}}for(let e=0;e<n;++e)o[e]=t[u+e];o.length=n}function di(t,e,i,n,r){let s=t[e],o=t[e+1];for(e+=n;e<i;e+=n){const i=t[e],n=t[e+1],a=Q(s,o,i,n);a>r&&(r=a),s=i,o=n}return r}function gi(t,e,i,n,r){for(let s=0,o=i.length;s<o;++s){const o=i[s];r=di(t,e,o,n,r),e=o}return r}function fi(t,e,i,n,r,s,o,a,l,h,c){if(e==i)return h;let u,d;if(0===r){if(d=Q(o,a,t[e],t[e+1]),d<h){for(u=0;u<n;++u)l[u]=t[e+u];return l.length=n,d}return h}c=c||[NaN,NaN];let g=e+n;for(;g<i;)if(ui(t,g-n,g,n,o,a,c),d=Q(o,a,c[0],c[1]),d<h){for(h=d,u=0;u<n;++u)l[u]=c[u];l.length=n,g+=n}else g+=n*Math.max((Math.sqrt(d)-Math.sqrt(h))/r|0,1);if(s&&(ui(t,i-n,e,n,o,a,c),d=Q(o,a,c[0],c[1]),d<h)){for(h=d,u=0;u<n;++u)l[u]=c[u];l.length=n}return h}function pi(t,e,i,n,r,s,o,a,l,h,c){c=c||[NaN,NaN];for(let u=0,d=i.length;u<d;++u){const d=i[u];h=fi(t,e,d,n,r,s,o,a,l,h,c),e=d}return h}function mi(t,e,i,n){for(let r=0,s=i.length;r<s;++r){const s=i[r];for(let i=0;i<n;++i)t[e++]=s[i]}return e}function _i(t,e,i,n,r){r=r||[];let s=0;for(let o=0,a=i.length;o<a;++o){const a=mi(t,e,i[o],n);r[s++]=a,e=a}return r.length=s,r}function yi(t,e,i,n,r){r=r||[];let s=0;for(let o=0,a=i.length;o<a;++o){const a=_i(t,e,i[o],n,r[s]);0===a.length&&(a[0]=e),r[s++]=a,e=a[a.length-1]}return r.length=s,r}function wi(t,e,i,n,r,s,o){const a=(i-e)/n;if(a<3){for(;e<i;e+=n)s[o++]=t[e],s[o++]=t[e+1];return o}const l=new Array(a);l[0]=1,l[a-1]=1;const h=[e,i-n];let c=0;for(;h.length>0;){const i=h.pop(),s=h.pop();let o=0;const a=t[s],u=t[s+1],d=t[i],g=t[i+1];for(let e=s+n;e<i;e+=n){const i=J(t[e],t[e+1],a,u,d,g);i>o&&(c=e,o=i)}o>r&&(l[(c-e)/n]=1,s+n<c&&h.push(s,c),c+n<i&&h.push(c,i))}for(let i=0;i<a;++i)l[i]&&(s[o++]=t[e+i*n],s[o++]=t[e+i*n+1]);return o}function xi(t,e,i,n,r,s,o,a){for(let l=0,h=i.length;l<h;++l){const h=i[l];o=wi(t,e,h,n,r,s,o),a.push(o),e=h}return o}function bi(t,e){return e*Math.round(t/e)}function vi(t,e,i,n,r,s,o){if(e==i)return o;let a,l,h=bi(t[e],r),c=bi(t[e+1],r);e+=n,s[o++]=h,s[o++]=c;do{if(a=bi(t[e],r),l=bi(t[e+1],r),(e+=n)==i)return s[o++]=a,s[o++]=l,o}while(a==h&&l==c);for(;e<i;){const i=bi(t[e],r),u=bi(t[e+1],r);if(e+=n,i==a&&u==l)continue;const d=a-h,g=l-c,f=i-h,p=u-c;d*p==g*f&&(d<0&&f<d||d==f||d>0&&f>d)&&(g<0&&p<g||g==p||g>0&&p>g)?(a=i,l=u):(s[o++]=a,s[o++]=l,h=a,c=l,a=i,l=u)}return s[o++]=a,s[o++]=l,o}function Ei(t,e,i,n,r,s,o,a){for(let l=0,h=i.length;l<h;++l){const h=i[l];o=vi(t,e,h,n,r,s,o),a.push(o),e=h}return o}function Si(t,e,i,n,r){r=void 0!==r?r:[];let s=0;for(let o=e;o<i;o+=n)r[s++]=t.slice(o,o+n);return r.length=s,r}function Ii(t,e,i,n,r){r=void 0!==r?r:[];let s=0;for(let o=0,a=i.length;o<a;++o){const a=i[o];r[s++]=Si(t,e,a,n,r[s]),e=a}return r.length=s,r}function Mi(t,e,i,n,r){r=void 0!==r?r:[];let s=0;for(let o=0,a=i.length;o<a;++o){const a=i[o];r[s++]=1===a.length&&a[0]===e?[]:Ii(t,e,a,n,r[s]),e=a[a.length-1]}return r.length=s,r}function Ci(t,e,i,n){let r=0,s=t[i-n],o=t[i-n+1];for(;e<i;e+=n){const i=t[e],n=t[e+1];r+=o*i-s*n,s=i,o=n}return r/2}function Ti(t,e,i,n){let r=0;for(let s=0,o=i.length;s<o;++s){const o=i[s];r+=Ci(t,e,o,n),e=o}return r}class Ri extends ci{constructor(t,e){super(),this.maxDelta_=-1,this.maxDeltaRevision_=-1,void 0===e||Array.isArray(t[0])?this.setCoordinates(t,e):this.setFlatCoordinates(e,t)}clone(){return new Ri(this.flatCoordinates.slice(),this.layout)}closestPointXY(t,e,i,n){return n<Dt(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(di(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),fi(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,t,e,i,n))}getArea(){return Ci(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinates(){return Si(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getSimplifiedGeometryInternal(t){const e=[];return e.length=wi(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,0),new Ri(e,"XY")}getType(){return"LinearRing"}intersectsExtent(t){return!1}setCoordinates(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=mi(this.flatCoordinates,0,t,this.stride),this.changed()}}const Ai=Ri;class ki extends ci{constructor(t,e){super(),this.setCoordinates(t,e)}clone(){const t=new ki(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(t,e,i,n){const r=this.flatCoordinates,s=Q(t,e,r[0],r[1]);if(s<n){const t=this.stride;for(let e=0;e<t;++e)i[e]=r[e];return i.length=t,s}return n}getCoordinates(){return this.flatCoordinates.slice()}computeExtent(t){return Ut(this.flatCoordinates,t)}getType(){return"Point"}intersectsExtent(t){return zt(t,this.flatCoordinates[0],this.flatCoordinates[1])}setCoordinates(t,e){this.setLayout(e,t,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=function(t,e,i,n){for(let n=0,r=i.length;n<r;++n)t[e++]=i[n];return e}(this.flatCoordinates,0,t,this.stride),this.changed()}}const Pi=ki;function Li(t,e,i,n,r){return!Ht(r,(function(r){return!Ni(t,e,i,n,r[0],r[1])}))}function Ni(t,e,i,n,r,s){let o=0,a=t[i-n],l=t[i-n+1];for(;e<i;e+=n){const i=t[e],n=t[e+1];l<=s?n>s&&(i-a)*(s-l)-(r-a)*(n-l)>0&&o++:n<=s&&(i-a)*(s-l)-(r-a)*(n-l)<0&&o--,a=i,l=n}return 0!==o}function Di(t,e,i,n,r,s){if(0===i.length)return!1;if(!Ni(t,e,i[0],n,r,s))return!1;for(let e=1,o=i.length;e<o;++e)if(Ni(t,i[e-1],i[e],n,r,s))return!1;return!0}function Oi(t,e,i,n,r,s,o){let l,h,c,u,d,g,f;const p=r[s+1],m=[];for(let r=0,s=i.length;r<s;++r){const s=i[r];for(u=t[s-n],g=t[s-n+1],l=e;l<s;l+=n)d=t[l],f=t[l+1],(p<=g&&f<=p||g<=p&&p<=f)&&(c=(p-g)/(f-g)*(d-u)+u,m.push(c)),u=d,g=f}let _=NaN,y=-1/0;for(m.sort(a),u=m[0],l=1,h=m.length;l<h;++l){d=m[l];const r=Math.abs(d-u);r>y&&(c=(u+d)/2,Di(t,e,i,n,c,p)&&(_=c,y=r)),u=d}return isNaN(_)&&(_=r[s]),o?(o.push(_,p,y),o):[_,p,y]}function Fi(t,e,i,n,r){let s=[];for(let o=0,a=i.length;o<a;++o){const a=i[o];s=Oi(t,e,a,n,r,2*o,s),e=a[a.length-1]}return s}function zi(t,e,i,n,r){let s;for(e+=n;e<i;e+=n)if(s=r(t.slice(e-n,e),t.slice(e,e+n)),s)return s;return!1}function Bi(t,e,i,n,r){const s=Wt([1/0,1/0,-1/0,-1/0],t,e,i,n);return!!le(r,s)&&(!!Ft(r,s)||s[0]>=r[0]&&s[2]<=r[2]||s[1]>=r[1]&&s[3]<=r[3]||zi(t,e,i,n,(function(t,e){return function(t,e,i){let n=!1;const r=Bt(t,e),s=Bt(t,i);if(r===kt.INTERSECTING||s===kt.INTERSECTING)n=!0;else{const o=t[0],a=t[1],l=t[2],h=t[3],c=e[0],u=e[1],d=i[0],g=i[1],f=(g-u)/(d-c);let p,m;s&kt.ABOVE&&!(r&kt.ABOVE)&&(p=d-(g-h)/f,n=p>=o&&p<=l),n||!(s&kt.RIGHT)||r&kt.RIGHT||(m=g-(d-l)*f,n=m>=a&&m<=h),n||!(s&kt.BELOW)||r&kt.BELOW||(p=d-(g-a)/f,n=p>=o&&p<=l),n||!(s&kt.LEFT)||r&kt.LEFT||(m=g-(d-o)*f,n=m>=a&&m<=h)}return n}(r,t,e)})))}function Gi(t,e,i,n,r){return!!(Bi(t,e,i,n,r)||Ni(t,e,i,n,r[0],r[1])||Ni(t,e,i,n,r[0],r[3])||Ni(t,e,i,n,r[2],r[1])||Ni(t,e,i,n,r[2],r[3]))}function Yi(t,e,i,n,r){if(!Gi(t,e,i[0],n,r))return!1;if(1===i.length)return!0;for(let e=1,s=i.length;e<s;++e)if(Li(t,i[e-1],i[e],n,r)&&!Bi(t,i[e-1],i[e],n,r))return!1;return!0}function Ui(t,e,i,n){for(;e<i-n;){for(let r=0;r<n;++r){const s=t[e+r];t[e+r]=t[i-n+r],t[i-n+r]=s}e+=n,i-=n}}function Xi(t,e,i,n){let r=0,s=t[i-n],o=t[i-n+1];for(;e<i;e+=n){const i=t[e],n=t[e+1];r+=(i-s)*(n+o),s=i,o=n}return 0===r?void 0:r>0}function qi(t,e,i,n,r){r=void 0!==r&&r;for(let s=0,o=i.length;s<o;++s){const o=i[s],a=Xi(t,e,o,n);if(0===s){if(r&&a||!r&&!a)return!1}else if(r&&!a||!r&&a)return!1;e=o}return!0}function Vi(t,e,i,n,r){for(let s=0,o=i.length;s<o;++s){const o=i[s];if(!qi(t,e,o,n,r))return!1;o.length&&(e=o[o.length-1])}return!0}function ji(t,e,i,n,r){r=void 0!==r&&r;for(let s=0,o=i.length;s<o;++s){const o=i[s],a=Xi(t,e,o,n);(0===s?r&&a||!r&&!a:r&&!a||!r&&a)&&Ui(t,e,o,n),e=o}return e}function Wi(t,e,i,n,r){for(let s=0,o=i.length;s<o;++s)e=ji(t,e,i[s],n,r);return e}class Zi extends ci{constructor(t,e,i){super(),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,void 0!==e&&i?(this.setFlatCoordinates(e,t),this.ends_=i):this.setCoordinates(t,e)}appendLinearRing(t){this.flatCoordinates?c(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const t=new Zi(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return t.applyProperties(this),t}closestPointXY(t,e,i,n){return n<Dt(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(gi(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),pi(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,t,e,i,n))}containsXY(t,e){return Di(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,e)}getArea(){return Ti(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)}getCoordinates(t){let e;return void 0!==t?(e=this.getOrientedFlatCoordinates().slice(),ji(e,0,this.ends_,this.stride,t)):e=this.flatCoordinates,Ii(e,0,this.ends_,this.stride)}getEnds(){return this.ends_}getFlatInteriorPoint(){if(this.flatInteriorPointRevision_!=this.getRevision()){const t=Qt(this.getExtent());this.flatInteriorPoint_=Oi(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_}getInteriorPoint(){return new Pi(this.getFlatInteriorPoint(),"XYM")}getLinearRingCount(){return this.ends_.length}getLinearRing(t){return t<0||this.ends_.length<=t?null:new Ai(this.flatCoordinates.slice(0===t?0:this.ends_[t-1],this.ends_[t]),this.layout)}getLinearRings(){const t=this.layout,e=this.flatCoordinates,i=this.ends_,n=[];let r=0;for(let s=0,o=i.length;s<o;++s){const o=i[s],a=new Ai(e.slice(r,o),t);n.push(a),r=o}return n}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const t=this.flatCoordinates;qi(t,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=ji(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(t){const e=[],i=[];return e.length=Ei(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(t),e,0,i),new Zi(e,"XY",i)}getType(){return"Polygon"}intersectsExtent(t){return Yi(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);const i=_i(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=0===i.length?0:i[i.length-1],this.changed()}}const Hi=Zi;function Ki(t){if(he(t))throw new Error("Cannot create polygon from empty extent");const e=t[0],i=t[1],n=t[2],r=t[3],s=[e,i,e,r,n,r,n,i,e,i];return new Zi(s,"XY",[s.length])}function $i(t,e){setTimeout((function(){t(e)}),0)}function Ji(t){return!(t.sourceCenter&&t.targetCenter&&!de(t.sourceCenter,t.targetCenter))&&t.sourceResolution===t.targetResolution&&t.sourceRotation===t.targetRotation}function Qi(t,e,i,n,r){const s=Math.cos(-r);let o=Math.sin(-r),a=t[0]*s-t[1]*o,l=t[1]*s+t[0]*o;return a+=(e[0]/2-i[0])*n,l+=(i[1]-e[1]/2)*n,o=-o,[a*s-l*o,l*s+a*o]}const tn=class extends D{constructor(t){super(),this.on,this.once,this.un,t=Object.assign({},t),this.hints_=[0,0],this.animations_=[],this.updateAnimationKey_,this.projection_=Ce(t.projection,"EPSG:3857"),this.viewportSize_=[100,100],this.targetCenter_=null,this.targetResolution_,this.targetRotation_,this.nextCenter_=null,this.nextResolution_,this.nextRotation_,this.cancelAnchor_=void 0,t.projection&&function(t){xe=!(void 0===t||t)}(),t.center&&(t.center=De(t.center,this.projection_)),t.extent&&(t.extent=Fe(t.extent,this.projection_)),this.applyOptions_(t)}applyOptions_(t){const e=Object.assign({},t);for(const t in dt)delete e[t];this.setProperties(e,!0);const i=function(t){let e,i,n;let r=void 0!==t.minZoom?t.minZoom:0,s=void 0!==t.maxZoom?t.maxZoom:28;const o=void 0!==t.zoomFactor?t.zoomFactor:2,a=void 0!==t.multiWorld&&t.multiWorld,h=void 0===t.smoothResolutionConstraint||t.smoothResolutionConstraint,c=void 0!==t.showFullExtent&&t.showFullExtent,u=Ce(t.projection,"EPSG:3857"),d=u.getExtent();let g=t.constrainOnlyCenter,f=t.extent;if(a||f||!u.isGlobal()||(g=!1,f=d),void 0!==t.resolutions){const o=t.resolutions;i=o[r],n=void 0!==o[s]?o[s]:o[o.length-1],e=t.constrainResolution?function(t,e,i,n){return e=void 0===e||e,function(r,s,o,a){if(void 0!==r){const h=t[0],c=t[t.length-1],u=i?qe(h,i,o,n):h;if(a)return e?Ve(r,u,c):$(r,c,u);const d=Math.min(u,r),g=Math.floor(l(t,d,s));return t[g]>u&&g<t.length-1?t[g+1]:t[g]}}}(o,h,!g&&f,c):je(i,n,h,!g&&f,c)}else{const a=(d?Math.max(ae(d),ne(d)):360*pt.degrees/u.getMetersPerUnit())/ft/Math.pow(2,0),l=a/Math.pow(2,28);i=t.maxResolution,void 0!==i?r=0:i=a/Math.pow(o,r),n=t.minResolution,void 0===n&&(n=void 0!==t.maxZoom?void 0!==t.maxResolution?i/Math.pow(o,s):a/Math.pow(o,s):l),s=r+Math.floor(Math.log(i/n)/Math.log(o)),n=i/Math.pow(o,s-r),e=t.constrainResolution?function(t,e,i,n,r,s){return n=void 0===n||n,i=void 0!==i?i:0,function(o,a,l,h){if(void 0!==o){const c=r?qe(e,r,l,s):e;if(h)return n?Ve(o,c,i):$(o,i,c);const u=1e-9,d=Math.ceil(Math.log(e/c)/Math.log(t)-u),g=-a*(.5-u)+.5,f=Math.min(c,o),p=Math.floor(Math.log(e/f)/Math.log(t)+g),m=Math.max(d,p);return $(e/Math.pow(t,m),i,c)}}}(o,i,n,h,!g&&f,c):je(i,n,h,!g&&f,c)}return{constraint:e,maxResolution:i,minResolution:n,minZoom:r,zoomFactor:o}}(t);this.maxResolution_=i.maxResolution,this.minResolution_=i.minResolution,this.zoomFactor_=i.zoomFactor,this.resolutions_=t.resolutions,this.padding_=t.padding,this.minZoom_=i.minZoom;const n=function(t){if(void 0!==t.extent){const e=void 0===t.smoothExtentConstraint||t.smoothExtentConstraint;return Ue(t.extent,t.constrainOnlyCenter,e)}const e=Ce(t.projection,"EPSG:3857");if(!0!==t.multiWorld&&e.isGlobal()){const t=e.getExtent().slice();return t[0]=-1/0,t[2]=1/0,Ue(t,!1,!1)}return Xe}(t),r=i.constraint,s=function(t){if(void 0===t.enableRotation||t.enableRotation){const e=t.constrainRotation;return void 0===e||!0===e?function(t){const e=tt(5);return function(t,i){return i||void 0===t?t:Math.abs(t)<=e?0:t}}():!1===e?Ze:"number"==typeof e?function(t){const e=2*Math.PI/t;return function(t,i){return i?t:void 0!==t?t=Math.floor(t/e+.5)*e:void 0}}(e):Ze}return We}(t);this.constraints_={center:n,resolution:r,rotation:s},this.setRotation(void 0!==t.rotation?t.rotation:0),this.setCenterInternal(void 0!==t.center?t.center:null),void 0!==t.resolution?this.setResolution(t.resolution):void 0!==t.zoom&&this.setZoom(t.zoom)}get padding(){return this.padding_}set padding(t){let e=this.padding_;this.padding_=t;const i=this.getCenterInternal();if(i){const n=t||[0,0,0,0];e=e||[0,0,0,0];const r=this.getResolution(),s=r/2*(n[3]-e[3]+e[1]-n[1]),o=r/2*(n[0]-e[0]+e[2]-n[2]);this.setCenterInternal([i[0]+s,i[1]-o])}}getUpdatedOptions_(t){const e=this.getProperties();return void 0!==e.resolution?e.resolution=this.getResolution():e.zoom=this.getZoom(),e.center=this.getCenterInternal(),e.rotation=this.getRotation(),Object.assign({},e,t)}animate(t){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);const e=new Array(arguments.length);for(let t=0;t<e.length;++t){let i=arguments[t];i.center&&(i=Object.assign({},i),i.center=De(i.center,this.getProjection())),i.anchor&&(i=Object.assign({},i),i.anchor=De(i.anchor,this.getProjection())),e[t]=i}this.animateInternal.apply(this,e)}animateInternal(t){let e,i=arguments.length;i>1&&"function"==typeof arguments[i-1]&&(e=arguments[i-1],--i);let n=0;for(;n<i&&!this.isDef();++n){const t=arguments[n];t.center&&this.setCenterInternal(t.center),void 0!==t.zoom?this.setZoom(t.zoom):t.resolution&&this.setResolution(t.resolution),void 0!==t.rotation&&this.setRotation(t.rotation)}if(n===i)return void(e&&$i(e,!0));let r=Date.now(),s=this.targetCenter_.slice(),o=this.targetResolution_,a=this.targetRotation_;const l=[];for(;n<i;++n){const t=arguments[n],i={start:r,complete:!1,anchor:t.anchor,duration:void 0!==t.duration?t.duration:1e3,easing:t.easing||$e,callback:e};if(t.center&&(i.sourceCenter=s,i.targetCenter=t.center.slice(),s=i.targetCenter),void 0!==t.zoom?(i.sourceResolution=o,i.targetResolution=this.getResolutionForZoom(t.zoom),o=i.targetResolution):t.resolution&&(i.sourceResolution=o,i.targetResolution=t.resolution,o=i.targetResolution),void 0!==t.rotation){i.sourceRotation=a;const e=et(t.rotation-a+Math.PI,2*Math.PI)-Math.PI;i.targetRotation=a+e,a=i.targetRotation}Ji(i)?i.complete=!0:r+=i.duration,l.push(i)}this.animations_.push(l),this.setHint(0,1),this.updateAnimations_()}getAnimating(){return this.hints_[0]>0}getInteracting(){return this.hints_[1]>0}cancelAnimations(){let t;this.setHint(0,-this.hints_[0]);for(let e=0,i=this.animations_.length;e<i;++e){const i=this.animations_[e];if(i[0].callback&&$i(i[0].callback,!1),!t)for(let e=0,n=i.length;e<n;++e){const n=i[e];if(!n.complete){t=n.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=t,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN}updateAnimations_(){if(void 0!==this.updateAnimationKey_&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),!this.getAnimating())return;const t=Date.now();let e=!1;for(let i=this.animations_.length-1;i>=0;--i){const n=this.animations_[i];let r=!0;for(let i=0,s=n.length;i<s;++i){const s=n[i];if(s.complete)continue;const o=t-s.start;let a=s.duration>0?o/s.duration:1;a>=1?(s.complete=!0,a=1):r=!1;const l=s.easing(a);if(s.sourceCenter){const t=s.sourceCenter[0],e=s.sourceCenter[1],i=s.targetCenter[0],n=s.targetCenter[1];this.nextCenter_=s.targetCenter;const r=t+l*(i-t),o=e+l*(n-e);this.targetCenter_=[r,o]}if(s.sourceResolution&&s.targetResolution){const t=1===l?s.targetResolution:s.sourceResolution+l*(s.targetResolution-s.sourceResolution);if(s.anchor){const e=this.getViewportSize_(this.getRotation()),i=this.constraints_.resolution(t,0,e,!0);this.targetCenter_=this.calculateCenterZoom(i,s.anchor)}this.nextResolution_=s.targetResolution,this.targetResolution_=t,this.applyTargetState_(!0)}if(void 0!==s.sourceRotation&&void 0!==s.targetRotation){const t=1===l?et(s.targetRotation+Math.PI,2*Math.PI)-Math.PI:s.sourceRotation+l*(s.targetRotation-s.sourceRotation);if(s.anchor){const e=this.constraints_.rotation(t,!0);this.targetCenter_=this.calculateCenterRotate(e,s.anchor)}this.nextRotation_=s.targetRotation,this.targetRotation_=t}if(this.applyTargetState_(!0),e=!0,!s.complete)break}if(r){this.animations_[i]=null,this.setHint(0,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;const t=n[0].callback;t&&$i(t,!0)}}this.animations_=this.animations_.filter(Boolean),e&&void 0===this.updateAnimationKey_&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}calculateCenterRotate(t,e){let i;const n=this.getCenterInternal();var r,s;return void 0!==n&&(i=[n[0]-e[0],n[1]-e[1]],ge(i,t-this.getRotation()),s=e,(r=i)[0]+=+s[0],r[1]+=+s[1]),i}calculateCenterZoom(t,e){let i;const n=this.getCenterInternal(),r=this.getResolution();return void 0!==n&&void 0!==r&&(i=[e[0]-t*(e[0]-n[0])/r,e[1]-t*(e[1]-n[1])/r]),i}getViewportSize_(t){const e=this.viewportSize_;if(t){const i=e[0],n=e[1];return[Math.abs(i*Math.cos(t))+Math.abs(n*Math.sin(t)),Math.abs(i*Math.sin(t))+Math.abs(n*Math.cos(t))]}return e}setViewportSize(t){this.viewportSize_=Array.isArray(t)?t.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)}getCenter(){const t=this.getCenterInternal();return t?Ne(t,this.getProjection()):t}getCenterInternal(){return this.get(dt.CENTER)}getConstraints(){return this.constraints_}getConstrainResolution(){return this.get("constrainResolution")}getHints(t){return void 0!==t?(t[0]=this.hints_[0],t[1]=this.hints_[1],t):this.hints_.slice()}calculateExtent(t){return Oe(this.calculateExtentInternal(t),this.getProjection())}calculateExtentInternal(t){t=t||this.getViewportSizeMinusPadding_();const e=this.getCenterInternal();K(e,"The view center is not defined");const i=this.getResolution();K(void 0!==i,"The view resolution is not defined");const n=this.getRotation();return K(void 0!==n,"The view rotation is not defined"),ee(e,i,n,t)}getMaxResolution(){return this.maxResolution_}getMinResolution(){return this.minResolution_}getMaxZoom(){return this.getZoomForResolution(this.minResolution_)}setMaxZoom(t){this.applyOptions_(this.getUpdatedOptions_({maxZoom:t}))}getMinZoom(){return this.getZoomForResolution(this.maxResolution_)}setMinZoom(t){this.applyOptions_(this.getUpdatedOptions_({minZoom:t}))}setConstrainResolution(t){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:t}))}getProjection(){return this.projection_}getResolution(){return this.get(dt.RESOLUTION)}getResolutions(){return this.resolutions_}getResolutionForExtent(t,e){return this.getResolutionForExtentInternal(Fe(t,this.getProjection()),e)}getResolutionForExtentInternal(t,e){e=e||this.getViewportSizeMinusPadding_();const i=ae(t)/e[0],n=ne(t)/e[1];return Math.max(i,n)}getResolutionForValueFunction(t){t=t||2;const e=this.getConstrainedResolution(this.maxResolution_),i=this.minResolution_,n=Math.log(e/i)/Math.log(t);return function(i){return e/Math.pow(t,i*n)}}getRotation(){return this.get(dt.ROTATION)}getValueForResolutionFunction(t){const e=Math.log(t||2),i=this.getConstrainedResolution(this.maxResolution_),n=this.minResolution_,r=Math.log(i/n)/e;return function(t){return Math.log(i/t)/e/r}}getViewportSizeMinusPadding_(t){let e=this.getViewportSize_(t);const i=this.padding_;return i&&(e=[e[0]-i[1]-i[3],e[1]-i[0]-i[2]]),e}getState(){const t=this.getProjection(),e=this.getResolution(),i=this.getRotation();let n=this.getCenterInternal();const r=this.padding_;if(r){const t=this.getViewportSizeMinusPadding_();n=Qi(n,this.getViewportSize_(),[t[0]/2+r[3],t[1]/2+r[0]],e,i)}return{center:n.slice(0),projection:void 0!==t?t:null,resolution:e,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:i,zoom:this.getZoom()}}getViewStateAndExtent(){return{viewState:this.getState(),extent:this.calculateExtent()}}getZoom(){let t;const e=this.getResolution();return void 0!==e&&(t=this.getZoomForResolution(e)),t}getZoomForResolution(t){let e,i,n=this.minZoom_||0;if(this.resolutions_){const r=l(this.resolutions_,t,1);n=r,e=this.resolutions_[r],i=r==this.resolutions_.length-1?2:e/this.resolutions_[r+1]}else e=this.maxResolution_,i=this.zoomFactor_;return n+Math.log(e/t)/Math.log(i)}getResolutionForZoom(t){if(this.resolutions_){if(this.resolutions_.length<=1)return 0;const e=$(Math.floor(t),0,this.resolutions_.length-2),i=this.resolutions_[e]/this.resolutions_[e+1];return this.resolutions_[e]/Math.pow(i,$(t-e,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,t-this.minZoom_)}fit(t,e){let i;if(K(Array.isArray(t)||"function"==typeof t.getSimplifiedGeometry,"Invalid extent or geometry provided as `geometry`"),Array.isArray(t))K(!he(t),"Cannot fit empty extent provided as `geometry`"),i=Ki(Fe(t,this.getProjection()));else if("Circle"===t.getType()){const e=Fe(t.getExtent(),this.getProjection());i=Ki(e),i.rotate(this.getRotation(),Qt(e))}else{const e=Le();i=e?t.clone().transform(e,this.getProjection()):t}this.fitInternal(i,e)}rotatedExtentForGeometry(t){const e=this.getRotation(),i=Math.cos(e),n=Math.sin(-e),r=t.getFlatCoordinates(),s=t.getStride();let o=1/0,a=1/0,l=-1/0,h=-1/0;for(let t=0,e=r.length;t<e;t+=s){const e=r[t]*i-r[t+1]*n,s=r[t]*n+r[t+1]*i;o=Math.min(o,e),a=Math.min(a,s),l=Math.max(l,e),h=Math.max(h,s)}return[o,a,l,h]}fitInternal(t,e){let i=(e=e||{}).size;i||(i=this.getViewportSizeMinusPadding_());const n=void 0!==e.padding?e.padding:[0,0,0,0],r=void 0!==e.nearest&&e.nearest;let s;s=void 0!==e.minResolution?e.minResolution:void 0!==e.maxZoom?this.getResolutionForZoom(e.maxZoom):0;const o=this.rotatedExtentForGeometry(t);let a=this.getResolutionForExtentInternal(o,[i[0]-n[1]-n[3],i[1]-n[0]-n[2]]);a=isNaN(a)?s:Math.max(a,s),a=this.getConstrainedResolution(a,r?0:1);const l=this.getRotation(),h=Math.sin(l),c=Math.cos(l),u=Qt(o);u[0]+=(n[1]-n[3])/2*a,u[1]+=(n[0]-n[2])/2*a;const d=u[0]*c-u[1]*h,g=u[1]*c+u[0]*h,p=this.getConstrainedCenter([d,g],a),m=e.callback?e.callback:f;void 0!==e.duration?this.animateInternal({resolution:a,center:p,duration:e.duration,easing:e.easing},m):(this.targetResolution_=a,this.targetCenter_=p,this.applyTargetState_(!1,!0),$i(m,!0))}centerOn(t,e,i){this.centerOnInternal(De(t,this.getProjection()),e,i)}centerOnInternal(t,e,i){this.setCenterInternal(Qi(t,e,i,this.getResolution(),this.getRotation()))}calculateCenterShift(t,e,i,n){let r;const s=this.padding_;if(s&&t){const o=this.getViewportSizeMinusPadding_(-i),a=Qi(t,n,[o[0]/2+s[3],o[1]/2+s[0]],e,i);r=[t[0]-a[0],t[1]-a[1]]}return r}isDef(){return!!this.getCenterInternal()&&void 0!==this.getResolution()}adjustCenter(t){const e=Ne(this.targetCenter_,this.getProjection());this.setCenter([e[0]+t[0],e[1]+t[1]])}adjustCenterInternal(t){const e=this.targetCenter_;this.setCenterInternal([e[0]+t[0],e[1]+t[1]])}adjustResolution(t,e){e=e&&De(e,this.getProjection()),this.adjustResolutionInternal(t,e)}adjustResolutionInternal(t,e){const i=this.getAnimating()||this.getInteracting(),n=this.getViewportSize_(this.getRotation()),r=this.constraints_.resolution(this.targetResolution_*t,0,n,i);e&&(this.targetCenter_=this.calculateCenterZoom(r,e)),this.targetResolution_*=t,this.applyTargetState_()}adjustZoom(t,e){this.adjustResolution(Math.pow(this.zoomFactor_,-t),e)}adjustRotation(t,e){e&&(e=De(e,this.getProjection())),this.adjustRotationInternal(t,e)}adjustRotationInternal(t,e){const i=this.getAnimating()||this.getInteracting(),n=this.constraints_.rotation(this.targetRotation_+t,i);e&&(this.targetCenter_=this.calculateCenterRotate(n,e)),this.targetRotation_+=t,this.applyTargetState_()}setCenter(t){this.setCenterInternal(t?De(t,this.getProjection()):t)}setCenterInternal(t){this.targetCenter_=t,this.applyTargetState_()}setHint(t,e){return this.hints_[t]+=e,this.changed(),this.hints_[t]}setResolution(t){this.targetResolution_=t,this.applyTargetState_()}setRotation(t){this.targetRotation_=t,this.applyTargetState_()}setZoom(t){this.setResolution(this.getResolutionForZoom(t))}applyTargetState_(t,e){const i=this.getAnimating()||this.getInteracting()||e,n=this.constraints_.rotation(this.targetRotation_,i),r=this.getViewportSize_(n),s=this.constraints_.resolution(this.targetResolution_,0,r,i),o=this.constraints_.center(this.targetCenter_,s,r,i,this.calculateCenterShift(this.targetCenter_,s,n,r));this.get(dt.ROTATION)!==n&&this.set(dt.ROTATION,n),this.get(dt.RESOLUTION)!==s&&(this.set(dt.RESOLUTION,s),this.set("zoom",this.getZoom(),!0)),o&&this.get(dt.CENTER)&&de(this.get(dt.CENTER),o)||this.set(dt.CENTER,o),this.getAnimating()&&!t&&this.cancelAnimations(),this.cancelAnchor_=void 0}resolveConstraints(t,e,i){t=void 0!==t?t:200;const n=e||0,r=this.constraints_.rotation(this.targetRotation_),s=this.getViewportSize_(r),o=this.constraints_.resolution(this.targetResolution_,n,s),a=this.constraints_.center(this.targetCenter_,o,s,!1,this.calculateCenterShift(this.targetCenter_,o,r,s));if(0===t&&!this.cancelAnchor_)return this.targetResolution_=o,this.targetRotation_=r,this.targetCenter_=a,void this.applyTargetState_();i=i||(0===t?this.cancelAnchor_:void 0),this.cancelAnchor_=void 0,this.getResolution()===o&&this.getRotation()===r&&this.getCenterInternal()&&de(this.getCenterInternal(),a)||(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:r,center:a,resolution:o,duration:t,easing:Ke,anchor:i}))}beginInteraction(){this.resolveConstraints(0),this.setHint(1,1)}endInteraction(t,e,i){i=i&&De(i,this.getProjection()),this.endInteractionInternal(t,e,i)}endInteractionInternal(t,e,i){this.getInteracting()&&(this.setHint(1,-1),this.resolveConstraints(t,e,i))}getConstrainedCenter(t,e){const i=this.getViewportSize_(this.getRotation());return this.constraints_.center(t,e||this.getResolution(),i)}getConstrainedZoom(t,e){const i=this.getResolutionForZoom(t);return this.getZoomForResolution(this.getConstrainedResolution(i,e))}getConstrainedResolution(t,e){e=e||0;const i=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(t,e,i)}};function en(t,e){if(!t.visible)return!1;const i=e.resolution;if(i<t.minResolution||i>=t.maxResolution)return!1;const n=e.zoom;return n>t.minZoom&&n<=t.maxZoom}const nn=class extends at{constructor(t){const e=Object.assign({},t);delete e.source,super(e),this.on,this.once,this.un,this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,this.renderer_=null,this.sourceReady_=!1,this.rendered=!1,t.render&&(this.render=t.render),t.map&&this.setMap(t.map),this.addChangeListener(H,this.handleSourcePropertyChange_);const i=t.source?t.source:null;this.setSource(i)}getLayersArray(t){return(t=t||[]).push(this),t}getLayerStatesArray(t){return(t=t||[]).push(this.getLayerState()),t}getSource(){return this.get(H)||null}getRenderSource(){return this.getSource()}getSourceState(){const t=this.getSource();return t?t.getState():"undefined"}handleSourceChange_(){this.changed(),this.sourceReady_||"ready"!==this.getSource().getState()||(this.sourceReady_=!0,this.dispatchEvent("sourceready"))}handleSourcePropertyChange_(){this.sourceChangeKey_&&(T(this.sourceChangeKey_),this.sourceChangeKey_=null),this.sourceReady_=!1;const t=this.getSource();t&&(this.sourceChangeKey_=M(t,w,this.handleSourceChange_,this),"ready"===t.getState()&&(this.sourceReady_=!0,setTimeout((()=>{this.dispatchEvent("sourceready")}),0))),this.changed()}getFeatures(t){return this.renderer_?this.renderer_.getFeatures(t):Promise.resolve([])}getData(t){return this.renderer_&&this.rendered?this.renderer_.getData(t):null}isVisible(t){let e;const i=this.getMapInternal();let n;!t&&i&&(t=i.getView()),e=t instanceof tn?{viewState:t.getState(),extent:t.calculateExtent()}:t,!e.layerStatesArray&&i&&(e.layerStatesArray=i.getLayerGroup().getLayerStatesArray()),n=e.layerStatesArray?e.layerStatesArray.find((t=>t.layer===this)):this.getLayerState();const r=this.getExtent();return en(n,e.viewState)&&(!r||le(r,e.extent))}getAttributions(t){if(!this.isVisible(t))return[];let e;const i=this.getSource();if(i&&(e=i.getAttributions()),!e)return[];let n=e(t instanceof tn?t.getViewStateAndExtent():t);return Array.isArray(n)||(n=[n]),n}render(t,e){const i=this.getRenderer();return i.prepareFrame(t)?(this.rendered=!0,i.renderFrame(t,e)):null}unrender(){this.rendered=!1}getDeclutter(){}renderDeclutter(t,e){}renderDeferred(t){const e=this.getRenderer();e&&e.renderDeferred(t)}setMapInternal(t){t||this.unrender(),this.set("map",t)}getMapInternal(){return this.get("map")}setMap(t){this.mapPrecomposeKey_&&(T(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),t||this.changed(),this.mapRenderKey_&&(T(this.mapRenderKey_),this.mapRenderKey_=null),t&&(this.mapPrecomposeKey_=M(t,ct,(function(t){const e=t.frameState.layerStatesArray,i=this.getLayerState(!1);K(!e.some((function(t){return t.layer===i.layer})),"A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both."),e.push(i)}),this),this.mapRenderKey_=M(this,w,t.render,t),this.changed())}setSource(t){this.set(H,t)}getRenderer(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_}hasRenderer(){return!!this.renderer_}createRenderer(){return null}disposeInternal(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_),this.setSource(null),super.disposeInternal()}};var rn=__webpack_require__(2582);const sn=0,on=1,an=2,ln=3;function hn(t){return t[0]>0&&t[1]>0}function cn(t,e,i){return void 0===i&&(i=[0,0]),i[0]=t[0]*e+.5|0,i[1]=t[1]*e+.5|0,i}function un(t,e){return Array.isArray(t)?t:(void 0===e?e=[t,t]:(e[0]=t,e[1]=t),e)}class dn{constructor(t){this.opacity_=t.opacity,this.rotateWithView_=t.rotateWithView,this.rotation_=t.rotation,this.scale_=t.scale,this.scaleArray_=un(t.scale),this.displacement_=t.displacement,this.declutterMode_=t.declutterMode}clone(){const t=this.getScale();return new dn({opacity:this.getOpacity(),scale:Array.isArray(t)?t.slice():t,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getOpacity(){return this.opacity_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getDisplacement(){return this.displacement_}getDeclutterMode(){return this.declutterMode_}getAnchor(){return k()}getImage(t){return k()}getHitDetectionImage(){return k()}getPixelRatio(t){return 1}getImageState(){return k()}getImageSize(){return k()}getOrigin(){return k()}getSize(){return k()}setDisplacement(t){this.displacement_=t}setOpacity(t){this.opacity_=t}setRotateWithView(t){this.rotateWithView_=t}setRotation(t){this.rotation_=t}setScale(t){this.scale_=t,this.scaleArray_=un(t)}listenImageChange(t){k()}load(){k()}unlistenImageChange(t){k()}ready(){return Promise.resolve()}}const gn=dn,fn={name:"rgb",min:[0,0,0],max:[255,255,255],channel:["red","green","blue"],alias:["RGB"]};var pn={name:"xyz",min:[0,0,0],channel:["X","Y","Z"],alias:["XYZ","ciexyz","cie1931"],whitepoint:{2:{A:[109.85,100,35.585],C:[98.074,100,118.232],D50:[96.422,100,82.521],D55:[95.682,100,92.149],D65:[95.045592705167,100,108.9057750759878],D75:[94.972,100,122.638],F2:[99.187,100,67.395],F7:[95.044,100,108.755],F11:[100.966,100,64.37],E:[100,100,100]},10:{A:[111.144,100,35.2],C:[97.285,100,116.145],D50:[96.72,100,81.427],D55:[95.799,100,90.926],D65:[94.811,100,107.304],D75:[94.416,100,120.641],F2:[103.28,100,69.026],F7:[95.792,100,107.687],F11:[103.866,100,65.627],E:[100,100,100]}}};pn.max=pn.whitepoint[2].D65,pn.rgb=function(t,e){e=e||pn.whitepoint[2].E;var i,n,r,s=t[0]/e[0],o=t[1]/e[1],a=t[2]/e[2];return n=-.96924363628087*s+1.87596750150772*o+.041555057407175*a,r=.055630079696993*s+-.20397695888897*o+1.056971514242878*a,i=(i=3.240969941904521*s+-1.537383177570093*o+-.498610760293*a)>.0031308?1.055*Math.pow(i,1/2.4)-.055:i*=12.92,n=n>.0031308?1.055*Math.pow(n,1/2.4)-.055:n*=12.92,r=r>.0031308?1.055*Math.pow(r,1/2.4)-.055:r*=12.92,[255*(i=Math.min(Math.max(0,i),1)),255*(n=Math.min(Math.max(0,n),1)),255*(r=Math.min(Math.max(0,r),1))]},fn.xyz=function(t,e){var i=t[0]/255,n=t[1]/255,r=t[2]/255,s=.21263900587151*(i=i>.04045?Math.pow((i+.055)/1.055,2.4):i/12.92)+.71516867876775*(n=n>.04045?Math.pow((n+.055)/1.055,2.4):n/12.92)+.072192315360733*(r=r>.04045?Math.pow((r+.055)/1.055,2.4):r/12.92),o=.019330818715591*i+.11919477979462*n+.95053215224966*r;return[(.41239079926595*i+.35758433938387*n+.18048078840183*r)*(e=e||pn.whitepoint[2].E)[0],s*e[1],o*e[2]]};const mn=pn,_n={name:"luv",min:[0,-134,-140],max:[100,224,122],channel:["lightness","u","v"],alias:["LUV","cieluv","cie1976"],xyz:function(t,e,i){var n,r,s,o,a,l,h,c,u;return s=t[0],o=t[1],a=t[2],0===s?[0,0,0]:(e=e||"D65",i=i||2,n=o/(13*s)+4*(h=mn.whitepoint[i][e][0])/(h+15*(c=mn.whitepoint[i][e][1])+3*(u=mn.whitepoint[i][e][2]))||0,r=a/(13*s)+9*c/(h+15*c+3*u)||0,[9*(l=s>8?c*Math.pow((s+16)/116,3):c*s*.0011070564598794539)*n/(4*r)||0,l,l*(12-3*n-20*r)/(4*r)||0])}};mn.luv=function(t,e,i){var n,r,s,o,a,l,h,c,u,d,g;e=e||"D65",i=i||2,d=4*(h=mn.whitepoint[i][e][0])/(h+15*(c=mn.whitepoint[i][e][1])+3*(u=mn.whitepoint[i][e][2])),g=9*c/(h+15*c+3*u),n=4*(o=t[0])/(o+15*(a=t[1])+3*(l=t[2]))||0,r=9*a/(o+15*a+3*l)||0;var f=a/c;return[s=f<=.008856451679035631?903.2962962962961*f:116*Math.pow(f,1/3)-16,13*s*(n-d),13*s*(r-g)]};var yn={name:"lchuv",channel:["lightness","chroma","hue"],alias:["LCHuv","cielchuv"],min:[0,0,0],max:[100,100,360],luv:function(t){var e,i=t[0],n=t[1];return e=t[2]/360*2*Math.PI,[i,n*Math.cos(e),n*Math.sin(e)]},xyz:function(t){return _n.xyz(yn.luv(t))}};const wn=yn;_n.lchuv=function(t){var e=t[0],i=t[1],n=t[2],r=Math.sqrt(i*i+n*n),s=360*Math.atan2(n,i)/2/Math.PI;return s<0&&(s+=360),[e,r,s]},mn.lchuv=function(t){return _n.lchuv(mn.luv(t))};var xn=__webpack_require__(8874);const bn=function(t){var e,i,n=[],r=1;if("number"==typeof t)return{space:"rgb",values:[t>>>16,(65280&t)>>>8,255&t],alpha:1};if("number"==typeof t)return{space:"rgb",values:[t>>>16,(65280&t)>>>8,255&t],alpha:1};if(t=String(t).toLowerCase(),xn[t])n=xn[t].slice(),i="rgb";else if("transparent"===t)r=0,i="rgb",n=[0,0,0];else if("#"===t[0]){var s=t.slice(1),o=s.length;r=1,o<=4?(n=[parseInt(s[0]+s[0],16),parseInt(s[1]+s[1],16),parseInt(s[2]+s[2],16)],4===o&&(r=parseInt(s[3]+s[3],16)/255)):(n=[parseInt(s[0]+s[1],16),parseInt(s[2]+s[3],16),parseInt(s[4]+s[5],16)],8===o&&(r=parseInt(s[6]+s[7],16)/255)),n[0]||(n[0]=0),n[1]||(n[1]=0),n[2]||(n[2]=0),i="rgb"}else if(e=/^((?:rgba?|hs[lvb]a?|hwba?|cmyk?|xy[zy]|gray|lab|lchu?v?|[ly]uv|lms|oklch|oklab|color))\s*\(([^\)]*)\)/.exec(t)){var a=e[1],l="cmyk"===(i=a.replace(/a$/,""))?4:"gray"===i?1:3;n=e[2].trim().split(/\s*[,\/]\s*|\s+/),"color"===i&&(i=n.shift()),r=(n=n.map((function(t,e){if("%"===t[t.length-1])return t=parseFloat(t)/100,3===e?t:"rgb"===i?255*t:"h"===i[0]?100*t:"l"!==i[0]||e?"lab"===i?125*t:"lch"===i?e<2?150*t:360*t:"o"!==i[0]||e?"oklab"===i?.4*t:"oklch"===i?e<2?.4*t:360*t:t:t:100*t;if("h"===i[e]||2===e&&"h"===i[i.length-1]){if(void 0!==vn[t])return vn[t];if(t.endsWith("deg"))return parseFloat(t);if(t.endsWith("turn"))return 360*parseFloat(t);if(t.endsWith("grad"))return 360*parseFloat(t)/400;if(t.endsWith("rad"))return 180*parseFloat(t)/Math.PI}return"none"===t?0:parseFloat(t)}))).length>l?n.pop():1}else/[0-9](?:\s|\/|,)/.test(t)&&(n=t.match(/([0-9]+)/g).map((function(t){return parseFloat(t)})),i=t.match(/([a-z])/gi)?.join("")?.toLowerCase()||"rgb");return{space:i,values:n,alpha:r}};var vn={red:0,orange:60,yellow:120,green:180,blue:240,purple:300};const En={name:"hsl",min:[0,0,0],max:[360,100,100],channel:["hue","saturation","lightness"],alias:["HSL"],rgb:function(t){var e,i,n,r,s,o=t[0]/360,a=t[1]/100,l=t[2]/100,h=0;if(0===a)return[s=255*l,s,s];for(e=2*l-(i=l<.5?l*(1+a):l+a-l*a),r=[0,0,0];h<3;)(n=o+1/3*-(h-1))<0?n++:n>1&&n--,s=6*n<1?e+6*(i-e)*n:2*n<1?i:3*n<2?e+(i-e)*(2/3-n)*6:e,r[h++]=255*s;return r}};fn.hsl=function(t){var e,i,n=t[0]/255,r=t[1]/255,s=t[2]/255,o=Math.min(n,r,s),a=Math.max(n,r,s),l=a-o;return a===o?e=0:n===a?e=(r-s)/l:r===a?e=2+(s-n)/l:s===a&&(e=4+(n-r)/l),(e=Math.min(60*e,360))<0&&(e+=360),i=(o+a)/2,[e,100*(a===o?0:i<=.5?l/(a+o):l/(2-a-o)),100*i]};const Sn=1024,In={};let Mn=0;function Cn(t){if(4===t.length)return t;const e=t.slice();return e[3]=1,e}function Tn(t){const e=mn.lchuv(fn.xyz(t));return e[3]=t[3],e}function Rn(t){if(In.hasOwnProperty(t))return In[t];if(Mn>=Sn){let t=0;for(const e in In)0==(3&t++)&&(delete In[e],--Mn)}const e=function(t){var e;Array.isArray(t)&&t.raw&&(t=String.raw(...arguments)),t instanceof Number&&(t=+t);var i=bn(t);if(!i.space)return[];const n="h"===i.space[0]?En.min:fn.min,r="h"===i.space[0]?En.max:fn.max;return(e=Array(3))[0]=Math.min(Math.max(i.values[0],n[0]),r[0]),e[1]=Math.min(Math.max(i.values[1],n[1]),r[1]),e[2]=Math.min(Math.max(i.values[2],n[2]),r[2]),"h"===i.space[0]&&(e=En.rgb(e)),e.push(Math.min(Math.max(i.alpha,0),1)),e}(t);if(4!==e.length)throw new Error('Failed to parse "'+t+'" as color');for(const i of e)if(isNaN(i))throw new Error('Failed to parse "'+t+'" as color');return kn(e),In[t]=e,++Mn,e}function An(t){return Array.isArray(t)?t:Rn(t)}function kn(t){return t[0]=$(t[0]+.5|0,0,255),t[1]=$(t[1]+.5|0,0,255),t[2]=$(t[2]+.5|0,0,255),t[3]=$(t[3],0,1),t}function Pn(t){let e=t[0];e!=(0|e)&&(e=e+.5|0);let i=t[1];i!=(0|i)&&(i=i+.5|0);let n=t[2];return n!=(0|n)&&(n=n+.5|0),"rgba("+e+","+i+","+n+","+(void 0===t[3]?1:Math.round(1e3*t[3])/1e3)+")"}const Ln="undefined"!=typeof navigator&&void 0!==navigator.userAgent?navigator.userAgent.toLowerCase():"",Nn=Ln.includes("firefox"),Dn=(Ln.includes("safari")&&!Ln.includes("chrom")&&(Ln.includes("version/15.4")||/cpu (os|iphone os) 15_4 like mac os x/.test(Ln)),Ln.includes("webkit")&&!Ln.includes("edge")),On=Ln.includes("macintosh"),Fn="undefined"!=typeof devicePixelRatio?devicePixelRatio:1,zn="undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof OffscreenCanvas&&self instanceof WorkerGlobalScope,Bn="undefined"!=typeof Image&&Image.prototype.decode,Gn=function(){let t=!1;try{const e=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("_",null,e),window.removeEventListener("_",null,e)}catch(t){}return t}();function Yn(t,e,i,n){let r;return r=i&&i.length?i.shift():zn?new OffscreenCanvas(t||300,e||300):document.createElement("canvas"),t&&(r.width=t),e&&(r.height=e),r.getContext("2d",n)}let Un;function Xn(){return Un||(Un=Yn(1,1)),Un}function qn(t){const e=t.canvas;e.width=1,e.height=1,t.clearRect(0,0,1,1)}function Vn(t,e){const i=e.parentNode;i&&i.replaceChild(t,e)}function jn(t){return t&&t.parentNode?t.parentNode.removeChild(t):null}function Wn(t,e,i){return e+":"+t+":"+(i?An(i):"null")}const Zn=new class{constructor(){this.cache_={},this.patternCache_={},this.cacheSize_=0,this.maxCacheSize_=32}clear(){this.cache_={},this.patternCache_={},this.cacheSize_=0}canExpireCache(){return this.cacheSize_>this.maxCacheSize_}expire(){if(this.canExpireCache()){let t=0;for(const e in this.cache_){const i=this.cache_[e];0!=(3&t++)||i.hasListener()||(delete this.cache_[e],delete this.patternCache_[e],--this.cacheSize_)}}}get(t,e,i){const n=Wn(t,e,i);return n in this.cache_?this.cache_[n]:null}getPattern(t,e,i){const n=Wn(t,e,i);return n in this.patternCache_?this.patternCache_[n]:null}set(t,e,i,n,r){const s=Wn(t,e,i),o=s in this.cache_;this.cache_[s]=n,r&&(n.getImageState()===sn&&n.load(),n.getImageState()===on?n.ready().then((()=>{this.patternCache_[s]=Xn().createPattern(n.getImage(1),"repeat")})):this.patternCache_[s]=Xn().createPattern(n.getImage(1),"repeat")),o||++this.cacheSize_}setSize(t){this.maxCacheSize_=t,this.expire()}};let Hn=null;class Kn extends y{constructor(t,e,i,n,r){super(),this.hitDetectionImage_=null,this.image_=t,this.crossOrigin_=i,this.canvas_={},this.color_=r,this.imageState_=void 0===n?sn:n,this.size_=t&&t.width&&t.height?[t.width,t.height]:null,this.src_=e,this.tainted_,this.ready_=null}initializeImage_(){this.image_=new Image,null!==this.crossOrigin_&&(this.image_.crossOrigin=this.crossOrigin_)}isTainted_(){if(void 0===this.tainted_&&this.imageState_===an){Hn||(Hn=Yn(1,1,void 0,{willReadFrequently:!0})),Hn.drawImage(this.image_,0,0);try{Hn.getImageData(0,0,1,1),this.tainted_=!1}catch(t){Hn=null,this.tainted_=!0}}return!0===this.tainted_}dispatchChangeEvent_(){this.dispatchEvent(w)}handleImageError_(){this.imageState_=ln,this.dispatchChangeEvent_()}handleImageLoad_(){this.imageState_=an,this.size_=[this.image_.width,this.image_.height],this.dispatchChangeEvent_()}getImage(t){return this.image_||this.initializeImage_(),this.replaceColor_(t),this.canvas_[t]?this.canvas_[t]:this.image_}getPixelRatio(t){return this.replaceColor_(t),this.canvas_[t]?t:1}getImageState(){return this.imageState_}getHitDetectionImage(){if(this.image_||this.initializeImage_(),!this.hitDetectionImage_)if(this.isTainted_()){const t=this.size_[0],e=this.size_[1],i=Yn(t,e);i.fillRect(0,0,t,e),this.hitDetectionImage_=i.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_}getSize(){return this.size_}getSrc(){return this.src_}load(){if(this.imageState_===sn){this.image_||this.initializeImage_(),this.imageState_=on;try{void 0!==this.src_&&(this.image_.src=this.src_)}catch(t){this.handleImageError_()}this.image_ instanceof HTMLImageElement&&function(t,e){return e&&(t.src=e),t.src&&Bn?new Promise(((e,i)=>t.decode().then((()=>e(t))).catch((n=>t.complete&&t.width?e(t):i(n))))):function(t,e){return new Promise(((e,i)=>{function n(){s(),e(t)}function r(){s(),i(new Error("Image load error"))}function s(){t.removeEventListener("load",n),t.removeEventListener("error",r)}t.addEventListener("load",n),t.addEventListener("error",r)}))}(t)}(this.image_,this.src_).then((t=>{this.image_=t,this.handleImageLoad_()})).catch(this.handleImageError_.bind(this))}}replaceColor_(t){if(!this.color_||this.canvas_[t]||this.imageState_!==an)return;const e=this.image_,i=document.createElement("canvas");i.width=Math.ceil(e.width*t),i.height=Math.ceil(e.height*t);const n=i.getContext("2d");n.scale(t,t),n.drawImage(e,0,0),n.globalCompositeOperation="multiply",n.fillStyle=function(t){return"string"==typeof t?t:Pn(t)}(this.color_),n.fillRect(0,0,i.width/t,i.height/t),n.globalCompositeOperation="destination-in",n.drawImage(e,0,0),this.canvas_[t]=i}ready(){return this.ready_||(this.ready_=new Promise((t=>{this.imageState_===an||this.imageState_===ln?t():this.addEventListener(w,(function e(){this.imageState_!==an&&this.imageState_!==ln||(this.removeEventListener(w,e),t())}))}))),this.ready_}}function $n(t,e,i,n,r,s){let o=void 0===e?void 0:Zn.get(e,i,r);return o||(o=new Kn(t,t instanceof HTMLImageElement?t.src||void 0:e,i,n,r),Zn.set(e,i,r,o,s)),s&&o&&!Zn.getPattern(e,i,r)&&Zn.set(e,i,r,o,s),o}function Jn(t){return t?Array.isArray(t)?Pn(t):"object"==typeof t&&"src"in t?function(t){if(!t.offset||!t.size)return Zn.getPattern(t.src,"anonymous",t.color);const e=t.src+":"+t.offset,i=Zn.getPattern(e,void 0,t.color);if(i)return i;const n=Zn.get(t.src,"anonymous",null);if(n.getImageState()!==an)return null;const r=Yn(t.size[0],t.size[1]);return r.drawImage(n.getImage(1),t.offset[0],t.offset[1],t.size[0],t.size[1],0,0,t.size[0],t.size[1]),$n(r.canvas,e,void 0,an,t.color,!0),Zn.getPattern(e,void 0,t.color)}(t):t:null}const Qn="ol-hidden",tr="ol-unselectable",er="ol-control",ir="ol-collapsed",nr=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))","?\\s*([-,\\\"\\'\\sa-z]+?)\\s*$"].join(""),"i"),rr=["style","variant","weight","size","lineHeight","family"],sr=function(t){const e=t.match(nr);if(!e)return null;const i={lineHeight:"normal",size:"1.2em",style:"normal",weight:"normal",variant:"normal"};for(let t=0,n=rr.length;t<n;++t){const n=e[t+1];void 0!==n&&(i[rr[t]]=n)}return i.families=i.family.split(/,\s?/),i},or="10px sans-serif",ar="#000",lr="round",hr=[],cr="round",ur="#000",dr="center",gr="middle",fr=[0,0,0,0],pr=new D;let mr,_r=null;const yr={},wr=function(){const t="32px ",e=["monospace","serif"],i=e.length,n="wmytzilWMYTZIL@#/&?$%10";let r,s;function o(r,o,a){let l=!0;for(let h=0;h<i;++h){const i=e[h];if(s=vr(r+" "+o+" "+t+i,n),a!=i){const e=vr(r+" "+o+" "+t+a+","+i,n);l=l&&e!=s}}return!!l}function a(){let t=!0;const e=pr.getKeys();for(let i=0,n=e.length;i<n;++i){const n=e[i];pr.get(n)<100&&(o.apply(this,n.split("\n"))?(m(yr),_r=null,mr=void 0,pr.set(n,100)):(pr.set(n,pr.get(n)+1,!0),t=!1))}t&&(clearInterval(r),r=void 0)}return function(t){const e=sr(t);if(!e)return;const i=e.families;for(let t=0,n=i.length;t<n;++t){const n=i[t],s=e.style+"\n"+e.weight+"\n"+n;void 0===pr.get(s)&&(pr.set(s,100,!0),o(e.style,e.weight,n)||(pr.set(s,0,!0),void 0===r&&(r=setInterval(a,32))))}}}(),xr=function(){let t;return function(e){let i=yr[e];if(null==i){if(zn){const t=sr(e),n=br(e,"g");i=(isNaN(Number(t.lineHeight))?1.2:Number(t.lineHeight))*(n.actualBoundingBoxAscent+n.actualBoundingBoxDescent)}else t||(t=document.createElement("div"),t.innerHTML="M",t.style.minHeight="0",t.style.maxHeight="none",t.style.height="auto",t.style.padding="0",t.style.border="none",t.style.position="absolute",t.style.display="block",t.style.left="-99999px"),t.style.font=e,document.body.appendChild(t),i=t.offsetHeight,document.body.removeChild(t);yr[e]=i}return i}}();function br(t,e){return _r||(_r=Yn(1,1)),t!=mr&&(_r.font=t,mr=_r.font),_r.measureText(e)}function vr(t,e){return br(t,e).width}function Er(t,e,i){if(e in i)return i[e];const n=e.split("\n").reduce(((e,i)=>Math.max(e,vr(t,i))),0);return i[e]=n,n}class Sr extends gn{constructor(t){super({opacity:1,rotateWithView:void 0!==t.rotateWithView&&t.rotateWithView,rotation:void 0!==t.rotation?t.rotation:0,scale:void 0!==t.scale?t.scale:1,displacement:void 0!==t.displacement?t.displacement:[0,0],declutterMode:t.declutterMode}),this.canvases_,this.hitDetectionCanvas_=null,this.fill_=void 0!==t.fill?t.fill:null,this.origin_=[0,0],this.points_=t.points,this.radius_=t.radius,this.radius2_=t.radius2,this.angle_=void 0!==t.angle?t.angle:0,this.stroke_=void 0!==t.stroke?t.stroke:null,this.size_,this.renderOptions_,this.imageState_=this.fill_&&this.fill_.loading()?on:an,this.imageState_===on&&this.ready().then((()=>this.imageState_=an)),this.render()}clone(){const t=this.getScale(),e=new Sr({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(t)?t.slice():t,displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return e.setOpacity(this.getOpacity()),e}getAnchor(){const t=this.size_,e=this.getDisplacement(),i=this.getScaleArray();return[t[0]/2-e[0]/i[0],t[1]/2+e[1]/i[1]]}getAngle(){return this.angle_}getFill(){return this.fill_}setFill(t){this.fill_=t,this.render()}getHitDetectionImage(){return this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.createHitDetectionCanvas_(this.renderOptions_)),this.hitDetectionCanvas_}getImage(t){let e=this.canvases_[t];if(!e){const i=this.renderOptions_,n=Yn(i.size*t,i.size*t);this.draw_(i,n,t),e=n.canvas,this.canvases_[t]=e}return e}getPixelRatio(t){return t}getImageSize(){return this.size_}getImageState(){return this.imageState_}getOrigin(){return this.origin_}getPoints(){return this.points_}getRadius(){return this.radius_}getRadius2(){return this.radius2_}getSize(){return this.size_}getStroke(){return this.stroke_}setStroke(t){this.stroke_=t,this.render()}listenImageChange(t){}load(){}unlistenImageChange(t){}calculateLineJoinSize_(t,e,i){if(0===e||this.points_===1/0||"bevel"!==t&&"miter"!==t)return e;let n=this.radius_,r=void 0===this.radius2_?n:this.radius2_;if(n<r){const t=n;n=r,r=t}const s=void 0===this.radius2_?this.points_:2*this.points_,o=2*Math.PI/s,a=r*Math.sin(o),l=n-Math.sqrt(r*r-a*a),h=Math.sqrt(a*a+l*l),c=h/a;if("miter"===t&&c<=i)return c*e;const u=e/2/c,d=e/2*(l/h),g=Math.sqrt((n+u)*(n+u)+d*d)-n;if(void 0===this.radius2_||"bevel"===t)return 2*g;const f=n*Math.sin(o),p=r-Math.sqrt(n*n-f*f),m=Math.sqrt(f*f+p*p)/f;if(m<=i){const t=m*e/2-r-n;return 2*Math.max(g,t)}return 2*g}createRenderOptions(){let t,e=lr,i=cr,n=0,r=null,s=0,o=0;this.stroke_&&(t=Jn(this.stroke_.getColor()??ur),o=this.stroke_.getWidth()??1,r=this.stroke_.getLineDash(),s=this.stroke_.getLineDashOffset()??0,i=this.stroke_.getLineJoin()??cr,e=this.stroke_.getLineCap()??lr,n=this.stroke_.getMiterLimit()??10);const a=this.calculateLineJoinSize_(i,o,n),l=Math.max(this.radius_,this.radius2_||0);return{strokeStyle:t,strokeWidth:o,size:Math.ceil(2*l+a),lineCap:e,lineDash:r,lineDashOffset:s,lineJoin:i,miterLimit:n}}render(){this.renderOptions_=this.createRenderOptions();const t=this.renderOptions_.size;this.canvases_={},this.hitDetectionCanvas_=null,this.size_=[t,t]}draw_(t,e,i){if(e.scale(i,i),e.translate(t.size/2,t.size/2),this.createPath_(e),this.fill_){let t=this.fill_.getColor();null===t&&(t=ar),e.fillStyle=Jn(t),e.fill()}t.strokeStyle&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineCap=t.lineCap,e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit,e.stroke())}createHitDetectionCanvas_(t){let e;if(this.fill_){let i=this.fill_.getColor(),n=0;"string"==typeof i&&(i=An(i)),null===i?n=1:Array.isArray(i)&&(n=4===i.length?i[3]:1),0===n&&(e=Yn(t.size,t.size),this.drawHitDetectionCanvas_(t,e))}return e?e.canvas:this.getImage(1)}createPath_(t){let e=this.points_;const i=this.radius_;if(e===1/0)t.arc(0,0,i,0,2*Math.PI);else{const n=void 0===this.radius2_?i:this.radius2_;void 0!==this.radius2_&&(e*=2);const r=this.angle_-Math.PI/2,s=2*Math.PI/e;for(let o=0;o<e;o++){const e=r+o*s,a=o%2==0?i:n;t.lineTo(a*Math.cos(e),a*Math.sin(e))}t.closePath()}}drawHitDetectionCanvas_(t,e){e.translate(t.size/2,t.size/2),this.createPath_(e),e.fillStyle=ar,e.fill(),t.strokeStyle&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit,e.stroke())}ready(){return this.fill_?this.fill_.ready():Promise.resolve()}}const Ir=Sr;class Mr extends Ir{constructor(t){super({points:1/0,fill:(t=t||{radius:5}).fill,radius:t.radius,stroke:t.stroke,scale:void 0!==t.scale?t.scale:1,rotation:void 0!==t.rotation?t.rotation:0,rotateWithView:void 0!==t.rotateWithView&&t.rotateWithView,displacement:void 0!==t.displacement?t.displacement:[0,0],declutterMode:t.declutterMode})}clone(){const t=this.getScale(),e=new Mr({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(t)?t.slice():t,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return e.setOpacity(this.getOpacity()),e}setRadius(t){this.radius_=t,this.render()}}const Cr=Mr;class Tr{constructor(t){t=t||{},this.patternImage_=null,this.color_=null,void 0!==t.color&&this.setColor(t.color)}clone(){const t=this.getColor();return new Tr({color:Array.isArray(t)?t.slice():t||void 0})}getColor(){return this.color_}setColor(t){if(null!==t&&"object"==typeof t&&"src"in t){const e=$n(null,t.src,"anonymous",void 0,t.offset?null:t.color?t.color:null,!(t.offset&&t.size));e.ready().then((()=>{this.patternImage_=null})),e.getImageState()===sn&&e.load(),e.getImageState()===on&&(this.patternImage_=e)}this.color_=t}loading(){return!!this.patternImage_}ready(){return this.patternImage_?this.patternImage_.ready():Promise.resolve()}}const Rr=Tr;class Ar{constructor(t){t=t||{},this.color_=void 0!==t.color?t.color:null,this.lineCap_=t.lineCap,this.lineDash_=void 0!==t.lineDash?t.lineDash:null,this.lineDashOffset_=t.lineDashOffset,this.lineJoin_=t.lineJoin,this.miterLimit_=t.miterLimit,this.width_=t.width}clone(){const t=this.getColor();return new Ar({color:Array.isArray(t)?t.slice():t||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})}getColor(){return this.color_}getLineCap(){return this.lineCap_}getLineDash(){return this.lineDash_}getLineDashOffset(){return this.lineDashOffset_}getLineJoin(){return this.lineJoin_}getMiterLimit(){return this.miterLimit_}getWidth(){return this.width_}setColor(t){this.color_=t}setLineCap(t){this.lineCap_=t}setLineDash(t){this.lineDash_=t}setLineDashOffset(t){this.lineDashOffset_=t}setLineJoin(t){this.lineJoin_=t}setMiterLimit(t){this.miterLimit_=t}setWidth(t){this.width_=t}}const kr=Ar;class Pr{constructor(t){t=t||{},this.geometry_=null,this.geometryFunction_=Dr,void 0!==t.geometry&&this.setGeometry(t.geometry),this.fill_=void 0!==t.fill?t.fill:null,this.image_=void 0!==t.image?t.image:null,this.renderer_=void 0!==t.renderer?t.renderer:null,this.hitDetectionRenderer_=void 0!==t.hitDetectionRenderer?t.hitDetectionRenderer:null,this.stroke_=void 0!==t.stroke?t.stroke:null,this.text_=void 0!==t.text?t.text:null,this.zIndex_=t.zIndex}clone(){let t=this.getGeometry();return t&&"object"==typeof t&&(t=t.clone()),new Pr({geometry:t??void 0,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:this.getRenderer()??void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})}getRenderer(){return this.renderer_}setRenderer(t){this.renderer_=t}setHitDetectionRenderer(t){this.hitDetectionRenderer_=t}getHitDetectionRenderer(){return this.hitDetectionRenderer_}getGeometry(){return this.geometry_}getGeometryFunction(){return this.geometryFunction_}getFill(){return this.fill_}setFill(t){this.fill_=t}getImage(){return this.image_}setImage(t){this.image_=t}getStroke(){return this.stroke_}setStroke(t){this.stroke_=t}getText(){return this.text_}setText(t){this.text_=t}getZIndex(){return this.zIndex_}setGeometry(t){"function"==typeof t?this.geometryFunction_=t:"string"==typeof t?this.geometryFunction_=function(e){return e.get(t)}:t?void 0!==t&&(this.geometryFunction_=function(){return t}):this.geometryFunction_=Dr,this.geometry_=t}setZIndex(t){this.zIndex_=t}}let Lr=null;function Nr(t,e){if(!Lr){const t=new Rr({color:"rgba(255,255,255,0.4)"}),e=new kr({color:"#3399CC",width:1.25});Lr=[new Pr({image:new Cr({fill:t,stroke:e,radius:5}),fill:t,stroke:e})]}return Lr}function Dr(t){return t.getGeometry()}const Or=Pr;function Fr(t,e,i,n){return void 0!==i&&void 0!==n?[i/t,n/e]:void 0!==i?i/t:void 0!==n?n/e:1}class zr extends gn{constructor(t){const e=void 0!==(t=t||{}).opacity?t.opacity:1,i=void 0!==t.rotation?t.rotation:0,n=void 0!==t.scale?t.scale:1,r=void 0!==t.rotateWithView&&t.rotateWithView;super({opacity:e,rotation:i,scale:n,displacement:void 0!==t.displacement?t.displacement:[0,0],rotateWithView:r,declutterMode:t.declutterMode}),this.anchor_=void 0!==t.anchor?t.anchor:[.5,.5],this.normalizedAnchor_=null,this.anchorOrigin_=void 0!==t.anchorOrigin?t.anchorOrigin:"top-left",this.anchorXUnits_=void 0!==t.anchorXUnits?t.anchorXUnits:"fraction",this.anchorYUnits_=void 0!==t.anchorYUnits?t.anchorYUnits:"fraction",this.crossOrigin_=void 0!==t.crossOrigin?t.crossOrigin:null;const s=void 0!==t.img?t.img:null;let o,a=t.src;if(K(!(void 0!==a&&s),"`image` and `src` cannot be provided at the same time"),void 0!==a&&0!==a.length||!s||(a=s.src||L(s)),K(void 0!==a&&a.length>0,"A defined and non-empty `src` or `image` must be provided"),K(!((void 0!==t.width||void 0!==t.height)&&void 0!==t.scale),"`width` or `height` cannot be provided together with `scale`"),void 0!==t.src?o=sn:void 0!==s&&(o=s instanceof HTMLImageElement?s.complete?s.src?an:sn:on:an),this.color_=void 0!==t.color?An(t.color):null,this.iconImage_=$n(s,a,this.crossOrigin_,o,this.color_),this.offset_=void 0!==t.offset?t.offset:[0,0],this.offsetOrigin_=void 0!==t.offsetOrigin?t.offsetOrigin:"top-left",this.origin_=null,this.size_=void 0!==t.size?t.size:null,void 0!==t.width||void 0!==t.height){let e,i;if(t.size)[e,i]=t.size;else{const n=this.getImage(1);if(n.width&&n.height)e=n.width,i=n.height;else if(n instanceof HTMLImageElement){this.initialOptions_=t;const e=()=>{if(this.unlistenImageChange(e),!this.initialOptions_)return;const i=this.iconImage_.getSize();this.setScale(Fr(i[0],i[1],t.width,t.height))};return void this.listenImageChange(e)}}void 0!==e&&this.setScale(Fr(e,i,t.width,t.height))}}clone(){let t,e,i;return this.initialOptions_?(e=this.initialOptions_.width,i=this.initialOptions_.height):(t=this.getScale(),t=Array.isArray(t)?t.slice():t),new zr({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,crossOrigin:this.crossOrigin_,offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,opacity:this.getOpacity(),rotateWithView:this.getRotateWithView(),rotation:this.getRotation(),scale:t,width:e,height:i,size:null!==this.size_?this.size_.slice():void 0,src:this.getSrc(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getAnchor(){let t=this.normalizedAnchor_;if(!t){t=this.anchor_;const e=this.getSize();if("fraction"==this.anchorXUnits_||"fraction"==this.anchorYUnits_){if(!e)return null;t=this.anchor_.slice(),"fraction"==this.anchorXUnits_&&(t[0]*=e[0]),"fraction"==this.anchorYUnits_&&(t[1]*=e[1])}if("top-left"!=this.anchorOrigin_){if(!e)return null;t===this.anchor_&&(t=this.anchor_.slice()),"top-right"!=this.anchorOrigin_&&"bottom-right"!=this.anchorOrigin_||(t[0]=-t[0]+e[0]),"bottom-left"!=this.anchorOrigin_&&"bottom-right"!=this.anchorOrigin_||(t[1]=-t[1]+e[1])}this.normalizedAnchor_=t}const e=this.getDisplacement(),i=this.getScaleArray();return[t[0]-e[0]/i[0],t[1]+e[1]/i[1]]}setAnchor(t){this.anchor_=t,this.normalizedAnchor_=null}getColor(){return this.color_}getImage(t){return this.iconImage_.getImage(t)}getPixelRatio(t){return this.iconImage_.getPixelRatio(t)}getImageSize(){return this.iconImage_.getSize()}getImageState(){return this.iconImage_.getImageState()}getHitDetectionImage(){return this.iconImage_.getHitDetectionImage()}getOrigin(){if(this.origin_)return this.origin_;let t=this.offset_;if("top-left"!=this.offsetOrigin_){const e=this.getSize(),i=this.iconImage_.getSize();if(!e||!i)return null;t=t.slice(),"top-right"!=this.offsetOrigin_&&"bottom-right"!=this.offsetOrigin_||(t[0]=i[0]-e[0]-t[0]),"bottom-left"!=this.offsetOrigin_&&"bottom-right"!=this.offsetOrigin_||(t[1]=i[1]-e[1]-t[1])}return this.origin_=t,this.origin_}getSrc(){return this.iconImage_.getSrc()}getSize(){return this.size_?this.size_:this.iconImage_.getSize()}getWidth(){const t=this.getScaleArray();return this.size_?this.size_[0]*t[0]:this.iconImage_.getImageState()==an?this.iconImage_.getSize()[0]*t[0]:void 0}getHeight(){const t=this.getScaleArray();return this.size_?this.size_[1]*t[1]:this.iconImage_.getImageState()==an?this.iconImage_.getSize()[1]*t[1]:void 0}setScale(t){delete this.initialOptions_,super.setScale(t)}listenImageChange(t){this.iconImage_.addEventListener(w,t)}load(){this.iconImage_.load()}unlistenImageChange(t){this.iconImage_.removeEventListener(w,t)}ready(){return this.iconImage_.ready()}}const Br=zr;class Gr{constructor(t){t=t||{},this.font_=t.font,this.rotation_=t.rotation,this.rotateWithView_=t.rotateWithView,this.scale_=t.scale,this.scaleArray_=un(void 0!==t.scale?t.scale:1),this.text_=t.text,this.textAlign_=t.textAlign,this.justify_=t.justify,this.repeat_=t.repeat,this.textBaseline_=t.textBaseline,this.fill_=void 0!==t.fill?t.fill:new Rr({color:"#333"}),this.maxAngle_=void 0!==t.maxAngle?t.maxAngle:Math.PI/4,this.placement_=void 0!==t.placement?t.placement:"point",this.overflow_=!!t.overflow,this.stroke_=void 0!==t.stroke?t.stroke:null,this.offsetX_=void 0!==t.offsetX?t.offsetX:0,this.offsetY_=void 0!==t.offsetY?t.offsetY:0,this.backgroundFill_=t.backgroundFill?t.backgroundFill:null,this.backgroundStroke_=t.backgroundStroke?t.backgroundStroke:null,this.padding_=void 0===t.padding?null:t.padding,this.declutterMode_=t.declutterMode}clone(){const t=this.getScale();return new Gr({font:this.getFont(),placement:this.getPlacement(),repeat:this.getRepeat(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(t)?t.slice():t,text:this.getText(),textAlign:this.getTextAlign(),justify:this.getJustify(),textBaseline:this.getTextBaseline(),fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()||void 0,declutterMode:this.getDeclutterMode()})}getOverflow(){return this.overflow_}getFont(){return this.font_}getMaxAngle(){return this.maxAngle_}getPlacement(){return this.placement_}getRepeat(){return this.repeat_}getOffsetX(){return this.offsetX_}getOffsetY(){return this.offsetY_}getFill(){return this.fill_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getStroke(){return this.stroke_}getText(){return this.text_}getTextAlign(){return this.textAlign_}getJustify(){return this.justify_}getTextBaseline(){return this.textBaseline_}getBackgroundFill(){return this.backgroundFill_}getBackgroundStroke(){return this.backgroundStroke_}getPadding(){return this.padding_}getDeclutterMode(){return this.declutterMode_}setOverflow(t){this.overflow_=t}setFont(t){this.font_=t}setMaxAngle(t){this.maxAngle_=t}setOffsetX(t){this.offsetX_=t}setOffsetY(t){this.offsetY_=t}setPlacement(t){this.placement_=t}setRepeat(t){this.repeat_=t}setRotateWithView(t){this.rotateWithView_=t}setFill(t){this.fill_=t}setRotation(t){this.rotation_=t}setScale(t){this.scale_=t,this.scaleArray_=un(void 0!==t?t:1)}setStroke(t){this.stroke_=t}setText(t){this.text_=t}setTextAlign(t){this.textAlign_=t}setJustify(t){this.justify_=t}setTextBaseline(t){this.textBaseline_=t}setBackgroundFill(t){this.backgroundFill_=t}setBackgroundStroke(t){this.backgroundStroke_=t}setPadding(t){this.padding_=t}}const Yr=Gr;let Ur=0;const Xr=0,qr=1<<Ur++,Vr=1<<Ur++,jr=1<<Ur++,Wr=1<<Ur++,Zr=1<<Ur++,Hr=Math.pow(2,5)-1,Kr={[qr]:"boolean",[Vr]:"number",[jr]:"string",[Wr]:"color",[Zr]:"number[]"},$r=Object.keys(Kr).map(Number).sort(a);function Jr(t){const e=[];for(const n of $r)(t&(i=n))===i&&e.push(Kr[n]);var i;return 0===e.length?"untyped":e.length<3?e.join(" or "):e.slice(0,-1).join(", ")+", or "+e[e.length-1]}function Qr(t,e){return!!(t&e)}function ts(t,e){return t===e}class es{constructor(t,e){this.type=t,this.value=e}}class is{constructor(t,e,...i){this.type=t,this.operator=e,this.args=i}}function ns(){return{variables:new Set,properties:new Set,featureId:!1,geometryType:!1,style:{}}}function rs(t,e,i){switch(typeof t){case"boolean":return new es(qr,t);case"number":return new es(Vr,t);case"string":{let e=jr;return function(t){try{return Rn(t),!0}catch(t){return!1}}(t)&&(e|=Wr),ts(e&i,Xr)||(e&=i),new es(e,t)}}if(!Array.isArray(t))throw new Error("Expression must be an array or a primitive value");if(0===t.length)throw new Error("Empty expression");if("string"==typeof t[0])return function(t,e,i){const n=t[0],r=os[n];if(!r)throw new Error(`Unknown operator: ${n}`);return r(t,e,i)}(t,e,i);for(const e of t)if("number"!=typeof e)throw new Error("Expected an array of numbers");let n=Zr;return 3!==t.length&&4!==t.length||(n|=Wr),i&&(n&=i),new es(n,t)}const ss={Get:"get",Var:"var",Concat:"concat",GeometryType:"geometry-type",Any:"any",All:"all",Not:"!",Resolution:"resolution",Zoom:"zoom",Time:"time",Equal:"==",NotEqual:"!=",GreaterThan:">",GreaterThanOrEqualTo:">=",LessThan:"<",LessThanOrEqualTo:"<=",Multiply:"*",Divide:"/",Add:"+",Subtract:"-",Clamp:"clamp",Mod:"%",Pow:"^",Abs:"abs",Floor:"floor",Ceil:"ceil",Round:"round",Sin:"sin",Cos:"cos",Atan:"atan",Sqrt:"sqrt",Match:"match",Between:"between",Interpolate:"interpolate",Coalesce:"coalesce",Case:"case",In:"in",Number:"number",String:"string",Array:"array",Color:"color",Id:"id",Band:"band",Palette:"palette",ToString:"to-string"},os={[ss.Get]:ds((([t,e])=>void 0!==e?function(t){switch(t){case"string":return jr;case"color":return Wr;case"number":return Vr;case"boolean":return qr;case"number[]":return Zr;default:throw new Error(`Unrecognized type hint: ${t}`)}}(e.value):Hr),ls(1,2),(function(t,e){const i=rs(t[1],e);if(!(i instanceof es))throw new Error("Expected a literal argument for get operation");if("string"!=typeof i.value)throw new Error("Expected a string argument for get operation");return e.properties.add(i.value),3===t.length?[i,rs(t[2],e)]:[i]})),[ss.Var]:ds((([t])=>t.type),ls(1,1),(function(t,e,i,n){const r=t[1];if("string"!=typeof r)throw new Error("Expected a string argument for var operation");if(e.variables.add(r),!("variables"in e.style)||void 0===e.style.variables[r])return[new es(Hr,r)];const s=rs(e.style.variables[r],e);if(s.value=r,n&&!Qr(n,s.type))throw new Error(`The variable ${r} has type ${Jr(s.type)} but the following type was expected: ${Jr(n)}`);return[s]})),[ss.Id]:ds(Vr|jr,as,(function(t,e){e.featureId=!0})),[ss.Concat]:ds(jr,ls(2,1/0),hs(Hr)),[ss.GeometryType]:ds(jr,as,(function(t,e){e.geometryType=!0})),[ss.Resolution]:ds(Vr,as),[ss.Zoom]:ds(Vr,as),[ss.Time]:ds(Vr,as),[ss.Any]:ds(qr,ls(2,1/0),hs(qr)),[ss.All]:ds(qr,ls(2,1/0),hs(qr)),[ss.Not]:ds(qr,ls(1,1),hs(qr)),[ss.Equal]:ds(qr,ls(2,2),hs(Hr),cs),[ss.NotEqual]:ds(qr,ls(2,2),hs(Hr),cs),[ss.GreaterThan]:ds(qr,ls(2,2),hs(Hr),cs),[ss.GreaterThanOrEqualTo]:ds(qr,ls(2,2),hs(Hr),cs),[ss.LessThan]:ds(qr,ls(2,2),hs(Hr),cs),[ss.LessThanOrEqualTo]:ds(qr,ls(2,2),hs(Hr),cs),[ss.Multiply]:ds((t=>{let e=Vr|Wr;for(let i=0;i<t.length;i++)e&=t[i].type;return e}),ls(2,1/0),hs(Vr|Wr),cs),[ss.Coalesce]:ds((t=>{let e=Hr;for(let i=1;i<t.length;i+=2)e&=t[i].type;return e&=t[t.length-1].type,e}),ls(2,1/0),hs(Hr),cs),[ss.Divide]:ds(Vr,ls(2,2),hs(Vr)),[ss.Add]:ds(Vr,ls(2,1/0),hs(Vr)),[ss.Subtract]:ds(Vr,ls(2,2),hs(Vr)),[ss.Clamp]:ds(Vr,ls(3,3),hs(Vr)),[ss.Mod]:ds(Vr,ls(2,2),hs(Vr)),[ss.Pow]:ds(Vr,ls(2,2),hs(Vr)),[ss.Abs]:ds(Vr,ls(1,1),hs(Vr)),[ss.Floor]:ds(Vr,ls(1,1),hs(Vr)),[ss.Ceil]:ds(Vr,ls(1,1),hs(Vr)),[ss.Round]:ds(Vr,ls(1,1),hs(Vr)),[ss.Sin]:ds(Vr,ls(1,1),hs(Vr)),[ss.Cos]:ds(Vr,ls(1,1),hs(Vr)),[ss.Atan]:ds(Vr,ls(1,2),hs(Vr)),[ss.Sqrt]:ds(Vr,ls(1,1),hs(Vr)),[ss.Match]:ds((t=>{let e=Hr;for(let i=2;i<t.length;i+=2)e&=t[i].type;return e&=t[t.length-1].type,e}),ls(4,1/0),us,(function(t,e,i,n){const r=t.length-1;let s=rs(t[1],e).type;const o=rs(t[t.length-1],e);let a=void 0!==n?n&o.type:o.type;const l=new Array(r-2);for(let i=0;i<r-2;i+=2){const n=rs(t[i+2],e),r=rs(t[i+3],e);s&=n.type,a&=r.type,l[i]=n,l[i+1]=r}const h=jr|Vr|qr;if(!Qr(h,s))throw new Error(`Expected an input of type ${Jr(h)} for the interpolate operation, got ${Jr(s)} instead`);if(ts(a,Xr))throw new Error("Could not find a common output type for the following match operation: "+JSON.stringify(t));for(let i=0;i<r-2;i+=2){const n=rs(t[i+2],e,s),r=rs(t[i+3],e,a);l[i]=n,l[i+1]=r}return[rs(t[1],e,s),...l,rs(t[t.length-1],e,a)]})),[ss.Between]:ds(qr,ls(3,3),hs(Vr)),[ss.Interpolate]:ds((t=>{let e=Wr|Vr;for(let i=3;i<t.length;i+=2)e&=t[i].type;return e}),ls(6,1/0),us,(function(t,e,i,n){const r=t[1];let s;switch(r[0]){case"linear":s=1;break;case"exponential":if(s=r[1],"number"!=typeof s)throw new Error(`Expected a number base for exponential interpolation, got ${JSON.stringify(s)} instead`);break;default:s=null}if(!s)throw new Error(`Invalid interpolation type: ${JSON.stringify(r)}`);s=rs(s,e);let o=rs(t[2],e);if(!Qr(Vr,o.type))throw new Error(`Expected an input of type number for the interpolate operation, got ${Jr(o.type)} instead`);o=rs(t[2],e,Vr);const a=new Array(t.length-3);for(let i=0;i<a.length;i+=2){let n=rs(t[i+3],e);if(!Qr(Vr,n.type))throw new Error(`Expected all stop input values in the interpolate operation to be of type number, got ${Jr(n.type)} at position ${i+2} instead`);let r=rs(t[i+4],e);if(!Qr(Vr|Wr,r.type))throw new Error(`Expected all stop output values in the interpolate operation to be a number or color, got ${Jr(r.type)} at position ${i+3} instead`);n=rs(t[i+3],e,Vr),r=rs(t[i+4],e,Vr|Wr),a[i]=n,a[i+1]=r}return[s,o,...a]})),[ss.Case]:ds((t=>{let e=Hr;for(let i=1;i<t.length;i+=2)e&=t[i].type;return e&=t[t.length-1].type,e}),ls(3,1/0),(function(t,e){const i=t[0],n=t.length-1;if(n%2==0)throw new Error(`An odd amount of arguments was expected for operation ${i}, got ${JSON.stringify(n)} instead`)}),(function(t,e,i,n){const r=rs(t[t.length-1],e);let s=void 0!==n?n&r.type:r.type;const o=new Array(t.length-1);for(let i=0;i<o.length-1;i+=2){const n=rs(t[i+1],e),r=rs(t[i+2],e);if(!Qr(qr,n.type))throw new Error(`Expected all conditions in the case operation to be of type boolean, got ${Jr(n.type)} at position ${i} instead`);s&=r.type,o[i]=n,o[i+1]=r}if(ts(s,Xr))throw new Error("Could not find a common output type for the following case operation: "+JSON.stringify(t));for(let i=0;i<o.length-1;i+=2)o[i+1]=rs(t[i+2],e,s);return o[o.length-1]=rs(t[t.length-1],e,s),o})),[ss.In]:ds(qr,ls(2,2),(function(t,e){let i=t[2];if(!Array.isArray(i))throw new Error('The "in" operator was provided a literal value which was not an array as second argument.');if("string"==typeof i[0]){if("literal"!==i[0])throw new Error('For the "in" operator, a string array should be wrapped in a "literal" operator to disambiguate from expressions.');if(!Array.isArray(i[1]))throw new Error('The "in" operator was provided a literal value which was not an array as second argument.');i=i[1]}let n=jr|Vr;const r=new Array(i.length);for(let t=0;t<r.length;t++){const s=rs(i[t],e);n&=s.type,r[t]=s}if(ts(n,Xr))throw new Error("Could not find a common type for the following in operation: "+JSON.stringify(t));return[rs(t[1],e,n),...r]})),[ss.Number]:ds(Vr,ls(1,1/0),hs(Hr)),[ss.String]:ds(jr,ls(1,1/0),hs(Hr)),[ss.Array]:ds((t=>3===t.length||4===t.length?Zr|Wr:Zr),ls(1,1/0),hs(Vr)),[ss.Color]:ds(Wr,ls(1,4),hs(Vr)),[ss.Band]:ds(Vr,ls(1,3),hs(Vr)),[ss.Palette]:ds(Wr,ls(2,2),(function(t,e){const i=rs(t[1],e,Vr);if(i.type!==Vr)throw new Error(`The first argument of palette must be an number, got ${Jr(i.type)} instead`);const n=t[2];if(!Array.isArray(n))throw new Error("The second argument of palette must be an array");const r=new Array(n.length);for(let t=0;t<r.length;t++){const i=rs(n[t],e,Wr);if(!(i instanceof es))throw new Error(`The palette color at index ${t} must be a literal value`);if(!Qr(i.type,Wr))throw new Error(`The palette color at index ${t} should be of type color, got ${Jr(i.type)} instead`);r[t]=i}return[i,...r]})),[ss.ToString]:ds(jr,ls(1,1),hs(qr|Vr|jr|Wr))};function as(t,e){const i=t[0];if(1!==t.length)throw new Error(`Expected no arguments for ${i} operation`);return[]}function ls(t,e){return function(i,n){const r=i[0],s=i.length-1;if(t===e){if(s!==t)throw new Error(`Expected ${t} argument${1===t?"":"s"} for ${r}, got ${s}`)}else if(s<t||s>e)throw new Error(`Expected ${e===1/0?`${t} or more`:`${t} to ${e}`} arguments for ${r}, got ${s}`)}}function hs(t){return function(e,i){const n=e[0],r=e.length-1,s=new Array(r);for(let o=0;o<r;++o){const r=rs(e[o+1],i);if(!Qr(t,r.type)){const e=Jr(t),i=Jr(r.type);throw new Error(`Unexpected type for argument ${o} of ${n} operation, got ${e} but expected ${i}`)}r.type&=t,s[o]=r}return s}}function cs(t,e,i){const n=t[0],r=t.length-1;let s=Hr;for(let t=0;t<i.length;++t)s&=i[t].type;if(s===Xr)throw new Error(`No common type could be found for arguments of ${n} operation`);const o=new Array(r);for(let i=0;i<r;++i)o[i]=rs(t[i+1],e,s);return o}function us(t,e){const i=t[0],n=t.length-1;if(n%2==1)throw new Error(`An even amount of arguments was expected for operation ${i}, got ${JSON.stringify(n)} instead`)}function ds(t,...e){return function(i,n,r){const s=i[0];let o=[];for(let t=0;t<e.length;t++)o=e[t](i,n,o,r)||o;let a="function"==typeof t?t(o):t;if(void 0!==r){if(!Qr(a,r))throw new Error(`The following expression was expected to return ${Jr(r)}, but returns ${Jr(a)} instead: ${JSON.stringify(i)}`);a&=r}if(a===Xr)throw new Error(`No matching type was found for the following expression: ${JSON.stringify(i)}`);return new is(a,s,...o)}}function gs(t){if(!t)return"";const e=t.getType();switch(e){case"Point":case"LineString":case"Polygon":return e;case"MultiPoint":case"MultiLineString":case"MultiPolygon":return e.substring(5);case"Circle":return"Polygon";case"GeometryCollection":return gs(t.getGeometries()[0]);default:return""}}function fs(t,e,i){const n=rs(t,i);if(!Qr(e,n.type)){const t=Jr(e),i=Jr(n.type);throw new Error(`Expected expression to be of type ${t}, got ${i}`)}return ps(n,i)}function ps(t,e){if(t instanceof es){if(t.type===Wr&&"string"==typeof t.value){const e=Rn(t.value);return function(){return e}}return function(){return t.value}}const i=t.operator;switch(i){case ss.Number:case ss.String:case ss.Coalesce:return function(t,e){const i=t.operator,n=t.args.length,r=new Array(n);for(let i=0;i<n;++i)r[i]=ps(t.args[i],e);switch(i){case ss.Coalesce:return t=>{for(let e=0;e<n;++e){const i=r[e](t);if(null!=i)return i}throw new Error("Expected one of the values to be non-null")};case ss.Number:case ss.String:return t=>{for(let e=0;e<n;++e){const n=r[e](t);if(typeof n===i)return n}throw new Error(`Expected one of the values to be a ${i}`)};default:throw new Error(`Unsupported assertion operator ${i}`)}}(t,e);case ss.Get:case ss.Var:return function(t,e){const i=t.args[0].value;switch(t.operator){case ss.Get:return t=>t.properties[i];case ss.Var:return t=>t.variables[i];default:throw new Error(`Unsupported accessor operator ${t.operator}`)}}(t);case ss.Id:return t=>t.featureId;case ss.GeometryType:return t=>t.geometryType;case ss.Concat:{const i=t.args.map((t=>ps(t,e)));return t=>"".concat(...i.map((e=>e(t).toString())))}case ss.Resolution:return t=>t.resolution;case ss.Any:case ss.All:case ss.Between:case ss.In:case ss.Not:return function(t,e){const i=t.operator,n=t.args.length,r=new Array(n);for(let i=0;i<n;++i)r[i]=ps(t.args[i],e);switch(i){case ss.Any:return t=>{for(let e=0;e<n;++e)if(r[e](t))return!0;return!1};case ss.All:return t=>{for(let e=0;e<n;++e)if(!r[e](t))return!1;return!0};case ss.Between:return t=>{const e=r[0](t),i=r[1](t),n=r[2](t);return e>=i&&e<=n};case ss.In:return t=>{const e=r[0](t);for(let i=1;i<n;++i)if(e===r[i](t))return!0;return!1};case ss.Not:return t=>!r[0](t);default:throw new Error(`Unsupported logical operator ${i}`)}}(t,e);case ss.Equal:case ss.NotEqual:case ss.LessThan:case ss.LessThanOrEqualTo:case ss.GreaterThan:case ss.GreaterThanOrEqualTo:return function(t,e){const i=t.operator,n=ps(t.args[0],e),r=ps(t.args[1],e);switch(i){case ss.Equal:return t=>n(t)===r(t);case ss.NotEqual:return t=>n(t)!==r(t);case ss.LessThan:return t=>n(t)<r(t);case ss.LessThanOrEqualTo:return t=>n(t)<=r(t);case ss.GreaterThan:return t=>n(t)>r(t);case ss.GreaterThanOrEqualTo:return t=>n(t)>=r(t);default:throw new Error(`Unsupported comparison operator ${i}`)}}(t,e);case ss.Multiply:case ss.Divide:case ss.Add:case ss.Subtract:case ss.Clamp:case ss.Mod:case ss.Pow:case ss.Abs:case ss.Floor:case ss.Ceil:case ss.Round:case ss.Sin:case ss.Cos:case ss.Atan:case ss.Sqrt:return function(t,e){const i=t.operator,n=t.args.length,r=new Array(n);for(let i=0;i<n;++i)r[i]=ps(t.args[i],e);switch(i){case ss.Multiply:return t=>{let e=1;for(let i=0;i<n;++i)e*=r[i](t);return e};case ss.Divide:return t=>r[0](t)/r[1](t);case ss.Add:return t=>{let e=0;for(let i=0;i<n;++i)e+=r[i](t);return e};case ss.Subtract:return t=>r[0](t)-r[1](t);case ss.Clamp:return t=>{const e=r[0](t),i=r[1](t);if(e<i)return i;const n=r[2](t);return e>n?n:e};case ss.Mod:return t=>r[0](t)%r[1](t);case ss.Pow:return t=>Math.pow(r[0](t),r[1](t));case ss.Abs:return t=>Math.abs(r[0](t));case ss.Floor:return t=>Math.floor(r[0](t));case ss.Ceil:return t=>Math.ceil(r[0](t));case ss.Round:return t=>Math.round(r[0](t));case ss.Sin:return t=>Math.sin(r[0](t));case ss.Cos:return t=>Math.cos(r[0](t));case ss.Atan:return 2===n?t=>Math.atan2(r[0](t),r[1](t)):t=>Math.atan(r[0](t));case ss.Sqrt:return t=>Math.sqrt(r[0](t));default:throw new Error(`Unsupported numeric operator ${i}`)}}(t,e);case ss.Case:return function(t,e){const i=t.args.length,n=new Array(i);for(let r=0;r<i;++r)n[r]=ps(t.args[r],e);return t=>{for(let e=0;e<i-1;e+=2)if(n[e](t))return n[e+1](t);return n[i-1](t)}}(t,e);case ss.Match:return function(t,e){const i=t.args.length,n=new Array(i);for(let r=0;r<i;++r)n[r]=ps(t.args[r],e);return t=>{const e=n[0](t);for(let r=1;r<i;r+=2)if(e===n[r](t))return n[r+1](t);return n[i-1](t)}}(t,e);case ss.Interpolate:return function(t,e){const i=t.args.length,n=new Array(i);for(let r=0;r<i;++r)n[r]=ps(t.args[r],e);return t=>{const e=n[0](t),r=n[1](t);let s,o;for(let a=2;a<i;a+=2){const i=n[a](t);let l=n[a+1](t);const h=Array.isArray(l);if(h&&(l=Cn(l)),i>=r)return 2===a?l:h?_s(e,r,s,o,i,l):ms(e,r,s,o,i,l);s=i,o=l}return o}}(t,e);case ss.ToString:return function(t,e){const i=t.operator,n=t.args.length,r=new Array(n);for(let i=0;i<n;++i)r[i]=ps(t.args[i],e);if(i===ss.ToString)return e=>{const i=r[0](e);return t.args[0].type===Wr?Pn(i):i.toString()};throw new Error(`Unsupported convert operator ${i}`)}(t,e);default:throw new Error(`Unsupported operator ${i}`)}}function ms(t,e,i,n,r,s){const o=r-i;if(0===o)return n;const a=e-i;return n+(1===t?a/o:(Math.pow(t,a)-1)/(Math.pow(t,o)-1))*(s-n)}function _s(t,e,i,n,r,s){if(0==r-i)return n;const o=Tn(n),a=Tn(s);let l=a[2]-o[2];return l>180?l-=360:l<-180&&(l+=360),kn(function(t){const e=mn.rgb(wn.xyz(t));return e[3]=t[3],e}([ms(t,e,i,o[0],r,a[0]),ms(t,e,i,o[1],r,a[1]),o[2]+ms(t,e,i,0,r,l),ms(t,e,i,n[3],r,s[3])]))}function ys(t){return!0}function ws(t){const e=ns(),i=function(t,e){const i=t.length,n=new Array(i);for(let r=0;r<i;++r){const i=t[r],s="filter"in i?fs(i.filter,qr,e):ys;let o;if(Array.isArray(i.style)){const t=i.style.length;o=new Array(t);for(let n=0;n<t;++n)o[n]=bs(i.style[n],e)}else o=[bs(i.style,e)];n[r]={filter:s,styles:o}}return function(e){const r=[];let s=!1;for(let o=0;o<i;++o)if((0,n[o].filter)(e)&&(!t[o].else||!s)){s=!0;for(const t of n[o].styles){const i=t(e);i&&r.push(i)}}return r}}(t,e),n={variables:{},properties:{},resolution:NaN,featureId:null,geometryType:""};return function(t,r){if(n.properties=t.getPropertiesInternal(),n.resolution=r,e.featureId){const e=t.getId();n.featureId=void 0!==e?e:null}return e.geometryType&&(n.geometryType=gs(t.getGeometry())),i(n)}}function xs(t){const e=ns(),i=t.length,n=new Array(i);for(let r=0;r<i;++r)n[r]=bs(t[r],e);const r={variables:{},properties:{},resolution:NaN,featureId:null,geometryType:""},s=new Array(i);return function(t,o){if(r.properties=t.getPropertiesInternal(),r.resolution=o,e.featureId){const e=t.getId();r.featureId=void 0!==e?e:null}let a=0;for(let t=0;t<i;++t){const e=n[t](r);e&&(s[a]=e,a+=1)}return s.length=a,s}}function bs(t,e){const i=vs(t,"",e),n=Es(t,"",e),r=function(t,e){const i="text-",n=Is(t,i+"value",e);if(!n)return null;const r=vs(t,i,e),s=vs(t,i+"background-",e),o=Es(t,i,e),a=Es(t,i+"background-",e),l=Is(t,i+"font",e),h=Ss(t,i+"max-angle",e),c=Ss(t,i+"offset-x",e),u=Ss(t,i+"offset-y",e),d=Ms(t,i+"overflow",e),g=Is(t,i+"placement",e),f=Ss(t,i+"repeat",e),p=ks(t,i+"scale",e),m=Ms(t,i+"rotate-with-view",e),_=Ss(t,i+"rotation",e),y=Is(t,i+"align",e),w=Is(t,i+"justify",e),x=Is(t,i+"baseline",e),b=Ts(t,i+"padding",e),v=Ds(t,i+"declutter-mode"),E=new Yr({declutterMode:v});return function(t){if(E.setText(n(t)),r&&E.setFill(r(t)),s&&E.setBackgroundFill(s(t)),o&&E.setStroke(o(t)),a&&E.setBackgroundStroke(a(t)),l&&E.setFont(l(t)),h&&E.setMaxAngle(h(t)),c&&E.setOffsetX(c(t)),u&&E.setOffsetY(u(t)),d&&E.setOverflow(d(t)),g){const e=g(t);if("point"!==e&&"line"!==e)throw new Error("Expected point or line for text-placement");E.setPlacement(e)}if(f&&E.setRepeat(f(t)),p&&E.setScale(p(t)),m&&E.setRotateWithView(m(t)),_&&E.setRotation(_(t)),y){const e=y(t);if("left"!==e&&"center"!==e&&"right"!==e&&"end"!==e&&"start"!==e)throw new Error("Expected left, right, center, start, or end for text-align");E.setTextAlign(e)}if(w){const e=w(t);if("left"!==e&&"right"!==e&&"center"!==e)throw new Error("Expected left, right, or center for text-justify");E.setJustify(e)}if(x){const e=x(t);if("bottom"!==e&&"top"!==e&&"middle"!==e&&"alphabetic"!==e&&"hanging"!==e)throw new Error("Expected bottom, top, middle, alphabetic, or hanging for text-baseline");E.setTextBaseline(e)}return b&&E.setPadding(b(t)),E}}(t,e),s=function(t,e){return"icon-src"in t?function(t,e){const i="icon-",n=i+"src",r=Fs(t[n],n),s=Rs(t,i+"anchor",e),o=ks(t,i+"scale",e),a=Ss(t,i+"opacity",e),l=Rs(t,i+"displacement",e),h=Ss(t,i+"rotation",e),c=Ms(t,i+"rotate-with-view",e),u=Ls(t,i+"anchor-origin"),d=Ns(t,i+"anchor-x-units"),g=Ns(t,i+"anchor-y-units"),f=function(t,e){const i=t[e];if(void 0!==i)return Bs(i,e)}(t,i+"color"),p=function(t,e){const i=t[e];if(void 0!==i){if("string"!=typeof i)throw new Error(`Expected a string for ${e}`);return i}}(t,i+"cross-origin"),m=function(t,e){const i=t[e];if(void 0!==i)return Os(i,e)}(t,i+"offset"),_=Ls(t,i+"offset-origin"),y=Ps(t,i+"width"),w=Ps(t,i+"height"),x=function(t,e){const i=t[e];if(void 0!==i){if("number"==typeof i)return un(i);if(!Array.isArray(i))throw new Error(`Expected a number or size array for ${e}`);if(2!==i.length||"number"!=typeof i[0]||"number"!=typeof i[1])throw new Error(`Expected a number or size array for ${e}`);return i}}(t,i+"size"),b=Ds(t,i+"declutter-mode"),v=new Br({src:r,anchorOrigin:u,anchorXUnits:d,anchorYUnits:g,color:f,crossOrigin:p,offset:m,offsetOrigin:_,height:w,width:y,size:x,declutterMode:b});return function(t){return a&&v.setOpacity(a(t)),l&&v.setDisplacement(l(t)),h&&v.setRotation(h(t)),c&&v.setRotateWithView(c(t)),o&&v.setScale(o(t)),s&&v.setAnchor(s(t)),v}}(t,e):"shape-points"in t?function(t,e){const i="shape-",n=i+"points",r=i+"radius",s=zs(t[n],n),o=zs(t[r],r),a=vs(t,i,e),l=Es(t,i,e),h=ks(t,i+"scale",e),c=Rs(t,i+"displacement",e),u=Ss(t,i+"rotation",e),d=Ms(t,i+"rotate-with-view",e),g=Ps(t,i+"radius2"),f=Ps(t,i+"angle"),p=Ds(t,i+"declutter-mode"),m=new Ir({points:s,radius:o,radius2:g,angle:f,declutterMode:p});return function(t){return a&&m.setFill(a(t)),l&&m.setStroke(l(t)),c&&m.setDisplacement(c(t)),u&&m.setRotation(u(t)),d&&m.setRotateWithView(d(t)),h&&m.setScale(h(t)),m}}(t,e):"circle-radius"in t?function(t,e){const i="circle-",n=vs(t,i,e),r=Es(t,i,e),s=Ss(t,i+"radius",e),o=ks(t,i+"scale",e),a=Rs(t,i+"displacement",e),l=Ss(t,i+"rotation",e),h=Ms(t,i+"rotate-with-view",e),c=Ds(t,i+"declutter-mode"),u=new Cr({radius:5,declutterMode:c});return function(t){return s&&u.setRadius(s(t)),n&&u.setFill(n(t)),r&&u.setStroke(r(t)),a&&u.setDisplacement(a(t)),l&&u.setRotation(l(t)),h&&u.setRotateWithView(h(t)),o&&u.setScale(o(t)),u}}(t,e):null}(t,e),o=Ss(t,"z-index",e);if(!(i||n||r||s||_(t)))throw new Error("No fill, stroke, point, or text symbolizer properties in style: "+JSON.stringify(t));const a=new Or;return function(t){let e=!0;if(i){const n=i(t);n&&(e=!1),a.setFill(n)}if(n){const i=n(t);i&&(e=!1),a.setStroke(i)}if(r){const i=r(t);i&&(e=!1),a.setText(i)}if(s){const i=s(t);i&&(e=!1),a.setImage(i)}return o&&a.setZIndex(o(t)),e?null:a}}function vs(t,e,i){let n;if(n=e+"fill-pattern-src"in t?function(t,e,i){const n=Is(t,e+"pattern-src",i),r=As(t,e+"pattern-offset",i),s=As(t,e+"pattern-size",i),o=Cs(t,e+"color",i);return function(t){return{src:n(t),offset:r&&r(t),size:s&&s(t),color:o&&o(t)}}}(t,e+"fill-",i):Cs(t,e+"fill-color",i),!n)return null;const r=new Rr;return function(t){const e=n(t);return"none"===e?null:(r.setColor(e),r)}}function Es(t,e,i){const n=Ss(t,e+"stroke-width",i),r=Cs(t,e+"stroke-color",i);if(!n&&!r)return null;const s=Is(t,e+"stroke-line-cap",i),o=Is(t,e+"stroke-line-join",i),a=Ts(t,e+"stroke-line-dash",i),l=Ss(t,e+"stroke-line-dash-offset",i),h=Ss(t,e+"stroke-miter-limit",i),c=new kr;return function(t){if(r){const e=r(t);if("none"===e)return null;c.setColor(e)}if(n&&c.setWidth(n(t)),s){const e=s(t);if("butt"!==e&&"round"!==e&&"square"!==e)throw new Error("Expected butt, round, or square line cap");c.setLineCap(e)}if(o){const e=o(t);if("bevel"!==e&&"round"!==e&&"miter"!==e)throw new Error("Expected bevel, round, or miter line join");c.setLineJoin(e)}return a&&c.setLineDash(a(t)),l&&c.setLineDashOffset(l(t)),h&&c.setMiterLimit(h(t)),c}}function Ss(t,e,i){if(!(e in t))return;const n=fs(t[e],Vr,i);return function(t){return zs(n(t),e)}}function Is(t,e,i){if(!(e in t))return null;const n=fs(t[e],jr,i);return function(t){return Fs(n(t),e)}}function Ms(t,e,i){if(!(e in t))return null;const n=fs(t[e],qr,i);return function(t){const i=n(t);if("boolean"!=typeof i)throw new Error(`Expected a boolean for ${e}`);return i}}function Cs(t,e,i){if(!(e in t))return null;const n=fs(t[e],Wr|jr,i);return function(t){return Bs(n(t),e)}}function Ts(t,e,i){if(!(e in t))return null;const n=fs(t[e],Zr,i);return function(t){return Os(n(t),e)}}function Rs(t,e,i){if(!(e in t))return null;const n=fs(t[e],Zr,i);return function(t){const i=Os(n(t),e);if(2!==i.length)throw new Error(`Expected two numbers for ${e}`);return i}}function As(t,e,i){if(!(e in t))return null;const n=fs(t[e],Zr,i);return function(t){return Gs(n(t),e)}}function ks(t,e,i){if(!(e in t))return null;const n=fs(t[e],Zr|Vr,i);return function(t){return i=n(t),r=e,"number"==typeof i?i:Gs(i,r);var i,r}}function Ps(t,e){const i=t[e];if(void 0!==i){if("number"!=typeof i)throw new Error(`Expected a number for ${e}`);return i}}function Ls(t,e){const i=t[e];if(void 0!==i){if("bottom-left"!==i&&"bottom-right"!==i&&"top-left"!==i&&"top-right"!==i)throw new Error(`Expected bottom-left, bottom-right, top-left, or top-right for ${e}`);return i}}function Ns(t,e){const i=t[e];if(void 0!==i){if("pixels"!==i&&"fraction"!==i)throw new Error(`Expected pixels or fraction for ${e}`);return i}}function Ds(t,e){const i=t[e];if(void 0!==i){if("string"!=typeof i)throw new Error(`Expected a string for ${e}`);if("declutter"!==i&&"obstacle"!==i&&"none"!==i)throw new Error(`Expected declutter, obstacle, or none for ${e}`);return i}}function Os(t,e){if(!Array.isArray(t))throw new Error(`Expected an array for ${e}`);const i=t.length;for(let n=0;n<i;++n)if("number"!=typeof t[n])throw new Error(`Expected an array of numbers for ${e}`);return t}function Fs(t,e){if("string"!=typeof t)throw new Error(`Expected a string for ${e}`);return t}function zs(t,e){if("number"!=typeof t)throw new Error(`Expected a number for ${e}`);return t}function Bs(t,e){if("string"==typeof t)return t;const i=Os(t,e),n=i.length;if(n<3||n>4)throw new Error(`Expected a color with 3 or 4 values for ${e}`);return i}function Gs(t,e){const i=Os(t,e);if(2!==i.length)throw new Error(`Expected an array of two numbers for ${e}`);return i}const Ys="renderOrder",Us=class extends nn{constructor(t){t=t||{};const e=Object.assign({},t);delete e.style,delete e.renderBuffer,delete e.updateWhileAnimating,delete e.updateWhileInteracting,super(e),this.declutter_=t.declutter?String(t.declutter):void 0,this.renderBuffer_=void 0!==t.renderBuffer?t.renderBuffer:100,this.style_=null,this.styleFunction_=void 0,this.setStyle(t.style),this.updateWhileAnimating_=void 0!==t.updateWhileAnimating&&t.updateWhileAnimating,this.updateWhileInteracting_=void 0!==t.updateWhileInteracting&&t.updateWhileInteracting}getDeclutter(){return this.declutter_}getFeatures(t){return super.getFeatures(t)}getRenderBuffer(){return this.renderBuffer_}getRenderOrder(){return this.get(Ys)}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}getUpdateWhileAnimating(){return this.updateWhileAnimating_}getUpdateWhileInteracting(){return this.updateWhileInteracting_}renderDeclutter(t,e){const i=this.getDeclutter();i in t.declutter==0&&(t.declutter[i]=new rn(9)),this.getRenderer().renderDeclutter(t,e)}setRenderOrder(t){this.set(Ys,t)}setStyle(t){this.style_=function(t){if(void 0===t)return Nr;if(!t)return null;if("function"==typeof t)return t;if(t instanceof Or)return t;if(!Array.isArray(t))return xs([t]);if(0===t.length)return[];const e=t.length,i=t[0];if(i instanceof Or){const i=new Array(e);for(let n=0;n<e;++n){const e=t[n];if(!(e instanceof Or))throw new Error("Expected a list of style instances");i[n]=e}return i}if("style"in i){const i=new Array(e);for(let n=0;n<e;++n){const e=t[n];if(!("style"in e))throw new Error("Expected a list of rules with a style property");i[n]=e}return ws(i)}return xs(t)}(t),this.styleFunction_=null===t?void 0:function(t){let e;if("function"==typeof t)e=t;else{let i;Array.isArray(t)?i=t:(K("function"==typeof t.getZIndex,"Expected an `Style` or an array of `Style`"),i=[t]),e=function(){return i}}return e}(this.style_),this.changed()}};function Xs(t,e){Zn.expire()}const qs=class extends o{constructor(t){super(),this.map_=t}dispatchRenderEvent(t,e){k()}calculateMatrices2D(t){const e=t.viewState,i=t.coordinateToPixelTransform,n=t.pixelToCoordinateTransform;ti(i,t.size[0]/2,t.size[1]/2,1/e.resolution,-1/e.resolution,-e.rotation,-e.center[0],-e.center[1]),ei(n,i)}forEachFeatureAtCoordinate(t,e,i,n,r,s,o,a){let l;const h=e.viewState;function c(t,e,i,n){return r.call(s,e,t?i:null,n)}const u=h.projection,d=fe(t.slice(),u),g=[[0,0]];if(u.canWrapX()&&n){const t=ae(u.getExtent());g.push([-t,0],[t,0])}const f=e.layerStatesArray,p=f.length,m=[],_=[];for(let n=0;n<g.length;n++)for(let r=p-1;r>=0;--r){const s=f[r],u=s.layer;if(u.hasRenderer()&&en(s,h)&&o.call(a,u)){const r=u.getRenderer(),o=u.getSource();if(r&&o){const a=o.getWrapX()?d:t,h=c.bind(null,s.managed);_[0]=a[0]+g[n][0],_[1]=a[1]+g[n][1],l=r.forEachFeatureAtCoordinate(_,e,i,h,m)}if(l)return l}}if(0===m.length)return;const y=1/m.length;return m.forEach(((t,e)=>t.distanceSq+=e*y)),m.sort(((t,e)=>t.distanceSq-e.distanceSq)),m.some((t=>l=t.callback(t.feature,t.layer,t.geometry))),l}hasFeatureAtCoordinate(t,e,i,n,r,s){return void 0!==this.forEachFeatureAtCoordinate(t,e,i,n,d,this,r,s)}getMap(){return this.map_}renderFrame(t){k()}scheduleExpireIconCache(t){Zn.canExpireCache()&&t.postRenderFunctions.push(Xs)}},Vs=class extends r{constructor(t,e,i,n){super(t),this.inversePixelTransform=e,this.frameState=i,this.context=n}},js=class extends qs{constructor(t){super(t),this.fontChangeListenerKey_=M(pr,s,t.redrawText.bind(t)),this.element_=document.createElement("div");const e=this.element_.style;e.position="absolute",e.width="100%",e.height="100%",e.zIndex="0",this.element_.className=tr+" ol-layers";const i=t.getViewport();i.insertBefore(this.element_,i.firstChild||null),this.children_=[],this.renderedVisible_=!0}dispatchRenderEvent(t,e){const i=this.getMap();if(i.hasListener(t)){const n=new Vs(t,void 0,e);i.dispatchEvent(n)}}disposeInternal(){T(this.fontChangeListenerKey_),this.element_.parentNode.removeChild(this.element_),super.disposeInternal()}renderFrame(t){if(!t)return void(this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1));this.calculateMatrices2D(t),this.dispatchRenderEvent(ct,t);const e=t.layerStatesArray.sort((function(t,e){return t.zIndex-e.zIndex}));e.some((t=>t.layer instanceof Us&&t.layer.getDeclutter()))&&(t.declutter={});const i=t.viewState;this.children_.length=0;const n=[];let r=null;for(let s=0,o=e.length;s<o;++s){const o=e[s];t.layerIndex=s;const a=o.layer,l=a.getSourceState();if(!en(o,i)||"ready"!=l&&"undefined"!=l){a.unrender();continue}const h=a.render(t,r);h&&(h!==r&&(this.children_.push(h),r=h),n.push(o))}this.declutter(t,n),function(t,e){const i=t.childNodes;for(let n=0;;++n){const r=i[n],s=e[n];if(!r&&!s)break;r!==s&&(r?s?t.insertBefore(s,r):(t.removeChild(r),--n):t.appendChild(s))}}(this.element_,this.children_),this.dispatchRenderEvent("postcompose",t),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(t)}declutter(t,e){for(let i=e.length-1;i>=0;--i){const n=e[i],r=n.layer;r.getDeclutter()&&r.renderDeclutter(t,n)}e.forEach((e=>e.layer.renderDeferred(t)))}};class Ws extends r{constructor(t,e){super(t),this.layer=e}}const Zs="layers";class Hs extends at{constructor(t){t=t||{};const e=Object.assign({},t);delete e.layers;let i=t.layers;super(e),this.on,this.once,this.un,this.layersListenerKeys_=[],this.listenerKeys_={},this.addChangeListener(Zs,this.handleLayersChanged_),i?Array.isArray(i)?i=new G(i.slice(),{unique:!0}):K("function"==typeof i.getArray,"Expected `layers` to be an array or a `Collection`"):i=new G(void 0,{unique:!0}),this.setLayers(i)}handleLayerChange_(){this.changed()}handleLayersChanged_(){this.layersListenerKeys_.forEach(T),this.layersListenerKeys_.length=0;const t=this.getLayers();this.layersListenerKeys_.push(M(t,O,this.handleLayersAdd_,this),M(t,F,this.handleLayersRemove_,this));for(const t in this.listenerKeys_)this.listenerKeys_[t].forEach(T);m(this.listenerKeys_);const e=t.getArray();for(let t=0,i=e.length;t<i;t++){const i=e[t];this.registerLayerListeners_(i),this.dispatchEvent(new Ws("addlayer",i))}this.changed()}registerLayerListeners_(t){const e=[M(t,s,this.handleLayerChange_,this),M(t,w,this.handleLayerChange_,this)];t instanceof Hs&&e.push(M(t,"addlayer",this.handleLayerGroupAdd_,this),M(t,"removelayer",this.handleLayerGroupRemove_,this)),this.listenerKeys_[L(t)]=e}handleLayerGroupAdd_(t){this.dispatchEvent(new Ws("addlayer",t.layer))}handleLayerGroupRemove_(t){this.dispatchEvent(new Ws("removelayer",t.layer))}handleLayersAdd_(t){const e=t.element;this.registerLayerListeners_(e),this.dispatchEvent(new Ws("addlayer",e)),this.changed()}handleLayersRemove_(t){const e=t.element,i=L(e);this.listenerKeys_[i].forEach(T),delete this.listenerKeys_[i],this.dispatchEvent(new Ws("removelayer",e)),this.changed()}getLayers(){return this.get(Zs)}setLayers(t){const e=this.getLayers();if(e){const t=e.getArray();for(let e=0,i=t.length;e<i;++e)this.dispatchEvent(new Ws("removelayer",t[e]))}this.set(Zs,t)}getLayersArray(t){return t=void 0!==t?t:[],this.getLayers().forEach((function(e){e.getLayersArray(t)})),t}getLayerStatesArray(t){const e=void 0!==t?t:[],i=e.length;this.getLayers().forEach((function(t){t.getLayerStatesArray(e)}));const n=this.getLayerState();let r=n.zIndex;t||void 0!==n.zIndex||(r=0);for(let t=i,s=e.length;t<s;t++){const i=e[t];i.opacity*=n.opacity,i.visible=i.visible&&n.visible,i.maxResolution=Math.min(i.maxResolution,n.maxResolution),i.minResolution=Math.max(i.minResolution,n.minResolution),i.minZoom=Math.max(i.minZoom,n.minZoom),i.maxZoom=Math.min(i.maxZoom,n.maxZoom),void 0!==n.extent&&(void 0!==i.extent?i.extent=re(i.extent,n.extent):i.extent=n.extent),void 0===i.zIndex&&(i.zIndex=r)}return e}getSourceState(){return"ready"}}const Ks=Hs,$s=class extends r{constructor(t,e,i){super(t),this.map=e,this.frameState=void 0!==i?i:null}},Js=class extends $s{constructor(t,e,i,n,r,s){super(t,e,r),this.originalEvent=i,this.pixel_=null,this.coordinate_=null,this.dragging=void 0!==n&&n,this.activePointers=s}get pixel(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_}set pixel(t){this.pixel_=t}get coordinate(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_}set coordinate(t){this.coordinate_=t}preventDefault(){super.preventDefault(),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()}stopPropagation(){super.stopPropagation(),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()}},Qs={SINGLECLICK:"singleclick",CLICK:b,DBLCLICK:"dblclick",POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},to="pointerdown",eo=class extends y{constructor(t,e){super(t),this.map_=t,this.clickTimeoutId_,this.emulateClicks_=!1,this.dragging_=!1,this.dragListenerKeys_=[],this.moveTolerance_=void 0===e?1:e,this.down_=null;const i=this.map_.getViewport();this.activePointers_=[],this.trackedTouches_={},this.element_=i,this.pointerdownListenerKey_=M(i,to,this.handlePointerDown_,this),this.originalPointerMoveEvent_,this.relayedListenerKey_=M(i,"pointermove",this.relayMoveEvent_,this),this.boundHandleTouchMove_=this.handleTouchMove_.bind(this),this.element_.addEventListener(S,this.boundHandleTouchMove_,!!Gn&&{passive:!1})}emulateClick_(t){let e=new Js(Qs.CLICK,this.map_,t);this.dispatchEvent(e),void 0!==this.clickTimeoutId_?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,e=new Js(Qs.DBLCLICK,this.map_,t),this.dispatchEvent(e)):this.clickTimeoutId_=setTimeout((()=>{this.clickTimeoutId_=void 0;const e=new Js(Qs.SINGLECLICK,this.map_,t);this.dispatchEvent(e)}),250)}updateActivePointers_(t){const e=t,i=e.pointerId;if(e.type==Qs.POINTERUP||e.type==Qs.POINTERCANCEL){delete this.trackedTouches_[i];for(const t in this.trackedTouches_)if(this.trackedTouches_[t].target!==e.target){delete this.trackedTouches_[t];break}}else e.type!=Qs.POINTERDOWN&&e.type!=Qs.POINTERMOVE||(this.trackedTouches_[i]=e);this.activePointers_=Object.values(this.trackedTouches_)}handlePointerUp_(t){this.updateActivePointers_(t);const e=new Js(Qs.POINTERUP,this.map_,t,void 0,void 0,this.activePointers_);this.dispatchEvent(e),this.emulateClicks_&&!e.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(t)&&this.emulateClick_(this.down_),0===this.activePointers_.length&&(this.dragListenerKeys_.forEach(T),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)}isMouseActionButton_(t){return 0===t.button}handlePointerDown_(t){this.emulateClicks_=0===this.activePointers_.length,this.updateActivePointers_(t);const e=new Js(Qs.POINTERDOWN,this.map_,t,void 0,void 0,this.activePointers_);if(this.dispatchEvent(e),this.down_=new PointerEvent(t.type,t),Object.defineProperty(this.down_,"target",{writable:!1,value:t.target}),0===this.dragListenerKeys_.length){const t=this.map_.getOwnerDocument();this.dragListenerKeys_.push(M(t,Qs.POINTERMOVE,this.handlePointerMove_,this),M(t,Qs.POINTERUP,this.handlePointerUp_,this),M(this.element_,Qs.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==t&&this.dragListenerKeys_.push(M(this.element_.getRootNode(),Qs.POINTERUP,this.handlePointerUp_,this))}}handlePointerMove_(t){if(this.isMoving_(t)){this.updateActivePointers_(t),this.dragging_=!0;const e=new Js(Qs.POINTERDRAG,this.map_,t,this.dragging_,void 0,this.activePointers_);this.dispatchEvent(e)}}relayMoveEvent_(t){this.originalPointerMoveEvent_=t;const e=!(!this.down_||!this.isMoving_(t));this.dispatchEvent(new Js(Qs.POINTERMOVE,this.map_,t,e))}handleTouchMove_(t){const e=this.originalPointerMoveEvent_;e&&!e.defaultPrevented||"boolean"==typeof t.cancelable&&!0!==t.cancelable||t.preventDefault()}isMoving_(t){return this.dragging_||Math.abs(t.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(t.clientY-this.down_.clientY)>this.moveTolerance_}disposeInternal(){this.relayedListenerKey_&&(T(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(S,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(T(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(T),this.dragListenerKeys_.length=0,this.element_=null,super.disposeInternal()}},io="postrender",no="loadstart",ro="loadend",so="layergroup",oo="size",ao="target",lo="view",ho=1/0,co=class{constructor(t,e){this.priorityFunction_=t,this.keyFunction_=e,this.elements_=[],this.priorities_=[],this.queuedElements_={}}clear(){this.elements_.length=0,this.priorities_.length=0,m(this.queuedElements_)}dequeue(){const t=this.elements_,e=this.priorities_,i=t[0];1==t.length?(t.length=0,e.length=0):(t[0]=t.pop(),e[0]=e.pop(),this.siftUp_(0));const n=this.keyFunction_(i);return delete this.queuedElements_[n],i}enqueue(t){K(!(this.keyFunction_(t)in this.queuedElements_),"Tried to enqueue an `element` that was already added to the queue");const e=this.priorityFunction_(t);return e!=ho&&(this.elements_.push(t),this.priorities_.push(e),this.queuedElements_[this.keyFunction_(t)]=!0,this.siftDown_(0,this.elements_.length-1),!0)}getCount(){return this.elements_.length}getLeftChildIndex_(t){return 2*t+1}getRightChildIndex_(t){return 2*t+2}getParentIndex_(t){return t-1>>1}heapify_(){let t;for(t=(this.elements_.length>>1)-1;t>=0;t--)this.siftUp_(t)}isEmpty(){return 0===this.elements_.length}isKeyQueued(t){return t in this.queuedElements_}isQueued(t){return this.isKeyQueued(this.keyFunction_(t))}siftUp_(t){const e=this.elements_,i=this.priorities_,n=e.length,r=e[t],s=i[t],o=t;for(;t<n>>1;){const r=this.getLeftChildIndex_(t),s=this.getRightChildIndex_(t),o=s<n&&i[s]<i[r]?s:r;e[t]=e[o],i[t]=i[o],t=o}e[t]=r,i[t]=s,this.siftDown_(o,t)}siftDown_(t,e){const i=this.elements_,n=this.priorities_,r=i[e],s=n[e];for(;e>t;){const t=this.getParentIndex_(e);if(!(n[t]>s))break;i[e]=i[t],n[e]=n[t],e=t}i[e]=r,n[e]=s}reprioritize(){const t=this.priorityFunction_,e=this.elements_,i=this.priorities_;let n=0;const r=e.length;let s,o,a;for(o=0;o<r;++o)s=e[o],a=t(s),a==ho?delete this.queuedElements_[this.keyFunction_(s)]:(i[n]=a,e[n++]=s);e.length=n,i.length=n,this.heapify_()}},uo=class extends co{constructor(t,e){super((function(e){return t.apply(null,e)}),(function(t){return t[0].getKey()})),this.boundHandleTileChange_=this.handleTileChange.bind(this),this.tileChangeCallback_=e,this.tilesLoading_=0,this.tilesLoadingKeys_={}}enqueue(t){const e=super.enqueue(t);return e&&t[0].addEventListener(w,this.boundHandleTileChange_),e}getTilesLoading(){return this.tilesLoading_}handleTileChange(t){const e=t.target,i=e.getState();if(2===i||3===i||4===i){3!==i&&e.removeEventListener(w,this.boundHandleTileChange_);const t=e.getKey();t in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[t],--this.tilesLoading_),this.tileChangeCallback_()}}loadMoreTiles(t,e){let i,n,r,s=0;for(;this.tilesLoading_<t&&s<e&&this.getCount()>0;)n=this.dequeue()[0],r=n.getKey(),i=n.getState(),0!==i||r in this.tilesLoadingKeys_||(this.tilesLoadingKeys_[r]=!0,++this.tilesLoading_,++s,n.load())}},go=class extends D{constructor(t){super();const e=t.element;!e||t.target||e.style.pointerEvents||(e.style.pointerEvents="auto"),this.element=e||null,this.target_=null,this.map_=null,this.listenerKeys=[],t.render&&(this.render=t.render),t.target&&this.setTarget(t.target)}disposeInternal(){jn(this.element),super.disposeInternal()}getMap(){return this.map_}setMap(t){this.map_&&jn(this.element);for(let t=0,e=this.listenerKeys.length;t<e;++t)T(this.listenerKeys[t]);this.listenerKeys.length=0,this.map_=t,t&&((this.target_?this.target_:t.getOverlayContainerStopEvent()).appendChild(this.element),this.render!==f&&this.listenerKeys.push(M(t,io,this.render,this)),t.render())}render(t){}setTarget(t){this.target_="string"==typeof t?document.getElementById(t):t}},fo=class extends go{constructor(t){t=t||{},super({element:document.createElement("div"),render:t.render,target:t.target}),this.ulElement_=document.createElement("ul"),this.collapsed_=void 0===t.collapsed||t.collapsed,this.userCollapsed_=this.collapsed_,this.overrideCollapsible_=void 0!==t.collapsible,this.collapsible_=void 0===t.collapsible||t.collapsible,this.collapsible_||(this.collapsed_=!1);const e=void 0!==t.className?t.className:"ol-attribution",i=void 0!==t.tipLabel?t.tipLabel:"Attributions",n=void 0!==t.expandClassName?t.expandClassName:e+"-expand",r=void 0!==t.collapseLabel?t.collapseLabel:"",s=void 0!==t.collapseClassName?t.collapseClassName:e+"-collapse";"string"==typeof r?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=r,this.collapseLabel_.className=s):this.collapseLabel_=r;const o=void 0!==t.label?t.label:"i";"string"==typeof o?(this.label_=document.createElement("span"),this.label_.textContent=o,this.label_.className=n):this.label_=o;const a=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_;this.toggleButton_=document.createElement("button"),this.toggleButton_.setAttribute("type","button"),this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_)),this.toggleButton_.title=i,this.toggleButton_.appendChild(a),this.toggleButton_.addEventListener(b,this.handleClick_.bind(this),!1);const l=e+" "+tr+" "+er+(this.collapsed_&&this.collapsible_?" "+ir:"")+(this.collapsible_?"":" ol-uncollapsible"),h=this.element;h.className=l,h.appendChild(this.toggleButton_),h.appendChild(this.ulElement_),this.renderedAttributions_=[],this.renderedVisible_=!0}collectSourceAttributions_(t){const e=Array.from(new Set(this.getMap().getAllLayers().flatMap((e=>e.getAttributions(t))))),i=!this.getMap().getAllLayers().some((t=>t.getSource()&&!1===t.getSource().getAttributionsCollapsible()));return this.overrideCollapsible_||this.setCollapsible(i),e}async updateElement_(t){if(!t)return void(this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1));const e=await Promise.all(this.collectSourceAttributions_(t).map((t=>{return e=()=>t,function(){let t;try{t=e()}catch(t){return Promise.reject(t)}return t instanceof Promise?t:Promise.resolve(t)}();var e}))),i=e.length>0;if(this.renderedVisible_!=i&&(this.element.style.display=i?"":"none",this.renderedVisible_=i),!u(e,this.renderedAttributions_)){!function(t){for(;t.lastChild;)t.removeChild(t.lastChild)}(this.ulElement_);for(let t=0,i=e.length;t<i;++t){const i=document.createElement("li");i.innerHTML=e[t],this.ulElement_.appendChild(i)}this.renderedAttributions_=e}}handleClick_(t){t.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_}handleToggle_(){this.element.classList.toggle(ir),this.collapsed_?Vn(this.collapseLabel_,this.label_):Vn(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))}getCollapsible(){return this.collapsible_}setCollapsible(t){this.collapsible_!==t&&(this.collapsible_=t,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_())}setCollapsed(t){this.userCollapsed_=t,this.collapsible_&&this.collapsed_!==t&&this.handleToggle_()}getCollapsed(){return this.collapsed_}render(t){this.updateElement_(t.frameState)}},po=class extends go{constructor(t){t=t||{},super({element:document.createElement("div"),render:t.render,target:t.target});const e=void 0!==t.className?t.className:"ol-rotate",i=void 0!==t.label?t.label:"",n=void 0!==t.compassClassName?t.compassClassName:"ol-compass";this.label_=null,"string"==typeof i?(this.label_=document.createElement("span"),this.label_.className=n,this.label_.textContent=i):(this.label_=i,this.label_.classList.add(n));const r=t.tipLabel?t.tipLabel:"Reset rotation",s=document.createElement("button");s.className=e+"-reset",s.setAttribute("type","button"),s.title=r,s.appendChild(this.label_),s.addEventListener(b,this.handleClick_.bind(this),!1);const o=e+" "+tr+" "+er,a=this.element;a.className=o,a.appendChild(s),this.callResetNorth_=t.resetNorth?t.resetNorth:void 0,this.duration_=void 0!==t.duration?t.duration:250,this.autoHide_=void 0===t.autoHide||t.autoHide,this.rotation_=void 0,this.autoHide_&&this.element.classList.add(Qn)}handleClick_(t){t.preventDefault(),void 0!==this.callResetNorth_?this.callResetNorth_():this.resetNorth_()}resetNorth_(){const t=this.getMap().getView();if(!t)return;const e=t.getRotation();void 0!==e&&(this.duration_>0&&e%(2*Math.PI)!=0?t.animate({rotation:0,duration:this.duration_,easing:Ke}):t.setRotation(0))}render(t){const e=t.frameState;if(!e)return;const i=e.viewState.rotation;if(i!=this.rotation_){const t="rotate("+i+"rad)";if(this.autoHide_){const t=this.element.classList.contains(Qn);t||0!==i?t&&0!==i&&this.element.classList.remove(Qn):this.element.classList.add(Qn)}this.label_.style.transform=t}this.rotation_=i}},mo=class extends go{constructor(t){t=t||{},super({element:document.createElement("div"),target:t.target});const e=void 0!==t.className?t.className:"ol-zoom",i=void 0!==t.delta?t.delta:1,n=void 0!==t.zoomInClassName?t.zoomInClassName:e+"-in",r=void 0!==t.zoomOutClassName?t.zoomOutClassName:e+"-out",s=void 0!==t.zoomInLabel?t.zoomInLabel:"+",o=void 0!==t.zoomOutLabel?t.zoomOutLabel:"",a=void 0!==t.zoomInTipLabel?t.zoomInTipLabel:"Zoom in",l=void 0!==t.zoomOutTipLabel?t.zoomOutTipLabel:"Zoom out",h=document.createElement("button");h.className=n,h.setAttribute("type","button"),h.title=a,h.appendChild("string"==typeof s?document.createTextNode(s):s),h.addEventListener(b,this.handleClick_.bind(this,i),!1);const c=document.createElement("button");c.className=r,c.setAttribute("type","button"),c.title=l,c.appendChild("string"==typeof o?document.createTextNode(o):o),c.addEventListener(b,this.handleClick_.bind(this,-i),!1);const u=e+" "+tr+" "+er,d=this.element;d.className=u,d.appendChild(h),d.appendChild(c),this.duration_=void 0!==t.duration?t.duration:250}handleClick_(t,e){e.preventDefault(),this.zoomByDelta_(t)}zoomByDelta_(t){const e=this.getMap().getView();if(!e)return;const i=e.getZoom();if(void 0!==i){const n=e.getConstrainedZoom(i+t);this.duration_>0?(e.getAnimating()&&e.cancelAnimations(),e.animate({zoom:n,duration:this.duration_,easing:Ke})):e.setZoom(n)}}},_o="active";function yo(t,e,i,n){const r=t.getZoom();if(void 0===r)return;const s=t.getConstrainedZoom(r+e),o=t.getResolutionForZoom(s);t.getAnimating()&&t.cancelAnimations(),t.animate({resolution:o,anchor:i,duration:void 0!==n?n:250,easing:Ke})}const wo=class extends D{constructor(t){super(),this.on,this.once,this.un,t&&t.handleEvent&&(this.handleEvent=t.handleEvent),this.map_=null,this.setActive(!0)}getActive(){return this.get(_o)}getMap(){return this.map_}handleEvent(t){return!0}setActive(t){this.set(_o,t)}setMap(t){this.map_=t}},xo=class extends wo{constructor(t){super(),t=t||{},this.delta_=t.delta?t.delta:1,this.duration_=void 0!==t.duration?t.duration:250}handleEvent(t){let e=!1;if(t.type==Qs.DBLCLICK){const i=t.originalEvent,n=t.map,r=t.coordinate,s=i.shiftKey?-this.delta_:this.delta_;yo(n.getView(),s,r,this.duration_),i.preventDefault(),e=!0}return!e}};function bo(t){const e=t.length;let i=0,n=0;for(let r=0;r<e;r++)i+=t[r].clientX,n+=t[r].clientY;return{clientX:i/e,clientY:n/e}}const vo=class extends wo{constructor(t){super(t=t||{}),t.handleDownEvent&&(this.handleDownEvent=t.handleDownEvent),t.handleDragEvent&&(this.handleDragEvent=t.handleDragEvent),t.handleMoveEvent&&(this.handleMoveEvent=t.handleMoveEvent),t.handleUpEvent&&(this.handleUpEvent=t.handleUpEvent),t.stopDown&&(this.stopDown=t.stopDown),this.handlingDownUpSequence=!1,this.targetPointers=[]}getPointerCount(){return this.targetPointers.length}handleDownEvent(t){return!1}handleDragEvent(t){}handleEvent(t){if(!t.originalEvent)return!0;let e=!1;if(this.updateTrackedPointers_(t),this.handlingDownUpSequence){if(t.type==Qs.POINTERDRAG)this.handleDragEvent(t),t.originalEvent.preventDefault();else if(t.type==Qs.POINTERUP){const e=this.handleUpEvent(t);this.handlingDownUpSequence=e&&this.targetPointers.length>0}}else if(t.type==Qs.POINTERDOWN){const i=this.handleDownEvent(t);this.handlingDownUpSequence=i,e=this.stopDown(i)}else t.type==Qs.POINTERMOVE&&this.handleMoveEvent(t);return!e}handleMoveEvent(t){}handleUpEvent(t){return!1}stopDown(t){return t}updateTrackedPointers_(t){t.activePointers&&(this.targetPointers=t.activePointers)}};function Eo(t){const e=arguments;return function(t){let i=!0;for(let n=0,r=e.length;n<r&&(i=i&&e[n](t),i);++n);return i}}const So=function(t){const e=t.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},Io=function(t){return!t.map.getTargetElement().hasAttribute("tabindex")||function(t){const e=t.map.getTargetElement(),i=t.map.getOwnerDocument().activeElement;return e.contains(i)}(t)},Mo=d,Co=function(t){const e=t.originalEvent;return 0==e.button&&!(Dn&&On&&e.ctrlKey)},To=function(t){const e=t.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},Ro=function(t){const e=t.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},Ao=function(t){const e=t.originalEvent,i=e.target.tagName;return"INPUT"!==i&&"SELECT"!==i&&"TEXTAREA"!==i&&!e.target.isContentEditable},ko=function(t){const e=t.originalEvent;return K(void 0!==e,"mapBrowserEvent must originate from a pointer event"),"mouse"==e.pointerType},Po=function(t){const e=t.originalEvent;return K(void 0!==e,"mapBrowserEvent must originate from a pointer event"),e.isPrimary&&0===e.button},Lo=class extends vo{constructor(t){super({stopDown:g}),t=t||{},this.kinetic_=t.kinetic,this.lastCentroid=null,this.lastPointersCount_,this.panning_=!1;const e=t.condition?t.condition:Eo(To,Po);this.condition_=t.onFocusOnly?Eo(Io,e):e,this.noKinetic_=!1}handleDragEvent(t){const e=t.map;this.panning_||(this.panning_=!0,e.getView().beginInteraction());const i=this.targetPointers,n=e.getEventPixel(bo(i));if(i.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(n[0],n[1]),this.lastCentroid){const e=[this.lastCentroid[0]-n[0],n[1]-this.lastCentroid[1]],i=t.map.getView();r=e,s=i.getResolution(),r[0]*=s,r[1]*=s,ge(e,i.getRotation()),i.adjustCenterInternal(e)}}else this.kinetic_&&this.kinetic_.begin();var r,s;this.lastCentroid=n,this.lastPointersCount_=i.length,t.originalEvent.preventDefault()}handleUpEvent(t){const e=t.map,i=e.getView();if(0===this.targetPointers.length){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){const t=this.kinetic_.getDistance(),n=this.kinetic_.getAngle(),r=i.getCenterInternal(),s=e.getPixelFromCoordinateInternal(r),o=e.getCoordinateFromPixelInternal([s[0]-t*Math.cos(n),s[1]-t*Math.sin(n)]);i.animateInternal({center:i.getConstrainedCenter(o),duration:500,easing:Ke})}return this.panning_&&(this.panning_=!1,i.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0}handleDownEvent(t){if(this.targetPointers.length>0&&this.condition_(t)){const e=t.map.getView();return this.lastCentroid=null,e.getAnimating()&&e.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1}},No=class extends vo{constructor(t){t=t||{},super({stopDown:g}),this.condition_=t.condition?t.condition:So,this.lastAngle_=void 0,this.duration_=void 0!==t.duration?t.duration:250}handleDragEvent(t){if(!ko(t))return;const e=t.map,i=e.getView();if(i.getConstraints().rotation===We)return;const n=e.getSize(),r=t.pixel,s=Math.atan2(n[1]/2-r[1],r[0]-n[0]/2);if(void 0!==this.lastAngle_){const t=s-this.lastAngle_;i.adjustRotationInternal(-t)}this.lastAngle_=s}handleUpEvent(t){return!ko(t)||(t.map.getView().endInteraction(this.duration_),!1)}handleDownEvent(t){return!!ko(t)&&(!(!Co(t)||!this.condition_(t))&&(t.map.getView().beginInteraction(),this.lastAngle_=void 0,!0))}},Do=class extends o{constructor(t){super(),this.geometry_=null,this.element_=document.createElement("div"),this.element_.style.position="absolute",this.element_.style.pointerEvents="auto",this.element_.className="ol-box "+t,this.map_=null,this.startPixel_=null,this.endPixel_=null}disposeInternal(){this.setMap(null)}render_(){const t=this.startPixel_,e=this.endPixel_,i="px",n=this.element_.style;n.left=Math.min(t[0],e[0])+i,n.top=Math.min(t[1],e[1])+i,n.width=Math.abs(e[0]-t[0])+i,n.height=Math.abs(e[1]-t[1])+i}setMap(t){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);const t=this.element_.style;t.left="inherit",t.top="inherit",t.width="inherit",t.height="inherit"}this.map_=t,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)}setPixels(t,e){this.startPixel_=t,this.endPixel_=e,this.createOrUpdateGeometry(),this.render_()}createOrUpdateGeometry(){const t=this.startPixel_,e=this.endPixel_,i=[t,[t[0],e[1]],e,[e[0],t[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);i[4]=i[0].slice(),this.geometry_?this.geometry_.setCoordinates([i]):this.geometry_=new Hi([i])}getGeometry(){return this.geometry_}};class Oo extends r{constructor(t,e,i){super(t),this.coordinate=e,this.mapBrowserEvent=i}}const Fo=class extends vo{constructor(t){super(),this.on,this.once,this.un,t=t||{},this.box_=new Do(t.className||"ol-dragbox"),this.minArea_=void 0!==t.minArea?t.minArea:64,t.onBoxEnd&&(this.onBoxEnd=t.onBoxEnd),this.startPixel_=null,this.condition_=t.condition?t.condition:Co,this.boxEndCondition_=t.boxEndCondition?t.boxEndCondition:this.defaultBoxEndCondition}defaultBoxEndCondition(t,e,i){const n=i[0]-e[0],r=i[1]-e[1];return n*n+r*r>=this.minArea_}getGeometry(){return this.box_.getGeometry()}handleDragEvent(t){this.box_.setPixels(this.startPixel_,t.pixel),this.dispatchEvent(new Oo("boxdrag",t.coordinate,t))}handleUpEvent(t){this.box_.setMap(null);const e=this.boxEndCondition_(t,this.startPixel_,t.pixel);return e&&this.onBoxEnd(t),this.dispatchEvent(new Oo(e?"boxend":"boxcancel",t.coordinate,t)),!1}handleDownEvent(t){return!!this.condition_(t)&&(this.startPixel_=t.pixel,this.box_.setMap(t.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new Oo("boxstart",t.coordinate,t)),!0)}onBoxEnd(t){}},zo=class extends Fo{constructor(t){super({condition:(t=t||{}).condition?t.condition:Ro,className:t.className||"ol-dragzoom",minArea:t.minArea}),this.duration_=void 0!==t.duration?t.duration:200,this.out_=void 0!==t.out&&t.out}onBoxEnd(t){const e=this.getMap().getView();let i=this.getGeometry();if(this.out_){const t=e.rotatedExtentForGeometry(i),n=e.getResolutionForExtentInternal(t),r=e.getResolution()/n;i=i.clone(),i.scale(r*r)}e.fitInternal(i,{duration:this.duration_,easing:Ke})}},Bo="ArrowLeft",Go="ArrowRight",Yo="ArrowDown",Uo=class extends wo{constructor(t){super(),t=t||{},this.defaultCondition_=function(t){return To(t)&&Ao(t)},this.condition_=void 0!==t.condition?t.condition:this.defaultCondition_,this.duration_=void 0!==t.duration?t.duration:100,this.pixelDelta_=void 0!==t.pixelDelta?t.pixelDelta:128}handleEvent(t){let e=!1;if(t.type==v){const i=t.originalEvent,n=i.key;if(this.condition_(t)&&(n==Yo||n==Bo||n==Go||"ArrowUp"==n)){const r=t.map.getView(),s=r.getResolution()*this.pixelDelta_;let o=0,a=0;n==Yo?a=-s:n==Bo?o=-s:n==Go?o=s:a=s;const l=[o,a];ge(l,r.getRotation()),function(t,e,i){const n=t.getCenterInternal();if(n){const r=[n[0]+e[0],n[1]+e[1]];t.animateInternal({duration:void 0!==i?i:250,easing:Je,center:t.getConstrainedCenter(r)})}}(r,l,this.duration_),i.preventDefault(),e=!0}}return!e}},Xo=class extends wo{constructor(t){super(),t=t||{},this.condition_=t.condition?t.condition:function(t){return!function(t){const e=t.originalEvent;return On?e.metaKey:e.ctrlKey}(t)&&Ao(t)},this.delta_=t.delta?t.delta:1,this.duration_=void 0!==t.duration?t.duration:100}handleEvent(t){let e=!1;if(t.type==v||t.type==E){const i=t.originalEvent,n=i.key;if(this.condition_(t)&&("+"===n||"-"===n)){const r=t.map,s="+"===n?this.delta_:-this.delta_;yo(r.getView(),s,void 0,this.duration_),i.preventDefault(),e=!0}}return!e}},qo=class{constructor(t,e,i){this.decay_=t,this.minVelocity_=e,this.delay_=i,this.points_=[],this.angle_=0,this.initialVelocity_=0}begin(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0}update(t,e){this.points_.push(t,e,Date.now())}end(){if(this.points_.length<6)return!1;const t=Date.now()-this.delay_,e=this.points_.length-3;if(this.points_[e+2]<t)return!1;let i=e-3;for(;i>0&&this.points_[i+2]>t;)i-=3;const n=this.points_[e+2]-this.points_[i+2];if(n<1e3/60)return!1;const r=this.points_[e]-this.points_[i],s=this.points_[e+1]-this.points_[i+1];return this.angle_=Math.atan2(s,r),this.initialVelocity_=Math.sqrt(r*r+s*s)/n,this.initialVelocity_>this.minVelocity_}getDistance(){return(this.minVelocity_-this.initialVelocity_)/this.decay_}getAngle(){return this.angle_}},Vo=class extends wo{constructor(t){super(t=t||{}),this.totalDelta_=0,this.lastDelta_=0,this.maxDelta_=void 0!==t.maxDelta?t.maxDelta:1,this.duration_=void 0!==t.duration?t.duration:250,this.timeout_=void 0!==t.timeout?t.timeout:80,this.useAnchor_=void 0===t.useAnchor||t.useAnchor,this.constrainResolution_=void 0!==t.constrainResolution&&t.constrainResolution;const e=t.condition?t.condition:Mo;this.condition_=t.onFocusOnly?Eo(Io,e):e,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_,this.mode_=void 0,this.trackpadEventGap_=400,this.trackpadTimeoutId_,this.deltaPerZoom_=300}endInteraction_(){this.trackpadTimeoutId_=void 0;const t=this.getMap();t&&t.getView().endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_)}handleEvent(t){if(!this.condition_(t))return!0;if(t.type!==I)return!0;const e=t.map,i=t.originalEvent;let n;if(i.preventDefault(),this.useAnchor_&&(this.lastAnchor_=t.coordinate),t.type==I&&(n=i.deltaY,Nn&&i.deltaMode===WheelEvent.DOM_DELTA_PIXEL&&(n/=Fn),i.deltaMode===WheelEvent.DOM_DELTA_LINE&&(n*=40)),0===n)return!1;this.lastDelta_=n;const r=Date.now();void 0===this.startTime_&&(this.startTime_=r),(!this.mode_||r-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(n)<4?"trackpad":"wheel");const s=e.getView();if("trackpad"===this.mode_&&!s.getConstrainResolution()&&!this.constrainResolution_)return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(s.getAnimating()&&s.cancelAnimations(),s.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),s.adjustZoom(-n/this.deltaPerZoom_,this.lastAnchor_),this.startTime_=r,!1;this.totalDelta_+=n;const o=Math.max(this.timeout_-(r-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,e),o),!1}handleWheelZoom_(t){const e=t.getView();e.getAnimating()&&e.cancelAnimations();let i=-$(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(e.getConstrainResolution()||this.constrainResolution_)&&(i=i?i>0?1:-1:0),yo(e,i,this.lastAnchor_,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0}setMouseAnchor(t){this.useAnchor_=t,t||(this.lastAnchor_=null)}},jo=class extends vo{constructor(t){const e=t=t||{};e.stopDown||(e.stopDown=g),super(e),this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.threshold_=void 0!==t.threshold?t.threshold:.3,this.duration_=void 0!==t.duration?t.duration:250}handleDragEvent(t){let e=0;const i=this.targetPointers[0],n=this.targetPointers[1],r=Math.atan2(n.clientY-i.clientY,n.clientX-i.clientX);if(void 0!==this.lastAngle_){const t=r-this.lastAngle_;this.rotationDelta_+=t,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),e=t}this.lastAngle_=r;const s=t.map,o=s.getView();o.getConstraints().rotation!==We&&(this.anchor_=s.getCoordinateFromPixelInternal(s.getEventPixel(bo(this.targetPointers))),this.rotating_&&(s.render(),o.adjustRotationInternal(e,this.anchor_)))}handleUpEvent(t){return!(this.targetPointers.length<2)||(t.map.getView().endInteraction(this.duration_),!1)}handleDownEvent(t){if(this.targetPointers.length>=2){const e=t.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||e.getView().beginInteraction(),!0}return!1}},Wo=class extends vo{constructor(t){const e=t=t||{};e.stopDown||(e.stopDown=g),super(e),this.anchor_=null,this.duration_=void 0!==t.duration?t.duration:400,this.lastDistance_=void 0,this.lastScaleDelta_=1}handleDragEvent(t){let e=1;const i=this.targetPointers[0],n=this.targetPointers[1],r=i.clientX-n.clientX,s=i.clientY-n.clientY,o=Math.sqrt(r*r+s*s);void 0!==this.lastDistance_&&(e=this.lastDistance_/o),this.lastDistance_=o;const a=t.map,l=a.getView();1!=e&&(this.lastScaleDelta_=e),this.anchor_=a.getCoordinateFromPixelInternal(a.getEventPixel(bo(this.targetPointers))),a.render(),l.adjustResolutionInternal(e,this.anchor_)}handleUpEvent(t){if(this.targetPointers.length<2){const e=t.map.getView(),i=this.lastScaleDelta_>1?1:-1;return e.endInteraction(this.duration_,i),!1}return!0}handleDownEvent(t){if(this.targetPointers.length>=2){const e=t.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||e.getView().beginInteraction(),!0}return!1}};function Zo(t){t instanceof nn?t.setMapInternal(null):t instanceof Ks&&t.getLayers().forEach(Zo)}function Ho(t,e){if(t instanceof nn)t.setMapInternal(e);else if(t instanceof Ks){const i=t.getLayers().getArray();for(let t=0,n=i.length;t<n;++t)Ho(i[t],e)}}const Ko=class extends D{constructor(t){super(),t=t||{},this.on,this.once,this.un;const e=function(t){let e=null;void 0!==t.keyboardEventTarget&&(e="string"==typeof t.keyboardEventTarget?document.getElementById(t.keyboardEventTarget):t.keyboardEventTarget);const i={},n=t.layers&&"function"==typeof t.layers.getLayers?t.layers:new Ks({layers:t.layers});let r,s,o;return i[so]=n,i[ao]=t.target,i[lo]=t.view instanceof tn?t.view:new tn,void 0!==t.controls&&(Array.isArray(t.controls)?r=new G(t.controls.slice()):(K("function"==typeof t.controls.getArray,"Expected `controls` to be an array or an `ol/Collection.js`"),r=t.controls)),void 0!==t.interactions&&(Array.isArray(t.interactions)?s=new G(t.interactions.slice()):(K("function"==typeof t.interactions.getArray,"Expected `interactions` to be an array or an `ol/Collection.js`"),s=t.interactions)),void 0!==t.overlays?Array.isArray(t.overlays)?o=new G(t.overlays.slice()):(K("function"==typeof t.overlays.getArray,"Expected `overlays` to be an array or an `ol/Collection.js`"),o=t.overlays):o=new G,{controls:r,interactions:s,keyboardEventTarget:e,overlays:o,values:i}}(t);this.renderComplete_,this.loaded_=!0,this.boundHandleBrowserEvent_=this.handleBrowserEvent.bind(this),this.maxTilesLoading_=void 0!==t.maxTilesLoading?t.maxTilesLoading:16,this.pixelRatio_=void 0!==t.pixelRatio?t.pixelRatio:Fn,this.postRenderTimeoutHandle_,this.animationDelayKey_,this.animationDelay_=this.animationDelay_.bind(this),this.coordinateToPixelTransform_=[1,0,0,1,0,0],this.pixelToCoordinateTransform_=[1,0,0,1,0,0],this.frameIndex_=0,this.frameState_=null,this.previousExtent_=null,this.viewPropertyListenerKey_=null,this.viewChangeListenerKey_=null,this.layerGroupPropertyListenerKeys_=null,this.viewport_=document.createElement("div"),this.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),this.viewport_.style.position="relative",this.viewport_.style.overflow="hidden",this.viewport_.style.width="100%",this.viewport_.style.height="100%",this.overlayContainer_=document.createElement("div"),this.overlayContainer_.style.position="absolute",this.overlayContainer_.style.zIndex="0",this.overlayContainer_.style.width="100%",this.overlayContainer_.style.height="100%",this.overlayContainer_.style.pointerEvents="none",this.overlayContainer_.className="ol-overlaycontainer",this.viewport_.appendChild(this.overlayContainer_),this.overlayContainerStopEvent_=document.createElement("div"),this.overlayContainerStopEvent_.style.position="absolute",this.overlayContainerStopEvent_.style.zIndex="0",this.overlayContainerStopEvent_.style.width="100%",this.overlayContainerStopEvent_.style.height="100%",this.overlayContainerStopEvent_.style.pointerEvents="none",this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",this.viewport_.appendChild(this.overlayContainerStopEvent_),this.mapBrowserEventHandler_=null,this.moveTolerance_=t.moveTolerance,this.keyboardEventTarget_=e.keyboardEventTarget,this.targetChangeHandlerKeys_=null,this.targetElement_=null,this.resizeObserver_=new ResizeObserver((()=>this.updateSize())),this.controls=e.controls||function(t){t=t||{};const e=new G;return(void 0===t.zoom||t.zoom)&&e.push(new mo(t.zoomOptions)),(void 0===t.rotate||t.rotate)&&e.push(new po(t.rotateOptions)),(void 0===t.attribution||t.attribution)&&e.push(new fo(t.attributionOptions)),e}(),this.interactions=e.interactions||function(t){t=t||{};const e=new G,i=new qo(-.005,.05,100);return(void 0===t.altShiftDragRotate||t.altShiftDragRotate)&&e.push(new No),(void 0===t.doubleClickZoom||t.doubleClickZoom)&&e.push(new xo({delta:t.zoomDelta,duration:t.zoomDuration})),(void 0===t.dragPan||t.dragPan)&&e.push(new Lo({onFocusOnly:t.onFocusOnly,kinetic:i})),(void 0===t.pinchRotate||t.pinchRotate)&&e.push(new jo),(void 0===t.pinchZoom||t.pinchZoom)&&e.push(new Wo({duration:t.zoomDuration})),(void 0===t.keyboard||t.keyboard)&&(e.push(new Uo),e.push(new Xo({delta:t.zoomDelta,duration:t.zoomDuration}))),(void 0===t.mouseWheelZoom||t.mouseWheelZoom)&&e.push(new Vo({onFocusOnly:t.onFocusOnly,duration:t.zoomDuration})),(void 0===t.shiftDragZoom||t.shiftDragZoom)&&e.push(new zo({duration:t.zoomDuration})),e}({onFocusOnly:!0}),this.overlays_=e.overlays,this.overlayIdIndex_={},this.renderer_=null,this.postRenderFunctions_=[],this.tileQueue_=new uo(this.getTilePriority.bind(this),this.handleTileChange_.bind(this)),this.addChangeListener(so,this.handleLayerGroupChanged_),this.addChangeListener(lo,this.handleViewChanged_),this.addChangeListener(oo,this.handleSizeChanged_),this.addChangeListener(ao,this.handleTargetChanged_),this.setProperties(e.values);const i=this;!t.view||t.view instanceof tn||t.view.then((function(t){i.setView(new tn(t))})),this.controls.addEventListener(O,(t=>{t.element.setMap(this)})),this.controls.addEventListener(F,(t=>{t.element.setMap(null)})),this.interactions.addEventListener(O,(t=>{t.element.setMap(this)})),this.interactions.addEventListener(F,(t=>{t.element.setMap(null)})),this.overlays_.addEventListener(O,(t=>{this.addOverlayInternal_(t.element)})),this.overlays_.addEventListener(F,(t=>{const e=t.element.getId();void 0!==e&&delete this.overlayIdIndex_[e.toString()],t.element.setMap(null)})),this.controls.forEach((t=>{t.setMap(this)})),this.interactions.forEach((t=>{t.setMap(this)})),this.overlays_.forEach(this.addOverlayInternal_.bind(this))}addControl(t){this.getControls().push(t)}addInteraction(t){this.getInteractions().push(t)}addLayer(t){this.getLayerGroup().getLayers().push(t)}handleLayerAdd_(t){Ho(t.layer,this)}addOverlay(t){this.getOverlays().push(t)}addOverlayInternal_(t){const e=t.getId();void 0!==e&&(this.overlayIdIndex_[e.toString()]=t),t.setMap(this)}disposeInternal(){this.controls.clear(),this.interactions.clear(),this.overlays_.clear(),this.resizeObserver_.disconnect(),this.setTarget(null),super.disposeInternal()}forEachFeatureAtPixel(t,e,i){if(!this.frameState_||!this.renderer_)return;const n=this.getCoordinateFromPixelInternal(t),r=void 0!==(i=void 0!==i?i:{}).hitTolerance?i.hitTolerance:0,s=void 0!==i.layerFilter?i.layerFilter:d,o=!1!==i.checkWrapped;return this.renderer_.forEachFeatureAtCoordinate(n,this.frameState_,r,o,e,null,s,null)}getFeaturesAtPixel(t,e){const i=[];return this.forEachFeatureAtPixel(t,(function(t){i.push(t)}),e),i}getAllLayers(){const t=[];return function e(i){i.forEach((function(i){i instanceof Ks?e(i.getLayers()):t.push(i)}))}(this.getLayers()),t}hasFeatureAtPixel(t,e){if(!this.frameState_||!this.renderer_)return!1;const i=this.getCoordinateFromPixelInternal(t),n=void 0!==(e=void 0!==e?e:{}).layerFilter?e.layerFilter:d,r=void 0!==e.hitTolerance?e.hitTolerance:0,s=!1!==e.checkWrapped;return this.renderer_.hasFeatureAtCoordinate(i,this.frameState_,r,s,n,null)}getEventCoordinate(t){return this.getCoordinateFromPixel(this.getEventPixel(t))}getEventCoordinateInternal(t){return this.getCoordinateFromPixelInternal(this.getEventPixel(t))}getEventPixel(t){const e=this.viewport_.getBoundingClientRect(),i=this.getSize(),n=e.width/i[0],r=e.height/i[1],s="changedTouches"in t?t.changedTouches[0]:t;return[(s.clientX-e.left)/n,(s.clientY-e.top)/r]}getTarget(){return this.get(ao)}getTargetElement(){return this.targetElement_}getCoordinateFromPixel(t){return Ne(this.getCoordinateFromPixelInternal(t),this.getView().getProjection())}getCoordinateFromPixelInternal(t){const e=this.frameState_;return e?Qe(e.pixelToCoordinateTransform,t.slice()):null}getControls(){return this.controls}getOverlays(){return this.overlays_}getOverlayById(t){const e=this.overlayIdIndex_[t.toString()];return void 0!==e?e:null}getInteractions(){return this.interactions}getLayerGroup(){return this.get(so)}setLayers(t){const e=this.getLayerGroup();if(t instanceof G)return void e.setLayers(t);const i=e.getLayers();i.clear(),i.extend(t)}getLayers(){return this.getLayerGroup().getLayers()}getLoadingOrNotReady(){const t=this.getLayerGroup().getLayerStatesArray();for(let e=0,i=t.length;e<i;++e){const i=t[e];if(!i.visible)continue;const n=i.layer.getRenderer();if(n&&!n.ready)return!0;const r=i.layer.getSource();if(r&&r.loading)return!0}return!1}getPixelFromCoordinate(t){const e=De(t,this.getView().getProjection());return this.getPixelFromCoordinateInternal(e)}getPixelFromCoordinateInternal(t){const e=this.frameState_;return e?Qe(e.coordinateToPixelTransform,t.slice(0,2)):null}getRenderer(){return this.renderer_}getSize(){return this.get(oo)}getView(){return this.get(lo)}getViewport(){return this.viewport_}getOverlayContainer(){return this.overlayContainer_}getOverlayContainerStopEvent(){return this.overlayContainerStopEvent_}getOwnerDocument(){const t=this.getTargetElement();return t?t.ownerDocument:document}getTilePriority(t,e,i,n){return function(t,e,i,n,r){if(!t||!(i in t.wantedTiles))return ho;if(!t.wantedTiles[i][e.getKey()])return ho;const s=t.viewState.center,o=n[0]-s[0],a=n[1]-s[1];return 65536*Math.log(r)+Math.sqrt(o*o+a*a)/r}(this.frameState_,t,e,i,n)}handleBrowserEvent(t,e){e=e||t.type;const i=new Js(e,this,t);this.handleMapBrowserEvent(i)}handleMapBrowserEvent(t){if(!this.frameState_)return;const e=t.originalEvent,i=e.type;if(i===to||i===I||i===v){const t=this.getOwnerDocument(),i=this.viewport_.getRootNode?this.viewport_.getRootNode():t,n=e.target;if(this.overlayContainerStopEvent_.contains(n)||!(i===t?t.documentElement:i).contains(n))return}if(t.frameState=this.frameState_,!1!==this.dispatchEvent(t)){const e=this.getInteractions().getArray().slice();for(let i=e.length-1;i>=0;i--){const n=e[i];if(n.getMap()===this&&n.getActive()&&this.getTargetElement()&&(!n.handleEvent(t)||t.propagationStopped))break}}}handlePostRender(){const t=this.frameState_,e=this.tileQueue_;if(!e.isEmpty()){let i=this.maxTilesLoading_,n=i;if(t){const e=t.viewHints;if(e[0]||e[1]){const e=Date.now()-t.time>8;i=e?0:8,n=e?0:2}}e.getTilesLoading()<i&&(e.reprioritize(),e.loadMoreTiles(i,n))}t&&this.renderer_&&!t.animate&&(!0===this.renderComplete_?(this.hasListener(ut)&&this.renderer_.dispatchRenderEvent(ut,t),!1===this.loaded_&&(this.loaded_=!0,this.dispatchEvent(new $s(ro,this,t)))):!0===this.loaded_&&(this.loaded_=!1,this.dispatchEvent(new $s(no,this,t))));const i=this.postRenderFunctions_;for(let e=0,n=i.length;e<n;++e)i[e](this,t);i.length=0}handleSizeChanged_(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()}handleTargetChanged_(){if(this.mapBrowserEventHandler_){for(let t=0,e=this.targetChangeHandlerKeys_.length;t<e;++t)T(this.targetChangeHandlerKeys_[t]);this.targetChangeHandlerKeys_=null,this.viewport_.removeEventListener(x,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(I,this.boundHandleBrowserEvent_),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,jn(this.viewport_)}if(this.targetElement_){this.resizeObserver_.unobserve(this.targetElement_);const t=this.targetElement_.getRootNode();t instanceof ShadowRoot&&this.resizeObserver_.unobserve(t.host),this.setSize(void 0)}const t=this.getTarget(),e="string"==typeof t?document.getElementById(t):t;if(this.targetElement_=e,e){e.appendChild(this.viewport_),this.renderer_||(this.renderer_=new js(this)),this.mapBrowserEventHandler_=new eo(this,this.moveTolerance_);for(const t in Qs)this.mapBrowserEventHandler_.addEventListener(Qs[t],this.handleMapBrowserEvent.bind(this));this.viewport_.addEventListener(x,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(I,this.boundHandleBrowserEvent_,!!Gn&&{passive:!1});const t=this.keyboardEventTarget_?this.keyboardEventTarget_:e;this.targetChangeHandlerKeys_=[M(t,v,this.handleBrowserEvent,this),M(t,E,this.handleBrowserEvent,this)];const i=e.getRootNode();i instanceof ShadowRoot&&this.resizeObserver_.observe(i.host),this.resizeObserver_.observe(e)}else this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);this.updateSize()}handleTileChange_(){this.render()}handleViewPropertyChanged_(){this.render()}handleViewChanged_(){this.viewPropertyListenerKey_&&(T(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(T(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);const t=this.getView();t&&(this.updateViewportSize_(this.getSize()),this.viewPropertyListenerKey_=M(t,s,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=M(t,w,this.handleViewPropertyChanged_,this),t.resolveConstraints(0)),this.render()}handleLayerGroupChanged_(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(T),this.layerGroupPropertyListenerKeys_=null);const t=this.getLayerGroup();t&&(this.handleLayerAdd_(new Ws("addlayer",t)),this.layerGroupPropertyListenerKeys_=[M(t,s,this.render,this),M(t,w,this.render,this),M(t,"addlayer",this.handleLayerAdd_,this),M(t,"removelayer",this.handleLayerRemove_,this)]),this.render()}isRendered(){return!!this.frameState_}animationDelay_(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}renderSync(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()}redrawText(){const t=this.getLayerGroup().getLayerStatesArray();for(let e=0,i=t.length;e<i;++e){const i=t[e].layer;i.hasRenderer()&&i.getRenderer().handleFontsChanged()}}render(){this.renderer_&&void 0===this.animationDelayKey_&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))}removeControl(t){return this.getControls().remove(t)}removeInteraction(t){return this.getInteractions().remove(t)}removeLayer(t){return this.getLayerGroup().getLayers().remove(t)}handleLayerRemove_(t){Zo(t.layer)}removeOverlay(t){return this.getOverlays().remove(t)}renderFrame_(t){const e=this.getSize(),i=this.getView(),n=this.frameState_;let r=null;if(void 0!==e&&hn(e)&&i&&i.isDef()){const n=i.getHints(this.frameState_?this.frameState_.viewHints:void 0),s=i.getState();if(r={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutter:null,extent:ee(s.center,s.resolution,s.rotation,e),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:e,tileQueue:this.tileQueue_,time:t,usedTiles:{},viewState:s,viewHints:n,wantedTiles:{},mapId:L(this),renderTargets:{}},s.nextCenter&&s.nextResolution){const t=isNaN(s.nextRotation)?s.rotation:s.nextRotation;r.nextExtent=ee(s.nextCenter,s.nextResolution,t,e)}}this.frameState_=r,this.renderer_.renderFrame(r),r&&(r.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,r.postRenderFunctions),n&&(!this.previousExtent_||!he(this.previousExtent_)&&!qt(r.extent,this.previousExtent_))&&(this.dispatchEvent(new $s("movestart",this,n)),this.previousExtent_=Yt(this.previousExtent_)),this.previousExtent_&&!r.viewHints[0]&&!r.viewHints[1]&&!qt(r.extent,this.previousExtent_)&&(this.dispatchEvent(new $s("moveend",this,r)),Nt(r.extent,this.previousExtent_))),this.dispatchEvent(new $s(io,this,r)),this.renderComplete_=this.hasListener(no)||this.hasListener(ro)||this.hasListener(ut)?!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoadingOrNotReady():void 0,this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout((()=>{this.postRenderTimeoutHandle_=void 0,this.handlePostRender()}),0))}setLayerGroup(t){const e=this.getLayerGroup();e&&this.handleLayerRemove_(new Ws("removelayer",e)),this.set(so,t)}setSize(t){this.set(oo,t)}setTarget(t){this.set(ao,t)}setView(t){if(!t||t instanceof tn)return void this.set(lo,t);this.set(lo,new tn);const e=this;t.then((function(t){e.setView(new tn(t))}))}updateSize(){const t=this.getTargetElement();let e;if(t){const i=getComputedStyle(t),n=t.offsetWidth-parseFloat(i.borderLeftWidth)-parseFloat(i.paddingLeft)-parseFloat(i.paddingRight)-parseFloat(i.borderRightWidth),r=t.offsetHeight-parseFloat(i.borderTopWidth)-parseFloat(i.paddingTop)-parseFloat(i.paddingBottom)-parseFloat(i.borderBottomWidth);isNaN(n)||isNaN(r)||(e=[n,r],!hn(e)&&(t.offsetWidth||t.offsetHeight||t.getClientRects().length)&&we("No map visible because the map container's width or height are 0."))}const i=this.getSize();!e||i&&u(e,i)||(this.setSize(e),this.updateViewportSize_(e))}updateViewportSize_(t){const e=this.getView();e&&e.setViewportSize(t)}},$o="preload",Jo="useInterimTilesOnError",Qo=class extends nn{constructor(t){t=t||{};const e=Object.assign({},t);delete e.preload,delete e.useInterimTilesOnError,super(e),this.on,this.once,this.un,this.setPreload(void 0!==t.preload?t.preload:0),this.setUseInterimTilesOnError(void 0===t.useInterimTilesOnError||t.useInterimTilesOnError)}getPreload(){return this.get($o)}setPreload(t){this.set($o,t)}getUseInterimTilesOnError(){return this.get(Jo)}setUseInterimTilesOnError(t){this.set(Jo,t)}getData(t){return super.getData(t)}},ta=class extends A{constructor(t){super(),this.ready=!0,this.boundHandleImageChange_=this.handleImageChange_.bind(this),this.layer_=t,this.declutterExecutorGroup=null}getFeatures(t){return k()}getData(t){return null}prepareFrame(t){return k()}renderFrame(t,e){return k()}loadedTileCallback(t,e,i){t[e]||(t[e]={}),t[e][i.tileCoord.toString()]=i}createLoadedTileFinder(t,e,i){return(n,r)=>{const s=this.loadedTileCallback.bind(this,i,n);return t.forEachLoadedTile(e,n,r,s)}}forEachFeatureAtCoordinate(t,e,i,n,r){}getLayer(){return this.layer_}handleFontsChanged(){}handleImageChange_(t){const e=t.target;e.getState()!==an&&e.getState()!==ln||this.renderIfReadyAndVisible()}loadImage(t){let e=t.getState();return e!=an&&e!=ln&&t.addEventListener(w,this.boundHandleImageChange_),e==sn&&(t.load(),e=t.getState()),e==an}renderIfReadyAndVisible(){const t=this.getLayer();t&&t.getVisible()&&"ready"===t.getSourceState()&&t.changed()}renderDeferred(t){}disposeInternal(){delete this.layer_,super.disposeInternal()}},ea=class{constructor(){this.instructions_=[],this.zIndex=0,this.offset_=0,this.context_=new Proxy(CanvasRenderingContext2D.prototype,{get:(t,e)=>{if("function"==typeof Xn()[e])return this.instructions_[this.zIndex+this.offset_]||(this.instructions_[this.zIndex+this.offset_]=[]),this.instructions_[this.zIndex+this.offset_].push(e),this.pushMethodArgs_},set:(t,e,i)=>(this.instructions_[this.zIndex+this.offset_]||(this.instructions_[this.zIndex+this.offset_]=[]),this.instructions_[this.zIndex+this.offset_].push(e,i),!0)})}pushMethodArgs_=(...t)=>(this.instructions_[this.zIndex+this.offset_].push(t),this);getContext(){return this.context_}draw(t){this.instructions_.forEach((e=>{for(let i=0,n=e.length;i<n;i+=2){const n=e[i],r=e[i+1];if("function"==typeof t[n])t[n](...r);else{if("function"==typeof r){t[n]=r(t);continue}t[n]=r}}}))}clear(){this.instructions_.length=0,this.zIndex=0,this.offset_=0}offset(){this.offset_=this.instructions_.length,this.zIndex=0}},ia=[];let na=null;const ra=class extends ta{constructor(t){super(t),this.container=null,this.renderedResolution,this.tempTransform=[1,0,0,1,0,0],this.pixelTransform=[1,0,0,1,0,0],this.inversePixelTransform=[1,0,0,1,0,0],this.context=null,this.deferredContext_=null,this.containerReused=!1,this.pixelContext_=null,this.frameState=null}getImageData(t,e,i){let n;na||(na=Yn(1,1,void 0,{willReadFrequently:!0})),na.clearRect(0,0,1,1);try{na.drawImage(t,e,i,1,1,0,0,1,1),n=na.getImageData(0,0,1,1).data}catch(t){return na=null,null}return n}getBackground(t){let e=this.getLayer().getBackground();return"function"==typeof e&&(e=e(t.viewState.resolution)),e||void 0}useContainer(t,e,i){const n=this.getLayer().getClassName();let r,s;if(t&&t.className===n&&(!i||t&&t.style.backgroundColor&&u(An(t.style.backgroundColor),An(i)))){const e=t.firstElementChild;e instanceof HTMLCanvasElement&&(s=e.getContext("2d"))}if(s&&s.canvas.style.transform===e?(this.container=t,this.context=s,this.containerReused=!0):this.containerReused?(this.container=null,this.context=null,this.containerReused=!1):this.container&&(this.container.style.backgroundColor=null),!this.container){r=document.createElement("div"),r.className=n;let t=r.style;t.position="absolute",t.width="100%",t.height="100%",s=Yn();const e=s.canvas;r.appendChild(e),t=e.style,t.position="absolute",t.left="0",t.transformOrigin="top left",this.container=r,this.context=s}this.containerReused||!i||this.container.style.backgroundColor||(this.container.style.backgroundColor=i)}clipUnrotated(t,e,i){const n=se(i),r=oe(i),s=Jt(i),o=$t(i);Qe(e.coordinateToPixelTransform,n),Qe(e.coordinateToPixelTransform,r),Qe(e.coordinateToPixelTransform,s),Qe(e.coordinateToPixelTransform,o);const a=this.inversePixelTransform;Qe(a,n),Qe(a,r),Qe(a,s),Qe(a,o),t.save(),t.beginPath(),t.moveTo(Math.round(n[0]),Math.round(n[1])),t.lineTo(Math.round(r[0]),Math.round(r[1])),t.lineTo(Math.round(s[0]),Math.round(s[1])),t.lineTo(Math.round(o[0]),Math.round(o[1])),t.clip()}dispatchRenderEvent_(t,e,i){const n=this.getLayer();if(n.hasListener(t)){const r=new Vs(t,this.inversePixelTransform,i,e);n.dispatchEvent(r)}}preRender(t,e){this.frameState=e,e.declutter||this.dispatchRenderEvent_(lt,t,e)}postRender(t,e){e.declutter||this.dispatchRenderEvent_(ht,t,e)}renderDeferredInternal(t){}getRenderContext(t){return t.declutter&&!this.deferredContext_&&(this.deferredContext_=new ea),t.declutter?this.deferredContext_.getContext():this.context}renderDeferred(t){t.declutter&&(this.dispatchRenderEvent_(lt,this.context,t),t.declutter&&this.deferredContext_&&(this.deferredContext_.draw(this.context),this.deferredContext_.clear()),this.renderDeferredInternal(t),this.dispatchRenderEvent_(ht,this.context,t))}getRenderTransform(t,e,i,n,r,s,o){const a=r/2,l=s/2,h=n/e,c=-h,u=-t[0]+o,d=-t[1];return ti(this.tempTransform,a,l,h,c,-i,u,d)}disposeInternal(){delete this.frameState,super.disposeInternal()}},sa=class extends y{constructor(t,e,i){super(),i=i||{},this.tileCoord=t,this.state=e,this.interimTile=null,this.key="",this.transition_=void 0===i.transition?250:i.transition,this.transitionStarts_={},this.interpolate=!!i.interpolate}changed(){this.dispatchEvent(w)}release(){3===this.state&&this.setState(4)}getKey(){return this.key+"/"+this.tileCoord}getInterimTile(){let t=this.interimTile;if(!t)return this;do{if(2==t.getState())return this.transition_=0,t;t=t.interimTile}while(t);return this}refreshInterimChain(){let t=this.interimTile;if(!t)return;let e=this;do{if(2==t.getState()){t.interimTile=null;break}1==t.getState()?e=t:0==t.getState()?e.interimTile=t.interimTile:e=t,t=e.interimTile}while(t)}getTileCoord(){return this.tileCoord}getState(){return this.state}setState(t){if(3!==this.state&&this.state>t)throw new Error("Tile load sequence violation");this.state=t,this.changed()}load(){k()}getAlpha(t,e){if(!this.transition_)return 1;let i=this.transitionStarts_[t];if(i){if(-1===i)return 1}else i=e,this.transitionStarts_[t]=i;const n=e-i+1e3/60;return n>=this.transition_?1:He(n/this.transition_)}inTransition(t){return!!this.transition_&&-1!==this.transitionStarts_[t]}endTransition(t){this.transition_&&(this.transitionStarts_[t]=-1)}},oa=class extends sa{constructor(t,e,i,n,r,s){super(t,e,s),this.crossOrigin_=n,this.src_=i,this.key=i,this.image_=new Image,null!==n&&(this.image_.crossOrigin=n),this.unlisten_=null,this.tileLoadFunction_=r}getImage(){return this.image_}setImage(t){this.image_=t,this.state=2,this.unlistenImage_(),this.changed()}handleImageError_(){this.state=3,this.unlistenImage_(),this.image_=function(){const t=Yn(1,1);return t.fillStyle="rgba(0,0,0,0)",t.fillRect(0,0,1,1),t.canvas}(),this.changed()}handleImageLoad_(){const t=this.image_;t.naturalWidth&&t.naturalHeight?this.state=2:this.state=4,this.unlistenImage_(),this.changed()}load(){3==this.state&&(this.state=0,this.image_=new Image,null!==this.crossOrigin_&&(this.image_.crossOrigin=this.crossOrigin_)),0==this.state&&(this.state=1,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=function(t,e,i){const n=t;let r=!0,s=!1,o=!1;const a=[C(n,"load",(function(){o=!0,s||e()}))];return n.src&&Bn?(s=!0,n.decode().then((function(){r&&e()})).catch((function(t){r&&(o?e():i())}))):a.push(C(n,"error",i)),function(){r=!1,a.forEach(T)}}(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}},aa=class{constructor(t,e,i,n,r,s){this.sourceProj_=t,this.targetProj_=e;let o={};const a=Ae(this.targetProj_,this.sourceProj_);this.transformInv_=function(t){const e=t[0]+"/"+t[1];return o[e]||(o[e]=a(t)),o[e]},this.maxSourceExtent_=n,this.errorThresholdSquared_=r*r,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!n&&!!this.sourceProj_.getExtent()&&ae(n)>=ae(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?ae(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?ae(this.targetProj_.getExtent()):null;const l=se(i),h=oe(i),c=Jt(i),u=$t(i),d=this.transformInv_(l),g=this.transformInv_(h),f=this.transformInv_(c),p=this.transformInv_(u),m=10+(s?Math.max(0,Math.ceil(Math.log2(Kt(i)/(s*s*256*256)))):0);if(this.addQuad_(l,h,c,u,d,g,f,p,m),this.wrapsXInSource_){let t=1/0;this.triangles_.forEach((function(e,i,n){t=Math.min(t,e.source[0][0],e.source[1][0],e.source[2][0])})),this.triangles_.forEach((e=>{if(Math.max(e.source[0][0],e.source[1][0],e.source[2][0])-t>this.sourceWorldWidth_/2){const i=[[e.source[0][0],e.source[0][1]],[e.source[1][0],e.source[1][1]],[e.source[2][0],e.source[2][1]]];i[0][0]-t>this.sourceWorldWidth_/2&&(i[0][0]-=this.sourceWorldWidth_),i[1][0]-t>this.sourceWorldWidth_/2&&(i[1][0]-=this.sourceWorldWidth_),i[2][0]-t>this.sourceWorldWidth_/2&&(i[2][0]-=this.sourceWorldWidth_);const n=Math.min(i[0][0],i[1][0],i[2][0]);Math.max(i[0][0],i[1][0],i[2][0])-n<this.sourceWorldWidth_/2&&(e.source=i)}}))}o={}}addTriangle_(t,e,i,n,r,s){this.triangles_.push({source:[n,r,s],target:[t,e,i]})}addQuad_(t,e,i,n,r,s,o,a,l){const h=Pt([r,s,o,a]),c=this.sourceWorldWidth_?ae(h)/this.sourceWorldWidth_:null,u=this.sourceWorldWidth_,d=this.sourceProj_.canWrapX()&&c>.5&&c<1;let g=!1;if(l>0&&(this.targetProj_.isGlobal()&&this.targetWorldWidth_&&(g=ae(Pt([t,e,i,n]))/this.targetWorldWidth_>.25||g),!d&&this.sourceProj_.isGlobal()&&c&&(g=c>.25||g)),!g&&this.maxSourceExtent_&&isFinite(h[0])&&isFinite(h[1])&&isFinite(h[2])&&isFinite(h[3])&&!le(h,this.maxSourceExtent_))return;let f=0;if(!(g||isFinite(r[0])&&isFinite(r[1])&&isFinite(s[0])&&isFinite(s[1])&&isFinite(o[0])&&isFinite(o[1])&&isFinite(a[0])&&isFinite(a[1])))if(l>0)g=!0;else if(f=(isFinite(r[0])&&isFinite(r[1])?0:8)+(isFinite(s[0])&&isFinite(s[1])?0:4)+(isFinite(o[0])&&isFinite(o[1])?0:2)+(isFinite(a[0])&&isFinite(a[1])?0:1),1!=f&&2!=f&&4!=f&&8!=f)return;if(l>0){if(!g){const e=[(t[0]+i[0])/2,(t[1]+i[1])/2],n=this.transformInv_(e);let s;s=d?(et(r[0],u)+et(o[0],u))/2-et(n[0],u):(r[0]+o[0])/2-n[0];const a=(r[1]+o[1])/2-n[1];g=s*s+a*a>this.errorThresholdSquared_}if(g){if(Math.abs(t[0]-i[0])<=Math.abs(t[1]-i[1])){const h=[(e[0]+i[0])/2,(e[1]+i[1])/2],c=this.transformInv_(h),u=[(n[0]+t[0])/2,(n[1]+t[1])/2],d=this.transformInv_(u);this.addQuad_(t,e,h,u,r,s,c,d,l-1),this.addQuad_(u,h,i,n,d,c,o,a,l-1)}else{const h=[(t[0]+e[0])/2,(t[1]+e[1])/2],c=this.transformInv_(h),u=[(i[0]+n[0])/2,(i[1]+n[1])/2],d=this.transformInv_(u);this.addQuad_(t,h,u,n,r,c,d,a,l-1),this.addQuad_(h,e,i,u,c,s,o,d,l-1)}return}}if(d){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}0==(11&f)&&this.addTriangle_(t,i,n,r,o,a),0==(14&f)&&this.addTriangle_(t,i,e,r,o,s),f&&(0==(13&f)&&this.addTriangle_(e,n,t,s,a,r),0==(7&f)&&this.addTriangle_(e,n,i,s,a,o))}calculateSourceExtent(){const t=[1/0,1/0,-1/0,-1/0];return this.triangles_.forEach((function(e,i,n){const r=e.source;jt(t,r[0]),jt(t,r[1]),jt(t,r[2])})),t}getTriangles(){return this.triangles_}};let la;const ha=[];function ca(t,e,i,n,r){t.beginPath(),t.moveTo(0,0),t.lineTo(e,i),t.lineTo(n,r),t.closePath(),t.save(),t.clip(),t.fillRect(0,0,Math.max(e,n)+1,Math.max(i,r)),t.restore()}function ua(t,e){return Math.abs(t[4*e]-210)>2||Math.abs(t[4*e+3]-191.25)>2}function da(t,e,i,n){const r=ke(i,e,t);let s=Ie(e,n,i);const o=e.getMetersPerUnit();void 0!==o&&(s*=o);const a=t.getMetersPerUnit();void 0!==a&&(s/=a);const l=t.getExtent();if(!l||Ot(l,r)){const e=Ie(t,s,r)/s;isFinite(e)&&e>0&&(s/=e)}return s}const ga=class extends sa{constructor(t,e,i,n,r,s,o,a,l,h,c,u){super(r,0,u),this.renderEdges_=void 0!==c&&c,this.pixelRatio_=o,this.gutter_=a,this.canvas_=null,this.sourceTileGrid_=e,this.targetTileGrid_=n,this.wrappedTileCoord_=s||r,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0;const d=n.getTileCoordExtent(this.wrappedTileCoord_),g=this.targetTileGrid_.getExtent();let f=this.sourceTileGrid_.getExtent();const p=g?re(d,g):d;if(0===Kt(p))return void(this.state=4);const m=t.getExtent();m&&(f=f?re(f,m):m);const _=n.getResolution(this.wrappedTileCoord_[0]),y=function(t,e,i,n){const r=Qt(i);let s=da(t,e,r,n);return(!isFinite(s)||s<=0)&&Ht(i,(function(i){return s=da(t,e,i,n),isFinite(s)&&s>0})),s}(t,i,p,_);if(!isFinite(y)||y<=0)return void(this.state=4);const w=void 0!==h?h:.5;if(this.triangulation_=new aa(t,i,p,f,y*w,_),0===this.triangulation_.getTriangles().length)return void(this.state=4);this.sourceZ_=e.getZForResolution(y);let x=this.triangulation_.calculateSourceExtent();if(f&&(t.canWrapX()?(x[1]=$(x[1],f[1],f[3]),x[3]=$(x[3],f[1],f[3])):x=re(x,f)),Kt(x)){const t=e.getTileRangeForExtentAndZ(x,this.sourceZ_);for(let e=t.minX;e<=t.maxX;e++)for(let i=t.minY;i<=t.maxY;i++){const t=l(this.sourceZ_,e,i,o);t&&this.sourceTiles_.push(t)}0===this.sourceTiles_.length&&(this.state=4)}else this.state=4}getImage(){return this.canvas_}reproject_(){const t=[];if(this.sourceTiles_.forEach((e=>{e&&2==e.getState()&&t.push({extent:this.sourceTileGrid_.getTileCoordExtent(e.tileCoord),image:e.getImage()})})),this.sourceTiles_.length=0,0===t.length)this.state=3;else{const e=this.wrappedTileCoord_[0],i=this.targetTileGrid_.getTileSize(e),n="number"==typeof i?i:i[0],r="number"==typeof i?i:i[1],s=this.targetTileGrid_.getResolution(e),o=this.sourceTileGrid_.getResolution(this.sourceZ_),a=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=function(t,e,i,n,r,s,o,a,l,h,c,u,d,g){const f=Yn(Math.round(i*t),Math.round(i*e),ha);if(u||(f.imageSmoothingEnabled=!1),0===l.length)return f.canvas;function p(t){return Math.round(t*i)/i}f.scale(i,i),f.globalCompositeOperation="lighter";const m=[1/0,1/0,-1/0,-1/0];let _;l.forEach((function(t,e,i){Vt(m,t.extent)}));const y=i/n,w=(u?1:1+Math.pow(2,-24))/y;if(!d||1!==l.length||0!==h){if(_=Yn(Math.round(ae(m)*y),Math.round(ne(m)*y),ha),u||(_.imageSmoothingEnabled=!1),r&&g){const t=(r[0]-m[0])*y,e=-(r[3]-m[3])*y,i=ae(r)*y,n=ne(r)*y;_.rect(t,e,i,n),_.clip()}l.forEach((function(t,e,i){const n=(t.extent[0]-m[0])*y,r=-(t.extent[3]-m[3])*y,s=ae(t.extent)*y,o=ne(t.extent)*y;t.image.width>0&&t.image.height>0&&_.drawImage(t.image,h,h,t.image.width-2*h,t.image.height-2*h,u?n:Math.round(n),u?r:Math.round(r),u?s:Math.round(n+s)-Math.round(n),u?o:Math.round(r+o)-Math.round(r))}))}const x=se(o);return a.getTriangles().forEach((function(t,e,i){const n=t.source,r=t.target;let o=n[0][0],a=n[0][1],h=n[1][0],c=n[1][1],d=n[2][0],g=n[2][1];const y=p((r[0][0]-x[0])/s),b=p(-(r[0][1]-x[1])/s),v=p((r[1][0]-x[0])/s),E=p(-(r[1][1]-x[1])/s),S=p((r[2][0]-x[0])/s),I=p(-(r[2][1]-x[1])/s),M=o,C=a;o=0,a=0,h-=M,c-=C,d-=M,g-=C;const T=function(t){const e=t.length;for(let i=0;i<e;i++){let n=i,r=Math.abs(t[i][i]);for(let s=i+1;s<e;s++){const e=Math.abs(t[s][i]);e>r&&(r=e,n=s)}if(0===r)return null;const s=t[n];t[n]=t[i],t[i]=s;for(let n=i+1;n<e;n++){const r=-t[n][i]/t[i][i];for(let s=i;s<e+1;s++)i==s?t[n][s]=0:t[n][s]+=r*t[i][s]}}const i=new Array(e);for(let n=e-1;n>=0;n--){i[n]=t[n][e]/t[n][n];for(let r=n-1;r>=0;r--)t[r][e]-=t[r][n]*i[n]}return i}([[h,c,0,0,v-y],[d,g,0,0,S-y],[0,0,h,c,E-b],[0,0,d,g,I-b]]);if(!T)return;if(f.save(),f.beginPath(),function(){if(void 0===la){const t=Yn(6,6,ha);t.globalCompositeOperation="lighter",t.fillStyle="rgba(210, 0, 0, 0.75)",ca(t,4,5,4,0),ca(t,4,5,0,5);const e=t.getImageData(0,0,3,3).data;la=ua(e,0)||ua(e,4)||ua(e,8),qn(t),ha.push(t.canvas)}return la}()||!u){f.moveTo(v,E);const t=4,e=y-v,i=b-E;for(let n=0;n<t;n++)f.lineTo(v+p((n+1)*e/t),E+p(n*i/(t-1))),n!=t-1&&f.lineTo(v+p((n+1)*e/t),E+p((n+1)*i/(t-1)));f.lineTo(S,I)}else f.moveTo(v,E),f.lineTo(y,b),f.lineTo(S,I);let R;if(f.clip(),f.transform(T[0],T[2],T[1],T[3],y,b),f.translate(m[0]-M,m[3]-C),_)R=_.canvas,f.scale(w,-w);else{const t=l[0],e=t.extent;R=t.image,f.scale(ae(e)/R.width,-ne(e)/R.height)}f.drawImage(R,0,0),f.restore()})),_&&(qn(_),ha.push(_.canvas)),c&&(f.save(),f.globalCompositeOperation="source-over",f.strokeStyle="black",f.lineWidth=1,a.getTriangles().forEach((function(t,e,i){const n=t.target,r=(n[0][0]-x[0])/s,o=-(n[0][1]-x[1])/s,a=(n[1][0]-x[0])/s,l=-(n[1][1]-x[1])/s,h=(n[2][0]-x[0])/s,c=-(n[2][1]-x[1])/s;f.beginPath(),f.moveTo(a,l),f.lineTo(r,o),f.lineTo(h,c),f.closePath(),f.stroke()})),f.restore()),f.canvas}(n,r,this.pixelRatio_,o,this.sourceTileGrid_.getExtent(),s,a,this.triangulation_,t,this.gutter_,this.renderEdges_,this.interpolate),this.state=2}this.changed()}load(){if(0==this.state){this.state=1,this.changed();let t=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach((e=>{const i=e.getState();if(0==i||1==i){t++;const i=M(e,w,(function(n){const r=e.getState();2!=r&&3!=r&&4!=r||(T(i),t--,0===t&&(this.unlistenSources_(),this.reproject_()))}),this);this.sourcesListenerKeys_.push(i)}})),0===t?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach((function(t,e,i){0==t.getState()&&t.load()}))}}unlistenSources_(){this.sourcesListenerKeys_.forEach(T),this.sourcesListenerKeys_=null}release(){this.canvas_&&(qn(this.canvas_.getContext("2d")),ha.push(this.canvas_),this.canvas_=null),super.release()}};class fa{constructor(t,e,i,n){this.minX=t,this.maxX=e,this.minY=i,this.maxY=n}contains(t){return this.containsXY(t[1],t[2])}containsTileRange(t){return this.minX<=t.minX&&t.maxX<=this.maxX&&this.minY<=t.minY&&t.maxY<=this.maxY}containsXY(t,e){return this.minX<=t&&t<=this.maxX&&this.minY<=e&&e<=this.maxY}equals(t){return this.minX==t.minX&&this.minY==t.minY&&this.maxX==t.maxX&&this.maxY==t.maxY}extend(t){t.minX<this.minX&&(this.minX=t.minX),t.maxX>this.maxX&&(this.maxX=t.maxX),t.minY<this.minY&&(this.minY=t.minY),t.maxY>this.maxY&&(this.maxY=t.maxY)}getHeight(){return this.maxY-this.minY+1}getSize(){return[this.getWidth(),this.getHeight()]}getWidth(){return this.maxX-this.minX+1}intersects(t){return this.minX<=t.maxX&&this.maxX>=t.minX&&this.minY<=t.maxY&&this.maxY>=t.minY}}function pa(t,e,i,n,r){return void 0!==r?(r.minX=t,r.maxX=e,r.minY=i,r.maxY=n,r):new fa(t,e,i,n)}const ma=fa,_a=class extends ra{constructor(t){super(t),this.extentChanged=!0,this.renderedExtent_=null,this.renderedPixelRatio,this.renderedProjection=null,this.renderedRevision,this.renderedTiles=[],this.newTiles_=!1,this.tmpExtent=[1/0,1/0,-1/0,-1/0],this.tmpTileRange_=new ma(0,0,0,0)}isDrawableTile(t){const e=this.getLayer(),i=t.getState(),n=e.getUseInterimTilesOnError();return 2==i||4==i||3==i&&!n}getTile(t,e,i,n){const r=n.pixelRatio,s=n.viewState.projection,o=this.getLayer();let a=o.getSource().getTile(t,e,i,r,s);return 3==a.getState()&&o.getUseInterimTilesOnError()&&o.getPreload()>0&&(this.newTiles_=!0),this.isDrawableTile(a)||(a=a.getInterimTile()),a}getData(t){const e=this.frameState;if(!e)return null;const i=this.getLayer(),n=Qe(e.pixelToCoordinateTransform,t.slice()),r=i.getExtent();if(r&&!Ot(r,n))return null;const s=e.pixelRatio,o=e.viewState.projection,a=e.viewState,l=i.getRenderSource(),h=l.getTileGridForProjection(a.projection),c=l.getTilePixelRatio(e.pixelRatio);for(let t=h.getZForResolution(a.resolution);t>=h.getMinZoom();--t){const e=h.getTileCoordForCoordAndZ(n,t),i=l.getTile(t,e[1],e[2],s,o);if(!(i instanceof oa||i instanceof ga)||i instanceof ga&&4===i.getState())return null;if(2!==i.getState())continue;const r=h.getOrigin(t),u=un(h.getTileSize(t)),d=h.getResolution(t),g=Math.floor(c*((n[0]-r[0])/d-e[1]*u[0])),f=Math.floor(c*((r[1]-n[1])/d-e[2]*u[1])),p=Math.round(c*l.getGutterForProjection(a.projection));return this.getImageData(i.getImage(),g+p,f+p)}return null}loadedTileCallback(t,e,i){return!!this.isDrawableTile(i)&&super.loadedTileCallback(t,e,i)}prepareFrame(t){return!!this.getLayer().getSource()}renderFrame(t,e){const i=t.layerStatesArray[t.layerIndex],n=t.viewState,r=n.projection,s=n.resolution,o=n.center,l=n.rotation,h=t.pixelRatio,c=this.getLayer(),u=c.getSource(),d=u.getRevision(),g=u.getTileGridForProjection(r),f=g.getZForResolution(s,u.zDirection),p=g.getResolution(f);let m=t.extent;const _=t.viewState.resolution,y=u.getTilePixelRatio(h),w=Math.round(ae(m)/_*h),x=Math.round(ne(m)/_*h),b=i.extent&&Fe(i.extent);b&&(m=re(m,Fe(i.extent)));const v=p*w/2/y,E=p*x/2/y,S=[o[0]-v,o[1]-E,o[0]+v,o[1]+E],I=g.getTileRangeForExtentAndZ(m,f),M={};M[f]={};const C=this.createLoadedTileFinder(u,r,M),T=this.tmpExtent,R=this.tmpTileRange_;this.newTiles_=!1;const A=l?ie(n.center,_,l,t.size):void 0;for(let e=I.minX;e<=I.maxX;++e)for(let n=I.minY;n<=I.maxY;++n){if(l&&!g.tileCoordIntersectsViewport([f,e,n],A))continue;const r=this.getTile(f,e,n,t);if(this.isDrawableTile(r)){const e=L(this);if(2==r.getState()){M[f][r.tileCoord.toString()]=r;let t=r.inTransition(e);t&&1!==i.opacity&&(r.endTransition(e),t=!1),this.newTiles_||!t&&this.renderedTiles.includes(r)||(this.newTiles_=!0)}if(1===r.getAlpha(e,t.time))continue}const s=g.getTileCoordChildTileRange(r.tileCoord,R,T);let o=!1;s&&(o=C(f+1,s)),o||g.forEachTileCoordParentTileRange(r.tileCoord,C,R,T)}const k=p/s*h/y;ti(this.pixelTransform,t.size[0]/2,t.size[1]/2,1/h,1/h,l,-w/2,-x/2);const P=ni(this.pixelTransform);this.useContainer(e,P,this.getBackground(t));const N=this.getRenderContext(t),D=this.context.canvas;ei(this.inversePixelTransform,this.pixelTransform),ti(this.tempTransform,w/2,x/2,k,k,0,-w/2,-x/2),D.width!=w||D.height!=x?(D.width=w,D.height=x):this.containerReused||N.clearRect(0,0,w,x),b&&this.clipUnrotated(N,t,b),u.getInterpolate()||(N.imageSmoothingEnabled=!1),this.preRender(N,t),this.renderedTiles.length=0;let O,F,z,B=Object.keys(M).map(Number);B.sort(a),1!==i.opacity||this.containerReused&&!u.getOpaque(t.viewState.projection)?(O=[],F=[]):B=B.reverse();for(let e=B.length-1;e>=0;--e){const i=B[e],n=u.getTilePixelSize(i,h,r),s=g.getResolution(i)/p,o=n[0]*s*k,a=n[1]*s*k,l=g.getTileCoordForCoordAndZ(se(S),i),c=g.getTileCoordExtent(l),d=Qe(this.tempTransform,[y*(c[0]-S[0])/p,y*(S[3]-c[3])/p]),m=y*u.getGutterForProjection(r),_=M[i];for(const e in _){const n=_[e],r=n.tileCoord,s=l[1]-r[1],h=Math.round(d[0]-(s-1)*o),c=l[2]-r[2],g=Math.round(d[1]-(c-1)*a),p=Math.round(d[0]-s*o),y=Math.round(d[1]-c*a),w=h-p,x=g-y,b=f===i,v=b&&1!==n.getAlpha(L(this),t.time);let E=!1;if(!v)if(O){z=[p,y,p+w,y,p+w,y+x,p,y+x];for(let t=0,e=O.length;t<e;++t)if(f!==i&&i<F[t]){const e=O[t];le([p,y,p+w,y+x],[e[0],e[3],e[4],e[7]])&&(E||(N.save(),E=!0),N.beginPath(),N.moveTo(z[0],z[1]),N.lineTo(z[2],z[3]),N.lineTo(z[4],z[5]),N.lineTo(z[6],z[7]),N.moveTo(e[6],e[7]),N.lineTo(e[4],e[5]),N.lineTo(e[2],e[3]),N.lineTo(e[0],e[1]),N.clip())}O.push(z),F.push(i)}else N.clearRect(p,y,w,x);this.drawTileImage(n,t,p,y,w,x,m,b),O&&!v?(E&&N.restore(),this.renderedTiles.unshift(n)):this.renderedTiles.push(n),this.updateUsedTiles(t.usedTiles,u,n)}}return this.renderedRevision=d,this.renderedResolution=p,this.extentChanged=!this.renderedExtent_||!qt(this.renderedExtent_,S),this.renderedExtent_=S,this.renderedPixelRatio=h,this.renderedProjection=r,this.manageTilePyramid(t,u,g,h,r,m,f,c.getPreload()),this.scheduleExpireCache(t,u),this.postRender(this.context,t),i.extent&&N.restore(),N.imageSmoothingEnabled=!0,P!==D.style.transform&&(D.style.transform=P),this.container}drawTileImage(t,e,i,n,r,s,o,a){const l=this.getTileImage(t);if(!l)return;const h=this.getRenderContext(e),c=L(this),u=e.layerStatesArray[e.layerIndex],d=u.opacity*(a?t.getAlpha(c,e.time):1),g=d!==h.globalAlpha;g&&(h.save(),h.globalAlpha=d),h.drawImage(l,o,o,l.width-2*o,l.height-2*o,i,n,r,s),g&&h.restore(),d!==u.opacity?e.animate=!0:a&&t.endTransition(c)}getImage(){const t=this.context;return t?t.canvas:null}getTileImage(t){return t.getImage()}scheduleExpireCache(t,e){if(e.canExpireCache()){const i=function(t,e,i){const n=L(t);n in i.usedTiles&&t.expireCache(i.viewState.projection,i.usedTiles[n])}.bind(null,e);t.postRenderFunctions.push(i)}}updateUsedTiles(t,e,i){const n=L(e);n in t||(t[n]={}),t[n][i.getKey()]=!0}manageTilePyramid(t,e,i,n,r,s,o,a,l){const h=L(e);h in t.wantedTiles||(t.wantedTiles[h]={});const c=t.wantedTiles[h],u=t.tileQueue,d=i.getMinZoom(),g=t.viewState.rotation,f=g?ie(t.viewState.center,t.viewState.resolution,g,t.size):void 0;let p,m,_,y,w,x,b=0;for(x=d;x<=o;++x)for(m=i.getTileRangeForExtentAndZ(s,x,m),_=i.getResolution(x),y=m.minX;y<=m.maxX;++y)for(w=m.minY;w<=m.maxY;++w)g&&!i.tileCoordIntersectsViewport([x,y,w],f)||(o-x<=a?(++b,p=e.getTile(x,y,w,n,r),0==p.getState()&&(c[p.getKey()]=!0,u.isKeyQueued(p.getKey())||u.enqueue([p,h,i.getTileCoordCenter(p.tileCoord),_])),void 0!==l&&l(p)):e.useTile(x,y,w,r));e.updateCacheSize(b,r)}},ya=class extends Qo{constructor(t){super(t)}createRenderer(){return new _a(this)}};var wa=__webpack_require__(3379),xa=__webpack_require__.n(wa),ba=__webpack_require__(7795),va=__webpack_require__.n(ba),Ea=__webpack_require__(569),Sa=__webpack_require__.n(Ea),Ia=__webpack_require__(3565),Ma=__webpack_require__.n(Ia),Ca=__webpack_require__(9216),Ta=__webpack_require__.n(Ca),Ra=__webpack_require__(4589),Aa=__webpack_require__.n(Ra),ka=__webpack_require__(1828),Pa={};Pa.styleTagTransform=Aa(),Pa.setAttributes=Ma(),Pa.insert=Sa().bind(null,"head"),Pa.domAPI=va(),Pa.insertStyleElement=Ta(),xa()(ka.Z,Pa),ka.Z&&ka.Z.locals&&ka.Z.locals;var La=__webpack_require__(1788),Na={};function Da(t,e){let i=[],n=[],r=cv.matFromImageData(t),s=cv.Mat.zeros(r.rows,r.cols,cv.CV_8UC3);cv.cvtColor(r,r,cv.COLOR_RGBA2GRAY,0),cv.threshold(r,r,0,255,cv.THRESH_BINARY);let o=new cv.MatVector,a=new cv.Mat;cv.findContours(r,o,a,cv.RETR_CCOMP,cv.CHAIN_APPROX_SIMPLE);for(let t=0;t<o.size();++t){let e=new cv.Scalar(Math.round(255*Math.random()),Math.round(255*Math.random()),Math.round(255*Math.random()));cv.drawContours(s,o,t,e,1,cv.LINE_8,a,10),n.push([e[0],e[1],e[2]])}return i=s,e&&cv.imshow(e,s),r.delete(),{contour:i.data,color:n}}function Oa(t,e){let i=cv.matFromImageData(t),n=cv.Mat.zeros(i.rows,i.cols,cv.CV_8UC3);console.log(n),cv.cvtColor(i,i,cv.COLOR_RGBA2GRAY,0);let r=new cv.Size(3,3),s=new cv.Point(-1,-1);return cv.blur(i,i,r,s,cv.BORDER_DEFAULT),cv.Canny(i,n,50,100,3,!1),i.delete(),n}function Fa(t,e,i){let n=function(t,e,i){let n=cv.matFromImageData(t),r=new cv.Mat,s=cv.Mat.ones(e,e,cv.CV_8U),o=new cv.Point(-1,-1);return cv.erode(n,r,s,o,i,cv.BORDER_CONSTANT,cv.morphologyDefaultBorderValue()),n.delete(),s.delete(),r}(t,e,i),r=Oa(t),s=new Uint8ClampedArray(n.data.length);for(let t=0,e=0;n.data.length,e<r.data.length;t+=4,e++)s[t]=n.data[t],s[t+1]=r.data[e],s[t+3]=255;return new ImageData(s,300,300)}function za(){}function Ba(t){return null==t?za:function(){return this.querySelector(t)}}function Ga(){return[]}function Ya(t){return null==t?Ga:function(){return this.querySelectorAll(t)}}function Ua(t){return function(){return this.matches(t)}}function Xa(t){return function(e){return e.matches(t)}}Na.styleTagTransform=Aa(),Na.setAttributes=Ma(),Na.insert=Sa().bind(null,"head"),Na.domAPI=va(),Na.insertStyleElement=Ta(),xa()(La.Z,Na),La.Z&&La.Z.locals&&La.Z.locals;var qa=Array.prototype.find;function Va(){return this.firstElementChild}var ja=Array.prototype.filter;function Wa(){return Array.from(this.children)}function Za(t){return new Array(t.length)}function Ha(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}function Ka(t,e,i,n,r,s){for(var o,a=0,l=e.length,h=s.length;a<h;++a)(o=e[a])?(o.__data__=s[a],n[a]=o):i[a]=new Ha(t,s[a]);for(;a<l;++a)(o=e[a])&&(r[a]=o)}function $a(t,e,i,n,r,s,o){var a,l,h,c=new Map,u=e.length,d=s.length,g=new Array(u);for(a=0;a<u;++a)(l=e[a])&&(g[a]=h=o.call(l,l.__data__,a,e)+"",c.has(h)?r[a]=l:c.set(h,l));for(a=0;a<d;++a)h=o.call(t,s[a],a,s)+"",(l=c.get(h))?(n[a]=l,l.__data__=s[a],c.delete(h)):i[a]=new Ha(t,s[a]);for(a=0;a<u;++a)(l=e[a])&&c.get(g[a])===l&&(r[a]=l)}function Ja(t){return t.__data__}function Qa(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}function tl(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}Ha.prototype={constructor:Ha,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};var el="http://www.w3.org/1999/xhtml";const il={svg:"http://www.w3.org/2000/svg",xhtml:el,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function nl(t){var e=t+="",i=e.indexOf(":");return i>=0&&"xmlns"!==(e=t.slice(0,i))&&(t=t.slice(i+1)),il.hasOwnProperty(e)?{space:il[e],local:t}:t}function rl(t){return function(){this.removeAttribute(t)}}function sl(t){return function(){this.removeAttributeNS(t.space,t.local)}}function al(t,e){return function(){this.setAttribute(t,e)}}function ll(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function hl(t,e){return function(){var i=e.apply(this,arguments);null==i?this.removeAttribute(t):this.setAttribute(t,i)}}function cl(t,e){return function(){var i=e.apply(this,arguments);null==i?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,i)}}function ul(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function dl(t){return function(){this.style.removeProperty(t)}}function gl(t,e,i){return function(){this.style.setProperty(t,e,i)}}function fl(t,e,i){return function(){var n=e.apply(this,arguments);null==n?this.style.removeProperty(t):this.style.setProperty(t,n,i)}}function pl(t,e){return t.style.getPropertyValue(e)||ul(t).getComputedStyle(t,null).getPropertyValue(e)}function ml(t){return function(){delete this[t]}}function _l(t,e){return function(){this[t]=e}}function yl(t,e){return function(){var i=e.apply(this,arguments);null==i?delete this[t]:this[t]=i}}function wl(t){return t.trim().split(/^|\s+/)}function xl(t){return t.classList||new bl(t)}function bl(t){this._node=t,this._names=wl(t.getAttribute("class")||"")}function vl(t,e){for(var i=xl(t),n=-1,r=e.length;++n<r;)i.add(e[n])}function El(t,e){for(var i=xl(t),n=-1,r=e.length;++n<r;)i.remove(e[n])}function Sl(t){return function(){vl(this,t)}}function Il(t){return function(){El(this,t)}}function Ml(t,e){return function(){(e.apply(this,arguments)?vl:El)(this,t)}}function Cl(){this.textContent=""}function Tl(t){return function(){this.textContent=t}}function Rl(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}function Al(){this.innerHTML=""}function kl(t){return function(){this.innerHTML=t}}function Pl(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}function Ll(){this.nextSibling&&this.parentNode.appendChild(this)}function Nl(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Dl(t){return function(){var e=this.ownerDocument,i=this.namespaceURI;return i===el&&e.documentElement.namespaceURI===el?e.createElement(t):e.createElementNS(i,t)}}function Ol(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function Fl(t){var e=nl(t);return(e.local?Ol:Dl)(e)}function zl(){return null}function Bl(){var t=this.parentNode;t&&t.removeChild(this)}function Gl(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Yl(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Ul(t){return function(){var e=this.__on;if(e){for(var i,n=0,r=-1,s=e.length;n<s;++n)i=e[n],t.type&&i.type!==t.type||i.name!==t.name?e[++r]=i:this.removeEventListener(i.type,i.listener,i.options);++r?e.length=r:delete this.__on}}}function Xl(t,e,i){return function(){var n,r=this.__on,s=function(t){return function(e){t.call(this,e,this.__data__)}}(e);if(r)for(var o=0,a=r.length;o<a;++o)if((n=r[o]).type===t.type&&n.name===t.name)return this.removeEventListener(n.type,n.listener,n.options),this.addEventListener(n.type,n.listener=s,n.options=i),void(n.value=e);this.addEventListener(t.type,s,i),n={type:t.type,name:t.name,value:e,listener:s,options:i},r?r.push(n):this.__on=[n]}}function ql(t,e,i){var n=ul(t),r=n.CustomEvent;"function"==typeof r?r=new r(e,i):(r=n.document.createEvent("Event"),i?(r.initEvent(e,i.bubbles,i.cancelable),r.detail=i.detail):r.initEvent(e,!1,!1)),t.dispatchEvent(r)}function Vl(t,e){return function(){return ql(this,t,e)}}function jl(t,e){return function(){return ql(this,t,e.apply(this,arguments))}}bl.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var Wl=[null];function Zl(t,e){this._groups=t,this._parents=e}function Hl(){return new Zl([[document.documentElement]],Wl)}Zl.prototype=Hl.prototype={constructor:Zl,select:function(t){"function"!=typeof t&&(t=Ba(t));for(var e=this._groups,i=e.length,n=new Array(i),r=0;r<i;++r)for(var s,o,a=e[r],l=a.length,h=n[r]=new Array(l),c=0;c<l;++c)(s=a[c])&&(o=t.call(s,s.__data__,c,a))&&("__data__"in s&&(o.__data__=s.__data__),h[c]=o);return new Zl(n,this._parents)},selectAll:function(t){t="function"==typeof t?function(t){return function(){return null==(e=t.apply(this,arguments))?[]:Array.isArray(e)?e:Array.from(e);var e}}(t):Ya(t);for(var e=this._groups,i=e.length,n=[],r=[],s=0;s<i;++s)for(var o,a=e[s],l=a.length,h=0;h<l;++h)(o=a[h])&&(n.push(t.call(o,o.__data__,h,a)),r.push(o));return new Zl(n,r)},selectChild:function(t){return this.select(null==t?Va:function(t){return function(){return qa.call(this.children,t)}}("function"==typeof t?t:Xa(t)))},selectChildren:function(t){return this.selectAll(null==t?Wa:function(t){return function(){return ja.call(this.children,t)}}("function"==typeof t?t:Xa(t)))},filter:function(t){"function"!=typeof t&&(t=Ua(t));for(var e=this._groups,i=e.length,n=new Array(i),r=0;r<i;++r)for(var s,o=e[r],a=o.length,l=n[r]=[],h=0;h<a;++h)(s=o[h])&&t.call(s,s.__data__,h,o)&&l.push(s);return new Zl(n,this._parents)},data:function(t,e){if(!arguments.length)return Array.from(this,Ja);var i,n=e?$a:Ka,r=this._parents,s=this._groups;"function"!=typeof t&&(i=t,t=function(){return i});for(var o=s.length,a=new Array(o),l=new Array(o),h=new Array(o),c=0;c<o;++c){var u=r[c],d=s[c],g=d.length,f=Qa(t.call(u,u&&u.__data__,c,r)),p=f.length,m=l[c]=new Array(p),_=a[c]=new Array(p);n(u,d,m,_,h[c]=new Array(g),f,e);for(var y,w,x=0,b=0;x<p;++x)if(y=m[x]){for(x>=b&&(b=x+1);!(w=_[b])&&++b<p;);y._next=w||null}}return(a=new Zl(a,r))._enter=l,a._exit=h,a},enter:function(){return new Zl(this._enter||this._groups.map(Za),this._parents)},exit:function(){return new Zl(this._exit||this._groups.map(Za),this._parents)},join:function(t,e,i){var n=this.enter(),r=this,s=this.exit();return"function"==typeof t?(n=t(n))&&(n=n.selection()):n=n.append(t+""),null!=e&&(r=e(r))&&(r=r.selection()),null==i?s.remove():i(s),n&&r?n.merge(r).order():r},merge:function(t){for(var e=t.selection?t.selection():t,i=this._groups,n=e._groups,r=i.length,s=n.length,o=Math.min(r,s),a=new Array(r),l=0;l<o;++l)for(var h,c=i[l],u=n[l],d=c.length,g=a[l]=new Array(d),f=0;f<d;++f)(h=c[f]||u[f])&&(g[f]=h);for(;l<r;++l)a[l]=i[l];return new Zl(a,this._parents)},selection:function(){return this},order:function(){for(var t=this._groups,e=-1,i=t.length;++e<i;)for(var n,r=t[e],s=r.length-1,o=r[s];--s>=0;)(n=r[s])&&(o&&4^n.compareDocumentPosition(o)&&o.parentNode.insertBefore(n,o),o=n);return this},sort:function(t){function e(e,i){return e&&i?t(e.__data__,i.__data__):!e-!i}t||(t=tl);for(var i=this._groups,n=i.length,r=new Array(n),s=0;s<n;++s){for(var o,a=i[s],l=a.length,h=r[s]=new Array(l),c=0;c<l;++c)(o=a[c])&&(h[c]=o);h.sort(e)}return new Zl(r,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var t=this._groups,e=0,i=t.length;e<i;++e)for(var n=t[e],r=0,s=n.length;r<s;++r){var o=n[r];if(o)return o}return null},size:function(){let t=0;for(const e of this)++t;return t},empty:function(){return!this.node()},each:function(t){for(var e=this._groups,i=0,n=e.length;i<n;++i)for(var r,s=e[i],o=0,a=s.length;o<a;++o)(r=s[o])&&t.call(r,r.__data__,o,s);return this},attr:function(t,e){var i=nl(t);if(arguments.length<2){var n=this.node();return i.local?n.getAttributeNS(i.space,i.local):n.getAttribute(i)}return this.each((null==e?i.local?sl:rl:"function"==typeof e?i.local?cl:hl:i.local?ll:al)(i,e))},style:function(t,e,i){return arguments.length>1?this.each((null==e?dl:"function"==typeof e?fl:gl)(t,e,null==i?"":i)):pl(this.node(),t)},property:function(t,e){return arguments.length>1?this.each((null==e?ml:"function"==typeof e?yl:_l)(t,e)):this.node()[t]},classed:function(t,e){var i=wl(t+"");if(arguments.length<2){for(var n=xl(this.node()),r=-1,s=i.length;++r<s;)if(!n.contains(i[r]))return!1;return!0}return this.each(("function"==typeof e?Ml:e?Sl:Il)(i,e))},text:function(t){return arguments.length?this.each(null==t?Cl:("function"==typeof t?Rl:Tl)(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?Al:("function"==typeof t?Pl:kl)(t)):this.node().innerHTML},raise:function(){return this.each(Ll)},lower:function(){return this.each(Nl)},append:function(t){var e="function"==typeof t?t:Fl(t);return this.select((function(){return this.appendChild(e.apply(this,arguments))}))},insert:function(t,e){var i="function"==typeof t?t:Fl(t),n=null==e?zl:"function"==typeof e?e:Ba(e);return this.select((function(){return this.insertBefore(i.apply(this,arguments),n.apply(this,arguments)||null)}))},remove:function(){return this.each(Bl)},clone:function(t){return this.select(t?Yl:Gl)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,e,i){var n,r,s=function(t){return t.trim().split(/^|\s+/).map((function(t){var e="",i=t.indexOf(".");return i>=0&&(e=t.slice(i+1),t=t.slice(0,i)),{type:t,name:e}}))}(t+""),o=s.length;if(!(arguments.length<2)){for(a=e?Xl:Ul,n=0;n<o;++n)this.each(a(s[n],e,i));return this}var a=this.node().__on;if(a)for(var l,h=0,c=a.length;h<c;++h)for(n=0,l=a[h];n<o;++n)if((r=s[n]).type===l.type&&r.name===l.name)return l.value},dispatch:function(t,e){return this.each(("function"==typeof e?jl:Vl)(t,e))},[Symbol.iterator]:function*(){for(var t=this._groups,e=0,i=t.length;e<i;++e)for(var n,r=t[e],s=0,o=r.length;s<o;++s)(n=r[s])&&(yield n)}};const Kl=Hl;var $l={value:()=>{}};function Jl(){for(var t,e=0,i=arguments.length,n={};e<i;++e){if(!(t=arguments[e]+"")||t in n||/[\s.]/.test(t))throw new Error("illegal type: "+t);n[t]=[]}return new Ql(n)}function Ql(t){this._=t}function th(t,e){for(var i,n=0,r=t.length;n<r;++n)if((i=t[n]).name===e)return i.value}function eh(t,e,i){for(var n=0,r=t.length;n<r;++n)if(t[n].name===e){t[n]=$l,t=t.slice(0,n).concat(t.slice(n+1));break}return null!=i&&t.push({name:e,value:i}),t}Ql.prototype=Jl.prototype={constructor:Ql,on:function(t,e){var i,n=this._,r=function(t,e){return t.trim().split(/^|\s+/).map((function(t){var i="",n=t.indexOf(".");if(n>=0&&(i=t.slice(n+1),t=t.slice(0,n)),t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:i}}))}(t+"",n),s=-1,o=r.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++s<o;)if(i=(t=r[s]).type)n[i]=eh(n[i],t.name,e);else if(null==e)for(i in n)n[i]=eh(n[i],t.name,null);return this}for(;++s<o;)if((i=(t=r[s]).type)&&(i=th(n[i],t.name)))return i},copy:function(){var t={},e=this._;for(var i in e)t[i]=e[i].slice();return new Ql(t)},call:function(t,e){if((i=arguments.length-2)>0)for(var i,n,r=new Array(i),s=0;s<i;++s)r[s]=arguments[s+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(s=0,i=(n=this._[t]).length;s<i;++s)n[s].value.apply(e,r)},apply:function(t,e,i){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var n=this._[t],r=0,s=n.length;r<s;++r)n[r].value.apply(e,i)}};const ih=Jl;var nh,rh,sh=0,oh=0,ah=0,lh=1e3,hh=0,ch=0,uh=0,dh="object"==typeof performance&&performance.now?performance:Date,gh="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function fh(){return ch||(gh(ph),ch=dh.now()+uh)}function ph(){ch=0}function mh(){this._call=this._time=this._next=null}function _h(t,e,i){var n=new mh;return n.restart(t,e,i),n}function yh(){ch=(hh=dh.now())+uh,sh=oh=0;try{!function(){fh(),++sh;for(var t,e=nh;e;)(t=ch-e._time)>=0&&e._call.call(void 0,t),e=e._next;--sh}()}finally{sh=0,function(){for(var t,e,i=nh,n=1/0;i;)i._call?(n>i._time&&(n=i._time),t=i,i=i._next):(e=i._next,i._next=null,i=t?t._next=e:nh=e);rh=t,xh(n)}(),ch=0}}function wh(){var t=dh.now(),e=t-hh;e>lh&&(uh-=e,hh=t)}function xh(t){sh||(oh&&(oh=clearTimeout(oh)),t-ch>24?(t<1/0&&(oh=setTimeout(yh,t-dh.now()-uh)),ah&&(ah=clearInterval(ah))):(ah||(hh=dh.now(),ah=setInterval(wh,lh)),sh=1,gh(yh)))}function bh(t,e,i){var n=new mh;return e=null==e?0:+e,n.restart((i=>{n.stop(),t(i+e)}),e,i),n}mh.prototype=_h.prototype={constructor:mh,restart:function(t,e,i){if("function"!=typeof t)throw new TypeError("callback is not a function");i=(null==i?fh():+i)+(null==e?0:+e),this._next||rh===this||(rh?rh._next=this:nh=this,rh=this),this._call=t,this._time=i,xh()},stop:function(){this._call&&(this._call=null,this._time=1/0,xh())}};var vh=ih("start","end","cancel","interrupt"),Eh=[],Sh=0,Ih=3;function Mh(t,e,i,n,r,s){var o=t.__transition;if(o){if(i in o)return}else t.__transition={};!function(t,e,i){var n,r=t.__transition;function s(l){var h,c,u,d;if(1!==i.state)return a();for(h in r)if((d=r[h]).name===i.name){if(d.state===Ih)return bh(s);4===d.state?(d.state=6,d.timer.stop(),d.on.call("interrupt",t,t.__data__,d.index,d.group),delete r[h]):+h<e&&(d.state=6,d.timer.stop(),d.on.call("cancel",t,t.__data__,d.index,d.group),delete r[h])}if(bh((function(){i.state===Ih&&(i.state=4,i.timer.restart(o,i.delay,i.time),o(l))})),i.state=2,i.on.call("start",t,t.__data__,i.index,i.group),2===i.state){for(i.state=Ih,n=new Array(u=i.tween.length),h=0,c=-1;h<u;++h)(d=i.tween[h].value.call(t,t.__data__,i.index,i.group))&&(n[++c]=d);n.length=c+1}}function o(e){for(var r=e<i.duration?i.ease.call(null,e/i.duration):(i.timer.restart(a),i.state=5,1),s=-1,o=n.length;++s<o;)n[s].call(t,r);5===i.state&&(i.on.call("end",t,t.__data__,i.index,i.group),a())}function a(){for(var n in i.state=6,i.timer.stop(),delete r[e],r)return;delete t.__transition}r[e]=i,i.timer=_h((function(t){i.state=1,i.timer.restart(s,i.delay,i.time),i.delay<=t&&s(t-i.delay)}),0,i.time)}(t,i,{name:e,index:n,group:r,on:vh,tween:Eh,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:Sh})}function Ch(t,e){var i=Rh(t,e);if(i.state>Sh)throw new Error("too late; already scheduled");return i}function Th(t,e){var i=Rh(t,e);if(i.state>Ih)throw new Error("too late; already running");return i}function Rh(t,e){var i=t.__transition;if(!i||!(i=i[e]))throw new Error("transition not found");return i}function Ah(t,e){return t=+t,e=+e,function(i){return t*(1-i)+e*i}}var kh,Ph=180/Math.PI,Lh={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Nh(t,e,i,n,r,s){var o,a,l;return(o=Math.sqrt(t*t+e*e))&&(t/=o,e/=o),(l=t*i+e*n)&&(i-=t*l,n-=e*l),(a=Math.sqrt(i*i+n*n))&&(i/=a,n/=a,l/=a),t*n<e*i&&(t=-t,e=-e,l=-l,o=-o),{translateX:r,translateY:s,rotate:Math.atan2(e,t)*Ph,skewX:Math.atan(l)*Ph,scaleX:o,scaleY:a}}function Dh(t,e,i,n){function r(t){return t.length?t.pop()+" ":""}return function(s,o){var a=[],l=[];return s=t(s),o=t(o),function(t,n,r,s,o,a){if(t!==r||n!==s){var l=o.push("translate(",null,e,null,i);a.push({i:l-4,x:Ah(t,r)},{i:l-2,x:Ah(n,s)})}else(r||s)&&o.push("translate("+r+e+s+i)}(s.translateX,s.translateY,o.translateX,o.translateY,a,l),function(t,e,i,s){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),s.push({i:i.push(r(i)+"rotate(",null,n)-2,x:Ah(t,e)})):e&&i.push(r(i)+"rotate("+e+n)}(s.rotate,o.rotate,a,l),function(t,e,i,s){t!==e?s.push({i:i.push(r(i)+"skewX(",null,n)-2,x:Ah(t,e)}):e&&i.push(r(i)+"skewX("+e+n)}(s.skewX,o.skewX,a,l),function(t,e,i,n,s,o){if(t!==i||e!==n){var a=s.push(r(s)+"scale(",null,",",null,")");o.push({i:a-4,x:Ah(t,i)},{i:a-2,x:Ah(e,n)})}else 1===i&&1===n||s.push(r(s)+"scale("+i+","+n+")")}(s.scaleX,s.scaleY,o.scaleX,o.scaleY,a,l),s=o=null,function(t){for(var e,i=-1,n=l.length;++i<n;)a[(e=l[i]).i]=e.x(t);return a.join("")}}}var Oh=Dh((function(t){const e=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?Lh:Nh(e.a,e.b,e.c,e.d,e.e,e.f)}),"px, ","px)","deg)"),Fh=Dh((function(t){return null==t?Lh:(kh||(kh=document.createElementNS("http://www.w3.org/2000/svg","g")),kh.setAttribute("transform",t),(t=kh.transform.baseVal.consolidate())?Nh((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):Lh)}),", ",")",")");function zh(t,e){var i,n;return function(){var r=Th(this,t),s=r.tween;if(s!==i)for(var o=0,a=(n=i=s).length;o<a;++o)if(n[o].name===e){(n=n.slice()).splice(o,1);break}r.tween=n}}function Bh(t,e,i){var n,r;if("function"!=typeof i)throw new Error;return function(){var s=Th(this,t),o=s.tween;if(o!==n){r=(n=o).slice();for(var a={name:e,value:i},l=0,h=r.length;l<h;++l)if(r[l].name===e){r[l]=a;break}l===h&&r.push(a)}s.tween=r}}function Gh(t,e,i){var n=t._id;return t.each((function(){var t=Th(this,n);(t.value||(t.value={}))[e]=i.apply(this,arguments)})),function(t){return Rh(t,n).value[e]}}function Yh(t,e,i){t.prototype=e.prototype=i,i.constructor=t}function Uh(t,e){var i=Object.create(t.prototype);for(var n in e)i[n]=e[n];return i}function Xh(){}var qh=.7,Vh=1/qh,jh="\\s*([+-]?\\d+)\\s*",Wh="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Zh="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Hh=/^#([0-9a-f]{3,8})$/,Kh=new RegExp(`^rgb\\(${jh},${jh},${jh}\\)$`),$h=new RegExp(`^rgb\\(${Zh},${Zh},${Zh}\\)$`),Jh=new RegExp(`^rgba\\(${jh},${jh},${jh},${Wh}\\)$`),Qh=new RegExp(`^rgba\\(${Zh},${Zh},${Zh},${Wh}\\)$`),tc=new RegExp(`^hsl\\(${Wh},${Zh},${Zh}\\)$`),ec=new RegExp(`^hsla\\(${Wh},${Zh},${Zh},${Wh}\\)$`),ic={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function nc(){return this.rgb().formatHex()}function rc(){return this.rgb().formatRgb()}function sc(t){var e,i;return t=(t+"").trim().toLowerCase(),(e=Hh.exec(t))?(i=e[1].length,e=parseInt(e[1],16),6===i?oc(e):3===i?new hc(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===i?ac(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===i?ac(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=Kh.exec(t))?new hc(e[1],e[2],e[3],1):(e=$h.exec(t))?new hc(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=Jh.exec(t))?ac(e[1],e[2],e[3],e[4]):(e=Qh.exec(t))?ac(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=tc.exec(t))?pc(e[1],e[2]/100,e[3]/100,1):(e=ec.exec(t))?pc(e[1],e[2]/100,e[3]/100,e[4]):ic.hasOwnProperty(t)?oc(ic[t]):"transparent"===t?new hc(NaN,NaN,NaN,0):null}function oc(t){return new hc(t>>16&255,t>>8&255,255&t,1)}function ac(t,e,i,n){return n<=0&&(t=e=i=NaN),new hc(t,e,i,n)}function lc(t,e,i,n){return 1===arguments.length?((r=t)instanceof Xh||(r=sc(r)),r?new hc((r=r.rgb()).r,r.g,r.b,r.opacity):new hc):new hc(t,e,i,null==n?1:n);var r}function hc(t,e,i,n){this.r=+t,this.g=+e,this.b=+i,this.opacity=+n}function cc(){return`#${fc(this.r)}${fc(this.g)}${fc(this.b)}`}function uc(){const t=dc(this.opacity);return`${1===t?"rgb(":"rgba("}${gc(this.r)}, ${gc(this.g)}, ${gc(this.b)}${1===t?")":`, ${t})`}`}function dc(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function gc(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function fc(t){return((t=gc(t))<16?"0":"")+t.toString(16)}function pc(t,e,i,n){return n<=0?t=e=i=NaN:i<=0||i>=1?t=e=NaN:e<=0&&(t=NaN),new _c(t,e,i,n)}function mc(t){if(t instanceof _c)return new _c(t.h,t.s,t.l,t.opacity);if(t instanceof Xh||(t=sc(t)),!t)return new _c;if(t instanceof _c)return t;var e=(t=t.rgb()).r/255,i=t.g/255,n=t.b/255,r=Math.min(e,i,n),s=Math.max(e,i,n),o=NaN,a=s-r,l=(s+r)/2;return a?(o=e===s?(i-n)/a+6*(i<n):i===s?(n-e)/a+2:(e-i)/a+4,a/=l<.5?s+r:2-s-r,o*=60):a=l>0&&l<1?0:o,new _c(o,a,l,t.opacity)}function _c(t,e,i,n){this.h=+t,this.s=+e,this.l=+i,this.opacity=+n}function yc(t){return(t=(t||0)%360)<0?t+360:t}function wc(t){return Math.max(0,Math.min(1,t||0))}function xc(t,e,i){return 255*(t<60?e+(i-e)*t/60:t<180?i:t<240?e+(i-e)*(240-t)/60:e)}function bc(t,e,i,n,r){var s=t*t,o=s*t;return((1-3*t+3*s-o)*e+(4-6*s+3*o)*i+(1+3*t+3*s-3*o)*n+o*r)/6}Yh(Xh,sc,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:nc,formatHex:nc,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return mc(this).formatHsl()},formatRgb:rc,toString:rc}),Yh(hc,lc,Uh(Xh,{brighter(t){return t=null==t?Vh:Math.pow(Vh,t),new hc(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=null==t?qh:Math.pow(qh,t),new hc(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new hc(gc(this.r),gc(this.g),gc(this.b),dc(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:cc,formatHex:cc,formatHex8:function(){return`#${fc(this.r)}${fc(this.g)}${fc(this.b)}${fc(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:uc,toString:uc})),Yh(_c,(function(t,e,i,n){return 1===arguments.length?mc(t):new _c(t,e,i,null==n?1:n)}),Uh(Xh,{brighter(t){return t=null==t?Vh:Math.pow(Vh,t),new _c(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=null==t?qh:Math.pow(qh,t),new _c(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,i=this.l,n=i+(i<.5?i:1-i)*e,r=2*i-n;return new hc(xc(t>=240?t-240:t+120,r,n),xc(t,r,n),xc(t<120?t+240:t-120,r,n),this.opacity)},clamp(){return new _c(yc(this.h),wc(this.s),wc(this.l),dc(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=dc(this.opacity);return`${1===t?"hsl(":"hsla("}${yc(this.h)}, ${100*wc(this.s)}%, ${100*wc(this.l)}%${1===t?")":`, ${t})`}`}}));const vc=t=>()=>t;function Ec(t,e){var i=e-t;return i?function(t,e){return function(i){return t+i*e}}(t,i):vc(isNaN(t)?e:t)}const Sc=function t(e){var i=function(t){return 1==(t=+t)?Ec:function(e,i){return i-e?function(t,e,i){return t=Math.pow(t,i),e=Math.pow(e,i)-t,i=1/i,function(n){return Math.pow(t+n*e,i)}}(e,i,t):vc(isNaN(e)?i:e)}}(e);function n(t,e){var n=i((t=lc(t)).r,(e=lc(e)).r),r=i(t.g,e.g),s=i(t.b,e.b),o=Ec(t.opacity,e.opacity);return function(e){return t.r=n(e),t.g=r(e),t.b=s(e),t.opacity=o(e),t+""}}return n.gamma=t,n}(1);function Ic(t){return function(e){var i,n,r=e.length,s=new Array(r),o=new Array(r),a=new Array(r);for(i=0;i<r;++i)n=lc(e[i]),s[i]=n.r||0,o[i]=n.g||0,a[i]=n.b||0;return s=t(s),o=t(o),a=t(a),n.opacity=1,function(t){return n.r=s(t),n.g=o(t),n.b=a(t),n+""}}}Ic((function(t){var e=t.length-1;return function(i){var n=i<=0?i=0:i>=1?(i=1,e-1):Math.floor(i*e),r=t[n],s=t[n+1],o=n>0?t[n-1]:2*r-s,a=n<e-1?t[n+2]:2*s-r;return bc((i-n/e)*e,o,r,s,a)}})),Ic((function(t){var e=t.length;return function(i){var n=Math.floor(((i%=1)<0?++i:i)*e),r=t[(n+e-1)%e],s=t[n%e],o=t[(n+1)%e],a=t[(n+2)%e];return bc((i-n/e)*e,r,s,o,a)}}));var Mc=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Cc=new RegExp(Mc.source,"g");function Tc(t,e){var i,n,r,s=Mc.lastIndex=Cc.lastIndex=0,o=-1,a=[],l=[];for(t+="",e+="";(i=Mc.exec(t))&&(n=Cc.exec(e));)(r=n.index)>s&&(r=e.slice(s,r),a[o]?a[o]+=r:a[++o]=r),(i=i[0])===(n=n[0])?a[o]?a[o]+=n:a[++o]=n:(a[++o]=null,l.push({i:o,x:Ah(i,n)})),s=Cc.lastIndex;return s<e.length&&(r=e.slice(s),a[o]?a[o]+=r:a[++o]=r),a.length<2?l[0]?function(t){return function(e){return t(e)+""}}(l[0].x):function(t){return function(){return t}}(e):(e=l.length,function(t){for(var i,n=0;n<e;++n)a[(i=l[n]).i]=i.x(t);return a.join("")})}function Rc(t,e){var i;return("number"==typeof e?Ah:e instanceof sc?Sc:(i=sc(e))?(e=i,Sc):Tc)(t,e)}function Ac(t){return function(){this.removeAttribute(t)}}function kc(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Pc(t,e,i){var n,r,s=i+"";return function(){var o=this.getAttribute(t);return o===s?null:o===n?r:r=e(n=o,i)}}function Lc(t,e,i){var n,r,s=i+"";return function(){var o=this.getAttributeNS(t.space,t.local);return o===s?null:o===n?r:r=e(n=o,i)}}function Nc(t,e,i){var n,r,s;return function(){var o,a,l=i(this);if(null!=l)return(o=this.getAttribute(t))===(a=l+"")?null:o===n&&a===r?s:(r=a,s=e(n=o,l));this.removeAttribute(t)}}function Dc(t,e,i){var n,r,s;return function(){var o,a,l=i(this);if(null!=l)return(o=this.getAttributeNS(t.space,t.local))===(a=l+"")?null:o===n&&a===r?s:(r=a,s=e(n=o,l));this.removeAttributeNS(t.space,t.local)}}function Oc(t,e){var i,n;function r(){var r=e.apply(this,arguments);return r!==n&&(i=(n=r)&&function(t,e){return function(i){this.setAttributeNS(t.space,t.local,e.call(this,i))}}(t,r)),i}return r._value=e,r}function Fc(t,e){var i,n;function r(){var r=e.apply(this,arguments);return r!==n&&(i=(n=r)&&function(t,e){return function(i){this.setAttribute(t,e.call(this,i))}}(t,r)),i}return r._value=e,r}function zc(t,e){return function(){Ch(this,t).delay=+e.apply(this,arguments)}}function Bc(t,e){return e=+e,function(){Ch(this,t).delay=e}}function Gc(t,e){return function(){Th(this,t).duration=+e.apply(this,arguments)}}function Yc(t,e){return e=+e,function(){Th(this,t).duration=e}}var Uc=Kl.prototype.constructor;function Xc(t){return function(){this.style.removeProperty(t)}}var qc=0;function Vc(t,e,i,n){this._groups=t,this._parents=e,this._name=i,this._id=n}function jc(){return++qc}var Wc=Kl.prototype;Vc.prototype=function(t){return Kl().transition(t)}.prototype={constructor:Vc,select:function(t){var e=this._name,i=this._id;"function"!=typeof t&&(t=Ba(t));for(var n=this._groups,r=n.length,s=new Array(r),o=0;o<r;++o)for(var a,l,h=n[o],c=h.length,u=s[o]=new Array(c),d=0;d<c;++d)(a=h[d])&&(l=t.call(a,a.__data__,d,h))&&("__data__"in a&&(l.__data__=a.__data__),u[d]=l,Mh(u[d],e,i,d,u,Rh(a,i)));return new Vc(s,this._parents,e,i)},selectAll:function(t){var e=this._name,i=this._id;"function"!=typeof t&&(t=Ya(t));for(var n=this._groups,r=n.length,s=[],o=[],a=0;a<r;++a)for(var l,h=n[a],c=h.length,u=0;u<c;++u)if(l=h[u]){for(var d,g=t.call(l,l.__data__,u,h),f=Rh(l,i),p=0,m=g.length;p<m;++p)(d=g[p])&&Mh(d,e,i,p,g,f);s.push(g),o.push(l)}return new Vc(s,o,e,i)},selectChild:Wc.selectChild,selectChildren:Wc.selectChildren,filter:function(t){"function"!=typeof t&&(t=Ua(t));for(var e=this._groups,i=e.length,n=new Array(i),r=0;r<i;++r)for(var s,o=e[r],a=o.length,l=n[r]=[],h=0;h<a;++h)(s=o[h])&&t.call(s,s.__data__,h,o)&&l.push(s);return new Vc(n,this._parents,this._name,this._id)},merge:function(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,i=t._groups,n=e.length,r=i.length,s=Math.min(n,r),o=new Array(n),a=0;a<s;++a)for(var l,h=e[a],c=i[a],u=h.length,d=o[a]=new Array(u),g=0;g<u;++g)(l=h[g]||c[g])&&(d[g]=l);for(;a<n;++a)o[a]=e[a];return new Vc(o,this._parents,this._name,this._id)},selection:function(){return new Uc(this._groups,this._parents)},transition:function(){for(var t=this._name,e=this._id,i=jc(),n=this._groups,r=n.length,s=0;s<r;++s)for(var o,a=n[s],l=a.length,h=0;h<l;++h)if(o=a[h]){var c=Rh(o,e);Mh(o,t,i,h,a,{time:c.time+c.delay+c.duration,delay:0,duration:c.duration,ease:c.ease})}return new Vc(n,this._parents,t,i)},call:Wc.call,nodes:Wc.nodes,node:Wc.node,size:Wc.size,empty:Wc.empty,each:Wc.each,on:function(t,e){var i=this._id;return arguments.length<2?Rh(this.node(),i).on.on(t):this.each(function(t,e,i){var n,r,s=function(t){return(t+"").trim().split(/^|\s+/).every((function(t){var e=t.indexOf(".");return e>=0&&(t=t.slice(0,e)),!t||"start"===t}))}(e)?Ch:Th;return function(){var o=s(this,t),a=o.on;a!==n&&(r=(n=a).copy()).on(e,i),o.on=r}}(i,t,e))},attr:function(t,e){var i=nl(t),n="transform"===i?Fh:Rc;return this.attrTween(t,"function"==typeof e?(i.local?Dc:Nc)(i,n,Gh(this,"attr."+t,e)):null==e?(i.local?kc:Ac)(i):(i.local?Lc:Pc)(i,n,e))},attrTween:function(t,e){var i="attr."+t;if(arguments.length<2)return(i=this.tween(i))&&i._value;if(null==e)return this.tween(i,null);if("function"!=typeof e)throw new Error;var n=nl(t);return this.tween(i,(n.local?Oc:Fc)(n,e))},style:function(t,e,i){var n="transform"==(t+="")?Oh:Rc;return null==e?this.styleTween(t,function(t,e){var i,n,r;return function(){var s=pl(this,t),o=(this.style.removeProperty(t),pl(this,t));return s===o?null:s===i&&o===n?r:r=e(i=s,n=o)}}(t,n)).on("end.style."+t,Xc(t)):"function"==typeof e?this.styleTween(t,function(t,e,i){var n,r,s;return function(){var o=pl(this,t),a=i(this),l=a+"";return null==a&&(this.style.removeProperty(t),l=a=pl(this,t)),o===l?null:o===n&&l===r?s:(r=l,s=e(n=o,a))}}(t,n,Gh(this,"style."+t,e))).each(function(t,e){var i,n,r,s,o="style."+e,a="end."+o;return function(){var l=Th(this,t),h=l.on,c=null==l.value[o]?s||(s=Xc(e)):void 0;h===i&&r===c||(n=(i=h).copy()).on(a,r=c),l.on=n}}(this._id,t)):this.styleTween(t,function(t,e,i){var n,r,s=i+"";return function(){var o=pl(this,t);return o===s?null:o===n?r:r=e(n=o,i)}}(t,n,e),i).on("end.style."+t,null)},styleTween:function(t,e,i){var n="style."+(t+="");if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==e)return this.tween(n,null);if("function"!=typeof e)throw new Error;return this.tween(n,function(t,e,i){var n,r;function s(){var s=e.apply(this,arguments);return s!==r&&(n=(r=s)&&function(t,e,i){return function(n){this.style.setProperty(t,e.call(this,n),i)}}(t,s,i)),n}return s._value=e,s}(t,e,null==i?"":i))},text:function(t){return this.tween("text","function"==typeof t?function(t){return function(){var e=t(this);this.textContent=null==e?"":e}}(Gh(this,"text",t)):function(t){return function(){this.textContent=t}}(null==t?"":t+""))},textTween:function(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(null==t)return this.tween(e,null);if("function"!=typeof t)throw new Error;return this.tween(e,function(t){var e,i;function n(){var n=t.apply(this,arguments);return n!==i&&(e=(i=n)&&function(t){return function(e){this.textContent=t.call(this,e)}}(n)),e}return n._value=t,n}(t))},remove:function(){return this.on("end.remove",function(t){return function(){var e=this.parentNode;for(var i in this.__transition)if(+i!==t)return;e&&e.removeChild(this)}}(this._id))},tween:function(t,e){var i=this._id;if(t+="",arguments.length<2){for(var n,r=Rh(this.node(),i).tween,s=0,o=r.length;s<o;++s)if((n=r[s]).name===t)return n.value;return null}return this.each((null==e?zh:Bh)(i,t,e))},delay:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?zc:Bc)(e,t)):Rh(this.node(),e).delay},duration:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?Gc:Yc)(e,t)):Rh(this.node(),e).duration},ease:function(t){var e=this._id;return arguments.length?this.each(function(t,e){if("function"!=typeof e)throw new Error;return function(){Th(this,t).ease=e}}(e,t)):Rh(this.node(),e).ease},easeVarying:function(t){if("function"!=typeof t)throw new Error;return this.each(function(t,e){return function(){var i=e.apply(this,arguments);if("function"!=typeof i)throw new Error;Th(this,t).ease=i}}(this._id,t))},end:function(){var t,e,i=this,n=i._id,r=i.size();return new Promise((function(s,o){var a={value:o},l={value:function(){0==--r&&s()}};i.each((function(){var i=Th(this,n),r=i.on;r!==t&&((e=(t=r).copy())._.cancel.push(a),e._.interrupt.push(a),e._.end.push(l)),i.on=e})),0===r&&s()}))},[Symbol.iterator]:Wc[Symbol.iterator]};var Zc={time:null,delay:0,duration:250,ease:function(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}};function Hc(t,e){for(var i;!(i=t.__transition)||!(i=i[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return i}Kl.prototype.interrupt=function(t){return this.each((function(){!function(t,e){var i,n,r,s=t.__transition,o=!0;if(s){for(r in e=null==e?null:e+"",s)(i=s[r]).name===e?(n=i.state>2&&i.state<5,i.state=6,i.timer.stop(),i.on.call(n?"interrupt":"cancel",t,t.__data__,i.index,i.group),delete s[r]):o=!1;o&&delete t.__transition}}(this,t)}))},Kl.prototype.transition=function(t){var e,i;t instanceof Vc?(e=t._id,t=t._name):(e=jc(),(i=Zc).time=fh(),t=null==t?null:t+"");for(var n=this._groups,r=n.length,s=0;s<r;++s)for(var o,a=n[s],l=a.length,h=0;h<l;++h)(o=a[h])&&Mh(o,t,e,h,a,i||Hc(o,e));return new Vc(n,this._parents,t,e)};const{abs:Kc,max:$c,min:Jc}=Math;function Qc(t){return{type:t}}function tu(t,e,i){this.k=t,this.x=e,this.y=i}function eu(t){let e=[];for(let i=0;i<t.length;i+=4){let n=t[i],r=t[i+1],s=t[i+2];t[i+3],e.push([n,r,s])}return e}function iu(t,e,i,n){return eu(e)[Math.floor(t[1])*i+Math.floor(t[0])]}["w","e"].map(Qc),["n","s"].map(Qc),["n","w","e","s","nw","ne","sw","se"].map(Qc),tu.prototype={constructor:tu,scale:function(t){return 1===t?this:new tu(this.k*t,this.x,this.y)},translate:function(t,e){return 0===t&0===e?this:new tu(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}},new tu(1,0,0),tu.prototype;const nu={getBit(t){return this.data[ru(t)]&1<<su(t)?1:0},setBit(t){this.data[ru(t)]|=1<<su(t)},clearBit(t){this.data[ru(t)]&=~(1<<su(t))},toggleBit(t){this.data[ru(t)]^=1<<su(t)},getBitXY(t,e){return t>=this.width||e>=this.height?0:this.getBit(e*this.width+t)},setBitXY(t,e){this.setBit(e*this.width+t)},clearBitXY(t,e){this.clearBit(e*this.width+t)},toggleBitXY(t,e){this.toggleBit(e*this.width+t)}};function ru(t){return t>>3}function su(t){return 7-(7&t)}function ou(t,e,i){return"function"==typeof t.toBlob?new Promise((function(n){t.toBlob(n,e,i)})):Promise.resolve(function(t){var e=t.match(/data:([^;]+)/)[1],i=t.replace(/^[^,]+,/,"");return function(t,e){t=t||[],"string"==typeof(e=e||{})&&(e={type:e});try{return new Blob(t,e)}catch(r){if("TypeError"!==r.name)throw r;for(var i=new("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),n=0;n<t.length;n+=1)i.append(t[n]);return i.getBlob(e.type)}}([au(atob(i))],{type:e})}(t.toDataURL(e,i)))}function au(t){for(var e=t.length,i=new ArrayBuffer(e),n=new Uint8Array(i),r=-1;++r<e;)n[r]=t.charCodeAt(r);return i}var lu=__webpack_require__(4665),hu=__webpack_require__(2155);function cu(t){let e=t.length;for(;--e>=0;)t[e]=0}const uu=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),du=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),gu=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),fu=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),pu=new Array(576);cu(pu);const mu=new Array(60);cu(mu);const _u=new Array(512);cu(_u);const yu=new Array(256);cu(yu);const wu=new Array(29);cu(wu);const xu=new Array(30);function bu(t,e,i,n,r){this.static_tree=t,this.extra_bits=e,this.extra_base=i,this.elems=n,this.max_length=r,this.has_stree=t&&t.length}let vu,Eu,Su;function Iu(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e}cu(xu);const Mu=t=>t<256?_u[t]:_u[256+(t>>>7)],Cu=(t,e)=>{t.pending_buf[t.pending++]=255&e,t.pending_buf[t.pending++]=e>>>8&255},Tu=(t,e,i)=>{t.bi_valid>16-i?(t.bi_buf|=e<<t.bi_valid&65535,Cu(t,t.bi_buf),t.bi_buf=e>>16-t.bi_valid,t.bi_valid+=i-16):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=i)},Ru=(t,e,i)=>{Tu(t,i[2*e],i[2*e+1])},Au=(t,e)=>{let i=0;do{i|=1&t,t>>>=1,i<<=1}while(--e>0);return i>>>1},ku=(t,e,i)=>{const n=new Array(16);let r,s,o=0;for(r=1;r<=15;r++)o=o+i[r-1]<<1,n[r]=o;for(s=0;s<=e;s++){let e=t[2*s+1];0!==e&&(t[2*s]=Au(n[e]++,e))}},Pu=t=>{let e;for(e=0;e<286;e++)t.dyn_ltree[2*e]=0;for(e=0;e<30;e++)t.dyn_dtree[2*e]=0;for(e=0;e<19;e++)t.bl_tree[2*e]=0;t.dyn_ltree[512]=1,t.opt_len=t.static_len=0,t.sym_next=t.matches=0},Lu=t=>{t.bi_valid>8?Cu(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0},Nu=(t,e,i,n)=>{const r=2*e,s=2*i;return t[r]<t[s]||t[r]===t[s]&&n[e]<=n[i]},Du=(t,e,i)=>{const n=t.heap[i];let r=i<<1;for(;r<=t.heap_len&&(r<t.heap_len&&Nu(e,t.heap[r+1],t.heap[r],t.depth)&&r++,!Nu(e,n,t.heap[r],t.depth));)t.heap[i]=t.heap[r],i=r,r<<=1;t.heap[i]=n},Ou=(t,e,i)=>{let n,r,s,o,a=0;if(0!==t.sym_next)do{n=255&t.pending_buf[t.sym_buf+a++],n+=(255&t.pending_buf[t.sym_buf+a++])<<8,r=t.pending_buf[t.sym_buf+a++],0===n?Ru(t,r,e):(s=yu[r],Ru(t,s+256+1,e),o=uu[s],0!==o&&(r-=wu[s],Tu(t,r,o)),n--,s=Mu(n),Ru(t,s,i),o=du[s],0!==o&&(n-=xu[s],Tu(t,n,o)))}while(a<t.sym_next);Ru(t,256,e)},Fu=(t,e)=>{const i=e.dyn_tree,n=e.stat_desc.static_tree,r=e.stat_desc.has_stree,s=e.stat_desc.elems;let o,a,l,h=-1;for(t.heap_len=0,t.heap_max=573,o=0;o<s;o++)0!==i[2*o]?(t.heap[++t.heap_len]=h=o,t.depth[o]=0):i[2*o+1]=0;for(;t.heap_len<2;)l=t.heap[++t.heap_len]=h<2?++h:0,i[2*l]=1,t.depth[l]=0,t.opt_len--,r&&(t.static_len-=n[2*l+1]);for(e.max_code=h,o=t.heap_len>>1;o>=1;o--)Du(t,i,o);l=s;do{o=t.heap[1],t.heap[1]=t.heap[t.heap_len--],Du(t,i,1),a=t.heap[1],t.heap[--t.heap_max]=o,t.heap[--t.heap_max]=a,i[2*l]=i[2*o]+i[2*a],t.depth[l]=(t.depth[o]>=t.depth[a]?t.depth[o]:t.depth[a])+1,i[2*o+1]=i[2*a+1]=l,t.heap[1]=l++,Du(t,i,1)}while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],((t,e)=>{const i=e.dyn_tree,n=e.max_code,r=e.stat_desc.static_tree,s=e.stat_desc.has_stree,o=e.stat_desc.extra_bits,a=e.stat_desc.extra_base,l=e.stat_desc.max_length;let h,c,u,d,g,f,p=0;for(d=0;d<=15;d++)t.bl_count[d]=0;for(i[2*t.heap[t.heap_max]+1]=0,h=t.heap_max+1;h<573;h++)c=t.heap[h],d=i[2*i[2*c+1]+1]+1,d>l&&(d=l,p++),i[2*c+1]=d,c>n||(t.bl_count[d]++,g=0,c>=a&&(g=o[c-a]),f=i[2*c],t.opt_len+=f*(d+g),s&&(t.static_len+=f*(r[2*c+1]+g)));if(0!==p){do{for(d=l-1;0===t.bl_count[d];)d--;t.bl_count[d]--,t.bl_count[d+1]+=2,t.bl_count[l]--,p-=2}while(p>0);for(d=l;0!==d;d--)for(c=t.bl_count[d];0!==c;)u=t.heap[--h],u>n||(i[2*u+1]!==d&&(t.opt_len+=(d-i[2*u+1])*i[2*u],i[2*u+1]=d),c--)}})(t,e),ku(i,h,t.bl_count)},zu=(t,e,i)=>{let n,r,s=-1,o=e[1],a=0,l=7,h=4;for(0===o&&(l=138,h=3),e[2*(i+1)+1]=65535,n=0;n<=i;n++)r=o,o=e[2*(n+1)+1],++a<l&&r===o||(a<h?t.bl_tree[2*r]+=a:0!==r?(r!==s&&t.bl_tree[2*r]++,t.bl_tree[32]++):a<=10?t.bl_tree[34]++:t.bl_tree[36]++,a=0,s=r,0===o?(l=138,h=3):r===o?(l=6,h=3):(l=7,h=4))},Bu=(t,e,i)=>{let n,r,s=-1,o=e[1],a=0,l=7,h=4;for(0===o&&(l=138,h=3),n=0;n<=i;n++)if(r=o,o=e[2*(n+1)+1],!(++a<l&&r===o)){if(a<h)do{Ru(t,r,t.bl_tree)}while(0!=--a);else 0!==r?(r!==s&&(Ru(t,r,t.bl_tree),a--),Ru(t,16,t.bl_tree),Tu(t,a-3,2)):a<=10?(Ru(t,17,t.bl_tree),Tu(t,a-3,3)):(Ru(t,18,t.bl_tree),Tu(t,a-11,7));a=0,s=r,0===o?(l=138,h=3):r===o?(l=6,h=3):(l=7,h=4)}};let Gu=!1;const Yu=(t,e,i,n)=>{Tu(t,0+(n?1:0),3),Lu(t),Cu(t,i),Cu(t,~i),i&&t.pending_buf.set(t.window.subarray(e,e+i),t.pending),t.pending+=i};var Uu={_tr_init:t=>{Gu||((()=>{let t,e,i,n,r;const s=new Array(16);for(i=0,n=0;n<28;n++)for(wu[n]=i,t=0;t<1<<uu[n];t++)yu[i++]=n;for(yu[i-1]=n,r=0,n=0;n<16;n++)for(xu[n]=r,t=0;t<1<<du[n];t++)_u[r++]=n;for(r>>=7;n<30;n++)for(xu[n]=r<<7,t=0;t<1<<du[n]-7;t++)_u[256+r++]=n;for(e=0;e<=15;e++)s[e]=0;for(t=0;t<=143;)pu[2*t+1]=8,t++,s[8]++;for(;t<=255;)pu[2*t+1]=9,t++,s[9]++;for(;t<=279;)pu[2*t+1]=7,t++,s[7]++;for(;t<=287;)pu[2*t+1]=8,t++,s[8]++;for(ku(pu,287,s),t=0;t<30;t++)mu[2*t+1]=5,mu[2*t]=Au(t,5);vu=new bu(pu,uu,257,286,15),Eu=new bu(mu,du,0,30,15),Su=new bu(new Array(0),gu,0,19,7)})(),Gu=!0),t.l_desc=new Iu(t.dyn_ltree,vu),t.d_desc=new Iu(t.dyn_dtree,Eu),t.bl_desc=new Iu(t.bl_tree,Su),t.bi_buf=0,t.bi_valid=0,Pu(t)},_tr_stored_block:Yu,_tr_flush_block:(t,e,i,n)=>{let r,s,o=0;t.level>0?(2===t.strm.data_type&&(t.strm.data_type=(t=>{let e,i=4093624447;for(e=0;e<=31;e++,i>>>=1)if(1&i&&0!==t.dyn_ltree[2*e])return 0;if(0!==t.dyn_ltree[18]||0!==t.dyn_ltree[20]||0!==t.dyn_ltree[26])return 1;for(e=32;e<256;e++)if(0!==t.dyn_ltree[2*e])return 1;return 0})(t)),Fu(t,t.l_desc),Fu(t,t.d_desc),o=(t=>{let e;for(zu(t,t.dyn_ltree,t.l_desc.max_code),zu(t,t.dyn_dtree,t.d_desc.max_code),Fu(t,t.bl_desc),e=18;e>=3&&0===t.bl_tree[2*fu[e]+1];e--);return t.opt_len+=3*(e+1)+5+5+4,e})(t),r=t.opt_len+3+7>>>3,s=t.static_len+3+7>>>3,s<=r&&(r=s)):r=s=i+5,i+4<=r&&-1!==e?Yu(t,e,i,n):4===t.strategy||s===r?(Tu(t,2+(n?1:0),3),Ou(t,pu,mu)):(Tu(t,4+(n?1:0),3),((t,e,i,n)=>{let r;for(Tu(t,e-257,5),Tu(t,i-1,5),Tu(t,n-4,4),r=0;r<n;r++)Tu(t,t.bl_tree[2*fu[r]+1],3);Bu(t,t.dyn_ltree,e-1),Bu(t,t.dyn_dtree,i-1)})(t,t.l_desc.max_code+1,t.d_desc.max_code+1,o+1),Ou(t,t.dyn_ltree,t.dyn_dtree)),Pu(t),n&&Lu(t)},_tr_tally:(t,e,i)=>(t.pending_buf[t.sym_buf+t.sym_next++]=e,t.pending_buf[t.sym_buf+t.sym_next++]=e>>8,t.pending_buf[t.sym_buf+t.sym_next++]=i,0===e?t.dyn_ltree[2*i]++:(t.matches++,e--,t.dyn_ltree[2*(yu[i]+256+1)]++,t.dyn_dtree[2*Mu(e)]++),t.sym_next===t.sym_end),_tr_align:t=>{Tu(t,2,3),Ru(t,256,pu),(t=>{16===t.bi_valid?(Cu(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)})(t)}},Xu=(t,e,i,n)=>{let r=65535&t|0,s=t>>>16&65535|0,o=0;for(;0!==i;){o=i>2e3?2e3:i,i-=o;do{r=r+e[n++]|0,s=s+r|0}while(--o);r%=65521,s%=65521}return r|s<<16|0};const qu=new Uint32Array((()=>{let t,e=[];for(var i=0;i<256;i++){t=i;for(var n=0;n<8;n++)t=1&t?3988292384^t>>>1:t>>>1;e[i]=t}return e})());var Vu=(t,e,i,n)=>{const r=qu,s=n+i;t^=-1;for(let i=n;i<s;i++)t=t>>>8^r[255&(t^e[i])];return-1^t},ju={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Wu={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:Zu,_tr_stored_block:Hu,_tr_flush_block:Ku,_tr_tally:$u,_tr_align:Ju}=Uu,{Z_NO_FLUSH:Qu,Z_PARTIAL_FLUSH:td,Z_FULL_FLUSH:ed,Z_FINISH:id,Z_BLOCK:nd,Z_OK:rd,Z_STREAM_END:sd,Z_STREAM_ERROR:od,Z_DATA_ERROR:ad,Z_BUF_ERROR:ld,Z_DEFAULT_COMPRESSION:hd,Z_FILTERED:cd,Z_HUFFMAN_ONLY:ud,Z_RLE:dd,Z_FIXED:gd,Z_DEFAULT_STRATEGY:fd,Z_UNKNOWN:pd,Z_DEFLATED:md}=Wu,_d=258,yd=262,wd=42,xd=113,bd=666,vd=(t,e)=>(t.msg=ju[e],e),Ed=t=>2*t-(t>4?9:0),Sd=t=>{let e=t.length;for(;--e>=0;)t[e]=0},Id=t=>{let e,i,n,r=t.w_size;e=t.hash_size,n=e;do{i=t.head[--n],t.head[n]=i>=r?i-r:0}while(--e);e=r,n=e;do{i=t.prev[--n],t.prev[n]=i>=r?i-r:0}while(--e)};let Md=(t,e,i)=>(e<<t.hash_shift^i)&t.hash_mask;const Cd=t=>{const e=t.state;let i=e.pending;i>t.avail_out&&(i=t.avail_out),0!==i&&(t.output.set(e.pending_buf.subarray(e.pending_out,e.pending_out+i),t.next_out),t.next_out+=i,e.pending_out+=i,t.total_out+=i,t.avail_out-=i,e.pending-=i,0===e.pending&&(e.pending_out=0))},Td=(t,e)=>{Ku(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,Cd(t.strm)},Rd=(t,e)=>{t.pending_buf[t.pending++]=e},Ad=(t,e)=>{t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=255&e},kd=(t,e,i,n)=>{let r=t.avail_in;return r>n&&(r=n),0===r?0:(t.avail_in-=r,e.set(t.input.subarray(t.next_in,t.next_in+r),i),1===t.state.wrap?t.adler=Xu(t.adler,e,r,i):2===t.state.wrap&&(t.adler=Vu(t.adler,e,r,i)),t.next_in+=r,t.total_in+=r,r)},Pd=(t,e)=>{let i,n,r=t.max_chain_length,s=t.strstart,o=t.prev_length,a=t.nice_match;const l=t.strstart>t.w_size-yd?t.strstart-(t.w_size-yd):0,h=t.window,c=t.w_mask,u=t.prev,d=t.strstart+_d;let g=h[s+o-1],f=h[s+o];t.prev_length>=t.good_match&&(r>>=2),a>t.lookahead&&(a=t.lookahead);do{if(i=e,h[i+o]===f&&h[i+o-1]===g&&h[i]===h[s]&&h[++i]===h[s+1]){s+=2,i++;do{}while(h[++s]===h[++i]&&h[++s]===h[++i]&&h[++s]===h[++i]&&h[++s]===h[++i]&&h[++s]===h[++i]&&h[++s]===h[++i]&&h[++s]===h[++i]&&h[++s]===h[++i]&&s<d);if(n=_d-(d-s),s=d-_d,n>o){if(t.match_start=e,o=n,n>=a)break;g=h[s+o-1],f=h[s+o]}}}while((e=u[e&c])>l&&0!=--r);return o<=t.lookahead?o:t.lookahead},Ld=t=>{const e=t.w_size;let i,n,r;do{if(n=t.window_size-t.lookahead-t.strstart,t.strstart>=e+(e-yd)&&(t.window.set(t.window.subarray(e,e+e-n),0),t.match_start-=e,t.strstart-=e,t.block_start-=e,t.insert>t.strstart&&(t.insert=t.strstart),Id(t),n+=e),0===t.strm.avail_in)break;if(i=kd(t.strm,t.window,t.strstart+t.lookahead,n),t.lookahead+=i,t.lookahead+t.insert>=3)for(r=t.strstart-t.insert,t.ins_h=t.window[r],t.ins_h=Md(t,t.ins_h,t.window[r+1]);t.insert&&(t.ins_h=Md(t,t.ins_h,t.window[r+3-1]),t.prev[r&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=r,r++,t.insert--,!(t.lookahead+t.insert<3)););}while(t.lookahead<yd&&0!==t.strm.avail_in)},Nd=(t,e)=>{let i,n,r,s=t.pending_buf_size-5>t.w_size?t.w_size:t.pending_buf_size-5,o=0,a=t.strm.avail_in;do{if(i=65535,r=t.bi_valid+42>>3,t.strm.avail_out<r)break;if(r=t.strm.avail_out-r,n=t.strstart-t.block_start,i>n+t.strm.avail_in&&(i=n+t.strm.avail_in),i>r&&(i=r),i<s&&(0===i&&e!==id||e===Qu||i!==n+t.strm.avail_in))break;o=e===id&&i===n+t.strm.avail_in?1:0,Hu(t,0,0,o),t.pending_buf[t.pending-4]=i,t.pending_buf[t.pending-3]=i>>8,t.pending_buf[t.pending-2]=~i,t.pending_buf[t.pending-1]=~i>>8,Cd(t.strm),n&&(n>i&&(n=i),t.strm.output.set(t.window.subarray(t.block_start,t.block_start+n),t.strm.next_out),t.strm.next_out+=n,t.strm.avail_out-=n,t.strm.total_out+=n,t.block_start+=n,i-=n),i&&(kd(t.strm,t.strm.output,t.strm.next_out,i),t.strm.next_out+=i,t.strm.avail_out-=i,t.strm.total_out+=i)}while(0===o);return a-=t.strm.avail_in,a&&(a>=t.w_size?(t.matches=2,t.window.set(t.strm.input.subarray(t.strm.next_in-t.w_size,t.strm.next_in),0),t.strstart=t.w_size,t.insert=t.strstart):(t.window_size-t.strstart<=a&&(t.strstart-=t.w_size,t.window.set(t.window.subarray(t.w_size,t.w_size+t.strstart),0),t.matches<2&&t.matches++,t.insert>t.strstart&&(t.insert=t.strstart)),t.window.set(t.strm.input.subarray(t.strm.next_in-a,t.strm.next_in),t.strstart),t.strstart+=a,t.insert+=a>t.w_size-t.insert?t.w_size-t.insert:a),t.block_start=t.strstart),t.high_water<t.strstart&&(t.high_water=t.strstart),o?4:e!==Qu&&e!==id&&0===t.strm.avail_in&&t.strstart===t.block_start?2:(r=t.window_size-t.strstart,t.strm.avail_in>r&&t.block_start>=t.w_size&&(t.block_start-=t.w_size,t.strstart-=t.w_size,t.window.set(t.window.subarray(t.w_size,t.w_size+t.strstart),0),t.matches<2&&t.matches++,r+=t.w_size,t.insert>t.strstart&&(t.insert=t.strstart)),r>t.strm.avail_in&&(r=t.strm.avail_in),r&&(kd(t.strm,t.window,t.strstart,r),t.strstart+=r,t.insert+=r>t.w_size-t.insert?t.w_size-t.insert:r),t.high_water<t.strstart&&(t.high_water=t.strstart),r=t.bi_valid+42>>3,r=t.pending_buf_size-r>65535?65535:t.pending_buf_size-r,s=r>t.w_size?t.w_size:r,n=t.strstart-t.block_start,(n>=s||(n||e===id)&&e!==Qu&&0===t.strm.avail_in&&n<=r)&&(i=n>r?r:n,o=e===id&&0===t.strm.avail_in&&i===n?1:0,Hu(t,t.block_start,i,o),t.block_start+=i,Cd(t.strm)),o?3:1)},Dd=(t,e)=>{let i,n;for(;;){if(t.lookahead<yd){if(Ld(t),t.lookahead<yd&&e===Qu)return 1;if(0===t.lookahead)break}if(i=0,t.lookahead>=3&&(t.ins_h=Md(t,t.ins_h,t.window[t.strstart+3-1]),i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!==i&&t.strstart-i<=t.w_size-yd&&(t.match_length=Pd(t,i)),t.match_length>=3)if(n=$u(t,t.strstart-t.match_start,t.match_length-3),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=3){t.match_length--;do{t.strstart++,t.ins_h=Md(t,t.ins_h,t.window[t.strstart+3-1]),i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart}while(0!=--t.match_length);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=Md(t,t.ins_h,t.window[t.strstart+1]);else n=$u(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(n&&(Td(t,!1),0===t.strm.avail_out))return 1}return t.insert=t.strstart<2?t.strstart:2,e===id?(Td(t,!0),0===t.strm.avail_out?3:4):t.sym_next&&(Td(t,!1),0===t.strm.avail_out)?1:2},Od=(t,e)=>{let i,n,r;for(;;){if(t.lookahead<yd){if(Ld(t),t.lookahead<yd&&e===Qu)return 1;if(0===t.lookahead)break}if(i=0,t.lookahead>=3&&(t.ins_h=Md(t,t.ins_h,t.window[t.strstart+3-1]),i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=2,0!==i&&t.prev_length<t.max_lazy_match&&t.strstart-i<=t.w_size-yd&&(t.match_length=Pd(t,i),t.match_length<=5&&(t.strategy===cd||3===t.match_length&&t.strstart-t.match_start>4096)&&(t.match_length=2)),t.prev_length>=3&&t.match_length<=t.prev_length){r=t.strstart+t.lookahead-3,n=$u(t,t.strstart-1-t.prev_match,t.prev_length-3),t.lookahead-=t.prev_length-1,t.prev_length-=2;do{++t.strstart<=r&&(t.ins_h=Md(t,t.ins_h,t.window[t.strstart+3-1]),i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart)}while(0!=--t.prev_length);if(t.match_available=0,t.match_length=2,t.strstart++,n&&(Td(t,!1),0===t.strm.avail_out))return 1}else if(t.match_available){if(n=$u(t,0,t.window[t.strstart-1]),n&&Td(t,!1),t.strstart++,t.lookahead--,0===t.strm.avail_out)return 1}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(n=$u(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<2?t.strstart:2,e===id?(Td(t,!0),0===t.strm.avail_out?3:4):t.sym_next&&(Td(t,!1),0===t.strm.avail_out)?1:2};function Fd(t,e,i,n,r){this.good_length=t,this.max_lazy=e,this.nice_length=i,this.max_chain=n,this.func=r}const zd=[new Fd(0,0,0,0,Nd),new Fd(4,4,8,4,Dd),new Fd(4,5,16,8,Dd),new Fd(4,6,32,32,Dd),new Fd(4,4,16,16,Od),new Fd(8,16,32,32,Od),new Fd(8,16,128,128,Od),new Fd(8,32,128,256,Od),new Fd(32,128,258,1024,Od),new Fd(32,258,258,4096,Od)];function Bd(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=md,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),Sd(this.dyn_ltree),Sd(this.dyn_dtree),Sd(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),Sd(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),Sd(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const Gd=t=>{if(!t)return 1;const e=t.state;return!e||e.strm!==t||e.status!==wd&&57!==e.status&&69!==e.status&&73!==e.status&&91!==e.status&&103!==e.status&&e.status!==xd&&e.status!==bd?1:0},Yd=t=>{if(Gd(t))return vd(t,od);t.total_in=t.total_out=0,t.data_type=pd;const e=t.state;return e.pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=2===e.wrap?57:e.wrap?wd:xd,t.adler=2===e.wrap?0:1,e.last_flush=-2,Zu(e),rd},Ud=t=>{const e=Yd(t);var i;return e===rd&&((i=t.state).window_size=2*i.w_size,Sd(i.head),i.max_lazy_match=zd[i.level].max_lazy,i.good_match=zd[i.level].good_length,i.nice_match=zd[i.level].nice_length,i.max_chain_length=zd[i.level].max_chain,i.strstart=0,i.block_start=0,i.lookahead=0,i.insert=0,i.match_length=i.prev_length=2,i.match_available=0,i.ins_h=0),e},Xd=(t,e,i,n,r,s)=>{if(!t)return od;let o=1;if(e===hd&&(e=6),n<0?(o=0,n=-n):n>15&&(o=2,n-=16),r<1||r>9||i!==md||n<8||n>15||e<0||e>9||s<0||s>gd||8===n&&1!==o)return vd(t,od);8===n&&(n=9);const a=new Bd;return t.state=a,a.strm=t,a.status=wd,a.wrap=o,a.gzhead=null,a.w_bits=n,a.w_size=1<<a.w_bits,a.w_mask=a.w_size-1,a.hash_bits=r+7,a.hash_size=1<<a.hash_bits,a.hash_mask=a.hash_size-1,a.hash_shift=~~((a.hash_bits+3-1)/3),a.window=new Uint8Array(2*a.w_size),a.head=new Uint16Array(a.hash_size),a.prev=new Uint16Array(a.w_size),a.lit_bufsize=1<<r+6,a.pending_buf_size=4*a.lit_bufsize,a.pending_buf=new Uint8Array(a.pending_buf_size),a.sym_buf=a.lit_bufsize,a.sym_end=3*(a.lit_bufsize-1),a.level=e,a.strategy=s,a.method=i,Ud(t)};var qd={deflateInit:(t,e)=>Xd(t,e,md,15,8,fd),deflateInit2:Xd,deflateReset:Ud,deflateResetKeep:Yd,deflateSetHeader:(t,e)=>Gd(t)||2!==t.state.wrap?od:(t.state.gzhead=e,rd),deflate:(t,e)=>{if(Gd(t)||e>nd||e<0)return t?vd(t,od):od;const i=t.state;if(!t.output||0!==t.avail_in&&!t.input||i.status===bd&&e!==id)return vd(t,0===t.avail_out?ld:od);const n=i.last_flush;if(i.last_flush=e,0!==i.pending){if(Cd(t),0===t.avail_out)return i.last_flush=-1,rd}else if(0===t.avail_in&&Ed(e)<=Ed(n)&&e!==id)return vd(t,ld);if(i.status===bd&&0!==t.avail_in)return vd(t,ld);if(i.status===wd&&0===i.wrap&&(i.status=xd),i.status===wd){let e=md+(i.w_bits-8<<4)<<8,n=-1;if(n=i.strategy>=ud||i.level<2?0:i.level<6?1:6===i.level?2:3,e|=n<<6,0!==i.strstart&&(e|=32),e+=31-e%31,Ad(i,e),0!==i.strstart&&(Ad(i,t.adler>>>16),Ad(i,65535&t.adler)),t.adler=1,i.status=xd,Cd(t),0!==i.pending)return i.last_flush=-1,rd}if(57===i.status)if(t.adler=0,Rd(i,31),Rd(i,139),Rd(i,8),i.gzhead)Rd(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),Rd(i,255&i.gzhead.time),Rd(i,i.gzhead.time>>8&255),Rd(i,i.gzhead.time>>16&255),Rd(i,i.gzhead.time>>24&255),Rd(i,9===i.level?2:i.strategy>=ud||i.level<2?4:0),Rd(i,255&i.gzhead.os),i.gzhead.extra&&i.gzhead.extra.length&&(Rd(i,255&i.gzhead.extra.length),Rd(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(t.adler=Vu(t.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=69;else if(Rd(i,0),Rd(i,0),Rd(i,0),Rd(i,0),Rd(i,0),Rd(i,9===i.level?2:i.strategy>=ud||i.level<2?4:0),Rd(i,3),i.status=xd,Cd(t),0!==i.pending)return i.last_flush=-1,rd;if(69===i.status){if(i.gzhead.extra){let e=i.pending,n=(65535&i.gzhead.extra.length)-i.gzindex;for(;i.pending+n>i.pending_buf_size;){let r=i.pending_buf_size-i.pending;if(i.pending_buf.set(i.gzhead.extra.subarray(i.gzindex,i.gzindex+r),i.pending),i.pending=i.pending_buf_size,i.gzhead.hcrc&&i.pending>e&&(t.adler=Vu(t.adler,i.pending_buf,i.pending-e,e)),i.gzindex+=r,Cd(t),0!==i.pending)return i.last_flush=-1,rd;e=0,n-=r}let r=new Uint8Array(i.gzhead.extra);i.pending_buf.set(r.subarray(i.gzindex,i.gzindex+n),i.pending),i.pending+=n,i.gzhead.hcrc&&i.pending>e&&(t.adler=Vu(t.adler,i.pending_buf,i.pending-e,e)),i.gzindex=0}i.status=73}if(73===i.status){if(i.gzhead.name){let e,n=i.pending;do{if(i.pending===i.pending_buf_size){if(i.gzhead.hcrc&&i.pending>n&&(t.adler=Vu(t.adler,i.pending_buf,i.pending-n,n)),Cd(t),0!==i.pending)return i.last_flush=-1,rd;n=0}e=i.gzindex<i.gzhead.name.length?255&i.gzhead.name.charCodeAt(i.gzindex++):0,Rd(i,e)}while(0!==e);i.gzhead.hcrc&&i.pending>n&&(t.adler=Vu(t.adler,i.pending_buf,i.pending-n,n)),i.gzindex=0}i.status=91}if(91===i.status){if(i.gzhead.comment){let e,n=i.pending;do{if(i.pending===i.pending_buf_size){if(i.gzhead.hcrc&&i.pending>n&&(t.adler=Vu(t.adler,i.pending_buf,i.pending-n,n)),Cd(t),0!==i.pending)return i.last_flush=-1,rd;n=0}e=i.gzindex<i.gzhead.comment.length?255&i.gzhead.comment.charCodeAt(i.gzindex++):0,Rd(i,e)}while(0!==e);i.gzhead.hcrc&&i.pending>n&&(t.adler=Vu(t.adler,i.pending_buf,i.pending-n,n))}i.status=103}if(103===i.status){if(i.gzhead.hcrc){if(i.pending+2>i.pending_buf_size&&(Cd(t),0!==i.pending))return i.last_flush=-1,rd;Rd(i,255&t.adler),Rd(i,t.adler>>8&255),t.adler=0}if(i.status=xd,Cd(t),0!==i.pending)return i.last_flush=-1,rd}if(0!==t.avail_in||0!==i.lookahead||e!==Qu&&i.status!==bd){let n=0===i.level?Nd(i,e):i.strategy===ud?((t,e)=>{let i;for(;;){if(0===t.lookahead&&(Ld(t),0===t.lookahead)){if(e===Qu)return 1;break}if(t.match_length=0,i=$u(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,i&&(Td(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,e===id?(Td(t,!0),0===t.strm.avail_out?3:4):t.sym_next&&(Td(t,!1),0===t.strm.avail_out)?1:2})(i,e):i.strategy===dd?((t,e)=>{let i,n,r,s;const o=t.window;for(;;){if(t.lookahead<=_d){if(Ld(t),t.lookahead<=_d&&e===Qu)return 1;if(0===t.lookahead)break}if(t.match_length=0,t.lookahead>=3&&t.strstart>0&&(r=t.strstart-1,n=o[r],n===o[++r]&&n===o[++r]&&n===o[++r])){s=t.strstart+_d;do{}while(n===o[++r]&&n===o[++r]&&n===o[++r]&&n===o[++r]&&n===o[++r]&&n===o[++r]&&n===o[++r]&&n===o[++r]&&r<s);t.match_length=_d-(s-r),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=3?(i=$u(t,1,t.match_length-3),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(i=$u(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),i&&(Td(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,e===id?(Td(t,!0),0===t.strm.avail_out?3:4):t.sym_next&&(Td(t,!1),0===t.strm.avail_out)?1:2})(i,e):zd[i.level].func(i,e);if(3!==n&&4!==n||(i.status=bd),1===n||3===n)return 0===t.avail_out&&(i.last_flush=-1),rd;if(2===n&&(e===td?Ju(i):e!==nd&&(Hu(i,0,0,!1),e===ed&&(Sd(i.head),0===i.lookahead&&(i.strstart=0,i.block_start=0,i.insert=0))),Cd(t),0===t.avail_out))return i.last_flush=-1,rd}return e!==id?rd:i.wrap<=0?sd:(2===i.wrap?(Rd(i,255&t.adler),Rd(i,t.adler>>8&255),Rd(i,t.adler>>16&255),Rd(i,t.adler>>24&255),Rd(i,255&t.total_in),Rd(i,t.total_in>>8&255),Rd(i,t.total_in>>16&255),Rd(i,t.total_in>>24&255)):(Ad(i,t.adler>>>16),Ad(i,65535&t.adler)),Cd(t),i.wrap>0&&(i.wrap=-i.wrap),0!==i.pending?rd:sd)},deflateEnd:t=>{if(Gd(t))return od;const e=t.state.status;return t.state=null,e===xd?vd(t,ad):rd},deflateSetDictionary:(t,e)=>{let i=e.length;if(Gd(t))return od;const n=t.state,r=n.wrap;if(2===r||1===r&&n.status!==wd||n.lookahead)return od;if(1===r&&(t.adler=Xu(t.adler,e,i,0)),n.wrap=0,i>=n.w_size){0===r&&(Sd(n.head),n.strstart=0,n.block_start=0,n.insert=0);let t=new Uint8Array(n.w_size);t.set(e.subarray(i-n.w_size,i),0),e=t,i=n.w_size}const s=t.avail_in,o=t.next_in,a=t.input;for(t.avail_in=i,t.next_in=0,t.input=e,Ld(n);n.lookahead>=3;){let t=n.strstart,e=n.lookahead-2;do{n.ins_h=Md(n,n.ins_h,n.window[t+3-1]),n.prev[t&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=t,t++}while(--e);n.strstart=t,n.lookahead=2,Ld(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=2,n.match_available=0,t.next_in=o,t.input=a,t.avail_in=s,n.wrap=r,rd},deflateInfo:"pako deflate (from Nodeca project)"};const Vd=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var jd={assign:function(t){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const i=e.shift();if(i){if("object"!=typeof i)throw new TypeError(i+"must be non-object");for(const e in i)Vd(i,e)&&(t[e]=i[e])}}return t},flattenChunks:t=>{let e=0;for(let i=0,n=t.length;i<n;i++)e+=t[i].length;const i=new Uint8Array(e);for(let e=0,n=0,r=t.length;e<r;e++){let r=t[e];i.set(r,n),n+=r.length}return i}};let Wd=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(t){Wd=!1}const Zd=new Uint8Array(256);for(let t=0;t<256;t++)Zd[t]=t>=252?6:t>=248?5:t>=240?4:t>=224?3:t>=192?2:1;Zd[254]=Zd[254]=1;var Hd={string2buf:t=>{if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(t);let e,i,n,r,s,o=t.length,a=0;for(r=0;r<o;r++)i=t.charCodeAt(r),55296==(64512&i)&&r+1<o&&(n=t.charCodeAt(r+1),56320==(64512&n)&&(i=65536+(i-55296<<10)+(n-56320),r++)),a+=i<128?1:i<2048?2:i<65536?3:4;for(e=new Uint8Array(a),s=0,r=0;s<a;r++)i=t.charCodeAt(r),55296==(64512&i)&&r+1<o&&(n=t.charCodeAt(r+1),56320==(64512&n)&&(i=65536+(i-55296<<10)+(n-56320),r++)),i<128?e[s++]=i:i<2048?(e[s++]=192|i>>>6,e[s++]=128|63&i):i<65536?(e[s++]=224|i>>>12,e[s++]=128|i>>>6&63,e[s++]=128|63&i):(e[s++]=240|i>>>18,e[s++]=128|i>>>12&63,e[s++]=128|i>>>6&63,e[s++]=128|63&i);return e},buf2string:(t,e)=>{const i=e||t.length;if("function"==typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(t.subarray(0,e));let n,r;const s=new Array(2*i);for(r=0,n=0;n<i;){let e=t[n++];if(e<128){s[r++]=e;continue}let o=Zd[e];if(o>4)s[r++]=65533,n+=o-1;else{for(e&=2===o?31:3===o?15:7;o>1&&n<i;)e=e<<6|63&t[n++],o--;o>1?s[r++]=65533:e<65536?s[r++]=e:(e-=65536,s[r++]=55296|e>>10&1023,s[r++]=56320|1023&e)}}return((t,e)=>{if(e<65534&&t.subarray&&Wd)return String.fromCharCode.apply(null,t.length===e?t:t.subarray(0,e));let i="";for(let n=0;n<e;n++)i+=String.fromCharCode(t[n]);return i})(s,r)},utf8border:(t,e)=>{(e=e||t.length)>t.length&&(e=t.length);let i=e-1;for(;i>=0&&128==(192&t[i]);)i--;return i<0||0===i?e:i+Zd[t[i]]>e?i:e}},Kd=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};const $d=Object.prototype.toString,{Z_NO_FLUSH:Jd,Z_SYNC_FLUSH:Qd,Z_FULL_FLUSH:tg,Z_FINISH:eg,Z_OK:ig,Z_STREAM_END:ng,Z_DEFAULT_COMPRESSION:rg,Z_DEFAULT_STRATEGY:sg,Z_DEFLATED:og}=Wu;function ag(t){this.options=jd.assign({level:rg,method:og,chunkSize:16384,windowBits:15,memLevel:8,strategy:sg},t||{});let e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Kd,this.strm.avail_out=0;let i=qd.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(i!==ig)throw new Error(ju[i]);if(e.header&&qd.deflateSetHeader(this.strm,e.header),e.dictionary){let t;if(t="string"==typeof e.dictionary?Hd.string2buf(e.dictionary):"[object ArrayBuffer]"===$d.call(e.dictionary)?new Uint8Array(e.dictionary):e.dictionary,i=qd.deflateSetDictionary(this.strm,t),i!==ig)throw new Error(ju[i]);this._dict_set=!0}}function lg(t,e){const i=new ag(e);if(i.push(t,!0),i.err)throw i.msg||ju[i.err];return i.result}ag.prototype.push=function(t,e){const i=this.strm,n=this.options.chunkSize;let r,s;if(this.ended)return!1;for(s=e===~~e?e:!0===e?eg:Jd,"string"==typeof t?i.input=Hd.string2buf(t):"[object ArrayBuffer]"===$d.call(t)?i.input=new Uint8Array(t):i.input=t,i.next_in=0,i.avail_in=i.input.length;;)if(0===i.avail_out&&(i.output=new Uint8Array(n),i.next_out=0,i.avail_out=n),(s===Qd||s===tg)&&i.avail_out<=6)this.onData(i.output.subarray(0,i.next_out)),i.avail_out=0;else{if(r=qd.deflate(i,s),r===ng)return i.next_out>0&&this.onData(i.output.subarray(0,i.next_out)),r=qd.deflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===ig;if(0!==i.avail_out){if(s>0&&i.next_out>0)this.onData(i.output.subarray(0,i.next_out)),i.avail_out=0;else if(0===i.avail_in)break}else this.onData(i.output)}return!0},ag.prototype.onData=function(t){this.chunks.push(t)},ag.prototype.onEnd=function(t){t===ig&&(this.result=jd.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};var hg={Deflate:ag,deflate:lg,deflateRaw:function(t,e){return(e=e||{}).raw=!0,lg(t,e)},gzip:function(t,e){return(e=e||{}).gzip=!0,lg(t,e)},constants:Wu};const cg=16209;var ug=function(t,e){let i,n,r,s,o,a,l,h,c,u,d,g,f,p,m,_,y,w,x,b,v,E,S,I;const M=t.state;i=t.next_in,S=t.input,n=i+(t.avail_in-5),r=t.next_out,I=t.output,s=r-(e-t.avail_out),o=r+(t.avail_out-257),a=M.dmax,l=M.wsize,h=M.whave,c=M.wnext,u=M.window,d=M.hold,g=M.bits,f=M.lencode,p=M.distcode,m=(1<<M.lenbits)-1,_=(1<<M.distbits)-1;t:do{g<15&&(d+=S[i++]<<g,g+=8,d+=S[i++]<<g,g+=8),y=f[d&m];e:for(;;){if(w=y>>>24,d>>>=w,g-=w,w=y>>>16&255,0===w)I[r++]=65535&y;else{if(!(16&w)){if(0==(64&w)){y=f[(65535&y)+(d&(1<<w)-1)];continue e}if(32&w){M.mode=16191;break t}t.msg="invalid literal/length code",M.mode=cg;break t}x=65535&y,w&=15,w&&(g<w&&(d+=S[i++]<<g,g+=8),x+=d&(1<<w)-1,d>>>=w,g-=w),g<15&&(d+=S[i++]<<g,g+=8,d+=S[i++]<<g,g+=8),y=p[d&_];i:for(;;){if(w=y>>>24,d>>>=w,g-=w,w=y>>>16&255,!(16&w)){if(0==(64&w)){y=p[(65535&y)+(d&(1<<w)-1)];continue i}t.msg="invalid distance code",M.mode=cg;break t}if(b=65535&y,w&=15,g<w&&(d+=S[i++]<<g,g+=8,g<w&&(d+=S[i++]<<g,g+=8)),b+=d&(1<<w)-1,b>a){t.msg="invalid distance too far back",M.mode=cg;break t}if(d>>>=w,g-=w,w=r-s,b>w){if(w=b-w,w>h&&M.sane){t.msg="invalid distance too far back",M.mode=cg;break t}if(v=0,E=u,0===c){if(v+=l-w,w<x){x-=w;do{I[r++]=u[v++]}while(--w);v=r-b,E=I}}else if(c<w){if(v+=l+c-w,w-=c,w<x){x-=w;do{I[r++]=u[v++]}while(--w);if(v=0,c<x){w=c,x-=w;do{I[r++]=u[v++]}while(--w);v=r-b,E=I}}}else if(v+=c-w,w<x){x-=w;do{I[r++]=u[v++]}while(--w);v=r-b,E=I}for(;x>2;)I[r++]=E[v++],I[r++]=E[v++],I[r++]=E[v++],x-=3;x&&(I[r++]=E[v++],x>1&&(I[r++]=E[v++]))}else{v=r-b;do{I[r++]=I[v++],I[r++]=I[v++],I[r++]=I[v++],x-=3}while(x>2);x&&(I[r++]=I[v++],x>1&&(I[r++]=I[v++]))}break}}break}}while(i<n&&r<o);x=g>>3,i-=x,g-=x<<3,d&=(1<<g)-1,t.next_in=i,t.next_out=r,t.avail_in=i<n?n-i+5:5-(i-n),t.avail_out=r<o?o-r+257:257-(r-o),M.hold=d,M.bits=g};const dg=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),gg=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),fg=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),pg=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var mg=(t,e,i,n,r,s,o,a)=>{const l=a.bits;let h,c,u,d,g,f,p=0,m=0,_=0,y=0,w=0,x=0,b=0,v=0,E=0,S=0,I=null;const M=new Uint16Array(16),C=new Uint16Array(16);let T,R,A,k=null;for(p=0;p<=15;p++)M[p]=0;for(m=0;m<n;m++)M[e[i+m]]++;for(w=l,y=15;y>=1&&0===M[y];y--);if(w>y&&(w=y),0===y)return r[s++]=20971520,r[s++]=20971520,a.bits=1,0;for(_=1;_<y&&0===M[_];_++);for(w<_&&(w=_),v=1,p=1;p<=15;p++)if(v<<=1,v-=M[p],v<0)return-1;if(v>0&&(0===t||1!==y))return-1;for(C[1]=0,p=1;p<15;p++)C[p+1]=C[p]+M[p];for(m=0;m<n;m++)0!==e[i+m]&&(o[C[e[i+m]]++]=m);if(0===t?(I=k=o,f=20):1===t?(I=dg,k=gg,f=257):(I=fg,k=pg,f=0),S=0,m=0,p=_,g=s,x=w,b=0,u=-1,E=1<<w,d=E-1,1===t&&E>852||2===t&&E>592)return 1;for(;;){T=p-b,o[m]+1<f?(R=0,A=o[m]):o[m]>=f?(R=k[o[m]-f],A=I[o[m]-f]):(R=96,A=0),h=1<<p-b,c=1<<x,_=c;do{c-=h,r[g+(S>>b)+c]=T<<24|R<<16|A|0}while(0!==c);for(h=1<<p-1;S&h;)h>>=1;if(0!==h?(S&=h-1,S+=h):S=0,m++,0==--M[p]){if(p===y)break;p=e[i+o[m]]}if(p>w&&(S&d)!==u){for(0===b&&(b=w),g+=_,x=p-b,v=1<<x;x+b<y&&(v-=M[x+b],!(v<=0));)x++,v<<=1;if(E+=1<<x,1===t&&E>852||2===t&&E>592)return 1;u=S&d,r[u]=w<<24|x<<16|g-s|0}}return 0!==S&&(r[g+S]=p-b<<24|64<<16|0),a.bits=w,0};const{Z_FINISH:_g,Z_BLOCK:yg,Z_TREES:wg,Z_OK:xg,Z_STREAM_END:bg,Z_NEED_DICT:vg,Z_STREAM_ERROR:Eg,Z_DATA_ERROR:Sg,Z_MEM_ERROR:Ig,Z_BUF_ERROR:Mg,Z_DEFLATED:Cg}=Wu,Tg=16180,Rg=16190,Ag=16191,kg=16192,Pg=16194,Lg=16199,Ng=16200,Dg=16206,Og=16209,Fg=t=>(t>>>24&255)+(t>>>8&65280)+((65280&t)<<8)+((255&t)<<24);function zg(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Bg=t=>{if(!t)return 1;const e=t.state;return!e||e.strm!==t||e.mode<Tg||e.mode>16211?1:0},Gg=t=>{if(Bg(t))return Eg;const e=t.state;return t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=1&e.wrap),e.mode=Tg,e.last=0,e.havedict=0,e.flags=-1,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(852),e.distcode=e.distdyn=new Int32Array(592),e.sane=1,e.back=-1,xg},Yg=t=>{if(Bg(t))return Eg;const e=t.state;return e.wsize=0,e.whave=0,e.wnext=0,Gg(t)},Ug=(t,e)=>{let i;if(Bg(t))return Eg;const n=t.state;return e<0?(i=0,e=-e):(i=5+(e>>4),e<48&&(e&=15)),e&&(e<8||e>15)?Eg:(null!==n.window&&n.wbits!==e&&(n.window=null),n.wrap=i,n.wbits=e,Yg(t))},Xg=(t,e)=>{if(!t)return Eg;const i=new zg;t.state=i,i.strm=t,i.window=null,i.mode=Tg;const n=Ug(t,e);return n!==xg&&(t.state=null),n};let qg,Vg,jg=!0;const Wg=t=>{if(jg){qg=new Int32Array(512),Vg=new Int32Array(32);let e=0;for(;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(mg(1,t.lens,0,288,qg,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;mg(2,t.lens,0,32,Vg,0,t.work,{bits:5}),jg=!1}t.lencode=qg,t.lenbits=9,t.distcode=Vg,t.distbits=5},Zg=(t,e,i,n)=>{let r;const s=t.state;return null===s.window&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new Uint8Array(s.wsize)),n>=s.wsize?(s.window.set(e.subarray(i-s.wsize,i),0),s.wnext=0,s.whave=s.wsize):(r=s.wsize-s.wnext,r>n&&(r=n),s.window.set(e.subarray(i-n,i-n+r),s.wnext),(n-=r)?(s.window.set(e.subarray(i-n,i),0),s.wnext=n,s.whave=s.wsize):(s.wnext+=r,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=r))),0};var Hg={inflateReset:Yg,inflateReset2:Ug,inflateResetKeep:Gg,inflateInit:t=>Xg(t,15),inflateInit2:Xg,inflate:(t,e)=>{let i,n,r,s,o,a,l,h,c,u,d,g,f,p,m,_,y,w,x,b,v,E,S=0;const I=new Uint8Array(4);let M,C;const T=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Bg(t)||!t.output||!t.input&&0!==t.avail_in)return Eg;i=t.state,i.mode===Ag&&(i.mode=kg),o=t.next_out,r=t.output,l=t.avail_out,s=t.next_in,n=t.input,a=t.avail_in,h=i.hold,c=i.bits,u=a,d=l,E=xg;t:for(;;)switch(i.mode){case Tg:if(0===i.wrap){i.mode=kg;break}for(;c<16;){if(0===a)break t;a--,h+=n[s++]<<c,c+=8}if(2&i.wrap&&35615===h){0===i.wbits&&(i.wbits=15),i.check=0,I[0]=255&h,I[1]=h>>>8&255,i.check=Vu(i.check,I,2,0),h=0,c=0,i.mode=16181;break}if(i.head&&(i.head.done=!1),!(1&i.wrap)||(((255&h)<<8)+(h>>8))%31){t.msg="incorrect header check",i.mode=Og;break}if((15&h)!==Cg){t.msg="unknown compression method",i.mode=Og;break}if(h>>>=4,c-=4,v=8+(15&h),0===i.wbits&&(i.wbits=v),v>15||v>i.wbits){t.msg="invalid window size",i.mode=Og;break}i.dmax=1<<i.wbits,i.flags=0,t.adler=i.check=1,i.mode=512&h?16189:Ag,h=0,c=0;break;case 16181:for(;c<16;){if(0===a)break t;a--,h+=n[s++]<<c,c+=8}if(i.flags=h,(255&i.flags)!==Cg){t.msg="unknown compression method",i.mode=Og;break}if(57344&i.flags){t.msg="unknown header flags set",i.mode=Og;break}i.head&&(i.head.text=h>>8&1),512&i.flags&&4&i.wrap&&(I[0]=255&h,I[1]=h>>>8&255,i.check=Vu(i.check,I,2,0)),h=0,c=0,i.mode=16182;case 16182:for(;c<32;){if(0===a)break t;a--,h+=n[s++]<<c,c+=8}i.head&&(i.head.time=h),512&i.flags&&4&i.wrap&&(I[0]=255&h,I[1]=h>>>8&255,I[2]=h>>>16&255,I[3]=h>>>24&255,i.check=Vu(i.check,I,4,0)),h=0,c=0,i.mode=16183;case 16183:for(;c<16;){if(0===a)break t;a--,h+=n[s++]<<c,c+=8}i.head&&(i.head.xflags=255&h,i.head.os=h>>8),512&i.flags&&4&i.wrap&&(I[0]=255&h,I[1]=h>>>8&255,i.check=Vu(i.check,I,2,0)),h=0,c=0,i.mode=16184;case 16184:if(1024&i.flags){for(;c<16;){if(0===a)break t;a--,h+=n[s++]<<c,c+=8}i.length=h,i.head&&(i.head.extra_len=h),512&i.flags&&4&i.wrap&&(I[0]=255&h,I[1]=h>>>8&255,i.check=Vu(i.check,I,2,0)),h=0,c=0}else i.head&&(i.head.extra=null);i.mode=16185;case 16185:if(1024&i.flags&&(g=i.length,g>a&&(g=a),g&&(i.head&&(v=i.head.extra_len-i.length,i.head.extra||(i.head.extra=new Uint8Array(i.head.extra_len)),i.head.extra.set(n.subarray(s,s+g),v)),512&i.flags&&4&i.wrap&&(i.check=Vu(i.check,n,g,s)),a-=g,s+=g,i.length-=g),i.length))break t;i.length=0,i.mode=16186;case 16186:if(2048&i.flags){if(0===a)break t;g=0;do{v=n[s+g++],i.head&&v&&i.length<65536&&(i.head.name+=String.fromCharCode(v))}while(v&&g<a);if(512&i.flags&&4&i.wrap&&(i.check=Vu(i.check,n,g,s)),a-=g,s+=g,v)break t}else i.head&&(i.head.name=null);i.length=0,i.mode=16187;case 16187:if(4096&i.flags){if(0===a)break t;g=0;do{v=n[s+g++],i.head&&v&&i.length<65536&&(i.head.comment+=String.fromCharCode(v))}while(v&&g<a);if(512&i.flags&&4&i.wrap&&(i.check=Vu(i.check,n,g,s)),a-=g,s+=g,v)break t}else i.head&&(i.head.comment=null);i.mode=16188;case 16188:if(512&i.flags){for(;c<16;){if(0===a)break t;a--,h+=n[s++]<<c,c+=8}if(4&i.wrap&&h!==(65535&i.check)){t.msg="header crc mismatch",i.mode=Og;break}h=0,c=0}i.head&&(i.head.hcrc=i.flags>>9&1,i.head.done=!0),t.adler=i.check=0,i.mode=Ag;break;case 16189:for(;c<32;){if(0===a)break t;a--,h+=n[s++]<<c,c+=8}t.adler=i.check=Fg(h),h=0,c=0,i.mode=Rg;case Rg:if(0===i.havedict)return t.next_out=o,t.avail_out=l,t.next_in=s,t.avail_in=a,i.hold=h,i.bits=c,vg;t.adler=i.check=1,i.mode=Ag;case Ag:if(e===yg||e===wg)break t;case kg:if(i.last){h>>>=7&c,c-=7&c,i.mode=Dg;break}for(;c<3;){if(0===a)break t;a--,h+=n[s++]<<c,c+=8}switch(i.last=1&h,h>>>=1,c-=1,3&h){case 0:i.mode=16193;break;case 1:if(Wg(i),i.mode=Lg,e===wg){h>>>=2,c-=2;break t}break;case 2:i.mode=16196;break;case 3:t.msg="invalid block type",i.mode=Og}h>>>=2,c-=2;break;case 16193:for(h>>>=7&c,c-=7&c;c<32;){if(0===a)break t;a--,h+=n[s++]<<c,c+=8}if((65535&h)!=(h>>>16^65535)){t.msg="invalid stored block lengths",i.mode=Og;break}if(i.length=65535&h,h=0,c=0,i.mode=Pg,e===wg)break t;case Pg:i.mode=16195;case 16195:if(g=i.length,g){if(g>a&&(g=a),g>l&&(g=l),0===g)break t;r.set(n.subarray(s,s+g),o),a-=g,s+=g,l-=g,o+=g,i.length-=g;break}i.mode=Ag;break;case 16196:for(;c<14;){if(0===a)break t;a--,h+=n[s++]<<c,c+=8}if(i.nlen=257+(31&h),h>>>=5,c-=5,i.ndist=1+(31&h),h>>>=5,c-=5,i.ncode=4+(15&h),h>>>=4,c-=4,i.nlen>286||i.ndist>30){t.msg="too many length or distance symbols",i.mode=Og;break}i.have=0,i.mode=16197;case 16197:for(;i.have<i.ncode;){for(;c<3;){if(0===a)break t;a--,h+=n[s++]<<c,c+=8}i.lens[T[i.have++]]=7&h,h>>>=3,c-=3}for(;i.have<19;)i.lens[T[i.have++]]=0;if(i.lencode=i.lendyn,i.lenbits=7,M={bits:i.lenbits},E=mg(0,i.lens,0,19,i.lencode,0,i.work,M),i.lenbits=M.bits,E){t.msg="invalid code lengths set",i.mode=Og;break}i.have=0,i.mode=16198;case 16198:for(;i.have<i.nlen+i.ndist;){for(;S=i.lencode[h&(1<<i.lenbits)-1],m=S>>>24,_=S>>>16&255,y=65535&S,!(m<=c);){if(0===a)break t;a--,h+=n[s++]<<c,c+=8}if(y<16)h>>>=m,c-=m,i.lens[i.have++]=y;else{if(16===y){for(C=m+2;c<C;){if(0===a)break t;a--,h+=n[s++]<<c,c+=8}if(h>>>=m,c-=m,0===i.have){t.msg="invalid bit length repeat",i.mode=Og;break}v=i.lens[i.have-1],g=3+(3&h),h>>>=2,c-=2}else if(17===y){for(C=m+3;c<C;){if(0===a)break t;a--,h+=n[s++]<<c,c+=8}h>>>=m,c-=m,v=0,g=3+(7&h),h>>>=3,c-=3}else{for(C=m+7;c<C;){if(0===a)break t;a--,h+=n[s++]<<c,c+=8}h>>>=m,c-=m,v=0,g=11+(127&h),h>>>=7,c-=7}if(i.have+g>i.nlen+i.ndist){t.msg="invalid bit length repeat",i.mode=Og;break}for(;g--;)i.lens[i.have++]=v}}if(i.mode===Og)break;if(0===i.lens[256]){t.msg="invalid code -- missing end-of-block",i.mode=Og;break}if(i.lenbits=9,M={bits:i.lenbits},E=mg(1,i.lens,0,i.nlen,i.lencode,0,i.work,M),i.lenbits=M.bits,E){t.msg="invalid literal/lengths set",i.mode=Og;break}if(i.distbits=6,i.distcode=i.distdyn,M={bits:i.distbits},E=mg(2,i.lens,i.nlen,i.ndist,i.distcode,0,i.work,M),i.distbits=M.bits,E){t.msg="invalid distances set",i.mode=Og;break}if(i.mode=Lg,e===wg)break t;case Lg:i.mode=Ng;case Ng:if(a>=6&&l>=258){t.next_out=o,t.avail_out=l,t.next_in=s,t.avail_in=a,i.hold=h,i.bits=c,ug(t,d),o=t.next_out,r=t.output,l=t.avail_out,s=t.next_in,n=t.input,a=t.avail_in,h=i.hold,c=i.bits,i.mode===Ag&&(i.back=-1);break}for(i.back=0;S=i.lencode[h&(1<<i.lenbits)-1],m=S>>>24,_=S>>>16&255,y=65535&S,!(m<=c);){if(0===a)break t;a--,h+=n[s++]<<c,c+=8}if(_&&0==(240&_)){for(w=m,x=_,b=y;S=i.lencode[b+((h&(1<<w+x)-1)>>w)],m=S>>>24,_=S>>>16&255,y=65535&S,!(w+m<=c);){if(0===a)break t;a--,h+=n[s++]<<c,c+=8}h>>>=w,c-=w,i.back+=w}if(h>>>=m,c-=m,i.back+=m,i.length=y,0===_){i.mode=16205;break}if(32&_){i.back=-1,i.mode=Ag;break}if(64&_){t.msg="invalid literal/length code",i.mode=Og;break}i.extra=15&_,i.mode=16201;case 16201:if(i.extra){for(C=i.extra;c<C;){if(0===a)break t;a--,h+=n[s++]<<c,c+=8}i.length+=h&(1<<i.extra)-1,h>>>=i.extra,c-=i.extra,i.back+=i.extra}i.was=i.length,i.mode=16202;case 16202:for(;S=i.distcode[h&(1<<i.distbits)-1],m=S>>>24,_=S>>>16&255,y=65535&S,!(m<=c);){if(0===a)break t;a--,h+=n[s++]<<c,c+=8}if(0==(240&_)){for(w=m,x=_,b=y;S=i.distcode[b+((h&(1<<w+x)-1)>>w)],m=S>>>24,_=S>>>16&255,y=65535&S,!(w+m<=c);){if(0===a)break t;a--,h+=n[s++]<<c,c+=8}h>>>=w,c-=w,i.back+=w}if(h>>>=m,c-=m,i.back+=m,64&_){t.msg="invalid distance code",i.mode=Og;break}i.offset=y,i.extra=15&_,i.mode=16203;case 16203:if(i.extra){for(C=i.extra;c<C;){if(0===a)break t;a--,h+=n[s++]<<c,c+=8}i.offset+=h&(1<<i.extra)-1,h>>>=i.extra,c-=i.extra,i.back+=i.extra}if(i.offset>i.dmax){t.msg="invalid distance too far back",i.mode=Og;break}i.mode=16204;case 16204:if(0===l)break t;if(g=d-l,i.offset>g){if(g=i.offset-g,g>i.whave&&i.sane){t.msg="invalid distance too far back",i.mode=Og;break}g>i.wnext?(g-=i.wnext,f=i.wsize-g):f=i.wnext-g,g>i.length&&(g=i.length),p=i.window}else p=r,f=o-i.offset,g=i.length;g>l&&(g=l),l-=g,i.length-=g;do{r[o++]=p[f++]}while(--g);0===i.length&&(i.mode=Ng);break;case 16205:if(0===l)break t;r[o++]=i.length,l--,i.mode=Ng;break;case Dg:if(i.wrap){for(;c<32;){if(0===a)break t;a--,h|=n[s++]<<c,c+=8}if(d-=l,t.total_out+=d,i.total+=d,4&i.wrap&&d&&(t.adler=i.check=i.flags?Vu(i.check,r,d,o-d):Xu(i.check,r,d,o-d)),d=l,4&i.wrap&&(i.flags?h:Fg(h))!==i.check){t.msg="incorrect data check",i.mode=Og;break}h=0,c=0}i.mode=16207;case 16207:if(i.wrap&&i.flags){for(;c<32;){if(0===a)break t;a--,h+=n[s++]<<c,c+=8}if(4&i.wrap&&h!==(4294967295&i.total)){t.msg="incorrect length check",i.mode=Og;break}h=0,c=0}i.mode=16208;case 16208:E=bg;break t;case Og:E=Sg;break t;case 16210:return Ig;default:return Eg}return t.next_out=o,t.avail_out=l,t.next_in=s,t.avail_in=a,i.hold=h,i.bits=c,(i.wsize||d!==t.avail_out&&i.mode<Og&&(i.mode<Dg||e!==_g))&&Zg(t,t.output,t.next_out,d-t.avail_out),u-=t.avail_in,d-=t.avail_out,t.total_in+=u,t.total_out+=d,i.total+=d,4&i.wrap&&d&&(t.adler=i.check=i.flags?Vu(i.check,r,d,t.next_out-d):Xu(i.check,r,d,t.next_out-d)),t.data_type=i.bits+(i.last?64:0)+(i.mode===Ag?128:0)+(i.mode===Lg||i.mode===Pg?256:0),(0===u&&0===d||e===_g)&&E===xg&&(E=Mg),E},inflateEnd:t=>{if(Bg(t))return Eg;let e=t.state;return e.window&&(e.window=null),t.state=null,xg},inflateGetHeader:(t,e)=>{if(Bg(t))return Eg;const i=t.state;return 0==(2&i.wrap)?Eg:(i.head=e,e.done=!1,xg)},inflateSetDictionary:(t,e)=>{const i=e.length;let n,r,s;return Bg(t)?Eg:(n=t.state,0!==n.wrap&&n.mode!==Rg?Eg:n.mode===Rg&&(r=1,r=Xu(r,e,i,0),r!==n.check)?Sg:(s=Zg(t,e,i,i),s?(n.mode=16210,Ig):(n.havedict=1,xg)))},inflateInfo:"pako inflate (from Nodeca project)"},Kg=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};const $g=Object.prototype.toString,{Z_NO_FLUSH:Jg,Z_FINISH:Qg,Z_OK:tf,Z_STREAM_END:ef,Z_NEED_DICT:nf,Z_STREAM_ERROR:rf,Z_DATA_ERROR:sf,Z_MEM_ERROR:of}=Wu;function af(t){this.options=jd.assign({chunkSize:65536,windowBits:15,to:""},t||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,0===e.windowBits&&(e.windowBits=-15)),!(e.windowBits>=0&&e.windowBits<16)||t&&t.windowBits||(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&0==(15&e.windowBits)&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Kd,this.strm.avail_out=0;let i=Hg.inflateInit2(this.strm,e.windowBits);if(i!==tf)throw new Error(ju[i]);if(this.header=new Kg,Hg.inflateGetHeader(this.strm,this.header),e.dictionary&&("string"==typeof e.dictionary?e.dictionary=Hd.string2buf(e.dictionary):"[object ArrayBuffer]"===$g.call(e.dictionary)&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(i=Hg.inflateSetDictionary(this.strm,e.dictionary),i!==tf)))throw new Error(ju[i])}function lf(t,e){const i=new af(e);if(i.push(t),i.err)throw i.msg||ju[i.err];return i.result}af.prototype.push=function(t,e){const i=this.strm,n=this.options.chunkSize,r=this.options.dictionary;let s,o,a;if(this.ended)return!1;for(o=e===~~e?e:!0===e?Qg:Jg,"[object ArrayBuffer]"===$g.call(t)?i.input=new Uint8Array(t):i.input=t,i.next_in=0,i.avail_in=i.input.length;;){for(0===i.avail_out&&(i.output=new Uint8Array(n),i.next_out=0,i.avail_out=n),s=Hg.inflate(i,o),s===nf&&r&&(s=Hg.inflateSetDictionary(i,r),s===tf?s=Hg.inflate(i,o):s===sf&&(s=nf));i.avail_in>0&&s===ef&&i.state.wrap>0&&0!==t[i.next_in];)Hg.inflateReset(i),s=Hg.inflate(i,o);switch(s){case rf:case sf:case nf:case of:return this.onEnd(s),this.ended=!0,!1}if(a=i.avail_out,i.next_out&&(0===i.avail_out||s===ef))if("string"===this.options.to){let t=Hd.utf8border(i.output,i.next_out),e=i.next_out-t,r=Hd.buf2string(i.output,t);i.next_out=e,i.avail_out=n-e,e&&i.output.set(i.output.subarray(t,t+e),0),this.onData(r)}else this.onData(i.output.length===i.next_out?i.output:i.output.subarray(0,i.next_out));if(s!==tf||0!==a){if(s===ef)return s=Hg.inflateEnd(this.strm),this.onEnd(s),this.ended=!0,!0;if(0===i.avail_in)break}}return!0},af.prototype.onData=function(t){this.chunks.push(t)},af.prototype.onEnd=function(t){t===tf&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=jd.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};var hf={Inflate:af,inflate:lf,inflateRaw:function(t,e){return(e=e||{}).raw=!0,lf(t,e)},ungzip:lf,constants:Wu};const{Deflate:cf,deflate:uf,deflateRaw:df,gzip:gf}=hg,{Inflate:ff,inflate:pf,inflateRaw:mf,ungzip:_f}=hf;var yf=uf,wf=ff,xf=pf;const bf=[137,80,78,71,13,10,26,10],vf=[];for(let t=0;t<256;t++){let e=t;for(let t=0;t<8;t++)1&e?e=3988292384^e>>>1:e>>>=1;vf[t]=e}const Ef=4294967295;function Sf(t,e){return(function(t,e,i){let n=4294967295;for(let t=0;t<i;t++)n=vf[255&(n^e[t])]^n>>>8;return n}(0,t,e)^Ef)>>>0}var If,Mf,Cf,Tf;!function(t){t[t.UNKNOWN=-1]="UNKNOWN",t[t.GREYSCALE=0]="GREYSCALE",t[t.TRUECOLOUR=2]="TRUECOLOUR",t[t.INDEXED_COLOUR=3]="INDEXED_COLOUR",t[t.GREYSCALE_ALPHA=4]="GREYSCALE_ALPHA",t[t.TRUECOLOUR_ALPHA=6]="TRUECOLOUR_ALPHA"}(If||(If={})),function(t){t[t.UNKNOWN=-1]="UNKNOWN",t[t.DEFLATE=0]="DEFLATE"}(Mf||(Mf={})),function(t){t[t.UNKNOWN=-1]="UNKNOWN",t[t.ADAPTIVE=0]="ADAPTIVE"}(Cf||(Cf={})),function(t){t[t.UNKNOWN=-1]="UNKNOWN",t[t.NO_INTERLACE=0]="NO_INTERLACE",t[t.ADAM7=1]="ADAM7"}(Tf||(Tf={}));const Rf=new Uint8Array(0),Af=new Uint16Array([255]),kf=255===new Uint8Array(Af.buffer)[0];class Pf extends hu.IOBuffer{constructor(t,e={}){super(t);const{checkCrc:i=!1}=e;this._checkCrc=i,this._inflator=new wf,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=Mf.UNKNOWN,this._filterMethod=Cf.UNKNOWN,this._interlaceMethod=Tf.UNKNOWN,this._colorType=If.UNKNOWN,this.setBigEndian()}decode(){for(this.decodeSignature();!this._end;)this.decodeChunk();return this.decodeImage(),this._png}decodeSignature(){for(let t=0;t<bf.length;t++)if(this.readUint8()!==bf[t])throw new Error(`wrong PNG signature. Byte at ${t} should be ${bf[t]}.`)}decodeChunk(){const t=this.readUint32(),e=this.readChars(4),i=this.offset;switch(e){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(t);break;case"IDAT":this.decodeIDAT(t);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(t);break;case"iCCP":this.decodeiCCP(t);break;case"tEXt":this.decodetEXt(t);break;case"pHYs":this.decodepHYs();break;default:this.skip(t)}if(this.offset-i!==t)throw new Error(`Length mismatch while decoding chunk ${e}`);if(this._checkCrc){const i=this.readUint32(),n=t+4,r=Sf(new Uint8Array(this.buffer,this.byteOffset+this.offset-n-4,n),n);if(r!==i)throw new Error(`CRC mismatch for chunk ${e}. Expected ${i}, found ${r}`)}else this.skip(4)}decodeIHDR(){const t=this._png;t.width=this.readUint32(),t.height=this.readUint32(),t.depth=function(t){if(1!==t&&2!==t&&4!==t&&8!==t&&16!==t)throw new Error(`invalid bit depth: ${t}`);return t}(this.readUint8());const e=this.readUint8();let i;switch(this._colorType=e,e){case If.GREYSCALE:i=1;break;case If.TRUECOLOUR:i=3;break;case If.INDEXED_COLOUR:i=1;break;case If.GREYSCALE_ALPHA:i=2;break;case If.TRUECOLOUR_ALPHA:i=4;break;default:throw new Error(`Unknown color type: ${e}`)}if(this._png.channels=i,this._compressionMethod=this.readUint8(),this._compressionMethod!==Mf.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodePLTE(t){if(t%3!=0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${t}`);const e=t/3;this._hasPalette=!0;const i=[];this._palette=i;for(let t=0;t<e;t++)i.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(t){this._inflator.push(new Uint8Array(this.buffer,this.offset+this.byteOffset,t)),this.skip(t)}decodetRNS(t){switch(this._colorType){case If.GREYSCALE:case If.TRUECOLOUR:if(t%2!=0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${t}`);if(t/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${t/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(t/2);for(let e=0;e<t/2;e++)this._transparency[e]=this.readUint16();break;case If.INDEXED_COLOUR:{if(t>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${t} vs ${this._palette.length})`);let e=0;for(;e<t;e++){const t=this.readByte();this._palette[e].push(t)}for(;e<this._palette.length;e++)this._palette[e].push(255);break}default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(t){let e,i="";for(;"\0"!==(e=this.readChar());)i+=e;const n=this.readUint8();if(n!==Mf.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${n}`);const r=this.readBytes(t-i.length-2);this._png.iccEmbeddedProfile={name:i,profile:xf(r)}}decodetEXt(t){let e,i="";for(;"\0"!==(e=this.readChar());)i+=e;this._png.text[i]=this.readChars(t-i.length-1)}decodepHYs(){const t=this.readUint32(),e=this.readUint32(),i=this.readByte();this._png.resolution={x:t,y:e,unit:i}}decodeImage(){if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const t=this._inflator.result;if(this._filterMethod!==Cf.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod!==Tf.NO_INTERLACE)throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this.decodeInterlaceNull(t)}decodeInterlaceNull(t){const e=this._png.height,i=this._png.channels*this._png.depth/8,n=this._png.width*i,r=new Uint8Array(this._png.height*n);let s,o,a=Rf,l=0;for(let h=0;h<e;h++){switch(s=t.subarray(l+1,l+1+n),o=r.subarray(h*n,(h+1)*n),t[l]){case 0:Lf(s,o,n);break;case 1:Nf(s,o,n,i);break;case 2:Df(s,o,a,n);break;case 3:Of(s,o,a,n,i);break;case 4:Ff(s,o,a,n,i);break;default:throw new Error(`Unsupported filter: ${t[l]}`)}a=o,l+=n+1}if(this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency),16===this._png.depth){const t=new Uint16Array(r.buffer);if(kf)for(let e=0;e<t.length;e++)t[e]=(255&(h=t[e]))<<8|h>>8&255;this._png.data=t}else this._png.data=r;var h}}function Lf(t,e,i){for(let n=0;n<i;n++)e[n]=t[n]}function Nf(t,e,i,n){let r=0;for(;r<n;r++)e[r]=t[r];for(;r<i;r++)e[r]=t[r]+e[r-n]&255}function Df(t,e,i,n){let r=0;if(0===i.length)for(;r<n;r++)e[r]=t[r];else for(;r<n;r++)e[r]=t[r]+i[r]&255}function Of(t,e,i,n,r){let s=0;if(0===i.length){for(;s<r;s++)e[s]=t[s];for(;s<n;s++)e[s]=t[s]+(e[s-r]>>1)&255}else{for(;s<r;s++)e[s]=t[s]+(i[s]>>1)&255;for(;s<n;s++)e[s]=t[s]+(e[s-r]+i[s]>>1)&255}}function Ff(t,e,i,n,r){let s=0;if(0===i.length){for(;s<r;s++)e[s]=t[s];for(;s<n;s++)e[s]=t[s]+e[s-r]&255}else{for(;s<r;s++)e[s]=t[s]+i[s]&255;for(;s<n;s++)e[s]=t[s]+zf(e[s-r],i[s],i[s-r])&255}}function zf(t,e,i){const n=t+e-i,r=Math.abs(n-t),s=Math.abs(n-e),o=Math.abs(n-i);return r<=s&&r<=o?t:s<=o?e:i}const Bf={level:3};class Gf extends hu.IOBuffer{constructor(t,e={}){super(),this._colorType=If.UNKNOWN,this._zlibOptions={...Bf,...e.zlib},this._png=this._checkData(t),this.setBigEndian()}encode(){return this.encodeSignature(),this.encodeIHDR(),this.encodeData(),this.encodeIEND(),this.toArray()}encodeSignature(){this.writeBytes(bf)}encodeIHDR(){this.writeUint32(13),this.writeChars("IHDR"),this.writeUint32(this._png.width),this.writeUint32(this._png.height),this.writeByte(this._png.depth),this.writeByte(this._colorType),this.writeByte(Mf.DEFLATE),this.writeByte(Cf.ADAPTIVE),this.writeByte(Tf.NO_INTERLACE),this.writeCrc(17)}encodeIEND(){this.writeUint32(0),this.writeChars("IEND"),this.writeCrc(4)}encodeIDAT(t){this.writeUint32(t.length),this.writeChars("IDAT"),this.writeBytes(t),this.writeCrc(t.length+4)}encodeData(){const{width:t,height:e,channels:i,depth:n,data:r}=this._png,s=i*t,o=(new hu.IOBuffer).setBigEndian();let a=0;for(let t=0;t<e;t++)if(o.writeByte(0),8===n)a=Uf(r,o,s,a);else{if(16!==n)throw new Error("unreachable");a=Xf(r,o,s,a)}const l=o.toArray(),h=yf(l,this._zlibOptions);this.encodeIDAT(h)}_checkData(t){const{colorType:e,channels:i,depth:n}=function(t){const{channels:e=4,depth:i=8}=t;if(4!==e&&3!==e&&2!==e&&1!==e)throw new RangeError(`unsupported number of channels: ${e}`);if(8!==i&&16!==i)throw new RangeError(`unsupported bit depth: ${i}`);const n={channels:e,depth:i,colorType:If.UNKNOWN};switch(e){case 4:n.colorType=If.TRUECOLOUR_ALPHA;break;case 3:n.colorType=If.TRUECOLOUR;break;case 1:n.colorType=If.GREYSCALE;break;case 2:n.colorType=If.GREYSCALE_ALPHA;break;default:throw new Error("unsupported number of channels")}return n}(t),r={width:Yf(t.width,"width"),height:Yf(t.height,"height"),channels:i,data:t.data,depth:n,text:{}};this._colorType=e;const s=r.width*r.height*i;if(r.data.length!==s)throw new RangeError(`wrong data size. Found ${r.data.length}, expected ${s}`);return r}writeCrc(t){this.writeUint32(Sf(new Uint8Array(this.buffer,this.byteOffset+this.offset-t,t),t))}}function Yf(t,e){if(Number.isInteger(t)&&t>0)return t;throw new TypeError(`${e} must be a positive integer`)}function Uf(t,e,i,n){for(let r=0;r<i;r++)e.writeByte(t[n++]);return n}function Xf(t,e,i,n){for(let r=0;r<i;r++)e.writeUint16(t[n++]);return n}var qf;!function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.METRE=1]="METRE"}(qf||(qf={}));var Vf=__webpack_require__(7870);let jf="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Wf=new Uint8Array(256);for(let t=0;t<jf.length;t++)Wf[jf.charCodeAt(t)]=t;function Zf(t,e){return`data:${e};base64,${function(t){let e,i=t.length,n="";for(e=0;e<i;e+=3)n+=jf[t[e]>>2],n+=jf[(3&t[e])<<4|t[e+1]>>4],n+=jf[(15&t[e+1])<<2|t[e+2]>>6],n+=jf[63&t[e+2]];return i%3==2?n=`${n.substring(0,n.length-1)}=`:i%3==1&&(n=`${n.substring(0,n.length-2)}==`),n}(t)}`}const Hf=self.ImageData,Kf=self.Image;function $f(t,e){let i=self.document.createElement("canvas");return i.width=t,i.height=e,i}function Jf(t,e={}){const i={width:t.width,height:t.height,data:t.getRGBAData()};return(0,Vf.encode)(i,e.quality).data}function Qf(t,e){const i={width:t.width,height:t.height,channels:t.channels,depth:t.bitDepth,data:t.data};return 1!==i.depth&&32!==i.depth||(i.depth=8,i.channels=4,i.data=t.getRGBAData()),function(t,e){return new Gf(t,e).encode()}(i,e)}const tp={save(t,e={}){const{useCanvas:i=!1,encoder:n}=e;let{format:r}=e;if(!r){const e=/\.(?<format>[a-zA-Z]+)$/.exec(t);e&&(r=e.groups.format.toLowerCase())}if(!r)throw new Error("file format not provided");return new Promise(((t,e)=>{let s,o;switch(r.toLowerCase()){case"png":i?s=this.getCanvas().pngStream():o=Qf(this,n);break;case"jpg":case"jpeg":i?s=this.getCanvas().jpegStream():o=Jf(this,n);break;case"bmp":o=(0,lu.c)(this,n);break;default:throw new RangeError(`invalid output format: ${r}`)}if(s){let i=function(){throw new Error("createWriteStream does not exist in the browser")}();i.on("finish",t),i.on("error",e),s.pipe(i)}else o&&function(){throw new Error("writeFile does not exist in the browser")}()}))},toDataURL(t="image/png",e={}){"object"==typeof t&&(e=t,t="image/png");const{useCanvas:i=!1,encoder:n}=e;function r(e,i){return Zf(e(i,n),t)}return"image/bmp"===(t=function(t){return t.includes("/")||(t=`image/${t}`),t}(t))?r(lu.c,this):"image/png"!==t||i?"image/jpeg"!==t||i?this.getCanvas().toDataURL(t):r(Jf,this):r(Qf,this)},toBuffer(t={}){const{format:e="png",encoder:i}=t;switch(e.toLowerCase()){case"png":return Qf(this,i);case"jpeg":case"jpg":return Jf(this,i);case"bmp":return(0,lu.c)(this,i);default:throw new RangeError(`invalid output format: ${e}`)}},toBase64(t="image/png",e={}){if(e.async)return this.toDataURL(t,e).then((function(t){return t.substring(t.indexOf(",")+1)}));{const i=this.toDataURL(t,e);return i.substring(i.indexOf(",")+1)}},toBlob(t="image/png",e=.8){return ou(this.getCanvas(),t,e)},getCanvas(){const t=new Hf(this.getRGBAData({clamped:!0}),this.width,this.height);let e=$f(this.width,this.height);return e.getContext("2d").putImageData(t,0,0),e}};var ep=__webpack_require__(2251),ip=__webpack_require__.n(ep);let np={configurable:!0,enumerable:!1,get:void 0};const rp="GREY",sp="RGB",op="HSL",ap="HSV",lp="CMYK",hp="BINARY",cp="RGBA",up={};up[hp]={components:1,alpha:0,bitDepth:1,colorModel:rp},up.GREYA={components:1,alpha:1,bitDepth:8,colorModel:rp},up.GREY={components:1,alpha:0,bitDepth:8,colorModel:rp},up[cp]={components:3,alpha:1,bitDepth:8,colorModel:sp},up.RGB={components:3,alpha:0,bitDepth:8,colorModel:sp},up.CMYK={components:4,alpha:0,bitDepth:8,colorModel:lp},up.CMYKA={components:4,alpha:1,bitDepth:8,colorModel:lp};const dp=[1,8,16,32];var gp=__webpack_require__(9464),fp=__webpack_require__(9184),pp=__webpack_require__.n(fp);const mp={33434:"ExposureTime",33437:"FNumber",34850:"ExposureProgram",34852:"SpectralSensitivity",34855:"ISOSpeedRatings",34856:"OECF",34864:"SensitivityType",34865:"StandardOutputSensitivity",34866:"RecommendedExposureIndex",34867:"ISOSpeed",34868:"ISOSpeedLatitudeyyy",34869:"ISOSpeedLatitudezzz",36864:"ExifVersion",36867:"DateTimeOriginal",36868:"DateTimeDigitized",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureBiasValue",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37386:"FocalLength",37396:"SubjectArea",37500:"MakerNote",37510:"UserComment",37520:"SubsecTime",37521:"SubsecTimeOriginal",37522:"SubsecTimeDigitized",40960:"FlashpixVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",40964:"RelatedSoundFile",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41492:"SubjectLocation",41493:"ExposureIndex",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRatio",41989:"FocalLengthIn35mmFilm",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",42016:"ImageUniqueID",42032:"CameraOwnerName",42033:"BodySerialNumber",42034:"LensSpecification",42035:"LensMake",42036:"LensModel",42037:"LensSerialNumber",42240:"Gamma"},_p={};for(let t in mp)_p[mp[t]]=Number(t);const yp={0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential",31:"GPSHPositioningError"},wp={};for(let t in yp)wp[yp[t]]=Number(t);const xp={254:"NewSubfileType",255:"SubfileType",256:"ImageWidth",257:"ImageLength",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",263:"Threshholding",264:"CellWidth",265:"CellLength",266:"FillOrder",270:"ImageDescription",271:"Make",272:"Model",273:"StripOffsets",274:"Orientation",277:"SamplesPerPixel",278:"RowsPerStrip",279:"StripByteCounts",280:"MinSampleValue",281:"MaxSampleValue",282:"XResolution",283:"YResolution",284:"PlanarConfiguration",288:"FreeOffsets",289:"FreeByteCounts",290:"GrayResponseUnit",291:"GrayResponseCurve",296:"ResolutionUnit",305:"Software",306:"DateTime",315:"Artist",316:"HostComputer",320:"ColorMap",338:"ExtraSamples",33432:"Copyright",269:"DocumentName",285:"PageName",286:"XPosition",287:"YPosition",292:"T4Options",293:"T6Options",297:"PageNumber",301:"TransferFunction",317:"Predictor",318:"WhitePoint",319:"PrimaryChromaticities",321:"HalftoneHints",322:"TileWidth",323:"TileLength",324:"TileOffsets",325:"TileByteCounts",326:"BadFaxLines",327:"CleanFaxData",328:"ConsecutiveBadFaxLines",330:"SubIFDs",332:"InkSet",333:"InkNames",334:"NumberOfInks",336:"DotRange",337:"TargetPrinter",339:"SampleFormat",340:"SMinSampleValue",341:"SMaxSampleValue",342:"TransferRange",343:"ClipPath",344:"XClipPathUnits",345:"YClipPathUnits",346:"Indexed",347:"JPEGTables",351:"OPIProxy",400:"GlobalParametersIFD",401:"ProfileType",402:"FaxProfile",403:"CodingMethods",404:"VersionYear",405:"ModeNumber",433:"Decode",434:"DefaultImageColor",512:"JPEGProc",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",515:"JPEGRestartInterval",517:"JPEGLosslessPredictors",518:"JPEGPointTransforms",519:"JPEGQTables",520:"JPEGDCTables",521:"JPEGACTables",529:"YCbCrCoefficients",530:"YCbCrSubSampling",531:"YCbCrPositioning",532:"ReferenceBlackWhite",559:"StripRowCounts",700:"XMP",32781:"ImageID",34732:"ImageLayer",32932:"WangAnnotatio",33445:"MDFileTag",33446:"MDScalePixel",33447:"MDColorTable",33448:"MDLabName",33449:"MDSampleInfo",33450:"MDPrepDate",33451:"MDPrepTime",33452:"MDFileUnits",33550:"ModelPixelScaleTag",33723:"IPTC",33918:"INGRPacketDataTag",33919:"INGRFlagRegisters",33920:"IrasBTransformationMatrix",33922:"ModelTiepointTag",34264:"ModelTransformationTag",34377:"Photoshop",34665:"ExifIFD",34675:"ICCProfile",34735:"GeoKeyDirectoryTag",34736:"GeoDoubleParamsTag",34737:"GeoAsciiParamsTag",34853:"GPSIFD",34908:"HylaFAXFaxRecvParams",34909:"HylaFAXFaxSubAddress",34910:"HylaFAXFaxRecvTime",37724:"ImageSourceData",40965:"InteroperabilityIFD",42112:"GDAL_METADATA",42113:"GDAL_NODATA",50215:"OceScanjobDescription",50216:"OceApplicationSelector",50217:"OceIdentificationNumber",50218:"OceImageLogicCharacteristics",50706:"DNGVersion",50707:"DNGBackwardVersion",50708:"UniqueCameraModel",50709:"LocalizedCameraModel",50710:"CFAPlaneColor",50711:"CFALayout",50712:"LinearizationTable",50713:"BlackLevelRepeatDim",50714:"BlackLevel",50715:"BlackLevelDeltaH",50716:"BlackLevelDeltaV",50717:"WhiteLevel",50718:"DefaultScale",50719:"DefaultCropOrigin",50720:"DefaultCropSize",50721:"ColorMatrix1",50722:"ColorMatrix2",50723:"CameraCalibration1",50724:"CameraCalibration2",50725:"ReductionMatrix1",50726:"ReductionMatrix2",50727:"AnalogBalance",50728:"AsShotNeutral",50729:"AsShotWhiteXY",50730:"BaselineExposure",50731:"BaselineNoise",50732:"BaselineSharpness",50733:"BayerGreenSplit",50734:"LinearResponseLimit",50735:"CameraSerialNumber",50736:"LensInfo",50737:"ChromaBlurRadius",50738:"AntiAliasStrength",50740:"DNGPrivateData",50741:"MakerNoteSafety",50778:"CalibrationIlluminant1",50779:"CalibrationIlluminant2",50780:"BestQualityScale",50784:"AliasLayerMetadata"},bp={};for(let t in xp)bp[xp[t]]=Number(t);const vp={standard:n,exif:e,gps:i};class Ep{constructor(t){if(!t)throw new Error("missing kind");this.data=new Uint8Array,this.fields=new Map,this.kind=t,this._hasMap=!1,this._map={}}get(t){if("number"==typeof t)return this.fields.get(t);if("string"==typeof t)return this.fields.get(vp[this.kind].tagsByName[t]);throw new Error("expected a number or string")}get map(){if(!this._hasMap){const t=vp[this.kind].tagsById;for(let e of this.fields.keys())t[e]&&(this._map[t[e]]=this.fields.get(e));this._hasMap=!0}return this._map}}let Sp=new Map([[1,[1,Ip]],[2,[1,function(t,e){let i=[],n="";for(let r=0;r<e;r++){let e=String.fromCharCode(t.readUint8());"\0"===e?(i.push(n),n=""):n+=e}return 1===i.length?i[0]:i}]],[3,[2,function(t,e){if(1===e)return t.readUint16();let i=new Uint16Array(e);for(let n=0;n<e;n++)i[n]=t.readUint16();return i}]],[4,[4,function(t,e){if(1===e)return t.readUint32();let i=new Uint32Array(e);for(let n=0;n<e;n++)i[n]=t.readUint32();return i}]],[5,[8,function(t,e){if(1===e)return t.readUint32()/t.readUint32();let i=new Array(e);for(let n=0;n<e;n++)i[n]=t.readUint32()/t.readUint32();return i}]],[6,[1,function(t,e){if(1===e)return t.readInt8();let i=new Int8Array(e);for(let n=0;n<e;n++)i[n]=t.readInt8();return i}]],[7,[1,Ip]],[8,[2,function(t,e){if(1===e)return t.readInt16();let i=new Int16Array(e);for(let n=0;n<e;n++)i[n]=t.readInt16();return i}]],[9,[4,function(t,e){if(1===e)return t.readInt32();let i=new Int32Array(e);for(let n=0;n<e;n++)i[n]=t.readInt32();return i}]],[10,[8,function(t,e){if(1===e)return t.readInt32()/t.readInt32();let i=new Array(e);for(let n=0;n<e;n++)i[n]=t.readInt32()/t.readInt32();return i}]],[11,[4,function(t,e){if(1===e)return t.readFloat32();let i=new Float32Array(e);for(let n=0;n<e;n++)i[n]=t.readFloat32();return i}]],[12,[8,function(t,e){if(1===e)return t.readFloat64();let i=new Float64Array(e);for(let n=0;n<e;n++)i[n]=t.readFloat64();return i}]]]);function Ip(t,e){if(1===e)return t.readUint8();let i=new Uint8Array(e);for(let n=0;n<e;n++)i[n]=t.readUint8();return i}let Mp=[];const Cp=[511,1023,2047,4095],Tp=[0,0,0,0,0,0,0,0,0,511,1023,2047,4095];class Rp{constructor(t){this.nextData=0,this.nextBits=0,this.bytePointer=0,this.tableLength=258,this.currentBitLength=9,this.stripArray=new Uint8Array(t.buffer,t.byteOffset,t.byteLength),this.outData=new hu.IOBuffer(t.byteLength),this.initializeTable()}decode(){let t=0,e=0;for(;257!==(t=this.getNextCode());)if(256===t){if(this.initializeTable(),t=this.getNextCode(),257===t)break;this.writeString(this.stringFromCode(t)),e=t}else if(this.isInTable(t))this.writeString(this.stringFromCode(t)),this.addStringToTable(this.stringFromCode(e).concat(this.stringFromCode(t)[0])),e=t;else{const i=this.stringFromCode(e).concat(this.stringFromCode(e)[0]);this.writeString(i),this.addStringToTable(i),e=t}const i=this.outData.toArray();return new DataView(i.buffer,i.byteOffset,i.byteLength)}initializeTable(){!function(){if(0===Mp.length){for(let t=0;t<256;t++)Mp.push([t]);const t=[];for(let e=256;e<4096;e++)Mp.push(t)}}(),this.tableLength=258,this.currentBitLength=9}writeString(t){this.outData.writeBytes(t)}stringFromCode(t){return Mp[t]}isInTable(t){return t<this.tableLength}addStringToTable(t){if(Mp[this.tableLength++]=t,Mp.length>4096)throw Mp=[],new Error("LZW decoding error. Please open an issue at https://github.com/image-js/tiff/issues/new/choose (include a test image).");this.tableLength===Tp[this.currentBitLength]&&this.currentBitLength++}getNextCode(){this.nextData=this.nextData<<8|255&this.stripArray[this.bytePointer++],this.nextBits+=8,this.nextBits<this.currentBitLength&&(this.nextData=this.nextData<<8|255&this.stripArray[this.bytePointer++],this.nextBits+=8);const t=this.nextData>>this.nextBits-this.currentBitLength&Cp[this.currentBitLength-9];return this.nextBits-=this.currentBitLength,this.bytePointer>this.stripArray.length?257:t}}function Ap(t){return new Rp(t).decode()}const kp=/^(\d{4}):(\d{2}):(\d{2}) (\d{2}):(\d{2}):(\d{2})$/;class Pp extends Ep{constructor(){super("standard")}get size(){return this.width*this.height}get width(){return this.imageWidth}get height(){return this.imageLength}get components(){return this.samplesPerPixel}get date(){let t=new Date,e=kp.exec(this.dateTime);if(null===e)throw new Error(`invalid dateTime: ${this.dateTime}`);return t.setFullYear(Number(e[1]),Number(e[2])-1,Number(e[3])),t.setHours(Number(e[4]),Number(e[5]),Number(e[6])),t}get newSubfileType(){return this.get("NewSubfileType")}get imageWidth(){return this.get("ImageWidth")}get imageLength(){return this.get("ImageLength")}get bitsPerSample(){const t=this.get("BitsPerSample");return t&&"number"!=typeof t?t[0]:t}get alpha(){const t=this.extraSamples;return!!t&&0!==t[0]}get associatedAlpha(){const t=this.extraSamples;return!!t&&1===t[0]}get extraSamples(){return Lp(this.get("ExtraSamples"))}get compression(){return this.get("Compression")||1}get type(){return this.get("PhotometricInterpretation")}get fillOrder(){return this.get("FillOrder")||1}get documentName(){return this.get("DocumentName")}get imageDescription(){return this.get("ImageDescription")}get stripOffsets(){return Lp(this.get("StripOffsets"))}get orientation(){return this.get("Orientation")}get samplesPerPixel(){return this.get("SamplesPerPixel")||1}get rowsPerStrip(){return this.get("RowsPerStrip")}get stripByteCounts(){return Lp(this.get("StripByteCounts"))}get minSampleValue(){return this.get("MinSampleValue")||0}get maxSampleValue(){return this.get("MaxSampleValue")||Math.pow(2,this.bitsPerSample)-1}get xResolution(){return this.get("XResolution")}get yResolution(){return this.get("YResolution")}get planarConfiguration(){return this.get("PlanarConfiguration")||1}get resolutionUnit(){return this.get("ResolutionUnit")||2}get dateTime(){return this.get("DateTime")}get predictor(){return this.get("Predictor")||1}get sampleFormat(){return this.get("SampleFormat")||1}get sMinSampleValue(){return this.get("SMinSampleValue")||this.minSampleValue}get sMaxSampleValue(){return this.get("SMaxSampleValue")||this.maxSampleValue}get palette(){const t=2**this.bitsPerSample,e=this.get("ColorMap");if(!e)return;if(e.length!==3*t)throw new Error(`ColorMap size must be ${t}`);const i=[];for(let n=0;n<t;n++)i.push([e[n],e[n+t],e[n+2*t]]);return i}}function Lp(t){return"number"==typeof t?[t]:t}function Np(t){const e=new Uint8Array(t.buffer,t.byteOffset,t.byteLength),i=xf(e);return new DataView(i.buffer,i.byteOffset,i.byteLength)}const Dp={ignoreImageData:!1,onlyFirst:!1};class Op extends hu.IOBuffer{constructor(t){super(t),this._nextIFD=0}get isMultiPage(){let t=0;for(this.decodeHeader();this._nextIFD;)if(t++,this.decodeIFD({ignoreImageData:!0},!0),2===t)return!0;if(1===t)return!1;throw Fp("ifdCount",t)}get pageCount(){let t=0;for(this.decodeHeader();this._nextIFD;)t++,this.decodeIFD({ignoreImageData:!0},!0);if(t>0)return t;throw Fp("ifdCount",t)}decode(t={}){t=Object.assign({},Dp,t);const e=[];for(this.decodeHeader();this._nextIFD;)if(e.push(this.decodeIFD(t,!0)),t.onlyFirst)return[e[0]];return e}decodeHeader(){const t=this.readUint16();if(18761===t)this.setLittleEndian();else{if(19789!==t)throw new Error(`invalid byte order: 0x${t.toString(16)}`);this.setBigEndian()}if(42!==this.readUint16())throw new Error("not a TIFF file");this._nextIFD=this.readUint32()}decodeIFD(t,e){let i;if(this.seek(this._nextIFD),e)i=new Pp;else{if(!t.kind)throw new Error("kind is missing");i=new Ep(t.kind)}const n=this.readUint16();for(let t=0;t<n;t++)this.decodeIFDEntry(i);if(!t.ignoreImageData){if(!(i instanceof Pp))throw new Error("must be a tiff ifd");this.decodeImageData(i)}return this._nextIFD=this.readUint32(),i}decodeIFDEntry(t){const e=this.offset,i=this.readUint16(),n=this.readUint16(),r=this.readUint32();if(n<1||n>12)return void this.skip(4);const s=function(t,e){const i=Sp.get(t);if(!i)throw new Error(`type not found: ${t}`);return i[0]*e}(n,r);s>4&&this.seek(this.readUint32());const o=function(t,e,i){const n=Sp.get(e);if(!n)throw new Error(`type not found: ${e}`);return n[1](t,i)}(this,n,r);if(t.fields.set(i,o),34665===i||34853===i){let e=this.offset,n="exif";34665===i?n="exif":34853===i&&(n="gps"),this._nextIFD=o,t[n]=this.decodeIFD({kind:n,ignoreImageData:!0},!1),this.offset=e}this.seek(e),this.skip(12)}decodeImageData(t){const e=t.orientation;if(e&&1!==e)throw Fp("orientation",e);switch(t.type){case 0:case 1:case 2:case 3:this.readStripData(t);break;default:throw Fp("image type",t.type)}if(this.applyPredictor(t),this.convertAlpha(t),0===t.type){const e=t.bitsPerSample,i=Math.pow(2,e)-1;for(let e=0;e<t.data.length;e++)t.data[e]=i-t.data[e]}}readStripData(t){const e=t.width,i=t.height,n=t.bitsPerSample,r=t.sampleFormat,s=e*i*t.samplesPerPixel,o=function(t,e,i){if(8===e)return new Uint8Array(t);if(16===e)return new Uint16Array(t);if(32===e&&3===i)return new Float32Array(t);throw Fp("bit depth / sample format",`${e} / ${i}`)}(s,n,r),a=t.rowsPerStrip*e*t.samplesPerPixel,l=t.stripOffsets,h=t.stripByteCounts||function(t){if(1!==t.compression)throw new Error("missing mandatory StripByteCounts field in compressed image");const e=t.rowsPerStrip*t.width*t.samplesPerPixel*(t.bitsPerSample/8);return new Array(t.stripOffsets.length).fill(e)}(t);let c=s,u=0;for(let e=0;e<l.length;e++){let i=new DataView(this.buffer,this.byteOffset+l[e],h[e]),s=c>a?a:c;c-=s;let d=i;switch(t.compression){case 1:break;case 5:d=Ap(i);break;case 8:d=Np(i);break;case 2:throw Fp("Compression","CCITT Group 3");case 32773:throw Fp("Compression","PackBits");default:throw Fp("Compression",t.compression)}u=this.fillUncompressed(n,r,o,d,u,s)}t.data=o}fillUncompressed(t,e,i,n,r,s){if(8===t)return function(t,e,i,n){for(let r=0;r<n;r++)t[i++]=e.getUint8(r);return i}(i,n,r,s);if(16===t)return function(t,e,i,n,r){for(let s=0;s<2*n;s+=2)t[i++]=e.getUint16(s,r);return i}(i,n,r,s,this.isLittleEndian());if(32===t&&3===e)return function(t,e,i,n,r){for(let s=0;s<4*n;s+=4)t[i++]=e.getFloat32(s,r);return i}(i,n,r,s,this.isLittleEndian());throw Fp("bitDepth",t)}applyPredictor(t){const e=t.bitsPerSample;switch(t.predictor){case 1:break;case 2:if(8===e)!function(t,e,i){let n=0;for(;n<t.length;){for(let r=i;r<e*i;r+=i)for(let e=0;e<i;e++)t[n+r+e]=t[n+r+e]+t[n+r-(i-e)]&255;n+=e*i}}(t.data,t.width,t.components);else{if(16!==e)throw new Error(`Horizontal differencing is only supported for images with a bit depth of ${e}`);!function(t,e,i){let n=0;for(;n<t.length;){for(let r=i;r<e*i;r+=i)for(let e=0;e<i;e++)t[n+r+e]=t[n+r+e]+t[n+r-(i-e)]&65535;n+=e*i}}(t.data,t.width,t.components)}break;default:throw new Error(`invalid predictor: ${t.predictor}`)}}convertAlpha(t){if(t.alpha&&t.associatedAlpha){const{data:e,components:i,maxSampleValue:n}=t;for(let t=0;t<e.length;t+=i){const r=e[t+i-1];for(let s=0;s<i-1;s++)e[t+s]=Math.round(e[t+s]*n/r)}}}}function Fp(t,e){return new Error(`Unsupported ${t}: ${e}`)}function zp(t={}){let{algorithm:e="matchToPrevious",ignoreBorder:i=[0,0]}=t;this.checkProcessable("matchAndCrop",{bitDepth:[8,16]});let n="matchToPrevious"===e,r=this[0],s=[];s[0]={position:[0,0],image:this[0]};let o=[0,0];for(let t=1;t<this.length;t++){let e=r.getBestMatch(this[t],{border:i});s[t]={position:[e[0]+o[0],e[1]+o[1]],image:this[t]},n&&(o[0]+=e[0],o[1]+=e[1],r=this[t])}let a=0,l=0,h=0,c=0;for(let t=0;t<s.length;t++){let e=s[t];e.position[0]>a&&(a=e.position[0]),e.position[0]<l&&(l=e.position[0]),e.position[1]>h&&(h=e.position[1]),e.position[1]<c&&(c=e.position[1])}l=0-l,c=0-c;for(let t=0;t<s.length;t++){let e=s[t];e.crop=e.image.crop({x:a-e.position[0],y:h-e.position[1],width:r.width-l-a,height:r.height-c-h})}let u=[];for(let t=0;t<s.length;t++)u[t]=s[t].crop;return new Kp(u)}function Bp(){this.checkProcessable("min",{bitDepth:[8,16]});let t=this[0].min;for(let e=1;e<this.length;e++)for(let i=0;i<t.length;i++)t[i]=Math.min(t[i],this[e].min[i]);return t}function Gp(){this.checkProcessable("min",{bitDepth:[8,16]});let t=this[0].max;for(let e=1;e<this.length;e++)for(let i=0;i<t.length;i++)t[i]=Math.max(t[i],this[e].max[i]);return t}function Yp(t){let e=t.reduce(((t,e)=>t+e));if(0===e)throw new Error("unreachable");let i,n=0,r=0,s=e/2;for(;;){if(t[n]>0){if(void 0!==i)return(i+n)/2;if(r+=t[n],r>s)return n;r===s&&(i=n)}n++}}function Up(t){let e=0,i=0;for(let n=0;n<t.length;n++)e+=t[n],i+=t[n]*n;return 0===e?0:i/e}function Xp(){this.checkProcessable("median",{bitDepth:[8,16]});let t=this.getHistograms({maxSlots:this[0].maxValue+1}),e=new Array(t.length);for(let i=0;i<t.length;i++){let n=t[i];e[i]=Yp(n)}return e}function qp(t){this.checkProcessable("min",{bitDepth:[8,16]});let e=this[0].getHistogram(t);for(let i=1;i<this.length;i++){let n=this[i].getHistogram(t);for(let t=0;t<e.length;t++)e[t]+=n[t]}return e}function Vp(t){this.checkProcessable("min",{bitDepth:[8,16]});let e=this[0].getHistograms(t),i=e[0].length;for(let n=1;n<this.length;n++){let r=this[n].getHistograms(t);for(let t=0;t<e.length;t++)for(let n=0;n<i;n++)e[t][n]+=r[t][n]}return e}function jp(){this.checkProcessable("averageImage",{bitDepth:[8,16]});let t=new Uint32Array(this[0].data.length);for(let e=0;e<this.length;e++){let i=this[e];for(let e=0;e<this[0].data.length;e++)t[e]+=i.data[e]}let e=tx.createFrom(this[0]),i=e.data;for(let e=0;e<this[0].data.length;e++)i[e]=t[e]/this.length;return e}function Wp(){this.checkProcessable("max",{bitDepth:[8,16]});let t=tx.createFrom(this[0]);t.data.fill(0);for(const e of this)for(let i=0;i<t.data.length;i++)t.data[i]=Math.max(e.data[i],t.data[i]);return t}function Zp(){this.checkProcessable("max",{bitDepth:[8,16]});let t=tx.createFrom(this[0]);t.data.fill(t.maxValue);for(const e of this)for(let i=0;i<t.data.length;i++)t.data[i]=Math.min(e.data[i],t.data[i]);return t}let Hp={configurable:!0,enumerable:!1,get:void 0};class Kp extends Array{constructor(t){if(Array.isArray(t)){super(t.length);for(let e=0;e<t.length;e++)this[e]=t[e]}else"number"==typeof t?super(t):super();this.computed=null}static load(t){return Promise.all(t.map(tx.load)).then((t=>new Kp(t)))}static extendMethod(t,e,i={}){let{inPlace:n=!1,returnThis:r=!0,partialArgs:s=[]}=i;return Kp.prototype[t]=n?function(...t){this.computed=null;let i=e.apply(this,[...s,...t]);return r?this:i}:function(...t){return e.apply(this,[...s,...t])},Kp}static extendProperty(t,e,i={}){let{partialArgs:n=[]}=i;return Hp.get=function(){if(null===this.computed)this.computed={};else if(ip()(t,this.computed))return this.computed[t];let i=e.apply(this,n);return this.computed[t]=i,i},Object.defineProperty(Kp.prototype,t,Hp),Kp}checkProcessable(t,e={}){if("string"!=typeof t)throw new TypeError("checkProcessable requires as first parameter the processName (a string)");if(0===this.size)throw new TypeError(`The process: ${t} can not be applied on an empty stack`);this[0].checkProcessable(t,e);for(let i=1;i<this.length;i++){if((void 0===e.sameSize||e.sameSize)&&this[0].width!==this[i].width)throw new TypeError(`The process: ${t} can not be applied if width is not identical in all images`);if((void 0===e.sameSize||e.sameSize)&&this[0].height!==this[i].height)throw new TypeError(`The process: ${t} can not be applied if height is not identical in all images`);if((void 0===e.sameAlpha||e.sameAlpha)&&this[0].alpha!==this[i].alpha)throw new TypeError(`The process: ${t} can not be applied if alpha is not identical in all images`);if((void 0===e.sameBitDepth||e.sameBitDepth)&&this[0].bitDepth!==this[i].bitDepth)throw new TypeError(`The process: ${t} can not be applied if bitDepth is not identical in all images`);if((void 0===e.sameColorModel||e.sameColorModel)&&this[0].colorModel!==this[i].colorModel)throw new TypeError(`The process: ${t} can not be applied if colorModel is not identical in all images`);if((void 0===e.sameNumberChannels||e.sameNumberChannels)&&this[0].channels!==this[i].channels)throw new TypeError(`The process: ${t} can not be applied if channels is not identical in all images`)}}}Array[Symbol.species]||(Kp.prototype.map=function(t,e){if("function"!=typeof t)throw new TypeError(`${t} is not a function`);let i=new Kp(this.length);for(let n=0;n<this.length;n++)i[n]=t.call(e,this[n],n,this);return i}),function(t){t.extendMethod("matchAndCrop",zp),t.extendMethod("getMin",Bp),t.extendMethod("getMax",Gp),t.extendMethod("getMedian",Xp),t.extendMethod("getHistogram",qp),t.extendMethod("getHistograms",Vp),t.extendMethod("getAverage",jp),t.extendMethod("getAverageImage",jp),t.extendMethod("getMaxImage",Wp),t.extendMethod("getMinImage",Zp)}(Kp);const $p=/^data:[a-z]+\/(?:[a-z]+);base64,/;function Jp(t,e,i){const n=pp()(t);if(n)switch(n.mime){case"image/png":return function(t){const e=function(t,e){return new Pf(t,void 0).decode()}(t);let i,n=e.channels,r=0;return 2===n||4===n?(i=n-1,r=1):i=n,e.palette?function(t){const e=t.width*t.height,i=t.palette[0].length,n=new Uint8Array(e*i),r=8/t.depth,s=t.depth<8?r:1,o=parseInt("1".repeat(t.depth),2),a=4===i;let l=0;for(let i=0;i<e;i++){const e=Math.floor(i/s);let h=t.data[e];t.depth<8&&(h=h>>>t.depth*(r-1-i%r)&o);const c=t.palette[h];n[l++]=c[0],n[l++]=c[1],n[l++]=c[2],a&&(n[l++]=c[3])}return new tx(t.width,t.height,n,{components:3,alpha:a,bitDepth:8})}(e):new tx(e.width,e.height,e.data,{components:i,alpha:r,bitDepth:e.depth})}(t);case"image/jpeg":return function(t){const e=(0,gp.decode)(t);let i;e.exif&&(i=Qp(e.exif));const n=(0,Vf.decode)(t,{useTArray:!0,maxMemoryUsageInMB:1024});let r=new tx(n.width,n.height,n.data,{meta:i});if(i&&i.tiff.tags.Orientation){const t=i.tiff.tags.Orientation;t>2&&(r=r.rotate({3:180,4:180,5:90,6:90,7:270,8:270}[t])),[2,4,5,7].includes(t)&&(r=r.flipX())}return r}(t);case"image/tiff":return function(t,e){let i=function(t,e){return new Op(t).decode(void 0)}(t);return 1===i.length?tm(i[0],e):new Kp(i.map((function(t){return tm(t,e)})))}(t,i);default:return em(r(n.mime))}return em(r("application/octet-stream"));function r(i){return e||Zf(t,i)}}function Qp(t){const e={tiff:{fields:t.fields,tags:t.map}};return t.exif&&(e.exif=t.exif),t.gps&&(e.gps=t.gps),e}function tm(t,e){if(e||3!==t.type)return new tx(t.width,t.height,t.data,{components:2===t.type?3:1,alpha:t.alpha,colorModel:2===t.type?sp:rp,bitDepth:t.bitsPerSample.length?t.bitsPerSample[0]:t.bitsPerSample,meta:Qp(t)});{const e=new Uint16Array(3*t.width*t.height),i=t.palette;let n=0;for(let r=0;r<t.data.length;r++){const s=i[t.data[r]];e[n++]=s[0],e[n++]=s[1],e[n++]=s[2]}return new tx(t.width,t.height,e,{components:3,alpha:t.alpha,colorModel:sp,bitDepth:16,meta:Qp(t)})}}function em(t,e){return e=e||{},new Promise((function(i,n){let r=new Kf;r.onload=function(){let t=r.width,n=r.height,s=$f(t,n).getContext("2d");s.drawImage(r,0,0,t,n);let o=s.getImageData(0,0,t,n).data;i(new tx(t,n,o,e))},r.onerror=function(){n(new Error(`Could not load ${t}`))},r.src=t}))}const im={getValueXY(t,e,i){return this.data[(e*this.width+t)*this.channels+i]},setValueXY(t,e,i,n){return this.data[(e*this.width+t)*this.channels+i]=n,this.computed=null,this},getValue(t,e){return this.data[t*this.channels+e]},setValue(t,e,i){return this.data[t*this.channels+e]=i,this.computed=null,this},getPixelXY(t,e){return this.getPixel(e*this.width+t)},setPixelXY(t,e,i){return this.setPixel(e*this.width+t,i)},getPixel(t){const e=new Array(this.channels),i=t*this.channels;for(let t=0;t<this.channels;t++)e[t]=this.data[i+t];return e},setPixel(t,e){const i=t*this.channels;for(let t=0;t<e.length;t++)this.data[i+t]=e[t];return this.computed=null,this}};function nm(t){return{width:t.width,height:t.height,components:t.components,alpha:t.alpha,colorModel:t.colorModel,bitDepth:t.bitDepth}}function rm(t,e,i,n={}){const{out:r}=e;if(void 0===r)return n.copy?t.clone():tx.createFrom(t,i);{if(!tx.isImage(r))throw new TypeError("out must be an Image object");const e=Object.assign(nm(t),i);for(const t in e)if(r[t]!==e[t])throw new RangeError(`cannot use out. Its ${t} must be "${e[t]}" (found "${r[t]}")`);return r}}function sm(t,e,i){if(void 0!==e.inPlace&&"boolean"!=typeof e.inPlace)throw new TypeError("inPlace option must be a boolean");if(e.inPlace){if(void 0!==e.out)throw new TypeError("out option must not be set if inPlace option is true");return t}return rm(t,e,null,i)}function om(t={}){this.checkProcessable("abs",{bitDepth:[32]});const e=sm(this,t);return function(t,e){for(let i=0;i<t.data.length;i++)e.data[i]=Math.abs(t.data[i])}(this,e),e}function am(t={}){this.checkProcessable("invert",{bitDepth:[1,8,16]});const e=sm(this,t);return 1===this.bitDepth?function(t,e){for(let i=0;i<t.data.length;i++)e.data[i]=~t.data[i]}(this,e):(function(t,e){for(let i=0;i<t.data.length;i+=t.channels)for(let n=0;n<t.components;n++)e.data[i+n]=t.maxValue-t.data[i+n]}(this,e),this!==e&&function(t,e){if(1===t.alpha&&1===e.alpha)for(let i=0;i<t.size;i++)e.data[i*e.channels+e.components]=t.data[i*t.channels+t.components]}(this,e)),e}function lm(){this.checkProcessable("flipX",{bitDepth:[8,16]});for(let t=0;t<this.height;t++){let e=t*this.width*this.channels;for(let t=0;t<Math.floor(this.width/2);t++){let i=t*this.channels+e,n=(this.width-t-1)*this.channels+e;for(let t=0;t<this.channels;t++){let e=this.data[i+t];this.data[i+t]=this.data[n+t],this.data[n+t]=e}}}return this}function hm(){this.checkProcessable("flipY",{bitDepth:[8,16]});for(let t=0;t<Math.floor(this.height/2);t++)for(let e=0;e<this.width;e++){let i=e*this.channels+t*this.width*this.channels,n=e*this.channels+(this.height-1-t)*this.channels*this.width;for(let t=0;t<this.channels;t++){let e=this.data[i+t];this.data[i+t]=this.data[n+t],this.data[n+t]=e}}return this}function cm(t={}){const{radius:e=1}=t;if(e<1)throw new Error("radius must be greater than 1");const i=2*e+1,n=new Array(i);for(let t=0;t<i;t++){n[t]=new Array(i);for(let e=0;e<i;e++)n[t][e]=1/(i*i)}return this.convolution(n)}var um=__webpack_require__(5520),dm=__webpack_require__.n(um);function gm(t,e={}){let{channels:i,allowAlpha:n,defaultAlpha:r}=e;return"boolean"!=typeof n&&(n=!0),void 0===i?function(t,e){let i=e?t.channels:t.components,n=new Array(i);for(let t=0;t<i;t++)n[t]=t;return n}(t,r):function(t,e,i){Array.isArray(e)||(e=[e]);for(let n=0;n<e.length;n++)e[n]=fm(t,e[n],i);return e}(t,i,n)}function fm(t,e,i=!0){if(void 0===e)throw new RangeError(`validateChannel : the channel has to be >=0 and <${t.channels}`);if("string"==typeof e){switch(t.colorModel){case rp:break;case sp:if("rgb".includes(e))switch(e){case"r":e=0;break;case"g":e=1;break;case"b":e=2}break;case op:if("hsl".includes(e))switch(e){case"h":e=0;break;case"s":e=1;break;case"l":e=2}break;case ap:if("hsv".includes(e))switch(e){case"h":e=0;break;case"s":e=1;break;case"v":e=2}break;case lp:if("cmyk".includes(e))switch(e){case"c":e=0;break;case"m":e=1;break;case"y":e=2;break;case"k":e=3}break;default:throw new Error(`Unexpected color model: ${t.colorModel}`)}if("a"===e){if(!t.alpha)throw new Error("validateChannel : the image does not contain alpha channel");e=t.components}if("string"==typeof e)throw new Error(`validateChannel : undefined channel: ${e}`)}if(e>=t.channels)throw new RangeError(`validateChannel : the channel has to be >=0 and <${t.channels}`);if(!i&&e>=t.components)throw new RangeError("validateChannel : alpha channel may not be selected");return e}function pm(t={}){let{radius:e=1,border:i="copy",channels:n}=t;if(this.checkProcessable("medianFilter",{bitDepth:[8,16]}),e<1)throw new Error("radius must be greater than 0");n=gm(this,n);let r=e,s=e,o=tx.createFrom(this),a=new Array((2*r+1)*(2*s+1));for(let t=0;t<n.length;t++){let e=n[t];for(let t=s;t<this.height-s;t++)for(let i=r;i<this.width-r;i++){let n=0;for(let o=-s;o<=s;o++)for(let s=-r;s<=r;s++){let r=((t+o)*this.width+i+s)*this.channels+e;a[n++]=this.data[r]}let l=(t*this.width+i)*this.channels+e;o.data[l]=dm()(a)}}if(this.alpha&&!n.includes(this.channels))for(let t=this.components;t<this.data.length;t+=this.channels)o.data[t]=this.data[t];return o.setBorder({size:[r,s],algorithm:i}),o}function mm(t={}){let{radius:e=1,sigma:i,channels:n,border:r="copy"}=t;this.checkProcessable("gaussian",{bitDepth:[8,16]});const s=function(t,e){const i=2*t+1,n=new Array(i),r=e||.3*(.5*(i-1)-1)+.8,s=-.5/(r*r);let o=0;for(let e=0;e<i;e++){const i=e-t,r=Math.exp(s*i*i);n[e]=r,o+=r}for(let t=0;t<i;t++)n[t]/=o;return n}(e,i);return this.convolution([s,s],{border:r,channels:n,algorithm:"separable"})}const _m=[[-1,0,1],[-2,0,2],[-1,0,1]],ym=[[-1,-2,-1],[0,0,0],[1,2,1]],wm=[[3,0,-3],[10,0,-10],[3,0,-3]],xm=[[3,10,3],[0,0,0],[-3,-10,-3]];var bm=__webpack_require__(414),vm=__webpack_require__(8336),Em=__webpack_require__.n(vm);function Sm(t,e){return Math.round(Math.min(Math.max(t,0),e.maxValue))}function Im(t,e,i){if(void 0===i){const n=t.length+e.length-1;i=new Array(n)}!function(t){for(var e=0;e<t.length;e++)t[e]=0}(i);for(var n=0;n<t.length;n++)for(var r=0;r<e.length;r++)i[n+r]+=t[n]*e[r];return i}function Mm(t,e,i,n){const r=new Array(t.length);let s,o,a,l;l=e[1],a=(l.length-1)/2,o=new Array(i+l.length-1),s=new Array(i);for(let e=0;e<n;e++){for(let n=0;n<i;n++)s[n]=t[e*i+n];Im(s,l,o);for(let t=0;t<i;t++)r[e*i+t]=o[a+t]}l=e[0],a=(l.length-1)/2,o=new Array(n+l.length-1),s=new Array(n);for(let t=0;t<i;t++){for(let e=0;e<n;e++)s[e]=r[e*i+t];Im(s,l,o);for(let e=0;e<n;e++)r[e*i+t]=o[a+e]}return r}__webpack_require__(9645),__webpack_require__(995);var Cm=__webpack_require__(8406);Cm.AbstractMatrix,Cm.CHO,Cm.CholeskyDecomposition,Cm.DistanceMatrix,Cm.EVD,Cm.EigenvalueDecomposition,Cm.LU,Cm.LuDecomposition;const Tm=Cm.Matrix,Rm=(Cm.MatrixColumnSelectionView,Cm.MatrixColumnView,Cm.MatrixFlipColumnView,Cm.MatrixFlipRowView,Cm.MatrixRowSelectionView,Cm.MatrixRowView,Cm.MatrixSelectionView,Cm.MatrixSubView,Cm.MatrixTransposeView,Cm.NIPALS,Cm.Nipals,Cm.QR,Cm.QrDecomposition,Cm.SVD),Am=Cm.SingularValueDecomposition,km=(Cm.SymmetricMatrix,Cm.WrapperMatrix1D,Cm.WrapperMatrix2D,Cm.correlation,Cm.covariance,Cm.Matrix,Cm.Matrix,Cm.determinant,Cm.inverse),Pm=(Cm.linearDependencies,Cm.pseudoInverse,Cm.solve);function Lm(t,e={}){let{channels:i,bitDepth:n,normalize:r=!1,divisor:s=1,border:o="copy",algorithm:a="auto"}=e,l={};n&&(l.bitDepth=n);let h,c,u=tx.createFrom(this,l);if(i=gm(this,i),"separable"!==a)({kernel:t}=function(t){let e,i;if(!Array.isArray(t))throw new Error(`validateKernel: Invalid Kernel: ${t}`);if(Array.isArray(t[0])){if(0==(1&t.length)||0==(1&t[0].length))throw new RangeError("validateKernel: Kernel rows and columns should be odd numbers");e=Math.floor(t.length/2),i=Math.floor(t[0].length/2)}else{let n=Math.sqrt(t.length);if(!Em()(n))throw new RangeError("validateKernel: Kernel array should be a square");i=e=Math.floor(Math.sqrt(t.length)/2);let r=new Array(n);for(let e=0;e<n;e++){r[e]=new Array(n);for(let i=0;i<n;i++)r[e][i]=t[e*n+i]}t=r}return{kernel:t,kWidth:i,kHeight:e}}(t));else if(!Array.isArray(t)||2!==t.length)throw new RangeError("separable convolution requires two arrays of numbers to represent the kernel");if("auto"===a){let e=function(t){const e=new Rm(t,{autoTranspose:!0});if(1!==e.rank)return null;const i=Math.sqrt(e.s[0]);return[e.U.to2DArray().map((t=>t[0]*i)),e.V.to2DArray().map((t=>t[0]*i))]}(t);null!==e?(a="separable",t=e):a=(t.length>9||t[0].length>9)&&this.width<=4096&&this.height<=4096?"fft":"direct"}"separable"===a?(h=Math.floor(t[0].length/2),c=Math.floor(t[1].length/2)):(h=Math.floor(t.length/2),c=Math.floor(t[0].length/2));let d,g,f,p,m,_,y=u.isClamped,w=new Array(this.height*this.width);for(p=0;p<i.length;p++){for(m=i[p],f=0;f<this.height;f++)for(g=0;g<this.width;g++)d=f*this.width+g,w[d]=this.data[d*this.channels+m];if("direct"===a)_=(0,bm.direct)(w,t,{rows:this.height,cols:this.width,normalize:r,divisor:s});else if("separable"===a){if(_=Mm(w,t,this.width,this.height),r){s=0;for(let e=0;e<t[0].length;e++)for(let i=0;i<t[1].length;i++)s+=t[0][e]*t[1][i]}if(1!==s)for(let t=0;t<_.length;t++)_[t]/=s}else _=(0,bm.fft)(w,t,{rows:this.height,cols:this.width,normalize:r,divisor:s});for(f=0;f<this.height;f++)for(g=0;g<this.width;g++)d=f*this.width+g,u.data[d*this.channels+m]=y?Sm(_[d],u):_[d]}if(this.alpha&&!i.includes(this.channels))for(g=this.components;g<this.data.length;g+=this.channels)u.data[g]=this.data[g];return"periodic"!==o&&u.setBorder({size:[c,h],algorithm:o}),u}function Nm(t={}){let{direction:e="xy",border:i="copy",kernelX:n,kernelY:r,channels:s,bitDepth:o=this.bitDepth}=t;switch(this.checkProcessable("gradientFilter",{bitDepth:[8,16]}),e){case"x":if(!n)throw new Error("kernelX option is missing");return Lm.call(this,n,{channels:s,border:i,bitDepth:o});case"y":if(!r)throw new Error("kernelY option is missing");return Lm.call(this,r,{channels:s,border:i,bitDepth:o});case"xy":{if(!n)throw new Error("kernelX option is missing");if(!r)throw new Error("kernelY option is missing");const t=Lm.call(this,n,{channels:s,border:i,bitDepth:32}),e=Lm.call(this,r,{channels:s,border:i,bitDepth:32});return t.hypotenuse(e,{bitDepth:o,channels:s})}default:throw new Error(`Unknown parameter direction: ${e}`)}}function Dm(t){return Nm.call(this,Object.assign({},t,{kernelX:_m,kernelY:ym}))}function Om(t){return Nm.call(this,Object.assign({},t,{kernelX:wm,kernelY:xm}))}Cm.wrap;var Fm=__webpack_require__(2664),zm=__webpack_require__.n(Fm);function Bm(t={}){let{algorithm:e="range",channels:i,min:n=this.min,max:r=this.max}=t;if(this.checkProcessable("level",{bitDepth:[8,16,32]}),i=gm(this,{channels:i}),i.length!==this.channel&&(Array.isArray(n)&&n.length===this.channels&&(n=n.filter(((t,e)=>i.includes(e)))),Array.isArray(r)&&r.length===this.channels&&(r=r.filter(((t,e)=>i.includes(e))))),"range"!==e)throw new Error(`level: algorithm not implement: ${e}`);return n<0&&(n=0),r>this.maxValue&&(r=this.maxValue),Array.isArray(n)||(n=zm()(i.length,n)),Array.isArray(r)||(r=zm()(i.length,r)),function(t,e,i,n){let r=1e-5,s=new Array(n.length);for(let o=0;o<n.length;o++)0===e[o]&&i[o]===t.maxValue||i[o]===e[o]?s[o]=0:s[o]=(t.maxValue+1-r)/(i[o]-e[o]),e[o]+=.499995/s[o];for(let i=0;i<n.length;i++){let r=n[i];if(0!==s[i])for(let n=0;n<t.data.length;n+=t.channels)t.data[n+r]=Math.min(Math.max(0,(t.data[n+r]-e[i])*s[i]+.5|0),t.maxValue)}}(this,n,r,i),this}var Gm=__webpack_require__(7811),Ym=__webpack_require__.n(Gm);function Um(t){if(isNaN(t)){if(t instanceof tx)return t.data;if(!Ym()(t))throw new Error("checkNumberArray: the value should be either a number, array or Image");return t}if(t<=0)throw new Error("checkNumberArray: the value must be greater than 0");return t}function Xm(t,e={}){let{channels:i}=e;if(this.checkProcessable("add",{bitDepth:[8,16]}),i=gm(this,{channels:i}),t=Um(t),isNaN(t)){if(this.data.length!==t.length)throw new Error("add: the data size is different");for(let e=0;e<i.length;e++){let n=i[e];for(let e=0;e<this.data.length;e+=this.channels)this.data[e+n]=Math.max(0,Math.min(this.maxValue,this.data[e+n]+t[e+n]>>0))}}else for(let e=0;e<i.length;e++){let n=i[e];for(let e=0;e<this.data.length;e+=this.channels)this.data[e+n]=Math.min(this.maxValue,this.data[e+n]+t>>0)}return this}function qm(t,e={}){let{channels:i}=e;if(this.checkProcessable("subtract",{bitDepth:[8,16]}),i=gm(this,{channels:i}),t=Um(t),isNaN(t)){if(this.data.length!==t.length)throw new Error("subtract: the data size is different");for(let e=0;e<i.length;e++){let n=i[e];for(let e=0;e<this.data.length;e+=this.channels)this.data[e+n]=Math.max(0,Math.min(this.maxValue,this.data[e+n]-t[e+n]>>0))}}else for(let e=0;e<i.length;e++){let n=i[e];for(let e=0;e<this.data.length;e+=this.channels)this.data[e+n]=Math.max(0,this.data[e+n]-t>>0)}return this}function Vm(t,e={}){let{channels:i,absolute:n=!1}=e;if(this.checkProcessable("subtractImage",{bitDepth:[8,16]}),this.width!==t.width||this.height!==t.height)throw new Error("subtractImage: both images must have the same size");if(this.alpha!==t.alpha||this.bitDepth!==t.bitDepth)throw new Error("subtractImage: both images must have the same alpha and bitDepth");if(this.channels!==t.channels)throw new Error("subtractImage: both images must have the same number of channels");let r=this.clone();i=gm(this,{channels:i});for(let e=0;e<i.length;e++)for(let s=i[e];s<this.data.length;s+=this.channels){let e=this.data[s]-t.data[s];r.data[s]=n?Math.abs(e):Math.max(e,0)}return r}function jm(t,e={}){let{bitDepth:i=this.bitDepth,channels:n}=e;if(this.checkProcessable("hypotenuse",{bitDepth:[8,16,32]}),this.width!==t.width||this.height!==t.height)throw new Error("hypotenuse: both images must have the same size");if(this.alpha!==t.alpha||this.bitDepth!==t.bitDepth)throw new Error("hypotenuse: both images must have the same alpha and bitDepth");if(this.channels!==t.channels)throw new Error("hypotenuse: both images must have the same number of channels");let r=tx.createFrom(this,{bitDepth:i});n=gm(this,{channels:n});let s=r.isClamped;for(let e=0;e<n.length;e++)for(let i=n[e];i<this.data.length;i+=this.channels){let e=Math.hypot(this.data[i],t.data[i]);r.data[i]=s?Math.min(Math.max(Math.round(e),0),r.maxValue):e}return r}function Wm(t,e={}){let{channels:i}=e;if(this.checkProcessable("multiply",{bitDepth:[8,16]}),t<=0)throw new Error("multiply: the value must be greater than 0");if(i=gm(this,{channels:i}),t=Um(t),isNaN(t)){if(this.data.length!==t.length)throw new Error("multiply: the data size is different");for(let e=0;e<i.length;e++){let n=i[e];for(let e=0;e<this.data.length;e+=this.channels)this.data[e+n]=Math.max(0,Math.min(this.maxValue,this.data[e+n]*t[e+n]>>0))}}else for(let e=0;e<i.length;e++){let n=i[e];for(let e=0;e<this.data.length;e+=this.channels)this.data[e+n]=Math.min(this.maxValue,this.data[e+n]*t>>0)}return this}function Zm(t,e={}){let{channels:i}=e;if(this.checkProcessable("divide",{bitDepth:[8,16]}),i=gm(this,{channels:i}),t=Um(t),isNaN(t)){if(this.data.length!==t.length)throw new Error("divide: the: the data size is different");for(let e=0;e<i.length;e++){let n=i[e];for(let e=0;e<this.data.length;e+=this.channels)this.data[e+n]=Math.max(0,Math.min(this.maxValue,this.data[e+n]/t[e+n]>>0))}}else for(let e=0;e<i.length;e++){let n=i[e];for(let e=0;e<this.data.length;e+=this.channels)this.data[e+n]=Math.min(this.maxValue,this.data[e+n]/t>>0)}return this}var Hm=__webpack_require__(4091);class Km{constructor(){if(new.target===Km)throw new Error("BaseRegression must be subclassed")}predict(t){if("number"==typeof t)return this._predict(t);if((0,Hm.isAnyArray)(t)){const e=[];for(let i=0;i<t.length;i++)e.push(this._predict(t[i]));return e}throw new TypeError("x must be a number or array")}_predict(){throw new Error("_predict must be implemented")}train(){}toString(){return""}toLaTeX(){return""}score(t,e){if(!(0,Hm.isAnyArray)(t)||!(0,Hm.isAnyArray)(e)||t.length!==e.length)throw new Error("x and y must be arrays of the same length");const i=t.length,n=new Array(i);for(let e=0;e<i;e++)n[e]=this._predict(t[e]);let r=0,s=0,o=0,a=0,l=0,h=0,c=0;for(let t=0;t<i;t++)r+=n[t],s+=e[t],l+=n[t]*n[t],h+=e[t]*e[t],c+=n[t]*e[t],0!==e[t]&&(o+=(e[t]-n[t])*(e[t]-n[t])/e[t]),a+=(e[t]-n[t])*(e[t]-n[t]);const u=(i*c-r*s)/Math.sqrt((i*l-r*r)*(i*h-s*s));return{r:u,r2:u*u,chi2:o,rmsd:Math.sqrt(a/i)}}}var $m=__webpack_require__(6952),Jm=__webpack_require__.n($m);const Qm={lambda:.1,kernelType:"gaussian",kernelOptions:{},computeCoefficient:!1};class t_ extends Km{constructor(t,e,i){if(super(),!0===t)this.alpha=e.alpha,this.inputs=e.inputs,this.kernelType=e.kernelType,this.kernelOptions=e.kernelOptions,this.kernel=new(Jm())(e.kernelType,e.kernelOptions);else{t=Tm.checkMatrix(t),i=Object.assign({},Qm,i);const n=new(Jm())(i.kernelType,i.kernelOptions),r=n.compute(t),s=t.rows;r.add(Tm.eye(s,s).mul(i.lambda)),this.alpha=Pm(r,e),this.inputs=t,this.kernelType=i.kernelType,this.kernelOptions=i.kernelOptions,this.kernel=n}}_predict(t){return this.kernel.compute([t],this.inputs).mmul(this.alpha).getRow(0)}toJSON(){return{name:"kernelRidgeRegression",alpha:this.alpha,inputs:this.inputs,kernelType:this.kernelType,kernelOptions:this.kernelOptions}}static load(t){if("kernelRidgeRegression"!==t.name)throw new TypeError("not a KRR model");return new t_(!0,t)}}function e_(t,e,i){const n=new t_(t,e,i),r=new Array(this.size);for(let t=0;t<this.width;t++)for(let e=0;e<this.height;e++)r[e*this.width+t]=[t,e];const s=n.predict(r),o=tx.createFrom(this);for(let t=0;t<this.size;t++)o.data[t]=Math.min(this.maxValue,Math.max(0,s[t][0]));return o}function i_(t={}){let{kernel:e=[[1,1,1],[1,1,1],[1,1,1]],iterations:i=1}=t;if(this.checkProcessable("dilate",{bitDepth:[1,8,16],components:1,alpha:0}),e.columns%2==0||e.rows%2==0)throw new TypeError("dilate: The number of rows and columns of the kernel must be odd");let n=!0;t:for(const t of e)for(const e of t)if(1!==e){n=!1;break t}let r=this;for(let t=0;t<i;t++)if(1===this.bitDepth)if(n){const t=r.clone();r=o_(r,t,e.length,e[0].length)}else r=s_(r,tx.createFrom(r),e);else r=n?r_(r,tx.createFrom(r),e.length,e[0].length):n_(r,tx.createFrom(r),e);return r}function n_(t,e,i){const n=i.length,r=i[0].length;let s=(n-1)/2,o=(r-1)/2;for(let a=0;a<t.height;a++)for(let l=0;l<t.width;l++){let h=0;for(let e=0;e<r;e++)for(let r=0;r<n;r++){if(1!==i[r][e])continue;let n=r-s+l,c=e-o+a;if(n<0||c<0||n>=t.width||c>=t.height)continue;const u=t.getValueXY(n,c,0);u>h&&(h=u)}e.setValueXY(l,a,0,h)}return e}function r_(t,e,i,n){const r=(i-1)/2,s=(n-1)/2,o=[];for(let e=0;e<t.width;e++)o.push(0);for(let i=0;i<t.height;i++){for(let e=0;e<t.width;e++){let n=0;for(let r=Math.max(0,i-s);r<Math.min(t.height,i+s+1);r++){const i=t.getValueXY(e,r,0);i>n&&(n=i)}o[e]=n}for(let n=0;n<t.width;n++){let s=0;for(let e=Math.max(0,n-r);e<Math.min(t.width,n+r+1);e++)o[e]>s&&(s=o[e]);e.setValueXY(n,i,0,s)}}return e}function s_(t,e,i){const n=i.length,r=i[0].length;let s=(n-1)/2,o=(r-1)/2;for(let a=0;a<t.height;a++)for(let l=0;l<t.width;l++){let h=0;t:for(let e=0;e<r;e++)for(let r=0;r<n;r++){if(1!==i[r][e])continue;let n=r-s+l,c=e-o+a;if(!(c<0||n<0||n>=t.width||c>=t.height)&&1===t.getBitXY(n,c)){h=1;break t}}1===h&&e.setBitXY(l,a)}return e}function o_(t,e,i,n){const r=(i-1)/2,s=(n-1)/2,o=[];for(let e=0;e<t.width;e++)o.push(1);for(let i=0;i<t.height;i++){for(let e=0;e<t.width;e++){o[e]=0;for(let n=Math.max(0,i-s);n<Math.min(t.height,i+s+1);n++)if(1===t.getBitXY(e,n)){o[e]=1;break}}for(let n=0;n<t.width;n++)if(1!==e.getBitXY(n,i))for(let s=Math.max(0,n-r);s<Math.min(t.width,n+r+1);s++)if(1===o[s]){e.setBitXY(n,i);break}}return e}function a_(t={}){let{kernel:e=[[1,1,1],[1,1,1],[1,1,1]],iterations:i=1}=t;if(this.checkProcessable("erode",{bitDepth:[1,8,16],components:1,alpha:0}),e.columns%2==0||e.rows%2==0)throw new TypeError("erode: The number of rows and columns of the kernel must be odd");let n=!0;t:for(const t of e)for(const e of t)if(1!==e){n=!1;break t}let r=this;for(let t=0;t<i;t++)if(1===this.bitDepth)if(n){const t=r.clone();r=u_(r,t,e.length,e[0].length)}else r=c_(r,tx.createFrom(r),e);else r=n?h_(r,tx.createFrom(r),e.length,e[0].length):l_(r,tx.createFrom(r),e);return r}function l_(t,e,i){const n=i.length,r=i[0].length;let s=(n-1)/2,o=(r-1)/2;for(let a=0;a<t.height;a++)for(let l=0;l<t.width;l++){let h=t.maxValue;for(let e=0;e<r;e++)for(let r=0;r<n;r++){if(1!==i[r][e])continue;let n=r-s+l,c=e-o+a;if(n<0||c<0||n>=t.width||c>=t.height)continue;const u=t.getValueXY(n,c,0);u<h&&(h=u)}e.setValueXY(l,a,0,h)}return e}function h_(t,e,i,n){const r=(i-1)/2,s=(n-1)/2,o=[];for(let e=0;e<t.width;e++)o.push(0);for(let i=0;i<t.height;i++){for(let e=0;e<t.width;e++){let n=t.maxValue;for(let r=Math.max(0,i-s);r<Math.min(t.height,i+s+1);r++){const i=t.getValueXY(e,r,0);i<n&&(n=i)}o[e]=n}for(let n=0;n<t.width;n++){let s=t.maxValue;for(let e=Math.max(0,n-r);e<Math.min(t.width,n+r+1);e++)o[e]<s&&(s=o[e]);e.setValueXY(n,i,0,s)}}return e}function c_(t,e,i){const n=i.length,r=i[0].length;let s=(n-1)/2,o=(r-1)/2;for(let a=0;a<t.height;a++)for(let l=0;l<t.width;l++){let h=1;t:for(let e=0;e<r;e++)for(let r=0;r<n;r++){if(1!==i[r][e])continue;let n=r-s+l,c=e-o+a;if(!(c<0||n<0||n>=t.width||c>=t.height)&&0===t.getBitXY(n,c)){h=0;break t}}1===h&&e.setBitXY(l,a)}return e}function u_(t,e,i,n){const r=(i-1)/2,s=(n-1)/2,o=[];for(let e=0;e<t.width;e++)o.push(0);for(let i=0;i<t.height;i++){for(let e=0;e<t.width;e++){o[e]=1;for(let n=Math.max(0,i-s);n<Math.min(t.height,i+s+1);n++)if(0===t.getBitXY(e,n)){o[e]=0;break}}for(let n=0;n<t.width;n++)if(0!==e.getBitXY(n,i))for(let s=Math.max(0,n-r);s<Math.min(t.width,n+r+1);s++)if(0===o[s]){e.clearBitXY(n,i);break}}return e}function d_(t={}){let{kernel:e=[[1,1,1],[1,1,1],[1,1,1]],iterations:i=1}=t;if(this.checkProcessable("open",{bitDepth:[8,16],components:1,alpha:0}),e.columns%2==0||e.rows%2==0)throw new TypeError("open: The number of rows and columns of the kernel must be odd");let n=this;for(let t=0;t<i;t++)n=n.erode({kernel:e}),n=n.dilate({kernel:e});return n}function g_(t={}){let{kernel:e=[[1,1,1],[1,1,1],[1,1,1]],iterations:i=1}=t;if(this.checkProcessable("close",{bitDepth:[1,8,16],components:1,alpha:0}),e.columns%2==0||e.rows%2==0)throw new TypeError("close: The number of rows and columns of the kernel must be odd");let n=this;for(let t=0;t<i;t++)n=n.dilate({kernel:e}).erode({kernel:e});return n}function f_(t={}){let{kernel:e=[[1,1,1],[1,1,1],[1,1,1]],iterations:i=1}=t;if(this.checkProcessable("topHat",{bitDepth:[8,16],components:1,alpha:0}),e.length%2==0||e[0].length%2==0)throw new TypeError("topHat: The number of rows and columns of the kernel must be odd");let n=this;for(let t=0;t<i;t++){let t=n.open({kernel:e});n=t.subtractImage(n,{absolute:!0})}return n}function p_(t={}){let{kernel:e=[[1,1,1],[1,1,1],[1,1,1]],iterations:i=1}=t;if(this.checkProcessable("blackHat",{bitDepth:[8,16],components:1,alpha:0}),e.columns%2==0||e.rows%2==0)throw new TypeError("blackHat: The number of rows and columns of the kernel must be odd");let n=this;for(let t=0;t<i;t++){const t=n.close({kernel:e});n=t.subtractImage(n,{absolute:!0})}return n}function m_(t={}){let{kernel:e=[[1,1,1],[1,1,1],[1,1,1]],iterations:i=1}=t;if(this.checkProcessable("morphologicalGradient",{bitDepth:[8,16],components:1,alpha:0}),e.columns%2==0||e.rows%2==0)throw new TypeError("morphologicalGradient: The number of rows and columns of the kernel must be odd");let n=this;for(let t=0;t<i;t++){let t=n.dilate({kernel:e}),i=n.erode({kernel:e});n=t.subtractImage(i,{absolute:!0})}return n}function __(t,e){return Math.sqrt(Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2))}function y_(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function w_(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function x_(t,e,i,n,r,s,o,a,l,h,c,u){let[d,g]=[(i*t+n*e+r)/(l*t+h*e+1),(s*t+o*e+a)/(l*t+h*e+1)];return c.getValueXY(Math.floor(d),Math.floor(g),u)}function b_(t,e={}){let{calculateRatio:i=!0}=e;if(4!==t.length)throw new Error(`The array pts must have four elements, which are the four corners. Currently, pts have ${t.length} elements`);let n,r,[s,o,a,l]=t,h=[s,o,a,l],[c,u,d,g]=function(t){let e=0,i=0,n=0,r=0,s=t[0][0],o=0;for(let e=1;e<t.length;e++)t[e][0]<s&&(s=t[e][0],o=e);let a=t[(o+1)%t.length][0],l=(o+1)%t.length;for(let e=1;e<t.length;e++)t[e][0]<a&&e!==o&&(a=t[e][0],l=e);return t[l][1]<t[o][1]?(e=t[l],r=t[o],o!==(l+1)%4?(i=t[(l+1)%4],n=t[(l+2)%4]):(i=t[(l+2)%4],n=t[(l+3)%4])):(r=t[l],e=t[o],l!==(o+1)%4?(i=t[(o+1)%4],n=t[(o+2)%4]):(i=t[(o+2)%4],n=t[(o+3)%4])),[e,i,n,r]}(h);i?[n,r]=function(t,e,i,n,r,s){let o=Math.max(__(t,e),__(n,i)),a=Math.max(__(t,n),__(e,i)),l=0,h=0,c=Math.ceil(r/2),u=Math.ceil(s/2),d=o/a,g=[t[0],t[1],1],f=[e[0],e[1],1],p=[n[0],n[1],1],m=[i[0],i[1],1],_=w_(y_(g,m),p)/w_(y_(f,m),p),y=w_(y_(g,m),f)/w_(y_(p,m),f),w=[_*f[0]-g[0],_*f[1]-g[1],_*f[2]-g[2]],x=[y*p[0]-g[0],y*p[1]-g[1],y*p[2]-g[2]],b=w[0],v=w[1],E=w[2],S=x[0],I=x[1],M=x[2],C=1/(E*M)*(b*S-(b*M+E*S)*c+E*M*c*c+(v*I-(v*M+E*I)*u+E*M*u*u));C=C>=0?Math.sqrt(C):Math.sqrt(-C);let T=new Tm([[C,0,c],[0,C,u],[0,0,1]]),R=T.transpose(),A=km(R),k=km(T),P=Tm.rowVector(w),L=Tm.rowVector(x),N=Math.sqrt(w_(P.mmul(A).mmul(k).to1DArray(),w)/w_(L.mmul(A).mmul(k).to1DArray(),x));return 0===N||0===d?(l=Math.ceil(o),h=Math.ceil(a)):N<d?(l=Math.ceil(o),h=Math.ceil(l/N)):(h=Math.ceil(a),l=Math.ceil(N*h)),[l,h]}(c,u,d,g,this.width,this.height):(n=Math.ceil(Math.max(__(c,u),__(g,d))),r=Math.ceil(Math.max(__(c,g),__(u,d))));let f=tx.createFrom(this,{width:n,height:r}),[p,m]=c,[_,y]=u,[w,x]=d,[b,v]=g,[E,S]=[0,0],[I,M]=[0,n-1],[C,T]=[r-1,n-1],[R,A]=[r-1,0],k=new Tm([[E,S,1,0,0,0,-E*p,-S*p],[I,M,1,0,0,0,-I*_,-M*_],[C,T,1,0,0,0,-C*w,-S*w],[R,A,1,0,0,0,-R*b,-A*b],[0,0,0,E,S,1,-E*m,-S*m],[0,0,0,I,M,1,-I*y,-M*y],[0,0,0,C,T,1,-C*x,-T*x],[0,0,0,R,A,1,-R*v,-A*v]]),P=Tm.columnVector([p,_,w,b,m,y,x,v]),L=new Am(k).solve(P),[N,D,O,F,z,B,G,Y]=L.to1DArray(),U=new Tm(r,n);for(let t=0;t<this.channels;t++){for(let e=0;e<r;e++)for(let i=0;i<n;i++)U.set(e,i,x_(e,i,N,D,O,F,z,B,G,Y,this,t));f.setMatrix(U,{channel:t})}return f}function v_(t={}){let{x:e=0,y:i=0,width:n=this.width-e,height:r=this.height-i}=t;if(this.checkProcessable("crop",{bitDepth:[1,8,16]}),e=Math.round(e),i=Math.round(i),n=Math.round(n),r=Math.round(r),e>this.width-1||i>this.height-1)throw new RangeError(`crop: origin (x:${e}, y:${i}) out of range (${this.width-1}; ${this.height-1})`);if(n<=0||r<=0)throw new RangeError(`crop: width and height (width:${n}; height:${r}) must be positive numbers`);if(e<0||i<0)throw new RangeError(`crop: x and y (x:${e}, y:${i}) must be positive numbers`);if(n>this.width-e||r>this.height-i)throw new RangeError(`crop: (x: ${e}, y:${i}, width:${n}, height:${r}) size is out of range`);let s=this;return s=1===this.bitDepth?function(t,e,i,n,r,s){let o=r*t.channels,a=n+s,l=0,h=i*t.channels;for(let i=n;i<a;i++){let n=i*t.width*t.channels+h,r=n+o;for(;n<r;n++)t.getBit(n)&&e.setBit(l),++l}return e}(this,new tx(n,r,{kind:"BINARY",parent:this}),e,i,n,r):function(t,e,i,n,r,s){let o=r*t.channels,a=n+s,l=0,h=i*t.channels;for(let i=n;i<a;i++){let n=i*t.width*t.channels+h,r=n+o;for(;n<r;n++)e.data[l++]=t.data[n]}return e}(this,tx.createFrom(this,{width:n,height:r,position:[e,i]}),e,i,n,r),s}function E_(t={}){this.checkProcessable("cropAlpha",{alpha:1});const{threshold:e=this.maxValue}=t;let i=function(t,e,i){for(let n=0;n<t.width;n++)for(let r=0;r<t.height;r++)if(t.getValueXY(n,r,i)>=e)return n;return-1}(this,e,this.components);if(-1===i)throw new Error("Could not find new dimensions. Threshold may be too high.");let n=function(t,e,i,n){for(let r=0;r<t.height;r++)for(let s=n;s<t.width;s++)if(t.getValueXY(s,r,i)>=e)return r;return-1}(this,e,this.components,i),r=function(t,e,i,n){for(let r=t.height-1;r>=0;r--)for(let s=n;s<t.width;s++)if(t.getValueXY(s,r,i)>=e)return r;return-1}(this,e,this.components,i),s=function(t,e,i,n,r,s){for(let o=t.width-1;o>=n;o--)for(let n=r;n<=s;n++)if(t.getValueXY(o,n,i)>=e)return o;return-1}(this,e,this.components,i,n,r);return this.crop({x:i,y:n,width:s-i+1,height:r-n+1})}function S_(t,e){if(e<0||e>=t.channels)throw new RangeError(`channel must be included between 0 and ${t.channels-1}. Current value: ${e}`)}const I_={nearestneighbor:"nearestNeighbor",nearestneighbour:"nearestNeighbor",bilinear:"bilinear"};function M_(t){if("string"!=typeof t)throw new TypeError("interpolation must be a string");if(t=t.toLowerCase(),!I_[t])throw new RangeError(`invalid interpolation algorithm: ${t}`);return I_[t]}function C_(t,e,i){const n=this.width/e,r=this.height/i;if(this.bitDepth>1)for(let s=0;s<e;s++){const e=Math.floor((s+.5)*n);for(let n=0;n<i;n++){const i=Math.floor((n+.5)*r);for(let r=0;r<this.channels;r++)t.setValueXY(s,n,r,this.getValueXY(e,i,r))}}else for(let s=0;s<e;s++){const e=Math.floor((s+.5)*n);for(let n=0;n<i;n++){const i=Math.floor((n+.5)*r);this.getBitXY(e,i)&&t.setBitXY(s,n)}}}function T_(t={}){const{factor:e=1,interpolation:i=I_.nearestneighbor,preserveAspectRatio:n=!0}=t,r=M_(i);let s=t.width,o=t.height;if(s||(s=o&&n?Math.round(o*(this.width/this.height)):this.width),o||(o=n?Math.round(s*(this.height/this.width)):this.height),({width:s,height:o}=function(t,e,i){t=function(t){if("string"==typeof t){const e=t[t.length-1];t=parseFloat(t),"%"===e&&(t/=100)}return t}(t);let n=Math.round(t*e),r=Math.round(t*i);return n<=0&&(n=1),r<=0&&(r=1),{width:n,height:r}}(e,s,o)),s===this.width&&o===this.height){const t=this.clone();return t.position=[0,0],t}let a=Math.round((this.width-s)/2),l=Math.round((this.height-o)/2);const h=tx.createFrom(this,{width:s,height:o,position:[a,l]});if(r!==I_.nearestneighbor)throw new Error(`unsupported resize interpolation: ${r}`);return C_.call(this,h,s,o),h}function R_(){this.checkProcessable("hsv",{bitDepth:[8,16],alpha:[0,1],colorModel:[sp]});let t=tx.createFrom(this,{colorModel:ap}),e=0,i=this.data;for(let n=0;n<i.length;n+=this.channels){let r=i[n],s=i[n+1],o=i[n+2],a=Math.min(r,s,o),l=Math.max(r,s,o),h=l-a,c=0,u=0===l?0:h/l,d=l;if(l!==a){switch(l){case r:c=(s-o)/h+(s<o?6:0);break;case s:c=(o-r)/h+2;break;case o:c=(r-s)/h+4;break;default:throw new Error("unreachable")}c/=6}t.data[e++]=c*this.maxValue,t.data[e++]=u*this.maxValue,t.data[e++]=d,this.alpha&&(t.data[e++]=i[n+3])}return t}function A_(){this.checkProcessable("hsl",{bitDepth:[8,16],alpha:[0,1],colorModel:[sp]});let t=tx.createFrom(this,{colorModel:op}),e=Math.floor(this.maxValue/2),i=0,n=this.data;for(let r=0;r<n.length;r+=this.channels){let s=n[r],o=n[r+1],a=n[r+2],l=Math.max(s,o,a),h=Math.min(s,o,a),c=0,u=0,d=(l+h)/2;if(l!==h){let t=l-h;switch(u=d>e?t/(2-l-h):t/(l+h),l){case s:c=(o-a)/t+(o<a?6:0);break;case o:c=(a-s)/t+2;break;case a:c=(s-o)/t+4;break;default:throw new Error("unreachable")}c/=6}t.data[i++]=c*this.maxValue,t.data[i++]=u*this.maxValue,t.data[i++]=d,this.alpha&&(t.data[i++]=n[r+3])}return t}function k_(){this.checkProcessable("cmyk",{bitDepth:[8,16],alpha:[0,1],colorModel:[sp]});let t=tx.createFrom(this,{components:4,colorModel:lp}),e=0,i=this.data;for(let n=0;n<i.length;n+=this.channels){let r=i[n],s=i[n+1],o=i[n+2],a=Math.min(this.maxValue-r,this.maxValue-s,this.maxValue-o),l=(this.maxValue-r-a)/(1-a/this.maxValue),h=(this.maxValue-s-a)/(1-a/this.maxValue),c=(this.maxValue-o-a)/(1-a/this.maxValue);t.data[e++]=Math.round(l),t.data[e++]=Math.round(h),t.data[e++]=Math.round(c),t.data[e++]=Math.round(a),this.alpha&&(t.data[e++]=i[n+3])}return t}function P_(){return new tx(this.width,this.height,this.getRGBAData(),{kind:"RGBA",parent:this})}const L_={luma709:(t,e,i)=>6966*t+23436*e+2366*i>>15,luma601:(t,e,i)=>9798*t+19235*e+3735*i>>15,maximum:(t,e,i)=>Math.max(t,e,i),minimum:(t,e,i)=>Math.min(t,e,i),average:(t,e,i)=>(t+e+i)/3>>0,minmax:(t,e,i)=>(Math.max(t,e,i)+Math.min(t,e,i))/2,red:t=>t,green:(t,e)=>e,blue:(t,e,i)=>i,cyan(t,e,i,n){let r=L_.black(t,e,i,n);return(n.maxValue-t-r)/(1-r/n.maxValue)>>0},magenta(t,e,i,n){let r=L_.black(t,e,i,n);return(n.maxValue-e-r)/(1-r/n.maxValue)>>0},yellow(t,e,i,n){let r=L_.black(t,e,i,n);return(n.maxValue-i-r)/(1-r/n.maxValue)>>0},black:(t,e,i,n)=>Math.min(n.maxValue-t,n.maxValue-e,n.maxValue-i),hue(t,e,i,n){let r=L_.min(t,e,i),s=L_.max(t,e,i);if(s===r)return 0;let o=0,a=s-r;switch(s){case t:o=(e-i)/a+(e<i?6:0);break;case e:o=(i-t)/a+2;break;case i:o=(t-e)/a+4;break;default:throw new Error("unreachable")}return o/6*n.maxValue>>0},saturation(t,e,i,n){let r=L_.min(t,e,i),s=L_.max(t,e,i);return 0===s?0:(s-r)/s*n.maxValue},lightness(t,e,i){let n=L_.min(t,e,i);return(L_.max(t,e,i)+n)/2}};Object.defineProperty(L_,"luminosity",{enumerable:!1,value:L_.lightness}),Object.defineProperty(L_,"luminance",{enumerable:!1,value:L_.lightness}),Object.defineProperty(L_,"min",{enumerable:!1,value:L_.minimum}),Object.defineProperty(L_,"max",{enumerable:!1,value:L_.maximum}),Object.defineProperty(L_,"brightness",{enumerable:!1,value:L_.maximum});const N_={};function D_(t={}){let{algorithm:e="luma709",keepAlpha:i=!1,mergeAlpha:n=!0}=t;if("string"!=typeof e&&"function"!=typeof e)throw new TypeError("algorithm must be a string or a function");this.checkProcessable("grey",{bitDepth:[8,16],alpha:[0,1]}),1===this.components&&(e="red"),i&=this.alpha,n&=this.alpha,i&&(n=!1);let r,s=rm(this,t,{components:1,alpha:i,colorModel:rp});if("function"==typeof e)r=e;else if(r=L_[e.toLowerCase()],!r)throw new Error(`unsupported grey algorithm: ${e}`);let o=0;for(let t=0;t<this.data.length;t+=this.channels)n?s.data[o++]=Sm(r(this.data[t],this.data[t+1],this.data[t+2],this)*this.data[t+this.components]/this.maxValue,this):(s.data[o++]=Sm(r(this.data[t],this.data[t+1],this.data[t+2],this),this),s.alpha&&(s.data[o++]=this.data[t+this.components]));return s}function O_(t){let e=!1,i=0;for(let e=1;e<t.length-1;e++)if(t[e-1]<t[e]&&t[e+1]<t[e]&&(i++,i>2))return!1;return 2===i&&(e=!0),e}function F_(t,e){let i=0;for(let n=0;n<=e;n++)i+=t[n];return i}function z_(t,e){let i=0;for(let n=0;n<=e;n++)i+=n*t[n];return i}function B_(t,e){let i=0;for(let n=0;n<=e;n++)i+=n*n*t[n];return i}function G_(t){let e=new Array(t.length);for(let i=1;i<t.length-1;i++)e[i]=(t[i-1]+t[i]+t[i+1])/3;return e[0]=(t[0]+t[1])/3,e[t.length-1]=(t[t.length-2]+t[t.length-1])/3,e}function Y_(t){let e=t.length,i=!1,n=0;for(let i=1;i<e-1;i++)if(t[i-1]<t[i]&&t[i+1]<t[i]&&(n++,n>2))return!1;return 2===n&&(i=!0),i}function U_(t,e){let i=0;for(let n=0;n<=e;n++)i+=t[n];return i}Object.keys(L_).forEach((t=>{N_[t]=t}));const X_={huang:function(t){let e=0;for(let i=0;i<t.length;i++)if(0!==t[i]){e=i;break}let i=t.length-1;for(let n=t.length-1;n>=e;n--)if(0!==t[n]){i=n;break}let n=1/(i-e),r=new Array(t.length),s=0,o=0;for(let i=e;i<t.length;i++)s+=i*t[i],o+=t[i],r[i]=s/o;let a=new Array(t.length);s=o=0;for(let e=i;e>0;e--)s+=e*t[e],o+=t[e],a[e-1]=s/o;let l=-1,h=Number.MAX_VALUE;for(let e=0;e<t.length;e++){let i,s=0;for(let o=0;o<=e;o++)i=1/(1+n*Math.abs(o-r[e])),i<1e-6||i>.999999||(s+=t[o]*(-i*Math.log(i)-(1-i)*Math.log(1-i)));for(let r=e+1;r<t.length;r++)i=1/(1+n*Math.abs(r-a[e])),i<1e-6||i>.999999||(s+=t[r]*(-i*Math.log(i)-(1-i)*Math.log(1-i)));s<h&&(h=s,l=e)}return l},intermodes:function(t){let e=t.slice(),i=0;for(;!O_(e);){let n=0,r=0,s=e[0];for(let i=0;i<t.length-1;i++)n=r,r=s,s=e[i+1],e[i]=(n+r+s)/3;if(e[t.length-1]=(r+s)/3,i++,i>1e4)throw new Error("Intermodes Threshold not found after 10000 iterations")}let n=0;for(let i=1;i<t.length-1;i++)e[i-1]<e[i]&&e[i+1]<e[i]&&(n+=i);return Math.floor(n/2)},isodata:function(t){let e,i,n,r,s=0;for(let e=1;e<t.length;e++)if(t[e]>0){s=e+1;break}for(;;){e=0,n=0;for(let i=0;i<s;i++)n+=t[i],e+=t[i]*i;r=0,i=0;for(let e=s+1;e<t.length;e++)i+=t[e],r+=t[e]*e;if(n>0&&i>0&&(e/=n,r/=i,s===Math.round((e+r)/2)))break;if(s++,s>t.length-2)throw new Error("Threshold not found")}return s},li:function(t,e){let i,n,r,s,o,a,l,h,c,u,d,g;d=.5,u=0;for(let e=0;e<t.length;e++)u+=e*t[e];u/=e,l=u;do{a=l,i=a+.5|0,n=0,s=0;for(let e=0;e<=i;e++)n+=e*t[e],s+=t[e];h=0===s?0:n/s,r=0,o=0;for(let e=i+1;e<t.length;e++)r+=e*t[e],o+=t[e];c=0===o?0:r/o,g=(h-c)/(Math.log(h)-Math.log(c)),l=g<-Number.EPSILON?g-.5|0:g+.5|0}while(Math.abs(l-a)>.5);return i},maxentropy:function(t,e){let i=new Array(t.length);for(let n=0;n<t.length;n++)i[n]=t[n]/e;let n=new Array(t.length),r=new Array(t.length);n[0]=i[0],r[0]=1-n[0];for(let e=1;e<t.length;e++)n[e]=n[e-1]+i[e],r[e]=1-n[e];let s=0;for(let e=0;e<t.length;e++)if(Math.abs(n[e])>=Number.EPSILON){s=e;break}let o=t.length-1;for(let e=t.length-1;e>=s;e--)if(Math.abs(r[e])>=Number.EPSILON){o=e;break}let a,l,h,c=-1,u=Number.MIN_VALUE;for(let e=s;e<=o;e++){l=0;for(let r=0;r<=e;r++)0!==t[r]&&(l-=i[r]/n[e]*Math.log(i[r]/n[e]));h=0;for(let n=e+1;n<t.length;n++)0!==t[n]&&(h-=i[n]/r[e]*Math.log(i[n]/r[e]));a=l+h,u<a&&(u=a,c=e)}return c},mean:function(t,e){let i=0;for(let e=0;e<t.length;e++)i+=e*t[e];return Math.floor(i/e)},minerror:function(t,e){let i,n,r,s,o,a,l,h,c,u,d,g,f=-2,p=0;for(let e=0;e<t.length;e++)p+=e*t[e];for(p/=e,i=p;i!==f;){let e=F_(t,i),p=F_(t,t.length-1),m=z_(t,i),_=z_(t,t.length-1),y=B_(t,i);if(n=m/e,r=(_-m)/(p-e),s=e/p,o=(p-e)/p,a=y/e-n*n,l=(B_(t,t.length-1)-y)/(p-e)-r*r,h=1/a-1/l,c=n/a-r/l,u=n*n/a-r*r/l+Math.log10(a*(o*o)/(l*(s*s))),d=c*c-h*u,d<0)return i;f=i,g=(c+Math.sqrt(d))/h,i=isNaN(g)?f:Math.floor(g)}return i},minimum:function(t){if(t.length<2)return 0;let e=0,i=-1,n=-1,r=new Array(t.length);for(let e=0;e<t.length;e++)r[e]=t[e],t[e]>0&&(n=e);for(;!Y_(r);)if(r=G_(r),e++,e>1e4)return i;return i=function(t,e){let i;for(let n=1;n<e;n++)if(t[n-1]>t[n]&&t[n+1]>=t[n]){i=n;break}return i}(r,n),i},moments:function(t,e){let i,n,r,s,o,a,l=0,h=0,c=0,u=0,d=-1,g=t.length,f=new Array(g);for(let i=0;i<g;i++)f[i]=t[i]/e;for(let t=0;t<g;t++)l+=t*f[t],h+=t*t*f[t],c+=t*t*t*f[t];n=1*h-l*l,r=(-h*h+l*c)/n,s=(1*-c+h*l)/n,o=.5*(-s-Math.sqrt(s*s-4*r)),a=.5*(-s+Math.sqrt(s*s-4*r)),i=(a-l)/(a-o);for(let t=0;t<g;t++)if(u+=f[t],u>i){d=t;break}return d},otsu:function(t,e){let i=0,n=0,r=0,s=0,o=0;for(let e=0;e<t.length;e++)o+=e*t[e];for(let a=0;a<t.length;a++){n+=t[a];const l=e-n;if(0===n||0===l)continue;i+=a*t[a];const h=(o-i)/l,c=n*l*(i/n-h)*(i/n-h);c>=r&&(s=a,r=c)}return s},percentile:function(t){let e=-1,i=new Array(t.length),n=U_(t,t.length-1),r=1;for(let s=0;s<t.length;s++)i[s]=Math.abs(U_(t,s)/n-.5),i[s]<r&&(r=i[s],e=s);return e},renyientropy:function(t,e){let i,n,r,s=new Array(t.length),o=new Array(t.length),a=new Array(t.length),l=0,h=0,c=0,u=0,d=0,g=0;for(let i=0;i<t.length;i++)s[i]=t[i]/e;o[0]=s[0],a[0]=1-o[0];for(let e=1;e<t.length;e++)o[e]=o[e-1]+s[e],a[e]=1-o[e];n=0;for(let e=0;e<t.length;e++)if(Math.abs(o[e])>=Number.EPSILON){n=e;break}r=t.length-1;for(let e=t.length-1;e>=n;e--)if(Math.abs(a[e])>=Number.EPSILON){r=e;break}for(let e=n;e<=r;e++){let i=0,n=0,r=0;for(let a=0;a<=e;a++)0!==t[a]&&(i-=s[a]/o[e]*Math.log(s[a]/o[e])),n+=Math.sqrt(s[a]/o[e]),r+=s[a]*s[a]/(o[e]*o[e]);let f=0,p=0,m=0;for(let i=e+1;i<t.length;i++)0!==t[i]&&(f-=s[i]/a[e]*Math.log(s[i]/a[e])),p+=Math.sqrt(s[i]/a[e]),m+=s[i]*s[i]/(a[e]*a[e]);let _=i+f,y=2*(n*p>0?Math.log(n*p):0),w=-1*(r*m>0?Math.log(r*m):0);_>u&&(u=_,l=e),y>d&&(d=y,h=e),w>g&&(g=w,c=e)}let f,p=[l,h,c];p.sort(((t,e)=>t-e)),f=Math.abs(p[0]-p[1])<=5?Math.abs(p[1]-p[2])<=5?[1,2,1]:[0,1,3]:Math.abs(p[1]-p[2])<=5?[3,1,0]:[1,2,1];let m=o[p[2]]-o[p[0]];return i=Math.round(p[0]*(o[p[0]]+.25*m*f[0])+.25*p[1]*m*f[1]+p[2]*(a[p[2]]+.25*m*f[2])),i},shanbhag:function(t,e){let i=new Array(t.length);for(let n=0;n<t.length;n++)i[n]=t[n]/e;let n=new Array(t.length),r=new Array(t.length);n[0]=i[0],r[0]=1-n[0];for(let e=1;e<t.length;e++)n[e]=n[e-1]+i[e],r[e]=1-n[e];let s=0;for(let e=0;e<t.length;e++)if(Math.abs(n[e])>=Number.EPSILON){s=e;break}let o=t.length-1;for(let e=t.length-1;e>=s;e--)if(Math.abs(r[e])>=Number.EPSILON){o=e;break}let a,l,h,c,u=-1,d=Number.MAX_VALUE;for(let e=s;e<=o;e++){h=0,a=.5/n[e];for(let t=1;t<=e;t++)h-=i[t]*Math.log(1-a*n[t-1]);h*=a,c=0,a=.5/r[e];for(let n=e+1;n<t.length;n++)c-=i[n]*Math.log(1-a*r[n]);c*=a,l=Math.abs(h-c),l<d&&(d=l,u=e)}return u},triangle:function(t){let e=0,i=0,n=0,r=0;for(let i=0;i<t.length;i++)if(t[i]>0){e=i;break}e>0&&e--;for(let e=t.length-1;e>0;e--)if(t[e]>0){r=e;break}r<t.length-1&&r++;for(let e=0;e<t.length;e++)t[e]>i&&(n=e,i=t[e]);let s,o,a,l=!1;if(n-e<r-n){l=!0;let i=0,s=t.length-1;for(;i<s;){let e=t[i];t[i]=t[s],t[s]=e,i++,s--}e=t.length-1-r,n=t.length-1-n}if(e===n)return e;s=t[n],o=e-n,a=Math.sqrt(s*s+o*o),s/=a,o/=a,a=s*e+o*t[e];let h=e,c=0;for(let i=e+1;i<=n;i++){let e=s*i+o*t[i]-a;e>c&&(h=i,c=e)}if(h--,l){let e=0,i=t.length-1;for(;e<i;){let n=t[e];t[e]=t[i],t[i]=n,e++,i--}return t.length-1-h}return h},yen:function(t,e){let i=new Array(t.length);for(let n=0;n<t.length;n++)i[n]=t[n]/e;let n=new Array(t.length);n[0]=i[0];for(let e=1;e<t.length;e++)n[e]=n[e-1]+i[e];let r=new Array(t.length);r[0]=i[0]*i[0];for(let e=1;e<t.length;e++)r[e]=r[e-1]+i[e]*i[e];let s=new Array(t.length);s[t.length-1]=0;for(let e=t.length-2;e>=0;e--)s[e]=s[e+1]+i[e+1]*i[e+1];let o,a=-1,l=Number.MIN_VALUE;for(let e=0;e<t.length;e++)o=-1*(r[e]*s[e]>0?Math.log(r[e]*s[e]):0)+2*(n[e]*(1-n[e])>0?Math.log(n[e]*(1-n[e])):0),o>l&&(l=o,a=e);return a}},q_={};function V_(t={}){let{algorithm:e=q_.otsu}=t;this.checkProcessable("getThreshold",{components:1,bitDepth:[8,16]});let i=X_[e.toLowerCase()];if(i)return i(this.getHistogram(),this.size);throw new Error(`unknown thresholding algorithm: ${e}`)}Object.keys(X_).forEach((t=>{q_[t]=t}));const j_="threshold";function W_(t={}){let{algorithm:e=j_,threshold:i=.5,useAlpha:n=!0,invert:r=!1}=t;this.checkProcessable("mask",{components:1,bitDepth:[8,16]}),i=e===j_?function(t,e){if(!e)throw Error("getThreshold : the maxValue should be specified");if("string"==typeof t){if("%"!==t[t.length-1])throw Error("getThreshold : if the value is a string it must finish by %");return parseFloat(t)/100*e}if("number"==typeof t)return t<1?t*e:t;throw Error("getThreshold : the value is not valid")}(i,this.maxValue):V_.call(this,t);let s=new tx(this.width,this.height,{kind:"BINARY",parent:this}),o=0;if(this.alpha&&n)for(let t=0;t<this.data.length;t+=this.channels){let e=this.data[t]+(this.maxValue-this.data[t])*(this.maxValue-this.data[t+1])/this.maxValue;(r&&e<=i||!r&&e>=i)&&s.setBit(o),o++}else for(let t=0;t<this.data.length;t+=this.channels)(r&&this.data[t]<=i||!r&&this.data[t]>=i)&&s.setBit(o),o++;return s}function Z_(t={}){let{size:e=0,algorithm:i="copy",color:n}=t;if(this.checkProcessable("pad",{bitDepth:[8,16]}),"set"===i){if(n.length!==this.channels)throw new Error(`pad: the color array must have the same length as the number of channels. Here: ${this.channels}`);for(let t=0;t<n.length;t++)0===n[t]&&(n[t]=.001)}else n=zm()(this.channels,null);Array.isArray(e)||(e=[e,e]);let r=this.width+2*e[0],s=this.height+2*e[1],o=this.channels,a=tx.createFrom(this,{width:r,height:s});!function(t,e,i,n){let r=t.width,s=t.height,o=e.width,a=t.channels;for(let l=0;l<r;l++)for(let h=0;h<s;h++)for(let s=0;s<a;s++){let c=(h*r+l)*a+s,u=((n+h)*o+i+l)*a+s;e.data[u]=t.data[c]}}(this,a,e[0],e[1]);for(let t=e[0];t<r-e[0];t++)for(let i=0;i<o;i++){let l=n[i]||a.data[(e[1]*r+t)*o+i];for(let n=0;n<e[1];n++)a.data[(n*r+t)*o+i]=l;l=n[i]||a.data[((s-e[1]-1)*r+t)*o+i];for(let n=s-e[1];n<s;n++)a.data[(n*r+t)*o+i]=l}for(let t=0;t<s;t++)for(let i=0;i<o;i++){let s=n[i]||a.data[(t*r+e[0])*o+i];for(let n=0;n<e[0];n++)a.data[(t*r+n)*o+i]=s;s=n[i]||a.data[(t*r+r-e[0]-1)*o+i];for(let n=r-e[0];n<r;n++)a.data[(t*r+n)*o+i]=s}return a}function H_(t=8){if(this.checkProcessable("colorDepth",{bitDepth:[1,8,16]}),![8,16].includes(t))throw Error("You need to specify the new colorDepth as 8 or 16");if(this.bitDepth===t)return this.clone();let e=tx.createFrom(this,{bitDepth:t});switch(t){case 8:if(1===this.bitDepth)for(let t=0;t<this.size;t++)this.getBit(t)&&(e.data[t]=255);else for(let t=0;t<this.data.length;t++)e.data[t]=this.data[t]>>8;break;case 16:if(1===this.bitDepth)for(let t=0;t<this.size;t++)this.getBit(t)&&(e.data[t]=65535);else for(let t=0;t<this.data.length;t++)e.data[t]=this.data[t]<<8|this.data[t];break;default:throw new Error("colorDepth conversion unexpected case")}return e}function K_(t,e={}){const{interpolation:i=I_.nearestneighbor,width:n=this.width,height:r=this.height}=e;if("number"!=typeof t)throw new TypeError("degrees must be a number");const s=M_(i),o=t*Math.PI/180,a=Math.floor(Math.abs(n*Math.cos(o))+Math.abs(r*Math.sin(o))),l=Math.floor(Math.abs(r*Math.cos(o))+Math.abs(n*Math.sin(o))),h=Math.cos(-o),c=Math.sin(-o);let u=a/2,d=l/2;a%2==0?(u-=.5,l%2==0?d-=.5:d=Math.floor(d)):(u=Math.floor(u),l%2==0?d-=.5:d=Math.floor(d));const g=Math.floor(n/2-u),f=Math.floor(r/2-d);if(1===this.bitDepth){const t=new tx(a,l,{kind:"BINARY",parent:this});switch(s){case I_.nearestneighbor:return function(t,e,i,n,r,s,o,a){for(let l=0;l<e.width;l+=1)for(let h=0;h<e.height;h+=1){let c=Math.round((l-r)*o-(h-s)*a+r)+i,u=Math.round((h-s)*o+(l-r)*a+s)+n;(c<0||c>=t.width||u<0||u>=t.height||t.getBitXY(c,u))&&e.setBitXY(l,h)}return e}(this,t,g,f,u,d,h,c);case I_.bilinear:return function(t,e,i,n,r,s,o,a){let l=t.width;for(let h=0;h<e.height;h++)for(let c=0;c<e.width;c++){let u=(c-r)*o-(h-s)*a+r+i,d=(h-s)*o+(c-r)*a+s+n,g=0|u,f=0|d,p=u-g,m=d-f;if(u<0||u>=t.width||d<0||d>=t.height)e.setBitXY(c,h);else{let i=f*t.width+g,n=t.getBit(i),r=t.getBit(i+1),s=t.getBit(i+l);(n|p&r-n|m&s-n|p&m&n-r-s+t.getBit(i+1+l))>0&&e.setBitXY(c,h)}}return e}(this,t,g,f,u,d,h,c);default:throw new Error(`unsupported rotate interpolation: ${s}`)}}else{const t=tx.createFrom(this,{width:a,height:l});switch(s){case I_.nearestneighbor:return function(t,e,i,n,r,s,o,a){for(let l=0;l<e.width;l+=1)for(let h=0;h<e.height;h+=1)for(let c=0;c<t.channels;c++){let u=Math.round((l-r)*o-(h-s)*a+r)+i,d=Math.round((h-s)*o+(l-r)*a+s)+n;u<0||u>=t.width||d<0||d>=t.height?1===t.alpha&&c===t.channels-1?e.setValueXY(l,h,c,0):e.setValueXY(l,h,c,t.maxValue):e.setValueXY(l,h,c,t.getValueXY(u,d,c))}return e}(this,t,g,f,u,d,h,c);case I_.bilinear:return function(t,e,i,n,r,s,o,a){let l=t.width*t.channels;for(let h=0;h<e.height;h++)for(let c=0;c<e.width;c++){let u=(c-r)*o-(h-s)*a+r+i,d=(h-s)*o+(c-r)*a+s+n,g=0|u,f=0|d,p=u-g,m=d-f;for(let i=0;i<t.channels;i++)if(u<0||u>=t.width||d<0||d>=t.height)1===t.alpha&&i===t.channels-1?e.setValueXY(c,h,i,0):e.setValueXY(c,h,i,t.maxValue);else{let n=(f*t.width+g)*t.channels+i,r=t.data[n],s=t.data[n+t.channels],o=t.data[n+l],a=r+p*(s-r)+m*(o-r)+p*m*(r-s-o+t.data[n+l+t.channels])|0;e.setValueXY(c,h,i,a)}}return e}(this,t,g,f,u,d,h,c);default:throw new Error(`unsupported rotate interpolation: ${s}`)}}}function $_(t,e){if(this.checkProcessable("rotate",{bitDepth:[1,8,16]}),"number"!=typeof t)throw new TypeError("angle must be a number");switch(t<0&&(t=360*Math.ceil(-t/360)+t),t%360){case 0:return this.clone();case 90:return Q_.call(this);case 180:return ty.call(this);case 270:return J_.call(this);default:return K_.call(this,t,e)}}function J_(){if(1===this.bitDepth){const t=new tx(this.height,this.width,{kind:"BINARY",parent:this}),e=t.height-1;for(let i=0;i<this.height;i++)for(let n=0;n<this.width;n++)this.getBitXY(n,i)&&t.setBitXY(i,e-n);return t}{const t=tx.createFrom(this,{width:this.height,height:this.width}),e=t.height-1;for(let i=0;i<this.height;i++)for(let n=0;n<this.width;n++)for(let r=0;r<this.channels;r++)t.setValueXY(i,e-n,r,this.getValueXY(n,i,r));return t}}function Q_(){if(1===this.bitDepth){const t=new tx(this.height,this.width,{kind:"BINARY",parent:this}),e=t.width-1;for(let i=0;i<this.height;i++)for(let n=0;n<this.width;n++)this.getBitXY(n,i)&&t.setBitXY(e-i,n);return t}{const t=tx.createFrom(this,{width:this.height,height:this.width}),e=t.width-1;for(let i=0;i<this.height;i++)for(let n=0;n<this.width;n++)for(let r=0;r<this.channels;r++)t.setValueXY(e-i,n,r,this.getValueXY(n,i,r));return t}}function ty(){if(1===this.bitDepth){const t=new tx(this.width,this.height,{kind:"BINARY",parent:this}),e=t.width-1,i=t.height-1;for(let n=0;n<this.height;n++)for(let r=0;r<this.width;r++)this.getBitXY(r,n)&&t.setBitXY(e-r,i-n);return t}{const t=tx.createFrom(this),e=t.width-1,i=t.height-1;for(let n=0;n<this.height;n++)for(let r=0;r<this.width;r++)for(let s=0;s<this.channels;s++)t.setValueXY(e-r,i-n,s,this.getValueXY(r,n,s));return t}}function ey(t,e={}){const i=nm(t);this.checkProcessable("insert",i);let{x:n=0,y:r=0}=e;const s=sm(this,e,{copy:!0}),o=Math.min(s.height,r+t.height),a=Math.min(s.width,n+t.width);if(1===s.bitDepth)for(let e=r;e<o;e++)for(let i=n;i<a;i++)t.getBitXY(i-n,e-r)?s.setBitXY(i,e):s.clearBitXY(i,e);else for(let e=r;e<o;e++)for(let i=n;i<a;i++)s.setPixelXY(i,e,t.getPixelXY(i-n,e-r));return s}function iy(t={}){let{size:e=0,algorithm:i="copy",color:n}=t;if(this.checkProcessable("setBorder",{bitDepth:[8,16,32,64]}),"set"===i){if(n.length!==this.channels)throw new Error(`setBorder: the color array must have the same length as the number of channels. Here: ${this.channels}`);for(let t=0;t<n.length;t++)0===n[t]&&(n[t]=.001)}else n=zm()(this.channels,null);Array.isArray(e)||(e=[e,e]);let r=e[0],s=e[1],o=this.channels;for(let t=r;t<this.width-r;t++)for(let e=0;e<o;e++){let i=n[e]||this.data[(t+this.width*s)*o+e];for(let n=0;n<s;n++)this.data[(n*this.width+t)*o+e]=i;i=n[e]||this.data[(t+this.width*(this.height-s-1))*o+e];for(let n=this.height-s;n<this.height;n++)this.data[(n*this.width+t)*o+e]=i}for(let t=0;t<this.height;t++)for(let e=0;e<o;e++){let i=n[e]||this.data[(t*this.width+r)*o+e];for(let n=0;n<r;n++)this.data[(t*this.width+n)*o+e]=i;i=n[e]||this.data[(t*this.width+this.width-r-1)*o+e];for(let n=this.width-r;n<this.width;n++)this.data[(t*this.width+n)*o+e]=i}return this}function ny(t={}){let{preserveAlpha:e=!0}=t;if(this.checkProcessable("split",{bitDepth:[8,16]}),1===this.components)return new Kp([this.clone()]);let i=new Kp,n=this.data;if(this.alpha&&e)for(let t=0;t<this.components;t++){let e=tx.createFrom(this,{components:1,alpha:!0,colorModel:rp}),r=0;for(let i=0;i<n.length;i+=this.channels)e.data[r++]=n[i+t],e.data[r++]=n[i+this.components];i.push(e)}else for(let t=0;t<this.channels;t++){let e=tx.createFrom(this,{components:1,alpha:!1,colorModel:rp}),r=0;for(let i=0;i<n.length;i+=this.channels)e.data[r++]=n[i+t];i.push(e)}return i}function ry(t,e={}){let{keepAlpha:i=!1,mergeAlpha:n=!1}=e;i&=this.alpha,n&=this.alpha,this.checkProcessable("getChannel",{bitDepth:[8,16]}),t=fm(this,t);let r=tx.createFrom(this,{components:1,alpha:i,colorModel:rp}),s=0;for(let e=0;e<this.data.length;e+=this.channels)n?r.data[s++]=this.data[e+t]*this.data[e+this.components]/this.maxValue:(r.data[s++]=this.data[e+t],i&&(r.data[s++]=this.data[e+this.components]));return r}function sy(t=oy,e={}){let{mergeAlpha:i=!1,keepAlpha:n=!1}=e;i&=this.alpha,n&=this.alpha,this.checkProcessable("combineChannels",{bitDepth:[8,16]});let r=tx.createFrom(this,{components:1,alpha:n,colorModel:rp}),s=0;for(let e=0;e<this.size;e++){let o=t(this.getPixel(e));i?r.data[s++]=o*this.data[e*this.channels+this.components]/this.maxValue:(r.data[s++]=o,n&&(r.data[s++]=this.data[e*this.channels+this.components]))}return r}function oy(t){return(t[0]+t[1]+t[2])/3}function ay(t,e){if(this.checkProcessable("setChannel",{bitDepth:[8,16]}),e.checkProcessable("setChannel (image parameter check)",{bitDepth:[this.bitDepth],alpha:[0],components:[1]}),e.width!==this.width||e.height!==this.height)throw new Error("Images must have exactly the same width and height");let i=t=fm(this,t);for(let t=0;t<e.data.length;t++)this.data[i]=e.data[t],i+=this.channels;return this}function ly(t,e={}){let{shift:i=[0,0],average:n,channels:r,defaultAlpha:s,normalize:o,border:a=[0,0]}=e;if(this.checkProcessable("getSimilarity",{bitDepth:[8,16]}),Array.isArray(a)||(a=[a,a]),r=gm(this,{channels:r,defaultAlpha:s}),this.bitDepth!==t.bitDepth)throw new Error("Both images must have the same bitDepth");if(this.channels!==t.channels)throw new Error("Both images must have the same number of channels");if(this.colorModel!==t.colorModel)throw new Error("Both images must have the same colorModel");void 0===n&&(n=!0);let l=Math.max(a[0],-i[0]),h=Math.min(this.width-a[0],this.width-i[0]),c=Math.max(a[1],-i[1]),u=Math.min(this.height-a[1],this.height-i[1]),d=zm()(r.length,0);for(let e=0;e<r.length;e++){let n=r[e],s=o?this.sum[n]:Math.max(this.sum[n],t.sum[n]),a=o?t.sum[n]:Math.max(this.sum[n],t.sum[n]);if(0!==s&&0!==a)for(let r=l;r<h;r++)for(let o=c;o<u;o++){let l=r*this.multiplierX+o*this.multiplierY+n,h=l+i[0]*this.multiplierX+i[1]*this.multiplierY;d[e]+=Math.min(this.data[l]/s,t.data[h]/a)}}return n?d.reduce(((t,e)=>t+e))/d.length:d}function hy(t={}){let{sampling:e=[10,10],painted:i=!1,mask:n}=t;this.checkProcessable("getPixelsGrid",{bitDepth:[8,16],channels:1}),Array.isArray(e)||(e=[e,e]);const r=e[0],s=e[1],o=[],a=[],l=this.width/r,h=this.height/s;let c=Math.floor(l/2);for(let t=0;t<r;t++){let t=Math.floor(h/2);for(let e=0;e<s;e++){let e=Math.round(c),i=Math.round(t);n&&!n.getBitXY(e,i)||(o.push([e,i]),a.push(this.getPixelXY(e,i))),t+=h}c+=l}const u={xyS:o,zS:a};return i&&(u.painted=this.rgba8().paintPoints(o)),u}function cy(t,e,i){const n=new Array(t);for(let i=0;i<t;i++)n[i]=new Array(e);if(i)for(let r=0;r<t;r++)for(let t=0;t<e;t++)n[r][t]=i;return n.width=t,n.height=e,Object.setPrototypeOf(n,cy.prototype),n}function uy(t,e={}){let{border:i}=e;if(this.checkProcessable("getChannel",{bitDepth:[8,16]}),this.bitDepth!==t.bitDepth)throw new Error("Both images must have the same bitDepth");if(this.channels!==t.channels)throw new Error("Both images must have the same number of channels");if(this.colorModel!==t.colorModel)throw new Error("Both images must have the same colorModel");let n=new cy(t.width,t.height,-1/0),r=Math.floor(t.width/2),s=Math.floor(t.height/2),o=r,a=s,l=!1;for(;!l;){let e=n.localSearch(r,s,-1/0);for(let r=0;r<e.length;r++){let s=e[r],l=this.getSimilarity(t,{border:i,shift:[o-s[0],a-s[1]]});n[s[0]][s[1]]=l}let h=n.localMax(r,s);h.position[0]!==r||h.position[1]!==s?(r=h.position[0],s=h.position[1]):l=!0}return[r-o,s-a]}function dy(t,e=0){this.checkProcessable("getRow",{bitDepth:[8,16]}),function(t,e){if(e<0||e>=t.height)throw new RangeError(`row must be included between 0 and ${t.height-1}. Current value: ${e}`)}(this,t),S_(this,e);let i=new Array(this.width),n=0,r=t*this.width*this.channels+e,s=r+this.width*this.channels;for(let t=r;t<s;t+=this.channels)i[n++]=this.data[t];return i}function gy(t,e=0){this.checkProcessable("getColumn",{bitDepth:[8,16]}),function(t,e){if(e<0||e>=t.width)throw new RangeError(`column must be included between 0 and ${t.width-1}. Current value: ${e}`)}(this,t),S_(this,e);let i=new Array(this.height),n=0,r=this.width*this.channels;for(let s=e+t*this.channels;s<this.data.length;s+=r)i[n++]=this.data[s];return i}function fy(t={}){let{channel:e}=t;if(this.checkProcessable("getMatrix",{bitDepth:[8,16]}),void 0===e){if(this.components>1)throw new RangeError("You need to define the channel for an image that contains more than one channel");e=0}let i=new Tm(this.height,this.width);for(let t=0;t<this.height;t++)for(let n=0;n<this.width;n++)i.set(t,n,this.getValueXY(n,t,e));return i}function py(t,e={}){t=new Tm(t);let{channel:i}=e;if(this.checkProcessable("getMatrix",{bitDepth:[8,16]}),void 0===i){if(this.components>1)throw new RangeError("You need to define the channel for an image that contains more than one channel");i=0}if(this.width!==t.columns||this.height!==t.rows)throw new RangeError("The size of the matrix must be equal to the size of the image");for(let e=0;e<this.height;e++)for(let n=0;n<this.width;n++)this.setValueXY(n,e,i,t.get(e,n));return this}function my(){this.checkProcessable("getPixelsArray",{bitDepth:[8,16,32]});let t=new Array(this.size),e=0;for(let i=0;i<this.data.length;i+=this.channels){let n=new Array(this.components);for(let t=0;t<this.components;t++)n[t]=this.data[i+t];t[e++]=n}return t}function _y(t){let e=this,i=e.getClosestCommonParent(t),n=e.getRelativePosition(i,{defaultFurther:!0}),r=yy(e,n),s=t.getRelativePosition(i,{defaultFurther:!0}),o=yy(t,s),a=function(t,e){let i=0,n=0,r=[];for(;i<t.length&&n<e.length;)t[i][0]===e[n][0]&&t[i][1]===e[n][1]?(r.push(t[i]),i++,n++):t[i][0]<e[n][0]||t[i][0]===e[n][0]&&t[i][1]<e[n][1]?i++:n++;return r}(r,o),l={whitePixelsMask1:[],whitePixelsMask2:[],commonWhitePixels:[]};for(let i=0;i<a.length;i++){let r=a[i],o=[r[0]-n[0],r[1]-n[1]],h=[r[0]-s[0],r[1]-s[1]],c=e.getBitXY(o[0],o[1]),u=t.getBitXY(h[0],h[1]);1===c&&1===u&&l.commonWhitePixels.push(r)}for(let t=0;t<r.length;t++){let i,n;0!==t&&(i=Math.floor(t/e.width),n=t%e.width),1===e.getBitXY(i,n)&&l.whitePixelsMask1.push(r[t])}for(let e=0;e<o.length;e++){let i=0,n=0;0!==e&&(i=Math.floor(e/t.width),n=e%t.width),1===t.getBitXY(i,n)&&l.whitePixelsMask2.push(o[e])}return l}function yy(t,e){let i=[];for(let n=0;n<t.height;n++)for(let r=0;r<t.width;r++){let t=[n,r];i.push([t[0]+e[0],t[1]+e[1]])}return i}function wy(t){let e,i=xy(this),n=xy(t);if(e=i>=n?by(this,i):by(t,n),0===i||0===n)return e;let r=this,s=t;for(;i!==n;)if(i>n){if(r=r.parent,null===r)return e;i-=1}else{if(s=s.parent,null===s)return e;n-=1}for(;r!==s&&null!==r&&null!==s;)if(r=r.parent,s=s.parent,null===r||null===s)return e;return r!==s?e:r}function xy(t){let e=0,i=t;for(;null!=i.parent;)i=i.parent,e++;return e}function by(t,e){let i=t;for(;e>0;)i=i.parent,e-=1;return i}cy.prototype.localMin=function(t,e){let i=this[t][e],n=[t,e];for(let r=Math.max(0,t-1);r<Math.min(this.length,t+2);r++)for(let t=Math.max(0,e-1);t<Math.min(this[0].length,e+2);t++)this[r][t]<i&&(i=this[r][t],n=[r,t]);return{position:n,value:i}},cy.prototype.localMax=function(t,e){let i=this[t][e],n=[t,e];for(let r=Math.max(0,t-1);r<Math.min(this.length,t+2);r++)for(let t=Math.max(0,e-1);t<Math.min(this[0].length,e+2);t++)this[r][t]>i&&(i=this[r][t],n=[r,t]);return{position:n,value:i}},cy.prototype.localSearch=function(t,e,i){let n=[];for(let r=Math.max(0,t-1);r<Math.min(this.length,t+2);r++)for(let t=Math.max(0,e-1);t<Math.min(this[0].length,e+2);t++)this[r][t]===i&&n.push([r,t]);return n};const vy={lowThreshold:10,highThreshold:30,gaussianBlur:1.1},Ey=[[-1,0,1],[-2,0,2],[-1,0,1]],Sy=[[-1,-2,-1],[0,0,0],[1,2,1]],Iy={bitDepth:32,mode:"periodic"};function My(t){return function(t,e){t.checkProcessable("Canny edge detector",{bitDepth:8,channels:1,components:1}),e=Object.assign({},vy,e);const i=t.width,n=t.height,r=t.maxValue,s={sigma:e.gaussianBlur,radius:3},o=t.gaussianFilter(s),a=o.convolution(Sy,Iy),l=o.convolution(Ey,Iy),h=l.hypotenuse(a),c=t.constructor,u=new c(i,n,{kind:"GREY",bitDepth:32}),d=new c(i,n,{kind:"GREY",bitDepth:32}),g=new c(i,n,{kind:"GREY"});for(var f=1;f<i-1;f++)for(var p=1;p<n-1;p++){var m=(Math.round(Math.atan2(l.getValueXY(f,p,0),a.getValueXY(f,p,0))*(5/Math.PI))+5)%5;0===m&&(h.getValueXY(f,p,0)<=h.getValueXY(f,p-1,0)||h.getValueXY(f,p,0)<=h.getValueXY(f,p+1,0))||1===m&&(h.getValueXY(f,p,0)<=h.getValueXY(f-1,p+1,0)||h.getValueXY(f,p,0)<=h.getValueXY(f+1,p-1,0))||2===m&&(h.getValueXY(f,p,0)<=h.getValueXY(f-1,p,0)||h.getValueXY(f,p,0)<=h.getValueXY(f+1,p,0))||3===m&&(h.getValueXY(f,p,0)<=h.getValueXY(f-1,p-1,0)||h.getValueXY(f,p,0)<=h.getValueXY(f+1,p+1,0))||u.setValueXY(f,p,0,h.getValueXY(f,p,0))}for(f=0;f<i*n;++f){var _=u.data[f],y=0;_>e.highThreshold&&(y++,g.data[f]=r),_>e.lowThreshold&&y++,d.data[f]=y}var w=[];for(f=1;f<i-1;++f)for(p=1;p<n-1;++p)if(1===d.getValueXY(f,p,0))t:for(var x=f-1;x<f+2;++x)for(var b=p-1;b<p+2;++b)if(2===d.getValueXY(x,b,0)){w.push([f,p]),g.setValueXY(f,p,0,r);break t}for(;w.length>0;){var v=[];for(f=0;f<w.length;++f)for(p=-1;p<2;++p)for(x=-1;x<2;++x)if(0!==p||0!==x){var E=w[f][0]+p,S=w[f][1]+x;1===d.getValueXY(E,S,0)&&0===g.getValueXY(E,S,0)&&(v.push([E,S]),g.setValueXY(E,S,0,r))}w=v}return g}(this,t)}function Cy(t,e={}){let{position:i}=e;if(this.checkProcessable("extract",{bitDepth:[1,8,16]}),!i&&(i=t.getRelativePosition(this),!i))throw new Error("extract : can not extract an image because the relative position can not be determined, try to specify manually the position as an array of 2 elements [x,y].");if(this.bitDepth>1){let e=tx.createFrom(this,{width:t.width,height:t.height,alpha:1,position:i,parent:this});for(let n=0;n<t.width;n++)for(let r=0;r<t.height;r++){for(let t=0;t<this.channels;t++){let s=this.getValueXY(n+i[0],r+i[1],t);e.setValueXY(n,r,t,s)}t.getBitXY(n,r)||e.setValueXY(n,r,this.components,0)}return e}{let e=tx.createFrom(this,{width:t.width,height:t.height,position:i,parent:this});for(let n=0;n<t.height;n++)for(let r=0;r<t.width;r++)t.getBitXY(r,n)&&this.getBitXY(r+i[0],n+i[1])&&e.setBitXY(r,n);return e}}var Ty=__webpack_require__(8737),Ry=__webpack_require__.n(Ty);function Ay(t={}){const{x:e=0,y:i=0,inPlace:n=!0}=t,r=n?this:tx.createFrom(this);if(this.checkProcessable("floodFill",{bitDepth:1}),this.getBitXY(e,i))return r;const s=new(Ry());for(s.push(new ky(e,i));s.length>0;){const t=s.shift();r.setBitXY(t.x,t.y);for(let e=t.x+1;e<this.width&&!r.getBitXY(e,t.y)&&!this.getBitXY(e,t.y);e++)r.setBitXY(e,t.y),t.y+1<this.height&&!this.getBitXY(e,t.y+1)&&s.push(new ky(e,t.y+1)),t.y-1>=0&&!this.getBitXY(e,t.y-1)&&s.push(new ky(e,t.y-1));for(let e=t.x-1;e>=0&&!r.getBitXY(e,t.y)&&!this.getBitXY(e,t.y);e++)r.setBitXY(e,t.y),t.y+1<this.height&&!this.getBitXY(e,t.y+1)&&s.push(new ky(e,t.y+1)),t.y-1>=0&&!this.getBitXY(e,t.y-1)&&s.push(new ky(e,t.y-1))}return r}function ky(t,e){this.x=t,this.y=e}function Py(){return Py=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},Py.apply(this,arguments)}function Ly(t,e,i){var n=function(t,e,i){return{h:t,s:2*(e*=(i<50?i:100-i)/100)/(i+e)*100,v:i+e}}(t,e,i);return function(t,e,i){var n,r=(i/=100)*(e/=100),s=t/60,o=r*(1-Math.abs(s%2-1)),a=i-r;return n=s>=0&&s<1?[r,o,0]:s>=1&&s<2?[o,r,0]:s>=2&&s<3?[0,r,o]:t>=3&&s<4?[0,o,r]:t>=4&&s<5?[o,0,r]:t>=5&&s<=6?[r,0,o]:[0,0,0],{r:Math.round(255*(n[0]+a)),g:Math.round(255*(n[1]+a)),b:Math.round(255*(n[2]+a))}}(n.h,n.s,n.v)}var Ny={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]};function Dy(t){let e=function(t){var e=Ny[t.toLowerCase()];if(e)return{r:e[0],g:e[1],b:e[2],a:100}}(i=t)||function(t){if("#"===t[0]&&4===t.length)return{r:parseInt(t[1]+t[1],16),g:parseInt(t[2]+t[2],16),b:parseInt(t[3]+t[3],16),a:100}}(i)||function(t){if("#"===t[0]&&7===t.length)return{r:parseInt(t.slice(1,3),16),g:parseInt(t.slice(3,5),16),b:parseInt(t.slice(5,7),16),a:100}}(i)||function(t){var e=t.match(/rgb\(([^)]+)\)/);if(e){var i=e[1].split(/ *, */).map(Number);return{r:i[0],g:i[1],b:i[2],a:100}}}(i)||function(t){var e=t.match(/rgba\(([^)]+)\)/);if(e){var i=e[1].split(/ *, */).map(Number);return{r:i[0],g:i[1],b:i[2],a:100*i[3]}}}(i)||function(t){var e=t.match(/hsl\(([^)]+)\)/);if(e){var i=e[1].split(/ *, */);return Py({},Ly(parseInt(i[0],10),parseInt(i[1],10),parseInt(i[2],10)),{a:100})}}(i)||function(t){var e=t.match(/hsla\(([^)]+)\)/);if(e){var i=e[1].split(/ *, */),n=parseInt(i[0],10),r=parseInt(i[1],10),s=parseInt(i[2],10),o=parseInt(100*parseFloat(i[3]),10);return Py({},Ly(n,r,s),{a:o})}}(i);var i;return[e.r,e.g,e.b,Math.round(255*e.a/100)]}function Oy(t,e,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?t+6*(e-t)*i:i<.5?e:i<2/3?t+(e-t)*(2/3-i)*6:t}function Fy(t,e,i){let n,r,s,o,a,l;return i/=100,0==(e/=100)?o=a=l=255*i:(r=i<=.5?i*(e+1):i+e-i*e,n=2*i-r,s=t/360,o=Oy(n,r,s+1/3),a=Oy(n,r,s),l=Oy(n,r,s-1/3)),{r:o,g:a,b:l}}function zy(t){let{color:e,colors:i,randomColors:n,numberColors:r=50}=t;if(e&&!Array.isArray(e)&&(e=Dy(e)),e)return[e];if(i)return i=i.map((function(t){return Array.isArray(t)?t:Dy(t)})),i;if(n){i=new Array(r);for(let t=0;t<r;t++)i[t]=[Math.floor(256*Math.random()),Math.floor(256*Math.random()),Math.floor(256*Math.random())]}return function(t){let e=new Array(t),i=0;for(let n=0;n<360;n+=360/t){i++;let t=Fy(n,100,30+i%4*15);e[i-1]=[Math.round(255*t.r),Math.round(255*t.g),Math.round(255*t.b)]}return e}(r)}function By(t,e,i={}){let{color:n="blue",colors:r,font:s="12px Helvetica",rotate:o=0}=i;if(this.checkProcessable("paintMasks",{channels:[3,4],bitDepth:[8,16],colorModel:sp}),!Array.isArray(t))throw Error("paintLabels: labels must be an array");if(!Array.isArray(e))throw Error("paintLabels: positions must be an array");if(n&&!Array.isArray(n)&&(n=Dy(n)),r=r?r.map((function(t){return Array.isArray(t)?t:Dy(t)})):[n],t.length!==e.length)throw Error("paintLabels: positions and labels must be arrays from the same size");Array.isArray(s)||(s=[s]),Array.isArray(o)||(o=[o]);let a=this.getCanvas().getContext("2d");for(let i=0;i<t.length;i++){a.save();let n=r[i%r.length];a.fillStyle=`rgba(${n[0]},${n[1]},${n[2]},${n[3]/this.maxValue})`,a.font=s[i%s.length];let l=e[i];a.translate(l[0],l[1]),a.rotate(o[i%o.length]/180*Math.PI),a.fillText(t[i],0,0),a.restore()}return this.data=Uint8Array.from(a.getImageData(0,0,this.width,this.height).data),this}function Gy(t,e={}){let{alpha:i=255,labels:n=[],labelsPosition:r=[],labelColor:s="blue",labelFont:o="12px Helvetica"}=e;this.checkProcessable("paintMasks",{channels:[3,4],bitDepth:[8,16],colorModel:sp});let a=zy(Object.assign({},e,{numberColors:t.length}));Array.isArray(t)||(t=[t]);for(let e=0;e<t.length;e++){let n=t[e],r=a[e%a.length];for(let t=0;t<n.width;t++)for(let e=0;e<n.height;e++)if(n.getBitXY(t,e))for(let s=0;s<Math.min(this.components,r.length);s++)if(255===i)this.setValueXY(t+n.position[0],e+n.position[1],s,r[s]);else{let o=this.getValueXY(t+n.position[0],e+n.position[1],s);o=Math.round((o*(255-i)+r[s]*i)/255),this.setValueXY(t+n.position[0],e+n.position[1],s,o)}}if(Array.isArray(n)&&n.length>0){let e=this.getCanvas().getContext("2d");e.fillStyle=s,e.font=o;for(let i=0;i<Math.min(t.length,n.length);i++){let s=r[i]?r[i]:t[i].position;e.fillText(n[i],s[0],s[1])}this.data=Uint8Array.from(e.getImageData(0,0,this.width,this.height).data)}return this}function Yy(t,e){let i=new Array(t);for(let n=0;n<t;n++)i[n]=new Array(e).fill(0);return i}const Uy=[[0,0,1,0,0],[0,0,1,0,0],[1,1,1,1,1],[0,0,1,0,0],[0,0,1,0,0]],Xy=[[0,1,0],[1,1,1],[0,1,0]];class qy{constructor(t={}){let{kind:e="cross",shape:i,size:n,width:r,height:s,filled:o=!0}=t;if(n&&(r=n,s=n),i)switch(i.toLowerCase()){case"square":case"rectangle":this.matrix=function(t,e,i){const n=Yy(e,t);if(i.filled)for(let i=0;i<e;i++)for(let e=0;e<t;e++)n[i][e]=1;else{for(let i of[0,e-1])for(let e=0;e<t;e++)n[i][e]=1;for(let i=0;i<e;i++)for(let e of[0,t-1])n[i][e]=1}return n}(r,s,{filled:o});break;case"circle":case"ellipse":this.matrix=function(t,e,i){const n=Yy(e,t);let r=1-e%2,s=1-t%2,o=Math.floor((t-1)/2),a=Math.floor((e-1)/2),l=o*o,h=a*a;if(i.filled)for(let e=0;e<=a;e++)for(let i=o-Math.floor(Math.sqrt(l-l*e*e/h));i<=o;i++)n[a-e][i]=1,n[a+e+r][i]=1,n[a-e][t-i-1]=1,n[a+e+r][t-i-1]=1;else{for(let e=0;e<=a;e++){let i=o-Math.floor(Math.sqrt(l-l*e*e/h));n[a-e][i]=1,n[a+e+r][i]=1,n[a-e][t-i-1]=1,n[a+e+r][t-i-1]=1}for(let t=0;t<=o;t++){let i=a-Math.floor(Math.sqrt(h-h*t*t/l));n[i][o-t]=1,n[i][o+t+s]=1,n[e-i-1][o-t]=1,n[e-i-1][o+t+s]=1}}return n}(r,s,{filled:o});break;case"triangle":this.matrix=function(t,e,i){if(!i.filled)throw new Error("Non filled triangle is not implemented");const n=Yy(e,t);for(let i=0;i<e;i++){let r=Math.floor((1-i/e)*t/2);for(let e=r;e<t-r;e++)n[i][e]=1}return n}(r,s,{filled:o});break;default:throw new Error(`Shape: unexpected shape: ${i}`)}else{if(!e)throw new Error("Shape: expected a kind or a shape option");switch(e.toLowerCase()){case"cross":this.matrix=Uy;break;case"smallcross":this.matrix=Xy;break;default:throw new Error(`Shape: unexpected kind: ${e}`)}}this.height=this.matrix.length,this.width=this.matrix[0].length,this.halfHeight=this.height/2>>0,this.halfWidth=this.width/2>>0}getPoints(){let t=this.matrix,e=[];for(let i=0;i<t.length;i++)for(let n=0;n<t[0].length;n++)t[i][n]&&e.push([n-this.halfWidth,i-this.halfHeight]);return e}getMask(){let t=new tx(this.width,this.height,{kind:hp});for(let e=0;e<this.matrix.length;e++)for(let i=0;i<this.matrix[0].length;i++)this.matrix[e][i]&&t.setBitXY(i,e);return t}}function Vy(t,e={}){let{shape:i}=e;this.checkProcessable("paintPoints",{bitDepth:[8,16]});let n=zy(Object.assign({},e,{numberColors:t.length})),r=new qy(i).getPoints(),s=Math.min(this.channels,n[0].length);for(let e=0;e<t.length;e++){let i=n[e%n.length],o=t[e][0],a=t[e][1];for(let t=0;t<r.length;t++){let e=r[t][0],n=r[t][1];if(o+e>=0&&a+n>=0&&o+e<this.width&&a+n<this.height){let t=(o+e+(a+n)*this.width)*this.channels;for(let e=0;e<s;e++)this.data[t+e]=i[e]}}}return this}function jy(t,e={}){let{color:i=[this.maxValue,0,0],closed:n=!1}=e;this.checkProcessable("paintPoints",{bitDepth:[1,8,16]});let r=Math.min(this.channels,i.length);for(let e=0;e<t.length-1+n;e++){let n=t[e],s=t[(e+1)%t.length],o=s[0]-n[0],a=s[1]-n[1],l=Math.max(Math.abs(o),Math.abs(a)),h=o/l,c=a/l,u=n[0],d=n[1];for(let t=0;t<=l;t++){let t=Math.round(u),e=Math.round(d);if(t>=0&&e>=0&&t<this.width&&e<this.height)if(1===this.bitDepth)this.setBitXY(t,e);else{let n=(t+e*this.width)*this.channels;for(let t=0;t<r;t++)this.data[n+t]=i[t]}u+=h,d+=c}}return this}function Wy(t,e={}){let i=Object.assign({},e);this.checkProcessable("paintPolylines",{bitDepth:[8,16]});let n=zy(Object.assign({},e,{numberColors:t.length}));for(let e=0;e<t.length;e++)i.color=n[e%n.length],this.paintPolyline(t[e],i);return this}function Zy(t,e={}){let{color:i=[this.maxValue,0,0],filled:n=!1}=e;this.checkProcessable("paintPoints",{bitDepth:[1,8,16]}),e.closed=!0;let r=function(t){let e=[];for(let i=0;i<t.length;i++)t[i][0]===t[(i+1)%t.length][0]&&t[i][1]===t[(i+1)%t.length][1]||t[i][0]===t[(i-1+t.length)%t.length][0]&&t[i][1]===t[(i-1+t.length)%t.length][1]||t[(i+1)%t.length][0]===t[(i-1+t.length)%t.length][0]&&t[(i-1+t.length)%t.length][1]===t[(i+1)%t.length][1]||e.push(t[i]);return e}(t);if(!1===n)return this.paintPolyline(t,e);{let n=Array(this.height);for(let t=0;t<this.height;t++){n[t]=[];for(let e=0;e<this.width;e++)n[t].push(0)}for(let t=0;t<r.length;t++){const e=Hy(r[t],r[(t+1)%r.length]);for(let t=0;t<this.height;t++)for(let i=0;i<this.width;i++)Ky(i,t,e,this.height)&&(n[t][i]=0===n[t][i]?1:0)}for(let t=0;t<this.height;t++)for(let e=0;e<this.width;e++)if(1===n[t][e])if(1===this.bitDepth)this.setBitXY(e,t);else{let n=Math.min(this.channels,i.length),r=(e+t*this.width)*this.channels;for(let t=0;t<n;t++)this.data[r+t]=i[t]}return this.paintPolyline(t,e)}}function Hy(t,e){if(t[0]===e[0])return{a:0,b:t[0],vertical:!0};{const i=(e[1]-t[1])/(e[0]-t[0]);return{a:i,b:t[1]-i*t[0],vertical:!1}}}function Ky(t,e,i,n){if(!0===i.vertical)return i.b<=t;if(0===i.a)return!1;{const r=(e-i.b)/i.a;return r<t&&r>=0&&r<=n}}function $y(t,e={}){let i=Object.assign({},e);this.checkProcessable("paintPolygons",{bitDepth:[8,16]});let n=zy(Object.assign({},e,{numberColors:t.length}));for(let e=0;e<t.length;e++)i.color=n[e%n.length],this.paintPolygon(t[e],i);return this}function Jy(t={}){let{maxSlots:e=256,channel:i,useAlpha:n=!0}=t;if(this.checkProcessable("getHistogram",{bitDepth:[1,8,16]}),void 0===i){if(this.components>1)throw new RangeError("You need to define the channel for an image that contains more than one channel");i=0}return tw.call(this,i,{useAlpha:n,maxSlots:e})}function Qy(t={}){const{maxSlots:e=256,useAlpha:i=!0}=t;this.checkProcessable("getHistograms",{bitDepth:[8,16]});let n=new Array(i?this.components:this.channels);for(let t=0;t<n.length;t++)n[t]=tw.call(this,t,{useAlpha:i,maxSlots:e});return n}function tw(t,e){let{useAlpha:i,maxSlots:n}=e;if(1===this.bitDepth){let t=[0,0];for(let e=0;e<this.height;e++)for(let i=0;i<this.width;i++){let n=this.getBitXY(e,i);0===n?t[0]+=1:1===n&&(t[1]+=1)}return t}let r=Math.log2(n);if(!Em()(r))throw new RangeError("maxSlots must be a power of 2, for example: 64, 256, 1024");let s=0;this.bitDepth>r&&(s=this.bitDepth-r);let o=this.data,a=zm()(Math.pow(2,Math.min(this.bitDepth,r)),0);if(i&&this.alpha){let e=this.channels-t-1;for(let i=t;i<o.length;i+=this.channels)a[o[i]>>s]+=o[i+e]/this.maxValue}else for(let e=t;e<o.length;e+=this.channels)a[o[e]>>s]++;return a}function ew(t={}){let{useAlpha:e=!0,nbSlots:i=512}=t;this.checkProcessable("getColorHistogram",{bitDepth:[8,16],components:[3]});let n=Math.log(i)/Math.log(8);if(n!==Math.floor(n))throw new RangeError("nbSlots must be a power of 8. Usually 8, 64, 512 or 4096");let r=this.bitDepth-n,s=this.data,o=zm()(Math.pow(8,n),0),a=Math.pow(2,2*n),l=Math.pow(2,n);for(let t=0;t<s.length;t+=this.channels){let i=(s[t]>>r)*a+(s[t+1]>>r)*l+(s[t+2]>>r);e&&this.alpha?o[i]+=s[t+this.channels-1]/this.maxValue:o[i]++}return o}function iw(){this.checkProcessable("min",{bitDepth:[8,16,32]});let t=zm()(this.channels,1/0);for(let e=0;e<this.data.length;e+=this.channels)for(let i=0;i<this.channels;i++)this.data[e+i]<t[i]&&(t[i]=this.data[e+i]);return t}function nw(){this.checkProcessable("max",{bitDepth:[8,16,32]});let t=zm()(this.channels,-1/0);for(let e=0;e<this.data.length;e+=this.channels)for(let i=0;i<this.channels;i++)this.data[e+i]>t[i]&&(t[i]=this.data[e+i]);return t}function rw(){this.checkProcessable("sum",{bitDepth:[8,16]});let t=zm()(this.channels,0);for(let e=0;e<this.data.length;e+=this.channels)for(let i=0;i<this.channels;i++)t[i]+=this.data[e+i];return t}function sw(t=0,e=0){this.checkProcessable("getMoment",{bitDepth:[1]});let i=0;for(let n=0;n<this.width;n++)for(let r=0;r<this.height;r++)1===this.getBitXY(n,r)&&(i+=n**t*r**e);return i}function ow(t={}){let{mask:e,region:i=3,removeClosePoints:n=0,invert:r=!1,maxEquals:s=2}=t,o=this;this.checkProcessable("localMaxima",{bitDepth:[8,16],components:1}),i*=4;let a=r?0:1,l=[1,0,-1,0,1,1,-1,-1,2,0,-2,0,2,2,-2,-2],h=[0,1,0,-1,1,-1,1,-1,0,2,0,-2,2,-2,2,-2],c=i<=8?1:2,u=[];for(let t=c;t<o.height-c;t++)for(let n=c;n<o.width-c;n++){if(e&&e.getBitXY(n,t)!==a)continue;let c=0,d=0,g=o.data[n+t*o.width];for(let e=0;e<i;e++)r?o.data[n+l[e]+(t+h[e])*o.width]>g&&c++:o.data[n+l[e]+(t+h[e])*o.width]<g&&c++,o.data[n+l[e]+(t+h[e])*o.width]===g&&d++;c+d===i&&d<=s&&u.push([n,t])}if(n>0)for(let t=0;t<u.length;t++)for(let e=t+1;e<u.length;e++)Math.sqrt(Math.pow(u[t][0]-u[e][0],2)+Math.pow(u[t][1]-u[e][1],2))<n&&(u[t][0]=u[t][0]+u[e][0]>>1,u[t][1]=u[t][1]+u[e][1]>>1,u.splice(e,1),e--);return u}function aw(){let t=this.getHistograms({maxSlots:this.maxValue+1}),e=new Array(t.length);for(let i=0;i<t.length;i++){let n=t[i];e[i]=Up(n)}return e}function lw(){let t=this.getHistograms({maxSlots:this.maxValue+1}),e=new Array(t.length);for(let i=0;i<t.length;i++){let n=t[i];e[i]=Yp(n)}return e}function hw(){this.checkProcessable("points",{bitDepth:[1]});const t=[];for(let e=0;e<this.width;e++)for(let i=0;i<this.height;i++)1===this.getBitXY(e,i)&&t.push([e,i]);return t}function cw(){this.checkProcessable("extendedPoints",{bitDepth:[1]});const t=[];for(let e=0;e<this.height;e++)for(let i=0;i<this.width;i++)if(1===this.getBitXY(i,e))for(t.push([i,e]),1!==this.getBitXY(i+1,e)?(t.push([i+1,e]),t.push([i+1,e+1]),1!==this.getBitXY(i,e+1)&&t.push([i,e+1])):1!==this.getBitXY(i,e+1)&&(t.push([i,e+1]),t.push([i+1,e+1]));i<this.width-2&&1===this.getBitXY(i+1,e)&&1===this.getBitXY(i+2,e);)i++;return t}function uw(t,e={}){if(this===t)return[0,0];let i=[0,0],n=this;for(;n;){if(n===t)return i;n.position&&(i[0]+=n.position[0],i[1]+=n.position[1]),n=n.parent}return!!e.defaultFurther&&i}function dw(t={}){let{alpha:e=1}=t;this.checkProcessable("countAlphaPixels",{bitDepth:[8,16],alpha:1});let i=0;if(void 0!==e){for(let t=this.components;t<this.data.length;t+=this.channels)this.data[t]===e&&i++;return i}return this.size}function gw(t,e={}){const{sorted:i}=e;i||(t=t.slice().sort(pw));const n=t.length,r=new Array(2*n);let s=0;for(let e=0;e<n;e++){const i=t[e];for(;s>=2&&fw(r[s-2],r[s-1],i)<=0;)s--;r[s++]=i}const o=s+1;for(let e=n-2;e>=0;e--){const i=t[e];for(;s>=o&&fw(r[s-2],r[s-1],i)<=0;)s--;r[s++]=i}return r.slice(0,s-1)}function fw(t,e,i){return(e[1]-t[1])*(i[0]-t[0])-(e[0]-t[0])*(i[1]-t[1])}function pw(t,e){return t[0]===e[0]?t[1]-e[1]:t[0]-e[0]}function mw(){return gw(this.extendedPoints,{sorted:!1})}function _w(t,e){return[t[0]-e[0],t[1]-e[1]]}function yw(t){let e=Math.sqrt(t[0]**2+t[1]**2);return[t[0]/e,t[1]/e]}function ww(t,e,i){void 0===i&&(i=new Array(e.length));let n=Math.cos(t),r=Math.sin(t);for(let t=0;t<i.length;++t)i[t]=[n*e[t][0]-r*e[t][1],r*e[t][0]+n*e[t][1]];return i}function xw(t){let e=0;for(let i=0;i<t.length;i++){let n=t[i][0],r=t[i][1],s=t[i===t.length-1?0:i+1][0],o=t[i===t.length-1?0:i+1][1];e+=Math.sqrt((s-n)**2+(o-r)**2)}return e}function bw(t){let e=0;for(let i=0;i<t.length;i++)e+=t[i][0]*t[i===t.length-1?0:i+1][1]*.5,e-=t[i===t.length-1?0:i+1][0]*t[i][1]*.5;return Math.abs(e)}function vw(t){let e=1/0,i=1/0,n=-1/0,r=-1/0;for(let s=0;s<t.length;s++)t[s][0]<e&&(e=t[s][0]),t[s][0]>n&&(n=t[s][0]),t[s][1]<i&&(i=t[s][1]),t[s][1]>r&&(r=t[s][1]);return[[e,i],[n,r]]}function Ew(t={}){const{originalPoints:e=mw.call(this)}=t;if(0===e.length)return[];if(1===e.length)return[e[0],e[0],e[0],e[0]];const i=new Array(e.length);let n,r=1/0,s=0;for(let t=0;t<i.length;t++){let o=Sw(e[t],e[(t+1)%i.length]);ww(-o,e,i);let a=i[t][0],l=i[t][1],h=i[(t+1)%i.length][0],c=i[(t+1)%i.length][1],u=!0,d=0,g=0,f=0;for(let t=0;t<i.length;t++){let e=(i[t][0]-a)/(h-a);!0===u?(u=!1,d=e,g=e):(e<d&&(d=e),e>g&&(g=e));let n=(-(h-a)*i[t][1]+h*l-c*a)/(h-a);Math.abs(n)>Math.abs(f)&&(f=n)}let p=[a+d*(h-a),l],m=[a+g*(h-a),l],_=Math.abs(f*(d-g)*(h-a));_<r&&(s=o,r=_,n=[p,m,[m[0],m[1]-f],[p[0],p[1]-f]])}return ww(s,n,n),n}function Sw(t,e){let i=yw(_w(e,t)),n=Math.acos(i[0]);return i[1]<0?-n:n}var Iw=__webpack_require__(2229),Mw=__webpack_require__.n(Iw),Cw=__webpack_require__(4707),Tw=__webpack_require__.n(Cw);function Rw(t,e){let i=yw(_w(e,t)),n=Math.acos(i[0]);return i[1]<0?-n:n}class Aw{constructor(t,e){this.map=t,this.id=e,this.minX=Number.POSITIVE_INFINITY,this.maxX=Number.NEGATIVE_INFINITY,this.minY=Number.POSITIVE_INFINITY,this.maxY=Number.NEGATIVE_INFINITY,this.meanX=0,this.meanY=0,this.surface=0,this.computed={}}getMask(t={}){const{scale:e=1,kind:i=""}=t;let n;switch(i){case"contour":n=this.contourMask;break;case"box":n=this.boxMask;break;case"filled":n=this.filledMask;break;case"center":n=this.centerMask;break;case"mbr":n=this.mbrFilledMask;break;case"hull":n=this.convexHullFilledMask;break;case"hullContour":n=this.convexHullMask;break;case"mbrContour":n=this.mbrMask;break;case"feret":n=this.feretMask;break;default:n=this.mask}return e<1&&(n=n.resize({factor:e}),n.parent=this.mask.parent,n.position[0]+=this.minX,n.position[1]+=this.minY),n}get mean(){throw new Error("Roi mean not implemented yet")}get center(){return this.computed.center||(this.computed.center=[this.width/2>>0,this.height/2>>0]),this.computed.center}get ratio(){return this.width/this.height}get width(){return this.maxX-this.minX+1}get height(){return this.maxY-this.minY+1}_computExternalIDs(){let t=this.borderIDs,e=this.borderLengths;this.computed.externalIDs=[],this.computed.externalLengths=[];let i=this.internalIDs;for(let n=0;n<t.length;n++)i.includes(t[n])||(this.computed.externalIDs.push(t[n]),this.computed.externalLengths.push(e[n]))}get externalIDs(){return this.computed.externalIDs||this._computExternalIDs(),this.computed.externalIDs}get externalLengths(){return this.computed.externalLengths||this._computExternalIDs(),this.computed.externalLengths}_computeBorderIDs(){let t=function(t){let e=t.map,i=e.data,n=new Set,r=new Map,s=new Set,o=[1,0,-1,0],a=[0,1,0,-1];for(let l=t.minX;l<=t.maxX;l++)for(let h=t.minY;h<=t.maxY;h++)if(i[l+h*e.width]===t.id)for(let c=0;c<4;c++){let u=l+o[c],d=h+a[c];if(u>=0&&d>=0&&u<e.width&&d<e.height){let o=u+d*e.width;if(i[o]!==t.id&&!s.has(o)){s.add(o),n.add(i[o]);let t=r.get(i[o]);t?r.set(i[o],++t):r.set(i[o],1)}}}let l=Array.from(n),h=l.map((function(t){return r.get(t)}));return{ids:l,lengths:h}}(this);this.computed.borderIDs=t.ids,this.computed.borderLengths=t.lengths}get borderIDs(){return this.computed.borderIDs||this._computeBorderIDs(),this.computed.borderIDs}get borderLengths(){return this.computed.borderLengths||this._computeBorderIDs(),this.computed.borderLengths}get boxIDs(){return this.computed.boxIDs||(this.computed.boxIDs=function(t){let e=new Set,i=t.map,n=i.data;for(let r of[0,t.height-1])for(let s=0;s<t.width;s++){let o=(r+t.minY)*i.width+s+t.minX;if(s-t.minX>0&&n[o]===t.id&&n[o-1]!==t.id){let t=n[o-1];e.add(t)}if(i.width-s-t.minX>1&&n[o]===t.id&&n[o+1]!==t.id){let t=n[o+1];e.add(t)}}for(let r of[0,t.width-1])for(let s=0;s<t.height;s++){let o=(s+t.minY)*i.width+r+t.minX;if(s-t.minY>0&&n[o]===t.id&&n[o-i.width]!==t.id){let t=n[o-i.width];e.add(t)}if(i.height-s-t.minY>1&&n[o]===t.id&&n[o+i.width]!==t.id){let t=n[o+i.width];e.add(t)}}return Array.from(e)}(this)),this.computed.boxIDs}get internalIDs(){return this.computed.internalIDs||(this.computed.internalIDs=function(t){let e=[t.id],i=t.map,n=i.data;if(t.height>2)for(let r=0;r<t.width;r++){let s=t.minY*i.width+r+t.minX;if(e.includes(n[s])){let r=n[s+i.width];e.includes(r)||t.boxIDs.includes(r)||e.push(r)}}let r=new Array(4);for(let s=1;s<t.width-1;s++)for(let o=1;o<t.height-1;o++){let a=(o+t.minY)*i.width+s+t.minX;if(e.includes(n[a])){r[0]=n[a-1],r[1]=n[a+1],r[2]=n[a-i.width],r[3]=n[a+i.width];for(let i=0;i<4;i++){let n=r[i];e.includes(n)||t.boxIDs.includes(n)||e.push(n)}}}return e}(this)),this.computed.internalIDs}get box(){return this.computed.box||(this.computed.box=function(t){let e=0,i=t.map,n=i.data,r=[0];t.height>1&&(r[1]=t.height-1);for(let s of r)for(let r=1;r<t.width-1;r++)n[(s+t.minY)*i.width+r+t.minX]===t.id&&e++;let s=[0];t.width>1&&(s[1]=t.width-1);for(let r of s)for(let s=0;s<t.height;s++)n[(s+t.minY)*i.width+r+t.minX]===t.id&&e++;return e}(this)),this.computed.box}get external(){return this.computed.external||(this.computed.external=function(t){let e=0,i=t.map,n=i.data;for(let r=1;r<t.width-1;r++)for(let s=1;s<t.height-1;s++){let o=(s+t.minY)*i.width+r+t.minX;n[o]===t.id&&(t.externalIDs.includes(n[o-1])||t.externalIDs.includes(n[o+1])||t.externalIDs.includes(n[o-i.width])||t.externalIDs.includes(n[o+i.width]))&&e++}return e+t.box}(this)),this.computed.external}get holesInfo(){return this.computed.holesInfo||(this.computed.holesInfo=function(t){let e=0,i=t.map.width,n=t.map.data;for(let r=1;r<t.width-1;r++)for(let s=1;s<t.height-1;s++){let o=(s+t.minY)*i+r+t.minX;t.internalIDs.includes(n[o])&&n[o]!==t.id&&e++}return{number:t.internalIDs.length-1,surface:e}}(this)),this.computed.holesInfo}get border(){return this.computed.border||(this.computed.border=function(t){let e=0,i=t.map,n=i.data;for(let r=1;r<t.width-1;r++)for(let s=1;s<t.height-1;s++){let o=(s+t.minY)*i.width+r+t.minX;n[o]===t.id&&(n[o-1]===t.id&&n[o+1]===t.id&&n[o-i.width]===t.id&&n[o+i.width]===t.id||e++)}return e+t.box}(this)),this.computed.border}get contourMask(){if(!this.computed.contourMask){let t=new tx(this.width,this.height,{kind:hp,position:[this.minX,this.minY],parent:this.map.parent});for(let e=0;e<this.width;e++)for(let i=0;i<this.height;i++)this.map.data[e+this.minX+(i+this.minY)*this.map.width]===this.id&&(e>0&&e<this.width-1&&i>0&&i<this.height-1&&this.map.data[e-1+this.minX+(i+this.minY)*this.map.width]===this.id&&this.map.data[e+1+this.minX+(i+this.minY)*this.map.width]===this.id&&this.map.data[e+this.minX+(i-1+this.minY)*this.map.width]===this.id&&this.map.data[e+this.minX+(i+1+this.minY)*this.map.width]===this.id||t.setBitXY(e,i));this.computed.contourMask=t}return this.computed.contourMask}get boxMask(){if(!this.computed.boxMask){let t=new tx(this.width,this.height,{kind:hp,position:[this.minX,this.minY],parent:this.map.parent});for(let e=0;e<this.width;e++)t.setBitXY(e,0),t.setBitXY(e,this.height-1);for(let e=0;e<this.height;e++)t.setBitXY(0,e),t.setBitXY(this.width-1,e);this.computed.boxMask=t}return this.computed.boxMask}get mask(){if(!this.computed.mask){let t=new tx(this.width,this.height,{kind:hp,position:[this.minX,this.minY],parent:this.map.parent});for(let e=0;e<this.width;e++)for(let i=0;i<this.height;i++)this.map.data[e+this.minX+(i+this.minY)*this.map.width]===this.id&&t.setBitXY(e,i);this.computed.mask=t}return this.computed.mask}get filledMask(){if(!this.computed.filledMask){let t=new tx(this.width,this.height,{kind:hp,position:[this.minX,this.minY],parent:this.map.parent});for(let e=0;e<this.width;e++)for(let i=0;i<this.height;i++){let n=e+this.minX+(i+this.minY)*this.map.width;this.internalIDs.includes(this.map.data[n])&&t.setBitXY(e,i)}this.computed.filledMask=t}return this.computed.filledMask}get centerMask(){if(!this.computed.centerMask){let t=new qy({kind:"smallCross"}).getMask();t.parent=this.map.parent,t.position=[this.minX+this.center[0]-1,this.minY+this.center[1]-1],this.computed.centerMask=t}return this.computed.centerMask}get convexHull(){if(!this.computed.convexHull){const t=[];for(let e=0;e<this.width;e++)for(let i=0;i<this.height;i++)this.map.data[e+this.minX+(i+this.minY)*this.map.width]===this.id&&(e>0&&e<this.width-1&&i>0&&i<this.height-1&&this.map.data[e-1+this.minX+(i+this.minY)*this.map.width]===this.id&&this.map.data[e+1+this.minX+(i+this.minY)*this.map.width]===this.id&&this.map.data[e+this.minX+(i-1+this.minY)*this.map.width]===this.id&&this.map.data[e+this.minX+(i+1+this.minY)*this.map.width]===this.id||(t.push([e,i]),t.push([e+1,i]),t.push([e,i+1]),t.push([e+1,i+1])));const e=gw(t);this.computed.convexHull={polyline:e,surface:bw(e),perimeter:xw(e)}}return this.computed.convexHull}get convexHullMask(){if(!this.computed.convexHullMask){const t=this.convexHull,e=new tx(this.width+1,this.height+1,{kind:hp,position:[this.minX,this.minY],parent:this.map.parent});e.paintPolyline(t.polyline,{closed:!0}),this.computed.convexHullMask=e}return this.computed.convexHullMask}get convexHullFilledMask(){if(!this.computed.convexHullFilledMask){const t=this.convexHull,e=new tx(this.width,this.height,{kind:hp,position:[this.minX,this.minY],parent:this.map.parent});for(let i=0;i<this.width;i++)for(let n=0;n<this.height;n++)1!==Tw()(t.polyline,[i,n])&&e.setBitXY(i,n);this.computed.convexHullFilledMask=e}return this.computed.convexHullFilledMask}get mbr(){if(!this.computed.mbr){let t=Ew({originalPoints:this.convexHull.polyline});if(0===t.length)this.computed.mbr={width:0,height:0,surface:0,perimeter:0,rectangle:t};else{let e=t[0],i=t[1],n=t[2],r=Math.sqrt((e[0]-i[0])**2+(e[1]-i[1])**2),s=Math.sqrt((n[0]-i[0])**2+(n[1]-i[1])**2);this.computed.mbr={width:r,height:s,elongation:1-r/s,aspectRatio:r/s,surface:r*s,perimeter:2*(r+s),rectangle:t}}}return this.computed.mbr}get fillRatio(){return this.surface/(this.surface+this.holesInfo.surface)}get feretDiameters(){return this.computed.feretDiameters||(this.computed.feretDiameters=function(t={}){const{originalPoints:e=mw.call(this)}=t;if(0===e.length)return{min:0,max:0,minLine:[],maxLine:[],aspectRatio:1};if(1===e.length)return{min:1,max:1,minLine:[e[0],e[0]],maxLine:[e[0],e[0]],aspectRatio:1};const i=new Array(e.length);let n=1/0,r=0,s=[];for(let t=0;t<e.length;t++){let o=Rw(e[t],e[(t+1)%e.length]);ww(-o,e,i);let a=0,l=[];for(let n=0;n<e.length;n++){let e=Math.abs(i[t][1]-i[n][1]);e>a&&(a=e,l=[],l.push([i[n][0],i[t][1]],[i[n][0],i[n][1]]))}a<n&&(n=a,r=o,s=l)}ww(r,s,s);let o=0,a=[],l=0;for(let t=0;t<e.length-1;t++)for(let i=t+1;i<e.length;i++){let n=(e[t][0]-e[i][0])**2+(e[t][1]-e[i][1])**2;n>l&&(l=n,o=Math.sqrt(n),a=[e[t],e[i]])}return{min:n,minLine:s,max:o,maxLine:a,aspectRatio:n/o}}({originalPoints:this.convexHull.polyline})),this.computed.feretDiameters}get eqpc(){return this.computed.eqpc||(this.computed.eqpc=2*Math.sqrt(this.surface/Math.PI)),this.computed.eqpc}get perimeterInfo(){return this.computed.perimeterInfo||(this.computed.perimeterInfo=function(t){let e=t.map,i=e.data,n=0,r=0,s=0,o=0;for(let a=0;a<t.width;a++)for(let l=0;l<t.height;l++){let h=(l+t.minY)*e.width+a+t.minX;if(i[h]===t.id){let c=0;switch((0===a||t.externalIDs.includes(i[h-1]))&&c++,(a===t.width-1||t.externalIDs.includes(i[h+1]))&&c++,(0===l||t.externalIDs.includes(i[h-e.width]))&&c++,(l===t.height-1||t.externalIDs.includes(i[h+e.width]))&&c++,c){case 1:n++;break;case 2:r++;break;case 3:s++;break;case 4:o++}}}return{one:n,two:r,three:s,four:o}}(this)),this.computed.perimeterInfo}get perimeter(){let t=this.perimeterInfo,e=2-Math.sqrt(2);return t.one+2*t.two+3*t.three+4*t.four-e*(t.two+2*t.three+t.four)}get ped(){return this.computed.ped||(this.computed.ped=this.perimeter/Math.PI),this.computed.ped}get feretMask(){if(!this.computed.feretMask){const t=new tx(this.width+1,this.height+1,{kind:hp,position:[this.minX,this.minY],parent:this.map.parent});t.paintPolyline(this.feretDiameters.minLine),t.paintPolyline(this.feretDiameters.maxLine),this.computed.feretMask=t}return this.computed.feretMask}get mbrMask(){if(!this.computed.mbrMask){let t=function(t){for(let e=0;e<t.length;e++)t[e][0]=Math.round(t[e][0]),t[e][1]=Math.round(t[e][1]);return t}(this.mbr.rectangle);if(t.length>0){const e=vw(t),i=new tx(e[1][0]-e[0][0]+1,e[1][1]-e[0][1]+1,{kind:hp,position:[this.minX+e[0][0],this.minY+e[0][1]],parent:this.map.parent});t=function(t,e){void 0===e&&(e=new Array(t.length).fill(0).map((()=>[])));let i=vw(t),n=i[0][0],r=i[0][1];for(let i=0;i<t.length;i++)e[i][0]=t[i][0]-n,e[i][1]=t[i][1]-r;return e}(t),i.paintPolyline(t,{closed:!0}),this.computed.mbrMask=i}else this.computed.mbrMask=new tx(1,1,{kind:hp,position:[this.minX,this.minY],parent:this.map.parent})}return this.computed.mbrMask}get mbrFilledMask(){if(!this.computed.mbrFilledMask){const t=new tx(this.width,this.height,{kind:hp,position:[this.minX,this.minY],parent:this.map.parent}),e=this.mask.minimalBoundingRectangle();for(let i=0;i<this.width;i++)for(let n=0;n<this.height;n++)1!==Tw()(e,[i,n])&&t.setBitXY(i,n);this.computed.mbrFilledMask=t}return this.computed.mbrFilledMask}get points(){if(!this.computed.points){let t=[];for(let e=0;e<this.height;e++)for(let i=0;i<this.width;i++){let n=(e+this.minY)*this.map.width+i+this.minX;this.map.data[n]===this.id&&t.push([i,e])}this.computed.points=t}return this.computed.points}get maxLengthPoints(){if(!this.computed.maxLengthPoints){let t,e=0;const i=this.points;for(let n=0;n<i.length;n++)for(let r=n+1;r<i.length;r++){let s=Math.pow(i[n][0]-i[r][0],2)+Math.pow(i[n][1]-i[r][1],2);s>=e&&(e=s,t=[i[n],i[r]])}this.computed.maxLengthPoints=t}return this.computed.maxLengthPoints}get maxLength(){if(!this.computed.maxLength){let t=Math.sqrt(Math.pow(this.maxLengthPoints[0][0]-this.maxLengthPoints[1][0],2)+Math.pow(this.maxLengthPoints[0][1]-this.maxLengthPoints[1][1],2));this.computed.maxLength=t}return this.computed.maxLength}get roundness(){return 4*this.surface/(Math.PI*this.feretDiameters.max**2)}get sphericity(){return 2*Math.sqrt(this.surface*Math.PI)/this.perimeter}get solidity(){return this.surface/this.convexHull.surface}get angle(){if(!this.computed.angle){let t=this.maxLengthPoints,e=180*-Math.atan2(t[0][1]-t[1][1],t[0][0]-t[1][0])/Math.PI;this.computed.angle=e}return this.computed.angle}toJSON(){return{id:this.id,minX:this.minX,maxX:this.maxX,minY:this.minY,maxY:this.maxY,meanX:this.meanX,meanY:this.meanY,height:this.height,width:this.width,surface:this.surface,mbrWidth:this.mbr.width,mbrHeight:this.mbr.height,mbrSurface:this.mbr.surface,eqpc:this.eqpc,ped:this.ped,feretDiameterMin:this.feretDiameters.min,feretDiameterMax:this.feretDiameters.max,aspectRatio:this.feretDiameters.aspectRatio,fillRatio:this.fillRatio,sphericity:this.sphericity,roundness:this.roundness,solidity:this.solidity,perimeter:this.perimeter}}}class kw{constructor(t,e){this.roiMap=t,this.options=e,this.roi=this.createRoi()}createRoi(){let t=this.roiMap.data,e={};this.roiMap.positive=0,this.roiMap.negative=0;for(let i=0;i<t.length;i++)t[i]&&!e[t[i]]&&(e[t[i]]=!0,t[i]>0?this.roiMap.positive++:this.roiMap.negative++);let i={};for(let t in e)i[t]=new Aw(this.roiMap,1*t);let n=this.roiMap.width,r=this.roiMap.height;for(let e=0;e<r;e++)for(let r=0;r<n;r++){let s=e*n+r;if(0!==t[s]){const n=i[t[s]];r<n.minX&&(n.minX=r),r>n.maxX&&(n.maxX=r),e<n.minY&&(n.minY=e),e>n.maxY&&(n.maxY=e),n.meanX+=r,n.meanY+=e,n.surface++}}let s=[];for(let t in e)i[t].meanX/=i[t].surface,i[t].meanY/=i[t].surface,s.push(i[t]);return s}}function Pw(t={}){const{algorithm:e="commonBorderLength",minCommonBorderLength:i=5,maxCommonBorderLength:n=100,minCommonBorderRatio:r=.3,maxCommonBorderRatio:s=1}=t;let o=function(t,e,r){return t[r]>=i&&t[r]<=n};"function"==typeof e&&(o=e),"commonborderratio"===e.toLowerCase()&&(o=function(t,e,i){let n=Math.min(t[i]/t[e],1);return n>=r&&n<=s});const a=this,l=a.commonBorderLength;let h={},c={};for(let t of Object.keys(l)){let e=l[t],i=Object.keys(e);for(let n of i)if(n!==t&&o(e,t,n)){let e=n;c[n]&&(e=c[n]);let i=t;if(c[t]&&(i=c[t]),Number(e)!==i){let t=Math.min(e,i),n=Math.max(e,i);if(h[t]||(h[t]={}),h[t][n]=!0,c[n]=t,h[n]){for(let e of Object.keys(h[n]))h[t][e]=!0,c[e]=t;delete h[n]}}}}let u=a.minMax,d=-u.min,g=u.max+d,f=new Array(g+1).fill(0);for(let t of Object.keys(c))f[Number(t)+d]=c[t];let p=a.data;for(let t=0;t<p.length;t++){let e=p[t];if(0!==e){let i=f[e+d];0!==i&&(p[t]=i)}}return a.computed={},a}class Lw{constructor(t,e){this.parent=t,this.width=t.width,this.height=t.height,this.data=e,this.negative=0,this.positive=0}get total(){return this.negative+this.positive}get minMax(){let t=Number.MAX_SAFE_INTEGER,e=Number.MIN_SAFE_INTEGER;for(let i=0;i<this.data.length;i++)this.data[i]<t&&(t=this.data[i]),this.data[i]>e&&(e=this.data[i]);return{min:t,max:e}}get commonBorderLength(){return function(t){let e=t.data,i=[1,0,-1,0],n=[0,1,0,-1],r=t.minMax,s=-r.min,o=r.max+s,a=[];for(let t=0;t<=o;t++)a.push(Object.create(null));for(let r=0;r<t.width;r++)for(let o=0;o<t.height;o++){let l=e[r+o*t.width];if(0!==l){let h=Object.create(null),c=!1;for(let u=0;u<4;u++){let d=r+i[u],g=o+n[u];if(d>=0&&g>=0&&d<t.width&&g<t.height){let i=e[d+g*t.width];l!==i&&(c=!0,0!==i&&void 0===h[i]&&(h[i]=!0,a[i+s][l]?a[i+s][l]++:a[i+s][l]=1))}else c=!0}c&&(a[l+s][l]?a[l+s][l]++:a[l+s][l]=1)}}let l={};for(let t=0;t<a.length;t++)Object.keys(a[t]).length>0&&(l[t-s]=a[t]);return l}(this)}mergeRoi(t={}){return Pw.call(this,t)}mergeRois(t){const e=t[0],i=t.slice(1);for(let t=0;t<this.data.length;t++)i.includes(this.data[t])&&(this.data[t]=e)}rowsInfo(){let t=new Array(this.height),e=0;for(let i=0;i<this.data.length;i+=this.width){let n={row:e,positivePixel:0,negativePixel:0,zeroPixel:0,positiveRoi:0,negativeRoi:0,medianChange:0};t[e++]=n;let r={},s={},o=[],a=this.data[i],l=0;for(let t=i;t<i+this.width;t++){let e=this.data[t];a!==e&&(a=e,o.push(l),l=0),l++,e>0?(n.positivePixel++,r[e]||(r[e]=!0)):e<0?(n.negativePixel++,s[e]||(s[e]=!0)):n.zeroPixel++}o.push(l),n.medianChange=o.sort(((t,e)=>t-e))[Math.floor(o.length/2)],n.positiveRoiIDs=Object.keys(r),n.negativeRoiIDs=Object.keys(s),n.positiveRoi=n.positiveRoiIDs.length,n.negativeRoi=n.negativeRoiIDs.length}return t}colsInfo(){let t=new Array(this.width),e=0;for(let i=0;i<this.width;i++){let n={col:e,positivePixel:0,negativePixel:0,zeroPixel:0,positiveRoi:0,negativeRoi:0,medianChange:0};t[e++]=n;let r={},s={},o=[],a=this.data[i],l=0;for(let t=i;t<i+this.data.length;t+=this.width){let e=this.data[t];a!==e&&(a=e,o.push(l),l=0),l++,e>0?(n.positivePixel++,r[e]||(r[e]=!0)):e<0?(n.negativePixel++,s[e]||(s[e]=!0)):n.zeroPixel++}o.push(l),n.medianChange=o.sort(((t,e)=>t-e))[Math.floor(o.length/2)],n.positiveRoiIDs=Object.keys(r),n.negativeRoiIDs=Object.keys(s),n.positiveRoi=n.positiveRoiIDs.length,n.negativeRoi=n.negativeRoiIDs.length}return t}}function Nw(t,e={}){const{allowCorners:i=!1}=e,n=65535;let r=new Int16Array(t.size),s=0,o=0,a=new Uint16Array(65536),l=new Uint16Array(65536);for(let e=0;e<t.width;e++)for(let i=0;i<t.height;i++)0===r[i*t.width+e]&&h(e,i);function h(e,h){let c=0,u=0,d=t.getBitXY(e,h),g=d?++s:--o;if(s>32767||o<-32768)throw new Error("Too many regions of interest");for(a[0]=e,l[0]=h;c<=u;){let e=a[c&n],s=l[c&n];if(r[s*t.width+e]=g,e>0&&0===r[s*t.width+e-1]&&t.getBitXY(e-1,s)===d&&(u++,a[u&n]=e-1,l[u&n]=s,r[s*t.width+e-1]=-32768),s>0&&0===r[(s-1)*t.width+e]&&t.getBitXY(e,s-1)===d&&(u++,a[u&n]=e,l[u&n]=s-1,r[(s-1)*t.width+e]=-32768),e<t.width-1&&0===r[s*t.width+e+1]&&t.getBitXY(e+1,s)===d&&(u++,a[u&n]=e+1,l[u&n]=s,r[s*t.width+e+1]=-32768),s<t.height-1&&0===r[(s+1)*t.width+e]&&t.getBitXY(e,s+1)===d&&(u++,a[u&n]=e,l[u&n]=s+1,r[(s+1)*t.width+e]=-32768),i&&(e>0&&s>0&&0===r[(s-1)*t.width+e-1]&&t.getBitXY(e-1,s-1)===d&&(u++,a[u&n]=e-1,l[u&n]=s-1,r[(s-1)*t.width+e-1]=-32768),e<t.width-1&&s>0&&0===r[(s-1)*t.width+e+1]&&t.getBitXY(e+1,s-1)===d&&(u++,a[u&n]=e+1,l[u&n]=s-1,r[(s-1)*t.width+e+1]=-32768),e>0&&s<t.height-1&&0===r[(s+1)*t.width+e-1]&&t.getBitXY(e-1,s+1)===d&&(u++,a[u&n]=e-1,l[u&n]=s+1,r[(s+1)*t.width+e-1]=-32768),e<t.width-1&&s<t.height-1&&0===r[(s+1)*t.width+e+1]&&t.getBitXY(e+1,s+1)===d&&(u++,a[u&n]=e+1,l[u&n]=s+1,r[(s+1)*t.width+e+1]=-32768)),c++,u-c>n)throw new Error("analyseMask can not finish, the array to manage internal data is not big enough.You could improve mask by changing MAX_ARRAY")}}return new Lw(t,r)}var Dw=__webpack_require__(530),Ow=__webpack_require__.n(Dw);const Fw=[-1,0],zw=[0,-1],Bw=[null,null],Gw=[-1,-1,0,1],Yw=[0,-1,-1,-1],Uw=[null,null,null,null];function Xw(t,e={}){const{allowCorners:i=!1}=e;let n,r,s,o=4;if(i&&(o=8),8===o)n=Gw,r=Yw,s=Uw;else{if(4!==o)throw new RangeError(`unsupported neighbours count: ${o}`);n=Fw,r=zw,s=Bw}const a=t.size,l=t.width,h=t.height,c=new Array(a),u=new Uint32Array(a),d=new(Ow());let g=1;for(let e=0;e<h;e++)for(let i=0;i<l;i++){const o=i+e*l;if(t.getBit(o)){let t=null;for(let o=0;o<s.length;o++){const a=i+n[o],u=e+r[o];if(a>=0&&u>=0&&a<l&&u<h){let e=c[a+u*l];e?(s[o]=e,(!t||s[o].value<t.value)&&(t=s[o])):s[o]=null}}if(t){c[o]=t;for(let e=0;e<s.length;e++)s[e]&&s[e]!==t&&d.union(t,s[e])}else c[o]=d.add(g++)}}for(let e=0;e<h;e++)for(let i=0;i<l;i++){const n=i+e*l;t.getBit(n)&&(u[n]=d.find(c[n]).value)}return new Lw(t,u)}function qw(t={}){let{allowCorner:e=!0,onlyTop:i=!1,invert:n=!1}=t,r=this;r.checkProcessable("fromMaxima",{components:[1]});const s=1,o=2;let a=0,l=0,h=new Int16Array(r.size),c=new Int8Array(r.size),u=new Float32Array(r.size),d=1048575,g=new Uint16Array(d+1),f=new Uint16Array(d+1),p=0,m=0,_=new Uint16Array(d+1),y=new Uint16Array(d+1),w=0,x=0;for(function({maxima:t=!0}){for(let i=1;i<r.height-1;i++)for(let n=1;n<r.width-1;n++){let s=n+i*r.width;if(0===c[s]){let o=t?r.data[s]:-r.data[n+i*r.width];if(r.data[i*r.width+n-1]>o)continue;if(r.data[i*r.width+n+1]>o)continue;if(r.data[(i-1)*r.width+n]>o)continue;if(r.data[(i+1)*r.width+n]>o)continue;if(e){if(r.data[(i-1)*r.width+n-1]>o)continue;if(r.data[(i-1)*r.width+n+1]>o)continue;if(r.data[(i+1)*r.width+n-1]>o)continue;if(r.data[(i+1)*r.width+n+1]>o)continue}h[s]=t?++a:--l,b(n,i)||(t?--a:++l)}}}(r);p<m;)v(g[p&d],f[p&d],o),p++;return new Lw(r,h);function b(t,e){let i=m;w=0,x=1,_[0]=t,y[0]=e;let n=!0;for(;w<x;)n&=v(_[w&d],y[w&d],s),w++;if(!n){for(let t=0;t<x;t++){let e=_[t&d],i=y[t&d]*r.width+e;h[i]=0}m=i}return n}function v(t,e,n){let a=h[e*r.width+t],l=r.data[e*r.width+t];for(let p=e-1;p<=e+1;p++)for(let e=t-1;e<=t+1;e++){let t=p*r.width+e;if(0===c[t])switch(c[t]=1,u[t]=r.data[t]-l,n){case s:if(0===u[t]){if(0===e||0===p||e===r.width-1||p===r.height-1)return!1;h[t]=a,_[x&d]=e,y[x&d]=p,x++}else{if(u[t]>0)return!1;i||(h[t]=a,g[m&d]=e,f[m&d]=p,m++)}break;case o:u[t]<=0&&(h[t]=a,g[m&d]=e,f[m&d]=p,m++);break;default:throw new Error("unreachable")}}return!0}}function Vw(t,e={}){let i=new qy(e),n=new Int16Array(this.size),r=0,s=i.getPoints();for(let e=0;e<t.length;e++){r++;let i=t[e][0],o=t[e][1];for(let t=0;t<s.length;t++){let e=s[t][0],a=s[t][1];i+e>=0&&o+a>=0&&i+e<this.width&&o+a<this.height&&(n[i+e+(o+a)*this.width]=r)}}return new Lw(this,n)}var jw=__webpack_require__(5307),Ww=__webpack_require__.n(jw);const Zw=[1,0,-1,0,1,1,-1,-1],Hw=[0,1,0,-1,1,-1,1,-1];function Kw(t={}){let{points:e,mask:i,image:n,fillMaxValue:r=this.maxValue,invert:s=!1}=t,o=n||this;o.checkProcessable("fromWaterShed",{bitDepth:[8,16],components:1}),s=!s,e||(e=o.getLocalMaxima({invert:s,mask:i}));let a=s?0:1,l=new Int16Array(o.size),h=o.width,c=o.height,u=new(Ww())({comparator:(t,e)=>t[2]-e[2],strategy:Ww().BinaryHeapStrategy});for(let t=0;t<e.length;t++){let i=e[t][0]+e[t][1]*h;l[i]=t+1;let n=o.data[i];(s&&n<=r||!s&&n>=r)&&u.queue([e[t][0],e[t][1],n])}for(;u.length>0;){let t=u.dequeue(),e=t[0]+t[1]*h;for(let n=0;n<4;n++){let d=t[0]+Zw[n],g=t[1]+Hw[n];if(d>=0&&g>=0&&d<h&&g<c){let c=d+g*h;if(!i||i.getBit(c)===a){let i=o.data[c];(s&&i<=r||!s&&i>=r)&&0===l[c]&&(l[c]=l[e],u.queue([t[0]+Zw[n],t[1]+Hw[n],i]))}}}}return new Lw(o,l)}class $w{constructor(t,e={}){this._image=t,this._options=e,this._options.label||(this._options.label="default"),this._layers={},this._painted=null}fromMaxima(t={}){let e=Object.assign({},this._options,t),i=qw.call(this._image,t);this._layers[e.label]=new kw(i,e)}fromPoints(t,e={}){let i=Object.assign({},this._options,e),n=Vw.call(this._image,t,e);return this._layers[i.label]=new kw(n,i),this}putMap(t,e={}){let i=new Lw(this._image,t),n=Object.assign({},this._options,e);return this._layers[n.label]=new kw(i,n),this}fromWaterShed(t={}){let e=Object.assign({},this._options,t),i=Kw.call(this._image,t);this._layers[e.label]=new kw(i,e)}fromMask(t,e={}){let i=Object.assign({},this._options,e),n=Nw.call(this._image,t,e);return this._layers[i.label]=new kw(n,i),this}fromMaskConnectedComponentLabelingAlgorithm(t,e={}){let i=Object.assign({},this._options,e),n=Xw.call(this._image,t,e);return this._layers[i.label]=new kw(n,i),this}getMap(t={}){let e=Object.assign({},this._options,t);return this._assertLayerWithLabel(e.label),this._layers[e.label].roiMap}rowsInfo(t={}){return this.getMap(t).rowsInfo()}colsInfo(t={}){return this.getMap(t).rowsInfo()}getRoiIds(t={}){let e=this.getRois(t);if(e){let t=new Array(e.length);for(let i=0;i<e.length;i++)t[i]=e[i].id;return t}throw new Error("ROIs not found")}getRois(t={}){let{label:e=this._options.label,positive:i=!0,negative:n=!0,minSurface:r=0,maxSurface:s=Number.POSITIVE_INFINITY,minWidth:o=0,maxWidth:a=Number.POSITIVE_INFINITY,minHeight:l=0,maxHeight:h=Number.POSITIVE_INFINITY,minRatio:c=0,maxRatio:u=Number.POSITIVE_INFINITY}=t;if(!this._layers[e])throw new Error(`this Roi layer (${e}) does not exist`);const d=this._layers[e].roi,g=[];for(const t of d)(t.id<0&&n||t.id>0&&i)&&t.surface>=r&&t.surface<=s&&t.width>=o&&t.width<=a&&t.height>=l&&t.height<=h&&t.ratio>=c&&t.ratio<=u&&g.push(t);return g}getRoi(t,e={}){const{label:i=this._options.label}=e;if(!this._layers[i])throw new Error(`this Roi layer (${i}) does not exist`);const n=this._layers[i].roi.find((e=>e.id===t));if(!n)throw new Error(`found no Roi with id ${t}`);return n}getMasks(t={}){let e=this.getRois(t),i=new Array(e.length);for(let n=0;n<e.length;n++)i[n]=e[n].getMask(t);return i}getAnalysisMasks(t={}){const{analysisProperty:e}=t;let i=`${e}Mask`,n=this.getRois(t);return 0!==n.length&&n[0][i]?n.map((t=>t[i])):[]}getData(t={}){let e=Object.assign({},this._options,t);return this._assertLayerWithLabel(e.label),this._layers[e.label].roiMap.data}paint(t={}){let{labelProperty:e,analysisProperty:i}=t;this._painted||(this._painted=this._image.rgba8());let n=this.getMasks(t);if(e){const i=this.getRois(t);t.labels=i.map((t=>function(t,e=""){let i=e.split(".");for(let e of i){if(void 0===t[e])return;t=t[e]}return t}(t,e)));const n=Math.max(...t.labels);let r=!1,s=!1;if(e.includes("surface")?r=!0:/(?:perimeter|min|max|external|width|height|length)/.test(e)&&(s=!0),isFinite(n)){let e="";if("pixel"!==t.unit&&t.pixelSize&&(s||r)){e=r?`${t.unit}^2`:t.unit;let i=r?"m^2":"m",n=r?t.pixelSize**2:t.pixelSize;const s=Mw().swiftConverter(i,e);t.labels=t.labels.map((t=>s(n*t)))}t.labels=n>50?t.labels.map((t=>Math.round(t)+e)):n>10?t.labels.map((t=>t.toFixed(1)+e)):t.labels.map((t=>t.toFixed(2)+e))}t.labelsPosition=i.map((t=>[t.meanX,t.meanY]))}if(this._painted.paintMasks(n,t),i){let e=this.getAnalysisMasks(t);this._painted.paintMasks(e,{color:t.analysisColor,alpha:t.analysisAlpha})}return this._painted}getMask(t={}){let e=new tx(this._image.width,this._image.height,{kind:"BINARY"}),i=this.getMasks(t);for(let t=0;t<i.length;t++){let n=i[t];for(let t=0;t<n.width;t++)for(let i=0;i<n.height;i++)n.getBitXY(t,i)&&e.setBitXY(t+n.position[0],i+n.position[1])}return e}resetPainted(t={}){const{image:e}=t;this._painted=e?this.image.rgba8():this._image.rgba8()}mergeRoi(t={}){const e=this.getMap(t);return e.mergeRoi(t),this.putMap(e.data,t),this}mergeRois(t,e={}){if(!Array.isArray(t)||t.some((t=>!Number.isInteger(t))))throw new Error("Roi ids must be an array of integers");if(t.length<2)throw new Error("Roi ids must have at least two elements");if(new Set(t).size!==t.length)throw new Error("Roi ids must be all different");t.forEach((t=>this.getRoi(t)));const i=this.getMap(e);return i.mergeRois(t),this.putMap(i.data,e),this}findCorrespondingRoi(t,e={}){let i=this.getRois(e),n=[];for(let e=0;e<i.length;e++){let r=i[e],s=Jw(r.minX,r.minY,r.points,t,Math.sign(r.id));n.push(s)}return n}_assertLayerWithLabel(t){if(!this._layers[t])throw new Error(`no layer with label ${t}`)}}function Jw(t,e,i,n,r){let s={id:[],surface:[],roiSurfaceCovered:[],same:0,opposite:0,total:0};for(let r=0;r<i.length;r++){let o=i[r],a=o[0]+t+(o[1]+e)*n.width,l=n.data[a];(l>0||l<0)&&(s.id.includes(l)?s.surface[s.id.indexOf(l)]+=1:(s.id.push(l),s.surface.push(1)))}for(let t=0;t<s.id.length;t++)Math.sign(s.id[t])===r?s.same+=s.surface[t]:s.opposite+=s.surface[t],s.roiSurfaceCovered[t]=s.surface[t]/i.length;return s.total=s.opposite+s.same,s}const Qw=Object.prototype.toString;class tx{constructor(e,i,n,r){if(1===arguments.length?(r=e,({width:e,height:i,data:n}=r)):n&&!n.length&&(r=n,({data:n}=r)),void 0===e&&(e=1),void 0===i&&(i=1),void 0===r&&(r={}),"object"!=typeof r||null===r)throw new TypeError("options must be an object");if(!Number.isInteger(e)||e<=0)throw new RangeError("width must be a positive integer");if(!Number.isInteger(i)||i<=0)throw new RangeError("height must be a positive integer");const{kind:s=cp}=r;if("string"!=typeof s)throw new TypeError("kind must be a string");const o=function(t){const e=up[t];if(!e)throw new RangeError(`invalid image kind: ${t}`);return e}(s),a=Object.assign({},r);for(const t in o)void 0===a[t]&&(a[t]=o[t]);!function(e){const{components:i,alpha:n,bitDepth:r,colorModel:s}=e;if(!Number.isInteger(i)||i<=0)throw new RangeError(`invalid components: ${i}. Must be a positive integer`);if(0!==n&&1!==n&&"boolean"!=typeof n)throw new TypeError(`invalid alpha: ${n}: must be a boolean, 0 or 1`);if(!dp.includes(r))throw new RangeError(`invalid bitDepth: ${r}. Must be one of ${dp.join(", ")}`);if(!t[s])throw new RangeError(`invalid colorModel: ${s}. Must be one of ${Object.keys(t).join(", ")}`)}(a);const{components:l,bitDepth:h,colorModel:c}=a,u=a.alpha+0,d=e*i,g=l+u,f=32===h?Number.MAX_VALUE:2**h-1;if(void 0===n)n=function(t,e,i,n,r,s){const o=n*t;let a;switch(r){case 1:a=new Uint8Array(Math.ceil(o/8));break;case 8:a=new Uint8Array(o);break;case 16:a=new Uint16Array(o);break;case 32:a=new Float32Array(o);break;default:throw new Error(`Cannot create pixel array for bit depth ${r}`)}if(i)for(let t=e;t<a.length;t+=n)a[t]=s;return a}(d,l,u,g,h,f);else{const t=function(t,e,i){let n=e*t;return 1===i&&(n=Math.ceil(n/8)),n}(d,g,h);if(n.length!==t)throw new RangeError(`incorrect data size: ${n.length}. Should be ${t}`)}this.width=e,this.height=i,this.data=n,this.size=d,this.components=l,this.alpha=u,this.bitDepth=h,this.maxValue=f,this.colorModel=c,this.channels=g,this.meta=r.meta||{},Object.defineProperty(this,"parent",{enumerable:!1,writable:!0,configurable:!0,value:r.parent||null}),this.position=r.position||[0,0],this.computed=null,this.sizes=[this.width,this.height],this.multiplierX=this.channels,this.multiplierY=this.channels*this.width,this.isClamped=this.bitDepth<32,this.borderSizes=[0,0]}get[Symbol.toStringTag](){return"IJSImage"}static isImage(t){return"[object IJSImage]"===Qw.call(t)}static fromCanvas(t){const e=t.getContext("2d").getImageData(0,0,t.width,t.height);return new tx(e.width,e.height,e.data)}static createFrom(t,e){const i=nm(t);return Object.assign(i,{parent:t,position:[0,0]},e),new tx(i)}getRoiManager(t){return new $w(this,t)}clone(){const t=this.data.slice();return new tx(this.width,this.height,t,this)}apply(t){for(let e=0;e<this.height;e++)for(let i=0;i<this.width;i++){let n=(e*this.width+i)*this.channels;t.call(this,n)}}}!function(t){for(const e in im)t.prototype[e]=im[e]}(tx),function(t){for(const e in nu)t.prototype[e]=nu[e]}(tx),function(t){for(const e in tp)t.prototype[e]=tp[e]}(tx),tx.prototype.checkProcessable=function(t,e={}){let{bitDepth:i,alpha:n,colorModel:r,components:s,channels:o}=e;if("string"!=typeof t||0===t.length)throw new TypeError("processName must be a string");if(i&&(Array.isArray(i)||(i=[i]),!i.includes(this.bitDepth)))throw new TypeError(`The process: ${t} can only be applied if bit depth is in: ${i}`);if(n&&(Array.isArray(n)||(n=[n]),!n.includes(this.alpha)))throw new TypeError(`The process: ${t} can only be applied if alpha is in: ${n}`);if(r&&(Array.isArray(r)||(r=[r]),!r.includes(this.colorModel)))throw new TypeError(`The process: ${t} can only be applied if color model is in: ${r}`);if(s&&(Array.isArray(s)||(s=[s]),!s.includes(this.components))){let e=`The process: ${t} can only be applied if the number of components is in: ${s}`;throw 1===s.length&&1===s[0]?new TypeError(`${e}.\rYou should transform your image using "image.grey()" before applying the algorithm.`):new TypeError(e)}if(o&&(Array.isArray(o)||(o=[o]),!o.includes(this.channels)))throw new TypeError(`The process: ${t} can only be applied if the number of channels is in: ${o}`)},tx.prototype.getRGBAData=function(t={}){const{clamped:e}=t;this.checkProcessable("getRGBAData",{components:[1,3],bitDepth:[1,8,16,32]});const i=this.width*this.height*4;let n=e?new Uint8ClampedArray(i):new Uint8Array(i);return 1===this.bitDepth?function(t,e){for(let i=0;i<t.size;i++){const n=t.getBit(i);e[4*i]=255*n,e[4*i+1]=255*n,e[4*i+2]=255*n}}(this,n):32===this.bitDepth?(this.checkProcessable("getRGBAData",{alpha:0}),1===this.components?function(t,e){const i=t.min[0],n=t.max[0]-i;for(let r=0;r<t.size;r++){const s=Math.floor(255*(t.data[r]-i)/n);e[4*r]=s,e[4*r+1]=s,e[4*r+2]=s}}(this,n):3===this.components&&(this.checkProcessable("getRGBAData",{colorModel:[sp]}),function(t,e){const i=Math.min(...t.min),n=Math.max(...t.max)-i;for(let r=0;r<t.size;r++){const s=Math.floor(255*(t.data[3*r]-i)/n),o=Math.floor(255*(t.data[3*r+1]-i)/n),a=Math.floor(255*(t.data[3*r+2]-i)/n);e[4*r]=s,e[4*r+1]=o,e[4*r+2]=a}}(this,n))):1===this.components?function(t,e){for(let i=0;i<t.size;i++)e[4*i]=t.data[i*t.channels]>>>t.bitDepth-8,e[4*i+1]=t.data[i*t.channels]>>>t.bitDepth-8,e[4*i+2]=t.data[i*t.channels]>>>t.bitDepth-8}(this,n):3===this.components&&(this.checkProcessable("getRGBAData",{colorModel:[sp]}),function(t,e){for(let i=0;i<t.size;i++)e[4*i]=t.data[i*t.channels]>>>t.bitDepth-8,e[4*i+1]=t.data[i*t.channels+1]>>>t.bitDepth-8,e[4*i+2]=t.data[i*t.channels+2]>>>t.bitDepth-8}(this,n)),1===this.alpha?(this.checkProcessable("getRGBAData",{bitDepth:[8,16]}),function(t,e){for(let i=0;i<t.size;i++)e[4*i+3]=t.data[i*t.channels+t.components]>>t.bitDepth-8}(this,n)):function(t,e){for(let i=0;i<t.size;i++)e[4*i+3]=255}(this,n),n},tx.load=function(t,e){if("string"==typeof t)return function(t,e){const i=t.slice(0,64).match($p);let n;return n=null!==i?Promise.resolve(function(t){let e,i,n,r,s=.75*t.length,o=t.length,a=0;"="===t[t.length-1]&&(s--,"="===t[t.length-2]&&s--);const l=new Uint8Array(s);for(let s=0;s<o;s+=4)e=Wf[t.charCodeAt(s)],i=Wf[t.charCodeAt(s+1)],n=Wf[t.charCodeAt(s+2)],r=Wf[t.charCodeAt(s+3)],l[a++]=e<<2|i>>4,l[a++]=(15&i)<<4|n>>2,l[a++]=(3&n)<<6|63&r;return l}(t.slice(i[0].length))):function(t,{withCredentials:e=!1}={}){return new Promise((function(i,n){let r=new self.XMLHttpRequest;r.open("GET",t,!0),r.responseType="arraybuffer",r.withCredentials=e,r.onload=function(t){200!==this.status?n(t):i(this.response)},r.onerror=n,r.send()}))}(t,e),n.then((n=>Jp(new Uint8Array(n),i?t:void 0,e&&e.ignorePalette)))}(t,e);if(t instanceof ArrayBuffer)return Promise.resolve(Jp(new Uint8Array(t),void 0,e&&e.ignorePalette));if(t.buffer)return Promise.resolve(Jp(t,void 0,e&&e.ignorePalette));throw new Error('argument to "load" must be a string or buffer.')},tx.extendMethod=function(t,e,i={}){let{inPlace:n=!1,returnThis:r=!0,partialArgs:s=[]}=i;return tx.prototype[t]=n?function(...t){this.computed=null;let i=e.apply(this,[...s,...t]);return r?this:i}:function(...t){return e.apply(this,[...s,...t])},tx},tx.extendProperty=function(t,e,i={}){let{partialArgs:n=[]}=i;return np.get=function(){if(null===this.computed)this.computed={};else if(ip()(t,this.computed))return this.computed[t];let i=e.apply(this,n);return this.computed[t]=i,i},Object.defineProperty(tx.prototype,t,np),tx},function(t){let e={inPlace:!0};t.extendMethod("invert",am),t.extendMethod("abs",om),t.extendMethod("level",Bm,e),t.extendMethod("add",Xm,e),t.extendMethod("subtract",qm,e),t.extendMethod("subtractImage",Vm),t.extendMethod("multiply",Wm,e),t.extendMethod("divide",Zm,e),t.extendMethod("hypotenuse",jm),t.extendMethod("background",e_),t.extendMethod("flipX",lm),t.extendMethod("flipY",hm),t.extendMethod("blurFilter",cm),t.extendMethod("medianFilter",pm),t.extendMethod("gaussianFilter",mm),t.extendMethod("sobelFilter",Dm),t.extendMethod("gradientFilter",Nm),t.extendMethod("scharrFilter",Om),t.extendMethod("dilate",i_),t.extendMethod("erode",a_),t.extendMethod("open",d_),t.extendMethod("close",g_),t.extendMethod("topHat",f_),t.extendMethod("blackHat",p_),t.extendMethod("morphologicalGradient",m_),t.extendMethod("warpingFourPoints",b_),t.extendMethod("crop",v_),t.extendMethod("cropAlpha",E_),t.extendMethod("resize",T_).extendMethod("scale",T_),t.extendMethod("hsv",R_),t.extendMethod("hsl",A_),t.extendMethod("cmyk",k_),t.extendMethod("rgba8",P_),t.extendMethod("grey",D_).extendMethod("gray",D_),t.extendMethod("mask",W_),t.extendMethod("pad",Z_),t.extendMethod("colorDepth",H_),t.extendMethod("setBorder",iy,e),t.extendMethod("rotate",$_),t.extendMethod("rotateLeft",J_),t.extendMethod("rotateRight",Q_),t.extendMethod("insert",ey),t.extendMethod("getRow",dy),t.extendMethod("getColumn",gy),t.extendMethod("getMatrix",fy),t.extendMethod("setMatrix",py),t.extendMethod("getPixelsArray",my),t.extendMethod("getIntersection",_y),t.extendMethod("getClosestCommonParent",wy),t.extendMethod("getThreshold",V_),t.extendMethod("split",ny),t.extendMethod("getChannel",ry),t.extendMethod("combineChannels",sy),t.extendMethod("setChannel",ay),t.extendMethod("getSimilarity",ly),t.extendMethod("getPixelsGrid",hy),t.extendMethod("getBestMatch",uy),t.extendMethod("cannyEdge",My),t.extendMethod("convolution",Lm),t.extendMethod("extract",Cy),t.extendMethod("floodFill",Ay),t.extendMethod("paintLabels",By,e),t.extendMethod("paintMasks",Gy,e),t.extendMethod("paintPoints",Vy,e),t.extendMethod("paintPolyline",jy,e),t.extendMethod("paintPolylines",Wy,e),t.extendMethod("paintPolygon",Zy,e),t.extendMethod("paintPolygons",$y,e),t.extendMethod("countAlphaPixels",dw),t.extendMethod("monotoneChainConvexHull",mw),t.extendMethod("minimalBoundingRectangle",Ew),t.extendMethod("getHistogram",Jy).extendProperty("histogram",Jy),t.extendMethod("getHistograms",Qy).extendProperty("histograms",Qy),t.extendMethod("getColorHistogram",ew).extendProperty("colorHistogram",ew),t.extendMethod("getMin",iw).extendProperty("min",iw),t.extendMethod("getMax",nw).extendProperty("max",nw),t.extendMethod("getSum",rw).extendProperty("sum",rw),t.extendMethod("getMoment",sw).extendProperty("moment",sw),t.extendMethod("getLocalMaxima",ow),t.extendMethod("getMedian",lw).extendProperty("median",lw),t.extendMethod("getMean",aw).extendProperty("mean",aw),t.extendMethod("getPoints",hw).extendProperty("points",hw),t.extendMethod("getExtendedPoints",cw).extendProperty("extendedPoints",cw),t.extendMethod("getRelativePosition",uw)}(tx);var ex=__webpack_require__(6732),ix=__webpack_require__.n(ex);const nx={regression:{kernelType:"polynomial",kernelOptions:{degree:2,constant:1}},threshold:.02,roi:{minSurface:100,positive:!1},sampling:20,include:[]};function rx(t,e,i){return t.post("data",[e,i]).then((function(t){for(let e in t)t[e]=new tx(t[e]);return t}))}const sx={run:function(t,e,i){e=Object.assign({},nx,e);const n=this.manager;return Array.isArray(t)?Promise.all(t.map((function(t){const r=rx(n,t,e);return"function"==typeof i&&r.then(i),r}))):rx(n,t,e)},work:function(){worker.on("data",(function(t,e,i){e=new IJS(e);const n={},r=[],s=e.grey(),o=s.sobelFilter();g("sobel",o);const a=o.level().mask({threshold:i.threshold});g("mask",a);const l=o.getRoiManager();l.fromMask(a);const h=l.getMask(i.roi);g("realMask",h);const c=s.getPixelsGrid({sampling:i.sampling,mask:h}),u=e.getBackground(c.xyS,c.zS,i.regression);g("background",u);const d=e.subtract(u);function g(t,e){i.include.includes(t)&&(n[t]=e,r.push(e.data.buffer))}n.result=d,r.push(d.data.buffer),t(n,r)}))}},ox=sx;class ax{constructor(){this._url=null,this._deps=[null]}checkUrl(){if(null===this._url)throw new Error("image worker must be initialized with an URL")}get url(){return this._url}set url(t){if("string"!=typeof t)throw new TypeError("worker URL must be a string");this._url=t,this._deps[0]=t}static extendMethod(t,e){let i,n,r={};function s(...t){return i||(this.checkUrl(),n=this.url,i=new(ix())(e.work,{deps:n}),r.manager=i),e.run.call(r,...t)}s.reset=function(){i&&(i.terminate(),i=new(ix())(e.work,{deps:n}),r.manager=i)},ax.prototype[t]=s}}function lx(t,e,i){let n=[],r=new ImageData(t.width,t.height),s=[hx(e[0],e[1],e[2]),cx(e[0],e[1],e[2]),ux(e[0],e[1],e[2])];for(let e=0;e<t.data.length;e+=4){let o=t.data[e],a=t.data[e+1],l=t.data[e+2],h=[hx(o,a,l),cx(o,a,l),ux(o,a,l)],c=Math.sqrt(.5053*Math.pow(h[0]-s[0],2)+.299*Math.pow(h[1]-s[1],2)+.1957*Math.pow(h[2]-s[2],2));n.push(c),Math.abs(c)===i&&(r.data[e]=255,r.data[e+3]=255)}return r}function hx(t,e,i){return.29889531*t+.58662247*e+.11448223*i}function cx(t,e,i){return.59597799*t-.2741761*e-.32180189*i}function ux(t,e,i){return.21147017*t-.52261711*e+.31114694*i}function dx(t,e,i,n){let r=t.contour,s=(t.color,{}),o=(n[2]-n[0])/e,a=(n[3]-n[1])/i;for(let t=0;t<r.length;t+=3){let e=r[t],i=r[t+1],n=r[t+2],o=[e,i,n];0===e&&0===i&&0===n||(o.toString()in s?s[o.toString()].push(t/3):s[o.toString()]=[t/3])}let l={type:"FeatureCollection",name:"polygonFeatures",crs:{type:"name",properties:{name:"EPSG:3857"}},features:[]},h=0;for(const t in s){h++;let i=[];for(let n=0;n<s[t].length;n++){let r=s[t][n]%e,o=Math.floor(s[t][n]/e);i.push([r,o])}if(i.length<=3)continue;let r=gx(i),c=[];for(let t=0;t<r.length;t++){let e=r[t][0],i=r[t][1];e=n[0]+e*o,i=n[3]-i*a,c.push([e,i])}l.features.push({type:"Feature",geometry:{type:"Polygon",coordinates:[c]},id:h})}return l}function gx(t){let e=t.slice(),i=[],n=e[0];i.push(n),e[0]=[NaN,NaN];let r=0,s=e.length-1,o=0;function a(t){return[[t[0]-1,t[1]-1],[t[0],t[1]-1],[t[0]+1,t[1]-1],[t[0]-1,t[1]],t,[t[0]+1,t[1]],[t[0]-1,t[1]+1],[t[0],t[1]+1],[t[0]+1,t[1]+1]]}for(let n=0;n<=i.length;n++){o++;let l=i.length,h=a(i[n]);t:for(let n=0;n<h.length;n++)for(let r=1;r<e.length&&4!==n;r++)if(h[n][0]===e[r][0]&&h[n][1]===e[r][1]&&NaN!=e[r][0]&&NaN!=e[r][1]){i.push(t[r]),e[r]=[NaN,NaN],s-=1;break t}if(i.length-l==0&&(i.pop(),n-=2,r+=1),o===e.length-1){console.log("breaked");break}}return i}!function(t){t.extendMethod("background",ox)}(ax),new ax;var fx=__webpack_require__(9152);const px=class{constructor(t){this.highWaterMark=void 0!==t?t:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}canExpireCache(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark}expireCache(t){for(;this.canExpireCache();)this.pop()}clear(){this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}containsKey(t){return this.entries_.hasOwnProperty(t)}forEach(t){let e=this.oldest_;for(;e;)t(e.value_,e.key_,this),e=e.newer}get(t,e){const i=this.entries_[t];return K(void 0!==i,"Tried to get a value for a key that does not exist in the cache"),i===this.newest_||(i===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(i.newer.older=i.older,i.older.newer=i.newer),i.newer=null,i.older=this.newest_,this.newest_.newer=i,this.newest_=i),i.value_}remove(t){const e=this.entries_[t];return K(void 0!==e,"Tried to get a value for a key that does not exist in the cache"),e===this.newest_?(this.newest_=e.older,this.newest_&&(this.newest_.newer=null)):e===this.oldest_?(this.oldest_=e.newer,this.oldest_&&(this.oldest_.older=null)):(e.newer.older=e.older,e.older.newer=e.newer),delete this.entries_[t],--this.count_,e.value_}getCount(){return this.count_}getKeys(){const t=new Array(this.count_);let e,i=0;for(e=this.newest_;e;e=e.older)t[i++]=e.key_;return t}getValues(){const t=new Array(this.count_);let e,i=0;for(e=this.newest_;e;e=e.older)t[i++]=e.value_;return t}peekLast(){return this.oldest_.value_}peekLastKey(){return this.oldest_.key_}peekFirstKey(){return this.newest_.key_}peek(t){return this.entries_[t]?.value_}pop(){const t=this.oldest_;return delete this.entries_[t.key_],t.newer&&(t.newer.older=null),this.oldest_=t.newer,this.oldest_||(this.newest_=null),--this.count_,t.value_}replace(t,e){this.get(t),this.entries_[t].value_=e}set(t,e){K(!(t in this.entries_),"Tried to set a value for a key that is used already");const i={key_:t,newer:null,older:this.newest_,value_:e};this.newest_?this.newest_.newer=i:this.oldest_=i,this.newest_=i,this.entries_[t]=i,++this.count_}setSize(t){this.highWaterMark=t}};function mx(t,e,i,n){return void 0!==n?(n[0]=t,n[1]=e,n[2]=i,n):[t,e,i]}function _x(t,e,i){return t+"/"+e+"/"+i}function yx(t){return _x(t[0],t[1],t[2])}function wx(t){return(t[1]<<t[0])+t[2]}const xx=class extends px{clear(){for(;this.getCount()>0;)this.pop().release();super.clear()}expireCache(t){for(;this.canExpireCache()&&!(this.peekLast().getKey()in t);)this.pop().release()}pruneExceptNewestZ(){if(0===this.getCount())return;const t=this.peekFirstKey().split("/").map(Number)[0];this.forEach((e=>{e.tileCoord[0]!==t&&(this.remove(yx(e.tileCoord)),e.release())}))}};function bx(t){return t?Array.isArray(t)?function(e){return t}:"function"==typeof t?t:function(e){return[t]}:null}const vx=class extends D{constructor(t){super(),this.projection=Se(t.projection),this.attributions_=bx(t.attributions),this.attributionsCollapsible_=void 0===t.attributionsCollapsible||t.attributionsCollapsible,this.loading=!1,this.state_=void 0!==t.state?t.state:"ready",this.wrapX_=void 0!==t.wrapX&&t.wrapX,this.interpolate_=!!t.interpolate,this.viewResolver=null,this.viewRejector=null;const e=this;this.viewPromise_=new Promise((function(t,i){e.viewResolver=t,e.viewRejector=i}))}getAttributions(){return this.attributions_}getAttributionsCollapsible(){return this.attributionsCollapsible_}getProjection(){return this.projection}getResolutions(t){return null}getView(){return this.viewPromise_}getState(){return this.state_}getWrapX(){return this.wrapX_}getInterpolate(){return this.interpolate_}refresh(){this.changed()}setAttributions(t){this.attributions_=bx(t),this.changed()}setState(t){this.state_=t,this.changed()}},Ex=[0,0,0],Sx=class{constructor(t){let e;if(this.minZoom=void 0!==t.minZoom?t.minZoom:0,this.resolutions_=t.resolutions,K(function(t,e,i){const n=((t,e)=>e-t)||a;return t.every((function(e,i){if(0===i)return!0;const r=n(t[i-1],e);return!(r>0||0===r)}))}(this.resolutions_),"`resolutions` must be sorted in descending order"),!t.origins)for(let t=0,i=this.resolutions_.length-1;t<i;++t)if(e){if(this.resolutions_[t]/this.resolutions_[t+1]!==e){e=void 0;break}}else e=this.resolutions_[t]/this.resolutions_[t+1];this.zoomFactor_=e,this.maxZoom=this.resolutions_.length-1,this.origin_=void 0!==t.origin?t.origin:null,this.origins_=null,void 0!==t.origins&&(this.origins_=t.origins,K(this.origins_.length==this.resolutions_.length,"Number of `origins` and `resolutions` must be equal"));const i=t.extent;void 0===i||this.origin_||this.origins_||(this.origin_=se(i)),K(!this.origin_&&this.origins_||this.origin_&&!this.origins_,"Either `origin` or `origins` must be configured, never both"),this.tileSizes_=null,void 0!==t.tileSizes&&(this.tileSizes_=t.tileSizes,K(this.tileSizes_.length==this.resolutions_.length,"Number of `tileSizes` and `resolutions` must be equal")),this.tileSize_=void 0!==t.tileSize?t.tileSize:this.tileSizes_?null:ft,K(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,"Either `tileSize` or `tileSizes` must be configured, never both"),this.extent_=void 0!==i?i:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],void 0!==t.sizes?this.fullTileRanges_=t.sizes.map(((t,e)=>{const n=new ma(Math.min(0,t[0]),Math.max(t[0]-1,-1),Math.min(0,t[1]),Math.max(t[1]-1,-1));if(i){const t=this.getTileRangeForExtentAndZ(i,e);n.minX=Math.max(t.minX,n.minX),n.maxX=Math.min(t.maxX,n.maxX),n.minY=Math.max(t.minY,n.minY),n.maxY=Math.min(t.maxY,n.maxY)}return n})):i&&this.calculateTileRanges_(i)}forEachTileCoord(t,e,i){const n=this.getTileRangeForExtentAndZ(t,e);for(let t=n.minX,r=n.maxX;t<=r;++t)for(let r=n.minY,s=n.maxY;r<=s;++r)i([e,t,r])}forEachTileCoordParentTileRange(t,e,i,n){let r,s,o,a=null,l=t[0]-1;for(2===this.zoomFactor_?(s=t[1],o=t[2]):a=this.getTileCoordExtent(t,n);l>=this.minZoom;){if(void 0!==s&&void 0!==o?(s=Math.floor(s/2),o=Math.floor(o/2),r=pa(s,s,o,o,i)):r=this.getTileRangeForExtentAndZ(a,l,i),e(l,r))return!0;--l}return!1}getExtent(){return this.extent_}getMaxZoom(){return this.maxZoom}getMinZoom(){return this.minZoom}getOrigin(t){return this.origin_?this.origin_:this.origins_[t]}getResolution(t){return this.resolutions_[t]}getResolutions(){return this.resolutions_}getTileCoordChildTileRange(t,e,i){if(t[0]<this.maxZoom){if(2===this.zoomFactor_){const i=2*t[1],n=2*t[2];return pa(i,i+1,n,n+1,e)}const n=this.getTileCoordExtent(t,i||this.tmpExtent_);return this.getTileRangeForExtentAndZ(n,t[0]+1,e)}return null}getTileRangeForTileCoordAndZ(t,e,i){if(e>this.maxZoom||e<this.minZoom)return null;const n=t[0],r=t[1],s=t[2];if(e===n)return pa(r,s,r,s,i);if(this.zoomFactor_){const t=Math.pow(this.zoomFactor_,e-n),o=Math.floor(r*t),a=Math.floor(s*t);return e<n?pa(o,o,a,a,i):pa(o,Math.floor(t*(r+1))-1,a,Math.floor(t*(s+1))-1,i)}const o=this.getTileCoordExtent(t,this.tmpExtent_);return this.getTileRangeForExtentAndZ(o,e,i)}getTileRangeForExtentAndZ(t,e,i){this.getTileCoordForXYAndZ_(t[0],t[3],e,!1,Ex);const n=Ex[1],r=Ex[2];return this.getTileCoordForXYAndZ_(t[2],t[1],e,!0,Ex),pa(n,Ex[1],r,Ex[2],i)}getTileCoordCenter(t){const e=this.getOrigin(t[0]),i=this.getResolution(t[0]),n=un(this.getTileSize(t[0]),this.tmpSize_);return[e[0]+(t[1]+.5)*n[0]*i,e[1]-(t[2]+.5)*n[1]*i]}getTileCoordExtent(t,e){const i=this.getOrigin(t[0]),n=this.getResolution(t[0]),r=un(this.getTileSize(t[0]),this.tmpSize_),s=i[0]+t[1]*r[0]*n,o=i[1]-(t[2]+1)*r[1]*n;return Gt(s,o,s+r[0]*n,o+r[1]*n,e)}getTileCoordForCoordAndResolution(t,e,i){return this.getTileCoordForXYAndResolution_(t[0],t[1],e,!1,i)}getTileCoordForXYAndResolution_(t,e,i,n,r){const s=this.getZForResolution(i),o=i/this.getResolution(s),a=this.getOrigin(s),l=un(this.getTileSize(s),this.tmpSize_);let h=o*(t-a[0])/i/l[0],c=o*(a[1]-e)/i/l[1];return n?(h=ot(h,5)-1,c=ot(c,5)-1):(h=st(h,5),c=st(c,5)),mx(s,h,c,r)}getTileCoordForXYAndZ_(t,e,i,n,r){const s=this.getOrigin(i),o=this.getResolution(i),a=un(this.getTileSize(i),this.tmpSize_);let l=(t-s[0])/o/a[0],h=(s[1]-e)/o/a[1];return n?(l=ot(l,5)-1,h=ot(h,5)-1):(l=st(l,5),h=st(h,5)),mx(i,l,h,r)}getTileCoordForCoordAndZ(t,e,i){return this.getTileCoordForXYAndZ_(t[0],t[1],e,!1,i)}getTileCoordResolution(t){return this.resolutions_[t[0]]}getTileSize(t){return this.tileSize_?this.tileSize_:this.tileSizes_[t]}getFullTileRange(t){return this.fullTileRanges_?this.fullTileRanges_[t]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,t):null}getZForResolution(t,e){return $(l(this.resolutions_,t,e||0),this.minZoom,this.maxZoom)}tileCoordIntersectsViewport(t,e){return Gi(e,0,e.length,2,this.getTileCoordExtent(t))}calculateTileRanges_(t){const e=this.resolutions_.length,i=new Array(e);for(let n=this.minZoom;n<e;++n)i[n]=this.getTileRangeForExtentAndZ(t,n);this.fullTileRanges_=i}};function Ix(t){let e=t.getDefaultTileGrid();return e||(e=function(t,e,i,n){return function(t,e,i,n){n=void 0!==n?n:"top-left";const r=Cx(t,undefined,i);return new Sx({extent:t,origin:te(t,n),resolutions:r,tileSize:i})}(Tx(t),0,void 0,void 0)}(t),t.setDefaultTileGrid(e)),e}function Mx(t){const e=t||{},i=e.extent||Se("EPSG:3857").getExtent(),n={extent:i,minZoom:e.minZoom,tileSize:e.tileSize,resolutions:Cx(i,e.maxZoom,e.tileSize,e.maxResolution)};return new Sx(n)}function Cx(t,e,i,n){e=void 0!==e?e:gt,i=un(void 0!==i?i:ft);const r=ne(t),s=ae(t);n=n>0?n:Math.max(s/i[0],r/i[1]);const o=e+1,a=new Array(o);for(let t=0;t<o;++t)a[t]=n/Math.pow(2,t);return a}function Tx(t){let e=(t=Se(t)).getExtent();if(!e){const i=180*pt.degrees/t.getMetersPerUnit();e=Gt(-i,-i,i,i)}return e}class Rx extends r{constructor(t,e){super(t),this.tile=e}}const Ax=class extends vx{constructor(t){super({attributions:t.attributions,attributionsCollapsible:t.attributionsCollapsible,projection:t.projection,state:t.state,wrapX:t.wrapX,interpolate:t.interpolate}),this.on,this.once,this.un,this.opaque_=void 0!==t.opaque&&t.opaque,this.tilePixelRatio_=void 0!==t.tilePixelRatio?t.tilePixelRatio:1,this.tileGrid=void 0!==t.tileGrid?t.tileGrid:null;this.tileGrid&&un(this.tileGrid.getTileSize(this.tileGrid.getMinZoom()),[256,256]),this.tileCache=new xx(t.cacheSize||0),this.tmpSize=[0,0],this.key_=t.key||"",this.tileOptions={transition:t.transition,interpolate:t.interpolate},this.zDirection=t.zDirection?t.zDirection:0}canExpireCache(){return this.tileCache.canExpireCache()}expireCache(t,e){const i=this.getTileCacheForProjection(t);i&&i.expireCache(e)}forEachLoadedTile(t,e,i,n){const r=this.getTileCacheForProjection(t);if(!r)return!1;let s,o,a,l=!0;for(let t=i.minX;t<=i.maxX;++t)for(let h=i.minY;h<=i.maxY;++h)o=_x(e,t,h),a=!1,r.containsKey(o)&&(s=r.get(o),a=2===s.getState(),a&&(a=!1!==n(s))),a||(l=!1);return l}getGutterForProjection(t){return 0}getKey(){return this.key_}setKey(t){this.key_!==t&&(this.key_=t,this.changed())}getOpaque(t){return this.opaque_}getResolutions(t){const e=t?this.getTileGridForProjection(t):this.tileGrid;return e?e.getResolutions():null}getTile(t,e,i,n,r){return k()}getTileGrid(){return this.tileGrid}getTileGridForProjection(t){return this.tileGrid?this.tileGrid:Ix(t)}getTileCacheForProjection(t){const e=this.getProjection();return K(null===e||Te(e,t),"A VectorTile source can only be rendered if it has a projection compatible with the view projection."),this.tileCache}getTilePixelRatio(t){return this.tilePixelRatio_}getTilePixelSize(t,e,i){const n=this.getTileGridForProjection(i),r=this.getTilePixelRatio(e),s=un(n.getTileSize(t),this.tmpSize);return 1==r?s:cn(s,r,this.tmpSize)}getTileCoordForTileUrlFunction(t,e){e=void 0!==e?e:this.getProjection();const i=this.getTileGridForProjection(e);return this.getWrapX()&&e.isGlobal()&&(t=function(t,e,i){const n=e[0],r=t.getTileCoordCenter(e),s=Tx(i);if(!Ot(s,r)){const e=ae(s),i=Math.ceil((s[0]-r[0])/e);return r[0]+=e*i,t.getTileCoordForCoordAndZ(r,n)}return e}(i,t,e)),function(t,e){const i=t[0],n=t[1],r=t[2];if(e.getMinZoom()>i||i>e.getMaxZoom())return!1;const s=e.getFullTileRange(i);return!s||s.containsXY(n,r)}(t,i)?t:null}clear(){this.tileCache.clear()}refresh(){this.clear(),super.refresh()}updateCacheSize(t,e){const i=this.getTileCacheForProjection(e);t>i.highWaterMark&&(i.highWaterMark=t)}useTile(t,e,i,n){}};function kx(t,e){const i=/\{z\}/g,n=/\{x\}/g,r=/\{y\}/g,s=/\{-y\}/g;return function(o,a,l){if(o)return t.replace(i,o[0].toString()).replace(n,o[1].toString()).replace(r,o[2].toString()).replace(s,(function(){const t=o[0],i=e.getFullTileRange(t);if(!i)throw new Error("The {-y} placeholder requires a tile grid with extent");return(i.getHeight()-o[2]-1).toString()}))}}function Px(t){return 1===t.length?t[0]:function(e,i,n){if(!e)return;const r=et(wx(e),t.length);return t[r](e,i,n)}}function Lx(t){const e=[];let i=/\{([a-z])-([a-z])\}/.exec(t);if(i){const n=i[1].charCodeAt(0),r=i[2].charCodeAt(0);let s;for(s=n;s<=r;++s)e.push(t.replace(i[0],String.fromCharCode(s)));return e}if(i=/\{(\d+)-(\d+)\}/.exec(t),i){const n=parseInt(i[2],10);for(let r=parseInt(i[1],10);r<=n;r++)e.push(t.replace(i[0],r.toString()));return e}return e.push(t),e}class Nx extends Ax{constructor(t){super({attributions:t.attributions,cacheSize:t.cacheSize,opaque:t.opaque,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tilePixelRatio:t.tilePixelRatio,wrapX:t.wrapX,transition:t.transition,interpolate:t.interpolate,key:t.key,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection}),this.generateTileUrlFunction_=this.tileUrlFunction===Nx.prototype.tileUrlFunction,this.tileLoadFunction=t.tileLoadFunction,t.tileUrlFunction&&(this.tileUrlFunction=t.tileUrlFunction),this.urls=null,t.urls?this.setUrls(t.urls):t.url&&this.setUrl(t.url),this.tileLoadingKeys_={}}getTileLoadFunction(){return this.tileLoadFunction}getTileUrlFunction(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction}getUrls(){return this.urls}handleTileChange(t){const e=t.target,i=L(e),n=e.getState();let r;1==n?(this.tileLoadingKeys_[i]=!0,r="tileloadstart"):i in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[i],r=3==n?"tileloaderror":2==n?"tileloadend":void 0),null!=r&&this.dispatchEvent(new Rx(r,e))}setTileLoadFunction(t){this.tileCache.clear(),this.tileLoadFunction=t,this.changed()}setTileUrlFunction(t,e){this.tileUrlFunction=t,this.tileCache.pruneExceptNewestZ(),void 0!==e?this.setKey(e):this.changed()}setUrl(t){const e=Lx(t);this.urls=e,this.setUrls(e)}setUrls(t){this.urls=t;const e=t.join("\n");this.generateTileUrlFunction_?this.setTileUrlFunction(function(t,e){const i=t.length,n=new Array(i);for(let r=0;r<i;++r)n[r]=kx(t[r],e);return Px(n)}(t,this.tileGrid),e):this.setKey(e)}tileUrlFunction(t,e,i){}useTile(t,e,i){const n=_x(t,e,i);this.tileCache.containsKey(n)&&this.tileCache.get(n)}}const Dx=Nx;function Ox(t,e){t.getImage().src=e}const Fx=class extends Dx{constructor(t){super({attributions:t.attributions,cacheSize:t.cacheSize,opaque:t.opaque,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tileLoadFunction:t.tileLoadFunction?t.tileLoadFunction:Ox,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:t.wrapX,transition:t.transition,interpolate:void 0===t.interpolate||t.interpolate,key:t.key,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection}),this.crossOrigin=void 0!==t.crossOrigin?t.crossOrigin:null,this.tileClass=void 0!==t.tileClass?t.tileClass:oa,this.tileCacheForProjection={},this.tileGridForProjection={},this.reprojectionErrorThreshold_=t.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1}canExpireCache(){if(this.tileCache.canExpireCache())return!0;for(const t in this.tileCacheForProjection)if(this.tileCacheForProjection[t].canExpireCache())return!0;return!1}expireCache(t,e){const i=this.getTileCacheForProjection(t);this.tileCache.expireCache(this.tileCache==i?e:{});for(const t in this.tileCacheForProjection){const n=this.tileCacheForProjection[t];n.expireCache(n==i?e:{})}}getGutterForProjection(t){return this.getProjection()&&t&&!Te(this.getProjection(),t)?0:this.getGutter()}getGutter(){return 0}getKey(){let t=super.getKey();return this.getInterpolate()||(t+=":disable-interpolation"),t}getOpaque(t){return!(this.getProjection()&&t&&!Te(this.getProjection(),t))&&super.getOpaque(t)}getTileGridForProjection(t){const e=this.getProjection();if(this.tileGrid&&(!e||Te(e,t)))return this.tileGrid;const i=L(t);return i in this.tileGridForProjection||(this.tileGridForProjection[i]=Ix(t)),this.tileGridForProjection[i]}getTileCacheForProjection(t){const e=this.getProjection();if(!e||Te(e,t))return this.tileCache;const i=L(t);return i in this.tileCacheForProjection||(this.tileCacheForProjection[i]=new xx(this.tileCache.highWaterMark)),this.tileCacheForProjection[i]}createTile_(t,e,i,n,r,s){const o=[t,e,i],a=this.getTileCoordForTileUrlFunction(o,r),l=a?this.tileUrlFunction(a,n,r):void 0,h=new this.tileClass(o,void 0!==l?0:4,void 0!==l?l:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return h.key=s,h.addEventListener(w,this.handleTileChange.bind(this)),h}getTile(t,e,i,n,r){const s=this.getProjection();if(!s||!r||Te(s,r))return this.getTileInternal(t,e,i,n,s||r);const o=this.getTileCacheForProjection(r),a=[t,e,i];let l;const h=yx(a);o.containsKey(h)&&(l=o.get(h));const c=this.getKey();if(l&&l.key==c)return l;const u=this.getTileGridForProjection(s),d=this.getTileGridForProjection(r),g=this.getTileCoordForTileUrlFunction(a,r),f=new ga(s,u,r,d,a,g,this.getTilePixelRatio(n),this.getGutter(),((t,e,i,n)=>this.getTileInternal(t,e,i,n,s)),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.tileOptions);return f.key=c,l?(f.interimTile=l,f.refreshInterimChain(),o.replace(h,f)):o.set(h,f),f}getTileInternal(t,e,i,n,r){let s=null;const o=_x(t,e,i),a=this.getKey();if(this.tileCache.containsKey(o)){if(s=this.tileCache.get(o),s.key!=a){const l=s;s=this.createTile_(t,e,i,n,r,a),0==l.getState()?s.interimTile=l.interimTile:s.interimTile=l,s.refreshInterimChain(),this.tileCache.replace(o,s)}}else s=this.createTile_(t,e,i,n,r,a),this.tileCache.set(o,s);return s}setRenderReprojectionEdges(t){if(this.renderReprojectionEdges_!=t){this.renderReprojectionEdges_=t;for(const t in this.tileCacheForProjection)this.tileCacheForProjection[t].clear();this.changed()}}setTileGridForProjection(t,e){const i=Se(t);if(i){const t=L(i);t in this.tileGridForProjection||(this.tileGridForProjection[t]=e)}}clear(){super.clear();for(const t in this.tileCacheForProjection)this.tileCacheForProjection[t].clear()}},zx=class extends Fx{constructor(t){const e=void 0!==(t=t||{}).projection?t.projection:"EPSG:3857",i=void 0!==t.tileGrid?t.tileGrid:Mx({extent:Tx(e),maxResolution:t.maxResolution,maxZoom:t.maxZoom,minZoom:t.minZoom,tileSize:t.tileSize});super({attributions:t.attributions,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,interpolate:t.interpolate,opaque:t.opaque,projection:e,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileGrid:i,tileLoadFunction:t.tileLoadFunction,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:void 0===t.wrapX||t.wrapX,transition:t.transition,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection}),this.gutter_=void 0!==t.gutter?t.gutter:0}getGutter(){return this.gutter_}},Bx=class extends zx{constructor(t){let e;e=void 0!==(t=t||{}).attributions?t.attributions:['&#169; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors.'];const i=void 0!==t.crossOrigin?t.crossOrigin:"anonymous",n=void 0!==t.url?t.url:"https://tile.openstreetmap.org/{z}/{x}/{y}.png";super({attributions:e,attributionsCollapsible:!1,cacheSize:t.cacheSize,crossOrigin:i,interpolate:t.interpolate,maxZoom:void 0!==t.maxZoom?t.maxZoom:19,opaque:void 0===t.opaque||t.opaque,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileLoadFunction:t.tileLoadFunction,transition:t.transition,url:n,wrapX:t.wrapX,zDirection:t.zDirection})}},Gx=class extends Fx{constructor(t){const e=void 0!==t.hidpi&&t.hidpi;super({cacheSize:t.cacheSize,crossOrigin:"anonymous",interpolate:t.interpolate,opaque:!0,projection:Se("EPSG:3857"),reprojectionErrorThreshold:t.reprojectionErrorThreshold,state:"loading",tileLoadFunction:t.tileLoadFunction,tilePixelRatio:e?2:1,wrapX:void 0===t.wrapX||t.wrapX,transition:t.transition,zDirection:t.zDirection}),this.hidpi_=e,this.culture_=void 0!==t.culture?t.culture:"en-us",this.maxZoom_=void 0!==t.maxZoom?t.maxZoom:-1,this.apiKey_=t.key,this.imagerySet_=t.imagerySet,this.placeholderTiles_=t.placeholderTiles;const i="https://dev.virtualearth.net/REST/v1/Imagery/Metadata/"+this.imagerySet_+"?uriScheme=https&include=ImageryProviders&key="+this.apiKey_+"&c="+this.culture_;fetch(i).then((t=>t.json())).then((t=>this.handleImageryMetadataResponse(t)))}getApiKey(){return this.apiKey_}getImagerySet(){return this.imagerySet_}handleImageryMetadataResponse(t){if(200!=t.statusCode||"OK"!=t.statusDescription||"ValidCredentials"!=t.authenticationResultCode||1!=t.resourceSets.length||1!=t.resourceSets[0].resources.length)return void this.setState("error");const e=t.resourceSets[0].resources[0],i=-1==this.maxZoom_?e.zoomMax:this.maxZoom_,n=Tx(this.getProjection()),r=this.hidpi_?2:1,s=e.imageWidth==e.imageHeight?e.imageWidth/r:[e.imageWidth/r,e.imageHeight/r],o=Mx({extent:n,minZoom:e.zoomMin,maxZoom:i,tileSize:s});this.tileGrid=o;const a=this.culture_,l=this.hidpi_,h=this.placeholderTiles_;if(this.tileUrlFunction=Px(e.imageUrlSubdomains.map((function(t){const i=[0,0,0],n=e.imageUrl.replace("{subdomain}",t).replace("{culture}",a);return function(t,e,r){if(!t)return;mx(t[0],t[1],t[2],i);const s=new URL(n.replace("{quadkey}",function(t){const e=t[0],i=new Array(e);let n,r,s=1<<e-1;for(n=0;n<e;++n)r=48,t[1]&s&&(r+=1),t[2]&s&&(r+=2),i[n]=String.fromCharCode(r),s>>=1;return i.join("")}(i))),o=s.searchParams;return l&&(o.set("dpi","d1"),o.set("device","mobile")),!0===h?o.delete("n"):!1===h&&o.set("n","z"),s.toString()}}))),e.imageryProviders){const t=Re(Se("EPSG:4326"),this.getProjection());this.setAttributions((i=>{const n=[],r=i.viewState,s=this.getTileGrid(),o=s.getZForResolution(r.resolution,this.zDirection),a=s.getTileCoordForCoordAndZ(r.center,o)[0];return e.imageryProviders.map((function(e){let r=!1;const s=e.coverageAreas;for(let e=0,n=s.length;e<n;++e){const n=s[e];if(a>=n.zoomMin&&a<=n.zoomMax){const e=n.bbox;if(le(ce([e[1],e[0],e[3],e[2]],t),i.extent)){r=!0;break}}}r&&n.push(e.attribution)})),n.push('<a class="ol-attribution-bing-tos" href="https://www.microsoft.com/maps/product/terms.html" target="_blank">Terms of Use</a>'),n}))}this.setState("ready")}};function Yx(t,e){const i=[];Object.keys(e).forEach((function(t){null!==e[t]&&void 0!==e[t]&&i.push(t+"="+encodeURIComponent(e[t]))}));const n=i.join("&");return t=t.replace(/[?&]$/,""),(t+=t.includes("?")?"&":"?")+n}const Ux=class extends Fx{constructor(t){super({attributions:(t=t||{}).attributions,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,interpolate:t.interpolate,projection:t.projection,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileGrid:t.tileGrid,tileLoadFunction:t.tileLoadFunction,url:t.url,urls:t.urls,wrapX:void 0===t.wrapX||t.wrapX,transition:t.transition,zDirection:t.zDirection}),this.params_=Object.assign({},t.params),this.hidpi_=void 0===t.hidpi||t.hidpi,this.tmpExtent_=[1/0,1/0,-1/0,-1/0],this.setKey(this.getKeyForParams_())}getKeyForParams_(){let t=0;const e=[];for(const i in this.params_)e[t++]=i+"-"+this.params_[i];return e.join("/")}getParams(){return this.params_}getRequestUrl_(t,e,i,n,r,s){const o=this.urls;if(!o)return;let a;return a=1==o.length?o[0]:o[et(wx(t),o.length)],function(t,e,i,n,r,s){const o=r.getCode().split(/:(?=\d+$)/).pop(),a=i/n,l=[rt(ae(e)/a,4),rt(ne(e)/a,4)];return s.SIZE=l[0]+","+l[1],s.BBOX=e.join(","),s.BBOXSR=o,s.IMAGESR=o,s.DPI=Math.round(s.DPI?s.DPI*n:90*n),Yx(t.replace(/MapServer\/?$/,"MapServer/export").replace(/ImageServer\/?$/,"ImageServer/exportImage"),s)}(a,i,(this.tileGrid||this.getTileGridForProjection(r)).getResolution(t[0]),n,r,s)}getTilePixelRatio(t){return this.hidpi_?t:1}updateParams(t){Object.assign(this.params_,t),this.setKey(this.getKeyForParams_())}tileUrlFunction(t,e,i){let n=this.getTileGrid();if(n||(n=this.getTileGridForProjection(i)),n.getResolutions().length<=t[0])return;1==e||this.hidpi_||(e=1);const r=n.getTileCoordExtent(t,this.tmpExtent_);let s=un(n.getTileSize(t[0]),this.tmpSize);1!=e&&(s=cn(s,e,this.tmpSize));const o={F:"image",FORMAT:"PNG32",TRANSPARENT:!0};return Object.assign(o,this.params_),this.getRequestUrl_(t,s,r,e,i,o)}},Xx=class extends Fx{constructor(t){const e=void 0!==t.requestEncoding?t.requestEncoding:"KVP",i=t.tileGrid;let n=t.urls;void 0===n&&void 0!==t.url&&(n=Lx(t.url)),super({attributions:t.attributions,attributionsCollapsible:t.attributionsCollapsible,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,interpolate:t.interpolate,projection:t.projection,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileClass:t.tileClass,tileGrid:i,tileLoadFunction:t.tileLoadFunction,tilePixelRatio:t.tilePixelRatio,urls:n,wrapX:void 0!==t.wrapX&&t.wrapX,transition:t.transition,zDirection:t.zDirection}),this.version_=void 0!==t.version?t.version:"1.0.0",this.format_=void 0!==t.format?t.format:"image/jpeg",this.dimensions_=void 0!==t.dimensions?t.dimensions:{},this.layer_=t.layer,this.matrixSet_=t.matrixSet,this.style_=t.style,this.requestEncoding_=e,this.setKey(this.getKeyForDimensions_()),n&&n.length>0&&(this.tileUrlFunction=Px(n.map(this.createFromWMTSTemplate.bind(this))))}setUrls(t){this.urls=t;const e=t.join("\n");this.setTileUrlFunction(Px(t.map(this.createFromWMTSTemplate.bind(this))),e)}getDimensions(){return this.dimensions_}getFormat(){return this.format_}getLayer(){return this.layer_}getMatrixSet(){return this.matrixSet_}getRequestEncoding(){return this.requestEncoding_}getStyle(){return this.style_}getVersion(){return this.version_}getKeyForDimensions_(){const t=this.urls?this.urls.slice(0):[];for(const e in this.dimensions_)t.push(e+"-"+this.dimensions_[e]);return t.join("/")}updateDimensions(t){Object.assign(this.dimensions_,t),this.setKey(this.getKeyForDimensions_())}createFromWMTSTemplate(t){const e=this.requestEncoding_,i={layer:this.layer_,style:this.style_,tilematrixset:this.matrixSet_};"KVP"==e&&Object.assign(i,{Service:"WMTS",Request:"GetTile",Version:this.version_,Format:this.format_}),t="KVP"==e?Yx(t,i):t.replace(/\{(\w+?)\}/g,(function(t,e){return e.toLowerCase()in i?i[e.toLowerCase()]:t}));const n=this.tileGrid,r=this.dimensions_;return function(i,s,o){if(!i)return;const a={TileMatrix:n.getMatrixId(i[0]),TileCol:i[1],TileRow:i[2]};Object.assign(a,r);let l=t;return l="KVP"==e?Yx(l,a):l.replace(/\{(\w+?)\}/g,(function(t,e){return a[e]})),l}}},qx=class{constructor(){this.apikeys={BingMapKey:"AoTrgwP6rdBDsqtY-wq-Z5aA31YHoSzOyKStmu8t0-ZLUbO2LS4PbYoNYNe2SPSx",ArcGISKey:"AAPK3890bdd7605a4e3d9adb68f5790780eczWSlc-Uyepn0n8XMnNwNaiymNVrEy4ihJruVsf2PVK_lD086faryQVtQkssjkq84"}}getKeys(){return this.apikeys}};const Vx=class extends Sx{constructor(t){super({extent:t.extent,origin:t.origin,origins:t.origins,resolutions:t.resolutions,tileSize:t.tileSize,tileSizes:t.tileSizes,sizes:t.sizes}),this.matrixIds_=t.matrixIds}getMatrixId(t){return this.matrixIds_[t]}getMatrixIds(){return this.matrixIds_}},jx=Se("EPSG:3857"),Wx=jx.getExtent(),Zx=ae(Wx)/256,Hx=new Array(19),Kx=new Array(19);for(let t=0;t<19;++t)Hx[t]=Zx/Math.pow(2,t),Kx[t]=t;async function $x(t,e,i){t.once("rendercomplete",(function(){const n=t.getSize();e.width=n[0],e.height=n[1];const r=i;Array.prototype.forEach.call(t.getViewport().querySelectorAll(".ol-layer canvas, canvas.ol-layer"),(function(t){if(t.width>0){const e=t.parentNode.style.opacity||t.style.opacity;let i;r.globalAlpha=""===e?1:Number(e);const n=t.style.transform;i=n?n.match(/^matrix\(([^\(]*)\)$/)[1].split(",").map(Number):[parseFloat(t.style.width)/t.width,0,0,parseFloat(t.style.height)/t.height,0,0],CanvasRenderingContext2D.prototype.setTransform.apply(r,i);const s=t.parentNode.style.backgroundColor;s&&(r.fillStyle=s,r.fillRect(0,0,t.width,t.height)),r.drawImage(t,0,0)}})),r.globalAlpha=1,r.setTransform(1,0,0,1,0,0)})),t.renderSync()}let Jx=document.createElement("div");Jx.style.width="300px",Jx.style.background="white";let Qx=document.createElement("h3");Qx.textContent="Select features from both map",Qx.style.color="#32a852",Qx.style.fontWeight="bold";let tb=document.createElement("h3");tb.className="h3",tb.textContent="Enter parameters for Map 1";let eb=document.createElement("h3");function ib(t,e,i){let n=document.createElement("div"),r=document.createElement("input");return r.setAttribute("id",t),r.placeholder=i,r.style.marginLeft="10px",r.style.marginBottom="10px",r.className="input",r.value=e,sessionStorage.setItem(t,e),r.addEventListener("input",(t=>{sessionStorage.setItem(r.id,r.value)})),r.value,n.append(r),n}function nb(t){for(;t.firstChild;)t.removeChild(t.firstChild)}function rb(t,e){const i=t;let n=e.pixel,r=[];const s=parseInt(e.delta);if(!n)return i;n=n.map(Math.round);const o=i.width,a=i.height,l=i.data,h=new Uint8ClampedArray(l),c=4*(n[1]*o+n[0]),u=l[c],d=l[c+1],g=l[c+2];let f=[n];for(;f.length;){const t=[];for(let e=0,i=f.length;e<i;e++){const i=sb(f[e]);for(let e=0,n=i.length;e<n;e++){const n=i[e][0],r=i[e][1];if(n>=0&&n<o&&r>=0&&r<a){const e=4*(r*o+n),i=l[e],a=l[e+1],c=l[e+2];if(0===l[e+3])continue;Math.abs(u-i)<s&&Math.abs(d-a)<s&&Math.abs(g-c)<s&&(h[e]=255,h[e+1]=0,h[e+2]=0,h[e+3]=255,t.push([n,r])),l[e+3]=0}}}r.push(t),f=t}for(let t=0;t<h.length;t+=4)255===h[t]&&0===h[t+1]&&0===h[t+2]&&255===h[t+3]||(h[t]=0,h[t+1]=0,h[t+2]=0,h[t+3]=255);return{data:h,width:o,height:a}}function sb(t){const e=t[0],i=t[1];return[[e+1,i],[e-1,i],[e,i+1],[e,i-1]]}function ob(t,e,i,n){let r,s=[],o=!0,a=[],l=[],h=0,c=[],u=[],d=(n[2]-n[0])/e,g=(n[3]-n[1])/i;for(let e=0;e<t.length;e+=4)s.push(t[e]),c.push(t[e+1]);for(let t=0;t<s.length;t++)if(255===s[t]){let i=t%e,n=Math.floor(t/e);t:for(let r=25;r<=31;r+=2){let o=[],a=r,l=0,h=lb(r);for(let t=0-Math.floor(a/2);t<=Math.floor(a/2);t++){let r,s;for(let l=0-Math.floor(a/2);l<=Math.floor(a/2);l++){r=i+t,s=n+l;let a=s*e+r;o.push(c[a])}}for(let t=0;t<r;t++)for(let e=0;e<r;e++)h[t][e]*o[t*r+e]==255&&(l+=1);if(l>=8){u.push(t),s[t]=0;break t}}}let f=new Uint8ClampedArray(t.length);for(let t=0,e=0;t<f.length;t+=4,e++)f[t]=s[e],f[t+1]=0,f[t+2]=0,f[t+3]=255;let p=new ImageData(f,e,i),m=0;for(let t=0;t<s.length;t++)255===s[t]&&(m+=1);function _(){let t;for(let i=0;i<s.length;i++)if(255===s[i]){t=[i%e,Math.floor(i/e)];break}return t}function y(t){a.push(t);for(let t=0;t<m&&void 0!==a[t];t++){let i=a[t][0],n=a[t][1],r=n*e+i,o=ab([i,n],3),l=[];for(let t=0;t<o.length;t++){let i,n=o[t][0],a=o[t][1];n>=0&&a>=0&&(i=a*e+n),255===s[i]&&(l.push([n,a]),s[r]=0)}for(let t=0;t<l.length;t++){let e=!1;for(let i=0;i<a.length;i++){if(l[t][0]===a[i][0]&&l[t][1]===a[i][1]){e=!0;break}e=!1}!1===e&&a.push(l[t])}}a.length>=30?(l.push(a),h+=1,a=[]):a=[]}for(;o;){if(r=_(),void 0===r){o=!1;break}y(r)}let w=function(t,e,i,n,r){let s={type:"FeatureCollection",name:"junctions",crs:{type:"name",properties:{name:"EPSG:3857"}},features:[]},o=new Array(t.length);for(let s in t){let a=t[s]%e,l=Math.floor(t[s]/e),h=i[0]+a*n,c=i[3]-l*r;o[s]={x:h,y:c}}let a=(0,fx.b)().eps(10).minPts(1).distance("EUCLIDEAN").data(o),l=(a(),a.getClusters()),h=0;for(let t=0;t<l.length;t++){h++;let e=[l[t].x,l[t].y];s.features.push({type:"Feature",geometry:{type:"Point",coordinates:e},id:h})}return s}(u,e,n,d,g),x=function(t,e,i,n,r){let s={type:"FeatureCollection",name:"lines",crs:{type:"name",properties:{name:"EPSG:3857"}},features:[]},o=0;for(let e=0;e<t.length;e++){o++;let a=[];for(let s=0;s<t[e].length;s+=3){let o=t[e][s][0],l=t[e][s][1],h=[i[0]+o*n,i[3]-l*r];a.push(h)}s.features.push({type:"Feature",geometry:{type:"LineString",coordinates:a},id:o})}return s}(l,0,n,d,g);return[w,x,p]}function ab(t,e){let i=Math.floor(e/2),n=[];for(let e=t[0]-i;e<=t[0]+i;e++)for(let r=t[1]-i;r<=t[1]+i;r++)n.push([e,r]);return n}function lb(t){let e=t/2,i=[],n=Math.floor(e);for(let e=0;e<t;e++){let e=[];for(let i=0;i<t;i++)e.push(0);i.push(e)}for(let r=0;r<t;r++)for(let s=0;s<t;s++){let o,a=n-r,l=n-s,h=Math.sqrt(Math.pow(a,2)+Math.pow(l,2)),c=n-1;if(Math.sqrt(Math.pow(c,2)+Math.pow(c,2)),h<=e&&0===r|r===t-1)i[r][s]=1;else if(h<=e){i[r][s]=1,o=s,i[r][t-1-o]=1;break}}return i}eb.className="h3",eb.textContent="Enter parameters for Map 2";class hb extends D{constructor(t){if(super(),this.on,this.once,this.un,this.id_=void 0,this.geometryName_="geometry",this.style_=null,this.styleFunction_=void 0,this.geometryChangeKey_=null,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),t)if("function"==typeof t.getSimplifiedGeometry){const e=t;this.setGeometry(e)}else{const e=t;this.setProperties(e)}}clone(){const t=new hb(this.hasProperties()?this.getProperties():null);t.setGeometryName(this.getGeometryName());const e=this.getGeometry();e&&t.setGeometry(e.clone());const i=this.getStyle();return i&&t.setStyle(i),t}getGeometry(){return this.get(this.geometryName_)}getId(){return this.id_}getGeometryName(){return this.geometryName_}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}handleGeometryChange_(){this.changed()}handleGeometryChanged_(){this.geometryChangeKey_&&(T(this.geometryChangeKey_),this.geometryChangeKey_=null);const t=this.getGeometry();t&&(this.geometryChangeKey_=M(t,w,this.handleGeometryChange_,this)),this.changed()}setGeometry(t){this.set(this.geometryName_,t)}setStyle(t){this.style_=t,this.styleFunction_=t?function(t){if("function"==typeof t)return t;let e;return Array.isArray(t)?e=t:(K("function"==typeof t.getZIndex,"Expected an `ol/style/Style` or an array of `ol/style/Style.js`"),e=[t]),function(){return e}}(t):void 0,this.changed()}setId(t){this.id_=t,this.changed()}setGeometryName(t){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_),this.geometryName_=t,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),this.handleGeometryChanged_()}}const cb=hb,ub={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},db=[ub.FILL],gb=[ub.STROKE],fb=[ub.BEGIN_PATH],pb=[ub.CLOSE_PATH],mb=ub,_b=class{drawCustom(t,e,i,n,r){}drawGeometry(t){}setStyle(t){}drawCircle(t,e,i){}drawFeature(t,e,i){}drawGeometryCollection(t,e,i){}drawLineString(t,e,i){}drawMultiLineString(t,e,i){}drawMultiPoint(t,e,i){}drawMultiPolygon(t,e,i){}drawPoint(t,e,i){}drawPolygon(t,e,i){}drawText(t,e,i){}setFillStrokeStyle(t,e){}setImageStyle(t,e){}setTextStyle(t,e){}},yb=class extends _b{constructor(t,e,i,n){super(),this.tolerance=t,this.maxExtent=e,this.pixelRatio=n,this.maxLineWidth=0,this.resolution=i,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_=null,this.bufferedMaxExtent_=null,this.instructions=[],this.coordinates=[],this.tmpCoordinate_=[],this.hitDetectionInstructions=[],this.state={}}applyPixelRatio(t){const e=this.pixelRatio;return 1==e?t:t.map((function(t){return t*e}))}appendFlatPointCoordinates(t,e){const i=this.getBufferedMaxExtent(),n=this.tmpCoordinate_,r=this.coordinates;let s=r.length;for(let o=0,a=t.length;o<a;o+=e)n[0]=t[o],n[1]=t[o+1],Ot(i,n)&&(r[s++]=n[0],r[s++]=n[1]);return s}appendFlatLineCoordinates(t,e,i,n,r,s){const o=this.coordinates;let a=o.length;const l=this.getBufferedMaxExtent();s&&(e+=n);let h=t[e],c=t[e+1];const u=this.tmpCoordinate_;let d,g,f,p=!0;for(d=e+n;d<i;d+=n)u[0]=t[d],u[1]=t[d+1],f=Bt(l,u),f!==g?(p&&(o[a++]=h,o[a++]=c,p=!1),o[a++]=u[0],o[a++]=u[1]):f===kt.INTERSECTING?(o[a++]=u[0],o[a++]=u[1],p=!1):p=!0,h=u[0],c=u[1],g=f;return(r&&p||d===e+n)&&(o[a++]=h,o[a++]=c),a}drawCustomCoordinates_(t,e,i,n,r){for(let s=0,o=i.length;s<o;++s){const o=i[s],a=this.appendFlatLineCoordinates(t,e,o,n,!1,!1);r.push(a),e=o}return e}drawCustom(t,e,i,n,r){this.beginGeometry(t,e,r);const s=t.getType(),o=t.getStride(),a=this.coordinates.length;let l,h,c,u,d;switch(s){case"MultiPolygon":l=t.getOrientedFlatCoordinates(),u=[];const e=t.getEndss();d=0;for(let t=0,i=e.length;t<i;++t){const i=[];d=this.drawCustomCoordinates_(l,d,e[t],o,i),u.push(i)}this.instructions.push([mb.CUSTOM,a,u,t,i,Mi,r]),this.hitDetectionInstructions.push([mb.CUSTOM,a,u,t,n||i,Mi,r]);break;case"Polygon":case"MultiLineString":c=[],l="Polygon"==s?t.getOrientedFlatCoordinates():t.getFlatCoordinates(),d=this.drawCustomCoordinates_(l,0,t.getEnds(),o,c),this.instructions.push([mb.CUSTOM,a,c,t,i,Ii,r]),this.hitDetectionInstructions.push([mb.CUSTOM,a,c,t,n||i,Ii,r]);break;case"LineString":case"Circle":l=t.getFlatCoordinates(),h=this.appendFlatLineCoordinates(l,0,l.length,o,!1,!1),this.instructions.push([mb.CUSTOM,a,h,t,i,Si,r]),this.hitDetectionInstructions.push([mb.CUSTOM,a,h,t,n||i,Si,r]);break;case"MultiPoint":l=t.getFlatCoordinates(),h=this.appendFlatPointCoordinates(l,o),h>a&&(this.instructions.push([mb.CUSTOM,a,h,t,i,Si,r]),this.hitDetectionInstructions.push([mb.CUSTOM,a,h,t,n||i,Si,r]));break;case"Point":l=t.getFlatCoordinates(),this.coordinates.push(l[0],l[1]),h=this.coordinates.length,this.instructions.push([mb.CUSTOM,a,h,t,i,void 0,r]),this.hitDetectionInstructions.push([mb.CUSTOM,a,h,t,n||i,void 0,r])}this.endGeometry(e)}beginGeometry(t,e,i){this.beginGeometryInstruction1_=[mb.BEGIN_GEOMETRY,e,0,t,i],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[mb.BEGIN_GEOMETRY,e,0,t,i],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)}finish(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}}reverseHitDetectionInstructions(){const t=this.hitDetectionInstructions;let e;t.reverse();const i=t.length;let n,r,s=-1;for(e=0;e<i;++e)n=t[e],r=n[0],r==mb.END_GEOMETRY?s=e:r==mb.BEGIN_GEOMETRY&&(n[2]=e,h(this.hitDetectionInstructions,s,e),s=-1)}setFillStrokeStyle(t,e){const i=this.state;if(t){const e=t.getColor();i.fillPatternScale=e&&"object"==typeof e&&"src"in e?this.pixelRatio:1,i.fillStyle=Jn(e||ar)}else i.fillStyle=void 0;if(e){const t=e.getColor();i.strokeStyle=Jn(t||ur);const n=e.getLineCap();i.lineCap=void 0!==n?n:lr;const r=e.getLineDash();i.lineDash=r?r.slice():hr;const s=e.getLineDashOffset();i.lineDashOffset=s||0;const o=e.getLineJoin();i.lineJoin=void 0!==o?o:cr;const a=e.getWidth();i.lineWidth=void 0!==a?a:1;const l=e.getMiterLimit();i.miterLimit=void 0!==l?l:10,i.lineWidth>this.maxLineWidth&&(this.maxLineWidth=i.lineWidth,this.bufferedMaxExtent_=null)}else i.strokeStyle=void 0,i.lineCap=void 0,i.lineDash=null,i.lineDashOffset=void 0,i.lineJoin=void 0,i.lineWidth=void 0,i.miterLimit=void 0}createFill(t){const e=t.fillStyle,i=[mb.SET_FILL_STYLE,e];return"string"!=typeof e&&i.push(t.fillPatternScale),i}applyStroke(t){this.instructions.push(this.createStroke(t))}createStroke(t){return[mb.SET_STROKE_STYLE,t.strokeStyle,t.lineWidth*this.pixelRatio,t.lineCap,t.lineJoin,t.miterLimit,this.applyPixelRatio(t.lineDash),t.lineDashOffset*this.pixelRatio]}updateFillStyle(t,e){const i=t.fillStyle;"string"==typeof i&&t.currentFillStyle==i||(void 0!==i&&this.instructions.push(e.call(this,t)),t.currentFillStyle=i)}updateStrokeStyle(t,e){const i=t.strokeStyle,n=t.lineCap,r=t.lineDash,s=t.lineDashOffset,o=t.lineJoin,a=t.lineWidth,l=t.miterLimit;(t.currentStrokeStyle!=i||t.currentLineCap!=n||r!=t.currentLineDash&&!u(t.currentLineDash,r)||t.currentLineDashOffset!=s||t.currentLineJoin!=o||t.currentLineWidth!=a||t.currentMiterLimit!=l)&&(void 0!==i&&e.call(this,t),t.currentStrokeStyle=i,t.currentLineCap=n,t.currentLineDash=r,t.currentLineDashOffset=s,t.currentLineJoin=o,t.currentLineWidth=a,t.currentMiterLimit=l)}endGeometry(t){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;const e=[mb.END_GEOMETRY,t];this.instructions.push(e),this.hitDetectionInstructions.push(e)}getBufferedMaxExtent(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=Nt(this.maxExtent),this.maxLineWidth>0)){const t=this.resolution*(this.maxLineWidth+1)/2;Lt(this.bufferedMaxExtent_,t,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_}},wb=class extends yb{constructor(t,e,i,n){super(t,e,i,n)}drawFlatCoordinatess_(t,e,i,n){const r=this.state,s=void 0!==r.fillStyle,o=void 0!==r.strokeStyle,a=i.length;this.instructions.push(fb),this.hitDetectionInstructions.push(fb);for(let r=0;r<a;++r){const s=i[r],a=this.coordinates.length,l=this.appendFlatLineCoordinates(t,e,s,n,!0,!o),h=[mb.MOVE_TO_LINE_TO,a,l];this.instructions.push(h),this.hitDetectionInstructions.push(h),o&&(this.instructions.push(pb),this.hitDetectionInstructions.push(pb)),e=s}return s&&(this.instructions.push(db),this.hitDetectionInstructions.push(db)),o&&(this.instructions.push(gb),this.hitDetectionInstructions.push(gb)),e}drawCircle(t,e,i){const n=this.state,r=n.fillStyle,s=n.strokeStyle;if(void 0===r&&void 0===s)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e,i),void 0!==n.fillStyle&&this.hitDetectionInstructions.push([mb.SET_FILL_STYLE,ar]),void 0!==n.strokeStyle&&this.hitDetectionInstructions.push([mb.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,hr,0]);const o=t.getFlatCoordinates(),a=t.getStride(),l=this.coordinates.length;this.appendFlatLineCoordinates(o,0,o.length,a,!1,!1);const h=[mb.CIRCLE,l];this.instructions.push(fb,h),this.hitDetectionInstructions.push(fb,h),void 0!==n.fillStyle&&(this.instructions.push(db),this.hitDetectionInstructions.push(db)),void 0!==n.strokeStyle&&(this.instructions.push(gb),this.hitDetectionInstructions.push(gb)),this.endGeometry(e)}drawPolygon(t,e,i){const n=this.state,r=n.fillStyle,s=n.strokeStyle;if(void 0===r&&void 0===s)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e,i),void 0!==n.fillStyle&&this.hitDetectionInstructions.push([mb.SET_FILL_STYLE,ar]),void 0!==n.strokeStyle&&this.hitDetectionInstructions.push([mb.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,hr,0]);const o=t.getEnds(),a=t.getOrientedFlatCoordinates(),l=t.getStride();this.drawFlatCoordinatess_(a,0,o,l),this.endGeometry(e)}drawMultiPolygon(t,e,i){const n=this.state,r=n.fillStyle,s=n.strokeStyle;if(void 0===r&&void 0===s)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e,i),void 0!==n.fillStyle&&this.hitDetectionInstructions.push([mb.SET_FILL_STYLE,ar]),void 0!==n.strokeStyle&&this.hitDetectionInstructions.push([mb.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,hr,0]);const o=t.getEndss(),a=t.getOrientedFlatCoordinates(),l=t.getStride();let h=0;for(let t=0,e=o.length;t<e;++t)h=this.drawFlatCoordinatess_(a,h,o[t],l);this.endGeometry(e)}finish(){this.reverseHitDetectionInstructions(),this.state=null;const t=this.tolerance;if(0!==t){const e=this.coordinates;for(let i=0,n=e.length;i<n;++i)e[i]=bi(e[i],t)}return super.finish()}setFillStrokeStyles_(){const t=this.state;void 0!==t.fillStyle&&this.updateFillStyle(t,this.createFill),void 0!==t.strokeStyle&&this.updateStrokeStyle(t,this.applyStroke)}};function xb(t,e,i,n,r){const s=[];let o=i,a=0,l=e.slice(i,2);for(;a<t&&o+r<n;){const[i,n]=l.slice(-2),h=e[o+r],c=e[o+r+1],u=Math.sqrt((h-i)*(h-i)+(c-n)*(c-n));if(a+=u,a>=t){const e=(t-a+u)/u,d=it(i,h,e),g=it(n,c,e);l.push(d,g),s.push(l),l=[d,g],a==t&&(o+=r),a=0}else if(a<t)l.push(e[o+r],e[o+r+1]),o+=r;else{const t=u-a,e=it(i,h,t/u),d=it(n,c,t/u);l.push(e,d),s.push(l),l=[e,d],a=0,o+=r}}return a>0&&s.push(l),s}function bb(t,e,i,n,r){let s,o,a,l,h,c,u,d,g,f,p=i,m=i,_=0,y=0,w=i;for(o=i;o<n;o+=r){const i=e[o],n=e[o+1];void 0!==h&&(g=i-h,f=n-c,l=Math.sqrt(g*g+f*f),void 0!==u&&(y+=a,s=Math.acos((u*g+d*f)/(a*l)),s>t&&(y>_&&(_=y,p=w,m=o),y=0,w=o-r)),a=l,u=g,d=f),h=i,c=n}return y+=l,y>_?[w,o]:[p,m]}const vb={left:0,center:.5,right:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1},Eb={Circle:wb,Default:yb,Image:class extends yb{constructor(t,e,i,n){super(t,e,i,n),this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.anchorX_=void 0,this.anchorY_=void 0,this.height_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.scale_=void 0,this.width_=void 0,this.declutterMode_=void 0,this.declutterImageWithText_=void 0}drawPoint(t,e,i){if(!this.image_||this.maxExtent&&!Ot(this.maxExtent,t.getFlatCoordinates()))return;this.beginGeometry(t,e,i);const n=t.getFlatCoordinates(),r=t.getStride(),s=this.coordinates.length,o=this.appendFlatPointCoordinates(n,r);this.instructions.push([mb.DRAW_IMAGE,s,o,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([mb.DRAW_IMAGE,s,o,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(e)}drawMultiPoint(t,e,i){if(!this.image_)return;this.beginGeometry(t,e,i);const n=t.getFlatCoordinates(),r=[];for(let e=0,i=n.length;e<i;e+=t.getStride())this.maxExtent&&!Ot(this.maxExtent,n.slice(e,e+2))||r.push(n[e],n[e+1]);const s=this.coordinates.length,o=this.appendFlatPointCoordinates(r,2);this.instructions.push([mb.DRAW_IMAGE,s,o,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([mb.DRAW_IMAGE,s,o,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(e)}finish(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,super.finish()}setImageStyle(t,e){const i=t.getAnchor(),n=t.getSize(),r=t.getOrigin();this.imagePixelRatio_=t.getPixelRatio(this.pixelRatio),this.anchorX_=i[0],this.anchorY_=i[1],this.hitDetectionImage_=t.getHitDetectionImage(),this.image_=t.getImage(this.pixelRatio),this.height_=n[1],this.opacity_=t.getOpacity(),this.originX_=r[0],this.originY_=r[1],this.rotateWithView_=t.getRotateWithView(),this.rotation_=t.getRotation(),this.scale_=t.getScaleArray(),this.width_=n[0],this.declutterMode_=t.getDeclutterMode(),this.declutterImageWithText_=e}},LineString:class extends yb{constructor(t,e,i,n){super(t,e,i,n)}drawFlatCoordinates_(t,e,i,n){const r=this.coordinates.length,s=this.appendFlatLineCoordinates(t,e,i,n,!1,!1),o=[mb.MOVE_TO_LINE_TO,r,s];return this.instructions.push(o),this.hitDetectionInstructions.push(o),i}drawLineString(t,e,i){const n=this.state,r=n.strokeStyle,s=n.lineWidth;if(void 0===r||void 0===s)return;this.updateStrokeStyle(n,this.applyStroke),this.beginGeometry(t,e,i),this.hitDetectionInstructions.push([mb.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,hr,0],fb);const o=t.getFlatCoordinates(),a=t.getStride();this.drawFlatCoordinates_(o,0,o.length,a),this.hitDetectionInstructions.push(gb),this.endGeometry(e)}drawMultiLineString(t,e,i){const n=this.state,r=n.strokeStyle,s=n.lineWidth;if(void 0===r||void 0===s)return;this.updateStrokeStyle(n,this.applyStroke),this.beginGeometry(t,e,i),this.hitDetectionInstructions.push([mb.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,hr,0],fb);const o=t.getEnds(),a=t.getFlatCoordinates(),l=t.getStride();let h=0;for(let t=0,e=o.length;t<e;++t)h=this.drawFlatCoordinates_(a,h,o[t],l);this.hitDetectionInstructions.push(gb),this.endGeometry(e)}finish(){const t=this.state;return null!=t.lastStroke&&t.lastStroke!=this.coordinates.length&&this.instructions.push(gb),this.reverseHitDetectionInstructions(),this.state=null,super.finish()}applyStroke(t){null!=t.lastStroke&&t.lastStroke!=this.coordinates.length&&(this.instructions.push(gb),t.lastStroke=this.coordinates.length),t.lastStroke=0,super.applyStroke(t),this.instructions.push(fb)}},Polygon:wb,Text:class extends yb{constructor(t,e,i,n){super(t,e,i,n),this.labels_=null,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=void 0,this.textRotation_=0,this.textFillState_=null,this.fillStates={},this.fillStates[ar]={fillStyle:ar},this.textStrokeState_=null,this.strokeStates={},this.textState_={},this.textStates={},this.textKey_="",this.fillKey_="",this.strokeKey_="",this.declutterMode_=void 0,this.declutterImageWithText_=void 0}finish(){const t=super.finish();return t.textStates=this.textStates,t.fillStates=this.fillStates,t.strokeStates=this.strokeStates,t}drawText(t,e,i){const n=this.textFillState_,r=this.textStrokeState_,s=this.textState_;if(""===this.text_||!s||!n&&!r)return;const o=this.coordinates;let a=o.length;const l=t.getType();let h=null,c=t.getStride();if("line"!==s.placement||"LineString"!=l&&"MultiLineString"!=l&&"Polygon"!=l&&"MultiPolygon"!=l){let n=s.overflow?null:[];switch(l){case"Point":case"MultiPoint":h=t.getFlatCoordinates();break;case"LineString":h=t.getFlatMidpoint();break;case"Circle":h=t.getCenter();break;case"MultiLineString":h=t.getFlatMidpoints(),c=2;break;case"Polygon":h=t.getFlatInteriorPoint(),s.overflow||n.push(h[2]/this.resolution),c=3;break;case"MultiPolygon":const e=t.getFlatInteriorPoints();h=[];for(let t=0,i=e.length;t<i;t+=3)s.overflow||n.push(e[t+2]/this.resolution),h.push(e[t],e[t+1]);if(0===h.length)return;c=2}const r=this.appendFlatPointCoordinates(h,c);if(r===a)return;if(n&&(r-a)/2!=h.length/c){let t=a/2;n=n.filter(((e,i)=>{const n=o[2*(t+i)]===h[i*c]&&o[2*(t+i)+1]===h[i*c+1];return n||--t,n}))}this.saveTextStates_(),(s.backgroundFill||s.backgroundStroke)&&(this.setFillStrokeStyle(s.backgroundFill,s.backgroundStroke),s.backgroundFill&&this.updateFillStyle(this.state,this.createFill),s.backgroundStroke&&(this.updateStrokeStyle(this.state,this.applyStroke),this.hitDetectionInstructions.push(this.createStroke(this.state)))),this.beginGeometry(t,e,i);let u=s.padding;if(u!=fr&&(s.scale[0]<0||s.scale[1]<0)){let t=s.padding[0],e=s.padding[1],i=s.padding[2],n=s.padding[3];s.scale[0]<0&&(e=-e,n=-n),s.scale[1]<0&&(t=-t,i=-i),u=[t,e,i,n]}const d=this.pixelRatio;this.instructions.push([mb.DRAW_IMAGE,a,r,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,this.declutterMode_,this.declutterImageWithText_,u==fr?fr:u.map((function(t){return t*d})),!!s.backgroundFill,!!s.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,n]);const g=1/d,f=this.state.fillStyle;s.backgroundFill&&(this.state.fillStyle=ar,this.hitDetectionInstructions.push(this.createFill(this.state))),this.hitDetectionInstructions.push([mb.DRAW_IMAGE,a,r,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[g,g],NaN,this.declutterMode_,this.declutterImageWithText_,u,!!s.backgroundFill,!!s.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_?ar:this.fillKey_,this.textOffsetX_,this.textOffsetY_,n]),s.backgroundFill&&(this.state.fillStyle=f,this.hitDetectionInstructions.push(this.createFill(this.state))),this.endGeometry(e)}else{if(!le(this.maxExtent,t.getExtent()))return;let n;if(h=t.getFlatCoordinates(),"LineString"==l)n=[h.length];else if("MultiLineString"==l)n=t.getEnds();else if("Polygon"==l)n=t.getEnds().slice(0,1);else if("MultiPolygon"==l){const e=t.getEndss();n=[];for(let t=0,i=e.length;t<i;++t)n.push(e[t][0])}this.beginGeometry(t,e,i);const r=s.repeat,u=r?void 0:s.textAlign;let d=0;for(let t=0,e=n.length;t<e;++t){let e;e=r?xb(r*this.resolution,h,d,n[t],c):[h.slice(d,n[t])];for(let i=0,r=e.length;i<r;++i){const r=e[i];let l=0,h=r.length;if(null==u){const t=bb(s.maxAngle,r,0,r.length,2);l=t[0],h=t[1]}for(let t=l;t<h;t+=c)o.push(r[t],r[t+1]);const g=o.length;d=n[t],this.drawChars_(a,g),a=g}}this.endGeometry(e)}}saveTextStates_(){const t=this.textStrokeState_,e=this.textState_,i=this.textFillState_,n=this.strokeKey_;t&&(n in this.strokeStates||(this.strokeStates[n]={strokeStyle:t.strokeStyle,lineCap:t.lineCap,lineDashOffset:t.lineDashOffset,lineWidth:t.lineWidth,lineJoin:t.lineJoin,miterLimit:t.miterLimit,lineDash:t.lineDash}));const r=this.textKey_;r in this.textStates||(this.textStates[r]={font:e.font,textAlign:e.textAlign||dr,justify:e.justify,textBaseline:e.textBaseline||gr,scale:e.scale});const s=this.fillKey_;i&&(s in this.fillStates||(this.fillStates[s]={fillStyle:i.fillStyle}))}drawChars_(t,e){const i=this.textStrokeState_,n=this.textState_,r=this.strokeKey_,s=this.textKey_,o=this.fillKey_;this.saveTextStates_();const a=this.pixelRatio,l=vb[n.textBaseline],h=this.textOffsetY_*a,c=this.text_,u=i?i.lineWidth*Math.abs(n.scale[0])/2:0;this.instructions.push([mb.DRAW_CHARS,t,e,l,n.overflow,o,n.maxAngle,a,h,r,u*a,c,s,1,this.declutterMode_]),this.hitDetectionInstructions.push([mb.DRAW_CHARS,t,e,l,n.overflow,o?ar:o,n.maxAngle,a,h,r,u*a,c,s,1/a,this.declutterMode_])}setTextStyle(t,e){let i,n,r;if(t){const e=t.getFill();e?(n=this.textFillState_,n||(n={},this.textFillState_=n),n.fillStyle=Jn(e.getColor()||ar)):(n=null,this.textFillState_=n);const s=t.getStroke();if(s){r=this.textStrokeState_,r||(r={},this.textStrokeState_=r);const t=s.getLineDash(),e=s.getLineDashOffset(),i=s.getWidth(),n=s.getMiterLimit();r.lineCap=s.getLineCap()||lr,r.lineDash=t?t.slice():hr,r.lineDashOffset=void 0===e?0:e,r.lineJoin=s.getLineJoin()||cr,r.lineWidth=void 0===i?1:i,r.miterLimit=void 0===n?10:n,r.strokeStyle=Jn(s.getColor()||ur)}else r=null,this.textStrokeState_=r;i=this.textState_;const o=t.getFont()||or;wr(o);const a=t.getScaleArray();i.overflow=t.getOverflow(),i.font=o,i.maxAngle=t.getMaxAngle(),i.placement=t.getPlacement(),i.textAlign=t.getTextAlign(),i.repeat=t.getRepeat(),i.justify=t.getJustify(),i.textBaseline=t.getTextBaseline()||gr,i.backgroundFill=t.getBackgroundFill(),i.backgroundStroke=t.getBackgroundStroke(),i.padding=t.getPadding()||fr,i.scale=void 0===a?[1,1]:a;const l=t.getOffsetX(),h=t.getOffsetY(),c=t.getRotateWithView(),u=t.getRotation();this.text_=t.getText()||"",this.textOffsetX_=void 0===l?0:l,this.textOffsetY_=void 0===h?0:h,this.textRotateWithView_=void 0!==c&&c,this.textRotation_=void 0===u?0:u,this.strokeKey_=r?("string"==typeof r.strokeStyle?r.strokeStyle:L(r.strokeStyle))+r.lineCap+r.lineDashOffset+"|"+r.lineWidth+r.lineJoin+r.miterLimit+"["+r.lineDash.join()+"]":"",this.textKey_=i.font+i.scale+(i.textAlign||"?")+(i.repeat||"?")+(i.justify||"?")+(i.textBaseline||"?"),this.fillKey_=n&&n.fillStyle?"string"==typeof n.fillStyle?n.fillStyle:"|"+L(n.fillStyle):""}else this.text_="";this.declutterMode_=t.getDeclutterMode(),this.declutterImageWithText_=e}}},Sb=class{constructor(t,e,i,n){this.tolerance_=t,this.maxExtent_=e,this.pixelRatio_=n,this.resolution_=i,this.buildersByZIndex_={}}finish(){const t={};for(const e in this.buildersByZIndex_){t[e]=t[e]||{};const i=this.buildersByZIndex_[e];for(const n in i){const r=i[n].finish();t[e][n]=r}}return t}getBuilder(t,e){const i=void 0!==t?t.toString():"0";let n=this.buildersByZIndex_[i];void 0===n&&(n={},this.buildersByZIndex_[i]=n);let r=n[e];return void 0===r&&(r=new(0,Eb[e])(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),n[e]=r),r}};function Ib(t,e,i,n,r,s,o,a,l,h,c,u){let d=t[e],g=t[e+1],f=0,p=0,m=0,_=0;function y(){f=d,p=g,d=t[e+=n],g=t[e+1],_+=m,m=Math.sqrt((d-f)*(d-f)+(g-p)*(g-p))}do{y()}while(e<i-n&&_+m<s);let w=0===m?0:(s-_)/m;const x=it(f,d,w),b=it(p,g,w),v=e-n,E=_,S=s+a*l(h,r,c);for(;e<i-n&&_+m<S;)y();w=0===m?0:(S-_)/m;const I=it(f,d,w),M=it(p,g,w);let C;if(u){const t=[x,b,I,M];si(t,0,4,2,u,t,t),C=t[0]>t[2]}else C=x>I;const T=Math.PI,R=[],A=v+n===e;let k;if(m=0,_=E,d=t[e=v],g=t[e+1],A){y(),k=Math.atan2(g-p,d-f),C&&(k+=k>0?-T:T);const t=(I+x)/2,e=(M+b)/2;return R[0]=[t,e,(S-s)/2,k,r],R}for(let t=0,u=(r=r.replace(/\n/g," ")).length;t<u;){y();let x=Math.atan2(g-p,d-f);if(C&&(x+=x>0?-T:T),void 0!==k){let t=x-k;if(t+=t>T?-2*T:t<-T?2*T:0,Math.abs(t)>o)return null}k=x;const b=t;let v=0;for(;t<u;++t){const o=a*l(h,r[C?u-t-1:t],c);if(e+n<i&&_+m<s+v+o/2)break;v+=o}if(t===b)continue;const E=C?r.substring(u-b,u-t):r.substring(b,t);w=0===m?0:(s+v/2-_)/m;const S=it(f,d,w),I=it(p,g,w);R.push([S,I,v/2,x,E]),s+=v}return R}function Mb(t,e,i,n){let r=t[e],s=t[e+1],o=0;for(let a=e+n;a<i;a+=n){const e=t[a],i=t[a+1];o+=Math.sqrt((e-r)*(e-r)+(i-s)*(i-s)),r=e,s=i}return o}const Cb=[1/0,1/0,-1/0,-1/0],Tb=[],Rb=[],Ab=[],kb=[];function Pb(t){return t[3].declutterBox}const Lb=new RegExp("["+String.fromCharCode(1425)+"-"+String.fromCharCode(2303)+String.fromCharCode(64285)+"-"+String.fromCharCode(65023)+String.fromCharCode(65136)+"-"+String.fromCharCode(65276)+String.fromCharCode(67584)+"-"+String.fromCharCode(69631)+String.fromCharCode(124928)+"-"+String.fromCharCode(126975)+"]");function Nb(t,e){return"start"===e?e=Lb.test(t)?"right":"left":"end"===e&&(e=Lb.test(t)?"left":"right"),vb[e]}function Db(t,e,i){return i>0&&t.push("\n",""),t.push(e,""),t}const Ob=class{constructor(t,e,i,n,r){this.overlaps=i,this.pixelRatio=e,this.resolution=t,this.alignAndScaleFill_,this.instructions=n.instructions,this.coordinates=n.coordinates,this.coordinateCache_={},this.renderedTransform_=[1,0,0,1,0,0],this.hitDetectionInstructions=n.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=n.fillStates||{},this.strokeStates=n.strokeStates||{},this.textStates=n.textStates||{},this.widths_={},this.labels_={},this.zIndexContext_=r?new ea:null}getZIndexContext(){return this.zIndexContext_}createLabel(t,e,i,n){const r=t+e+i+n;if(this.labels_[r])return this.labels_[r];const s=n?this.strokeStates[n]:null,o=i?this.fillStates[i]:null,a=this.textStates[e],l=this.pixelRatio,h=[a.scale[0]*l,a.scale[1]*l],c=Array.isArray(t),u=a.justify?vb[a.justify]:Nb(Array.isArray(t)?t[0]:t,a.textAlign||dr),d=n&&s.lineWidth?s.lineWidth:0,g=c?t:t.split("\n").reduce(Db,[]),{width:f,height:p,widths:m,heights:_,lineWidths:y}=function(t,e){const i=[],n=[],r=[];let s=0,o=0,a=0,l=0;for(let h=0,c=e.length;h<=c;h+=2){const u=e[h];if("\n"===u||h===c){s=Math.max(s,o),r.push(o),o=0,a+=l;continue}const d=e[h+1]||t.font,g=vr(d,u);i.push(g),o+=g;const f=xr(d);n.push(f),l=Math.max(l,f)}return{width:s,height:a,widths:i,heights:n,lineWidths:r}}(a,g),w=f+d,x=[],b=(w+2)*h[0],v=(p+d)*h[1],E={width:b<0?Math.floor(b):Math.ceil(b),height:v<0?Math.floor(v):Math.ceil(v),contextInstructions:x};1==h[0]&&1==h[1]||x.push("scale",h),n&&(x.push("strokeStyle",s.strokeStyle),x.push("lineWidth",d),x.push("lineCap",s.lineCap),x.push("lineJoin",s.lineJoin),x.push("miterLimit",s.miterLimit),x.push("setLineDash",[s.lineDash]),x.push("lineDashOffset",s.lineDashOffset)),i&&x.push("fillStyle",o.fillStyle),x.push("textBaseline","middle"),x.push("textAlign","center");const S=.5-u;let I=u*w+S*d;const M=[],C=[];let T,R=0,A=0,k=0,P=0;for(let t=0,e=g.length;t<e;t+=2){const e=g[t];if("\n"===e){A+=R,R=0,I=u*w+S*d,++P;continue}const r=g[t+1]||a.font;r!==T&&(n&&M.push("font",r),i&&C.push("font",r),T=r),R=Math.max(R,_[k]);const s=[e,I+S*m[k]+u*(m[k]-y[P]),.5*(d+R)+A];I+=m[k],n&&M.push("strokeText",s),i&&C.push("fillText",s),++k}return Array.prototype.push.apply(x,M),Array.prototype.push.apply(x,C),this.labels_[r]=E,E}replayTextBackground_(t,e,i,n,r,s,o){t.beginPath(),t.moveTo.apply(t,e),t.lineTo.apply(t,i),t.lineTo.apply(t,n),t.lineTo.apply(t,r),t.lineTo.apply(t,e),s&&(this.alignAndScaleFill_=s[2],this.fill_(t)),o&&(this.setStrokeStyle_(t,o),t.stroke())}calculateImageOrLabelDimensions_(t,e,i,n,r,s,o,a,l,h,c,u,d,g,f,p){let m=i-(o*=u[0]),_=n-(a*=u[1]);const y=r+l>t?t-l:r,w=s+h>e?e-h:s,x=g[3]+y*u[0]+g[1],b=g[0]+w*u[1]+g[2],v=m-g[3],E=_-g[0];let S;return(f||0!==c)&&(Tb[0]=v,kb[0]=v,Tb[1]=E,Rb[1]=E,Rb[0]=v+x,Ab[0]=Rb[0],Ab[1]=E+b,kb[1]=Ab[1]),0!==c?(S=ti([1,0,0,1,0,0],i,n,1,1,c,-i,-n),Qe(S,Tb),Qe(S,Rb),Qe(S,Ab),Qe(S,kb),Gt(Math.min(Tb[0],Rb[0],Ab[0],kb[0]),Math.min(Tb[1],Rb[1],Ab[1],kb[1]),Math.max(Tb[0],Rb[0],Ab[0],kb[0]),Math.max(Tb[1],Rb[1],Ab[1],kb[1]),Cb)):Gt(Math.min(v,v+x),Math.min(E,E+b),Math.max(v,v+x),Math.max(E,E+b),Cb),d&&(m=Math.round(m),_=Math.round(_)),{drawImageX:m,drawImageY:_,drawImageW:y,drawImageH:w,originX:l,originY:h,declutterBox:{minX:Cb[0],minY:Cb[1],maxX:Cb[2],maxY:Cb[3],value:p},canvasTransform:S,scale:u}}replayImageOrLabel_(t,e,i,n,r,s,o){const a=!(!s&&!o),l=n.declutterBox,h=o?o[2]*n.scale[0]/2:0;return l.minX-h<=e[0]&&l.maxX+h>=0&&l.minY-h<=e[1]&&l.maxY+h>=0&&(a&&this.replayTextBackground_(t,Tb,Rb,Ab,kb,s,o),function(t,e,i,n,r,s,o,a,l,h,c){t.save(),1!==i&&(void 0===t.globalAlpha?t.globalAlpha=t=>t.globalAlpha*=i:t.globalAlpha*=i),e&&t.transform.apply(t,e),n.contextInstructions?(t.translate(l,h),t.scale(c[0],c[1]),function(t,e){const i=t.contextInstructions;for(let t=0,n=i.length;t<n;t+=2)Array.isArray(i[t+1])?e[i[t]].apply(e,i[t+1]):e[i[t]]=i[t+1]}(n,t)):c[0]<0||c[1]<0?(t.translate(l,h),t.scale(c[0],c[1]),t.drawImage(n,r,s,o,a,0,0,o,a)):t.drawImage(n,r,s,o,a,l,h,o*c[0],a*c[1]),t.restore()}(t,n.canvasTransform,r,i,n.originX,n.originY,n.drawImageW,n.drawImageH,n.drawImageX,n.drawImageY,n.scale)),!0}fill_(t){const e=this.alignAndScaleFill_;if(e){const i=Qe(this.renderedTransform_,[0,0]),n=512*this.pixelRatio;t.save(),t.translate(i[0]%n,i[1]%n),1!==e&&t.scale(e,e),t.rotate(this.viewRotation_)}t.fill(),e&&t.restore()}setStrokeStyle_(t,e){t.strokeStyle=e[1],t.lineWidth=e[2],t.lineCap=e[3],t.lineJoin=e[4],t.miterLimit=e[5],t.lineDashOffset=e[7],t.setLineDash(e[6])}drawLabelWithPointPlacement_(t,e,i,n){const r=this.textStates[e],s=this.createLabel(t,e,n,i),o=this.strokeStates[i],a=this.pixelRatio,l=Nb(Array.isArray(t)?t[0]:t,r.textAlign||dr),h=vb[r.textBaseline||gr],c=o&&o.lineWidth?o.lineWidth:0;return{label:s,anchorX:l*(s.width/a-2*r.scale[0])+2*(.5-l)*c,anchorY:h*s.height/a+2*(.5-h)*c}}execute_(t,e,i,n,r,s,o,a){const l=this.zIndexContext_;let h;var c,d;this.pixelCoordinates_&&u(i,this.renderedTransform_)?h=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),h=ri(this.coordinates,0,this.coordinates.length,2,i,this.pixelCoordinates_),d=i,(c=this.renderedTransform_)[0]=d[0],c[1]=d[1],c[2]=d[2],c[3]=d[3],c[4]=d[4],c[5]=d[5]);let g=0;const f=n.length;let p,m,_,y,w,x,b,v,E,S,I,M,C,T=0,R=0,A=0,k=null,P=null;const L=this.coordinateCache_,N=this.viewRotation_,D=Math.round(1e12*Math.atan2(-i[1],i[0]))/1e12,O={context:t,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:N},F=this.instructions!=n||this.overlaps?0:200;let z,B,G,Y;for(;g<f;){const i=n[g];switch(i[0]){case mb.BEGIN_GEOMETRY:z=i[1],Y=i[3],z.getGeometry()?void 0===o||le(o,Y.getExtent())?++g:g=i[2]+1:g=i[2],l&&(l.zIndex=i[4]);break;case mb.BEGIN_PATH:R>F&&(this.fill_(t),R=0),A>F&&(t.stroke(),A=0),R||A||(t.beginPath(),w=NaN,x=NaN),++g;break;case mb.CIRCLE:T=i[1];const n=h[T],c=h[T+1],u=h[T+2]-n,d=h[T+3]-c,f=Math.sqrt(u*u+d*d);t.moveTo(n+f,c),t.arc(n,c,f,0,2*Math.PI,!0),++g;break;case mb.CLOSE_PATH:t.closePath(),++g;break;case mb.CUSTOM:T=i[1],p=i[2];const U=i[3],X=i[4],q=i[5];O.geometry=U,O.feature=z,g in L||(L[g]=[]);const V=L[g];q?q(h,T,p,2,V):(V[0]=h[T],V[1]=h[T+1],V.length=2),l&&(l.zIndex=i[6]),X(V,O),++g;break;case mb.DRAW_IMAGE:T=i[1],p=i[2],E=i[3],m=i[4],_=i[5];let j=i[6];const W=i[7],Z=i[8],H=i[9],K=i[10];let $=i[11];const J=i[12];let Q=i[13];y=i[14]||"declutter";const tt=i[15];if(!E&&i.length>=20){S=i[19],I=i[20],M=i[21],C=i[22];const t=this.drawLabelWithPointPlacement_(S,I,M,C);E=t.label,i[3]=E;const e=i[23];m=(t.anchorX-e)*this.pixelRatio,i[4]=m;const n=i[24];_=(t.anchorY-n)*this.pixelRatio,i[5]=_,j=E.height,i[6]=j,Q=E.width,i[13]=Q}let et,it,nt,rt;i.length>25&&(et=i[25]),i.length>17?(it=i[16],nt=i[17],rt=i[18]):(it=fr,nt=!1,rt=!1),K&&D?$+=N:K||D||($-=N);let st=0;for(;T<p;T+=2){if(et&&et[st++]<Q/this.pixelRatio)continue;const i=this.calculateImageOrLabelDimensions_(E.width,E.height,h[T],h[T+1],Q,j,m,_,Z,H,$,J,r,it,nt||rt,z),n=[t,e,E,i,W,nt?k:null,rt?P:null];if(a){let t,e,r,s,o;if(tt){const i=p-T;if(!tt[i]){tt[i]={args:n,declutterMode:y};continue}const s=tt[i];t=s.args,e=s.declutterMode,delete tt[i],r=Pb(t)}if(!t||"declutter"===e&&a.collides(r)||(s=!0),"declutter"===y&&a.collides(i.declutterBox)||(o=!0),"declutter"===e&&"declutter"===y){const t=s&&o;s=t,o=t}s&&("none"!==e&&a.insert(r),this.replayImageOrLabel_.apply(this,t)),o&&("none"!==y&&a.insert(i.declutterBox),this.replayImageOrLabel_.apply(this,n))}else this.replayImageOrLabel_.apply(this,n)}++g;break;case mb.DRAW_CHARS:const ot=i[1],at=i[2],lt=i[3],ht=i[4];C=i[5];const ct=i[6],ut=i[7],dt=i[8];M=i[9];const gt=i[10];S=i[11],I=i[12];const ft=[i[13],i[13]];y=i[14]||"declutter";const pt=this.textStates[I],mt=pt.font,_t=[pt.scale[0]*ut,pt.scale[1]*ut];let yt;mt in this.widths_?yt=this.widths_[mt]:(yt={},this.widths_[mt]=yt);const wt=Mb(h,ot,at,2),xt=Math.abs(_t[0])*Er(mt,S,yt);if(ht||xt<=wt){const i=Ib(h,ot,at,2,S,(wt-xt)*Nb(S,this.textStates[I].textAlign),ct,Math.abs(_t[0]),Er,mt,yt,D?0:this.viewRotation_);t:if(i){const n=[];let r,s,o,l,h;if(M)for(r=0,s=i.length;r<s;++r){h=i[r],o=h[4],l=this.createLabel(o,I,"",M),m=h[2]+(_t[0]<0?-gt:gt),_=lt*l.height+2*(.5-lt)*gt*_t[1]/_t[0]-dt;const s=this.calculateImageOrLabelDimensions_(l.width,l.height,h[0],h[1],l.width,l.height,m,_,0,0,h[3],ft,!1,fr,!1,z);if(a&&"declutter"===y&&a.collides(s.declutterBox))break t;n.push([t,e,l,s,1,null,null])}if(C)for(r=0,s=i.length;r<s;++r){h=i[r],o=h[4],l=this.createLabel(o,I,C,""),m=h[2],_=lt*l.height-dt;const s=this.calculateImageOrLabelDimensions_(l.width,l.height,h[0],h[1],l.width,l.height,m,_,0,0,h[3],ft,!1,fr,!1,z);if(a&&"declutter"===y&&a.collides(s.declutterBox))break t;n.push([t,e,l,s,1,null,null])}a&&"none"!==y&&a.load(n.map(Pb));for(let t=0,e=n.length;t<e;++t)this.replayImageOrLabel_.apply(this,n[t])}}++g;break;case mb.END_GEOMETRY:if(void 0!==s){z=i[1];const t=s(z,Y);if(t)return t}++g;break;case mb.FILL:F?R++:this.fill_(t),++g;break;case mb.MOVE_TO_LINE_TO:for(T=i[1],p=i[2],B=h[T],G=h[T+1],b=B+.5|0,v=G+.5|0,b===w&&v===x||(t.moveTo(B,G),w=b,x=v),T+=2;T<p;T+=2)B=h[T],G=h[T+1],b=B+.5|0,v=G+.5|0,T!=p-2&&b===w&&v===x||(t.lineTo(B,G),w=b,x=v);++g;break;case mb.SET_FILL_STYLE:k=i,this.alignAndScaleFill_=i[2],R&&(this.fill_(t),R=0,A&&(t.stroke(),A=0)),t.fillStyle=i[1],++g;break;case mb.SET_STROKE_STYLE:P=i,A&&(t.stroke(),A=0),this.setStrokeStyle_(t,i),++g;break;case mb.STROKE:F?A++:t.stroke(),++g;break;default:++g}}R&&this.fill_(t),A&&t.stroke()}execute(t,e,i,n,r,s){this.viewRotation_=n,this.execute_(t,e,i,this.instructions,r,void 0,void 0,s)}executeHitDetection(t,e,i,n,r){return this.viewRotation_=i,this.execute_(t,[t.canvas.width,t.canvas.height],e,this.hitDetectionInstructions,!0,n,r)}},Fb=["Polygon","Circle","LineString","Image","Text","Default"],zb=["Image","Text"],Bb=Fb.filter((t=>!zb.includes(t))),Gb={},Yb=class{constructor(t,e,i,n,r,s,o){this.maxExtent_=t,this.overlaps_=n,this.pixelRatio_=i,this.resolution_=e,this.renderBuffer_=s,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=[1,0,0,1,0,0],this.renderedContext_=null,this.deferredZIndexContexts_={},this.createExecutors_(r,o)}clip(t,e){const i=this.getClipCoords(e);t.beginPath(),t.moveTo(i[0],i[1]),t.lineTo(i[2],i[3]),t.lineTo(i[4],i[5]),t.lineTo(i[6],i[7]),t.clip()}createExecutors_(t,e){for(const i in t){let n=this.executorsByZIndex_[i];void 0===n&&(n={},this.executorsByZIndex_[i]=n);const r=t[i];for(const t in r){const i=r[t];n[t]=new Ob(this.resolution_,this.pixelRatio_,this.overlaps_,i,e)}}}hasExecutors(t){for(const e in this.executorsByZIndex_){const i=this.executorsByZIndex_[e];for(let e=0,n=t.length;e<n;++e)if(t[e]in i)return!0}return!1}forEachFeatureAtCoordinate(t,e,i,n,r,s){const o=2*(n=Math.round(n))+1,l=ti(this.hitDetectionTransform_,n+.5,n+.5,1/e,-1/e,-i,-t[0],-t[1]),h=!this.hitDetectionContext_;h&&(this.hitDetectionContext_=Yn(o,o,void 0,{willReadFrequently:!0}));const c=this.hitDetectionContext_;let u;c.canvas.width!==o||c.canvas.height!==o?(c.canvas.width=o,c.canvas.height=o):h||c.clearRect(0,0,o,o),void 0!==this.renderBuffer_&&(u=[1/0,1/0,-1/0,-1/0],jt(u,t),Lt(u,e*(this.renderBuffer_+n),u));const d=function(t){if(void 0!==Gb[t])return Gb[t];const e=2*t+1,i=t*t,n=new Array(i+1);for(let r=0;r<=t;++r)for(let s=0;s<=t;++s){const o=r*r+s*s;if(o>i)break;let a=n[o];a||(a=[],n[o]=a),a.push(4*((t+r)*e+(t+s))+3),r>0&&a.push(4*((t-r)*e+(t+s))+3),s>0&&(a.push(4*((t+r)*e+(t-s))+3),r>0&&a.push(4*((t-r)*e+(t-s))+3))}const r=[];for(let t=0,e=n.length;t<e;++t)n[t]&&r.push(...n[t]);return Gb[t]=r,r}(n);let g;function f(t,e){const i=c.getImageData(0,0,o,o).data;for(let a=0,l=d.length;a<l;a++)if(i[d[a]]>0){if(!s||"Image"!==g&&"Text"!==g||s.includes(t)){const i=(d[a]-3)/4,s=n-i%o,l=n-(i/o|0),h=r(t,e,s*s+l*l);if(h)return h}c.clearRect(0,0,o,o);break}}const p=Object.keys(this.executorsByZIndex_).map(Number);let m,_,y,w,x;for(p.sort(a),m=p.length-1;m>=0;--m){const t=p[m].toString();for(y=this.executorsByZIndex_[t],_=Fb.length-1;_>=0;--_)if(g=Fb[_],w=y[g],void 0!==w&&(x=w.executeHitDetection(c,l,i,f,u),x))return x}}getClipCoords(t){const e=this.maxExtent_;if(!e)return null;const i=e[0],n=e[1],r=e[2],s=e[3],o=[i,n,i,s,r,s,r,n];return ri(o,0,8,2,t,o),o}isEmpty(){return _(this.executorsByZIndex_)}execute(t,e,i,n,r,s,o){const l=Object.keys(this.executorsByZIndex_).map(Number);let h,c,u,d,g,f;for(l.sort(a),s=s||Fb,o&&l.reverse(),h=0,c=l.length;h<c;++h){const a=l[h].toString();for(g=this.executorsByZIndex_[a],u=0,d=s.length;u<d;++u){const a=s[u];if(f=g[a],void 0!==f){const s=null===o?void 0:f.getZIndexContext(),c=s?s.getContext():t,u=this.maxExtent_&&"Image"!==a&&"Text"!==a;if(u&&(c.save(),this.clip(c,i)),f.execute(c,e,i,n,r,o),u&&c.restore(),s){s.offset();const t=l[h];this.deferredZIndexContexts_[t]||(this.deferredZIndexContexts_[t]=[]),this.deferredZIndexContexts_[t].push(s)}}}}this.renderedContext_=t}getDeferredZIndexContexts(){return this.deferredZIndexContexts_}getRenderedContext(){return this.renderedContext_}renderDeferred(){const t=this.deferredZIndexContexts_,e=Object.keys(t).map(Number).sort(a);for(let i=0,n=e.length;i<n;++i)t[e[i]].forEach((t=>{t.draw(this.renderedContext_),t.clear()}))}},Ub=class extends _b{constructor(t,e,i,n,r,s,o){super(),this.context_=t,this.pixelRatio_=e,this.extent_=i,this.transform_=n,this.transformRotation_=n?nt(Math.atan2(n[1],n[0]),10):0,this.viewRotation_=r,this.squaredTolerance_=s,this.userTransform_=o,this.contextFillState_=null,this.contextStrokeState_=null,this.contextTextState_=null,this.fillState_=null,this.strokeState_=null,this.image_=null,this.imageAnchorX_=0,this.imageAnchorY_=0,this.imageHeight_=0,this.imageOpacity_=0,this.imageOriginX_=0,this.imageOriginY_=0,this.imageRotateWithView_=!1,this.imageRotation_=0,this.imageScale_=[0,0],this.imageWidth_=0,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=!1,this.textRotation_=0,this.textScale_=[0,0],this.textFillState_=null,this.textStrokeState_=null,this.textState_=null,this.pixelCoordinates_=[],this.tmpLocalTransform_=[1,0,0,1,0,0]}drawImages_(t,e,i,n){if(!this.image_)return;const r=ri(t,e,i,n,this.transform_,this.pixelCoordinates_),s=this.context_,o=this.tmpLocalTransform_,a=s.globalAlpha;1!=this.imageOpacity_&&(s.globalAlpha=a*this.imageOpacity_);let l=this.imageRotation_;0===this.transformRotation_&&(l-=this.viewRotation_),this.imageRotateWithView_&&(l+=this.viewRotation_);for(let t=0,e=r.length;t<e;t+=2){const e=r[t]-this.imageAnchorX_,i=r[t+1]-this.imageAnchorY_;if(0!==l||1!=this.imageScale_[0]||1!=this.imageScale_[1]){const t=e+this.imageAnchorX_,n=i+this.imageAnchorY_;ti(o,t,n,1,1,l,-t,-n),s.save(),s.transform.apply(s,o),s.translate(t,n),s.scale(this.imageScale_[0],this.imageScale_[1]),s.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),s.restore()}else s.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,e,i,this.imageWidth_,this.imageHeight_)}1!=this.imageOpacity_&&(s.globalAlpha=a)}drawText_(t,e,i,n){if(!this.textState_||""===this.text_)return;this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);const r=ri(t,e,i,n,this.transform_,this.pixelCoordinates_),s=this.context_;let o=this.textRotation_;for(0===this.transformRotation_&&(o-=this.viewRotation_),this.textRotateWithView_&&(o+=this.viewRotation_);e<i;e+=n){const t=r[e]+this.textOffsetX_,i=r[e+1]+this.textOffsetY_;0!==o||1!=this.textScale_[0]||1!=this.textScale_[1]?(s.save(),s.translate(t-this.textOffsetX_,i-this.textOffsetY_),s.rotate(o),s.translate(this.textOffsetX_,this.textOffsetY_),s.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&s.strokeText(this.text_,0,0),this.textFillState_&&s.fillText(this.text_,0,0),s.restore()):(this.textStrokeState_&&s.strokeText(this.text_,t,i),this.textFillState_&&s.fillText(this.text_,t,i))}}moveToLineTo_(t,e,i,n,r){const s=this.context_,o=ri(t,e,i,n,this.transform_,this.pixelCoordinates_);s.moveTo(o[0],o[1]);let a=o.length;r&&(a-=2);for(let t=2;t<a;t+=2)s.lineTo(o[t],o[t+1]);return r&&s.closePath(),i}drawRings_(t,e,i,n){for(let r=0,s=i.length;r<s;++r)e=this.moveToLineTo_(t,e,i[r],n,!0);return e}drawCircle(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),le(this.extent_,t.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=function(t,e,i){const n=t.getFlatCoordinates();if(!n)return null;const r=t.getStride();return ri(n,0,n.length,r,e,i)}(t,this.transform_,this.pixelCoordinates_),i=e[2]-e[0],n=e[3]-e[1],r=Math.sqrt(i*i+n*n),s=this.context_;s.beginPath(),s.arc(e[0],e[1],r,0,2*Math.PI),this.fillState_&&s.fill(),this.strokeState_&&s.stroke()}""!==this.text_&&this.drawText_(t.getCenter(),0,2,2)}}setStyle(t){this.setFillStrokeStyle(t.getFill(),t.getStroke()),this.setImageStyle(t.getImage()),this.setTextStyle(t.getText())}setTransform(t){this.transform_=t}drawGeometry(t){switch(t.getType()){case"Point":this.drawPoint(t);break;case"LineString":this.drawLineString(t);break;case"Polygon":this.drawPolygon(t);break;case"MultiPoint":this.drawMultiPoint(t);break;case"MultiLineString":this.drawMultiLineString(t);break;case"MultiPolygon":this.drawMultiPolygon(t);break;case"GeometryCollection":this.drawGeometryCollection(t);break;case"Circle":this.drawCircle(t)}}drawFeature(t,e){const i=e.getGeometryFunction()(t);i&&(this.setStyle(e),this.drawGeometry(i))}drawGeometryCollection(t){const e=t.getGeometriesArray();for(let t=0,i=e.length;t<i;++t)this.drawGeometry(e[t])}drawPoint(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const e=t.getFlatCoordinates(),i=t.getStride();this.image_&&this.drawImages_(e,0,e.length,i),""!==this.text_&&this.drawText_(e,0,e.length,i)}drawMultiPoint(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const e=t.getFlatCoordinates(),i=t.getStride();this.image_&&this.drawImages_(e,0,e.length,i),""!==this.text_&&this.drawText_(e,0,e.length,i)}drawLineString(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),le(this.extent_,t.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const e=this.context_,i=t.getFlatCoordinates();e.beginPath(),this.moveToLineTo_(i,0,i.length,t.getStride(),!1),e.stroke()}if(""!==this.text_){const e=t.getFlatMidpoint();this.drawText_(e,0,2,2)}}}drawMultiLineString(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const e=t.getExtent();if(le(this.extent_,e)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const e=this.context_,i=t.getFlatCoordinates();let n=0;const r=t.getEnds(),s=t.getStride();e.beginPath();for(let t=0,e=r.length;t<e;++t)n=this.moveToLineTo_(i,n,r[t],s,!1);e.stroke()}if(""!==this.text_){const e=t.getFlatMidpoints();this.drawText_(e,0,e.length,2)}}}drawPolygon(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),le(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=this.context_;e.beginPath(),this.drawRings_(t.getOrientedFlatCoordinates(),0,t.getEnds(),t.getStride()),this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(""!==this.text_){const e=t.getFlatInteriorPoint();this.drawText_(e,0,2,2)}}}drawMultiPolygon(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),le(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=this.context_,i=t.getOrientedFlatCoordinates();let n=0;const r=t.getEndss(),s=t.getStride();e.beginPath();for(let t=0,e=r.length;t<e;++t){const e=r[t];n=this.drawRings_(i,n,e,s)}this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(""!==this.text_){const e=t.getFlatInteriorPoints();this.drawText_(e,0,e.length,2)}}}setContextFillState_(t){const e=this.context_,i=this.contextFillState_;i?i.fillStyle!=t.fillStyle&&(i.fillStyle=t.fillStyle,e.fillStyle=t.fillStyle):(e.fillStyle=t.fillStyle,this.contextFillState_={fillStyle:t.fillStyle})}setContextStrokeState_(t){const e=this.context_,i=this.contextStrokeState_;i?(i.lineCap!=t.lineCap&&(i.lineCap=t.lineCap,e.lineCap=t.lineCap),u(i.lineDash,t.lineDash)||e.setLineDash(i.lineDash=t.lineDash),i.lineDashOffset!=t.lineDashOffset&&(i.lineDashOffset=t.lineDashOffset,e.lineDashOffset=t.lineDashOffset),i.lineJoin!=t.lineJoin&&(i.lineJoin=t.lineJoin,e.lineJoin=t.lineJoin),i.lineWidth!=t.lineWidth&&(i.lineWidth=t.lineWidth,e.lineWidth=t.lineWidth),i.miterLimit!=t.miterLimit&&(i.miterLimit=t.miterLimit,e.miterLimit=t.miterLimit),i.strokeStyle!=t.strokeStyle&&(i.strokeStyle=t.strokeStyle,e.strokeStyle=t.strokeStyle)):(e.lineCap=t.lineCap,e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset,e.lineJoin=t.lineJoin,e.lineWidth=t.lineWidth,e.miterLimit=t.miterLimit,e.strokeStyle=t.strokeStyle,this.contextStrokeState_={lineCap:t.lineCap,lineDash:t.lineDash,lineDashOffset:t.lineDashOffset,lineJoin:t.lineJoin,lineWidth:t.lineWidth,miterLimit:t.miterLimit,strokeStyle:t.strokeStyle})}setContextTextState_(t){const e=this.context_,i=this.contextTextState_,n=t.textAlign?t.textAlign:dr;i?(i.font!=t.font&&(i.font=t.font,e.font=t.font),i.textAlign!=n&&(i.textAlign=n,e.textAlign=n),i.textBaseline!=t.textBaseline&&(i.textBaseline=t.textBaseline,e.textBaseline=t.textBaseline)):(e.font=t.font,e.textAlign=n,e.textBaseline=t.textBaseline,this.contextTextState_={font:t.font,textAlign:n,textBaseline:t.textBaseline})}setFillStrokeStyle(t,e){if(t){const e=t.getColor();this.fillState_={fillStyle:Jn(e||ar)}}else this.fillState_=null;if(e){const t=e.getColor(),i=e.getLineCap(),n=e.getLineDash(),r=e.getLineDashOffset(),s=e.getLineJoin(),o=e.getWidth(),a=e.getMiterLimit(),l=n||hr;this.strokeState_={lineCap:void 0!==i?i:lr,lineDash:1===this.pixelRatio_?l:l.map((t=>t*this.pixelRatio_)),lineDashOffset:(r||0)*this.pixelRatio_,lineJoin:void 0!==s?s:cr,lineWidth:(void 0!==o?o:1)*this.pixelRatio_,miterLimit:void 0!==a?a:10,strokeStyle:Jn(t||ur)}}else this.strokeState_=null}setImageStyle(t){let e;if(!t||!(e=t.getSize()))return void(this.image_=null);const i=t.getPixelRatio(this.pixelRatio_),n=t.getAnchor(),r=t.getOrigin();this.image_=t.getImage(this.pixelRatio_),this.imageAnchorX_=n[0]*i,this.imageAnchorY_=n[1]*i,this.imageHeight_=e[1]*i,this.imageOpacity_=t.getOpacity(),this.imageOriginX_=r[0],this.imageOriginY_=r[1],this.imageRotateWithView_=t.getRotateWithView(),this.imageRotation_=t.getRotation();const s=t.getScaleArray();this.imageScale_=[s[0]*this.pixelRatio_/i,s[1]*this.pixelRatio_/i],this.imageWidth_=e[0]*i}setTextStyle(t){if(t){const e=t.getFill();if(e){const t=e.getColor();this.textFillState_={fillStyle:Jn(t||ar)}}else this.textFillState_=null;const i=t.getStroke();if(i){const t=i.getColor(),e=i.getLineCap(),n=i.getLineDash(),r=i.getLineDashOffset(),s=i.getLineJoin(),o=i.getWidth(),a=i.getMiterLimit();this.textStrokeState_={lineCap:void 0!==e?e:lr,lineDash:n||hr,lineDashOffset:r||0,lineJoin:void 0!==s?s:cr,lineWidth:void 0!==o?o:1,miterLimit:void 0!==a?a:10,strokeStyle:Jn(t||ur)}}else this.textStrokeState_=null;const n=t.getFont(),r=t.getOffsetX(),s=t.getOffsetY(),o=t.getRotateWithView(),a=t.getRotation(),l=t.getScaleArray(),h=t.getText(),c=t.getTextAlign(),u=t.getTextBaseline();this.textState_={font:void 0!==n?n:or,textAlign:void 0!==c?c:dr,textBaseline:void 0!==u?u:gr},this.text_=void 0!==h?Array.isArray(h)?h.reduce(((t,e,i)=>t+(i%2?" ":e)),""):h:"",this.textOffsetX_=void 0!==r?this.pixelRatio_*r:0,this.textOffsetY_=void 0!==s?this.pixelRatio_*s:0,this.textRotateWithView_=void 0!==o&&o,this.textRotation_=void 0!==a?a:0,this.textScale_=[this.pixelRatio_*l[0],this.pixelRatio_*l[1]]}else this.text_=""}},Xb=.5,qb=.5,Vb={Point:function(t,e,i,n,r,s){const o=i.getImage(),a=i.getText(),l=a&&a.getText(),h=s&&o&&l?{}:void 0;if(o){if(o.getImageState()!=an)return;const s=t.getBuilder(i.getZIndex(),"Image");s.setImageStyle(o,h),s.drawPoint(e,n,r)}if(l){const s=t.getBuilder(i.getZIndex(),"Text");s.setTextStyle(a,h),s.drawText(e,n,r)}},LineString:function(t,e,i,n,r){const s=i.getStroke();if(s){const o=t.getBuilder(i.getZIndex(),"LineString");o.setFillStrokeStyle(null,s),o.drawLineString(e,n,r)}const o=i.getText();if(o&&o.getText()){const s=t.getBuilder(i.getZIndex(),"Text");s.setTextStyle(o),s.drawText(e,n,r)}},Polygon:function(t,e,i,n,r){const s=i.getFill(),o=i.getStroke();if(s||o){const a=t.getBuilder(i.getZIndex(),"Polygon");a.setFillStrokeStyle(s,o),a.drawPolygon(e,n,r)}const a=i.getText();if(a&&a.getText()){const s=t.getBuilder(i.getZIndex(),"Text");s.setTextStyle(a),s.drawText(e,n,r)}},MultiPoint:function(t,e,i,n,r,s){const o=i.getImage(),a=o&&0!==o.getOpacity(),l=i.getText(),h=l&&l.getText(),c=s&&a&&h?{}:void 0;if(a){if(o.getImageState()!=an)return;const s=t.getBuilder(i.getZIndex(),"Image");s.setImageStyle(o,c),s.drawMultiPoint(e,n,r)}if(h){const s=t.getBuilder(i.getZIndex(),"Text");s.setTextStyle(l,c),s.drawText(e,n,r)}},MultiLineString:function(t,e,i,n,r){const s=i.getStroke();if(s){const o=t.getBuilder(i.getZIndex(),"LineString");o.setFillStrokeStyle(null,s),o.drawMultiLineString(e,n,r)}const o=i.getText();if(o&&o.getText()){const s=t.getBuilder(i.getZIndex(),"Text");s.setTextStyle(o),s.drawText(e,n,r)}},MultiPolygon:function(t,e,i,n,r){const s=i.getFill(),o=i.getStroke();if(o||s){const a=t.getBuilder(i.getZIndex(),"Polygon");a.setFillStrokeStyle(s,o),a.drawMultiPolygon(e,n,r)}const a=i.getText();if(a&&a.getText()){const s=t.getBuilder(i.getZIndex(),"Text");s.setTextStyle(a),s.drawText(e,n,r)}},GeometryCollection:function(t,e,i,n,r,s){const o=e.getGeometriesArray();let a,l;for(a=0,l=o.length;a<l;++a)(0,Vb[o[a].getType()])(t,o[a],i,n,r,s)},Circle:function(t,e,i,n,r){const s=i.getFill(),o=i.getStroke();if(s||o){const a=t.getBuilder(i.getZIndex(),"Circle");a.setFillStrokeStyle(s,o),a.drawCircle(e,n,r)}const a=i.getText();if(a&&a.getText()){const r=t.getBuilder(i.getZIndex(),"Text");r.setTextStyle(a),r.drawText(e,n)}}};function jb(t,e){return parseInt(L(t),10)-parseInt(L(e),10)}function Wb(t,e){const i=Zb(t,e);return i*i}function Zb(t,e){return qb*t/e}function Hb(t,e,i,n,r,s,o,a){const l=[],h=i.getImage();if(h){let t=!0;const e=h.getImageState();e==an||e==ln?t=!1:e==sn&&h.load(),t&&l.push(h.ready())}const c=i.getFill();c&&c.loading()&&l.push(c.ready());const u=l.length>0;return u&&Promise.all(l).then((()=>r(null))),function(t,e,i,n,r,s,o){const a=i.getGeometryFunction()(e);if(!a)return;const l=a.simplifyTransformed(n,r);i.getRenderer()?Kb(t,l,i,e,o):(0,Vb[l.getType()])(t,l,i,e,o,s)}(t,e,i,n,s,o,a),u}function Kb(t,e,i,n,r){if("GeometryCollection"!=e.getType())t.getBuilder(i.getZIndex(),"Default").drawCustom(e,n,i.getRenderer(),i.getHitDetectionRenderer(),r);else{const s=e.getGeometries();for(let e=0,o=s.length;e<o;++e)Kb(t,s[e],i,n,r)}}const $b=class extends ra{constructor(t){super(t),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.animatingOrInteracting_,this.hitDetectionImageData_=null,this.renderedFeatures_=null,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=[1/0,1/0,-1/0,-1/0],this.wrappedRenderedExtent_=[1/0,1/0,-1/0,-1/0],this.renderedRotation_,this.renderedCenter_=null,this.renderedProjection_=null,this.renderedPixelRatio_=1,this.renderedRenderOrder_=null,this.replayGroup_=null,this.replayGroupChanged=!0,this.clipping=!0,this.targetContext_=null,this.opacity_=1}renderWorlds(t,e,i){const n=e.extent,r=e.viewState,s=r.center,o=r.resolution,a=r.projection,l=r.rotation,h=a.getExtent(),c=this.getLayer().getSource(),u=this.getLayer().getDeclutter(),d=e.pixelRatio,g=e.viewHints,f=!(g[0]||g[1]),p=this.context,m=Math.round(ae(n)/o*d),_=Math.round(ne(n)/o*d),y=c.getWrapX()&&a.canWrapX(),w=y?ae(h):null,x=y?Math.ceil((n[2]-h[2])/w)+1:1;let b=y?Math.floor((n[0]-h[0])/w):0;do{const n=this.getRenderTransform(s,o,l,d,m,_,b*w);t.execute(p,[p.canvas.width,p.canvas.height],n,l,f,void 0===i?Fb:i?zb:Bb,i?u&&e.declutter[u]:void 0)}while(++b<x)}setDrawContext_(){1!==this.opacity_&&(this.targetContext_=this.context,this.context=Yn(this.context.canvas.width,this.context.canvas.height,ia))}resetDrawContext_(){if(1!==this.opacity_){const t=this.targetContext_.globalAlpha;this.targetContext_.globalAlpha=this.opacity_,this.targetContext_.drawImage(this.context.canvas,0,0),this.targetContext_.globalAlpha=t,qn(this.context),ia.push(this.context.canvas),this.context=this.targetContext_,this.targetContext_=null}}renderDeclutter(t){this.replayGroup_&&this.getLayer().getDeclutter()&&this.renderWorlds(this.replayGroup_,t,!0)}renderDeferredInternal(t){this.replayGroup_&&(this.replayGroup_.renderDeferred(),this.resetDrawContext_())}renderFrame(t,e){const i=t.pixelRatio,n=t.layerStatesArray[t.layerIndex];this.opacity_=n.opacity;const r=t.extent,s=t.viewState.resolution,o=Math.round(ae(r)/s*i),a=Math.round(ne(r)/s*i);ti(this.pixelTransform,t.size[0]/2,t.size[1]/2,1/i,1/i,0,-o/2,-a/2),ei(this.inversePixelTransform,this.pixelTransform);const l=ni(this.pixelTransform);this.useContainer(e,l,this.getBackground(t));const h=this.context,c=h.canvas,u=this.replayGroup_;let d=u&&!u.isEmpty();if(!d&&!this.getLayer().hasListener(lt)&&!this.getLayer().hasListener(ht))return null;c.width!=o||c.height!=a?(c.width=o,c.height=a,c.style.transform!==l&&(c.style.transform=l)):this.containerReused||h.clearRect(0,0,o,a),this.setDrawContext_(),this.preRender(h,t);const g=t.viewState;g.projection;let f=!1;if(d&&n.extent&&this.clipping){const e=Fe(n.extent);d=le(e,t.extent),f=d&&!Ft(e,t.extent),f&&this.clipUnrotated(h,t,e)}return d&&this.renderWorlds(u,t,!this.getLayer().getDeclutter()&&void 0),f&&h.restore(),this.postRender(h,t),this.renderedRotation_!==g.rotation&&(this.renderedRotation_=g.rotation,this.hitDetectionImageData_=null),t.declutter||this.resetDrawContext_(),this.container}getFeatures(t){return new Promise((e=>{if(!this.hitDetectionImageData_&&!this.animatingOrInteracting_){const t=[this.context.canvas.width,this.context.canvas.height];Qe(this.pixelTransform,t);const e=this.renderedCenter_,i=this.renderedResolution_,n=this.renderedRotation_,r=this.renderedProjection_,s=this.wrappedRenderedExtent_,o=this.getLayer(),l=[],h=t[0]*Xb,c=t[1]*Xb;l.push(this.getRenderTransform(e,i,n,Xb,h,c,0).slice());const u=o.getSource(),d=r.getExtent();if(u.getWrapX()&&r.canWrapX()&&!Ft(d,s)){let t=s[0];const r=ae(d);let o,a=0;for(;t<d[0];)--a,o=r*a,l.push(this.getRenderTransform(e,i,n,Xb,h,c,o).slice()),t+=r;for(a=0,t=s[2];t>d[2];)++a,o=r*a,l.push(this.getRenderTransform(e,i,n,Xb,h,c,o).slice()),t-=r}const g=Le();this.hitDetectionImageData_=function(t,e,i,n,r,s,o,l,h){const c=h?Oe(r):r,u=Yn(t[0]*Xb,t[1]*Xb);u.imageSmoothingEnabled=!1;const d=u.canvas,g=new Ub(u,Xb,r,null,o,l,h?Re(Le(),h):null),f=i.length,p=Math.floor(16777215/f),m={};for(let t=1;t<=f;++t){const e=i[t-1],r=e.getStyleFunction()||n;if(!r)continue;let o=r(e,s);if(!o)continue;Array.isArray(o)||(o=[o]);const a=(t*p).toString(16).padStart(7,"#00000");for(let t=0,i=o.length;t<i;++t){const i=o[t],n=i.getGeometryFunction()(e);if(!n||!le(c,n.getExtent()))continue;const r=i.clone(),s=r.getFill();s&&s.setColor(a);const l=r.getStroke();l&&(l.setColor(a),l.setLineDash(null)),r.setText(void 0);const h=i.getImage();if(h){const t=h.getImageSize();if(!t)continue;const e=Yn(t[0],t[1],void 0,{alpha:!1}),i=e.canvas;e.fillStyle=a,e.fillRect(0,0,i.width,i.height),r.setImage(new Br({img:i,anchor:h.getAnchor(),anchorXUnits:"pixels",anchorYUnits:"pixels",offset:h.getOrigin(),opacity:1,size:h.getSize(),scale:h.getScale(),rotation:h.getRotation(),rotateWithView:h.getRotateWithView()}))}const u=r.getZIndex()||0;let d=m[u];d||(d={},m[u]=d,d.Polygon=[],d.Circle=[],d.LineString=[],d.Point=[]);const g=n.getType();if("GeometryCollection"===g){const t=n.getGeometriesArrayRecursive();for(let e=0,i=t.length;e<i;++e){const i=t[e];d[i.getType().replace("Multi","")].push(i,r)}}else d[g.replace("Multi","")].push(n,r)}}const _=Object.keys(m).map(Number).sort(a);for(let t=0,i=_.length;t<i;++t){const i=m[_[t]];for(const t in i){const n=i[t];for(let t=0,i=n.length;t<i;t+=2){g.setStyle(n[t+1]);for(let i=0,r=e.length;i<r;++i)g.setTransform(e[i]),g.drawGeometry(n[t])}}}return u.getImageData(0,0,d.width,d.height)}(t,l,this.renderedFeatures_,o.getStyleFunction(),s,i,n,Wb(i,this.renderedPixelRatio_),g?r:null)}e(function(t,e,i){const n=[];if(i){const r=Math.floor(Math.round(t[0])*Xb),s=Math.floor(Math.round(t[1])*Xb),o=4*($(r,0,i.width-1)+$(s,0,i.height-1)*i.width),a=i.data[o],l=i.data[o+1],h=i.data[o+2]+256*(l+256*a),c=Math.floor(16777215/e.length);h&&h%c==0&&n.push(e[h/c-1])}return n}(t,this.renderedFeatures_,this.hitDetectionImageData_))}))}forEachFeatureAtCoordinate(t,e,i,n,r){if(!this.replayGroup_)return;const s=e.viewState.resolution,o=e.viewState.rotation,a=this.getLayer(),l={},h=function(t,e,i){const s=L(t),o=l[s];if(o){if(!0!==o&&i<o.distanceSq){if(0===i)return l[s]=!0,r.splice(r.lastIndexOf(o),1),n(t,a,e);o.geometry=e,o.distanceSq=i}}else{if(0===i)return l[s]=!0,n(t,a,e);r.push(l[s]={feature:t,layer:a,geometry:e,distanceSq:i,callback:n})}};let c;const u=[this.replayGroup_],d=this.getLayer().getDeclutter();return u.some((n=>c=n.forEachFeatureAtCoordinate(t,s,o,i,h,d&&e.declutter[d]?e.declutter[d].all().map((t=>t.value)):null))),c}handleFontsChanged(){const t=this.getLayer();t.getVisible()&&this.replayGroup_&&t.changed()}handleStyleImageChange_(t){this.renderIfReadyAndVisible()}prepareFrame(t){const e=this.getLayer(),i=e.getSource();if(!i)return!1;const n=t.viewHints[0],r=t.viewHints[1],s=e.getUpdateWhileAnimating(),o=e.getUpdateWhileInteracting();if(this.ready&&!s&&n||!o&&r)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;const a=t.extent,l=t.viewState,h=l.projection,c=l.resolution,d=t.pixelRatio,g=e.getRevision(),f=e.getRenderBuffer();let p=e.getRenderOrder();void 0===p&&(p=jb);const m=l.center.slice(),_=Lt(a,f*c),y=_.slice(),w=[_.slice()],x=h.getExtent();if(i.getWrapX()&&h.canWrapX()&&!Ft(x,t.extent)){const t=ae(x),e=Math.max(ae(_)/2,t);_[0]=x[0]-e,_[2]=x[2]+e,fe(m,h);const i=ue(w[0],h);i[0]<x[0]&&i[2]<x[2]?w.push([i[0]+t,i[1],i[2]+t,i[3]]):i[0]>x[0]&&i[2]>x[2]&&w.push([i[0]-t,i[1],i[2]-t,i[3]])}if(this.ready&&this.renderedResolution_==c&&this.renderedRevision_==g&&this.renderedRenderOrder_==p&&Ft(this.wrappedRenderedExtent_,_))return u(this.renderedExtent_,y)||(this.hitDetectionImageData_=null,this.renderedExtent_=y),this.renderedCenter_=m,this.replayGroupChanged=!1,!0;this.replayGroup_=null;const b=new Sb(Zb(c,d),_,c,d),v=Le();let E;if(v){for(let t=0,e=w.length;t<e;++t){const e=Oe(w[t]);i.loadFeatures(e,ze(c),v)}E=Re(v,h)}else for(let t=0,e=w.length;t<e;++t)i.loadFeatures(w[t],c,h);const S=Wb(c,d);let I=!0;const M=(t,i)=>{let n;const r=t.getStyleFunction()||e.getStyleFunction();if(r&&(n=r(t,c)),n){const e=this.renderFeature(t,S,n,b,E,this.getLayer().getDeclutter(),i);I=I&&!e}},C=Oe(_),T=i.getFeaturesInExtent(C);p&&T.sort(p);for(let t=0,e=T.length;t<e;++t)M(T[t],t);this.renderedFeatures_=T,this.ready=I;const R=b.finish(),A=new Yb(_,c,d,i.getOverlaps(),R,e.getRenderBuffer(),!!t.declutter);return this.renderedResolution_=c,this.renderedRevision_=g,this.renderedRenderOrder_=p,this.renderedExtent_=y,this.wrappedRenderedExtent_=_,this.renderedCenter_=m,this.renderedProjection_=h,this.renderedPixelRatio_=d,this.replayGroup_=A,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0}renderFeature(t,e,i,n,r,s,o){if(!i)return!1;let a=!1;if(Array.isArray(i))for(let l=0,h=i.length;l<h;++l)a=Hb(n,t,i[l],e,this.boundHandleStyleImageChange_,r,s,o)||a;else a=Hb(n,t,i,e,this.boundHandleStyleImageChange_,r,s,o);return a}},Jb=class extends Us{constructor(t){super(t)}createRenderer(){return new $b(this)}},Qb=class{constructor(t){this.rbush_=new rn(t),this.items_={}}insert(t,e){const i={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3],value:e};this.rbush_.insert(i),this.items_[L(e)]=i}load(t,e){const i=new Array(e.length);for(let n=0,r=e.length;n<r;n++){const r=t[n],s=e[n],o={minX:r[0],minY:r[1],maxX:r[2],maxY:r[3],value:s};i[n]=o,this.items_[L(s)]=o}this.rbush_.load(i)}remove(t){const e=L(t),i=this.items_[e];return delete this.items_[e],null!==this.rbush_.remove(i)}update(t,e){const i=this.items_[L(e)];qt([i.minX,i.minY,i.maxX,i.maxY],t)||(this.remove(e),this.insert(t,e))}getAll(){return this.rbush_.all().map((function(t){return t.value}))}getInExtent(t){const e={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]};return this.rbush_.search(e).map((function(t){return t.value}))}forEach(t){return this.forEach_(this.getAll(),t)}forEachInExtent(t,e){return this.forEach_(this.getInExtent(t),e)}forEach_(t,e){let i;for(let n=0,r=t.length;n<r;n++)if(i=e(t[n]),i)return i;return i}isEmpty(){return _(this.items_)}clear(){this.rbush_.clear(),this.items_={}}getExtent(t){const e=this.rbush_.toJSON();return Gt(e.minX,e.minY,e.maxX,e.maxY,t)}concat(t){this.rbush_.load(t.rbush_.all());for(const e in t.items_)this.items_[e]=t.items_[e]}};function tv(t,e,i,n,r,s,o){let l,h;const c=(i-e)/n;if(1===c)l=e;else if(2===c)l=e,h=r;else if(0!==c){let s=t[e],o=t[e+1],c=0;const u=[0];for(let r=e+n;r<i;r+=n){const e=t[r],i=t[r+1];c+=Math.sqrt((e-s)*(e-s)+(i-o)*(i-o)),u.push(c),s=e,o=i}const d=r*c,g=function(t,e,i){let n,r;i=i||a;let s=0,o=t.length,l=!1;for(;s<o;)n=s+(o-s>>1),r=+i(t[n],e),r<0?s=n+1:(o=n,l=!r);return l?s:~s}(u,d);g<0?(h=(d-u[-g-2])/(u[-g-1]-u[-g-2]),l=e+(-g-2)*n):l=e+g*n}o=o>1?o:2,s=s||new Array(o);for(let e=0;e<o;++e)s[e]=void 0===l?NaN:void 0===h?t[l+e]:it(t[l+e],t[l+n+e],h);return s}function ev(t,e,i,n,r,s){if(i==e)return null;let o;if(r<t[e+n-1])return s?(o=t.slice(e,e+n),o[n-1]=r,o):null;if(t[i-1]<r)return s?(o=t.slice(i-n,i),o[n-1]=r,o):null;if(r==t[e+n-1])return t.slice(e,e+n);let a=e/n,l=i/n;for(;a<l;){const e=a+l>>1;r<t[(e+1)*n-1]?l=e:a=e+1}const h=t[a*n-1];if(r==h)return t.slice((a-1)*n,(a-1)*n+n);const c=(r-h)/(t[(a+1)*n-1]-h);o=[];for(let e=0;e<n-1;++e)o.push(it(t[(a-1)*n+e],t[a*n+e],c));return o.push(r),o}function iv(t,e,i,n){const r=[];let s=[1/0,1/0,-1/0,-1/0];for(let o=0,a=i.length;o<a;++o){const a=i[o];s=Xt(t,e,a[0],n),r.push((s[0]+s[2])/2,(s[1]+s[3])/2),e=a[a.length-1]}return r}const nv=[1,0,0,1,0,0];class rv{constructor(t,e,i,n,r,s){this.styleFunction,this.extent_,this.id_=s,this.type_=t,this.flatCoordinates_=e,this.flatInteriorPoints_=null,this.flatMidpoints_=null,this.ends_=i||null,this.properties_=r,this.squaredTolerance_,this.stride_=n,this.simplifiedGeometry_}get(t){return this.properties_[t]}getExtent(){return this.extent_||(this.extent_="Point"===this.type_?Ut(this.flatCoordinates_):Xt(this.flatCoordinates_,0,this.flatCoordinates_.length,2)),this.extent_}getFlatInteriorPoint(){if(!this.flatInteriorPoints_){const t=Qt(this.getExtent());this.flatInteriorPoints_=Oi(this.flatCoordinates_,0,this.ends_,2,t,0)}return this.flatInteriorPoints_}getFlatInteriorPoints(){if(!this.flatInteriorPoints_){const t=function(t,e){const i=[];let n,r=0,s=0;for(let o=0,a=e.length;o<a;++o){const a=e[o],l=Xi(t,r,a,2);if(void 0===n&&(n=l),l===n)i.push(e.slice(s,o+1));else{if(0===i.length)continue;i[i.length-1].push(e[s])}s=o+1,r=a}return i}(this.flatCoordinates_,this.ends_),e=iv(this.flatCoordinates_,0,t,2);this.flatInteriorPoints_=Fi(this.flatCoordinates_,0,t,2,e)}return this.flatInteriorPoints_}getFlatMidpoint(){return this.flatMidpoints_||(this.flatMidpoints_=tv(this.flatCoordinates_,0,this.flatCoordinates_.length,2,.5)),this.flatMidpoints_}getFlatMidpoints(){if(!this.flatMidpoints_){this.flatMidpoints_=[];const t=this.flatCoordinates_;let e=0;const i=this.ends_;for(let n=0,r=i.length;n<r;++n){const r=i[n],s=tv(t,e,r,2,.5);c(this.flatMidpoints_,s),e=r}}return this.flatMidpoints_}getId(){return this.id_}getOrientedFlatCoordinates(){return this.flatCoordinates_}getGeometry(){return this}getSimplifiedGeometry(t){return this}simplifyTransformed(t,e){return this}getProperties(){return this.properties_}getPropertiesInternal(){return this.properties_}getStride(){return this.stride_}getStyleFunction(){return this.styleFunction}getType(){return this.type_}transform(t){const e=(t=Se(t)).getExtent(),i=t.getWorldExtent();if(e&&i){const t=ne(i)/ne(e);ti(nv,i[0],i[3],t,-t,0,0,0),ri(this.flatCoordinates_,0,this.flatCoordinates_.length,2,nv,this.flatCoordinates_)}}applyTransform(t){t(this.flatCoordinates_,this.flatCoordinates_,this.stride_)}clone(){return new rv(this.type_,this.flatCoordinates_.slice(),this.ends_?.slice(),this.stride_,Object.assign({},this.properties_),this.id_)}getEnds(){return this.ends_}enableSimplifyTransformed(){return this.simplifyTransformed=p(((t,e)=>{if(t===this.squaredTolerance_)return this.simplifiedGeometry_;this.simplifiedGeometry_=this.clone(),e&&this.simplifiedGeometry_.applyTransform(e);const i=this.simplifiedGeometry_.getFlatCoordinates();let n;switch(this.type_){case"LineString":i.length=wi(i,0,this.simplifiedGeometry_.flatCoordinates_.length,this.simplifiedGeometry_.stride_,t,i,0),n=[i.length];break;case"MultiLineString":n=[],i.length=xi(i,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,t,i,0,n);break;case"Polygon":n=[],i.length=Ei(i,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,Math.sqrt(t),i,0,n)}return n&&(this.simplifiedGeometry_=new rv(this.type_,i,n,2,this.properties_,this.id_)),this.squaredTolerance_=t,this.simplifiedGeometry_})),this}}rv.prototype.getFlatCoordinates=rv.prototype.getOrientedFlatCoordinates;const sv=rv,ov="addfeature",av="removefeature";function lv(t,e){return[[-1/0,-1/0,1/0,1/0]]}function hv(t,e){return function(i,n,r,s,o){const a=this;!function(t,e,i,n,r,s,o){const a=new XMLHttpRequest;a.open("GET","function"==typeof t?t(i,n,r):t,!0),"arraybuffer"==e.getType()&&(a.responseType="arraybuffer"),a.withCredentials=false,a.onload=function(t){if(!a.status||a.status>=200&&a.status<300){const t=e.getType();let n;"json"==t?n=JSON.parse(a.responseText):"text"==t?n=a.responseText:"xml"==t?(n=a.responseXML,n||(n=(new DOMParser).parseFromString(a.responseText,"application/xml"))):"arraybuffer"==t&&(n=a.response),n?s(e.readFeatures(n,{extent:i,featureProjection:r}),e.readProjection(n)):o()}else o()},a.onerror=o,a.send()}(t,e,i,n,r,(function(t,e){a.addFeatures(t),void 0!==s&&s(t)}),o||f)}}class uv extends r{constructor(t,e,i){super(t),this.feature=e,this.features=i}}const dv=class extends vx{constructor(t){super({attributions:(t=t||{}).attributions,interpolate:!0,projection:void 0,state:"ready",wrapX:void 0===t.wrapX||t.wrapX}),this.on,this.once,this.un,this.loader_=f,this.format_=t.format,this.overlaps_=void 0===t.overlaps||t.overlaps,this.url_=t.url,void 0!==t.loader?this.loader_=t.loader:void 0!==this.url_&&(K(this.format_,"`format` must be set when `url` is set"),this.loader_=hv(this.url_,this.format_)),this.strategy_=void 0!==t.strategy?t.strategy:lv;const e=void 0===t.useSpatialIndex||t.useSpatialIndex;let i,n;this.featuresRtree_=e?new Qb:null,this.loadedExtentsRtree_=new Qb,this.loadingExtentsCount_=0,this.nullGeometryFeatures_={},this.idIndex_={},this.uidIndex_={},this.featureChangeKeys_={},this.featuresCollection_=null,Array.isArray(t.features)?n=t.features:t.features&&(i=t.features,n=i.getArray()),e||void 0!==i||(i=new G(n)),void 0!==n&&this.addFeaturesInternal(n),void 0!==i&&this.bindFeaturesCollection_(i)}addFeature(t){this.addFeatureInternal(t),this.changed()}addFeatureInternal(t){const e=L(t);if(!this.addToIndex_(e,t))return void(this.featuresCollection_&&this.featuresCollection_.remove(t));this.setupChangeEvents_(e,t);const i=t.getGeometry();if(i){const e=i.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(e,t)}else this.nullGeometryFeatures_[e]=t;this.dispatchEvent(new uv(ov,t))}setupChangeEvents_(t,e){e instanceof sv||(this.featureChangeKeys_[t]=[M(e,w,this.handleFeatureChange_,this),M(e,s,this.handleFeatureChange_,this)])}addToIndex_(t,e){let i=!0;if(void 0!==e.getId()){const t=String(e.getId());if(t in this.idIndex_)if(e instanceof sv){const n=this.idIndex_[t];n instanceof sv?Array.isArray(n)?n.push(e):this.idIndex_[t]=[n,e]:i=!1}else i=!1;else this.idIndex_[t]=e}return i&&(K(!(t in this.uidIndex_),"The passed `feature` was already added to the source"),this.uidIndex_[t]=e),i}addFeatures(t){this.addFeaturesInternal(t),this.changed()}addFeaturesInternal(t){const e=[],i=[],n=[];for(let e=0,n=t.length;e<n;e++){const n=t[e],r=L(n);this.addToIndex_(r,n)&&i.push(n)}for(let t=0,r=i.length;t<r;t++){const r=i[t],s=L(r);this.setupChangeEvents_(s,r);const o=r.getGeometry();if(o){const t=o.getExtent();e.push(t),n.push(r)}else this.nullGeometryFeatures_[s]=r}if(this.featuresRtree_&&this.featuresRtree_.load(e,n),this.hasListener(ov))for(let t=0,e=i.length;t<e;t++)this.dispatchEvent(new uv(ov,i[t]))}bindFeaturesCollection_(t){let e=!1;this.addEventListener(ov,(function(i){e||(e=!0,t.push(i.feature),e=!1)})),this.addEventListener(av,(function(i){e||(e=!0,t.remove(i.feature),e=!1)})),t.addEventListener(O,(t=>{e||(e=!0,this.addFeature(t.element),e=!1)})),t.addEventListener(F,(t=>{e||(e=!0,this.removeFeature(t.element),e=!1)})),this.featuresCollection_=t}clear(t){if(t){for(const t in this.featureChangeKeys_)this.featureChangeKeys_[t].forEach(T);this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_){const t=t=>{this.removeFeatureInternal(t)};this.featuresRtree_.forEach(t);for(const t in this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[t])}this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};const e=new uv("clear");this.dispatchEvent(e),this.changed()}forEachFeature(t){if(this.featuresRtree_)return this.featuresRtree_.forEach(t);this.featuresCollection_&&this.featuresCollection_.forEach(t)}forEachFeatureAtCoordinateDirect(t,e){const i=[t[0],t[1],t[0],t[1]];return this.forEachFeatureInExtent(i,(function(i){const n=i.getGeometry();if(n instanceof sv||n.intersectsCoordinate(t))return e(i)}))}forEachFeatureInExtent(t,e){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(t,e);this.featuresCollection_&&this.featuresCollection_.forEach(e)}forEachFeatureIntersectingExtent(t,e){return this.forEachFeatureInExtent(t,(function(i){const n=i.getGeometry();if(n instanceof sv||n.intersectsExtent(t)){const t=e(i);if(t)return t}}))}getFeaturesCollection(){return this.featuresCollection_}getFeatures(){let t;return this.featuresCollection_?t=this.featuresCollection_.getArray().slice(0):this.featuresRtree_&&(t=this.featuresRtree_.getAll(),_(this.nullGeometryFeatures_)||c(t,Object.values(this.nullGeometryFeatures_))),t}getFeaturesAtCoordinate(t){const e=[];return this.forEachFeatureAtCoordinateDirect(t,(function(t){e.push(t)})),e}getFeaturesInExtent(t,e){if(this.featuresRtree_){if(!(e&&e.canWrapX()&&this.getWrapX()))return this.featuresRtree_.getInExtent(t);const i=function(t,e){if(e.canWrapX()){const i=e.getExtent();if(!isFinite(t[0])||!isFinite(t[2]))return[[i[0],t[1],i[2],t[3]]];ue(t,e);const n=ae(i);if(ae(t)>n)return[[i[0],t[1],i[2],t[3]]];if(t[0]<i[0])return[[t[0]+n,t[1],i[2],t[3]],[i[0],t[1],t[2],t[3]]];if(t[2]>i[2])return[[t[0],t[1],i[2],t[3]],[i[0],t[1],t[2]-n,t[3]]]}return[t]}(t,e);return[].concat(...i.map((t=>this.featuresRtree_.getInExtent(t))))}return this.featuresCollection_?this.featuresCollection_.getArray().slice(0):[]}getClosestFeatureToCoordinate(t,e){const i=t[0],n=t[1];let r=null;const s=[NaN,NaN];let o=1/0;const a=[-1/0,-1/0,1/0,1/0];return e=e||d,this.featuresRtree_.forEachInExtent(a,(function(t){if(e(t)){const e=t.getGeometry(),l=o;if(o=e instanceof sv?0:e.closestPointXY(i,n,s,o),o<l){r=t;const e=Math.sqrt(o);a[0]=i-e,a[1]=n-e,a[2]=i+e,a[3]=n+e}}})),r}getExtent(t){return this.featuresRtree_.getExtent(t)}getFeatureById(t){const e=this.idIndex_[t.toString()];return void 0!==e?e:null}getFeatureByUid(t){const e=this.uidIndex_[t];return void 0!==e?e:null}getFormat(){return this.format_}getOverlaps(){return this.overlaps_}getUrl(){return this.url_}handleFeatureChange_(t){const e=t.target,i=L(e),n=e.getGeometry();if(n){const t=n.getExtent();i in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[i],this.featuresRtree_&&this.featuresRtree_.insert(t,e)):this.featuresRtree_&&this.featuresRtree_.update(t,e)}else i in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(e),this.nullGeometryFeatures_[i]=e);const r=e.getId();if(void 0!==r){const t=r.toString();this.idIndex_[t]!==e&&(this.removeFromIdIndex_(e),this.idIndex_[t]=e)}else this.removeFromIdIndex_(e),this.uidIndex_[i]=e;this.changed(),this.dispatchEvent(new uv("changefeature",e))}hasFeature(t){const e=t.getId();return void 0!==e?e in this.idIndex_:L(t)in this.uidIndex_}isEmpty(){return this.featuresRtree_?this.featuresRtree_.isEmpty()&&_(this.nullGeometryFeatures_):!this.featuresCollection_||0===this.featuresCollection_.getLength()}loadFeatures(t,e,i){const n=this.loadedExtentsRtree_,r=this.strategy_(t,e,i);for(let t=0,s=r.length;t<s;++t){const s=r[t];n.forEachInExtent(s,(function(t){return Ft(t.extent,s)}))||(++this.loadingExtentsCount_,this.dispatchEvent(new uv("featuresloadstart")),this.loader_.call(this,s,e,i,(t=>{--this.loadingExtentsCount_,this.dispatchEvent(new uv("featuresloadend",void 0,t))}),(()=>{--this.loadingExtentsCount_,this.dispatchEvent(new uv("featuresloaderror"))})),n.insert(s,{extent:s.slice()}))}this.loading=!(this.loader_.length<4)&&this.loadingExtentsCount_>0}refresh(){this.clear(!0),this.loadedExtentsRtree_.clear(),super.refresh()}removeLoadedExtent(t){const e=this.loadedExtentsRtree_;let i;e.forEachInExtent(t,(function(e){if(qt(e.extent,t))return i=e,!0})),i&&e.remove(i)}removeFeatures(t){const e=[];for(let i=0,n=t.length;i<n;++i){const n=t[i],r=this.removeFeatureInternal(n);r&&e.push(r)}e.length>0&&this.changed()}removeFeature(t){t&&this.removeFeatureInternal(t)&&this.changed()}removeFeatureInternal(t){const e=L(t);e in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[e]:this.featuresRtree_&&this.featuresRtree_.remove(t);const i=this.featureChangeKeys_[e];if(!i)return;i.forEach(T),delete this.featureChangeKeys_[e];const n=t.getId();return void 0!==n&&delete this.idIndex_[n.toString()],delete this.uidIndex_[e],this.hasListener(av)&&this.dispatchEvent(new uv(av,t)),t}removeFromIdIndex_(t){let e=!1;for(const i in this.idIndex_){const n=this.idIndex_[i];if(t instanceof sv&&Array.isArray(n)&&n.includes(t))n.splice(n.indexOf(t),1);else if(this.idIndex_[i]===t){delete this.idIndex_[i],e=!0;break}}return e}setLoader(t){this.loader_=t}setUrl(t){K(this.format_,"`format` must be set when `url` is set"),this.url_=t,this.setLoader(hv(t,this.format_))}};class gv extends ci{constructor(t,e){super(),this.flatMidpoint_=null,this.flatMidpointRevision_=-1,this.maxDelta_=-1,this.maxDeltaRevision_=-1,void 0===e||Array.isArray(t[0])?this.setCoordinates(t,e):this.setFlatCoordinates(e,t)}appendCoordinate(t){c(this.flatCoordinates,t),this.changed()}clone(){const t=new gv(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(t,e,i,n){return n<Dt(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(di(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),fi(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!1,t,e,i,n))}forEachSegment(t){return zi(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}getCoordinateAtM(t,e){return"XYM"!=this.layout&&"XYZM"!=this.layout?null:(e=void 0!==e&&e,ev(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e))}getCoordinates(){return Si(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinateAt(t,e){return tv(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,this.stride)}getLength(){return Mb(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getFlatMidpoint(){return this.flatMidpointRevision_!=this.getRevision()&&(this.flatMidpoint_=this.getCoordinateAt(.5,this.flatMidpoint_??void 0),this.flatMidpointRevision_=this.getRevision()),this.flatMidpoint_}getSimplifiedGeometryInternal(t){const e=[];return e.length=wi(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,0),new gv(e,"XY")}getType(){return"LineString"}intersectsExtent(t){return Bi(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=mi(this.flatCoordinates,0,t,this.stride),this.changed()}}const fv=gv;class pv extends ci{constructor(t,e){super(),e&&!Array.isArray(t[0])?this.setFlatCoordinates(e,t):this.setCoordinates(t,e)}appendPoint(t){c(this.flatCoordinates,t.getFlatCoordinates()),this.changed()}clone(){const t=new pv(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(t,e,i,n){if(n<Dt(this.getExtent(),t,e))return n;const r=this.flatCoordinates,s=this.stride;for(let o=0,a=r.length;o<a;o+=s){const a=Q(t,e,r[o],r[o+1]);if(a<n){n=a;for(let t=0;t<s;++t)i[t]=r[o+t];i.length=s}}return n}getCoordinates(){return Si(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getPoint(t){const e=this.flatCoordinates.length/this.stride;return t<0||e<=t?null:new Pi(this.flatCoordinates.slice(t*this.stride,(t+1)*this.stride),this.layout)}getPoints(){const t=this.flatCoordinates,e=this.layout,i=this.stride,n=[];for(let r=0,s=t.length;r<s;r+=i){const s=new Pi(t.slice(r,r+i),e);n.push(s)}return n}getType(){return"MultiPoint"}intersectsExtent(t){const e=this.flatCoordinates,i=this.stride;for(let n=0,r=e.length;n<r;n+=i)if(zt(t,e[n],e[n+1]))return!0;return!1}setCoordinates(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=mi(this.flatCoordinates,0,t,this.stride),this.changed()}}const mv=pv;class _v extends ci{constructor(t,e,i){if(super(),this.ends_=[],this.maxDelta_=-1,this.maxDeltaRevision_=-1,Array.isArray(t[0]))this.setCoordinates(t,e);else if(void 0!==e&&i)this.setFlatCoordinates(e,t),this.ends_=i;else{const e=t,i=[],n=[];for(let t=0,r=e.length;t<r;++t)c(i,e[t].getFlatCoordinates()),n.push(i.length);const r=0===e.length?this.getLayout():e[0].getLayout();this.setFlatCoordinates(r,i),this.ends_=n}}appendLineString(t){c(this.flatCoordinates,t.getFlatCoordinates().slice()),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const t=new _v(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return t.applyProperties(this),t}closestPointXY(t,e,i,n){return n<Dt(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(gi(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),pi(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!1,t,e,i,n))}getCoordinateAtM(t,e,i){return"XYM"!=this.layout&&"XYZM"!=this.layout||0===this.flatCoordinates.length?null:(e=void 0!==e&&e,i=void 0!==i&&i,function(t,e,i,n,r,s,o){if(o)return ev(t,e,i[i.length-1],n,r,s);let a;if(r<t[n-1])return s?(a=t.slice(0,n),a[n-1]=r,a):null;if(t[t.length-1]<r)return s?(a=t.slice(t.length-n),a[n-1]=r,a):null;for(let s=0,o=i.length;s<o;++s){const o=i[s];if(e!=o){if(r<t[e+n-1])return null;if(r<=t[o-1])return ev(t,e,o,n,r,!1);e=o}}return null}(this.flatCoordinates,0,this.ends_,this.stride,t,e,i))}getCoordinates(){return Ii(this.flatCoordinates,0,this.ends_,this.stride)}getEnds(){return this.ends_}getLineString(t){return t<0||this.ends_.length<=t?null:new fv(this.flatCoordinates.slice(0===t?0:this.ends_[t-1],this.ends_[t]),this.layout)}getLineStrings(){const t=this.flatCoordinates,e=this.ends_,i=this.layout,n=[];let r=0;for(let s=0,o=e.length;s<o;++s){const o=e[s],a=new fv(t.slice(r,o),i);n.push(a),r=o}return n}getFlatMidpoints(){const t=[],e=this.flatCoordinates;let i=0;const n=this.ends_,r=this.stride;for(let s=0,o=n.length;s<o;++s){const o=n[s];c(t,tv(e,i,o,r,.5)),i=o}return t}getSimplifiedGeometryInternal(t){const e=[],i=[];return e.length=xi(this.flatCoordinates,0,this.ends_,this.stride,t,e,0,i),new _v(e,"XY",i)}getType(){return"MultiLineString"}intersectsExtent(t){return function(t,e,i,n,r){for(let s=0,o=i.length;s<o;++s){if(Bi(t,e,i[s],n,r))return!0;e=i[s]}return!1}(this.flatCoordinates,0,this.ends_,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);const i=_i(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=0===i.length?0:i[i.length-1],this.changed()}}const yv=_v;class wv extends ci{constructor(t,e,i){if(super(),this.endss_=[],this.flatInteriorPointsRevision_=-1,this.flatInteriorPoints_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,!i&&!Array.isArray(t[0])){const n=t,r=[],s=[];for(let t=0,e=n.length;t<e;++t){const e=n[t],i=r.length,o=e.getEnds();for(let t=0,e=o.length;t<e;++t)o[t]+=i;c(r,e.getFlatCoordinates()),s.push(o)}e=0===n.length?this.getLayout():n[0].getLayout(),t=r,i=s}void 0!==e&&i?(this.setFlatCoordinates(e,t),this.endss_=i):this.setCoordinates(t,e)}appendPolygon(t){let e;if(this.flatCoordinates){const i=this.flatCoordinates.length;c(this.flatCoordinates,t.getFlatCoordinates()),e=t.getEnds().slice();for(let t=0,n=e.length;t<n;++t)e[t]+=i}else this.flatCoordinates=t.getFlatCoordinates().slice(),e=t.getEnds().slice(),this.endss_.push();this.endss_.push(e),this.changed()}clone(){const t=this.endss_.length,e=new Array(t);for(let i=0;i<t;++i)e[i]=this.endss_[i].slice();const i=new wv(this.flatCoordinates.slice(),this.layout,e);return i.applyProperties(this),i}closestPointXY(t,e,i,n){return n<Dt(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(function(t,e,i,n,r){for(let s=0,o=i.length;s<o;++s){const o=i[s];r=gi(t,e,o,n,r),e=o[o.length-1]}return r}(this.flatCoordinates,0,this.endss_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),function(t,e,i,n,r,s,o,a,l,h,c){c=c||[NaN,NaN];for(let s=0,u=i.length;s<u;++s){const u=i[s];h=pi(t,e,u,n,r,true,o,a,l,h,c),e=u[u.length-1]}return h}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,this.maxDelta_,0,t,e,i,n))}containsXY(t,e){return function(t,e,i,n,r,s){if(0===i.length)return!1;for(let o=0,a=i.length;o<a;++o){const a=i[o];if(Di(t,e,a,n,r,s))return!0;e=a[a.length-1]}return!1}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t,e)}getArea(){return function(t,e,i,n){let r=0;for(let s=0,o=i.length;s<o;++s){const o=i[s];r+=Ti(t,e,o,n),e=o[o.length-1]}return r}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride)}getCoordinates(t){let e;return void 0!==t?(e=this.getOrientedFlatCoordinates().slice(),Wi(e,0,this.endss_,this.stride,t)):e=this.flatCoordinates,Mi(e,0,this.endss_,this.stride)}getEndss(){return this.endss_}getFlatInteriorPoints(){if(this.flatInteriorPointsRevision_!=this.getRevision()){const t=iv(this.flatCoordinates,0,this.endss_,this.stride);this.flatInteriorPoints_=Fi(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t),this.flatInteriorPointsRevision_=this.getRevision()}return this.flatInteriorPoints_}getInteriorPoints(){return new mv(this.getFlatInteriorPoints().slice(),"XYM")}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const t=this.flatCoordinates;Vi(t,0,this.endss_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=Wi(this.orientedFlatCoordinates_,0,this.endss_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(t){const e=[],i=[];return e.length=function(t,e,i,n,r,s,o,a){for(let l=0,h=i.length;l<h;++l){const h=i[l],c=[];o=Ei(t,e,h,n,r,s,o,c),a.push(c),e=h[h.length-1]}return o}(this.flatCoordinates,0,this.endss_,this.stride,Math.sqrt(t),e,0,i),new wv(e,"XY",i)}getPolygon(t){if(t<0||this.endss_.length<=t)return null;let e;if(0===t)e=0;else{const i=this.endss_[t-1];e=i[i.length-1]}const i=this.endss_[t].slice(),n=i[i.length-1];if(0!==e)for(let t=0,n=i.length;t<n;++t)i[t]-=e;return new Hi(this.flatCoordinates.slice(e,n),this.layout,i)}getPolygons(){const t=this.layout,e=this.flatCoordinates,i=this.endss_,n=[];let r=0;for(let s=0,o=i.length;s<o;++s){const o=i[s].slice(),a=o[o.length-1];if(0!==r)for(let t=0,e=o.length;t<e;++t)o[t]-=r;const l=new Hi(e.slice(r,a),t,o);n.push(l),r=a}return n}getType(){return"MultiPolygon"}intersectsExtent(t){return function(t,e,i,n,r){for(let s=0,o=i.length;s<o;++s){const o=i[s];if(Yi(t,e,o,n,r))return!0;e=o[o.length-1]}return!1}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,3),this.flatCoordinates||(this.flatCoordinates=[]);const i=yi(this.flatCoordinates,0,t,this.stride,this.endss_);if(0===i.length)this.flatCoordinates.length=0;else{const t=i[i.length-1];this.flatCoordinates.length=0===t.length?0:t[t.length-1]}this.changed()}}const xv=wv;class bv extends ai{constructor(t){super(),this.geometries_=t,this.changeEventsKeys_=[],this.listenGeometriesChange_()}unlistenGeometriesChange_(){this.changeEventsKeys_.forEach(T),this.changeEventsKeys_.length=0}listenGeometriesChange_(){const t=this.geometries_;for(let e=0,i=t.length;e<i;++e)this.changeEventsKeys_.push(M(t[e],w,this.changed,this))}clone(){const t=new bv(vv(this.geometries_));return t.applyProperties(this),t}closestPointXY(t,e,i,n){if(n<Dt(this.getExtent(),t,e))return n;const r=this.geometries_;for(let s=0,o=r.length;s<o;++s)n=r[s].closestPointXY(t,e,i,n);return n}containsXY(t,e){const i=this.geometries_;for(let n=0,r=i.length;n<r;++n)if(i[n].containsXY(t,e))return!0;return!1}computeExtent(t){Yt(t);const e=this.geometries_;for(let i=0,n=e.length;i<n;++i)Vt(t,e[i].getExtent());return t}getGeometries(){return vv(this.geometries_)}getGeometriesArray(){return this.geometries_}getGeometriesArrayRecursive(){let t=[];const e=this.geometries_;for(let i=0,n=e.length;i<n;++i)e[i].getType()===this.getType()?t=t.concat(e[i].getGeometriesArrayRecursive()):t.push(e[i]);return t}getSimplifiedGeometry(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&t<this.simplifiedGeometryMaxMinSquaredTolerance)return this;const e=[],i=this.geometries_;let n=!1;for(let r=0,s=i.length;r<s;++r){const s=i[r],o=s.getSimplifiedGeometry(t);e.push(o),o!==s&&(n=!0)}return n?new bv(e):(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)}getType(){return"GeometryCollection"}intersectsExtent(t){const e=this.geometries_;for(let i=0,n=e.length;i<n;++i)if(e[i].intersectsExtent(t))return!0;return!1}isEmpty(){return 0===this.geometries_.length}rotate(t,e){const i=this.geometries_;for(let n=0,r=i.length;n<r;++n)i[n].rotate(t,e);this.changed()}scale(t,e,i){i||(i=Qt(this.getExtent()));const n=this.geometries_;for(let r=0,s=n.length;r<s;++r)n[r].scale(t,e,i);this.changed()}setGeometries(t){this.setGeometriesArray(vv(t))}setGeometriesArray(t){this.unlistenGeometriesChange_(),this.geometries_=t,this.listenGeometriesChange_(),this.changed()}applyTransform(t){const e=this.geometries_;for(let i=0,n=e.length;i<n;++i)e[i].applyTransform(t);this.changed()}translate(t,e){const i=this.geometries_;for(let n=0,r=i.length;n<r;++n)i[n].translate(t,e);this.changed()}disposeInternal(){this.unlistenGeometriesChange_(),super.disposeInternal()}}function vv(t){return t.map((t=>t.clone()))}const Ev=bv,Sv=class{constructor(){this.dataProjection=void 0,this.defaultFeatureProjection=void 0,this.featureClass=cb,this.supportedMediaTypes=null}getReadOptions(t,e){if(e){let i=e.dataProjection?Se(e.dataProjection):this.readProjection(t);e.extent&&i&&"tile-pixels"===i.getUnits()&&(i=Se(i),i.setWorldExtent(e.extent)),e={dataProjection:i,featureProjection:e.featureProjection}}return this.adaptOptions(e)}adaptOptions(t){return Object.assign({dataProjection:this.dataProjection,featureProjection:this.defaultFeatureProjection,featureClass:this.featureClass},t)}getType(){return k()}readFeature(t,e){return k()}readFeatures(t,e){return k()}readGeometry(t,e){return k()}readProjection(t){return k()}writeFeature(t,e){return k()}writeFeatures(t,e){return k()}writeGeometry(t,e){return k()}};function Iv(t,e,i){const n=i?Se(i.featureProjection):null,r=i?Se(i.dataProjection):null;let s=t;if(n&&r&&!Te(n,r)){e&&(s=t.clone());const i=e?n:r,o=e?r:n;"tile-pixels"===i.getUnits()?s.transform(i,o):s.applyTransform(Ae(i,o))}if(e&&i&&void 0!==i.decimals){const e=Math.pow(10,i.decimals),n=function(t){for(let i=0,n=t.length;i<n;++i)t[i]=Math.round(t[i]*e)/e;return t};s===t&&(s=t.clone()),s.applyTransform(n)}return s}const Mv={Point:Pi,LineString:fv,Polygon:Hi,MultiPoint:mv,MultiLineString:yv,MultiPolygon:xv};function Cv(t,e){const i=t.geometry;if(!i)return[];if(Array.isArray(i))return i.map((e=>Cv({...t,geometry:e}))).flat();const n="MultiPolygon"===i.type?"Polygon":i.type;if("GeometryCollection"===n||"Circle"===n)throw new Error("Unsupported geometry type: "+n);const r=i.layout.length;return Iv(new sv(n,"Polygon"===n?function(t,e,i){return Array.isArray(e[0])?(Vi(t,0,e,i)||Wi(t=t.slice(),0,e,i),t):(qi(t,0,e,i)||ji(t=t.slice(),0,e,i),t)}(i.flatCoordinates,i.ends,r):i.flatCoordinates,i.ends?.flat(),r,t.properties||{},t.id).enableSimplifyTransformed(),!1,e)}function Tv(t,e){if(!t)return null;if(Array.isArray(t)){const i=t.map((t=>Tv(t,e)));return new Ev(i)}return Iv(new(0,Mv[t.type])(t.flatCoordinates,t.layout,t.ends),!1,e)}function Rv(t){if("string"==typeof t){return JSON.parse(t)||null}return null!==t?t:null}const Av=class extends Sv{constructor(){super()}getType(){return"json"}readFeature(t,e){return this.readFeatureFromObject(Rv(t),this.getReadOptions(t,e))}readFeatures(t,e){return this.readFeaturesFromObject(Rv(t),this.getReadOptions(t,e))}readFeatureFromObject(t,e){return k()}readFeaturesFromObject(t,e){return k()}readGeometry(t,e){return this.readGeometryFromObject(Rv(t),this.getReadOptions(t,e))}readGeometryFromObject(t,e){return k()}readProjection(t){return this.readProjectionFromObject(Rv(t))}readProjectionFromObject(t){return k()}writeFeature(t,e){return JSON.stringify(this.writeFeatureObject(t,e))}writeFeatureObject(t,e){return k()}writeFeatures(t,e){return JSON.stringify(this.writeFeaturesObject(t,e))}writeFeaturesObject(t,e){return k()}writeGeometry(t,e){return JSON.stringify(this.writeGeometryObject(t,e))}writeGeometryObject(t,e){return k()}};function kv(t,e){if(!t)return null;let i;switch(t.type){case"Point":i=function(t){const e=t.coordinates;return{type:"Point",flatCoordinates:e,layout:li(e.length)}}(t);break;case"LineString":i=function(t){const e=t.coordinates,i=e.flat();return{type:"LineString",flatCoordinates:i,ends:[i.length],layout:li(e[0]?.length||2)}}(t);break;case"Polygon":i=function(t){const e=t.coordinates,i=[],n=e[0]?.[0]?.length;return{type:"Polygon",flatCoordinates:i,ends:_i(i,0,e,n),layout:li(n)}}(t);break;case"MultiPoint":i=function(t){const e=t.coordinates;return{type:"MultiPoint",flatCoordinates:e.flat(),layout:li(e[0]?.length||2)}}(t);break;case"MultiLineString":i=function(t){const e=t.coordinates,i=e[0]?.[0]?.length||2,n=[];return{type:"MultiLineString",flatCoordinates:n,ends:_i(n,0,e,i),layout:li(i)}}(t);break;case"MultiPolygon":i=function(t){const e=t.coordinates,i=[],n=e[0]?.[0]?.[0].length||2;return{type:"MultiPolygon",flatCoordinates:i,ends:yi(i,0,e,n),layout:li(n)}}(t);break;case"GeometryCollection":i=function(t,e){const i=t.geometries.map((function(t){return kv(t)}));return i}(t);break;default:throw new Error("Unsupported GeoJSON type: "+t.type)}return i}function Pv(t,e){const i=(t=Iv(t,!0,e)).getType();let n;switch(i){case"Point":n=function(t,e){return{type:"Point",coordinates:t.getCoordinates()}}(t);break;case"LineString":n=function(t,e){return{type:"LineString",coordinates:t.getCoordinates()}}(t);break;case"Polygon":n=function(t,e){let i;return e&&(i=e.rightHanded),{type:"Polygon",coordinates:t.getCoordinates(i)}}(t,e);break;case"MultiPoint":n=function(t,e){return{type:"MultiPoint",coordinates:t.getCoordinates()}}(t);break;case"MultiLineString":n=function(t,e){return{type:"MultiLineString",coordinates:t.getCoordinates()}}(t);break;case"MultiPolygon":n=function(t,e){let i;return e&&(i=e.rightHanded),{type:"MultiPolygon",coordinates:t.getCoordinates(i)}}(t,e);break;case"GeometryCollection":n=function(t,e){delete(e=Object.assign({},e)).featureProjection;return{type:"GeometryCollection",geometries:t.getGeometriesArray().map((function(t){return Pv(t,e)}))}}(t,e);break;case"Circle":n={type:"GeometryCollection",geometries:[]};break;default:throw new Error("Unsupported geometry type: "+i)}return n}const Lv=class extends Av{constructor(t){t=t||{},super(),this.dataProjection=Se(t.dataProjection?t.dataProjection:"EPSG:4326"),t.featureProjection&&(this.defaultFeatureProjection=Se(t.featureProjection)),t.featureClass&&(this.featureClass=t.featureClass),this.geometryName_=t.geometryName,this.extractGeometryName_=t.extractGeometryName,this.supportedMediaTypes=["application/geo+json","application/vnd.geo+json"]}readFeatureFromObject(t,e){let i=null;i="Feature"===t.type?t:{type:"Feature",geometry:t,properties:null};const n=kv(i.geometry);if(this.featureClass===sv)return Cv({geometry:n,id:i.id,properties:i.properties},e);const r=new cb;return this.geometryName_?r.setGeometryName(this.geometryName_):this.extractGeometryName_&&i.geometry_name&&r.setGeometryName(i.geometry_name),r.setGeometry(Tv(n,e)),"id"in i&&r.setId(i.id),i.properties&&r.setProperties(i.properties,!0),r}readFeaturesFromObject(t,e){let i=null;if("FeatureCollection"===t.type){i=[];const n=t.features;for(let t=0,r=n.length;t<r;++t){const r=this.readFeatureFromObject(n[t],e);r&&i.push(r)}}else i=[this.readFeatureFromObject(t,e)];return i.flat()}readGeometryFromObject(t,e){return function(t,e){return Tv(kv(t),e)}(t,e)}readProjectionFromObject(t){const e=t.crs;let i;if(e)if("name"==e.type)i=Se(e.properties.name);else{if("EPSG"!==e.type)throw new Error("Unknown SRS type");i=Se("EPSG:"+e.properties.code)}else i=this.dataProjection;return i}writeFeatureObject(t,e){e=this.adaptOptions(e);const i={type:"Feature",geometry:null,properties:null},n=t.getId();if(void 0!==n&&(i.id=n),!t.hasProperties())return i;const r=t.getProperties(),s=t.getGeometry();return s&&(i.geometry=Pv(s,e),delete r[t.getGeometryName()]),_(r)||(i.properties=r),i}writeFeaturesObject(t,e){e=this.adaptOptions(e);const i=[];for(let n=0,r=t.length;n<r;++n)i.push(this.writeFeatureObject(t[n],e));return{type:"FeatureCollection",features:i}}writeGeometryObject(t,e){return Pv(t,this.adaptOptions(e))}};class Nv{static equalsWithTolerance(t,e,i){return Math.abs(t-e)<=i}}class Dv{constructor(t){this.message=t}toString(){return this.message}}class Ov extends Dv{}class Fv{constructor(t,e){this.low=e||0,this.high=t||0}static toBinaryString(t){let e,i="";for(e=2147483648;e>0;e>>>=1)i+=(t.high&e)===e?"1":"0";for(e=2147483648;e>0;e>>>=1)i+=(t.low&e)===e?"1":"0";return i}}function zv(){}function Bv(){}function Gv(){}function Yv(){}function Uv(){}zv.isNaN=t=>Number.isNaN(t),zv.isInfinite=t=>!Number.isFinite(t),zv.MAX_VALUE=Number.MAX_VALUE,"function"==typeof Float64Array&&"function"==typeof Int32Array?function(){const t=2146435072,e=new Float64Array(1),i=new Int32Array(e.buffer);zv.doubleToLongBits=function(n){e[0]=n;let r=0|i[0],s=0|i[1];return(s&t)===t&&0!=(1048575&s)&&0!==r&&(r=0,s=2146959360),new Fv(s,r)},zv.longBitsToDouble=function(t){return i[0]=t.low,i[1]=t.high,e[0]}}():function(){const t=Math.log2,e=Math.floor,i=Math.pow,n=function(){for(let n=53;n>0;n--){const r=i(2,n)-1;if(e(t(r))+1===n)return r}return 0}();zv.doubleToLongBits=function(r){let s,o,a,l,h,c,u,d,g;if(r<0||1/r===Number.NEGATIVE_INFINITY?(c=1<<31,r=-r):c=0,0===r)return g=0,d=c,new Fv(d,g);if(r===1/0)return g=0,d=2146435072|c,new Fv(d,g);if(r!=r)return g=0,d=2146959360,new Fv(d,g);if(l=0,g=0,s=e(r),s>1)if(s<=n)l=e(t(s)),l<=20?(g=0,d=s<<20-l&1048575):(a=l-20,o=i(2,a),g=s%o<<32-a,d=s/o&1048575);else for(a=s,g=0;o=a/2,a=e(o),0!==a;)l++,g>>>=1,g|=(1&d)<<31,d>>>=1,o!==a&&(d|=524288);if(u=l+1023,h=0===s,s=r-s,l<52&&0!==s)for(a=0;;){if(o=2*s,o>=1?(s=o-1,h?(u--,h=!1):(a<<=1,a|=1,l++)):(s=o,h?0==--u&&(l++,h=!1):(a<<=1,l++)),20===l)d|=a,a=0;else if(52===l){g|=a;break}if(1===o){l<20?d|=a<<20-l:l<52&&(g|=a<<52-l);break}}return d|=u<<20,d|=c,new Fv(d,g)},zv.longBitsToDouble=function(t){let e,n,r,s;const o=t.high,a=t.low,l=o&1<<31?-1:1;for(r=((2146435072&o)>>20)-1023,s=0,n=1<<19,e=1;e<=20;e++)o&n&&(s+=i(2,-e)),n>>>=1;for(n=1<<31,e=21;e<=52;e++)a&n&&(s+=i(2,-e)),n>>>=1;if(-1023===r){if(0===s)return 0*l;r=-1022}else{if(1024===r)return 0===s?l/0:NaN;s+=1}return l*s*i(2,r)}}();class Xv extends Dv{}class qv extends Xv{}class Vv{static shouldNeverReachHere(){if(0===arguments.length)Vv.shouldNeverReachHere(null);else if(1===arguments.length){const t=arguments[0];throw new qv("Should never reach here"+(null!==t?": "+t:""))}}static isTrue(){if(1===arguments.length){const t=arguments[0];Vv.isTrue(t,null)}else if(2===arguments.length){const t=arguments[1];if(!arguments[0])throw null===t?new qv:new qv(t)}}static equals(){if(2===arguments.length){const t=arguments[0],e=arguments[1];Vv.equals(t,e,null)}else if(3===arguments.length){const t=arguments[0],e=arguments[1],i=arguments[2];if(!e.equals(t))throw new qv("Expected "+t+" but encountered "+e+(null!==i?": "+i:""))}}}const jv=new ArrayBuffer(8),Wv=new Float64Array(jv),Zv=new Int32Array(jv);class Hv{constructor(){Hv.constructor_.apply(this,arguments)}static constructor_(){if(this.x=null,this.y=null,this.z=null,0===arguments.length)Hv.constructor_.call(this,0,0);else if(1===arguments.length){const t=arguments[0];Hv.constructor_.call(this,t.x,t.y,t.getZ())}else if(2===arguments.length){const t=arguments[0],e=arguments[1];Hv.constructor_.call(this,t,e,Hv.NULL_ORDINATE)}else if(3===arguments.length){const t=arguments[0],e=arguments[1],i=arguments[2];this.x=t,this.y=e,this.z=i}}static hashCode(t){return Wv[0]=t,Zv[0]^Zv[1]}getM(){return zv.NaN}setOrdinate(t,e){switch(t){case Hv.X:this.x=e;break;case Hv.Y:this.y=e;break;case Hv.Z:this.setZ(e);break;default:throw new Ov("Invalid ordinate index: "+t)}}equals2D(){if(1===arguments.length){const t=arguments[0];return this.x===t.x&&this.y===t.y}if(2===arguments.length){const t=arguments[0],e=arguments[1];return!!Nv.equalsWithTolerance(this.x,t.x,e)&&!!Nv.equalsWithTolerance(this.y,t.y,e)}}setM(t){throw new Ov("Invalid ordinate index: "+Hv.M)}getZ(){return this.z}getOrdinate(t){switch(t){case Hv.X:return this.x;case Hv.Y:return this.y;case Hv.Z:return this.getZ()}throw new Ov("Invalid ordinate index: "+t)}equals3D(t){return this.x===t.x&&this.y===t.y&&(this.getZ()===t.getZ()||zv.isNaN(this.getZ())&&zv.isNaN(t.getZ()))}equals(t){return t instanceof Hv&&this.equals2D(t)}equalInZ(t,e){return Nv.equalsWithTolerance(this.getZ(),t.getZ(),e)}setX(t){this.x=t}compareTo(t){const e=t;return this.x<e.x?-1:this.x>e.x?1:this.y<e.y?-1:this.y>e.y?1:0}getX(){return this.x}setZ(t){this.z=t}clone(){try{return null}catch(t){if(t instanceof CloneNotSupportedException)return Vv.shouldNeverReachHere("this shouldn't happen because this class is Cloneable"),null;throw t}}copy(){return new Hv(this)}toString(){return"("+this.x+", "+this.y+", "+this.getZ()+")"}distance3D(t){const e=this.x-t.x,i=this.y-t.y,n=this.getZ()-t.getZ();return Math.sqrt(e*e+i*i+n*n)}getY(){return this.y}setY(t){this.y=t}distance(t){const e=this.x-t.x,i=this.y-t.y;return Math.sqrt(e*e+i*i)}hashCode(){let t=17;return t=37*t+Hv.hashCode(this.x),t=37*t+Hv.hashCode(this.y),t}setCoordinate(t){this.x=t.x,this.y=t.y,this.z=t.getZ()}get interfaces_(){return[Bv,Gv,Uv]}}class Kv{constructor(){Kv.constructor_.apply(this,arguments)}static constructor_(){if(this._dimensionsToTest=2,0===arguments.length)Kv.constructor_.call(this,2);else if(1===arguments.length){const t=arguments[0];if(2!==t&&3!==t)throw new Ov("only 2 or 3 dimensions may be specified");this._dimensionsToTest=t}}static compare(t,e){return t<e?-1:t>e?1:zv.isNaN(t)?zv.isNaN(e)?0:-1:zv.isNaN(e)?1:0}compare(t,e){const i=Kv.compare(t.x,e.x);if(0!==i)return i;const n=Kv.compare(t.y,e.y);return 0!==n?n:this._dimensionsToTest<=2?0:Kv.compare(t.getZ(),e.getZ())}get interfaces_(){return[Yv]}}function $v(t,e){return t.interfaces_&&t.interfaces_.indexOf(e)>-1}Hv.DimensionalComparator=Kv,Hv.NULL_ORDINATE=zv.NaN,Hv.X=0,Hv.Y=1,Hv.Z=2,Hv.M=3;class Jv{getM(t){if(this.hasM()){const e=this.getDimension()-this.getMeasures();return this.getOrdinate(t,e)}return zv.NaN}setOrdinate(t,e,i){}getZ(t){return this.hasZ()?this.getOrdinate(t,2):zv.NaN}size(){}getOrdinate(t,e){}getCoordinate(){}getCoordinateCopy(t){}createCoordinate(){}getDimension(){}hasM(){return this.getMeasures()>0}getX(t){}hasZ(){return this.getDimension()-this.getMeasures()>2}getMeasures(){return 0}expandEnvelope(t){}copy(){}getY(t){}toCoordinateArray(){}get interfaces_(){return[Gv]}}Jv.X=0,Jv.Y=1,Jv.Z=2,Jv.M=3;class Qv{create(){if(1===arguments.length)arguments[0]instanceof Array||$v(arguments[0],Jv);else if(2===arguments.length);else if(3===arguments.length){const t=arguments[0],e=arguments[1];return this.create(t,e)}}}class tE{filter(t){}}class eE{constructor(){eE.constructor_.apply(this,arguments)}static constructor_(){if(this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,0===arguments.length)this.init();else if(1===arguments.length){if(arguments[0]instanceof Hv){const t=arguments[0];this.init(t.x,t.x,t.y,t.y)}else if(arguments[0]instanceof eE){const t=arguments[0];this.init(t)}}else if(2===arguments.length){const t=arguments[0],e=arguments[1];this.init(t.x,e.x,t.y,e.y)}else if(4===arguments.length){const t=arguments[0],e=arguments[1],i=arguments[2],n=arguments[3];this.init(t,e,i,n)}}static intersects(){if(3===arguments.length){const t=arguments[0],e=arguments[1],i=arguments[2];return i.x>=(t.x<e.x?t.x:e.x)&&i.x<=(t.x>e.x?t.x:e.x)&&i.y>=(t.y<e.y?t.y:e.y)&&i.y<=(t.y>e.y?t.y:e.y)}if(4===arguments.length){const t=arguments[0],e=arguments[1],i=arguments[2],n=arguments[3];let r=Math.min(i.x,n.x),s=Math.max(i.x,n.x),o=Math.min(t.x,e.x),a=Math.max(t.x,e.x);return!(o>s||a<r||(r=Math.min(i.y,n.y),s=Math.max(i.y,n.y),o=Math.min(t.y,e.y),a=Math.max(t.y,e.y),o>s||a<r))}}getArea(){return this.getWidth()*this.getHeight()}equals(t){if(!(t instanceof eE))return!1;const e=t;return this.isNull()?e.isNull():this._maxx===e.getMaxX()&&this._maxy===e.getMaxY()&&this._minx===e.getMinX()&&this._miny===e.getMinY()}intersection(t){if(this.isNull()||t.isNull()||!this.intersects(t))return new eE;const e=this._minx>t._minx?this._minx:t._minx,i=this._miny>t._miny?this._miny:t._miny,n=this._maxx<t._maxx?this._maxx:t._maxx,r=this._maxy<t._maxy?this._maxy:t._maxy;return new eE(e,n,i,r)}isNull(){return this._maxx<this._minx}getMaxX(){return this._maxx}covers(){if(1===arguments.length){if(arguments[0]instanceof Hv){const t=arguments[0];return this.covers(t.x,t.y)}if(arguments[0]instanceof eE){const t=arguments[0];return!this.isNull()&&!t.isNull()&&t.getMinX()>=this._minx&&t.getMaxX()<=this._maxx&&t.getMinY()>=this._miny&&t.getMaxY()<=this._maxy}}else if(2===arguments.length){const t=arguments[0],e=arguments[1];return!this.isNull()&&t>=this._minx&&t<=this._maxx&&e>=this._miny&&e<=this._maxy}}intersects(){if(1===arguments.length){if(arguments[0]instanceof eE){const t=arguments[0];return!this.isNull()&&!t.isNull()&&!(t._minx>this._maxx||t._maxx<this._minx||t._miny>this._maxy||t._maxy<this._miny)}if(arguments[0]instanceof Hv){const t=arguments[0];return this.intersects(t.x,t.y)}}else if(2===arguments.length){if(arguments[0]instanceof Hv&&arguments[1]instanceof Hv){const t=arguments[0],e=arguments[1];return!this.isNull()&&(!((t.x<e.x?t.x:e.x)>this._maxx)&&(!((t.x>e.x?t.x:e.x)<this._minx)&&(!((t.y<e.y?t.y:e.y)>this._maxy)&&!((t.y>e.y?t.y:e.y)<this._miny))))}if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){const t=arguments[0],e=arguments[1];return!this.isNull()&&!(t>this._maxx||t<this._minx||e>this._maxy||e<this._miny)}}}getMinY(){return this._miny}getDiameter(){if(this.isNull())return 0;const t=this.getWidth(),e=this.getHeight();return Math.sqrt(t*t+e*e)}getMinX(){return this._minx}expandToInclude(){if(1===arguments.length){if(arguments[0]instanceof Hv){const t=arguments[0];this.expandToInclude(t.x,t.y)}else if(arguments[0]instanceof eE){const t=arguments[0];if(t.isNull())return null;this.isNull()?(this._minx=t.getMinX(),this._maxx=t.getMaxX(),this._miny=t.getMinY(),this._maxy=t.getMaxY()):(t._minx<this._minx&&(this._minx=t._minx),t._maxx>this._maxx&&(this._maxx=t._maxx),t._miny<this._miny&&(this._miny=t._miny),t._maxy>this._maxy&&(this._maxy=t._maxy))}}else if(2===arguments.length){const t=arguments[0],e=arguments[1];this.isNull()?(this._minx=t,this._maxx=t,this._miny=e,this._maxy=e):(t<this._minx&&(this._minx=t),t>this._maxx&&(this._maxx=t),e<this._miny&&(this._miny=e),e>this._maxy&&(this._maxy=e))}}minExtent(){if(this.isNull())return 0;const t=this.getWidth(),e=this.getHeight();return t<e?t:e}getWidth(){return this.isNull()?0:this._maxx-this._minx}compareTo(t){const e=t;return this.isNull()?e.isNull()?0:-1:e.isNull()?1:this._minx<e._minx?-1:this._minx>e._minx?1:this._miny<e._miny?-1:this._miny>e._miny?1:this._maxx<e._maxx?-1:this._maxx>e._maxx?1:this._maxy<e._maxy?-1:this._maxy>e._maxy?1:0}translate(t,e){if(this.isNull())return null;this.init(this.getMinX()+t,this.getMaxX()+t,this.getMinY()+e,this.getMaxY()+e)}copy(){return new eE(this)}toString(){return"Env["+this._minx+" : "+this._maxx+", "+this._miny+" : "+this._maxy+"]"}setToNull(){this._minx=0,this._maxx=-1,this._miny=0,this._maxy=-1}disjoint(t){return!(!this.isNull()&&!t.isNull())||t._minx>this._maxx||t._maxx<this._minx||t._miny>this._maxy||t._maxy<this._miny}getHeight(){return this.isNull()?0:this._maxy-this._miny}maxExtent(){if(this.isNull())return 0;const t=this.getWidth(),e=this.getHeight();return t>e?t:e}expandBy(){if(1===arguments.length){const t=arguments[0];this.expandBy(t,t)}else if(2===arguments.length){const t=arguments[0],e=arguments[1];if(this.isNull())return null;this._minx-=t,this._maxx+=t,this._miny-=e,this._maxy+=e,(this._minx>this._maxx||this._miny>this._maxy)&&this.setToNull()}}contains(){if(1===arguments.length){if(arguments[0]instanceof eE){const t=arguments[0];return this.covers(t)}if(arguments[0]instanceof Hv){const t=arguments[0];return this.covers(t)}}else if(2===arguments.length){const t=arguments[0],e=arguments[1];return this.covers(t,e)}}centre(){return this.isNull()?null:new Hv((this.getMinX()+this.getMaxX())/2,(this.getMinY()+this.getMaxY())/2)}init(){if(0===arguments.length)this.setToNull();else if(1===arguments.length){if(arguments[0]instanceof Hv){const t=arguments[0];this.init(t.x,t.x,t.y,t.y)}else if(arguments[0]instanceof eE){const t=arguments[0];this._minx=t._minx,this._maxx=t._maxx,this._miny=t._miny,this._maxy=t._maxy}}else if(2===arguments.length){const t=arguments[0],e=arguments[1];this.init(t.x,e.x,t.y,e.y)}else if(4===arguments.length){const t=arguments[0],e=arguments[1],i=arguments[2],n=arguments[3];t<e?(this._minx=t,this._maxx=e):(this._minx=e,this._maxx=t),i<n?(this._miny=i,this._maxy=n):(this._miny=n,this._maxy=i)}}getMaxY(){return this._maxy}distance(t){if(this.intersects(t))return 0;let e=0;this._maxx<t._minx?e=t._minx-this._maxx:this._minx>t._maxx&&(e=this._minx-t._maxx);let i=0;return this._maxy<t._miny?i=t._miny-this._maxy:this._miny>t._maxy&&(i=this._miny-t._maxy),0===e?i:0===i?e:Math.sqrt(e*e+i*i)}hashCode(){let t=17;return t=37*t+Hv.hashCode(this._minx),t=37*t+Hv.hashCode(this._maxx),t=37*t+Hv.hashCode(this._miny),t=37*t+Hv.hashCode(this._maxy),t}get interfaces_(){return[Bv,Uv]}}class iE{constructor(){iE.constructor_.apply(this,arguments)}isGeometryCollection(){return this.getTypeCode()===iE.TYPECODE_GEOMETRYCOLLECTION}getFactory(){return this._factory}getGeometryN(t){return this}getArea(){return 0}isRectangle(){return!1}equalsExact(t){return this===t||this.equalsExact(t,0)}geometryChanged(){this.apply(iE.geometryChangedFilter)}geometryChangedAction(){this._envelope=null}equalsNorm(t){return null!==t&&this.norm().equalsExact(t.norm())}getLength(){return 0}getNumGeometries(){return 1}compareTo(){let t;if(1===arguments.length){const e=arguments[0];return t=e,this.getTypeCode()!==t.getTypeCode()?this.getTypeCode()-t.getTypeCode():this.isEmpty()&&t.isEmpty()?0:this.isEmpty()?-1:t.isEmpty()?1:this.compareToSameClass(e)}if(2===arguments.length){const e=arguments[0],i=arguments[1];return t=e,this.getTypeCode()!==t.getTypeCode()?this.getTypeCode()-t.getTypeCode():this.isEmpty()&&t.isEmpty()?0:this.isEmpty()?-1:t.isEmpty()?1:this.compareToSameClass(e,i)}}getUserData(){return this._userData}getSRID(){return this._SRID}getEnvelope(){return this.getFactory().toGeometry(this.getEnvelopeInternal())}checkNotGeometryCollection(t){if(t.getTypeCode()===iE.TYPECODE_GEOMETRYCOLLECTION)throw new Ov("This method does not support GeometryCollection arguments")}equal(t,e,i){return 0===i?t.equals(e):t.distance(e)<=i}norm(){const t=this.copy();return t.normalize(),t}reverse(){const t=this.reverseInternal();return null!=this.envelope&&(t.envelope=this.envelope.copy()),t.setSRID(this.getSRID()),t}copy(){const t=this.copyInternal();return t.envelope=null==this._envelope?null:this._envelope.copy(),t._SRID=this._SRID,t._userData=this._userData,t}getPrecisionModel(){return this._factory.getPrecisionModel()}getEnvelopeInternal(){return null===this._envelope&&(this._envelope=this.computeEnvelopeInternal()),new eE(this._envelope)}setSRID(t){this._SRID=t}setUserData(t){this._userData=t}compare(t,e){const i=t.iterator(),n=e.iterator();for(;i.hasNext()&&n.hasNext();){const t=i.next(),e=n.next(),r=t.compareTo(e);if(0!==r)return r}return i.hasNext()?1:n.hasNext()?-1:0}hashCode(){return this.getEnvelopeInternal().hashCode()}isEquivalentClass(t){return this.getClass()===t.getClass()}isGeometryCollectionOrDerived(){return this.getTypeCode()===iE.TYPECODE_GEOMETRYCOLLECTION||this.getTypeCode()===iE.TYPECODE_MULTIPOINT||this.getTypeCode()===iE.TYPECODE_MULTILINESTRING||this.getTypeCode()===iE.TYPECODE_MULTIPOLYGON}get interfaces_(){return[Gv,Bv,Uv]}getClass(){return iE}static hasNonEmptyElements(t){for(let e=0;e<t.length;e++)if(!t[e].isEmpty())return!0;return!1}static hasNullElements(t){for(let e=0;e<t.length;e++)if(null===t[e])return!0;return!1}}iE.constructor_=function(t){t&&(this._envelope=null,this._userData=null,this._factory=t,this._SRID=t.getSRID())},iE.TYPECODE_POINT=0,iE.TYPECODE_MULTIPOINT=1,iE.TYPECODE_LINESTRING=2,iE.TYPECODE_LINEARRING=3,iE.TYPECODE_MULTILINESTRING=4,iE.TYPECODE_POLYGON=5,iE.TYPECODE_MULTIPOLYGON=6,iE.TYPECODE_GEOMETRYCOLLECTION=7,iE.TYPENAME_POINT="Point",iE.TYPENAME_MULTIPOINT="MultiPoint",iE.TYPENAME_LINESTRING="LineString",iE.TYPENAME_LINEARRING="LinearRing",iE.TYPENAME_MULTILINESTRING="MultiLineString",iE.TYPENAME_POLYGON="Polygon",iE.TYPENAME_MULTIPOLYGON="MultiPolygon",iE.TYPENAME_GEOMETRYCOLLECTION="GeometryCollection",iE.geometryChangedFilter={get interfaces_(){return[tE]},filter(t){t.geometryChangedAction()}};class nE{filter(t){}}class rE{static ofLine(t){const e=t.size();if(e<=1)return 0;let i=0;const n=new Hv;t.getCoordinate(0,n);let r=n.x,s=n.y;for(let o=1;o<e;o++){t.getCoordinate(o,n);const e=n.x,a=n.y,l=e-r,h=a-s;i+=Math.sqrt(l*l+h*h),r=e,s=a}return i}}class sE{}class oE{static copyCoord(t,e,i,n){const r=Math.min(t.getDimension(),i.getDimension());for(let s=0;s<r;s++)i.setOrdinate(n,s,t.getOrdinate(e,s))}static isRing(t){const e=t.size();return 0===e||!(e<=3)&&t.getOrdinate(0,Jv.X)===t.getOrdinate(e-1,Jv.X)&&t.getOrdinate(0,Jv.Y)===t.getOrdinate(e-1,Jv.Y)}static scroll(){if(2===arguments.length){if($v(arguments[0],Jv)&&Number.isInteger(arguments[1])){const t=arguments[0],e=arguments[1];oE.scroll(t,e,oE.isRing(t))}else if($v(arguments[0],Jv)&&arguments[1]instanceof Hv){const t=arguments[0],e=arguments[1],i=oE.indexOf(e,t);if(i<=0)return null;oE.scroll(t,i)}}else if(3===arguments.length){const t=arguments[0],e=arguments[1],i=arguments[2];if(e<=0)return null;const n=t.copy(),r=i?t.size()-1:t.size();for(let i=0;i<r;i++)for(let s=0;s<t.getDimension();s++)t.setOrdinate(i,s,n.getOrdinate((e+i)%r,s));if(i)for(let e=0;e<t.getDimension();e++)t.setOrdinate(r,e,t.getOrdinate(0,e))}}static isEqual(t,e){const i=t.size();if(i!==e.size())return!1;const n=Math.min(t.getDimension(),e.getDimension());for(let r=0;r<i;r++)for(let i=0;i<n;i++){const n=t.getOrdinate(r,i),s=e.getOrdinate(r,i);if(!(t.getOrdinate(r,i)===e.getOrdinate(r,i)||zv.isNaN(n)&&zv.isNaN(s)))return!1}return!0}static minCoordinateIndex(){if(1===arguments.length){const t=arguments[0];return oE.minCoordinateIndex(t,0,t.size()-1)}if(3===arguments.length){const t=arguments[0],e=arguments[2];let i=-1,n=null;for(let r=arguments[1];r<=e;r++){const e=t.getCoordinate(r);(null===n||n.compareTo(e)>0)&&(n=e,i=r)}return i}}static extend(t,e,i){const n=t.create(i,e.getDimension()),r=e.size();if(oE.copy(e,0,n,0,r),r>0)for(let t=r;t<i;t++)oE.copy(e,r-1,n,t,1);return n}static reverse(t){const e=t.size()-1,i=Math.trunc(e/2);for(let n=0;n<=i;n++)oE.swap(t,n,e-n)}static swap(t,e,i){if(e===i)return null;for(let n=0;n<t.getDimension();n++){const r=t.getOrdinate(e,n);t.setOrdinate(e,n,t.getOrdinate(i,n)),t.setOrdinate(i,n,r)}}static copy(t,e,i,n,r){for(let s=0;s<r;s++)oE.copyCoord(t,e+s,i,n+s)}static ensureValidRing(t,e){const i=e.size();return 0===i?e:i<=3?oE.createClosedRing(t,e,4):e.getOrdinate(0,Jv.X)===e.getOrdinate(i-1,Jv.X)&&e.getOrdinate(0,Jv.Y)===e.getOrdinate(i-1,Jv.Y)?e:oE.createClosedRing(t,e,i+1)}static indexOf(t,e){for(let i=0;i<e.size();i++)if(t.x===e.getOrdinate(i,Jv.X)&&t.y===e.getOrdinate(i,Jv.Y))return i;return-1}static createClosedRing(t,e,i){const n=t.create(i,e.getDimension()),r=e.size();oE.copy(e,0,n,0,r);for(let t=r;t<i;t++)oE.copy(e,0,n,t,1);return n}static minCoordinate(t){let e=null;for(let i=0;i<t.size();i++){const n=t.getCoordinate(i);(null===e||e.compareTo(n)>0)&&(e=n)}return e}}class aE extends Dv{}class lE{static isWhitespace(t){return t<=32&&t>=0||127===t}static toUpperCase(t){return t.toUpperCase()}}class hE{static toDimensionSymbol(t){switch(t){case hE.FALSE:return hE.SYM_FALSE;case hE.TRUE:return hE.SYM_TRUE;case hE.DONTCARE:return hE.SYM_DONTCARE;case hE.P:return hE.SYM_P;case hE.L:return hE.SYM_L;case hE.A:return hE.SYM_A}throw new Ov("Unknown dimension value: "+t)}static toDimensionValue(t){switch(lE.toUpperCase(t)){case hE.SYM_FALSE:return hE.FALSE;case hE.SYM_TRUE:return hE.TRUE;case hE.SYM_DONTCARE:return hE.DONTCARE;case hE.SYM_P:return hE.P;case hE.SYM_L:return hE.L;case hE.SYM_A:return hE.A}throw new Ov("Unknown dimension symbol: "+t)}}hE.P=0,hE.L=1,hE.A=2,hE.FALSE=-1,hE.TRUE=-2,hE.DONTCARE=-3,hE.SYM_FALSE="F",hE.SYM_TRUE="T",hE.SYM_DONTCARE="*",hE.SYM_P="0",hE.SYM_L="1",hE.SYM_A="2";class cE{filter(t){}}class uE{filter(t,e){}isDone(){}isGeometryChanged(){}}class dE extends iE{constructor(){super(),dE.constructor_.apply(this,arguments)}static constructor_(){if(this._points=null,0===arguments.length);else if(2===arguments.length){const t=arguments[0],e=arguments[1];iE.constructor_.call(this,e),this.init(t)}}computeEnvelopeInternal(){return this.isEmpty()?new eE:this._points.expandEnvelope(new eE)}isRing(){return this.isClosed()&&this.isSimple()}getCoordinates(){return this._points.toCoordinateArray()}copyInternal(){return new dE(this._points.copy(),this._factory)}equalsExact(){if(2===arguments.length&&"number"==typeof arguments[1]&&arguments[0]instanceof iE){const t=arguments[0],e=arguments[1];if(!this.isEquivalentClass(t))return!1;const i=t;if(this._points.size()!==i._points.size())return!1;for(let t=0;t<this._points.size();t++)if(!this.equal(this._points.getCoordinate(t),i._points.getCoordinate(t),e))return!1;return!0}return super.equalsExact.apply(this,arguments)}normalize(){for(let t=0;t<Math.trunc(this._points.size()/2);t++){const e=this._points.size()-1-t;if(!this._points.getCoordinate(t).equals(this._points.getCoordinate(e))){if(this._points.getCoordinate(t).compareTo(this._points.getCoordinate(e))>0){const t=this._points.copy();oE.reverse(t),this._points=t}return null}}}getCoordinate(){return this.isEmpty()?null:this._points.getCoordinate(0)}getBoundaryDimension(){return this.isClosed()?hE.FALSE:0}isClosed(){return!this.isEmpty()&&this.getCoordinateN(0).equals2D(this.getCoordinateN(this.getNumPoints()-1))}reverseInternal(){const t=this._points.copy();return oE.reverse(t),this.getFactory().createLineString(t)}getEndPoint(){return this.isEmpty()?null:this.getPointN(this.getNumPoints()-1)}getTypeCode(){return iE.TYPECODE_LINESTRING}getDimension(){return 1}getLength(){return rE.ofLine(this._points)}getNumPoints(){return this._points.size()}compareToSameClass(){if(1===arguments.length){const t=arguments[0];let e=0,i=0;for(;e<this._points.size()&&i<t._points.size();){const n=this._points.getCoordinate(e).compareTo(t._points.getCoordinate(i));if(0!==n)return n;e++,i++}return e<this._points.size()?1:i<t._points.size()?-1:0}if(2===arguments.length){const t=arguments[0];return arguments[1].compare(this._points,t._points)}}apply(){if($v(arguments[0],nE)){const t=arguments[0];for(let e=0;e<this._points.size();e++)t.filter(this._points.getCoordinate(e))}else if($v(arguments[0],uE)){const t=arguments[0];if(0===this._points.size())return null;for(let e=0;e<this._points.size()&&(t.filter(this._points,e),!t.isDone());e++);t.isGeometryChanged()&&this.geometryChanged()}else($v(arguments[0],cE)||$v(arguments[0],tE))&&arguments[0].filter(this)}getBoundary(){throw new aE}isEquivalentClass(t){return t instanceof dE}getCoordinateN(t){return this._points.getCoordinate(t)}getGeometryType(){return iE.TYPENAME_LINESTRING}getCoordinateSequence(){return this._points}isEmpty(){return 0===this._points.size()}init(t){if(null===t&&(t=this.getFactory().getCoordinateSequenceFactory().create([])),1===t.size())throw new Ov("Invalid number of points in LineString (found "+t.size()+" - must be 0 or >= 2)");this._points=t}isCoordinate(t){for(let e=0;e<this._points.size();e++)if(this._points.getCoordinate(e).equals(t))return!0;return!1}getStartPoint(){return this.isEmpty()?null:this.getPointN(0)}getPointN(t){return this.getFactory().createPoint(this._points.getCoordinate(t))}get interfaces_(){return[sE]}}class gE{}class fE extends iE{constructor(){super(),fE.constructor_.apply(this,arguments)}static constructor_(){this._coordinates=null;const t=arguments[0],e=arguments[1];iE.constructor_.call(this,e),this.init(t)}computeEnvelopeInternal(){if(this.isEmpty())return new eE;const t=new eE;return t.expandToInclude(this._coordinates.getX(0),this._coordinates.getY(0)),t}getCoordinates(){return this.isEmpty()?[]:[this.getCoordinate()]}copyInternal(){return new fE(this._coordinates.copy(),this._factory)}equalsExact(){if(2===arguments.length&&"number"==typeof arguments[1]&&arguments[0]instanceof iE){const t=arguments[0],e=arguments[1];return!!this.isEquivalentClass(t)&&(!(!this.isEmpty()||!t.isEmpty())||this.isEmpty()===t.isEmpty()&&this.equal(t.getCoordinate(),this.getCoordinate(),e))}return super.equalsExact.apply(this,arguments)}normalize(){}getCoordinate(){return 0!==this._coordinates.size()?this._coordinates.getCoordinate(0):null}getBoundaryDimension(){return hE.FALSE}reverseInternal(){return this.getFactory().createPoint(this._coordinates.copy())}getTypeCode(){return iE.TYPECODE_POINT}getDimension(){return 0}getNumPoints(){return this.isEmpty()?0:1}getX(){if(null===this.getCoordinate())throw new IllegalStateException("getX called on empty Point");return this.getCoordinate().x}compareToSameClass(){if(1===arguments.length){const t=arguments[0];return this.getCoordinate().compareTo(t.getCoordinate())}if(2===arguments.length){const t=arguments[0];return arguments[1].compare(this._coordinates,t._coordinates)}}apply(){if($v(arguments[0],nE)){const t=arguments[0];if(this.isEmpty())return null;t.filter(this.getCoordinate())}else if($v(arguments[0],uE)){const t=arguments[0];if(this.isEmpty())return null;t.filter(this._coordinates,0),t.isGeometryChanged()&&this.geometryChanged()}else($v(arguments[0],cE)||$v(arguments[0],tE))&&arguments[0].filter(this)}getBoundary(){return this.getFactory().createGeometryCollection()}getGeometryType(){return iE.TYPENAME_POINT}getCoordinateSequence(){return this._coordinates}getY(){if(null===this.getCoordinate())throw new IllegalStateException("getY called on empty Point");return this.getCoordinate().y}isEmpty(){return 0===this._coordinates.size()}init(t){null===t&&(t=this.getFactory().getCoordinateSequenceFactory().create([])),Vv.isTrue(t.size()<=1),this._coordinates=t}isSimple(){return!0}get interfaces_(){return[gE]}}class pE{static ofRing(){if(arguments[0]instanceof Array){const t=arguments[0];return Math.abs(pE.ofRingSigned(t))}if($v(arguments[0],Jv)){const t=arguments[0];return Math.abs(pE.ofRingSigned(t))}}static ofRingSigned(){if(arguments[0]instanceof Array){const t=arguments[0];if(t.length<3)return 0;let e=0;const i=t[0].x;for(let n=1;n<t.length-1;n++){const r=t[n].x-i,s=t[n+1].y;e+=r*(t[n-1].y-s)}return e/2}if($v(arguments[0],Jv)){const t=arguments[0],e=t.size();if(e<3)return 0;const i=new Hv,n=new Hv,r=new Hv;t.getCoordinate(0,n),t.getCoordinate(1,r);const s=n.x;r.x-=s;let o=0;for(let a=1;a<e-1;a++)i.y=n.y,n.x=r.x,n.y=r.y,t.getCoordinate(a+1,r),r.x-=s,o+=n.x*(i.y-r.y);return o/2}}}class mE{add(){}addAll(){}isEmpty(){}iterator(){}size(){}toArray(){}remove(){}}class _E extends Dv{}class yE extends mE{get(){}set(){}isEmpty(){}}class wE extends Dv{}class xE extends yE{constructor(t){super(),this.array=[],t instanceof mE&&this.addAll(t)}get interfaces_(){return[yE,mE]}ensureCapacity(){}add(t){return 1===arguments.length?this.array.push(t):this.array.splice(arguments[0],0,arguments[1]),!0}clear(){this.array=[]}addAll(t){for(const e of t)this.array.push(e)}set(t,e){const i=this.array[t];return this.array[t]=e,i}iterator(){return new bE(this)}get(t){if(t<0||t>=this.size())throw new _E;return this.array[t]}isEmpty(){return 0===this.array.length}sort(t){t?this.array.sort(((e,i)=>t.compare(e,i))):this.array.sort()}size(){return this.array.length}toArray(){return this.array.slice()}remove(t){for(let e=0,i=this.array.length;e<i;e++)if(this.array[e]===t)return!!this.array.splice(e,1);return!1}[Symbol.iterator](){return this.array.values()}}class bE{constructor(t){this.arrayList=t,this.position=0}next(){if(this.position===this.arrayList.size())throw new wE;return this.arrayList.get(this.position++)}hasNext(){return this.position<this.arrayList.size()}set(t){return this.arrayList.set(this.position-1,t)}remove(){this.arrayList.remove(this.arrayList.get(this.position))}}class vE{static sort(){const t=arguments[0];if(1===arguments.length)t.sort(((t,e)=>t.compareTo(e)));else if(2===arguments.length)t.sort(((t,e)=>arguments[1].compare(t,e)));else if(3===arguments.length){const e=t.slice(arguments[1],arguments[2]);e.sort();const i=t.slice(0,arguments[1]).concat(e,t.slice(arguments[2],t.length));t.splice(0,t.length);for(const e of i)t.push(e)}else if(4===arguments.length){const e=t.slice(arguments[1],arguments[2]);e.sort(((t,e)=>arguments[3].compare(t,e)));const i=t.slice(0,arguments[1]).concat(e,t.slice(arguments[2],t.length));t.splice(0,t.length);for(const e of i)t.push(e)}}static asList(t){const e=new xE;for(const i of t)e.add(i);return e}static copyOf(t,e){return t.slice(0,e)}}class EE{constructor(t){this.str=t}append(t){this.str+=t}setCharAt(t,e){this.str=this.str.substr(0,t)+e+this.str.substr(t+1)}toString(){return this.str}}class SE{constructor(t){this.value=t}intValue(){return this.value}compareTo(t){return this.value<t?-1:this.value>t?1:0}static compare(t,e){return t<e?-1:t>e?1:0}static isNan(t){return Number.isNaN(t)}static valueOf(t){return new SE(t)}}class IE{constructor(){IE.constructor_.apply(this,arguments)}static constructor_(){if(this._hi=0,this._lo=0,0===arguments.length)this.init(0);else if(1===arguments.length){if("number"==typeof arguments[0]){const t=arguments[0];this.init(t)}else if(arguments[0]instanceof IE){const t=arguments[0];this.init(t)}else if("string"==typeof arguments[0]){const t=arguments[0];IE.constructor_.call(this,IE.parse(t))}}else if(2===arguments.length){const t=arguments[0],e=arguments[1];this.init(t,e)}}static determinant(){if("number"==typeof arguments[3]&&"number"==typeof arguments[2]&&"number"==typeof arguments[0]&&"number"==typeof arguments[1]){const t=arguments[0],e=arguments[1],i=arguments[2],n=arguments[3];return IE.determinant(IE.valueOf(t),IE.valueOf(e),IE.valueOf(i),IE.valueOf(n))}if(arguments[3]instanceof IE&&arguments[2]instanceof IE&&arguments[0]instanceof IE&&arguments[1]instanceof IE){const t=arguments[1],e=arguments[2],i=arguments[3];return arguments[0].multiply(i).selfSubtract(t.multiply(e))}}static sqr(t){return IE.valueOf(t).selfMultiply(t)}static valueOf(){if("string"==typeof arguments[0]){const t=arguments[0];return IE.parse(t)}if("number"==typeof arguments[0])return new IE(arguments[0])}static sqrt(t){return IE.valueOf(t).sqrt()}static parse(t){let e=0;const i=t.length;for(;lE.isWhitespace(t.charAt(e));)e++;let n=!1;if(e<i){const i=t.charAt(e);"-"!==i&&"+"!==i||(e++,"-"===i&&(n=!0))}const r=new IE;let s=0,o=0,a=0,l=!1;for(;!(e>=i);){const i=t.charAt(e);if(e++,lE.isDigit(i)){const t=i-"0";r.selfMultiply(IE.TEN),r.selfAdd(t),s++}else{if("."!==i){if("e"===i||"E"===i){const i=t.substring(e);try{a=SE.parseInt(i)}catch(e){throw e instanceof NumberFormatException?new NumberFormatException("Invalid exponent "+i+" in string "+t):e}break}throw new NumberFormatException("Unexpected character '"+i+"' at position "+e+" in string "+t)}o=s,l=!0}}let h=r;l||(o=s);const c=s-o-a;if(0===c)h=r;else if(c>0){const t=IE.TEN.pow(c);h=r.divide(t)}else if(c<0){const t=IE.TEN.pow(-c);h=r.multiply(t)}return n?h.negate():h}static createNaN(){return new IE(zv.NaN,zv.NaN)}static copy(t){return new IE(t)}static magnitude(t){const e=Math.abs(t),i=Math.log(e)/Math.log(10);let n=Math.trunc(Math.floor(i));return 10*Math.pow(10,n)<=e&&(n+=1),n}static stringOfChar(t,e){const i=new EE;for(let n=0;n<e;n++)i.append(t);return i.toString()}le(t){return this._hi<t._hi||this._hi===t._hi&&this._lo<=t._lo}extractSignificantDigits(t,e){let i=this.abs(),n=IE.magnitude(i._hi);const r=IE.TEN.pow(n);i=i.divide(r),i.gt(IE.TEN)?(i=i.divide(IE.TEN),n+=1):i.lt(IE.ONE)&&(i=i.multiply(IE.TEN),n-=1);const s=n+1,o=new EE,a=IE.MAX_PRINT_DIGITS-1;for(let e=0;e<=a;e++){t&&e===s&&o.append(".");const n=Math.trunc(i._hi);if(n<0)break;let r=!1,l=0;n>9?(r=!0,l="9"):l="0"+n,o.append(l),i=i.subtract(IE.valueOf(n)).multiply(IE.TEN),r&&i.selfAdd(IE.TEN);let h=!0;const c=IE.magnitude(i._hi);if(c<0&&Math.abs(c)>=a-e&&(h=!1),!h)break}return e[0]=n,o.toString()}sqr(){return this.multiply(this)}doubleValue(){return this._hi+this._lo}subtract(){if(arguments[0]instanceof IE){const t=arguments[0];return this.add(t.negate())}if("number"==typeof arguments[0]){const t=arguments[0];return this.add(-t)}}equals(){if(1===arguments.length&&arguments[0]instanceof IE){const t=arguments[0];return this._hi===t._hi&&this._lo===t._lo}}isZero(){return 0===this._hi&&0===this._lo}selfSubtract(){if(arguments[0]instanceof IE){const t=arguments[0];return this.isNaN()?this:this.selfAdd(-t._hi,-t._lo)}if("number"==typeof arguments[0]){const t=arguments[0];return this.isNaN()?this:this.selfAdd(-t,0)}}getSpecialNumberString(){return this.isZero()?"0.0":this.isNaN()?"NaN ":null}min(t){return this.le(t)?this:t}selfDivide(){if(1===arguments.length){if(arguments[0]instanceof IE){const t=arguments[0];return this.selfDivide(t._hi,t._lo)}if("number"==typeof arguments[0]){const t=arguments[0];return this.selfDivide(t,0)}}else if(2===arguments.length){const t=arguments[0],e=arguments[1];let i=null,n=null,r=null,s=null,o=null,a=null,l=null,h=null;return o=this._hi/t,a=IE.SPLIT*o,i=a-o,h=IE.SPLIT*t,i=a-i,n=o-i,r=h-t,l=o*t,r=h-r,s=t-r,h=i*r-l+i*s+n*r+n*s,a=(this._hi-l-h+this._lo-o*e)/t,h=o+a,this._hi=h,this._lo=o-h+a,this}}dump(){return"DD<"+this._hi+", "+this._lo+">"}divide(){if(arguments[0]instanceof IE){const t=arguments[0];let e=null,i=null,n=null,r=null,s=null,o=null,a=null,l=null;return s=this._hi/t._hi,o=IE.SPLIT*s,e=o-s,l=IE.SPLIT*t._hi,e=o-e,i=s-e,n=l-t._hi,a=s*t._hi,n=l-n,r=t._hi-n,l=e*n-a+e*r+i*n+i*r,o=(this._hi-a-l+this._lo-s*t._lo)/t._hi,l=s+o,new IE(l,s-l+o)}if("number"==typeof arguments[0]){const t=arguments[0];return zv.isNaN(t)?IE.createNaN():IE.copy(this).selfDivide(t,0)}}ge(t){return this._hi>t._hi||this._hi===t._hi&&this._lo>=t._lo}pow(t){if(0===t)return IE.valueOf(1);let e=new IE(this),i=IE.valueOf(1),n=Math.abs(t);if(n>1)for(;n>0;)n%2==1&&i.selfMultiply(e),n/=2,n>0&&(e=e.sqr());else i=e;return t<0?i.reciprocal():i}ceil(){if(this.isNaN())return IE.NaN;const t=Math.ceil(this._hi);let e=0;return t===this._hi&&(e=Math.ceil(this._lo)),new IE(t,e)}compareTo(t){const e=t;return this._hi<e._hi?-1:this._hi>e._hi?1:this._lo<e._lo?-1:this._lo>e._lo?1:0}rint(){return this.isNaN()?this:this.add(.5).floor()}setValue(){if(arguments[0]instanceof IE){const t=arguments[0];return this.init(t),this}if("number"==typeof arguments[0]){const t=arguments[0];return this.init(t),this}}max(t){return this.ge(t)?this:t}sqrt(){if(this.isZero())return IE.valueOf(0);if(this.isNegative())return IE.NaN;const t=1/Math.sqrt(this._hi),e=this._hi*t,i=IE.valueOf(e),n=this.subtract(i.sqr())._hi*(.5*t);return i.add(n)}selfAdd(){if(1===arguments.length){if(arguments[0]instanceof IE){const t=arguments[0];return this.selfAdd(t._hi,t._lo)}if("number"==typeof arguments[0]){const t=arguments[0];let e=null,i=null,n=null,r=null,s=null,o=null;return n=this._hi+t,s=n-this._hi,r=n-s,r=t-s+(this._hi-r),o=r+this._lo,e=n+o,i=o+(n-e),this._hi=e+i,this._lo=i+(e-this._hi),this}}else if(2===arguments.length){const t=arguments[0],e=arguments[1];let i=null,n=null,r=null,s=null,o=null,a=null,l=null,h=null;o=this._hi+t,r=this._lo+e,l=o-this._hi,h=r-this._lo,a=o-l,s=r-h,a=t-l+(this._hi-a),s=e-h+(this._lo-s),l=a+r,i=o+l,n=l+(o-i),l=s+n;const c=i+l,u=l+(i-c);return this._hi=c,this._lo=u,this}}selfMultiply(){if(1===arguments.length){if(arguments[0]instanceof IE){const t=arguments[0];return this.selfMultiply(t._hi,t._lo)}if("number"==typeof arguments[0]){const t=arguments[0];return this.selfMultiply(t,0)}}else if(2===arguments.length){const t=arguments[0],e=arguments[1];let i=null,n=null,r=null,s=null,o=null,a=null;o=IE.SPLIT*this._hi,i=o-this._hi,a=IE.SPLIT*t,i=o-i,n=this._hi-i,r=a-t,o=this._hi*t,r=a-r,s=t-r,a=i*r-o+i*s+n*r+n*s+(this._hi*e+this._lo*t);const l=o+a;i=o-l;const h=a+i;return this._hi=l,this._lo=h,this}}selfSqr(){return this.selfMultiply(this)}floor(){if(this.isNaN())return IE.NaN;const t=Math.floor(this._hi);let e=0;return t===this._hi&&(e=Math.floor(this._lo)),new IE(t,e)}negate(){return this.isNaN()?this:new IE(-this._hi,-this._lo)}clone(){try{return null}catch(t){if(t instanceof CloneNotSupportedException)return null;throw t}}multiply(){if(arguments[0]instanceof IE){const t=arguments[0];return t.isNaN()?IE.createNaN():IE.copy(this).selfMultiply(t)}if("number"==typeof arguments[0]){const t=arguments[0];return zv.isNaN(t)?IE.createNaN():IE.copy(this).selfMultiply(t,0)}}isNaN(){return zv.isNaN(this._hi)}intValue(){return Math.trunc(this._hi)}toString(){const t=IE.magnitude(this._hi);return t>=-3&&t<=20?this.toStandardNotation():this.toSciNotation()}toStandardNotation(){const t=this.getSpecialNumberString();if(null!==t)return t;const e=new Array(1).fill(null),i=this.extractSignificantDigits(!0,e),n=e[0]+1;let r=i;if("."===i.charAt(0))r="0"+i;else if(n<0)r="0."+IE.stringOfChar("0",-n)+i;else if(-1===i.indexOf(".")){const t=n-i.length;r=i+IE.stringOfChar("0",t)+".0"}return this.isNegative()?"-"+r:r}reciprocal(){let t=null,e=null,i=null,n=null,r=null,s=null,o=null,a=null;r=1/this._hi,s=IE.SPLIT*r,t=s-r,a=IE.SPLIT*this._hi,t=s-t,e=r-t,i=a-this._hi,o=r*this._hi,i=a-i,n=this._hi-i,a=t*i-o+t*n+e*i+e*n,s=(1-o-a-r*this._lo)/this._hi;const l=r+s;return new IE(l,r-l+s)}toSciNotation(){if(this.isZero())return IE.SCI_NOT_ZERO;const t=this.getSpecialNumberString();if(null!==t)return t;const e=new Array(1).fill(null),i=this.extractSignificantDigits(!1,e),n=IE.SCI_NOT_EXPONENT_CHAR+e[0];if("0"===i.charAt(0))throw new IllegalStateException("Found leading zero: "+i);let r="";i.length>1&&(r=i.substring(1));const s=i.charAt(0)+"."+r;return this.isNegative()?"-"+s+n:s+n}abs(){return this.isNaN()?IE.NaN:this.isNegative()?this.negate():new IE(this)}isPositive(){return this._hi>0||0===this._hi&&this._lo>0}lt(t){return this._hi<t._hi||this._hi===t._hi&&this._lo<t._lo}add(){if(arguments[0]instanceof IE){const t=arguments[0];return IE.copy(this).selfAdd(t)}if("number"==typeof arguments[0]){const t=arguments[0];return IE.copy(this).selfAdd(t)}}init(){if(1===arguments.length){if("number"==typeof arguments[0]){const t=arguments[0];this._hi=t,this._lo=0}else if(arguments[0]instanceof IE){const t=arguments[0];this._hi=t._hi,this._lo=t._lo}}else if(2===arguments.length){const t=arguments[0],e=arguments[1];this._hi=t,this._lo=e}}gt(t){return this._hi>t._hi||this._hi===t._hi&&this._lo>t._lo}isNegative(){return this._hi<0||0===this._hi&&this._lo<0}trunc(){return this.isNaN()?IE.NaN:this.isPositive()?this.floor():this.ceil()}signum(){return this._hi>0?1:this._hi<0?-1:this._lo>0?1:this._lo<0?-1:0}get interfaces_(){return[Uv,Bv,Gv]}}IE.PI=new IE(3.141592653589793,12246467991473532e-32),IE.TWO_PI=new IE(6.283185307179586,24492935982947064e-32),IE.PI_2=new IE(1.5707963267948966,6123233995736766e-32),IE.E=new IE(2.718281828459045,14456468917292502e-32),IE.NaN=new IE(zv.NaN,zv.NaN),IE.EPS=123259516440783e-46,IE.SPLIT=134217729,IE.MAX_PRINT_DIGITS=32,IE.TEN=IE.valueOf(10),IE.ONE=IE.valueOf(1),IE.SCI_NOT_EXPONENT_CHAR="E",IE.SCI_NOT_ZERO="0.0E0";class ME{static orientationIndex(t,e,i){const n=ME.orientationIndexFilter(t,e,i);if(n<=1)return n;const r=IE.valueOf(e.x).selfAdd(-t.x),s=IE.valueOf(e.y).selfAdd(-t.y),o=IE.valueOf(i.x).selfAdd(-e.x),a=IE.valueOf(i.y).selfAdd(-e.y);return r.selfMultiply(a).selfSubtract(s.selfMultiply(o)).signum()}static signOfDet2x2(){if(arguments[3]instanceof IE&&arguments[2]instanceof IE&&arguments[0]instanceof IE&&arguments[1]instanceof IE){const t=arguments[1],e=arguments[2],i=arguments[3];return arguments[0].multiply(i).selfSubtract(t.multiply(e)).signum()}if("number"==typeof arguments[3]&&"number"==typeof arguments[2]&&"number"==typeof arguments[0]&&"number"==typeof arguments[1]){const t=arguments[0],e=arguments[1],i=arguments[2],n=arguments[3],r=IE.valueOf(t),s=IE.valueOf(e),o=IE.valueOf(i),a=IE.valueOf(n);return r.multiply(a).selfSubtract(s.multiply(o)).signum()}}static intersection(t,e,i,n){const r=new IE(t.y).selfSubtract(e.y),s=new IE(e.x).selfSubtract(t.x),o=new IE(t.x).selfMultiply(e.y).selfSubtract(new IE(e.x).selfMultiply(t.y)),a=new IE(i.y).selfSubtract(n.y),l=new IE(n.x).selfSubtract(i.x),h=new IE(i.x).selfMultiply(n.y).selfSubtract(new IE(n.x).selfMultiply(i.y)),c=s.multiply(h).selfSubtract(l.multiply(o)),u=a.multiply(o).selfSubtract(r.multiply(h)),d=r.multiply(l).selfSubtract(a.multiply(s)),g=c.selfDivide(d).doubleValue(),f=u.selfDivide(d).doubleValue();return zv.isNaN(g)||zv.isInfinite(g)||zv.isNaN(f)||zv.isInfinite(f)?null:new Hv(g,f)}static orientationIndexFilter(t,e,i){let n=null;const r=(t.x-i.x)*(e.y-i.y),s=(t.y-i.y)*(e.x-i.x),o=r-s;if(r>0){if(s<=0)return ME.signum(o);n=r+s}else{if(!(r<0))return ME.signum(o);if(s>=0)return ME.signum(o);n=-r-s}const a=ME.DP_SAFE_EPSILON*n;return o>=a||-o>=a?ME.signum(o):2}static signum(t){return t>0?1:t<0?-1:0}}ME.DP_SAFE_EPSILON=1e-15;class CE{static index(t,e,i){return ME.orientationIndex(t,e,i)}static isCCW(){if(arguments[0]instanceof Array){const t=arguments[0],e=t.length-1;if(e<3)throw new Ov("Ring has fewer than 4 points, so orientation cannot be determined");let i=t[0],n=0;for(let r=1;r<=e;r++){const e=t[r];e.y>i.y&&(i=e,n=r)}let r=n;do{r-=1,r<0&&(r=e)}while(t[r].equals2D(i)&&r!==n);let s=n;do{s=(s+1)%e}while(t[s].equals2D(i)&&s!==n);const o=t[r],a=t[s];if(o.equals2D(i)||a.equals2D(i)||o.equals2D(a))return!1;const l=CE.index(o,i,a);let h=null;return h=0===l?o.x>a.x:l>0,h}if($v(arguments[0],Jv)){const t=arguments[0],e=t.size()-1;if(e<3)throw new Ov("Ring has fewer than 4 points, so orientation cannot be determined");let i=t.getCoordinate(0),n=0;for(let r=1;r<=e;r++){const e=t.getCoordinate(r);e.y>i.y&&(i=e,n=r)}let r=null,s=n;do{s-=1,s<0&&(s=e),r=t.getCoordinate(s)}while(r.equals2D(i)&&s!==n);let o=null,a=n;do{a=(a+1)%e,o=t.getCoordinate(a)}while(o.equals2D(i)&&a!==n);if(r.equals2D(i)||o.equals2D(i)||r.equals2D(o))return!1;const l=CE.index(r,i,o);let h=null;return h=0===l?r.x>o.x:l>0,h}}}CE.CLOCKWISE=-1,CE.RIGHT=CE.CLOCKWISE,CE.COUNTERCLOCKWISE=1,CE.LEFT=CE.COUNTERCLOCKWISE,CE.COLLINEAR=0,CE.STRAIGHT=CE.COLLINEAR;class TE{}class RE extends iE{constructor(){super(),RE.constructor_.apply(this,arguments)}static constructor_(){this._shell=null,this._holes=null;let t=arguments[0],e=arguments[1],i=arguments[2];if(iE.constructor_.call(this,i),null===t&&(t=this.getFactory().createLinearRing()),null===e&&(e=[]),iE.hasNullElements(e))throw new Ov("holes must not contain null elements");if(t.isEmpty()&&iE.hasNonEmptyElements(e))throw new Ov("shell is empty but holes are not");this._shell=t,this._holes=e}computeEnvelopeInternal(){return this._shell.getEnvelopeInternal()}getCoordinates(){if(this.isEmpty())return[];const t=new Array(this.getNumPoints()).fill(null);let e=-1;const i=this._shell.getCoordinates();for(let n=0;n<i.length;n++)e++,t[e]=i[n];for(let i=0;i<this._holes.length;i++){const n=this._holes[i].getCoordinates();for(let i=0;i<n.length;i++)e++,t[e]=n[i]}return t}getArea(){let t=0;t+=pE.ofRing(this._shell.getCoordinateSequence());for(let e=0;e<this._holes.length;e++)t-=pE.ofRing(this._holes[e].getCoordinateSequence());return t}copyInternal(){const t=this._shell.copy(),e=new Array(this._holes.length).fill(null);for(let t=0;t<this._holes.length;t++)e[t]=this._holes[t].copy();return new RE(t,e,this._factory)}isRectangle(){if(0!==this.getNumInteriorRing())return!1;if(null===this._shell)return!1;if(5!==this._shell.getNumPoints())return!1;const t=this._shell.getCoordinateSequence(),e=this.getEnvelopeInternal();for(let i=0;i<5;i++){const n=t.getX(i);if(n!==e.getMinX()&&n!==e.getMaxX())return!1;const r=t.getY(i);if(r!==e.getMinY()&&r!==e.getMaxY())return!1}let i=t.getX(0),n=t.getY(0);for(let e=1;e<=4;e++){const r=t.getX(e),s=t.getY(e);if(r!==i==(s!==n))return!1;i=r,n=s}return!0}equalsExact(){if(2===arguments.length&&"number"==typeof arguments[1]&&arguments[0]instanceof iE){const t=arguments[0],e=arguments[1];if(!this.isEquivalentClass(t))return!1;const i=t,n=this._shell,r=i._shell;if(!n.equalsExact(r,e))return!1;if(this._holes.length!==i._holes.length)return!1;for(let t=0;t<this._holes.length;t++)if(!this._holes[t].equalsExact(i._holes[t],e))return!1;return!0}return super.equalsExact.apply(this,arguments)}normalize(){if(0===arguments.length){this._shell=this.normalized(this._shell,!0);for(let t=0;t<this._holes.length;t++)this._holes[t]=this.normalized(this._holes[t],!1);vE.sort(this._holes)}else if(2===arguments.length){const t=arguments[0],e=arguments[1];if(t.isEmpty())return null;const i=t.getCoordinateSequence(),n=oE.minCoordinateIndex(i,0,i.size()-2);oE.scroll(i,n,!0),CE.isCCW(i)===e&&oE.reverse(i)}}getCoordinate(){return this._shell.getCoordinate()}getNumInteriorRing(){return this._holes.length}getBoundaryDimension(){return 1}reverseInternal(){const t=this.getExteriorRing().reverse(),e=new Array(this.getNumInteriorRing()).fill(null);for(let t=0;t<e.length;t++)e[t]=this.getInteriorRingN(t).reverse();return this.getFactory().createPolygon(t,e)}getTypeCode(){return iE.TYPECODE_POLYGON}getDimension(){return 2}getLength(){let t=0;t+=this._shell.getLength();for(let e=0;e<this._holes.length;e++)t+=this._holes[e].getLength();return t}getNumPoints(){let t=this._shell.getNumPoints();for(let e=0;e<this._holes.length;e++)t+=this._holes[e].getNumPoints();return t}convexHull(){return this.getExteriorRing().convexHull()}normalized(t,e){const i=t.copy();return this.normalize(i,e),i}compareToSameClass(){if(1===arguments.length){const t=arguments[0],e=this._shell,i=t._shell;return e.compareToSameClass(i)}if(2===arguments.length){const t=arguments[1],e=arguments[0],i=this._shell,n=e._shell,r=i.compareToSameClass(n,t);if(0!==r)return r;const s=this.getNumInteriorRing(),o=e.getNumInteriorRing();let a=0;for(;a<s&&a<o;){const i=this.getInteriorRingN(a),n=e.getInteriorRingN(a),r=i.compareToSameClass(n,t);if(0!==r)return r;a++}return a<s?1:a<o?-1:0}}apply(){if($v(arguments[0],nE)){const t=arguments[0];this._shell.apply(t);for(let e=0;e<this._holes.length;e++)this._holes[e].apply(t)}else if($v(arguments[0],uE)){const t=arguments[0];if(this._shell.apply(t),!t.isDone())for(let e=0;e<this._holes.length&&(this._holes[e].apply(t),!t.isDone());e++);t.isGeometryChanged()&&this.geometryChanged()}else if($v(arguments[0],cE))arguments[0].filter(this);else if($v(arguments[0],tE)){const t=arguments[0];t.filter(this),this._shell.apply(t);for(let e=0;e<this._holes.length;e++)this._holes[e].apply(t)}}getBoundary(){if(this.isEmpty())return this.getFactory().createMultiLineString();const t=new Array(this._holes.length+1).fill(null);t[0]=this._shell;for(let e=0;e<this._holes.length;e++)t[e+1]=this._holes[e];return t.length<=1?this.getFactory().createLinearRing(t[0].getCoordinateSequence()):this.getFactory().createMultiLineString(t)}getGeometryType(){return iE.TYPENAME_POLYGON}getExteriorRing(){return this._shell}isEmpty(){return this._shell.isEmpty()}getInteriorRingN(t){return this._holes[t]}get interfaces_(){return[TE]}}class AE extends mE{contains(){}}class kE extends AE{}class PE extends kE{constructor(t){super(),this.array=[],t instanceof mE&&this.addAll(t)}contains(t){for(const e of this.array)if(0===e.compareTo(t))return!0;return!1}add(t){if(this.contains(t))return!1;for(let e=0,i=this.array.length;e<i;e++)if(1===this.array[e].compareTo(t))return!!this.array.splice(e,0,t);return this.array.push(t),!0}addAll(t){for(const e of t)this.add(e);return!0}remove(){throw new aE}size(){return this.array.length}isEmpty(){return 0===this.array.length}toArray(){return this.array.slice()}iterator(){return new LE(this.array)}}class LE{constructor(t){this.array=t,this.position=0}next(){if(this.position===this.array.length)throw new wE;return this.array[this.position++]}hasNext(){return this.position<this.array.length}remove(){throw new aE}}class NE extends iE{constructor(){super(),NE.constructor_.apply(this,arguments)}static constructor_(){if(this._geometries=null,0===arguments.length);else if(2===arguments.length){let t=arguments[0],e=arguments[1];if(iE.constructor_.call(this,e),null===t&&(t=[]),iE.hasNullElements(t))throw new Ov("geometries must not contain null elements");this._geometries=t}}computeEnvelopeInternal(){const t=new eE;for(let e=0;e<this._geometries.length;e++)t.expandToInclude(this._geometries[e].getEnvelopeInternal());return t}getGeometryN(t){return this._geometries[t]}getCoordinates(){const t=new Array(this.getNumPoints()).fill(null);let e=-1;for(let i=0;i<this._geometries.length;i++){const n=this._geometries[i].getCoordinates();for(let i=0;i<n.length;i++)e++,t[e]=n[i]}return t}getArea(){let t=0;for(let e=0;e<this._geometries.length;e++)t+=this._geometries[e].getArea();return t}copyInternal(){const t=new Array(this._geometries.length).fill(null);for(let e=0;e<t.length;e++)t[e]=this._geometries[e].copy();return new NE(t,this._factory)}equalsExact(){if(2===arguments.length&&"number"==typeof arguments[1]&&arguments[0]instanceof iE){const t=arguments[0],e=arguments[1];if(!this.isEquivalentClass(t))return!1;const i=t;if(this._geometries.length!==i._geometries.length)return!1;for(let t=0;t<this._geometries.length;t++)if(!this._geometries[t].equalsExact(i._geometries[t],e))return!1;return!0}return super.equalsExact.apply(this,arguments)}normalize(){for(let t=0;t<this._geometries.length;t++)this._geometries[t].normalize();vE.sort(this._geometries)}getCoordinate(){return this.isEmpty()?null:this._geometries[0].getCoordinate()}getBoundaryDimension(){let t=hE.FALSE;for(let e=0;e<this._geometries.length;e++)t=Math.max(t,this._geometries[e].getBoundaryDimension());return t}reverseInternal(){const t=this._geometries.length,e=new xE(t);for(let i=0;i<t;i++)e.add(this._geometries[i].reverse());return this.getFactory().buildGeometry(e)}getTypeCode(){return iE.TYPECODE_GEOMETRYCOLLECTION}getDimension(){let t=hE.FALSE;for(let e=0;e<this._geometries.length;e++)t=Math.max(t,this._geometries[e].getDimension());return t}getLength(){let t=0;for(let e=0;e<this._geometries.length;e++)t+=this._geometries[e].getLength();return t}getNumPoints(){let t=0;for(let e=0;e<this._geometries.length;e++)t+=this._geometries[e].getNumPoints();return t}getNumGeometries(){return this._geometries.length}compareToSameClass(){if(1===arguments.length){const t=arguments[0],e=new PE(vE.asList(this._geometries)),i=new PE(vE.asList(t._geometries));return this.compare(e,i)}if(2===arguments.length){const t=arguments[1],e=arguments[0],i=this.getNumGeometries(),n=e.getNumGeometries();let r=0;for(;r<i&&r<n;){const i=this.getGeometryN(r),n=e.getGeometryN(r),s=i.compareToSameClass(n,t);if(0!==s)return s;r++}return r<i?1:r<n?-1:0}}apply(){if($v(arguments[0],nE)){const t=arguments[0];for(let e=0;e<this._geometries.length;e++)this._geometries[e].apply(t)}else if($v(arguments[0],uE)){const t=arguments[0];if(0===this._geometries.length)return null;for(let e=0;e<this._geometries.length&&(this._geometries[e].apply(t),!t.isDone());e++);t.isGeometryChanged()&&this.geometryChanged()}else if($v(arguments[0],cE)){const t=arguments[0];t.filter(this);for(let e=0;e<this._geometries.length;e++)this._geometries[e].apply(t)}else if($v(arguments[0],tE)){const t=arguments[0];t.filter(this);for(let e=0;e<this._geometries.length;e++)this._geometries[e].apply(t)}}getBoundary(){return iE.checkNotGeometryCollection(this),Vv.shouldNeverReachHere(),null}getGeometryType(){return iE.TYPENAME_GEOMETRYCOLLECTION}isEmpty(){for(let t=0;t<this._geometries.length;t++)if(!this._geometries[t].isEmpty())return!1;return!0}}class DE extends NE{constructor(){super(),DE.constructor_.apply(this,arguments)}static constructor_(){const t=arguments[0],e=arguments[1];NE.constructor_.call(this,t,e)}copyInternal(){const t=new Array(this._geometries.length).fill(null);for(let e=0;e<t.length;e++)t[e]=this._geometries[e].copy();return new DE(t,this._factory)}isValid(){return!0}equalsExact(){if(2===arguments.length&&"number"==typeof arguments[1]&&arguments[0]instanceof iE){const t=arguments[0],e=arguments[1];return!!this.isEquivalentClass(t)&&super.equalsExact.call(this,t,e)}return super.equalsExact.apply(this,arguments)}getCoordinate(){if(1===arguments.length&&Number.isInteger(arguments[0])){const t=arguments[0];return this._geometries[t].getCoordinate()}return super.getCoordinate.apply(this,arguments)}getBoundaryDimension(){return hE.FALSE}getTypeCode(){return iE.TYPECODE_MULTIPOINT}getDimension(){return 0}getBoundary(){return this.getFactory().createGeometryCollection()}getGeometryType(){return iE.TYPENAME_MULTIPOINT}get interfaces_(){return[gE]}}class OE extends dE{constructor(){super(),OE.constructor_.apply(this,arguments)}static constructor_(){const t=arguments[0],e=arguments[1];dE.constructor_.call(this,t,e),this.validateConstruction()}copyInternal(){return new OE(this._points.copy(),this._factory)}getBoundaryDimension(){return hE.FALSE}isClosed(){return!!this.isEmpty()||super.isClosed.call(this)}reverseInternal(){const t=this._points.copy();return oE.reverse(t),this.getFactory().createLinearRing(t)}getTypeCode(){return iE.TYPECODE_LINEARRING}validateConstruction(){if(!this.isEmpty()&&!super.isClosed.call(this))throw new Ov("Points of LinearRing do not form a closed linestring");if(this.getCoordinateSequence().size()>=1&&this.getCoordinateSequence().size()<OE.MINIMUM_VALID_SIZE)throw new Ov("Invalid number of points in LinearRing (found "+this.getCoordinateSequence().size()+" - must be 0 or >= 4)")}getGeometryType(){return iE.TYPENAME_LINEARRING}}OE.MINIMUM_VALID_SIZE=4;class FE extends Hv{constructor(){super(),FE.constructor_.apply(this,arguments)}static constructor_(){if(0===arguments.length)Hv.constructor_.call(this);else if(1===arguments.length){if(arguments[0]instanceof FE){const t=arguments[0];Hv.constructor_.call(this,t.x,t.y)}else if(arguments[0]instanceof Hv){const t=arguments[0];Hv.constructor_.call(this,t.x,t.y)}}else if(2===arguments.length){const t=arguments[0],e=arguments[1];Hv.constructor_.call(this,t,e,Hv.NULL_ORDINATE)}}setOrdinate(t,e){switch(t){case FE.X:this.x=e;break;case FE.Y:this.y=e;break;default:throw new Ov("Invalid ordinate index: "+t)}}getZ(){return Hv.NULL_ORDINATE}getOrdinate(t){switch(t){case FE.X:return this.x;case FE.Y:return this.y}throw new Ov("Invalid ordinate index: "+t)}setZ(t){throw new Ov("CoordinateXY dimension 2 does not support z-ordinate")}copy(){return new FE(this)}toString(){return"("+this.x+", "+this.y+")"}setCoordinate(t){this.x=t.x,this.y=t.y,this.z=t.getZ()}}FE.X=0,FE.Y=1,FE.Z=-1,FE.M=-1;class zE extends Hv{constructor(){super(),zE.constructor_.apply(this,arguments)}static constructor_(){if(this._m=null,0===arguments.length)Hv.constructor_.call(this),this._m=0;else if(1===arguments.length){if(arguments[0]instanceof zE){const t=arguments[0];Hv.constructor_.call(this,t.x,t.y),this._m=t._m}else if(arguments[0]instanceof Hv){const t=arguments[0];Hv.constructor_.call(this,t.x,t.y),this._m=this.getM()}}else if(3===arguments.length){const t=arguments[0],e=arguments[1],i=arguments[2];Hv.constructor_.call(this,t,e,Hv.NULL_ORDINATE),this._m=i}}getM(){return this._m}setOrdinate(t,e){switch(t){case zE.X:this.x=e;break;case zE.Y:this.y=e;break;case zE.M:this._m=e;break;default:throw new Ov("Invalid ordinate index: "+t)}}setM(t){this._m=t}getZ(){return Hv.NULL_ORDINATE}getOrdinate(t){switch(t){case zE.X:return this.x;case zE.Y:return this.y;case zE.M:return this._m}throw new Ov("Invalid ordinate index: "+t)}setZ(t){throw new Ov("CoordinateXY dimension 2 does not support z-ordinate")}copy(){return new zE(this)}toString(){return"("+this.x+", "+this.y+" m="+this.getM()+")"}setCoordinate(t){this.x=t.x,this.y=t.y,this.z=t.getZ(),this._m=t.getM()}}zE.X=0,zE.Y=1,zE.Z=-1,zE.M=2;class BE extends Hv{constructor(){super(),BE.constructor_.apply(this,arguments)}static constructor_(){if(this._m=null,0===arguments.length)Hv.constructor_.call(this),this._m=0;else if(1===arguments.length){if(arguments[0]instanceof BE){const t=arguments[0];Hv.constructor_.call(this,t),this._m=t._m}else if(arguments[0]instanceof Hv){const t=arguments[0];Hv.constructor_.call(this,t),this._m=this.getM()}}else if(4===arguments.length){const t=arguments[0],e=arguments[1],i=arguments[2],n=arguments[3];Hv.constructor_.call(this,t,e,i),this._m=n}}getM(){return this._m}setOrdinate(t,e){switch(t){case Hv.X:this.x=e;break;case Hv.Y:this.y=e;break;case Hv.Z:this.z=e;break;case Hv.M:this._m=e;break;default:throw new Ov("Invalid ordinate index: "+t)}}setM(t){this._m=t}getOrdinate(t){switch(t){case Hv.X:return this.x;case Hv.Y:return this.y;case Hv.Z:return this.getZ();case Hv.M:return this.getM()}throw new Ov("Invalid ordinate index: "+t)}copy(){return new BE(this)}toString(){return"("+this.x+", "+this.y+", "+this.getZ()+" m="+this.getM()+")"}setCoordinate(t){this.x=t.x,this.y=t.y,this.z=t.getZ(),this._m=t.getM()}}class GE{static measures(t){return t instanceof FE?0:t instanceof zE||t instanceof BE?1:0}static dimension(t){return t instanceof FE?2:t instanceof zE?3:t instanceof BE?4:3}static create(){if(1===arguments.length){const t=arguments[0];return GE.create(t,0)}if(2===arguments.length){const t=arguments[0],e=arguments[1];return 2===t?new FE:3===t&&0===e?new Hv:3===t&&1===e?new zE:4===t&&1===e?new BE:new Hv}}}class YE extends xE{constructor(){super(),YE.constructor_.apply(this,arguments)}static constructor_(){if(0===arguments.length);else if(1===arguments.length){const t=arguments[0];this.ensureCapacity(t.length),this.add(t,!0)}else if(2===arguments.length){const t=arguments[0],e=arguments[1];this.ensureCapacity(t.length),this.add(t,e)}}getCoordinate(t){return this.get(t)}addAll(){if(2===arguments.length&&"boolean"==typeof arguments[1]&&$v(arguments[0],mE)){const t=arguments[1];let e=!1;for(let i=arguments[0].iterator();i.hasNext();)this.add(i.next(),t),e=!0;return e}return super.addAll.apply(this,arguments)}clone(){const t=super.clone.call(this);for(let e=0;e<this.size();e++)t.add(e,this.get(e).clone());return t}toCoordinateArray(){if(0===arguments.length)return this.toArray(YE.coordArrayType);if(1===arguments.length){if(arguments[0])return this.toArray(YE.coordArrayType);const t=this.size(),e=new Array(t).fill(null);for(let i=0;i<t;i++)e[i]=this.get(t-i-1);return e}}add(){if(1===arguments.length){const t=arguments[0];return super.add.call(this,t)}if(2===arguments.length){if(arguments[0]instanceof Array&&"boolean"==typeof arguments[1]){const t=arguments[0],e=arguments[1];return this.add(t,e,!0),!0}if(arguments[0]instanceof Hv&&"boolean"==typeof arguments[1]){const t=arguments[0];if(!arguments[1]&&this.size()>=1&&this.get(this.size()-1).equals2D(t))return null;super.add.call(this,t)}else if(arguments[0]instanceof Object&&"boolean"==typeof arguments[1]){const t=arguments[0],e=arguments[1];return this.add(t,e),!0}}else if(3===arguments.length){if("boolean"==typeof arguments[2]&&arguments[0]instanceof Array&&"boolean"==typeof arguments[1]){const t=arguments[0],e=arguments[1];if(arguments[2])for(let i=0;i<t.length;i++)this.add(t[i],e);else for(let i=t.length-1;i>=0;i--)this.add(t[i],e);return!0}if("boolean"==typeof arguments[2]&&Number.isInteger(arguments[0])&&arguments[1]instanceof Hv){const t=arguments[0],e=arguments[1];if(!arguments[2]){const i=this.size();if(i>0){if(t>0&&this.get(t-1).equals2D(e))return null;if(t<i&&this.get(t).equals2D(e))return null}}super.add.call(this,t,e)}}else if(4===arguments.length){const t=arguments[0],e=arguments[1],i=arguments[2],n=arguments[3];let r=1;i>n&&(r=-1);for(let s=i;s!==n;s+=r)this.add(t[s],e);return!0}}closeRing(){if(this.size()>0){const t=this.get(0).copy();this.add(t,!1)}}}YE.coordArrayType=new Array(0).fill(null);class UE{static log10(t){const e=Math.log(t);return zv.isInfinite(e)||zv.isNaN(e)?e:e/UE.LOG_10}static min(t,e,i,n){let r=t;return e<r&&(r=e),i<r&&(r=i),n<r&&(r=n),r}static clamp(){if("number"==typeof arguments[2]&&"number"==typeof arguments[0]&&"number"==typeof arguments[1]){const t=arguments[0],e=arguments[1],i=arguments[2];return t<e?e:t>i?i:t}if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){const t=arguments[0],e=arguments[1],i=arguments[2];return t<e?e:t>i?i:t}}static wrap(t,e){return t<0?e- -t%e:t%e}static max(){if(3===arguments.length){const t=arguments[1],e=arguments[2];let i=arguments[0];return t>i&&(i=t),e>i&&(i=e),i}if(4===arguments.length){const t=arguments[1],e=arguments[2],i=arguments[3];let n=arguments[0];return t>n&&(n=t),e>n&&(n=e),i>n&&(n=i),n}}static average(t,e){return(t+e)/2}}UE.LOG_10=Math.log(10);class XE{static arraycopy(t,e,i,n,r){let s=0;for(let o=e;o<e+r;o++)i[n+s]=t[o],s++}static getProperty(t){return{"line.separator":"\n"}[t]}}class qE{static isRing(t){return!(t.length<4||!t[0].equals2D(t[t.length-1]))}static ptNotInList(t,e){for(let i=0;i<t.length;i++){const n=t[i];if(qE.indexOf(n,e)<0)return n}return null}static scroll(t,e){const i=qE.indexOf(e,t);if(i<0)return null;const n=new Array(t.length).fill(null);XE.arraycopy(t,i,n,0,t.length-i),XE.arraycopy(t,0,n,t.length-i,i),XE.arraycopy(n,0,t,0,t.length)}static equals(){if(2===arguments.length){const t=arguments[0],e=arguments[1];if(t===e)return!0;if(null===t||null===e)return!1;if(t.length!==e.length)return!1;for(let i=0;i<t.length;i++)if(!t[i].equals(e[i]))return!1;return!0}if(3===arguments.length){const t=arguments[0],e=arguments[1],i=arguments[2];if(t===e)return!0;if(null===t||null===e)return!1;if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(0!==i.compare(t[n],e[n]))return!1;return!0}}static intersection(t,e){const i=new YE;for(let n=0;n<t.length;n++)e.intersects(t[n])&&i.add(t[n],!0);return i.toCoordinateArray()}static measures(t){if(null===t||0===t.length)return 0;let e=0;for(const i of t)e=Math.max(e,GE.measures(i));return e}static hasRepeatedPoints(t){for(let e=1;e<t.length;e++)if(t[e-1].equals(t[e]))return!0;return!1}static removeRepeatedPoints(t){return qE.hasRepeatedPoints(t)?new YE(t,!1).toCoordinateArray():t}static reverse(t){const e=t.length-1,i=Math.trunc(e/2);for(let n=0;n<=i;n++){const i=t[n];t[n]=t[e-n],t[e-n]=i}}static removeNull(t){let e=0;for(let i=0;i<t.length;i++)null!==t[i]&&e++;const i=new Array(e).fill(null);if(0===e)return i;let n=0;for(let e=0;e<t.length;e++)null!==t[e]&&(i[n++]=t[e]);return i}static copyDeep(){if(1===arguments.length){const t=arguments[0],e=new Array(t.length).fill(null);for(let i=0;i<t.length;i++)e[i]=t[i].copy();return e}if(5===arguments.length){const t=arguments[0],e=arguments[1],i=arguments[2],n=arguments[3],r=arguments[4];for(let s=0;s<r;s++)i[n+s]=t[e+s].copy()}}static isEqualReversed(t,e){for(let i=0;i<t.length;i++){const n=t[i],r=e[t.length-i-1];if(0!==n.compareTo(r))return!1}return!0}static envelope(t){const e=new eE;for(let i=0;i<t.length;i++)e.expandToInclude(t[i]);return e}static toCoordinateArray(t){return t.toArray(qE.coordArrayType)}static dimension(t){if(null===t||0===t.length)return 3;let e=0;for(const i of t)e=Math.max(e,GE.dimension(i));return e}static atLeastNCoordinatesOrNothing(t,e){return e.length>=t?e:[]}static indexOf(t,e){for(let i=0;i<e.length;i++)if(t.equals(e[i]))return i;return-1}static increasingDirection(t){for(let e=0;e<Math.trunc(t.length/2);e++){const i=t.length-1-e,n=t[e].compareTo(t[i]);if(0!==n)return n}return 1}static compare(t,e){let i=0;for(;i<t.length&&i<e.length;){const n=t[i].compareTo(e[i]);if(0!==n)return n;i++}return i<e.length?-1:i<t.length?1:0}static minCoordinate(t){let e=null;for(let i=0;i<t.length;i++)(null===e||e.compareTo(t[i])>0)&&(e=t[i]);return e}static extract(t,e,i){e=UE.clamp(e,0,t.length);let n=(i=UE.clamp(i,-1,t.length))-e+1;i<0&&(n=0),e>=t.length&&(n=0),i<e&&(n=0);const r=new Array(n).fill(null);if(0===n)return r;let s=0;for(let n=e;n<=i;n++)r[s++]=t[n];return r}}qE.ForwardComparator=class{compare(t,e){const i=t,n=e;return qE.compare(i,n)}get interfaces_(){return[Yv]}},qE.BidirectionalComparator=class{compare(t,e){const i=t,n=e;if(i.length<n.length)return-1;if(i.length>n.length)return 1;if(0===i.length)return 0;const r=qE.compare(i,n);return qE.isEqualReversed(i,n)?0:r}OLDcompare(t,e){const i=t,n=e;if(i.length<n.length)return-1;if(i.length>n.length)return 1;if(0===i.length)return 0;const r=qE.increasingDirection(i),s=qE.increasingDirection(n);let o=r>0?0:i.length-1,a=s>0?0:i.length-1;for(let t=0;t<i.length;t++){const t=i[o].compareTo(n[a]);if(0!==t)return t;o+=r,a+=s}return 0}get interfaces_(){return[Yv]}},qE.coordArrayType=new Array(0).fill(null);class VE{constructor(t){this.str=t}append(t){this.str+=t}setCharAt(t,e){this.str=this.str.substr(0,t)+e+this.str.substr(t+1)}toString(){return this.str}}class jE{constructor(){jE.constructor_.apply(this,arguments)}static constructor_(){if(this._dimension=3,this._measures=0,this._coordinates=null,1===arguments.length){if(arguments[0]instanceof Array){const t=arguments[0];jE.constructor_.call(this,t,qE.dimension(t),qE.measures(t))}else if(Number.isInteger(arguments[0])){const t=arguments[0];this._coordinates=new Array(t).fill(null);for(let e=0;e<t;e++)this._coordinates[e]=new Hv}else if($v(arguments[0],Jv)){const t=arguments[0];if(null===t)return this._coordinates=new Array(0).fill(null),null;this._dimension=t.getDimension(),this._measures=t.getMeasures(),this._coordinates=new Array(t.size()).fill(null);for(let e=0;e<this._coordinates.length;e++)this._coordinates[e]=t.getCoordinateCopy(e)}}else if(2===arguments.length){if(arguments[0]instanceof Array&&Number.isInteger(arguments[1])){const t=arguments[0],e=arguments[1];jE.constructor_.call(this,t,e,qE.measures(t))}else if(Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){const t=arguments[0],e=arguments[1];this._coordinates=new Array(t).fill(null),this._dimension=e;for(let i=0;i<t;i++)this._coordinates[i]=GE.create(e)}}else if(3===arguments.length)if(Number.isInteger(arguments[2])&&arguments[0]instanceof Array&&Number.isInteger(arguments[1])){const t=arguments[0],e=arguments[1],i=arguments[2];this._dimension=e,this._measures=i,this._coordinates=null===t?new Array(0).fill(null):t}else if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){const t=arguments[0],e=arguments[1],i=arguments[2];this._coordinates=new Array(t).fill(null),this._dimension=e,this._measures=i;for(let e=0;e<t;e++)this._coordinates[e]=this.createCoordinate()}}getM(t){return this.hasM()?this._coordinates[t].getM():zv.NaN}setOrdinate(t,e,i){switch(e){case Jv.X:this._coordinates[t].x=i;break;case Jv.Y:this._coordinates[t].y=i;break;default:this._coordinates[t].setOrdinate(e,i)}}getZ(t){return this.hasZ()?this._coordinates[t].getZ():zv.NaN}size(){return this._coordinates.length}getOrdinate(t,e){switch(e){case Jv.X:return this._coordinates[t].x;case Jv.Y:return this._coordinates[t].y;default:return this._coordinates[t].getOrdinate(e)}}getCoordinate(){if(1===arguments.length){const t=arguments[0];return this._coordinates[t]}if(2===arguments.length){const t=arguments[0];arguments[1].setCoordinate(this._coordinates[t])}}getCoordinateCopy(t){const e=this.createCoordinate();return e.setCoordinate(this._coordinates[t]),e}createCoordinate(){return GE.create(this.getDimension(),this.getMeasures())}getDimension(){return this._dimension}getX(t){return this._coordinates[t].x}getMeasures(){return this._measures}expandEnvelope(t){for(let e=0;e<this._coordinates.length;e++)t.expandToInclude(this._coordinates[e]);return t}copy(){const t=new Array(this.size()).fill(null);for(let e=0;e<this._coordinates.length;e++){const i=this.createCoordinate();i.setCoordinate(this._coordinates[e]),t[e]=i}return new jE(t,this._dimension,this._measures)}toString(){if(this._coordinates.length>0){const t=new VE(17*this._coordinates.length);t.append("("),t.append(this._coordinates[0]);for(let e=1;e<this._coordinates.length;e++)t.append(", "),t.append(this._coordinates[e]);return t.append(")"),t.toString()}return"()"}getY(t){return this._coordinates[t].y}toCoordinateArray(){return this._coordinates}get interfaces_(){return[Jv,Uv]}}class WE{static instance(){return WE.instanceObject}readResolve(){return WE.instance()}create(){if(1===arguments.length){if(arguments[0]instanceof Array)return new jE(arguments[0]);if($v(arguments[0],Jv))return new jE(arguments[0])}else{if(2===arguments.length){let t=arguments[1];return t>3&&(t=3),t<2&&(t=2),new jE(arguments[0],t)}if(3===arguments.length){let t=arguments[2],e=arguments[1]-t;return t>1&&(t=1),e>3&&(e=3),e<2&&(e=2),new jE(arguments[0],e+t,t)}}}get interfaces_(){return[Qv,Uv]}}WE.instanceObject=new WE;class ZE extends NE{constructor(){super(),ZE.constructor_.apply(this,arguments)}static constructor_(){const t=arguments[0],e=arguments[1];NE.constructor_.call(this,t,e)}copyInternal(){const t=new Array(this._geometries.length).fill(null);for(let e=0;e<t.length;e++)t[e]=this._geometries[e].copy();return new ZE(t,this._factory)}equalsExact(){if(2===arguments.length&&"number"==typeof arguments[1]&&arguments[0]instanceof iE){const t=arguments[0],e=arguments[1];return!!this.isEquivalentClass(t)&&super.equalsExact.call(this,t,e)}return super.equalsExact.apply(this,arguments)}getBoundaryDimension(){return 1}getTypeCode(){return iE.TYPECODE_MULTIPOLYGON}getDimension(){return 2}getBoundary(){if(this.isEmpty())return this.getFactory().createMultiLineString();const t=new xE;for(let e=0;e<this._geometries.length;e++){const i=this._geometries[e].getBoundary();for(let e=0;e<i.getNumGeometries();e++)t.add(i.getGeometryN(e))}const e=new Array(t.size()).fill(null);return this.getFactory().createMultiLineString(t.toArray(e))}getGeometryType(){return iE.TYPENAME_MULTIPOLYGON}get interfaces_(){return[TE]}}class HE{get(){}put(){}size(){}values(){}entrySet(){}}class KE extends AE{constructor(t){super(),this.map=new Map,t instanceof mE&&this.addAll(t)}contains(t){const e=t.hashCode?t.hashCode():t;return!!this.map.has(e)}add(t){const e=t.hashCode?t.hashCode():t;return!this.map.has(e)&&!!this.map.set(e,t)}addAll(t){for(const e of t)this.add(e);return!0}remove(){throw new aE}size(){return this.map.size}isEmpty(){return 0===this.map.size}toArray(){return Array.from(this.map.values())}iterator(){return new $E(this.map)}[Symbol.iterator](){return this.map}}class $E{constructor(t){this.iterator=t.values();const{done:e,value:i}=this.iterator.next();this.done=e,this.value=i}next(){if(this.done)throw new wE;const t=this.value,{done:e,value:i}=this.iterator.next();return this.done=e,this.value=i,t}hasNext(){return!this.done}remove(){throw new aE}}class JE{constructor(){JE.constructor_.apply(this,arguments)}static constructor_(){if(this._modelType=null,this._scale=null,0===arguments.length)this._modelType=JE.FLOATING;else if(1===arguments.length)if(arguments[0]instanceof QE){const t=arguments[0];this._modelType=t,t===JE.FIXED&&this.setScale(1)}else if("number"==typeof arguments[0]){const t=arguments[0];this._modelType=JE.FIXED,this.setScale(t)}else if(arguments[0]instanceof JE){const t=arguments[0];this._modelType=t._modelType,this._scale=t._scale}}static mostPrecise(t,e){return t.compareTo(e)>=0?t:e}equals(t){if(!(t instanceof JE))return!1;const e=t;return this._modelType===e._modelType&&this._scale===e._scale}compareTo(t){const e=t,i=this.getMaximumSignificantDigits(),n=e.getMaximumSignificantDigits();return SE.compare(i,n)}getScale(){return this._scale}isFloating(){return this._modelType===JE.FLOATING||this._modelType===JE.FLOATING_SINGLE}getType(){return this._modelType}toString(){let t="UNKNOWN";return this._modelType===JE.FLOATING?t="Floating":this._modelType===JE.FLOATING_SINGLE?t="Floating-Single":this._modelType===JE.FIXED&&(t="Fixed (Scale="+this.getScale()+")"),t}makePrecise(){if("number"==typeof arguments[0]){const t=arguments[0];return zv.isNaN(t)||this._modelType===JE.FLOATING_SINGLE?t:this._modelType===JE.FIXED?Math.round(t*this._scale)/this._scale:t}if(arguments[0]instanceof Hv){const t=arguments[0];if(this._modelType===JE.FLOATING)return null;t.x=this.makePrecise(t.x),t.y=this.makePrecise(t.y)}}getMaximumSignificantDigits(){let t=16;return this._modelType===JE.FLOATING?t=16:this._modelType===JE.FLOATING_SINGLE?t=6:this._modelType===JE.FIXED&&(t=1+Math.trunc(Math.ceil(Math.log(this.getScale())/Math.log(10)))),t}setScale(t){this._scale=Math.abs(t)}get interfaces_(){return[Uv,Bv]}}class QE{constructor(){QE.constructor_.apply(this,arguments)}static constructor_(){this._name=null;const t=arguments[0];this._name=t,QE.nameToTypeMap.put(t,this)}readResolve(){return QE.nameToTypeMap.get(this._name)}toString(){return this._name}get interfaces_(){return[Uv]}}QE.nameToTypeMap=new class extends HE{constructor(){super(),this.map=new Map}get(t){return this.map.get(t)||null}put(t,e){return this.map.set(t,e),e}values(){const t=new xE,e=this.map.values();let i=e.next();for(;!i.done;)t.add(i.value),i=e.next();return t}entrySet(){const t=new KE;return this.map.entries().forEach((e=>t.add(e))),t}size(){return this.map.size()}},JE.Type=QE,JE.FIXED=new QE("FIXED"),JE.FLOATING=new QE("FLOATING"),JE.FLOATING_SINGLE=new QE("FLOATING SINGLE"),JE.maximumPreciseValue=9007199254740992;class tS extends NE{constructor(){super(),tS.constructor_.apply(this,arguments)}static constructor_(){const t=arguments[0],e=arguments[1];NE.constructor_.call(this,t,e)}copyInternal(){const t=new Array(this._geometries.length).fill(null);for(let e=0;e<t.length;e++)t[e]=this._geometries[e].copy();return new tS(t,this._factory)}equalsExact(){if(2===arguments.length&&"number"==typeof arguments[1]&&arguments[0]instanceof iE){const t=arguments[0],e=arguments[1];return!!this.isEquivalentClass(t)&&super.equalsExact.call(this,t,e)}return super.equalsExact.apply(this,arguments)}getBoundaryDimension(){return this.isClosed()?hE.FALSE:0}isClosed(){if(this.isEmpty())return!1;for(let t=0;t<this._geometries.length;t++)if(!this._geometries[t].isClosed())return!1;return!0}getTypeCode(){return iE.TYPECODE_MULTILINESTRING}getDimension(){return 1}getBoundary(){throw new aE}getGeometryType(){return iE.TYPENAME_MULTILINESTRING}get interfaces_(){return[sE]}}class eS{constructor(){eS.constructor_.apply(this,arguments)}static constructor_(){if(this._precisionModel=null,this._coordinateSequenceFactory=null,this._SRID=null,0===arguments.length)eS.constructor_.call(this,new JE,0);else if(1===arguments.length){if($v(arguments[0],Qv)){const t=arguments[0];eS.constructor_.call(this,new JE,0,t)}else if(arguments[0]instanceof JE){const t=arguments[0];eS.constructor_.call(this,t,0,eS.getDefaultCoordinateSequenceFactory())}}else if(2===arguments.length){const t=arguments[0],e=arguments[1];eS.constructor_.call(this,t,e,eS.getDefaultCoordinateSequenceFactory())}else if(3===arguments.length){const t=arguments[0],e=arguments[1],i=arguments[2];this._precisionModel=t,this._coordinateSequenceFactory=i,this._SRID=e}}static toMultiPolygonArray(t){const e=new Array(t.size()).fill(null);return t.toArray(e)}static toGeometryArray(t){if(null===t)return null;const e=new Array(t.size()).fill(null);return t.toArray(e)}static getDefaultCoordinateSequenceFactory(){return WE.instance()}static toMultiLineStringArray(t){const e=new Array(t.size()).fill(null);return t.toArray(e)}static toLineStringArray(t){const e=new Array(t.size()).fill(null);return t.toArray(e)}static toMultiPointArray(t){const e=new Array(t.size()).fill(null);return t.toArray(e)}static toLinearRingArray(t){const e=new Array(t.size()).fill(null);return t.toArray(e)}static toPointArray(t){const e=new Array(t.size()).fill(null);return t.toArray(e)}static toPolygonArray(t){const e=new Array(t.size()).fill(null);return t.toArray(e)}static createPointFromInternalCoord(t,e){return e.getPrecisionModel().makePrecise(t),e.getFactory().createPoint(t)}createEmpty(t){switch(t){case-1:return this.createGeometryCollection();case 0:return this.createPoint();case 1:return this.createLineString();case 2:return this.createPolygon();default:throw new Ov("Invalid dimension: "+t)}}toGeometry(t){return t.isNull()?this.createPoint():t.getMinX()===t.getMaxX()&&t.getMinY()===t.getMaxY()?this.createPoint(new Hv(t.getMinX(),t.getMinY())):t.getMinX()===t.getMaxX()||t.getMinY()===t.getMaxY()?this.createLineString([new Hv(t.getMinX(),t.getMinY()),new Hv(t.getMaxX(),t.getMaxY())]):this.createPolygon(this.createLinearRing([new Hv(t.getMinX(),t.getMinY()),new Hv(t.getMinX(),t.getMaxY()),new Hv(t.getMaxX(),t.getMaxY()),new Hv(t.getMaxX(),t.getMinY()),new Hv(t.getMinX(),t.getMinY())]),null)}createLineString(){if(0===arguments.length)return this.createLineString(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof Array){const t=arguments[0];return this.createLineString(null!==t?this.getCoordinateSequenceFactory().create(t):null)}if($v(arguments[0],Jv))return new dE(arguments[0],this)}}createMultiLineString(){return 0===arguments.length?new tS(null,this):1===arguments.length?new tS(arguments[0],this):void 0}buildGeometry(t){let e=null,i=!1,n=!1;for(let r=t.iterator();r.hasNext();){const t=r.next(),s=t.getTypeCode();null===e&&(e=s),s!==e&&(i=!0),t instanceof NE&&(n=!0)}if(null===e)return this.createGeometryCollection();if(i||n)return this.createGeometryCollection(eS.toGeometryArray(t));const r=t.iterator().next();if(t.size()>1){if(r instanceof RE)return this.createMultiPolygon(eS.toPolygonArray(t));if(r instanceof dE)return this.createMultiLineString(eS.toLineStringArray(t));if(r instanceof fE)return this.createMultiPoint(eS.toPointArray(t));Vv.shouldNeverReachHere("Unhandled geometry type: "+r.getGeometryType())}return r}createMultiPointFromCoords(t){return this.createMultiPoint(null!==t?this.getCoordinateSequenceFactory().create(t):null)}createPoint(){if(0===arguments.length)return this.createPoint(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof Hv){const t=arguments[0];return this.createPoint(null!==t?this.getCoordinateSequenceFactory().create([t]):null)}if($v(arguments[0],Jv))return new fE(arguments[0],this)}}getCoordinateSequenceFactory(){return this._coordinateSequenceFactory}createPolygon(){if(0===arguments.length)return this.createPolygon(null,null);if(1===arguments.length){if($v(arguments[0],Jv)){const t=arguments[0];return this.createPolygon(this.createLinearRing(t))}if(arguments[0]instanceof Array){const t=arguments[0];return this.createPolygon(this.createLinearRing(t))}if(arguments[0]instanceof OE){const t=arguments[0];return this.createPolygon(t,null)}}else if(2===arguments.length)return new RE(arguments[0],arguments[1],this)}getSRID(){return this._SRID}createGeometryCollection(){return 0===arguments.length?new NE(null,this):1===arguments.length?new NE(arguments[0],this):void 0}getPrecisionModel(){return this._precisionModel}createLinearRing(){if(0===arguments.length)return this.createLinearRing(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof Array){const t=arguments[0];return this.createLinearRing(null!==t?this.getCoordinateSequenceFactory().create(t):null)}if($v(arguments[0],Jv))return new OE(arguments[0],this)}}createMultiPolygon(){return 0===arguments.length?new ZE(null,this):1===arguments.length?new ZE(arguments[0],this):void 0}createMultiPoint(){if(0===arguments.length)return new DE(null,this);if(1===arguments.length){if(arguments[0]instanceof Array)return new DE(arguments[0],this);if($v(arguments[0],Jv)){const t=arguments[0];if(null===t)return this.createMultiPoint(new Array(0).fill(null));const e=new Array(t.size()).fill(null);for(let i=0;i<t.size();i++){const n=this.getCoordinateSequenceFactory().create(1,t.getDimension(),t.getMeasures());oE.copy(t,i,n,0,1),e[i]=this.createPoint(n)}return this.createMultiPoint(e)}}}get interfaces_(){return[Uv]}}function iS(t){return[t.x,t.y]}class nS{constructor(t,e){this.geometryFactory=t||new eS,this.ol=e||"undefined"!=typeof ol&&ol}inject(t,e,i,n,r,s,o,a){this.ol={geom:{Point:t,LineString:e,LinearRing:i,Polygon:n,MultiPoint:r,MultiLineString:s,MultiPolygon:o,GeometryCollection:a}}}read(t){const e=this.ol;return t instanceof e.geom.Point?this.convertFromPoint(t):t instanceof e.geom.LineString?this.convertFromLineString(t):t instanceof e.geom.LinearRing?this.convertFromLinearRing(t):t instanceof e.geom.Polygon?this.convertFromPolygon(t):t instanceof e.geom.MultiPoint?this.convertFromMultiPoint(t):t instanceof e.geom.MultiLineString?this.convertFromMultiLineString(t):t instanceof e.geom.MultiPolygon?this.convertFromMultiPolygon(t):t instanceof e.geom.GeometryCollection?this.convertFromCollection(t):void 0}convertFromPoint(t){const e=t.getCoordinates();return this.geometryFactory.createPoint(new Hv(e[0],e[1]))}convertFromLineString(t){return this.geometryFactory.createLineString(t.getCoordinates().map((function(t){return new Hv(t[0],t[1])})))}convertFromLinearRing(t){return this.geometryFactory.createLinearRing(t.getCoordinates().map((function(t){return new Hv(t[0],t[1])})))}convertFromPolygon(t){const e=t.getLinearRings();let i=null;const n=[];for(let t=0;t<e.length;t++){const r=this.convertFromLinearRing(e[t]);0===t?i=r:n.push(r)}return this.geometryFactory.createPolygon(i,n)}convertFromMultiPoint(t){const e=t.getPoints().map((function(t){return this.convertFromPoint(t)}),this);return this.geometryFactory.createMultiPoint(e)}convertFromMultiLineString(t){const e=t.getLineStrings().map((function(t){return this.convertFromLineString(t)}),this);return this.geometryFactory.createMultiLineString(e)}convertFromMultiPolygon(t){const e=t.getPolygons().map((function(t){return this.convertFromPolygon(t)}),this);return this.geometryFactory.createMultiPolygon(e)}convertFromCollection(t){const e=t.getGeometries().map((function(t){return this.read(t)}),this);return this.geometryFactory.createGeometryCollection(e)}write(t){return"Point"===t.getGeometryType()?this.convertToPoint(t.getCoordinate()):"LineString"===t.getGeometryType()?this.convertToLineString(t):"LinearRing"===t.getGeometryType()?this.convertToLinearRing(t):"Polygon"===t.getGeometryType()?this.convertToPolygon(t):"MultiPoint"===t.getGeometryType()?this.convertToMultiPoint(t):"MultiLineString"===t.getGeometryType()?this.convertToMultiLineString(t):"MultiPolygon"===t.getGeometryType()?this.convertToMultiPolygon(t):"GeometryCollection"===t.getGeometryType()?this.convertToCollection(t):void 0}convertToPoint(t){return new this.ol.geom.Point([t.x,t.y])}convertToLineString(t){const e=t._points._coordinates.map(iS);return new this.ol.geom.LineString(e)}convertToLinearRing(t){const e=t._points._coordinates.map(iS);return new this.ol.geom.LinearRing(e)}convertToPolygon(t){const e=[t._shell._points._coordinates.map(iS)];for(let i=0;i<t._holes.length;i++)e.push(t._holes[i]._points._coordinates.map(iS));return new this.ol.geom.Polygon(e)}convertToMultiPoint(t){return new this.ol.geom.MultiPoint(t.getCoordinates().map(iS))}convertToMultiLineString(t){const e=[];for(let i=0;i<t._geometries.length;i++)e.push(this.convertToLineString(t._geometries[i]).getCoordinates());return new this.ol.geom.MultiLineString(e)}convertToMultiPolygon(t){const e=[];for(let i=0;i<t._geometries.length;i++)e.push(this.convertToPolygon(t._geometries[i]).getCoordinates());return new this.ol.geom.MultiPolygon(e)}convertToCollection(t){const e=[];for(let i=0;i<t._geometries.length;i++){const n=t._geometries[i];e.push(this.write(n))}return new this.ol.geom.GeometryCollection(e)}}class rS{static toLocationSymbol(t){switch(t){case rS.EXTERIOR:return"e";case rS.BOUNDARY:return"b";case rS.INTERIOR:return"i";case rS.NONE:return"-"}throw new Ov("Unknown location value: "+t)}}rS.INTERIOR=0,rS.BOUNDARY=1,rS.EXTERIOR=2,rS.NONE=-1;class sS{static opposite(t){return t===sS.LEFT?sS.RIGHT:t===sS.RIGHT?sS.LEFT:t}}sS.ON=0,sS.LEFT=1,sS.RIGHT=2;class oS extends Dv{}class aS extends yE{constructor(){super(),this.array=[]}add(t){return this.array.push(t),!0}get(t){if(t<0||t>=this.size())throw new _E;return this.array[t]}push(t){return this.array.push(t),t}pop(){if(0===this.array.length)throw new oS;return this.array.pop()}peek(){if(0===this.array.length)throw new oS;return this.array[this.array.length-1]}empty(){return 0===this.array.length}isEmpty(){return this.empty()}search(t){return this.array.indexOf(t)}size(){return this.array.length}toArray(){return this.array.slice()}}class lS{constructor(){lS.constructor_.apply(this,arguments)}static constructor_(){this._minIndex=-1,this._minCoord=null,this._minDe=null,this._orientedDe=null}getCoordinate(){return this._minCoord}getRightmostSide(t,e){let i=this.getRightmostSideOfSegment(t,e);return i<0&&(i=this.getRightmostSideOfSegment(t,e-1)),i<0&&(this._minCoord=null,this.checkForRightmostCoordinate(t)),i}findRightmostEdgeAtVertex(){const t=this._minDe.getEdge().getCoordinates();Vv.isTrue(this._minIndex>0&&this._minIndex<t.length,"rightmost point expected to be interior vertex of edge");const e=t[this._minIndex-1],i=t[this._minIndex+1],n=CE.index(this._minCoord,i,e);let r=!1;(e.y<this._minCoord.y&&i.y<this._minCoord.y&&n===CE.COUNTERCLOCKWISE||e.y>this._minCoord.y&&i.y>this._minCoord.y&&n===CE.CLOCKWISE)&&(r=!0),r&&(this._minIndex=this._minIndex-1)}getRightmostSideOfSegment(t,e){const i=t.getEdge().getCoordinates();if(e<0||e+1>=i.length)return-1;if(i[e].y===i[e+1].y)return-1;let n=sS.LEFT;return i[e].y<i[e+1].y&&(n=sS.RIGHT),n}getEdge(){return this._orientedDe}checkForRightmostCoordinate(t){const e=t.getEdge().getCoordinates();for(let i=0;i<e.length-1;i++)(null===this._minCoord||e[i].x>this._minCoord.x)&&(this._minDe=t,this._minIndex=i,this._minCoord=e[i])}findRightmostEdgeAtNode(){const t=this._minDe.getNode().getEdges();this._minDe=t.getRightmostEdge(),this._minDe.isForward()||(this._minDe=this._minDe.getSym(),this._minIndex=this._minDe.getEdge().getCoordinates().length-1)}findEdge(t){for(let e=t.iterator();e.hasNext();){const t=e.next();t.isForward()&&this.checkForRightmostCoordinate(t)}Vv.isTrue(0!==this._minIndex||this._minCoord.equals(this._minDe.getCoordinate()),"inconsistency in rightmost processing"),0===this._minIndex?this.findRightmostEdgeAtNode():this.findRightmostEdgeAtVertex(),this._orientedDe=this._minDe,this.getRightmostSide(this._minDe,this._minIndex)===sS.LEFT&&(this._orientedDe=this._minDe.getSym())}}class hS extends Xv{constructor(t,e){super(e?t+" [ "+e+" ]":t),this.pt=e?new Hv(e):void 0}getCoordinate(){return this.pt}}class cS{constructor(){this.array=[]}addLast(t){this.array.push(t)}removeFirst(){return this.array.shift()}isEmpty(){return 0===this.array.length}}class uS{constructor(){uS.constructor_.apply(this,arguments)}static constructor_(){this._finder=null,this._dirEdgeList=new xE,this._nodes=new xE,this._rightMostCoord=null,this._env=null,this._finder=new lS}clearVisitedEdges(){for(let t=this._dirEdgeList.iterator();t.hasNext();)t.next().setVisited(!1)}getRightmostCoordinate(){return this._rightMostCoord}computeNodeDepth(t){let e=null;for(let i=t.getEdges().iterator();i.hasNext();){const t=i.next();if(t.isVisited()||t.getSym().isVisited()){e=t;break}}if(null===e)throw new hS("unable to find edge to compute depths at "+t.getCoordinate());t.getEdges().computeDepths(e);for(let e=t.getEdges().iterator();e.hasNext();){const t=e.next();t.setVisited(!0),this.copySymDepths(t)}}computeDepth(t){this.clearVisitedEdges();const e=this._finder.getEdge();e.getNode(),e.getLabel(),e.setEdgeDepths(sS.RIGHT,t),this.copySymDepths(e),this.computeDepths(e)}create(t){this.addReachable(t),this._finder.findEdge(this._dirEdgeList),this._rightMostCoord=this._finder.getCoordinate()}findResultEdges(){for(let t=this._dirEdgeList.iterator();t.hasNext();){const e=t.next();e.getDepth(sS.RIGHT)>=1&&e.getDepth(sS.LEFT)<=0&&!e.isInteriorAreaEdge()&&e.setInResult(!0)}}computeDepths(t){const e=new KE,i=new cS,n=t.getNode();for(i.addLast(n),e.add(n),t.setVisited(!0);!i.isEmpty();){const t=i.removeFirst();e.add(t),this.computeNodeDepth(t);for(let n=t.getEdges().iterator();n.hasNext();){const t=n.next().getSym();if(t.isVisited())continue;const r=t.getNode();e.contains(r)||(i.addLast(r),e.add(r))}}}compareTo(t){const e=t;return this._rightMostCoord.x<e._rightMostCoord.x?-1:this._rightMostCoord.x>e._rightMostCoord.x?1:0}getEnvelope(){if(null===this._env){const t=new eE;for(let e=this._dirEdgeList.iterator();e.hasNext();){const i=e.next().getEdge().getCoordinates();for(let e=0;e<i.length-1;e++)t.expandToInclude(i[e])}this._env=t}return this._env}addReachable(t){const e=new aS;for(e.add(t);!e.empty();){const t=e.pop();this.add(t,e)}}copySymDepths(t){const e=t.getSym();e.setDepth(sS.LEFT,t.getDepth(sS.RIGHT)),e.setDepth(sS.RIGHT,t.getDepth(sS.LEFT))}add(t,e){t.setVisited(!0),this._nodes.add(t);for(let i=t.getEdges().iterator();i.hasNext();){const t=i.next();this._dirEdgeList.add(t);const n=t.getSym().getNode();n.isVisited()||e.push(n)}}getNodes(){return this._nodes}getDirectedEdges(){return this._dirEdgeList}get interfaces_(){return[Bv]}}class dS{static intersection(t,e,i,n){const r=t.x<e.x?t.x:e.x,s=t.y<e.y?t.y:e.y,o=t.x>e.x?t.x:e.x,a=t.y>e.y?t.y:e.y,l=i.x<n.x?i.x:n.x,h=i.y<n.y?i.y:n.y,c=i.x>n.x?i.x:n.x,u=i.y>n.y?i.y:n.y,d=((r>l?r:l)+(o<c?o:c))/2,g=((s>h?s:h)+(a<u?a:u))/2,f=t.x-d,p=t.y-g,m=e.x-d,_=e.y-g,y=i.x-d,w=i.y-g,x=n.x-d,b=n.y-g,v=p-_,E=m-f,S=f*_-m*p,I=w-b,M=x-y,C=y*b-x*w,T=v*M-I*E,R=(E*C-M*S)/T,A=(I*S-v*C)/T;return zv.isNaN(R)||zv.isInfinite(R)||zv.isNaN(A)||zv.isInfinite(A)?null:new Hv(R+d,A+g)}}class gS{static segmentToSegment(t,e,i,n){if(t.equals(e))return gS.pointToSegment(t,i,n);if(i.equals(n))return gS.pointToSegment(n,t,e);let r=!1;if(eE.intersects(t,e,i,n)){const s=(e.x-t.x)*(n.y-i.y)-(e.y-t.y)*(n.x-i.x);if(0===s)r=!0;else{const o=(t.y-i.y)*(n.x-i.x)-(t.x-i.x)*(n.y-i.y),a=((t.y-i.y)*(e.x-t.x)-(t.x-i.x)*(e.y-t.y))/s,l=o/s;(l<0||l>1||a<0||a>1)&&(r=!0)}}else r=!0;return r?UE.min(gS.pointToSegment(t,i,n),gS.pointToSegment(e,i,n),gS.pointToSegment(i,t,e),gS.pointToSegment(n,t,e)):0}static pointToSegment(t,e,i){if(e.x===i.x&&e.y===i.y)return t.distance(e);const n=(i.x-e.x)*(i.x-e.x)+(i.y-e.y)*(i.y-e.y),r=((t.x-e.x)*(i.x-e.x)+(t.y-e.y)*(i.y-e.y))/n;if(r<=0)return t.distance(e);if(r>=1)return t.distance(i);const s=((e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y))/n;return Math.abs(s)*Math.sqrt(n)}static pointToLinePerpendicular(t,e,i){const n=(i.x-e.x)*(i.x-e.x)+(i.y-e.y)*(i.y-e.y),r=((e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y))/n;return Math.abs(r)*Math.sqrt(n)}static pointToSegmentString(t,e){if(0===e.length)throw new Ov("Line array must contain at least one vertex");let i=t.distance(e[0]);for(let n=0;n<e.length-1;n++){const r=gS.pointToSegment(t,e[n],e[n+1]);r<i&&(i=r)}return i}}const fS={typeStr:/^\s*(\w+)\s*\(\s*(.*)\s*\)\s*$/,emptyTypeStr:/^\s*(\w+)\s*EMPTY\s*$/,spaces:/\s+/,parenComma:/\)\s*,\s*\(/,doubleParenComma:/\)\s*\)\s*,\s*\(\s*\(/,trimParens:/^\s*\(?(.*?)\)?\s*$/};class pS{constructor(t){this.geometryFactory=t||new eS,this.precisionModel=this.geometryFactory.getPrecisionModel()}read(t){let e,i,n;t=t.replace(/[\n\r]/g," ");let r=fS.typeStr.exec(t);if(-1!==t.search("EMPTY")&&(r=fS.emptyTypeStr.exec(t),r[2]=void 0),r&&(i=r[1].toLowerCase(),n=r[2],_S[i]&&(e=_S[i].call(this,n))),void 0===e)throw new Error("Could not parse WKT "+t);return e}write(t){return this.extractGeometry(t)}extractGeometry(t){const e=t.getGeometryType().toLowerCase();if(!mS[e])return null;const i=e.toUpperCase();let n;return n=t.isEmpty()?i+" EMPTY":i+"("+mS[e].call(this,t)+")",n}}const mS={coordinate(t){return this.precisionModel.makePrecise(t),t.x+" "+t.y},point(t){return mS.coordinate.call(this,t._coordinates._coordinates[0])},multipoint(t){const e=[];for(let i=0,n=t._geometries.length;i<n;++i)e.push("("+mS.point.call(this,t._geometries[i])+")");return e.join(",")},linestring(t){const e=[];for(let i=0,n=t._points._coordinates.length;i<n;++i)e.push(mS.coordinate.call(this,t._points._coordinates[i]));return e.join(",")},linearring(t){const e=[];for(let i=0,n=t._points._coordinates.length;i<n;++i)e.push(mS.coordinate.call(this,t._points._coordinates[i]));return e.join(",")},multilinestring(t){const e=[];for(let i=0,n=t._geometries.length;i<n;++i)e.push("("+mS.linestring.call(this,t._geometries[i])+")");return e.join(",")},polygon(t){const e=[];e.push("("+mS.linestring.call(this,t._shell)+")");for(let i=0,n=t._holes.length;i<n;++i)e.push("("+mS.linestring.call(this,t._holes[i])+")");return e.join(",")},multipolygon(t){const e=[];for(let i=0,n=t._geometries.length;i<n;++i)e.push("("+mS.polygon.call(this,t._geometries[i])+")");return e.join(",")},geometrycollection(t){const e=[];for(let i=0,n=t._geometries.length;i<n;++i)e.push(this.extractGeometry(t._geometries[i]));return e.join(",")}},_S={coord(t){const e=t.trim().split(fS.spaces),i=new Hv(Number.parseFloat(e[0]),Number.parseFloat(e[1]));return this.precisionModel.makePrecise(i),i},point(t){return void 0===t?this.geometryFactory.createPoint():this.geometryFactory.createPoint(_S.coord.call(this,t))},multipoint(t){if(void 0===t)return this.geometryFactory.createMultiPoint();let e;const i=t.trim().split(","),n=[];for(let t=0,r=i.length;t<r;++t)e=i[t].replace(fS.trimParens,"$1"),n.push(_S.point.call(this,e));return this.geometryFactory.createMultiPoint(n)},linestring(t){if(void 0===t)return this.geometryFactory.createLineString();const e=t.trim().split(","),i=[];for(let t=0,n=e.length;t<n;++t)i.push(_S.coord.call(this,e[t]));return this.geometryFactory.createLineString(i)},linearring(t){if(void 0===t)return this.geometryFactory.createLinearRing();const e=t.trim().split(","),i=[];for(let t=0,n=e.length;t<n;++t)i.push(_S.coord.call(this,e[t]));return this.geometryFactory.createLinearRing(i)},multilinestring(t){if(void 0===t)return this.geometryFactory.createMultiLineString();let e;const i=t.trim().split(fS.parenComma),n=[];for(let t=0,r=i.length;t<r;++t)e=i[t].replace(fS.trimParens,"$1"),n.push(_S.linestring.call(this,e));return this.geometryFactory.createMultiLineString(n)},polygon(t){if(void 0===t)return this.geometryFactory.createPolygon();let e,i,n;const r=t.trim().split(fS.parenComma);let s;const o=[];for(let t=0,a=r.length;t<a;++t)e=r[t].replace(fS.trimParens,"$1"),i=_S.linestring.call(this,e),n=this.geometryFactory.createLinearRing(i._points),0===t?s=n:o.push(n);return this.geometryFactory.createPolygon(s,o)},multipolygon(t){if(void 0===t)return this.geometryFactory.createMultiPolygon();let e;const i=t.trim().split(fS.doubleParenComma),n=[];for(let t=0,r=i.length;t<r;++t)e=i[t].replace(fS.trimParens,"$1"),n.push(_S.polygon.call(this,e));return this.geometryFactory.createMultiPolygon(n)},geometrycollection(t){if(void 0===t)return this.geometryFactory.createGeometryCollection();const e=(t=t.replace(/,\s*([A-Za-z])/g,"|$1")).trim().split("|"),i=[];for(let t=0,n=e.length;t<n;++t)i.push(this.read(e[t]));return this.geometryFactory.createGeometryCollection(i)}};class yS{constructor(t){this.parser=new pS(t)}write(t){return this.parser.write(t)}static toLineString(t,e){if(2!==arguments.length)throw new Error("Not implemented");return"LINESTRING ( "+t.x+" "+t.y+", "+e.x+" "+e.y+" )"}}class wS{constructor(){wS.constructor_.apply(this,arguments)}static constructor_(){this._result=null,this._inputLines=Array(2).fill().map((()=>Array(2))),this._intPt=new Array(2).fill(null),this._intLineIndex=null,this._isProper=null,this._pa=null,this._pb=null,this._precisionModel=null,this._intPt[0]=new Hv,this._intPt[1]=new Hv,this._pa=this._intPt[0],this._pb=this._intPt[1],this._result=0}static computeEdgeDistance(t,e,i){const n=Math.abs(i.x-e.x),r=Math.abs(i.y-e.y);let s=-1;if(t.equals(e))s=0;else if(t.equals(i))s=n>r?n:r;else{const i=Math.abs(t.x-e.x),o=Math.abs(t.y-e.y);s=n>r?i:o,0!==s||t.equals(e)||(s=Math.max(i,o))}return Vv.isTrue(!(0===s&&!t.equals(e)),"Bad distance calculation"),s}static nonRobustComputeEdgeDistance(t,e,i){const n=t.x-e.x,r=t.y-e.y,s=Math.sqrt(n*n+r*r);return Vv.isTrue(!(0===s&&!t.equals(e)),"Invalid distance calculation"),s}getIndexAlongSegment(t,e){return this.computeIntLineIndex(),this._intLineIndex[t][e]}getTopologySummary(){const t=new VE;return this.isEndPoint()&&t.append(" endpoint"),this._isProper&&t.append(" proper"),this.isCollinear()&&t.append(" collinear"),t.toString()}computeIntersection(t,e,i,n){this._inputLines[0][0]=t,this._inputLines[0][1]=e,this._inputLines[1][0]=i,this._inputLines[1][1]=n,this._result=this.computeIntersect(t,e,i,n)}getIntersectionNum(){return this._result}computeIntLineIndex(){if(0===arguments.length)null===this._intLineIndex&&(this._intLineIndex=Array(2).fill().map((()=>Array(2))),this.computeIntLineIndex(0),this.computeIntLineIndex(1));else if(1===arguments.length){const t=arguments[0];this.getEdgeDistance(t,0)>this.getEdgeDistance(t,1)?(this._intLineIndex[t][0]=0,this._intLineIndex[t][1]=1):(this._intLineIndex[t][0]=1,this._intLineIndex[t][1]=0)}}isProper(){return this.hasIntersection()&&this._isProper}setPrecisionModel(t){this._precisionModel=t}isInteriorIntersection(){if(0===arguments.length)return!!this.isInteriorIntersection(0)||!!this.isInteriorIntersection(1);if(1===arguments.length){const t=arguments[0];for(let e=0;e<this._result;e++)if(!this._intPt[e].equals2D(this._inputLines[t][0])&&!this._intPt[e].equals2D(this._inputLines[t][1]))return!0;return!1}}getIntersection(t){return this._intPt[t]}isEndPoint(){return this.hasIntersection()&&!this._isProper}hasIntersection(){return this._result!==wS.NO_INTERSECTION}getEdgeDistance(t,e){return wS.computeEdgeDistance(this._intPt[e],this._inputLines[t][0],this._inputLines[t][1])}isCollinear(){return this._result===wS.COLLINEAR_INTERSECTION}toString(){return yS.toLineString(this._inputLines[0][0],this._inputLines[0][1])+" - "+yS.toLineString(this._inputLines[1][0],this._inputLines[1][1])+this.getTopologySummary()}getEndpoint(t,e){return this._inputLines[t][e]}isIntersection(t){for(let e=0;e<this._result;e++)if(this._intPt[e].equals2D(t))return!0;return!1}getIntersectionAlongSegment(t,e){return this.computeIntLineIndex(),this._intPt[this._intLineIndex[t][e]]}}wS.DONT_INTERSECT=0,wS.DO_INTERSECT=1,wS.COLLINEAR=2,wS.NO_INTERSECTION=0,wS.POINT_INTERSECTION=1,wS.COLLINEAR_INTERSECTION=2;class xS extends wS{constructor(){super()}static nearestEndpoint(t,e,i,n){let r=t,s=gS.pointToSegment(t,i,n),o=gS.pointToSegment(e,i,n);return o<s&&(s=o,r=e),o=gS.pointToSegment(i,t,e),o<s&&(s=o,r=i),o=gS.pointToSegment(n,t,e),o<s&&(s=o,r=n),r}isInSegmentEnvelopes(t){const e=new eE(this._inputLines[0][0],this._inputLines[0][1]),i=new eE(this._inputLines[1][0],this._inputLines[1][1]);return e.contains(t)&&i.contains(t)}computeIntersection(){if(3!==arguments.length)return super.computeIntersection.apply(this,arguments);{const t=arguments[0],e=arguments[1],i=arguments[2];if(this._isProper=!1,eE.intersects(e,i,t)&&0===CE.index(e,i,t)&&0===CE.index(i,e,t))return this._isProper=!0,(t.equals(e)||t.equals(i))&&(this._isProper=!1),this._result=wS.POINT_INTERSECTION,null;this._result=wS.NO_INTERSECTION}}intersection(t,e,i,n){let r=this.intersectionSafe(t,e,i,n);return this.isInSegmentEnvelopes(r)||(r=new Hv(xS.nearestEndpoint(t,e,i,n))),null!==this._precisionModel&&this._precisionModel.makePrecise(r),r}checkDD(t,e,i,n,r){const s=ME.intersection(t,e,i,n),o=this.isInSegmentEnvelopes(s);XE.out.println("DD in env = "+o+"  --------------------- "+s),r.distance(s)>1e-4&&XE.out.println("Distance = "+r.distance(s))}intersectionSafe(t,e,i,n){let r=dS.intersection(t,e,i,n);return null===r&&(r=xS.nearestEndpoint(t,e,i,n)),r}computeCollinearIntersection(t,e,i,n){const r=eE.intersects(t,e,i),s=eE.intersects(t,e,n),o=eE.intersects(i,n,t),a=eE.intersects(i,n,e);return r&&s?(this._intPt[0]=i,this._intPt[1]=n,wS.COLLINEAR_INTERSECTION):o&&a?(this._intPt[0]=t,this._intPt[1]=e,wS.COLLINEAR_INTERSECTION):r&&o?(this._intPt[0]=i,this._intPt[1]=t,!i.equals(t)||s||a?wS.COLLINEAR_INTERSECTION:wS.POINT_INTERSECTION):r&&a?(this._intPt[0]=i,this._intPt[1]=e,!i.equals(e)||s||o?wS.COLLINEAR_INTERSECTION:wS.POINT_INTERSECTION):s&&o?(this._intPt[0]=n,this._intPt[1]=t,!n.equals(t)||r||a?wS.COLLINEAR_INTERSECTION:wS.POINT_INTERSECTION):s&&a?(this._intPt[0]=n,this._intPt[1]=e,!n.equals(e)||r||o?wS.COLLINEAR_INTERSECTION:wS.POINT_INTERSECTION):wS.NO_INTERSECTION}computeIntersect(t,e,i,n){if(this._isProper=!1,!eE.intersects(t,e,i,n))return wS.NO_INTERSECTION;const r=CE.index(t,e,i),s=CE.index(t,e,n);if(r>0&&s>0||r<0&&s<0)return wS.NO_INTERSECTION;const o=CE.index(i,n,t),a=CE.index(i,n,e);return o>0&&a>0||o<0&&a<0?wS.NO_INTERSECTION:0===r&&0===s&&0===o&&0===a?this.computeCollinearIntersection(t,e,i,n):(0===r||0===s||0===o||0===a?(this._isProper=!1,t.equals2D(i)||t.equals2D(n)?this._intPt[0]=t:e.equals2D(i)||e.equals2D(n)?this._intPt[0]=e:0===r?this._intPt[0]=new Hv(i):0===s?this._intPt[0]=new Hv(n):0===o?this._intPt[0]=new Hv(t):0===a&&(this._intPt[0]=new Hv(e))):(this._isProper=!0,this._intPt[0]=this.intersection(t,e,i,n)),wS.POINT_INTERSECTION)}}class bS{constructor(){bS.constructor_.apply(this,arguments)}static constructor_(){this._p=null,this._crossingCount=0,this._isPointOnSegment=!1;const t=arguments[0];this._p=t}static locatePointInRing(){if(arguments[0]instanceof Hv&&$v(arguments[1],Jv)){const t=arguments[1],e=new bS(arguments[0]),i=new Hv,n=new Hv;for(let r=1;r<t.size();r++)if(t.getCoordinate(r,i),t.getCoordinate(r-1,n),e.countSegment(i,n),e.isOnSegment())return e.getLocation();return e.getLocation()}if(arguments[0]instanceof Hv&&arguments[1]instanceof Array){const t=arguments[1],e=new bS(arguments[0]);for(let i=1;i<t.length;i++){const n=t[i],r=t[i-1];if(e.countSegment(n,r),e.isOnSegment())return e.getLocation()}return e.getLocation()}}countSegment(t,e){if(t.x<this._p.x&&e.x<this._p.x)return null;if(this._p.x===e.x&&this._p.y===e.y)return this._isPointOnSegment=!0,null;if(t.y===this._p.y&&e.y===this._p.y){let i=t.x,n=e.x;return i>n&&(i=e.x,n=t.x),this._p.x>=i&&this._p.x<=n&&(this._isPointOnSegment=!0),null}if(t.y>this._p.y&&e.y<=this._p.y||e.y>this._p.y&&t.y<=this._p.y){let i=CE.index(t,e,this._p);if(i===CE.COLLINEAR)return this._isPointOnSegment=!0,null;e.y<t.y&&(i=-i),i===CE.LEFT&&this._crossingCount++}}isPointInPolygon(){return this.getLocation()!==rS.EXTERIOR}getLocation(){return this._isPointOnSegment?rS.BOUNDARY:this._crossingCount%2==1?rS.INTERIOR:rS.EXTERIOR}isOnSegment(){return this._isPointOnSegment}}class vS{static isOnLine(){if(arguments[0]instanceof Hv&&$v(arguments[1],Jv)){const t=arguments[0],e=arguments[1],i=new xS,n=new Hv,r=new Hv,s=e.size();for(let o=1;o<s;o++)if(e.getCoordinate(o-1,n),e.getCoordinate(o,r),i.computeIntersection(t,n,r),i.hasIntersection())return!0;return!1}if(arguments[0]instanceof Hv&&arguments[1]instanceof Array){const t=arguments[0],e=arguments[1],i=new xS;for(let n=1;n<e.length;n++){const r=e[n-1],s=e[n];if(i.computeIntersection(t,r,s),i.hasIntersection())return!0}return!1}}static locateInRing(t,e){return bS.locatePointInRing(t,e)}static isInRing(t,e){return vS.locateInRing(t,e)!==rS.EXTERIOR}}class ES{constructor(){ES.constructor_.apply(this,arguments)}static constructor_(){if(this.location=null,1===arguments.length){if(arguments[0]instanceof Array){const t=arguments[0];this.init(t.length)}else if(Number.isInteger(arguments[0])){const t=arguments[0];this.init(1),this.location[sS.ON]=t}else if(arguments[0]instanceof ES){const t=arguments[0];if(this.init(t.location.length),null!==t)for(let e=0;e<this.location.length;e++)this.location[e]=t.location[e]}}else if(3===arguments.length){const t=arguments[0],e=arguments[1],i=arguments[2];this.init(3),this.location[sS.ON]=t,this.location[sS.LEFT]=e,this.location[sS.RIGHT]=i}}setAllLocations(t){for(let e=0;e<this.location.length;e++)this.location[e]=t}isNull(){for(let t=0;t<this.location.length;t++)if(this.location[t]!==rS.NONE)return!1;return!0}setAllLocationsIfNull(t){for(let e=0;e<this.location.length;e++)this.location[e]===rS.NONE&&(this.location[e]=t)}isLine(){return 1===this.location.length}merge(t){if(t.location.length>this.location.length){const t=new Array(3).fill(null);t[sS.ON]=this.location[sS.ON],t[sS.LEFT]=rS.NONE,t[sS.RIGHT]=rS.NONE,this.location=t}for(let e=0;e<this.location.length;e++)this.location[e]===rS.NONE&&e<t.location.length&&(this.location[e]=t.location[e])}getLocations(){return this.location}flip(){if(this.location.length<=1)return null;const t=this.location[sS.LEFT];this.location[sS.LEFT]=this.location[sS.RIGHT],this.location[sS.RIGHT]=t}toString(){const t=new EE;return this.location.length>1&&t.append(rS.toLocationSymbol(this.location[sS.LEFT])),t.append(rS.toLocationSymbol(this.location[sS.ON])),this.location.length>1&&t.append(rS.toLocationSymbol(this.location[sS.RIGHT])),t.toString()}setLocations(t,e,i){this.location[sS.ON]=t,this.location[sS.LEFT]=e,this.location[sS.RIGHT]=i}get(t){return t<this.location.length?this.location[t]:rS.NONE}isArea(){return this.location.length>1}isAnyNull(){for(let t=0;t<this.location.length;t++)if(this.location[t]===rS.NONE)return!0;return!1}setLocation(){if(1===arguments.length){const t=arguments[0];this.setLocation(sS.ON,t)}else if(2===arguments.length){const t=arguments[0],e=arguments[1];this.location[t]=e}}init(t){this.location=new Array(t).fill(null),this.setAllLocations(rS.NONE)}isEqualOnSide(t,e){return this.location[e]===t.location[e]}allPositionsEqual(t){for(let e=0;e<this.location.length;e++)if(this.location[e]!==t)return!1;return!0}}class SS{constructor(){SS.constructor_.apply(this,arguments)}static constructor_(){if(this.elt=new Array(2).fill(null),1===arguments.length){if(Number.isInteger(arguments[0])){const t=arguments[0];this.elt[0]=new ES(t),this.elt[1]=new ES(t)}else if(arguments[0]instanceof SS){const t=arguments[0];this.elt[0]=new ES(t.elt[0]),this.elt[1]=new ES(t.elt[1])}}else if(2===arguments.length){const t=arguments[0],e=arguments[1];this.elt[0]=new ES(rS.NONE),this.elt[1]=new ES(rS.NONE),this.elt[t].setLocation(e)}else if(3===arguments.length){const t=arguments[0],e=arguments[1],i=arguments[2];this.elt[0]=new ES(t,e,i),this.elt[1]=new ES(t,e,i)}else if(4===arguments.length){const t=arguments[0],e=arguments[1],i=arguments[2],n=arguments[3];this.elt[0]=new ES(rS.NONE,rS.NONE,rS.NONE),this.elt[1]=new ES(rS.NONE,rS.NONE,rS.NONE),this.elt[t].setLocations(e,i,n)}}static toLineLabel(t){const e=new SS(rS.NONE);for(let i=0;i<2;i++)e.setLocation(i,t.getLocation(i));return e}getGeometryCount(){let t=0;return this.elt[0].isNull()||t++,this.elt[1].isNull()||t++,t}setAllLocations(t,e){this.elt[t].setAllLocations(e)}isNull(t){return this.elt[t].isNull()}setAllLocationsIfNull(){if(1===arguments.length){const t=arguments[0];this.setAllLocationsIfNull(0,t),this.setAllLocationsIfNull(1,t)}else if(2===arguments.length){const t=arguments[0],e=arguments[1];this.elt[t].setAllLocationsIfNull(e)}}isLine(t){return this.elt[t].isLine()}merge(t){for(let e=0;e<2;e++)null===this.elt[e]&&null!==t.elt[e]?this.elt[e]=new ES(t.elt[e]):this.elt[e].merge(t.elt[e])}flip(){this.elt[0].flip(),this.elt[1].flip()}getLocation(){if(1===arguments.length){const t=arguments[0];return this.elt[t].get(sS.ON)}if(2===arguments.length){const t=arguments[0],e=arguments[1];return this.elt[t].get(e)}}toString(){const t=new EE;return null!==this.elt[0]&&(t.append("A:"),t.append(this.elt[0].toString())),null!==this.elt[1]&&(t.append(" B:"),t.append(this.elt[1].toString())),t.toString()}isArea(){if(0===arguments.length)return this.elt[0].isArea()||this.elt[1].isArea();if(1===arguments.length){const t=arguments[0];return this.elt[t].isArea()}}isAnyNull(t){return this.elt[t].isAnyNull()}setLocation(){if(2===arguments.length){const t=arguments[0],e=arguments[1];this.elt[t].setLocation(sS.ON,e)}else if(3===arguments.length){const t=arguments[0],e=arguments[1],i=arguments[2];this.elt[t].setLocation(e,i)}}isEqualOnSide(t,e){return this.elt[0].isEqualOnSide(t.elt[0],e)&&this.elt[1].isEqualOnSide(t.elt[1],e)}allPositionsEqual(t,e){return this.elt[t].allPositionsEqual(e)}toLine(t){this.elt[t].isArea()&&(this.elt[t]=new ES(this.elt[t].location[0]))}}class IS{constructor(){IS.constructor_.apply(this,arguments)}static constructor_(){if(this._startDe=null,this._maxNodeDegree=-1,this._edges=new xE,this._pts=new xE,this._label=new SS(rS.NONE),this._ring=null,this._isHole=null,this._shell=null,this._holes=new xE,this._geometryFactory=null,0===arguments.length);else if(2===arguments.length){const t=arguments[0],e=arguments[1];this._geometryFactory=e,this.computePoints(t),this.computeRing()}}computeRing(){if(null!==this._ring)return null;const t=new Array(this._pts.size()).fill(null);for(let e=0;e<this._pts.size();e++)t[e]=this._pts.get(e);this._ring=this._geometryFactory.createLinearRing(t),this._isHole=CE.isCCW(this._ring.getCoordinates())}isIsolated(){return 1===this._label.getGeometryCount()}computePoints(t){this._startDe=t;let e=t,i=!0;do{if(null===e)throw new hS("Found null DirectedEdge");if(e.getEdgeRing()===this)throw new hS("Directed Edge visited twice during ring-building at "+e.getCoordinate());this._edges.add(e);const t=e.getLabel();Vv.isTrue(t.isArea()),this.mergeLabel(t),this.addPoints(e.getEdge(),e.isForward(),i),i=!1,this.setEdgeRing(e,this),e=this.getNext(e)}while(e!==this._startDe)}getLinearRing(){return this._ring}getCoordinate(t){return this._pts.get(t)}computeMaxNodeDegree(){this._maxNodeDegree=0;let t=this._startDe;do{const e=t.getNode().getEdges().getOutgoingDegree(this);e>this._maxNodeDegree&&(this._maxNodeDegree=e),t=this.getNext(t)}while(t!==this._startDe);this._maxNodeDegree*=2}addPoints(t,e,i){const n=t.getCoordinates();if(e){let t=1;i&&(t=0);for(let e=t;e<n.length;e++)this._pts.add(n[e])}else{let t=n.length-2;i&&(t=n.length-1);for(let e=t;e>=0;e--)this._pts.add(n[e])}}isHole(){return this._isHole}setInResult(){let t=this._startDe;do{t.getEdge().setInResult(!0),t=t.getNext()}while(t!==this._startDe)}containsPoint(t){const e=this.getLinearRing();if(!e.getEnvelopeInternal().contains(t))return!1;if(!vS.isInRing(t,e.getCoordinates()))return!1;for(let e=this._holes.iterator();e.hasNext();)if(e.next().containsPoint(t))return!1;return!0}addHole(t){this._holes.add(t)}isShell(){return null===this._shell}getLabel(){return this._label}getEdges(){return this._edges}getMaxNodeDegree(){return this._maxNodeDegree<0&&this.computeMaxNodeDegree(),this._maxNodeDegree}getShell(){return this._shell}mergeLabel(){if(1===arguments.length){const t=arguments[0];this.mergeLabel(t,0),this.mergeLabel(t,1)}else if(2===arguments.length){const t=arguments[1],e=arguments[0].getLocation(t,sS.RIGHT);if(e===rS.NONE)return null;if(this._label.getLocation(t)===rS.NONE)return this._label.setLocation(t,e),null}}setShell(t){this._shell=t,null!==t&&t.addHole(this)}toPolygon(t){const e=new Array(this._holes.size()).fill(null);for(let t=0;t<this._holes.size();t++)e[t]=this._holes.get(t).getLinearRing();return t.createPolygon(this.getLinearRing(),e)}}class MS extends IS{constructor(){super(),MS.constructor_.apply(this,arguments)}static constructor_(){const t=arguments[0],e=arguments[1];IS.constructor_.call(this,t,e)}setEdgeRing(t,e){t.setMinEdgeRing(e)}getNext(t){return t.getNextMin()}}class CS extends IS{constructor(){super(),CS.constructor_.apply(this,arguments)}static constructor_(){const t=arguments[0],e=arguments[1];IS.constructor_.call(this,t,e)}buildMinimalRings(){const t=new xE;let e=this._startDe;do{if(null===e.getMinEdgeRing()){const i=new MS(e,this._geometryFactory);t.add(i)}e=e.getNext()}while(e!==this._startDe);return t}setEdgeRing(t,e){t.setEdgeRing(e)}linkDirectedEdgesForMinimalEdgeRings(){let t=this._startDe;do{t.getNode().getEdges().linkMinimalDirectedEdges(this),t=t.getNext()}while(t!==this._startDe)}getNext(t){return t.getNext()}}class TS{constructor(){TS.constructor_.apply(this,arguments)}static constructor_(){if(this._label=null,this._isInResult=!1,this._isCovered=!1,this._isCoveredSet=!1,this._isVisited=!1,0===arguments.length);else if(1===arguments.length){const t=arguments[0];this._label=t}}setVisited(t){this._isVisited=t}setInResult(t){this._isInResult=t}isCovered(){return this._isCovered}isCoveredSet(){return this._isCoveredSet}setLabel(t){this._label=t}getLabel(){return this._label}setCovered(t){this._isCovered=t,this._isCoveredSet=!0}updateIM(t){Vv.isTrue(this._label.getGeometryCount()>=2,"found partial label"),this.computeIM(t)}isInResult(){return this._isInResult}isVisited(){return this._isVisited}}class RS extends TS{constructor(){super(),RS.constructor_.apply(this,arguments)}static constructor_(){this._coord=null,this._edges=null;const t=arguments[0],e=arguments[1];this._coord=t,this._edges=e,this._label=new SS(0,rS.NONE)}isIncidentEdgeInResult(){for(let t=this.getEdges().getEdges().iterator();t.hasNext();)if(t.next().getEdge().isInResult())return!0;return!1}isIsolated(){return 1===this._label.getGeometryCount()}getCoordinate(){return this._coord}print(t){t.println("node "+this._coord+" lbl: "+this._label)}computeIM(t){}computeMergedLocation(t,e){let i=rS.NONE;if(i=this._label.getLocation(e),!t.isNull(e)){const n=t.getLocation(e);i!==rS.BOUNDARY&&(i=n)}return i}setLabel(){if(2!==arguments.length||!Number.isInteger(arguments[1])||!Number.isInteger(arguments[0]))return super.setLabel.apply(this,arguments);{const t=arguments[0],e=arguments[1];null===this._label?this._label=new SS(t,e):this._label.setLocation(t,e)}}getEdges(){return this._edges}mergeLabel(){if(arguments[0]instanceof RS){const t=arguments[0];this.mergeLabel(t._label)}else if(arguments[0]instanceof SS){const t=arguments[0];for(let e=0;e<2;e++){const i=this.computeMergedLocation(t,e);this._label.getLocation(e)===rS.NONE&&this._label.setLocation(e,i)}}}add(t){this._edges.insert(t),t.setNode(this)}setLabelBoundary(t){if(null===this._label)return null;let e=rS.NONE;null!==this._label&&(e=this._label.getLocation(t));let i=null;switch(e){case rS.BOUNDARY:i=rS.INTERIOR;break;case rS.INTERIOR:default:i=rS.BOUNDARY}this._label.setLocation(t,i)}}class AS extends HE{}function kS(t){return null==t?0:t.color}function PS(t){return null==t?null:t.parent}function LS(t,e){null!==t&&(t.color=e)}function NS(t){return null==t?null:t.left}function DS(t){return null==t?null:t.right}class OS extends AS{constructor(){super(),this.root_=null,this.size_=0}get(t){let e=this.root_;for(;null!==e;){const i=t.compareTo(e.key);if(i<0)e=e.left;else{if(!(i>0))return e.value;e=e.right}}return null}put(t,e){if(null===this.root_)return this.root_={key:t,value:e,left:null,right:null,parent:null,color:0,getValue(){return this.value},getKey(){return this.key}},this.size_=1,null;let i,n,r=this.root_;do{if(i=r,n=t.compareTo(r.key),n<0)r=r.left;else{if(!(n>0)){const t=r.value;return r.value=e,t}r=r.right}}while(null!==r);const s={key:t,left:null,right:null,value:e,parent:i,color:0,getValue(){return this.value},getKey(){return this.key}};return n<0?i.left=s:i.right=s,this.fixAfterInsertion(s),this.size_++,null}fixAfterInsertion(t){let e;for(t.color=1;null!=t&&t!==this.root_&&1===t.parent.color;)PS(t)===NS(PS(PS(t)))?(e=DS(PS(PS(t))),1===kS(e)?(LS(PS(t),0),LS(e,0),LS(PS(PS(t)),1),t=PS(PS(t))):(t===DS(PS(t))&&(t=PS(t),this.rotateLeft(t)),LS(PS(t),0),LS(PS(PS(t)),1),this.rotateRight(PS(PS(t))))):(e=NS(PS(PS(t))),1===kS(e)?(LS(PS(t),0),LS(e,0),LS(PS(PS(t)),1),t=PS(PS(t))):(t===NS(PS(t))&&(t=PS(t),this.rotateRight(t)),LS(PS(t),0),LS(PS(PS(t)),1),this.rotateLeft(PS(PS(t)))));this.root_.color=0}values(){const t=new xE;let e=this.getFirstEntry();if(null!==e)for(t.add(e.value);null!==(e=OS.successor(e));)t.add(e.value);return t}entrySet(){const t=new KE;let e=this.getFirstEntry();if(null!==e)for(t.add(e);null!==(e=OS.successor(e));)t.add(e);return t}rotateLeft(t){if(null!=t){const e=t.right;t.right=e.left,null!=e.left&&(e.left.parent=t),e.parent=t.parent,null==t.parent?this.root_=e:t.parent.left===t?t.parent.left=e:t.parent.right=e,e.left=t,t.parent=e}}rotateRight(t){if(null!=t){const e=t.left;t.left=e.right,null!=e.right&&(e.right.parent=t),e.parent=t.parent,null==t.parent?this.root_=e:t.parent.right===t?t.parent.right=e:t.parent.left=e,e.right=t,t.parent=e}}getFirstEntry(){let t=this.root_;if(null!=t)for(;null!=t.left;)t=t.left;return t}static successor(t){let e;if(null===t)return null;if(null!==t.right){for(e=t.right;null!==e.left;)e=e.left;return e}{e=t.parent;let i=t;for(;null!==e&&i===e.right;)i=e,e=e.parent;return e}}size(){return this.size_}containsKey(t){let e=this.root_;for(;null!==e;){const i=t.compareTo(e.key);if(i<0)e=e.left;else{if(!(i>0))return!0;e=e.right}}return!1}}class FS{constructor(){FS.constructor_.apply(this,arguments)}static constructor_(){this.nodeMap=new OS,this.nodeFact=null;const t=arguments[0];this.nodeFact=t}find(t){return this.nodeMap.get(t)}addNode(){if(arguments[0]instanceof Hv){const t=arguments[0];let e=this.nodeMap.get(t);return null===e&&(e=this.nodeFact.createNode(t),this.nodeMap.put(t,e)),e}if(arguments[0]instanceof RS){const t=arguments[0],e=this.nodeMap.get(t.getCoordinate());return null===e?(this.nodeMap.put(t.getCoordinate(),t),t):(e.mergeLabel(t),e)}}print(t){for(let e=this.iterator();e.hasNext();)e.next().print(t)}iterator(){return this.nodeMap.values().iterator()}values(){return this.nodeMap.values()}getBoundaryNodes(t){const e=new xE;for(let i=this.iterator();i.hasNext();){const n=i.next();n.getLabel().getLocation(t)===rS.BOUNDARY&&e.add(n)}return e}add(t){const e=t.getCoordinate();this.addNode(e).add(t)}}class zS{static isNorthern(t){return t===zS.NE||t===zS.NW}static isOpposite(t,e){return t!==e&&2==(t-e+4)%4}static commonHalfPlane(t,e){if(t===e)return t;if(2==(t-e+4)%4)return-1;const i=t<e?t:e;return 0===i&&3===(t>e?t:e)?3:i}static isInHalfPlane(t,e){return e===zS.SE?t===zS.SE||t===zS.SW:t===e||t===e+1}static quadrant(){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){const t=arguments[0],e=arguments[1];if(0===t&&0===e)throw new Ov("Cannot compute the quadrant for point ( "+t+", "+e+" )");return t>=0?e>=0?zS.NE:zS.SE:e>=0?zS.NW:zS.SW}if(arguments[0]instanceof Hv&&arguments[1]instanceof Hv){const t=arguments[0],e=arguments[1];if(e.x===t.x&&e.y===t.y)throw new Ov("Cannot compute the quadrant for two identical points "+t);return e.x>=t.x?e.y>=t.y?zS.NE:zS.SE:e.y>=t.y?zS.NW:zS.SW}}}zS.NE=0,zS.NW=1,zS.SW=2,zS.SE=3;class BS{constructor(){BS.constructor_.apply(this,arguments)}static constructor_(){if(this._edge=null,this._label=null,this._node=null,this._p0=null,this._p1=null,this._dx=null,this._dy=null,this._quadrant=null,1===arguments.length){const t=arguments[0];this._edge=t}else if(3===arguments.length){const t=arguments[0],e=arguments[1],i=arguments[2];BS.constructor_.call(this,t,e,i,null)}else if(4===arguments.length){const t=arguments[0],e=arguments[1],i=arguments[2],n=arguments[3];BS.constructor_.call(this,t),this.init(e,i),this._label=n}}compareDirection(t){return this._dx===t._dx&&this._dy===t._dy?0:this._quadrant>t._quadrant?1:this._quadrant<t._quadrant?-1:CE.index(t._p0,t._p1,this._p1)}getDy(){return this._dy}getCoordinate(){return this._p0}setNode(t){this._node=t}print(t){const e=Math.atan2(this._dy,this._dx),i=this.getClass().getName(),n=i.lastIndexOf("."),r=i.substring(n+1);t.print("  "+r+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+e+"   "+this._label)}compareTo(t){const e=t;return this.compareDirection(e)}getDirectedCoordinate(){return this._p1}getDx(){return this._dx}getLabel(){return this._label}getEdge(){return this._edge}getQuadrant(){return this._quadrant}getNode(){return this._node}toString(){const t=Math.atan2(this._dy,this._dx),e=this.getClass().getName(),i=e.lastIndexOf(".");return"  "+e.substring(i+1)+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+t+"   "+this._label}computeLabel(t){}init(t,e){this._p0=t,this._p1=e,this._dx=e.x-t.x,this._dy=e.y-t.y,this._quadrant=zS.quadrant(this._dx,this._dy),Vv.isTrue(!(0===this._dx&&0===this._dy),"EdgeEnd with identical endpoints found")}get interfaces_(){return[Bv]}}class GS extends BS{constructor(){super(),GS.constructor_.apply(this,arguments)}static constructor_(){this._isForward=null,this._isInResult=!1,this._isVisited=!1,this._sym=null,this._next=null,this._nextMin=null,this._edgeRing=null,this._minEdgeRing=null,this._depth=[0,-999,-999];const t=arguments[0],e=arguments[1];if(BS.constructor_.call(this,t),this._isForward=e,e)this.init(t.getCoordinate(0),t.getCoordinate(1));else{const e=t.getNumPoints()-1;this.init(t.getCoordinate(e),t.getCoordinate(e-1))}this.computeDirectedLabel()}static depthFactor(t,e){return t===rS.EXTERIOR&&e===rS.INTERIOR?1:t===rS.INTERIOR&&e===rS.EXTERIOR?-1:0}getNextMin(){return this._nextMin}getDepth(t){return this._depth[t]}setVisited(t){this._isVisited=t}computeDirectedLabel(){this._label=new SS(this._edge.getLabel()),this._isForward||this._label.flip()}getNext(){return this._next}setDepth(t,e){if(-999!==this._depth[t]&&this._depth[t]!==e)throw new hS("assigned depths do not match",this.getCoordinate());this._depth[t]=e}isInteriorAreaEdge(){let t=!0;for(let e=0;e<2;e++)this._label.isArea(e)&&this._label.getLocation(e,sS.LEFT)===rS.INTERIOR&&this._label.getLocation(e,sS.RIGHT)===rS.INTERIOR||(t=!1);return t}setNextMin(t){this._nextMin=t}print(t){super.print.call(this,t),t.print(" "+this._depth[sS.LEFT]+"/"+this._depth[sS.RIGHT]),t.print(" ("+this.getDepthDelta()+")"),this._isInResult&&t.print(" inResult")}setMinEdgeRing(t){this._minEdgeRing=t}isLineEdge(){const t=this._label.isLine(0)||this._label.isLine(1),e=!this._label.isArea(0)||this._label.allPositionsEqual(0,rS.EXTERIOR),i=!this._label.isArea(1)||this._label.allPositionsEqual(1,rS.EXTERIOR);return t&&e&&i}setEdgeRing(t){this._edgeRing=t}getMinEdgeRing(){return this._minEdgeRing}getDepthDelta(){let t=this._edge.getDepthDelta();return this._isForward||(t=-t),t}setInResult(t){this._isInResult=t}getSym(){return this._sym}isForward(){return this._isForward}getEdge(){return this._edge}printEdge(t){this.print(t),t.print(" "),this._isForward?this._edge.print(t):this._edge.printReverse(t)}setSym(t){this._sym=t}setVisitedEdge(t){this.setVisited(t),this._sym.setVisited(t)}setEdgeDepths(t,e){let i=this.getEdge().getDepthDelta();this._isForward||(i=-i);let n=1;t===sS.LEFT&&(n=-1);const r=sS.opposite(t),s=e+i*n;this.setDepth(t,e),this.setDepth(r,s)}getEdgeRing(){return this._edgeRing}isInResult(){return this._isInResult}setNext(t){this._next=t}isVisited(){return this._isVisited}}class YS{createNode(t){return new RS(t,null)}}class US{constructor(){US.constructor_.apply(this,arguments)}static constructor_(){if(this._edges=new xE,this._nodes=null,this._edgeEndList=new xE,0===arguments.length)this._nodes=new FS(new YS);else if(1===arguments.length){const t=arguments[0];this._nodes=new FS(t)}}static linkResultDirectedEdges(t){for(let e=t.iterator();e.hasNext();)e.next().getEdges().linkResultDirectedEdges()}printEdges(t){t.println("Edges:");for(let e=0;e<this._edges.size();e++){t.println("edge "+e+":");const i=this._edges.get(e);i.print(t),i.eiList.print(t)}}find(t){return this._nodes.find(t)}addNode(){if(arguments[0]instanceof RS){const t=arguments[0];return this._nodes.addNode(t)}if(arguments[0]instanceof Hv){const t=arguments[0];return this._nodes.addNode(t)}}getNodeIterator(){return this._nodes.iterator()}linkResultDirectedEdges(){for(let t=this._nodes.iterator();t.hasNext();)t.next().getEdges().linkResultDirectedEdges()}debugPrintln(t){XE.out.println(t)}isBoundaryNode(t,e){const i=this._nodes.find(e);if(null===i)return!1;const n=i.getLabel();return null!==n&&n.getLocation(t)===rS.BOUNDARY}linkAllDirectedEdges(){for(let t=this._nodes.iterator();t.hasNext();)t.next().getEdges().linkAllDirectedEdges()}matchInSameDirection(t,e,i,n){return!!t.equals(i)&&CE.index(t,e,n)===CE.COLLINEAR&&zS.quadrant(t,e)===zS.quadrant(i,n)}getEdgeEnds(){return this._edgeEndList}debugPrint(t){XE.out.print(t)}getEdgeIterator(){return this._edges.iterator()}findEdgeInSameDirection(t,e){for(let i=0;i<this._edges.size();i++){const n=this._edges.get(i),r=n.getCoordinates();if(this.matchInSameDirection(t,e,r[0],r[1]))return n;if(this.matchInSameDirection(t,e,r[r.length-1],r[r.length-2]))return n}return null}insertEdge(t){this._edges.add(t)}findEdgeEnd(t){for(let e=this.getEdgeEnds().iterator();e.hasNext();){const i=e.next();if(i.getEdge()===t)return i}return null}addEdges(t){for(let e=t.iterator();e.hasNext();){const t=e.next();this._edges.add(t);const i=new GS(t,!0),n=new GS(t,!1);i.setSym(n),n.setSym(i),this.add(i),this.add(n)}}add(t){this._nodes.add(t),this._edgeEndList.add(t)}getNodes(){return this._nodes.values()}findEdge(t,e){for(let i=0;i<this._edges.size();i++){const n=this._edges.get(i),r=n.getCoordinates();if(t.equals(r[0])&&e.equals(r[1]))return n}return null}}class XS{constructor(){XS.constructor_.apply(this,arguments)}static constructor_(){this._geometryFactory=null,this._shellList=new xE;const t=arguments[0];this._geometryFactory=t}static findEdgeRingContaining(t,e){const i=t.getLinearRing(),n=i.getEnvelopeInternal();let r=i.getCoordinateN(0),s=null,o=null;for(let t=e.iterator();t.hasNext();){const e=t.next(),a=e.getLinearRing(),l=a.getEnvelopeInternal();if(l.equals(n))continue;if(!l.contains(n))continue;r=qE.ptNotInList(i.getCoordinates(),a.getCoordinates());let h=!1;vS.isInRing(r,a.getCoordinates())&&(h=!0),h&&(null===s||o.contains(l))&&(s=e,o=s.getLinearRing().getEnvelopeInternal())}return s}sortShellsAndHoles(t,e,i){for(let n=t.iterator();n.hasNext();){const t=n.next();t.isHole()?i.add(t):e.add(t)}}computePolygons(t){const e=new xE;for(let i=t.iterator();i.hasNext();){const t=i.next().toPolygon(this._geometryFactory);e.add(t)}return e}placeFreeHoles(t,e){for(let i=e.iterator();i.hasNext();){const e=i.next();if(null===e.getShell()){const i=XS.findEdgeRingContaining(e,t);if(null===i)throw new hS("unable to assign hole to a shell",e.getCoordinate(0));e.setShell(i)}}}buildMinimalEdgeRings(t,e,i){const n=new xE;for(let r=t.iterator();r.hasNext();){const t=r.next();if(t.getMaxNodeDegree()>2){t.linkDirectedEdgesForMinimalEdgeRings();const n=t.buildMinimalRings(),r=this.findShell(n);null!==r?(this.placePolygonHoles(r,n),e.add(r)):i.addAll(n)}else n.add(t)}return n}buildMaximalEdgeRings(t){const e=new xE;for(let i=t.iterator();i.hasNext();){const t=i.next();if(t.isInResult()&&t.getLabel().isArea()&&null===t.getEdgeRing()){const i=new CS(t,this._geometryFactory);e.add(i),i.setInResult()}}return e}placePolygonHoles(t,e){for(let i=e.iterator();i.hasNext();){const e=i.next();e.isHole()&&e.setShell(t)}}getPolygons(){return this.computePolygons(this._shellList)}findShell(t){let e=0,i=null;for(let n=t.iterator();n.hasNext();){const t=n.next();t.isHole()||(i=t,e++)}return Vv.isTrue(e<=1,"found two shells in MinimalEdgeRing list"),i}add(){if(1===arguments.length){const t=arguments[0];this.add(t.getEdgeEnds(),t.getNodes())}else if(2===arguments.length){const t=arguments[0],e=arguments[1];US.linkResultDirectedEdges(e);const i=this.buildMaximalEdgeRings(t),n=new xE,r=this.buildMinimalEdgeRings(i,this._shellList,n);this.sortShellsAndHoles(r,this._shellList,n),this.placeFreeHoles(this._shellList,n)}}}class qS{getBounds(){}}class VS{constructor(){VS.constructor_.apply(this,arguments)}static constructor_(){this._bounds=null,this._item=null;const t=arguments[0],e=arguments[1];this._bounds=t,this._item=e}getItem(){return this._item}getBounds(){return this._bounds}get interfaces_(){return[qS,Uv]}}class jS{constructor(){jS.constructor_.apply(this,arguments)}static constructor_(){this._size=null,this._items=null,this._size=0,this._items=new xE,this._items.add(null)}poll(){if(this.isEmpty())return null;const t=this._items.get(1);return this._items.set(1,this._items.get(this._size)),this._size-=1,this.reorder(1),t}size(){return this._size}reorder(t){let e=null;const i=this._items.get(t);for(;2*t<=this._size&&(e=2*t,e!==this._size&&this._items.get(e+1).compareTo(this._items.get(e))<0&&e++,this._items.get(e).compareTo(i)<0);t=e)this._items.set(t,this._items.get(e));this._items.set(t,i)}clear(){this._size=0,this._items.clear()}peek(){return this.isEmpty()?null:this._items.get(1)}isEmpty(){return 0===this._size}add(t){this._items.add(null),this._size+=1;let e=this._size;for(this._items.set(0,t);t.compareTo(this._items.get(Math.trunc(e/2)))<0;e/=2)this._items.set(e,this._items.get(Math.trunc(e/2)));this._items.set(e,t)}}class WS{insert(t,e){}remove(t,e){}query(){}}class ZS{constructor(){ZS.constructor_.apply(this,arguments)}static constructor_(){if(this._childBoundables=new xE,this._bounds=null,this._level=null,0===arguments.length);else if(1===arguments.length){const t=arguments[0];this._level=t}}getLevel(){return this._level}size(){return this._childBoundables.size()}getChildBoundables(){return this._childBoundables}addChildBoundable(t){Vv.isTrue(null===this._bounds),this._childBoundables.add(t)}isEmpty(){return this._childBoundables.isEmpty()}getBounds(){return null===this._bounds&&(this._bounds=this.computeBounds()),this._bounds}get interfaces_(){return[qS,Uv]}}const HS={reverseOrder:function(){return{compare:(t,e)=>e.compareTo(t)}},min:function(t){return HS.sort(t),t.get(0)},sort:function(t,e){const i=t.toArray();e?vE.sort(i,e):vE.sort(i);const n=t.iterator();for(let t=0,e=i.length;t<e;t++)n.next(),n.set(i[t])},singletonList:function(t){const e=new xE;return e.add(t),e}},KS=HS;class $S{static maxDistance(t,e,i,n,r,s,o,a){let l=$S.distance(t,e,r,s);return l=Math.max(l,$S.distance(t,e,o,a)),l=Math.max(l,$S.distance(i,n,r,s)),l=Math.max(l,$S.distance(i,n,o,a)),l}static distance(t,e,i,n){const r=i-t,s=n-e;return Math.sqrt(r*r+s*s)}static maximumDistance(t,e){const i=Math.min(t.getMinX(),e.getMinX()),n=Math.min(t.getMinY(),e.getMinY()),r=Math.max(t.getMaxX(),e.getMaxX()),s=Math.max(t.getMaxY(),e.getMaxY());return $S.distance(i,n,r,s)}static minMaxDistance(t,e){const i=t.getMinX(),n=t.getMinY(),r=t.getMaxX(),s=t.getMaxY(),o=e.getMinX(),a=e.getMinY(),l=e.getMaxX(),h=e.getMaxY();let c=$S.maxDistance(i,n,i,s,o,a,o,h);return c=Math.min(c,$S.maxDistance(i,n,i,s,o,a,l,a)),c=Math.min(c,$S.maxDistance(i,n,i,s,l,h,o,h)),c=Math.min(c,$S.maxDistance(i,n,i,s,l,h,l,a)),c=Math.min(c,$S.maxDistance(i,n,r,n,o,a,o,h)),c=Math.min(c,$S.maxDistance(i,n,r,n,o,a,l,a)),c=Math.min(c,$S.maxDistance(i,n,r,n,l,h,o,h)),c=Math.min(c,$S.maxDistance(i,n,r,n,l,h,l,a)),c=Math.min(c,$S.maxDistance(r,s,i,s,o,a,o,h)),c=Math.min(c,$S.maxDistance(r,s,i,s,o,a,l,a)),c=Math.min(c,$S.maxDistance(r,s,i,s,l,h,o,h)),c=Math.min(c,$S.maxDistance(r,s,i,s,l,h,l,a)),c=Math.min(c,$S.maxDistance(r,s,r,n,o,a,o,h)),c=Math.min(c,$S.maxDistance(r,s,r,n,o,a,l,a)),c=Math.min(c,$S.maxDistance(r,s,r,n,l,h,o,h)),c=Math.min(c,$S.maxDistance(r,s,r,n,l,h,l,a)),c}}class JS{constructor(){JS.constructor_.apply(this,arguments)}static constructor_(){this._boundable1=null,this._boundable2=null,this._distance=null,this._itemDistance=null;const t=arguments[0],e=arguments[1],i=arguments[2];this._boundable1=t,this._boundable2=e,this._itemDistance=i,this._distance=this.distance()}static area(t){return t.getBounds().getArea()}static isComposite(t){return t instanceof ZS}maximumDistance(){return $S.maximumDistance(this._boundable1.getBounds(),this._boundable2.getBounds())}expandToQueue(t,e){const i=JS.isComposite(this._boundable1),n=JS.isComposite(this._boundable2);if(i&&n)return JS.area(this._boundable1)>JS.area(this._boundable2)?(this.expand(this._boundable1,this._boundable2,!1,t,e),null):(this.expand(this._boundable2,this._boundable1,!0,t,e),null);if(i)return this.expand(this._boundable1,this._boundable2,!1,t,e),null;if(n)return this.expand(this._boundable2,this._boundable1,!0,t,e),null;throw new Ov("neither boundable is composite")}isLeaves(){return!(JS.isComposite(this._boundable1)||JS.isComposite(this._boundable2))}compareTo(t){const e=t;return this._distance<e._distance?-1:this._distance>e._distance?1:0}expand(t,e,i,n,r){for(let s=t.getChildBoundables().iterator();s.hasNext();){const t=s.next();let o=null;o=i?new JS(e,t,this._itemDistance):new JS(t,e,this._itemDistance),o.getDistance()<r&&n.add(o)}}getBoundable(t){return 0===t?this._boundable1:this._boundable2}getDistance(){return this._distance}distance(){return this.isLeaves()?this._itemDistance.distance(this._boundable1,this._boundable2):this._boundable1.getBounds().distance(this._boundable2.getBounds())}get interfaces_(){return[Bv]}}class QS{visitItem(t){}}class tI{constructor(){tI.constructor_.apply(this,arguments)}static constructor_(){if(this._root=null,this._built=!1,this._itemBoundables=new xE,this._nodeCapacity=null,0===arguments.length)tI.constructor_.call(this,tI.DEFAULT_NODE_CAPACITY);else if(1===arguments.length){const t=arguments[0];Vv.isTrue(t>1,"Node capacity must be greater than 1"),this._nodeCapacity=t}}static compareDoubles(t,e){return t>e?1:t<e?-1:0}queryInternal(){if($v(arguments[2],QS)&&arguments[0]instanceof Object&&arguments[1]instanceof ZS){const t=arguments[0],e=arguments[2],i=arguments[1].getChildBoundables();for(let n=0;n<i.size();n++){const r=i.get(n);this.getIntersectsOp().intersects(r.getBounds(),t)&&(r instanceof ZS?this.queryInternal(t,r,e):r instanceof VS?e.visitItem(r.getItem()):Vv.shouldNeverReachHere())}}else if($v(arguments[2],yE)&&arguments[0]instanceof Object&&arguments[1]instanceof ZS){const t=arguments[0],e=arguments[2],i=arguments[1].getChildBoundables();for(let n=0;n<i.size();n++){const r=i.get(n);this.getIntersectsOp().intersects(r.getBounds(),t)&&(r instanceof ZS?this.queryInternal(t,r,e):r instanceof VS?e.add(r.getItem()):Vv.shouldNeverReachHere())}}}getNodeCapacity(){return this._nodeCapacity}lastNode(t){return t.get(t.size()-1)}size(){if(0===arguments.length)return this.isEmpty()?0:(this.build(),this.size(this._root));if(1===arguments.length){let t=0;for(let e=arguments[0].getChildBoundables().iterator();e.hasNext();){const i=e.next();i instanceof ZS?t+=this.size(i):i instanceof VS&&(t+=1)}return t}}removeItem(t,e){let i=null;for(let n=t.getChildBoundables().iterator();n.hasNext();){const t=n.next();t instanceof VS&&t.getItem()===e&&(i=t)}return null!==i&&(t.getChildBoundables().remove(i),!0)}itemsTree(){if(0===arguments.length){this.build();const t=this.itemsTree(this._root);return null===t?new xE:t}if(1===arguments.length){const t=arguments[0],e=new xE;for(let i=t.getChildBoundables().iterator();i.hasNext();){const t=i.next();if(t instanceof ZS){const i=this.itemsTree(t);null!==i&&e.add(i)}else t instanceof VS?e.add(t.getItem()):Vv.shouldNeverReachHere()}return e.size()<=0?null:e}}insert(t,e){Vv.isTrue(!this._built,"Cannot insert items into an STR packed R-tree after it has been built."),this._itemBoundables.add(new VS(t,e))}boundablesAtLevel(){if(1===arguments.length){const t=arguments[0],e=new xE;return this.boundablesAtLevel(t,this._root,e),e}if(3===arguments.length){const t=arguments[0],e=arguments[1],i=arguments[2];if(Vv.isTrue(t>-2),e.getLevel()===t)return i.add(e),null;for(let n=e.getChildBoundables().iterator();n.hasNext();){const e=n.next();e instanceof ZS?this.boundablesAtLevel(t,e,i):(Vv.isTrue(e instanceof VS),-1===t&&i.add(e))}return null}}query(){if(1===arguments.length){const t=arguments[0];this.build();const e=new xE;return this.isEmpty()||this.getIntersectsOp().intersects(this._root.getBounds(),t)&&this.queryInternal(t,this._root,e),e}if(2===arguments.length){const t=arguments[0],e=arguments[1];if(this.build(),this.isEmpty())return null;this.getIntersectsOp().intersects(this._root.getBounds(),t)&&this.queryInternal(t,this._root,e)}}build(){if(this._built)return null;this._root=this._itemBoundables.isEmpty()?this.createNode(0):this.createHigherLevels(this._itemBoundables,-1),this._itemBoundables=null,this._built=!0}getRoot(){return this.build(),this._root}remove(){if(2===arguments.length){const t=arguments[0],e=arguments[1];return this.build(),!!this.getIntersectsOp().intersects(this._root.getBounds(),t)&&this.remove(t,this._root,e)}if(3===arguments.length){const t=arguments[0],e=arguments[1],i=arguments[2];let n=this.removeItem(e,i);if(n)return!0;let r=null;for(let s=e.getChildBoundables().iterator();s.hasNext();){const e=s.next();if(this.getIntersectsOp().intersects(e.getBounds(),t)&&e instanceof ZS&&(n=this.remove(t,e,i),n)){r=e;break}}return null!==r&&r.getChildBoundables().isEmpty()&&e.getChildBoundables().remove(r),n}}createHigherLevels(t,e){Vv.isTrue(!t.isEmpty());const i=this.createParentBoundables(t,e+1);return 1===i.size()?i.get(0):this.createHigherLevels(i,e+1)}depth(){if(0===arguments.length)return this.isEmpty()?0:(this.build(),this.depth(this._root));if(1===arguments.length){let t=0;for(let e=arguments[0].getChildBoundables().iterator();e.hasNext();){const i=e.next();if(i instanceof ZS){const e=this.depth(i);e>t&&(t=e)}}return t+1}}createParentBoundables(t,e){Vv.isTrue(!t.isEmpty());const i=new xE;i.add(this.createNode(e));const n=new xE(t);KS.sort(n,this.getComparator());for(let t=n.iterator();t.hasNext();){const n=t.next();this.lastNode(i).getChildBoundables().size()===this.getNodeCapacity()&&i.add(this.createNode(e)),this.lastNode(i).addChildBoundable(n)}return i}isEmpty(){return this._built?this._root.isEmpty():this._itemBoundables.isEmpty()}get interfaces_(){return[Uv]}}tI.IntersectsOp=function(){},tI.DEFAULT_NODE_CAPACITY=10;class eI{distance(t,e){}}class iI extends tI{constructor(){super(),iI.constructor_.apply(this,arguments)}static constructor_(){if(0===arguments.length)iI.constructor_.call(this,iI.DEFAULT_NODE_CAPACITY);else if(1===arguments.length){const t=arguments[0];tI.constructor_.call(this,t)}}static centreX(t){return iI.avg(t.getMinX(),t.getMaxX())}static avg(t,e){return(t+e)/2}static getItems(t){const e=new Array(t.size()).fill(null);let i=0;for(;!t.isEmpty();){const n=t.poll();e[i]=n.getBoundable(0).getItem(),i++}return e}static centreY(t){return iI.avg(t.getMinY(),t.getMaxY())}createParentBoundablesFromVerticalSlices(t,e){Vv.isTrue(t.length>0);const i=new xE;for(let n=0;n<t.length;n++)i.addAll(this.createParentBoundablesFromVerticalSlice(t[n],e));return i}nearestNeighbourK(){if(2===arguments.length){const t=arguments[0],e=arguments[1];return this.nearestNeighbourK(t,zv.POSITIVE_INFINITY,e)}if(3===arguments.length){const t=arguments[0],e=arguments[2];let i=arguments[1];const n=new jS;n.add(t);const r=new jS;for(;!n.isEmpty()&&i>=0;){const t=n.poll(),s=t.getDistance();if(s>=i)break;t.isLeaves()?r.size()<e?r.add(t):(r.peek().getDistance()>s&&(r.poll(),r.add(t)),i=r.peek().getDistance()):t.expandToQueue(n,i)}return iI.getItems(r)}}createNode(t){return new nI(t)}size(){return 0===arguments.length?super.size.call(this):super.size.apply(this,arguments)}insert(){if(!(2===arguments.length&&arguments[1]instanceof Object&&arguments[0]instanceof eE))return super.insert.apply(this,arguments);{const t=arguments[0],e=arguments[1];if(t.isNull())return null;super.insert.call(this,t,e)}}getIntersectsOp(){return iI.intersectsOp}verticalSlices(t,e){const i=Math.trunc(Math.ceil(t.size()/e)),n=new Array(e).fill(null),r=t.iterator();for(let t=0;t<e;t++){n[t]=new xE;let e=0;for(;r.hasNext()&&e<i;){const i=r.next();n[t].add(i),e++}}return n}query(){if(1===arguments.length){const t=arguments[0];return super.query.call(this,t)}if(2===arguments.length){const t=arguments[0],e=arguments[1];super.query.call(this,t,e)}}getComparator(){return iI.yComparator}createParentBoundablesFromVerticalSlice(t,e){return super.createParentBoundables.call(this,t,e)}remove(){if(2===arguments.length&&arguments[1]instanceof Object&&arguments[0]instanceof eE){const t=arguments[0],e=arguments[1];return super.remove.call(this,t,e)}return super.remove.apply(this,arguments)}depth(){return 0===arguments.length?super.depth.call(this):super.depth.apply(this,arguments)}createParentBoundables(t,e){Vv.isTrue(!t.isEmpty());const i=Math.trunc(Math.ceil(t.size()/this.getNodeCapacity())),n=new xE(t);KS.sort(n,iI.xComparator);const r=this.verticalSlices(n,Math.trunc(Math.ceil(Math.sqrt(i))));return this.createParentBoundablesFromVerticalSlices(r,e)}nearestNeighbour(){if(1===arguments.length){if($v(arguments[0],eI)){const t=arguments[0];if(this.isEmpty())return null;const e=new JS(this.getRoot(),this.getRoot(),t);return this.nearestNeighbour(e)}if(arguments[0]instanceof JS){const t=arguments[0];let e=zv.POSITIVE_INFINITY,i=null;const n=new jS;for(n.add(t);!n.isEmpty()&&e>0;){const t=n.poll(),r=t.getDistance();if(r>=e)break;t.isLeaves()?(e=r,i=t):t.expandToQueue(n,e)}return null===i?null:[i.getBoundable(0).getItem(),i.getBoundable(1).getItem()]}}else{if(2===arguments.length){const t=arguments[0],e=arguments[1];if(this.isEmpty()||t.isEmpty())return null;const i=new JS(this.getRoot(),t.getRoot(),e);return this.nearestNeighbour(i)}if(3===arguments.length){const t=arguments[2],e=new VS(arguments[0],arguments[1]),i=new JS(this.getRoot(),e,t);return this.nearestNeighbour(i)[0]}if(4===arguments.length){const t=arguments[2],e=arguments[3],i=new VS(arguments[0],arguments[1]),n=new JS(this.getRoot(),i,t);return this.nearestNeighbourK(n,e)}}}isWithinDistance(){if(2===arguments.length){const t=arguments[0],e=arguments[1];let i=zv.POSITIVE_INFINITY;const n=new jS;for(n.add(t);!n.isEmpty();){const t=n.poll(),r=t.getDistance();if(r>e)return!1;if(t.maximumDistance()<=e)return!0;if(t.isLeaves()){if(i=r,i<=e)return!0}else t.expandToQueue(n,i)}return!1}if(3===arguments.length){const t=arguments[0],e=arguments[1],i=arguments[2],n=new JS(this.getRoot(),t.getRoot(),e);return this.isWithinDistance(n,i)}}get interfaces_(){return[WS,Uv]}}class nI extends ZS{constructor(){super(),nI.constructor_.apply(this,arguments)}static constructor_(){const t=arguments[0];ZS.constructor_.call(this,t)}computeBounds(){let t=null;for(let e=this.getChildBoundables().iterator();e.hasNext();){const i=e.next();null===t?t=new eE(i.getBounds()):t.expandToInclude(i.getBounds())}return t}}iI.STRtreeNode=nI,iI.xComparator=new class{get interfaces_(){return[Yv]}compare(t,e){return tI.compareDoubles(iI.centreX(t.getBounds()),iI.centreX(e.getBounds()))}},iI.yComparator=new class{get interfaces_(){return[Yv]}compare(t,e){return tI.compareDoubles(iI.centreY(t.getBounds()),iI.centreY(e.getBounds()))}},iI.intersectsOp=new class{get interfaces_(){return[IntersectsOp]}intersects(t,e){return t.intersects(e)}},iI.DEFAULT_NODE_CAPACITY=10;class rI{static relativeSign(t,e){return t<e?-1:t>e?1:0}static compare(t,e,i){if(e.equals2D(i))return 0;const n=rI.relativeSign(e.x,i.x),r=rI.relativeSign(e.y,i.y);switch(t){case 0:return rI.compareValue(n,r);case 1:return rI.compareValue(r,n);case 2:return rI.compareValue(r,-n);case 3:return rI.compareValue(-n,r);case 4:return rI.compareValue(-n,-r);case 5:return rI.compareValue(-r,-n);case 6:return rI.compareValue(-r,n);case 7:return rI.compareValue(n,-r)}return Vv.shouldNeverReachHere("invalid octant value"),0}static compareValue(t,e){return t<0?-1:t>0?1:e<0?-1:e>0?1:0}}class sI{constructor(){sI.constructor_.apply(this,arguments)}static constructor_(){this._segString=null,this.coord=null,this.segmentIndex=null,this._segmentOctant=null,this._isInterior=null;const t=arguments[0],e=arguments[1],i=arguments[2],n=arguments[3];this._segString=t,this.coord=new Hv(e),this.segmentIndex=i,this._segmentOctant=n,this._isInterior=!e.equals2D(t.getCoordinate(i))}getCoordinate(){return this.coord}print(t){t.print(this.coord),t.print(" seg # = "+this.segmentIndex)}compareTo(t){const e=t;return this.segmentIndex<e.segmentIndex?-1:this.segmentIndex>e.segmentIndex?1:this.coord.equals2D(e.coord)?0:this._isInterior?e._isInterior?rI.compare(this._segmentOctant,this.coord,e.coord):1:-1}isEndPoint(t){return 0===this.segmentIndex&&!this._isInterior||this.segmentIndex===t}toString(){return this.segmentIndex+":"+this.coord.toString()}isInterior(){return this._isInterior}get interfaces_(){return[Bv]}}class oI{constructor(){oI.constructor_.apply(this,arguments)}static constructor_(){this._nodeMap=new OS,this._edge=null;const t=arguments[0];this._edge=t}getSplitCoordinates(){const t=new YE;this.addEndpoints();const e=this.iterator();let i=e.next();for(;e.hasNext();){const n=e.next();this.addEdgeCoordinates(i,n,t),i=n}return t.toCoordinateArray()}addCollapsedNodes(){const t=new xE;this.findCollapsesFromInsertedNodes(t),this.findCollapsesFromExistingVertices(t);for(let e=t.iterator();e.hasNext();){const t=e.next().intValue();this.add(this._edge.getCoordinate(t),t)}}createSplitEdgePts(t,e){let i=e.segmentIndex-t.segmentIndex+2;if(2===i)return[new Hv(t.coord),new Hv(e.coord)];const n=this._edge.getCoordinate(e.segmentIndex),r=e.isInterior()||!e.coord.equals2D(n);r||i--;const s=new Array(i).fill(null);let o=0;s[o++]=new Hv(t.coord);for(let i=t.segmentIndex+1;i<=e.segmentIndex;i++)s[o++]=this._edge.getCoordinate(i);return r&&(s[o]=new Hv(e.coord)),s}print(t){t.println("Intersections:");for(let e=this.iterator();e.hasNext();)e.next().print(t)}findCollapsesFromExistingVertices(t){for(let e=0;e<this._edge.size()-2;e++){const i=this._edge.getCoordinate(e),n=(this._edge.getCoordinate(e+1),this._edge.getCoordinate(e+2));i.equals2D(n)&&t.add(SE.valueOf(e+1))}}addEdgeCoordinates(t,e,i){const n=this.createSplitEdgePts(t,e);i.add(n,!1)}iterator(){return this._nodeMap.values().iterator()}addSplitEdges(t){this.addEndpoints(),this.addCollapsedNodes();const e=this.iterator();let i=e.next();for(;e.hasNext();){const n=e.next(),r=this.createSplitEdge(i,n);t.add(r),i=n}}findCollapseIndex(t,e,i){if(!t.coord.equals2D(e.coord))return!1;let n=e.segmentIndex-t.segmentIndex;return e.isInterior()||n--,1===n&&(i[0]=t.segmentIndex+1,!0)}findCollapsesFromInsertedNodes(t){const e=new Array(1).fill(null),i=this.iterator();let n=i.next();for(;i.hasNext();){const r=i.next();this.findCollapseIndex(n,r,e)&&t.add(SE.valueOf(e[0])),n=r}}getEdge(){return this._edge}addEndpoints(){const t=this._edge.size()-1;this.add(this._edge.getCoordinate(0),0),this.add(this._edge.getCoordinate(t),t)}createSplitEdge(t,e){const i=this.createSplitEdgePts(t,e);return new cI(i,this._edge.getData())}add(t,e){const i=new sI(this._edge,t,e,this._edge.getSegmentOctant(e)),n=this._nodeMap.get(i);return null!==n?(Vv.isTrue(n.coord.equals2D(t),"Found equal nodes with different coordinates"),n):(this._nodeMap.put(i,i),i)}checkSplitEdgesCorrectness(t){const e=this._edge.getCoordinates(),i=t.get(0).getCoordinate(0);if(!i.equals2D(e[0]))throw new Xv("bad split edge start point at "+i);const n=t.get(t.size()-1).getCoordinates(),r=n[n.length-1];if(!r.equals2D(e[e.length-1]))throw new Xv("bad split edge end point at "+r)}}class aI{static octant(){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){const t=arguments[0],e=arguments[1];if(0===t&&0===e)throw new Ov("Cannot compute the octant for point ( "+t+", "+e+" )");const i=Math.abs(t),n=Math.abs(e);return t>=0?e>=0?i>=n?0:1:i>=n?7:6:e>=0?i>=n?3:2:i>=n?4:5}if(arguments[0]instanceof Hv&&arguments[1]instanceof Hv){const t=arguments[0],e=arguments[1],i=e.x-t.x,n=e.y-t.y;if(0===i&&0===n)throw new Ov("Cannot compute the octant for two identical points "+t);return aI.octant(i,n)}}}class lI{getCoordinates(){}size(){}getCoordinate(t){}isClosed(){}setData(t){}getData(){}}class hI{addIntersection(t,e){}get interfaces_(){return[lI]}}class cI{constructor(){cI.constructor_.apply(this,arguments)}static constructor_(){this._nodeList=new oI(this),this._pts=null,this._data=null;const t=arguments[0],e=arguments[1];this._pts=t,this._data=e}static getNodedSubstrings(){if(1===arguments.length){const t=arguments[0],e=new xE;return cI.getNodedSubstrings(t,e),e}if(2===arguments.length){const t=arguments[1];for(let e=arguments[0].iterator();e.hasNext();)e.next().getNodeList().addSplitEdges(t)}}getCoordinates(){return this._pts}size(){return this._pts.length}getCoordinate(t){return this._pts[t]}isClosed(){return this._pts[0].equals(this._pts[this._pts.length-1])}getSegmentOctant(t){return t===this._pts.length-1?-1:this.safeOctant(this.getCoordinate(t),this.getCoordinate(t+1))}setData(t){this._data=t}safeOctant(t,e){return t.equals2D(e)?0:aI.octant(t,e)}getData(){return this._data}addIntersection(){if(2===arguments.length){const t=arguments[0],e=arguments[1];this.addIntersectionNode(t,e)}else if(4===arguments.length){const t=arguments[1],e=arguments[3],i=new Hv(arguments[0].getIntersection(e));this.addIntersection(i,t)}}toString(){return yS.toLineString(new jE(this._pts))}getNodeList(){return this._nodeList}addIntersectionNode(t,e){let i=e;const n=i+1;if(n<this._pts.length){const e=this._pts[n];t.equals2D(e)&&(i=n)}return this._nodeList.add(t,i)}addIntersections(t,e,i){for(let n=0;n<t.getIntersectionNum();n++)this.addIntersection(t,e,i,n)}get interfaces_(){return[hI]}}class uI{constructor(){uI.constructor_.apply(this,arguments)}static constructor_(){if(this.p0=null,this.p1=null,0===arguments.length)uI.constructor_.call(this,new Hv,new Hv);else if(1===arguments.length){const t=arguments[0];uI.constructor_.call(this,t.p0,t.p1)}else if(2===arguments.length){const t=arguments[0],e=arguments[1];this.p0=t,this.p1=e}else if(4===arguments.length){const t=arguments[0],e=arguments[1],i=arguments[2],n=arguments[3];uI.constructor_.call(this,new Hv(t,e),new Hv(i,n))}}static midPoint(t,e){return new Hv((t.x+e.x)/2,(t.y+e.y)/2)}minX(){return Math.min(this.p0.x,this.p1.x)}orientationIndex(){if(arguments[0]instanceof uI){const t=arguments[0],e=CE.index(this.p0,this.p1,t.p0),i=CE.index(this.p0,this.p1,t.p1);return e>=0&&i>=0||e<=0&&i<=0?Math.max(e,i):0}if(arguments[0]instanceof Hv){const t=arguments[0];return CE.index(this.p0,this.p1,t)}}toGeometry(t){return t.createLineString([this.p0,this.p1])}isVertical(){return this.p0.x===this.p1.x}equals(t){if(!(t instanceof uI))return!1;const e=t;return this.p0.equals(e.p0)&&this.p1.equals(e.p1)}intersection(t){const e=new xS;return e.computeIntersection(this.p0,this.p1,t.p0,t.p1),e.hasIntersection()?e.getIntersection(0):null}project(){if(arguments[0]instanceof Hv){const t=arguments[0];if(t.equals(this.p0)||t.equals(this.p1))return new Hv(t);const e=this.projectionFactor(t),i=new Hv;return i.x=this.p0.x+e*(this.p1.x-this.p0.x),i.y=this.p0.y+e*(this.p1.y-this.p0.y),i}if(arguments[0]instanceof uI){const t=arguments[0],e=this.projectionFactor(t.p0),i=this.projectionFactor(t.p1);if(e>=1&&i>=1)return null;if(e<=0&&i<=0)return null;let n=this.project(t.p0);e<0&&(n=this.p0),e>1&&(n=this.p1);let r=this.project(t.p1);return i<0&&(r=this.p0),i>1&&(r=this.p1),new uI(n,r)}}normalize(){this.p1.compareTo(this.p0)<0&&this.reverse()}angle(){return Math.atan2(this.p1.y-this.p0.y,this.p1.x-this.p0.x)}getCoordinate(t){return 0===t?this.p0:this.p1}distancePerpendicular(t){return gS.pointToLinePerpendicular(t,this.p0,this.p1)}minY(){return Math.min(this.p0.y,this.p1.y)}midPoint(){return uI.midPoint(this.p0,this.p1)}projectionFactor(t){if(t.equals(this.p0))return 0;if(t.equals(this.p1))return 1;const e=this.p1.x-this.p0.x,i=this.p1.y-this.p0.y,n=e*e+i*i;return n<=0?zv.NaN:((t.x-this.p0.x)*e+(t.y-this.p0.y)*i)/n}closestPoints(t){const e=this.intersection(t);if(null!==e)return[e,e];const i=new Array(2).fill(null);let n=zv.MAX_VALUE,r=null;const s=this.closestPoint(t.p0);n=s.distance(t.p0),i[0]=s,i[1]=t.p0;const o=this.closestPoint(t.p1);r=o.distance(t.p1),r<n&&(n=r,i[0]=o,i[1]=t.p1);const a=t.closestPoint(this.p0);r=a.distance(this.p0),r<n&&(n=r,i[0]=this.p0,i[1]=a);const l=t.closestPoint(this.p1);return r=l.distance(this.p1),r<n&&(n=r,i[0]=this.p1,i[1]=l),i}closestPoint(t){const e=this.projectionFactor(t);return e>0&&e<1?this.project(t):this.p0.distance(t)<this.p1.distance(t)?this.p0:this.p1}maxX(){return Math.max(this.p0.x,this.p1.x)}getLength(){return this.p0.distance(this.p1)}compareTo(t){const e=t,i=this.p0.compareTo(e.p0);return 0!==i?i:this.p1.compareTo(e.p1)}reverse(){const t=this.p0;this.p0=this.p1,this.p1=t}equalsTopo(t){return this.p0.equals(t.p0)&&this.p1.equals(t.p1)||this.p0.equals(t.p1)&&this.p1.equals(t.p0)}lineIntersection(t){return dS.intersection(this.p0,this.p1,t.p0,t.p1)}maxY(){return Math.max(this.p0.y,this.p1.y)}pointAlongOffset(t,e){const i=this.p0.x+t*(this.p1.x-this.p0.x),n=this.p0.y+t*(this.p1.y-this.p0.y),r=this.p1.x-this.p0.x,s=this.p1.y-this.p0.y,o=Math.sqrt(r*r+s*s);let a=0,l=0;if(0!==e){if(o<=0)throw new IllegalStateException("Cannot compute offset from zero-length line segment");a=e*r/o,l=e*s/o}return new Hv(i-l,n+a)}setCoordinates(){if(1===arguments.length){const t=arguments[0];this.setCoordinates(t.p0,t.p1)}else if(2===arguments.length){const t=arguments[0],e=arguments[1];this.p0.x=t.x,this.p0.y=t.y,this.p1.x=e.x,this.p1.y=e.y}}segmentFraction(t){let e=this.projectionFactor(t);return e<0?e=0:(e>1||zv.isNaN(e))&&(e=1),e}toString(){return"LINESTRING( "+this.p0.x+" "+this.p0.y+", "+this.p1.x+" "+this.p1.y+")"}isHorizontal(){return this.p0.y===this.p1.y}reflect(t){const e=this.p1.getY()-this.p0.getY(),i=this.p0.getX()-this.p1.getX(),n=this.p0.getY()*(this.p1.getX()-this.p0.getX())-this.p0.getX()*(this.p1.getY()-this.p0.getY()),r=e*e+i*i,s=e*e-i*i,o=t.getX(),a=t.getY();return new Hv((-s*o-2*e*i*a-2*e*n)/r,(s*a-2*e*i*o-2*i*n)/r)}distance(){if(arguments[0]instanceof uI){const t=arguments[0];return gS.segmentToSegment(this.p0,this.p1,t.p0,t.p1)}if(arguments[0]instanceof Hv){const t=arguments[0];return gS.pointToSegment(t,this.p0,this.p1)}}pointAlong(t){const e=new Hv;return e.x=this.p0.x+t*(this.p1.x-this.p0.x),e.y=this.p0.y+t*(this.p1.y-this.p0.y),e}hashCode(){let t=zv.doubleToLongBits(this.p0.x);t^=31*zv.doubleToLongBits(this.p0.y);const e=Math.trunc(t)^Math.trunc(t>>32);let i=zv.doubleToLongBits(this.p1.x);return i^=31*zv.doubleToLongBits(this.p1.y),e^Math.trunc(i)^Math.trunc(i>>32)}get interfaces_(){return[Bv,Uv]}}class dI{constructor(){dI.constructor_.apply(this,arguments)}static constructor_(){this._overlapSeg1=new uI,this._overlapSeg2=new uI}overlap(){if(2===arguments.length);else if(4===arguments.length){const t=arguments[1],e=arguments[2],i=arguments[3];arguments[0].getLineSegment(t,this._overlapSeg1),e.getLineSegment(i,this._overlapSeg2),this.overlap(this._overlapSeg1,this._overlapSeg2)}}}class gI{constructor(){gI.constructor_.apply(this,arguments)}static constructor_(){this._pts=null,this._start=null,this._end=null,this._env=null,this._context=null,this._id=null;const t=arguments[0],e=arguments[1],i=arguments[2],n=arguments[3];this._pts=t,this._start=e,this._end=i,this._context=n}getLineSegment(t,e){e.p0=this._pts[t],e.p1=this._pts[t+1]}computeSelect(t,e,i,n){const r=this._pts[e],s=this._pts[i];if(i-e==1)return n.select(this,e),null;if(!t.intersects(r,s))return null;const o=Math.trunc((e+i)/2);e<o&&this.computeSelect(t,e,o,n),o<i&&this.computeSelect(t,o,i,n)}getCoordinates(){const t=new Array(this._end-this._start+1).fill(null);let e=0;for(let i=this._start;i<=this._end;i++)t[e++]=this._pts[i];return t}computeOverlaps(){if(2===arguments.length){const t=arguments[0],e=arguments[1];this.computeOverlaps(this._start,this._end,t,t._start,t._end,e)}else if(6===arguments.length){const t=arguments[0],e=arguments[1],i=arguments[2],n=arguments[3],r=arguments[4],s=arguments[5];if(e-t==1&&r-n==1)return s.overlap(this,t,i,n),null;if(!this.overlaps(t,e,i,n,r))return null;const o=Math.trunc((t+e)/2),a=Math.trunc((n+r)/2);t<o&&(n<a&&this.computeOverlaps(t,o,i,n,a,s),a<r&&this.computeOverlaps(t,o,i,a,r,s)),o<e&&(n<a&&this.computeOverlaps(o,e,i,n,a,s),a<r&&this.computeOverlaps(o,e,i,a,r,s))}}setId(t){this._id=t}select(t,e){this.computeSelect(t,this._start,this._end,e)}getEnvelope(){if(null===this._env){const t=this._pts[this._start],e=this._pts[this._end];this._env=new eE(t,e)}return this._env}overlaps(t,e,i,n,r){return eE.intersects(this._pts[t],this._pts[e],i._pts[n],i._pts[r])}getEndIndex(){return this._end}getStartIndex(){return this._start}getContext(){return this._context}getId(){return this._id}}class fI{static findChainEnd(t,e){let i=e;for(;i<t.length-1&&t[i].equals2D(t[i+1]);)i++;if(i>=t.length-1)return t.length-1;const n=zS.quadrant(t[i],t[i+1]);let r=e+1;for(;r<t.length&&(t[r-1].equals2D(t[r])||zS.quadrant(t[r-1],t[r])===n);)r++;return r-1}static getChains(){if(1===arguments.length){const t=arguments[0];return fI.getChains(t,null)}if(2===arguments.length){const t=arguments[0],e=arguments[1],i=new xE;let n=0;do{const r=fI.findChainEnd(t,n),s=new gI(t,n,r,e);i.add(s),n=r}while(n<t.length-1);return i}}}class pI{computeNodes(t){}getNodedSubstrings(){}}class mI{constructor(){mI.constructor_.apply(this,arguments)}static constructor_(){if(this._segInt=null,0===arguments.length);else if(1===arguments.length){const t=arguments[0];this.setSegmentIntersector(t)}}setSegmentIntersector(t){this._segInt=t}get interfaces_(){return[pI]}}class _I extends mI{constructor(){super(),_I.constructor_.apply(this,arguments)}static constructor_(){if(this._monoChains=new xE,this._index=new iI,this._idCounter=0,this._nodedSegStrings=null,this._nOverlaps=0,0===arguments.length);else if(1===arguments.length){const t=arguments[0];mI.constructor_.call(this,t)}}getMonotoneChains(){return this._monoChains}getNodedSubstrings(){return cI.getNodedSubstrings(this._nodedSegStrings)}getIndex(){return this._index}add(t){for(let e=fI.getChains(t.getCoordinates(),t).iterator();e.hasNext();){const t=e.next();t.setId(this._idCounter++),this._index.insert(t.getEnvelope(),t),this._monoChains.add(t)}}computeNodes(t){this._nodedSegStrings=t;for(let e=t.iterator();e.hasNext();)this.add(e.next());this.intersectChains()}intersectChains(){const t=new yI(this._segInt);for(let e=this._monoChains.iterator();e.hasNext();){const i=e.next();for(let e=this._index.query(i.getEnvelope()).iterator();e.hasNext();){const n=e.next();if(n.getId()>i.getId()&&(i.computeOverlaps(n,t),this._nOverlaps++),this._segInt.isDone())return null}}}}class yI extends dI{constructor(){super(),yI.constructor_.apply(this,arguments)}static constructor_(){this._si=null;const t=arguments[0];this._si=t}overlap(){if(4!==arguments.length)return super.overlap.apply(this,arguments);{const t=arguments[1],e=arguments[2],i=arguments[3],n=arguments[0].getContext(),r=e.getContext();this._si.processIntersections(n,t,r,i)}}}_I.SegmentOverlapAction=yI;class wI{constructor(){wI.constructor_.apply(this,arguments)}static constructor_(){if(this._quadrantSegments=wI.DEFAULT_QUADRANT_SEGMENTS,this._endCapStyle=wI.CAP_ROUND,this._joinStyle=wI.JOIN_ROUND,this._mitreLimit=wI.DEFAULT_MITRE_LIMIT,this._isSingleSided=!1,this._simplifyFactor=wI.DEFAULT_SIMPLIFY_FACTOR,0===arguments.length);else if(1===arguments.length){const t=arguments[0];this.setQuadrantSegments(t)}else if(2===arguments.length){const t=arguments[0],e=arguments[1];this.setQuadrantSegments(t),this.setEndCapStyle(e)}else if(4===arguments.length){const t=arguments[0],e=arguments[1],i=arguments[2],n=arguments[3];this.setQuadrantSegments(t),this.setEndCapStyle(e),this.setJoinStyle(i),this.setMitreLimit(n)}}static bufferDistanceError(t){const e=Math.PI/2/t;return 1-Math.cos(e/2)}getEndCapStyle(){return this._endCapStyle}isSingleSided(){return this._isSingleSided}setQuadrantSegments(t){this._quadrantSegments=t,0===this._quadrantSegments&&(this._joinStyle=wI.JOIN_BEVEL),this._quadrantSegments<0&&(this._joinStyle=wI.JOIN_MITRE,this._mitreLimit=Math.abs(this._quadrantSegments)),t<=0&&(this._quadrantSegments=1),this._joinStyle!==wI.JOIN_ROUND&&(this._quadrantSegments=wI.DEFAULT_QUADRANT_SEGMENTS)}getJoinStyle(){return this._joinStyle}setJoinStyle(t){this._joinStyle=t}setSimplifyFactor(t){this._simplifyFactor=t<0?0:t}getSimplifyFactor(){return this._simplifyFactor}getQuadrantSegments(){return this._quadrantSegments}setEndCapStyle(t){this._endCapStyle=t}getMitreLimit(){return this._mitreLimit}setMitreLimit(t){this._mitreLimit=t}setSingleSided(t){this._isSingleSided=t}}wI.CAP_ROUND=1,wI.CAP_FLAT=2,wI.CAP_SQUARE=3,wI.JOIN_ROUND=1,wI.JOIN_MITRE=2,wI.JOIN_BEVEL=3,wI.DEFAULT_QUADRANT_SEGMENTS=8,wI.DEFAULT_MITRE_LIMIT=5,wI.DEFAULT_SIMPLIFY_FACTOR=.01;class xI{constructor(){xI.constructor_.apply(this,arguments)}static constructor_(){this._inputLine=null,this._distanceTol=null,this._isDeleted=null,this._angleOrientation=CE.COUNTERCLOCKWISE;const t=arguments[0];this._inputLine=t}static simplify(t,e){return new xI(t).simplify(e)}isDeletable(t,e,i,n){const r=this._inputLine[t],s=this._inputLine[e],o=this._inputLine[i];return!!this.isConcave(r,s,o)&&!!this.isShallow(r,s,o,n)&&this.isShallowSampled(r,s,t,i,n)}deleteShallowConcavities(){let t=1,e=this.findNextNonDeletedIndex(t),i=this.findNextNonDeletedIndex(e),n=!1;for(;i<this._inputLine.length;){let r=!1;this.isDeletable(t,e,i,this._distanceTol)&&(this._isDeleted[e]=xI.DELETE,r=!0,n=!0),t=r?i:e,e=this.findNextNonDeletedIndex(t),i=this.findNextNonDeletedIndex(e)}return n}isShallowConcavity(t,e,i,n){return CE.index(t,e,i)===this._angleOrientation&&gS.pointToSegment(e,t,i)<n}isShallowSampled(t,e,i,n,r){let s=Math.trunc((n-i)/xI.NUM_PTS_TO_CHECK);s<=0&&(s=1);for(let o=i;o<n;o+=s)if(!this.isShallow(t,e,this._inputLine[o],r))return!1;return!0}isConcave(t,e,i){return CE.index(t,e,i)===this._angleOrientation}simplify(t){this._distanceTol=Math.abs(t),t<0&&(this._angleOrientation=CE.CLOCKWISE),this._isDeleted=new Array(this._inputLine.length).fill(null);let e=!1;do{e=this.deleteShallowConcavities()}while(e);return this.collapseLine()}findNextNonDeletedIndex(t){let e=t+1;for(;e<this._inputLine.length&&this._isDeleted[e]===xI.DELETE;)e++;return e}isShallow(t,e,i,n){return gS.pointToSegment(e,t,i)<n}collapseLine(){const t=new YE;for(let e=0;e<this._inputLine.length;e++)this._isDeleted[e]!==xI.DELETE&&t.add(this._inputLine[e]);return t.toCoordinateArray()}}xI.INIT=0,xI.DELETE=1,xI.KEEP=1,xI.NUM_PTS_TO_CHECK=10;class bI{constructor(){bI.constructor_.apply(this,arguments)}static constructor_(){this._ptList=null,this._precisionModel=null,this._minimimVertexDistance=0,this._ptList=new xE}getCoordinates(){return this._ptList.toArray(bI.COORDINATE_ARRAY_TYPE)}setPrecisionModel(t){this._precisionModel=t}addPt(t){const e=new Hv(t);if(this._precisionModel.makePrecise(e),this.isRedundant(e))return null;this._ptList.add(e)}reverse(){}addPts(t,e){if(e)for(let e=0;e<t.length;e++)this.addPt(t[e]);else for(let e=t.length-1;e>=0;e--)this.addPt(t[e])}isRedundant(t){if(this._ptList.size()<1)return!1;const e=this._ptList.get(this._ptList.size()-1);return t.distance(e)<this._minimimVertexDistance}toString(){return(new eS).createLineString(this.getCoordinates()).toString()}closeRing(){if(this._ptList.size()<1)return null;const t=new Hv(this._ptList.get(0)),e=this._ptList.get(this._ptList.size()-1);if(t.equals(e))return null;this._ptList.add(t)}setMinimumVertexDistance(t){this._minimimVertexDistance=t}}bI.COORDINATE_ARRAY_TYPE=new Array(0).fill(null);class vI{static toDegrees(t){return 180*t/Math.PI}static normalize(t){for(;t>Math.PI;)t-=vI.PI_TIMES_2;for(;t<=-Math.PI;)t+=vI.PI_TIMES_2;return t}static angle(){if(1===arguments.length){const t=arguments[0];return Math.atan2(t.y,t.x)}if(2===arguments.length){const t=arguments[0],e=arguments[1],i=e.x-t.x,n=e.y-t.y;return Math.atan2(n,i)}}static isAcute(t,e,i){const n=t.x-e.x,r=t.y-e.y;return n*(i.x-e.x)+r*(i.y-e.y)>0}static isObtuse(t,e,i){const n=t.x-e.x,r=t.y-e.y;return n*(i.x-e.x)+r*(i.y-e.y)<0}static interiorAngle(t,e,i){const n=vI.angle(e,t),r=vI.angle(e,i);return Math.abs(r-n)}static normalizePositive(t){if(t<0){for(;t<0;)t+=vI.PI_TIMES_2;t>=vI.PI_TIMES_2&&(t=0)}else{for(;t>=vI.PI_TIMES_2;)t-=vI.PI_TIMES_2;t<0&&(t=0)}return t}static angleBetween(t,e,i){const n=vI.angle(e,t),r=vI.angle(e,i);return vI.diff(n,r)}static diff(t,e){let i=null;return i=t<e?e-t:t-e,i>Math.PI&&(i=2*Math.PI-i),i}static toRadians(t){return t*Math.PI/180}static getTurn(t,e){const i=Math.sin(e-t);return i>0?vI.COUNTERCLOCKWISE:i<0?vI.CLOCKWISE:vI.NONE}static angleBetweenOriented(t,e,i){const n=vI.angle(e,t),r=vI.angle(e,i)-n;return r<=-Math.PI?r+vI.PI_TIMES_2:r>Math.PI?r-vI.PI_TIMES_2:r}}vI.PI_TIMES_2=2*Math.PI,vI.PI_OVER_2=Math.PI/2,vI.PI_OVER_4=Math.PI/4,vI.COUNTERCLOCKWISE=CE.COUNTERCLOCKWISE,vI.CLOCKWISE=CE.CLOCKWISE,vI.NONE=CE.COLLINEAR;class EI{constructor(){EI.constructor_.apply(this,arguments)}static constructor_(){this._maxCurveSegmentError=0,this._filletAngleQuantum=null,this._closingSegLengthFactor=1,this._segList=null,this._distance=0,this._precisionModel=null,this._bufParams=null,this._li=null,this._s0=null,this._s1=null,this._s2=null,this._seg0=new uI,this._seg1=new uI,this._offset0=new uI,this._offset1=new uI,this._side=0,this._hasNarrowConcaveAngle=!1;const t=arguments[0],e=arguments[1],i=arguments[2];this._precisionModel=t,this._bufParams=e,this._li=new xS,this._filletAngleQuantum=Math.PI/2/e.getQuadrantSegments(),e.getQuadrantSegments()>=8&&e.getJoinStyle()===wI.JOIN_ROUND&&(this._closingSegLengthFactor=EI.MAX_CLOSING_SEG_LEN_FACTOR),this.init(i)}addNextSegment(t,e){if(this._s0=this._s1,this._s1=this._s2,this._s2=t,this._seg0.setCoordinates(this._s0,this._s1),this.computeOffsetSegment(this._seg0,this._side,this._distance,this._offset0),this._seg1.setCoordinates(this._s1,this._s2),this.computeOffsetSegment(this._seg1,this._side,this._distance,this._offset1),this._s1.equals(this._s2))return null;const i=CE.index(this._s0,this._s1,this._s2),n=i===CE.CLOCKWISE&&this._side===sS.LEFT||i===CE.COUNTERCLOCKWISE&&this._side===sS.RIGHT;0===i?this.addCollinear(e):n?this.addOutsideTurn(i,e):this.addInsideTurn(i,e)}addLineEndCap(t,e){const i=new uI(t,e),n=new uI;this.computeOffsetSegment(i,sS.LEFT,this._distance,n);const r=new uI;this.computeOffsetSegment(i,sS.RIGHT,this._distance,r);const s=e.x-t.x,o=e.y-t.y,a=Math.atan2(o,s);switch(this._bufParams.getEndCapStyle()){case wI.CAP_ROUND:this._segList.addPt(n.p1),this.addDirectedFillet(e,a+Math.PI/2,a-Math.PI/2,CE.CLOCKWISE,this._distance),this._segList.addPt(r.p1);break;case wI.CAP_FLAT:this._segList.addPt(n.p1),this._segList.addPt(r.p1);break;case wI.CAP_SQUARE:const t=new Hv;t.x=Math.abs(this._distance)*Math.cos(a),t.y=Math.abs(this._distance)*Math.sin(a);const i=new Hv(n.p1.x+t.x,n.p1.y+t.y),s=new Hv(r.p1.x+t.x,r.p1.y+t.y);this._segList.addPt(i),this._segList.addPt(s)}}getCoordinates(){return this._segList.getCoordinates()}addMitreJoin(t,e,i,n){const r=dS.intersection(e.p0,e.p1,i.p0,i.p1);if(null!==r&&(n<=0?1:r.distance(t)/Math.abs(n))<=this._bufParams.getMitreLimit())return this._segList.addPt(r),null;this.addLimitedMitreJoin(e,i,n,this._bufParams.getMitreLimit())}addOutsideTurn(t,e){if(this._offset0.p1.distance(this._offset1.p0)<this._distance*EI.OFFSET_SEGMENT_SEPARATION_FACTOR)return this._segList.addPt(this._offset0.p1),null;this._bufParams.getJoinStyle()===wI.JOIN_MITRE?this.addMitreJoin(this._s1,this._offset0,this._offset1,this._distance):this._bufParams.getJoinStyle()===wI.JOIN_BEVEL?this.addBevelJoin(this._offset0,this._offset1):(e&&this._segList.addPt(this._offset0.p1),this.addCornerFillet(this._s1,this._offset0.p1,this._offset1.p0,t,this._distance),this._segList.addPt(this._offset1.p0))}createSquare(t){this._segList.addPt(new Hv(t.x+this._distance,t.y+this._distance)),this._segList.addPt(new Hv(t.x+this._distance,t.y-this._distance)),this._segList.addPt(new Hv(t.x-this._distance,t.y-this._distance)),this._segList.addPt(new Hv(t.x-this._distance,t.y+this._distance)),this._segList.closeRing()}addSegments(t,e){this._segList.addPts(t,e)}addFirstSegment(){this._segList.addPt(this._offset1.p0)}addCornerFillet(t,e,i,n,r){const s=e.x-t.x,o=e.y-t.y;let a=Math.atan2(o,s);const l=i.x-t.x,h=i.y-t.y,c=Math.atan2(h,l);n===CE.CLOCKWISE?a<=c&&(a+=2*Math.PI):a>=c&&(a-=2*Math.PI),this._segList.addPt(e),this.addDirectedFillet(t,a,c,n,r),this._segList.addPt(i)}addLastSegment(){this._segList.addPt(this._offset1.p1)}initSideSegments(t,e,i){this._s1=t,this._s2=e,this._side=i,this._seg1.setCoordinates(t,e),this.computeOffsetSegment(this._seg1,i,this._distance,this._offset1)}addLimitedMitreJoin(t,e,i,n){const r=this._seg0.p1,s=vI.angle(r,this._seg0.p0),o=vI.angleBetweenOriented(this._seg0.p0,r,this._seg1.p1)/2,a=vI.normalize(s+o),l=vI.normalize(a+Math.PI),h=n*i,c=i-h*Math.abs(Math.sin(o)),u=r.x+h*Math.cos(l),d=r.y+h*Math.sin(l),g=new Hv(u,d),f=new uI(r,g),p=f.pointAlongOffset(1,c),m=f.pointAlongOffset(1,-c);this._side===sS.LEFT?(this._segList.addPt(p),this._segList.addPt(m)):(this._segList.addPt(m),this._segList.addPt(p))}addDirectedFillet(t,e,i,n,r){const s=n===CE.CLOCKWISE?-1:1,o=Math.abs(e-i),a=Math.trunc(o/this._filletAngleQuantum+.5);if(a<1)return null;const l=o/a,h=new Hv;for(let i=0;i<a;i++){const n=e+s*i*l;h.x=t.x+r*Math.cos(n),h.y=t.y+r*Math.sin(n),this._segList.addPt(h)}}computeOffsetSegment(t,e,i,n){const r=e===sS.LEFT?1:-1,s=t.p1.x-t.p0.x,o=t.p1.y-t.p0.y,a=Math.sqrt(s*s+o*o),l=r*i*s/a,h=r*i*o/a;n.p0.x=t.p0.x-h,n.p0.y=t.p0.y+l,n.p1.x=t.p1.x-h,n.p1.y=t.p1.y+l}addInsideTurn(t,e){if(this._li.computeIntersection(this._offset0.p0,this._offset0.p1,this._offset1.p0,this._offset1.p1),this._li.hasIntersection())this._segList.addPt(this._li.getIntersection(0));else if(this._hasNarrowConcaveAngle=!0,this._offset0.p1.distance(this._offset1.p0)<this._distance*EI.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR)this._segList.addPt(this._offset0.p1);else{if(this._segList.addPt(this._offset0.p1),this._closingSegLengthFactor>0){const t=new Hv((this._closingSegLengthFactor*this._offset0.p1.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset0.p1.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(t);const e=new Hv((this._closingSegLengthFactor*this._offset1.p0.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset1.p0.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(e)}else this._segList.addPt(this._s1);this._segList.addPt(this._offset1.p0)}}createCircle(t){const e=new Hv(t.x+this._distance,t.y);this._segList.addPt(e),this.addDirectedFillet(t,0,2*Math.PI,-1,this._distance),this._segList.closeRing()}addBevelJoin(t,e){this._segList.addPt(t.p1),this._segList.addPt(e.p0)}init(t){this._distance=t,this._maxCurveSegmentError=t*(1-Math.cos(this._filletAngleQuantum/2)),this._segList=new bI,this._segList.setPrecisionModel(this._precisionModel),this._segList.setMinimumVertexDistance(t*EI.CURVE_VERTEX_SNAP_DISTANCE_FACTOR)}addCollinear(t){this._li.computeIntersection(this._s0,this._s1,this._s1,this._s2),this._li.getIntersectionNum()>=2&&(this._bufParams.getJoinStyle()===wI.JOIN_BEVEL||this._bufParams.getJoinStyle()===wI.JOIN_MITRE?(t&&this._segList.addPt(this._offset0.p1),this._segList.addPt(this._offset1.p0)):this.addCornerFillet(this._s1,this._offset0.p1,this._offset1.p0,CE.CLOCKWISE,this._distance))}closeRing(){this._segList.closeRing()}hasNarrowConcaveAngle(){return this._hasNarrowConcaveAngle}}EI.OFFSET_SEGMENT_SEPARATION_FACTOR=.001,EI.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR=.001,EI.CURVE_VERTEX_SNAP_DISTANCE_FACTOR=1e-6,EI.MAX_CLOSING_SEG_LEN_FACTOR=80;class SI{constructor(){SI.constructor_.apply(this,arguments)}static constructor_(){this._distance=0,this._precisionModel=null,this._bufParams=null;const t=arguments[0],e=arguments[1];this._precisionModel=t,this._bufParams=e}static copyCoordinates(t){const e=new Array(t.length).fill(null);for(let i=0;i<e.length;i++)e[i]=new Hv(t[i]);return e}getOffsetCurve(t,e){if(this._distance=e,0===e)return null;const i=e<0,n=Math.abs(e),r=this.getSegGen(n);t.length<=1?this.computePointCurve(t[0],r):this.computeOffsetCurve(t,i,r);const s=r.getCoordinates();return i&&qE.reverse(s),s}computeSingleSidedBufferCurve(t,e,i){const n=this.simplifyTolerance(this._distance);if(e){i.addSegments(t,!0);const e=xI.simplify(t,-n),r=e.length-1;i.initSideSegments(e[r],e[r-1],sS.LEFT),i.addFirstSegment();for(let t=r-2;t>=0;t--)i.addNextSegment(e[t],!0)}else{i.addSegments(t,!1);const e=xI.simplify(t,n),r=e.length-1;i.initSideSegments(e[0],e[1],sS.LEFT),i.addFirstSegment();for(let t=2;t<=r;t++)i.addNextSegment(e[t],!0)}i.addLastSegment(),i.closeRing()}computeRingBufferCurve(t,e,i){let n=this.simplifyTolerance(this._distance);e===sS.RIGHT&&(n=-n);const r=xI.simplify(t,n),s=r.length-1;i.initSideSegments(r[s-1],r[0],e);for(let t=1;t<=s;t++){const e=1!==t;i.addNextSegment(r[t],e)}i.closeRing()}computeLineBufferCurve(t,e){const i=this.simplifyTolerance(this._distance),n=xI.simplify(t,i),r=n.length-1;e.initSideSegments(n[0],n[1],sS.LEFT);for(let t=2;t<=r;t++)e.addNextSegment(n[t],!0);e.addLastSegment(),e.addLineEndCap(n[r-1],n[r]);const s=xI.simplify(t,-i),o=s.length-1;e.initSideSegments(s[o],s[o-1],sS.LEFT);for(let t=o-2;t>=0;t--)e.addNextSegment(s[t],!0);e.addLastSegment(),e.addLineEndCap(s[1],s[0]),e.closeRing()}computePointCurve(t,e){switch(this._bufParams.getEndCapStyle()){case wI.CAP_ROUND:e.createCircle(t);break;case wI.CAP_SQUARE:e.createSquare(t)}}getLineCurve(t,e){if(this._distance=e,this.isLineOffsetEmpty(e))return null;const i=Math.abs(e),n=this.getSegGen(i);if(t.length<=1)this.computePointCurve(t[0],n);else if(this._bufParams.isSingleSided()){const i=e<0;this.computeSingleSidedBufferCurve(t,i,n)}else this.computeLineBufferCurve(t,n);return n.getCoordinates()}getBufferParameters(){return this._bufParams}simplifyTolerance(t){return t*this._bufParams.getSimplifyFactor()}getRingCurve(t,e,i){if(this._distance=i,t.length<=2)return this.getLineCurve(t,i);if(0===i)return SI.copyCoordinates(t);const n=this.getSegGen(i);return this.computeRingBufferCurve(t,e,n),n.getCoordinates()}computeOffsetCurve(t,e,i){const n=this.simplifyTolerance(this._distance);if(e){const e=xI.simplify(t,-n),r=e.length-1;i.initSideSegments(e[r],e[r-1],sS.LEFT),i.addFirstSegment();for(let t=r-2;t>=0;t--)i.addNextSegment(e[t],!0)}else{const e=xI.simplify(t,n),r=e.length-1;i.initSideSegments(e[0],e[1],sS.LEFT),i.addFirstSegment();for(let t=2;t<=r;t++)i.addNextSegment(e[t],!0)}i.addLastSegment()}isLineOffsetEmpty(t){return 0===t||t<0&&!this._bufParams.isSingleSided()}getSegGen(t){return new EI(this._precisionModel,this._bufParams,t)}}class II{constructor(){II.constructor_.apply(this,arguments)}static constructor_(){this._subgraphs=null,this._seg=new uI;const t=arguments[0];this._subgraphs=t}findStabbedSegments(){if(1===arguments.length){const t=arguments[0],e=new xE;for(let i=this._subgraphs.iterator();i.hasNext();){const n=i.next(),r=n.getEnvelope();t.y<r.getMinY()||t.y>r.getMaxY()||this.findStabbedSegments(t,n.getDirectedEdges(),e)}return e}if(3===arguments.length)if($v(arguments[2],yE)&&arguments[0]instanceof Hv&&arguments[1]instanceof GS){const t=arguments[0],e=arguments[1],i=arguments[2],n=e.getEdge().getCoordinates();for(let r=0;r<n.length-1;r++){if(this._seg.p0=n[r],this._seg.p1=n[r+1],this._seg.p0.y>this._seg.p1.y&&this._seg.reverse(),Math.max(this._seg.p0.x,this._seg.p1.x)<t.x)continue;if(this._seg.isHorizontal())continue;if(t.y<this._seg.p0.y||t.y>this._seg.p1.y)continue;if(CE.index(this._seg.p0,this._seg.p1,t)===CE.RIGHT)continue;let s=e.getDepth(sS.LEFT);this._seg.p0.equals(n[r])||(s=e.getDepth(sS.RIGHT));const o=new MI(this._seg,s);i.add(o)}}else if($v(arguments[2],yE)&&arguments[0]instanceof Hv&&$v(arguments[1],yE)){const t=arguments[0],e=arguments[2];for(let i=arguments[1].iterator();i.hasNext();){const n=i.next();n.isForward()&&this.findStabbedSegments(t,n,e)}}}getDepth(t){const e=this.findStabbedSegments(t);return 0===e.size()?0:KS.min(e)._leftDepth}}class MI{constructor(){MI.constructor_.apply(this,arguments)}static constructor_(){this._upwardSeg=null,this._leftDepth=null;const t=arguments[0],e=arguments[1];this._upwardSeg=new uI(t),this._leftDepth=e}compareTo(t){const e=t;if(this._upwardSeg.minX()>=e._upwardSeg.maxX())return 1;if(this._upwardSeg.maxX()<=e._upwardSeg.minX())return-1;let i=this._upwardSeg.orientationIndex(e._upwardSeg);return 0!==i?i:(i=-1*e._upwardSeg.orientationIndex(this._upwardSeg),0!==i?i:this._upwardSeg.compareTo(e._upwardSeg))}compareX(t,e){const i=t.p0.compareTo(e.p0);return 0!==i?i:t.p1.compareTo(e.p1)}toString(){return this._upwardSeg.toString()}get interfaces_(){return[Bv]}}II.DepthSegment=MI;class CI extends Dv{constructor(){super(),CI.constructor_.apply(this,arguments)}static constructor_(){Dv.constructor_.call(this,"Projective point not representable on the Cartesian plane.")}}class TI{constructor(){TI.constructor_.apply(this,arguments)}static constructor_(){if(this.x=null,this.y=null,this.w=null,0===arguments.length)this.x=0,this.y=0,this.w=1;else if(1===arguments.length){const t=arguments[0];this.x=t.x,this.y=t.y,this.w=1}else if(2===arguments.length){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){const t=arguments[0],e=arguments[1];this.x=t,this.y=e,this.w=1}else if(arguments[0]instanceof TI&&arguments[1]instanceof TI){const t=arguments[0],e=arguments[1];this.x=t.y*e.w-e.y*t.w,this.y=e.x*t.w-t.x*e.w,this.w=t.x*e.y-e.x*t.y}else if(arguments[0]instanceof Hv&&arguments[1]instanceof Hv){const t=arguments[0],e=arguments[1];this.x=t.y-e.y,this.y=e.x-t.x,this.w=t.x*e.y-e.x*t.y}}else if(3===arguments.length){const t=arguments[0],e=arguments[1],i=arguments[2];this.x=t,this.y=e,this.w=i}else if(4===arguments.length){const t=arguments[0],e=arguments[1],i=arguments[2],n=arguments[3],r=t.y-e.y,s=e.x-t.x,o=t.x*e.y-e.x*t.y,a=i.y-n.y,l=n.x-i.x,h=i.x*n.y-n.x*i.y;this.x=s*h-l*o,this.y=a*o-r*h,this.w=r*l-a*s}}getY(){const t=this.y/this.w;if(zv.isNaN(t)||zv.isInfinite(t))throw new CI;return t}getX(){const t=this.x/this.w;if(zv.isNaN(t)||zv.isInfinite(t))throw new CI;return t}getCoordinate(){const t=new Hv;return t.x=this.getX(),t.y=this.getY(),t}}class RI{constructor(){RI.constructor_.apply(this,arguments)}static constructor_(){this.p0=null,this.p1=null,this.p2=null;const t=arguments[0],e=arguments[1],i=arguments[2];this.p0=t,this.p1=e,this.p2=i}static area(t,e,i){return Math.abs(((i.x-t.x)*(e.y-t.y)-(e.x-t.x)*(i.y-t.y))/2)}static signedArea(t,e,i){return((i.x-t.x)*(e.y-t.y)-(e.x-t.x)*(i.y-t.y))/2}static det(t,e,i,n){return t*n-e*i}static interpolateZ(t,e,i,n){const r=e.x,s=e.y,o=i.x-r,a=n.x-r,l=i.y-s,h=n.y-s,c=o*h-a*l,u=t.x-r,d=t.y-s,g=(h*u-a*d)/c,f=(-l*u+o*d)/c;return e.getZ()+g*(i.getZ()-e.getZ())+f*(n.getZ()-e.getZ())}static longestSideLength(t,e,i){const n=t.distance(e),r=e.distance(i),s=i.distance(t);let o=n;return r>o&&(o=r),s>o&&(o=s),o}static circumcentreDD(t,e,i){const n=IE.valueOf(t.x).subtract(i.x),r=IE.valueOf(t.y).subtract(i.y),s=IE.valueOf(e.x).subtract(i.x),o=IE.valueOf(e.y).subtract(i.y),a=IE.determinant(n,r,s,o).multiply(2),l=n.sqr().add(r.sqr()),h=s.sqr().add(o.sqr()),c=IE.determinant(r,l,o,h),u=IE.determinant(n,l,s,h),d=IE.valueOf(i.x).subtract(c.divide(a)).doubleValue(),g=IE.valueOf(i.y).add(u.divide(a)).doubleValue();return new Hv(d,g)}static isAcute(t,e,i){return!!vI.isAcute(t,e,i)&&!!vI.isAcute(e,i,t)&&!!vI.isAcute(i,t,e)}static circumcentre(t,e,i){const n=i.x,r=i.y,s=t.x-n,o=t.y-r,a=e.x-n,l=e.y-r,h=2*RI.det(s,o,a,l),c=RI.det(o,s*s+o*o,l,a*a+l*l),u=RI.det(s,s*s+o*o,a,a*a+l*l);return new Hv(n-c/h,r+u/h)}static perpendicularBisector(t,e){const i=e.x-t.x,n=e.y-t.y,r=new TI(t.x+i/2,t.y+n/2,1),s=new TI(t.x-n+i/2,t.y+i+n/2,1);return new TI(r,s)}static angleBisector(t,e,i){const n=e.distance(t),r=n/(n+e.distance(i)),s=i.x-t.x,o=i.y-t.y;return new Hv(t.x+r*s,t.y+r*o)}static area3D(t,e,i){const n=e.x-t.x,r=e.y-t.y,s=e.getZ()-t.getZ(),o=i.x-t.x,a=i.y-t.y,l=i.getZ()-t.getZ(),h=r*l-s*a,c=s*o-n*l,u=n*a-r*o,d=h*h+c*c+u*u;return Math.sqrt(d)/2}static centroid(t,e,i){const n=(t.x+e.x+i.x)/3,r=(t.y+e.y+i.y)/3;return new Hv(n,r)}static inCentre(t,e,i){const n=e.distance(i),r=t.distance(i),s=t.distance(e),o=n+r+s,a=(n*t.x+r*e.x+s*i.x)/o,l=(n*t.y+r*e.y+s*i.y)/o;return new Hv(a,l)}area(){return RI.area(this.p0,this.p1,this.p2)}signedArea(){return RI.signedArea(this.p0,this.p1,this.p2)}interpolateZ(t){if(null===t)throw new Ov("Supplied point is null.");return RI.interpolateZ(t,this.p0,this.p1,this.p2)}longestSideLength(){return RI.longestSideLength(this.p0,this.p1,this.p2)}isAcute(){return RI.isAcute(this.p0,this.p1,this.p2)}circumcentre(){return RI.circumcentre(this.p0,this.p1,this.p2)}area3D(){return RI.area3D(this.p0,this.p1,this.p2)}centroid(){return RI.centroid(this.p0,this.p1,this.p2)}inCentre(){return RI.inCentre(this.p0,this.p1,this.p2)}}class AI{constructor(){AI.constructor_.apply(this,arguments)}static constructor_(){this._inputGeom=null,this._distance=null,this._curveBuilder=null,this._curveList=new xE;const t=arguments[0],e=arguments[1],i=arguments[2];this._inputGeom=t,this._distance=e,this._curveBuilder=i}addRingSide(t,e,i,n,r){if(0===e&&t.length<OE.MINIMUM_VALID_SIZE)return null;let s=n,o=r;t.length>=OE.MINIMUM_VALID_SIZE&&CE.isCCW(t)&&(s=r,o=n,i=sS.opposite(i));const a=this._curveBuilder.getRingCurve(t,i,e);this.addCurve(a,s,o)}addRingBothSides(t,e){this.addRingSide(t,e,sS.LEFT,rS.EXTERIOR,rS.INTERIOR),this.addRingSide(t,e,sS.RIGHT,rS.INTERIOR,rS.EXTERIOR)}addPoint(t){if(this._distance<=0)return null;const e=t.getCoordinates(),i=this._curveBuilder.getLineCurve(e,this._distance);this.addCurve(i,rS.EXTERIOR,rS.INTERIOR)}addPolygon(t){let e=this._distance,i=sS.LEFT;this._distance<0&&(e=-this._distance,i=sS.RIGHT);const n=t.getExteriorRing(),r=qE.removeRepeatedPoints(n.getCoordinates());if(this._distance<0&&this.isErodedCompletely(n,this._distance))return null;if(this._distance<=0&&r.length<3)return null;this.addRingSide(r,e,i,rS.EXTERIOR,rS.INTERIOR);for(let n=0;n<t.getNumInteriorRing();n++){const r=t.getInteriorRingN(n),s=qE.removeRepeatedPoints(r.getCoordinates());this._distance>0&&this.isErodedCompletely(r,-this._distance)||this.addRingSide(s,e,sS.opposite(i),rS.INTERIOR,rS.EXTERIOR)}}isTriangleErodedCompletely(t,e){const i=new RI(t[0],t[1],t[2]),n=i.inCentre();return gS.pointToSegment(n,i.p0,i.p1)<Math.abs(e)}addLineString(t){if(this._curveBuilder.isLineOffsetEmpty(this._distance))return null;const e=qE.removeRepeatedPoints(t.getCoordinates());if(qE.isRing(e)&&!this._curveBuilder.getBufferParameters().isSingleSided())this.addRingBothSides(e,this._distance);else{const t=this._curveBuilder.getLineCurve(e,this._distance);this.addCurve(t,rS.EXTERIOR,rS.INTERIOR)}}addCurve(t,e,i){if(null===t||t.length<2)return null;const n=new cI(t,new SS(0,rS.BOUNDARY,e,i));this._curveList.add(n)}getCurves(){return this.add(this._inputGeom),this._curveList}add(t){if(t.isEmpty())return null;if(t instanceof RE)this.addPolygon(t);else if(t instanceof dE)this.addLineString(t);else if(t instanceof fE)this.addPoint(t);else if(t instanceof DE)this.addCollection(t);else if(t instanceof tS)this.addCollection(t);else if(t instanceof ZE)this.addCollection(t);else{if(!(t instanceof NE))throw new aE(t.getGeometryType());this.addCollection(t)}}isErodedCompletely(t,e){const i=t.getCoordinates();if(i.length<4)return e<0;if(4===i.length)return this.isTriangleErodedCompletely(i,e);const n=t.getEnvelopeInternal(),r=Math.min(n.getHeight(),n.getWidth());return e<0&&2*Math.abs(e)>r}addCollection(t){for(let e=0;e<t.getNumGeometries();e++){const i=t.getGeometryN(e);this.add(i)}}}class kI{locate(t){}}class PI{hasNext(){}next(){}remove(){}}class LI{constructor(){LI.constructor_.apply(this,arguments)}static constructor_(){this._parent=null,this._atStart=null,this._max=null,this._index=null,this._subcollectionIterator=null;const t=arguments[0];this._parent=t,this._atStart=!0,this._index=0,this._max=t.getNumGeometries()}static isAtomic(t){return!(t instanceof NE)}next(){if(this._atStart)return this._atStart=!1,LI.isAtomic(this._parent)&&this._index++,this._parent;if(null!==this._subcollectionIterator){if(this._subcollectionIterator.hasNext())return this._subcollectionIterator.next();this._subcollectionIterator=null}if(this._index>=this._max)throw new wE;const t=this._parent.getGeometryN(this._index++);return t instanceof NE?(this._subcollectionIterator=new LI(t),this._subcollectionIterator.next()):t}remove(){throw new aE(this.getClass().getName())}hasNext(){if(this._atStart)return!0;if(null!==this._subcollectionIterator){if(this._subcollectionIterator.hasNext())return!0;this._subcollectionIterator=null}return!(this._index>=this._max)}get interfaces_(){return[PI]}}class NI{constructor(){NI.constructor_.apply(this,arguments)}static constructor_(){this._geom=null;const t=arguments[0];this._geom=t}static locatePointInPolygon(t,e){if(e.isEmpty())return rS.EXTERIOR;const i=e.getExteriorRing(),n=NI.locatePointInRing(t,i);if(n!==rS.INTERIOR)return n;for(let i=0;i<e.getNumInteriorRing();i++){const n=e.getInteriorRingN(i),r=NI.locatePointInRing(t,n);if(r===rS.BOUNDARY)return rS.BOUNDARY;if(r===rS.INTERIOR)return rS.EXTERIOR}return rS.INTERIOR}static locatePointInRing(t,e){return e.getEnvelopeInternal().intersects(t)?vS.locateInRing(t,e.getCoordinates()):rS.EXTERIOR}static containsPointInPolygon(t,e){return rS.EXTERIOR!==NI.locatePointInPolygon(t,e)}static locateInGeometry(t,e){if(e instanceof RE)return NI.locatePointInPolygon(t,e);if(e instanceof NE){const i=new LI(e);for(;i.hasNext();){const n=i.next();if(n!==e){const e=NI.locateInGeometry(t,n);if(e!==rS.EXTERIOR)return e}}}return rS.EXTERIOR}static isContained(t,e){return rS.EXTERIOR!==NI.locate(t,e)}static locate(t,e){return e.isEmpty()?rS.EXTERIOR:e.getEnvelopeInternal().intersects(t)?NI.locateInGeometry(t,e):rS.EXTERIOR}locate(t){return NI.locate(t,this._geom)}get interfaces_(){return[kI]}}class DI{constructor(){DI.constructor_.apply(this,arguments)}static constructor_(){this._edgeMap=new OS,this._edgeList=null,this._ptInAreaLocation=[rS.NONE,rS.NONE]}getNextCW(t){this.getEdges();const e=this._edgeList.indexOf(t);let i=e-1;return 0===e&&(i=this._edgeList.size()-1),this._edgeList.get(i)}propagateSideLabels(t){let e=rS.NONE;for(let i=this.iterator();i.hasNext();){const n=i.next().getLabel();n.isArea(t)&&n.getLocation(t,sS.LEFT)!==rS.NONE&&(e=n.getLocation(t,sS.LEFT))}if(e===rS.NONE)return null;let i=e;for(let e=this.iterator();e.hasNext();){const n=e.next(),r=n.getLabel();if(r.getLocation(t,sS.ON)===rS.NONE&&r.setLocation(t,sS.ON,i),r.isArea(t)){const e=r.getLocation(t,sS.LEFT),s=r.getLocation(t,sS.RIGHT);if(s!==rS.NONE){if(s!==i)throw new hS("side location conflict",n.getCoordinate());e===rS.NONE&&Vv.shouldNeverReachHere("found single null side (at "+n.getCoordinate()+")"),i=e}else Vv.isTrue(r.getLocation(t,sS.LEFT)===rS.NONE,"found single null side"),r.setLocation(t,sS.RIGHT,i),r.setLocation(t,sS.LEFT,i)}}}getCoordinate(){const t=this.iterator();return t.hasNext()?t.next().getCoordinate():null}print(t){XE.out.println("EdgeEndStar:   "+this.getCoordinate());for(let e=this.iterator();e.hasNext();)e.next().print(t)}isAreaLabelsConsistent(t){return this.computeEdgeEndLabels(t.getBoundaryNodeRule()),this.checkAreaLabelsConsistent(0)}checkAreaLabelsConsistent(t){const e=this.getEdges();if(e.size()<=0)return!0;const i=e.size()-1,n=e.get(i).getLabel().getLocation(t,sS.LEFT);Vv.isTrue(n!==rS.NONE,"Found unlabelled area edge");let r=n;for(let e=this.iterator();e.hasNext();){const i=e.next().getLabel();Vv.isTrue(i.isArea(t),"Found non-area edge");const n=i.getLocation(t,sS.LEFT),s=i.getLocation(t,sS.RIGHT);if(n===s)return!1;if(s!==r)return!1;r=n}return!0}findIndex(t){this.iterator();for(let e=0;e<this._edgeList.size();e++)if(this._edgeList.get(e)===t)return e;return-1}iterator(){return this.getEdges().iterator()}getEdges(){return null===this._edgeList&&(this._edgeList=new xE(this._edgeMap.values())),this._edgeList}getLocation(t,e,i){return this._ptInAreaLocation[t]===rS.NONE&&(this._ptInAreaLocation[t]=NI.locate(e,i[t].getGeometry())),this._ptInAreaLocation[t]}toString(){const t=new EE;t.append("EdgeEndStar:   "+this.getCoordinate()),t.append("\n");for(let e=this.iterator();e.hasNext();){const i=e.next();t.append(i),t.append("\n")}return t.toString()}computeEdgeEndLabels(t){for(let e=this.iterator();e.hasNext();)e.next().computeLabel(t)}computeLabelling(t){this.computeEdgeEndLabels(t[0].getBoundaryNodeRule()),this.propagateSideLabels(0),this.propagateSideLabels(1);const e=[!1,!1];for(let t=this.iterator();t.hasNext();){const i=t.next().getLabel();for(let t=0;t<2;t++)i.isLine(t)&&i.getLocation(t)===rS.BOUNDARY&&(e[t]=!0)}for(let i=this.iterator();i.hasNext();){const n=i.next(),r=n.getLabel();for(let i=0;i<2;i++)if(r.isAnyNull(i)){let s=rS.NONE;if(e[i])s=rS.EXTERIOR;else{const e=n.getCoordinate();s=this.getLocation(i,e,t)}r.setAllLocationsIfNull(i,s)}}}getDegree(){return this._edgeMap.size()}insertEdgeEnd(t,e){this._edgeMap.put(t,e),this._edgeList=null}}class OI extends DI{constructor(){super(),OI.constructor_.apply(this,arguments)}static constructor_(){this._resultAreaEdgeList=null,this._label=null,this._SCANNING_FOR_INCOMING=1,this._LINKING_TO_OUTGOING=2}linkResultDirectedEdges(){this.getResultAreaEdges();let t=null,e=null,i=this._SCANNING_FOR_INCOMING;for(let n=0;n<this._resultAreaEdgeList.size();n++){const r=this._resultAreaEdgeList.get(n),s=r.getSym();if(r.getLabel().isArea())switch(null===t&&r.isInResult()&&(t=r),i){case this._SCANNING_FOR_INCOMING:if(!s.isInResult())continue;e=s,i=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(!r.isInResult())continue;e.setNext(r),i=this._SCANNING_FOR_INCOMING}}if(i===this._LINKING_TO_OUTGOING){if(null===t)throw new hS("no outgoing dirEdge found",this.getCoordinate());Vv.isTrue(t.isInResult(),"unable to link last incoming dirEdge"),e.setNext(t)}}insert(t){const e=t;this.insertEdgeEnd(e,e)}getRightmostEdge(){const t=this.getEdges(),e=t.size();if(e<1)return null;const i=t.get(0);if(1===e)return i;const n=t.get(e-1),r=i.getQuadrant(),s=n.getQuadrant();return zS.isNorthern(r)&&zS.isNorthern(s)?i:zS.isNorthern(r)||zS.isNorthern(s)?0!==i.getDy()?i:0!==n.getDy()?n:(Vv.shouldNeverReachHere("found two horizontal edges incident on node"),null):n}print(t){XE.out.println("DirectedEdgeStar: "+this.getCoordinate());for(let e=this.iterator();e.hasNext();){const i=e.next();t.print("out "),i.print(t),t.println(),t.print("in "),i.getSym().print(t),t.println()}}getResultAreaEdges(){if(null!==this._resultAreaEdgeList)return this._resultAreaEdgeList;this._resultAreaEdgeList=new xE;for(let t=this.iterator();t.hasNext();){const e=t.next();(e.isInResult()||e.getSym().isInResult())&&this._resultAreaEdgeList.add(e)}return this._resultAreaEdgeList}updateLabelling(t){for(let e=this.iterator();e.hasNext();){const i=e.next().getLabel();i.setAllLocationsIfNull(0,t.getLocation(0)),i.setAllLocationsIfNull(1,t.getLocation(1))}}linkAllDirectedEdges(){this.getEdges();let t=null,e=null;for(let i=this._edgeList.size()-1;i>=0;i--){const n=this._edgeList.get(i),r=n.getSym();null===e&&(e=r),null!==t&&r.setNext(t),t=n}e.setNext(t)}computeDepths(){if(1===arguments.length){const t=arguments[0],e=this.findIndex(t),i=t.getDepth(sS.LEFT),n=t.getDepth(sS.RIGHT),r=this.computeDepths(e+1,this._edgeList.size(),i);if(this.computeDepths(0,e,r)!==n)throw new hS("depth mismatch at "+t.getCoordinate())}else if(3===arguments.length){const t=arguments[1];let e=arguments[2];for(let i=arguments[0];i<t;i++){const t=this._edgeList.get(i);t.setEdgeDepths(sS.RIGHT,e),e=t.getDepth(sS.LEFT)}return e}}mergeSymLabels(){for(let t=this.iterator();t.hasNext();){const e=t.next();e.getLabel().merge(e.getSym().getLabel())}}linkMinimalDirectedEdges(t){let e=null,i=null,n=this._SCANNING_FOR_INCOMING;for(let r=this._resultAreaEdgeList.size()-1;r>=0;r--){const s=this._resultAreaEdgeList.get(r),o=s.getSym();switch(null===e&&s.getEdgeRing()===t&&(e=s),n){case this._SCANNING_FOR_INCOMING:if(o.getEdgeRing()!==t)continue;i=o,n=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(s.getEdgeRing()!==t)continue;i.setNextMin(s),n=this._SCANNING_FOR_INCOMING}}n===this._LINKING_TO_OUTGOING&&(Vv.isTrue(null!==e,"found null for first outgoing dirEdge"),Vv.isTrue(e.getEdgeRing()===t,"unable to link last incoming dirEdge"),i.setNextMin(e))}getOutgoingDegree(){if(0===arguments.length){let t=0;for(let e=this.iterator();e.hasNext();)e.next().isInResult()&&t++;return t}if(1===arguments.length){const t=arguments[0];let e=0;for(let i=this.iterator();i.hasNext();)i.next().getEdgeRing()===t&&e++;return e}}getLabel(){return this._label}findCoveredLineEdges(){let t=rS.NONE;for(let e=this.iterator();e.hasNext();){const i=e.next(),n=i.getSym();if(!i.isLineEdge()){if(i.isInResult()){t=rS.INTERIOR;break}if(n.isInResult()){t=rS.EXTERIOR;break}}}if(t===rS.NONE)return null;let e=t;for(let t=this.iterator();t.hasNext();){const i=t.next(),n=i.getSym();i.isLineEdge()?i.getEdge().setCovered(e===rS.INTERIOR):(i.isInResult()&&(e=rS.EXTERIOR),n.isInResult()&&(e=rS.INTERIOR))}}computeLabelling(t){super.computeLabelling.call(this,t),this._label=new SS(rS.NONE);for(let t=this.iterator();t.hasNext();){const e=t.next().getEdge().getLabel();for(let t=0;t<2;t++){const i=e.getLocation(t);i!==rS.INTERIOR&&i!==rS.BOUNDARY||this._label.setLocation(t,rS.INTERIOR)}}}}class FI extends YS{constructor(){super()}createNode(t){return new RS(t,new OI)}}class zI{constructor(){zI.constructor_.apply(this,arguments)}static constructor_(){this._pts=null,this._orientation=null;const t=arguments[0];this._pts=t,this._orientation=zI.orientation(t)}static orientation(t){return 1===qE.increasingDirection(t)}static compareOriented(t,e,i,n){const r=e?1:-1,s=n?1:-1,o=e?t.length:-1,a=n?i.length:-1;let l=e?0:t.length-1,h=n?0:i.length-1;for(;;){const e=t[l].compareTo(i[h]);if(0!==e)return e;l+=r,h+=s;const n=l===o,c=h===a;if(n&&!c)return-1;if(!n&&c)return 1;if(n&&c)return 0}}compareTo(t){const e=t;return zI.compareOriented(this._pts,this._orientation,e._pts,e._orientation)}get interfaces_(){return[Bv]}}class BI{constructor(){BI.constructor_.apply(this,arguments)}static constructor_(){this._edges=new xE,this._ocaMap=new OS}print(t){t.print("MULTILINESTRING ( ");for(let e=0;e<this._edges.size();e++){const i=this._edges.get(e);e>0&&t.print(","),t.print("(");const n=i.getCoordinates();for(let e=0;e<n.length;e++)e>0&&t.print(","),t.print(n[e].x+" "+n[e].y);t.println(")")}t.print(")  ")}addAll(t){for(let e=t.iterator();e.hasNext();)this.add(e.next())}findEdgeIndex(t){for(let e=0;e<this._edges.size();e++)if(this._edges.get(e).equals(t))return e;return-1}iterator(){return this._edges.iterator()}getEdges(){return this._edges}get(t){return this._edges.get(t)}findEqualEdge(t){const e=new zI(t.getCoordinates());return this._ocaMap.get(e)}add(t){this._edges.add(t);const e=new zI(t.getCoordinates());this._ocaMap.put(e,t)}}class GI{processIntersections(t,e,i,n){}isDone(){}}class YI{constructor(){YI.constructor_.apply(this,arguments)}static constructor_(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._hasInterior=!1,this._properIntersectionPoint=null,this._li=null,this._isSelfIntersection=null,this.numIntersections=0,this.numInteriorIntersections=0,this.numProperIntersections=0,this.numTests=0;const t=arguments[0];this._li=t}static isAdjacentSegments(t,e){return 1===Math.abs(t-e)}isTrivialIntersection(t,e,i,n){if(t===i&&1===this._li.getIntersectionNum()){if(YI.isAdjacentSegments(e,n))return!0;if(t.isClosed()){const i=t.size()-1;if(0===e&&n===i||0===n&&e===i)return!0}}return!1}getProperIntersectionPoint(){return this._properIntersectionPoint}hasProperInteriorIntersection(){return this._hasProperInterior}getLineIntersector(){return this._li}hasProperIntersection(){return this._hasProper}processIntersections(t,e,i,n){if(t===i&&e===n)return null;this.numTests++;const r=t.getCoordinates()[e],s=t.getCoordinates()[e+1],o=i.getCoordinates()[n],a=i.getCoordinates()[n+1];this._li.computeIntersection(r,s,o,a),this._li.hasIntersection()&&(this.numIntersections++,this._li.isInteriorIntersection()&&(this.numInteriorIntersections++,this._hasInterior=!0),this.isTrivialIntersection(t,e,i,n)||(this._hasIntersection=!0,t.addIntersections(this._li,e,0),i.addIntersections(this._li,n,1),this._li.isProper()&&(this.numProperIntersections++,this._hasProper=!0,this._hasProperInterior=!0)))}hasIntersection(){return this._hasIntersection}isDone(){return!1}hasInteriorIntersection(){return this._hasInterior}get interfaces_(){return[GI]}}class UI{constructor(){UI.constructor_.apply(this,arguments)}static constructor_(){this.coord=null,this.segmentIndex=null,this.dist=null;const t=arguments[0],e=arguments[1],i=arguments[2];this.coord=new Hv(t),this.segmentIndex=e,this.dist=i}getSegmentIndex(){return this.segmentIndex}getCoordinate(){return this.coord}print(t){t.print(this.coord),t.print(" seg # = "+this.segmentIndex),t.println(" dist = "+this.dist)}compareTo(t){const e=t;return this.compare(e.segmentIndex,e.dist)}isEndPoint(t){return 0===this.segmentIndex&&0===this.dist||this.segmentIndex===t}toString(){return this.coord+" seg # = "+this.segmentIndex+" dist = "+this.dist}getDistance(){return this.dist}compare(t,e){return this.segmentIndex<t?-1:this.segmentIndex>t?1:this.dist<e?-1:this.dist>e?1:0}get interfaces_(){return[Bv]}}class XI{constructor(){XI.constructor_.apply(this,arguments)}static constructor_(){this._nodeMap=new OS,this.edge=null;const t=arguments[0];this.edge=t}print(t){t.println("Intersections:");for(let e=this.iterator();e.hasNext();)e.next().print(t)}iterator(){return this._nodeMap.values().iterator()}addSplitEdges(t){this.addEndpoints();const e=this.iterator();let i=e.next();for(;e.hasNext();){const n=e.next(),r=this.createSplitEdge(i,n);t.add(r),i=n}}addEndpoints(){const t=this.edge.pts.length-1;this.add(this.edge.pts[0],0,0),this.add(this.edge.pts[t],t,0)}createSplitEdge(t,e){let i=e.segmentIndex-t.segmentIndex+2;const n=this.edge.pts[e.segmentIndex],r=e.dist>0||!e.coord.equals2D(n);r||i--;const s=new Array(i).fill(null);let o=0;s[o++]=new Hv(t.coord);for(let i=t.segmentIndex+1;i<=e.segmentIndex;i++)s[o++]=this.edge.pts[i];return r&&(s[o]=e.coord),new HI(s,new SS(this.edge._label))}add(t,e,i){const n=new UI(t,e,i),r=this._nodeMap.get(n);return null!==r?r:(this._nodeMap.put(n,n),n)}isIntersection(t){for(let e=this.iterator();e.hasNext();)if(e.next().coord.equals(t))return!0;return!1}}class qI{constructor(){qI.constructor_.apply(this,arguments)}static constructor_(){if(this._matrix=null,0===arguments.length)this._matrix=Array(3).fill().map((()=>Array(3))),this.setAll(hE.FALSE);else if(1===arguments.length)if("string"==typeof arguments[0]){const t=arguments[0];qI.constructor_.call(this),this.set(t)}else if(arguments[0]instanceof qI){const t=arguments[0];qI.constructor_.call(this),this._matrix[rS.INTERIOR][rS.INTERIOR]=t._matrix[rS.INTERIOR][rS.INTERIOR],this._matrix[rS.INTERIOR][rS.BOUNDARY]=t._matrix[rS.INTERIOR][rS.BOUNDARY],this._matrix[rS.INTERIOR][rS.EXTERIOR]=t._matrix[rS.INTERIOR][rS.EXTERIOR],this._matrix[rS.BOUNDARY][rS.INTERIOR]=t._matrix[rS.BOUNDARY][rS.INTERIOR],this._matrix[rS.BOUNDARY][rS.BOUNDARY]=t._matrix[rS.BOUNDARY][rS.BOUNDARY],this._matrix[rS.BOUNDARY][rS.EXTERIOR]=t._matrix[rS.BOUNDARY][rS.EXTERIOR],this._matrix[rS.EXTERIOR][rS.INTERIOR]=t._matrix[rS.EXTERIOR][rS.INTERIOR],this._matrix[rS.EXTERIOR][rS.BOUNDARY]=t._matrix[rS.EXTERIOR][rS.BOUNDARY],this._matrix[rS.EXTERIOR][rS.EXTERIOR]=t._matrix[rS.EXTERIOR][rS.EXTERIOR]}}static matches(){if(Number.isInteger(arguments[0])&&"string"==typeof arguments[1]){const t=arguments[0],e=arguments[1];return e===hE.SYM_DONTCARE||e===hE.SYM_TRUE&&(t>=0||t===hE.TRUE)||e===hE.SYM_FALSE&&t===hE.FALSE||e===hE.SYM_P&&t===hE.P||e===hE.SYM_L&&t===hE.L||e===hE.SYM_A&&t===hE.A}if("string"==typeof arguments[0]&&"string"==typeof arguments[1]){const t=arguments[1];return new qI(arguments[0]).matches(t)}}static isTrue(t){return t>=0||t===hE.TRUE}isIntersects(){return!this.isDisjoint()}isCovers(){return(qI.isTrue(this._matrix[rS.INTERIOR][rS.INTERIOR])||qI.isTrue(this._matrix[rS.INTERIOR][rS.BOUNDARY])||qI.isTrue(this._matrix[rS.BOUNDARY][rS.INTERIOR])||qI.isTrue(this._matrix[rS.BOUNDARY][rS.BOUNDARY]))&&this._matrix[rS.EXTERIOR][rS.INTERIOR]===hE.FALSE&&this._matrix[rS.EXTERIOR][rS.BOUNDARY]===hE.FALSE}isCoveredBy(){return(qI.isTrue(this._matrix[rS.INTERIOR][rS.INTERIOR])||qI.isTrue(this._matrix[rS.INTERIOR][rS.BOUNDARY])||qI.isTrue(this._matrix[rS.BOUNDARY][rS.INTERIOR])||qI.isTrue(this._matrix[rS.BOUNDARY][rS.BOUNDARY]))&&this._matrix[rS.INTERIOR][rS.EXTERIOR]===hE.FALSE&&this._matrix[rS.BOUNDARY][rS.EXTERIOR]===hE.FALSE}set(){if(1===arguments.length){const t=arguments[0];for(let e=0;e<t.length;e++){const i=Math.trunc(e/3),n=e%3;this._matrix[i][n]=hE.toDimensionValue(t.charAt(e))}}else if(3===arguments.length){const t=arguments[0],e=arguments[1],i=arguments[2];this._matrix[t][e]=i}}isContains(){return qI.isTrue(this._matrix[rS.INTERIOR][rS.INTERIOR])&&this._matrix[rS.EXTERIOR][rS.INTERIOR]===hE.FALSE&&this._matrix[rS.EXTERIOR][rS.BOUNDARY]===hE.FALSE}setAtLeast(){if(1===arguments.length){const t=arguments[0];for(let e=0;e<t.length;e++){const i=Math.trunc(e/3),n=e%3;this.setAtLeast(i,n,hE.toDimensionValue(t.charAt(e)))}}else if(3===arguments.length){const t=arguments[0],e=arguments[1],i=arguments[2];this._matrix[t][e]<i&&(this._matrix[t][e]=i)}}setAtLeastIfValid(t,e,i){t>=0&&e>=0&&this.setAtLeast(t,e,i)}isWithin(){return qI.isTrue(this._matrix[rS.INTERIOR][rS.INTERIOR])&&this._matrix[rS.INTERIOR][rS.EXTERIOR]===hE.FALSE&&this._matrix[rS.BOUNDARY][rS.EXTERIOR]===hE.FALSE}isTouches(t,e){return t>e?this.isTouches(e,t):(t===hE.A&&e===hE.A||t===hE.L&&e===hE.L||t===hE.L&&e===hE.A||t===hE.P&&e===hE.A||t===hE.P&&e===hE.L)&&this._matrix[rS.INTERIOR][rS.INTERIOR]===hE.FALSE&&(qI.isTrue(this._matrix[rS.INTERIOR][rS.BOUNDARY])||qI.isTrue(this._matrix[rS.BOUNDARY][rS.INTERIOR])||qI.isTrue(this._matrix[rS.BOUNDARY][rS.BOUNDARY]))}isOverlaps(t,e){return t===hE.P&&e===hE.P||t===hE.A&&e===hE.A?qI.isTrue(this._matrix[rS.INTERIOR][rS.INTERIOR])&&qI.isTrue(this._matrix[rS.INTERIOR][rS.EXTERIOR])&&qI.isTrue(this._matrix[rS.EXTERIOR][rS.INTERIOR]):t===hE.L&&e===hE.L&&1===this._matrix[rS.INTERIOR][rS.INTERIOR]&&qI.isTrue(this._matrix[rS.INTERIOR][rS.EXTERIOR])&&qI.isTrue(this._matrix[rS.EXTERIOR][rS.INTERIOR])}isEquals(t,e){return t===e&&qI.isTrue(this._matrix[rS.INTERIOR][rS.INTERIOR])&&this._matrix[rS.INTERIOR][rS.EXTERIOR]===hE.FALSE&&this._matrix[rS.BOUNDARY][rS.EXTERIOR]===hE.FALSE&&this._matrix[rS.EXTERIOR][rS.INTERIOR]===hE.FALSE&&this._matrix[rS.EXTERIOR][rS.BOUNDARY]===hE.FALSE}toString(){const t=new VE("123456789");for(let e=0;e<3;e++)for(let i=0;i<3;i++)t.setCharAt(3*e+i,hE.toDimensionSymbol(this._matrix[e][i]));return t.toString()}setAll(t){for(let e=0;e<3;e++)for(let i=0;i<3;i++)this._matrix[e][i]=t}get(t,e){return this._matrix[t][e]}transpose(){let t=this._matrix[1][0];return this._matrix[1][0]=this._matrix[0][1],this._matrix[0][1]=t,t=this._matrix[2][0],this._matrix[2][0]=this._matrix[0][2],this._matrix[0][2]=t,t=this._matrix[2][1],this._matrix[2][1]=this._matrix[1][2],this._matrix[1][2]=t,this}matches(t){if(9!==t.length)throw new Ov("Should be length 9: "+t);for(let e=0;e<3;e++)for(let i=0;i<3;i++)if(!qI.matches(this._matrix[e][i],t.charAt(3*e+i)))return!1;return!0}add(t){for(let e=0;e<3;e++)for(let i=0;i<3;i++)this.setAtLeast(e,i,t.get(e,i))}isDisjoint(){return this._matrix[rS.INTERIOR][rS.INTERIOR]===hE.FALSE&&this._matrix[rS.INTERIOR][rS.BOUNDARY]===hE.FALSE&&this._matrix[rS.BOUNDARY][rS.INTERIOR]===hE.FALSE&&this._matrix[rS.BOUNDARY][rS.BOUNDARY]===hE.FALSE}isCrosses(t,e){return t===hE.P&&e===hE.L||t===hE.P&&e===hE.A||t===hE.L&&e===hE.A?qI.isTrue(this._matrix[rS.INTERIOR][rS.INTERIOR])&&qI.isTrue(this._matrix[rS.INTERIOR][rS.EXTERIOR]):t===hE.L&&e===hE.P||t===hE.A&&e===hE.P||t===hE.A&&e===hE.L?qI.isTrue(this._matrix[rS.INTERIOR][rS.INTERIOR])&&qI.isTrue(this._matrix[rS.EXTERIOR][rS.INTERIOR]):t===hE.L&&e===hE.L&&0===this._matrix[rS.INTERIOR][rS.INTERIOR]}get interfaces_(){return[Gv]}}class VI{constructor(){VI.constructor_.apply(this,arguments)}static constructor_(){if(this._data=null,this._size=0,0===arguments.length)VI.constructor_.call(this,10);else if(1===arguments.length){const t=arguments[0];this._data=new Array(t).fill(null)}}size(){return this._size}addAll(t){return null===t||0===t.length?null:(this.ensureCapacity(this._size+t.length),XE.arraycopy(t,0,this._data,this._size,t.length),void(this._size+=t.length))}ensureCapacity(t){if(t<=this._data.length)return null;const e=Math.max(t,2*this._data.length);this._data=vE.copyOf(this._data,e)}toArray(){const t=new Array(this._size).fill(null);return XE.arraycopy(this._data,0,t,0,this._size),t}add(t){this.ensureCapacity(this._size+1),this._data[this._size]=t,++this._size}}class jI{static toIntArray(t){const e=new Array(t.size()).fill(null);for(let i=0;i<e.length;i++)e[i]=t.get(i).intValue();return e}getChainStartIndices(t){let e=0;const i=new VI(Math.trunc(t.length/2));i.add(e);do{const n=this.findChainEnd(t,e);i.add(n),e=n}while(e<t.length-1);return i.toArray()}findChainEnd(t,e){const i=zS.quadrant(t[e],t[e+1]);let n=e+1;for(;n<t.length&&zS.quadrant(t[n-1],t[n])===i;)n++;return n-1}OLDgetChainStartIndices(t){let e=0;const i=new xE;i.add(e);do{const n=this.findChainEnd(t,e);i.add(n),e=n}while(e<t.length-1);return jI.toIntArray(i)}}class WI{constructor(){WI.constructor_.apply(this,arguments)}static constructor_(){this.e=null,this.pts=null,this.startIndex=null;const t=arguments[0];this.e=t,this.pts=t.getCoordinates();const e=new jI;this.startIndex=e.getChainStartIndices(this.pts)}getCoordinates(){return this.pts}getMaxX(t){const e=this.pts[this.startIndex[t]].x,i=this.pts[this.startIndex[t+1]].x;return e>i?e:i}getMinX(t){const e=this.pts[this.startIndex[t]].x,i=this.pts[this.startIndex[t+1]].x;return e<i?e:i}computeIntersectsForChain(){if(4===arguments.length){const t=arguments[0],e=arguments[1],i=arguments[2],n=arguments[3];this.computeIntersectsForChain(this.startIndex[t],this.startIndex[t+1],e,e.startIndex[i],e.startIndex[i+1],n)}else if(6===arguments.length){const t=arguments[0],e=arguments[1],i=arguments[2],n=arguments[3],r=arguments[4],s=arguments[5];if(e-t==1&&r-n==1)return s.addIntersections(this.e,t,i.e,n),null;if(!this.overlaps(t,e,i,n,r))return null;const o=Math.trunc((t+e)/2),a=Math.trunc((n+r)/2);t<o&&(n<a&&this.computeIntersectsForChain(t,o,i,n,a,s),a<r&&this.computeIntersectsForChain(t,o,i,a,r,s)),o<e&&(n<a&&this.computeIntersectsForChain(o,e,i,n,a,s),a<r&&this.computeIntersectsForChain(o,e,i,a,r,s))}}overlaps(t,e,i,n,r){return eE.intersects(this.pts[t],this.pts[e],i.pts[n],i.pts[r])}getStartIndexes(){return this.startIndex}computeIntersects(t,e){for(let i=0;i<this.startIndex.length-1;i++)for(let n=0;n<t.startIndex.length-1;n++)this.computeIntersectsForChain(i,t,n,e)}}class ZI{constructor(){ZI.constructor_.apply(this,arguments)}static constructor_(){this._depth=Array(2).fill().map((()=>Array(3)));for(let t=0;t<2;t++)for(let e=0;e<3;e++)this._depth[t][e]=ZI.NULL_VALUE}static depthAtLocation(t){return t===rS.EXTERIOR?0:t===rS.INTERIOR?1:ZI.NULL_VALUE}getDepth(t,e){return this._depth[t][e]}setDepth(t,e,i){this._depth[t][e]=i}isNull(){if(0===arguments.length){for(let t=0;t<2;t++)for(let e=0;e<3;e++)if(this._depth[t][e]!==ZI.NULL_VALUE)return!1;return!0}if(1===arguments.length){const t=arguments[0];return this._depth[t][1]===ZI.NULL_VALUE}if(2===arguments.length){const t=arguments[0],e=arguments[1];return this._depth[t][e]===ZI.NULL_VALUE}}normalize(){for(let t=0;t<2;t++)if(!this.isNull(t)){let e=this._depth[t][1];this._depth[t][2]<e&&(e=this._depth[t][2]),e<0&&(e=0);for(let i=1;i<3;i++){let n=0;this._depth[t][i]>e&&(n=1),this._depth[t][i]=n}}}getDelta(t){return this._depth[t][sS.RIGHT]-this._depth[t][sS.LEFT]}getLocation(t,e){return this._depth[t][e]<=0?rS.EXTERIOR:rS.INTERIOR}toString(){return"A: "+this._depth[0][1]+","+this._depth[0][2]+" B: "+this._depth[1][1]+","+this._depth[1][2]}add(){if(1===arguments.length){const t=arguments[0];for(let e=0;e<2;e++)for(let i=1;i<3;i++){const n=t.getLocation(e,i);n!==rS.EXTERIOR&&n!==rS.INTERIOR||(this.isNull(e,i)?this._depth[e][i]=ZI.depthAtLocation(n):this._depth[e][i]+=ZI.depthAtLocation(n))}}else if(3===arguments.length){const t=arguments[0],e=arguments[1];arguments[2]===rS.INTERIOR&&this._depth[t][e]++}}}ZI.NULL_VALUE=-1;class HI extends TS{constructor(){super(),HI.constructor_.apply(this,arguments)}static constructor_(){if(this.pts=null,this._env=null,this.eiList=new XI(this),this._name=null,this._mce=null,this._isIsolated=!0,this._depth=new ZI,this._depthDelta=0,1===arguments.length){const t=arguments[0];HI.constructor_.call(this,t,null)}else if(2===arguments.length){const t=arguments[0],e=arguments[1];this.pts=t,this._label=e}}static updateIM(){if(!(2===arguments.length&&arguments[1]instanceof qI&&arguments[0]instanceof SS))return super.updateIM.apply(this,arguments);{const t=arguments[0],e=arguments[1];e.setAtLeastIfValid(t.getLocation(0,sS.ON),t.getLocation(1,sS.ON),1),t.isArea()&&(e.setAtLeastIfValid(t.getLocation(0,sS.LEFT),t.getLocation(1,sS.LEFT),2),e.setAtLeastIfValid(t.getLocation(0,sS.RIGHT),t.getLocation(1,sS.RIGHT),2))}}getDepth(){return this._depth}getCollapsedEdge(){const t=new Array(2).fill(null);return t[0]=this.pts[0],t[1]=this.pts[1],new HI(t,SS.toLineLabel(this._label))}isIsolated(){return this._isIsolated}getCoordinates(){return this.pts}setIsolated(t){this._isIsolated=t}setName(t){this._name=t}equals(t){if(!(t instanceof HI))return!1;const e=t;if(this.pts.length!==e.pts.length)return!1;let i=!0,n=!0,r=this.pts.length;for(let t=0;t<this.pts.length;t++)if(this.pts[t].equals2D(e.pts[t])||(i=!1),this.pts[t].equals2D(e.pts[--r])||(n=!1),!i&&!n)return!1;return!0}getCoordinate(){if(0===arguments.length)return this.pts.length>0?this.pts[0]:null;if(1===arguments.length){const t=arguments[0];return this.pts[t]}}print(t){t.print("edge "+this._name+": "),t.print("LINESTRING (");for(let e=0;e<this.pts.length;e++)e>0&&t.print(","),t.print(this.pts[e].x+" "+this.pts[e].y);t.print(")  "+this._label+" "+this._depthDelta)}computeIM(t){HI.updateIM(this._label,t)}isCollapsed(){return!!this._label.isArea()&&3===this.pts.length&&!!this.pts[0].equals(this.pts[2])}isClosed(){return this.pts[0].equals(this.pts[this.pts.length-1])}getMaximumSegmentIndex(){return this.pts.length-1}getDepthDelta(){return this._depthDelta}getNumPoints(){return this.pts.length}printReverse(t){t.print("edge "+this._name+": ");for(let e=this.pts.length-1;e>=0;e--)t.print(this.pts[e]+" ");t.println("")}getMonotoneChainEdge(){return null===this._mce&&(this._mce=new WI(this)),this._mce}getEnvelope(){if(null===this._env){this._env=new eE;for(let t=0;t<this.pts.length;t++)this._env.expandToInclude(this.pts[t])}return this._env}addIntersection(t,e,i,n){const r=new Hv(t.getIntersection(n));let s=e,o=t.getEdgeDistance(i,n);const a=s+1;if(a<this.pts.length){const t=this.pts[a];r.equals2D(t)&&(s=a,o=0)}this.eiList.add(r,s,o)}toString(){const t=new VE;t.append("edge "+this._name+": "),t.append("LINESTRING (");for(let e=0;e<this.pts.length;e++)e>0&&t.append(","),t.append(this.pts[e].x+" "+this.pts[e].y);return t.append(")  "+this._label+" "+this._depthDelta),t.toString()}isPointwiseEqual(t){if(this.pts.length!==t.pts.length)return!1;for(let e=0;e<this.pts.length;e++)if(!this.pts[e].equals2D(t.pts[e]))return!1;return!0}setDepthDelta(t){this._depthDelta=t}getEdgeIntersectionList(){return this.eiList}addIntersections(t,e,i){for(let n=0;n<t.getIntersectionNum();n++)this.addIntersection(t,e,i,n)}}class KI{constructor(){KI.constructor_.apply(this,arguments)}static constructor_(){this._bufParams=null,this._workingPrecisionModel=null,this._workingNoder=null,this._geomFact=null,this._graph=null,this._edgeList=new BI;const t=arguments[0];this._bufParams=t}static depthDelta(t){const e=t.getLocation(0,sS.LEFT),i=t.getLocation(0,sS.RIGHT);return e===rS.INTERIOR&&i===rS.EXTERIOR?1:e===rS.EXTERIOR&&i===rS.INTERIOR?-1:0}static convertSegStrings(t){const e=new eS,i=new xE;for(;t.hasNext();){const n=t.next(),r=e.createLineString(n.getCoordinates());i.add(r)}return e.buildGeometry(i)}setWorkingPrecisionModel(t){this._workingPrecisionModel=t}insertUniqueEdge(t){const e=this._edgeList.findEqualEdge(t);if(null!==e){const i=e.getLabel();let n=t.getLabel();e.isPointwiseEqual(t)||(n=new SS(t.getLabel()),n.flip()),i.merge(n);const r=KI.depthDelta(n),s=e.getDepthDelta()+r;e.setDepthDelta(s)}else this._edgeList.add(t),t.setDepthDelta(KI.depthDelta(t.getLabel()))}buildSubgraphs(t,e){const i=new xE;for(let n=t.iterator();n.hasNext();){const t=n.next(),r=t.getRightmostCoordinate(),s=new II(i).getDepth(r);t.computeDepth(s),t.findResultEdges(),i.add(t),e.add(t.getDirectedEdges(),t.getNodes())}}createSubgraphs(t){const e=new xE;for(let i=t.getNodes().iterator();i.hasNext();){const t=i.next();if(!t.isVisited()){const i=new uS;i.create(t),e.add(i)}}return KS.sort(e,KS.reverseOrder()),e}createEmptyResultGeometry(){return this._geomFact.createPolygon()}getNoder(t){if(null!==this._workingNoder)return this._workingNoder;const e=new _I,i=new xS;return i.setPrecisionModel(t),e.setSegmentIntersector(new YI(i)),e}buffer(t,e){let i=this._workingPrecisionModel;null===i&&(i=t.getPrecisionModel()),this._geomFact=t.getFactory();const n=new SI(i,this._bufParams),r=new AI(t,e,n).getCurves();if(r.size()<=0)return this.createEmptyResultGeometry();this.computeNodedEdges(r,i),this._graph=new US(new FI),this._graph.addEdges(this._edgeList.getEdges());const s=this.createSubgraphs(this._graph),o=new XS(this._geomFact);this.buildSubgraphs(s,o);const a=o.getPolygons();return a.size()<=0?this.createEmptyResultGeometry():this._geomFact.buildGeometry(a)}computeNodedEdges(t,e){const i=this.getNoder(e);i.computeNodes(t);for(let t=i.getNodedSubstrings().iterator();t.hasNext();){const e=t.next(),i=e.getCoordinates();if(2===i.length&&i[0].equals2D(i[1]))continue;const n=e.getData(),r=new HI(e.getCoordinates(),new SS(n));this.insertUniqueEdge(r)}}setNoder(t){this._workingNoder=t}}let $I=0;function JI(t){const e=new dv({features:new Lv({dataProjection:"EPSG:3857"}).readFeatures(t)});let i=new Jb;if("lines"===t.name){let t=[];e.forEachFeature((e=>{let i=e.getGeometry().simplify(3),n=new cb({geometry:i});t.push(n)}));let n=new dv({features:t});i.setSource(n),$I=t.length}else $I=t.features.length,i.setSource(e);return"junctions"===t.name&&i.setStyle(new Or({image:new Br({src:"https://maps.google.com/mapfiles/kml/paddle/red-blank.png",anchor:[.5,1],scale:.5})})),i}function QI(t,e){const i=new dv({features:new Lv({dataProjection:"EPSG:3857"}).readFeatures(t)});new dv({features:new Lv({dataProjection:"EPSG:3857"}).readFeatures(e)}),i.forEachFeature((t=>{let e=t.getGeometry();(new nS).convertFromLineString(e),(new KI).buffer(e,50)}))}let tM=new class{constructor(){let t=new qx;this.OSM_Standard=new Bx,this.Bing_RoadsOnDemand=new Gx({key:t.apikeys.BingMapKey,imagerySet:"RoadOnDemand"}),this.ArcGIS_sample=new Ux({url:`https://basemapstyles-api.arcgis.com/arcgis/rest/services/styles/v2/styles/arcgis/streets?token=${t.apikeys.ArcGISKey}`,crossOrigin:"Anonymous"}),this.EsriXYZ=new zx({attributions:'Tiles  <a href="https://services.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer">ArcGIS</a>',url:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer/tile/{z}/{y}/{x}",maxZoom:19,crossOrigin:"Anonymous"}),this.EsriMaps=new zx({url:"https://services.arcgisonline.com/arcgis/rest/services/World_Topo_Map/MapServer/MapServer/tile/{z}/{y}/{x}"}),this.ESALULC=new Xx({url:"https://services.terrascope.be/wmts/v2",layer:"WORLDCOVER_2020_MAP",matrixSet:"EPSG:3857",format:"image/png",projection:jx,tileGrid:new Vx({origin:se(Wx),resolutions:Hx,matrixIds:Kx})}),this.BhuvanLULC=new Xx({url:"https://bhuvan-vec2.nrsc.gov.in/bhuvan/gwc/service/wmts/",version:"1.0.0",format:"image/png"})}};const eM=document.getElementById("imgCanvas1"),iM=document.getElementById("imgCanvas2"),nM=eM.getContext("2d",{willReadFrequently:!0}),rM=iM.getContext("2d",{willReadFrequently:!0});var sM=document.createElement("canvas"),oM=document.createElement("canvas");sM.getContext("2d"),oM.getContext("2d"),new tx,new tx;const aM=document.getElementById("processImgBtn"),lM=document.getElementById("vectorizeBtn"),hM=document.getElementById("compareBtn"),cM=document.getElementById("downloadVector"),uM=document.getElementById("imageCov"),dM=document.getElementById("extentBox"),gM=document.getElementById("zoomLevel"),fM=document.getElementById("FeatureType"),pM=document.getElementById("SelectionType"),mM=document.getElementById("MapType1"),_M=document.getElementById("MapType2"),yM=document.getElementById("processOptions");let wM,xM,bM,vM,EM,SM,IM,MM,CM=!1,TM=!1,RM=!1,AM=!1,kM=!1,PM=!1,LM="YIQ";aM.addEventListener("click",(t=>{if("1"===fM.value)alert("Choose a feature type from drop down");else if("2"===fM.value){if(!0===CM){let t=nM.getImageData(0,0,eM.width,eM.height);wM=Da(t,eM),RM=!0}if(!0===TM){let t=rM.getImageData(0,0,iM.width,iM.height);xM=Da(t,iM),AM=!0}}else if("3"===fM.value){if(!0===CM){let t=parseInt(sessionStorage.getItem("ER_KER_SIZ_1")),e=parseInt(sessionStorage.getItem("ER_ITER_1")),i=nM.getImageData(0,0,eM.width,eM.height);bM=Fa(i,t,e),RM=!0,nM.putImageData(bM,0,0)}if(!0===TM){let t=parseInt(sessionStorage.getItem("ER_KER_SIZ_2")),e=parseInt(sessionStorage.getItem("ER_ITER_2")),i=rM.getImageData(0,0,iM.width,iM.height);vM=Fa(i,t,e),AM=!0,rM.putImageData(vM,0,0)}}})),lM.addEventListener("click",(t=>{if("2"===fM.value){if(!0===RM){let t=IM.getView().calculateExtent(IM.getSize());EM=dx(wM,eM.width,eM.height,t),kM=!0;let e=JI(EM);IM.addLayer(e),RM=!1,console.log(IM.getLayers())}else alert("Process image from map1 before vectorizing");if(!0===AM){let t=MM.getView().calculateExtent(MM.getSize());SM=dx(xM,iM.width,iM.height,t),PM=!0;let e=JI(SM);IM.addLayer(e),AM=!1}}else if("3"===fM.value){if(!0===RM){let t=IM.getView().calculateExtent(IM.getSize()),e=ob(bM.data,300,300,t);EM=e[0],kM=!0;let i=JI(EM),n=JI(e[1]);IM.addLayer(i),IM.addLayer(n),QI(e[0],e[1]),nM.putImageData(e[2],0,0),RM=!1,nb(yM)}else alert("Process image from map1 before vectorizing");if(!0===AM){let t=MM.getView().calculateExtent(MM.getSize()),e=ob(vM.data,300,300,t);SM=e[0],PM=!0;let i=JI(SM),n=JI(e[1]);MM.addLayer(i),MM.addLayer(n),QI(e[0],e[1]),rM.putImageData(e[2],0,0),AM=!1,nb(yM)}else alert("Process image from map1 before vectorizing")}})),cM.addEventListener("click",(t=>{var e,i;!0===kM?(e=JSON.stringify(EM),(i=document.createElement("a")).setAttribute("href","data:application/json;charset=utf-8, "+encodeURIComponent(e)),i.setAttribute("download","layer.geojson"),document.body.appendChild(i),i.click(),document.body.removeChild(i)):alert("Generate vector file before downloading")})),uM.addEventListener("click",(t=>{if(!0===CM&&!0===CM){let t=nM.getImageData(0,0,eM.width,eM.height),e=rM.getImageData(0,0,iM.width,iM.height);Oa(t),Oa(e);let i=nM.getImageData(0,0,eM.width,eM.height),n=rM.getImageData(0,0,iM.width,iM.height);console.log(i,n),function(t,e){let i=eu(t.data),n=eu(e.data),r=new Array(i.length),s=new Array(n.length);for(let t=0;t<i.length;t++)i[t][0]&&i[t][1]&&255===i[t][2]?r[t]=255:r[t]=0;for(let t=0;t<n.length;t++)n[t][0]&&n[t][1]&&255===n[t][2]?s[t]=255:s[t]=0;let o=[r,s],a=o.length,l=new Array(a*a);for(let t=0;t<a;t++)for(let e=0;e<a;e++){let i=0,n=o[t],r=o[e],s=n.length,a=n.reduce(((t,e)=>t+e))/s,h=r.reduce(((t,e)=>t+e))/s;for(let t=0;t<s;t++)i+=(n[t]-a)*(r[t]-h)/s;l.push(i)}let h=Math.min(...l),c=Math.max(...l);console.log(h,c,l)}(i,n)}else alert("Select features from both maps")})),hM.addEventListener("click",(t=>{}));let NM={1:tM.OSM_Standard,2:tM.Bing_RoadsOnDemand,3:tM.EsriXYZ,4:tM.ArcGIS_sample,5:tM.EsriMaps,6:tM.ESALULC};!function(t,e){fM.addEventListener("change",(t=>{"1"===fM.value?nb(yM):"2"===fM.value?(nb(yM),function(t){Jx.append(Qx,tb,eb),t.append(Jx)}(yM)):"3"===fM.value&&(nb(yM),function(t){let e=ib("ER_KER_SIZ_1",3,""),i=ib("ER_ITER_1",3,""),n=ib("WIN_MIN_SIZ_1",25,""),r=ib("WIN_MAX_SIZ_1",31,""),s=ib("ER_KER_SIZ_2",3,""),o=ib("ER_ITER_2",3,""),a=ib("WIN_MIN_SIZ_2",25,""),l=ib("WIN_MAX_SIZ_2",31,"");Jx.append(Qx,tb,e,i,n,r,eb,s,o,a,l),t.append(Jx)}(yM))})),pM.addEventListener("change",(t=>{"1"===pM.value?LM="YIQ":"2"===pM.value&&(LM="RG")}));const i=new tn({center:[8687373.06,3544749.53],zoom:13,constrainResolution:!0});IM=new Ko({layers:[new ya({source:t})],view:i,target:"map1"}),MM=new Ko({layers:[new ya({source:e})],view:i,target:"map2"}),dM.textContent="Extent: "+IM.getView().calculateExtent(IM.getSize()),gM.textContent="Zoom Level: "+IM.getView().getZoom(),IM.on("moveend",(t=>{$x(IM,eM,nM),!0===kM&&(wM=void 0,EM=void 0,kM=!1),dM.textContent="Extent: "+IM.getView().calculateExtent(IM.getSize()),gM.textContent="Zoom Level: "+IM.getView().getZoom()})),MM.on("moveend",(t=>{$x(MM,iM,rM),!0===PM&&(xM=void 0,SM=void 0,PM=!1)})),IM.on("click",(t=>{let e,i=nM.getImageData(0,0,eM.width,eM.height);if("YIQ"===LM)e=lx(i,iu(t.pixel,i.data,300),0),nM.putImageData(e,0,0);else if("RG"===LM){let n=rb(i,{delta:20,pixel:t.pixel});e=new ImageData(n.data,300,300),nM.putImageData(e,0,0)}CM=!0})),MM.on("click",(t=>{let e,i=rM.getImageData(0,0,iM.width,iM.height);if("YIQ"===LM)e=lx(i,iu(t.pixel,i.data,300),0),rM.putImageData(e,0,0);else if("RG"===LM){let n=rb(i,{delta:20,pixel:t.pixel});e=new ImageData(n.data,300,300),rM.putImageData(e,0,0)}TM=!0}))}(NM[1],NM[2]),mM.addEventListener("change",(t=>{})),_M.addEventListener("change",(t=>{}))})()})();