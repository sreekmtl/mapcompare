(()=>{var __webpack_modules__={8874:t=>{"use strict";t.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},1788:(t,e,i)=>{"use strict";i.d(e,{Z:()=>a});var n=i(8081),r=i.n(n),s=i(3645),o=i.n(s)()(r());o.push([t.id,':root,\n:host {\n  --ol-background-color: white;\n  --ol-accent-background-color: #F5F5F5;\n  --ol-subtle-background-color: rgba(128, 128, 128, 0.25);\n  --ol-partial-background-color: rgba(255, 255, 255, 0.75);\n  --ol-foreground-color: #333333;\n  --ol-subtle-foreground-color: #666666;\n  --ol-brand-color: #00AAFF;\n}\n\n.ol-box {\n  box-sizing: border-box;\n  border-radius: 2px;\n  border: 1.5px solid var(--ol-background-color);\n  background-color: var(--ol-partial-background-color);\n}\n\n.ol-mouse-position {\n  top: 8px;\n  right: 8px;\n  position: absolute;\n}\n\n.ol-scale-line {\n  background: var(--ol-partial-background-color);\n  border-radius: 4px;\n  bottom: 8px;\n  left: 8px;\n  padding: 2px;\n  position: absolute;\n}\n\n.ol-scale-line-inner {\n  border: 1px solid var(--ol-subtle-foreground-color);\n  border-top: none;\n  color: var(--ol-foreground-color);\n  font-size: 10px;\n  text-align: center;\n  margin: 1px;\n  will-change: contents, width;\n  transition: all 0.25s;\n}\n\n.ol-scale-bar {\n  position: absolute;\n  bottom: 8px;\n  left: 8px;\n}\n\n.ol-scale-bar-inner {\n  display: flex;\n}\n\n.ol-scale-step-marker {\n  width: 1px;\n  height: 15px;\n  background-color: var(--ol-foreground-color);\n  float: right;\n  z-index: 10;\n}\n\n.ol-scale-step-text {\n  position: absolute;\n  bottom: -5px;\n  font-size: 10px;\n  z-index: 11;\n  color: var(--ol-foreground-color);\n  text-shadow: -1.5px 0 var(--ol-partial-background-color), 0 1.5px var(--ol-partial-background-color), 1.5px 0 var(--ol-partial-background-color), 0 -1.5px var(--ol-partial-background-color);\n}\n\n.ol-scale-text {\n  position: absolute;\n  font-size: 12px;\n  text-align: center;\n  bottom: 25px;\n  color: var(--ol-foreground-color);\n  text-shadow: -1.5px 0 var(--ol-partial-background-color), 0 1.5px var(--ol-partial-background-color), 1.5px 0 var(--ol-partial-background-color), 0 -1.5px var(--ol-partial-background-color);\n}\n\n.ol-scale-singlebar {\n  position: relative;\n  height: 10px;\n  z-index: 9;\n  box-sizing: border-box;\n  border: 1px solid var(--ol-foreground-color);\n}\n\n.ol-scale-singlebar-even {\n  background-color: var(--ol-subtle-foreground-color);\n}\n\n.ol-scale-singlebar-odd {\n  background-color: var(--ol-background-color);\n}\n\n.ol-unsupported {\n  display: none;\n}\n\n.ol-viewport,\n.ol-unselectable {\n  -webkit-touch-callout: none;\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  user-select: none;\n  -webkit-tap-highlight-color: transparent;\n}\n\n.ol-viewport canvas {\n  all: unset;\n  overflow: hidden;\n}\n\n.ol-viewport {\n  touch-action: pan-x pan-y;\n}\n\n.ol-selectable {\n  -webkit-touch-callout: default;\n  -webkit-user-select: text;\n  -moz-user-select: text;\n  user-select: text;\n}\n\n.ol-grabbing {\n  cursor: -webkit-grabbing;\n  cursor: -moz-grabbing;\n  cursor: grabbing;\n}\n\n.ol-grab {\n  cursor: move;\n  cursor: -webkit-grab;\n  cursor: -moz-grab;\n  cursor: grab;\n}\n\n.ol-control {\n  position: absolute;\n  background-color: var(--ol-subtle-background-color);\n  border-radius: 4px;\n}\n\n.ol-zoom {\n  top: .5em;\n  left: .5em;\n}\n\n.ol-rotate {\n  top: .5em;\n  right: .5em;\n  transition: opacity .25s linear, visibility 0s linear;\n}\n\n.ol-rotate.ol-hidden {\n  opacity: 0;\n  visibility: hidden;\n  transition: opacity .25s linear, visibility 0s linear .25s;\n}\n\n.ol-zoom-extent {\n  top: 4.643em;\n  left: .5em;\n}\n\n.ol-full-screen {\n  right: .5em;\n  top: .5em;\n}\n\n.ol-control button {\n  display: block;\n  margin: 1px;\n  padding: 0;\n  color: var(--ol-subtle-foreground-color);\n  font-weight: bold;\n  text-decoration: none;\n  font-size: inherit;\n  text-align: center;\n  height: 1.375em;\n  width: 1.375em;\n  line-height: .4em;\n  background-color: var(--ol-background-color);\n  border: none;\n  border-radius: 2px;\n}\n\n.ol-control button::-moz-focus-inner {\n  border: none;\n  padding: 0;\n}\n\n.ol-zoom-extent button {\n  line-height: 1.4em;\n}\n\n.ol-compass {\n  display: block;\n  font-weight: normal;\n  will-change: transform;\n}\n\n.ol-touch .ol-control button {\n  font-size: 1.5em;\n}\n\n.ol-touch .ol-zoom-extent {\n  top: 5.5em;\n}\n\n.ol-control button:hover,\n.ol-control button:focus {\n  text-decoration: none;\n  outline: 1px solid var(--ol-subtle-foreground-color);\n  color: var(--ol-foreground-color);\n}\n\n.ol-zoom .ol-zoom-in {\n  border-radius: 2px 2px 0 0;\n}\n\n.ol-zoom .ol-zoom-out {\n  border-radius: 0 0 2px 2px;\n}\n\n.ol-attribution {\n  text-align: right;\n  bottom: .5em;\n  right: .5em;\n  max-width: calc(100% - 1.3em);\n  display: flex;\n  flex-flow: row-reverse;\n  align-items: center;\n}\n\n.ol-attribution a {\n  color: var(--ol-subtle-foreground-color);\n  text-decoration: none;\n}\n\n.ol-attribution ul {\n  margin: 0;\n  padding: 1px .5em;\n  color: var(--ol-foreground-color);\n  text-shadow: 0 0 2px var(--ol-background-color);\n  font-size: 12px;\n}\n\n.ol-attribution li {\n  display: inline;\n  list-style: none;\n}\n\n.ol-attribution li:not(:last-child):after {\n  content: " ";\n}\n\n.ol-attribution img {\n  max-height: 2em;\n  max-width: inherit;\n  vertical-align: middle;\n}\n\n.ol-attribution button {\n  flex-shrink: 0;\n}\n\n.ol-attribution.ol-collapsed ul {\n  display: none;\n}\n\n.ol-attribution:not(.ol-collapsed) {\n  background: var(--ol-partial-background-color);\n}\n\n.ol-attribution.ol-uncollapsible {\n  bottom: 0;\n  right: 0;\n  border-radius: 4px 0 0;\n}\n\n.ol-attribution.ol-uncollapsible img {\n  margin-top: -.2em;\n  max-height: 1.6em;\n}\n\n.ol-attribution.ol-uncollapsible button {\n  display: none;\n}\n\n.ol-zoomslider {\n  top: 4.5em;\n  left: .5em;\n  height: 200px;\n}\n\n.ol-zoomslider button {\n  position: relative;\n  height: 10px;\n}\n\n.ol-touch .ol-zoomslider {\n  top: 5.5em;\n}\n\n.ol-overviewmap {\n  left: 0.5em;\n  bottom: 0.5em;\n}\n\n.ol-overviewmap.ol-uncollapsible {\n  bottom: 0;\n  left: 0;\n  border-radius: 0 4px 0 0;\n}\n\n.ol-overviewmap .ol-overviewmap-map,\n.ol-overviewmap button {\n  display: block;\n}\n\n.ol-overviewmap .ol-overviewmap-map {\n  border: 1px solid var(--ol-subtle-foreground-color);\n  height: 150px;\n  width: 150px;\n}\n\n.ol-overviewmap:not(.ol-collapsed) button {\n  bottom: 0;\n  left: 0;\n  position: absolute;\n}\n\n.ol-overviewmap.ol-collapsed .ol-overviewmap-map,\n.ol-overviewmap.ol-uncollapsible button {\n  display: none;\n}\n\n.ol-overviewmap:not(.ol-collapsed) {\n  background: var(--ol-subtle-background-color);\n}\n\n.ol-overviewmap-box {\n  border: 1.5px dotted var(--ol-subtle-foreground-color);\n}\n\n.ol-overviewmap .ol-overviewmap-box:hover {\n  cursor: move;\n}\n',""]);const a=o},1828:(t,e,i)=>{"use strict";i.d(e,{Z:()=>a});var n=i(8081),r=i.n(n),s=i(3645),o=i.n(s)()(r());o.push([t.id,'* {\n    box-sizing: border-box;\n  }\n.column {\n    float: left;\n    width: 30%;\n    height: 680px; /* Should be removed. Only for demonstration */\n}\n  \n  /* Clear floats after the columns */\n  .row:after {\n    content: "";\n    display: table;\n    clear: both;\n}\n\n\n\np{\n    color: #000000;\n    font-family: monospace;\n    font-size: medium;\n    padding-left: 10px;\n  \n}\n\nh3{\n\n    color: #000000;\n    font-family: monospace;\n    font-size: large;\n    font-weight: bold;\n    padding-left: 10px;\n\n}\n\n\ninput[type="text"] {\n  width:300px;\n  color: #000000;\n  font-family: monospace;\n  font-size: large;\n  padding-left: 20px;\n}\n\nbutton{\n  font-family:monospace;\n  font-size: 12px;\n}\n\nlabel{\n  font-family:monospace;\n}\n\nselect{\n  font-family:monospace;\n}\n\n.article{\n  color: white;\n}',""]);const a=o},3645:t=>{"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var i="",n=void 0!==e[5];return e[4]&&(i+="@supports (".concat(e[4],") {")),e[2]&&(i+="@media ".concat(e[2]," {")),n&&(i+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),i+=t(e),n&&(i+="}"),e[2]&&(i+="}"),e[4]&&(i+="}"),i})).join("")},e.i=function(t,i,n,r,s){"string"==typeof t&&(t=[[null,t,void 0]]);var o={};if(n)for(var a=0;a<this.length;a++){var h=this[a][0];null!=h&&(o[h]=!0)}for(var l=0;l<t.length;l++){var c=[].concat(t[l]);n&&o[c[0]]||(void 0!==s&&(void 0===c[5]||(c[1]="@layer".concat(c[5].length>0?" ".concat(c[5]):""," {").concat(c[1],"}")),c[5]=s),i&&(c[2]?(c[1]="@media ".concat(c[2]," {").concat(c[1],"}"),c[2]=i):c[2]=i),r&&(c[4]?(c[1]="@supports (".concat(c[4],") {").concat(c[1],"}"),c[4]=r):c[4]="".concat(r)),e.push(c))}},e}},8081:t=>{"use strict";t.exports=function(t){return t[1]}},7060:(t,e,i)=>{"use strict";const{IOBuffer:n}=i(2155),r=i(5578),s=[];for(let t=0;t<=8;t++)s.push(255<<t);t.exports=class extends n{constructor(t){if(1!==t.bitDepth)throw new Error("Only bitDepth of 1 is supported");if(!t.height||!t.width)throw new Error("ImageData width and height are required");super(t.data),this.width=t.width,this.height=t.height,this.bitDepth=t.bitDepth,this.channels=t.channels,this.components=t.components}encode(){this.encoded=new n,this.encoded.skip(14),this.writeBitmapV5Header(),this.writeColorTable();const t=this.encoded.offset;return this.writePixelArray(),this.encoded.rewind(),this.writeBitmapFileHeader(t),this.encoded.toArray()}writePixelArray(){let t=this.encoded;const e=4*Math.floor((this.bitDepth*this.width+31)/32),i=Math.ceil(this.bitDepth*this.width/8),n=e-i,r=this.bitDepth*this.width%8,o=0===r?0:8-r,a=e*this.height;let h,l,c=0,u=0,d=8;t.mark(),l=this.readUint8();for(let a=this.height-1;a>=0;a--){const f=0===a;t.reset(),t.skip(a*e);for(let e=0;e<i;e++){const a=e===i-1;u<=o&&a?(t.writeByte(l<<u),0!==o&&o!==u||f||(h=l,l=this.readByte())):0===u?(h=l,l=this.readUint8(),t.writeByte(h)):(h=l,l=this.readUint8(),t.writeByte(h<<u&s[u]|l>>d)),a&&(c+=r||0,t.skip(n),u=c%8,d=8-u)}}e>i&&(t.reset(),t.skip(a-1),t.writeUint8(0))}writeColorTable(){this.encoded.writeUint32(0).writeUint32(16777215)}writeBitmapFileHeader(t){this.encoded.writeChars("BM").writeInt32(this.encoded.lastWrittenByte).writeUint16(0).writeUint16(0).writeUint32(t)}writeBitmapV5Header(){const t=4*Math.floor((this.bitDepth*this.width+31)/32)*this.height;this.encoded.writeUint32(124).writeInt32(this.width).writeInt32(this.height).writeUint16(1).writeUint16(this.bitDepth).writeUint32(r.BITMAPV5HEADER.Compression.BI_RGB).writeUint32(t).writeInt32(0).writeInt32(0).writeUint32(Math.pow(2,this.bitDepth)).writeUint32(Math.pow(2,this.bitDepth)).writeUint32(4278190080).writeUint32(16711680).writeUint32(65280).writeUint32(255).writeUint32(r.BITMAPV5HEADER.LogicalColorSpace.LCS_sRGB).skip(36).skip(12).writeUint32(r.BITMAPV5HEADER.GamutMappingIntent.LCS_GM_IMAGES).skip(12)}}},5578:t=>{"use strict";t.exports={BITMAPV5HEADER:{LogicalColorSpace:{LCS_CALIBRATED_RGB:0,LCS_sRGB:1934772034,LCS_WINDOWS_COLOR_SPACE:1466527264},Compression:{BI_RGB:0,BI_RLE8:1,BI_RLE4:2,BI_BITFIELDS:3,BI_JPEG:4,BI_PNG:5,BI_CMYK:11,BI_CMYKRLE8:12,BI_CMYKRLE4:13},GamutMappingIntent:{LCS_GM_ABS_COLORIMETRIC:8,LCS_GM_BUSINESS:1,LCS_GM_GRAPHICS:2,LCS_GM_IMAGES:4}}}},4665:(t,e,i)=>{"use strict";const n=i(7060);e.c=function(t){return new n(t).encode()}},7909:t=>{"use strict";const e=[];t.exports=class{constructor(t,e){e=e||{},void 0===t&&(t=8192),"number"==typeof t&&(t=new ArrayBuffer(t));let i=t.byteLength;const n=e.offset?e.offset>>>0:0;t.buffer&&(i=t.byteLength-n,t=t.byteLength!==t.buffer.byteLength?t.buffer.slice(t.byteOffset+n,t.byteOffset+t.byteLength):n?t.buffer.slice(n):t.buffer),this.buffer=t,this.length=i,this.byteLength=i,this.byteOffset=0,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer),this._increment=i||8192,this._mark=0}available(t){return void 0===t&&(t=1),this.offset+t<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){this.littleEndian=!0}isBigEndian(){return!this.littleEndian}setBigEndian(){this.littleEndian=!1}skip(t){void 0===t&&(t=1),this.offset+=t}seek(t){this.offset=t}mark(){this._mark=this.offset}reset(){this.offset=this._mark}rewind(){this.offset=0}ensureAvailable(t){if(void 0===t&&(t=1),!this.available(t)){const t=this._increment+this._increment;this._increment=t;const e=this.length+t,i=new Uint8Array(e);i.set(new Uint8Array(this.buffer)),this.buffer=i.buffer,this.length=e,this._data=new DataView(this.buffer)}}readBoolean(){return 0!==this.readUint8()}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(t){void 0===t&&(t=1);for(var e=new Uint8Array(t),i=0;i<t;i++)e[i]=this.readByte();return e}readInt16(){var t=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,t}readUint16(){var t=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,t}readInt32(){var t=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,t}readUint32(){var t=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat32(){var t=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat64(){var t=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,t}readChar(){return String.fromCharCode(this.readInt8())}readChars(t){void 0===t&&(t=1),e.length=t;for(var i=0;i<t;i++)e[i]=this.readChar();return e.join("")}writeBoolean(t){this.writeUint8(t?255:0)}writeInt8(t){this.ensureAvailable(1),this._data.setInt8(this.offset++,t)}writeUint8(t){this.ensureAvailable(1),this._data.setUint8(this.offset++,t)}writeByte(t){this.writeUint8(t)}writeBytes(t){this.ensureAvailable(t.length);for(var e=0;e<t.length;e++)this._data.setUint8(this.offset++,t[e])}writeInt16(t){this.ensureAvailable(2),this._data.setInt16(this.offset,t,this.littleEndian),this.offset+=2}writeUint16(t){this.ensureAvailable(2),this._data.setUint16(this.offset,t,this.littleEndian),this.offset+=2}writeInt32(t){this.ensureAvailable(4),this._data.setInt32(this.offset,t,this.littleEndian),this.offset+=4}writeUint32(t){this.ensureAvailable(4),this._data.setUint32(this.offset,t,this.littleEndian),this.offset+=4}writeFloat32(t){this.ensureAvailable(4),this._data.setFloat32(this.offset,t,this.littleEndian),this.offset+=4}writeFloat64(t){this.ensureAvailable(8),this._data.setFloat64(this.offset,t,this.littleEndian),this.offset+=8}writeChar(t){this.writeUint8(t.charCodeAt(0))}writeChars(t){for(var e=0;e<t.length;e++)this.writeUint8(t.charCodeAt(e))}toArray(){return new Uint8Array(this.buffer,0,this.offset)}}},3311:(t,e,i)=>{"use strict";const n=i(6752);t.exports=function(t,e){return new n(t,e).decode(e)}},8029:(t,e,i)=>{"use strict";const n={standard:i(4263),exif:i(9640),gps:i(5367)};t.exports=class{constructor(t){if(!t)throw new Error("missing kind");this.data=null,this.fields=new Map,this.kind=t,this._map=null}get(t){if("number"==typeof t)return this.fields.get(t);if("string"==typeof t)return this.fields.get(n[this.kind].tagsByName[t]);throw new Error("expected a number or string")}get map(){if(!this._map){this._map={};const e=n[this.kind].tagsById;for(var t of this.fields.keys())e[t]&&(this._map[e[t]]=this.fields.get(t))}return this._map}}},6486:(t,e)=>{"use strict";var i=new Map([[1,[1,n]],[2,[1,function(t,e){for(var i=[],n="",r=0;r<e;r++){var s=String.fromCharCode(t.readUint8());"\0"===s?(i.push(n),n=""):n+=s}return 1===i.length?i[0]:i}]],[3,[2,function(t,e){if(1===e)return t.readUint16();for(var i=new Uint16Array(e),n=0;n<e;n++)i[n]=t.readUint16();return i}]],[4,[4,function(t,e){if(1===e)return t.readUint32();for(var i=new Uint32Array(e),n=0;n<e;n++)i[n]=t.readUint32();return i}]],[5,[8,function(t,e){if(1===e)return t.readUint32()/t.readUint32();for(var i=new Array(e),n=0;n<e;n++)i[n]=t.readUint32()/t.readUint32();return i}]],[6,[1,function(t,e){if(1===e)return t.readInt8();for(var i=new Int8Array(e),n=0;n<e;n++)i[n]=t.readInt8();return i}]],[7,[1,n]],[8,[2,function(t,e){if(1===e)return t.readInt16();for(var i=new Int16Array(e),n=0;n<e;n++)i[n]=t.readInt16();return i}]],[9,[4,function(t,e){if(1===e)return t.readInt32();for(var i=new Int32Array(e),n=0;n<e;n++)i[n]=t.readInt32();return i}]],[10,[8,function(t,e){if(1===e)return t.readInt32()/t.readInt32();for(var i=new Array(e),n=0;n<e;n++)i[n]=t.readInt32()/t.readInt32();return i}]],[11,[4,function(t,e){if(1===e)return t.readFloat32();for(var i=new Float32Array(e),n=0;n<e;n++)i[n]=t.readFloat32();return i}]],[12,[8,function(t,e){if(1===e)return t.readFloat64();for(var i=new Float64Array(e),n=0;n<e;n++)i[n]=t.readFloat64();return i}]]]);function n(t,e){if(1===e)return t.readUint8();for(var i=new Uint8Array(e),n=0;n<e;n++)i[n]=t.readUint8();return i}e.getByteLength=function(t,e){return i.get(t)[0]*e},e.readData=function(t,e,n){return i.get(e)[1](t,n)}},9469:(t,e,i)=>{"use strict";e.decode=i(3311)},9640:t=>{"use strict";const e={33434:"ExposureTime",33437:"FNumber",34850:"ExposureProgram",34852:"SpectralSensitivity",34855:"ISOSpeedRatings",34856:"OECF",34864:"SensitivityType",34865:"StandardOutputSensitivity",34866:"RecommendedExposureIndex",34867:"ISOSpeed",34868:"ISOSpeedLatitudeyyy",34869:"ISOSpeedLatitudezzz",36864:"ExifVersion",36867:"DateTimeOriginal",36868:"DateTimeDigitized",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureBiasValue",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37386:"FocalLength",37396:"SubjectArea",37500:"MakerNote",37510:"UserComment",37520:"SubsecTime",37521:"SubsecTimeOriginal",37522:"SubsecTimeDigitized",40960:"FlashpixVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",40964:"RelatedSoundFile",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41492:"SubjectLocation",41493:"ExposureIndex",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRatio",41989:"FocalLengthIn35mmFilm",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",42016:"ImageUniqueID",42032:"CameraOwnerName",42033:"BodySerialNumber",42034:"LensSpecification",42035:"LensMake",42036:"LensModel",42037:"LensSerialNumber",42240:"Gamma"},i={};for(var n in e)i[e[n]]=n;t.exports={tagsById:e,tagsByName:i}},5367:t=>{"use strict";const e={0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential",31:"GPSHPositioningError"},i={};for(var n in e)i[e[n]]=n;t.exports={tagsById:e,tagsByName:i}},4263:t=>{"use strict";const e={254:"NewSubfileType",255:"SubfileType",256:"ImageWidth",257:"ImageLength",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",263:"Threshholding",264:"CellWidth",265:"CellLength",266:"FillOrder",270:"ImageDescription",271:"Make",272:"Model",273:"StripOffsets",274:"Orientation",277:"SamplesPerPixel",278:"RowsPerStrip",279:"StripByteCounts",280:"MinSampleValue",281:"MaxSampleValue",282:"XResolution",283:"YResolution",284:"PlanarConfiguration",288:"FreeOffsets",289:"FreeByteCounts",290:"GrayResponseUnit",291:"GrayResponseCurve",296:"ResolutionUnit",305:"Software",306:"DateTime",315:"Artist",316:"HostComputer",320:"ColorMap",338:"ExtraSamples",33432:"Copyright",269:"DocumentName",285:"PageName",286:"XPosition",287:"YPosition",292:"T4Options",293:"T6Options",297:"PageNumber",301:"TransferFunction",317:"Predictor",318:"WhitePoint",319:"PrimaryChromaticities",321:"HalftoneHints",322:"TileWidth",323:"TileLength",324:"TileOffsets",325:"TileByteCounts",326:"BadFaxLines",327:"CleanFaxData",328:"ConsecutiveBadFaxLines",330:"SubIFDs",332:"InkSet",333:"InkNames",334:"NumberOfInks",336:"DotRange",337:"TargetPrinter",339:"SampleFormat",340:"SMinSampleValue",341:"SMaxSampleValue",342:"TransferRange",343:"ClipPath",344:"XClipPathUnits",345:"YClipPathUnits",346:"Indexed",347:"JPEGTables",351:"OPIProxy",400:"GlobalParametersIFD",401:"ProfileType",402:"FaxProfile",403:"CodingMethods",404:"VersionYear",405:"ModeNumber",433:"Decode",434:"DefaultImageColor",512:"JPEGProc",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",515:"JPEGRestartInterval",517:"JPEGLosslessPredictors",518:"JPEGPointTransforms",519:"JPEGQTables",520:"JPEGDCTables",521:"JPEGACTables",529:"YCbCrCoefficients",530:"YCbCrSubSampling",531:"YCbCrPositioning",532:"ReferenceBlackWhite",559:"StripRowCounts",700:"XMP",32781:"ImageID",34732:"ImageLayer",32932:"WangAnnotatio",33445:"MDFileTag",33446:"MDScalePixel",33447:"MDColorTable",33448:"MDLabName",33449:"MDSampleInfo",33450:"MDPrepDate",33451:"MDPrepTime",33452:"MDFileUnits",33550:"ModelPixelScaleTag",33723:"IPTC",33918:"INGRPacketDataTag",33919:"INGRFlagRegisters",33920:"IrasBTransformationMatrix",33922:"ModelTiepointTag",34264:"ModelTransformationTag",34377:"Photoshop",34665:"ExifIFD",34675:"ICCProfile",34735:"GeoKeyDirectoryTag",34736:"GeoDoubleParamsTag",34737:"GeoAsciiParamsTag",34853:"GPSIFD",34908:"HylaFAXFaxRecvParams",34909:"HylaFAXFaxSubAddress",34910:"HylaFAXFaxRecvTime",37724:"ImageSourceData",40965:"InteroperabilityIFD",42112:"GDAL_METADATA",42113:"GDAL_NODATA",50215:"OceScanjobDescription",50216:"OceApplicationSelector",50217:"OceIdentificationNumber",50218:"OceImageLogicCharacteristics",50706:"DNGVersion",50707:"DNGBackwardVersion",50708:"UniqueCameraModel",50709:"LocalizedCameraModel",50710:"CFAPlaneColor",50711:"CFALayout",50712:"LinearizationTable",50713:"BlackLevelRepeatDim",50714:"BlackLevel",50715:"BlackLevelDeltaH",50716:"BlackLevelDeltaV",50717:"WhiteLevel",50718:"DefaultScale",50719:"DefaultCropOrigin",50720:"DefaultCropSize",50721:"ColorMatrix1",50722:"ColorMatrix2",50723:"CameraCalibration1",50724:"CameraCalibration2",50725:"ReductionMatrix1",50726:"ReductionMatrix2",50727:"AnalogBalance",50728:"AsShotNeutral",50729:"AsShotWhiteXY",50730:"BaselineExposure",50731:"BaselineNoise",50732:"BaselineSharpness",50733:"BayerGreenSplit",50734:"LinearResponseLimit",50735:"CameraSerialNumber",50736:"LensInfo",50737:"ChromaBlurRadius",50738:"AntiAliasStrength",50740:"DNGPrivateData",50741:"MakerNoteSafety",50778:"CalibrationIlluminant1",50779:"CalibrationIlluminant2",50780:"BestQualityScale",50784:"AliasLayerMetadata"},i={};for(var n in e)i[e[n]]=n;t.exports={tagsById:e,tagsByName:i}},6752:(t,e,i)=>{"use strict";const n=i(7909),r=i(8029),s=i(8353),o=i(6486),a={ignoreImageData:!1,onlyFirst:!1};function h(t,e,i,n){for(var r=0;r<n;r++)t[i++]=e.getUint8(r);return i}function l(t,e,i,n,r){for(var s=0;s<2*n;s+=2)t[i++]=e.getUint16(s,r);return i}function c(t,e,i,n,r){for(var s=0;s<4*n;s+=4)t[i++]=e.getFloat32(s,r);return i}function u(t,e){throw new Error("Unsupported "+t+": "+e)}t.exports=class extends n{constructor(t,e){super(t,e),this._nextIFD=0}decode(t){t=Object.assign({},a,t);const e=[];for(this.decodeHeader();this._nextIFD;)if(e.push(this.decodeIFD(t)),t.onlyFirst)return e[0];return e}decodeHeader(){let t=this.readUint16();if(18761===t)this.setLittleEndian();else{if(19789!==t)throw new Error("invalid byte order: 0x"+t.toString(16));this.setBigEndian()}if(t=this.readUint16(),42!==t)throw new Error("not a TIFF file");this._nextIFD=this.readUint32()}decodeIFD(t){var e;this.seek(this._nextIFD),e=t.kind?new r(t.kind):new s;const i=this.readUint16();for(var n=0;n<i;n++)this.decodeIFDEntry(e);return t.ignoreImageData||this.decodeImageData(e),this._nextIFD=this.readUint32(),e}decodeIFDEntry(t){const e=this.offset,i=this.readUint16(),n=this.readUint16(),r=this.readUint32();if(n<1||n>12)return void this.skip(4);o.getByteLength(n,r)>4&&this.seek(this.readUint32());const s=o.readData(this,n,r);if(t.fields.set(i,s),34665===i||34853===i){let e,n=this.offset;34665===i?e="exif":34853===i&&(e="gps"),this._nextIFD=s,t[e]=this.decodeIFD({kind:e,ignoreImageData:!0}),this.offset=n}this.seek(e),this.skip(12)}decodeImageData(t){const e=t.orientation;switch(e&&1!==e&&u("orientation",e),t.type){case 1:case 2:this.readStripData(t);break;default:u("image type",t.type)}}readStripData(t){const e=t.width,i=t.height,n=function(t){if(t.length){const i=t;t=i[0];for(var e=0;e<i.length;e++)i[e]!==t&&u("bit depth",i)}return t}(t.bitsPerSample),r=t.sampleFormat;let s=e*i;const o=function(t,e,i,n){return 8===i?new Uint8Array(1*t):16===i?new Uint16Array(1*t):32===i&&3===n?new Float32Array(1*t):u("bit depth / sample format",i+" / "+n)}(s,0,n,r),a=t.compression,d=t.rowsPerStrip*e,f=t.stripOffsets,g=t.stripByteCounts;for(var m=0,p=0;p<f.length;p++){var _=this.getStripData(a,f[p],g[p]),w=s>d?d:s;s-=w,8===n?m=h(o,_,m,w):16===n?m=l(o,_,m,w,this.isLittleEndian()):32===n&&3===r?m=c(o,_,m,w,this.isLittleEndian()):u("bitDepth",n)}t.data=o}getStripData(t,e,i){switch(t){case 1:return new DataView(this.buffer,e,i);case 2:case 32773:return u("Compression",t);default:throw new Error("invalid compression: "+t)}}}},8353:(t,e,i)=>{"use strict";const n=i(8029),r=/^(\d{4}):(\d{2}):(\d{2}) (\d{2}):(\d{2}):(\d{2})$/;function s(t){return"number"==typeof t?[t]:t}t.exports=class extends n{constructor(){super("standard")}get size(){return this.width*this.height}get width(){return this.imageWidth}get height(){return this.imageLength}get components(){return this.samplesPerPixel}get date(){var t=new Date,e=r.exec(this.dateTime);return t.setFullYear(e[1],e[2]-1,e[3]),t.setHours(e[4],e[5],e[6]),t}get newSubfileType(){return this.get(254)}get imageWidth(){return this.get(256)}get imageLength(){return this.get(257)}get bitsPerSample(){return this.get(258)}get compression(){return this.get(259)||1}get type(){return this.get(262)}get fillOrder(){return this.get(266)||1}get documentName(){return this.get(269)}get imageDescription(){return this.get(270)}get stripOffsets(){return s(this.get(273))}get orientation(){return this.get(274)}get samplesPerPixel(){return this.get(277)}get rowsPerStrip(){return this.get(278)}get stripByteCounts(){return s(this.get(279))}get minSampleValue(){return this.get(280)||0}get maxSampleValue(){return this.get(281)||Math.pow(2,this.bitsPerSample)-1}get xResolution(){return this.get(282)}get yResolution(){return this.get(283)}get planarConfiguration(){return this.get(284)||1}get resolutionUnit(){return this.get(296)||2}get dateTime(){return this.get(306)}get predictor(){return this.get(317)||1}get sampleFormat(){return this.get(339)||1}get sMinSampleValue(){return this.get(340)||this.minSampleValue}get sMaxSampleValue(){return this.get(341)||this.maxSampleValue}}},9698:(t,e,i)=>{"use strict";const n=i(7909),r=i(9469);t.exports=function(t){const e=new n(t),i={};if(e.setBigEndian(),65496!==e.readUint16())throw new Error("SOI marker not found. Not a valid JPEG file");if(65505===e.readUint16()){e.readUint16();const t=e.readBytes(6);if(69===t[0]&&120===t[1]&&105===t[2]&&102===t[3]&&0===t[4]&&0===t[5]){const t=r.decode(e,{onlyFirst:!0,ignoreImageData:!0,offset:e.offset});i.exif=t}}return i}},9464:(t,e,i)=>{"use strict";e.decode=i(9698)},8737:t=>{!function(){function e(t,e,i){this.next=i,i&&(i.prev=this),this.prev=e,e&&(e.next=this),this.data=t}function i(){if(!(this instanceof i))return new i;this._head=null,this._tail=null,this.length=0}i.prototype={push:function(t){this._tail=new e(t,this._tail,null),this._head||(this._head=this._tail),this.length++},pop:function(){if(0!==this.length){var t=this._tail;return this._tail=t.prev,t.prev&&(t.prev=this._tail.next=null),this.length--,1===this.length?this._head=this._tail:0===this.length&&(this._head=this._tail=null),t.data}},unshift:function(t){this._head=new e(t,null,this._head),this._tail||(this._tail=this._head),this.length++},shift:function(){if(0!==this.length){var t=this._head;return this._head=t.next,t.next&&(t.next=this._head.prev=null),this.length--,1===this.length?this._tail=this._head:0===this.length&&(this._head=this._tail=null),t.data}},item:function(t){t<0&&(t=this.length+t);for(var e=this._head;t-- >0&&e;)e=e.next;return e?e.data:void 0},slice:function(t,e){if(t||(t=0),e||(e=this.length),e<0&&(e=this.length+e),t<0&&(t=this.length+t),e===t)return[];if(e<t)throw new Error("invalid offset: "+t+","+e+" (length="+this.length+")");for(var i=e-t,n=new Array(i),r=0,s=this._head;t-- >0&&s;)s=s.next;for(;r<i&&s;)n[r++]=s.data,s=s.next;return n},drop:function(){i.call(this)},forEach:function(t,e){for(var i=this._head,n=0,r=this.length;n<r&&i;)t.call(e||this,i.data,n,this),i=i.next,n++},map:function(t,e){var n=new i;return this.forEach((function(i,r,s){n.push(t.call(e||s,i,r,s))})),n},filter:function(t,e){var n=new i;return this.forEach((function(i,r,s){t.call(e||s,i,r,s)&&n.push(i)})),n},reduce:function(t,e,i){var n=0,r=this._head,s=this.length;for(e||(n=1,e=r&&r.data,r=r&&r.next);n<s&&r;)e=t.call(i||this,e,r.data,this),n++,r=r.next;return e}},t.exports=i}()},9645:t=>{"use strict";function e(t){if(this.size=0|t,this.size<=1||0!=(this.size&this.size-1))throw new Error("FFT size must be a power of two and bigger than 1");this._csize=t<<1;for(var e=new Array(2*this.size),i=0;i<e.length;i+=2){const t=Math.PI*i/this.size;e[i]=Math.cos(t),e[i+1]=-Math.sin(t)}this.table=e;for(var n=0,r=1;this.size>r;r<<=1)n++;this._width=n%2==0?n-1:n,this._bitrev=new Array(1<<this._width);for(var s=0;s<this._bitrev.length;s++){this._bitrev[s]=0;for(var o=0;o<this._width;o+=2){var a=this._width-o-2;this._bitrev[s]|=(s>>>o&3)<<a}}this._out=null,this._data=null,this._inv=0}t.exports=e,e.prototype.fromComplexArray=function(t,e){for(var i=e||new Array(t.length>>>1),n=0;n<t.length;n+=2)i[n>>>1]=t[n];return i},e.prototype.createComplexArray=function(){const t=new Array(this._csize);for(var e=0;e<t.length;e++)t[e]=0;return t},e.prototype.toComplexArray=function(t,e){for(var i=e||this.createComplexArray(),n=0;n<i.length;n+=2)i[n]=t[n>>>1],i[n+1]=0;return i},e.prototype.completeSpectrum=function(t){for(var e=this._csize,i=e>>>1,n=2;n<i;n+=2)t[e-n]=t[n],t[e-n+1]=-t[n+1]},e.prototype.transform=function(t,e){if(t===e)throw new Error("Input and output buffers must be different");this._out=t,this._data=e,this._inv=0,this._transform4(),this._out=null,this._data=null},e.prototype.realTransform=function(t,e){if(t===e)throw new Error("Input and output buffers must be different");this._out=t,this._data=e,this._inv=0,this._realTransform4(),this._out=null,this._data=null},e.prototype.inverseTransform=function(t,e){if(t===e)throw new Error("Input and output buffers must be different");this._out=t,this._data=e,this._inv=1,this._transform4();for(var i=0;i<t.length;i++)t[i]/=this.size;this._out=null,this._data=null},e.prototype._transform4=function(){var t,e,i=this._out,n=this._csize,r=1<<this._width,s=n/r<<1,o=this._bitrev;if(4===s)for(t=0,e=0;t<n;t+=s,e++){const i=o[e];this._singleTransform2(t,i,r)}else for(t=0,e=0;t<n;t+=s,e++){const i=o[e];this._singleTransform4(t,i,r)}var a=this._inv?-1:1,h=this.table;for(r>>=2;r>=2;r>>=2){var l=(s=n/r<<1)>>>2;for(t=0;t<n;t+=s)for(var c=t+l,u=t,d=0;u<c;u+=2,d+=r){const t=u,e=t+l,n=e+l,r=n+l,s=i[t],o=i[t+1],c=i[e],f=i[e+1],g=i[n],m=i[n+1],p=i[r],_=i[r+1],w=s,y=o,v=h[d],b=a*h[d+1],x=c*v-f*b,M=c*b+f*v,E=h[2*d],S=a*h[2*d+1],k=g*E-m*S,C=g*S+m*E,I=h[3*d],A=a*h[3*d+1],T=p*I-_*A,R=p*A+_*I,P=w+k,D=y+C,F=w-k,L=y-C,O=x+T,N=M+R,B=a*(x-T),z=a*(M-R),U=P+O,G=D+N,Y=P-O,X=D-N,V=F+z,j=L-B,q=F-z,W=L+B;i[t]=U,i[t+1]=G,i[e]=V,i[e+1]=j,i[n]=Y,i[n+1]=X,i[r]=q,i[r+1]=W}}},e.prototype._singleTransform2=function(t,e,i){const n=this._out,r=this._data,s=r[e],o=r[e+1],a=r[e+i],h=r[e+i+1],l=s+a,c=o+h,u=s-a,d=o-h;n[t]=l,n[t+1]=c,n[t+2]=u,n[t+3]=d},e.prototype._singleTransform4=function(t,e,i){const n=this._out,r=this._data,s=this._inv?-1:1,o=2*i,a=3*i,h=r[e],l=r[e+1],c=r[e+i],u=r[e+i+1],d=r[e+o],f=r[e+o+1],g=r[e+a],m=r[e+a+1],p=h+d,_=l+f,w=h-d,y=l-f,v=c+g,b=u+m,x=s*(c-g),M=s*(u-m),E=p+v,S=_+b,k=w+M,C=y-x,I=p-v,A=_-b,T=w-M,R=y+x;n[t]=E,n[t+1]=S,n[t+2]=k,n[t+3]=C,n[t+4]=I,n[t+5]=A,n[t+6]=T,n[t+7]=R},e.prototype._realTransform4=function(){var t,e,i=this._out,n=this._csize,r=1<<this._width,s=n/r<<1,o=this._bitrev;if(4===s)for(t=0,e=0;t<n;t+=s,e++){const i=o[e];this._singleRealTransform2(t,i>>>1,r>>>1)}else for(t=0,e=0;t<n;t+=s,e++){const i=o[e];this._singleRealTransform4(t,i>>>1,r>>>1)}var a=this._inv?-1:1,h=this.table;for(r>>=2;r>=2;r>>=2){var l=(s=n/r<<1)>>>1,c=l>>>1,u=c>>>1;for(t=0;t<n;t+=s)for(var d=0,f=0;d<=u;d+=2,f+=r){var g=t+d,m=g+c,p=m+c,_=p+c,w=i[g],y=i[g+1],v=i[m],b=i[m+1],x=i[p],M=i[p+1],E=i[_],S=i[_+1],k=w,C=y,I=h[f],A=a*h[f+1],T=v*I-b*A,R=v*A+b*I,P=h[2*f],D=a*h[2*f+1],F=x*P-M*D,L=x*D+M*P,O=h[3*f],N=a*h[3*f+1],B=E*O-S*N,z=E*N+S*O,U=k+F,G=C+L,Y=k-F,X=C-L,V=T+B,j=R+z,q=a*(T-B),W=a*(R-z),Z=U+V,K=G+j,H=Y+W,$=X-q;if(i[g]=Z,i[g+1]=K,i[m]=H,i[m+1]=$,0!==d){if(d!==u){var J=Y+-a*W,Q=-a*q-X,tt=U+-a*V,et=-G- -a*j,it=t+c-d,nt=t+l-d;i[it]=J,i[it+1]=Q,i[nt]=tt,i[nt+1]=et}}else{var rt=U-V,st=G-j;i[p]=rt,i[p+1]=st}}}},e.prototype._singleRealTransform2=function(t,e,i){const n=this._out,r=this._data,s=r[e],o=r[e+i],a=s+o,h=s-o;n[t]=a,n[t+1]=0,n[t+2]=h,n[t+3]=0},e.prototype._singleRealTransform4=function(t,e,i){const n=this._out,r=this._data,s=this._inv?-1:1,o=2*i,a=3*i,h=r[e],l=r[e+i],c=r[e+o],u=r[e+a],d=h+c,f=h-c,g=l+u,m=s*(l-u),p=d+g,_=f,w=-m,y=d-g,v=f,b=m;n[t]=p,n[t+1]=0,n[t+2]=_,n[t+3]=w,n[t+4]=y,n[t+5]=0,n[t+6]=v,n[t+7]=b}},7769:module=>{"use strict";const toBytes=t=>[...t].map((t=>t.charCodeAt(0))),xpiZipFilename=toBytes("META-INF/mozilla.rsa"),oxmlContentTypes=toBytes("[Content_Types].xml"),oxmlRels=toBytes("_rels/.rels");function readUInt64LE(t,e=0){let i=t[e],n=1,r=0;for(;++r<8;)n*=256,i+=t[e+r]*n;return i}const fileType=t=>{if(!(t instanceof Uint8Array||t instanceof ArrayBuffer||Buffer.isBuffer(t)))throw new TypeError(`Expected the \`input\` argument to be of type \`Uint8Array\` or \`Buffer\` or \`ArrayBuffer\`, got \`${typeof t}\``);const e=t instanceof Uint8Array?t:new Uint8Array(t);if(!(e&&e.length>1))return null;const i=(t,i)=>{i=Object.assign({offset:0},i);for(let n=0;n<t.length;n++)if(i.mask){if(t[n]!==(i.mask[n]&e[n+i.offset]))return!1}else if(t[n]!==e[n+i.offset])return!1;return!0},n=(t,e)=>i(toBytes(t),e);if(i([255,216,255]))return{ext:"jpg",mime:"image/jpeg"};if(i([137,80,78,71,13,10,26,10]))return{ext:"png",mime:"image/png"};if(i([71,73,70]))return{ext:"gif",mime:"image/gif"};if(i([87,69,66,80],{offset:8}))return{ext:"webp",mime:"image/webp"};if(i([70,76,73,70]))return{ext:"flif",mime:"image/flif"};if((i([73,73,42,0])||i([77,77,0,42]))&&i([67,82],{offset:8}))return{ext:"cr2",mime:"image/x-canon-cr2"};if(i([73,73,42,0])||i([77,77,0,42]))return{ext:"tif",mime:"image/tiff"};if(i([66,77]))return{ext:"bmp",mime:"image/bmp"};if(i([73,73,188]))return{ext:"jxr",mime:"image/vnd.ms-photo"};if(i([56,66,80,83]))return{ext:"psd",mime:"image/vnd.adobe.photoshop"};if(i([80,75,3,4])){if(i([109,105,109,101,116,121,112,101,97,112,112,108,105,99,97,116,105,111,110,47,101,112,117,98,43,122,105,112],{offset:30}))return{ext:"epub",mime:"application/epub+zip"};if(i(xpiZipFilename,{offset:30}))return{ext:"xpi",mime:"application/x-xpinstall"};if(n("mimetypeapplication/vnd.oasis.opendocument.text",{offset:30}))return{ext:"odt",mime:"application/vnd.oasis.opendocument.text"};if(n("mimetypeapplication/vnd.oasis.opendocument.spreadsheet",{offset:30}))return{ext:"ods",mime:"application/vnd.oasis.opendocument.spreadsheet"};if(n("mimetypeapplication/vnd.oasis.opendocument.presentation",{offset:30}))return{ext:"odp",mime:"application/vnd.oasis.opendocument.presentation"};const t=(t,e=0)=>t.findIndex(((t,i,n)=>i>=e&&80===n[i]&&75===n[i+1]&&3===n[i+2]&&4===n[i+3]));let r=0,s=!1,o=null;do{const a=r+30;if(s||(s=i(oxmlContentTypes,{offset:a})||i(oxmlRels,{offset:a})),o||(n("word/",{offset:a})?o={ext:"docx",mime:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"}:n("ppt/",{offset:a})?o={ext:"pptx",mime:"application/vnd.openxmlformats-officedocument.presentationml.presentation"}:n("xl/",{offset:a})&&(o={ext:"xlsx",mime:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"})),s&&o)return o;r=t(e,a)}while(r>=0);if(o)return o}if(i([80,75])&&(3===e[2]||5===e[2]||7===e[2])&&(4===e[3]||6===e[3]||8===e[3]))return{ext:"zip",mime:"application/zip"};if(i([117,115,116,97,114],{offset:257}))return{ext:"tar",mime:"application/x-tar"};if(i([82,97,114,33,26,7])&&(0===e[6]||1===e[6]))return{ext:"rar",mime:"application/x-rar-compressed"};if(i([31,139,8]))return{ext:"gz",mime:"application/gzip"};if(i([66,90,104]))return{ext:"bz2",mime:"application/x-bzip2"};if(i([55,122,188,175,39,28]))return{ext:"7z",mime:"application/x-7z-compressed"};if(i([120,1]))return{ext:"dmg",mime:"application/x-apple-diskimage"};if(i([51,103,112,53])||i([0,0,0])&&i([102,116,121,112],{offset:4})&&(i([109,112,52,49],{offset:8})||i([109,112,52,50],{offset:8})||i([105,115,111,109],{offset:8})||i([105,115,111,50],{offset:8})||i([109,109,112,52],{offset:8})||i([77,52,86],{offset:8})||i([100,97,115,104],{offset:8})))return{ext:"mp4",mime:"video/mp4"};if(i([77,84,104,100]))return{ext:"mid",mime:"audio/midi"};if(i([26,69,223,163])){const t=e.subarray(4,4100),i=t.findIndex(((t,e,i)=>66===i[e]&&130===i[e+1]));if(-1!==i){const e=i+3,n=i=>[...i].every(((i,n)=>t[e+n]===i.charCodeAt(0)));if(n("matroska"))return{ext:"mkv",mime:"video/x-matroska"};if(n("webm"))return{ext:"webm",mime:"video/webm"}}}if(i([0,0,0,20,102,116,121,112,113,116,32,32])||i([102,114,101,101],{offset:4})||i([102,116,121,112,113,116,32,32],{offset:4})||i([109,100,97,116],{offset:4})||i([109,111,111,118],{offset:4})||i([119,105,100,101],{offset:4}))return{ext:"mov",mime:"video/quicktime"};if(i([82,73,70,70])){if(i([65,86,73],{offset:8}))return{ext:"avi",mime:"video/vnd.avi"};if(i([87,65,86,69],{offset:8}))return{ext:"wav",mime:"audio/vnd.wave"};if(i([81,76,67,77],{offset:8}))return{ext:"qcp",mime:"audio/qcelp"}}if(i([48,38,178,117,142,102,207,17,166,217])){let t=30;do{const n=readUInt64LE(e,t+16);if(i([145,7,220,183,183,169,207,17,142,230,0,192,12,32,83,101],{offset:t})){if(i([64,158,105,248,77,91,207,17,168,253,0,128,95,92,68,43],{offset:t+24}))return{ext:"wma",mime:"audio/x-ms-wma"};if(i([192,239,25,188,77,91,207,17,168,253,0,128,95,92,68,43],{offset:t+24}))return{ext:"wmv",mime:"video/x-ms-asf"};break}t+=n}while(t+24<=e.length);return{ext:"asf",mime:"application/vnd.ms-asf"}}if(i([0,0,1,186])||i([0,0,1,179]))return{ext:"mpg",mime:"video/mpeg"};if(i([102,116,121,112,51,103],{offset:4}))return{ext:"3gp",mime:"video/3gpp"};for(let t=0;t<2&&t<e.length-16;t++){if(i([73,68,51],{offset:t})||i([255,226],{offset:t,mask:[255,226]}))return{ext:"mp3",mime:"audio/mpeg"};if(i([255,228],{offset:t,mask:[255,228]}))return{ext:"mp2",mime:"audio/mpeg"};if(i([255,248],{offset:t,mask:[255,252]}))return{ext:"mp2",mime:"audio/mpeg"};if(i([255,240],{offset:t,mask:[255,252]}))return{ext:"mp4",mime:"audio/mpeg"}}if(i([102,116,121,112,77,52,65],{offset:4}))return{ext:"m4a",mime:"audio/mp4"};if(i([79,112,117,115,72,101,97,100],{offset:28}))return{ext:"opus",mime:"audio/opus"};if(i([79,103,103,83]))return i([128,116,104,101,111,114,97],{offset:28})?{ext:"ogv",mime:"video/ogg"}:i([1,118,105,100,101,111,0],{offset:28})?{ext:"ogm",mime:"video/ogg"}:i([127,70,76,65,67],{offset:28})?{ext:"oga",mime:"audio/ogg"}:i([83,112,101,101,120,32,32],{offset:28})?{ext:"spx",mime:"audio/ogg"}:i([1,118,111,114,98,105,115],{offset:28})?{ext:"ogg",mime:"audio/ogg"}:{ext:"ogx",mime:"application/ogg"};if(i([102,76,97,67]))return{ext:"flac",mime:"audio/x-flac"};if(i([77,65,67,32]))return{ext:"ape",mime:"audio/ape"};if(i([119,118,112,107]))return{ext:"wv",mime:"audio/wavpack"};if(i([35,33,65,77,82,10]))return{ext:"amr",mime:"audio/amr"};if(i([37,80,68,70]))return{ext:"pdf",mime:"application/pdf"};if(i([77,90]))return{ext:"exe",mime:"application/x-msdownload"};if((67===e[0]||70===e[0])&&i([87,83],{offset:1}))return{ext:"swf",mime:"application/x-shockwave-flash"};if(i([123,92,114,116,102]))return{ext:"rtf",mime:"application/rtf"};if(i([0,97,115,109]))return{ext:"wasm",mime:"application/wasm"};if(i([119,79,70,70])&&(i([0,1,0,0],{offset:4})||i([79,84,84,79],{offset:4})))return{ext:"woff",mime:"font/woff"};if(i([119,79,70,50])&&(i([0,1,0,0],{offset:4})||i([79,84,84,79],{offset:4})))return{ext:"woff2",mime:"font/woff2"};if(i([76,80],{offset:34})&&(i([0,0,1],{offset:8})||i([1,0,2],{offset:8})||i([2,0,2],{offset:8})))return{ext:"eot",mime:"application/vnd.ms-fontobject"};if(i([0,1,0,0,0]))return{ext:"ttf",mime:"font/ttf"};if(i([79,84,84,79,0]))return{ext:"otf",mime:"font/otf"};if(i([0,0,1,0]))return{ext:"ico",mime:"image/x-icon"};if(i([0,0,2,0]))return{ext:"cur",mime:"image/x-icon"};if(i([70,76,86,1]))return{ext:"flv",mime:"video/x-flv"};if(i([37,33]))return{ext:"ps",mime:"application/postscript"};if(i([253,55,122,88,90,0]))return{ext:"xz",mime:"application/x-xz"};if(i([83,81,76,105]))return{ext:"sqlite",mime:"application/x-sqlite3"};if(i([78,69,83,26]))return{ext:"nes",mime:"application/x-nintendo-nes-rom"};if(i([67,114,50,52]))return{ext:"crx",mime:"application/x-google-chrome-extension"};if(i([77,83,67,70])||i([73,83,99,40]))return{ext:"cab",mime:"application/vnd.ms-cab-compressed"};if(i([33,60,97,114,99,104,62,10,100,101,98,105,97,110,45,98,105,110,97,114,121]))return{ext:"deb",mime:"application/x-deb"};if(i([33,60,97,114,99,104,62]))return{ext:"ar",mime:"application/x-unix-archive"};if(i([237,171,238,219]))return{ext:"rpm",mime:"application/x-rpm"};if(i([31,160])||i([31,157]))return{ext:"Z",mime:"application/x-compress"};if(i([76,90,73,80]))return{ext:"lz",mime:"application/x-lzip"};if(i([208,207,17,224,161,177,26,225]))return{ext:"msi",mime:"application/x-msi"};if(i([6,14,43,52,2,5,1,1,13,1,2,1,1,2]))return{ext:"mxf",mime:"application/mxf"};if(i([71],{offset:4})&&(i([71],{offset:192})||i([71],{offset:196})))return{ext:"mts",mime:"video/mp2t"};if(i([66,76,69,78,68,69,82]))return{ext:"blend",mime:"application/x-blender"};if(i([66,80,71,251]))return{ext:"bpg",mime:"image/bpg"};if(i([0,0,0,12,106,80,32,32,13,10,135,10])){if(i([106,112,50,32],{offset:20}))return{ext:"jp2",mime:"image/jp2"};if(i([106,112,120,32],{offset:20}))return{ext:"jpx",mime:"image/jpx"};if(i([106,112,109,32],{offset:20}))return{ext:"jpm",mime:"image/jpm"};if(i([109,106,112,50],{offset:20}))return{ext:"mj2",mime:"image/mj2"}}if(i([70,79,82,77]))return{ext:"aif",mime:"audio/aiff"};if(n("<?xml "))return{ext:"xml",mime:"application/xml"};if(i([66,79,79,75,77,79,66,73],{offset:60}))return{ext:"mobi",mime:"application/x-mobipocket-ebook"};if(i([102,116,121,112],{offset:4})){if(i([109,105,102,49],{offset:8}))return{ext:"heic",mime:"image/heif"};if(i([109,115,102,49],{offset:8}))return{ext:"heic",mime:"image/heif-sequence"};if(i([104,101,105,99],{offset:8})||i([104,101,105,120],{offset:8}))return{ext:"heic",mime:"image/heic"};if(i([104,101,118,99],{offset:8})||i([104,101,118,120],{offset:8}))return{ext:"heic",mime:"image/heic-sequence"}}return i([171,75,84,88,32,49,49,187,13,10,26,10])?{ext:"ktx",mime:"image/ktx"}:i([68,73,67,77],{offset:128})?{ext:"dcm",mime:"application/dicom"}:i([77,80,43])||i([77,80,67,75])?{ext:"mpc",mime:"audio/x-musepack"}:i([66,69,71,73,78,58])?{ext:"ics",mime:"text/calendar"}:i([103,108,84,70,2,0,0,0])?{ext:"glb",mime:"model/gltf-binary"}:i([212,195,178,161])||i([161,178,195,212])?{ext:"pcap",mime:"application/vnd.tcpdump.pcap"}:null};module.exports=fileType,module.exports.default=fileType,Object.defineProperty(fileType,"minimumBytes",{value:4100}),module.exports.stream=readableStream=>new Promise(((resolve,reject)=>{const stream=eval("require")("stream");readableStream.once("readable",(()=>{const t=new stream.PassThrough,e=readableStream.read(module.exports.minimumBytes)||readableStream.read();try{t.fileType=fileType(e)}catch(t){reject(t)}readableStream.unshift(e),stream.pipeline?resolve(stream.pipeline(readableStream,t,(()=>{}))):resolve(readableStream.pipe(t))}))}))},2251:(t,e,i)=>{var n=Object.prototype.hasOwnProperty;t.exports=e=function(t,e){return n.call(e,t)},e.version=i(2898).version},9184:(t,e,i)=>{"use strict";const n=i(7769),r=new Set(["jpg","png","gif","webp","flif","cr2","tif","bmp","jxr","psd","ico","bpg","jp2","jpm","jpx","heic","cur","dcm"]),s=t=>{const e=n(t);return r.has(e&&e.ext)?e:null};t.exports=s,t.exports.default=s,Object.defineProperty(s,"minimumBytes",{value:n.minimumBytes})},2155:(t,e,i)=>{"use strict";function n(t,e="utf8"){return new TextDecoder(e).decode(t)}i.r(e),i.d(e,{IOBuffer:()=>a}),i(7396);const r=new TextEncoder,s=(()=>{const t=new Uint8Array(4);return!((new Uint32Array(t.buffer)[0]=1)&t[0])})(),o={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class a{constructor(t=8192,e={}){let i=!1;"number"==typeof t?t=new ArrayBuffer(t):(i=!0,this.lastWrittenByte=t.byteLength);const n=e.offset?e.offset>>>0:0,r=t.byteLength-n;let s=n;(ArrayBuffer.isView(t)||t instanceof a)&&(t.byteLength!==t.buffer.byteLength&&(s=t.byteOffset+n),t=t.buffer),this.lastWrittenByte=i?r:0,this.buffer=t,this.length=r,this.byteLength=r,this.byteOffset=s,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,s,r),this._mark=0,this._marks=[]}available(t=1){return this.offset+t<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(t=1){return this.offset+=t,this}back(t=1){return this.offset-=t,this}seek(t){return this.offset=t,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const t=this._marks.pop();if(void 0===t)throw new Error("Mark stack empty");return this.seek(t),this}rewind(){return this.offset=0,this}ensureAvailable(t=1){if(!this.available(t)){const e=2*(this.offset+t),i=new Uint8Array(e);i.set(new Uint8Array(this.buffer)),this.buffer=i.buffer,this.length=this.byteLength=e,this._data=new DataView(this.buffer)}return this}readBoolean(){return 0!==this.readUint8()}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(t=1){return this.readArray(t,"uint8")}readArray(t,e){const i=o[e].BYTES_PER_ELEMENT*t,n=this.byteOffset+this.offset,r=this.buffer.slice(n,n+i);if(this.littleEndian===s&&"uint8"!==e&&"int8"!==e){const t=new Uint8Array(this.buffer.slice(n,n+i));t.reverse();const r=new o[e](t.buffer);return this.offset+=i,r.reverse(),r}const a=new o[e](r);return this.offset+=i,a}readInt16(){const t=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,t}readUint16(){const t=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,t}readInt32(){const t=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,t}readUint32(){const t=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat32(){const t=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat64(){const t=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,t}readBigInt64(){const t=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,t}readBigUint64(){const t=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,t}readChar(){return String.fromCharCode(this.readInt8())}readChars(t=1){let e="";for(let i=0;i<t;i++)e+=this.readChar();return e}readUtf8(t=1){return n(this.readBytes(t))}decodeText(t=1,e="utf-8"){return n(this.readBytes(t),e)}writeBoolean(t){return this.writeUint8(t?255:0),this}writeInt8(t){return this.ensureAvailable(1),this._data.setInt8(this.offset++,t),this._updateLastWrittenByte(),this}writeUint8(t){return this.ensureAvailable(1),this._data.setUint8(this.offset++,t),this._updateLastWrittenByte(),this}writeByte(t){return this.writeUint8(t)}writeBytes(t){this.ensureAvailable(t.length);for(let e=0;e<t.length;e++)this._data.setUint8(this.offset++,t[e]);return this._updateLastWrittenByte(),this}writeInt16(t){return this.ensureAvailable(2),this._data.setInt16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(t){return this.ensureAvailable(2),this._data.setUint16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(t){return this.ensureAvailable(4),this._data.setInt32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(t){return this.ensureAvailable(4),this._data.setUint32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(t){return this.ensureAvailable(4),this._data.setFloat32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(t){return this.ensureAvailable(8),this._data.setFloat64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(t){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(t){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(t){return this.writeUint8(t.charCodeAt(0))}writeChars(t){for(let e=0;e<t.length;e++)this.writeUint8(t.charCodeAt(e));return this}writeUtf8(t){return this.writeBytes(function(t){return r.encode(t)}(t))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}},7396:function(){"use strict";!function(t){if(t.TextEncoder&&t.TextDecoder)return!1;function e(t="utf-8"){if("utf-8"!==t)throw new RangeError(`Failed to construct 'TextEncoder': The encoding label provided ('${t}') is invalid.`)}function i(t="utf-8",e={fatal:!1}){if("utf-8"!==t)throw new RangeError(`Failed to construct 'TextDecoder': The encoding label provided ('${t}') is invalid.`);if(e.fatal)throw new Error("Failed to construct 'TextDecoder': the 'fatal' option is unsupported.")}Object.defineProperty(e.prototype,"encoding",{value:"utf-8"}),e.prototype.encode=function(t,e={stream:!1}){if(e.stream)throw new Error("Failed to encode: the 'stream' option is unsupported.");let i=0;const n=t.length;let r=0,s=Math.max(32,n+(n>>1)+7),o=new Uint8Array(s>>3<<3);for(;i<n;){let e=t.charCodeAt(i++);if(e>=55296&&e<=56319){if(i<n){const n=t.charCodeAt(i);56320==(64512&n)&&(++i,e=((1023&e)<<10)+(1023&n)+65536)}if(e>=55296&&e<=56319)continue}if(r+4>o.length){s+=8,s*=1+i/t.length*2,s=s>>3<<3;const e=new Uint8Array(s);e.set(o),o=e}if(0!=(4294967168&e)){if(0==(4294965248&e))o[r++]=e>>6&31|192;else if(0==(4294901760&e))o[r++]=e>>12&15|224,o[r++]=e>>6&63|128;else{if(0!=(4292870144&e))continue;o[r++]=e>>18&7|240,o[r++]=e>>12&63|128,o[r++]=e>>6&63|128}o[r++]=63&e|128}else o[r++]=e}return o.slice(0,r)},Object.defineProperty(i.prototype,"encoding",{value:"utf-8"}),Object.defineProperty(i.prototype,"fatal",{value:!1}),Object.defineProperty(i.prototype,"ignoreBOM",{value:!1}),i.prototype.decode=function(t,e={stream:!1}){if(e.stream)throw new Error("Failed to decode: the 'stream' option is unsupported.");const i=new Uint8Array(t);let n=0;const r=i.length,s=[];for(;n<r;){const t=i[n++];if(0===t)break;if(0==(128&t))s.push(t);else if(192==(224&t)){const e=63&i[n++];s.push((31&t)<<6|e)}else if(224==(240&t)){const e=63&i[n++],r=63&i[n++];s.push((31&t)<<12|e<<6|r)}else if(240==(248&t)){let e=(7&t)<<18|(63&i[n++])<<12|(63&i[n++])<<6|63&i[n++];e>65535&&(e-=65536,s.push(e>>>10&1023|55296),e=56320|1023&e),s.push(e)}}return String.fromCharCode.apply(null,s)},t.TextEncoder=e,t.TextDecoder=i}("undefined"!=typeof window?window:"undefined"!=typeof self?self:this)},4091:(t,e,i)=>{"use strict";i.r(e),i.d(e,{isAnyArray:()=>r});const n=Object.prototype.toString;function r(t){const e=n.call(t);return e.endsWith("Array]")&&!e.includes("Big")}},7811:t=>{"use strict";var e=Object.prototype.toString;t.exports=function(t){return"Array"===e.call(t).substr(-6,5)}},1867:t=>{"use strict";t.exports=Number.isFinite||function(t){return!("number"!=typeof t||t!=t||t===1/0||t===-1/0)}},8336:(t,e,i)=>{var n=i(1867);t.exports=Number.isInteger||function(t){return"number"==typeof t&&n(t)&&Math.floor(t)===t}},7870:(t,e,i)=>{var n=i(587),r=i(914);t.exports={encode:n,decode:r}},914:t=>{var e=function(){"use strict";var t=new Int32Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]),e=4017,i=799,n=3406,r=2276,s=1567,o=3784,a=5793,h=2896;function l(){}function c(t,e){for(var i,n,r=0,s=[],o=16;o>0&&!t[o-1];)o--;s.push({children:[],index:0});var a,h=s[0];for(i=0;i<o;i++){for(n=0;n<t[i];n++){for((h=s.pop()).children[h.index]=e[r];h.index>0;){if(0===s.length)throw new Error("Could not recreate Huffman Table");h=s.pop()}for(h.index++,s.push(h);s.length<=i;)s.push(a={children:[],index:0}),h.children[h.index]=a.children,h=a;r++}i+1<o&&(s.push(a={children:[],index:0}),h.children[h.index]=a.children,h=a)}return s[0].children}function u(e,i,n,r,s,o,a,h,l,c){n.precision,n.samplesPerLine,n.scanLines;var u=n.mcusPerLine,d=n.progressive,f=(n.maxH,n.maxV,i),g=0,m=0;function p(){if(m>0)return m--,g>>m&1;if(255==(g=e[i++])){var t=e[i++];if(t)throw new Error("unexpected marker: "+(g<<8|t).toString(16))}return m=7,g>>>7}function _(t){for(var e,i=t;null!==(e=p());){if("number"==typeof(i=i[e]))return i;if("object"!=typeof i)throw new Error("invalid huffman sequence")}return null}function w(t){for(var e=0;t>0;){var i=p();if(null===i)return;e=e<<1|i,t--}return e}function y(t){var e=w(t);return e>=1<<t-1?e:e+(-1<<t)+1}var v,b=0,x=0;function M(t,e,i,n,r){var s=i%u,o=(i/u|0)*t.v+n,a=s*t.h+r;void 0===t.blocks[o]&&c.tolerantDecoding||e(t,t.blocks[o][a])}function E(t,e,i){var n=i/t.blocksPerLine|0,r=i%t.blocksPerLine;void 0===t.blocks[n]&&c.tolerantDecoding||e(t,t.blocks[n][r])}var S,k,C,I,A,T,R=r.length;T=d?0===o?0===h?function(t,e){var i=_(t.huffmanTableDC),n=0===i?0:y(i)<<l;e[0]=t.pred+=n}:function(t,e){e[0]|=p()<<l}:0===h?function(e,i){if(b>0)b--;else for(var n=o,r=a;n<=r;){var s=_(e.huffmanTableAC),h=15&s,c=s>>4;if(0!==h)i[t[n+=c]]=y(h)*(1<<l),n++;else{if(c<15){b=w(c)+(1<<c)-1;break}n+=16}}}:function(e,i){for(var n=o,r=a,s=0;n<=r;){var h=t[n],c=i[h]<0?-1:1;switch(x){case 0:var u=_(e.huffmanTableAC),d=15&u;if(s=u>>4,0===d)s<15?(b=w(s)+(1<<s),x=4):(s=16,x=1);else{if(1!==d)throw new Error("invalid ACn encoding");v=y(d),x=s?2:3}continue;case 1:case 2:i[h]?i[h]+=(p()<<l)*c:0==--s&&(x=2==x?3:0);break;case 3:i[h]?i[h]+=(p()<<l)*c:(i[h]=v<<l,x=0);break;case 4:i[h]&&(i[h]+=(p()<<l)*c)}n++}4===x&&0==--b&&(x=0)}:function(e,i){var n=_(e.huffmanTableDC),r=0===n?0:y(n);i[0]=e.pred+=r;for(var s=1;s<64;){var o=_(e.huffmanTableAC),a=15&o,h=o>>4;if(0!==a)i[t[s+=h]]=y(a),s++;else{if(h<15)break;s+=16}}};var P,D,F,L,O=0;for(D=1==R?r[0].blocksPerLine*r[0].blocksPerColumn:u*n.mcusPerColumn,s||(s=D);O<D;){for(k=0;k<R;k++)r[k].pred=0;if(b=0,1==R)for(S=r[0],A=0;A<s;A++)E(S,T,O),O++;else for(A=0;A<s;A++){for(k=0;k<R;k++)for(F=(S=r[k]).h,L=S.v,C=0;C<L;C++)for(I=0;I<F;I++)M(S,T,O,C,I);if(++O===D)break}if(O===D)do{if(255===e[i]&&0!==e[i+1])break;i+=1}while(i<e.length-2);if(m=0,(P=e[i]<<8|e[i+1])<65280)throw new Error("marker was not found");if(!(P>=65488&&P<=65495))break;i+=2}return i-f}function d(t,l){var c,u,d=[],f=l.blocksPerLine,g=l.blocksPerColumn,m=f<<3,_=new Int32Array(64),w=new Uint8Array(64);function y(t,c,u){var d,f,g,m,p,_,w,y,v,b,x=l.quantizationTable,M=u;for(b=0;b<64;b++)M[b]=t[b]*x[b];for(b=0;b<8;++b){var E=8*b;0!=M[1+E]||0!=M[2+E]||0!=M[3+E]||0!=M[4+E]||0!=M[5+E]||0!=M[6+E]||0!=M[7+E]?(d=a*M[0+E]+128>>8,f=a*M[4+E]+128>>8,g=M[2+E],m=M[6+E],p=h*(M[1+E]-M[7+E])+128>>8,y=h*(M[1+E]+M[7+E])+128>>8,_=M[3+E]<<4,w=M[5+E]<<4,v=d-f+1>>1,d=d+f+1>>1,f=v,v=g*o+m*s+128>>8,g=g*s-m*o+128>>8,m=v,v=p-w+1>>1,p=p+w+1>>1,w=v,v=y+_+1>>1,_=y-_+1>>1,y=v,v=d-m+1>>1,d=d+m+1>>1,m=v,v=f-g+1>>1,f=f+g+1>>1,g=v,v=p*r+y*n+2048>>12,p=p*n-y*r+2048>>12,y=v,v=_*i+w*e+2048>>12,_=_*e-w*i+2048>>12,w=v,M[0+E]=d+y,M[7+E]=d-y,M[1+E]=f+w,M[6+E]=f-w,M[2+E]=g+_,M[5+E]=g-_,M[3+E]=m+p,M[4+E]=m-p):(v=a*M[0+E]+512>>10,M[0+E]=v,M[1+E]=v,M[2+E]=v,M[3+E]=v,M[4+E]=v,M[5+E]=v,M[6+E]=v,M[7+E]=v)}for(b=0;b<8;++b){var S=b;0!=M[8+S]||0!=M[16+S]||0!=M[24+S]||0!=M[32+S]||0!=M[40+S]||0!=M[48+S]||0!=M[56+S]?(d=a*M[0+S]+2048>>12,f=a*M[32+S]+2048>>12,g=M[16+S],m=M[48+S],p=h*(M[8+S]-M[56+S])+2048>>12,y=h*(M[8+S]+M[56+S])+2048>>12,_=M[24+S],w=M[40+S],v=d-f+1>>1,d=d+f+1>>1,f=v,v=g*o+m*s+2048>>12,g=g*s-m*o+2048>>12,m=v,v=p-w+1>>1,p=p+w+1>>1,w=v,v=y+_+1>>1,_=y-_+1>>1,y=v,v=d-m+1>>1,d=d+m+1>>1,m=v,v=f-g+1>>1,f=f+g+1>>1,g=v,v=p*r+y*n+2048>>12,p=p*n-y*r+2048>>12,y=v,v=_*i+w*e+2048>>12,_=_*e-w*i+2048>>12,w=v,M[0+S]=d+y,M[56+S]=d-y,M[8+S]=f+w,M[48+S]=f-w,M[16+S]=g+_,M[40+S]=g-_,M[24+S]=m+p,M[32+S]=m-p):(v=a*u[b+0]+8192>>14,M[0+S]=v,M[8+S]=v,M[16+S]=v,M[24+S]=v,M[32+S]=v,M[40+S]=v,M[48+S]=v,M[56+S]=v)}for(b=0;b<64;++b){var k=128+(M[b]+8>>4);c[b]=k<0?0:k>255?255:k}}p(m*g*8);for(var v=0;v<g;v++){var b=v<<3;for(c=0;c<8;c++)d.push(new Uint8Array(m));for(var x=0;x<f;x++){y(l.blocks[v][x],w,_);var M=0,E=x<<3;for(u=0;u<8;u++){var S=d[b+u];for(c=0;c<8;c++)S[E+c]=w[M++]}}}return d}function f(t){return t<0?0:t>255?255:t}l.prototype={load:function(t){var e=new XMLHttpRequest;e.open("GET",t,!0),e.responseType="arraybuffer",e.onload=function(){var t=new Uint8Array(e.response||e.mozResponseArrayBuffer);this.parse(t),this.onload&&this.onload()}.bind(this),e.send(null)},parse:function(e){var i=1e3*this.opts.maxResolutionInMP*1e3,n=0;function r(){var t=e[n]<<8|e[n+1];return n+=2,t}function s(t){var e,i,n=1,r=1;for(i in t.components)t.components.hasOwnProperty(i)&&(n<(e=t.components[i]).h&&(n=e.h),r<e.v&&(r=e.v));var s=Math.ceil(t.samplesPerLine/8/n),o=Math.ceil(t.scanLines/8/r);for(i in t.components)if(t.components.hasOwnProperty(i)){e=t.components[i];var a=Math.ceil(Math.ceil(t.samplesPerLine/8)*e.h/n),h=Math.ceil(Math.ceil(t.scanLines/8)*e.v/r),l=s*e.h,c=o*e.v,u=[];p(c*l*256);for(var d=0;d<c;d++){for(var f=[],g=0;g<l;g++)f.push(new Int32Array(64));u.push(f)}e.blocksPerLine=a,e.blocksPerColumn=h,e.blocks=u}t.maxH=n,t.maxV=r,t.mcusPerLine=s,t.mcusPerColumn=o}e.length;var o,a,h,l,f=null,g=null,m=[],_=[],w=[],y=[],v=r(),b=-1;if(this.comments=[],65496!=v)throw new Error("SOI not found");for(v=r();65497!=v;){switch(v){case 65280:break;case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:var x=(h=void 0,l=void 0,h=r(),l=e.subarray(n,n+h-2),n+=l.length,l);if(65534===v){var M=String.fromCharCode.apply(null,x);this.comments.push(M)}65504===v&&74===x[0]&&70===x[1]&&73===x[2]&&70===x[3]&&0===x[4]&&(f={version:{major:x[5],minor:x[6]},densityUnits:x[7],xDensity:x[8]<<8|x[9],yDensity:x[10]<<8|x[11],thumbWidth:x[12],thumbHeight:x[13],thumbData:x.subarray(14,14+3*x[12]*x[13])}),65505===v&&69===x[0]&&120===x[1]&&105===x[2]&&102===x[3]&&0===x[4]&&(this.exifBuffer=x.subarray(5,x.length)),65518===v&&65===x[0]&&100===x[1]&&111===x[2]&&98===x[3]&&101===x[4]&&0===x[5]&&(g={version:x[6],flags0:x[7]<<8|x[8],flags1:x[9]<<8|x[10],transformCode:x[11]});break;case 65499:for(var E=r()+n-2;n<E;){var S=e[n++];p(256);var k=new Int32Array(64);if(S>>4==0)for(Z=0;Z<64;Z++)k[t[Z]]=e[n++];else{if(S>>4!=1)throw new Error("DQT: invalid table spec");for(Z=0;Z<64;Z++)k[t[Z]]=r()}m[15&S]=k}break;case 65472:case 65473:case 65474:r(),(o={}).extended=65473===v,o.progressive=65474===v,o.precision=e[n++],o.scanLines=r(),o.samplesPerLine=r(),o.components={},o.componentsOrder=[];var C=o.scanLines*o.samplesPerLine;if(C>i){var I=Math.ceil((C-i)/1e6);throw new Error(`maxResolutionInMP limit exceeded by ${I}MP`)}var A,T=e[n++];for(q=0;q<T;q++){A=e[n];var R=e[n+1]>>4,P=15&e[n+1],D=e[n+2];if(R<=0||P<=0)throw new Error("Invalid sampling factor, expected values above 0");o.componentsOrder.push(A),o.components[A]={h:R,v:P,quantizationIdx:D},n+=3}s(o),_.push(o);break;case 65476:var F=r();for(q=2;q<F;){var L=e[n++],O=new Uint8Array(16),N=0;for(Z=0;Z<16;Z++,n++)N+=O[Z]=e[n];p(16+N);var B=new Uint8Array(N);for(Z=0;Z<N;Z++,n++)B[Z]=e[n];q+=17+N,(L>>4==0?y:w)[15&L]=c(O,B)}break;case 65501:r(),a=r();break;case 65500:r(),r();break;case 65498:r();var z=e[n++],U=[];for(q=0;q<z;q++){K=o.components[e[n++]];var G=e[n++];K.huffmanTableDC=y[G>>4],K.huffmanTableAC=w[15&G],U.push(K)}var Y=e[n++],X=e[n++],V=e[n++],j=u(e,n,o,U,a,Y,X,V>>4,15&V,this.opts);n+=j;break;case 65535:255!==e[n]&&n--;break;default:if(255==e[n-3]&&e[n-2]>=192&&e[n-2]<=254){n-=3;break}if(224===v||225==v){if(-1!==b)throw new Error(`first unknown JPEG marker at offset ${b.toString(16)}, second unknown JPEG marker ${v.toString(16)} at offset ${(n-1).toString(16)}`);b=n-1;const t=r();if(255===e[n+t-2]){n+=t-2;break}}throw new Error("unknown JPEG marker "+v.toString(16))}v=r()}if(1!=_.length)throw new Error("only single frame JPEGs supported");for(var q=0;q<_.length;q++){var W=_[q].components;for(var Z in W)W[Z].quantizationTable=m[W[Z].quantizationIdx],delete W[Z].quantizationIdx}for(this.width=o.samplesPerLine,this.height=o.scanLines,this.jfif=f,this.adobe=g,this.components=[],q=0;q<o.componentsOrder.length;q++){var K=o.components[o.componentsOrder[q]];this.components.push({lines:d(0,K),scaleX:K.h/o.maxH,scaleY:K.v/o.maxV})}},getData:function(t,e){var i,n,r,s,o,a,h,l,c,u,d,g,m,_,w,y,v,b,x,M,E,S=this.width/t,k=this.height/e,C=0,I=t*e*this.components.length;p(I);var A=new Uint8Array(I);switch(this.components.length){case 1:for(i=this.components[0],u=0;u<e;u++)for(o=i.lines[0|u*i.scaleY*k],c=0;c<t;c++)d=o[0|c*i.scaleX*S],A[C++]=d;break;case 2:for(i=this.components[0],n=this.components[1],u=0;u<e;u++)for(o=i.lines[0|u*i.scaleY*k],a=n.lines[0|u*n.scaleY*k],c=0;c<t;c++)d=o[0|c*i.scaleX*S],A[C++]=d,d=a[0|c*n.scaleX*S],A[C++]=d;break;case 3:for(E=!0,this.adobe&&this.adobe.transformCode?E=!0:void 0!==this.opts.colorTransform&&(E=!!this.opts.colorTransform),i=this.components[0],n=this.components[1],r=this.components[2],u=0;u<e;u++)for(o=i.lines[0|u*i.scaleY*k],a=n.lines[0|u*n.scaleY*k],h=r.lines[0|u*r.scaleY*k],c=0;c<t;c++)E?(d=o[0|c*i.scaleX*S],g=a[0|c*n.scaleX*S],b=f(d+1.402*((m=h[0|c*r.scaleX*S])-128)),x=f(d-.3441363*(g-128)-.71413636*(m-128)),M=f(d+1.772*(g-128))):(b=o[0|c*i.scaleX*S],x=a[0|c*n.scaleX*S],M=h[0|c*r.scaleX*S]),A[C++]=b,A[C++]=x,A[C++]=M;break;case 4:if(!this.adobe)throw new Error("Unsupported color mode (4 components)");for(E=!1,this.adobe&&this.adobe.transformCode?E=!0:void 0!==this.opts.colorTransform&&(E=!!this.opts.colorTransform),i=this.components[0],n=this.components[1],r=this.components[2],s=this.components[3],u=0;u<e;u++)for(o=i.lines[0|u*i.scaleY*k],a=n.lines[0|u*n.scaleY*k],h=r.lines[0|u*r.scaleY*k],l=s.lines[0|u*s.scaleY*k],c=0;c<t;c++)E?(d=o[0|c*i.scaleX*S],g=a[0|c*n.scaleX*S],m=h[0|c*r.scaleX*S],_=l[0|c*s.scaleX*S],w=255-f(d+1.402*(m-128)),y=255-f(d-.3441363*(g-128)-.71413636*(m-128)),v=255-f(d+1.772*(g-128))):(w=o[0|c*i.scaleX*S],y=a[0|c*n.scaleX*S],v=h[0|c*r.scaleX*S],_=l[0|c*s.scaleX*S]),A[C++]=255-w,A[C++]=255-y,A[C++]=255-v,A[C++]=255-_;break;default:throw new Error("Unsupported color mode")}return A},copyToImageData:function(t,e){var i,n,r,s,o,a,h,l,c,u=t.width,d=t.height,g=t.data,m=this.getData(u,d),p=0,_=0;switch(this.components.length){case 1:for(n=0;n<d;n++)for(i=0;i<u;i++)r=m[p++],g[_++]=r,g[_++]=r,g[_++]=r,e&&(g[_++]=255);break;case 3:for(n=0;n<d;n++)for(i=0;i<u;i++)h=m[p++],l=m[p++],c=m[p++],g[_++]=h,g[_++]=l,g[_++]=c,e&&(g[_++]=255);break;case 4:for(n=0;n<d;n++)for(i=0;i<u;i++)o=m[p++],a=m[p++],r=m[p++],h=255-f(o*(1-(s=m[p++])/255)+s),l=255-f(a*(1-s/255)+s),c=255-f(r*(1-s/255)+s),g[_++]=h,g[_++]=l,g[_++]=c,e&&(g[_++]=255);break;default:throw new Error("Unsupported color mode")}}};var g=0,m=0;function p(t=0){var e=g+t;if(e>m){var i=Math.ceil((e-m)/1024/1024);throw new Error(`maxMemoryUsageInMB limit exceeded by at least ${i}MB`)}g=e}return l.resetMaxMemoryUsage=function(t){g=0,m=t},l.getBytesAllocated=function(){return g},l.requestMemoryAllocation=p,l}();t.exports=function(t,i={}){var n={colorTransform:void 0,useTArray:!1,formatAsRGBA:!0,tolerantDecoding:!0,maxResolutionInMP:100,maxMemoryUsageInMB:512,...i},r=new Uint8Array(t),s=new e;s.opts=n,e.resetMaxMemoryUsage(1024*n.maxMemoryUsageInMB*1024),s.parse(r);var o=n.formatAsRGBA?4:3,a=s.width*s.height*o;try{e.requestMemoryAllocation(a);var h={width:s.width,height:s.height,exifBuffer:s.exifBuffer,data:n.useTArray?new Uint8Array(a):Buffer.alloc(a)};s.comments.length>0&&(h.comments=s.comments)}catch(t){if(t instanceof RangeError)throw new Error("Could not allocate enough memory for the image. Required: "+a);if(t instanceof ReferenceError&&"Buffer is not defined"===t.message)throw new Error("Buffer is not globally defined in this environment. Consider setting useTArray to true");throw t}return s.copyToImageData(h,n.formatAsRGBA),h}},587:t=>{function e(t){Math.round;var e,i,n,r,s,o=Math.floor,a=new Array(64),h=new Array(64),l=new Array(64),c=new Array(64),u=new Array(65535),d=new Array(65535),f=new Array(64),g=new Array(64),m=[],p=0,_=7,w=new Array(64),y=new Array(64),v=new Array(64),b=new Array(256),x=new Array(2048),M=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],E=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],S=[0,1,2,3,4,5,6,7,8,9,10,11],k=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],C=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],I=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],A=[0,1,2,3,4,5,6,7,8,9,10,11],T=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],R=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function P(t,e){for(var i=0,n=0,r=new Array,s=1;s<=16;s++){for(var o=1;o<=t[s];o++)r[e[n]]=[],r[e[n]][0]=i,r[e[n]][1]=s,n++,i++;i*=2}return r}function D(t){for(var e=t[0],i=t[1]-1;i>=0;)e&1<<i&&(p|=1<<_),i--,--_<0&&(255==p?(F(255),F(0)):F(p),_=7,p=0)}function F(t){m.push(t)}function L(t){F(t>>8&255),F(255&t)}function O(t,e,i,n,r){for(var s,o=r[0],a=r[240],h=function(t,e){var i,n,r,s,o,a,h,l,c,u,d=0;for(c=0;c<8;++c){i=t[d],n=t[d+1],r=t[d+2],s=t[d+3],o=t[d+4],a=t[d+5],h=t[d+6];var g=i+(l=t[d+7]),m=i-l,p=n+h,_=n-h,w=r+a,y=r-a,v=s+o,b=s-o,x=g+v,M=g-v,E=p+w,S=p-w;t[d]=x+E,t[d+4]=x-E;var k=.707106781*(S+M);t[d+2]=M+k,t[d+6]=M-k;var C=.382683433*((x=b+y)-(S=_+m)),I=.5411961*x+C,A=1.306562965*S+C,T=.707106781*(E=y+_),R=m+T,P=m-T;t[d+5]=P+I,t[d+3]=P-I,t[d+1]=R+A,t[d+7]=R-A,d+=8}for(d=0,c=0;c<8;++c){i=t[d],n=t[d+8],r=t[d+16],s=t[d+24],o=t[d+32],a=t[d+40],h=t[d+48];var D=i+(l=t[d+56]),F=i-l,L=n+h,O=n-h,N=r+a,B=r-a,z=s+o,U=s-o,G=D+z,Y=D-z,X=L+N,V=L-N;t[d]=G+X,t[d+32]=G-X;var j=.707106781*(V+Y);t[d+16]=Y+j,t[d+48]=Y-j;var q=.382683433*((G=U+B)-(V=O+F)),W=.5411961*G+q,Z=1.306562965*V+q,K=.707106781*(X=B+O),H=F+K,$=F-K;t[d+40]=$+W,t[d+24]=$-W,t[d+8]=H+Z,t[d+56]=H-Z,d++}for(c=0;c<64;++c)u=t[c]*e[c],f[c]=u>0?u+.5|0:u-.5|0;return f}(t,e),l=0;l<64;++l)g[M[l]]=h[l];var c=g[0]-i;i=g[0],0==c?D(n[0]):(D(n[d[s=32767+c]]),D(u[s]));for(var m=63;m>0&&0==g[m];m--);if(0==m)return D(o),i;for(var p,_=1;_<=m;){for(var w=_;0==g[_]&&_<=m;++_);var y=_-w;if(y>=16){p=y>>4;for(var v=1;v<=p;++v)D(a);y&=15}s=32767+g[_],D(r[(y<<4)+d[s]]),D(u[s]),_++}return 63!=m&&D(o),i}function N(t){t<=0&&(t=1),t>100&&(t=100),s!=t&&(function(t){for(var e=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],i=0;i<64;i++){var n=o((e[i]*t+50)/100);n<1?n=1:n>255&&(n=255),a[M[i]]=n}for(var r=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],s=0;s<64;s++){var u=o((r[s]*t+50)/100);u<1?u=1:u>255&&(u=255),h[M[s]]=u}for(var d=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],f=0,g=0;g<8;g++)for(var m=0;m<8;m++)l[f]=1/(a[M[f]]*d[g]*d[m]*8),c[f]=1/(h[M[f]]*d[g]*d[m]*8),f++}(t<50?Math.floor(5e3/t):Math.floor(200-2*t)),s=t)}this.encode=function(t,s){var o;(new Date).getTime(),s&&N(s),m=new Array,p=0,_=7,L(65496),L(65504),L(16),F(74),F(70),F(73),F(70),F(0),F(1),F(1),F(0),L(1),L(1),F(0),F(0),void 0!==(o=t.comments)&&o.constructor===Array&&o.forEach((t=>{if("string"==typeof t){L(65534);var e,i=t.length;for(L(i+2),e=0;e<i;e++)F(t.charCodeAt(e))}})),function(t){if(t){L(65505),69===t[0]&&120===t[1]&&105===t[2]&&102===t[3]?L(t.length+2):(L(t.length+5+2),F(69),F(120),F(105),F(102),F(0));for(var e=0;e<t.length;e++)F(t[e])}}(t.exifBuffer),function(){L(65499),L(132),F(0);for(var t=0;t<64;t++)F(a[t]);F(1);for(var e=0;e<64;e++)F(h[e])}(),function(t,e){L(65472),L(17),F(8),L(e),L(t),F(3),F(1),F(17),F(0),F(2),F(17),F(1),F(3),F(17),F(1)}(t.width,t.height),function(){L(65476),L(418),F(0);for(var t=0;t<16;t++)F(E[t+1]);for(var e=0;e<=11;e++)F(S[e]);F(16);for(var i=0;i<16;i++)F(k[i+1]);for(var n=0;n<=161;n++)F(C[n]);F(1);for(var r=0;r<16;r++)F(I[r+1]);for(var s=0;s<=11;s++)F(A[s]);F(17);for(var o=0;o<16;o++)F(T[o+1]);for(var a=0;a<=161;a++)F(R[a])}(),L(65498),L(12),F(3),F(1),F(0),F(2),F(17),F(3),F(17),F(0),F(63),F(0);var u=0,d=0,f=0;p=0,_=7,this.encode.displayName="_encode_";for(var g,b,M,P,B,z,U,G,Y,X=t.data,V=t.width,j=t.height,q=4*V,W=0;W<j;){for(g=0;g<q;){for(z=B=q*W+g,U=-1,G=0,Y=0;Y<64;Y++)z=B+(G=Y>>3)*q+(U=4*(7&Y)),W+G>=j&&(z-=q*(W+1+G-j)),g+U>=q&&(z-=g+U-q+4),b=X[z++],M=X[z++],P=X[z++],w[Y]=(x[b]+x[M+256>>0]+x[P+512>>0]>>16)-128,y[Y]=(x[b+768>>0]+x[M+1024>>0]+x[P+1280>>0]>>16)-128,v[Y]=(x[b+1280>>0]+x[M+1536>>0]+x[P+1792>>0]>>16)-128;u=O(w,l,u,e,n),d=O(y,c,d,i,r),f=O(v,c,f,i,r),g+=32}W+=8}if(_>=0){var Z=[];Z[1]=_+1,Z[0]=(1<<_+1)-1,D(Z)}return L(65497),Buffer.from(m)},(new Date).getTime(),t||(t=50),function(){for(var t=String.fromCharCode,e=0;e<256;e++)b[e]=t(e)}(),e=P(E,S),i=P(I,A),n=P(k,C),r=P(T,R),function(){for(var t=1,e=2,i=1;i<=15;i++){for(var n=t;n<e;n++)d[32767+n]=i,u[32767+n]=[],u[32767+n][1]=i,u[32767+n][0]=n;for(var r=-(e-1);r<=-t;r++)d[32767+r]=i,u[32767+r]=[],u[32767+r][1]=i,u[32767+r][0]=e-1+r;t<<=1,e<<=1}}(),function(){for(var t=0;t<256;t++)x[t]=19595*t,x[t+256>>0]=38470*t,x[t+512>>0]=7471*t+32768,x[t+768>>0]=-11059*t,x[t+1024>>0]=-21709*t,x[t+1280>>0]=32768*t+8421375,x[t+1536>>0]=-27439*t,x[t+1792>>0]=-5329*t}(),N(t),(new Date).getTime()}t.exports=function(t,i){return void 0===i&&(i=50),{data:new e(i).encode(t,i),width:t.width,height:t.height}}},5307:t=>{t.exports=function t(e,i,n){function r(o,a){if(!i[o]){if(!e[o]){if(s)return s(o,!0);var h=new Error("Cannot find module '"+o+"'");throw h.code="MODULE_NOT_FOUND",h}var l=i[o]={exports:{}};e[o][0].call(l.exports,(function(t){return r(e[o][1][t]||t)}),l,l.exports,t,e,i,n)}return i[o].exports}for(var s=void 0,o=0;o<n.length;o++)r(n[o]);return r}({1:[function(t,e,i){var n,r,s,o,a,h={}.hasOwnProperty;n=t("./PriorityQueue/AbstractPriorityQueue"),r=t("./PriorityQueue/ArrayStrategy"),o=t("./PriorityQueue/BinaryHeapStrategy"),s=t("./PriorityQueue/BHeapStrategy"),(a=function(t){function e(t){t||(t={}),t.strategy||(t.strategy=o),t.comparator||(t.comparator=function(t,e){return(t||0)-(e||0)}),e.__super__.constructor.call(this,t)}return function(t,e){for(var i in e)h.call(e,i)&&(t[i]=e[i]);function n(){this.constructor=t}n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype}(e,t),e}(n)).ArrayStrategy=r,a.BinaryHeapStrategy=o,a.BHeapStrategy=s,e.exports=a},{"./PriorityQueue/AbstractPriorityQueue":2,"./PriorityQueue/ArrayStrategy":3,"./PriorityQueue/BHeapStrategy":4,"./PriorityQueue/BinaryHeapStrategy":5}],2:[function(t,e,i){e.exports=function(){function t(t){var e;if(null==(null!=t?t.strategy:void 0))throw"Must pass options.strategy, a strategy";if(null==(null!=t?t.comparator:void 0))throw"Must pass options.comparator, a comparator";this.priv=new t.strategy(t),this.length=(null!=t&&null!=(e=t.initialValues)?e.length:void 0)||0}return t.prototype.queue=function(t){this.length++,this.priv.queue(t)},t.prototype.dequeue=function(t){if(!this.length)throw"Empty queue";return this.length--,this.priv.dequeue()},t.prototype.peek=function(t){if(!this.length)throw"Empty queue";return this.priv.peek()},t.prototype.clear=function(){return this.length=0,this.priv.clear()},t}()},{}],3:[function(t,e,i){var n;n=function(t,e,i){var n,r,s;for(r=0,n=t.length;r<n;)i(t[s=r+n>>>1],e)>=0?r=s+1:n=s;return r},e.exports=function(){function t(t){var e;this.options=t,this.comparator=this.options.comparator,this.data=(null!=(e=this.options.initialValues)?e.slice(0):void 0)||[],this.data.sort(this.comparator).reverse()}return t.prototype.queue=function(t){var e;e=n(this.data,t,this.comparator),this.data.splice(e,0,t)},t.prototype.dequeue=function(){return this.data.pop()},t.prototype.peek=function(){return this.data[this.data.length-1]},t.prototype.clear=function(){this.data.length=0},t}()},{}],4:[function(t,e,i){e.exports=function(){function t(t){var e,i,n,r,s,o,a,h;for(this.comparator=(null!=t?t.comparator:void 0)||function(t,e){return t-e},this.pageSize=(null!=t?t.pageSize:void 0)||512,this.length=0,a=0;1<<a<this.pageSize;)a+=1;if(1<<a!==this.pageSize)throw"pageSize must be a power of two";for(this._shift=a,this._emptyMemoryPageTemplate=e=[],i=0,s=this.pageSize;0<=s?i<s:i>s;0<=s?++i:--i)e.push(null);if(this._memory=[],this._mask=this.pageSize-1,t.initialValues)for(n=0,r=(o=t.initialValues).length;n<r;n++)h=o[n],this.queue(h)}return t.prototype.queue=function(t){this.length+=1,this._write(this.length,t),this._bubbleUp(this.length,t)},t.prototype.dequeue=function(){var t,e;return t=this._read(1),e=this._read(this.length),this.length-=1,this.length>0&&(this._write(1,e),this._bubbleDown(1,e)),t},t.prototype.peek=function(){return this._read(1)},t.prototype.clear=function(){this.length=0,this._memory.length=0},t.prototype._write=function(t,e){var i;for(i=t>>this._shift;i>=this._memory.length;)this._memory.push(this._emptyMemoryPageTemplate.slice(0));return this._memory[i][t&this._mask]=e},t.prototype._read=function(t){return this._memory[t>>this._shift][t&this._mask]},t.prototype._bubbleUp=function(t,e){var i,n,r,s;for(i=this.comparator;t>1&&(n=t&this._mask,t<this.pageSize||n>3?r=t&~this._mask|n>>1:n<2?(r=t-this.pageSize>>this._shift,r+=r&~(this._mask>>1),r|=this.pageSize>>1):r=t-2,!(i(s=this._read(r),e)<0));)this._write(r,e),this._write(t,s),t=r},t.prototype._bubbleDown=function(t,e){var i,n,r,s,o;for(o=this.comparator;t<this.length;)if(t>this._mask&&!(t&this._mask-1)?i=n=t+2:t&this.pageSize>>1?(i=(t&~this._mask)>>1,n=1+(i=1+(i|=t&this._mask>>1)<<this._shift)):n=(i=t+(t&this._mask))+1,i!==n&&n<=this.length)if(r=this._read(i),s=this._read(n),o(r,e)<0&&o(r,s)<=0)this._write(i,e),this._write(t,r),t=i;else{if(!(o(s,e)<0))break;this._write(n,e),this._write(t,s),t=n}else{if(!(i<=this.length))break;if(!(o(r=this._read(i),e)<0))break;this._write(i,e),this._write(t,r),t=i}},t}()},{}],5:[function(t,e,i){e.exports=function(){function t(t){var e;this.comparator=(null!=t?t.comparator:void 0)||function(t,e){return t-e},this.length=0,this.data=(null!=(e=t.initialValues)?e.slice(0):void 0)||[],this._heapify()}return t.prototype._heapify=function(){var t,e,i;if(this.data.length>0)for(t=e=1,i=this.data.length;1<=i?e<i:e>i;t=1<=i?++e:--e)this._bubbleUp(t)},t.prototype.queue=function(t){this.data.push(t),this._bubbleUp(this.data.length-1)},t.prototype.dequeue=function(){var t,e;return e=this.data[0],t=this.data.pop(),this.data.length>0&&(this.data[0]=t,this._bubbleDown(0)),e},t.prototype.peek=function(){return this.data[0]},t.prototype.clear=function(){this.length=0,this.data.length=0},t.prototype._bubbleUp=function(t){for(var e,i;t>0&&(e=t-1>>>1,this.comparator(this.data[t],this.data[e])<0);)i=this.data[e],this.data[e]=this.data[t],this.data[t]=i,t=e},t.prototype._bubbleDown=function(t){var e,i,n,r,s;for(e=this.data.length-1;r=1+(i=1+(t<<1)),n=t,i<=e&&this.comparator(this.data[i],this.data[n])<0&&(n=i),r<=e&&this.comparator(this.data[r],this.data[n])<0&&(n=r),n!==t;)s=this.data[n],this.data[n]=this.data[t],this.data[t]=s,t=n},t}()},{}]},{},[1])(1)},2229:function(t){t.exports=function(){"use strict";function t(t){return"string"==typeof t||t instanceof String}var e=Number.isFinite||window.isFinite;function i(t){return e(t)}function n(t){return t}function r(t,e){if(e.length!==t.length)return!1;for(var i=0;i<t.length;i++){if(e[i].compareArray&&!e[i].compareArray(t[i]))return!1;if(e[i]!==t[i])return!1}return!0}function s(t,e){Object.keys(e).forEach((function(i){t[i]=e[i]}))}function o(){for(var t=1,e=0,i=0;i<arguments.length;i++){var n=arguments[i];e+=l(n),t*=n}return 0!==e?h(t,e):t}function a(t,e){if(0===e)throw new Error("Divide by zero");var i=Math.pow(10,l(e));return o(t,i/(i*e))}function h(t,e){return Math.round(t*Math.pow(10,e))/Math.pow(10,e)}function l(t){if(!isFinite(t))return 0;for(var e=0;t%1!=0;)t*=10,e++;return e}function c(){var t;if(!this)return t=Object.create(c.prototype),c.apply(t,arguments),t;t=Error.apply(this,arguments),this.name="QtyError",this.message=t.message,this.stack=t.stack}function u(t,e){throw new c("Incompatible units: "+t+" and "+e)}c.prototype=Object.create(Error.prototype,{constructor:{value:c}});var d={"<googol>":[["googol"],1e100,"prefix"],"<kibi>":[["Ki","Kibi","kibi"],Math.pow(2,10),"prefix"],"<mebi>":[["Mi","Mebi","mebi"],Math.pow(2,20),"prefix"],"<gibi>":[["Gi","Gibi","gibi"],Math.pow(2,30),"prefix"],"<tebi>":[["Ti","Tebi","tebi"],Math.pow(2,40),"prefix"],"<pebi>":[["Pi","Pebi","pebi"],Math.pow(2,50),"prefix"],"<exi>":[["Ei","Exi","exi"],Math.pow(2,60),"prefix"],"<zebi>":[["Zi","Zebi","zebi"],Math.pow(2,70),"prefix"],"<yebi>":[["Yi","Yebi","yebi"],Math.pow(2,80),"prefix"],"<yotta>":[["Y","Yotta","yotta"],1e24,"prefix"],"<zetta>":[["Z","Zetta","zetta"],1e21,"prefix"],"<exa>":[["E","Exa","exa"],1e18,"prefix"],"<peta>":[["P","Peta","peta"],1e15,"prefix"],"<tera>":[["T","Tera","tera"],1e12,"prefix"],"<giga>":[["G","Giga","giga"],1e9,"prefix"],"<mega>":[["M","Mega","mega"],1e6,"prefix"],"<kilo>":[["k","kilo"],1e3,"prefix"],"<hecto>":[["h","Hecto","hecto"],100,"prefix"],"<deca>":[["da","Deca","deca","deka"],10,"prefix"],"<deci>":[["d","Deci","deci"],.1,"prefix"],"<centi>":[["c","Centi","centi"],.01,"prefix"],"<milli>":[["m","Milli","milli"],.001,"prefix"],"<micro>":[["u","μ","µ","Micro","mc","micro"],1e-6,"prefix"],"<nano>":[["n","Nano","nano"],1e-9,"prefix"],"<pico>":[["p","Pico","pico"],1e-12,"prefix"],"<femto>":[["f","Femto","femto"],1e-15,"prefix"],"<atto>":[["a","Atto","atto"],1e-18,"prefix"],"<zepto>":[["z","Zepto","zepto"],1e-21,"prefix"],"<yocto>":[["y","Yocto","yocto"],1e-24,"prefix"],"<1>":[["1","<1>"],1,""],"<meter>":[["m","meter","meters","metre","metres"],1,"length",["<meter>"]],"<inch>":[["in","inch","inches",'"'],.0254,"length",["<meter>"]],"<foot>":[["ft","foot","feet","'"],.3048,"length",["<meter>"]],"<yard>":[["yd","yard","yards"],.9144,"length",["<meter>"]],"<mile>":[["mi","mile","miles"],1609.344,"length",["<meter>"]],"<naut-mile>":[["nmi","naut-mile"],1852,"length",["<meter>"]],"<league>":[["league","leagues"],4828,"length",["<meter>"]],"<furlong>":[["furlong","furlongs"],201.2,"length",["<meter>"]],"<rod>":[["rd","rod","rods"],5.029,"length",["<meter>"]],"<mil>":[["mil","mils"],254e-7,"length",["<meter>"]],"<angstrom>":[["ang","angstrom","angstroms"],1e-10,"length",["<meter>"]],"<fathom>":[["fathom","fathoms"],1.829,"length",["<meter>"]],"<pica>":[["pica","picas"],.00423333333,"length",["<meter>"]],"<point>":[["pt","point","points"],.000352777778,"length",["<meter>"]],"<redshift>":[["z","red-shift","redshift"],1302773e20,"length",["<meter>"]],"<AU>":[["AU","astronomical-unit"],1495979e5,"length",["<meter>"]],"<light-second>":[["ls","light-second"],299792500,"length",["<meter>"]],"<light-minute>":[["lmin","light-minute"],1798755e4,"length",["<meter>"]],"<light-year>":[["ly","light-year"],9460528e9,"length",["<meter>"]],"<parsec>":[["pc","parsec","parsecs"],3085678e10,"length",["<meter>"]],"<datamile>":[["DM","datamile"],1828.8,"length",["<meter>"]],"<kilogram>":[["kg","kilogram","kilograms"],1,"mass",["<kilogram>"]],"<AMU>":[["u","AMU","amu"],1660538921e-36,"mass",["<kilogram>"]],"<dalton>":[["Da","Dalton","Daltons","dalton","daltons"],1660538921e-36,"mass",["<kilogram>"]],"<slug>":[["slug","slugs"],14.5939029,"mass",["<kilogram>"]],"<short-ton>":[["tn","ton","short-ton"],907.18474,"mass",["<kilogram>"]],"<metric-ton>":[["t","tonne","metric-ton"],1e3,"mass",["<kilogram>"]],"<carat>":[["ct","carat","carats"],2e-4,"mass",["<kilogram>"]],"<pound>":[["lbs","lb","pound","pounds","#"],.45359237,"mass",["<kilogram>"]],"<ounce>":[["oz","ounce","ounces"],.0283495231,"mass",["<kilogram>"]],"<gram>":[["g","gram","grams","gramme","grammes"],.001,"mass",["<kilogram>"]],"<grain>":[["grain","grains","gr"],6479891e-11,"mass",["<kilogram>"]],"<dram>":[["dram","drams","dr"],.0017718452,"mass",["<kilogram>"]],"<stone>":[["stone","stones","st"],6.35029318,"mass",["<kilogram>"]],"<hectare>":[["hectare"],1e4,"area",["<meter>","<meter>"]],"<acre>":[["acre","acres"],4046.85642,"area",["<meter>","<meter>"]],"<sqft>":[["sqft"],1,"area",["<foot>","<foot>"]],"<liter>":[["l","L","liter","liters","litre","litres"],.001,"volume",["<meter>","<meter>","<meter>"]],"<gallon>":[["gal","gallon","gallons"],.0037854118,"volume",["<meter>","<meter>","<meter>"]],"<gallon-imp>":[["galimp","gallon-imp","gallons-imp"],.00454609,"volume",["<meter>","<meter>","<meter>"]],"<quart>":[["qt","quart","quarts"],.00094635295,"volume",["<meter>","<meter>","<meter>"]],"<pint>":[["pt","pint","pints"],.000473176475,"volume",["<meter>","<meter>","<meter>"]],"<pint-imp>":[["ptimp","pint-imp","pints-imp"],.00056826125,"volume",["<meter>","<meter>","<meter>"]],"<cup>":[["cu","cup","cups"],.000236588238,"volume",["<meter>","<meter>","<meter>"]],"<fluid-ounce>":[["floz","fluid-ounce","fluid-ounces"],295735297e-13,"volume",["<meter>","<meter>","<meter>"]],"<fluid-ounce-imp>":[["flozimp","floz-imp","fluid-ounce-imp","fluid-ounces-imp"],284130625e-13,"volume",["<meter>","<meter>","<meter>"]],"<tablespoon>":[["tb","tbsp","tbs","tablespoon","tablespoons"],147867648e-13,"volume",["<meter>","<meter>","<meter>"]],"<teaspoon>":[["tsp","teaspoon","teaspoons"],492892161e-14,"volume",["<meter>","<meter>","<meter>"]],"<bushel>":[["bu","bsh","bushel","bushels"],.035239072,"volume",["<meter>","<meter>","<meter>"]],"<oilbarrel>":[["bbl","oilbarrel","oilbarrels","oil-barrel","oil-barrels"],.158987294928,"volume",["<meter>","<meter>","<meter>"]],"<beerbarrel>":[["bl","bl-us","beerbarrel","beerbarrels","beer-barrel","beer-barrels"],.1173477658,"volume",["<meter>","<meter>","<meter>"]],"<beerbarrel-imp>":[["blimp","bl-imp","beerbarrel-imp","beerbarrels-imp","beer-barrel-imp","beer-barrels-imp"],.16365924,"volume",["<meter>","<meter>","<meter>"]],"<kph>":[["kph"],.277777778,"speed",["<meter>"],["<second>"]],"<mph>":[["mph"],.44704,"speed",["<meter>"],["<second>"]],"<knot>":[["kt","kn","kts","knot","knots"],.514444444,"speed",["<meter>"],["<second>"]],"<fps>":[["fps"],.3048,"speed",["<meter>"],["<second>"]],"<gee>":[["gee"],9.80665,"acceleration",["<meter>"],["<second>","<second>"]],"<Gal>":[["Gal"],.01,"acceleration",["<meter>"],["<second>","<second>"]],"<kelvin>":[["degK","kelvin"],1,"temperature",["<kelvin>"]],"<celsius>":[["degC","celsius","celsius","centigrade"],1,"temperature",["<kelvin>"]],"<fahrenheit>":[["degF","fahrenheit"],5/9,"temperature",["<kelvin>"]],"<rankine>":[["degR","rankine"],5/9,"temperature",["<kelvin>"]],"<temp-K>":[["tempK","temp-K"],1,"temperature",["<temp-K>"]],"<temp-C>":[["tempC","temp-C"],1,"temperature",["<temp-K>"]],"<temp-F>":[["tempF","temp-F"],5/9,"temperature",["<temp-K>"]],"<temp-R>":[["tempR","temp-R"],5/9,"temperature",["<temp-K>"]],"<second>":[["s","sec","secs","second","seconds"],1,"time",["<second>"]],"<minute>":[["min","mins","minute","minutes"],60,"time",["<second>"]],"<hour>":[["h","hr","hrs","hour","hours"],3600,"time",["<second>"]],"<day>":[["d","day","days"],86400,"time",["<second>"]],"<week>":[["wk","week","weeks"],604800,"time",["<second>"]],"<fortnight>":[["fortnight","fortnights"],1209600,"time",["<second>"]],"<year>":[["y","yr","year","years","annum"],31556926,"time",["<second>"]],"<decade>":[["decade","decades"],315569260,"time",["<second>"]],"<century>":[["century","centuries"],3155692600,"time",["<second>"]],"<pascal>":[["Pa","pascal","Pascal"],1,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<bar>":[["bar","bars"],1e5,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<mmHg>":[["mmHg"],133.322368,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<inHg>":[["inHg"],3386.3881472,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<torr>":[["torr"],133.322368,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<atm>":[["atm","ATM","atmosphere","atmospheres"],101325,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<psi>":[["psi"],6894.76,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<cmh2o>":[["cmH2O","cmh2o"],98.0638,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<inh2o>":[["inH2O","inh2o"],249.082052,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<poise>":[["P","poise"],.1,"viscosity",["<kilogram>"],["<meter>","<second>"]],"<stokes>":[["St","stokes"],1e-4,"viscosity",["<meter>","<meter>"],["<second>"]],"<mole>":[["mol","mole"],1,"substance",["<mole>"]],"<molar>":[["M","molar"],1e3,"molar_concentration",["<mole>"],["<meter>","<meter>","<meter>"]],"<wtpercent>":[["wt%","wtpercent"],10,"molar_concentration",["<kilogram>"],["<meter>","<meter>","<meter>"]],"<katal>":[["kat","katal","Katal"],1,"activity",["<mole>"],["<second>"]],"<unit>":[["U","enzUnit","unit"],16667e-19,"activity",["<mole>"],["<second>"]],"<farad>":[["F","farad","Farad"],1,"capacitance",["<second>","<second>","<second>","<second>","<ampere>","<ampere>"],["<meter>","<meter>","<kilogram>"]],"<coulomb>":[["C","coulomb","Coulomb"],1,"charge",["<ampere>","<second>"]],"<Ah>":[["Ah"],3600,"charge",["<ampere>","<second>"]],"<ampere>":[["A","Ampere","ampere","amp","amps"],1,"current",["<ampere>"]],"<siemens>":[["S","Siemens","siemens"],1,"conductance",["<second>","<second>","<second>","<ampere>","<ampere>"],["<kilogram>","<meter>","<meter>"]],"<henry>":[["H","Henry","henry"],1,"inductance",["<meter>","<meter>","<kilogram>"],["<second>","<second>","<ampere>","<ampere>"]],"<volt>":[["V","Volt","volt","volts"],1,"potential",["<meter>","<meter>","<kilogram>"],["<second>","<second>","<second>","<ampere>"]],"<ohm>":[["Ohm","ohm","Ω","Ω"],1,"resistance",["<meter>","<meter>","<kilogram>"],["<second>","<second>","<second>","<ampere>","<ampere>"]],"<weber>":[["Wb","weber","webers"],1,"magnetism",["<meter>","<meter>","<kilogram>"],["<second>","<second>","<ampere>"]],"<tesla>":[["T","tesla","teslas"],1,"magnetism",["<kilogram>"],["<second>","<second>","<ampere>"]],"<gauss>":[["G","gauss"],1e-4,"magnetism",["<kilogram>"],["<second>","<second>","<ampere>"]],"<maxwell>":[["Mx","maxwell","maxwells"],1e-8,"magnetism",["<meter>","<meter>","<kilogram>"],["<second>","<second>","<ampere>"]],"<oersted>":[["Oe","oersted","oersteds"],250/Math.PI,"magnetism",["<ampere>"],["<meter>"]],"<joule>":[["J","joule","Joule","joules","Joules"],1,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<erg>":[["erg","ergs"],1e-7,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<btu>":[["BTU","btu","BTUs"],1055.056,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<calorie>":[["cal","calorie","calories"],4.184,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<Calorie>":[["Cal","Calorie","Calories"],4184,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<therm-US>":[["th","therm","therms","Therm","therm-US"],105480400,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<Wh>":[["Wh"],3600,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<electronvolt>":[["eV","electronvolt","electronvolts"],1602176634e-28,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<newton>":[["N","Newton","newton"],1,"force",["<kilogram>","<meter>"],["<second>","<second>"]],"<dyne>":[["dyn","dyne"],1e-5,"force",["<kilogram>","<meter>"],["<second>","<second>"]],"<pound-force>":[["lbf","pound-force"],4.448222,"force",["<kilogram>","<meter>"],["<second>","<second>"]],"<hertz>":[["Hz","hertz","Hertz"],1,"frequency",["<1>"],["<second>"]],"<radian>":[["rad","radian","radians"],1,"angle",["<radian>"]],"<degree>":[["deg","degree","degrees"],Math.PI/180,"angle",["<radian>"]],"<arcminute>":[["arcmin","arcminute","arcminutes"],Math.PI/10800,"angle",["<radian>"]],"<arcsecond>":[["arcsec","arcsecond","arcseconds"],Math.PI/648e3,"angle",["<radian>"]],"<gradian>":[["gon","grad","gradian","grads"],Math.PI/200,"angle",["<radian>"]],"<steradian>":[["sr","steradian","steradians"],1,"solid_angle",["<steradian>"]],"<rotation>":[["rotation"],2*Math.PI,"angle",["<radian>"]],"<rpm>":[["rpm"],2*Math.PI/60,"angular_velocity",["<radian>"],["<second>"]],"<byte>":[["B","byte","bytes"],1,"information",["<byte>"]],"<bit>":[["b","bit","bits"],.125,"information",["<byte>"]],"<Bps>":[["Bps"],1,"information_rate",["<byte>"],["<second>"]],"<bps>":[["bps"],.125,"information_rate",["<byte>"],["<second>"]],"<dollar>":[["USD","dollar"],1,"currency",["<dollar>"]],"<cents>":[["cents"],.01,"currency",["<dollar>"]],"<candela>":[["cd","candela"],1,"luminosity",["<candela>"]],"<lumen>":[["lm","lumen"],1,"luminous_power",["<candela>","<steradian>"]],"<lux>":[["lux"],1,"illuminance",["<candela>","<steradian>"],["<meter>","<meter>"]],"<watt>":[["W","watt","watts"],1,"power",["<kilogram>","<meter>","<meter>"],["<second>","<second>","<second>"]],"<volt-ampere>":[["VA","volt-ampere"],1,"power",["<kilogram>","<meter>","<meter>"],["<second>","<second>","<second>"]],"<volt-ampere-reactive>":[["var","Var","VAr","VAR","volt-ampere-reactive"],1,"power",["<kilogram>","<meter>","<meter>"],["<second>","<second>","<second>"]],"<horsepower>":[["hp","horsepower"],745.699872,"power",["<kilogram>","<meter>","<meter>"],["<second>","<second>","<second>"]],"<gray>":[["Gy","gray","grays"],1,"radiation",["<meter>","<meter>"],["<second>","<second>"]],"<roentgen>":[["R","roentgen"],.00933,"radiation",["<meter>","<meter>"],["<second>","<second>"]],"<sievert>":[["Sv","sievert","sieverts"],1,"radiation",["<meter>","<meter>"],["<second>","<second>"]],"<becquerel>":[["Bq","becquerel","becquerels"],1,"radiation",["<1>"],["<second>"]],"<curie>":[["Ci","curie","curies"],37e9,"radiation",["<1>"],["<second>"]],"<cpm>":[["cpm"],1/60,"rate",["<count>"],["<second>"]],"<dpm>":[["dpm"],1/60,"rate",["<count>"],["<second>"]],"<bpm>":[["bpm"],1/60,"rate",["<count>"],["<second>"]],"<dot>":[["dot","dots"],1,"resolution",["<each>"]],"<pixel>":[["pixel","px"],1,"resolution",["<each>"]],"<ppi>":[["ppi"],1,"resolution",["<pixel>"],["<inch>"]],"<dpi>":[["dpi"],1,"typography",["<dot>"],["<inch>"]],"<cell>":[["cells","cell"],1,"counting",["<each>"]],"<each>":[["each"],1,"counting",["<each>"]],"<count>":[["count"],1,"counting",["<each>"]],"<base-pair>":[["bp","base-pair"],1,"counting",["<each>"]],"<nucleotide>":[["nt","nucleotide"],1,"counting",["<each>"]],"<molecule>":[["molecule","molecules"],1,"counting",["<1>"]],"<dozen>":[["doz","dz","dozen"],12,"prefix_only",["<each>"]],"<percent>":[["%","percent"],.01,"prefix_only",["<1>"]],"<ppm>":[["ppm"],1e-6,"prefix_only",["<1>"]],"<ppb>":[["ppb"],1e-9,"prefix_only",["<1>"]],"<ppt>":[["ppt"],1e-12,"prefix_only",["<1>"]],"<ppq>":[["ppq"],1e-15,"prefix_only",["<1>"]],"<gross>":[["gr","gross"],144,"prefix_only",["<dozen>","<dozen>"]],"<decibel>":[["dB","decibel","decibels"],1,"logarithmic",["<decibel>"]]},f=["<meter>","<kilogram>","<second>","<mole>","<ampere>","<radian>","<kelvin>","<temp-K>","<byte>","<dollar>","<candela>","<each>","<steradian>","<decibel>"],g="<1>",m=[g];function p(t,e){var n=e[1],r=e[3]||[],s=e[4]||[];if(!i(n))throw new c(t+": Invalid unit definition. 'scalar' must be a number");r.forEach((function(e){if(void 0===d[e])throw new c(t+": Invalid unit definition. Unit "+e+" in 'numerator' is not recognized")})),s.forEach((function(e){if(void 0===d[e])throw new c(t+": Invalid unit definition. Unit "+e+" in 'denominator' is not recognized")}))}var _={},w={},y={},v={},b={};for(var x in d)if(d.hasOwnProperty(x)){var M=d[x];if("prefix"===M[2]){_[x]=M[1];for(var E=0;E<M[0].length;E++)w[M[0][E]]=x}else{p(x,M),y[x]={scalar:M[1],numerator:M[3],denominator:M[4]};for(var S=0;S<M[0].length;S++)v[M[0][S]]=x}b[x]=M[0][0]}var k=["length","time","temperature","mass","current","substance","luminosity","currency","information","angle"];function C(){if(this.signature)return this.signature;for(var t=I.call(this),e=0;e<t.length;e++)t[e]*=Math.pow(20,e);return t.reduce((function(t,e){return t+e}),0)}function I(){if(!this.isBase())return I.call(this.toBase());for(var t,e,i=new Array(k.length),n=0;n<i.length;n++)i[n]=0;for(var r=0;r<this.numerator.length;r++)(t=d[this.numerator[r]])&&(e=k.indexOf(t[2]))>=0&&(i[e]=i[e]+1);for(var s=0;s<this.denominator.length;s++)(t=d[this.denominator[s]])&&(e=k.indexOf(t[2]))>=0&&(i[e]=i[e]-1);return i}var A=new RegExp("^([+-]?\\s*(?:(?:\\d+(?:\\.\\d+)?)|(?:\\.\\d+))(?:[Ee][+-]?\\d+)?)?\\s*([^/]*)(?:/(.+))?$"),T="\\^|\\*{2}",R="[01234]",P=new RegExp("([^ \\*\\d]+?)(?:"+T+")?(-?"+R+"(?![a-zA-Z]))"),D=new RegExp("([^ \\*\\d]+?)(?:"+T+")?("+R+"(?![a-zA-Z]))");function F(e){t(e)||(e=e.toString()),e=e.trim();var i=A.exec(e);if(!i)throw new c(e+": Quantity not recognized");var n=i[1];n?(n=n.replace(/\s/g,""),this.scalar=parseFloat(n)):this.scalar=1;for(var r,s,o,a=i[2],h=i[3];i=P.exec(a);){if(r=parseFloat(i[2]),isNaN(r))throw new c("Unit exponent is not a number");if(0===r&&!O.test(i[1]))throw new c("Unit not recognized");s=i[1]+" ",o="";for(var l=0;l<Math.abs(r);l++)o+=s;r>=0?a=a.replace(i[0],o):(h=h?h+o:o,a=a.replace(i[0],""))}for(;i=D.exec(h);){if(r=parseFloat(i[2]),isNaN(r))throw new c("Unit exponent is not a number");if(0===r&&!O.test(i[1]))throw new c("Unit not recognized");s=i[1]+" ",o="";for(var u=0;u<r;u++)o+=s;h=h.replace(i[0],o)}a&&(this.numerator=z(a.trim())),h&&(this.denominator=z(h.trim()))}var L="("+Object.keys(w).sort((function(t,e){return e.length-t.length})).join("|")+")??("+Object.keys(v).sort((function(t,e){return e.length-t.length})).join("|")+")(?:\\b|$)",O=new RegExp("^\\s*("+L+"[\\s\\*]*)+$"),N=new RegExp(L,"g"),B={};function z(t){var e=B[t];if(e)return e;var i,n=[];if(!O.test(t))throw new c("Unit not recognized");for(;i=N.exec(t);)n.push(i.slice(1));return n=(n=(n=n.map((function(t){return w[t[0]]?[w[t[0]],v[t[1]]]:[v[t[1]]]}))).reduce((function(t,e){return t.concat(e)}),[])).filter((function(t){return t})),B[t]=n,n}function U(t){return t instanceof G}function G(t,e){if(Y.apply(null,arguments),!U(this))return new G(t,e);if(this.scalar=null,this.baseScalar=null,this.signature=null,this._conversionCache={},this.numerator=m,this.denominator=m,X(t)?(this.scalar=t.scalar,this.numerator=t.numerator&&0!==t.numerator.length?t.numerator:m,this.denominator=t.denominator&&0!==t.denominator.length?t.denominator:m):e?(F.call(this,e),this.scalar=t):F.call(this,t),this.denominator.join("*").indexOf("temp")>=0)throw new c("Cannot divide with temperatures");if(this.numerator.join("*").indexOf("temp")>=0){if(this.numerator.length>1)throw new c("Cannot multiply by temperatures");if(!r(this.denominator,m))throw new c("Cannot divide with temperatures")}if(this.initValue=t,V.call(this),this.isTemperature()&&this.baseScalar<0)throw new c("Temperatures must not be less than absolute zero")}function Y(e,n){if(n){if(!i(e)||!t(n))throw new c("Only number accepted as initialization value when units are explicitly provided")}else if(!(t(e)||i(e)||U(e)||X(e)))throw new c("Only string, number or quantity accepted as single initialization value")}function X(t){return t&&"object"==typeof t&&t.hasOwnProperty("scalar")}function V(){if(this.baseScalar)return this.baseScalar;if(this.isBase())this.baseScalar=this.scalar,this.signature=C.call(this);else{var t=this.toBase();this.baseScalar=t.scalar,this.signature=t.signature}}G.prototype={constructor:G};var j={"-312078":"elastance","-312058":"resistance","-312038":"inductance","-152058":"potential","-152040":"magnetism","-152038":"magnetism","-7997":"specific_volume","-79":"snap","-59":"jolt","-39":"acceleration","-38":"radiation","-20":"frequency","-19":"speed","-18":"viscosity","-17":"volumetric_flow","-1":"wavenumber",0:"unitless",1:"length",2:"area",3:"volume",20:"time",400:"temperature",7941:"yank",7942:"power",7959:"pressure",7961:"force",7962:"energy",7979:"viscosity",7981:"momentum",7982:"angular_momentum",7997:"density",7998:"area_density",8e3:"mass",152020:"radiation_exposure",159999:"magnetism",16e4:"current",160020:"charge",312058:"conductance",312078:"capacitance",3199980:"activity",3199997:"molar_concentration",32e5:"substance",63999998:"illuminance",64e6:"luminous_power",128e7:"currency",25599999980:"information_rate",256e8:"information",511999999980:"angular_velocity",512e9:"angle"};function q(t,e){var i=e.to(W(t.units()));return G({scalar:t.scalar+i.scalar,numerator:t.numerator,denominator:t.denominator})}function W(t){if("tempK"===t)return"degK";if("tempC"===t)return"degC";if("tempF"===t)return"degF";if("tempR"===t)return"degR";throw new c("Unknown type for temp conversion from: "+t)}function Z(t,e){var i,n=function(t){var e,i=t.units();if(i.match(/(deg)[CFRK]/))e=t.baseScalar;else if("tempK"===i)e=t.scalar;else if("tempC"===i)e=t.scalar;else if("tempF"===i)e=5*t.scalar/9;else{if("tempR"!==i)throw new c("Unknown type for temp conversion from: "+i);e=5*t.scalar/9}return G({scalar:e,numerator:["<kelvin>"],denominator:m})}(t),r=e.units();if("degK"===r)i=n.scalar;else if("degC"===r)i=n.scalar;else if("degF"===r)i=9*n.scalar/5;else{if("degR"!==r)throw new c("Unknown type for degree conversion to: "+r);i=9*n.scalar/5}return G({scalar:i,numerator:e.numerator,denominator:e.denominator})}G.prototype.kind=function(){return j[this.signature.toString()]},s(G.prototype,{isDegrees:function(){return(null===this.signature||400===this.signature)&&1===this.numerator.length&&r(this.denominator,m)&&(this.numerator[0].match(/<temp-[CFRK]>/)||this.numerator[0].match(/<(kelvin|celsius|rankine|fahrenheit)>/))},isTemperature:function(){return this.isDegrees()&&this.numerator[0].match(/<temp-[CFRK]>/)}}),s(G.prototype,{to:function(e){var i,n;return null==e?this:t(e)?(i=this._conversionCache[e])?i:(n=G(e)).units()===this.units()?this:(this.isCompatible(n)?n=n.isTemperature()?function(t,e){var i,n=e.units();if("tempK"===n)i=t.baseScalar;else if("tempC"===n)i=t.baseScalar-273.15;else if("tempF"===n)i=9*t.baseScalar/5-459.67;else{if("tempR"!==n)throw new c("Unknown type for temp conversion to: "+n);i=9*t.baseScalar/5}return G({scalar:i,numerator:e.numerator,denominator:e.denominator})}(this,n):n.isDegrees()?Z(this,n):G({scalar:a(this.baseScalar,n.baseScalar),numerator:n.numerator,denominator:n.denominator}):this.isInverse(n)?n=this.inverse().to(e):u(this.units(),n.units()),this._conversionCache[e]=n,n):this.to(e.units())},toBase:function(){if(this.isBase())return this;if(this.isTemperature())return function(t){var e,i=t.units();if(i.match(/(deg)[CFRK]/))e=t.baseScalar;else if("tempK"===i)e=t.scalar;else if("tempC"===i)e=t.scalar+273.15;else if("tempF"===i)e=5*(t.scalar+459.67)/9;else{if("tempR"!==i)throw new c("Unknown type for temp conversion from: "+i);e=5*t.scalar/9}return G({scalar:e,numerator:["<temp-K>"],denominator:m})}(this);var t=K[this.units()];return t||(t=function(t,e){for(var i,n=[],r=[],s=1,a=0;a<t.length;a++)i=t[a],_[i]?s=o(s,_[i]):y[i]&&(s*=y[i].scalar,y[i].numerator&&n.push(y[i].numerator),y[i].denominator&&r.push(y[i].denominator));for(var h=0;h<e.length;h++)i=e[h],_[i]?s/=_[i]:y[i]&&(s/=y[i].scalar,y[i].numerator&&r.push(y[i].numerator),y[i].denominator&&n.push(y[i].denominator));return G({scalar:s,numerator:n=n.reduce((function(t,e){return t.concat(e)}),[]),denominator:r=r.reduce((function(t,e){return t.concat(e)}),[])})}(this.numerator,this.denominator),K[this.units()]=t),t.mul(this.scalar)},toFloat:function(){if(this.isUnitless())return this.scalar;throw new c("Can't convert to Float unless unitless.  Use Unit#scalar")},toPrec:function(e){if(t(e)&&(e=G(e)),i(e)&&(e=G(e+" "+this.units())),this.isUnitless()?e.isUnitless()||u(this.units(),e.units()):e=e.to(this.units()),0===e.scalar)throw new c("Divide by zero");return G(o(Math.round(this.scalar/e.scalar),e.scalar)+this.units())}});var K={};function H(t,e,i,n){function r(t){return t!==g}t=t.filter(r),i=i.filter(r),e=e.filter(r),n=n.filter(r);var s={};function o(t,e){for(var i,n,r,o=0;o<t.length;o++)if(_[t[o]]?(i=t[o+1],n=t[o],r=_[n],o++):(i=t[o],n=null,r=1),i&&i!==g)if(s[i]){s[i][0]+=e;var h=s[i][2]?_[s[i][2]]:1;s[i][1===e?3:4]*=a(r,h)}else s[i]=[e,i,n,1,1]}o(t,1),o(e,-1),o(i,1),o(n,-1);var h=[],l=[],c=1;for(var u in s)if(s.hasOwnProperty(u)){var d,f=s[u];if(f[0]>0)for(d=0;d<f[0];d++)h.push(null===f[2]?f[1]:[f[2],f[1]]);else if(f[0]<0)for(d=0;d<-f[0];d++)l.push(null===f[2]?f[1]:[f[2],f[1]]);c*=a(f[3],f[4])}return 0===h.length&&(h=m),0===l.length&&(l=m),[h=h.reduce((function(t,e){return t.concat(e)}),[]),l=l.reduce((function(t,e){return t.concat(e)}),[]),c]}function $(){}G.parse=function(e){if(!t(e))throw new c("Argument should be a string");try{return this(e)}catch(t){return null}},G.getUnits=function(t){var e,i=[],n=Object.keys(d);if(void 0===t)for(e=0;e<n.length;e++)-1===["","prefix"].indexOf(d[n[e]][2])&&i.push(n[e].substr(1,n[e].length-2));else{if(-1===this.getKinds().indexOf(t))throw new c("Kind not recognized");for(e=0;e<n.length;e++)d[n[e]][2]===t&&i.push(n[e].substr(1,n[e].length-2))}return i.sort((function(t,e){return t.toLowerCase()<e.toLowerCase()?-1:t.toLowerCase()>e.toLowerCase()?1:0}))},G.getAliases=function(t){if(!v[t])throw new c("Unit not recognized");return d[v[t]][0]},G.mulSafe=o,G.divSafe=a,G.getKinds=function(){return t=Object.keys(j).map((function(t){return j[t]})),e={},t.filter((function(t){return!e.hasOwnProperty(t)&&(e[t]=!0)}));var t,e},G.swiftConverter=function(t,e){var i,r=G(t),s=G(e);return r.eq(s)?n:(i=r.isTemperature()?function(t){return r.mul(t).to(s).scalar}:function(t){return t*r.baseScalar/s.baseScalar},function(t){var e,n,r;if(Array.isArray(t)){for(n=t.length,r=[],e=0;e<n;e++)r.push(i(t[e]));return r}return i(t)})},G.Error=c,s(G.prototype,{add:function(e){if(t(e)&&(e=G(e)),this.isCompatible(e)||u(this.units(),e.units()),this.isTemperature()&&e.isTemperature())throw new c("Cannot add two temperatures");return this.isTemperature()?q(this,e):e.isTemperature()?q(e,this):G({scalar:this.scalar+e.to(this).scalar,numerator:this.numerator,denominator:this.denominator})},sub:function(e){if(t(e)&&(e=G(e)),this.isCompatible(e)||u(this.units(),e.units()),this.isTemperature()&&e.isTemperature())return n=e,r=(i=this).units(),s=n.to(r),o=G(W(r)),G({scalar:i.scalar-s.scalar,numerator:o.numerator,denominator:o.denominator});var i,n,r,s,o,a,h;if(this.isTemperature())return a=this,h=e.to(W(a.units())),G({scalar:a.scalar-h.scalar,numerator:a.numerator,denominator:a.denominator});if(e.isTemperature())throw new c("Cannot subtract a temperature from a differential degree unit");return G({scalar:this.scalar-e.to(this).scalar,numerator:this.numerator,denominator:this.denominator})},mul:function(e){if(i(e))return G({scalar:o(this.scalar,e),numerator:this.numerator,denominator:this.denominator});if(t(e)&&(e=G(e)),(this.isTemperature()||e.isTemperature())&&!this.isUnitless()&&!e.isUnitless())throw new c("Cannot multiply by temperatures");var n=this,r=e;n.isCompatible(r)&&400!==n.signature&&(r=r.to(n));var s=H(n.numerator,n.denominator,r.numerator,r.denominator);return G({scalar:o(n.scalar,r.scalar,s[2]),numerator:s[0],denominator:s[1]})},div:function(e){if(i(e)){if(0===e)throw new c("Divide by zero");return G({scalar:this.scalar/e,numerator:this.numerator,denominator:this.denominator})}if(t(e)&&(e=G(e)),0===e.scalar)throw new c("Divide by zero");if(e.isTemperature())throw new c("Cannot divide with temperatures");if(this.isTemperature()&&!e.isUnitless())throw new c("Cannot divide with temperatures");var n=this,r=e;n.isCompatible(r)&&400!==n.signature&&(r=r.to(n));var s=H(n.numerator,n.denominator,r.denominator,r.numerator);return G({scalar:o(n.scalar,s[2])/r.scalar,numerator:s[0],denominator:s[1]})},inverse:function(){if(this.isTemperature())throw new c("Cannot divide with temperatures");if(0===this.scalar)throw new c("Divide by zero");return G({scalar:1/this.scalar,numerator:this.denominator,denominator:this.numerator})}}),s(G.prototype,{eq:function(t){return 0===this.compareTo(t)},lt:function(t){return-1===this.compareTo(t)},lte:function(t){return this.eq(t)||this.lt(t)},gt:function(t){return 1===this.compareTo(t)},gte:function(t){return this.eq(t)||this.gt(t)},compareTo:function(e){return t(e)?this.compareTo(G(e)):(this.isCompatible(e)||u(this.units(),e.units()),this.baseScalar<e.baseScalar?-1:this.baseScalar===e.baseScalar?0:this.baseScalar>e.baseScalar?1:void 0)},same:function(t){return this.scalar===t.scalar&&this.units()===t.units()}}),s(G.prototype,{isUnitless:function(){return[this.numerator,this.denominator].every((function(t){return r(t,m)}))},isCompatible:function(e){return t(e)?this.isCompatible(G(e)):!!U(e)&&void 0!==e.signature&&this.signature===e.signature},isInverse:function(t){return this.inverse().isCompatible(t)},isBase:function(){return void 0!==this._isBase?this._isBase:this.isDegrees()&&this.numerator[0].match(/<(kelvin|temp-K)>/)?(this._isBase=!0,this._isBase):(this.numerator.concat(this.denominator).forEach((function(t){t!==g&&-1===f.indexOf(t)&&(this._isBase=!1)}),this),!1===this._isBase||(this._isBase=!0),this._isBase)}}),$.prototype.get=function(t){return arguments.length>1&&(t=Array.apply(null,arguments)),t.reduce((function(e,i,n){if(e){var r=e[i];return n===t.length-1?r?r.data:void 0:r}}),this)},$.prototype.set=function(t,e){return arguments.length>2&&(t=Array.prototype.slice.call(arguments,0,-1),e=arguments[arguments.length-1]),t.reduce((function(i,n,r){var s=i[n];return void 0===s&&(s=i[n]={}),r===t.length-1?(s.data=e,e):s}),this)},G.formatter=function(t,e){return(t+" "+e).trim()},s(G.prototype,{units:function(){if(void 0!==this._units)return this._units;var t=r(this.numerator,m),e=r(this.denominator,m);if(t&&e)return this._units="",this._units;var i=Q(this.numerator),n=Q(this.denominator);return this._units=i+(e?"":"/"+n),this._units},toString:function(e,n){var r;if(i(e))r=this.units(),n=e;else if(t(e))r=e;else if(U(e))return this.toPrec(e).toString(n);var s=this.to(r);return((void 0!==n?h(s.scalar,n):s.scalar)+" "+s.units()).trim()},format:function(t,e){1===arguments.length&&"function"==typeof t&&(e=t,t=void 0),e=e||G.formatter;var i=this.to(t);return e.call(this,i.scalar,i.units())}});var J=new $;function Q(t){var e=J.get(t);return e||(e=r(t,m)?"1":function(t){return t.reduce((function(t,e){var i=t[e];return i||t.push(i=t[e]=[e,0]),i[1]++,t}),[]).map((function(t){return t[0]+(t[1]>1?t[1]:"")}))}(function(t){for(var e,i,n=[],r=0;r<t.length;r++)e=t[r],i=t[r+1],_[e]?(n.push(b[e]+b[i]),r++):n.push(b[e]);return n}(t)).join("*"),J.set(t,e),e)}return G.version="1.8.0",G}()},5520:t=>{!function(){function e(t){for(var e=0,r=t.length-1,s=void 0,o=void 0,a=void 0,h=n(e,r);;){if(r<=e)return t[h];if(r==e+1)return t[e]>t[r]&&i(t,e,r),t[h];for(t[s=n(e,r)]>t[r]&&i(t,s,r),t[e]>t[r]&&i(t,e,r),t[s]>t[e]&&i(t,s,e),i(t,s,e+1),o=e+1,a=r;;){do{o++}while(t[e]>t[o]);do{a--}while(t[a]>t[e]);if(a<o)break;i(t,o,a)}i(t,e,a),a<=h&&(e=o),a>=h&&(r=a-1)}}var i=function(t,e,i){var n;return n=[t[i],t[e]],t[e]=n[0],t[i]=n[1],n},n=function(t,e){return~~((t+e)/2)};t.exports?t.exports=e:window.median=e}()},4805:(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>r});var n=i(4091);function r(t){var e,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!(0,n.isAnyArray)(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");if(void 0!==i.output){if(!(0,n.isAnyArray)(i.output))throw new TypeError("output option must be an array if specified");e=i.output}else e=new Array(t.length);var r=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!(0,n.isAnyArray)(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");var i=e.fromIndex,r=void 0===i?0:i,s=e.toIndex,o=void 0===s?t.length:s;if(r<0||r>=t.length||!Number.isInteger(r))throw new Error("fromIndex must be a positive integer smaller than length");if(o<=r||o>t.length||!Number.isInteger(o))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var a=t[r],h=r+1;h<o;h++)t[h]<a&&(a=t[h]);return a}(t),s=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!(0,n.isAnyArray)(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");var i=e.fromIndex,r=void 0===i?0:i,s=e.toIndex,o=void 0===s?t.length:s;if(r<0||r>=t.length||!Number.isInteger(r))throw new Error("fromIndex must be a positive integer smaller than length");if(o<=r||o>t.length||!Number.isInteger(o))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var a=t[r],h=r+1;h<o;h++)t[h]>a&&(a=t[h]);return a}(t);if(r===s)throw new RangeError("minimum and maximum input values are equal. Cannot rescale a constant array");var o=i.min,a=void 0===o?i.autoMinMax?r:0:o,h=i.max,l=void 0===h?i.autoMinMax?s:1:h;if(a>=l)throw new RangeError("min option must be smaller than max option");for(var c=(l-a)/(s-r),u=0;u<t.length;u++)e[u]=(t[u]-r)*c+a;return e}},530:t=>{"use strict";function e(t){this.value=t,this.parent=null,this.rank=0}t.exports=class{constructor(){this.nodes=new Map}add(t){var i=this.nodes.get(t);return i||(i=new e(t),this.nodes.set(t,i)),i}union(t,e){const i=this.find(t),n=this.find(e);i!==n&&(i.rank<n.rank?i.parent=n:i.rank>n.rank?n.parent=i:(n.parent=i,i.rank++))}find(t){for(var e=t;null!==e.parent;)e=e.parent;for(var i=t;null!==i.parent;){var n=i;i=i.parent,n.parent=e}return e}connected(t,e){return this.find(t)===this.find(e)}}},4953:(t,e,i)=>{"use strict";function n(t,e){let i=0;for(let n=0;n<t.length;n++)i+=(t[n]-e[n])*(t[n]-e[n]);return i}function r(t,e){return Math.sqrt(n(t,e))}i.r(e),i.d(e,{euclidean:()=>r,squaredEuclidean:()=>n})},7345:(t,e,i)=>{"use strict";var n=i(5571),r={DEBUG:!1,ifft2DArray:function(t,e,i){var r=new Array(e*i),s=e/2,o=2*(i-1);n.init(s);for(var a={re:new Array(s),im:new Array(s)},h=0;h<i;h++){for(var l=s-1;l>=0;l--)a.re[l]=t[2*l*i+h],a.im[l]=t[(2*l+1)*i+h];for(n.bt(a.re,a.im),l=s-1;l>=0;l--)r[2*l*i+h]=a.re[l],r[(2*l+1)*i+h]=a.im[l]}var c=new Array(s*o);n.init(o);var u={re:new Array(o),im:new Array(o)},d=o*s;for(l=0;l<e;l+=2){for(u.re[0]=r[l*i],u.im[0]=r[(l+1)*i],h=1;h<i;h++)u.re[h]=r[l*i+h],u.im[h]=r[(l+1)*i+h],u.re[o-h]=r[l*i+h],u.im[o-h]=-r[(l+1)*i+h];n.bt(u.re,u.im);var f=l/2*o;for(h=o-1;h>=0;h--)c[f+h]=u.re[h]/d}return c},fft2DArray:function(t,e,i,r){Object.assign({},{inplace:!0});var s=i/2+1,o=2*e,a=new Array(o*s);n.init(i);for(var h,l,c,u,d,f={re:new Array(i),im:new Array(i)},g={re:new Array(i),im:new Array(i)},m={re:new Array(i),im:new Array(i)},p=0;p<e/2;p++){h=2*p*i,f.re=t.slice(h,h+i),h=(2*p+1)*i,f.im=t.slice(h,h+i),n.fft1d(f.re,f.im),this.reconstructTwoRealFFT(f,g,m),l=4*p*s,c=(4*p+1)*s,u=(4*p+2)*s,d=(4*p+3)*s;for(var _=s-1;_>=0;_--)a[l+_]=g.re[_],a[c+_]=g.im[_],a[u+_]=m.re[_],a[d+_]=m.im[_]}g=null,m=null;var w=new Array(o*s);n.init(e);for(var y={re:new Array(e),im:new Array(e)},v=s-1;v>=0;v--){for(p=e-1;p>=0;p--)y.re[p]=a[2*p*s+v],y.im[p]=a[(2*p+1)*s+v],isNaN(y.re[p])&&(y.re[p]=0),isNaN(y.im[p])&&(y.im[p]=0);for(n.fft1d(y.re,y.im),p=e-1;p>=0;p--)w[2*p*s+v]=y.re[p],w[(2*p+1)*s+v]=y.im[p]}return w},reconstructTwoRealFFT:function(t,e,i){var n,r,s,o,a,h=t.re.length;e.re[0]=t.re[0],e.im[0]=0,i.re[0]=t.im[0],i.im[0]=0;for(var l=h/2;l>0;l--)a=h-l,n=.5*(t.re[l]-t.re[a]),r=.5*(t.re[l]+t.re[a]),s=.5*(t.im[l]-t.im[a]),o=.5*(t.im[l]+t.im[a]),e.re[l]=r,e.im[l]=s,e.re[a]=r,e.im[a]=-s,i.re[l]=o,i.im[l]=-n,i.re[a]=o,i.im[a]=n},convolute2DI:function(t,e,i,n){for(var r,s,o=0;o<i/2;o++)for(var a=0;a<n;a++)r=t[2*o*n+a]*e[2*o*n+a]-t[(2*o+1)*n+a]*e[(2*o+1)*n+a],s=t[2*o*n+a]*e[(2*o+1)*n+a]+t[(2*o+1)*n+a]*e[2*o*n+a],t[2*o*n+a]=r,t[(2*o+1)*n+a]=s},convolute:function(t,e,i,n,r){for(var s=new Array(n*i),o=0;o<i*n;o++)s[o]=t[o];s=this.fft2DArray(s,i,n);var a,h=e.length,l=e[0].length,c=new Array(n*i);for(o=0;o<n*i;o++)c[o]=0;for(var u=Math.floor((h-1)/2),d=Math.floor((l-1)/2),f=0;f<h;f++){a=(f-u+i)%i;for(var g=0;g<l;g++)c[a*n+(g-d+n)%n]=e[f][g]}c=this.fft2DArray(c,i,n);var m=2*i,p=n/2+1;return this.convolute2DI(s,c,m,p),this.ifft2DArray(s,m,p)},toRadix2:function(t,e,i){var n,r,s,o,a=i,h=e;if(0===i||0!=(i&i-1)){for(a=0;i>>++a!=0;);a=1<<a}if(0===e||0!=(e&e-1)){for(h=0;e>>++h!=0;);h=1<<h}if(h==e&&a==i)return{data:t,rows:e,cols:i};var l=new Array(h*a),c=Math.floor((h-e)/2)-e,u=Math.floor((a-i)/2)-i;for(n=0;n<h;n++)for(s=n*a,o=(n-c)%e*i,r=0;r<a;r++)l[s+r]=t[o+(r-u)%i];return{data:l,rows:h,cols:a}},crop:function(t,e,i,n,r,s){if(e==n&&i==r)return t;Object.assign({},s);var o,a,h,l,c=new Array(r*n),u=Math.floor((e-n)/2),d=Math.floor((i-r)/2);for(h=0;h<n;h++)for(o=h*r,a=(h+u)*i,l=0;l<r;l++)c[o+l]=t[a+(l+d)];return c}};t.exports=r},5571:function(t,e){(function(){var t;(t=e).toString=function(){return"version 0.3.0, released 2013-03"};for(var i=0,n=null,r=null,s={init:function(t){if(0===t||0!=(t&t-1))throw new Error("init: radix-2 required");i=t,s._initArray(),s._makeBitReversalTable(),s._makeCosSinTable()},fft1d:function(t,e){s.fft(t,e,1)},ifft1d:function(t,e){var n=1/i;s.fft(t,e,-1);for(var r=0;r<i;r++)t[r]*=n,e[r]*=n},bt1d:function(t,e){s.fft(t,e,-1)},fft2d:function(t,e){for(var n=[],r=[],o=0,a=0;a<i;a++){o=a*i;for(var h=0;h<i;h++)n[h]=t[h+o],r[h]=e[h+o];s.fft1d(n,r);for(var l=0;l<i;l++)t[l+o]=n[l],e[l+o]=r[l]}for(var c=0;c<i;c++){for(var u=0;u<i;u++)o=c+u*i,n[u]=t[o],r[u]=e[o];s.fft1d(n,r);for(var d=0;d<i;d++)t[o=c+d*i]=n[d],e[o]=r[d]}},ifft2d:function(t,e){for(var n=[],r=[],o=0,a=0;a<i;a++){o=a*i;for(var h=0;h<i;h++)n[h]=t[h+o],r[h]=e[h+o];s.ifft1d(n,r);for(var l=0;l<i;l++)t[l+o]=n[l],e[l+o]=r[l]}for(var c=0;c<i;c++){for(var u=0;u<i;u++)o=c+u*i,n[u]=t[o],r[u]=e[o];s.ifft1d(n,r);for(var d=0;d<i;d++)t[o=c+d*i]=n[d],e[o]=r[d]}},fft:function(t,e,s){for(var o,a,h,l,c,u,d,f,g,m=i>>2,p=0;p<i;p++)p<(l=n[p])&&(c=t[p],t[p]=t[l],t[l]=c,c=e[p],e[p]=e[l],e[l]=c);for(var _=1;_<i;_<<=1){a=0,o=i/(_<<1);for(var w=0;w<_;w++){u=r[a+m],d=s*r[a];for(var y=w;y<i;y+=_<<1)f=u*t[h=y+_]+d*e[h],g=u*e[h]-d*t[h],t[h]=t[y]-f,t[y]+=f,e[h]=e[y]-g,e[y]+=g;a+=o}}},_initArray:function(){n="undefined"!=typeof Uint32Array?new Uint32Array(i):[],r="undefined"!=typeof Float64Array?new Float64Array(1.25*i):[]},_paddingZero:function(){},_makeBitReversalTable:function(){var t=0,e=0,r=0;for(n[0]=0;++t<i;){for(r=i>>1;r<=e;)e-=r,r>>=1;e+=r,n[t]=e}},_makeCosSinTable:function(){var t=i>>1,e=i>>2,n=i>>3,s=t+e,o=Math.sin(Math.PI/i),a=2*o*o,h=Math.sqrt(a*(2-a)),l=r[e]=1,c=r[0]=0;o=2*a;for(var u=1;u<n;u++)a+=o*(l-=a),h-=o*(c+=h),r[u]=c,r[e-u]=l;0!==n&&(r[n]=Math.sqrt(.5));for(var d=0;d<e;d++)r[t-d]=r[d];for(var f=0;f<s;f++)r[f+t]=-r[f]}},o=["init","fft1d","ifft1d","fft2d","ifft2d"],a=0;a<o.length;a++)t[o[a]]=s[o[a]];return t.bt=s.bt1d,t.fft=s.fft1d,t.ifft=s.ifft1d,t}).call(this)},3910:(t,e,i)=>{"use strict";e.FFTUtils=i(7345),i(5571)},8881:(t,e,i)=>{"use strict";const{squaredEuclidean:n}=i(4953),r={sigma:1};t.exports=class{constructor(t){t=Object.assign({},r,t),this.sigma=t.sigma,this.divisor=2*t.sigma*t.sigma}compute(t,e){const i=n(t,e);return Math.exp(-i/this.divisor)}}},4229:t=>{"use strict";const e={degree:1,constant:1,scale:1};t.exports=class{constructor(t){t=Object.assign({},e,t),this.degree=t.degree,this.constant=t.constant,this.scale=t.scale}compute(t,e){for(var i=0,n=0;n<t.length;n++)i+=t[n]*e[n];return Math.pow(this.scale*i+this.constant,this.degree)}}},7613:t=>{"use strict";const e={alpha:.01,constant:-Math.E};t.exports=class{constructor(t){t=Object.assign({},e,t),this.alpha=t.alpha,this.constant=t.constant}compute(t,e){for(var i=0,n=0;n<t.length;n++)i+=t[n]*e[n];return Math.tanh(this.alpha*i+this.constant)}}},6952:(t,e,i)=>{"use strict";const{Matrix:n,MatrixTransposeView:r}=i(8406),s=i(8881),o=i(4229),a=i(7613),h=i(8541),l=i(9176),c=i(3316),u=i(1960),d={gaussian:s,rbf:s,polynomial:o,poly:o,anova:h,cauchy:l,exponential:c,histogram:u,min:u,laplacian:i(8557),multiquadratic:i(8609),rational:i(3029),sigmoid:a,mlp:a};t.exports=class{constructor(t,e){if(this.kernelType=t,"linear"!==t)if("string"==typeof t){t=t.toLowerCase();var i=d[t];if(!i)throw new Error(`unsupported kernel type: ${t}`);this.kernelFunction=new i(e)}else{if("object"!=typeof t||"function"!=typeof t.compute)throw new TypeError("first argument must be a valid kernel type or instance");this.kernelFunction=t}}compute(t,e){if(t=n.checkMatrix(t),e=void 0===e?t:n.checkMatrix(e),"linear"===this.kernelType)return t.mmul(new r(e));const i=new n(t.rows,e.rows);if(t===e)for(let e=0;e<t.rows;e++)for(let n=e;n<t.rows;n++){const r=this.kernelFunction.compute(t.getRow(e),t.getRow(n));i.set(e,n,r),i.set(n,e,r)}else for(let n=0;n<t.rows;n++)for(let r=0;r<e.rows;r++)i.set(n,r,this.kernelFunction.compute(t.getRow(n),e.getRow(r)));return i}}},8541:t=>{"use strict";const e={sigma:1,degree:1};t.exports=class{constructor(t){t=Object.assign({},e,t),this.sigma=t.sigma,this.degree=t.degree}compute(t,e){for(var i=0,n=Math.min(t.length,e.length),r=1;r<=n;++r)i+=Math.pow(Math.exp(-this.sigma*Math.pow(Math.pow(t[r-1],r)-Math.pow(e[r-1],r),2)),this.degree);return i}}},9176:(t,e,i)=>{"use strict";const{squaredEuclidean:n}=i(4953),r={sigma:1};t.exports=class{constructor(t){t=Object.assign({},r,t),this.sigma=t.sigma}compute(t,e){return 1/(1+n(t,e)/(this.sigma*this.sigma))}}},3316:(t,e,i)=>{"use strict";const{euclidean:n}=i(4953),r={sigma:1};t.exports=class{constructor(t){t=Object.assign({},r,t),this.sigma=t.sigma,this.divisor=2*t.sigma*t.sigma}compute(t,e){const i=n(t,e);return Math.exp(-i/this.divisor)}}},1960:t=>{"use strict";t.exports=class{compute(t,e){for(var i=Math.min(t.length,e.length),n=0,r=0;r<i;++r)n+=Math.min(t[r],e[r]);return n}}},8557:(t,e,i)=>{"use strict";const{euclidean:n}=i(4953),r={sigma:1};t.exports=class{constructor(t){t=Object.assign({},r,t),this.sigma=t.sigma}compute(t,e){const i=n(t,e);return Math.exp(-i/this.sigma)}}},8609:(t,e,i)=>{"use strict";const{squaredEuclidean:n}=i(4953),r={constant:1};t.exports=class{constructor(t){t=Object.assign({},r,t),this.constant=t.constant}compute(t,e){return Math.sqrt(n(t,e)+this.constant*this.constant)}}},3029:(t,e,i)=>{"use strict";const{squaredEuclidean:n}=i(4953),r={constant:1};t.exports=class{constructor(t){t=Object.assign({},r,t),this.constant=t.constant}compute(t,e){const i=n(t,e);return 1-i/(i+this.constant)}}},414:(t,e,i)=>{var n=i(3910).FFTUtils;function r(t){var e,i,n=t;if("number"!=typeof t[0]){e=t.length,i=t[0].length,n=new Array(e*i);for(var r=0;r<e;r++)for(var s=0;s<i;s++)n[r*i+s]=t[r][s]}else{var o=Math.sqrt(t.length);Number.isInteger(o)&&(e=o,i=o)}return{data:n,rows:e,cols:i}}t.exports={fft:function(t,e,i){var s,o,a=r(t),h=a.data,l=Object.assign({normalize:!1,divisor:1,rows:a.rows,cols:a.cols},i);if(!l.rows||!l.cols)throw new Error("Invalid number of rows or columns "+s+" "+o);s=l.rows,o=l.cols;var c,u,d=l.divisor,f=e.length,g=e[0].length;if(l.normalize)for(d=0,c=0;c<f;c++)for(u=0;u<g;u++)d+=e[c][u];if(0===d)throw new RangeError("convolution: The divisor is equal to zero");var m=n.toRadix2(h,s,o),p=n.convolute(m.data,e,m.rows,m.cols);if(p=n.crop(p,m.rows,m.cols,s,o),0!=d&&1!=d)for(c=0;c<p.length;c++)p[c]/=d;return p},direct:function(t,e,i){var n,s,o=r(t),a=o.data,h=Object.assign({normalize:!1,divisor:1,rows:o.rows,cols:o.cols},i);if(!h.rows||!h.cols)throw new Error("Invalid number of rows or columns "+n+" "+s);n=h.rows,s=h.cols;var l,c,u,d,f,g,m=h.divisor,p=e.length,_=e[0].length;if(h.normalize)for(m=0,l=0;l<p;l++)for(c=0;c<_;c++)m+=e[l][c];if(0===m)throw new RangeError("convolution: The divisor is equal to zero");var w=new Array(n*s),y=Math.floor(p/2),v=Math.floor(_/2);for(d=0;d<n;d++)for(u=0;u<s;u++){for(f=0,c=0;c<p;c++)for(l=0;l<_;l++)g=e[p-c-1][_-l-1],f+=a[(d+c-y+n)%n*s+(u+l-v+s)%s]*g;w[d*s+u]=f/m}return w},kernelFactory:{LoG:function(t,e,i){var n=1e3;i&&i.factor&&(n=i.factor);var r,s,o,a,h=new Array(e);n*=-1;var l=(e-1)/2,c=2*t*t;for(r=0;r<e;r++)for(h[r]=new Array(e),a=(r-l)*(r-l),s=0;s<e;s++)o=-((s-l)*(s-l)+a)/c,h[r][s]=Math.round(n*(1+o)*Math.exp(o));return h}},matrix2Array:r}},8406:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(4091),r=i(4805);const s=" ".repeat(2),o=" ".repeat(4);function a(t,e={}){const{maxRows:i=15,maxColumns:n=10,maxNumSize:r=8,padMinus:a="auto"}=e;return`${t.constructor.name} {\n${s}[\n${o}${function(t,e,i,n,r){const{rows:s,columns:a}=t,l=Math.min(s,e),c=Math.min(a,i),u=[];if("auto"===r){r=!1;t:for(let e=0;e<l;e++)for(let i=0;i<c;i++)if(t.get(e,i)<0){r=!0;break t}}for(let e=0;e<l;e++){let i=[];for(let s=0;s<c;s++)i.push(h(t.get(e,s),n,r));u.push(`${i.join(" ")}`)}return c!==a&&(u[u.length-1]+=` ... ${a-i} more columns`),l!==s&&u.push(`... ${s-e} more rows`),u.join(`\n${o}`)}(t,i,n,r,a)}\n${s}]\n${s}rows: ${t.rows}\n${s}columns: ${t.columns}\n}`}function h(t,e,i){return(t>=0&&i?` ${l(t,e-1)}`:l(t,e)).padEnd(e)}function l(t,e){let i=t.toString();if(i.length<=e)return i;let n=t.toFixed(e);if(n.length>e&&(n=t.toFixed(Math.max(0,e-(n.length-e)))),n.length<=e&&!n.startsWith("0.000")&&!n.startsWith("-0.000"))return n;let r=t.toExponential(e);return r.length>e&&(r=t.toExponential(Math.max(0,e-(r.length-e)))),r.slice(0)}function c(t,e,i){let n=i?t.rows:t.rows-1;if(e<0||e>n)throw new RangeError("Row index out of range")}function u(t,e,i){let n=i?t.columns:t.columns-1;if(e<0||e>n)throw new RangeError("Column index out of range")}function d(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.columns)throw new RangeError("vector size must be the same as the number of columns");return e}function f(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.rows)throw new RangeError("vector size must be the same as the number of rows");return e}function g(t,e){if(!n.isAnyArray(e))throw new TypeError("row indices must be an array");for(let i=0;i<e.length;i++)if(e[i]<0||e[i]>=t.rows)throw new RangeError("row indices are out of range")}function m(t,e){if(!n.isAnyArray(e))throw new TypeError("column indices must be an array");for(let i=0;i<e.length;i++)if(e[i]<0||e[i]>=t.columns)throw new RangeError("column indices are out of range")}function p(t,e,i,n,r){if(5!==arguments.length)throw new RangeError("expected 4 arguments");if(w("startRow",e),w("endRow",i),w("startColumn",n),w("endColumn",r),e>i||n>r||e<0||e>=t.rows||i<0||i>=t.rows||n<0||n>=t.columns||r<0||r>=t.columns)throw new RangeError("Submatrix indices are out of range")}function _(t,e=0){let i=[];for(let n=0;n<t;n++)i.push(e);return i}function w(t,e){if("number"!=typeof e)throw new TypeError(`${t} must be a number`)}function y(t){if(t.isEmpty())throw new Error("Empty matrix has no elements to index")}class v{static from1DArray(t,e,i){if(t*e!==i.length)throw new RangeError("data length does not match given dimensions");let n=new x(t,e);for(let r=0;r<t;r++)for(let t=0;t<e;t++)n.set(r,t,i[r*e+t]);return n}static rowVector(t){let e=new x(1,t.length);for(let i=0;i<t.length;i++)e.set(0,i,t[i]);return e}static columnVector(t){let e=new x(t.length,1);for(let i=0;i<t.length;i++)e.set(i,0,t[i]);return e}static zeros(t,e){return new x(t,e)}static ones(t,e){return new x(t,e).fill(1)}static rand(t,e,i={}){if("object"!=typeof i)throw new TypeError("options must be an object");const{random:n=Math.random}=i;let r=new x(t,e);for(let i=0;i<t;i++)for(let t=0;t<e;t++)r.set(i,t,n());return r}static randInt(t,e,i={}){if("object"!=typeof i)throw new TypeError("options must be an object");const{min:n=0,max:r=1e3,random:s=Math.random}=i;if(!Number.isInteger(n))throw new TypeError("min must be an integer");if(!Number.isInteger(r))throw new TypeError("max must be an integer");if(n>=r)throw new RangeError("min must be smaller than max");let o=r-n,a=new x(t,e);for(let i=0;i<t;i++)for(let t=0;t<e;t++){let e=n+Math.round(s()*o);a.set(i,t,e)}return a}static eye(t,e,i){void 0===e&&(e=t),void 0===i&&(i=1);let n=Math.min(t,e),r=this.zeros(t,e);for(let t=0;t<n;t++)r.set(t,t,i);return r}static diag(t,e,i){let n=t.length;void 0===e&&(e=n),void 0===i&&(i=e);let r=Math.min(n,e,i),s=this.zeros(e,i);for(let e=0;e<r;e++)s.set(e,e,t[e]);return s}static min(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);let i=t.rows,n=t.columns,r=new x(i,n);for(let s=0;s<i;s++)for(let i=0;i<n;i++)r.set(s,i,Math.min(t.get(s,i),e.get(s,i)));return r}static max(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);let i=t.rows,n=t.columns,r=new this(i,n);for(let s=0;s<i;s++)for(let i=0;i<n;i++)r.set(s,i,Math.max(t.get(s,i),e.get(s,i)));return r}static checkMatrix(t){return v.isMatrix(t)?t:new x(t)}static isMatrix(t){return null!=t&&"Matrix"===t.klass}get size(){return this.rows*this.columns}apply(t){if("function"!=typeof t)throw new TypeError("callback must be a function");for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)t.call(this,e,i);return this}to1DArray(){let t=[];for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)t.push(this.get(e,i));return t}to2DArray(){let t=[];for(let e=0;e<this.rows;e++){t.push([]);for(let i=0;i<this.columns;i++)t[e].push(this.get(e,i))}return t}toJSON(){return this.to2DArray()}isRowVector(){return 1===this.rows}isColumnVector(){return 1===this.columns}isVector(){return 1===this.rows||1===this.columns}isSquare(){return this.rows===this.columns}isEmpty(){return 0===this.rows||0===this.columns}isSymmetric(){if(this.isSquare()){for(let t=0;t<this.rows;t++)for(let e=0;e<=t;e++)if(this.get(t,e)!==this.get(e,t))return!1;return!0}return!1}isDistance(){if(!this.isSymmetric())return!1;for(let t=0;t<this.rows;t++)if(0!==this.get(t,t))return!1;return!0}isEchelonForm(){let t=0,e=0,i=-1,n=!0,r=!1;for(;t<this.rows&&n;){for(e=0,r=!1;e<this.columns&&!1===r;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>i?(r=!0,i=e):(n=!1,r=!0);t++}return n}isReducedEchelonForm(){let t=0,e=0,i=-1,n=!0,r=!1;for(;t<this.rows&&n;){for(e=0,r=!1;e<this.columns&&!1===r;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>i?(r=!0,i=e):(n=!1,r=!0);for(let i=e+1;i<this.rows;i++)0!==this.get(t,i)&&(n=!1);t++}return n}echelonForm(){let t=this.clone(),e=0,i=0;for(;e<t.rows&&i<t.columns;){let n=e;for(let r=e;r<t.rows;r++)t.get(r,i)>t.get(n,i)&&(n=r);if(0===t.get(n,i))i++;else{t.swapRows(e,n);let r=t.get(e,i);for(let n=i;n<t.columns;n++)t.set(e,n,t.get(e,n)/r);for(let n=e+1;n<t.rows;n++){let r=t.get(n,i)/t.get(e,i);t.set(n,i,0);for(let s=i+1;s<t.columns;s++)t.set(n,s,t.get(n,s)-t.get(e,s)*r)}e++,i++}}return t}reducedEchelonForm(){let t=this.echelonForm(),e=t.columns,i=t.rows,n=i-1;for(;n>=0;)if(0===t.maxRow(n))n--;else{let r=0,s=!1;for(;r<i&&!1===s;)1===t.get(n,r)?s=!0:r++;for(let i=0;i<n;i++){let s=t.get(i,r);for(let o=r;o<e;o++){let e=t.get(i,o)-s*t.get(n,o);t.set(i,o,e)}}n--}return t}set(){throw new Error("set method is unimplemented")}get(){throw new Error("get method is unimplemented")}repeat(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{rows:e=1,columns:i=1}=t;if(!Number.isInteger(e)||e<=0)throw new TypeError("rows must be a positive integer");if(!Number.isInteger(i)||i<=0)throw new TypeError("columns must be a positive integer");let n=new x(this.rows*e,this.columns*i);for(let t=0;t<e;t++)for(let e=0;e<i;e++)n.setSubMatrix(this,this.rows*t,this.columns*e);return n}fill(t){for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.set(e,i,t);return this}neg(){return this.mulS(-1)}getRow(t){c(this,t);let e=[];for(let i=0;i<this.columns;i++)e.push(this.get(t,i));return e}getRowVector(t){return x.rowVector(this.getRow(t))}setRow(t,e){c(this,t),e=d(this,e);for(let i=0;i<this.columns;i++)this.set(t,i,e[i]);return this}swapRows(t,e){c(this,t),c(this,e);for(let i=0;i<this.columns;i++){let n=this.get(t,i);this.set(t,i,this.get(e,i)),this.set(e,i,n)}return this}getColumn(t){u(this,t);let e=[];for(let i=0;i<this.rows;i++)e.push(this.get(i,t));return e}getColumnVector(t){return x.columnVector(this.getColumn(t))}setColumn(t,e){u(this,t),e=f(this,e);for(let i=0;i<this.rows;i++)this.set(i,t,e[i]);return this}swapColumns(t,e){u(this,t),u(this,e);for(let i=0;i<this.rows;i++){let n=this.get(i,t);this.set(i,t,this.get(i,e)),this.set(i,e,n)}return this}addRowVector(t){t=d(this,t);for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.set(e,i,this.get(e,i)+t[i]);return this}subRowVector(t){t=d(this,t);for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.set(e,i,this.get(e,i)-t[i]);return this}mulRowVector(t){t=d(this,t);for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.set(e,i,this.get(e,i)*t[i]);return this}divRowVector(t){t=d(this,t);for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.set(e,i,this.get(e,i)/t[i]);return this}addColumnVector(t){t=f(this,t);for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.set(e,i,this.get(e,i)+t[e]);return this}subColumnVector(t){t=f(this,t);for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.set(e,i,this.get(e,i)-t[e]);return this}mulColumnVector(t){t=f(this,t);for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.set(e,i,this.get(e,i)*t[e]);return this}divColumnVector(t){t=f(this,t);for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.set(e,i,this.get(e,i)/t[e]);return this}mulRow(t,e){c(this,t);for(let i=0;i<this.columns;i++)this.set(t,i,this.get(t,i)*e);return this}mulColumn(t,e){u(this,t);for(let i=0;i<this.rows;i++)this.set(i,t,this.get(i,t)*e);return this}max(t){if(this.isEmpty())return NaN;switch(t){case"row":{const t=new Array(this.rows).fill(Number.NEGATIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.get(e,i)>t[e]&&(t[e]=this.get(e,i));return t}case"column":{const t=new Array(this.columns).fill(Number.NEGATIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.get(e,i)>t[i]&&(t[i]=this.get(e,i));return t}case void 0:{let t=this.get(0,0);for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.get(e,i)>t&&(t=this.get(e,i));return t}default:throw new Error(`invalid option: ${t}`)}}maxIndex(){y(this);let t=this.get(0,0),e=[0,0];for(let i=0;i<this.rows;i++)for(let n=0;n<this.columns;n++)this.get(i,n)>t&&(t=this.get(i,n),e[0]=i,e[1]=n);return e}min(t){if(this.isEmpty())return NaN;switch(t){case"row":{const t=new Array(this.rows).fill(Number.POSITIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.get(e,i)<t[e]&&(t[e]=this.get(e,i));return t}case"column":{const t=new Array(this.columns).fill(Number.POSITIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.get(e,i)<t[i]&&(t[i]=this.get(e,i));return t}case void 0:{let t=this.get(0,0);for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.get(e,i)<t&&(t=this.get(e,i));return t}default:throw new Error(`invalid option: ${t}`)}}minIndex(){y(this);let t=this.get(0,0),e=[0,0];for(let i=0;i<this.rows;i++)for(let n=0;n<this.columns;n++)this.get(i,n)<t&&(t=this.get(i,n),e[0]=i,e[1]=n);return e}maxRow(t){if(c(this,t),this.isEmpty())return NaN;let e=this.get(t,0);for(let i=1;i<this.columns;i++)this.get(t,i)>e&&(e=this.get(t,i));return e}maxRowIndex(t){c(this,t),y(this);let e=this.get(t,0),i=[t,0];for(let n=1;n<this.columns;n++)this.get(t,n)>e&&(e=this.get(t,n),i[1]=n);return i}minRow(t){if(c(this,t),this.isEmpty())return NaN;let e=this.get(t,0);for(let i=1;i<this.columns;i++)this.get(t,i)<e&&(e=this.get(t,i));return e}minRowIndex(t){c(this,t),y(this);let e=this.get(t,0),i=[t,0];for(let n=1;n<this.columns;n++)this.get(t,n)<e&&(e=this.get(t,n),i[1]=n);return i}maxColumn(t){if(u(this,t),this.isEmpty())return NaN;let e=this.get(0,t);for(let i=1;i<this.rows;i++)this.get(i,t)>e&&(e=this.get(i,t));return e}maxColumnIndex(t){u(this,t),y(this);let e=this.get(0,t),i=[0,t];for(let n=1;n<this.rows;n++)this.get(n,t)>e&&(e=this.get(n,t),i[0]=n);return i}minColumn(t){if(u(this,t),this.isEmpty())return NaN;let e=this.get(0,t);for(let i=1;i<this.rows;i++)this.get(i,t)<e&&(e=this.get(i,t));return e}minColumnIndex(t){u(this,t),y(this);let e=this.get(0,t),i=[0,t];for(let n=1;n<this.rows;n++)this.get(n,t)<e&&(e=this.get(n,t),i[0]=n);return i}diag(){let t=Math.min(this.rows,this.columns),e=[];for(let i=0;i<t;i++)e.push(this.get(i,i));return e}norm(t="frobenius"){switch(t){case"max":return this.max();case"frobenius":return Math.sqrt(this.dot(this));default:throw new RangeError(`unknown norm type: ${t}`)}}cumulativeSum(){let t=0;for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)t+=this.get(e,i),this.set(e,i,t);return this}dot(t){v.isMatrix(t)&&(t=t.to1DArray());let e=this.to1DArray();if(e.length!==t.length)throw new RangeError("vectors do not have the same size");let i=0;for(let n=0;n<e.length;n++)i+=e[n]*t[n];return i}mmul(t){t=x.checkMatrix(t);let e=this.rows,i=this.columns,n=t.columns,r=new x(e,n),s=new Float64Array(i);for(let o=0;o<n;o++){for(let e=0;e<i;e++)s[e]=t.get(e,o);for(let t=0;t<e;t++){let e=0;for(let n=0;n<i;n++)e+=this.get(t,n)*s[n];r.set(t,o,e)}}return r}strassen2x2(t){t=x.checkMatrix(t);let e=new x(2,2);const i=this.get(0,0),n=t.get(0,0),r=this.get(0,1),s=t.get(0,1),o=this.get(1,0),a=t.get(1,0),h=this.get(1,1),l=t.get(1,1),c=(i+h)*(n+l),u=(o+h)*n,d=i*(s-l),f=h*(a-n),g=(i+r)*l,m=c+f-g+(r-h)*(a+l),p=d+g,_=u+f,w=c-u+d+(o-i)*(n+s);return e.set(0,0,m),e.set(0,1,p),e.set(1,0,_),e.set(1,1,w),e}strassen3x3(t){t=x.checkMatrix(t);let e=new x(3,3);const i=this.get(0,0),n=this.get(0,1),r=this.get(0,2),s=this.get(1,0),o=this.get(1,1),a=this.get(1,2),h=this.get(2,0),l=this.get(2,1),c=this.get(2,2),u=t.get(0,0),d=t.get(0,1),f=t.get(0,2),g=t.get(1,0),m=t.get(1,1),p=t.get(1,2),_=t.get(2,0),w=t.get(2,1),y=t.get(2,2),v=(i-s)*(-d+m),b=(-i+s+o)*(u-d+m),M=(s+o)*(-u+d),E=i*u,S=(-i+h+l)*(u-f+p),k=(-i+h)*(f-p),C=(h+l)*(-u+f),I=(-r+l+c)*(m+_-w),A=(r-c)*(m-w),T=r*_,R=(l+c)*(-_+w),P=(-r+o+a)*(p+_-y),D=(r-a)*(p-y),F=(o+a)*(-_+y),L=E+T+n*g,O=(i+n+r-s-o-l-c)*m+b+M+E+I+T+R,N=E+S+C+(i+n+r-o-a-h-l)*p+T+P+F,B=v+o*(-u+d+g-m-p-_+y)+b+E+T+P+D,z=v+b+M+E+a*w,U=T+P+D+F+s*f,G=E+S+k+l*(-u+f+g-m-p-_+w)+I+A+T,Y=I+A+T+R+h*d,X=E+S+k+C+c*y;return e.set(0,0,L),e.set(0,1,O),e.set(0,2,N),e.set(1,0,B),e.set(1,1,z),e.set(1,2,U),e.set(2,0,G),e.set(2,1,Y),e.set(2,2,X),e}mmulStrassen(t){t=x.checkMatrix(t);let e=this.clone(),i=e.rows,n=e.columns,r=t.rows,s=t.columns;function o(t,e,i){let n=t.rows,r=t.columns;if(n===e&&r===i)return t;{let n=v.zeros(e,i);return n=n.setSubMatrix(t,0,0),n}}n!==r&&console.warn(`Multiplying ${i} x ${n} and ${r} x ${s} matrix: dimensions do not match.`);let a=Math.max(i,r),h=Math.max(n,s);return e=o(e,a,h),function t(e,i,n,r){if(n<=512||r<=512)return e.mmul(i);n%2==1&&r%2==1?(e=o(e,n+1,r+1),i=o(i,n+1,r+1)):n%2==1?(e=o(e,n+1,r),i=o(i,n+1,r)):r%2==1&&(e=o(e,n,r+1),i=o(i,n,r+1));let s=parseInt(e.rows/2,10),a=parseInt(e.columns/2,10),h=e.subMatrix(0,s-1,0,a-1),l=i.subMatrix(0,s-1,0,a-1),c=e.subMatrix(0,s-1,a,e.columns-1),u=i.subMatrix(0,s-1,a,i.columns-1),d=e.subMatrix(s,e.rows-1,0,a-1),f=i.subMatrix(s,i.rows-1,0,a-1),g=e.subMatrix(s,e.rows-1,a,e.columns-1),m=i.subMatrix(s,i.rows-1,a,i.columns-1),p=t(v.add(h,g),v.add(l,m),s,a),_=t(v.add(d,g),l,s,a),w=t(h,v.sub(u,m),s,a),y=t(g,v.sub(f,l),s,a),b=t(v.add(h,c),m,s,a),x=t(v.sub(d,h),v.add(l,u),s,a),M=t(v.sub(c,g),v.add(f,m),s,a),E=v.add(p,y);E.sub(b),E.add(M);let S=v.add(w,b),k=v.add(_,y),C=v.sub(p,_);C.add(w),C.add(x);let I=v.zeros(2*E.rows,2*E.columns);return I=I.setSubMatrix(E,0,0),I=I.setSubMatrix(S,E.rows,0),I=I.setSubMatrix(k,0,E.columns),I=I.setSubMatrix(C,E.rows,E.columns),I.subMatrix(0,n-1,0,r-1)}(e,t=o(t,a,h),a,h)}scaleRows(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{min:e=0,max:i=1}=t;if(!Number.isFinite(e))throw new TypeError("min must be a number");if(!Number.isFinite(i))throw new TypeError("max must be a number");if(e>=i)throw new RangeError("min must be smaller than max");let n=new x(this.rows,this.columns);for(let t=0;t<this.rows;t++){const s=this.getRow(t);s.length>0&&r(s,{min:e,max:i,output:s}),n.setRow(t,s)}return n}scaleColumns(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{min:e=0,max:i=1}=t;if(!Number.isFinite(e))throw new TypeError("min must be a number");if(!Number.isFinite(i))throw new TypeError("max must be a number");if(e>=i)throw new RangeError("min must be smaller than max");let n=new x(this.rows,this.columns);for(let t=0;t<this.columns;t++){const s=this.getColumn(t);s.length&&r(s,{min:e,max:i,output:s}),n.setColumn(t,s)}return n}flipRows(){const t=Math.ceil(this.columns/2);for(let e=0;e<this.rows;e++)for(let i=0;i<t;i++){let t=this.get(e,i),n=this.get(e,this.columns-1-i);this.set(e,i,n),this.set(e,this.columns-1-i,t)}return this}flipColumns(){const t=Math.ceil(this.rows/2);for(let e=0;e<this.columns;e++)for(let i=0;i<t;i++){let t=this.get(i,e),n=this.get(this.rows-1-i,e);this.set(i,e,n),this.set(this.rows-1-i,e,t)}return this}kroneckerProduct(t){t=x.checkMatrix(t);let e=this.rows,i=this.columns,n=t.rows,r=t.columns,s=new x(e*n,i*r);for(let o=0;o<e;o++)for(let e=0;e<i;e++)for(let i=0;i<n;i++)for(let a=0;a<r;a++)s.set(n*o+i,r*e+a,this.get(o,e)*t.get(i,a));return s}kroneckerSum(t){if(t=x.checkMatrix(t),!this.isSquare()||!t.isSquare())throw new Error("Kronecker Sum needs two Square Matrices");let e=this.rows,i=t.rows,n=this.kroneckerProduct(x.eye(i,i)),r=x.eye(e,e).kroneckerProduct(t);return n.add(r)}transpose(){let t=new x(this.columns,this.rows);for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)t.set(i,e,this.get(e,i));return t}sortRows(t=b){for(let e=0;e<this.rows;e++)this.setRow(e,this.getRow(e).sort(t));return this}sortColumns(t=b){for(let e=0;e<this.columns;e++)this.setColumn(e,this.getColumn(e).sort(t));return this}subMatrix(t,e,i,n){p(this,t,e,i,n);let r=new x(e-t+1,n-i+1);for(let s=t;s<=e;s++)for(let e=i;e<=n;e++)r.set(s-t,e-i,this.get(s,e));return r}subMatrixRow(t,e,i){if(void 0===e&&(e=0),void 0===i&&(i=this.columns-1),e>i||e<0||e>=this.columns||i<0||i>=this.columns)throw new RangeError("Argument out of range");let n=new x(t.length,i-e+1);for(let r=0;r<t.length;r++)for(let s=e;s<=i;s++){if(t[r]<0||t[r]>=this.rows)throw new RangeError(`Row index out of range: ${t[r]}`);n.set(r,s-e,this.get(t[r],s))}return n}subMatrixColumn(t,e,i){if(void 0===e&&(e=0),void 0===i&&(i=this.rows-1),e>i||e<0||e>=this.rows||i<0||i>=this.rows)throw new RangeError("Argument out of range");let n=new x(i-e+1,t.length);for(let r=0;r<t.length;r++)for(let s=e;s<=i;s++){if(t[r]<0||t[r]>=this.columns)throw new RangeError(`Column index out of range: ${t[r]}`);n.set(s-e,r,this.get(s,t[r]))}return n}setSubMatrix(t,e,i){if((t=x.checkMatrix(t)).isEmpty())return this;p(this,e,e+t.rows-1,i,i+t.columns-1);for(let n=0;n<t.rows;n++)for(let r=0;r<t.columns;r++)this.set(e+n,i+r,t.get(n,r));return this}selection(t,e){g(this,t),m(this,e);let i=new x(t.length,e.length);for(let n=0;n<t.length;n++){let r=t[n];for(let t=0;t<e.length;t++){let s=e[t];i.set(n,t,this.get(r,s))}}return i}trace(){let t=Math.min(this.rows,this.columns),e=0;for(let i=0;i<t;i++)e+=this.get(i,i);return e}clone(){return this.constructor.copy(this,new x(this.rows,this.columns))}static copy(t,e){for(const[i,n,r]of t.entries())e.set(i,n,r);return e}sum(t){switch(t){case"row":return function(t){let e=_(t.rows);for(let i=0;i<t.rows;++i)for(let n=0;n<t.columns;++n)e[i]+=t.get(i,n);return e}(this);case"column":return function(t){let e=_(t.columns);for(let i=0;i<t.rows;++i)for(let n=0;n<t.columns;++n)e[n]+=t.get(i,n);return e}(this);case void 0:return function(t){let e=0;for(let i=0;i<t.rows;i++)for(let n=0;n<t.columns;n++)e+=t.get(i,n);return e}(this);default:throw new Error(`invalid option: ${t}`)}}product(t){switch(t){case"row":return function(t){let e=_(t.rows,1);for(let i=0;i<t.rows;++i)for(let n=0;n<t.columns;++n)e[i]*=t.get(i,n);return e}(this);case"column":return function(t){let e=_(t.columns,1);for(let i=0;i<t.rows;++i)for(let n=0;n<t.columns;++n)e[n]*=t.get(i,n);return e}(this);case void 0:return function(t){let e=1;for(let i=0;i<t.rows;i++)for(let n=0;n<t.columns;n++)e*=t.get(i,n);return e}(this);default:throw new Error(`invalid option: ${t}`)}}mean(t){const e=this.sum(t);switch(t){case"row":for(let t=0;t<this.rows;t++)e[t]/=this.columns;return e;case"column":for(let t=0;t<this.columns;t++)e[t]/=this.rows;return e;case void 0:return e/this.size;default:throw new Error(`invalid option: ${t}`)}}variance(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw new TypeError("options must be an object");const{unbiased:i=!0,mean:r=this.mean(t)}=e;if("boolean"!=typeof i)throw new TypeError("unbiased must be a boolean");switch(t){case"row":if(!n.isAnyArray(r))throw new TypeError("mean must be an array");return function(t,e,i){const n=t.rows,r=t.columns,s=[];for(let o=0;o<n;o++){let n=0,a=0,h=0;for(let e=0;e<r;e++)h=t.get(o,e)-i[o],n+=h,a+=h*h;e?s.push((a-n*n/r)/(r-1)):s.push((a-n*n/r)/r)}return s}(this,i,r);case"column":if(!n.isAnyArray(r))throw new TypeError("mean must be an array");return function(t,e,i){const n=t.rows,r=t.columns,s=[];for(let o=0;o<r;o++){let r=0,a=0,h=0;for(let e=0;e<n;e++)h=t.get(e,o)-i[o],r+=h,a+=h*h;e?s.push((a-r*r/n)/(n-1)):s.push((a-r*r/n)/n)}return s}(this,i,r);case void 0:if("number"!=typeof r)throw new TypeError("mean must be a number");return function(t,e,i){const n=t.rows,r=t.columns,s=n*r;let o=0,a=0,h=0;for(let e=0;e<n;e++)for(let n=0;n<r;n++)h=t.get(e,n)-i,o+=h,a+=h*h;return e?(a-o*o/s)/(s-1):(a-o*o/s)/s}(this,i,r);default:throw new Error(`invalid option: ${t}`)}}standardDeviation(t,e){"object"==typeof t&&(e=t,t=void 0);const i=this.variance(t,e);if(void 0===t)return Math.sqrt(i);for(let t=0;t<i.length;t++)i[t]=Math.sqrt(i[t]);return i}center(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw new TypeError("options must be an object");const{center:i=this.mean(t)}=e;switch(t){case"row":if(!n.isAnyArray(i))throw new TypeError("center must be an array");return function(t,e){for(let i=0;i<t.rows;i++)for(let n=0;n<t.columns;n++)t.set(i,n,t.get(i,n)-e[i])}(this,i),this;case"column":if(!n.isAnyArray(i))throw new TypeError("center must be an array");return function(t,e){for(let i=0;i<t.rows;i++)for(let n=0;n<t.columns;n++)t.set(i,n,t.get(i,n)-e[n])}(this,i),this;case void 0:if("number"!=typeof i)throw new TypeError("center must be a number");return function(t,e){for(let i=0;i<t.rows;i++)for(let n=0;n<t.columns;n++)t.set(i,n,t.get(i,n)-e)}(this,i),this;default:throw new Error(`invalid option: ${t}`)}}scale(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw new TypeError("options must be an object");let i=e.scale;switch(t){case"row":if(void 0===i)i=function(t){const e=[];for(let i=0;i<t.rows;i++){let n=0;for(let e=0;e<t.columns;e++)n+=Math.pow(t.get(i,e),2)/(t.columns-1);e.push(Math.sqrt(n))}return e}(this);else if(!n.isAnyArray(i))throw new TypeError("scale must be an array");return function(t,e){for(let i=0;i<t.rows;i++)for(let n=0;n<t.columns;n++)t.set(i,n,t.get(i,n)/e[i])}(this,i),this;case"column":if(void 0===i)i=function(t){const e=[];for(let i=0;i<t.columns;i++){let n=0;for(let e=0;e<t.rows;e++)n+=Math.pow(t.get(e,i),2)/(t.rows-1);e.push(Math.sqrt(n))}return e}(this);else if(!n.isAnyArray(i))throw new TypeError("scale must be an array");return function(t,e){for(let i=0;i<t.rows;i++)for(let n=0;n<t.columns;n++)t.set(i,n,t.get(i,n)/e[n])}(this,i),this;case void 0:if(void 0===i)i=function(t){const e=t.size-1;let i=0;for(let n=0;n<t.columns;n++)for(let r=0;r<t.rows;r++)i+=Math.pow(t.get(r,n),2)/e;return Math.sqrt(i)}(this);else if("number"!=typeof i)throw new TypeError("scale must be a number");return function(t,e){for(let i=0;i<t.rows;i++)for(let n=0;n<t.columns;n++)t.set(i,n,t.get(i,n)/e)}(this,i),this;default:throw new Error(`invalid option: ${t}`)}}toString(t){return a(this,t)}[Symbol.iterator](){return this.entries()}*entries(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)yield[t,e,this.get(t,e)]}*values(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)yield this.get(t,e)}}function b(t,e){return t-e}v.prototype.klass="Matrix","undefined"!=typeof Symbol&&(v.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return a(this)}),v.random=v.rand,v.randomInt=v.randInt,v.diagonal=v.diag,v.prototype.diagonal=v.prototype.diag,v.identity=v.eye,v.prototype.negate=v.prototype.neg,v.prototype.tensorProduct=v.prototype.kroneckerProduct;class x extends v{data;#t(t,e){if(this.data=[],!(Number.isInteger(e)&&e>=0))throw new TypeError("nColumns must be a positive integer");for(let i=0;i<t;i++)this.data.push(new Float64Array(e));this.rows=t,this.columns=e}constructor(t,e){if(super(),x.isMatrix(t))this.#t(t.rows,t.columns),x.copy(t,this);else if(Number.isInteger(t)&&t>=0)this.#t(t,e);else{if(!n.isAnyArray(t))throw new TypeError("First argument must be a positive number or an array");{const i=t;if("number"!=typeof(e=(t=i.length)?i[0].length:0))throw new TypeError("Data must be a 2D array with at least one element");this.data=[];for(let n=0;n<t;n++){if(i[n].length!==e)throw new RangeError("Inconsistent array dimensions");if(!i[n].every((t=>"number"==typeof t)))throw new TypeError("Input data contains non-numeric values");this.data.push(Float64Array.from(i[n]))}this.rows=t,this.columns=e}}}set(t,e,i){return this.data[t][e]=i,this}get(t,e){return this.data[t][e]}removeRow(t){return c(this,t),this.data.splice(t,1),this.rows-=1,this}addRow(t,e){return void 0===e&&(e=t,t=this.rows),c(this,t,!0),e=Float64Array.from(d(this,e)),this.data.splice(t,0,e),this.rows+=1,this}removeColumn(t){u(this,t);for(let e=0;e<this.rows;e++){const i=new Float64Array(this.columns-1);for(let n=0;n<t;n++)i[n]=this.data[e][n];for(let n=t+1;n<this.columns;n++)i[n-1]=this.data[e][n];this.data[e]=i}return this.columns-=1,this}addColumn(t,e){void 0===e&&(e=t,t=this.columns),u(this,t,!0),e=f(this,e);for(let i=0;i<this.rows;i++){const n=new Float64Array(this.columns+1);let r=0;for(;r<t;r++)n[r]=this.data[i][r];for(n[r++]=e[i];r<this.columns+1;r++)n[r]=this.data[i][r-1];this.data[i]=n}return this.columns+=1,this}}!function(t,e){t.prototype.add=function(t){return"number"==typeof t?this.addS(t):this.addM(t)},t.prototype.addS=function(t){for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.set(e,i,this.get(e,i)+t);return this},t.prototype.addM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.set(e,i,this.get(e,i)+t.get(e,i));return this},t.add=function(t,i){return new e(t).add(i)},t.prototype.sub=function(t){return"number"==typeof t?this.subS(t):this.subM(t)},t.prototype.subS=function(t){for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.set(e,i,this.get(e,i)-t);return this},t.prototype.subM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.set(e,i,this.get(e,i)-t.get(e,i));return this},t.sub=function(t,i){return new e(t).sub(i)},t.prototype.subtract=t.prototype.sub,t.prototype.subtractS=t.prototype.subS,t.prototype.subtractM=t.prototype.subM,t.subtract=t.sub,t.prototype.mul=function(t){return"number"==typeof t?this.mulS(t):this.mulM(t)},t.prototype.mulS=function(t){for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.set(e,i,this.get(e,i)*t);return this},t.prototype.mulM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.set(e,i,this.get(e,i)*t.get(e,i));return this},t.mul=function(t,i){return new e(t).mul(i)},t.prototype.multiply=t.prototype.mul,t.prototype.multiplyS=t.prototype.mulS,t.prototype.multiplyM=t.prototype.mulM,t.multiply=t.mul,t.prototype.div=function(t){return"number"==typeof t?this.divS(t):this.divM(t)},t.prototype.divS=function(t){for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.set(e,i,this.get(e,i)/t);return this},t.prototype.divM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.set(e,i,this.get(e,i)/t.get(e,i));return this},t.div=function(t,i){return new e(t).div(i)},t.prototype.divide=t.prototype.div,t.prototype.divideS=t.prototype.divS,t.prototype.divideM=t.prototype.divM,t.divide=t.div,t.prototype.mod=function(t){return"number"==typeof t?this.modS(t):this.modM(t)},t.prototype.modS=function(t){for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.set(e,i,this.get(e,i)%t);return this},t.prototype.modM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.set(e,i,this.get(e,i)%t.get(e,i));return this},t.mod=function(t,i){return new e(t).mod(i)},t.prototype.modulus=t.prototype.mod,t.prototype.modulusS=t.prototype.modS,t.prototype.modulusM=t.prototype.modM,t.modulus=t.mod,t.prototype.and=function(t){return"number"==typeof t?this.andS(t):this.andM(t)},t.prototype.andS=function(t){for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.set(e,i,this.get(e,i)&t);return this},t.prototype.andM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.set(e,i,this.get(e,i)&t.get(e,i));return this},t.and=function(t,i){return new e(t).and(i)},t.prototype.or=function(t){return"number"==typeof t?this.orS(t):this.orM(t)},t.prototype.orS=function(t){for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.set(e,i,this.get(e,i)|t);return this},t.prototype.orM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.set(e,i,this.get(e,i)|t.get(e,i));return this},t.or=function(t,i){return new e(t).or(i)},t.prototype.xor=function(t){return"number"==typeof t?this.xorS(t):this.xorM(t)},t.prototype.xorS=function(t){for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.set(e,i,this.get(e,i)^t);return this},t.prototype.xorM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.set(e,i,this.get(e,i)^t.get(e,i));return this},t.xor=function(t,i){return new e(t).xor(i)},t.prototype.leftShift=function(t){return"number"==typeof t?this.leftShiftS(t):this.leftShiftM(t)},t.prototype.leftShiftS=function(t){for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.set(e,i,this.get(e,i)<<t);return this},t.prototype.leftShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.set(e,i,this.get(e,i)<<t.get(e,i));return this},t.leftShift=function(t,i){return new e(t).leftShift(i)},t.prototype.signPropagatingRightShift=function(t){return"number"==typeof t?this.signPropagatingRightShiftS(t):this.signPropagatingRightShiftM(t)},t.prototype.signPropagatingRightShiftS=function(t){for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.set(e,i,this.get(e,i)>>t);return this},t.prototype.signPropagatingRightShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.set(e,i,this.get(e,i)>>t.get(e,i));return this},t.signPropagatingRightShift=function(t,i){return new e(t).signPropagatingRightShift(i)},t.prototype.rightShift=function(t){return"number"==typeof t?this.rightShiftS(t):this.rightShiftM(t)},t.prototype.rightShiftS=function(t){for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.set(e,i,this.get(e,i)>>>t);return this},t.prototype.rightShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.set(e,i,this.get(e,i)>>>t.get(e,i));return this},t.rightShift=function(t,i){return new e(t).rightShift(i)},t.prototype.zeroFillRightShift=t.prototype.rightShift,t.prototype.zeroFillRightShiftS=t.prototype.rightShiftS,t.prototype.zeroFillRightShiftM=t.prototype.rightShiftM,t.zeroFillRightShift=t.rightShift,t.prototype.not=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,~this.get(t,e));return this},t.not=function(t){return new e(t).not()},t.prototype.abs=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.abs(this.get(t,e)));return this},t.abs=function(t){return new e(t).abs()},t.prototype.acos=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.acos(this.get(t,e)));return this},t.acos=function(t){return new e(t).acos()},t.prototype.acosh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.acosh(this.get(t,e)));return this},t.acosh=function(t){return new e(t).acosh()},t.prototype.asin=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.asin(this.get(t,e)));return this},t.asin=function(t){return new e(t).asin()},t.prototype.asinh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.asinh(this.get(t,e)));return this},t.asinh=function(t){return new e(t).asinh()},t.prototype.atan=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.atan(this.get(t,e)));return this},t.atan=function(t){return new e(t).atan()},t.prototype.atanh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.atanh(this.get(t,e)));return this},t.atanh=function(t){return new e(t).atanh()},t.prototype.cbrt=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cbrt(this.get(t,e)));return this},t.cbrt=function(t){return new e(t).cbrt()},t.prototype.ceil=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.ceil(this.get(t,e)));return this},t.ceil=function(t){return new e(t).ceil()},t.prototype.clz32=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.clz32(this.get(t,e)));return this},t.clz32=function(t){return new e(t).clz32()},t.prototype.cos=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cos(this.get(t,e)));return this},t.cos=function(t){return new e(t).cos()},t.prototype.cosh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cosh(this.get(t,e)));return this},t.cosh=function(t){return new e(t).cosh()},t.prototype.exp=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.exp(this.get(t,e)));return this},t.exp=function(t){return new e(t).exp()},t.prototype.expm1=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.expm1(this.get(t,e)));return this},t.expm1=function(t){return new e(t).expm1()},t.prototype.floor=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.floor(this.get(t,e)));return this},t.floor=function(t){return new e(t).floor()},t.prototype.fround=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.fround(this.get(t,e)));return this},t.fround=function(t){return new e(t).fround()},t.prototype.log=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log(this.get(t,e)));return this},t.log=function(t){return new e(t).log()},t.prototype.log1p=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log1p(this.get(t,e)));return this},t.log1p=function(t){return new e(t).log1p()},t.prototype.log10=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log10(this.get(t,e)));return this},t.log10=function(t){return new e(t).log10()},t.prototype.log2=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log2(this.get(t,e)));return this},t.log2=function(t){return new e(t).log2()},t.prototype.round=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.round(this.get(t,e)));return this},t.round=function(t){return new e(t).round()},t.prototype.sign=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sign(this.get(t,e)));return this},t.sign=function(t){return new e(t).sign()},t.prototype.sin=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sin(this.get(t,e)));return this},t.sin=function(t){return new e(t).sin()},t.prototype.sinh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sinh(this.get(t,e)));return this},t.sinh=function(t){return new e(t).sinh()},t.prototype.sqrt=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sqrt(this.get(t,e)));return this},t.sqrt=function(t){return new e(t).sqrt()},t.prototype.tan=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.tan(this.get(t,e)));return this},t.tan=function(t){return new e(t).tan()},t.prototype.tanh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.tanh(this.get(t,e)));return this},t.tanh=function(t){return new e(t).tanh()},t.prototype.trunc=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.trunc(this.get(t,e)));return this},t.trunc=function(t){return new e(t).trunc()},t.pow=function(t,i){return new e(t).pow(i)},t.prototype.pow=function(t){return"number"==typeof t?this.powS(t):this.powM(t)},t.prototype.powS=function(t){for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.set(e,i,Math.pow(this.get(e,i),t));return this},t.prototype.powM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let i=0;i<this.columns;i++)this.set(e,i,Math.pow(this.get(e,i),t.get(e,i)));return this}}(v,x);class M extends v{#e;get size(){return this.#e.size}get rows(){return this.#e.rows}get columns(){return this.#e.columns}get diagonalSize(){return this.rows}static isSymmetricMatrix(t){return x.isMatrix(t)&&"SymmetricMatrix"===t.klassType}static zeros(t){return new this(t)}static ones(t){return new this(t).fill(1)}constructor(t){if(super(),x.isMatrix(t)){if(!t.isSymmetric())throw new TypeError("not symmetric data");this.#e=x.copy(t,new x(t.rows,t.rows))}else if(Number.isInteger(t)&&t>=0)this.#e=new x(t,t);else if(this.#e=new x(t),!this.isSymmetric())throw new TypeError("not symmetric data")}clone(){const t=new M(this.diagonalSize);for(const[e,i,n]of this.upperRightEntries())t.set(e,i,n);return t}toMatrix(){return new x(this)}get(t,e){return this.#e.get(t,e)}set(t,e,i){return this.#e.set(t,e,i),this.#e.set(e,t,i),this}removeCross(t){return this.#e.removeRow(t),this.#e.removeColumn(t),this}addCross(t,e){void 0===e&&(e=t,t=this.diagonalSize);const i=e.slice();return i.splice(t,1),this.#e.addRow(t,i),this.#e.addColumn(t,e),this}applyMask(t){if(t.length!==this.diagonalSize)throw new RangeError("Mask size do not match with matrix size");const e=[];for(const[i,n]of t.entries())n||e.push(i);e.reverse();for(const t of e)this.removeCross(t);return this}toCompact(){const{diagonalSize:t}=this,e=new Array(t*(t+1)/2);for(let i=0,n=0,r=0;r<e.length;r++)e[r]=this.get(n,i),++i>=t&&(i=++n);return e}static fromCompact(t){const e=t.length,i=(Math.sqrt(8*e+1)-1)/2;if(!Number.isInteger(i))throw new TypeError(`This array is not a compact representation of a Symmetric Matrix, ${JSON.stringify(t)}`);const n=new M(i);for(let r=0,s=0,o=0;o<e;o++)n.set(r,s,t[o]),++r>=i&&(r=++s);return n}*upperRightEntries(){for(let t=0,e=0;t<this.diagonalSize;void 0){const i=this.get(t,e);yield[t,e,i],++e>=this.diagonalSize&&(e=++t)}}*upperRightValues(){for(let t=0,e=0;t<this.diagonalSize;void 0){const i=this.get(t,e);yield i,++e>=this.diagonalSize&&(e=++t)}}}M.prototype.klassType="SymmetricMatrix";class E extends M{static isDistanceMatrix(t){return M.isSymmetricMatrix(t)&&"DistanceMatrix"===t.klassSubType}constructor(t){if(super(t),!this.isDistance())throw new TypeError("Provided arguments do no produce a distance matrix")}set(t,e,i){return t===e&&(i=0),super.set(t,e,i)}addCross(t,e){return void 0===e&&(e=t,t=this.diagonalSize),(e=e.slice())[t]=0,super.addCross(t,e)}toSymmetricMatrix(){return new M(this)}clone(){const t=new E(this.diagonalSize);for(const[e,i,n]of this.upperRightEntries())e!==i&&t.set(e,i,n);return t}toCompact(){const{diagonalSize:t}=this,e=new Array((t-1)*t/2);for(let i=1,n=0,r=0;r<e.length;r++)e[r]=this.get(n,i),++i>=t&&(i=1+ ++n);return e}static fromCompact(t){const e=t.length,i=(Math.sqrt(8*e+1)+1)/2;if(!Number.isInteger(i))throw new TypeError(`This array is not a compact representation of a DistanceMatrix, ${JSON.stringify(t)}`);const n=new this(i);for(let r=1,s=0,o=0;o<e;o++)n.set(r,s,t[o]),++r>=i&&(r=1+ ++s);return n}}E.prototype.klassSubType="DistanceMatrix";class S extends v{constructor(t,e,i){super(),this.matrix=t,this.rows=e,this.columns=i}}class k extends S{constructor(t,e,i){g(t,e),m(t,i),super(t,e.length,i.length),this.rowIndices=e,this.columnIndices=i}set(t,e,i){return this.matrix.set(this.rowIndices[t],this.columnIndices[e],i),this}get(t,e){return this.matrix.get(this.rowIndices[t],this.columnIndices[e])}}class C extends v{constructor(t,e={}){const{rows:i=1}=e;if(t.length%i!=0)throw new Error("the data length is not divisible by the number of rows");super(),this.rows=i,this.columns=t.length/i,this.data=t}set(t,e,i){let n=this._calculateIndex(t,e);return this.data[n]=i,this}get(t,e){let i=this._calculateIndex(t,e);return this.data[i]}_calculateIndex(t,e){return t*this.columns+e}}class I extends v{constructor(t){super(),this.data=t,this.rows=t.length,this.columns=t[0].length}set(t,e,i){return this.data[t][e]=i,this}get(t,e){return this.data[t][e]}}class A{constructor(t){let e,i,n,r,s,o,a,h,l,c=(t=I.checkMatrix(t)).clone(),u=c.rows,d=c.columns,f=new Float64Array(u),g=1;for(e=0;e<u;e++)f[e]=e;for(h=new Float64Array(u),i=0;i<d;i++){for(e=0;e<u;e++)h[e]=c.get(e,i);for(e=0;e<u;e++){for(l=Math.min(e,i),s=0,n=0;n<l;n++)s+=c.get(e,n)*h[n];h[e]-=s,c.set(e,i,h[e])}for(r=i,e=i+1;e<u;e++)Math.abs(h[e])>Math.abs(h[r])&&(r=e);if(r!==i){for(n=0;n<d;n++)o=c.get(r,n),c.set(r,n,c.get(i,n)),c.set(i,n,o);a=f[r],f[r]=f[i],f[i]=a,g=-g}if(i<u&&0!==c.get(i,i))for(e=i+1;e<u;e++)c.set(e,i,c.get(e,i)/c.get(i,i))}this.LU=c,this.pivotVector=f,this.pivotSign=g}isSingular(){let t=this.LU,e=t.columns;for(let i=0;i<e;i++)if(0===t.get(i,i))return!0;return!1}solve(t){t=x.checkMatrix(t);let e=this.LU;if(e.rows!==t.rows)throw new Error("Invalid matrix dimensions");if(this.isSingular())throw new Error("LU matrix is singular");let i,n,r,s=t.columns,o=t.subMatrixRow(this.pivotVector,0,s-1),a=e.columns;for(r=0;r<a;r++)for(i=r+1;i<a;i++)for(n=0;n<s;n++)o.set(i,n,o.get(i,n)-o.get(r,n)*e.get(i,r));for(r=a-1;r>=0;r--){for(n=0;n<s;n++)o.set(r,n,o.get(r,n)/e.get(r,r));for(i=0;i<r;i++)for(n=0;n<s;n++)o.set(i,n,o.get(i,n)-o.get(r,n)*e.get(i,r))}return o}get determinant(){let t=this.LU;if(!t.isSquare())throw new Error("Matrix must be square");let e=this.pivotSign,i=t.columns;for(let n=0;n<i;n++)e*=t.get(n,n);return e}get lowerTriangularMatrix(){let t=this.LU,e=t.rows,i=t.columns,n=new x(e,i);for(let r=0;r<e;r++)for(let e=0;e<i;e++)r>e?n.set(r,e,t.get(r,e)):r===e?n.set(r,e,1):n.set(r,e,0);return n}get upperTriangularMatrix(){let t=this.LU,e=t.rows,i=t.columns,n=new x(e,i);for(let r=0;r<e;r++)for(let e=0;e<i;e++)r<=e?n.set(r,e,t.get(r,e)):n.set(r,e,0);return n}get pivotPermutationVector(){return Array.from(this.pivotVector)}}function T(t,e){let i=0;return Math.abs(t)>Math.abs(e)?(i=e/t,Math.abs(t)*Math.sqrt(1+i*i)):0!==e?(i=t/e,Math.abs(e)*Math.sqrt(1+i*i)):0}class R{constructor(t){let e,i,n,r,s=(t=I.checkMatrix(t)).clone(),o=t.rows,a=t.columns,h=new Float64Array(a);for(n=0;n<a;n++){let t=0;for(e=n;e<o;e++)t=T(t,s.get(e,n));if(0!==t){for(s.get(n,n)<0&&(t=-t),e=n;e<o;e++)s.set(e,n,s.get(e,n)/t);for(s.set(n,n,s.get(n,n)+1),i=n+1;i<a;i++){for(r=0,e=n;e<o;e++)r+=s.get(e,n)*s.get(e,i);for(r=-r/s.get(n,n),e=n;e<o;e++)s.set(e,i,s.get(e,i)+r*s.get(e,n))}}h[n]=-t}this.QR=s,this.Rdiag=h}solve(t){t=x.checkMatrix(t);let e=this.QR,i=e.rows;if(t.rows!==i)throw new Error("Matrix row dimensions must agree");if(!this.isFullRank())throw new Error("Matrix is rank deficient");let n,r,s,o,a=t.columns,h=t.clone(),l=e.columns;for(s=0;s<l;s++)for(r=0;r<a;r++){for(o=0,n=s;n<i;n++)o+=e.get(n,s)*h.get(n,r);for(o=-o/e.get(s,s),n=s;n<i;n++)h.set(n,r,h.get(n,r)+o*e.get(n,s))}for(s=l-1;s>=0;s--){for(r=0;r<a;r++)h.set(s,r,h.get(s,r)/this.Rdiag[s]);for(n=0;n<s;n++)for(r=0;r<a;r++)h.set(n,r,h.get(n,r)-h.get(s,r)*e.get(n,s))}return h.subMatrix(0,l-1,0,a-1)}isFullRank(){let t=this.QR.columns;for(let e=0;e<t;e++)if(0===this.Rdiag[e])return!1;return!0}get upperTriangularMatrix(){let t,e,i=this.QR,n=i.columns,r=new x(n,n);for(t=0;t<n;t++)for(e=0;e<n;e++)t<e?r.set(t,e,i.get(t,e)):t===e?r.set(t,e,this.Rdiag[t]):r.set(t,e,0);return r}get orthogonalMatrix(){let t,e,i,n,r=this.QR,s=r.rows,o=r.columns,a=new x(s,o);for(i=o-1;i>=0;i--){for(t=0;t<s;t++)a.set(t,i,0);for(a.set(i,i,1),e=i;e<o;e++)if(0!==r.get(i,i)){for(n=0,t=i;t<s;t++)n+=r.get(t,i)*a.get(t,e);for(n=-n/r.get(i,i),t=i;t<s;t++)a.set(t,e,a.get(t,e)+n*r.get(t,i))}}return a}}class P{constructor(t,e={}){if((t=I.checkMatrix(t)).isEmpty())throw new Error("Matrix must be non-empty");let i=t.rows,n=t.columns;const{computeLeftSingularVectors:r=!0,computeRightSingularVectors:s=!0,autoTranspose:o=!1}=e;let a,h=Boolean(r),l=Boolean(s),c=!1;if(i<n)if(o){a=t.transpose(),i=a.rows,n=a.columns,c=!0;let e=h;h=l,l=e}else a=t.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else a=t.clone();let u=Math.min(i,n),d=Math.min(i+1,n),f=new Float64Array(d),g=new x(i,u),m=new x(n,n),p=new Float64Array(n),_=new Float64Array(i),w=new Float64Array(d);for(let t=0;t<d;t++)w[t]=t;let y=Math.min(i-1,n),v=Math.max(0,Math.min(n-2,i)),b=Math.max(y,v);for(let t=0;t<b;t++){if(t<y){f[t]=0;for(let e=t;e<i;e++)f[t]=T(f[t],a.get(e,t));if(0!==f[t]){a.get(t,t)<0&&(f[t]=-f[t]);for(let e=t;e<i;e++)a.set(e,t,a.get(e,t)/f[t]);a.set(t,t,a.get(t,t)+1)}f[t]=-f[t]}for(let e=t+1;e<n;e++){if(t<y&&0!==f[t]){let n=0;for(let r=t;r<i;r++)n+=a.get(r,t)*a.get(r,e);n=-n/a.get(t,t);for(let r=t;r<i;r++)a.set(r,e,a.get(r,e)+n*a.get(r,t))}p[e]=a.get(t,e)}if(h&&t<y)for(let e=t;e<i;e++)g.set(e,t,a.get(e,t));if(t<v){p[t]=0;for(let e=t+1;e<n;e++)p[t]=T(p[t],p[e]);if(0!==p[t]){p[t+1]<0&&(p[t]=0-p[t]);for(let e=t+1;e<n;e++)p[e]/=p[t];p[t+1]+=1}if(p[t]=-p[t],t+1<i&&0!==p[t]){for(let e=t+1;e<i;e++)_[e]=0;for(let e=t+1;e<i;e++)for(let i=t+1;i<n;i++)_[e]+=p[i]*a.get(e,i);for(let e=t+1;e<n;e++){let n=-p[e]/p[t+1];for(let r=t+1;r<i;r++)a.set(r,e,a.get(r,e)+n*_[r])}}if(l)for(let e=t+1;e<n;e++)m.set(e,t,p[e])}}let M=Math.min(n,i+1);if(y<n&&(f[y]=a.get(y,y)),i<M&&(f[M-1]=0),v+1<M&&(p[v]=a.get(v,M-1)),p[M-1]=0,h){for(let t=y;t<u;t++){for(let e=0;e<i;e++)g.set(e,t,0);g.set(t,t,1)}for(let t=y-1;t>=0;t--)if(0!==f[t]){for(let e=t+1;e<u;e++){let n=0;for(let r=t;r<i;r++)n+=g.get(r,t)*g.get(r,e);n=-n/g.get(t,t);for(let r=t;r<i;r++)g.set(r,e,g.get(r,e)+n*g.get(r,t))}for(let e=t;e<i;e++)g.set(e,t,-g.get(e,t));g.set(t,t,1+g.get(t,t));for(let e=0;e<t-1;e++)g.set(e,t,0)}else{for(let e=0;e<i;e++)g.set(e,t,0);g.set(t,t,1)}}if(l)for(let t=n-1;t>=0;t--){if(t<v&&0!==p[t])for(let e=t+1;e<n;e++){let i=0;for(let r=t+1;r<n;r++)i+=m.get(r,t)*m.get(r,e);i=-i/m.get(t+1,t);for(let r=t+1;r<n;r++)m.set(r,e,m.get(r,e)+i*m.get(r,t))}for(let e=0;e<n;e++)m.set(e,t,0);m.set(t,t,1)}let E=M-1,S=Number.EPSILON;for(;M>0;){let t,e;for(t=M-2;t>=-1&&-1!==t;t--){const e=Number.MIN_VALUE+S*Math.abs(f[t]+Math.abs(f[t+1]));if(Math.abs(p[t])<=e||Number.isNaN(p[t])){p[t]=0;break}}if(t===M-2)e=4;else{let i;for(i=M-1;i>=t&&i!==t;i--){let e=(i!==M?Math.abs(p[i]):0)+(i!==t+1?Math.abs(p[i-1]):0);if(Math.abs(f[i])<=S*e){f[i]=0;break}}i===t?e=3:i===M-1?e=1:(e=2,t=i)}switch(t++,e){case 1:{let e=p[M-2];p[M-2]=0;for(let i=M-2;i>=t;i--){let r=T(f[i],e),s=f[i]/r,o=e/r;if(f[i]=r,i!==t&&(e=-o*p[i-1],p[i-1]=s*p[i-1]),l)for(let t=0;t<n;t++)r=s*m.get(t,i)+o*m.get(t,M-1),m.set(t,M-1,-o*m.get(t,i)+s*m.get(t,M-1)),m.set(t,i,r)}break}case 2:{let e=p[t-1];p[t-1]=0;for(let n=t;n<M;n++){let r=T(f[n],e),s=f[n]/r,o=e/r;if(f[n]=r,e=-o*p[n],p[n]=s*p[n],h)for(let e=0;e<i;e++)r=s*g.get(e,n)+o*g.get(e,t-1),g.set(e,t-1,-o*g.get(e,n)+s*g.get(e,t-1)),g.set(e,n,r)}break}case 3:{const e=Math.max(Math.abs(f[M-1]),Math.abs(f[M-2]),Math.abs(p[M-2]),Math.abs(f[t]),Math.abs(p[t])),r=f[M-1]/e,s=f[M-2]/e,o=p[M-2]/e,a=f[t]/e,c=p[t]/e,u=((s+r)*(s-r)+o*o)/2,d=r*o*(r*o);let _=0;0===u&&0===d||(_=u<0?0-Math.sqrt(u*u+d):Math.sqrt(u*u+d),_=d/(u+_));let w=(a+r)*(a-r)+_,y=a*c;for(let e=t;e<M-1;e++){let r=T(w,y);0===r&&(r=Number.MIN_VALUE);let s=w/r,o=y/r;if(e!==t&&(p[e-1]=r),w=s*f[e]+o*p[e],p[e]=s*p[e]-o*f[e],y=o*f[e+1],f[e+1]=s*f[e+1],l)for(let t=0;t<n;t++)r=s*m.get(t,e)+o*m.get(t,e+1),m.set(t,e+1,-o*m.get(t,e)+s*m.get(t,e+1)),m.set(t,e,r);if(r=T(w,y),0===r&&(r=Number.MIN_VALUE),s=w/r,o=y/r,f[e]=r,w=s*p[e]+o*f[e+1],f[e+1]=-o*p[e]+s*f[e+1],y=o*p[e+1],p[e+1]=s*p[e+1],h&&e<i-1)for(let t=0;t<i;t++)r=s*g.get(t,e)+o*g.get(t,e+1),g.set(t,e+1,-o*g.get(t,e)+s*g.get(t,e+1)),g.set(t,e,r)}p[M-2]=w;break}case 4:if(f[t]<=0&&(f[t]=f[t]<0?-f[t]:0,l))for(let e=0;e<=E;e++)m.set(e,t,-m.get(e,t));for(;t<E&&!(f[t]>=f[t+1]);){let e=f[t];if(f[t]=f[t+1],f[t+1]=e,l&&t<n-1)for(let i=0;i<n;i++)e=m.get(i,t+1),m.set(i,t+1,m.get(i,t)),m.set(i,t,e);if(h&&t<i-1)for(let n=0;n<i;n++)e=g.get(n,t+1),g.set(n,t+1,g.get(n,t)),g.set(n,t,e);t++}M--}}if(c){let t=m;m=g,g=t}this.m=i,this.n=n,this.s=f,this.U=g,this.V=m}solve(t){let e=t,i=this.threshold,n=this.s.length,r=x.zeros(n,n);for(let t=0;t<n;t++)Math.abs(this.s[t])<=i?r.set(t,t,0):r.set(t,t,1/this.s[t]);let s=this.U,o=this.rightSingularVectors,a=o.mmul(r),h=o.rows,l=s.rows,c=x.zeros(h,l);for(let t=0;t<h;t++)for(let e=0;e<l;e++){let i=0;for(let r=0;r<n;r++)i+=a.get(t,r)*s.get(e,r);c.set(t,e,i)}return c.mmul(e)}solveForDiagonal(t){return this.solve(x.diag(t))}inverse(){let t=this.V,e=this.threshold,i=t.rows,n=t.columns,r=new x(i,this.s.length);for(let s=0;s<i;s++)for(let i=0;i<n;i++)Math.abs(this.s[i])>e&&r.set(s,i,t.get(s,i)/this.s[i]);let s=this.U,o=s.rows,a=s.columns,h=new x(i,o);for(let t=0;t<i;t++)for(let e=0;e<o;e++){let i=0;for(let n=0;n<a;n++)i+=r.get(t,n)*s.get(e,n);h.set(t,e,i)}return h}get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]}get norm2(){return this.s[0]}get rank(){let t=Math.max(this.m,this.n)*this.s[0]*Number.EPSILON,e=0,i=this.s;for(let n=0,r=i.length;n<r;n++)i[n]>t&&e++;return e}get diagonal(){return Array.from(this.s)}get threshold(){return Number.EPSILON/2*Math.max(this.m,this.n)*this.s[0]}get leftSingularVectors(){return this.U}get rightSingularVectors(){return this.V}get diagonalMatrix(){return x.diag(this.s)}}function D(t,e,i=!1){return t=I.checkMatrix(t),e=I.checkMatrix(e),i?new P(t).solve(e):t.isSquare()?new A(t).solve(e):new R(t).solve(e)}function F(t,e){let i=[];for(let n=0;n<t;n++)n!==e&&i.push(n);return i}function L(t,e,i,n=1e-9,r=1e-9){if(t>r)return new Array(e.rows+1).fill(0);{let t=e.addRow(i,[0]);for(let e=0;e<t.rows;e++)Math.abs(t.get(e,0))<n&&t.set(e,0,0);return t.to1DArray()}}class O{constructor(t,e={}){const{assumeSymmetric:i=!1}=e;if(!(t=I.checkMatrix(t)).isSquare())throw new Error("Matrix is not a square matrix");if(t.isEmpty())throw new Error("Matrix must be non-empty");let n,r,s=t.columns,o=new x(s,s),a=new Float64Array(s),h=new Float64Array(s),l=t,c=!1;if(c=!!i||t.isSymmetric(),c){for(n=0;n<s;n++)for(r=0;r<s;r++)o.set(n,r,l.get(n,r));!function(t,e,i,n){let r,s,o,a,h,l,c,u;for(h=0;h<t;h++)i[h]=n.get(t-1,h);for(a=t-1;a>0;a--){for(u=0,o=0,l=0;l<a;l++)u+=Math.abs(i[l]);if(0===u)for(e[a]=i[a-1],h=0;h<a;h++)i[h]=n.get(a-1,h),n.set(a,h,0),n.set(h,a,0);else{for(l=0;l<a;l++)i[l]/=u,o+=i[l]*i[l];for(r=i[a-1],s=Math.sqrt(o),r>0&&(s=-s),e[a]=u*s,o-=r*s,i[a-1]=r-s,h=0;h<a;h++)e[h]=0;for(h=0;h<a;h++){for(r=i[h],n.set(h,a,r),s=e[h]+n.get(h,h)*r,l=h+1;l<=a-1;l++)s+=n.get(l,h)*i[l],e[l]+=n.get(l,h)*r;e[h]=s}for(r=0,h=0;h<a;h++)e[h]/=o,r+=e[h]*i[h];for(c=r/(o+o),h=0;h<a;h++)e[h]-=c*i[h];for(h=0;h<a;h++){for(r=i[h],s=e[h],l=h;l<=a-1;l++)n.set(l,h,n.get(l,h)-(r*e[l]+s*i[l]));i[h]=n.get(a-1,h),n.set(a,h,0)}}i[a]=o}for(a=0;a<t-1;a++){if(n.set(t-1,a,n.get(a,a)),n.set(a,a,1),o=i[a+1],0!==o){for(l=0;l<=a;l++)i[l]=n.get(l,a+1)/o;for(h=0;h<=a;h++){for(s=0,l=0;l<=a;l++)s+=n.get(l,a+1)*n.get(l,h);for(l=0;l<=a;l++)n.set(l,h,n.get(l,h)-s*i[l])}}for(l=0;l<=a;l++)n.set(l,a+1,0)}for(h=0;h<t;h++)i[h]=n.get(t-1,h),n.set(t-1,h,0);n.set(t-1,t-1,1),e[0]=0}(s,h,a,o),function(t,e,i,n){let r,s,o,a,h,l,c,u,d,f,g,m,p,_,w,y;for(o=1;o<t;o++)e[o-1]=e[o];e[t-1]=0;let v=0,b=0,x=Number.EPSILON;for(l=0;l<t;l++){for(b=Math.max(b,Math.abs(i[l])+Math.abs(e[l])),c=l;c<t&&!(Math.abs(e[c])<=x*b);)c++;if(c>l)do{for(r=i[l],u=(i[l+1]-r)/(2*e[l]),d=T(u,1),u<0&&(d=-d),i[l]=e[l]/(u+d),i[l+1]=e[l]*(u+d),f=i[l+1],s=r-i[l],o=l+2;o<t;o++)i[o]-=s;for(v+=s,u=i[c],g=1,m=g,p=g,_=e[l+1],w=0,y=0,o=c-1;o>=l;o--)for(p=m,m=g,y=w,r=g*e[o],s=g*u,d=T(u,e[o]),e[o+1]=w*d,w=e[o]/d,g=u/d,u=g*i[o]-w*r,i[o+1]=s+w*(g*r+w*i[o]),h=0;h<t;h++)s=n.get(h,o+1),n.set(h,o+1,w*n.get(h,o)+g*s),n.set(h,o,g*n.get(h,o)-w*s);u=-w*y*p*_*e[l]/f,e[l]=w*u,i[l]=g*u}while(Math.abs(e[l])>x*b);i[l]=i[l]+v,e[l]=0}for(o=0;o<t-1;o++){for(h=o,u=i[o],a=o+1;a<t;a++)i[a]<u&&(h=a,u=i[a]);if(h!==o)for(i[h]=i[o],i[o]=u,a=0;a<t;a++)u=n.get(a,o),n.set(a,o,n.get(a,h)),n.set(a,h,u)}}(s,h,a,o)}else{let t=new x(s,s),e=new Float64Array(s);for(r=0;r<s;r++)for(n=0;n<s;n++)t.set(n,r,l.get(n,r));!function(t,e,i,n){let r,s,o,a,h,l,c,u=t-1;for(l=1;l<=u-1;l++){for(c=0,a=l;a<=u;a++)c+=Math.abs(e.get(a,l-1));if(0!==c){for(o=0,a=u;a>=l;a--)i[a]=e.get(a,l-1)/c,o+=i[a]*i[a];for(s=Math.sqrt(o),i[l]>0&&(s=-s),o-=i[l]*s,i[l]=i[l]-s,h=l;h<t;h++){for(r=0,a=u;a>=l;a--)r+=i[a]*e.get(a,h);for(r/=o,a=l;a<=u;a++)e.set(a,h,e.get(a,h)-r*i[a])}for(a=0;a<=u;a++){for(r=0,h=u;h>=l;h--)r+=i[h]*e.get(a,h);for(r/=o,h=l;h<=u;h++)e.set(a,h,e.get(a,h)-r*i[h])}i[l]=c*i[l],e.set(l,l-1,c*s)}}for(a=0;a<t;a++)for(h=0;h<t;h++)n.set(a,h,a===h?1:0);for(l=u-1;l>=1;l--)if(0!==e.get(l,l-1)){for(a=l+1;a<=u;a++)i[a]=e.get(a,l-1);for(h=l;h<=u;h++){for(s=0,a=l;a<=u;a++)s+=i[a]*n.get(a,h);for(s=s/i[l]/e.get(l,l-1),a=l;a<=u;a++)n.set(a,h,n.get(a,h)+s*i[a])}}}(s,t,e,o),function(t,e,i,n,r){let s,o,a,h,l,c,u,d,f,g,m,p,_,w,y,v=t-1,b=t-1,x=Number.EPSILON,M=0,E=0,S=0,k=0,C=0,I=0,A=0,T=0;for(s=0;s<t;s++)for((s<0||s>b)&&(i[s]=r.get(s,s),e[s]=0),o=Math.max(s-1,0);o<t;o++)E+=Math.abs(r.get(s,o));for(;v>=0;){for(h=v;h>0&&(I=Math.abs(r.get(h-1,h-1))+Math.abs(r.get(h,h)),0===I&&(I=E),!(Math.abs(r.get(h,h-1))<x*I));)h--;if(h===v)r.set(v,v,r.get(v,v)+M),i[v]=r.get(v,v),e[v]=0,v--,T=0;else if(h===v-1){if(u=r.get(v,v-1)*r.get(v-1,v),S=(r.get(v-1,v-1)-r.get(v,v))/2,k=S*S+u,A=Math.sqrt(Math.abs(k)),r.set(v,v,r.get(v,v)+M),r.set(v-1,v-1,r.get(v-1,v-1)+M),d=r.get(v,v),k>=0){for(A=S>=0?S+A:S-A,i[v-1]=d+A,i[v]=i[v-1],0!==A&&(i[v]=d-u/A),e[v-1]=0,e[v]=0,d=r.get(v,v-1),I=Math.abs(d)+Math.abs(A),S=d/I,k=A/I,C=Math.sqrt(S*S+k*k),S/=C,k/=C,o=v-1;o<t;o++)A=r.get(v-1,o),r.set(v-1,o,k*A+S*r.get(v,o)),r.set(v,o,k*r.get(v,o)-S*A);for(s=0;s<=v;s++)A=r.get(s,v-1),r.set(s,v-1,k*A+S*r.get(s,v)),r.set(s,v,k*r.get(s,v)-S*A);for(s=0;s<=b;s++)A=n.get(s,v-1),n.set(s,v-1,k*A+S*n.get(s,v)),n.set(s,v,k*n.get(s,v)-S*A)}else i[v-1]=d+S,i[v]=d+S,e[v-1]=A,e[v]=-A;v-=2,T=0}else{if(d=r.get(v,v),f=0,u=0,h<v&&(f=r.get(v-1,v-1),u=r.get(v,v-1)*r.get(v-1,v)),10===T){for(M+=d,s=0;s<=v;s++)r.set(s,s,r.get(s,s)-d);I=Math.abs(r.get(v,v-1))+Math.abs(r.get(v-1,v-2)),d=f=.75*I,u=-.4375*I*I}if(30===T&&(I=(f-d)/2,I=I*I+u,I>0)){for(I=Math.sqrt(I),f<d&&(I=-I),I=d-u/((f-d)/2+I),s=0;s<=v;s++)r.set(s,s,r.get(s,s)-I);M+=I,d=f=u=.964}for(T+=1,l=v-2;l>=h&&(A=r.get(l,l),C=d-A,I=f-A,S=(C*I-u)/r.get(l+1,l)+r.get(l,l+1),k=r.get(l+1,l+1)-A-C-I,C=r.get(l+2,l+1),I=Math.abs(S)+Math.abs(k)+Math.abs(C),S/=I,k/=I,C/=I,l!==h)&&!(Math.abs(r.get(l,l-1))*(Math.abs(k)+Math.abs(C))<x*(Math.abs(S)*(Math.abs(r.get(l-1,l-1))+Math.abs(A)+Math.abs(r.get(l+1,l+1)))));)l--;for(s=l+2;s<=v;s++)r.set(s,s-2,0),s>l+2&&r.set(s,s-3,0);for(a=l;a<=v-1&&(w=a!==v-1,a!==l&&(S=r.get(a,a-1),k=r.get(a+1,a-1),C=w?r.get(a+2,a-1):0,d=Math.abs(S)+Math.abs(k)+Math.abs(C),0!==d&&(S/=d,k/=d,C/=d)),0!==d);a++)if(I=Math.sqrt(S*S+k*k+C*C),S<0&&(I=-I),0!==I){for(a!==l?r.set(a,a-1,-I*d):h!==l&&r.set(a,a-1,-r.get(a,a-1)),S+=I,d=S/I,f=k/I,A=C/I,k/=S,C/=S,o=a;o<t;o++)S=r.get(a,o)+k*r.get(a+1,o),w&&(S+=C*r.get(a+2,o),r.set(a+2,o,r.get(a+2,o)-S*A)),r.set(a,o,r.get(a,o)-S*d),r.set(a+1,o,r.get(a+1,o)-S*f);for(s=0;s<=Math.min(v,a+3);s++)S=d*r.get(s,a)+f*r.get(s,a+1),w&&(S+=A*r.get(s,a+2),r.set(s,a+2,r.get(s,a+2)-S*C)),r.set(s,a,r.get(s,a)-S),r.set(s,a+1,r.get(s,a+1)-S*k);for(s=0;s<=b;s++)S=d*n.get(s,a)+f*n.get(s,a+1),w&&(S+=A*n.get(s,a+2),n.set(s,a+2,n.get(s,a+2)-S*C)),n.set(s,a,n.get(s,a)-S),n.set(s,a+1,n.get(s,a+1)-S*k)}}}if(0!==E){for(v=t-1;v>=0;v--)if(S=i[v],k=e[v],0===k)for(h=v,r.set(v,v,1),s=v-1;s>=0;s--){for(u=r.get(s,s)-S,C=0,o=h;o<=v;o++)C+=r.get(s,o)*r.get(o,v);if(e[s]<0)A=u,I=C;else if(h=s,0===e[s]?r.set(s,v,0!==u?-C/u:-C/(x*E)):(d=r.get(s,s+1),f=r.get(s+1,s),k=(i[s]-S)*(i[s]-S)+e[s]*e[s],c=(d*I-A*C)/k,r.set(s,v,c),r.set(s+1,v,Math.abs(d)>Math.abs(A)?(-C-u*c)/d:(-I-f*c)/A)),c=Math.abs(r.get(s,v)),x*c*c>1)for(o=s;o<=v;o++)r.set(o,v,r.get(o,v)/c)}else if(k<0)for(h=v-1,Math.abs(r.get(v,v-1))>Math.abs(r.get(v-1,v))?(r.set(v-1,v-1,k/r.get(v,v-1)),r.set(v-1,v,-(r.get(v,v)-S)/r.get(v,v-1))):(y=N(0,-r.get(v-1,v),r.get(v-1,v-1)-S,k),r.set(v-1,v-1,y[0]),r.set(v-1,v,y[1])),r.set(v,v-1,0),r.set(v,v,1),s=v-2;s>=0;s--){for(g=0,m=0,o=h;o<=v;o++)g+=r.get(s,o)*r.get(o,v-1),m+=r.get(s,o)*r.get(o,v);if(u=r.get(s,s)-S,e[s]<0)A=u,C=g,I=m;else if(h=s,0===e[s]?(y=N(-g,-m,u,k),r.set(s,v-1,y[0]),r.set(s,v,y[1])):(d=r.get(s,s+1),f=r.get(s+1,s),p=(i[s]-S)*(i[s]-S)+e[s]*e[s]-k*k,_=2*(i[s]-S)*k,0===p&&0===_&&(p=x*E*(Math.abs(u)+Math.abs(k)+Math.abs(d)+Math.abs(f)+Math.abs(A))),y=N(d*C-A*g+k*m,d*I-A*m-k*g,p,_),r.set(s,v-1,y[0]),r.set(s,v,y[1]),Math.abs(d)>Math.abs(A)+Math.abs(k)?(r.set(s+1,v-1,(-g-u*r.get(s,v-1)+k*r.get(s,v))/d),r.set(s+1,v,(-m-u*r.get(s,v)-k*r.get(s,v-1))/d)):(y=N(-C-f*r.get(s,v-1),-I-f*r.get(s,v),A,k),r.set(s+1,v-1,y[0]),r.set(s+1,v,y[1]))),c=Math.max(Math.abs(r.get(s,v-1)),Math.abs(r.get(s,v))),x*c*c>1)for(o=s;o<=v;o++)r.set(o,v-1,r.get(o,v-1)/c),r.set(o,v,r.get(o,v)/c)}for(s=0;s<t;s++)if(s<0||s>b)for(o=s;o<t;o++)n.set(s,o,r.get(s,o));for(o=t-1;o>=0;o--)for(s=0;s<=b;s++){for(A=0,a=0;a<=Math.min(o,b);a++)A+=n.get(s,a)*r.get(a,o);n.set(s,o,A)}}}(s,h,a,o,t)}this.n=s,this.e=h,this.d=a,this.V=o}get realEigenvalues(){return Array.from(this.d)}get imaginaryEigenvalues(){return Array.from(this.e)}get eigenvectorMatrix(){return this.V}get diagonalMatrix(){let t,e,i=this.n,n=this.e,r=this.d,s=new x(i,i);for(t=0;t<i;t++){for(e=0;e<i;e++)s.set(t,e,0);s.set(t,t,r[t]),n[t]>0?s.set(t,t+1,n[t]):n[t]<0&&s.set(t,t-1,n[t])}return s}}function N(t,e,i,n){let r,s;return Math.abs(i)>Math.abs(n)?(r=n/i,s=i+r*n,[(t+r*e)/s,(e-r*t)/s]):(r=i/n,s=n+r*i,[(r*t+e)/s,(r*e-t)/s])}class B{constructor(t){if(!(t=I.checkMatrix(t)).isSymmetric())throw new Error("Matrix is not symmetric");let e,i,n,r=t,s=r.rows,o=new x(s,s),a=!0;for(i=0;i<s;i++){let t=0;for(n=0;n<i;n++){let s=0;for(e=0;e<n;e++)s+=o.get(n,e)*o.get(i,e);s=(r.get(i,n)-s)/o.get(n,n),o.set(i,n,s),t+=s*s}for(t=r.get(i,i)-t,a&=t>0,o.set(i,i,Math.sqrt(Math.max(t,0))),n=i+1;n<s;n++)o.set(i,n,0)}this.L=o,this.positiveDefinite=Boolean(a)}isPositiveDefinite(){return this.positiveDefinite}solve(t){t=I.checkMatrix(t);let e=this.L,i=e.rows;if(t.rows!==i)throw new Error("Matrix dimensions do not match");if(!1===this.isPositiveDefinite())throw new Error("Matrix is not positive definite");let n,r,s,o=t.columns,a=t.clone();for(s=0;s<i;s++)for(r=0;r<o;r++){for(n=0;n<s;n++)a.set(s,r,a.get(s,r)-a.get(n,r)*e.get(s,n));a.set(s,r,a.get(s,r)/e.get(s,s))}for(s=i-1;s>=0;s--)for(r=0;r<o;r++){for(n=s+1;n<i;n++)a.set(s,r,a.get(s,r)-a.get(n,r)*e.get(n,s));a.set(s,r,a.get(s,r)/e.get(s,s))}return a}get lowerTriangularMatrix(){return this.L}}class z{constructor(t,e={}){t=I.checkMatrix(t);let{Y:i}=e;const{scaleScores:r=!1,maxIterations:s=1e3,terminationCriteria:o=1e-10}=e;let a;if(i){if(i=n.isAnyArray(i)&&"number"==typeof i[0]?x.columnVector(i):I.checkMatrix(i),i.rows!==t.rows)throw new Error("Y should have the same number of rows as X");a=i.getColumnVector(0)}else a=t.getColumnVector(0);let h,l,c,u,d=1;for(let e=0;e<s&&d>o;e++)c=t.transpose().mmul(a).div(a.transpose().mmul(a).get(0,0)),c=c.div(c.norm()),h=t.mmul(c).div(c.transpose().mmul(c).get(0,0)),e>0&&(d=h.clone().sub(u).pow(2).sum()),u=h.clone(),i?(l=i.transpose().mmul(h).div(h.transpose().mmul(h).get(0,0)),l=l.div(l.norm()),a=i.mmul(l).div(l.transpose().mmul(l).get(0,0))):a=h;if(i){let e=t.transpose().mmul(h).div(h.transpose().mmul(h).get(0,0));e=e.div(e.norm());let n=t.clone().sub(h.clone().mmul(e.transpose())),r=a.transpose().mmul(h).div(h.transpose().mmul(h).get(0,0)),s=i.clone().sub(h.clone().mulS(r.get(0,0)).mmul(l.transpose()));this.t=h,this.p=e.transpose(),this.w=c.transpose(),this.q=l,this.u=a,this.s=h.transpose().mmul(h),this.xResidual=n,this.yResidual=s,this.betas=r}else this.w=c.transpose(),this.s=h.transpose().mmul(h).sqrt(),this.t=r?h.clone().div(this.s.get(0,0)):h,this.xResidual=t.sub(h.mmul(c.transpose()))}}e.AbstractMatrix=v,e.CHO=B,e.CholeskyDecomposition=B,e.DistanceMatrix=E,e.EVD=O,e.EigenvalueDecomposition=O,e.LU=A,e.LuDecomposition=A,e.Matrix=x,e.MatrixColumnSelectionView=class extends S{constructor(t,e){m(t,e),super(t,t.rows,e.length),this.columnIndices=e}set(t,e,i){return this.matrix.set(t,this.columnIndices[e],i),this}get(t,e){return this.matrix.get(t,this.columnIndices[e])}},e.MatrixColumnView=class extends S{constructor(t,e){u(t,e),super(t,t.rows,1),this.column=e}set(t,e,i){return this.matrix.set(t,this.column,i),this}get(t){return this.matrix.get(t,this.column)}},e.MatrixFlipColumnView=class extends S{constructor(t){super(t,t.rows,t.columns)}set(t,e,i){return this.matrix.set(t,this.columns-e-1,i),this}get(t,e){return this.matrix.get(t,this.columns-e-1)}},e.MatrixFlipRowView=class extends S{constructor(t){super(t,t.rows,t.columns)}set(t,e,i){return this.matrix.set(this.rows-t-1,e,i),this}get(t,e){return this.matrix.get(this.rows-t-1,e)}},e.MatrixRowSelectionView=class extends S{constructor(t,e){g(t,e),super(t,e.length,t.columns),this.rowIndices=e}set(t,e,i){return this.matrix.set(this.rowIndices[t],e,i),this}get(t,e){return this.matrix.get(this.rowIndices[t],e)}},e.MatrixRowView=class extends S{constructor(t,e){c(t,e),super(t,1,t.columns),this.row=e}set(t,e,i){return this.matrix.set(this.row,e,i),this}get(t,e){return this.matrix.get(this.row,e)}},e.MatrixSelectionView=k,e.MatrixSubView=class extends S{constructor(t,e,i,n,r){p(t,e,i,n,r),super(t,i-e+1,r-n+1),this.startRow=e,this.startColumn=n}set(t,e,i){return this.matrix.set(this.startRow+t,this.startColumn+e,i),this}get(t,e){return this.matrix.get(this.startRow+t,this.startColumn+e)}},e.MatrixTransposeView=class extends S{constructor(t){super(t,t.columns,t.rows)}set(t,e,i){return this.matrix.set(e,t,i),this}get(t,e){return this.matrix.get(e,t)}},e.NIPALS=z,e.Nipals=z,e.QR=R,e.QrDecomposition=R,e.SVD=P,e.SingularValueDecomposition=P,e.SymmetricMatrix=M,e.WrapperMatrix1D=C,e.WrapperMatrix2D=I,e.correlation=function(t,e=t,i={}){t=new x(t);let r=!1;if("object"!=typeof e||x.isMatrix(e)||n.isAnyArray(e)?e=new x(e):(i=e,e=t,r=!0),t.rows!==e.rows)throw new TypeError("Both matrices must have the same number of rows");const{center:s=!0,scale:o=!0}=i;s&&(t.center("column"),r||e.center("column")),o&&(t.scale("column"),r||e.scale("column"));const a=t.standardDeviation("column",{unbiased:!0}),h=r?a:e.standardDeviation("column",{unbiased:!0}),l=t.transpose().mmul(e);for(let e=0;e<l.rows;e++)for(let i=0;i<l.columns;i++)l.set(e,i,l.get(e,i)*(1/(a[e]*h[i]))*(1/(t.rows-1)));return l},e.covariance=function(t,e=t,i={}){t=new x(t);let r=!1;if("object"!=typeof e||x.isMatrix(e)||n.isAnyArray(e)?e=new x(e):(i=e,e=t,r=!0),t.rows!==e.rows)throw new TypeError("Both matrices must have the same number of rows");const{center:s=!0}=i;s&&(t=t.center("column"),r||(e=e.center("column")));const o=t.transpose().mmul(e);for(let e=0;e<o.rows;e++)for(let i=0;i<o.columns;i++)o.set(e,i,o.get(e,i)*(1/(t.rows-1)));return o},e.default=x,e.determinant=function t(e){if((e=x.checkMatrix(e)).isSquare()){if(0===e.columns)return 1;let i,n,r,s;if(2===e.columns)return i=e.get(0,0),n=e.get(0,1),r=e.get(1,0),s=e.get(1,1),i*s-n*r;if(3===e.columns){let s,o,a;return s=new k(e,[1,2],[1,2]),o=new k(e,[1,2],[0,2]),a=new k(e,[1,2],[0,1]),i=e.get(0,0),n=e.get(0,1),r=e.get(0,2),i*t(s)-n*t(o)+r*t(a)}return new A(e).determinant}throw Error("determinant can only be calculated for a square matrix")},e.inverse=function(t,e=!1){return t=I.checkMatrix(t),e?new P(t).inverse():D(t,x.eye(t.rows))},e.linearDependencies=function(t,e={}){const{thresholdValue:i=1e-9,thresholdError:n=1e-9}=e;let r=(t=x.checkMatrix(t)).rows,s=new x(r,r);for(let e=0;e<r;e++){let o=x.columnVector(t.getRow(e)),a=t.subMatrixRow(F(r,e)).transpose(),h=new P(a).solve(o),l=x.sub(o,a.mmul(h)).abs().max();s.setRow(e,L(l,h,e,i,n))}return s},e.pseudoInverse=function(t,e=Number.EPSILON){if((t=x.checkMatrix(t)).isEmpty())return t.transpose();let i=new P(t,{autoTranspose:!0}),n=i.leftSingularVectors,r=i.rightSingularVectors,s=i.diagonal;for(let t=0;t<s.length;t++)Math.abs(s[t])>e?s[t]=1/s[t]:s[t]=0;return r.mmul(x.diag(s).mmul(n.transpose()))},e.solve=D,e.wrap=function(t,e){if(n.isAnyArray(t))return t[0]&&n.isAnyArray(t[0])?new I(t):new C(t,e);throw new Error("the argument is not an array")}},2664:t=>{t.exports=function(t,e){t=t||0;for(var i=new Array(t),n=0;n<t;n++)i[n]=e;return i}},995:t=>{t.exports=function(t){return 0===t?1:(t--,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,1+(t|=t>>16))}},2582:function(t){t.exports=function(){"use strict";function t(t,n,r,s,o){!function t(i,n,r,s,o){for(;s>r;){if(s-r>600){var a=s-r+1,h=n-r+1,l=Math.log(a),c=.5*Math.exp(2*l/3),u=.5*Math.sqrt(l*c*(a-c)/a)*(h-a/2<0?-1:1);t(i,n,Math.max(r,Math.floor(n-h*c/a+u)),Math.min(s,Math.floor(n+(a-h)*c/a+u)),o)}var d=i[n],f=r,g=s;for(e(i,r,n),o(i[s],d)>0&&e(i,r,s);f<g;){for(e(i,f,g),f++,g--;o(i[f],d)<0;)f++;for(;o(i[g],d)>0;)g--}0===o(i[r],d)?e(i,r,g):e(i,++g,s),g<=n&&(r=g+1),n<=g&&(s=g-1)}}(t,n,r||0,s||t.length-1,o||i)}function e(t,e,i){var n=t[e];t[e]=t[i],t[i]=n}function i(t,e){return t<e?-1:t>e?1:0}var n=function(t){void 0===t&&(t=9),this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function r(t,e,i){if(!i)return e.indexOf(t);for(var n=0;n<e.length;n++)if(i(t,e[n]))return n;return-1}function s(t,e){o(t,0,t.children.length,e,t)}function o(t,e,i,n,r){r||(r=g(null)),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(var s=e;s<i;s++){var o=t.children[s];a(r,t.leaf?n(o):o)}return r}function a(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function h(t,e){return t.minX-e.minX}function l(t,e){return t.minY-e.minY}function c(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function u(t){return t.maxX-t.minX+(t.maxY-t.minY)}function d(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function f(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function g(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function m(e,i,n,r,s){for(var o=[i,n];o.length;)if(!((n=o.pop())-(i=o.pop())<=r)){var a=i+Math.ceil((n-i)/r/2)*r;t(e,a,i,n,s),o.push(i,a,a,n)}}return n.prototype.all=function(){return this._all(this.data,[])},n.prototype.search=function(t){var e=this.data,i=[];if(!f(t,e))return i;for(var n=this.toBBox,r=[];e;){for(var s=0;s<e.children.length;s++){var o=e.children[s],a=e.leaf?n(o):o;f(t,a)&&(e.leaf?i.push(o):d(t,a)?this._all(o,i):r.push(o))}e=r.pop()}return i},n.prototype.collides=function(t){var e=this.data;if(!f(t,e))return!1;for(var i=[];e;){for(var n=0;n<e.children.length;n++){var r=e.children[n],s=e.leaf?this.toBBox(r):r;if(f(t,s)){if(e.leaf||d(t,s))return!0;i.push(r)}}e=i.pop()}return!1},n.prototype.load=function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0;e<t.length;e++)this.insert(t[e]);return this}var i=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===i.height)this._splitRoot(this.data,i);else{if(this.data.height<i.height){var n=this.data;this.data=i,i=n}this._insert(i,this.data.height-i.height-1,!0)}else this.data=i;return this},n.prototype.insert=function(t){return t&&this._insert(t,this.data.height-1),this},n.prototype.clear=function(){return this.data=g([]),this},n.prototype.remove=function(t,e){if(!t)return this;for(var i,n,s,o=this.data,a=this.toBBox(t),h=[],l=[];o||h.length;){if(o||(o=h.pop(),n=h[h.length-1],i=l.pop(),s=!0),o.leaf){var c=r(t,o.children,e);if(-1!==c)return o.children.splice(c,1),h.push(o),this._condense(h),this}s||o.leaf||!d(o,a)?n?(i++,o=n.children[i],s=!1):o=null:(h.push(o),l.push(i),i=0,n=o,o=o.children[0])}return this},n.prototype.toBBox=function(t){return t},n.prototype.compareMinX=function(t,e){return t.minX-e.minX},n.prototype.compareMinY=function(t,e){return t.minY-e.minY},n.prototype.toJSON=function(){return this.data},n.prototype.fromJSON=function(t){return this.data=t,this},n.prototype._all=function(t,e){for(var i=[];t;)t.leaf?e.push.apply(e,t.children):i.push.apply(i,t.children),t=i.pop();return e},n.prototype._build=function(t,e,i,n){var r,o=i-e+1,a=this._maxEntries;if(o<=a)return s(r=g(t.slice(e,i+1)),this.toBBox),r;n||(n=Math.ceil(Math.log(o)/Math.log(a)),a=Math.ceil(o/Math.pow(a,n-1))),(r=g([])).leaf=!1,r.height=n;var h=Math.ceil(o/a),l=h*Math.ceil(Math.sqrt(a));m(t,e,i,l,this.compareMinX);for(var c=e;c<=i;c+=l){var u=Math.min(c+l-1,i);m(t,c,u,h,this.compareMinY);for(var d=c;d<=u;d+=h){var f=Math.min(d+h-1,u);r.children.push(this._build(t,d,f,n-1))}}return s(r,this.toBBox),r},n.prototype._chooseSubtree=function(t,e,i,n){for(;n.push(e),!e.leaf&&n.length-1!==i;){for(var r=1/0,s=1/0,o=void 0,a=0;a<e.children.length;a++){var h=e.children[a],l=c(h),u=(d=t,f=h,(Math.max(f.maxX,d.maxX)-Math.min(f.minX,d.minX))*(Math.max(f.maxY,d.maxY)-Math.min(f.minY,d.minY))-l);u<s?(s=u,r=l<r?l:r,o=h):u===s&&l<r&&(r=l,o=h)}e=o||e.children[0]}var d,f;return e},n.prototype._insert=function(t,e,i){var n=i?t:this.toBBox(t),r=[],s=this._chooseSubtree(n,this.data,e,r);for(s.children.push(t),a(s,n);e>=0&&r[e].children.length>this._maxEntries;)this._split(r,e),e--;this._adjustParentBBoxes(n,r,e)},n.prototype._split=function(t,e){var i=t[e],n=i.children.length,r=this._minEntries;this._chooseSplitAxis(i,r,n);var o=this._chooseSplitIndex(i,r,n),a=g(i.children.splice(o,i.children.length-o));a.height=i.height,a.leaf=i.leaf,s(i,this.toBBox),s(a,this.toBBox),e?t[e-1].children.push(a):this._splitRoot(i,a)},n.prototype._splitRoot=function(t,e){this.data=g([t,e]),this.data.height=t.height+1,this.data.leaf=!1,s(this.data,this.toBBox)},n.prototype._chooseSplitIndex=function(t,e,i){for(var n,r,s,a,h,l,u,d=1/0,f=1/0,g=e;g<=i-e;g++){var m=o(t,0,g,this.toBBox),p=o(t,g,i,this.toBBox),_=(r=m,s=p,void 0,void 0,void 0,void 0,a=Math.max(r.minX,s.minX),h=Math.max(r.minY,s.minY),l=Math.min(r.maxX,s.maxX),u=Math.min(r.maxY,s.maxY),Math.max(0,l-a)*Math.max(0,u-h)),w=c(m)+c(p);_<d?(d=_,n=g,f=w<f?w:f):_===d&&w<f&&(f=w,n=g)}return n||i-e},n.prototype._chooseSplitAxis=function(t,e,i){var n=t.leaf?this.compareMinX:h,r=t.leaf?this.compareMinY:l;this._allDistMargin(t,e,i,n)<this._allDistMargin(t,e,i,r)&&t.children.sort(n)},n.prototype._allDistMargin=function(t,e,i,n){t.children.sort(n);for(var r=this.toBBox,s=o(t,0,e,r),h=o(t,i-e,i,r),l=u(s)+u(h),c=e;c<i-e;c++){var d=t.children[c];a(s,t.leaf?r(d):d),l+=u(s)}for(var f=i-e-1;f>=e;f--){var g=t.children[f];a(h,t.leaf?r(g):g),l+=u(h)}return l},n.prototype._adjustParentBBoxes=function(t,e,i){for(var n=i;n>=0;n--)a(e[n],t)},n.prototype._condense=function(t){for(var e=t.length-1,i=void 0;e>=0;e--)0===t[e].children.length?e>0?(i=t[e-1].children).splice(i.indexOf(t[e]),1):this.clear():s(t[e],this.toBBox)},n}()},146:(t,e,i)=>{"use strict";var n=i(8005),r=i(6740),s=i(5442),o=i(7972);function a(t,e,i,n){return function(i,r,s){var o=t(t(e(r[1],s[0]),e(-s[1],r[0])),t(e(i[1],r[0]),e(-r[1],i[0]))),a=t(e(i[1],s[0]),e(-s[1],i[0])),h=n(o,a);return h[h.length-1]}}function h(t,e,i,n){return function(r,s,o,a){var h=t(t(i(t(e(o[1],a[0]),e(-a[1],o[0])),s[2]),t(i(t(e(s[1],a[0]),e(-a[1],s[0])),-o[2]),i(t(e(s[1],o[0]),e(-o[1],s[0])),a[2]))),t(i(t(e(s[1],a[0]),e(-a[1],s[0])),r[2]),t(i(t(e(r[1],a[0]),e(-a[1],r[0])),-s[2]),i(t(e(r[1],s[0]),e(-s[1],r[0])),a[2])))),l=t(t(i(t(e(o[1],a[0]),e(-a[1],o[0])),r[2]),t(i(t(e(r[1],a[0]),e(-a[1],r[0])),-o[2]),i(t(e(r[1],o[0]),e(-o[1],r[0])),a[2]))),t(i(t(e(s[1],o[0]),e(-o[1],s[0])),r[2]),t(i(t(e(r[1],o[0]),e(-o[1],r[0])),-s[2]),i(t(e(r[1],s[0]),e(-s[1],r[0])),o[2])))),c=n(h,l);return c[c.length-1]}}function l(t,e,i,n){return function(r,s,o,a,h){var l=t(t(t(i(t(i(t(e(a[1],h[0]),e(-h[1],a[0])),o[2]),t(i(t(e(o[1],h[0]),e(-h[1],o[0])),-a[2]),i(t(e(o[1],a[0]),e(-a[1],o[0])),h[2]))),s[3]),t(i(t(i(t(e(a[1],h[0]),e(-h[1],a[0])),s[2]),t(i(t(e(s[1],h[0]),e(-h[1],s[0])),-a[2]),i(t(e(s[1],a[0]),e(-a[1],s[0])),h[2]))),-o[3]),i(t(i(t(e(o[1],h[0]),e(-h[1],o[0])),s[2]),t(i(t(e(s[1],h[0]),e(-h[1],s[0])),-o[2]),i(t(e(s[1],o[0]),e(-o[1],s[0])),h[2]))),a[3]))),t(i(t(i(t(e(o[1],a[0]),e(-a[1],o[0])),s[2]),t(i(t(e(s[1],a[0]),e(-a[1],s[0])),-o[2]),i(t(e(s[1],o[0]),e(-o[1],s[0])),a[2]))),-h[3]),t(i(t(i(t(e(a[1],h[0]),e(-h[1],a[0])),s[2]),t(i(t(e(s[1],h[0]),e(-h[1],s[0])),-a[2]),i(t(e(s[1],a[0]),e(-a[1],s[0])),h[2]))),r[3]),i(t(i(t(e(a[1],h[0]),e(-h[1],a[0])),r[2]),t(i(t(e(r[1],h[0]),e(-h[1],r[0])),-a[2]),i(t(e(r[1],a[0]),e(-a[1],r[0])),h[2]))),-s[3])))),t(t(i(t(i(t(e(s[1],h[0]),e(-h[1],s[0])),r[2]),t(i(t(e(r[1],h[0]),e(-h[1],r[0])),-s[2]),i(t(e(r[1],s[0]),e(-s[1],r[0])),h[2]))),a[3]),t(i(t(i(t(e(s[1],a[0]),e(-a[1],s[0])),r[2]),t(i(t(e(r[1],a[0]),e(-a[1],r[0])),-s[2]),i(t(e(r[1],s[0]),e(-s[1],r[0])),a[2]))),-h[3]),i(t(i(t(e(o[1],a[0]),e(-a[1],o[0])),s[2]),t(i(t(e(s[1],a[0]),e(-a[1],s[0])),-o[2]),i(t(e(s[1],o[0]),e(-o[1],s[0])),a[2]))),r[3]))),t(i(t(i(t(e(o[1],a[0]),e(-a[1],o[0])),r[2]),t(i(t(e(r[1],a[0]),e(-a[1],r[0])),-o[2]),i(t(e(r[1],o[0]),e(-o[1],r[0])),a[2]))),-s[3]),t(i(t(i(t(e(s[1],a[0]),e(-a[1],s[0])),r[2]),t(i(t(e(r[1],a[0]),e(-a[1],r[0])),-s[2]),i(t(e(r[1],s[0]),e(-s[1],r[0])),a[2]))),o[3]),i(t(i(t(e(s[1],o[0]),e(-o[1],s[0])),r[2]),t(i(t(e(r[1],o[0]),e(-o[1],r[0])),-s[2]),i(t(e(r[1],s[0]),e(-s[1],r[0])),o[2]))),-a[3]))))),c=t(t(t(i(t(i(t(e(a[1],h[0]),e(-h[1],a[0])),o[2]),t(i(t(e(o[1],h[0]),e(-h[1],o[0])),-a[2]),i(t(e(o[1],a[0]),e(-a[1],o[0])),h[2]))),r[3]),i(t(i(t(e(a[1],h[0]),e(-h[1],a[0])),r[2]),t(i(t(e(r[1],h[0]),e(-h[1],r[0])),-a[2]),i(t(e(r[1],a[0]),e(-a[1],r[0])),h[2]))),-o[3])),t(i(t(i(t(e(o[1],h[0]),e(-h[1],o[0])),r[2]),t(i(t(e(r[1],h[0]),e(-h[1],r[0])),-o[2]),i(t(e(r[1],o[0]),e(-o[1],r[0])),h[2]))),a[3]),i(t(i(t(e(o[1],a[0]),e(-a[1],o[0])),r[2]),t(i(t(e(r[1],a[0]),e(-a[1],r[0])),-o[2]),i(t(e(r[1],o[0]),e(-o[1],r[0])),a[2]))),-h[3]))),t(t(i(t(i(t(e(o[1],h[0]),e(-h[1],o[0])),s[2]),t(i(t(e(s[1],h[0]),e(-h[1],s[0])),-o[2]),i(t(e(s[1],o[0]),e(-o[1],s[0])),h[2]))),r[3]),i(t(i(t(e(o[1],h[0]),e(-h[1],o[0])),r[2]),t(i(t(e(r[1],h[0]),e(-h[1],r[0])),-o[2]),i(t(e(r[1],o[0]),e(-o[1],r[0])),h[2]))),-s[3])),t(i(t(i(t(e(s[1],h[0]),e(-h[1],s[0])),r[2]),t(i(t(e(r[1],h[0]),e(-h[1],r[0])),-s[2]),i(t(e(r[1],s[0]),e(-s[1],r[0])),h[2]))),o[3]),i(t(i(t(e(s[1],o[0]),e(-o[1],s[0])),r[2]),t(i(t(e(r[1],o[0]),e(-o[1],r[0])),-s[2]),i(t(e(r[1],s[0]),e(-s[1],r[0])),o[2]))),-h[3])))),u=n(l,c);return u[u.length-1]}}function c(t){return(3===t?a:4===t?h:l)(r,n,s,o)}var u=c(3),d=c(4),f=[function(){return 0},function(){return 0},function(t,e){return e[0]-t[0]},function(t,e,i){var n,r=(t[1]-i[1])*(e[0]-i[0]),s=(t[0]-i[0])*(e[1]-i[1]),o=r-s;if(r>0){if(s<=0)return o;n=r+s}else{if(!(r<0))return o;if(s>=0)return o;n=-(r+s)}var a=33306690738754716e-32*n;return o>=a||o<=-a?o:u(t,e,i)},function(t,e,i,n){var r=t[0]-n[0],s=e[0]-n[0],o=i[0]-n[0],a=t[1]-n[1],h=e[1]-n[1],l=i[1]-n[1],c=t[2]-n[2],u=e[2]-n[2],f=i[2]-n[2],g=s*l,m=o*h,p=o*a,_=r*l,w=r*h,y=s*a,v=c*(g-m)+u*(p-_)+f*(w-y),b=7771561172376103e-31*((Math.abs(g)+Math.abs(m))*Math.abs(c)+(Math.abs(p)+Math.abs(_))*Math.abs(u)+(Math.abs(w)+Math.abs(y))*Math.abs(f));return v>b||-v>b?v:d(t,e,i,n)}];function g(t){var e=f[t.length];return e||(e=f[t.length]=c(t.length)),e.apply(void 0,t)}function m(t,e,i,n,r,s,o){return function(e,i,a,h,l){switch(arguments.length){case 0:case 1:return 0;case 2:return n(e,i);case 3:return r(e,i,a);case 4:return s(e,i,a,h);case 5:return o(e,i,a,h,l)}for(var c=new Array(arguments.length),u=0;u<arguments.length;++u)c[u]=arguments[u];return t(c)}}!function(){for(;f.length<=5;)f.push(c(f.length));t.exports=m.apply(void 0,[g].concat(f));for(var e=0;e<=5;++e)t.exports[e]=f[e]}()},4707:(t,e,i)=>{t.exports=function(t,e){for(var i=e[0],r=e[1],s=t.length,o=1,a=s,h=0,l=s-1;h<a;l=h++){var c=t[h],u=t[l],d=c[1],f=u[1];if(f<d){if(f<r&&r<d){if(0===(g=n(c,u,e)))return 0;o^=0<g|0}else if(r===d&&d<t[(h+1)%s][1]){if(0===(g=n(c,u,e)))return 0;o^=0<g|0}}else if(d<f){if(d<r&&r<f){if(0===(g=n(c,u,e)))return 0;o^=g<0|0}else if(r===d&&t[(h+1)%s][1]<d){var g;if(0===(g=n(c,u,e)))return 0;o^=g<0|0}}else if(r===d){var m=Math.min(c[0],u[0]),p=Math.max(c[0],u[0]);if(0===h){for(;l>0;){var _=(l+s-1)%s;if((v=t[_])[1]!==r)break;var w=v[0];m=Math.min(m,w),p=Math.max(p,w),l=_}if(0===l)return m<=i&&i<=p?0:1;a=l+1}for(var y=t[(l+s-1)%s][1];h+1<a;){var v;if((v=t[h+1])[1]!==r)break;w=v[0],m=Math.min(m,w),p=Math.max(p,w),h+=1}if(m<=i&&i<=p)return 0;var b=t[(h+1)%s][1];i<m&&y<r!=b<r&&(o^=1)}}return 2*o-1};var n=i(146)},5442:(t,e,i)=>{"use strict";var n=i(8005),r=i(6359);t.exports=function(t,e){var i=t.length;if(1===i){var s=n(t[0],e);return s[0]?s:[s[1]]}var o=new Array(2*i),a=[.1,.1],h=[.1,.1],l=0;n(t[0],e,a),a[0]&&(o[l++]=a[0]);for(var c=1;c<i;++c){n(t[c],e,h);var u=a[1];r(u,h[0],a),a[0]&&(o[l++]=a[0]);var d=h[1],f=a[1],g=d+f,m=f-(g-d);a[1]=g,m&&(o[l++]=m)}return a[1]&&(o[l++]=a[1]),0===l&&(o[l++]=0),o.length=l,o}},7972:t=>{"use strict";t.exports=function(t,e){var i=0|t.length,n=0|e.length;if(1===i&&1===n)return function(t,e){var i=t+e,n=i-t,r=t-(i-n)+(e-n);return r?[r,i]:[i]}(t[0],-e[0]);var r,s,o=new Array(i+n),a=0,h=0,l=0,c=Math.abs,u=t[h],d=c(u),f=-e[l],g=c(f);d<g?(s=u,(h+=1)<i&&(d=c(u=t[h]))):(s=f,(l+=1)<n&&(g=c(f=-e[l]))),h<i&&d<g||l>=n?(r=u,(h+=1)<i&&(d=c(u=t[h]))):(r=f,(l+=1)<n&&(g=c(f=-e[l])));for(var m,p,_=r+s,w=_-r,y=s-w,v=y,b=_;h<i&&l<n;)d<g?(r=u,(h+=1)<i&&(d=c(u=t[h]))):(r=f,(l+=1)<n&&(g=c(f=-e[l]))),(y=(s=v)-(w=(_=r+s)-r))&&(o[a++]=y),v=b-((m=b+_)-(p=m-b))+(_-p),b=m;for(;h<i;)(y=(s=v)-(w=(_=(r=u)+s)-r))&&(o[a++]=y),v=b-((m=b+_)-(p=m-b))+(_-p),b=m,(h+=1)<i&&(u=t[h]);for(;l<n;)(y=(s=v)-(w=(_=(r=f)+s)-r))&&(o[a++]=y),v=b-((m=b+_)-(p=m-b))+(_-p),b=m,(l+=1)<n&&(f=-e[l]);return v&&(o[a++]=v),b&&(o[a++]=b),a||(o[a++]=0),o.length=a,o}},6740:t=>{"use strict";t.exports=function(t,e){var i=0|t.length,n=0|e.length;if(1===i&&1===n)return function(t,e){var i=t+e,n=i-t,r=t-(i-n)+(e-n);return r?[r,i]:[i]}(t[0],e[0]);var r,s,o=new Array(i+n),a=0,h=0,l=0,c=Math.abs,u=t[h],d=c(u),f=e[l],g=c(f);d<g?(s=u,(h+=1)<i&&(d=c(u=t[h]))):(s=f,(l+=1)<n&&(g=c(f=e[l]))),h<i&&d<g||l>=n?(r=u,(h+=1)<i&&(d=c(u=t[h]))):(r=f,(l+=1)<n&&(g=c(f=e[l])));for(var m,p,_=r+s,w=_-r,y=s-w,v=y,b=_;h<i&&l<n;)d<g?(r=u,(h+=1)<i&&(d=c(u=t[h]))):(r=f,(l+=1)<n&&(g=c(f=e[l]))),(y=(s=v)-(w=(_=r+s)-r))&&(o[a++]=y),v=b-((m=b+_)-(p=m-b))+(_-p),b=m;for(;h<i;)(y=(s=v)-(w=(_=(r=u)+s)-r))&&(o[a++]=y),v=b-((m=b+_)-(p=m-b))+(_-p),b=m,(h+=1)<i&&(u=t[h]);for(;l<n;)(y=(s=v)-(w=(_=(r=f)+s)-r))&&(o[a++]=y),v=b-((m=b+_)-(p=m-b))+(_-p),b=m,(l+=1)<n&&(f=e[l]);return v&&(o[a++]=v),b&&(o[a++]=b),a||(o[a++]=0),o.length=a,o}},3379:t=>{"use strict";var e=[];function i(t){for(var i=-1,n=0;n<e.length;n++)if(e[n].identifier===t){i=n;break}return i}function n(t,n){for(var s={},o=[],a=0;a<t.length;a++){var h=t[a],l=n.base?h[0]+n.base:h[0],c=s[l]||0,u="".concat(l," ").concat(c);s[l]=c+1;var d=i(u),f={css:h[1],media:h[2],sourceMap:h[3],supports:h[4],layer:h[5]};if(-1!==d)e[d].references++,e[d].updater(f);else{var g=r(f,n);n.byIndex=a,e.splice(a,0,{identifier:u,updater:g,references:1})}o.push(u)}return o}function r(t,e){var i=e.domAPI(e);return i.update(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap&&e.supports===t.supports&&e.layer===t.layer)return;i.update(t=e)}else i.remove()}}t.exports=function(t,r){var s=n(t=t||[],r=r||{});return function(t){t=t||[];for(var o=0;o<s.length;o++){var a=i(s[o]);e[a].references--}for(var h=n(t,r),l=0;l<s.length;l++){var c=i(s[l]);0===e[c].references&&(e[c].updater(),e.splice(c,1))}s=h}}},569:t=>{"use strict";var e={};t.exports=function(t,i){var n=function(t){if(void 0===e[t]){var i=document.querySelector(t);if(window.HTMLIFrameElement&&i instanceof window.HTMLIFrameElement)try{i=i.contentDocument.head}catch(t){i=null}e[t]=i}return e[t]}(t);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");n.appendChild(i)}},9216:t=>{"use strict";t.exports=function(t){var e=document.createElement("style");return t.setAttributes(e,t.attributes),t.insert(e,t.options),e}},3565:(t,e,i)=>{"use strict";t.exports=function(t){var e=i.nc;e&&t.setAttribute("nonce",e)}},7795:t=>{"use strict";t.exports=function(t){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var e=t.insertStyleElement(t);return{update:function(i){!function(t,e,i){var n="";i.supports&&(n+="@supports (".concat(i.supports,") {")),i.media&&(n+="@media ".concat(i.media," {"));var r=void 0!==i.layer;r&&(n+="@layer".concat(i.layer.length>0?" ".concat(i.layer):""," {")),n+=i.css,r&&(n+="}"),i.media&&(n+="}"),i.supports&&(n+="}");var s=i.sourceMap;s&&"undefined"!=typeof btoa&&(n+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(s))))," */")),e.styleTagTransform(n,t,e.options)}(e,t,i)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)}}}},4589:t=>{"use strict";t.exports=function(t,e){if(e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}},8005:t=>{"use strict";t.exports=function(t,i,n){var r=t*i,s=e*t,o=s-(s-t),a=t-o,h=e*i,l=h-(h-i),c=i-l,u=a*c-(r-o*l-a*l-o*c);return n?(n[0]=u,n[1]=r,n):[u,r]};var e=+(Math.pow(2,27)+1)},6359:t=>{"use strict";t.exports=function(t,e,i){var n=t+e,r=n-t,s=e-r,o=t-(n-r);return i?(i[0]=o+s,i[1]=n,i):[o+s,n]}},6732:(t,e,i)=>{"use strict";var n=i(7963),r=navigator.hardwareConcurrency||1;function s(t,e){if("string"!=typeof t&&"function"!=typeof t)throw new TypeError("func argument must be a function");if(void 0===e&&(e={}),"object"!=typeof e||null===e)throw new TypeError("options argument must be an object");this._workerCode=t.toString(),void 0===e.maxWorkers||"auto"===e.maxWorkers?this._numWorkers=Math.min(r-1,1):e.maxWorkers>0?this._numWorkers=Math.min(e.maxWorkers,r):this._numWorkers=r,this._workers=new Map,this._timeout=e.timeout||0,this._terminateOnError=!!e.terminateOnError;var i=e.deps;"string"==typeof i&&(i=[i]),Array.isArray(i)||(i=void 0),this._id=0,this._terminated=!1,this._working=0,this._waiting=[],this._init(i)}Function.prototype,s.prototype._init=function(t){for(var e=n.newWorkerURL(this._workerCode,t),i=0;i<this._numWorkers;i++){var r=new Worker(e);r.onmessage=this._onmessage.bind(this,r),r.onerror=this._onerror.bind(this,r),r.running=!1,r.id=i,this._workers.set(r,null)}URL.revokeObjectURL(e)},s.prototype._onerror=function(t,e){if(!this._terminated){this._working--,t.running=!1;var i=this._workers.get(t);i&&i[1](e.message),this._workers.set(t,null),this._terminateOnError?this.terminate():this._exec()}},s.prototype._onmessage=function(t,e){if(!this._terminated){this._working--,t.running=!1;var i=this._workers.get(t);i&&i[0](e.data.data),this._workers.set(t,null),this._exec()}},s.prototype._exec=function(){for(var t of this._workers.keys()){if(this._working===this._numWorkers||0===this._waiting.length)return;if(!t.running)for(var e=0;e<this._waiting.length;e++){var i=this._waiting[e];if("number"!=typeof i[4]||i[4]===t.id){this._waiting.splice(e,1),t.postMessage({action:"exec",event:i[0],args:i[1]},i[2]),t.running=!0,t.time=Date.now(),this._workers.set(t,i[3]),this._working++;break}}}},s.prototype.terminate=function(){if(!this._terminated){for(var t of this._workers)t[0].terminate(),t[1]&&t[1][1](new Error("Terminated"));this._workers.clear(),this._waiting=[],this._working=0,this._terminated=!0}},s.prototype.postAll=function(t,e){if(this._terminated)throw new Error("Cannot post (terminated)");var i=[];for(var n of this._workers.keys())i.push(this.post(t,e,[],n.id));return Promise.all(i)},s.prototype.post=function(t,e,i,n){void 0===e&&(e=[]),void 0===i&&(i=[]),Array.isArray(e)||(e=[e]),Array.isArray(i)||(i=[i]);var r=this;return new Promise((function(s,o){if(r._terminated)throw new Error("Cannot post (terminated)");r._waiting.push([t,e,i,[s,o],n]),r._exec()}))},t.exports=s},7963:(t,e)=>{"use strict";var i=function(){function t(){this._listeners={}}self.window=self,t.prototype.on=function(t,e){if(this._listeners[t])throw new RangeError("there is already a listener for "+t);if("function"!=typeof e)throw new TypeError("callback argument must be a function");this._listeners[t]=e},t.prototype._send=function(t,e,i){void 0===i?i=[]:Array.isArray(i)||(i=[i]),self.postMessage({id:t,data:e},i)},t.prototype._trigger=function(t,e){if(!this._listeners[t])throw new Error("event "+t+" is not defined");this._listeners[t].apply(null,e)};var e=new t;self.onmessage=function(t){switch(t.data.action){case"exec":t.data.args.unshift((function(i,n){e._send(t.data.id,i,n)})),e._trigger(t.data.event,t.data.args);break;case"ping":e._send(t.data.id,"pong");break;default:throw new Error("unexpected action: "+t.data.action)}}}.toString().split('"CODE";');e.newWorkerURL=function(t,e){var n=new Blob(["(",i[0],"importScripts.apply(self, "+JSON.stringify(e)+");\n","(",t,")();",i[1],")();"],{type:"application/javascript"});return URL.createObjectURL(n)}},9152:(t,e,i)=>{"use strict";i.d(e,{b:()=>n}),t=i.hmd(t);const n=function(){let t,e,i,n=[],r=[],s=[],o=c,a=function(t,e){return Math.abs(e.timestamp-t.timestamp)};function h(t,e){let i,n,r=-1,s=t.length;if(1===arguments.length){for(;++r<s&&!(null!=(i=t[r])&&i<=i);)i=void 0;for(;++r<s;)null!=(n=t[r])&&i>n&&(i=n)}else{for(;++r<s&&!(null!=(i=e.call(t,t[r],r))&&i<=i);)i=void 0;for(;++r<s;)null!=(n=e.call(t,t[r],r))&&i>n&&(i=n)}return i}function l(t,e){let i,n,r=-1,s=t.length;if(1===arguments.length){for(;++r<s&&!(null!=(i=t[r])&&i<=i);)i=void 0;for(;++r<s;)null!=(n=t[r])&&n>i&&(i=n)}else{for(;++r<s&&!(null!=(i=e.call(t,t[r],r))&&i<=i);)i=void 0;for(;++r<s;)null!=(n=e.call(t,t[r],r))&&n>i&&(i=n)}return i}function c(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function u(t,e){return Math.abs(e.x-t.x)+Math.abs(e.y-t.y)}function d(t,e){const i=t.location.latitude*Math.PI/180,n=t.location.longitude*Math.PI/180,r=e.location.latitude*Math.PI/180,s=r-i,o=e.location.longitude*Math.PI/180-n,a=Math.sin(s/2)*Math.sin(s/2)+Math.cos(i)*Math.cos(r)*Math.sin(o/2)*Math.sin(o/2);return(2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a))*6371).toPrecision(4)}function f(i){const r=[];let s=n[i];for(let h=0;h<n.length;h++)i!==h&&(e&&a(n[h],s)<=e&&o(n[h],s)<=t||o(n[h],s)<=t)&&r.push(h);return r}function g(t,e,n){r[n-1].push(t),s[t]=n;for(let t=0;t<e.length;t++){const o=e[t];if(void 0===s[o]){s[o]=0;let t=f(o);t.length>=i&&g(o,t,n)}s[o]<1&&(s[o]=n,r[n-1].push(o))}}let m=function(){s=[],r=[];for(let t=0;t<n.length;t++)if(void 0===s[t]){s[t]=0;const e=f(t);e.length<i?s[t]=0:(r.push([]),g(t,e,r.length))}return s};return m.getClusters=function(){const t=r.length,i=[];for(let s=0;s<t;s++){if(o===c||o===u){i[s]={x:0,y:0};for(let t=0;t<r[s].length;t++)i[s].x+=n[r[s][t]].x,i[s].y+=n[r[s][t]].y;i[s].x/=r[s].length,i[s].y/=r[s].length,i[s].dimension=r[s].length,i[s].parts=r[s]}if(o===d){i[s]={location:{latitude:0,longitude:0,accuracy:0}};for(let t=0;t<r[s].length;t++)i[s].location.latitude+=n[r[s][t]].location.latitude,i[s].location.longitude+=n[r[s][t]].location.longitude,i[s].location.accuracy+=n[r[s][t]].location.accuracy;i[s].dimension=r[s].length,i[s].parts=r[s],i[s].location.latitude/=r[s].length,i[s].location.longitude/=r[s].length,i[s].location.accuracy/=r[s].length}e&&(i[s].duration={},i[s].duration.start=h(r[s],(function(t){return n[t].timestamp})),i[s].duration.end=l(r[s],(function(t){return n[t].timestamp})),i[s].duration.span=i[s].duration.end-i[s].duration.start)}return i},m.data=function(t){return 0===arguments.length?n:(Array.isArray(t)&&(n=t),m)},m.eps=function(e){return 0===arguments.length?t:("number"==typeof e&&(t=e),m)},m.timeEps=function(t){return 0===arguments.length?e:("number"==typeof t&&(e=t),m)},m.minPts=function(t){return 0===arguments.length?i:("number"==typeof t&&(i=t),m)},m.distance=function(t){if(1===arguments.length)if("string"==typeof t)switch(t){case"HAVERSINE":o=d;break;case"EUCLIDEAN":default:o=c;break;case"MANHATTAN":o=u}else"function"==typeof t&&(o=t);return m},m.timeDistance=function(t){return 1===arguments.length&&(a=t),m},m};var r,s;r="undefined"!=typeof self?self:void 0,s=function(){return n},"function"==typeof define&&i.amdO?define([],s):t.exports?t.exports=s():r.jDBSCAN=s()},2898:t=>{"use strict";t.exports={version:"1.0.1"}}},__webpack_module_cache__={};function __webpack_require__(t){var e=__webpack_module_cache__[t];if(void 0!==e)return e.exports;var i=__webpack_module_cache__[t]={id:t,loaded:!1,exports:{}};return __webpack_modules__[t].call(i.exports,i,i.exports,__webpack_require__),i.loaded=!0,i.exports}__webpack_require__.amdO={},__webpack_require__.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return __webpack_require__.d(e,{a:e}),e},__webpack_require__.d=(t,e)=>{for(var i in e)__webpack_require__.o(e,i)&&!__webpack_require__.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},__webpack_require__.hmd=t=>((t=Object.create(t)).children||(t.children=[]),Object.defineProperty(t,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+t.id)}}),t),__webpack_require__.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),__webpack_require__.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},__webpack_require__.nc=void 0;var __webpack_exports__={};(()=>{"use strict";var t={};__webpack_require__.r(t),__webpack_require__.d(t,{CMYK:()=>If,GREY:()=>Ef,HSL:()=>kf,HSV:()=>Cf,RGB:()=>Sf});var e={};__webpack_require__.r(e),__webpack_require__.d(e,{tagsById:()=>Of,tagsByName:()=>Nf});var i={};__webpack_require__.r(i),__webpack_require__.d(i,{tagsById:()=>Bf,tagsByName:()=>zf});var n={};__webpack_require__.r(n),__webpack_require__.d(n,{tagsById:()=>Uf,tagsByName:()=>Gf});const r=class{constructor(t){this.propagationStopped,this.defaultPrevented,this.type=t,this.target=null}preventDefault(){this.defaultPrevented=!0}stopPropagation(){this.propagationStopped=!0}},s="propertychange",o=class{constructor(){this.disposed=!1}dispose(){this.disposed||(this.disposed=!0,this.disposeInternal())}disposeInternal(){}};function a(t,e){return t>e?1:t<e?-1:0}function h(t,e,i){if(t[0]<=e)return 0;const n=t.length;if(e<=t[n-1])return n-1;if("function"==typeof i){for(let r=1;r<n;++r){const n=t[r];if(n===e)return r;if(n<e)return i(e,t[r-1],n)>0?r-1:r}return n-1}if(i>0){for(let i=1;i<n;++i)if(t[i]<e)return i-1;return n-1}if(i<0){for(let i=1;i<n;++i)if(t[i]<=e)return i;return n-1}for(let i=1;i<n;++i){if(t[i]==e)return i;if(t[i]<e)return t[i-1]-e<e-t[i]?i-1:i}return n-1}function l(t,e,i){for(;e<i;){const n=t[e];t[e]=t[i],t[i]=n,++e,--i}}function c(t,e){const i=Array.isArray(e)?e:[e],n=i.length;for(let e=0;e<n;e++)t[t.length]=i[e]}function u(t,e){const i=t.length;if(i!==e.length)return!1;for(let n=0;n<i;n++)if(t[n]!==e[n])return!1;return!0}function d(){return!0}function f(){return!1}function g(){}function m(t){let e,i,n,r=!1;return function(){const s=Array.prototype.slice.call(arguments);return r&&this===n&&u(s,i)||(r=!0,n=this,i=s,e=t.apply(this,arguments)),e}}function p(t){for(const e in t)delete t[e]}function _(t){let e;for(e in t)return!1;return!e}const w=class extends o{constructor(t){super(),this.eventTarget_=t,this.pendingRemovals_=null,this.dispatching_=null,this.listeners_=null}addEventListener(t,e){if(!t||!e)return;const i=this.listeners_||(this.listeners_={}),n=i[t]||(i[t]=[]);n.includes(e)||n.push(e)}dispatchEvent(t){const e="string"==typeof t,i=e?t:t.type,n=this.listeners_&&this.listeners_[i];if(!n)return;const s=e?new r(t):t;s.target||(s.target=this.eventTarget_||this);const o=this.dispatching_||(this.dispatching_={}),a=this.pendingRemovals_||(this.pendingRemovals_={});let h;i in o||(o[i]=0,a[i]=0),++o[i];for(let t=0,e=n.length;t<e;++t)if(h="handleEvent"in n[t]?n[t].handleEvent(s):n[t].call(this,s),!1===h||s.propagationStopped){h=!1;break}if(0==--o[i]){let t=a[i];for(delete a[i];t--;)this.removeEventListener(i,g);delete o[i]}return h}disposeInternal(){this.listeners_&&p(this.listeners_)}getListeners(t){return this.listeners_&&this.listeners_[t]||void 0}hasListener(t){return!!this.listeners_&&(t?t in this.listeners_:Object.keys(this.listeners_).length>0)}removeEventListener(t,e){if(!this.listeners_)return;const i=this.listeners_[t];if(!i)return;const n=i.indexOf(e);-1!==n&&(this.pendingRemovals_&&t in this.pendingRemovals_?(i[n]=g,++this.pendingRemovals_[t]):(i.splice(n,1),0===i.length&&delete this.listeners_[t]))}},y="change",v="contextmenu",b="click",x="keydown",M="keypress",E="touchmove",S="wheel";function k(t,e,i,n,r){if(n&&n!==t&&(i=i.bind(n)),r){const n=i;i=function(){t.removeEventListener(e,i),n.apply(this,arguments)}}const s={target:t,type:e,listener:i};return t.addEventListener(e,i),s}function C(t,e,i,n){return k(t,e,i,n,!0)}function I(t){t&&t.target&&(t.target.removeEventListener(t.type,t.listener),p(t))}class A extends w{constructor(){super(),this.on=this.onInternal,this.once=this.onceInternal,this.un=this.unInternal,this.revision_=0}changed(){++this.revision_,this.dispatchEvent(y)}getRevision(){return this.revision_}onInternal(t,e){if(Array.isArray(t)){const i=t.length,n=new Array(i);for(let r=0;r<i;++r)n[r]=k(this,t[r],e);return n}return k(this,t,e)}onceInternal(t,e){let i;if(Array.isArray(t)){const n=t.length;i=new Array(n);for(let r=0;r<n;++r)i[r]=C(this,t[r],e)}else i=C(this,t,e);return e.ol_key=i,i}unInternal(t,e){const i=e.ol_key;if(i)!function(t){if(Array.isArray(t))for(let e=0,i=t.length;e<i;++e)I(t[e]);else I(t)}(i);else if(Array.isArray(t))for(let i=0,n=t.length;i<n;++i)this.removeEventListener(t[i],e);else this.removeEventListener(t,e)}}A.prototype.on,A.prototype.once,A.prototype.un;const T=A;function R(){throw new Error("Unimplemented abstract method.")}let P=0;function D(t){return t.ol_uid||(t.ol_uid=String(++P))}class F extends r{constructor(t,e,i){super(t),this.key=e,this.oldValue=i}}const L=class extends T{constructor(t){super(),this.on,this.once,this.un,D(this),this.values_=null,void 0!==t&&this.setProperties(t)}get(t){let e;return this.values_&&this.values_.hasOwnProperty(t)&&(e=this.values_[t]),e}getKeys(){return this.values_&&Object.keys(this.values_)||[]}getProperties(){return this.values_&&Object.assign({},this.values_)||{}}getPropertiesInternal(){return this.values_}hasProperties(){return!!this.values_}notify(t,e){let i;i=`change:${t}`,this.hasListener(i)&&this.dispatchEvent(new F(i,t,e)),i=s,this.hasListener(i)&&this.dispatchEvent(new F(i,t,e))}addChangeListener(t,e){this.addEventListener(`change:${t}`,e)}removeChangeListener(t,e){this.removeEventListener(`change:${t}`,e)}set(t,e,i){const n=this.values_||(this.values_={});if(i)n[t]=e;else{const i=n[t];n[t]=e,i!==e&&this.notify(t,i)}}setProperties(t,e){for(const i in t)this.set(i,t[i],e)}applyProperties(t){t.values_&&Object.assign(this.values_||(this.values_={}),t.values_)}unset(t,e){if(this.values_&&t in this.values_){const i=this.values_[t];delete this.values_[t],_(this.values_)&&(this.values_=null),e||this.notify(t,i)}}},O="add",N="remove",B="length";class z extends r{constructor(t,e,i){super(t),this.element=e,this.index=i}}const U=class extends L{constructor(t,e){if(super(),this.on,this.once,this.un,e=e||{},this.unique_=!!e.unique,this.array_=t||[],this.unique_)for(let t=0,e=this.array_.length;t<e;++t)this.assertUnique_(this.array_[t],t);this.updateLength_()}clear(){for(;this.getLength()>0;)this.pop()}extend(t){for(let e=0,i=t.length;e<i;++e)this.push(t[e]);return this}forEach(t){const e=this.array_;for(let i=0,n=e.length;i<n;++i)t(e[i],i,e)}getArray(){return this.array_}item(t){return this.array_[t]}getLength(){return this.get(B)}insertAt(t,e){if(t<0||t>this.getLength())throw new Error("Index out of bounds: "+t);this.unique_&&this.assertUnique_(e),this.array_.splice(t,0,e),this.updateLength_(),this.dispatchEvent(new z(O,e,t))}pop(){return this.removeAt(this.getLength()-1)}push(t){this.unique_&&this.assertUnique_(t);const e=this.getLength();return this.insertAt(e,t),this.getLength()}remove(t){const e=this.array_;for(let i=0,n=e.length;i<n;++i)if(e[i]===t)return this.removeAt(i)}removeAt(t){if(t<0||t>=this.getLength())return;const e=this.array_[t];return this.array_.splice(t,1),this.updateLength_(),this.dispatchEvent(new z(N,e,t)),e}setAt(t,e){if(t>=this.getLength())return void this.insertAt(t,e);if(t<0)throw new Error("Index out of bounds: "+t);this.unique_&&this.assertUnique_(e,t);const i=this.array_[t];this.array_[t]=e,this.dispatchEvent(new z(N,i,t)),this.dispatchEvent(new z(O,e,t))}updateLength_(){this.set(B,this.array_.length)}assertUnique_(t,e){for(let i=0,n=this.array_.length;i<n;++i)if(this.array_[i]===t&&i!==e)throw new Error("Duplicate item added to a unique collection")}},G="undefined"!=typeof navigator&&void 0!==navigator.userAgent?navigator.userAgent.toLowerCase():"",Y=G.includes("firefox"),X=(G.includes("safari")&&!G.includes("chrom")&&(G.includes("version/15.4")||/cpu (os|iphone os) 15_4 like mac os x/.test(G)),G.includes("webkit")&&!G.includes("edge")),V=G.includes("macintosh"),j="undefined"!=typeof devicePixelRatio?devicePixelRatio:1,q="undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof OffscreenCanvas&&self instanceof WorkerGlobalScope,W="undefined"!=typeof Image&&Image.prototype.decode,Z=function(){let t=!1;try{const e=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("_",null,e),window.removeEventListener("_",null,e)}catch(t){}return t}();function K(t,e){if(!t)throw new Error(e)}function H(t,e){const i=e[0],n=e[1];return e[0]=t[0]*i+t[2]*n+t[4],e[1]=t[1]*i+t[3]*n+t[5],e}function $(t,e,i,n,r,s,o,a){const h=Math.sin(s),l=Math.cos(s);return t[0]=n*l,t[1]=r*h,t[2]=-n*h,t[3]=r*l,t[4]=o*n*l-a*n*h+e,t[5]=o*r*h+a*r*l+i,t}function J(t,e){const i=(n=e)[0]*n[3]-n[1]*n[2];var n;K(0!==i,"Transformation matrix cannot be inverted");const r=e[0],s=e[1],o=e[2],a=e[3],h=e[4],l=e[5];return t[0]=a/i,t[1]=-s/i,t[2]=-o/i,t[3]=r/i,t[4]=(o*l-a*h)/i,t[5]=-(r*l-s*h)/i,t}let Q;function tt(t){const e="matrix("+t.join(", ")+")";if(q)return e;const i=Q||(Q=document.createElement("div"));return i.style.transform=e,i.style.transform}new Array(6);const et={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};function it(t){const e=[1/0,1/0,-1/0,-1/0];for(let i=0,n=t.length;i<n;++i)pt(e,t[i]);return e}function nt(t,e,i){return i?(i[0]=t[0]-e,i[1]=t[1]-e,i[2]=t[2]+e,i[3]=t[3]+e,i):[t[0]-e,t[1]-e,t[2]+e,t[3]+e]}function rt(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t.slice()}function st(t,e,i){let n,r;return n=e<t[0]?t[0]-e:t[2]<e?e-t[2]:0,r=i<t[1]?t[1]-i:t[3]<i?i-t[3]:0,n*n+r*r}function ot(t,e){return ht(t,e[0],e[1])}function at(t,e){return t[0]<=e[0]&&e[2]<=t[2]&&t[1]<=e[1]&&e[3]<=t[3]}function ht(t,e,i){return t[0]<=e&&e<=t[2]&&t[1]<=i&&i<=t[3]}function lt(t,e){const i=t[0],n=t[1],r=t[2],s=t[3],o=e[0],a=e[1];let h=et.UNKNOWN;return o<i?h|=et.LEFT:o>r&&(h|=et.RIGHT),a<n?h|=et.BELOW:a>s&&(h|=et.ABOVE),h===et.UNKNOWN&&(h=et.INTERSECTING),h}function ct(t,e,i,n,r){return r?(r[0]=t,r[1]=e,r[2]=i,r[3]=n,r):[t,e,i,n]}function ut(t){return ct(1/0,1/0,-1/0,-1/0,t)}function dt(t,e){const i=t[0],n=t[1];return ct(i,n,i,n,e)}function ft(t,e,i,n,r){return _t(ut(r),t,e,i,n)}function gt(t,e){return t[0]==e[0]&&t[2]==e[2]&&t[1]==e[1]&&t[3]==e[3]}function mt(t,e){return e[0]<t[0]&&(t[0]=e[0]),e[2]>t[2]&&(t[2]=e[2]),e[1]<t[1]&&(t[1]=e[1]),e[3]>t[3]&&(t[3]=e[3]),t}function pt(t,e){e[0]<t[0]&&(t[0]=e[0]),e[0]>t[2]&&(t[2]=e[0]),e[1]<t[1]&&(t[1]=e[1]),e[1]>t[3]&&(t[3]=e[1])}function _t(t,e,i,n,r){for(;i<n;i+=r)wt(t,e[i],e[i+1]);return t}function wt(t,e,i){t[0]=Math.min(t[0],e),t[1]=Math.min(t[1],i),t[2]=Math.max(t[2],e),t[3]=Math.max(t[3],i)}function yt(t,e){let i;return i=e(bt(t)),i||(i=e(xt(t)),i||(i=e(Tt(t)),i||(i=e(At(t)),i||!1)))}function vt(t){let e=0;return Dt(t)||(e=Rt(t)*Ct(t)),e}function bt(t){return[t[0],t[1]]}function xt(t){return[t[2],t[1]]}function Mt(t){return[(t[0]+t[2])/2,(t[1]+t[3])/2]}function Et(t,e){let i;if("bottom-left"===e)i=bt(t);else if("bottom-right"===e)i=xt(t);else if("top-left"===e)i=At(t);else{if("top-right"!==e)throw new Error("Invalid corner");i=Tt(t)}return i}function St(t,e,i,n,r){const[s,o,a,h,l,c,u,d]=kt(t,e,i,n);return ct(Math.min(s,a,l,u),Math.min(o,h,c,d),Math.max(s,a,l,u),Math.max(o,h,c,d),r)}function kt(t,e,i,n){const r=e*n[0]/2,s=e*n[1]/2,o=Math.cos(i),a=Math.sin(i),h=r*o,l=r*a,c=s*o,u=s*a,d=t[0],f=t[1];return[d-h+u,f-l-c,d-h-u,f-l+c,d+h-u,f+l+c,d+h+u,f+l-c,d-h+u,f-l-c]}function Ct(t){return t[3]-t[1]}function It(t,e,i){const n=i||[1/0,1/0,-1/0,-1/0];return Pt(t,e)?(t[0]>e[0]?n[0]=t[0]:n[0]=e[0],t[1]>e[1]?n[1]=t[1]:n[1]=e[1],t[2]<e[2]?n[2]=t[2]:n[2]=e[2],t[3]<e[3]?n[3]=t[3]:n[3]=e[3]):ut(n),n}function At(t){return[t[0],t[3]]}function Tt(t){return[t[2],t[3]]}function Rt(t){return t[2]-t[0]}function Pt(t,e){return t[0]<=e[2]&&t[2]>=e[0]&&t[1]<=e[3]&&t[3]>=e[1]}function Dt(t){return t[2]<t[0]||t[3]<t[1]}function Ft(t,e,i,n){if(Dt(t))return ut(i);let r=[];if(n>1){const e=t[2]-t[0],i=t[3]-t[1];for(let s=0;s<n;++s)r.push(t[0]+e*s/n,t[1],t[2],t[1]+i*s/n,t[2]-e*s/n,t[3],t[0],t[3]-i*s/n)}else r=[t[0],t[1],t[2],t[1],t[2],t[3],t[0],t[3]];e(r,r,2);const s=[],o=[];for(let t=0,e=r.length;t<e;t+=2)s.push(r[t]),o.push(r[t+1]);return function(t,e,i){return ct(Math.min.apply(null,t),Math.min.apply(null,e),Math.max.apply(null,t),Math.max.apply(null,e),i)}(s,o,i)}function Lt(t,e){const i=e.getExtent(),n=Mt(t);if(e.canWrapX()&&(n[0]<i[0]||n[0]>=i[2])){const e=Rt(i),r=Math.floor((n[0]-i[0])/e)*e;t[0]-=r,t[2]-=r}return t}const Ot={name:"rgb",min:[0,0,0],max:[255,255,255],channel:["red","green","blue"],alias:["RGB"]};var Nt={name:"xyz",min:[0,0,0],channel:["X","Y","Z"],alias:["XYZ","ciexyz","cie1931"],whitepoint:{2:{A:[109.85,100,35.585],C:[98.074,100,118.232],D50:[96.422,100,82.521],D55:[95.682,100,92.149],D65:[95.045592705167,100,108.9057750759878],D75:[94.972,100,122.638],F2:[99.187,100,67.395],F7:[95.044,100,108.755],F11:[100.966,100,64.37],E:[100,100,100]},10:{A:[111.144,100,35.2],C:[97.285,100,116.145],D50:[96.72,100,81.427],D55:[95.799,100,90.926],D65:[94.811,100,107.304],D75:[94.416,100,120.641],F2:[103.28,100,69.026],F7:[95.792,100,107.687],F11:[103.866,100,65.627],E:[100,100,100]}}};Nt.max=Nt.whitepoint[2].D65,Nt.rgb=function(t,e){e=e||Nt.whitepoint[2].E;var i,n,r,s=t[0]/e[0],o=t[1]/e[1],a=t[2]/e[2];return n=-.96924363628087*s+1.87596750150772*o+.041555057407175*a,r=.055630079696993*s+-.20397695888897*o+1.056971514242878*a,i=(i=3.240969941904521*s+-1.537383177570093*o+-.498610760293*a)>.0031308?1.055*Math.pow(i,1/2.4)-.055:i*=12.92,n=n>.0031308?1.055*Math.pow(n,1/2.4)-.055:n*=12.92,r=r>.0031308?1.055*Math.pow(r,1/2.4)-.055:r*=12.92,[255*(i=Math.min(Math.max(0,i),1)),255*(n=Math.min(Math.max(0,n),1)),255*(r=Math.min(Math.max(0,r),1))]},Ot.xyz=function(t,e){var i=t[0]/255,n=t[1]/255,r=t[2]/255,s=.21263900587151*(i=i>.04045?Math.pow((i+.055)/1.055,2.4):i/12.92)+.71516867876775*(n=n>.04045?Math.pow((n+.055)/1.055,2.4):n/12.92)+.072192315360733*(r=r>.04045?Math.pow((r+.055)/1.055,2.4):r/12.92),o=.019330818715591*i+.11919477979462*n+.95053215224966*r;return[(.41239079926595*i+.35758433938387*n+.18048078840183*r)*(e=e||Nt.whitepoint[2].E)[0],s*e[1],o*e[2]]};const Bt=Nt,zt={name:"luv",min:[0,-134,-140],max:[100,224,122],channel:["lightness","u","v"],alias:["LUV","cieluv","cie1976"],xyz:function(t,e,i){var n,r,s,o,a,h,l,c,u;return s=t[0],o=t[1],a=t[2],0===s?[0,0,0]:(e=e||"D65",i=i||2,n=o/(13*s)+4*(l=Bt.whitepoint[i][e][0])/(l+15*(c=Bt.whitepoint[i][e][1])+3*(u=Bt.whitepoint[i][e][2]))||0,r=a/(13*s)+9*c/(l+15*c+3*u)||0,[9*(h=s>8?c*Math.pow((s+16)/116,3):c*s*.0011070564598794539)*n/(4*r)||0,h,h*(12-3*n-20*r)/(4*r)||0])}};Bt.luv=function(t,e,i){var n,r,s,o,a,h,l,c,u,d,f;e=e||"D65",i=i||2,d=4*(l=Bt.whitepoint[i][e][0])/(l+15*(c=Bt.whitepoint[i][e][1])+3*(u=Bt.whitepoint[i][e][2])),f=9*c/(l+15*c+3*u),n=4*(o=t[0])/(o+15*(a=t[1])+3*(h=t[2]))||0,r=9*a/(o+15*a+3*h)||0;var g=a/c;return[s=g<=.008856451679035631?903.2962962962961*g:116*Math.pow(g,1/3)-16,13*s*(n-d),13*s*(r-f)]};var Ut={name:"lchuv",channel:["lightness","chroma","hue"],alias:["LCHuv","cielchuv"],min:[0,0,0],max:[100,100,360],luv:function(t){var e,i=t[0],n=t[1];return e=t[2]/360*2*Math.PI,[i,n*Math.cos(e),n*Math.sin(e)]},xyz:function(t){return zt.xyz(Ut.luv(t))}};const Gt=Ut;zt.lchuv=function(t){var e=t[0],i=t[1],n=t[2],r=Math.sqrt(i*i+n*n),s=360*Math.atan2(n,i)/2/Math.PI;return s<0&&(s+=360),[e,r,s]},Bt.lchuv=function(t){return zt.lchuv(Bt.luv(t))};var Yt=__webpack_require__(8874);const Xt=function(t){var e,i,n=[],r=1;if("number"==typeof t)return{space:"rgb",values:[t>>>16,(65280&t)>>>8,255&t],alpha:1};if("number"==typeof t)return{space:"rgb",values:[t>>>16,(65280&t)>>>8,255&t],alpha:1};if(t=String(t).toLowerCase(),Yt[t])n=Yt[t].slice(),i="rgb";else if("transparent"===t)r=0,i="rgb",n=[0,0,0];else if("#"===t[0]){var s=t.slice(1),o=s.length;r=1,o<=4?(n=[parseInt(s[0]+s[0],16),parseInt(s[1]+s[1],16),parseInt(s[2]+s[2],16)],4===o&&(r=parseInt(s[3]+s[3],16)/255)):(n=[parseInt(s[0]+s[1],16),parseInt(s[2]+s[3],16),parseInt(s[4]+s[5],16)],8===o&&(r=parseInt(s[6]+s[7],16)/255)),n[0]||(n[0]=0),n[1]||(n[1]=0),n[2]||(n[2]=0),i="rgb"}else if(e=/^((?:rgba?|hs[lvb]a?|hwba?|cmyk?|xy[zy]|gray|lab|lchu?v?|[ly]uv|lms|oklch|oklab|color))\s*\(([^\)]*)\)/.exec(t)){var a=e[1],h="cmyk"===(i=a.replace(/a$/,""))?4:"gray"===i?1:3;n=e[2].trim().split(/\s*[,\/]\s*|\s+/),"color"===i&&(i=n.shift()),r=(n=n.map((function(t,e){if("%"===t[t.length-1])return t=parseFloat(t)/100,3===e?t:"rgb"===i?255*t:"h"===i[0]?100*t:"l"!==i[0]||e?"lab"===i?125*t:"lch"===i?e<2?150*t:360*t:"o"!==i[0]||e?"oklab"===i?.4*t:"oklch"===i?e<2?.4*t:360*t:t:t:100*t;if("h"===i[e]||2===e&&"h"===i[i.length-1]){if(void 0!==Vt[t])return Vt[t];if(t.endsWith("deg"))return parseFloat(t);if(t.endsWith("turn"))return 360*parseFloat(t);if(t.endsWith("grad"))return 360*parseFloat(t)/400;if(t.endsWith("rad"))return 180*parseFloat(t)/Math.PI}return"none"===t?0:parseFloat(t)}))).length>h?n.pop():1}else/[0-9](?:\s|\/|,)/.test(t)&&(n=t.match(/([0-9]+)/g).map((function(t){return parseFloat(t)})),i=t.match(/([a-z])/gi)?.join("")?.toLowerCase()||"rgb");return{space:i,values:n,alpha:r}};var Vt={red:0,orange:60,yellow:120,green:180,blue:240,purple:300};const jt={name:"hsl",min:[0,0,0],max:[360,100,100],channel:["hue","saturation","lightness"],alias:["HSL"],rgb:function(t){var e,i,n,r,s,o=t[0]/360,a=t[1]/100,h=t[2]/100,l=0;if(0===a)return[s=255*h,s,s];for(e=2*h-(i=h<.5?h*(1+a):h+a-h*a),r=[0,0,0];l<3;)(n=o+1/3*-(l-1))<0?n++:n>1&&n--,s=6*n<1?e+6*(i-e)*n:2*n<1?i:3*n<2?e+(i-e)*(2/3-n)*6:e,r[l++]=255*s;return r}};function qt(t,e,i){return Math.min(Math.max(t,e),i)}function Wt(t,e,i,n,r,s){const o=r-i,a=s-n;if(0!==o||0!==a){const h=((t-i)*o+(e-n)*a)/(o*o+a*a);h>1?(i=r,n=s):h>0&&(i+=o*h,n+=a*h)}return Zt(t,e,i,n)}function Zt(t,e,i,n){const r=i-t,s=n-e;return r*r+s*s}function Kt(t){return t*Math.PI/180}function Ht(t,e){const i=t%e;return i*e<0?i+e:i}function $t(t,e,i){return t+i*(e-t)}function Jt(t,e){const i=Math.pow(10,e);return Math.round(t*i)/i}function Qt(t,e){return Math.round(Jt(t,e))}function te(t,e){return Math.floor(Jt(t,e))}function ee(t,e){return Math.ceil(Jt(t,e))}function ie(t){return"string"==typeof t?t:ue(t)}Ot.hsl=function(t){var e,i,n=t[0]/255,r=t[1]/255,s=t[2]/255,o=Math.min(n,r,s),a=Math.max(n,r,s),h=a-o;return a===o?e=0:n===a?e=(r-s)/h:r===a?e=2+(s-n)/h:s===a&&(e=4+(n-r)/h),(e=Math.min(60*e,360))<0&&(e+=360),i=(o+a)/2,[e,100*(a===o?0:i<=.5?h/(a+o):h/(2-a-o)),100*i]};const ne=1024,re={};let se=0;function oe(t){if(4===t.length)return t;const e=t.slice();return e[3]=1,e}function ae(t){const e=Bt.lchuv(Ot.xyz(t));return e[3]=t[3],e}function he(t){if(re.hasOwnProperty(t))return re[t];if(se>=ne){let t=0;for(const e in re)0==(3&t++)&&(delete re[e],--se)}const e=function(t){var e;Array.isArray(t)&&t.raw&&(t=String.raw(...arguments)),t instanceof Number&&(t=+t);var i=Xt(t);if(!i.space)return[];const n="h"===i.space[0]?jt.min:Ot.min,r="h"===i.space[0]?jt.max:Ot.max;return(e=Array(3))[0]=Math.min(Math.max(i.values[0],n[0]),r[0]),e[1]=Math.min(Math.max(i.values[1],n[1]),r[1]),e[2]=Math.min(Math.max(i.values[2],n[2]),r[2]),"h"===i.space[0]&&(e=jt.rgb(e)),e.push(Math.min(Math.max(i.alpha,0),1)),e}(t);if(4!==e.length)throw new Error('Failed to parse "'+t+'" as color');for(const i of e)if(isNaN(i))throw new Error('Failed to parse "'+t+'" as color');return ce(e),re[t]=e,++se,e}function le(t){return Array.isArray(t)?t:he(t)}function ce(t){return t[0]=qt(t[0]+.5|0,0,255),t[1]=qt(t[1]+.5|0,0,255),t[2]=qt(t[2]+.5|0,0,255),t[3]=qt(t[3],0,1),t}function ue(t){let e=t[0];e!=(0|e)&&(e=e+.5|0);let i=t[1];i!=(0|i)&&(i=i+.5|0);let n=t[2];return n!=(0|n)&&(n=n+.5|0),"rgba("+e+","+i+","+n+","+(void 0===t[3]?1:Math.round(100*t[3])/100)+")"}function de(t,e,i){return e+":"+t+":"+(i?ie(i):"null")}const fe=new class{constructor(){this.cache_={},this.cacheSize_=0,this.maxCacheSize_=32}clear(){this.cache_={},this.cacheSize_=0}canExpireCache(){return this.cacheSize_>this.maxCacheSize_}expire(){if(this.canExpireCache()){let t=0;for(const e in this.cache_){const i=this.cache_[e];0!=(3&t++)||i.hasListener()||(delete this.cache_[e],--this.cacheSize_)}}}get(t,e,i){const n=de(t,e,i);return n in this.cache_?this.cache_[n]:null}set(t,e,i,n){const r=de(t,e,i);this.cache_[r]=n,++this.cacheSize_}setSize(t){this.maxCacheSize_=t,this.expire()}},ge="opacity",me="visible",pe="extent",_e="zIndex",we="maxResolution",ye="minResolution",ve="maxZoom",be="minZoom",xe="source",Me=class extends L{constructor(t){super(),this.on,this.once,this.un,this.background_=t.background;const e=Object.assign({},t);"object"==typeof t.properties&&(delete e.properties,Object.assign(e,t.properties)),e[ge]=void 0!==t.opacity?t.opacity:1,K("number"==typeof e[ge],"Layer opacity must be a number"),e[me]=void 0===t.visible||t.visible,e[_e]=t.zIndex,e[we]=void 0!==t.maxResolution?t.maxResolution:1/0,e[ye]=void 0!==t.minResolution?t.minResolution:0,e[be]=void 0!==t.minZoom?t.minZoom:-1/0,e[ve]=void 0!==t.maxZoom?t.maxZoom:1/0,this.className_=void 0!==e.className?e.className:"ol-layer",delete e.className,this.setProperties(e),this.state_=null}getBackground(){return this.background_}getClassName(){return this.className_}getLayerState(t){const e=this.state_||{layer:this,managed:void 0===t||t},i=this.getZIndex();return e.opacity=qt(Math.round(100*this.getOpacity())/100,0,1),e.visible=this.getVisible(),e.extent=this.getExtent(),e.zIndex=void 0!==i||e.managed?i:1/0,e.maxResolution=this.getMaxResolution(),e.minResolution=Math.max(this.getMinResolution(),0),e.minZoom=this.getMinZoom(),e.maxZoom=this.getMaxZoom(),this.state_=e,e}getLayersArray(t){return R()}getLayerStatesArray(t){return R()}getExtent(){return this.get(pe)}getMaxResolution(){return this.get(we)}getMinResolution(){return this.get(ye)}getMinZoom(){return this.get(be)}getMaxZoom(){return this.get(ve)}getOpacity(){return this.get(ge)}getSourceState(){return R()}getVisible(){return this.get(me)}getZIndex(){return this.get(_e)}setBackground(t){this.background_=t,this.changed()}setExtent(t){this.set(pe,t)}setMaxResolution(t){this.set(we,t)}setMinResolution(t){this.set(ye,t)}setMaxZoom(t){this.set(ve,t)}setMinZoom(t){this.set(be,t)}setOpacity(t){K("number"==typeof t,"Layer opacity must be a number"),this.set(ge,t)}setVisible(t){this.set(me,t)}setZIndex(t){this.set(_e,t)}disposeInternal(){this.state_&&(this.state_.layer=null,this.state_=null),super.disposeInternal()}},Ee="prerender",Se="postrender",ke="precompose",Ce="rendercomplete",Ie={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"},Ae=42,Te=256,Re={radians:6370997/(2*Math.PI),degrees:2*Math.PI*6370997/360,ft:.3048,m:1,"us-ft":1200/3937},Pe=class{constructor(t){this.code_=t.code,this.units_=t.units,this.extent_=void 0!==t.extent?t.extent:null,this.worldExtent_=void 0!==t.worldExtent?t.worldExtent:null,this.axisOrientation_=void 0!==t.axisOrientation?t.axisOrientation:"enu",this.global_=void 0!==t.global&&t.global,this.canWrapX_=!(!this.global_||!this.extent_),this.getPointResolutionFunc_=t.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=t.metersPerUnit}canWrapX(){return this.canWrapX_}getCode(){return this.code_}getExtent(){return this.extent_}getUnits(){return this.units_}getMetersPerUnit(){return this.metersPerUnit_||Re[this.units_]}getWorldExtent(){return this.worldExtent_}getAxisOrientation(){return this.axisOrientation_}isGlobal(){return this.global_}setGlobal(t){this.global_=t,this.canWrapX_=!(!t||!this.extent_)}getDefaultTileGrid(){return this.defaultTileGrid_}setDefaultTileGrid(t){this.defaultTileGrid_=t}setExtent(t){this.extent_=t,this.canWrapX_=!(!this.global_||!t)}setWorldExtent(t){this.worldExtent_=t}setGetPointResolution(t){this.getPointResolutionFunc_=t}getPointResolutionFunc(){return this.getPointResolutionFunc_}},De=6378137,Fe=Math.PI*De,Le=[-Fe,-Fe,Fe,Fe],Oe=[-180,-85,180,85],Ne=De*Math.log(Math.tan(Math.PI/2));class Be extends Pe{constructor(t){super({code:t,units:"m",extent:Le,global:!0,worldExtent:Oe,getPointResolution:function(t,e){return t/Math.cosh(e[1]/De)}})}}const ze=[new Be("EPSG:3857"),new Be("EPSG:102100"),new Be("EPSG:102113"),new Be("EPSG:900913"),new Be("http://www.opengis.net/def/crs/EPSG/0/3857"),new Be("http://www.opengis.net/gml/srs/epsg.xml#3857")];const Ue=[-180,-90,180,90],Ge=6378137*Math.PI/180;class Ye extends Pe{constructor(t,e){super({code:t,units:"degrees",extent:Ue,axisOrientation:e,global:!0,metersPerUnit:Ge,worldExtent:Ue})}}const Xe=[new Ye("CRS:84"),new Ye("EPSG:4326","neu"),new Ye("urn:ogc:def:crs:OGC:1.3:CRS84"),new Ye("urn:ogc:def:crs:OGC:2:84"),new Ye("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new Ye("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new Ye("http://www.opengis.net/def/crs/EPSG/0/4326","neu")];let Ve={},je={};function qe(t,e,i){const n=t.getCode(),r=e.getCode();n in je||(je[n]={}),je[n][r]=i}function We(t,e){let i=!0;for(let n=t.length-1;n>=0;--n)if(t[n]!=e[n]){i=!1;break}return i}function Ze(t,e){const i=Math.cos(e),n=Math.sin(e),r=t[0]*i-t[1]*n,s=t[1]*i+t[0]*n;return t[0]=r,t[1]=s,t}function Ke(t,e){if(e.canWrapX()){const i=Rt(e.getExtent()),n=function(t,e,i){const n=e.getExtent();let r=0;return e.canWrapX()&&(t[0]<n[0]||t[0]>n[2])&&(i=i||Rt(n),r=Math.floor((t[0]-n[0])/i)),r}(t,e,i);n&&(t[0]-=n*i)}return t}const He=6371008.8;function $e(t,e,i){i=i||He;const n=Kt(t[1]),r=Kt(e[1]),s=(r-n)/2,o=Kt(e[0]-t[0])/2,a=Math.sin(s)*Math.sin(s)+Math.sin(o)*Math.sin(o)*Math.cos(n)*Math.cos(r);return 2*i*Math.atan2(Math.sqrt(a),Math.sqrt(1-a))}const Je={info:1,warn:2,error:3,none:4};let Qe=Je.info;function ti(...t){Qe>Je.warn||console.warn(...t)}let ei=!0;function ii(t,e){if(void 0!==e)for(let i=0,n=t.length;i<n;++i)e[i]=t[i];else e=t.slice();return e}function ni(t,e){if(void 0!==e&&t!==e){for(let i=0,n=t.length;i<n;++i)e[i]=t[i];t=e}return t}function ri(t){!function(t,e){Ve[t]=e}(t.getCode(),t),qe(t,t,ii)}function si(t){return"string"==typeof t?Ve[e=t]||Ve[e.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null:t||null;var e}function oi(t,e,i,n){let r;const s=(t=si(t)).getPointResolutionFunc();if(s){if(r=s(e,i),n&&n!==t.getUnits()){const e=t.getMetersPerUnit();e&&(r=r*e/Re[n])}}else{const s=t.getUnits();if("degrees"==s&&!n||"degrees"==n)r=e;else{const o=ci(t,si("EPSG:4326"));if(o===ni&&"degrees"!==s)r=e*t.getMetersPerUnit();else{let t=[i[0]-e/2,i[1],i[0]+e/2,i[1],i[0],i[1]-e/2,i[0],i[1]+e/2];t=o(t,t,2),r=($e(t.slice(0,2),t.slice(2,4))+$e(t.slice(4,6),t.slice(6,8)))/2}const a=n?Re[n]:t.getMetersPerUnit();void 0!==a&&(r/=a)}}return r}function ai(t){!function(t){t.forEach(ri)}(t),t.forEach((function(e){t.forEach((function(t){e!==t&&qe(e,t,ii)}))}))}function hi(t,e){return t?"string"==typeof t?si(t):t:si(e)}function li(t,e){if(t===e)return!0;const i=t.getUnits()===e.getUnits();return(t.getCode()===e.getCode()||ci(t,e)===ii)&&i}function ci(t,e){let i=function(t,e){let i;return t in je&&e in je[t]&&(i=je[t][e]),i}(t.getCode(),e.getCode());return i||(i=ni),i}function ui(t,e){return ci(si(t),si(e))}function di(t,e,i){return ui(e,i)(t,void 0,t.length)}let fi=null;function gi(){return fi}function mi(t,e){return t}function pi(t,e){return ei&&!We(t,[0,0])&&t[0]>=-180&&t[0]<=180&&t[1]>=-90&&t[1]<=90&&(ei=!1,ti("Call useGeographic() from ol/proj once to work with [longitude, latitude] coordinates.")),t}function _i(t,e){return t}function wi(t,e){return t}function yi(t,e){return t}var vi,bi,xi;function Mi(t,e,i){return function(n,r,s,o,a){if(!n)return;if(!r&&!e)return n;const h=e?0:s[0]*r,l=e?0:s[1]*r,c=a?a[0]:0,u=a?a[1]:0;let d=t[0]+h/2+c,f=t[2]-h/2+c,g=t[1]+l/2+u,m=t[3]-l/2+u;d>f&&(d=(f+d)/2,f=d),g>m&&(g=(m+g)/2,m=g);let p=qt(n[0],d,f),_=qt(n[1],g,m);if(o&&i&&r){const t=30*r;p+=-t*Math.log(1+Math.max(0,d-n[0])/t)+t*Math.log(1+Math.max(0,n[0]-f)/t),_+=-t*Math.log(1+Math.max(0,g-n[1])/t)+t*Math.log(1+Math.max(0,n[1]-m)/t)}return[p,_]}}function Ei(t){return t}function Si(t,e,i,n){const r=Rt(e)/i[0],s=Ct(e)/i[1];return n?Math.min(t,Math.max(r,s)):Math.min(t,Math.min(r,s))}function ki(t,e,i){let n=Math.min(t,e);return n*=Math.log(1+50*Math.max(0,t/e-1))/50+1,i&&(n=Math.max(n,i),n/=Math.log(1+50*Math.max(0,i/t-1))/50+1),qt(n,i/2,2*e)}function Ci(t,e,i,n,r){return i=void 0===i||i,function(s,o,a,h){if(void 0!==s){const o=n?Si(t,n,a,r):t;return i&&h?ki(s,o,e):qt(s,e,o)}}}function Ii(t){if(void 0!==t)return 0}function Ai(t){if(void 0!==t)return t}function Ti(t){return Math.pow(t,3)}function Ri(t){return 1-Ti(1-t)}function Pi(t){return 3*t*t-2*t*t*t}function Di(t){return t}function Fi(t,e,i,n,r,s){s=s||[];let o=0;for(let a=e;a<i;a+=n){const e=t[a],i=t[a+1];s[o++]=r[0]*e+r[2]*i+r[4],s[o++]=r[1]*e+r[3]*i+r[5]}return s&&s.length!=o&&(s.length=o),s}function Li(t,e,i,n,r,s,o){o=o||[];const a=Math.cos(r),h=Math.sin(r),l=s[0],c=s[1];let u=0;for(let r=e;r<i;r+=n){const e=t[r]-l,i=t[r+1]-c;o[u++]=l+e*a-i*h,o[u++]=c+e*h+i*a;for(let e=r+2;e<r+n;++e)o[u++]=t[e]}return o&&o.length!=u&&(o.length=u),o}ai(ze),ai(Xe),vi=ze,bi=function(t,e,i){const n=t.length;i=i>1?i:2,void 0===e&&(e=i>2?t.slice():new Array(n));for(let r=0;r<n;r+=i){e[r]=Fe*t[r]/180;let i=De*Math.log(Math.tan(Math.PI*(+t[r+1]+90)/360));i>Ne?i=Ne:i<-Ne&&(i=-Ne),e[r+1]=i}return e},xi=function(t,e,i){const n=t.length;i=i>1?i:2,void 0===e&&(e=i>2?t.slice():new Array(n));for(let r=0;r<n;r+=i)e[r]=180*t[r]/Fe,e[r+1]=360*Math.atan(Math.exp(t[r+1]/De))/Math.PI-90;return e},Xe.forEach((function(t){vi.forEach((function(e){qe(t,e,bi),qe(e,t,xi)}))}));const Oi=[1,0,0,1,0,0],Ni=class extends L{constructor(){super(),this.extent_=[1/0,1/0,-1/0,-1/0],this.extentRevision_=-1,this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0,this.simplifyTransformedInternal=m(((t,e,i)=>{if(!i)return this.getSimplifiedGeometry(e);const n=this.clone();return n.applyTransform(i),n.getSimplifiedGeometry(e)}))}simplifyTransformed(t,e){return this.simplifyTransformedInternal(this.getRevision(),t,e)}clone(){return R()}closestPointXY(t,e,i,n){return R()}containsXY(t,e){const i=this.getClosestPoint([t,e]);return i[0]===t&&i[1]===e}getClosestPoint(t,e){return e=e||[NaN,NaN],this.closestPointXY(t[0],t[1],e,1/0),e}intersectsCoordinate(t){return this.containsXY(t[0],t[1])}computeExtent(t){return R()}getExtent(t){if(this.extentRevision_!=this.getRevision()){const t=this.computeExtent(this.extent_);(isNaN(t[0])||isNaN(t[1]))&&ut(t),this.extentRevision_=this.getRevision()}return function(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t}(this.extent_,t)}rotate(t,e){R()}scale(t,e,i){R()}simplify(t){return this.getSimplifiedGeometry(t*t)}getSimplifiedGeometry(t){return R()}getType(){return R()}applyTransform(t){R()}intersectsExtent(t){return R()}translate(t,e){R()}transform(t,e){const i=si(t),n="tile-pixels"==i.getUnits()?function(t,n,r){const s=i.getExtent(),o=i.getWorldExtent(),a=Ct(o)/Ct(s);return $(Oi,o[0],o[3],a,-a,0,0,0),Fi(t,0,t.length,r,Oi,n),ui(i,e)(t,n,r)}:ui(i,e);return this.applyTransform(n),this}};function Bi(t){let e;return 2==t?e="XY":3==t?e="XYZ":4==t&&(e="XYZM"),e}function zi(t){let e;return"XY"==t?e=2:"XYZ"==t||"XYM"==t?e=3:"XYZM"==t&&(e=4),e}const Ui=class extends Ni{constructor(){super(),this.layout="XY",this.stride=2,this.flatCoordinates}computeExtent(t){return ft(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}getCoordinates(){return R()}getFirstCoordinate(){return this.flatCoordinates.slice(0,this.stride)}getFlatCoordinates(){return this.flatCoordinates}getLastCoordinate(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}getLayout(){return this.layout}getSimplifiedGeometry(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&t<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;const e=this.getSimplifiedGeometryInternal(t);return e.getFlatCoordinates().length<this.flatCoordinates.length?e:(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)}getSimplifiedGeometryInternal(t){return this}getStride(){return this.stride}setFlatCoordinates(t,e){this.stride=zi(t),this.layout=t,this.flatCoordinates=e}setCoordinates(t,e){R()}setLayout(t,e,i){let n;if(t)n=zi(t);else{for(let t=0;t<i;++t){if(0===e.length)return this.layout="XY",void(this.stride=2);e=e[0]}n=e.length,t=Bi(n)}this.layout=t,this.stride=n}applyTransform(t){this.flatCoordinates&&(t(this.flatCoordinates,this.flatCoordinates,this.stride),this.changed())}rotate(t,e){const i=this.getFlatCoordinates();if(i){const n=this.getStride();Li(i,0,i.length,n,t,e,i),this.changed()}}scale(t,e,i){void 0===e&&(e=t),i||(i=Mt(this.getExtent()));const n=this.getFlatCoordinates();if(n){const r=this.getStride();!function(t,e,i,n,r,s,o,a){a=a||[];const h=o[0],l=o[1];let c=0;for(let e=0;e<i;e+=n){const i=t[e]-h,o=t[e+1]-l;a[c++]=h+r*i,a[c++]=l+s*o;for(let i=e+2;i<e+n;++i)a[c++]=t[i]}a&&a.length!=c&&(a.length=c)}(n,0,n.length,r,t,e,i,n),this.changed()}}translate(t,e){const i=this.getFlatCoordinates();if(i){const n=this.getStride();!function(t,e,i,n,r,s,o){o=o||[];let a=0;for(let e=0;e<i;e+=n){o[a++]=t[e]+r,o[a++]=t[e+1]+s;for(let i=e+2;i<e+n;++i)o[a++]=t[i]}o&&o.length!=a&&(o.length=a)}(i,0,i.length,n,t,e,i),this.changed()}}};function Gi(t,e,i,n,r,s,o){const a=t[e],h=t[e+1],l=t[i]-a,c=t[i+1]-h;let u;if(0===l&&0===c)u=e;else{const d=((r-a)*l+(s-h)*c)/(l*l+c*c);if(d>1)u=i;else{if(d>0){for(let r=0;r<n;++r)o[r]=$t(t[e+r],t[i+r],d);return void(o.length=n)}u=e}}for(let e=0;e<n;++e)o[e]=t[u+e];o.length=n}function Yi(t,e,i,n,r){let s=t[e],o=t[e+1];for(e+=n;e<i;e+=n){const i=t[e],n=t[e+1],a=Zt(s,o,i,n);a>r&&(r=a),s=i,o=n}return r}function Xi(t,e,i,n,r){for(let s=0,o=i.length;s<o;++s){const o=i[s];r=Yi(t,e,o,n,r),e=o}return r}function Vi(t,e,i,n,r,s,o,a,h,l,c){if(e==i)return l;let u,d;if(0===r){if(d=Zt(o,a,t[e],t[e+1]),d<l){for(u=0;u<n;++u)h[u]=t[e+u];return h.length=n,d}return l}c=c||[NaN,NaN];let f=e+n;for(;f<i;)if(Gi(t,f-n,f,n,o,a,c),d=Zt(o,a,c[0],c[1]),d<l){for(l=d,u=0;u<n;++u)h[u]=c[u];h.length=n,f+=n}else f+=n*Math.max((Math.sqrt(d)-Math.sqrt(l))/r|0,1);if(s&&(Gi(t,i-n,e,n,o,a,c),d=Zt(o,a,c[0],c[1]),d<l)){for(l=d,u=0;u<n;++u)h[u]=c[u];h.length=n}return l}function ji(t,e,i,n,r,s,o,a,h,l,c){c=c||[NaN,NaN];for(let u=0,d=i.length;u<d;++u){const d=i[u];l=Vi(t,e,d,n,r,s,o,a,h,l,c),e=d}return l}function qi(t,e,i,n){for(let r=0,s=i.length;r<s;++r){const s=i[r];for(let i=0;i<n;++i)t[e++]=s[i]}return e}function Wi(t,e,i,n,r){r=r||[];let s=0;for(let o=0,a=i.length;o<a;++o){const a=qi(t,e,i[o],n);r[s++]=a,e=a}return r.length=s,r}function Zi(t,e,i,n,r){r=r||[];let s=0;for(let o=0,a=i.length;o<a;++o){const a=Wi(t,e,i[o],n,r[s]);0===a.length&&(a[0]=e),r[s++]=a,e=a[a.length-1]}return r.length=s,r}function Ki(t,e,i,n,r,s,o){const a=(i-e)/n;if(a<3){for(;e<i;e+=n)s[o++]=t[e],s[o++]=t[e+1];return o}const h=new Array(a);h[0]=1,h[a-1]=1;const l=[e,i-n];let c=0;for(;l.length>0;){const i=l.pop(),s=l.pop();let o=0;const a=t[s],u=t[s+1],d=t[i],f=t[i+1];for(let e=s+n;e<i;e+=n){const i=Wt(t[e],t[e+1],a,u,d,f);i>o&&(c=e,o=i)}o>r&&(h[(c-e)/n]=1,s+n<c&&l.push(s,c),c+n<i&&l.push(c,i))}for(let i=0;i<a;++i)h[i]&&(s[o++]=t[e+i*n],s[o++]=t[e+i*n+1]);return o}function Hi(t,e,i,n,r,s,o,a){for(let h=0,l=i.length;h<l;++h){const l=i[h];o=Ki(t,e,l,n,r,s,o),a.push(o),e=l}return o}function $i(t,e){return e*Math.round(t/e)}function Ji(t,e,i,n,r,s,o){if(e==i)return o;let a,h,l=$i(t[e],r),c=$i(t[e+1],r);e+=n,s[o++]=l,s[o++]=c;do{if(a=$i(t[e],r),h=$i(t[e+1],r),(e+=n)==i)return s[o++]=a,s[o++]=h,o}while(a==l&&h==c);for(;e<i;){const i=$i(t[e],r),u=$i(t[e+1],r);if(e+=n,i==a&&u==h)continue;const d=a-l,f=h-c,g=i-l,m=u-c;d*m==f*g&&(d<0&&g<d||d==g||d>0&&g>d)&&(f<0&&m<f||f==m||f>0&&m>f)?(a=i,h=u):(s[o++]=a,s[o++]=h,l=a,c=h,a=i,h=u)}return s[o++]=a,s[o++]=h,o}function Qi(t,e,i,n,r,s,o,a){for(let h=0,l=i.length;h<l;++h){const l=i[h];o=Ji(t,e,l,n,r,s,o),a.push(o),e=l}return o}function tn(t,e,i,n,r){r=void 0!==r?r:[];let s=0;for(let o=e;o<i;o+=n)r[s++]=t.slice(o,o+n);return r.length=s,r}function en(t,e,i,n,r){r=void 0!==r?r:[];let s=0;for(let o=0,a=i.length;o<a;++o){const a=i[o];r[s++]=tn(t,e,a,n,r[s]),e=a}return r.length=s,r}function nn(t,e,i,n,r){r=void 0!==r?r:[];let s=0;for(let o=0,a=i.length;o<a;++o){const a=i[o];r[s++]=1===a.length&&a[0]===e?[]:en(t,e,a,n,r[s]),e=a[a.length-1]}return r.length=s,r}function rn(t,e,i,n){let r=0,s=t[i-n],o=t[i-n+1];for(;e<i;e+=n){const i=t[e],n=t[e+1];r+=o*i-s*n,s=i,o=n}return r/2}function sn(t,e,i,n){let r=0;for(let s=0,o=i.length;s<o;++s){const o=i[s];r+=rn(t,e,o,n),e=o}return r}class on extends Ui{constructor(t,e){super(),this.maxDelta_=-1,this.maxDeltaRevision_=-1,void 0===e||Array.isArray(t[0])?this.setCoordinates(t,e):this.setFlatCoordinates(e,t)}clone(){return new on(this.flatCoordinates.slice(),this.layout)}closestPointXY(t,e,i,n){return n<st(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Yi(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Vi(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,t,e,i,n))}getArea(){return rn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinates(){return tn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getSimplifiedGeometryInternal(t){const e=[];return e.length=Ki(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,0),new on(e,"XY")}getType(){return"LinearRing"}intersectsExtent(t){return!1}setCoordinates(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=qi(this.flatCoordinates,0,t,this.stride),this.changed()}}const an=on;class hn extends Ui{constructor(t,e){super(),this.setCoordinates(t,e)}clone(){const t=new hn(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(t,e,i,n){const r=this.flatCoordinates,s=Zt(t,e,r[0],r[1]);if(s<n){const t=this.stride;for(let e=0;e<t;++e)i[e]=r[e];return i.length=t,s}return n}getCoordinates(){return this.flatCoordinates.slice()}computeExtent(t){return dt(this.flatCoordinates,t)}getType(){return"Point"}intersectsExtent(t){return ht(t,this.flatCoordinates[0],this.flatCoordinates[1])}setCoordinates(t,e){this.setLayout(e,t,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=function(t,e,i,n){for(let n=0,r=i.length;n<r;++n)t[e++]=i[n];return e}(this.flatCoordinates,0,t,this.stride),this.changed()}}const ln=hn;function cn(t,e,i,n,r){return!yt(r,(function(r){return!un(t,e,i,n,r[0],r[1])}))}function un(t,e,i,n,r,s){let o=0,a=t[i-n],h=t[i-n+1];for(;e<i;e+=n){const i=t[e],n=t[e+1];h<=s?n>s&&(i-a)*(s-h)-(r-a)*(n-h)>0&&o++:n<=s&&(i-a)*(s-h)-(r-a)*(n-h)<0&&o--,a=i,h=n}return 0!==o}function dn(t,e,i,n,r,s){if(0===i.length)return!1;if(!un(t,e,i[0],n,r,s))return!1;for(let e=1,o=i.length;e<o;++e)if(un(t,i[e-1],i[e],n,r,s))return!1;return!0}function fn(t,e,i,n,r,s,o){let h,l,c,u,d,f,g;const m=r[s+1],p=[];for(let r=0,s=i.length;r<s;++r){const s=i[r];for(u=t[s-n],f=t[s-n+1],h=e;h<s;h+=n)d=t[h],g=t[h+1],(m<=f&&g<=m||f<=m&&m<=g)&&(c=(m-f)/(g-f)*(d-u)+u,p.push(c)),u=d,f=g}let _=NaN,w=-1/0;for(p.sort(a),u=p[0],h=1,l=p.length;h<l;++h){d=p[h];const r=Math.abs(d-u);r>w&&(c=(u+d)/2,dn(t,e,i,n,c,m)&&(_=c,w=r)),u=d}return isNaN(_)&&(_=r[s]),o?(o.push(_,m,w),o):[_,m,w]}function gn(t,e,i,n,r){let s=[];for(let o=0,a=i.length;o<a;++o){const a=i[o];s=fn(t,e,a,n,r,2*o,s),e=a[a.length-1]}return s}function mn(t,e,i,n,r){let s;for(e+=n;e<i;e+=n)if(s=r(t.slice(e-n,e),t.slice(e,e+n)),s)return s;return!1}function pn(t,e,i,n,r){const s=_t([1/0,1/0,-1/0,-1/0],t,e,i,n);return!!Pt(r,s)&&(!!at(r,s)||s[0]>=r[0]&&s[2]<=r[2]||s[1]>=r[1]&&s[3]<=r[3]||mn(t,e,i,n,(function(t,e){return function(t,e,i){let n=!1;const r=lt(t,e),s=lt(t,i);if(r===et.INTERSECTING||s===et.INTERSECTING)n=!0;else{const o=t[0],a=t[1],h=t[2],l=t[3],c=e[0],u=e[1],d=i[0],f=i[1],g=(f-u)/(d-c);let m,p;s&et.ABOVE&&!(r&et.ABOVE)&&(m=d-(f-l)/g,n=m>=o&&m<=h),n||!(s&et.RIGHT)||r&et.RIGHT||(p=f-(d-h)*g,n=p>=a&&p<=l),n||!(s&et.BELOW)||r&et.BELOW||(m=d-(f-a)/g,n=m>=o&&m<=h),n||!(s&et.LEFT)||r&et.LEFT||(p=f-(d-o)*g,n=p>=a&&p<=l)}return n}(r,t,e)})))}function _n(t,e,i,n,r){return!!(pn(t,e,i,n,r)||un(t,e,i,n,r[0],r[1])||un(t,e,i,n,r[0],r[3])||un(t,e,i,n,r[2],r[1])||un(t,e,i,n,r[2],r[3]))}function wn(t,e,i,n,r){if(!_n(t,e,i[0],n,r))return!1;if(1===i.length)return!0;for(let e=1,s=i.length;e<s;++e)if(cn(t,i[e-1],i[e],n,r)&&!pn(t,i[e-1],i[e],n,r))return!1;return!0}function yn(t,e,i,n){for(;e<i-n;){for(let r=0;r<n;++r){const s=t[e+r];t[e+r]=t[i-n+r],t[i-n+r]=s}e+=n,i-=n}}function vn(t,e,i,n){let r=0,s=t[i-n],o=t[i-n+1];for(;e<i;e+=n){const i=t[e],n=t[e+1];r+=(i-s)*(n+o),s=i,o=n}return 0===r?void 0:r>0}function bn(t,e,i,n,r){r=void 0!==r&&r;for(let s=0,o=i.length;s<o;++s){const o=i[s],a=vn(t,e,o,n);if(0===s){if(r&&a||!r&&!a)return!1}else if(r&&!a||!r&&a)return!1;e=o}return!0}function xn(t,e,i,n,r){for(let s=0,o=i.length;s<o;++s){const o=i[s];if(!bn(t,e,o,n,r))return!1;o.length&&(e=o[o.length-1])}return!0}function Mn(t,e,i,n,r){r=void 0!==r&&r;for(let s=0,o=i.length;s<o;++s){const o=i[s],a=vn(t,e,o,n);(0===s?r&&a||!r&&!a:r&&!a||!r&&a)&&yn(t,e,o,n),e=o}return e}function En(t,e,i,n,r){for(let s=0,o=i.length;s<o;++s)e=Mn(t,e,i[s],n,r);return e}class Sn extends Ui{constructor(t,e,i){super(),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,void 0!==e&&i?(this.setFlatCoordinates(e,t),this.ends_=i):this.setCoordinates(t,e)}appendLinearRing(t){this.flatCoordinates?c(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const t=new Sn(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return t.applyProperties(this),t}closestPointXY(t,e,i,n){return n<st(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Xi(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),ji(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,t,e,i,n))}containsXY(t,e){return dn(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,e)}getArea(){return sn(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)}getCoordinates(t){let e;return void 0!==t?(e=this.getOrientedFlatCoordinates().slice(),Mn(e,0,this.ends_,this.stride,t)):e=this.flatCoordinates,en(e,0,this.ends_,this.stride)}getEnds(){return this.ends_}getFlatInteriorPoint(){if(this.flatInteriorPointRevision_!=this.getRevision()){const t=Mt(this.getExtent());this.flatInteriorPoint_=fn(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_}getInteriorPoint(){return new ln(this.getFlatInteriorPoint(),"XYM")}getLinearRingCount(){return this.ends_.length}getLinearRing(t){return t<0||this.ends_.length<=t?null:new an(this.flatCoordinates.slice(0===t?0:this.ends_[t-1],this.ends_[t]),this.layout)}getLinearRings(){const t=this.layout,e=this.flatCoordinates,i=this.ends_,n=[];let r=0;for(let s=0,o=i.length;s<o;++s){const o=i[s],a=new an(e.slice(r,o),t);n.push(a),r=o}return n}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const t=this.flatCoordinates;bn(t,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=Mn(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(t){const e=[],i=[];return e.length=Qi(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(t),e,0,i),new Sn(e,"XY",i)}getType(){return"Polygon"}intersectsExtent(t){return wn(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);const i=Wi(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=0===i.length?0:i[i.length-1],this.changed()}}const kn=Sn;function Cn(t){if(Dt(t))throw new Error("Cannot create polygon from empty extent");const e=t[0],i=t[1],n=t[2],r=t[3],s=[e,i,e,r,n,r,n,i,e,i];return new Sn(s,"XY",[s.length])}function In(t,e){setTimeout((function(){t(e)}),0)}function An(t){return!(t.sourceCenter&&t.targetCenter&&!We(t.sourceCenter,t.targetCenter))&&t.sourceResolution===t.targetResolution&&t.sourceRotation===t.targetRotation}function Tn(t,e,i,n,r){const s=Math.cos(-r);let o=Math.sin(-r),a=t[0]*s-t[1]*o,h=t[1]*s+t[0]*o;return a+=(e[0]/2-i[0])*n,h+=(i[1]-e[1]/2)*n,o=-o,[a*s-h*o,h*s+a*o]}const Rn=class extends L{constructor(t){super(),this.on,this.once,this.un,t=Object.assign({},t),this.hints_=[0,0],this.animations_=[],this.updateAnimationKey_,this.projection_=hi(t.projection,"EPSG:3857"),this.viewportSize_=[100,100],this.targetCenter_=null,this.targetResolution_,this.targetRotation_,this.nextCenter_=null,this.nextResolution_,this.nextRotation_,this.cancelAnchor_=void 0,t.projection&&function(t){ei=!(void 0===t||t)}(),t.center&&(t.center=pi(t.center,this.projection_)),t.extent&&(t.extent=wi(t.extent,this.projection_)),this.applyOptions_(t)}applyOptions_(t){const e=Object.assign({},t);for(const t in Ie)delete e[t];this.setProperties(e,!0);const i=function(t){let e,i,n;let r=void 0!==t.minZoom?t.minZoom:0,s=void 0!==t.maxZoom?t.maxZoom:28;const o=void 0!==t.zoomFactor?t.zoomFactor:2,a=void 0!==t.multiWorld&&t.multiWorld,l=void 0===t.smoothResolutionConstraint||t.smoothResolutionConstraint,c=void 0!==t.showFullExtent&&t.showFullExtent,u=hi(t.projection,"EPSG:3857"),d=u.getExtent();let f=t.constrainOnlyCenter,g=t.extent;if(a||g||!u.isGlobal()||(f=!1,g=d),void 0!==t.resolutions){const o=t.resolutions;i=o[r],n=void 0!==o[s]?o[s]:o[o.length-1],e=t.constrainResolution?function(t,e,i,n){return e=void 0===e||e,function(r,s,o,a){if(void 0!==r){const l=t[0],c=t[t.length-1],u=i?Si(l,i,o,n):l;if(a)return e?ki(r,u,c):qt(r,c,u);const d=Math.min(u,r),f=Math.floor(h(t,d,s));return t[f]>u&&f<t.length-1?t[f+1]:t[f]}}}(o,l,!f&&g,c):Ci(i,n,l,!f&&g,c)}else{const a=(d?Math.max(Rt(d),Ct(d)):360*Re.degrees/u.getMetersPerUnit())/Te/Math.pow(2,0),h=a/Math.pow(2,28);i=t.maxResolution,void 0!==i?r=0:i=a/Math.pow(o,r),n=t.minResolution,void 0===n&&(n=void 0!==t.maxZoom?void 0!==t.maxResolution?i/Math.pow(o,s):a/Math.pow(o,s):h),s=r+Math.floor(Math.log(i/n)/Math.log(o)),n=i/Math.pow(o,s-r),e=t.constrainResolution?function(t,e,i,n,r,s){return n=void 0===n||n,i=void 0!==i?i:0,function(o,a,h,l){if(void 0!==o){const c=r?Si(e,r,h,s):e;if(l)return n?ki(o,c,i):qt(o,i,c);const u=1e-9,d=Math.ceil(Math.log(e/c)/Math.log(t)-u),f=-a*(.5-u)+.5,g=Math.min(c,o),m=Math.floor(Math.log(e/g)/Math.log(t)+f),p=Math.max(d,m);return qt(e/Math.pow(t,p),i,c)}}}(o,i,n,l,!f&&g,c):Ci(i,n,l,!f&&g,c)}return{constraint:e,maxResolution:i,minResolution:n,minZoom:r,zoomFactor:o}}(t);this.maxResolution_=i.maxResolution,this.minResolution_=i.minResolution,this.zoomFactor_=i.zoomFactor,this.resolutions_=t.resolutions,this.padding_=t.padding,this.minZoom_=i.minZoom;const n=function(t){if(void 0!==t.extent){const e=void 0===t.smoothExtentConstraint||t.smoothExtentConstraint;return Mi(t.extent,t.constrainOnlyCenter,e)}const e=hi(t.projection,"EPSG:3857");if(!0!==t.multiWorld&&e.isGlobal()){const t=e.getExtent().slice();return t[0]=-1/0,t[2]=1/0,Mi(t,!1,!1)}return Ei}(t),r=i.constraint,s=function(t){if(void 0===t.enableRotation||t.enableRotation){const e=t.constrainRotation;return void 0===e||!0===e?function(t){const e=Kt(5);return function(t,i){return i||void 0===t?t:Math.abs(t)<=e?0:t}}():!1===e?Ai:"number"==typeof e?function(t){const e=2*Math.PI/t;return function(t,i){return i?t:void 0!==t?t=Math.floor(t/e+.5)*e:void 0}}(e):Ai}return Ii}(t);this.constraints_={center:n,resolution:r,rotation:s},this.setRotation(void 0!==t.rotation?t.rotation:0),this.setCenterInternal(void 0!==t.center?t.center:null),void 0!==t.resolution?this.setResolution(t.resolution):void 0!==t.zoom&&this.setZoom(t.zoom)}get padding(){return this.padding_}set padding(t){let e=this.padding_;this.padding_=t;const i=this.getCenterInternal();if(i){const n=t||[0,0,0,0];e=e||[0,0,0,0];const r=this.getResolution(),s=r/2*(n[3]-e[3]+e[1]-n[1]),o=r/2*(n[0]-e[0]+e[2]-n[2]);this.setCenterInternal([i[0]+s,i[1]-o])}}getUpdatedOptions_(t){const e=this.getProperties();return void 0!==e.resolution?e.resolution=this.getResolution():e.zoom=this.getZoom(),e.center=this.getCenterInternal(),e.rotation=this.getRotation(),Object.assign({},e,t)}animate(t){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);const e=new Array(arguments.length);for(let t=0;t<e.length;++t){let i=arguments[t];i.center&&(i=Object.assign({},i),i.center=pi(i.center,this.getProjection())),i.anchor&&(i=Object.assign({},i),i.anchor=pi(i.anchor,this.getProjection())),e[t]=i}this.animateInternal.apply(this,e)}animateInternal(t){let e,i=arguments.length;i>1&&"function"==typeof arguments[i-1]&&(e=arguments[i-1],--i);let n=0;for(;n<i&&!this.isDef();++n){const t=arguments[n];t.center&&this.setCenterInternal(t.center),void 0!==t.zoom?this.setZoom(t.zoom):t.resolution&&this.setResolution(t.resolution),void 0!==t.rotation&&this.setRotation(t.rotation)}if(n===i)return void(e&&In(e,!0));let r=Date.now(),s=this.targetCenter_.slice(),o=this.targetResolution_,a=this.targetRotation_;const h=[];for(;n<i;++n){const t=arguments[n],i={start:r,complete:!1,anchor:t.anchor,duration:void 0!==t.duration?t.duration:1e3,easing:t.easing||Pi,callback:e};if(t.center&&(i.sourceCenter=s,i.targetCenter=t.center.slice(),s=i.targetCenter),void 0!==t.zoom?(i.sourceResolution=o,i.targetResolution=this.getResolutionForZoom(t.zoom),o=i.targetResolution):t.resolution&&(i.sourceResolution=o,i.targetResolution=t.resolution,o=i.targetResolution),void 0!==t.rotation){i.sourceRotation=a;const e=Ht(t.rotation-a+Math.PI,2*Math.PI)-Math.PI;i.targetRotation=a+e,a=i.targetRotation}An(i)?i.complete=!0:r+=i.duration,h.push(i)}this.animations_.push(h),this.setHint(0,1),this.updateAnimations_()}getAnimating(){return this.hints_[0]>0}getInteracting(){return this.hints_[1]>0}cancelAnimations(){let t;this.setHint(0,-this.hints_[0]);for(let e=0,i=this.animations_.length;e<i;++e){const i=this.animations_[e];if(i[0].callback&&In(i[0].callback,!1),!t)for(let e=0,n=i.length;e<n;++e){const n=i[e];if(!n.complete){t=n.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=t,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN}updateAnimations_(){if(void 0!==this.updateAnimationKey_&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),!this.getAnimating())return;const t=Date.now();let e=!1;for(let i=this.animations_.length-1;i>=0;--i){const n=this.animations_[i];let r=!0;for(let i=0,s=n.length;i<s;++i){const s=n[i];if(s.complete)continue;const o=t-s.start;let a=s.duration>0?o/s.duration:1;a>=1?(s.complete=!0,a=1):r=!1;const h=s.easing(a);if(s.sourceCenter){const t=s.sourceCenter[0],e=s.sourceCenter[1],i=s.targetCenter[0],n=s.targetCenter[1];this.nextCenter_=s.targetCenter;const r=t+h*(i-t),o=e+h*(n-e);this.targetCenter_=[r,o]}if(s.sourceResolution&&s.targetResolution){const t=1===h?s.targetResolution:s.sourceResolution+h*(s.targetResolution-s.sourceResolution);if(s.anchor){const e=this.getViewportSize_(this.getRotation()),i=this.constraints_.resolution(t,0,e,!0);this.targetCenter_=this.calculateCenterZoom(i,s.anchor)}this.nextResolution_=s.targetResolution,this.targetResolution_=t,this.applyTargetState_(!0)}if(void 0!==s.sourceRotation&&void 0!==s.targetRotation){const t=1===h?Ht(s.targetRotation+Math.PI,2*Math.PI)-Math.PI:s.sourceRotation+h*(s.targetRotation-s.sourceRotation);if(s.anchor){const e=this.constraints_.rotation(t,!0);this.targetCenter_=this.calculateCenterRotate(e,s.anchor)}this.nextRotation_=s.targetRotation,this.targetRotation_=t}if(this.applyTargetState_(!0),e=!0,!s.complete)break}if(r){this.animations_[i]=null,this.setHint(0,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;const t=n[0].callback;t&&In(t,!0)}}this.animations_=this.animations_.filter(Boolean),e&&void 0===this.updateAnimationKey_&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}calculateCenterRotate(t,e){let i;const n=this.getCenterInternal();var r,s;return void 0!==n&&(i=[n[0]-e[0],n[1]-e[1]],Ze(i,t-this.getRotation()),s=e,(r=i)[0]+=+s[0],r[1]+=+s[1]),i}calculateCenterZoom(t,e){let i;const n=this.getCenterInternal(),r=this.getResolution();return void 0!==n&&void 0!==r&&(i=[e[0]-t*(e[0]-n[0])/r,e[1]-t*(e[1]-n[1])/r]),i}getViewportSize_(t){const e=this.viewportSize_;if(t){const i=e[0],n=e[1];return[Math.abs(i*Math.cos(t))+Math.abs(n*Math.sin(t)),Math.abs(i*Math.sin(t))+Math.abs(n*Math.cos(t))]}return e}setViewportSize(t){this.viewportSize_=Array.isArray(t)?t.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)}getCenter(){const t=this.getCenterInternal();return t?mi(t,this.getProjection()):t}getCenterInternal(){return this.get(Ie.CENTER)}getConstraints(){return this.constraints_}getConstrainResolution(){return this.get("constrainResolution")}getHints(t){return void 0!==t?(t[0]=this.hints_[0],t[1]=this.hints_[1],t):this.hints_.slice()}calculateExtent(t){return _i(this.calculateExtentInternal(t),this.getProjection())}calculateExtentInternal(t){t=t||this.getViewportSizeMinusPadding_();const e=this.getCenterInternal();K(e,"The view center is not defined");const i=this.getResolution();K(void 0!==i,"The view resolution is not defined");const n=this.getRotation();return K(void 0!==n,"The view rotation is not defined"),St(e,i,n,t)}getMaxResolution(){return this.maxResolution_}getMinResolution(){return this.minResolution_}getMaxZoom(){return this.getZoomForResolution(this.minResolution_)}setMaxZoom(t){this.applyOptions_(this.getUpdatedOptions_({maxZoom:t}))}getMinZoom(){return this.getZoomForResolution(this.maxResolution_)}setMinZoom(t){this.applyOptions_(this.getUpdatedOptions_({minZoom:t}))}setConstrainResolution(t){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:t}))}getProjection(){return this.projection_}getResolution(){return this.get(Ie.RESOLUTION)}getResolutions(){return this.resolutions_}getResolutionForExtent(t,e){return this.getResolutionForExtentInternal(wi(t,this.getProjection()),e)}getResolutionForExtentInternal(t,e){e=e||this.getViewportSizeMinusPadding_();const i=Rt(t)/e[0],n=Ct(t)/e[1];return Math.max(i,n)}getResolutionForValueFunction(t){t=t||2;const e=this.getConstrainedResolution(this.maxResolution_),i=this.minResolution_,n=Math.log(e/i)/Math.log(t);return function(i){return e/Math.pow(t,i*n)}}getRotation(){return this.get(Ie.ROTATION)}getValueForResolutionFunction(t){const e=Math.log(t||2),i=this.getConstrainedResolution(this.maxResolution_),n=this.minResolution_,r=Math.log(i/n)/e;return function(t){return Math.log(i/t)/e/r}}getViewportSizeMinusPadding_(t){let e=this.getViewportSize_(t);const i=this.padding_;return i&&(e=[e[0]-i[1]-i[3],e[1]-i[0]-i[2]]),e}getState(){const t=this.getProjection(),e=this.getResolution(),i=this.getRotation();let n=this.getCenterInternal();const r=this.padding_;if(r){const t=this.getViewportSizeMinusPadding_();n=Tn(n,this.getViewportSize_(),[t[0]/2+r[3],t[1]/2+r[0]],e,i)}return{center:n.slice(0),projection:void 0!==t?t:null,resolution:e,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:i,zoom:this.getZoom()}}getViewStateAndExtent(){return{viewState:this.getState(),extent:this.calculateExtent()}}getZoom(){let t;const e=this.getResolution();return void 0!==e&&(t=this.getZoomForResolution(e)),t}getZoomForResolution(t){let e,i,n=this.minZoom_||0;if(this.resolutions_){const r=h(this.resolutions_,t,1);n=r,e=this.resolutions_[r],i=r==this.resolutions_.length-1?2:e/this.resolutions_[r+1]}else e=this.maxResolution_,i=this.zoomFactor_;return n+Math.log(e/t)/Math.log(i)}getResolutionForZoom(t){if(this.resolutions_){if(this.resolutions_.length<=1)return 0;const e=qt(Math.floor(t),0,this.resolutions_.length-2),i=this.resolutions_[e]/this.resolutions_[e+1];return this.resolutions_[e]/Math.pow(i,qt(t-e,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,t-this.minZoom_)}fit(t,e){let i;if(K(Array.isArray(t)||"function"==typeof t.getSimplifiedGeometry,"Invalid extent or geometry provided as `geometry`"),Array.isArray(t))K(!Dt(t),"Cannot fit empty extent provided as `geometry`"),i=Cn(wi(t,this.getProjection()));else if("Circle"===t.getType()){const e=wi(t.getExtent(),this.getProjection());i=Cn(e),i.rotate(this.getRotation(),Mt(e))}else{const e=gi();i=e?t.clone().transform(e,this.getProjection()):t}this.fitInternal(i,e)}rotatedExtentForGeometry(t){const e=this.getRotation(),i=Math.cos(e),n=Math.sin(-e),r=t.getFlatCoordinates(),s=t.getStride();let o=1/0,a=1/0,h=-1/0,l=-1/0;for(let t=0,e=r.length;t<e;t+=s){const e=r[t]*i-r[t+1]*n,s=r[t]*n+r[t+1]*i;o=Math.min(o,e),a=Math.min(a,s),h=Math.max(h,e),l=Math.max(l,s)}return[o,a,h,l]}fitInternal(t,e){let i=(e=e||{}).size;i||(i=this.getViewportSizeMinusPadding_());const n=void 0!==e.padding?e.padding:[0,0,0,0],r=void 0!==e.nearest&&e.nearest;let s;s=void 0!==e.minResolution?e.minResolution:void 0!==e.maxZoom?this.getResolutionForZoom(e.maxZoom):0;const o=this.rotatedExtentForGeometry(t);let a=this.getResolutionForExtentInternal(o,[i[0]-n[1]-n[3],i[1]-n[0]-n[2]]);a=isNaN(a)?s:Math.max(a,s),a=this.getConstrainedResolution(a,r?0:1);const h=this.getRotation(),l=Math.sin(h),c=Math.cos(h),u=Mt(o);u[0]+=(n[1]-n[3])/2*a,u[1]+=(n[0]-n[2])/2*a;const d=u[0]*c-u[1]*l,f=u[1]*c+u[0]*l,m=this.getConstrainedCenter([d,f],a),p=e.callback?e.callback:g;void 0!==e.duration?this.animateInternal({resolution:a,center:m,duration:e.duration,easing:e.easing},p):(this.targetResolution_=a,this.targetCenter_=m,this.applyTargetState_(!1,!0),In(p,!0))}centerOn(t,e,i){this.centerOnInternal(pi(t,this.getProjection()),e,i)}centerOnInternal(t,e,i){this.setCenterInternal(Tn(t,e,i,this.getResolution(),this.getRotation()))}calculateCenterShift(t,e,i,n){let r;const s=this.padding_;if(s&&t){const o=this.getViewportSizeMinusPadding_(-i),a=Tn(t,n,[o[0]/2+s[3],o[1]/2+s[0]],e,i);r=[t[0]-a[0],t[1]-a[1]]}return r}isDef(){return!!this.getCenterInternal()&&void 0!==this.getResolution()}adjustCenter(t){const e=mi(this.targetCenter_,this.getProjection());this.setCenter([e[0]+t[0],e[1]+t[1]])}adjustCenterInternal(t){const e=this.targetCenter_;this.setCenterInternal([e[0]+t[0],e[1]+t[1]])}adjustResolution(t,e){e=e&&pi(e,this.getProjection()),this.adjustResolutionInternal(t,e)}adjustResolutionInternal(t,e){const i=this.getAnimating()||this.getInteracting(),n=this.getViewportSize_(this.getRotation()),r=this.constraints_.resolution(this.targetResolution_*t,0,n,i);e&&(this.targetCenter_=this.calculateCenterZoom(r,e)),this.targetResolution_*=t,this.applyTargetState_()}adjustZoom(t,e){this.adjustResolution(Math.pow(this.zoomFactor_,-t),e)}adjustRotation(t,e){e&&(e=pi(e,this.getProjection())),this.adjustRotationInternal(t,e)}adjustRotationInternal(t,e){const i=this.getAnimating()||this.getInteracting(),n=this.constraints_.rotation(this.targetRotation_+t,i);e&&(this.targetCenter_=this.calculateCenterRotate(n,e)),this.targetRotation_+=t,this.applyTargetState_()}setCenter(t){this.setCenterInternal(t?pi(t,this.getProjection()):t)}setCenterInternal(t){this.targetCenter_=t,this.applyTargetState_()}setHint(t,e){return this.hints_[t]+=e,this.changed(),this.hints_[t]}setResolution(t){this.targetResolution_=t,this.applyTargetState_()}setRotation(t){this.targetRotation_=t,this.applyTargetState_()}setZoom(t){this.setResolution(this.getResolutionForZoom(t))}applyTargetState_(t,e){const i=this.getAnimating()||this.getInteracting()||e,n=this.constraints_.rotation(this.targetRotation_,i),r=this.getViewportSize_(n),s=this.constraints_.resolution(this.targetResolution_,0,r,i),o=this.constraints_.center(this.targetCenter_,s,r,i,this.calculateCenterShift(this.targetCenter_,s,n,r));this.get(Ie.ROTATION)!==n&&this.set(Ie.ROTATION,n),this.get(Ie.RESOLUTION)!==s&&(this.set(Ie.RESOLUTION,s),this.set("zoom",this.getZoom(),!0)),o&&this.get(Ie.CENTER)&&We(this.get(Ie.CENTER),o)||this.set(Ie.CENTER,o),this.getAnimating()&&!t&&this.cancelAnimations(),this.cancelAnchor_=void 0}resolveConstraints(t,e,i){t=void 0!==t?t:200;const n=e||0,r=this.constraints_.rotation(this.targetRotation_),s=this.getViewportSize_(r),o=this.constraints_.resolution(this.targetResolution_,n,s),a=this.constraints_.center(this.targetCenter_,o,s,!1,this.calculateCenterShift(this.targetCenter_,o,r,s));if(0===t&&!this.cancelAnchor_)return this.targetResolution_=o,this.targetRotation_=r,this.targetCenter_=a,void this.applyTargetState_();i=i||(0===t?this.cancelAnchor_:void 0),this.cancelAnchor_=void 0,this.getResolution()===o&&this.getRotation()===r&&this.getCenterInternal()&&We(this.getCenterInternal(),a)||(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:r,center:a,resolution:o,duration:t,easing:Ri,anchor:i}))}beginInteraction(){this.resolveConstraints(0),this.setHint(1,1)}endInteraction(t,e,i){i=i&&pi(i,this.getProjection()),this.endInteractionInternal(t,e,i)}endInteractionInternal(t,e,i){this.getInteracting()&&(this.setHint(1,-1),this.resolveConstraints(t,e,i))}getConstrainedCenter(t,e){const i=this.getViewportSize_(this.getRotation());return this.constraints_.center(t,e||this.getResolution(),i)}getConstrainedZoom(t,e){const i=this.getResolutionForZoom(t);return this.getZoomForResolution(this.getConstrainedResolution(i,e))}getConstrainedResolution(t,e){e=e||0;const i=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(t,e,i)}};function Pn(t,e){if(!t.visible)return!1;const i=e.resolution;if(i<t.minResolution||i>=t.maxResolution)return!1;const n=e.zoom;return n>t.minZoom&&n<=t.maxZoom}const Dn=class extends Me{constructor(t){const e=Object.assign({},t);delete e.source,super(e),this.on,this.once,this.un,this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,this.renderer_=null,this.sourceReady_=!1,this.rendered=!1,t.render&&(this.render=t.render),t.map&&this.setMap(t.map),this.addChangeListener(xe,this.handleSourcePropertyChange_);const i=t.source?t.source:null;this.setSource(i)}getLayersArray(t){return(t=t||[]).push(this),t}getLayerStatesArray(t){return(t=t||[]).push(this.getLayerState()),t}getSource(){return this.get(xe)||null}getRenderSource(){return this.getSource()}getSourceState(){const t=this.getSource();return t?t.getState():"undefined"}handleSourceChange_(){this.changed(),this.sourceReady_||"ready"!==this.getSource().getState()||(this.sourceReady_=!0,this.dispatchEvent("sourceready"))}handleSourcePropertyChange_(){this.sourceChangeKey_&&(I(this.sourceChangeKey_),this.sourceChangeKey_=null),this.sourceReady_=!1;const t=this.getSource();t&&(this.sourceChangeKey_=k(t,y,this.handleSourceChange_,this),"ready"===t.getState()&&(this.sourceReady_=!0,setTimeout((()=>{this.dispatchEvent("sourceready")}),0))),this.changed()}getFeatures(t){return this.renderer_?this.renderer_.getFeatures(t):Promise.resolve([])}getData(t){return this.renderer_&&this.rendered?this.renderer_.getData(t):null}isVisible(t){let e;const i=this.getMapInternal();let n;!t&&i&&(t=i.getView()),e=t instanceof Rn?{viewState:t.getState(),extent:t.calculateExtent()}:t,!e.layerStatesArray&&i&&(e.layerStatesArray=i.getLayerGroup().getLayerStatesArray()),n=e.layerStatesArray?e.layerStatesArray.find((t=>t.layer===this)):this.getLayerState();const r=this.getExtent();return Pn(n,e.viewState)&&(!r||Pt(r,e.extent))}getAttributions(t){if(!this.isVisible(t))return[];let e;const i=this.getSource();if(i&&(e=i.getAttributions()),!e)return[];let n=e(t instanceof Rn?t.getViewStateAndExtent():t);return Array.isArray(n)||(n=[n]),n}render(t,e){const i=this.getRenderer();return i.prepareFrame(t)?(this.rendered=!0,i.renderFrame(t,e)):null}unrender(){this.rendered=!1}setMapInternal(t){t||this.unrender(),this.set("map",t)}getMapInternal(){return this.get("map")}setMap(t){this.mapPrecomposeKey_&&(I(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),t||this.changed(),this.mapRenderKey_&&(I(this.mapRenderKey_),this.mapRenderKey_=null),t&&(this.mapPrecomposeKey_=k(t,ke,(function(t){const e=t.frameState.layerStatesArray,i=this.getLayerState(!1);K(!e.some((function(t){return t.layer===i.layer})),"A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both."),e.push(i)}),this),this.mapRenderKey_=k(this,y,t.render,t),this.changed())}setSource(t){this.set(xe,t)}getRenderer(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_}hasRenderer(){return!!this.renderer_}createRenderer(){return null}disposeInternal(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_),this.setSource(null),super.disposeInternal()}};function Fn(t,e){fe.expire()}const Ln=class extends o{constructor(t){super(),this.map_=t}dispatchRenderEvent(t,e){R()}calculateMatrices2D(t){const e=t.viewState,i=t.coordinateToPixelTransform,n=t.pixelToCoordinateTransform;$(i,t.size[0]/2,t.size[1]/2,1/e.resolution,-1/e.resolution,-e.rotation,-e.center[0],-e.center[1]),J(n,i)}forEachFeatureAtCoordinate(t,e,i,n,r,s,o,a){let h;const l=e.viewState;function c(t,e,i,n){return r.call(s,e,t?i:null,n)}const u=l.projection,d=Ke(t.slice(),u),f=[[0,0]];if(u.canWrapX()&&n){const t=Rt(u.getExtent());f.push([-t,0],[t,0])}const g=e.layerStatesArray,m=g.length,p=[],_=[];for(let n=0;n<f.length;n++)for(let r=m-1;r>=0;--r){const s=g[r],u=s.layer;if(u.hasRenderer()&&Pn(s,l)&&o.call(a,u)){const r=u.getRenderer(),o=u.getSource();if(r&&o){const a=o.getWrapX()?d:t,l=c.bind(null,s.managed);_[0]=a[0]+f[n][0],_[1]=a[1]+f[n][1],h=r.forEachFeatureAtCoordinate(_,e,i,l,p)}if(h)return h}}if(0===p.length)return;const w=1/p.length;return p.forEach(((t,e)=>t.distanceSq+=e*w)),p.sort(((t,e)=>t.distanceSq-e.distanceSq)),p.some((t=>h=t.callback(t.feature,t.layer,t.geometry))),h}hasFeatureAtCoordinate(t,e,i,n,r,s){return void 0!==this.forEachFeatureAtCoordinate(t,e,i,n,d,this,r,s)}getMap(){return this.map_}renderFrame(t){R()}flushDeclutterItems(t){}scheduleExpireIconCache(t){fe.canExpireCache()&&t.postRenderFunctions.push(Fn)}},On=class extends r{constructor(t,e,i,n){super(t),this.inversePixelTransform=e,this.frameState=i,this.context=n}},Nn="ol-hidden",Bn="ol-unselectable",zn="ol-control",Un="ol-collapsed",Gn=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))","?\\s*([-,\\\"\\'\\sa-z]+?)\\s*$"].join(""),"i"),Yn=["style","variant","weight","size","lineHeight","family"],Xn=function(t){const e=t.match(Gn);if(!e)return null;const i={lineHeight:"normal",size:"1.2em",style:"normal",weight:"normal",variant:"normal"};for(let t=0,n=Yn.length;t<n;++t){const n=e[t+1];void 0!==n&&(i[Yn[t]]=n)}return i.families=i.family.split(/,\s?/),i};function Vn(t,e,i,n){let r;return r=i&&i.length?i.shift():q?new OffscreenCanvas(t||300,e||300):document.createElement("canvas"),t&&(r.width=t),e&&(r.height=e),r.getContext("2d",n)}function jn(t){const e=t.canvas;e.width=1,e.height=1,t.clearRect(0,0,1,1)}function qn(t,e){const i=e.parentNode;i&&i.replaceChild(t,e)}function Wn(t){return t&&t.parentNode?t.parentNode.removeChild(t):null}const Zn="10px sans-serif",Kn="#000",Hn="round",$n=[],Jn="round",Qn="#000",tr="center",er="middle",ir=[0,0,0,0],nr=new L;let rr,sr=null;const or={},ar=function(){const t="32px ",e=["monospace","serif"],i=e.length,n="wmytzilWMYTZIL@#/&?$%10";let r,s;function o(r,o,a){let h=!0;for(let l=0;l<i;++l){const i=e[l];if(s=cr(r+" "+o+" "+t+i,n),a!=i){const e=cr(r+" "+o+" "+t+a+","+i,n);h=h&&e!=s}}return!!h}function a(){let t=!0;const e=nr.getKeys();for(let i=0,n=e.length;i<n;++i){const n=e[i];nr.get(n)<100&&(o.apply(this,n.split("\n"))?(p(or),sr=null,rr=void 0,nr.set(n,100)):(nr.set(n,nr.get(n)+1,!0),t=!1))}t&&(clearInterval(r),r=void 0)}return function(t){const e=Xn(t);if(!e)return;const i=e.families;for(let t=0,n=i.length;t<n;++t){const n=i[t],s=e.style+"\n"+e.weight+"\n"+n;void 0===nr.get(s)&&(nr.set(s,100,!0),o(e.style,e.weight,n)||(nr.set(s,0,!0),void 0===r&&(r=setInterval(a,32))))}}}(),hr=function(){let t;return function(e){let i=or[e];if(null==i){if(q){const t=Xn(e),n=lr(e,"Žg");i=(isNaN(Number(t.lineHeight))?1.2:Number(t.lineHeight))*(n.actualBoundingBoxAscent+n.actualBoundingBoxDescent)}else t||(t=document.createElement("div"),t.innerHTML="M",t.style.minHeight="0",t.style.maxHeight="none",t.style.height="auto",t.style.padding="0",t.style.border="none",t.style.position="absolute",t.style.display="block",t.style.left="-99999px"),t.style.font=e,document.body.appendChild(t),i=t.offsetHeight,document.body.removeChild(t);or[e]=i}return i}}();function lr(t,e){return sr||(sr=Vn(1,1)),t!=rr&&(sr.font=t,rr=sr.font),sr.measureText(e)}function cr(t,e){return lr(t,e).width}function ur(t,e,i){if(e in i)return i[e];const n=e.split("\n").reduce(((e,i)=>Math.max(e,cr(t,i))),0);return i[e]=n,n}const dr=class extends Ln{constructor(t){super(t),this.fontChangeListenerKey_=k(nr,s,t.redrawText.bind(t)),this.element_=document.createElement("div");const e=this.element_.style;e.position="absolute",e.width="100%",e.height="100%",e.zIndex="0",this.element_.className=Bn+" ol-layers";const i=t.getViewport();i.insertBefore(this.element_,i.firstChild||null),this.children_=[],this.renderedVisible_=!0,this.declutterLayers_=[]}dispatchRenderEvent(t,e){const i=this.getMap();if(i.hasListener(t)){const n=new On(t,void 0,e);i.dispatchEvent(n)}}disposeInternal(){I(this.fontChangeListenerKey_),this.element_.parentNode.removeChild(this.element_),super.disposeInternal()}renderFrame(t){if(!t)return void(this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1));this.calculateMatrices2D(t),this.dispatchRenderEvent(ke,t);const e=t.layerStatesArray.sort((function(t,e){return t.zIndex-e.zIndex})),i=t.viewState;this.children_.length=0;const n=this.declutterLayers_;n.length=0;let r=null;for(let s=0,o=e.length;s<o;++s){const o=e[s];t.layerIndex=s;const a=o.layer,h=a.getSourceState();if(!Pn(o,i)||"ready"!=h&&"undefined"!=h){a.unrender();continue}const l=a.render(t,r);l&&(l!==r&&(this.children_.push(l),r=l),"getDeclutter"in a&&n.push(a))}this.flushDeclutterItems(t),function(t,e){const i=t.childNodes;for(let n=0;;++n){const r=i[n],s=e[n];if(!r&&!s)break;r!==s&&(r?s?t.insertBefore(s,r):(t.removeChild(r),--n):t.appendChild(s))}}(this.element_,this.children_),this.dispatchRenderEvent("postcompose",t),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(t)}flushDeclutterItems(t){const e=this.declutterLayers_;for(let i=e.length-1;i>=0;--i)e[i].renderDeclutter(t);e.length=0}};class fr extends r{constructor(t,e){super(t),this.layer=e}}const gr="layers";class mr extends Me{constructor(t){t=t||{};const e=Object.assign({},t);delete e.layers;let i=t.layers;super(e),this.on,this.once,this.un,this.layersListenerKeys_=[],this.listenerKeys_={},this.addChangeListener(gr,this.handleLayersChanged_),i?Array.isArray(i)?i=new U(i.slice(),{unique:!0}):K("function"==typeof i.getArray,"Expected `layers` to be an array or a `Collection`"):i=new U(void 0,{unique:!0}),this.setLayers(i)}handleLayerChange_(){this.changed()}handleLayersChanged_(){this.layersListenerKeys_.forEach(I),this.layersListenerKeys_.length=0;const t=this.getLayers();this.layersListenerKeys_.push(k(t,O,this.handleLayersAdd_,this),k(t,N,this.handleLayersRemove_,this));for(const t in this.listenerKeys_)this.listenerKeys_[t].forEach(I);p(this.listenerKeys_);const e=t.getArray();for(let t=0,i=e.length;t<i;t++){const i=e[t];this.registerLayerListeners_(i),this.dispatchEvent(new fr("addlayer",i))}this.changed()}registerLayerListeners_(t){const e=[k(t,s,this.handleLayerChange_,this),k(t,y,this.handleLayerChange_,this)];t instanceof mr&&e.push(k(t,"addlayer",this.handleLayerGroupAdd_,this),k(t,"removelayer",this.handleLayerGroupRemove_,this)),this.listenerKeys_[D(t)]=e}handleLayerGroupAdd_(t){this.dispatchEvent(new fr("addlayer",t.layer))}handleLayerGroupRemove_(t){this.dispatchEvent(new fr("removelayer",t.layer))}handleLayersAdd_(t){const e=t.element;this.registerLayerListeners_(e),this.dispatchEvent(new fr("addlayer",e)),this.changed()}handleLayersRemove_(t){const e=t.element,i=D(e);this.listenerKeys_[i].forEach(I),delete this.listenerKeys_[i],this.dispatchEvent(new fr("removelayer",e)),this.changed()}getLayers(){return this.get(gr)}setLayers(t){const e=this.getLayers();if(e){const t=e.getArray();for(let e=0,i=t.length;e<i;++e)this.dispatchEvent(new fr("removelayer",t[e]))}this.set(gr,t)}getLayersArray(t){return t=void 0!==t?t:[],this.getLayers().forEach((function(e){e.getLayersArray(t)})),t}getLayerStatesArray(t){const e=void 0!==t?t:[],i=e.length;this.getLayers().forEach((function(t){t.getLayerStatesArray(e)}));const n=this.getLayerState();let r=n.zIndex;t||void 0!==n.zIndex||(r=0);for(let t=i,s=e.length;t<s;t++){const i=e[t];i.opacity*=n.opacity,i.visible=i.visible&&n.visible,i.maxResolution=Math.min(i.maxResolution,n.maxResolution),i.minResolution=Math.max(i.minResolution,n.minResolution),i.minZoom=Math.max(i.minZoom,n.minZoom),i.maxZoom=Math.min(i.maxZoom,n.maxZoom),void 0!==n.extent&&(void 0!==i.extent?i.extent=It(i.extent,n.extent):i.extent=n.extent),void 0===i.zIndex&&(i.zIndex=r)}return e}getSourceState(){return"ready"}}const pr=mr,_r=class extends r{constructor(t,e,i){super(t),this.map=e,this.frameState=void 0!==i?i:null}},wr=class extends _r{constructor(t,e,i,n,r,s){super(t,e,r),this.originalEvent=i,this.pixel_=null,this.coordinate_=null,this.dragging=void 0!==n&&n,this.activePointers=s}get pixel(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_}set pixel(t){this.pixel_=t}get coordinate(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_}set coordinate(t){this.coordinate_=t}preventDefault(){super.preventDefault(),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()}stopPropagation(){super.stopPropagation(),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()}},yr={SINGLECLICK:"singleclick",CLICK:b,DBLCLICK:"dblclick",POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},vr="pointerdown",br=class extends w{constructor(t,e){super(t),this.map_=t,this.clickTimeoutId_,this.emulateClicks_=!1,this.dragging_=!1,this.dragListenerKeys_=[],this.moveTolerance_=void 0===e?1:e,this.down_=null;const i=this.map_.getViewport();this.activePointers_=[],this.trackedTouches_={},this.element_=i,this.pointerdownListenerKey_=k(i,vr,this.handlePointerDown_,this),this.originalPointerMoveEvent_,this.relayedListenerKey_=k(i,"pointermove",this.relayMoveEvent_,this),this.boundHandleTouchMove_=this.handleTouchMove_.bind(this),this.element_.addEventListener(E,this.boundHandleTouchMove_,!!Z&&{passive:!1})}emulateClick_(t){let e=new wr(yr.CLICK,this.map_,t);this.dispatchEvent(e),void 0!==this.clickTimeoutId_?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,e=new wr(yr.DBLCLICK,this.map_,t),this.dispatchEvent(e)):this.clickTimeoutId_=setTimeout((()=>{this.clickTimeoutId_=void 0;const e=new wr(yr.SINGLECLICK,this.map_,t);this.dispatchEvent(e)}),250)}updateActivePointers_(t){const e=t,i=e.pointerId;if(e.type==yr.POINTERUP||e.type==yr.POINTERCANCEL){delete this.trackedTouches_[i];for(const t in this.trackedTouches_)if(this.trackedTouches_[t].target!==e.target){delete this.trackedTouches_[t];break}}else e.type!=yr.POINTERDOWN&&e.type!=yr.POINTERMOVE||(this.trackedTouches_[i]=e);this.activePointers_=Object.values(this.trackedTouches_)}handlePointerUp_(t){this.updateActivePointers_(t);const e=new wr(yr.POINTERUP,this.map_,t,void 0,void 0,this.activePointers_);this.dispatchEvent(e),this.emulateClicks_&&!e.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(t)&&this.emulateClick_(this.down_),0===this.activePointers_.length&&(this.dragListenerKeys_.forEach(I),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)}isMouseActionButton_(t){return 0===t.button}handlePointerDown_(t){this.emulateClicks_=0===this.activePointers_.length,this.updateActivePointers_(t);const e=new wr(yr.POINTERDOWN,this.map_,t,void 0,void 0,this.activePointers_);if(this.dispatchEvent(e),this.down_=new PointerEvent(t.type,t),Object.defineProperty(this.down_,"target",{writable:!1,value:t.target}),0===this.dragListenerKeys_.length){const t=this.map_.getOwnerDocument();this.dragListenerKeys_.push(k(t,yr.POINTERMOVE,this.handlePointerMove_,this),k(t,yr.POINTERUP,this.handlePointerUp_,this),k(this.element_,yr.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==t&&this.dragListenerKeys_.push(k(this.element_.getRootNode(),yr.POINTERUP,this.handlePointerUp_,this))}}handlePointerMove_(t){if(this.isMoving_(t)){this.updateActivePointers_(t),this.dragging_=!0;const e=new wr(yr.POINTERDRAG,this.map_,t,this.dragging_,void 0,this.activePointers_);this.dispatchEvent(e)}}relayMoveEvent_(t){this.originalPointerMoveEvent_=t;const e=!(!this.down_||!this.isMoving_(t));this.dispatchEvent(new wr(yr.POINTERMOVE,this.map_,t,e))}handleTouchMove_(t){const e=this.originalPointerMoveEvent_;e&&!e.defaultPrevented||"boolean"==typeof t.cancelable&&!0!==t.cancelable||t.preventDefault()}isMoving_(t){return this.dragging_||Math.abs(t.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(t.clientY-this.down_.clientY)>this.moveTolerance_}disposeInternal(){this.relayedListenerKey_&&(I(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(E,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(I(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(I),this.dragListenerKeys_.length=0,this.element_=null,super.disposeInternal()}},xr="postrender",Mr="loadstart",Er="loadend",Sr="layergroup",kr="size",Cr="target",Ir="view",Ar=1/0,Tr=class{constructor(t,e){this.priorityFunction_=t,this.keyFunction_=e,this.elements_=[],this.priorities_=[],this.queuedElements_={}}clear(){this.elements_.length=0,this.priorities_.length=0,p(this.queuedElements_)}dequeue(){const t=this.elements_,e=this.priorities_,i=t[0];1==t.length?(t.length=0,e.length=0):(t[0]=t.pop(),e[0]=e.pop(),this.siftUp_(0));const n=this.keyFunction_(i);return delete this.queuedElements_[n],i}enqueue(t){K(!(this.keyFunction_(t)in this.queuedElements_),"Tried to enqueue an `element` that was already added to the queue");const e=this.priorityFunction_(t);return e!=Ar&&(this.elements_.push(t),this.priorities_.push(e),this.queuedElements_[this.keyFunction_(t)]=!0,this.siftDown_(0,this.elements_.length-1),!0)}getCount(){return this.elements_.length}getLeftChildIndex_(t){return 2*t+1}getRightChildIndex_(t){return 2*t+2}getParentIndex_(t){return t-1>>1}heapify_(){let t;for(t=(this.elements_.length>>1)-1;t>=0;t--)this.siftUp_(t)}isEmpty(){return 0===this.elements_.length}isKeyQueued(t){return t in this.queuedElements_}isQueued(t){return this.isKeyQueued(this.keyFunction_(t))}siftUp_(t){const e=this.elements_,i=this.priorities_,n=e.length,r=e[t],s=i[t],o=t;for(;t<n>>1;){const r=this.getLeftChildIndex_(t),s=this.getRightChildIndex_(t),o=s<n&&i[s]<i[r]?s:r;e[t]=e[o],i[t]=i[o],t=o}e[t]=r,i[t]=s,this.siftDown_(o,t)}siftDown_(t,e){const i=this.elements_,n=this.priorities_,r=i[e],s=n[e];for(;e>t;){const t=this.getParentIndex_(e);if(!(n[t]>s))break;i[e]=i[t],n[e]=n[t],e=t}i[e]=r,n[e]=s}reprioritize(){const t=this.priorityFunction_,e=this.elements_,i=this.priorities_;let n=0;const r=e.length;let s,o,a;for(o=0;o<r;++o)s=e[o],a=t(s),a==Ar?delete this.queuedElements_[this.keyFunction_(s)]:(i[n]=a,e[n++]=s);e.length=n,i.length=n,this.heapify_()}},Rr=class extends Tr{constructor(t,e){super((function(e){return t.apply(null,e)}),(function(t){return t[0].getKey()})),this.boundHandleTileChange_=this.handleTileChange.bind(this),this.tileChangeCallback_=e,this.tilesLoading_=0,this.tilesLoadingKeys_={}}enqueue(t){const e=super.enqueue(t);return e&&t[0].addEventListener(y,this.boundHandleTileChange_),e}getTilesLoading(){return this.tilesLoading_}handleTileChange(t){const e=t.target,i=e.getState();if(2===i||3===i||4===i){3!==i&&e.removeEventListener(y,this.boundHandleTileChange_);const t=e.getKey();t in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[t],--this.tilesLoading_),this.tileChangeCallback_()}}loadMoreTiles(t,e){let i,n,r,s=0;for(;this.tilesLoading_<t&&s<e&&this.getCount()>0;)n=this.dequeue()[0],r=n.getKey(),i=n.getState(),0!==i||r in this.tilesLoadingKeys_||(this.tilesLoadingKeys_[r]=!0,++this.tilesLoading_,++s,n.load())}},Pr=class extends L{constructor(t){super();const e=t.element;!e||t.target||e.style.pointerEvents||(e.style.pointerEvents="auto"),this.element=e||null,this.target_=null,this.map_=null,this.listenerKeys=[],t.render&&(this.render=t.render),t.target&&this.setTarget(t.target)}disposeInternal(){Wn(this.element),super.disposeInternal()}getMap(){return this.map_}setMap(t){this.map_&&Wn(this.element);for(let t=0,e=this.listenerKeys.length;t<e;++t)I(this.listenerKeys[t]);this.listenerKeys.length=0,this.map_=t,t&&((this.target_?this.target_:t.getOverlayContainerStopEvent()).appendChild(this.element),this.render!==g&&this.listenerKeys.push(k(t,xr,this.render,this)),t.render())}render(t){}setTarget(t){this.target_="string"==typeof t?document.getElementById(t):t}},Dr=class extends Pr{constructor(t){t=t||{},super({element:document.createElement("div"),render:t.render,target:t.target}),this.ulElement_=document.createElement("ul"),this.collapsed_=void 0===t.collapsed||t.collapsed,this.userCollapsed_=this.collapsed_,this.overrideCollapsible_=void 0!==t.collapsible,this.collapsible_=void 0===t.collapsible||t.collapsible,this.collapsible_||(this.collapsed_=!1);const e=void 0!==t.className?t.className:"ol-attribution",i=void 0!==t.tipLabel?t.tipLabel:"Attributions",n=void 0!==t.expandClassName?t.expandClassName:e+"-expand",r=void 0!==t.collapseLabel?t.collapseLabel:"›",s=void 0!==t.collapseClassName?t.collapseClassName:e+"-collapse";"string"==typeof r?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=r,this.collapseLabel_.className=s):this.collapseLabel_=r;const o=void 0!==t.label?t.label:"i";"string"==typeof o?(this.label_=document.createElement("span"),this.label_.textContent=o,this.label_.className=n):this.label_=o;const a=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_;this.toggleButton_=document.createElement("button"),this.toggleButton_.setAttribute("type","button"),this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_)),this.toggleButton_.title=i,this.toggleButton_.appendChild(a),this.toggleButton_.addEventListener(b,this.handleClick_.bind(this),!1);const h=e+" "+Bn+" "+zn+(this.collapsed_&&this.collapsible_?" "+Un:"")+(this.collapsible_?"":" ol-uncollapsible"),l=this.element;l.className=h,l.appendChild(this.toggleButton_),l.appendChild(this.ulElement_),this.renderedAttributions_=[],this.renderedVisible_=!0}collectSourceAttributions_(t){const e=Array.from(new Set(this.getMap().getAllLayers().flatMap((e=>e.getAttributions(t))))),i=!this.getMap().getAllLayers().some((t=>t.getSource()&&!1===t.getSource().getAttributionsCollapsible()));return this.overrideCollapsible_||this.setCollapsible(i),e}updateElement_(t){if(!t)return void(this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1));const e=this.collectSourceAttributions_(t),i=e.length>0;if(this.renderedVisible_!=i&&(this.element.style.display=i?"":"none",this.renderedVisible_=i),!u(e,this.renderedAttributions_)){!function(t){for(;t.lastChild;)t.removeChild(t.lastChild)}(this.ulElement_);for(let t=0,i=e.length;t<i;++t){const i=document.createElement("li");i.innerHTML=e[t],this.ulElement_.appendChild(i)}this.renderedAttributions_=e}}handleClick_(t){t.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_}handleToggle_(){this.element.classList.toggle(Un),this.collapsed_?qn(this.collapseLabel_,this.label_):qn(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))}getCollapsible(){return this.collapsible_}setCollapsible(t){this.collapsible_!==t&&(this.collapsible_=t,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_())}setCollapsed(t){this.userCollapsed_=t,this.collapsible_&&this.collapsed_!==t&&this.handleToggle_()}getCollapsed(){return this.collapsed_}render(t){this.updateElement_(t.frameState)}},Fr=class extends Pr{constructor(t){t=t||{},super({element:document.createElement("div"),render:t.render,target:t.target});const e=void 0!==t.className?t.className:"ol-rotate",i=void 0!==t.label?t.label:"⇧",n=void 0!==t.compassClassName?t.compassClassName:"ol-compass";this.label_=null,"string"==typeof i?(this.label_=document.createElement("span"),this.label_.className=n,this.label_.textContent=i):(this.label_=i,this.label_.classList.add(n));const r=t.tipLabel?t.tipLabel:"Reset rotation",s=document.createElement("button");s.className=e+"-reset",s.setAttribute("type","button"),s.title=r,s.appendChild(this.label_),s.addEventListener(b,this.handleClick_.bind(this),!1);const o=e+" "+Bn+" "+zn,a=this.element;a.className=o,a.appendChild(s),this.callResetNorth_=t.resetNorth?t.resetNorth:void 0,this.duration_=void 0!==t.duration?t.duration:250,this.autoHide_=void 0===t.autoHide||t.autoHide,this.rotation_=void 0,this.autoHide_&&this.element.classList.add(Nn)}handleClick_(t){t.preventDefault(),void 0!==this.callResetNorth_?this.callResetNorth_():this.resetNorth_()}resetNorth_(){const t=this.getMap().getView();if(!t)return;const e=t.getRotation();void 0!==e&&(this.duration_>0&&e%(2*Math.PI)!=0?t.animate({rotation:0,duration:this.duration_,easing:Ri}):t.setRotation(0))}render(t){const e=t.frameState;if(!e)return;const i=e.viewState.rotation;if(i!=this.rotation_){const t="rotate("+i+"rad)";if(this.autoHide_){const t=this.element.classList.contains(Nn);t||0!==i?t&&0!==i&&this.element.classList.remove(Nn):this.element.classList.add(Nn)}this.label_.style.transform=t}this.rotation_=i}},Lr=class extends Pr{constructor(t){t=t||{},super({element:document.createElement("div"),target:t.target});const e=void 0!==t.className?t.className:"ol-zoom",i=void 0!==t.delta?t.delta:1,n=void 0!==t.zoomInClassName?t.zoomInClassName:e+"-in",r=void 0!==t.zoomOutClassName?t.zoomOutClassName:e+"-out",s=void 0!==t.zoomInLabel?t.zoomInLabel:"+",o=void 0!==t.zoomOutLabel?t.zoomOutLabel:"–",a=void 0!==t.zoomInTipLabel?t.zoomInTipLabel:"Zoom in",h=void 0!==t.zoomOutTipLabel?t.zoomOutTipLabel:"Zoom out",l=document.createElement("button");l.className=n,l.setAttribute("type","button"),l.title=a,l.appendChild("string"==typeof s?document.createTextNode(s):s),l.addEventListener(b,this.handleClick_.bind(this,i),!1);const c=document.createElement("button");c.className=r,c.setAttribute("type","button"),c.title=h,c.appendChild("string"==typeof o?document.createTextNode(o):o),c.addEventListener(b,this.handleClick_.bind(this,-i),!1);const u=e+" "+Bn+" "+zn,d=this.element;d.className=u,d.appendChild(l),d.appendChild(c),this.duration_=void 0!==t.duration?t.duration:250}handleClick_(t,e){e.preventDefault(),this.zoomByDelta_(t)}zoomByDelta_(t){const e=this.getMap().getView();if(!e)return;const i=e.getZoom();if(void 0!==i){const n=e.getConstrainedZoom(i+t);this.duration_>0?(e.getAnimating()&&e.cancelAnimations(),e.animate({zoom:n,duration:this.duration_,easing:Ri})):e.setZoom(n)}}},Or="active";function Nr(t,e,i,n){const r=t.getZoom();if(void 0===r)return;const s=t.getConstrainedZoom(r+e),o=t.getResolutionForZoom(s);t.getAnimating()&&t.cancelAnimations(),t.animate({resolution:o,anchor:i,duration:void 0!==n?n:250,easing:Ri})}const Br=class extends L{constructor(t){super(),this.on,this.once,this.un,t&&t.handleEvent&&(this.handleEvent=t.handleEvent),this.map_=null,this.setActive(!0)}getActive(){return this.get(Or)}getMap(){return this.map_}handleEvent(t){return!0}setActive(t){this.set(Or,t)}setMap(t){this.map_=t}},zr=class extends Br{constructor(t){super(),t=t||{},this.delta_=t.delta?t.delta:1,this.duration_=void 0!==t.duration?t.duration:250}handleEvent(t){let e=!1;if(t.type==yr.DBLCLICK){const i=t.originalEvent,n=t.map,r=t.coordinate,s=i.shiftKey?-this.delta_:this.delta_;Nr(n.getView(),s,r,this.duration_),i.preventDefault(),e=!0}return!e}};function Ur(t){const e=t.length;let i=0,n=0;for(let r=0;r<e;r++)i+=t[r].clientX,n+=t[r].clientY;return{clientX:i/e,clientY:n/e}}const Gr=class extends Br{constructor(t){super(t=t||{}),t.handleDownEvent&&(this.handleDownEvent=t.handleDownEvent),t.handleDragEvent&&(this.handleDragEvent=t.handleDragEvent),t.handleMoveEvent&&(this.handleMoveEvent=t.handleMoveEvent),t.handleUpEvent&&(this.handleUpEvent=t.handleUpEvent),t.stopDown&&(this.stopDown=t.stopDown),this.handlingDownUpSequence=!1,this.targetPointers=[]}getPointerCount(){return this.targetPointers.length}handleDownEvent(t){return!1}handleDragEvent(t){}handleEvent(t){if(!t.originalEvent)return!0;let e=!1;if(this.updateTrackedPointers_(t),this.handlingDownUpSequence){if(t.type==yr.POINTERDRAG)this.handleDragEvent(t),t.originalEvent.preventDefault();else if(t.type==yr.POINTERUP){const e=this.handleUpEvent(t);this.handlingDownUpSequence=e&&this.targetPointers.length>0}}else if(t.type==yr.POINTERDOWN){const i=this.handleDownEvent(t);this.handlingDownUpSequence=i,e=this.stopDown(i)}else t.type==yr.POINTERMOVE&&this.handleMoveEvent(t);return!e}handleMoveEvent(t){}handleUpEvent(t){return!1}stopDown(t){return t}updateTrackedPointers_(t){t.activePointers&&(this.targetPointers=t.activePointers)}};function Yr(t){const e=arguments;return function(t){let i=!0;for(let n=0,r=e.length;n<r&&(i=i&&e[n](t),i);++n);return i}}const Xr=function(t){const e=t.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},Vr=function(t){return!t.map.getTargetElement().hasAttribute("tabindex")||function(t){const e=t.map.getTargetElement(),i=t.map.getOwnerDocument().activeElement;return e.contains(i)}(t)},jr=d,qr=function(t){const e=t.originalEvent;return 0==e.button&&!(X&&V&&e.ctrlKey)},Wr=function(t){const e=t.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},Zr=function(t){const e=t.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},Kr=function(t){const e=t.originalEvent,i=e.target.tagName;return"INPUT"!==i&&"SELECT"!==i&&"TEXTAREA"!==i&&!e.target.isContentEditable},Hr=function(t){const e=t.originalEvent;return K(void 0!==e,"mapBrowserEvent must originate from a pointer event"),"mouse"==e.pointerType},$r=function(t){const e=t.originalEvent;return K(void 0!==e,"mapBrowserEvent must originate from a pointer event"),e.isPrimary&&0===e.button},Jr=class extends Gr{constructor(t){super({stopDown:f}),t=t||{},this.kinetic_=t.kinetic,this.lastCentroid=null,this.lastPointersCount_,this.panning_=!1;const e=t.condition?t.condition:Yr(Wr,$r);this.condition_=t.onFocusOnly?Yr(Vr,e):e,this.noKinetic_=!1}handleDragEvent(t){const e=t.map;this.panning_||(this.panning_=!0,e.getView().beginInteraction());const i=this.targetPointers,n=e.getEventPixel(Ur(i));if(i.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(n[0],n[1]),this.lastCentroid){const e=[this.lastCentroid[0]-n[0],n[1]-this.lastCentroid[1]],i=t.map.getView();r=e,s=i.getResolution(),r[0]*=s,r[1]*=s,Ze(e,i.getRotation()),i.adjustCenterInternal(e)}}else this.kinetic_&&this.kinetic_.begin();var r,s;this.lastCentroid=n,this.lastPointersCount_=i.length,t.originalEvent.preventDefault()}handleUpEvent(t){const e=t.map,i=e.getView();if(0===this.targetPointers.length){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){const t=this.kinetic_.getDistance(),n=this.kinetic_.getAngle(),r=i.getCenterInternal(),s=e.getPixelFromCoordinateInternal(r),o=e.getCoordinateFromPixelInternal([s[0]-t*Math.cos(n),s[1]-t*Math.sin(n)]);i.animateInternal({center:i.getConstrainedCenter(o),duration:500,easing:Ri})}return this.panning_&&(this.panning_=!1,i.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0}handleDownEvent(t){if(this.targetPointers.length>0&&this.condition_(t)){const e=t.map.getView();return this.lastCentroid=null,e.getAnimating()&&e.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1}},Qr=class extends Gr{constructor(t){t=t||{},super({stopDown:f}),this.condition_=t.condition?t.condition:Xr,this.lastAngle_=void 0,this.duration_=void 0!==t.duration?t.duration:250}handleDragEvent(t){if(!Hr(t))return;const e=t.map,i=e.getView();if(i.getConstraints().rotation===Ii)return;const n=e.getSize(),r=t.pixel,s=Math.atan2(n[1]/2-r[1],r[0]-n[0]/2);if(void 0!==this.lastAngle_){const t=s-this.lastAngle_;i.adjustRotationInternal(-t)}this.lastAngle_=s}handleUpEvent(t){return!Hr(t)||(t.map.getView().endInteraction(this.duration_),!1)}handleDownEvent(t){return!!Hr(t)&&(!(!qr(t)||!this.condition_(t))&&(t.map.getView().beginInteraction(),this.lastAngle_=void 0,!0))}},ts=class extends o{constructor(t){super(),this.geometry_=null,this.element_=document.createElement("div"),this.element_.style.position="absolute",this.element_.style.pointerEvents="auto",this.element_.className="ol-box "+t,this.map_=null,this.startPixel_=null,this.endPixel_=null}disposeInternal(){this.setMap(null)}render_(){const t=this.startPixel_,e=this.endPixel_,i="px",n=this.element_.style;n.left=Math.min(t[0],e[0])+i,n.top=Math.min(t[1],e[1])+i,n.width=Math.abs(e[0]-t[0])+i,n.height=Math.abs(e[1]-t[1])+i}setMap(t){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);const t=this.element_.style;t.left="inherit",t.top="inherit",t.width="inherit",t.height="inherit"}this.map_=t,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)}setPixels(t,e){this.startPixel_=t,this.endPixel_=e,this.createOrUpdateGeometry(),this.render_()}createOrUpdateGeometry(){const t=this.startPixel_,e=this.endPixel_,i=[t,[t[0],e[1]],e,[e[0],t[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);i[4]=i[0].slice(),this.geometry_?this.geometry_.setCoordinates([i]):this.geometry_=new kn([i])}getGeometry(){return this.geometry_}};class es extends r{constructor(t,e,i){super(t),this.coordinate=e,this.mapBrowserEvent=i}}const is=class extends Gr{constructor(t){super(),this.on,this.once,this.un,t=t||{},this.box_=new ts(t.className||"ol-dragbox"),this.minArea_=void 0!==t.minArea?t.minArea:64,t.onBoxEnd&&(this.onBoxEnd=t.onBoxEnd),this.startPixel_=null,this.condition_=t.condition?t.condition:qr,this.boxEndCondition_=t.boxEndCondition?t.boxEndCondition:this.defaultBoxEndCondition}defaultBoxEndCondition(t,e,i){const n=i[0]-e[0],r=i[1]-e[1];return n*n+r*r>=this.minArea_}getGeometry(){return this.box_.getGeometry()}handleDragEvent(t){this.box_.setPixels(this.startPixel_,t.pixel),this.dispatchEvent(new es("boxdrag",t.coordinate,t))}handleUpEvent(t){this.box_.setMap(null);const e=this.boxEndCondition_(t,this.startPixel_,t.pixel);return e&&this.onBoxEnd(t),this.dispatchEvent(new es(e?"boxend":"boxcancel",t.coordinate,t)),!1}handleDownEvent(t){return!!this.condition_(t)&&(this.startPixel_=t.pixel,this.box_.setMap(t.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new es("boxstart",t.coordinate,t)),!0)}onBoxEnd(t){}},ns=class extends is{constructor(t){super({condition:(t=t||{}).condition?t.condition:Zr,className:t.className||"ol-dragzoom",minArea:t.minArea}),this.duration_=void 0!==t.duration?t.duration:200,this.out_=void 0!==t.out&&t.out}onBoxEnd(t){const e=this.getMap().getView();let i=this.getGeometry();if(this.out_){const t=e.rotatedExtentForGeometry(i),n=e.getResolutionForExtentInternal(t),r=e.getResolution()/n;i=i.clone(),i.scale(r*r)}e.fitInternal(i,{duration:this.duration_,easing:Ri})}},rs="ArrowLeft",ss="ArrowRight",os="ArrowDown",as=class extends Br{constructor(t){super(),t=t||{},this.defaultCondition_=function(t){return Wr(t)&&Kr(t)},this.condition_=void 0!==t.condition?t.condition:this.defaultCondition_,this.duration_=void 0!==t.duration?t.duration:100,this.pixelDelta_=void 0!==t.pixelDelta?t.pixelDelta:128}handleEvent(t){let e=!1;if(t.type==x){const i=t.originalEvent,n=i.key;if(this.condition_(t)&&(n==os||n==rs||n==ss||"ArrowUp"==n)){const r=t.map.getView(),s=r.getResolution()*this.pixelDelta_;let o=0,a=0;n==os?a=-s:n==rs?o=-s:n==ss?o=s:a=s;const h=[o,a];Ze(h,r.getRotation()),function(t,e,i){const n=t.getCenterInternal();if(n){const r=[n[0]+e[0],n[1]+e[1]];t.animateInternal({duration:void 0!==i?i:250,easing:Di,center:t.getConstrainedCenter(r)})}}(r,h,this.duration_),i.preventDefault(),e=!0}}return!e}},hs=class extends Br{constructor(t){super(),t=t||{},this.condition_=t.condition?t.condition:function(t){return!function(t){const e=t.originalEvent;return V?e.metaKey:e.ctrlKey}(t)&&Kr(t)},this.delta_=t.delta?t.delta:1,this.duration_=void 0!==t.duration?t.duration:100}handleEvent(t){let e=!1;if(t.type==x||t.type==M){const i=t.originalEvent,n=i.key;if(this.condition_(t)&&("+"===n||"-"===n)){const r=t.map,s="+"===n?this.delta_:-this.delta_;Nr(r.getView(),s,void 0,this.duration_),i.preventDefault(),e=!0}}return!e}},ls=class{constructor(t,e,i){this.decay_=t,this.minVelocity_=e,this.delay_=i,this.points_=[],this.angle_=0,this.initialVelocity_=0}begin(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0}update(t,e){this.points_.push(t,e,Date.now())}end(){if(this.points_.length<6)return!1;const t=Date.now()-this.delay_,e=this.points_.length-3;if(this.points_[e+2]<t)return!1;let i=e-3;for(;i>0&&this.points_[i+2]>t;)i-=3;const n=this.points_[e+2]-this.points_[i+2];if(n<1e3/60)return!1;const r=this.points_[e]-this.points_[i],s=this.points_[e+1]-this.points_[i+1];return this.angle_=Math.atan2(s,r),this.initialVelocity_=Math.sqrt(r*r+s*s)/n,this.initialVelocity_>this.minVelocity_}getDistance(){return(this.minVelocity_-this.initialVelocity_)/this.decay_}getAngle(){return this.angle_}},cs=class extends Br{constructor(t){super(t=t||{}),this.totalDelta_=0,this.lastDelta_=0,this.maxDelta_=void 0!==t.maxDelta?t.maxDelta:1,this.duration_=void 0!==t.duration?t.duration:250,this.timeout_=void 0!==t.timeout?t.timeout:80,this.useAnchor_=void 0===t.useAnchor||t.useAnchor,this.constrainResolution_=void 0!==t.constrainResolution&&t.constrainResolution;const e=t.condition?t.condition:jr;this.condition_=t.onFocusOnly?Yr(Vr,e):e,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_,this.mode_=void 0,this.trackpadEventGap_=400,this.trackpadTimeoutId_,this.deltaPerZoom_=300}endInteraction_(){this.trackpadTimeoutId_=void 0;const t=this.getMap();t&&t.getView().endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_)}handleEvent(t){if(!this.condition_(t))return!0;if(t.type!==S)return!0;const e=t.map,i=t.originalEvent;let n;if(i.preventDefault(),this.useAnchor_&&(this.lastAnchor_=t.coordinate),t.type==S&&(n=i.deltaY,Y&&i.deltaMode===WheelEvent.DOM_DELTA_PIXEL&&(n/=j),i.deltaMode===WheelEvent.DOM_DELTA_LINE&&(n*=40)),0===n)return!1;this.lastDelta_=n;const r=Date.now();void 0===this.startTime_&&(this.startTime_=r),(!this.mode_||r-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(n)<4?"trackpad":"wheel");const s=e.getView();if("trackpad"===this.mode_&&!s.getConstrainResolution()&&!this.constrainResolution_)return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(s.getAnimating()&&s.cancelAnimations(),s.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),s.adjustZoom(-n/this.deltaPerZoom_,this.lastAnchor_),this.startTime_=r,!1;this.totalDelta_+=n;const o=Math.max(this.timeout_-(r-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,e),o),!1}handleWheelZoom_(t){const e=t.getView();e.getAnimating()&&e.cancelAnimations();let i=-qt(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(e.getConstrainResolution()||this.constrainResolution_)&&(i=i?i>0?1:-1:0),Nr(e,i,this.lastAnchor_,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0}setMouseAnchor(t){this.useAnchor_=t,t||(this.lastAnchor_=null)}},us=class extends Gr{constructor(t){const e=t=t||{};e.stopDown||(e.stopDown=f),super(e),this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.threshold_=void 0!==t.threshold?t.threshold:.3,this.duration_=void 0!==t.duration?t.duration:250}handleDragEvent(t){let e=0;const i=this.targetPointers[0],n=this.targetPointers[1],r=Math.atan2(n.clientY-i.clientY,n.clientX-i.clientX);if(void 0!==this.lastAngle_){const t=r-this.lastAngle_;this.rotationDelta_+=t,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),e=t}this.lastAngle_=r;const s=t.map,o=s.getView();o.getConstraints().rotation!==Ii&&(this.anchor_=s.getCoordinateFromPixelInternal(s.getEventPixel(Ur(this.targetPointers))),this.rotating_&&(s.render(),o.adjustRotationInternal(e,this.anchor_)))}handleUpEvent(t){return!(this.targetPointers.length<2)||(t.map.getView().endInteraction(this.duration_),!1)}handleDownEvent(t){if(this.targetPointers.length>=2){const e=t.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||e.getView().beginInteraction(),!0}return!1}},ds=class extends Gr{constructor(t){const e=t=t||{};e.stopDown||(e.stopDown=f),super(e),this.anchor_=null,this.duration_=void 0!==t.duration?t.duration:400,this.lastDistance_=void 0,this.lastScaleDelta_=1}handleDragEvent(t){let e=1;const i=this.targetPointers[0],n=this.targetPointers[1],r=i.clientX-n.clientX,s=i.clientY-n.clientY,o=Math.sqrt(r*r+s*s);void 0!==this.lastDistance_&&(e=this.lastDistance_/o),this.lastDistance_=o;const a=t.map,h=a.getView();1!=e&&(this.lastScaleDelta_=e),this.anchor_=a.getCoordinateFromPixelInternal(a.getEventPixel(Ur(this.targetPointers))),a.render(),h.adjustResolutionInternal(e,this.anchor_)}handleUpEvent(t){if(this.targetPointers.length<2){const e=t.map.getView(),i=this.lastScaleDelta_>1?1:-1;return e.endInteraction(this.duration_,i),!1}return!0}handleDownEvent(t){if(this.targetPointers.length>=2){const e=t.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||e.getView().beginInteraction(),!0}return!1}};function fs(t){return t[0]>0&&t[1]>0}function gs(t,e,i){return void 0===i&&(i=[0,0]),i[0]=t[0]*e+.5|0,i[1]=t[1]*e+.5|0,i}function ms(t,e){return Array.isArray(t)?t:(void 0===e?e=[t,t]:(e[0]=t,e[1]=t),e)}function ps(t){t instanceof Dn?t.setMapInternal(null):t instanceof pr&&t.getLayers().forEach(ps)}function _s(t,e){if(t instanceof Dn)t.setMapInternal(e);else if(t instanceof pr){const i=t.getLayers().getArray();for(let t=0,n=i.length;t<n;++t)_s(i[t],e)}}const ws=class extends L{constructor(t){super(),t=t||{},this.on,this.once,this.un;const e=function(t){let e=null;void 0!==t.keyboardEventTarget&&(e="string"==typeof t.keyboardEventTarget?document.getElementById(t.keyboardEventTarget):t.keyboardEventTarget);const i={},n=t.layers&&"function"==typeof t.layers.getLayers?t.layers:new pr({layers:t.layers});let r,s,o;return i[Sr]=n,i[Cr]=t.target,i[Ir]=t.view instanceof Rn?t.view:new Rn,void 0!==t.controls&&(Array.isArray(t.controls)?r=new U(t.controls.slice()):(K("function"==typeof t.controls.getArray,"Expected `controls` to be an array or an `ol/Collection.js`"),r=t.controls)),void 0!==t.interactions&&(Array.isArray(t.interactions)?s=new U(t.interactions.slice()):(K("function"==typeof t.interactions.getArray,"Expected `interactions` to be an array or an `ol/Collection.js`"),s=t.interactions)),void 0!==t.overlays?Array.isArray(t.overlays)?o=new U(t.overlays.slice()):(K("function"==typeof t.overlays.getArray,"Expected `overlays` to be an array or an `ol/Collection.js`"),o=t.overlays):o=new U,{controls:r,interactions:s,keyboardEventTarget:e,overlays:o,values:i}}(t);this.renderComplete_,this.loaded_=!0,this.boundHandleBrowserEvent_=this.handleBrowserEvent.bind(this),this.maxTilesLoading_=void 0!==t.maxTilesLoading?t.maxTilesLoading:16,this.pixelRatio_=void 0!==t.pixelRatio?t.pixelRatio:j,this.postRenderTimeoutHandle_,this.animationDelayKey_,this.animationDelay_=this.animationDelay_.bind(this),this.coordinateToPixelTransform_=[1,0,0,1,0,0],this.pixelToCoordinateTransform_=[1,0,0,1,0,0],this.frameIndex_=0,this.frameState_=null,this.previousExtent_=null,this.viewPropertyListenerKey_=null,this.viewChangeListenerKey_=null,this.layerGroupPropertyListenerKeys_=null,this.viewport_=document.createElement("div"),this.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),this.viewport_.style.position="relative",this.viewport_.style.overflow="hidden",this.viewport_.style.width="100%",this.viewport_.style.height="100%",this.overlayContainer_=document.createElement("div"),this.overlayContainer_.style.position="absolute",this.overlayContainer_.style.zIndex="0",this.overlayContainer_.style.width="100%",this.overlayContainer_.style.height="100%",this.overlayContainer_.style.pointerEvents="none",this.overlayContainer_.className="ol-overlaycontainer",this.viewport_.appendChild(this.overlayContainer_),this.overlayContainerStopEvent_=document.createElement("div"),this.overlayContainerStopEvent_.style.position="absolute",this.overlayContainerStopEvent_.style.zIndex="0",this.overlayContainerStopEvent_.style.width="100%",this.overlayContainerStopEvent_.style.height="100%",this.overlayContainerStopEvent_.style.pointerEvents="none",this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",this.viewport_.appendChild(this.overlayContainerStopEvent_),this.mapBrowserEventHandler_=null,this.moveTolerance_=t.moveTolerance,this.keyboardEventTarget_=e.keyboardEventTarget,this.targetChangeHandlerKeys_=null,this.targetElement_=null,this.resizeObserver_=new ResizeObserver((()=>this.updateSize())),this.controls=e.controls||function(t){t=t||{};const e=new U;return(void 0===t.zoom||t.zoom)&&e.push(new Lr(t.zoomOptions)),(void 0===t.rotate||t.rotate)&&e.push(new Fr(t.rotateOptions)),(void 0===t.attribution||t.attribution)&&e.push(new Dr(t.attributionOptions)),e}(),this.interactions=e.interactions||function(t){t=t||{};const e=new U,i=new ls(-.005,.05,100);return(void 0===t.altShiftDragRotate||t.altShiftDragRotate)&&e.push(new Qr),(void 0===t.doubleClickZoom||t.doubleClickZoom)&&e.push(new zr({delta:t.zoomDelta,duration:t.zoomDuration})),(void 0===t.dragPan||t.dragPan)&&e.push(new Jr({onFocusOnly:t.onFocusOnly,kinetic:i})),(void 0===t.pinchRotate||t.pinchRotate)&&e.push(new us),(void 0===t.pinchZoom||t.pinchZoom)&&e.push(new ds({duration:t.zoomDuration})),(void 0===t.keyboard||t.keyboard)&&(e.push(new as),e.push(new hs({delta:t.zoomDelta,duration:t.zoomDuration}))),(void 0===t.mouseWheelZoom||t.mouseWheelZoom)&&e.push(new cs({onFocusOnly:t.onFocusOnly,duration:t.zoomDuration})),(void 0===t.shiftDragZoom||t.shiftDragZoom)&&e.push(new ns({duration:t.zoomDuration})),e}({onFocusOnly:!0}),this.overlays_=e.overlays,this.overlayIdIndex_={},this.renderer_=null,this.postRenderFunctions_=[],this.tileQueue_=new Rr(this.getTilePriority.bind(this),this.handleTileChange_.bind(this)),this.addChangeListener(Sr,this.handleLayerGroupChanged_),this.addChangeListener(Ir,this.handleViewChanged_),this.addChangeListener(kr,this.handleSizeChanged_),this.addChangeListener(Cr,this.handleTargetChanged_),this.setProperties(e.values);const i=this;!t.view||t.view instanceof Rn||t.view.then((function(t){i.setView(new Rn(t))})),this.controls.addEventListener(O,(t=>{t.element.setMap(this)})),this.controls.addEventListener(N,(t=>{t.element.setMap(null)})),this.interactions.addEventListener(O,(t=>{t.element.setMap(this)})),this.interactions.addEventListener(N,(t=>{t.element.setMap(null)})),this.overlays_.addEventListener(O,(t=>{this.addOverlayInternal_(t.element)})),this.overlays_.addEventListener(N,(t=>{const e=t.element.getId();void 0!==e&&delete this.overlayIdIndex_[e.toString()],t.element.setMap(null)})),this.controls.forEach((t=>{t.setMap(this)})),this.interactions.forEach((t=>{t.setMap(this)})),this.overlays_.forEach(this.addOverlayInternal_.bind(this))}addControl(t){this.getControls().push(t)}addInteraction(t){this.getInteractions().push(t)}addLayer(t){this.getLayerGroup().getLayers().push(t)}handleLayerAdd_(t){_s(t.layer,this)}addOverlay(t){this.getOverlays().push(t)}addOverlayInternal_(t){const e=t.getId();void 0!==e&&(this.overlayIdIndex_[e.toString()]=t),t.setMap(this)}disposeInternal(){this.controls.clear(),this.interactions.clear(),this.overlays_.clear(),this.resizeObserver_.disconnect(),this.setTarget(null),super.disposeInternal()}forEachFeatureAtPixel(t,e,i){if(!this.frameState_||!this.renderer_)return;const n=this.getCoordinateFromPixelInternal(t),r=void 0!==(i=void 0!==i?i:{}).hitTolerance?i.hitTolerance:0,s=void 0!==i.layerFilter?i.layerFilter:d,o=!1!==i.checkWrapped;return this.renderer_.forEachFeatureAtCoordinate(n,this.frameState_,r,o,e,null,s,null)}getFeaturesAtPixel(t,e){const i=[];return this.forEachFeatureAtPixel(t,(function(t){i.push(t)}),e),i}getAllLayers(){const t=[];return function e(i){i.forEach((function(i){i instanceof pr?e(i.getLayers()):t.push(i)}))}(this.getLayers()),t}hasFeatureAtPixel(t,e){if(!this.frameState_||!this.renderer_)return!1;const i=this.getCoordinateFromPixelInternal(t),n=void 0!==(e=void 0!==e?e:{}).layerFilter?e.layerFilter:d,r=void 0!==e.hitTolerance?e.hitTolerance:0,s=!1!==e.checkWrapped;return this.renderer_.hasFeatureAtCoordinate(i,this.frameState_,r,s,n,null)}getEventCoordinate(t){return this.getCoordinateFromPixel(this.getEventPixel(t))}getEventCoordinateInternal(t){return this.getCoordinateFromPixelInternal(this.getEventPixel(t))}getEventPixel(t){const e=this.viewport_.getBoundingClientRect(),i=this.getSize(),n=e.width/i[0],r=e.height/i[1],s="changedTouches"in t?t.changedTouches[0]:t;return[(s.clientX-e.left)/n,(s.clientY-e.top)/r]}getTarget(){return this.get(Cr)}getTargetElement(){return this.targetElement_}getCoordinateFromPixel(t){return mi(this.getCoordinateFromPixelInternal(t),this.getView().getProjection())}getCoordinateFromPixelInternal(t){const e=this.frameState_;return e?H(e.pixelToCoordinateTransform,t.slice()):null}getControls(){return this.controls}getOverlays(){return this.overlays_}getOverlayById(t){const e=this.overlayIdIndex_[t.toString()];return void 0!==e?e:null}getInteractions(){return this.interactions}getLayerGroup(){return this.get(Sr)}setLayers(t){const e=this.getLayerGroup();if(t instanceof U)return void e.setLayers(t);const i=e.getLayers();i.clear(),i.extend(t)}getLayers(){return this.getLayerGroup().getLayers()}getLoadingOrNotReady(){const t=this.getLayerGroup().getLayerStatesArray();for(let e=0,i=t.length;e<i;++e){const i=t[e];if(!i.visible)continue;const n=i.layer.getRenderer();if(n&&!n.ready)return!0;const r=i.layer.getSource();if(r&&r.loading)return!0}return!1}getPixelFromCoordinate(t){const e=pi(t,this.getView().getProjection());return this.getPixelFromCoordinateInternal(e)}getPixelFromCoordinateInternal(t){const e=this.frameState_;return e?H(e.coordinateToPixelTransform,t.slice(0,2)):null}getRenderer(){return this.renderer_}getSize(){return this.get(kr)}getView(){return this.get(Ir)}getViewport(){return this.viewport_}getOverlayContainer(){return this.overlayContainer_}getOverlayContainerStopEvent(){return this.overlayContainerStopEvent_}getOwnerDocument(){const t=this.getTargetElement();return t?t.ownerDocument:document}getTilePriority(t,e,i,n){return function(t,e,i,n,r){if(!t||!(i in t.wantedTiles))return Ar;if(!t.wantedTiles[i][e.getKey()])return Ar;const s=t.viewState.center,o=n[0]-s[0],a=n[1]-s[1];return 65536*Math.log(r)+Math.sqrt(o*o+a*a)/r}(this.frameState_,t,e,i,n)}handleBrowserEvent(t,e){e=e||t.type;const i=new wr(e,this,t);this.handleMapBrowserEvent(i)}handleMapBrowserEvent(t){if(!this.frameState_)return;const e=t.originalEvent,i=e.type;if(i===vr||i===S||i===x){const t=this.getOwnerDocument(),i=this.viewport_.getRootNode?this.viewport_.getRootNode():t,n=e.target;if(this.overlayContainerStopEvent_.contains(n)||!(i===t?t.documentElement:i).contains(n))return}if(t.frameState=this.frameState_,!1!==this.dispatchEvent(t)){const e=this.getInteractions().getArray().slice();for(let i=e.length-1;i>=0;i--){const n=e[i];if(n.getMap()===this&&n.getActive()&&this.getTargetElement()&&(!n.handleEvent(t)||t.propagationStopped))break}}}handlePostRender(){const t=this.frameState_,e=this.tileQueue_;if(!e.isEmpty()){let i=this.maxTilesLoading_,n=i;if(t){const e=t.viewHints;if(e[0]||e[1]){const e=Date.now()-t.time>8;i=e?0:8,n=e?0:2}}e.getTilesLoading()<i&&(e.reprioritize(),e.loadMoreTiles(i,n))}t&&this.renderer_&&!t.animate&&(!0===this.renderComplete_?(this.hasListener(Ce)&&this.renderer_.dispatchRenderEvent(Ce,t),!1===this.loaded_&&(this.loaded_=!0,this.dispatchEvent(new _r(Er,this,t)))):!0===this.loaded_&&(this.loaded_=!1,this.dispatchEvent(new _r(Mr,this,t))));const i=this.postRenderFunctions_;for(let e=0,n=i.length;e<n;++e)i[e](this,t);i.length=0}handleSizeChanged_(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()}handleTargetChanged_(){if(this.mapBrowserEventHandler_){for(let t=0,e=this.targetChangeHandlerKeys_.length;t<e;++t)I(this.targetChangeHandlerKeys_[t]);this.targetChangeHandlerKeys_=null,this.viewport_.removeEventListener(v,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(S,this.boundHandleBrowserEvent_),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,Wn(this.viewport_)}if(this.targetElement_){this.resizeObserver_.unobserve(this.targetElement_);const t=this.targetElement_.getRootNode();t instanceof ShadowRoot&&this.resizeObserver_.unobserve(t.host),this.setSize(void 0)}const t=this.getTarget(),e="string"==typeof t?document.getElementById(t):t;if(this.targetElement_=e,e){e.appendChild(this.viewport_),this.renderer_||(this.renderer_=new dr(this)),this.mapBrowserEventHandler_=new br(this,this.moveTolerance_);for(const t in yr)this.mapBrowserEventHandler_.addEventListener(yr[t],this.handleMapBrowserEvent.bind(this));this.viewport_.addEventListener(v,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(S,this.boundHandleBrowserEvent_,!!Z&&{passive:!1});const t=this.keyboardEventTarget_?this.keyboardEventTarget_:e;this.targetChangeHandlerKeys_=[k(t,x,this.handleBrowserEvent,this),k(t,M,this.handleBrowserEvent,this)];const i=e.getRootNode();i instanceof ShadowRoot&&this.resizeObserver_.observe(i.host),this.resizeObserver_.observe(e)}else this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);this.updateSize()}handleTileChange_(){this.render()}handleViewPropertyChanged_(){this.render()}handleViewChanged_(){this.viewPropertyListenerKey_&&(I(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(I(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);const t=this.getView();t&&(this.updateViewportSize_(this.getSize()),this.viewPropertyListenerKey_=k(t,s,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=k(t,y,this.handleViewPropertyChanged_,this),t.resolveConstraints(0)),this.render()}handleLayerGroupChanged_(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(I),this.layerGroupPropertyListenerKeys_=null);const t=this.getLayerGroup();t&&(this.handleLayerAdd_(new fr("addlayer",t)),this.layerGroupPropertyListenerKeys_=[k(t,s,this.render,this),k(t,y,this.render,this),k(t,"addlayer",this.handleLayerAdd_,this),k(t,"removelayer",this.handleLayerRemove_,this)]),this.render()}isRendered(){return!!this.frameState_}animationDelay_(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}renderSync(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()}redrawText(){const t=this.getLayerGroup().getLayerStatesArray();for(let e=0,i=t.length;e<i;++e){const i=t[e].layer;i.hasRenderer()&&i.getRenderer().handleFontsChanged()}}render(){this.renderer_&&void 0===this.animationDelayKey_&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))}flushDeclutterItems(){const t=this.frameState_;t&&this.renderer_.flushDeclutterItems(t)}removeControl(t){return this.getControls().remove(t)}removeInteraction(t){return this.getInteractions().remove(t)}removeLayer(t){return this.getLayerGroup().getLayers().remove(t)}handleLayerRemove_(t){ps(t.layer)}removeOverlay(t){return this.getOverlays().remove(t)}renderFrame_(t){const e=this.getSize(),i=this.getView(),n=this.frameState_;let r=null;if(void 0!==e&&fs(e)&&i&&i.isDef()){const n=i.getHints(this.frameState_?this.frameState_.viewHints:void 0),s=i.getState();if(r={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutterTree:null,extent:St(s.center,s.resolution,s.rotation,e),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:e,tileQueue:this.tileQueue_,time:t,usedTiles:{},viewState:s,viewHints:n,wantedTiles:{},mapId:D(this),renderTargets:{}},s.nextCenter&&s.nextResolution){const t=isNaN(s.nextRotation)?s.rotation:s.nextRotation;r.nextExtent=St(s.nextCenter,s.nextResolution,t,e)}}this.frameState_=r,this.renderer_.renderFrame(r),r&&(r.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,r.postRenderFunctions),n&&(!this.previousExtent_||!Dt(this.previousExtent_)&&!gt(r.extent,this.previousExtent_))&&(this.dispatchEvent(new _r("movestart",this,n)),this.previousExtent_=ut(this.previousExtent_)),this.previousExtent_&&!r.viewHints[0]&&!r.viewHints[1]&&!gt(r.extent,this.previousExtent_)&&(this.dispatchEvent(new _r("moveend",this,r)),rt(r.extent,this.previousExtent_))),this.dispatchEvent(new _r(xr,this,r)),this.renderComplete_=this.hasListener(Mr)||this.hasListener(Er)||this.hasListener(Ce)?!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoadingOrNotReady():void 0,this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout((()=>{this.postRenderTimeoutHandle_=void 0,this.handlePostRender()}),0))}setLayerGroup(t){const e=this.getLayerGroup();e&&this.handleLayerRemove_(new fr("removelayer",e)),this.set(Sr,t)}setSize(t){this.set(kr,t)}setTarget(t){this.set(Cr,t)}setView(t){if(!t||t instanceof Rn)return void this.set(Ir,t);this.set(Ir,new Rn);const e=this;t.then((function(t){e.setView(new Rn(t))}))}updateSize(){const t=this.getTargetElement();let e;if(t){const i=getComputedStyle(t),n=t.offsetWidth-parseFloat(i.borderLeftWidth)-parseFloat(i.paddingLeft)-parseFloat(i.paddingRight)-parseFloat(i.borderRightWidth),r=t.offsetHeight-parseFloat(i.borderTopWidth)-parseFloat(i.paddingTop)-parseFloat(i.paddingBottom)-parseFloat(i.borderBottomWidth);isNaN(n)||isNaN(r)||(e=[n,r],!fs(e)&&(t.offsetWidth||t.offsetHeight||t.getClientRects().length)&&ti("No map visible because the map container's width or height are 0."))}const i=this.getSize();!e||i&&u(e,i)||(this.setSize(e),this.updateViewportSize_(e))}updateViewportSize_(t){const e=this.getView();e&&e.setViewportSize(t)}},ys="preload",vs="useInterimTilesOnError",bs=class extends Dn{constructor(t){t=t||{};const e=Object.assign({},t);delete e.preload,delete e.useInterimTilesOnError,super(e),this.on,this.once,this.un,this.setPreload(void 0!==t.preload?t.preload:0),this.setUseInterimTilesOnError(void 0===t.useInterimTilesOnError||t.useInterimTilesOnError)}getPreload(){return this.get(ys)}setPreload(t){this.set(ys,t)}getUseInterimTilesOnError(){return this.get(vs)}setUseInterimTilesOnError(t){this.set(vs,t)}getData(t){return super.getData(t)}},xs=class extends T{constructor(t){super(),this.ready=!0,this.boundHandleImageChange_=this.handleImageChange_.bind(this),this.layer_=t,this.declutterExecutorGroup=null}getFeatures(t){return R()}getData(t){return null}prepareFrame(t){return R()}renderFrame(t,e){return R()}loadedTileCallback(t,e,i){t[e]||(t[e]={}),t[e][i.tileCoord.toString()]=i}createLoadedTileFinder(t,e,i){return(n,r)=>{const s=this.loadedTileCallback.bind(this,i,n);return t.forEachLoadedTile(e,n,r,s)}}forEachFeatureAtCoordinate(t,e,i,n,r){}getLayer(){return this.layer_}handleFontsChanged(){}handleImageChange_(t){const e=t.target;2!==e.getState()&&3!==e.getState()||this.renderIfReadyAndVisible()}loadImage(t){let e=t.getState();return 2!=e&&3!=e&&t.addEventListener(y,this.boundHandleImageChange_),0==e&&(t.load(),e=t.getState()),2==e}renderIfReadyAndVisible(){const t=this.getLayer();t&&t.getVisible()&&"ready"===t.getSourceState()&&t.changed()}disposeInternal(){delete this.layer_,super.disposeInternal()}},Ms=[];let Es=null;const Ss=class extends xs{constructor(t){super(t),this.container=null,this.renderedResolution,this.tempTransform=[1,0,0,1,0,0],this.pixelTransform=[1,0,0,1,0,0],this.inversePixelTransform=[1,0,0,1,0,0],this.context=null,this.containerReused=!1,this.pixelContext_=null,this.frameState=null}getImageData(t,e,i){let n;Es||(Es=Vn(1,1,void 0,{willReadFrequently:!0})),Es.clearRect(0,0,1,1);try{Es.drawImage(t,e,i,1,1,0,0,1,1),n=Es.getImageData(0,0,1,1).data}catch(t){return Es=null,null}return n}getBackground(t){let e=this.getLayer().getBackground();return"function"==typeof e&&(e=e(t.viewState.resolution)),e||void 0}useContainer(t,e,i){const n=this.getLayer().getClassName();let r,s;if(t&&t.className===n&&(!i||t&&t.style.backgroundColor&&u(le(t.style.backgroundColor),le(i)))){const e=t.firstElementChild;e instanceof HTMLCanvasElement&&(s=e.getContext("2d"))}if(s&&s.canvas.style.transform===e?(this.container=t,this.context=s,this.containerReused=!0):this.containerReused?(this.container=null,this.context=null,this.containerReused=!1):this.container&&(this.container.style.backgroundColor=null),!this.container){r=document.createElement("div"),r.className=n;let t=r.style;t.position="absolute",t.width="100%",t.height="100%",s=Vn();const e=s.canvas;r.appendChild(e),t=e.style,t.position="absolute",t.left="0",t.transformOrigin="top left",this.container=r,this.context=s}this.containerReused||!i||this.container.style.backgroundColor||(this.container.style.backgroundColor=i)}clipUnrotated(t,e,i){const n=At(i),r=Tt(i),s=xt(i),o=bt(i);H(e.coordinateToPixelTransform,n),H(e.coordinateToPixelTransform,r),H(e.coordinateToPixelTransform,s),H(e.coordinateToPixelTransform,o);const a=this.inversePixelTransform;H(a,n),H(a,r),H(a,s),H(a,o),t.save(),t.beginPath(),t.moveTo(Math.round(n[0]),Math.round(n[1])),t.lineTo(Math.round(r[0]),Math.round(r[1])),t.lineTo(Math.round(s[0]),Math.round(s[1])),t.lineTo(Math.round(o[0]),Math.round(o[1])),t.clip()}dispatchRenderEvent_(t,e,i){const n=this.getLayer();if(n.hasListener(t)){const r=new On(t,this.inversePixelTransform,i,e);n.dispatchEvent(r)}}preRender(t,e){this.frameState=e,this.dispatchRenderEvent_(Ee,t,e)}postRender(t,e){this.dispatchRenderEvent_(Se,t,e)}getRenderTransform(t,e,i,n,r,s,o){const a=r/2,h=s/2,l=n/e,c=-l,u=-t[0]+o,d=-t[1];return $(this.tempTransform,a,h,l,c,-i,u,d)}disposeInternal(){delete this.frameState,super.disposeInternal()}},ks=class extends w{constructor(t,e,i){super(),i=i||{},this.tileCoord=t,this.state=e,this.interimTile=null,this.key="",this.transition_=void 0===i.transition?250:i.transition,this.transitionStarts_={},this.interpolate=!!i.interpolate}changed(){this.dispatchEvent(y)}release(){3===this.state&&this.setState(4)}getKey(){return this.key+"/"+this.tileCoord}getInterimTile(){let t=this.interimTile;if(!t)return this;do{if(2==t.getState())return this.transition_=0,t;t=t.interimTile}while(t);return this}refreshInterimChain(){let t=this.interimTile;if(!t)return;let e=this;do{if(2==t.getState()){t.interimTile=null;break}1==t.getState()?e=t:0==t.getState()?e.interimTile=t.interimTile:e=t,t=e.interimTile}while(t)}getTileCoord(){return this.tileCoord}getState(){return this.state}setState(t){if(3!==this.state&&this.state>t)throw new Error("Tile load sequence violation");this.state=t,this.changed()}load(){R()}getAlpha(t,e){if(!this.transition_)return 1;let i=this.transitionStarts_[t];if(i){if(-1===i)return 1}else i=e,this.transitionStarts_[t]=i;const n=e-i+1e3/60;return n>=this.transition_?1:Ti(n/this.transition_)}inTransition(t){return!!this.transition_&&-1!==this.transitionStarts_[t]}endTransition(t){this.transition_&&(this.transitionStarts_[t]=-1)}};const Cs=class extends ks{constructor(t,e,i,n,r,s){super(t,e,s),this.crossOrigin_=n,this.src_=i,this.key=i,this.image_=new Image,null!==n&&(this.image_.crossOrigin=n),this.unlisten_=null,this.tileLoadFunction_=r}getImage(){return this.image_}setImage(t){this.image_=t,this.state=2,this.unlistenImage_(),this.changed()}handleImageError_(){this.state=3,this.unlistenImage_(),this.image_=function(){const t=Vn(1,1);return t.fillStyle="rgba(0,0,0,0)",t.fillRect(0,0,1,1),t.canvas}(),this.changed()}handleImageLoad_(){const t=this.image_;t.naturalWidth&&t.naturalHeight?this.state=2:this.state=4,this.unlistenImage_(),this.changed()}load(){3==this.state&&(this.state=0,this.image_=new Image,null!==this.crossOrigin_&&(this.image_.crossOrigin=this.crossOrigin_)),0==this.state&&(this.state=1,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=function(t,e,i){const n=t;let r=!0,s=!1,o=!1;const a=[C(n,"load",(function(){o=!0,s||e()}))];return n.src&&W?(s=!0,n.decode().then((function(){r&&e()})).catch((function(t){r&&(o?e():i())}))):a.push(C(n,"error",i)),function(){r=!1,a.forEach(I)}}(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}},Is=class{constructor(t,e,i,n,r,s){this.sourceProj_=t,this.targetProj_=e;let o={};const a=ui(this.targetProj_,this.sourceProj_);this.transformInv_=function(t){const e=t[0]+"/"+t[1];return o[e]||(o[e]=a(t)),o[e]},this.maxSourceExtent_=n,this.errorThresholdSquared_=r*r,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!n&&!!this.sourceProj_.getExtent()&&Rt(n)>=Rt(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?Rt(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?Rt(this.targetProj_.getExtent()):null;const h=At(i),l=Tt(i),c=xt(i),u=bt(i),d=this.transformInv_(h),f=this.transformInv_(l),g=this.transformInv_(c),m=this.transformInv_(u),p=10+(s?Math.max(0,Math.ceil(Math.log2(vt(i)/(s*s*256*256)))):0);if(this.addQuad_(h,l,c,u,d,f,g,m,p),this.wrapsXInSource_){let t=1/0;this.triangles_.forEach((function(e,i,n){t=Math.min(t,e.source[0][0],e.source[1][0],e.source[2][0])})),this.triangles_.forEach((e=>{if(Math.max(e.source[0][0],e.source[1][0],e.source[2][0])-t>this.sourceWorldWidth_/2){const i=[[e.source[0][0],e.source[0][1]],[e.source[1][0],e.source[1][1]],[e.source[2][0],e.source[2][1]]];i[0][0]-t>this.sourceWorldWidth_/2&&(i[0][0]-=this.sourceWorldWidth_),i[1][0]-t>this.sourceWorldWidth_/2&&(i[1][0]-=this.sourceWorldWidth_),i[2][0]-t>this.sourceWorldWidth_/2&&(i[2][0]-=this.sourceWorldWidth_);const n=Math.min(i[0][0],i[1][0],i[2][0]);Math.max(i[0][0],i[1][0],i[2][0])-n<this.sourceWorldWidth_/2&&(e.source=i)}}))}o={}}addTriangle_(t,e,i,n,r,s){this.triangles_.push({source:[n,r,s],target:[t,e,i]})}addQuad_(t,e,i,n,r,s,o,a,h){const l=it([r,s,o,a]),c=this.sourceWorldWidth_?Rt(l)/this.sourceWorldWidth_:null,u=this.sourceWorldWidth_,d=this.sourceProj_.canWrapX()&&c>.5&&c<1;let f=!1;if(h>0&&(this.targetProj_.isGlobal()&&this.targetWorldWidth_&&(f=Rt(it([t,e,i,n]))/this.targetWorldWidth_>.25||f),!d&&this.sourceProj_.isGlobal()&&c&&(f=c>.25||f)),!f&&this.maxSourceExtent_&&isFinite(l[0])&&isFinite(l[1])&&isFinite(l[2])&&isFinite(l[3])&&!Pt(l,this.maxSourceExtent_))return;let g=0;if(!(f||isFinite(r[0])&&isFinite(r[1])&&isFinite(s[0])&&isFinite(s[1])&&isFinite(o[0])&&isFinite(o[1])&&isFinite(a[0])&&isFinite(a[1])))if(h>0)f=!0;else if(g=(isFinite(r[0])&&isFinite(r[1])?0:8)+(isFinite(s[0])&&isFinite(s[1])?0:4)+(isFinite(o[0])&&isFinite(o[1])?0:2)+(isFinite(a[0])&&isFinite(a[1])?0:1),1!=g&&2!=g&&4!=g&&8!=g)return;if(h>0){if(!f){const e=[(t[0]+i[0])/2,(t[1]+i[1])/2],n=this.transformInv_(e);let s;s=d?(Ht(r[0],u)+Ht(o[0],u))/2-Ht(n[0],u):(r[0]+o[0])/2-n[0];const a=(r[1]+o[1])/2-n[1];f=s*s+a*a>this.errorThresholdSquared_}if(f){if(Math.abs(t[0]-i[0])<=Math.abs(t[1]-i[1])){const l=[(e[0]+i[0])/2,(e[1]+i[1])/2],c=this.transformInv_(l),u=[(n[0]+t[0])/2,(n[1]+t[1])/2],d=this.transformInv_(u);this.addQuad_(t,e,l,u,r,s,c,d,h-1),this.addQuad_(u,l,i,n,d,c,o,a,h-1)}else{const l=[(t[0]+e[0])/2,(t[1]+e[1])/2],c=this.transformInv_(l),u=[(i[0]+n[0])/2,(i[1]+n[1])/2],d=this.transformInv_(u);this.addQuad_(t,l,u,n,r,c,d,a,h-1),this.addQuad_(l,e,i,u,c,s,o,d,h-1)}return}}if(d){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}0==(11&g)&&this.addTriangle_(t,i,n,r,o,a),0==(14&g)&&this.addTriangle_(t,i,e,r,o,s),g&&(0==(13&g)&&this.addTriangle_(e,n,t,s,a,r),0==(7&g)&&this.addTriangle_(e,n,i,s,a,o))}calculateSourceExtent(){const t=[1/0,1/0,-1/0,-1/0];return this.triangles_.forEach((function(e,i,n){const r=e.source;pt(t,r[0]),pt(t,r[1]),pt(t,r[2])})),t}getTriangles(){return this.triangles_}};let As;const Ts=[];function Rs(t,e,i,n,r){t.beginPath(),t.moveTo(0,0),t.lineTo(e,i),t.lineTo(n,r),t.closePath(),t.save(),t.clip(),t.fillRect(0,0,Math.max(e,n)+1,Math.max(i,r)),t.restore()}function Ps(t,e){return Math.abs(t[4*e]-210)>2||Math.abs(t[4*e+3]-191.25)>2}function Ds(t,e,i,n){const r=di(i,e,t);let s=oi(e,n,i);const o=e.getMetersPerUnit();void 0!==o&&(s*=o);const a=t.getMetersPerUnit();void 0!==a&&(s/=a);const h=t.getExtent();if(!h||ot(h,r)){const e=oi(t,s,r)/s;isFinite(e)&&e>0&&(s/=e)}return s}const Fs=class extends ks{constructor(t,e,i,n,r,s,o,a,h,l,c,u){super(r,0,u),this.renderEdges_=void 0!==c&&c,this.pixelRatio_=o,this.gutter_=a,this.canvas_=null,this.sourceTileGrid_=e,this.targetTileGrid_=n,this.wrappedTileCoord_=s||r,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0;const d=n.getTileCoordExtent(this.wrappedTileCoord_),f=this.targetTileGrid_.getExtent();let g=this.sourceTileGrid_.getExtent();const m=f?It(d,f):d;if(0===vt(m))return void(this.state=4);const p=t.getExtent();p&&(g=g?It(g,p):p);const _=n.getResolution(this.wrappedTileCoord_[0]),w=function(t,e,i,n){const r=Mt(i);let s=Ds(t,e,r,n);return(!isFinite(s)||s<=0)&&yt(i,(function(i){return s=Ds(t,e,i,n),isFinite(s)&&s>0})),s}(t,i,m,_);if(!isFinite(w)||w<=0)return void(this.state=4);const y=void 0!==l?l:.5;if(this.triangulation_=new Is(t,i,m,g,w*y,_),0===this.triangulation_.getTriangles().length)return void(this.state=4);this.sourceZ_=e.getZForResolution(w);let v=this.triangulation_.calculateSourceExtent();if(g&&(t.canWrapX()?(v[1]=qt(v[1],g[1],g[3]),v[3]=qt(v[3],g[1],g[3])):v=It(v,g)),vt(v)){const t=e.getTileRangeForExtentAndZ(v,this.sourceZ_);for(let e=t.minX;e<=t.maxX;e++)for(let i=t.minY;i<=t.maxY;i++){const t=h(this.sourceZ_,e,i,o);t&&this.sourceTiles_.push(t)}0===this.sourceTiles_.length&&(this.state=4)}else this.state=4}getImage(){return this.canvas_}reproject_(){const t=[];if(this.sourceTiles_.forEach((e=>{e&&2==e.getState()&&t.push({extent:this.sourceTileGrid_.getTileCoordExtent(e.tileCoord),image:e.getImage()})})),this.sourceTiles_.length=0,0===t.length)this.state=3;else{const e=this.wrappedTileCoord_[0],i=this.targetTileGrid_.getTileSize(e),n="number"==typeof i?i:i[0],r="number"==typeof i?i:i[1],s=this.targetTileGrid_.getResolution(e),o=this.sourceTileGrid_.getResolution(this.sourceZ_),a=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=function(t,e,i,n,r,s,o,a,h,l,c,u,d){const f=Vn(Math.round(i*t),Math.round(i*e),Ts);if(u||(f.imageSmoothingEnabled=!1),0===h.length)return f.canvas;function g(t){return Math.round(t*i)/i}f.scale(i,i),f.globalCompositeOperation="lighter";const m=[1/0,1/0,-1/0,-1/0];let p;if(h.forEach((function(t,e,i){mt(m,t.extent)})),!d||1!==h.length||0!==l){const t=Rt(m),e=Ct(m);p=Vn(Math.round(i*t/n),Math.round(i*e/n),Ts),u||(p.imageSmoothingEnabled=!1);const r=i/n;h.forEach((function(t,e,i){const n=t.extent[0]-m[0],s=-(t.extent[3]-m[3]),o=Rt(t.extent),a=Ct(t.extent);t.image.width>0&&t.image.height>0&&p.drawImage(t.image,l,l,t.image.width-2*l,t.image.height-2*l,n*r,s*r,o*r,a*r)}))}const _=At(o);return a.getTriangles().forEach((function(t,e,r){const o=t.source,a=t.target;let l=o[0][0],c=o[0][1],d=o[1][0],w=o[1][1],y=o[2][0],v=o[2][1];const b=g((a[0][0]-_[0])/s),x=g(-(a[0][1]-_[1])/s),M=g((a[1][0]-_[0])/s),E=g(-(a[1][1]-_[1])/s),S=g((a[2][0]-_[0])/s),k=g(-(a[2][1]-_[1])/s),C=l,I=c;l=0,c=0,d-=C,w-=I,y-=C,v-=I;const A=function(t){const e=t.length;for(let i=0;i<e;i++){let n=i,r=Math.abs(t[i][i]);for(let s=i+1;s<e;s++){const e=Math.abs(t[s][i]);e>r&&(r=e,n=s)}if(0===r)return null;const s=t[n];t[n]=t[i],t[i]=s;for(let n=i+1;n<e;n++){const r=-t[n][i]/t[i][i];for(let s=i;s<e+1;s++)i==s?t[n][s]=0:t[n][s]+=r*t[i][s]}}const i=new Array(e);for(let n=e-1;n>=0;n--){i[n]=t[n][e]/t[n][n];for(let r=n-1;r>=0;r--)t[r][e]-=t[r][n]*i[n]}return i}([[d,w,0,0,M-b],[y,v,0,0,S-b],[0,0,d,w,E-x],[0,0,y,v,k-x]]);if(!A)return;if(f.save(),f.beginPath(),function(){if(void 0===As){const t=Vn(6,6,Ts);t.globalCompositeOperation="lighter",t.fillStyle="rgba(210, 0, 0, 0.75)",Rs(t,4,5,4,0),Rs(t,4,5,0,5);const e=t.getImageData(0,0,3,3).data;As=Ps(e,0)||Ps(e,4)||Ps(e,8),jn(t),Ts.push(t.canvas)}return As}()||!u){f.moveTo(M,E);const t=4,e=b-M,i=x-E;for(let n=0;n<t;n++)f.lineTo(M+g((n+1)*e/t),E+g(n*i/(t-1))),n!=t-1&&f.lineTo(M+g((n+1)*e/t),E+g((n+1)*i/(t-1)));f.lineTo(S,k)}else f.moveTo(M,E),f.lineTo(b,x),f.lineTo(S,k);let T;if(f.clip(),f.transform(A[0],A[2],A[1],A[3],b,x),f.translate(m[0]-C,m[3]-I),p)T=p.canvas,f.scale(n/i,-n/i);else{const t=h[0],e=t.extent;T=t.image,f.scale(Rt(e)/T.width,-Ct(e)/T.height)}f.drawImage(T,0,0),f.restore()})),p&&(jn(p),Ts.push(p.canvas)),c&&(f.save(),f.globalCompositeOperation="source-over",f.strokeStyle="black",f.lineWidth=1,a.getTriangles().forEach((function(t,e,i){const n=t.target,r=(n[0][0]-_[0])/s,o=-(n[0][1]-_[1])/s,a=(n[1][0]-_[0])/s,h=-(n[1][1]-_[1])/s,l=(n[2][0]-_[0])/s,c=-(n[2][1]-_[1])/s;f.beginPath(),f.moveTo(a,h),f.lineTo(r,o),f.lineTo(l,c),f.closePath(),f.stroke()})),f.restore()),f.canvas}(n,r,this.pixelRatio_,o,this.sourceTileGrid_.getExtent(),s,a,this.triangulation_,t,this.gutter_,this.renderEdges_,this.interpolate),this.state=2}this.changed()}load(){if(0==this.state){this.state=1,this.changed();let t=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach((e=>{const i=e.getState();if(0==i||1==i){t++;const i=k(e,y,(function(n){const r=e.getState();2!=r&&3!=r&&4!=r||(I(i),t--,0===t&&(this.unlistenSources_(),this.reproject_()))}),this);this.sourcesListenerKeys_.push(i)}})),0===t?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach((function(t,e,i){0==t.getState()&&t.load()}))}}unlistenSources_(){this.sourcesListenerKeys_.forEach(I),this.sourcesListenerKeys_=null}release(){this.canvas_&&(jn(this.canvas_.getContext("2d")),Ts.push(this.canvas_),this.canvas_=null),super.release()}};class Ls{constructor(t,e,i,n){this.minX=t,this.maxX=e,this.minY=i,this.maxY=n}contains(t){return this.containsXY(t[1],t[2])}containsTileRange(t){return this.minX<=t.minX&&t.maxX<=this.maxX&&this.minY<=t.minY&&t.maxY<=this.maxY}containsXY(t,e){return this.minX<=t&&t<=this.maxX&&this.minY<=e&&e<=this.maxY}equals(t){return this.minX==t.minX&&this.minY==t.minY&&this.maxX==t.maxX&&this.maxY==t.maxY}extend(t){t.minX<this.minX&&(this.minX=t.minX),t.maxX>this.maxX&&(this.maxX=t.maxX),t.minY<this.minY&&(this.minY=t.minY),t.maxY>this.maxY&&(this.maxY=t.maxY)}getHeight(){return this.maxY-this.minY+1}getSize(){return[this.getWidth(),this.getHeight()]}getWidth(){return this.maxX-this.minX+1}intersects(t){return this.minX<=t.maxX&&this.maxX>=t.minX&&this.minY<=t.maxY&&this.maxY>=t.minY}}function Os(t,e,i,n,r){return void 0!==r?(r.minX=t,r.maxX=e,r.minY=i,r.maxY=n,r):new Ls(t,e,i,n)}const Ns=Ls,Bs=class extends Ss{constructor(t){super(t),this.extentChanged=!0,this.renderedExtent_=null,this.renderedPixelRatio,this.renderedProjection=null,this.renderedRevision,this.renderedTiles=[],this.newTiles_=!1,this.tmpExtent=[1/0,1/0,-1/0,-1/0],this.tmpTileRange_=new Ns(0,0,0,0)}isDrawableTile(t){const e=this.getLayer(),i=t.getState(),n=e.getUseInterimTilesOnError();return 2==i||4==i||3==i&&!n}getTile(t,e,i,n){const r=n.pixelRatio,s=n.viewState.projection,o=this.getLayer();let a=o.getSource().getTile(t,e,i,r,s);return 3==a.getState()&&o.getUseInterimTilesOnError()&&o.getPreload()>0&&(this.newTiles_=!0),this.isDrawableTile(a)||(a=a.getInterimTile()),a}getData(t){const e=this.frameState;if(!e)return null;const i=this.getLayer(),n=H(e.pixelToCoordinateTransform,t.slice()),r=i.getExtent();if(r&&!ot(r,n))return null;const s=e.pixelRatio,o=e.viewState.projection,a=e.viewState,h=i.getRenderSource(),l=h.getTileGridForProjection(a.projection),c=h.getTilePixelRatio(e.pixelRatio);for(let t=l.getZForResolution(a.resolution);t>=l.getMinZoom();--t){const e=l.getTileCoordForCoordAndZ(n,t),i=h.getTile(t,e[1],e[2],s,o);if(!(i instanceof Cs||i instanceof Fs)||i instanceof Fs&&4===i.getState())return null;if(2!==i.getState())continue;const r=l.getOrigin(t),u=ms(l.getTileSize(t)),d=l.getResolution(t),f=Math.floor(c*((n[0]-r[0])/d-e[1]*u[0])),g=Math.floor(c*((r[1]-n[1])/d-e[2]*u[1])),m=Math.round(c*h.getGutterForProjection(a.projection));return this.getImageData(i.getImage(),f+m,g+m)}return null}loadedTileCallback(t,e,i){return!!this.isDrawableTile(i)&&super.loadedTileCallback(t,e,i)}prepareFrame(t){return!!this.getLayer().getSource()}renderFrame(t,e){const i=t.layerStatesArray[t.layerIndex],n=t.viewState,r=n.projection,s=n.resolution,o=n.center,h=n.rotation,l=t.pixelRatio,c=this.getLayer(),u=c.getSource(),d=u.getRevision(),f=u.getTileGridForProjection(r),g=f.getZForResolution(s,u.zDirection),m=f.getResolution(g);let p=t.extent;const _=t.viewState.resolution,w=u.getTilePixelRatio(l),y=Math.round(Rt(p)/_*l),v=Math.round(Ct(p)/_*l),b=i.extent&&wi(i.extent);b&&(p=It(p,wi(i.extent)));const x=m*y/2/w,M=m*v/2/w,E=[o[0]-x,o[1]-M,o[0]+x,o[1]+M],S=f.getTileRangeForExtentAndZ(p,g),k={};k[g]={};const C=this.createLoadedTileFinder(u,r,k),I=this.tmpExtent,A=this.tmpTileRange_;this.newTiles_=!1;const T=h?kt(n.center,_,h,t.size):void 0;for(let e=S.minX;e<=S.maxX;++e)for(let n=S.minY;n<=S.maxY;++n){if(h&&!f.tileCoordIntersectsViewport([g,e,n],T))continue;const r=this.getTile(g,e,n,t);if(this.isDrawableTile(r)){const e=D(this);if(2==r.getState()){k[g][r.tileCoord.toString()]=r;let t=r.inTransition(e);t&&1!==i.opacity&&(r.endTransition(e),t=!1),this.newTiles_||!t&&this.renderedTiles.includes(r)||(this.newTiles_=!0)}if(1===r.getAlpha(e,t.time))continue}const s=f.getTileCoordChildTileRange(r.tileCoord,A,I);let o=!1;s&&(o=C(g+1,s)),o||f.forEachTileCoordParentTileRange(r.tileCoord,C,A,I)}const R=m/s*l/w;$(this.pixelTransform,t.size[0]/2,t.size[1]/2,1/l,1/l,h,-y/2,-v/2);const P=tt(this.pixelTransform);this.useContainer(e,P,this.getBackground(t));const F=this.context,L=F.canvas;J(this.inversePixelTransform,this.pixelTransform),$(this.tempTransform,y/2,v/2,R,R,0,-y/2,-v/2),L.width!=y||L.height!=v?(L.width=y,L.height=v):this.containerReused||F.clearRect(0,0,y,v),b&&this.clipUnrotated(F,t,b),u.getInterpolate()||(F.imageSmoothingEnabled=!1),this.preRender(F,t),this.renderedTiles.length=0;let O,N,B,z=Object.keys(k).map(Number);z.sort(a),1!==i.opacity||this.containerReused&&!u.getOpaque(t.viewState.projection)?(O=[],N=[]):z=z.reverse();for(let e=z.length-1;e>=0;--e){const i=z[e],n=u.getTilePixelSize(i,l,r),s=f.getResolution(i)/m,o=n[0]*s*R,a=n[1]*s*R,h=f.getTileCoordForCoordAndZ(At(E),i),c=f.getTileCoordExtent(h),d=H(this.tempTransform,[w*(c[0]-E[0])/m,w*(E[3]-c[3])/m]),p=w*u.getGutterForProjection(r),_=k[i];for(const e in _){const n=_[e],r=n.tileCoord,s=h[1]-r[1],l=Math.round(d[0]-(s-1)*o),c=h[2]-r[2],f=Math.round(d[1]-(c-1)*a),m=Math.round(d[0]-s*o),w=Math.round(d[1]-c*a),y=l-m,v=f-w,b=g===i,x=b&&1!==n.getAlpha(D(this),t.time);let M=!1;if(!x)if(O){B=[m,w,m+y,w,m+y,w+v,m,w+v];for(let t=0,e=O.length;t<e;++t)if(g!==i&&i<N[t]){const e=O[t];Pt([m,w,m+y,w+v],[e[0],e[3],e[4],e[7]])&&(M||(F.save(),M=!0),F.beginPath(),F.moveTo(B[0],B[1]),F.lineTo(B[2],B[3]),F.lineTo(B[4],B[5]),F.lineTo(B[6],B[7]),F.moveTo(e[6],e[7]),F.lineTo(e[4],e[5]),F.lineTo(e[2],e[3]),F.lineTo(e[0],e[1]),F.clip())}O.push(B),N.push(i)}else F.clearRect(m,w,y,v);this.drawTileImage(n,t,m,w,y,v,p,b),O&&!x?(M&&F.restore(),this.renderedTiles.unshift(n)):this.renderedTiles.push(n),this.updateUsedTiles(t.usedTiles,u,n)}}return this.renderedRevision=d,this.renderedResolution=m,this.extentChanged=!this.renderedExtent_||!gt(this.renderedExtent_,E),this.renderedExtent_=E,this.renderedPixelRatio=l,this.renderedProjection=r,this.manageTilePyramid(t,u,f,l,r,p,g,c.getPreload()),this.scheduleExpireCache(t,u),this.postRender(F,t),i.extent&&F.restore(),F.imageSmoothingEnabled=!0,P!==L.style.transform&&(L.style.transform=P),this.container}drawTileImage(t,e,i,n,r,s,o,a){const h=this.getTileImage(t);if(!h)return;const l=D(this),c=e.layerStatesArray[e.layerIndex],u=c.opacity*(a?t.getAlpha(l,e.time):1),d=u!==this.context.globalAlpha;d&&(this.context.save(),this.context.globalAlpha=u),this.context.drawImage(h,o,o,h.width-2*o,h.height-2*o,i,n,r,s),d&&this.context.restore(),u!==c.opacity?e.animate=!0:a&&t.endTransition(l)}getImage(){const t=this.context;return t?t.canvas:null}getTileImage(t){return t.getImage()}scheduleExpireCache(t,e){if(e.canExpireCache()){const i=function(t,e,i){const n=D(t);n in i.usedTiles&&t.expireCache(i.viewState.projection,i.usedTiles[n])}.bind(null,e);t.postRenderFunctions.push(i)}}updateUsedTiles(t,e,i){const n=D(e);n in t||(t[n]={}),t[n][i.getKey()]=!0}manageTilePyramid(t,e,i,n,r,s,o,a,h){const l=D(e);l in t.wantedTiles||(t.wantedTiles[l]={});const c=t.wantedTiles[l],u=t.tileQueue,d=i.getMinZoom(),f=t.viewState.rotation,g=f?kt(t.viewState.center,t.viewState.resolution,f,t.size):void 0;let m,p,_,w,y,v,b=0;for(v=d;v<=o;++v)for(p=i.getTileRangeForExtentAndZ(s,v,p),_=i.getResolution(v),w=p.minX;w<=p.maxX;++w)for(y=p.minY;y<=p.maxY;++y)f&&!i.tileCoordIntersectsViewport([v,w,y],g)||(o-v<=a?(++b,m=e.getTile(v,w,y,n,r),0==m.getState()&&(c[m.getKey()]=!0,u.isKeyQueued(m.getKey())||u.enqueue([m,l,i.getTileCoordCenter(m.tileCoord),_])),void 0!==h&&h(m)):e.useTile(v,w,y,r));e.updateCacheSize(b,r)}},zs=class extends bs{constructor(t){super(t)}createRenderer(){return new Bs(this)}};var Us=__webpack_require__(3379),Gs=__webpack_require__.n(Us),Ys=__webpack_require__(7795),Xs=__webpack_require__.n(Ys),Vs=__webpack_require__(569),js=__webpack_require__.n(Vs),qs=__webpack_require__(3565),Ws=__webpack_require__.n(qs),Zs=__webpack_require__(9216),Ks=__webpack_require__.n(Zs),Hs=__webpack_require__(4589),$s=__webpack_require__.n(Hs),Js=__webpack_require__(1828),Qs={};Qs.styleTagTransform=$s(),Qs.setAttributes=Ws(),Qs.insert=js().bind(null,"head"),Qs.domAPI=Xs(),Qs.insertStyleElement=Ks(),Gs()(Js.Z,Qs),Js.Z&&Js.Z.locals&&Js.Z.locals;var to=__webpack_require__(1788),eo={};function io(t,e){let i=[],n=[],r=cv.matFromImageData(t);console.log(r);let s=cv.Mat.zeros(r.rows,r.cols,cv.CV_8UC3);console.log(s),cv.cvtColor(r,r,cv.COLOR_RGBA2GRAY,0),cv.threshold(r,r,0,255,cv.THRESH_BINARY);let o=new cv.MatVector,a=new cv.Mat;cv.findContours(r,o,a,cv.RETR_CCOMP,cv.CHAIN_APPROX_SIMPLE);for(let t=0;t<o.size();++t){let e=new cv.Scalar(Math.round(255*Math.random()),Math.round(255*Math.random()),Math.round(255*Math.random()));cv.drawContours(s,o,t,e,1,cv.LINE_8,a,10),n.push([e[0],e[1],e[2]])}return i=s,e&&cv.imshow(e,s),r.delete(),{contour:i.data,color:n}}function no(t,e){let i=cv.matFromImageData(t);console.log(i);let n=cv.Mat.zeros(i.rows,i.cols,cv.CV_8UC3);console.log(n),cv.cvtColor(i,i,cv.COLOR_RGBA2GRAY,0);let r=new cv.Size(3,3),s=new cv.Point(-1,-1);return cv.blur(i,i,r,s,cv.BORDER_DEFAULT),cv.Canny(i,n,50,100,3,!1),i.delete(),n}function ro(){}function so(t){return null==t?ro:function(){return this.querySelector(t)}}function oo(){return[]}function ao(t){return null==t?oo:function(){return this.querySelectorAll(t)}}function ho(t){return function(){return this.matches(t)}}function lo(t){return function(e){return e.matches(t)}}eo.styleTagTransform=$s(),eo.setAttributes=Ws(),eo.insert=js().bind(null,"head"),eo.domAPI=Xs(),eo.insertStyleElement=Ks(),Gs()(to.Z,eo),to.Z&&to.Z.locals&&to.Z.locals;var co=Array.prototype.find;function uo(){return this.firstElementChild}var fo=Array.prototype.filter;function go(){return Array.from(this.children)}function mo(t){return new Array(t.length)}function po(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}function _o(t,e,i,n,r,s){for(var o,a=0,h=e.length,l=s.length;a<l;++a)(o=e[a])?(o.__data__=s[a],n[a]=o):i[a]=new po(t,s[a]);for(;a<h;++a)(o=e[a])&&(r[a]=o)}function wo(t,e,i,n,r,s,o){var a,h,l,c=new Map,u=e.length,d=s.length,f=new Array(u);for(a=0;a<u;++a)(h=e[a])&&(f[a]=l=o.call(h,h.__data__,a,e)+"",c.has(l)?r[a]=h:c.set(l,h));for(a=0;a<d;++a)l=o.call(t,s[a],a,s)+"",(h=c.get(l))?(n[a]=h,h.__data__=s[a],c.delete(l)):i[a]=new po(t,s[a]);for(a=0;a<u;++a)(h=e[a])&&c.get(f[a])===h&&(r[a]=h)}function yo(t){return t.__data__}function vo(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}function bo(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}po.prototype={constructor:po,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};var xo="http://www.w3.org/1999/xhtml";const Mo={svg:"http://www.w3.org/2000/svg",xhtml:xo,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Eo(t){var e=t+="",i=e.indexOf(":");return i>=0&&"xmlns"!==(e=t.slice(0,i))&&(t=t.slice(i+1)),Mo.hasOwnProperty(e)?{space:Mo[e],local:t}:t}function So(t){return function(){this.removeAttribute(t)}}function ko(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Co(t,e){return function(){this.setAttribute(t,e)}}function Io(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function Ao(t,e){return function(){var i=e.apply(this,arguments);null==i?this.removeAttribute(t):this.setAttribute(t,i)}}function To(t,e){return function(){var i=e.apply(this,arguments);null==i?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,i)}}function Ro(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function Po(t){return function(){this.style.removeProperty(t)}}function Do(t,e,i){return function(){this.style.setProperty(t,e,i)}}function Fo(t,e,i){return function(){var n=e.apply(this,arguments);null==n?this.style.removeProperty(t):this.style.setProperty(t,n,i)}}function Lo(t,e){return t.style.getPropertyValue(e)||Ro(t).getComputedStyle(t,null).getPropertyValue(e)}function Oo(t){return function(){delete this[t]}}function No(t,e){return function(){this[t]=e}}function Bo(t,e){return function(){var i=e.apply(this,arguments);null==i?delete this[t]:this[t]=i}}function zo(t){return t.trim().split(/^|\s+/)}function Uo(t){return t.classList||new Go(t)}function Go(t){this._node=t,this._names=zo(t.getAttribute("class")||"")}function Yo(t,e){for(var i=Uo(t),n=-1,r=e.length;++n<r;)i.add(e[n])}function Xo(t,e){for(var i=Uo(t),n=-1,r=e.length;++n<r;)i.remove(e[n])}function Vo(t){return function(){Yo(this,t)}}function jo(t){return function(){Xo(this,t)}}function qo(t,e){return function(){(e.apply(this,arguments)?Yo:Xo)(this,t)}}function Wo(){this.textContent=""}function Zo(t){return function(){this.textContent=t}}function Ko(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}function Ho(){this.innerHTML=""}function $o(t){return function(){this.innerHTML=t}}function Jo(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}function Qo(){this.nextSibling&&this.parentNode.appendChild(this)}function ta(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function ea(t){return function(){var e=this.ownerDocument,i=this.namespaceURI;return i===xo&&e.documentElement.namespaceURI===xo?e.createElement(t):e.createElementNS(i,t)}}function ia(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function na(t){var e=Eo(t);return(e.local?ia:ea)(e)}function ra(){return null}function sa(){var t=this.parentNode;t&&t.removeChild(this)}function oa(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function aa(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function ha(t){return function(){var e=this.__on;if(e){for(var i,n=0,r=-1,s=e.length;n<s;++n)i=e[n],t.type&&i.type!==t.type||i.name!==t.name?e[++r]=i:this.removeEventListener(i.type,i.listener,i.options);++r?e.length=r:delete this.__on}}}function la(t,e,i){return function(){var n,r=this.__on,s=function(t){return function(e){t.call(this,e,this.__data__)}}(e);if(r)for(var o=0,a=r.length;o<a;++o)if((n=r[o]).type===t.type&&n.name===t.name)return this.removeEventListener(n.type,n.listener,n.options),this.addEventListener(n.type,n.listener=s,n.options=i),void(n.value=e);this.addEventListener(t.type,s,i),n={type:t.type,name:t.name,value:e,listener:s,options:i},r?r.push(n):this.__on=[n]}}function ca(t,e,i){var n=Ro(t),r=n.CustomEvent;"function"==typeof r?r=new r(e,i):(r=n.document.createEvent("Event"),i?(r.initEvent(e,i.bubbles,i.cancelable),r.detail=i.detail):r.initEvent(e,!1,!1)),t.dispatchEvent(r)}function ua(t,e){return function(){return ca(this,t,e)}}function da(t,e){return function(){return ca(this,t,e.apply(this,arguments))}}Go.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var fa=[null];function ga(t,e){this._groups=t,this._parents=e}function ma(){return new ga([[document.documentElement]],fa)}ga.prototype=ma.prototype={constructor:ga,select:function(t){"function"!=typeof t&&(t=so(t));for(var e=this._groups,i=e.length,n=new Array(i),r=0;r<i;++r)for(var s,o,a=e[r],h=a.length,l=n[r]=new Array(h),c=0;c<h;++c)(s=a[c])&&(o=t.call(s,s.__data__,c,a))&&("__data__"in s&&(o.__data__=s.__data__),l[c]=o);return new ga(n,this._parents)},selectAll:function(t){t="function"==typeof t?function(t){return function(){return null==(e=t.apply(this,arguments))?[]:Array.isArray(e)?e:Array.from(e);var e}}(t):ao(t);for(var e=this._groups,i=e.length,n=[],r=[],s=0;s<i;++s)for(var o,a=e[s],h=a.length,l=0;l<h;++l)(o=a[l])&&(n.push(t.call(o,o.__data__,l,a)),r.push(o));return new ga(n,r)},selectChild:function(t){return this.select(null==t?uo:function(t){return function(){return co.call(this.children,t)}}("function"==typeof t?t:lo(t)))},selectChildren:function(t){return this.selectAll(null==t?go:function(t){return function(){return fo.call(this.children,t)}}("function"==typeof t?t:lo(t)))},filter:function(t){"function"!=typeof t&&(t=ho(t));for(var e=this._groups,i=e.length,n=new Array(i),r=0;r<i;++r)for(var s,o=e[r],a=o.length,h=n[r]=[],l=0;l<a;++l)(s=o[l])&&t.call(s,s.__data__,l,o)&&h.push(s);return new ga(n,this._parents)},data:function(t,e){if(!arguments.length)return Array.from(this,yo);var i,n=e?wo:_o,r=this._parents,s=this._groups;"function"!=typeof t&&(i=t,t=function(){return i});for(var o=s.length,a=new Array(o),h=new Array(o),l=new Array(o),c=0;c<o;++c){var u=r[c],d=s[c],f=d.length,g=vo(t.call(u,u&&u.__data__,c,r)),m=g.length,p=h[c]=new Array(m),_=a[c]=new Array(m);n(u,d,p,_,l[c]=new Array(f),g,e);for(var w,y,v=0,b=0;v<m;++v)if(w=p[v]){for(v>=b&&(b=v+1);!(y=_[b])&&++b<m;);w._next=y||null}}return(a=new ga(a,r))._enter=h,a._exit=l,a},enter:function(){return new ga(this._enter||this._groups.map(mo),this._parents)},exit:function(){return new ga(this._exit||this._groups.map(mo),this._parents)},join:function(t,e,i){var n=this.enter(),r=this,s=this.exit();return"function"==typeof t?(n=t(n))&&(n=n.selection()):n=n.append(t+""),null!=e&&(r=e(r))&&(r=r.selection()),null==i?s.remove():i(s),n&&r?n.merge(r).order():r},merge:function(t){for(var e=t.selection?t.selection():t,i=this._groups,n=e._groups,r=i.length,s=n.length,o=Math.min(r,s),a=new Array(r),h=0;h<o;++h)for(var l,c=i[h],u=n[h],d=c.length,f=a[h]=new Array(d),g=0;g<d;++g)(l=c[g]||u[g])&&(f[g]=l);for(;h<r;++h)a[h]=i[h];return new ga(a,this._parents)},selection:function(){return this},order:function(){for(var t=this._groups,e=-1,i=t.length;++e<i;)for(var n,r=t[e],s=r.length-1,o=r[s];--s>=0;)(n=r[s])&&(o&&4^n.compareDocumentPosition(o)&&o.parentNode.insertBefore(n,o),o=n);return this},sort:function(t){function e(e,i){return e&&i?t(e.__data__,i.__data__):!e-!i}t||(t=bo);for(var i=this._groups,n=i.length,r=new Array(n),s=0;s<n;++s){for(var o,a=i[s],h=a.length,l=r[s]=new Array(h),c=0;c<h;++c)(o=a[c])&&(l[c]=o);l.sort(e)}return new ga(r,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var t=this._groups,e=0,i=t.length;e<i;++e)for(var n=t[e],r=0,s=n.length;r<s;++r){var o=n[r];if(o)return o}return null},size:function(){let t=0;for(const e of this)++t;return t},empty:function(){return!this.node()},each:function(t){for(var e=this._groups,i=0,n=e.length;i<n;++i)for(var r,s=e[i],o=0,a=s.length;o<a;++o)(r=s[o])&&t.call(r,r.__data__,o,s);return this},attr:function(t,e){var i=Eo(t);if(arguments.length<2){var n=this.node();return i.local?n.getAttributeNS(i.space,i.local):n.getAttribute(i)}return this.each((null==e?i.local?ko:So:"function"==typeof e?i.local?To:Ao:i.local?Io:Co)(i,e))},style:function(t,e,i){return arguments.length>1?this.each((null==e?Po:"function"==typeof e?Fo:Do)(t,e,null==i?"":i)):Lo(this.node(),t)},property:function(t,e){return arguments.length>1?this.each((null==e?Oo:"function"==typeof e?Bo:No)(t,e)):this.node()[t]},classed:function(t,e){var i=zo(t+"");if(arguments.length<2){for(var n=Uo(this.node()),r=-1,s=i.length;++r<s;)if(!n.contains(i[r]))return!1;return!0}return this.each(("function"==typeof e?qo:e?Vo:jo)(i,e))},text:function(t){return arguments.length?this.each(null==t?Wo:("function"==typeof t?Ko:Zo)(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?Ho:("function"==typeof t?Jo:$o)(t)):this.node().innerHTML},raise:function(){return this.each(Qo)},lower:function(){return this.each(ta)},append:function(t){var e="function"==typeof t?t:na(t);return this.select((function(){return this.appendChild(e.apply(this,arguments))}))},insert:function(t,e){var i="function"==typeof t?t:na(t),n=null==e?ra:"function"==typeof e?e:so(e);return this.select((function(){return this.insertBefore(i.apply(this,arguments),n.apply(this,arguments)||null)}))},remove:function(){return this.each(sa)},clone:function(t){return this.select(t?aa:oa)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,e,i){var n,r,s=function(t){return t.trim().split(/^|\s+/).map((function(t){var e="",i=t.indexOf(".");return i>=0&&(e=t.slice(i+1),t=t.slice(0,i)),{type:t,name:e}}))}(t+""),o=s.length;if(!(arguments.length<2)){for(a=e?la:ha,n=0;n<o;++n)this.each(a(s[n],e,i));return this}var a=this.node().__on;if(a)for(var h,l=0,c=a.length;l<c;++l)for(n=0,h=a[l];n<o;++n)if((r=s[n]).type===h.type&&r.name===h.name)return h.value},dispatch:function(t,e){return this.each(("function"==typeof e?da:ua)(t,e))},[Symbol.iterator]:function*(){for(var t=this._groups,e=0,i=t.length;e<i;++e)for(var n,r=t[e],s=0,o=r.length;s<o;++s)(n=r[s])&&(yield n)}};const pa=ma;var _a={value:()=>{}};function wa(){for(var t,e=0,i=arguments.length,n={};e<i;++e){if(!(t=arguments[e]+"")||t in n||/[\s.]/.test(t))throw new Error("illegal type: "+t);n[t]=[]}return new ya(n)}function ya(t){this._=t}function va(t,e){for(var i,n=0,r=t.length;n<r;++n)if((i=t[n]).name===e)return i.value}function ba(t,e,i){for(var n=0,r=t.length;n<r;++n)if(t[n].name===e){t[n]=_a,t=t.slice(0,n).concat(t.slice(n+1));break}return null!=i&&t.push({name:e,value:i}),t}ya.prototype=wa.prototype={constructor:ya,on:function(t,e){var i,n=this._,r=function(t,e){return t.trim().split(/^|\s+/).map((function(t){var i="",n=t.indexOf(".");if(n>=0&&(i=t.slice(n+1),t=t.slice(0,n)),t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:i}}))}(t+"",n),s=-1,o=r.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++s<o;)if(i=(t=r[s]).type)n[i]=ba(n[i],t.name,e);else if(null==e)for(i in n)n[i]=ba(n[i],t.name,null);return this}for(;++s<o;)if((i=(t=r[s]).type)&&(i=va(n[i],t.name)))return i},copy:function(){var t={},e=this._;for(var i in e)t[i]=e[i].slice();return new ya(t)},call:function(t,e){if((i=arguments.length-2)>0)for(var i,n,r=new Array(i),s=0;s<i;++s)r[s]=arguments[s+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(s=0,i=(n=this._[t]).length;s<i;++s)n[s].value.apply(e,r)},apply:function(t,e,i){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var n=this._[t],r=0,s=n.length;r<s;++r)n[r].value.apply(e,i)}};const xa=wa;var Ma,Ea,Sa=0,ka=0,Ca=0,Ia=1e3,Aa=0,Ta=0,Ra=0,Pa="object"==typeof performance&&performance.now?performance:Date,Da="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function Fa(){return Ta||(Da(La),Ta=Pa.now()+Ra)}function La(){Ta=0}function Oa(){this._call=this._time=this._next=null}function Na(t,e,i){var n=new Oa;return n.restart(t,e,i),n}function Ba(){Ta=(Aa=Pa.now())+Ra,Sa=ka=0;try{!function(){Fa(),++Sa;for(var t,e=Ma;e;)(t=Ta-e._time)>=0&&e._call.call(void 0,t),e=e._next;--Sa}()}finally{Sa=0,function(){for(var t,e,i=Ma,n=1/0;i;)i._call?(n>i._time&&(n=i._time),t=i,i=i._next):(e=i._next,i._next=null,i=t?t._next=e:Ma=e);Ea=t,Ua(n)}(),Ta=0}}function za(){var t=Pa.now(),e=t-Aa;e>Ia&&(Ra-=e,Aa=t)}function Ua(t){Sa||(ka&&(ka=clearTimeout(ka)),t-Ta>24?(t<1/0&&(ka=setTimeout(Ba,t-Pa.now()-Ra)),Ca&&(Ca=clearInterval(Ca))):(Ca||(Aa=Pa.now(),Ca=setInterval(za,Ia)),Sa=1,Da(Ba)))}function Ga(t,e,i){var n=new Oa;return e=null==e?0:+e,n.restart((i=>{n.stop(),t(i+e)}),e,i),n}Oa.prototype=Na.prototype={constructor:Oa,restart:function(t,e,i){if("function"!=typeof t)throw new TypeError("callback is not a function");i=(null==i?Fa():+i)+(null==e?0:+e),this._next||Ea===this||(Ea?Ea._next=this:Ma=this,Ea=this),this._call=t,this._time=i,Ua()},stop:function(){this._call&&(this._call=null,this._time=1/0,Ua())}};var Ya=xa("start","end","cancel","interrupt"),Xa=[],Va=0,ja=3;function qa(t,e,i,n,r,s){var o=t.__transition;if(o){if(i in o)return}else t.__transition={};!function(t,e,i){var n,r=t.__transition;function s(h){var l,c,u,d;if(1!==i.state)return a();for(l in r)if((d=r[l]).name===i.name){if(d.state===ja)return Ga(s);4===d.state?(d.state=6,d.timer.stop(),d.on.call("interrupt",t,t.__data__,d.index,d.group),delete r[l]):+l<e&&(d.state=6,d.timer.stop(),d.on.call("cancel",t,t.__data__,d.index,d.group),delete r[l])}if(Ga((function(){i.state===ja&&(i.state=4,i.timer.restart(o,i.delay,i.time),o(h))})),i.state=2,i.on.call("start",t,t.__data__,i.index,i.group),2===i.state){for(i.state=ja,n=new Array(u=i.tween.length),l=0,c=-1;l<u;++l)(d=i.tween[l].value.call(t,t.__data__,i.index,i.group))&&(n[++c]=d);n.length=c+1}}function o(e){for(var r=e<i.duration?i.ease.call(null,e/i.duration):(i.timer.restart(a),i.state=5,1),s=-1,o=n.length;++s<o;)n[s].call(t,r);5===i.state&&(i.on.call("end",t,t.__data__,i.index,i.group),a())}function a(){for(var n in i.state=6,i.timer.stop(),delete r[e],r)return;delete t.__transition}r[e]=i,i.timer=Na((function(t){i.state=1,i.timer.restart(s,i.delay,i.time),i.delay<=t&&s(t-i.delay)}),0,i.time)}(t,i,{name:e,index:n,group:r,on:Ya,tween:Xa,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:Va})}function Wa(t,e){var i=Ka(t,e);if(i.state>Va)throw new Error("too late; already scheduled");return i}function Za(t,e){var i=Ka(t,e);if(i.state>ja)throw new Error("too late; already running");return i}function Ka(t,e){var i=t.__transition;if(!i||!(i=i[e]))throw new Error("transition not found");return i}function Ha(t,e){return t=+t,e=+e,function(i){return t*(1-i)+e*i}}var $a,Ja=180/Math.PI,Qa={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function th(t,e,i,n,r,s){var o,a,h;return(o=Math.sqrt(t*t+e*e))&&(t/=o,e/=o),(h=t*i+e*n)&&(i-=t*h,n-=e*h),(a=Math.sqrt(i*i+n*n))&&(i/=a,n/=a,h/=a),t*n<e*i&&(t=-t,e=-e,h=-h,o=-o),{translateX:r,translateY:s,rotate:Math.atan2(e,t)*Ja,skewX:Math.atan(h)*Ja,scaleX:o,scaleY:a}}function eh(t,e,i,n){function r(t){return t.length?t.pop()+" ":""}return function(s,o){var a=[],h=[];return s=t(s),o=t(o),function(t,n,r,s,o,a){if(t!==r||n!==s){var h=o.push("translate(",null,e,null,i);a.push({i:h-4,x:Ha(t,r)},{i:h-2,x:Ha(n,s)})}else(r||s)&&o.push("translate("+r+e+s+i)}(s.translateX,s.translateY,o.translateX,o.translateY,a,h),function(t,e,i,s){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),s.push({i:i.push(r(i)+"rotate(",null,n)-2,x:Ha(t,e)})):e&&i.push(r(i)+"rotate("+e+n)}(s.rotate,o.rotate,a,h),function(t,e,i,s){t!==e?s.push({i:i.push(r(i)+"skewX(",null,n)-2,x:Ha(t,e)}):e&&i.push(r(i)+"skewX("+e+n)}(s.skewX,o.skewX,a,h),function(t,e,i,n,s,o){if(t!==i||e!==n){var a=s.push(r(s)+"scale(",null,",",null,")");o.push({i:a-4,x:Ha(t,i)},{i:a-2,x:Ha(e,n)})}else 1===i&&1===n||s.push(r(s)+"scale("+i+","+n+")")}(s.scaleX,s.scaleY,o.scaleX,o.scaleY,a,h),s=o=null,function(t){for(var e,i=-1,n=h.length;++i<n;)a[(e=h[i]).i]=e.x(t);return a.join("")}}}var ih=eh((function(t){const e=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?Qa:th(e.a,e.b,e.c,e.d,e.e,e.f)}),"px, ","px)","deg)"),nh=eh((function(t){return null==t?Qa:($a||($a=document.createElementNS("http://www.w3.org/2000/svg","g")),$a.setAttribute("transform",t),(t=$a.transform.baseVal.consolidate())?th((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):Qa)}),", ",")",")");function rh(t,e){var i,n;return function(){var r=Za(this,t),s=r.tween;if(s!==i)for(var o=0,a=(n=i=s).length;o<a;++o)if(n[o].name===e){(n=n.slice()).splice(o,1);break}r.tween=n}}function sh(t,e,i){var n,r;if("function"!=typeof i)throw new Error;return function(){var s=Za(this,t),o=s.tween;if(o!==n){r=(n=o).slice();for(var a={name:e,value:i},h=0,l=r.length;h<l;++h)if(r[h].name===e){r[h]=a;break}h===l&&r.push(a)}s.tween=r}}function oh(t,e,i){var n=t._id;return t.each((function(){var t=Za(this,n);(t.value||(t.value={}))[e]=i.apply(this,arguments)})),function(t){return Ka(t,n).value[e]}}function ah(t,e,i){t.prototype=e.prototype=i,i.constructor=t}function hh(t,e){var i=Object.create(t.prototype);for(var n in e)i[n]=e[n];return i}function lh(){}var ch=.7,uh=1/ch,dh="\\s*([+-]?\\d+)\\s*",fh="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",gh="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",mh=/^#([0-9a-f]{3,8})$/,ph=new RegExp(`^rgb\\(${dh},${dh},${dh}\\)$`),_h=new RegExp(`^rgb\\(${gh},${gh},${gh}\\)$`),wh=new RegExp(`^rgba\\(${dh},${dh},${dh},${fh}\\)$`),yh=new RegExp(`^rgba\\(${gh},${gh},${gh},${fh}\\)$`),vh=new RegExp(`^hsl\\(${fh},${gh},${gh}\\)$`),bh=new RegExp(`^hsla\\(${fh},${gh},${gh},${fh}\\)$`),xh={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Mh(){return this.rgb().formatHex()}function Eh(){return this.rgb().formatRgb()}function Sh(t){var e,i;return t=(t+"").trim().toLowerCase(),(e=mh.exec(t))?(i=e[1].length,e=parseInt(e[1],16),6===i?kh(e):3===i?new Ah(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===i?Ch(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===i?Ch(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=ph.exec(t))?new Ah(e[1],e[2],e[3],1):(e=_h.exec(t))?new Ah(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=wh.exec(t))?Ch(e[1],e[2],e[3],e[4]):(e=yh.exec(t))?Ch(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=vh.exec(t))?Lh(e[1],e[2]/100,e[3]/100,1):(e=bh.exec(t))?Lh(e[1],e[2]/100,e[3]/100,e[4]):xh.hasOwnProperty(t)?kh(xh[t]):"transparent"===t?new Ah(NaN,NaN,NaN,0):null}function kh(t){return new Ah(t>>16&255,t>>8&255,255&t,1)}function Ch(t,e,i,n){return n<=0&&(t=e=i=NaN),new Ah(t,e,i,n)}function Ih(t,e,i,n){return 1===arguments.length?((r=t)instanceof lh||(r=Sh(r)),r?new Ah((r=r.rgb()).r,r.g,r.b,r.opacity):new Ah):new Ah(t,e,i,null==n?1:n);var r}function Ah(t,e,i,n){this.r=+t,this.g=+e,this.b=+i,this.opacity=+n}function Th(){return`#${Fh(this.r)}${Fh(this.g)}${Fh(this.b)}`}function Rh(){const t=Ph(this.opacity);return`${1===t?"rgb(":"rgba("}${Dh(this.r)}, ${Dh(this.g)}, ${Dh(this.b)}${1===t?")":`, ${t})`}`}function Ph(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function Dh(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function Fh(t){return((t=Dh(t))<16?"0":"")+t.toString(16)}function Lh(t,e,i,n){return n<=0?t=e=i=NaN:i<=0||i>=1?t=e=NaN:e<=0&&(t=NaN),new Nh(t,e,i,n)}function Oh(t){if(t instanceof Nh)return new Nh(t.h,t.s,t.l,t.opacity);if(t instanceof lh||(t=Sh(t)),!t)return new Nh;if(t instanceof Nh)return t;var e=(t=t.rgb()).r/255,i=t.g/255,n=t.b/255,r=Math.min(e,i,n),s=Math.max(e,i,n),o=NaN,a=s-r,h=(s+r)/2;return a?(o=e===s?(i-n)/a+6*(i<n):i===s?(n-e)/a+2:(e-i)/a+4,a/=h<.5?s+r:2-s-r,o*=60):a=h>0&&h<1?0:o,new Nh(o,a,h,t.opacity)}function Nh(t,e,i,n){this.h=+t,this.s=+e,this.l=+i,this.opacity=+n}function Bh(t){return(t=(t||0)%360)<0?t+360:t}function zh(t){return Math.max(0,Math.min(1,t||0))}function Uh(t,e,i){return 255*(t<60?e+(i-e)*t/60:t<180?i:t<240?e+(i-e)*(240-t)/60:e)}function Gh(t,e,i,n,r){var s=t*t,o=s*t;return((1-3*t+3*s-o)*e+(4-6*s+3*o)*i+(1+3*t+3*s-3*o)*n+o*r)/6}ah(lh,Sh,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:Mh,formatHex:Mh,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return Oh(this).formatHsl()},formatRgb:Eh,toString:Eh}),ah(Ah,Ih,hh(lh,{brighter(t){return t=null==t?uh:Math.pow(uh,t),new Ah(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=null==t?ch:Math.pow(ch,t),new Ah(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new Ah(Dh(this.r),Dh(this.g),Dh(this.b),Ph(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Th,formatHex:Th,formatHex8:function(){return`#${Fh(this.r)}${Fh(this.g)}${Fh(this.b)}${Fh(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:Rh,toString:Rh})),ah(Nh,(function(t,e,i,n){return 1===arguments.length?Oh(t):new Nh(t,e,i,null==n?1:n)}),hh(lh,{brighter(t){return t=null==t?uh:Math.pow(uh,t),new Nh(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=null==t?ch:Math.pow(ch,t),new Nh(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,i=this.l,n=i+(i<.5?i:1-i)*e,r=2*i-n;return new Ah(Uh(t>=240?t-240:t+120,r,n),Uh(t,r,n),Uh(t<120?t+240:t-120,r,n),this.opacity)},clamp(){return new Nh(Bh(this.h),zh(this.s),zh(this.l),Ph(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=Ph(this.opacity);return`${1===t?"hsl(":"hsla("}${Bh(this.h)}, ${100*zh(this.s)}%, ${100*zh(this.l)}%${1===t?")":`, ${t})`}`}}));const Yh=t=>()=>t;function Xh(t,e){var i=e-t;return i?function(t,e){return function(i){return t+i*e}}(t,i):Yh(isNaN(t)?e:t)}const Vh=function t(e){var i=function(t){return 1==(t=+t)?Xh:function(e,i){return i-e?function(t,e,i){return t=Math.pow(t,i),e=Math.pow(e,i)-t,i=1/i,function(n){return Math.pow(t+n*e,i)}}(e,i,t):Yh(isNaN(e)?i:e)}}(e);function n(t,e){var n=i((t=Ih(t)).r,(e=Ih(e)).r),r=i(t.g,e.g),s=i(t.b,e.b),o=Xh(t.opacity,e.opacity);return function(e){return t.r=n(e),t.g=r(e),t.b=s(e),t.opacity=o(e),t+""}}return n.gamma=t,n}(1);function jh(t){return function(e){var i,n,r=e.length,s=new Array(r),o=new Array(r),a=new Array(r);for(i=0;i<r;++i)n=Ih(e[i]),s[i]=n.r||0,o[i]=n.g||0,a[i]=n.b||0;return s=t(s),o=t(o),a=t(a),n.opacity=1,function(t){return n.r=s(t),n.g=o(t),n.b=a(t),n+""}}}jh((function(t){var e=t.length-1;return function(i){var n=i<=0?i=0:i>=1?(i=1,e-1):Math.floor(i*e),r=t[n],s=t[n+1],o=n>0?t[n-1]:2*r-s,a=n<e-1?t[n+2]:2*s-r;return Gh((i-n/e)*e,o,r,s,a)}})),jh((function(t){var e=t.length;return function(i){var n=Math.floor(((i%=1)<0?++i:i)*e),r=t[(n+e-1)%e],s=t[n%e],o=t[(n+1)%e],a=t[(n+2)%e];return Gh((i-n/e)*e,r,s,o,a)}}));var qh=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Wh=new RegExp(qh.source,"g");function Zh(t,e){var i,n,r,s=qh.lastIndex=Wh.lastIndex=0,o=-1,a=[],h=[];for(t+="",e+="";(i=qh.exec(t))&&(n=Wh.exec(e));)(r=n.index)>s&&(r=e.slice(s,r),a[o]?a[o]+=r:a[++o]=r),(i=i[0])===(n=n[0])?a[o]?a[o]+=n:a[++o]=n:(a[++o]=null,h.push({i:o,x:Ha(i,n)})),s=Wh.lastIndex;return s<e.length&&(r=e.slice(s),a[o]?a[o]+=r:a[++o]=r),a.length<2?h[0]?function(t){return function(e){return t(e)+""}}(h[0].x):function(t){return function(){return t}}(e):(e=h.length,function(t){for(var i,n=0;n<e;++n)a[(i=h[n]).i]=i.x(t);return a.join("")})}function Kh(t,e){var i;return("number"==typeof e?Ha:e instanceof Sh?Vh:(i=Sh(e))?(e=i,Vh):Zh)(t,e)}function Hh(t){return function(){this.removeAttribute(t)}}function $h(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Jh(t,e,i){var n,r,s=i+"";return function(){var o=this.getAttribute(t);return o===s?null:o===n?r:r=e(n=o,i)}}function Qh(t,e,i){var n,r,s=i+"";return function(){var o=this.getAttributeNS(t.space,t.local);return o===s?null:o===n?r:r=e(n=o,i)}}function tl(t,e,i){var n,r,s;return function(){var o,a,h=i(this);if(null!=h)return(o=this.getAttribute(t))===(a=h+"")?null:o===n&&a===r?s:(r=a,s=e(n=o,h));this.removeAttribute(t)}}function el(t,e,i){var n,r,s;return function(){var o,a,h=i(this);if(null!=h)return(o=this.getAttributeNS(t.space,t.local))===(a=h+"")?null:o===n&&a===r?s:(r=a,s=e(n=o,h));this.removeAttributeNS(t.space,t.local)}}function il(t,e){var i,n;function r(){var r=e.apply(this,arguments);return r!==n&&(i=(n=r)&&function(t,e){return function(i){this.setAttributeNS(t.space,t.local,e.call(this,i))}}(t,r)),i}return r._value=e,r}function nl(t,e){var i,n;function r(){var r=e.apply(this,arguments);return r!==n&&(i=(n=r)&&function(t,e){return function(i){this.setAttribute(t,e.call(this,i))}}(t,r)),i}return r._value=e,r}function rl(t,e){return function(){Wa(this,t).delay=+e.apply(this,arguments)}}function sl(t,e){return e=+e,function(){Wa(this,t).delay=e}}function ol(t,e){return function(){Za(this,t).duration=+e.apply(this,arguments)}}function al(t,e){return e=+e,function(){Za(this,t).duration=e}}var hl=pa.prototype.constructor;function ll(t){return function(){this.style.removeProperty(t)}}var cl=0;function ul(t,e,i,n){this._groups=t,this._parents=e,this._name=i,this._id=n}function dl(){return++cl}var fl=pa.prototype;ul.prototype=function(t){return pa().transition(t)}.prototype={constructor:ul,select:function(t){var e=this._name,i=this._id;"function"!=typeof t&&(t=so(t));for(var n=this._groups,r=n.length,s=new Array(r),o=0;o<r;++o)for(var a,h,l=n[o],c=l.length,u=s[o]=new Array(c),d=0;d<c;++d)(a=l[d])&&(h=t.call(a,a.__data__,d,l))&&("__data__"in a&&(h.__data__=a.__data__),u[d]=h,qa(u[d],e,i,d,u,Ka(a,i)));return new ul(s,this._parents,e,i)},selectAll:function(t){var e=this._name,i=this._id;"function"!=typeof t&&(t=ao(t));for(var n=this._groups,r=n.length,s=[],o=[],a=0;a<r;++a)for(var h,l=n[a],c=l.length,u=0;u<c;++u)if(h=l[u]){for(var d,f=t.call(h,h.__data__,u,l),g=Ka(h,i),m=0,p=f.length;m<p;++m)(d=f[m])&&qa(d,e,i,m,f,g);s.push(f),o.push(h)}return new ul(s,o,e,i)},selectChild:fl.selectChild,selectChildren:fl.selectChildren,filter:function(t){"function"!=typeof t&&(t=ho(t));for(var e=this._groups,i=e.length,n=new Array(i),r=0;r<i;++r)for(var s,o=e[r],a=o.length,h=n[r]=[],l=0;l<a;++l)(s=o[l])&&t.call(s,s.__data__,l,o)&&h.push(s);return new ul(n,this._parents,this._name,this._id)},merge:function(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,i=t._groups,n=e.length,r=i.length,s=Math.min(n,r),o=new Array(n),a=0;a<s;++a)for(var h,l=e[a],c=i[a],u=l.length,d=o[a]=new Array(u),f=0;f<u;++f)(h=l[f]||c[f])&&(d[f]=h);for(;a<n;++a)o[a]=e[a];return new ul(o,this._parents,this._name,this._id)},selection:function(){return new hl(this._groups,this._parents)},transition:function(){for(var t=this._name,e=this._id,i=dl(),n=this._groups,r=n.length,s=0;s<r;++s)for(var o,a=n[s],h=a.length,l=0;l<h;++l)if(o=a[l]){var c=Ka(o,e);qa(o,t,i,l,a,{time:c.time+c.delay+c.duration,delay:0,duration:c.duration,ease:c.ease})}return new ul(n,this._parents,t,i)},call:fl.call,nodes:fl.nodes,node:fl.node,size:fl.size,empty:fl.empty,each:fl.each,on:function(t,e){var i=this._id;return arguments.length<2?Ka(this.node(),i).on.on(t):this.each(function(t,e,i){var n,r,s=function(t){return(t+"").trim().split(/^|\s+/).every((function(t){var e=t.indexOf(".");return e>=0&&(t=t.slice(0,e)),!t||"start"===t}))}(e)?Wa:Za;return function(){var o=s(this,t),a=o.on;a!==n&&(r=(n=a).copy()).on(e,i),o.on=r}}(i,t,e))},attr:function(t,e){var i=Eo(t),n="transform"===i?nh:Kh;return this.attrTween(t,"function"==typeof e?(i.local?el:tl)(i,n,oh(this,"attr."+t,e)):null==e?(i.local?$h:Hh)(i):(i.local?Qh:Jh)(i,n,e))},attrTween:function(t,e){var i="attr."+t;if(arguments.length<2)return(i=this.tween(i))&&i._value;if(null==e)return this.tween(i,null);if("function"!=typeof e)throw new Error;var n=Eo(t);return this.tween(i,(n.local?il:nl)(n,e))},style:function(t,e,i){var n="transform"==(t+="")?ih:Kh;return null==e?this.styleTween(t,function(t,e){var i,n,r;return function(){var s=Lo(this,t),o=(this.style.removeProperty(t),Lo(this,t));return s===o?null:s===i&&o===n?r:r=e(i=s,n=o)}}(t,n)).on("end.style."+t,ll(t)):"function"==typeof e?this.styleTween(t,function(t,e,i){var n,r,s;return function(){var o=Lo(this,t),a=i(this),h=a+"";return null==a&&(this.style.removeProperty(t),h=a=Lo(this,t)),o===h?null:o===n&&h===r?s:(r=h,s=e(n=o,a))}}(t,n,oh(this,"style."+t,e))).each(function(t,e){var i,n,r,s,o="style."+e,a="end."+o;return function(){var h=Za(this,t),l=h.on,c=null==h.value[o]?s||(s=ll(e)):void 0;l===i&&r===c||(n=(i=l).copy()).on(a,r=c),h.on=n}}(this._id,t)):this.styleTween(t,function(t,e,i){var n,r,s=i+"";return function(){var o=Lo(this,t);return o===s?null:o===n?r:r=e(n=o,i)}}(t,n,e),i).on("end.style."+t,null)},styleTween:function(t,e,i){var n="style."+(t+="");if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==e)return this.tween(n,null);if("function"!=typeof e)throw new Error;return this.tween(n,function(t,e,i){var n,r;function s(){var s=e.apply(this,arguments);return s!==r&&(n=(r=s)&&function(t,e,i){return function(n){this.style.setProperty(t,e.call(this,n),i)}}(t,s,i)),n}return s._value=e,s}(t,e,null==i?"":i))},text:function(t){return this.tween("text","function"==typeof t?function(t){return function(){var e=t(this);this.textContent=null==e?"":e}}(oh(this,"text",t)):function(t){return function(){this.textContent=t}}(null==t?"":t+""))},textTween:function(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(null==t)return this.tween(e,null);if("function"!=typeof t)throw new Error;return this.tween(e,function(t){var e,i;function n(){var n=t.apply(this,arguments);return n!==i&&(e=(i=n)&&function(t){return function(e){this.textContent=t.call(this,e)}}(n)),e}return n._value=t,n}(t))},remove:function(){return this.on("end.remove",function(t){return function(){var e=this.parentNode;for(var i in this.__transition)if(+i!==t)return;e&&e.removeChild(this)}}(this._id))},tween:function(t,e){var i=this._id;if(t+="",arguments.length<2){for(var n,r=Ka(this.node(),i).tween,s=0,o=r.length;s<o;++s)if((n=r[s]).name===t)return n.value;return null}return this.each((null==e?rh:sh)(i,t,e))},delay:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?rl:sl)(e,t)):Ka(this.node(),e).delay},duration:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?ol:al)(e,t)):Ka(this.node(),e).duration},ease:function(t){var e=this._id;return arguments.length?this.each(function(t,e){if("function"!=typeof e)throw new Error;return function(){Za(this,t).ease=e}}(e,t)):Ka(this.node(),e).ease},easeVarying:function(t){if("function"!=typeof t)throw new Error;return this.each(function(t,e){return function(){var i=e.apply(this,arguments);if("function"!=typeof i)throw new Error;Za(this,t).ease=i}}(this._id,t))},end:function(){var t,e,i=this,n=i._id,r=i.size();return new Promise((function(s,o){var a={value:o},h={value:function(){0==--r&&s()}};i.each((function(){var i=Za(this,n),r=i.on;r!==t&&((e=(t=r).copy())._.cancel.push(a),e._.interrupt.push(a),e._.end.push(h)),i.on=e})),0===r&&s()}))},[Symbol.iterator]:fl[Symbol.iterator]};var gl={time:null,delay:0,duration:250,ease:function(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}};function ml(t,e){for(var i;!(i=t.__transition)||!(i=i[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return i}pa.prototype.interrupt=function(t){return this.each((function(){!function(t,e){var i,n,r,s=t.__transition,o=!0;if(s){for(r in e=null==e?null:e+"",s)(i=s[r]).name===e?(n=i.state>2&&i.state<5,i.state=6,i.timer.stop(),i.on.call(n?"interrupt":"cancel",t,t.__data__,i.index,i.group),delete s[r]):o=!1;o&&delete t.__transition}}(this,t)}))},pa.prototype.transition=function(t){var e,i;t instanceof ul?(e=t._id,t=t._name):(e=dl(),(i=gl).time=Fa(),t=null==t?null:t+"");for(var n=this._groups,r=n.length,s=0;s<r;++s)for(var o,a=n[s],h=a.length,l=0;l<h;++l)(o=a[l])&&qa(o,t,e,l,a,i||ml(o,e));return new ul(n,this._parents,t,e)};const{abs:pl,max:_l,min:wl}=Math;function yl(t){return{type:t}}function vl(t,e,i){this.k=t,this.x=e,this.y=i}function bl(t){let e=[];for(let i=0;i<t.length;i+=4){let n=t[i],r=t[i+1],s=t[i+2];t[i+3],e.push([n,r,s])}return e}function xl(t,e,i,n){return bl(e)[t[1]*i+t[0]]}["w","e"].map(yl),["n","s"].map(yl),["n","w","e","s","nw","ne","sw","se"].map(yl),vl.prototype={constructor:vl,scale:function(t){return 1===t?this:new vl(this.k*t,this.x,this.y)},translate:function(t,e){return 0===t&0===e?this:new vl(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}},new vl(1,0,0),vl.prototype;const Ml={getBit(t){return this.data[El(t)]&1<<Sl(t)?1:0},setBit(t){this.data[El(t)]|=1<<Sl(t)},clearBit(t){this.data[El(t)]&=~(1<<Sl(t))},toggleBit(t){this.data[El(t)]^=1<<Sl(t)},getBitXY(t,e){return t>=this.width||e>=this.height?0:this.getBit(e*this.width+t)},setBitXY(t,e){this.setBit(e*this.width+t)},clearBitXY(t,e){this.clearBit(e*this.width+t)},toggleBitXY(t,e){this.toggleBit(e*this.width+t)}};function El(t){return t>>3}function Sl(t){return 7-(7&t)}function kl(t,e,i){return"function"==typeof t.toBlob?new Promise((function(n){t.toBlob(n,e,i)})):Promise.resolve(function(t){var e=t.match(/data:([^;]+)/)[1],i=t.replace(/^[^,]+,/,"");return function(t,e){t=t||[],"string"==typeof(e=e||{})&&(e={type:e});try{return new Blob(t,e)}catch(r){if("TypeError"!==r.name)throw r;for(var i=new("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),n=0;n<t.length;n+=1)i.append(t[n]);return i.getBlob(e.type)}}([Cl(atob(i))],{type:e})}(t.toDataURL(e,i)))}function Cl(t){for(var e=t.length,i=new ArrayBuffer(e),n=new Uint8Array(i),r=-1;++r<e;)n[r]=t.charCodeAt(r);return i}var Il=__webpack_require__(4665),Al=__webpack_require__(2155);function Tl(t){let e=t.length;for(;--e>=0;)t[e]=0}const Rl=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),Pl=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),Dl=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),Fl=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Ll=new Array(576);Tl(Ll);const Ol=new Array(60);Tl(Ol);const Nl=new Array(512);Tl(Nl);const Bl=new Array(256);Tl(Bl);const zl=new Array(29);Tl(zl);const Ul=new Array(30);function Gl(t,e,i,n,r){this.static_tree=t,this.extra_bits=e,this.extra_base=i,this.elems=n,this.max_length=r,this.has_stree=t&&t.length}let Yl,Xl,Vl;function jl(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e}Tl(Ul);const ql=t=>t<256?Nl[t]:Nl[256+(t>>>7)],Wl=(t,e)=>{t.pending_buf[t.pending++]=255&e,t.pending_buf[t.pending++]=e>>>8&255},Zl=(t,e,i)=>{t.bi_valid>16-i?(t.bi_buf|=e<<t.bi_valid&65535,Wl(t,t.bi_buf),t.bi_buf=e>>16-t.bi_valid,t.bi_valid+=i-16):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=i)},Kl=(t,e,i)=>{Zl(t,i[2*e],i[2*e+1])},Hl=(t,e)=>{let i=0;do{i|=1&t,t>>>=1,i<<=1}while(--e>0);return i>>>1},$l=(t,e,i)=>{const n=new Array(16);let r,s,o=0;for(r=1;r<=15;r++)o=o+i[r-1]<<1,n[r]=o;for(s=0;s<=e;s++){let e=t[2*s+1];0!==e&&(t[2*s]=Hl(n[e]++,e))}},Jl=t=>{let e;for(e=0;e<286;e++)t.dyn_ltree[2*e]=0;for(e=0;e<30;e++)t.dyn_dtree[2*e]=0;for(e=0;e<19;e++)t.bl_tree[2*e]=0;t.dyn_ltree[512]=1,t.opt_len=t.static_len=0,t.sym_next=t.matches=0},Ql=t=>{t.bi_valid>8?Wl(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0},tc=(t,e,i,n)=>{const r=2*e,s=2*i;return t[r]<t[s]||t[r]===t[s]&&n[e]<=n[i]},ec=(t,e,i)=>{const n=t.heap[i];let r=i<<1;for(;r<=t.heap_len&&(r<t.heap_len&&tc(e,t.heap[r+1],t.heap[r],t.depth)&&r++,!tc(e,n,t.heap[r],t.depth));)t.heap[i]=t.heap[r],i=r,r<<=1;t.heap[i]=n},ic=(t,e,i)=>{let n,r,s,o,a=0;if(0!==t.sym_next)do{n=255&t.pending_buf[t.sym_buf+a++],n+=(255&t.pending_buf[t.sym_buf+a++])<<8,r=t.pending_buf[t.sym_buf+a++],0===n?Kl(t,r,e):(s=Bl[r],Kl(t,s+256+1,e),o=Rl[s],0!==o&&(r-=zl[s],Zl(t,r,o)),n--,s=ql(n),Kl(t,s,i),o=Pl[s],0!==o&&(n-=Ul[s],Zl(t,n,o)))}while(a<t.sym_next);Kl(t,256,e)},nc=(t,e)=>{const i=e.dyn_tree,n=e.stat_desc.static_tree,r=e.stat_desc.has_stree,s=e.stat_desc.elems;let o,a,h,l=-1;for(t.heap_len=0,t.heap_max=573,o=0;o<s;o++)0!==i[2*o]?(t.heap[++t.heap_len]=l=o,t.depth[o]=0):i[2*o+1]=0;for(;t.heap_len<2;)h=t.heap[++t.heap_len]=l<2?++l:0,i[2*h]=1,t.depth[h]=0,t.opt_len--,r&&(t.static_len-=n[2*h+1]);for(e.max_code=l,o=t.heap_len>>1;o>=1;o--)ec(t,i,o);h=s;do{o=t.heap[1],t.heap[1]=t.heap[t.heap_len--],ec(t,i,1),a=t.heap[1],t.heap[--t.heap_max]=o,t.heap[--t.heap_max]=a,i[2*h]=i[2*o]+i[2*a],t.depth[h]=(t.depth[o]>=t.depth[a]?t.depth[o]:t.depth[a])+1,i[2*o+1]=i[2*a+1]=h,t.heap[1]=h++,ec(t,i,1)}while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],((t,e)=>{const i=e.dyn_tree,n=e.max_code,r=e.stat_desc.static_tree,s=e.stat_desc.has_stree,o=e.stat_desc.extra_bits,a=e.stat_desc.extra_base,h=e.stat_desc.max_length;let l,c,u,d,f,g,m=0;for(d=0;d<=15;d++)t.bl_count[d]=0;for(i[2*t.heap[t.heap_max]+1]=0,l=t.heap_max+1;l<573;l++)c=t.heap[l],d=i[2*i[2*c+1]+1]+1,d>h&&(d=h,m++),i[2*c+1]=d,c>n||(t.bl_count[d]++,f=0,c>=a&&(f=o[c-a]),g=i[2*c],t.opt_len+=g*(d+f),s&&(t.static_len+=g*(r[2*c+1]+f)));if(0!==m){do{for(d=h-1;0===t.bl_count[d];)d--;t.bl_count[d]--,t.bl_count[d+1]+=2,t.bl_count[h]--,m-=2}while(m>0);for(d=h;0!==d;d--)for(c=t.bl_count[d];0!==c;)u=t.heap[--l],u>n||(i[2*u+1]!==d&&(t.opt_len+=(d-i[2*u+1])*i[2*u],i[2*u+1]=d),c--)}})(t,e),$l(i,l,t.bl_count)},rc=(t,e,i)=>{let n,r,s=-1,o=e[1],a=0,h=7,l=4;for(0===o&&(h=138,l=3),e[2*(i+1)+1]=65535,n=0;n<=i;n++)r=o,o=e[2*(n+1)+1],++a<h&&r===o||(a<l?t.bl_tree[2*r]+=a:0!==r?(r!==s&&t.bl_tree[2*r]++,t.bl_tree[32]++):a<=10?t.bl_tree[34]++:t.bl_tree[36]++,a=0,s=r,0===o?(h=138,l=3):r===o?(h=6,l=3):(h=7,l=4))},sc=(t,e,i)=>{let n,r,s=-1,o=e[1],a=0,h=7,l=4;for(0===o&&(h=138,l=3),n=0;n<=i;n++)if(r=o,o=e[2*(n+1)+1],!(++a<h&&r===o)){if(a<l)do{Kl(t,r,t.bl_tree)}while(0!=--a);else 0!==r?(r!==s&&(Kl(t,r,t.bl_tree),a--),Kl(t,16,t.bl_tree),Zl(t,a-3,2)):a<=10?(Kl(t,17,t.bl_tree),Zl(t,a-3,3)):(Kl(t,18,t.bl_tree),Zl(t,a-11,7));a=0,s=r,0===o?(h=138,l=3):r===o?(h=6,l=3):(h=7,l=4)}};let oc=!1;const ac=(t,e,i,n)=>{Zl(t,0+(n?1:0),3),Ql(t),Wl(t,i),Wl(t,~i),i&&t.pending_buf.set(t.window.subarray(e,e+i),t.pending),t.pending+=i};var hc={_tr_init:t=>{oc||((()=>{let t,e,i,n,r;const s=new Array(16);for(i=0,n=0;n<28;n++)for(zl[n]=i,t=0;t<1<<Rl[n];t++)Bl[i++]=n;for(Bl[i-1]=n,r=0,n=0;n<16;n++)for(Ul[n]=r,t=0;t<1<<Pl[n];t++)Nl[r++]=n;for(r>>=7;n<30;n++)for(Ul[n]=r<<7,t=0;t<1<<Pl[n]-7;t++)Nl[256+r++]=n;for(e=0;e<=15;e++)s[e]=0;for(t=0;t<=143;)Ll[2*t+1]=8,t++,s[8]++;for(;t<=255;)Ll[2*t+1]=9,t++,s[9]++;for(;t<=279;)Ll[2*t+1]=7,t++,s[7]++;for(;t<=287;)Ll[2*t+1]=8,t++,s[8]++;for($l(Ll,287,s),t=0;t<30;t++)Ol[2*t+1]=5,Ol[2*t]=Hl(t,5);Yl=new Gl(Ll,Rl,257,286,15),Xl=new Gl(Ol,Pl,0,30,15),Vl=new Gl(new Array(0),Dl,0,19,7)})(),oc=!0),t.l_desc=new jl(t.dyn_ltree,Yl),t.d_desc=new jl(t.dyn_dtree,Xl),t.bl_desc=new jl(t.bl_tree,Vl),t.bi_buf=0,t.bi_valid=0,Jl(t)},_tr_stored_block:ac,_tr_flush_block:(t,e,i,n)=>{let r,s,o=0;t.level>0?(2===t.strm.data_type&&(t.strm.data_type=(t=>{let e,i=4093624447;for(e=0;e<=31;e++,i>>>=1)if(1&i&&0!==t.dyn_ltree[2*e])return 0;if(0!==t.dyn_ltree[18]||0!==t.dyn_ltree[20]||0!==t.dyn_ltree[26])return 1;for(e=32;e<256;e++)if(0!==t.dyn_ltree[2*e])return 1;return 0})(t)),nc(t,t.l_desc),nc(t,t.d_desc),o=(t=>{let e;for(rc(t,t.dyn_ltree,t.l_desc.max_code),rc(t,t.dyn_dtree,t.d_desc.max_code),nc(t,t.bl_desc),e=18;e>=3&&0===t.bl_tree[2*Fl[e]+1];e--);return t.opt_len+=3*(e+1)+5+5+4,e})(t),r=t.opt_len+3+7>>>3,s=t.static_len+3+7>>>3,s<=r&&(r=s)):r=s=i+5,i+4<=r&&-1!==e?ac(t,e,i,n):4===t.strategy||s===r?(Zl(t,2+(n?1:0),3),ic(t,Ll,Ol)):(Zl(t,4+(n?1:0),3),((t,e,i,n)=>{let r;for(Zl(t,e-257,5),Zl(t,i-1,5),Zl(t,n-4,4),r=0;r<n;r++)Zl(t,t.bl_tree[2*Fl[r]+1],3);sc(t,t.dyn_ltree,e-1),sc(t,t.dyn_dtree,i-1)})(t,t.l_desc.max_code+1,t.d_desc.max_code+1,o+1),ic(t,t.dyn_ltree,t.dyn_dtree)),Jl(t),n&&Ql(t)},_tr_tally:(t,e,i)=>(t.pending_buf[t.sym_buf+t.sym_next++]=e,t.pending_buf[t.sym_buf+t.sym_next++]=e>>8,t.pending_buf[t.sym_buf+t.sym_next++]=i,0===e?t.dyn_ltree[2*i]++:(t.matches++,e--,t.dyn_ltree[2*(Bl[i]+256+1)]++,t.dyn_dtree[2*ql(e)]++),t.sym_next===t.sym_end),_tr_align:t=>{Zl(t,2,3),Kl(t,256,Ll),(t=>{16===t.bi_valid?(Wl(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)})(t)}},lc=(t,e,i,n)=>{let r=65535&t|0,s=t>>>16&65535|0,o=0;for(;0!==i;){o=i>2e3?2e3:i,i-=o;do{r=r+e[n++]|0,s=s+r|0}while(--o);r%=65521,s%=65521}return r|s<<16|0};const cc=new Uint32Array((()=>{let t,e=[];for(var i=0;i<256;i++){t=i;for(var n=0;n<8;n++)t=1&t?3988292384^t>>>1:t>>>1;e[i]=t}return e})());var uc=(t,e,i,n)=>{const r=cc,s=n+i;t^=-1;for(let i=n;i<s;i++)t=t>>>8^r[255&(t^e[i])];return-1^t},dc={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},fc={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:gc,_tr_stored_block:mc,_tr_flush_block:pc,_tr_tally:_c,_tr_align:wc}=hc,{Z_NO_FLUSH:yc,Z_PARTIAL_FLUSH:vc,Z_FULL_FLUSH:bc,Z_FINISH:xc,Z_BLOCK:Mc,Z_OK:Ec,Z_STREAM_END:Sc,Z_STREAM_ERROR:kc,Z_DATA_ERROR:Cc,Z_BUF_ERROR:Ic,Z_DEFAULT_COMPRESSION:Ac,Z_FILTERED:Tc,Z_HUFFMAN_ONLY:Rc,Z_RLE:Pc,Z_FIXED:Dc,Z_DEFAULT_STRATEGY:Fc,Z_UNKNOWN:Lc,Z_DEFLATED:Oc}=fc,Nc=258,Bc=262,zc=42,Uc=113,Gc=666,Yc=(t,e)=>(t.msg=dc[e],e),Xc=t=>2*t-(t>4?9:0),Vc=t=>{let e=t.length;for(;--e>=0;)t[e]=0},jc=t=>{let e,i,n,r=t.w_size;e=t.hash_size,n=e;do{i=t.head[--n],t.head[n]=i>=r?i-r:0}while(--e);e=r,n=e;do{i=t.prev[--n],t.prev[n]=i>=r?i-r:0}while(--e)};let qc=(t,e,i)=>(e<<t.hash_shift^i)&t.hash_mask;const Wc=t=>{const e=t.state;let i=e.pending;i>t.avail_out&&(i=t.avail_out),0!==i&&(t.output.set(e.pending_buf.subarray(e.pending_out,e.pending_out+i),t.next_out),t.next_out+=i,e.pending_out+=i,t.total_out+=i,t.avail_out-=i,e.pending-=i,0===e.pending&&(e.pending_out=0))},Zc=(t,e)=>{pc(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,Wc(t.strm)},Kc=(t,e)=>{t.pending_buf[t.pending++]=e},Hc=(t,e)=>{t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=255&e},$c=(t,e,i,n)=>{let r=t.avail_in;return r>n&&(r=n),0===r?0:(t.avail_in-=r,e.set(t.input.subarray(t.next_in,t.next_in+r),i),1===t.state.wrap?t.adler=lc(t.adler,e,r,i):2===t.state.wrap&&(t.adler=uc(t.adler,e,r,i)),t.next_in+=r,t.total_in+=r,r)},Jc=(t,e)=>{let i,n,r=t.max_chain_length,s=t.strstart,o=t.prev_length,a=t.nice_match;const h=t.strstart>t.w_size-Bc?t.strstart-(t.w_size-Bc):0,l=t.window,c=t.w_mask,u=t.prev,d=t.strstart+Nc;let f=l[s+o-1],g=l[s+o];t.prev_length>=t.good_match&&(r>>=2),a>t.lookahead&&(a=t.lookahead);do{if(i=e,l[i+o]===g&&l[i+o-1]===f&&l[i]===l[s]&&l[++i]===l[s+1]){s+=2,i++;do{}while(l[++s]===l[++i]&&l[++s]===l[++i]&&l[++s]===l[++i]&&l[++s]===l[++i]&&l[++s]===l[++i]&&l[++s]===l[++i]&&l[++s]===l[++i]&&l[++s]===l[++i]&&s<d);if(n=Nc-(d-s),s=d-Nc,n>o){if(t.match_start=e,o=n,n>=a)break;f=l[s+o-1],g=l[s+o]}}}while((e=u[e&c])>h&&0!=--r);return o<=t.lookahead?o:t.lookahead},Qc=t=>{const e=t.w_size;let i,n,r;do{if(n=t.window_size-t.lookahead-t.strstart,t.strstart>=e+(e-Bc)&&(t.window.set(t.window.subarray(e,e+e-n),0),t.match_start-=e,t.strstart-=e,t.block_start-=e,t.insert>t.strstart&&(t.insert=t.strstart),jc(t),n+=e),0===t.strm.avail_in)break;if(i=$c(t.strm,t.window,t.strstart+t.lookahead,n),t.lookahead+=i,t.lookahead+t.insert>=3)for(r=t.strstart-t.insert,t.ins_h=t.window[r],t.ins_h=qc(t,t.ins_h,t.window[r+1]);t.insert&&(t.ins_h=qc(t,t.ins_h,t.window[r+3-1]),t.prev[r&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=r,r++,t.insert--,!(t.lookahead+t.insert<3)););}while(t.lookahead<Bc&&0!==t.strm.avail_in)},tu=(t,e)=>{let i,n,r,s=t.pending_buf_size-5>t.w_size?t.w_size:t.pending_buf_size-5,o=0,a=t.strm.avail_in;do{if(i=65535,r=t.bi_valid+42>>3,t.strm.avail_out<r)break;if(r=t.strm.avail_out-r,n=t.strstart-t.block_start,i>n+t.strm.avail_in&&(i=n+t.strm.avail_in),i>r&&(i=r),i<s&&(0===i&&e!==xc||e===yc||i!==n+t.strm.avail_in))break;o=e===xc&&i===n+t.strm.avail_in?1:0,mc(t,0,0,o),t.pending_buf[t.pending-4]=i,t.pending_buf[t.pending-3]=i>>8,t.pending_buf[t.pending-2]=~i,t.pending_buf[t.pending-1]=~i>>8,Wc(t.strm),n&&(n>i&&(n=i),t.strm.output.set(t.window.subarray(t.block_start,t.block_start+n),t.strm.next_out),t.strm.next_out+=n,t.strm.avail_out-=n,t.strm.total_out+=n,t.block_start+=n,i-=n),i&&($c(t.strm,t.strm.output,t.strm.next_out,i),t.strm.next_out+=i,t.strm.avail_out-=i,t.strm.total_out+=i)}while(0===o);return a-=t.strm.avail_in,a&&(a>=t.w_size?(t.matches=2,t.window.set(t.strm.input.subarray(t.strm.next_in-t.w_size,t.strm.next_in),0),t.strstart=t.w_size,t.insert=t.strstart):(t.window_size-t.strstart<=a&&(t.strstart-=t.w_size,t.window.set(t.window.subarray(t.w_size,t.w_size+t.strstart),0),t.matches<2&&t.matches++,t.insert>t.strstart&&(t.insert=t.strstart)),t.window.set(t.strm.input.subarray(t.strm.next_in-a,t.strm.next_in),t.strstart),t.strstart+=a,t.insert+=a>t.w_size-t.insert?t.w_size-t.insert:a),t.block_start=t.strstart),t.high_water<t.strstart&&(t.high_water=t.strstart),o?4:e!==yc&&e!==xc&&0===t.strm.avail_in&&t.strstart===t.block_start?2:(r=t.window_size-t.strstart,t.strm.avail_in>r&&t.block_start>=t.w_size&&(t.block_start-=t.w_size,t.strstart-=t.w_size,t.window.set(t.window.subarray(t.w_size,t.w_size+t.strstart),0),t.matches<2&&t.matches++,r+=t.w_size,t.insert>t.strstart&&(t.insert=t.strstart)),r>t.strm.avail_in&&(r=t.strm.avail_in),r&&($c(t.strm,t.window,t.strstart,r),t.strstart+=r,t.insert+=r>t.w_size-t.insert?t.w_size-t.insert:r),t.high_water<t.strstart&&(t.high_water=t.strstart),r=t.bi_valid+42>>3,r=t.pending_buf_size-r>65535?65535:t.pending_buf_size-r,s=r>t.w_size?t.w_size:r,n=t.strstart-t.block_start,(n>=s||(n||e===xc)&&e!==yc&&0===t.strm.avail_in&&n<=r)&&(i=n>r?r:n,o=e===xc&&0===t.strm.avail_in&&i===n?1:0,mc(t,t.block_start,i,o),t.block_start+=i,Wc(t.strm)),o?3:1)},eu=(t,e)=>{let i,n;for(;;){if(t.lookahead<Bc){if(Qc(t),t.lookahead<Bc&&e===yc)return 1;if(0===t.lookahead)break}if(i=0,t.lookahead>=3&&(t.ins_h=qc(t,t.ins_h,t.window[t.strstart+3-1]),i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!==i&&t.strstart-i<=t.w_size-Bc&&(t.match_length=Jc(t,i)),t.match_length>=3)if(n=_c(t,t.strstart-t.match_start,t.match_length-3),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=3){t.match_length--;do{t.strstart++,t.ins_h=qc(t,t.ins_h,t.window[t.strstart+3-1]),i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart}while(0!=--t.match_length);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=qc(t,t.ins_h,t.window[t.strstart+1]);else n=_c(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(n&&(Zc(t,!1),0===t.strm.avail_out))return 1}return t.insert=t.strstart<2?t.strstart:2,e===xc?(Zc(t,!0),0===t.strm.avail_out?3:4):t.sym_next&&(Zc(t,!1),0===t.strm.avail_out)?1:2},iu=(t,e)=>{let i,n,r;for(;;){if(t.lookahead<Bc){if(Qc(t),t.lookahead<Bc&&e===yc)return 1;if(0===t.lookahead)break}if(i=0,t.lookahead>=3&&(t.ins_h=qc(t,t.ins_h,t.window[t.strstart+3-1]),i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=2,0!==i&&t.prev_length<t.max_lazy_match&&t.strstart-i<=t.w_size-Bc&&(t.match_length=Jc(t,i),t.match_length<=5&&(t.strategy===Tc||3===t.match_length&&t.strstart-t.match_start>4096)&&(t.match_length=2)),t.prev_length>=3&&t.match_length<=t.prev_length){r=t.strstart+t.lookahead-3,n=_c(t,t.strstart-1-t.prev_match,t.prev_length-3),t.lookahead-=t.prev_length-1,t.prev_length-=2;do{++t.strstart<=r&&(t.ins_h=qc(t,t.ins_h,t.window[t.strstart+3-1]),i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart)}while(0!=--t.prev_length);if(t.match_available=0,t.match_length=2,t.strstart++,n&&(Zc(t,!1),0===t.strm.avail_out))return 1}else if(t.match_available){if(n=_c(t,0,t.window[t.strstart-1]),n&&Zc(t,!1),t.strstart++,t.lookahead--,0===t.strm.avail_out)return 1}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(n=_c(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<2?t.strstart:2,e===xc?(Zc(t,!0),0===t.strm.avail_out?3:4):t.sym_next&&(Zc(t,!1),0===t.strm.avail_out)?1:2};function nu(t,e,i,n,r){this.good_length=t,this.max_lazy=e,this.nice_length=i,this.max_chain=n,this.func=r}const ru=[new nu(0,0,0,0,tu),new nu(4,4,8,4,eu),new nu(4,5,16,8,eu),new nu(4,6,32,32,eu),new nu(4,4,16,16,iu),new nu(8,16,32,32,iu),new nu(8,16,128,128,iu),new nu(8,32,128,256,iu),new nu(32,128,258,1024,iu),new nu(32,258,258,4096,iu)];function su(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Oc,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),Vc(this.dyn_ltree),Vc(this.dyn_dtree),Vc(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),Vc(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),Vc(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const ou=t=>{if(!t)return 1;const e=t.state;return!e||e.strm!==t||e.status!==zc&&57!==e.status&&69!==e.status&&73!==e.status&&91!==e.status&&103!==e.status&&e.status!==Uc&&e.status!==Gc?1:0},au=t=>{if(ou(t))return Yc(t,kc);t.total_in=t.total_out=0,t.data_type=Lc;const e=t.state;return e.pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=2===e.wrap?57:e.wrap?zc:Uc,t.adler=2===e.wrap?0:1,e.last_flush=-2,gc(e),Ec},hu=t=>{const e=au(t);var i;return e===Ec&&((i=t.state).window_size=2*i.w_size,Vc(i.head),i.max_lazy_match=ru[i.level].max_lazy,i.good_match=ru[i.level].good_length,i.nice_match=ru[i.level].nice_length,i.max_chain_length=ru[i.level].max_chain,i.strstart=0,i.block_start=0,i.lookahead=0,i.insert=0,i.match_length=i.prev_length=2,i.match_available=0,i.ins_h=0),e},lu=(t,e,i,n,r,s)=>{if(!t)return kc;let o=1;if(e===Ac&&(e=6),n<0?(o=0,n=-n):n>15&&(o=2,n-=16),r<1||r>9||i!==Oc||n<8||n>15||e<0||e>9||s<0||s>Dc||8===n&&1!==o)return Yc(t,kc);8===n&&(n=9);const a=new su;return t.state=a,a.strm=t,a.status=zc,a.wrap=o,a.gzhead=null,a.w_bits=n,a.w_size=1<<a.w_bits,a.w_mask=a.w_size-1,a.hash_bits=r+7,a.hash_size=1<<a.hash_bits,a.hash_mask=a.hash_size-1,a.hash_shift=~~((a.hash_bits+3-1)/3),a.window=new Uint8Array(2*a.w_size),a.head=new Uint16Array(a.hash_size),a.prev=new Uint16Array(a.w_size),a.lit_bufsize=1<<r+6,a.pending_buf_size=4*a.lit_bufsize,a.pending_buf=new Uint8Array(a.pending_buf_size),a.sym_buf=a.lit_bufsize,a.sym_end=3*(a.lit_bufsize-1),a.level=e,a.strategy=s,a.method=i,hu(t)};var cu={deflateInit:(t,e)=>lu(t,e,Oc,15,8,Fc),deflateInit2:lu,deflateReset:hu,deflateResetKeep:au,deflateSetHeader:(t,e)=>ou(t)||2!==t.state.wrap?kc:(t.state.gzhead=e,Ec),deflate:(t,e)=>{if(ou(t)||e>Mc||e<0)return t?Yc(t,kc):kc;const i=t.state;if(!t.output||0!==t.avail_in&&!t.input||i.status===Gc&&e!==xc)return Yc(t,0===t.avail_out?Ic:kc);const n=i.last_flush;if(i.last_flush=e,0!==i.pending){if(Wc(t),0===t.avail_out)return i.last_flush=-1,Ec}else if(0===t.avail_in&&Xc(e)<=Xc(n)&&e!==xc)return Yc(t,Ic);if(i.status===Gc&&0!==t.avail_in)return Yc(t,Ic);if(i.status===zc&&0===i.wrap&&(i.status=Uc),i.status===zc){let e=Oc+(i.w_bits-8<<4)<<8,n=-1;if(n=i.strategy>=Rc||i.level<2?0:i.level<6?1:6===i.level?2:3,e|=n<<6,0!==i.strstart&&(e|=32),e+=31-e%31,Hc(i,e),0!==i.strstart&&(Hc(i,t.adler>>>16),Hc(i,65535&t.adler)),t.adler=1,i.status=Uc,Wc(t),0!==i.pending)return i.last_flush=-1,Ec}if(57===i.status)if(t.adler=0,Kc(i,31),Kc(i,139),Kc(i,8),i.gzhead)Kc(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),Kc(i,255&i.gzhead.time),Kc(i,i.gzhead.time>>8&255),Kc(i,i.gzhead.time>>16&255),Kc(i,i.gzhead.time>>24&255),Kc(i,9===i.level?2:i.strategy>=Rc||i.level<2?4:0),Kc(i,255&i.gzhead.os),i.gzhead.extra&&i.gzhead.extra.length&&(Kc(i,255&i.gzhead.extra.length),Kc(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(t.adler=uc(t.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=69;else if(Kc(i,0),Kc(i,0),Kc(i,0),Kc(i,0),Kc(i,0),Kc(i,9===i.level?2:i.strategy>=Rc||i.level<2?4:0),Kc(i,3),i.status=Uc,Wc(t),0!==i.pending)return i.last_flush=-1,Ec;if(69===i.status){if(i.gzhead.extra){let e=i.pending,n=(65535&i.gzhead.extra.length)-i.gzindex;for(;i.pending+n>i.pending_buf_size;){let r=i.pending_buf_size-i.pending;if(i.pending_buf.set(i.gzhead.extra.subarray(i.gzindex,i.gzindex+r),i.pending),i.pending=i.pending_buf_size,i.gzhead.hcrc&&i.pending>e&&(t.adler=uc(t.adler,i.pending_buf,i.pending-e,e)),i.gzindex+=r,Wc(t),0!==i.pending)return i.last_flush=-1,Ec;e=0,n-=r}let r=new Uint8Array(i.gzhead.extra);i.pending_buf.set(r.subarray(i.gzindex,i.gzindex+n),i.pending),i.pending+=n,i.gzhead.hcrc&&i.pending>e&&(t.adler=uc(t.adler,i.pending_buf,i.pending-e,e)),i.gzindex=0}i.status=73}if(73===i.status){if(i.gzhead.name){let e,n=i.pending;do{if(i.pending===i.pending_buf_size){if(i.gzhead.hcrc&&i.pending>n&&(t.adler=uc(t.adler,i.pending_buf,i.pending-n,n)),Wc(t),0!==i.pending)return i.last_flush=-1,Ec;n=0}e=i.gzindex<i.gzhead.name.length?255&i.gzhead.name.charCodeAt(i.gzindex++):0,Kc(i,e)}while(0!==e);i.gzhead.hcrc&&i.pending>n&&(t.adler=uc(t.adler,i.pending_buf,i.pending-n,n)),i.gzindex=0}i.status=91}if(91===i.status){if(i.gzhead.comment){let e,n=i.pending;do{if(i.pending===i.pending_buf_size){if(i.gzhead.hcrc&&i.pending>n&&(t.adler=uc(t.adler,i.pending_buf,i.pending-n,n)),Wc(t),0!==i.pending)return i.last_flush=-1,Ec;n=0}e=i.gzindex<i.gzhead.comment.length?255&i.gzhead.comment.charCodeAt(i.gzindex++):0,Kc(i,e)}while(0!==e);i.gzhead.hcrc&&i.pending>n&&(t.adler=uc(t.adler,i.pending_buf,i.pending-n,n))}i.status=103}if(103===i.status){if(i.gzhead.hcrc){if(i.pending+2>i.pending_buf_size&&(Wc(t),0!==i.pending))return i.last_flush=-1,Ec;Kc(i,255&t.adler),Kc(i,t.adler>>8&255),t.adler=0}if(i.status=Uc,Wc(t),0!==i.pending)return i.last_flush=-1,Ec}if(0!==t.avail_in||0!==i.lookahead||e!==yc&&i.status!==Gc){let n=0===i.level?tu(i,e):i.strategy===Rc?((t,e)=>{let i;for(;;){if(0===t.lookahead&&(Qc(t),0===t.lookahead)){if(e===yc)return 1;break}if(t.match_length=0,i=_c(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,i&&(Zc(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,e===xc?(Zc(t,!0),0===t.strm.avail_out?3:4):t.sym_next&&(Zc(t,!1),0===t.strm.avail_out)?1:2})(i,e):i.strategy===Pc?((t,e)=>{let i,n,r,s;const o=t.window;for(;;){if(t.lookahead<=Nc){if(Qc(t),t.lookahead<=Nc&&e===yc)return 1;if(0===t.lookahead)break}if(t.match_length=0,t.lookahead>=3&&t.strstart>0&&(r=t.strstart-1,n=o[r],n===o[++r]&&n===o[++r]&&n===o[++r])){s=t.strstart+Nc;do{}while(n===o[++r]&&n===o[++r]&&n===o[++r]&&n===o[++r]&&n===o[++r]&&n===o[++r]&&n===o[++r]&&n===o[++r]&&r<s);t.match_length=Nc-(s-r),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=3?(i=_c(t,1,t.match_length-3),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(i=_c(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),i&&(Zc(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,e===xc?(Zc(t,!0),0===t.strm.avail_out?3:4):t.sym_next&&(Zc(t,!1),0===t.strm.avail_out)?1:2})(i,e):ru[i.level].func(i,e);if(3!==n&&4!==n||(i.status=Gc),1===n||3===n)return 0===t.avail_out&&(i.last_flush=-1),Ec;if(2===n&&(e===vc?wc(i):e!==Mc&&(mc(i,0,0,!1),e===bc&&(Vc(i.head),0===i.lookahead&&(i.strstart=0,i.block_start=0,i.insert=0))),Wc(t),0===t.avail_out))return i.last_flush=-1,Ec}return e!==xc?Ec:i.wrap<=0?Sc:(2===i.wrap?(Kc(i,255&t.adler),Kc(i,t.adler>>8&255),Kc(i,t.adler>>16&255),Kc(i,t.adler>>24&255),Kc(i,255&t.total_in),Kc(i,t.total_in>>8&255),Kc(i,t.total_in>>16&255),Kc(i,t.total_in>>24&255)):(Hc(i,t.adler>>>16),Hc(i,65535&t.adler)),Wc(t),i.wrap>0&&(i.wrap=-i.wrap),0!==i.pending?Ec:Sc)},deflateEnd:t=>{if(ou(t))return kc;const e=t.state.status;return t.state=null,e===Uc?Yc(t,Cc):Ec},deflateSetDictionary:(t,e)=>{let i=e.length;if(ou(t))return kc;const n=t.state,r=n.wrap;if(2===r||1===r&&n.status!==zc||n.lookahead)return kc;if(1===r&&(t.adler=lc(t.adler,e,i,0)),n.wrap=0,i>=n.w_size){0===r&&(Vc(n.head),n.strstart=0,n.block_start=0,n.insert=0);let t=new Uint8Array(n.w_size);t.set(e.subarray(i-n.w_size,i),0),e=t,i=n.w_size}const s=t.avail_in,o=t.next_in,a=t.input;for(t.avail_in=i,t.next_in=0,t.input=e,Qc(n);n.lookahead>=3;){let t=n.strstart,e=n.lookahead-2;do{n.ins_h=qc(n,n.ins_h,n.window[t+3-1]),n.prev[t&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=t,t++}while(--e);n.strstart=t,n.lookahead=2,Qc(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=2,n.match_available=0,t.next_in=o,t.input=a,t.avail_in=s,n.wrap=r,Ec},deflateInfo:"pako deflate (from Nodeca project)"};const uu=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var du={assign:function(t){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const i=e.shift();if(i){if("object"!=typeof i)throw new TypeError(i+"must be non-object");for(const e in i)uu(i,e)&&(t[e]=i[e])}}return t},flattenChunks:t=>{let e=0;for(let i=0,n=t.length;i<n;i++)e+=t[i].length;const i=new Uint8Array(e);for(let e=0,n=0,r=t.length;e<r;e++){let r=t[e];i.set(r,n),n+=r.length}return i}};let fu=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(t){fu=!1}const gu=new Uint8Array(256);for(let t=0;t<256;t++)gu[t]=t>=252?6:t>=248?5:t>=240?4:t>=224?3:t>=192?2:1;gu[254]=gu[254]=1;var mu={string2buf:t=>{if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(t);let e,i,n,r,s,o=t.length,a=0;for(r=0;r<o;r++)i=t.charCodeAt(r),55296==(64512&i)&&r+1<o&&(n=t.charCodeAt(r+1),56320==(64512&n)&&(i=65536+(i-55296<<10)+(n-56320),r++)),a+=i<128?1:i<2048?2:i<65536?3:4;for(e=new Uint8Array(a),s=0,r=0;s<a;r++)i=t.charCodeAt(r),55296==(64512&i)&&r+1<o&&(n=t.charCodeAt(r+1),56320==(64512&n)&&(i=65536+(i-55296<<10)+(n-56320),r++)),i<128?e[s++]=i:i<2048?(e[s++]=192|i>>>6,e[s++]=128|63&i):i<65536?(e[s++]=224|i>>>12,e[s++]=128|i>>>6&63,e[s++]=128|63&i):(e[s++]=240|i>>>18,e[s++]=128|i>>>12&63,e[s++]=128|i>>>6&63,e[s++]=128|63&i);return e},buf2string:(t,e)=>{const i=e||t.length;if("function"==typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(t.subarray(0,e));let n,r;const s=new Array(2*i);for(r=0,n=0;n<i;){let e=t[n++];if(e<128){s[r++]=e;continue}let o=gu[e];if(o>4)s[r++]=65533,n+=o-1;else{for(e&=2===o?31:3===o?15:7;o>1&&n<i;)e=e<<6|63&t[n++],o--;o>1?s[r++]=65533:e<65536?s[r++]=e:(e-=65536,s[r++]=55296|e>>10&1023,s[r++]=56320|1023&e)}}return((t,e)=>{if(e<65534&&t.subarray&&fu)return String.fromCharCode.apply(null,t.length===e?t:t.subarray(0,e));let i="";for(let n=0;n<e;n++)i+=String.fromCharCode(t[n]);return i})(s,r)},utf8border:(t,e)=>{(e=e||t.length)>t.length&&(e=t.length);let i=e-1;for(;i>=0&&128==(192&t[i]);)i--;return i<0||0===i?e:i+gu[t[i]]>e?i:e}},pu=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};const _u=Object.prototype.toString,{Z_NO_FLUSH:wu,Z_SYNC_FLUSH:yu,Z_FULL_FLUSH:vu,Z_FINISH:bu,Z_OK:xu,Z_STREAM_END:Mu,Z_DEFAULT_COMPRESSION:Eu,Z_DEFAULT_STRATEGY:Su,Z_DEFLATED:ku}=fc;function Cu(t){this.options=du.assign({level:Eu,method:ku,chunkSize:16384,windowBits:15,memLevel:8,strategy:Su},t||{});let e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new pu,this.strm.avail_out=0;let i=cu.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(i!==xu)throw new Error(dc[i]);if(e.header&&cu.deflateSetHeader(this.strm,e.header),e.dictionary){let t;if(t="string"==typeof e.dictionary?mu.string2buf(e.dictionary):"[object ArrayBuffer]"===_u.call(e.dictionary)?new Uint8Array(e.dictionary):e.dictionary,i=cu.deflateSetDictionary(this.strm,t),i!==xu)throw new Error(dc[i]);this._dict_set=!0}}function Iu(t,e){const i=new Cu(e);if(i.push(t,!0),i.err)throw i.msg||dc[i.err];return i.result}Cu.prototype.push=function(t,e){const i=this.strm,n=this.options.chunkSize;let r,s;if(this.ended)return!1;for(s=e===~~e?e:!0===e?bu:wu,"string"==typeof t?i.input=mu.string2buf(t):"[object ArrayBuffer]"===_u.call(t)?i.input=new Uint8Array(t):i.input=t,i.next_in=0,i.avail_in=i.input.length;;)if(0===i.avail_out&&(i.output=new Uint8Array(n),i.next_out=0,i.avail_out=n),(s===yu||s===vu)&&i.avail_out<=6)this.onData(i.output.subarray(0,i.next_out)),i.avail_out=0;else{if(r=cu.deflate(i,s),r===Mu)return i.next_out>0&&this.onData(i.output.subarray(0,i.next_out)),r=cu.deflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===xu;if(0!==i.avail_out){if(s>0&&i.next_out>0)this.onData(i.output.subarray(0,i.next_out)),i.avail_out=0;else if(0===i.avail_in)break}else this.onData(i.output)}return!0},Cu.prototype.onData=function(t){this.chunks.push(t)},Cu.prototype.onEnd=function(t){t===xu&&(this.result=du.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};var Au={Deflate:Cu,deflate:Iu,deflateRaw:function(t,e){return(e=e||{}).raw=!0,Iu(t,e)},gzip:function(t,e){return(e=e||{}).gzip=!0,Iu(t,e)},constants:fc};const Tu=16209;var Ru=function(t,e){let i,n,r,s,o,a,h,l,c,u,d,f,g,m,p,_,w,y,v,b,x,M,E,S;const k=t.state;i=t.next_in,E=t.input,n=i+(t.avail_in-5),r=t.next_out,S=t.output,s=r-(e-t.avail_out),o=r+(t.avail_out-257),a=k.dmax,h=k.wsize,l=k.whave,c=k.wnext,u=k.window,d=k.hold,f=k.bits,g=k.lencode,m=k.distcode,p=(1<<k.lenbits)-1,_=(1<<k.distbits)-1;t:do{f<15&&(d+=E[i++]<<f,f+=8,d+=E[i++]<<f,f+=8),w=g[d&p];e:for(;;){if(y=w>>>24,d>>>=y,f-=y,y=w>>>16&255,0===y)S[r++]=65535&w;else{if(!(16&y)){if(0==(64&y)){w=g[(65535&w)+(d&(1<<y)-1)];continue e}if(32&y){k.mode=16191;break t}t.msg="invalid literal/length code",k.mode=Tu;break t}v=65535&w,y&=15,y&&(f<y&&(d+=E[i++]<<f,f+=8),v+=d&(1<<y)-1,d>>>=y,f-=y),f<15&&(d+=E[i++]<<f,f+=8,d+=E[i++]<<f,f+=8),w=m[d&_];i:for(;;){if(y=w>>>24,d>>>=y,f-=y,y=w>>>16&255,!(16&y)){if(0==(64&y)){w=m[(65535&w)+(d&(1<<y)-1)];continue i}t.msg="invalid distance code",k.mode=Tu;break t}if(b=65535&w,y&=15,f<y&&(d+=E[i++]<<f,f+=8,f<y&&(d+=E[i++]<<f,f+=8)),b+=d&(1<<y)-1,b>a){t.msg="invalid distance too far back",k.mode=Tu;break t}if(d>>>=y,f-=y,y=r-s,b>y){if(y=b-y,y>l&&k.sane){t.msg="invalid distance too far back",k.mode=Tu;break t}if(x=0,M=u,0===c){if(x+=h-y,y<v){v-=y;do{S[r++]=u[x++]}while(--y);x=r-b,M=S}}else if(c<y){if(x+=h+c-y,y-=c,y<v){v-=y;do{S[r++]=u[x++]}while(--y);if(x=0,c<v){y=c,v-=y;do{S[r++]=u[x++]}while(--y);x=r-b,M=S}}}else if(x+=c-y,y<v){v-=y;do{S[r++]=u[x++]}while(--y);x=r-b,M=S}for(;v>2;)S[r++]=M[x++],S[r++]=M[x++],S[r++]=M[x++],v-=3;v&&(S[r++]=M[x++],v>1&&(S[r++]=M[x++]))}else{x=r-b;do{S[r++]=S[x++],S[r++]=S[x++],S[r++]=S[x++],v-=3}while(v>2);v&&(S[r++]=S[x++],v>1&&(S[r++]=S[x++]))}break}}break}}while(i<n&&r<o);v=f>>3,i-=v,f-=v<<3,d&=(1<<f)-1,t.next_in=i,t.next_out=r,t.avail_in=i<n?n-i+5:5-(i-n),t.avail_out=r<o?o-r+257:257-(r-o),k.hold=d,k.bits=f};const Pu=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),Du=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),Fu=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),Lu=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var Ou=(t,e,i,n,r,s,o,a)=>{const h=a.bits;let l,c,u,d,f,g,m=0,p=0,_=0,w=0,y=0,v=0,b=0,x=0,M=0,E=0,S=null;const k=new Uint16Array(16),C=new Uint16Array(16);let I,A,T,R=null;for(m=0;m<=15;m++)k[m]=0;for(p=0;p<n;p++)k[e[i+p]]++;for(y=h,w=15;w>=1&&0===k[w];w--);if(y>w&&(y=w),0===w)return r[s++]=20971520,r[s++]=20971520,a.bits=1,0;for(_=1;_<w&&0===k[_];_++);for(y<_&&(y=_),x=1,m=1;m<=15;m++)if(x<<=1,x-=k[m],x<0)return-1;if(x>0&&(0===t||1!==w))return-1;for(C[1]=0,m=1;m<15;m++)C[m+1]=C[m]+k[m];for(p=0;p<n;p++)0!==e[i+p]&&(o[C[e[i+p]]++]=p);if(0===t?(S=R=o,g=20):1===t?(S=Pu,R=Du,g=257):(S=Fu,R=Lu,g=0),E=0,p=0,m=_,f=s,v=y,b=0,u=-1,M=1<<y,d=M-1,1===t&&M>852||2===t&&M>592)return 1;for(;;){I=m-b,o[p]+1<g?(A=0,T=o[p]):o[p]>=g?(A=R[o[p]-g],T=S[o[p]-g]):(A=96,T=0),l=1<<m-b,c=1<<v,_=c;do{c-=l,r[f+(E>>b)+c]=I<<24|A<<16|T|0}while(0!==c);for(l=1<<m-1;E&l;)l>>=1;if(0!==l?(E&=l-1,E+=l):E=0,p++,0==--k[m]){if(m===w)break;m=e[i+o[p]]}if(m>y&&(E&d)!==u){for(0===b&&(b=y),f+=_,v=m-b,x=1<<v;v+b<w&&(x-=k[v+b],!(x<=0));)v++,x<<=1;if(M+=1<<v,1===t&&M>852||2===t&&M>592)return 1;u=E&d,r[u]=y<<24|v<<16|f-s|0}}return 0!==E&&(r[f+E]=m-b<<24|64<<16|0),a.bits=y,0};const{Z_FINISH:Nu,Z_BLOCK:Bu,Z_TREES:zu,Z_OK:Uu,Z_STREAM_END:Gu,Z_NEED_DICT:Yu,Z_STREAM_ERROR:Xu,Z_DATA_ERROR:Vu,Z_MEM_ERROR:ju,Z_BUF_ERROR:qu,Z_DEFLATED:Wu}=fc,Zu=16180,Ku=16190,Hu=16191,$u=16192,Ju=16194,Qu=16199,td=16200,ed=16206,id=16209,nd=t=>(t>>>24&255)+(t>>>8&65280)+((65280&t)<<8)+((255&t)<<24);function rd(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const sd=t=>{if(!t)return 1;const e=t.state;return!e||e.strm!==t||e.mode<Zu||e.mode>16211?1:0},od=t=>{if(sd(t))return Xu;const e=t.state;return t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=1&e.wrap),e.mode=Zu,e.last=0,e.havedict=0,e.flags=-1,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(852),e.distcode=e.distdyn=new Int32Array(592),e.sane=1,e.back=-1,Uu},ad=t=>{if(sd(t))return Xu;const e=t.state;return e.wsize=0,e.whave=0,e.wnext=0,od(t)},hd=(t,e)=>{let i;if(sd(t))return Xu;const n=t.state;return e<0?(i=0,e=-e):(i=5+(e>>4),e<48&&(e&=15)),e&&(e<8||e>15)?Xu:(null!==n.window&&n.wbits!==e&&(n.window=null),n.wrap=i,n.wbits=e,ad(t))},ld=(t,e)=>{if(!t)return Xu;const i=new rd;t.state=i,i.strm=t,i.window=null,i.mode=Zu;const n=hd(t,e);return n!==Uu&&(t.state=null),n};let cd,ud,dd=!0;const fd=t=>{if(dd){cd=new Int32Array(512),ud=new Int32Array(32);let e=0;for(;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(Ou(1,t.lens,0,288,cd,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;Ou(2,t.lens,0,32,ud,0,t.work,{bits:5}),dd=!1}t.lencode=cd,t.lenbits=9,t.distcode=ud,t.distbits=5},gd=(t,e,i,n)=>{let r;const s=t.state;return null===s.window&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new Uint8Array(s.wsize)),n>=s.wsize?(s.window.set(e.subarray(i-s.wsize,i),0),s.wnext=0,s.whave=s.wsize):(r=s.wsize-s.wnext,r>n&&(r=n),s.window.set(e.subarray(i-n,i-n+r),s.wnext),(n-=r)?(s.window.set(e.subarray(i-n,i),0),s.wnext=n,s.whave=s.wsize):(s.wnext+=r,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=r))),0};var md={inflateReset:ad,inflateReset2:hd,inflateResetKeep:od,inflateInit:t=>ld(t,15),inflateInit2:ld,inflate:(t,e)=>{let i,n,r,s,o,a,h,l,c,u,d,f,g,m,p,_,w,y,v,b,x,M,E=0;const S=new Uint8Array(4);let k,C;const I=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(sd(t)||!t.output||!t.input&&0!==t.avail_in)return Xu;i=t.state,i.mode===Hu&&(i.mode=$u),o=t.next_out,r=t.output,h=t.avail_out,s=t.next_in,n=t.input,a=t.avail_in,l=i.hold,c=i.bits,u=a,d=h,M=Uu;t:for(;;)switch(i.mode){case Zu:if(0===i.wrap){i.mode=$u;break}for(;c<16;){if(0===a)break t;a--,l+=n[s++]<<c,c+=8}if(2&i.wrap&&35615===l){0===i.wbits&&(i.wbits=15),i.check=0,S[0]=255&l,S[1]=l>>>8&255,i.check=uc(i.check,S,2,0),l=0,c=0,i.mode=16181;break}if(i.head&&(i.head.done=!1),!(1&i.wrap)||(((255&l)<<8)+(l>>8))%31){t.msg="incorrect header check",i.mode=id;break}if((15&l)!==Wu){t.msg="unknown compression method",i.mode=id;break}if(l>>>=4,c-=4,x=8+(15&l),0===i.wbits&&(i.wbits=x),x>15||x>i.wbits){t.msg="invalid window size",i.mode=id;break}i.dmax=1<<i.wbits,i.flags=0,t.adler=i.check=1,i.mode=512&l?16189:Hu,l=0,c=0;break;case 16181:for(;c<16;){if(0===a)break t;a--,l+=n[s++]<<c,c+=8}if(i.flags=l,(255&i.flags)!==Wu){t.msg="unknown compression method",i.mode=id;break}if(57344&i.flags){t.msg="unknown header flags set",i.mode=id;break}i.head&&(i.head.text=l>>8&1),512&i.flags&&4&i.wrap&&(S[0]=255&l,S[1]=l>>>8&255,i.check=uc(i.check,S,2,0)),l=0,c=0,i.mode=16182;case 16182:for(;c<32;){if(0===a)break t;a--,l+=n[s++]<<c,c+=8}i.head&&(i.head.time=l),512&i.flags&&4&i.wrap&&(S[0]=255&l,S[1]=l>>>8&255,S[2]=l>>>16&255,S[3]=l>>>24&255,i.check=uc(i.check,S,4,0)),l=0,c=0,i.mode=16183;case 16183:for(;c<16;){if(0===a)break t;a--,l+=n[s++]<<c,c+=8}i.head&&(i.head.xflags=255&l,i.head.os=l>>8),512&i.flags&&4&i.wrap&&(S[0]=255&l,S[1]=l>>>8&255,i.check=uc(i.check,S,2,0)),l=0,c=0,i.mode=16184;case 16184:if(1024&i.flags){for(;c<16;){if(0===a)break t;a--,l+=n[s++]<<c,c+=8}i.length=l,i.head&&(i.head.extra_len=l),512&i.flags&&4&i.wrap&&(S[0]=255&l,S[1]=l>>>8&255,i.check=uc(i.check,S,2,0)),l=0,c=0}else i.head&&(i.head.extra=null);i.mode=16185;case 16185:if(1024&i.flags&&(f=i.length,f>a&&(f=a),f&&(i.head&&(x=i.head.extra_len-i.length,i.head.extra||(i.head.extra=new Uint8Array(i.head.extra_len)),i.head.extra.set(n.subarray(s,s+f),x)),512&i.flags&&4&i.wrap&&(i.check=uc(i.check,n,f,s)),a-=f,s+=f,i.length-=f),i.length))break t;i.length=0,i.mode=16186;case 16186:if(2048&i.flags){if(0===a)break t;f=0;do{x=n[s+f++],i.head&&x&&i.length<65536&&(i.head.name+=String.fromCharCode(x))}while(x&&f<a);if(512&i.flags&&4&i.wrap&&(i.check=uc(i.check,n,f,s)),a-=f,s+=f,x)break t}else i.head&&(i.head.name=null);i.length=0,i.mode=16187;case 16187:if(4096&i.flags){if(0===a)break t;f=0;do{x=n[s+f++],i.head&&x&&i.length<65536&&(i.head.comment+=String.fromCharCode(x))}while(x&&f<a);if(512&i.flags&&4&i.wrap&&(i.check=uc(i.check,n,f,s)),a-=f,s+=f,x)break t}else i.head&&(i.head.comment=null);i.mode=16188;case 16188:if(512&i.flags){for(;c<16;){if(0===a)break t;a--,l+=n[s++]<<c,c+=8}if(4&i.wrap&&l!==(65535&i.check)){t.msg="header crc mismatch",i.mode=id;break}l=0,c=0}i.head&&(i.head.hcrc=i.flags>>9&1,i.head.done=!0),t.adler=i.check=0,i.mode=Hu;break;case 16189:for(;c<32;){if(0===a)break t;a--,l+=n[s++]<<c,c+=8}t.adler=i.check=nd(l),l=0,c=0,i.mode=Ku;case Ku:if(0===i.havedict)return t.next_out=o,t.avail_out=h,t.next_in=s,t.avail_in=a,i.hold=l,i.bits=c,Yu;t.adler=i.check=1,i.mode=Hu;case Hu:if(e===Bu||e===zu)break t;case $u:if(i.last){l>>>=7&c,c-=7&c,i.mode=ed;break}for(;c<3;){if(0===a)break t;a--,l+=n[s++]<<c,c+=8}switch(i.last=1&l,l>>>=1,c-=1,3&l){case 0:i.mode=16193;break;case 1:if(fd(i),i.mode=Qu,e===zu){l>>>=2,c-=2;break t}break;case 2:i.mode=16196;break;case 3:t.msg="invalid block type",i.mode=id}l>>>=2,c-=2;break;case 16193:for(l>>>=7&c,c-=7&c;c<32;){if(0===a)break t;a--,l+=n[s++]<<c,c+=8}if((65535&l)!=(l>>>16^65535)){t.msg="invalid stored block lengths",i.mode=id;break}if(i.length=65535&l,l=0,c=0,i.mode=Ju,e===zu)break t;case Ju:i.mode=16195;case 16195:if(f=i.length,f){if(f>a&&(f=a),f>h&&(f=h),0===f)break t;r.set(n.subarray(s,s+f),o),a-=f,s+=f,h-=f,o+=f,i.length-=f;break}i.mode=Hu;break;case 16196:for(;c<14;){if(0===a)break t;a--,l+=n[s++]<<c,c+=8}if(i.nlen=257+(31&l),l>>>=5,c-=5,i.ndist=1+(31&l),l>>>=5,c-=5,i.ncode=4+(15&l),l>>>=4,c-=4,i.nlen>286||i.ndist>30){t.msg="too many length or distance symbols",i.mode=id;break}i.have=0,i.mode=16197;case 16197:for(;i.have<i.ncode;){for(;c<3;){if(0===a)break t;a--,l+=n[s++]<<c,c+=8}i.lens[I[i.have++]]=7&l,l>>>=3,c-=3}for(;i.have<19;)i.lens[I[i.have++]]=0;if(i.lencode=i.lendyn,i.lenbits=7,k={bits:i.lenbits},M=Ou(0,i.lens,0,19,i.lencode,0,i.work,k),i.lenbits=k.bits,M){t.msg="invalid code lengths set",i.mode=id;break}i.have=0,i.mode=16198;case 16198:for(;i.have<i.nlen+i.ndist;){for(;E=i.lencode[l&(1<<i.lenbits)-1],p=E>>>24,_=E>>>16&255,w=65535&E,!(p<=c);){if(0===a)break t;a--,l+=n[s++]<<c,c+=8}if(w<16)l>>>=p,c-=p,i.lens[i.have++]=w;else{if(16===w){for(C=p+2;c<C;){if(0===a)break t;a--,l+=n[s++]<<c,c+=8}if(l>>>=p,c-=p,0===i.have){t.msg="invalid bit length repeat",i.mode=id;break}x=i.lens[i.have-1],f=3+(3&l),l>>>=2,c-=2}else if(17===w){for(C=p+3;c<C;){if(0===a)break t;a--,l+=n[s++]<<c,c+=8}l>>>=p,c-=p,x=0,f=3+(7&l),l>>>=3,c-=3}else{for(C=p+7;c<C;){if(0===a)break t;a--,l+=n[s++]<<c,c+=8}l>>>=p,c-=p,x=0,f=11+(127&l),l>>>=7,c-=7}if(i.have+f>i.nlen+i.ndist){t.msg="invalid bit length repeat",i.mode=id;break}for(;f--;)i.lens[i.have++]=x}}if(i.mode===id)break;if(0===i.lens[256]){t.msg="invalid code -- missing end-of-block",i.mode=id;break}if(i.lenbits=9,k={bits:i.lenbits},M=Ou(1,i.lens,0,i.nlen,i.lencode,0,i.work,k),i.lenbits=k.bits,M){t.msg="invalid literal/lengths set",i.mode=id;break}if(i.distbits=6,i.distcode=i.distdyn,k={bits:i.distbits},M=Ou(2,i.lens,i.nlen,i.ndist,i.distcode,0,i.work,k),i.distbits=k.bits,M){t.msg="invalid distances set",i.mode=id;break}if(i.mode=Qu,e===zu)break t;case Qu:i.mode=td;case td:if(a>=6&&h>=258){t.next_out=o,t.avail_out=h,t.next_in=s,t.avail_in=a,i.hold=l,i.bits=c,Ru(t,d),o=t.next_out,r=t.output,h=t.avail_out,s=t.next_in,n=t.input,a=t.avail_in,l=i.hold,c=i.bits,i.mode===Hu&&(i.back=-1);break}for(i.back=0;E=i.lencode[l&(1<<i.lenbits)-1],p=E>>>24,_=E>>>16&255,w=65535&E,!(p<=c);){if(0===a)break t;a--,l+=n[s++]<<c,c+=8}if(_&&0==(240&_)){for(y=p,v=_,b=w;E=i.lencode[b+((l&(1<<y+v)-1)>>y)],p=E>>>24,_=E>>>16&255,w=65535&E,!(y+p<=c);){if(0===a)break t;a--,l+=n[s++]<<c,c+=8}l>>>=y,c-=y,i.back+=y}if(l>>>=p,c-=p,i.back+=p,i.length=w,0===_){i.mode=16205;break}if(32&_){i.back=-1,i.mode=Hu;break}if(64&_){t.msg="invalid literal/length code",i.mode=id;break}i.extra=15&_,i.mode=16201;case 16201:if(i.extra){for(C=i.extra;c<C;){if(0===a)break t;a--,l+=n[s++]<<c,c+=8}i.length+=l&(1<<i.extra)-1,l>>>=i.extra,c-=i.extra,i.back+=i.extra}i.was=i.length,i.mode=16202;case 16202:for(;E=i.distcode[l&(1<<i.distbits)-1],p=E>>>24,_=E>>>16&255,w=65535&E,!(p<=c);){if(0===a)break t;a--,l+=n[s++]<<c,c+=8}if(0==(240&_)){for(y=p,v=_,b=w;E=i.distcode[b+((l&(1<<y+v)-1)>>y)],p=E>>>24,_=E>>>16&255,w=65535&E,!(y+p<=c);){if(0===a)break t;a--,l+=n[s++]<<c,c+=8}l>>>=y,c-=y,i.back+=y}if(l>>>=p,c-=p,i.back+=p,64&_){t.msg="invalid distance code",i.mode=id;break}i.offset=w,i.extra=15&_,i.mode=16203;case 16203:if(i.extra){for(C=i.extra;c<C;){if(0===a)break t;a--,l+=n[s++]<<c,c+=8}i.offset+=l&(1<<i.extra)-1,l>>>=i.extra,c-=i.extra,i.back+=i.extra}if(i.offset>i.dmax){t.msg="invalid distance too far back",i.mode=id;break}i.mode=16204;case 16204:if(0===h)break t;if(f=d-h,i.offset>f){if(f=i.offset-f,f>i.whave&&i.sane){t.msg="invalid distance too far back",i.mode=id;break}f>i.wnext?(f-=i.wnext,g=i.wsize-f):g=i.wnext-f,f>i.length&&(f=i.length),m=i.window}else m=r,g=o-i.offset,f=i.length;f>h&&(f=h),h-=f,i.length-=f;do{r[o++]=m[g++]}while(--f);0===i.length&&(i.mode=td);break;case 16205:if(0===h)break t;r[o++]=i.length,h--,i.mode=td;break;case ed:if(i.wrap){for(;c<32;){if(0===a)break t;a--,l|=n[s++]<<c,c+=8}if(d-=h,t.total_out+=d,i.total+=d,4&i.wrap&&d&&(t.adler=i.check=i.flags?uc(i.check,r,d,o-d):lc(i.check,r,d,o-d)),d=h,4&i.wrap&&(i.flags?l:nd(l))!==i.check){t.msg="incorrect data check",i.mode=id;break}l=0,c=0}i.mode=16207;case 16207:if(i.wrap&&i.flags){for(;c<32;){if(0===a)break t;a--,l+=n[s++]<<c,c+=8}if(4&i.wrap&&l!==(4294967295&i.total)){t.msg="incorrect length check",i.mode=id;break}l=0,c=0}i.mode=16208;case 16208:M=Gu;break t;case id:M=Vu;break t;case 16210:return ju;default:return Xu}return t.next_out=o,t.avail_out=h,t.next_in=s,t.avail_in=a,i.hold=l,i.bits=c,(i.wsize||d!==t.avail_out&&i.mode<id&&(i.mode<ed||e!==Nu))&&gd(t,t.output,t.next_out,d-t.avail_out),u-=t.avail_in,d-=t.avail_out,t.total_in+=u,t.total_out+=d,i.total+=d,4&i.wrap&&d&&(t.adler=i.check=i.flags?uc(i.check,r,d,t.next_out-d):lc(i.check,r,d,t.next_out-d)),t.data_type=i.bits+(i.last?64:0)+(i.mode===Hu?128:0)+(i.mode===Qu||i.mode===Ju?256:0),(0===u&&0===d||e===Nu)&&M===Uu&&(M=qu),M},inflateEnd:t=>{if(sd(t))return Xu;let e=t.state;return e.window&&(e.window=null),t.state=null,Uu},inflateGetHeader:(t,e)=>{if(sd(t))return Xu;const i=t.state;return 0==(2&i.wrap)?Xu:(i.head=e,e.done=!1,Uu)},inflateSetDictionary:(t,e)=>{const i=e.length;let n,r,s;return sd(t)?Xu:(n=t.state,0!==n.wrap&&n.mode!==Ku?Xu:n.mode===Ku&&(r=1,r=lc(r,e,i,0),r!==n.check)?Vu:(s=gd(t,e,i,i),s?(n.mode=16210,ju):(n.havedict=1,Uu)))},inflateInfo:"pako inflate (from Nodeca project)"},pd=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};const _d=Object.prototype.toString,{Z_NO_FLUSH:wd,Z_FINISH:yd,Z_OK:vd,Z_STREAM_END:bd,Z_NEED_DICT:xd,Z_STREAM_ERROR:Md,Z_DATA_ERROR:Ed,Z_MEM_ERROR:Sd}=fc;function kd(t){this.options=du.assign({chunkSize:65536,windowBits:15,to:""},t||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,0===e.windowBits&&(e.windowBits=-15)),!(e.windowBits>=0&&e.windowBits<16)||t&&t.windowBits||(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&0==(15&e.windowBits)&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new pu,this.strm.avail_out=0;let i=md.inflateInit2(this.strm,e.windowBits);if(i!==vd)throw new Error(dc[i]);if(this.header=new pd,md.inflateGetHeader(this.strm,this.header),e.dictionary&&("string"==typeof e.dictionary?e.dictionary=mu.string2buf(e.dictionary):"[object ArrayBuffer]"===_d.call(e.dictionary)&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(i=md.inflateSetDictionary(this.strm,e.dictionary),i!==vd)))throw new Error(dc[i])}function Cd(t,e){const i=new kd(e);if(i.push(t),i.err)throw i.msg||dc[i.err];return i.result}kd.prototype.push=function(t,e){const i=this.strm,n=this.options.chunkSize,r=this.options.dictionary;let s,o,a;if(this.ended)return!1;for(o=e===~~e?e:!0===e?yd:wd,"[object ArrayBuffer]"===_d.call(t)?i.input=new Uint8Array(t):i.input=t,i.next_in=0,i.avail_in=i.input.length;;){for(0===i.avail_out&&(i.output=new Uint8Array(n),i.next_out=0,i.avail_out=n),s=md.inflate(i,o),s===xd&&r&&(s=md.inflateSetDictionary(i,r),s===vd?s=md.inflate(i,o):s===Ed&&(s=xd));i.avail_in>0&&s===bd&&i.state.wrap>0&&0!==t[i.next_in];)md.inflateReset(i),s=md.inflate(i,o);switch(s){case Md:case Ed:case xd:case Sd:return this.onEnd(s),this.ended=!0,!1}if(a=i.avail_out,i.next_out&&(0===i.avail_out||s===bd))if("string"===this.options.to){let t=mu.utf8border(i.output,i.next_out),e=i.next_out-t,r=mu.buf2string(i.output,t);i.next_out=e,i.avail_out=n-e,e&&i.output.set(i.output.subarray(t,t+e),0),this.onData(r)}else this.onData(i.output.length===i.next_out?i.output:i.output.subarray(0,i.next_out));if(s!==vd||0!==a){if(s===bd)return s=md.inflateEnd(this.strm),this.onEnd(s),this.ended=!0,!0;if(0===i.avail_in)break}}return!0},kd.prototype.onData=function(t){this.chunks.push(t)},kd.prototype.onEnd=function(t){t===vd&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=du.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};var Id={Inflate:kd,inflate:Cd,inflateRaw:function(t,e){return(e=e||{}).raw=!0,Cd(t,e)},ungzip:Cd,constants:fc};const{Deflate:Ad,deflate:Td,deflateRaw:Rd,gzip:Pd}=Au,{Inflate:Dd,inflate:Fd,inflateRaw:Ld,ungzip:Od}=Id;var Nd=Td,Bd=Dd,zd=Fd;const Ud=[137,80,78,71,13,10,26,10],Gd=[];for(let t=0;t<256;t++){let e=t;for(let t=0;t<8;t++)1&e?e=3988292384^e>>>1:e>>>=1;Gd[t]=e}const Yd=4294967295;function Xd(t,e){return(function(t,e,i){let n=4294967295;for(let t=0;t<i;t++)n=Gd[255&(n^e[t])]^n>>>8;return n}(0,t,e)^Yd)>>>0}var Vd,jd,qd,Wd;!function(t){t[t.UNKNOWN=-1]="UNKNOWN",t[t.GREYSCALE=0]="GREYSCALE",t[t.TRUECOLOUR=2]="TRUECOLOUR",t[t.INDEXED_COLOUR=3]="INDEXED_COLOUR",t[t.GREYSCALE_ALPHA=4]="GREYSCALE_ALPHA",t[t.TRUECOLOUR_ALPHA=6]="TRUECOLOUR_ALPHA"}(Vd||(Vd={})),function(t){t[t.UNKNOWN=-1]="UNKNOWN",t[t.DEFLATE=0]="DEFLATE"}(jd||(jd={})),function(t){t[t.UNKNOWN=-1]="UNKNOWN",t[t.ADAPTIVE=0]="ADAPTIVE"}(qd||(qd={})),function(t){t[t.UNKNOWN=-1]="UNKNOWN",t[t.NO_INTERLACE=0]="NO_INTERLACE",t[t.ADAM7=1]="ADAM7"}(Wd||(Wd={}));const Zd=new Uint8Array(0),Kd=new Uint16Array([255]),Hd=255===new Uint8Array(Kd.buffer)[0];class $d extends Al.IOBuffer{constructor(t,e={}){super(t);const{checkCrc:i=!1}=e;this._checkCrc=i,this._inflator=new Bd,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=jd.UNKNOWN,this._filterMethod=qd.UNKNOWN,this._interlaceMethod=Wd.UNKNOWN,this._colorType=Vd.UNKNOWN,this.setBigEndian()}decode(){for(this.decodeSignature();!this._end;)this.decodeChunk();return this.decodeImage(),this._png}decodeSignature(){for(let t=0;t<Ud.length;t++)if(this.readUint8()!==Ud[t])throw new Error(`wrong PNG signature. Byte at ${t} should be ${Ud[t]}.`)}decodeChunk(){const t=this.readUint32(),e=this.readChars(4),i=this.offset;switch(e){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(t);break;case"IDAT":this.decodeIDAT(t);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(t);break;case"iCCP":this.decodeiCCP(t);break;case"tEXt":this.decodetEXt(t);break;case"pHYs":this.decodepHYs();break;default:this.skip(t)}if(this.offset-i!==t)throw new Error(`Length mismatch while decoding chunk ${e}`);if(this._checkCrc){const i=this.readUint32(),n=t+4,r=Xd(new Uint8Array(this.buffer,this.byteOffset+this.offset-n-4,n),n);if(r!==i)throw new Error(`CRC mismatch for chunk ${e}. Expected ${i}, found ${r}`)}else this.skip(4)}decodeIHDR(){const t=this._png;t.width=this.readUint32(),t.height=this.readUint32(),t.depth=function(t){if(1!==t&&2!==t&&4!==t&&8!==t&&16!==t)throw new Error(`invalid bit depth: ${t}`);return t}(this.readUint8());const e=this.readUint8();let i;switch(this._colorType=e,e){case Vd.GREYSCALE:i=1;break;case Vd.TRUECOLOUR:i=3;break;case Vd.INDEXED_COLOUR:i=1;break;case Vd.GREYSCALE_ALPHA:i=2;break;case Vd.TRUECOLOUR_ALPHA:i=4;break;default:throw new Error(`Unknown color type: ${e}`)}if(this._png.channels=i,this._compressionMethod=this.readUint8(),this._compressionMethod!==jd.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodePLTE(t){if(t%3!=0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${t}`);const e=t/3;this._hasPalette=!0;const i=[];this._palette=i;for(let t=0;t<e;t++)i.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(t){this._inflator.push(new Uint8Array(this.buffer,this.offset+this.byteOffset,t)),this.skip(t)}decodetRNS(t){switch(this._colorType){case Vd.GREYSCALE:case Vd.TRUECOLOUR:if(t%2!=0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${t}`);if(t/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${t/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(t/2);for(let e=0;e<t/2;e++)this._transparency[e]=this.readUint16();break;case Vd.INDEXED_COLOUR:{if(t>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${t} vs ${this._palette.length})`);let e=0;for(;e<t;e++){const t=this.readByte();this._palette[e].push(t)}for(;e<this._palette.length;e++)this._palette[e].push(255);break}default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(t){let e,i="";for(;"\0"!==(e=this.readChar());)i+=e;const n=this.readUint8();if(n!==jd.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${n}`);const r=this.readBytes(t-i.length-2);this._png.iccEmbeddedProfile={name:i,profile:zd(r)}}decodetEXt(t){let e,i="";for(;"\0"!==(e=this.readChar());)i+=e;this._png.text[i]=this.readChars(t-i.length-1)}decodepHYs(){const t=this.readUint32(),e=this.readUint32(),i=this.readByte();this._png.resolution={x:t,y:e,unit:i}}decodeImage(){if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const t=this._inflator.result;if(this._filterMethod!==qd.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod!==Wd.NO_INTERLACE)throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this.decodeInterlaceNull(t)}decodeInterlaceNull(t){const e=this._png.height,i=this._png.channels*this._png.depth/8,n=this._png.width*i,r=new Uint8Array(this._png.height*n);let s,o,a=Zd,h=0;for(let l=0;l<e;l++){switch(s=t.subarray(h+1,h+1+n),o=r.subarray(l*n,(l+1)*n),t[h]){case 0:Jd(s,o,n);break;case 1:Qd(s,o,n,i);break;case 2:tf(s,o,a,n);break;case 3:ef(s,o,a,n,i);break;case 4:nf(s,o,a,n,i);break;default:throw new Error(`Unsupported filter: ${t[h]}`)}a=o,h+=n+1}if(this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency),16===this._png.depth){const t=new Uint16Array(r.buffer);if(Hd)for(let e=0;e<t.length;e++)t[e]=(255&(l=t[e]))<<8|l>>8&255;this._png.data=t}else this._png.data=r;var l}}function Jd(t,e,i){for(let n=0;n<i;n++)e[n]=t[n]}function Qd(t,e,i,n){let r=0;for(;r<n;r++)e[r]=t[r];for(;r<i;r++)e[r]=t[r]+e[r-n]&255}function tf(t,e,i,n){let r=0;if(0===i.length)for(;r<n;r++)e[r]=t[r];else for(;r<n;r++)e[r]=t[r]+i[r]&255}function ef(t,e,i,n,r){let s=0;if(0===i.length){for(;s<r;s++)e[s]=t[s];for(;s<n;s++)e[s]=t[s]+(e[s-r]>>1)&255}else{for(;s<r;s++)e[s]=t[s]+(i[s]>>1)&255;for(;s<n;s++)e[s]=t[s]+(e[s-r]+i[s]>>1)&255}}function nf(t,e,i,n,r){let s=0;if(0===i.length){for(;s<r;s++)e[s]=t[s];for(;s<n;s++)e[s]=t[s]+e[s-r]&255}else{for(;s<r;s++)e[s]=t[s]+i[s]&255;for(;s<n;s++)e[s]=t[s]+rf(e[s-r],i[s],i[s-r])&255}}function rf(t,e,i){const n=t+e-i,r=Math.abs(n-t),s=Math.abs(n-e),o=Math.abs(n-i);return r<=s&&r<=o?t:s<=o?e:i}const sf={level:3};class of extends Al.IOBuffer{constructor(t,e={}){super(),this._colorType=Vd.UNKNOWN,this._zlibOptions={...sf,...e.zlib},this._png=this._checkData(t),this.setBigEndian()}encode(){return this.encodeSignature(),this.encodeIHDR(),this.encodeData(),this.encodeIEND(),this.toArray()}encodeSignature(){this.writeBytes(Ud)}encodeIHDR(){this.writeUint32(13),this.writeChars("IHDR"),this.writeUint32(this._png.width),this.writeUint32(this._png.height),this.writeByte(this._png.depth),this.writeByte(this._colorType),this.writeByte(jd.DEFLATE),this.writeByte(qd.ADAPTIVE),this.writeByte(Wd.NO_INTERLACE),this.writeCrc(17)}encodeIEND(){this.writeUint32(0),this.writeChars("IEND"),this.writeCrc(4)}encodeIDAT(t){this.writeUint32(t.length),this.writeChars("IDAT"),this.writeBytes(t),this.writeCrc(t.length+4)}encodeData(){const{width:t,height:e,channels:i,depth:n,data:r}=this._png,s=i*t,o=(new Al.IOBuffer).setBigEndian();let a=0;for(let t=0;t<e;t++)if(o.writeByte(0),8===n)a=hf(r,o,s,a);else{if(16!==n)throw new Error("unreachable");a=lf(r,o,s,a)}const h=o.toArray(),l=Nd(h,this._zlibOptions);this.encodeIDAT(l)}_checkData(t){const{colorType:e,channels:i,depth:n}=function(t){const{channels:e=4,depth:i=8}=t;if(4!==e&&3!==e&&2!==e&&1!==e)throw new RangeError(`unsupported number of channels: ${e}`);if(8!==i&&16!==i)throw new RangeError(`unsupported bit depth: ${i}`);const n={channels:e,depth:i,colorType:Vd.UNKNOWN};switch(e){case 4:n.colorType=Vd.TRUECOLOUR_ALPHA;break;case 3:n.colorType=Vd.TRUECOLOUR;break;case 1:n.colorType=Vd.GREYSCALE;break;case 2:n.colorType=Vd.GREYSCALE_ALPHA;break;default:throw new Error("unsupported number of channels")}return n}(t),r={width:af(t.width,"width"),height:af(t.height,"height"),channels:i,data:t.data,depth:n,text:{}};this._colorType=e;const s=r.width*r.height*i;if(r.data.length!==s)throw new RangeError(`wrong data size. Found ${r.data.length}, expected ${s}`);return r}writeCrc(t){this.writeUint32(Xd(new Uint8Array(this.buffer,this.byteOffset+this.offset-t,t),t))}}function af(t,e){if(Number.isInteger(t)&&t>0)return t;throw new TypeError(`${e} must be a positive integer`)}function hf(t,e,i,n){for(let r=0;r<i;r++)e.writeByte(t[n++]);return n}function lf(t,e,i,n){for(let r=0;r<i;r++)e.writeUint16(t[n++]);return n}var cf;!function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.METRE=1]="METRE"}(cf||(cf={}));var uf=__webpack_require__(7870);let df="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ff=new Uint8Array(256);for(let t=0;t<df.length;t++)ff[df.charCodeAt(t)]=t;function gf(t,e){return`data:${e};base64,${function(t){let e,i=t.length,n="";for(e=0;e<i;e+=3)n+=df[t[e]>>2],n+=df[(3&t[e])<<4|t[e+1]>>4],n+=df[(15&t[e+1])<<2|t[e+2]>>6],n+=df[63&t[e+2]];return i%3==2?n=`${n.substring(0,n.length-1)}=`:i%3==1&&(n=`${n.substring(0,n.length-2)}==`),n}(t)}`}const mf=self.ImageData,pf=self.Image;function _f(t,e){let i=self.document.createElement("canvas");return i.width=t,i.height=e,i}function wf(t,e={}){const i={width:t.width,height:t.height,data:t.getRGBAData()};return(0,uf.encode)(i,e.quality).data}function yf(t,e){const i={width:t.width,height:t.height,channels:t.channels,depth:t.bitDepth,data:t.data};return 1!==i.depth&&32!==i.depth||(i.depth=8,i.channels=4,i.data=t.getRGBAData()),function(t,e){return new of(t,e).encode()}(i,e)}const vf={save(t,e={}){const{useCanvas:i=!1,encoder:n}=e;let{format:r}=e;if(!r){const e=/\.(?<format>[a-zA-Z]+)$/.exec(t);e&&(r=e.groups.format.toLowerCase())}if(!r)throw new Error("file format not provided");return new Promise(((t,e)=>{let s,o;switch(r.toLowerCase()){case"png":i?s=this.getCanvas().pngStream():o=yf(this,n);break;case"jpg":case"jpeg":i?s=this.getCanvas().jpegStream():o=wf(this,n);break;case"bmp":o=(0,Il.c)(this,n);break;default:throw new RangeError(`invalid output format: ${r}`)}if(s){let i=function(){throw new Error("createWriteStream does not exist in the browser")}();i.on("finish",t),i.on("error",e),s.pipe(i)}else o&&function(){throw new Error("writeFile does not exist in the browser")}()}))},toDataURL(t="image/png",e={}){"object"==typeof t&&(e=t,t="image/png");const{useCanvas:i=!1,encoder:n}=e;function r(e,i){return gf(e(i,n),t)}return"image/bmp"===(t=function(t){return t.includes("/")||(t=`image/${t}`),t}(t))?r(Il.c,this):"image/png"!==t||i?"image/jpeg"!==t||i?this.getCanvas().toDataURL(t):r(wf,this):r(yf,this)},toBuffer(t={}){const{format:e="png",encoder:i}=t;switch(e.toLowerCase()){case"png":return yf(this,i);case"jpeg":case"jpg":return wf(this,i);case"bmp":return(0,Il.c)(this,i);default:throw new RangeError(`invalid output format: ${e}`)}},toBase64(t="image/png",e={}){if(e.async)return this.toDataURL(t,e).then((function(t){return t.substring(t.indexOf(",")+1)}));{const i=this.toDataURL(t,e);return i.substring(i.indexOf(",")+1)}},toBlob(t="image/png",e=.8){return kl(this.getCanvas(),t,e)},getCanvas(){const t=new mf(this.getRGBAData({clamped:!0}),this.width,this.height);let e=_f(this.width,this.height);return e.getContext("2d").putImageData(t,0,0),e}};var bf=__webpack_require__(2251),xf=__webpack_require__.n(bf);let Mf={configurable:!0,enumerable:!1,get:void 0};const Ef="GREY",Sf="RGB",kf="HSL",Cf="HSV",If="CMYK",Af="BINARY",Tf="RGBA",Rf={};Rf[Af]={components:1,alpha:0,bitDepth:1,colorModel:Ef},Rf.GREYA={components:1,alpha:1,bitDepth:8,colorModel:Ef},Rf.GREY={components:1,alpha:0,bitDepth:8,colorModel:Ef},Rf[Tf]={components:3,alpha:1,bitDepth:8,colorModel:Sf},Rf.RGB={components:3,alpha:0,bitDepth:8,colorModel:Sf},Rf.CMYK={components:4,alpha:0,bitDepth:8,colorModel:If},Rf.CMYKA={components:4,alpha:1,bitDepth:8,colorModel:If};const Pf=[1,8,16,32];var Df=__webpack_require__(9464),Ff=__webpack_require__(9184),Lf=__webpack_require__.n(Ff);const Of={33434:"ExposureTime",33437:"FNumber",34850:"ExposureProgram",34852:"SpectralSensitivity",34855:"ISOSpeedRatings",34856:"OECF",34864:"SensitivityType",34865:"StandardOutputSensitivity",34866:"RecommendedExposureIndex",34867:"ISOSpeed",34868:"ISOSpeedLatitudeyyy",34869:"ISOSpeedLatitudezzz",36864:"ExifVersion",36867:"DateTimeOriginal",36868:"DateTimeDigitized",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureBiasValue",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37386:"FocalLength",37396:"SubjectArea",37500:"MakerNote",37510:"UserComment",37520:"SubsecTime",37521:"SubsecTimeOriginal",37522:"SubsecTimeDigitized",40960:"FlashpixVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",40964:"RelatedSoundFile",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41492:"SubjectLocation",41493:"ExposureIndex",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRatio",41989:"FocalLengthIn35mmFilm",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",42016:"ImageUniqueID",42032:"CameraOwnerName",42033:"BodySerialNumber",42034:"LensSpecification",42035:"LensMake",42036:"LensModel",42037:"LensSerialNumber",42240:"Gamma"},Nf={};for(let t in Of)Nf[Of[t]]=Number(t);const Bf={0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential",31:"GPSHPositioningError"},zf={};for(let t in Bf)zf[Bf[t]]=Number(t);const Uf={254:"NewSubfileType",255:"SubfileType",256:"ImageWidth",257:"ImageLength",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",263:"Threshholding",264:"CellWidth",265:"CellLength",266:"FillOrder",270:"ImageDescription",271:"Make",272:"Model",273:"StripOffsets",274:"Orientation",277:"SamplesPerPixel",278:"RowsPerStrip",279:"StripByteCounts",280:"MinSampleValue",281:"MaxSampleValue",282:"XResolution",283:"YResolution",284:"PlanarConfiguration",288:"FreeOffsets",289:"FreeByteCounts",290:"GrayResponseUnit",291:"GrayResponseCurve",296:"ResolutionUnit",305:"Software",306:"DateTime",315:"Artist",316:"HostComputer",320:"ColorMap",338:"ExtraSamples",33432:"Copyright",269:"DocumentName",285:"PageName",286:"XPosition",287:"YPosition",292:"T4Options",293:"T6Options",297:"PageNumber",301:"TransferFunction",317:"Predictor",318:"WhitePoint",319:"PrimaryChromaticities",321:"HalftoneHints",322:"TileWidth",323:"TileLength",324:"TileOffsets",325:"TileByteCounts",326:"BadFaxLines",327:"CleanFaxData",328:"ConsecutiveBadFaxLines",330:"SubIFDs",332:"InkSet",333:"InkNames",334:"NumberOfInks",336:"DotRange",337:"TargetPrinter",339:"SampleFormat",340:"SMinSampleValue",341:"SMaxSampleValue",342:"TransferRange",343:"ClipPath",344:"XClipPathUnits",345:"YClipPathUnits",346:"Indexed",347:"JPEGTables",351:"OPIProxy",400:"GlobalParametersIFD",401:"ProfileType",402:"FaxProfile",403:"CodingMethods",404:"VersionYear",405:"ModeNumber",433:"Decode",434:"DefaultImageColor",512:"JPEGProc",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",515:"JPEGRestartInterval",517:"JPEGLosslessPredictors",518:"JPEGPointTransforms",519:"JPEGQTables",520:"JPEGDCTables",521:"JPEGACTables",529:"YCbCrCoefficients",530:"YCbCrSubSampling",531:"YCbCrPositioning",532:"ReferenceBlackWhite",559:"StripRowCounts",700:"XMP",32781:"ImageID",34732:"ImageLayer",32932:"WangAnnotatio",33445:"MDFileTag",33446:"MDScalePixel",33447:"MDColorTable",33448:"MDLabName",33449:"MDSampleInfo",33450:"MDPrepDate",33451:"MDPrepTime",33452:"MDFileUnits",33550:"ModelPixelScaleTag",33723:"IPTC",33918:"INGRPacketDataTag",33919:"INGRFlagRegisters",33920:"IrasBTransformationMatrix",33922:"ModelTiepointTag",34264:"ModelTransformationTag",34377:"Photoshop",34665:"ExifIFD",34675:"ICCProfile",34735:"GeoKeyDirectoryTag",34736:"GeoDoubleParamsTag",34737:"GeoAsciiParamsTag",34853:"GPSIFD",34908:"HylaFAXFaxRecvParams",34909:"HylaFAXFaxSubAddress",34910:"HylaFAXFaxRecvTime",37724:"ImageSourceData",40965:"InteroperabilityIFD",42112:"GDAL_METADATA",42113:"GDAL_NODATA",50215:"OceScanjobDescription",50216:"OceApplicationSelector",50217:"OceIdentificationNumber",50218:"OceImageLogicCharacteristics",50706:"DNGVersion",50707:"DNGBackwardVersion",50708:"UniqueCameraModel",50709:"LocalizedCameraModel",50710:"CFAPlaneColor",50711:"CFALayout",50712:"LinearizationTable",50713:"BlackLevelRepeatDim",50714:"BlackLevel",50715:"BlackLevelDeltaH",50716:"BlackLevelDeltaV",50717:"WhiteLevel",50718:"DefaultScale",50719:"DefaultCropOrigin",50720:"DefaultCropSize",50721:"ColorMatrix1",50722:"ColorMatrix2",50723:"CameraCalibration1",50724:"CameraCalibration2",50725:"ReductionMatrix1",50726:"ReductionMatrix2",50727:"AnalogBalance",50728:"AsShotNeutral",50729:"AsShotWhiteXY",50730:"BaselineExposure",50731:"BaselineNoise",50732:"BaselineSharpness",50733:"BayerGreenSplit",50734:"LinearResponseLimit",50735:"CameraSerialNumber",50736:"LensInfo",50737:"ChromaBlurRadius",50738:"AntiAliasStrength",50740:"DNGPrivateData",50741:"MakerNoteSafety",50778:"CalibrationIlluminant1",50779:"CalibrationIlluminant2",50780:"BestQualityScale",50784:"AliasLayerMetadata"},Gf={};for(let t in Uf)Gf[Uf[t]]=Number(t);const Yf={standard:n,exif:e,gps:i};class Xf{constructor(t){if(!t)throw new Error("missing kind");this.data=new Uint8Array,this.fields=new Map,this.kind=t,this._hasMap=!1,this._map={}}get(t){if("number"==typeof t)return this.fields.get(t);if("string"==typeof t)return this.fields.get(Yf[this.kind].tagsByName[t]);throw new Error("expected a number or string")}get map(){if(!this._hasMap){const t=Yf[this.kind].tagsById;for(let e of this.fields.keys())t[e]&&(this._map[t[e]]=this.fields.get(e));this._hasMap=!0}return this._map}}let Vf=new Map([[1,[1,jf]],[2,[1,function(t,e){let i=[],n="";for(let r=0;r<e;r++){let e=String.fromCharCode(t.readUint8());"\0"===e?(i.push(n),n=""):n+=e}return 1===i.length?i[0]:i}]],[3,[2,function(t,e){if(1===e)return t.readUint16();let i=new Uint16Array(e);for(let n=0;n<e;n++)i[n]=t.readUint16();return i}]],[4,[4,function(t,e){if(1===e)return t.readUint32();let i=new Uint32Array(e);for(let n=0;n<e;n++)i[n]=t.readUint32();return i}]],[5,[8,function(t,e){if(1===e)return t.readUint32()/t.readUint32();let i=new Array(e);for(let n=0;n<e;n++)i[n]=t.readUint32()/t.readUint32();return i}]],[6,[1,function(t,e){if(1===e)return t.readInt8();let i=new Int8Array(e);for(let n=0;n<e;n++)i[n]=t.readInt8();return i}]],[7,[1,jf]],[8,[2,function(t,e){if(1===e)return t.readInt16();let i=new Int16Array(e);for(let n=0;n<e;n++)i[n]=t.readInt16();return i}]],[9,[4,function(t,e){if(1===e)return t.readInt32();let i=new Int32Array(e);for(let n=0;n<e;n++)i[n]=t.readInt32();return i}]],[10,[8,function(t,e){if(1===e)return t.readInt32()/t.readInt32();let i=new Array(e);for(let n=0;n<e;n++)i[n]=t.readInt32()/t.readInt32();return i}]],[11,[4,function(t,e){if(1===e)return t.readFloat32();let i=new Float32Array(e);for(let n=0;n<e;n++)i[n]=t.readFloat32();return i}]],[12,[8,function(t,e){if(1===e)return t.readFloat64();let i=new Float64Array(e);for(let n=0;n<e;n++)i[n]=t.readFloat64();return i}]]]);function jf(t,e){if(1===e)return t.readUint8();let i=new Uint8Array(e);for(let n=0;n<e;n++)i[n]=t.readUint8();return i}let qf=[];const Wf=[511,1023,2047,4095],Zf=[0,0,0,0,0,0,0,0,0,511,1023,2047,4095];class Kf{constructor(t){this.nextData=0,this.nextBits=0,this.bytePointer=0,this.tableLength=258,this.currentBitLength=9,this.stripArray=new Uint8Array(t.buffer,t.byteOffset,t.byteLength),this.outData=new Al.IOBuffer(t.byteLength),this.initializeTable()}decode(){let t=0,e=0;for(;257!==(t=this.getNextCode());)if(256===t){if(this.initializeTable(),t=this.getNextCode(),257===t)break;this.writeString(this.stringFromCode(t)),e=t}else if(this.isInTable(t))this.writeString(this.stringFromCode(t)),this.addStringToTable(this.stringFromCode(e).concat(this.stringFromCode(t)[0])),e=t;else{const i=this.stringFromCode(e).concat(this.stringFromCode(e)[0]);this.writeString(i),this.addStringToTable(i),e=t}const i=this.outData.toArray();return new DataView(i.buffer,i.byteOffset,i.byteLength)}initializeTable(){!function(){if(0===qf.length){for(let t=0;t<256;t++)qf.push([t]);const t=[];for(let e=256;e<4096;e++)qf.push(t)}}(),this.tableLength=258,this.currentBitLength=9}writeString(t){this.outData.writeBytes(t)}stringFromCode(t){return qf[t]}isInTable(t){return t<this.tableLength}addStringToTable(t){if(qf[this.tableLength++]=t,qf.length>4096)throw qf=[],new Error("LZW decoding error. Please open an issue at https://github.com/image-js/tiff/issues/new/choose (include a test image).");this.tableLength===Zf[this.currentBitLength]&&this.currentBitLength++}getNextCode(){this.nextData=this.nextData<<8|255&this.stripArray[this.bytePointer++],this.nextBits+=8,this.nextBits<this.currentBitLength&&(this.nextData=this.nextData<<8|255&this.stripArray[this.bytePointer++],this.nextBits+=8);const t=this.nextData>>this.nextBits-this.currentBitLength&Wf[this.currentBitLength-9];return this.nextBits-=this.currentBitLength,this.bytePointer>this.stripArray.length?257:t}}function Hf(t){return new Kf(t).decode()}const $f=/^(\d{4}):(\d{2}):(\d{2}) (\d{2}):(\d{2}):(\d{2})$/;class Jf extends Xf{constructor(){super("standard")}get size(){return this.width*this.height}get width(){return this.imageWidth}get height(){return this.imageLength}get components(){return this.samplesPerPixel}get date(){let t=new Date,e=$f.exec(this.dateTime);if(null===e)throw new Error(`invalid dateTime: ${this.dateTime}`);return t.setFullYear(Number(e[1]),Number(e[2])-1,Number(e[3])),t.setHours(Number(e[4]),Number(e[5]),Number(e[6])),t}get newSubfileType(){return this.get("NewSubfileType")}get imageWidth(){return this.get("ImageWidth")}get imageLength(){return this.get("ImageLength")}get bitsPerSample(){const t=this.get("BitsPerSample");return t&&"number"!=typeof t?t[0]:t}get alpha(){const t=this.extraSamples;return!!t&&0!==t[0]}get associatedAlpha(){const t=this.extraSamples;return!!t&&1===t[0]}get extraSamples(){return Qf(this.get("ExtraSamples"))}get compression(){return this.get("Compression")||1}get type(){return this.get("PhotometricInterpretation")}get fillOrder(){return this.get("FillOrder")||1}get documentName(){return this.get("DocumentName")}get imageDescription(){return this.get("ImageDescription")}get stripOffsets(){return Qf(this.get("StripOffsets"))}get orientation(){return this.get("Orientation")}get samplesPerPixel(){return this.get("SamplesPerPixel")||1}get rowsPerStrip(){return this.get("RowsPerStrip")}get stripByteCounts(){return Qf(this.get("StripByteCounts"))}get minSampleValue(){return this.get("MinSampleValue")||0}get maxSampleValue(){return this.get("MaxSampleValue")||Math.pow(2,this.bitsPerSample)-1}get xResolution(){return this.get("XResolution")}get yResolution(){return this.get("YResolution")}get planarConfiguration(){return this.get("PlanarConfiguration")||1}get resolutionUnit(){return this.get("ResolutionUnit")||2}get dateTime(){return this.get("DateTime")}get predictor(){return this.get("Predictor")||1}get sampleFormat(){return this.get("SampleFormat")||1}get sMinSampleValue(){return this.get("SMinSampleValue")||this.minSampleValue}get sMaxSampleValue(){return this.get("SMaxSampleValue")||this.maxSampleValue}get palette(){const t=2**this.bitsPerSample,e=this.get("ColorMap");if(!e)return;if(e.length!==3*t)throw new Error(`ColorMap size must be ${t}`);const i=[];for(let n=0;n<t;n++)i.push([e[n],e[n+t],e[n+2*t]]);return i}}function Qf(t){return"number"==typeof t?[t]:t}function tg(t){const e=new Uint8Array(t.buffer,t.byteOffset,t.byteLength),i=zd(e);return new DataView(i.buffer,i.byteOffset,i.byteLength)}const eg={ignoreImageData:!1,onlyFirst:!1};class ig extends Al.IOBuffer{constructor(t){super(t),this._nextIFD=0}get isMultiPage(){let t=0;for(this.decodeHeader();this._nextIFD;)if(t++,this.decodeIFD({ignoreImageData:!0},!0),2===t)return!0;if(1===t)return!1;throw ng("ifdCount",t)}get pageCount(){let t=0;for(this.decodeHeader();this._nextIFD;)t++,this.decodeIFD({ignoreImageData:!0},!0);if(t>0)return t;throw ng("ifdCount",t)}decode(t={}){t=Object.assign({},eg,t);const e=[];for(this.decodeHeader();this._nextIFD;)if(e.push(this.decodeIFD(t,!0)),t.onlyFirst)return[e[0]];return e}decodeHeader(){const t=this.readUint16();if(18761===t)this.setLittleEndian();else{if(19789!==t)throw new Error(`invalid byte order: 0x${t.toString(16)}`);this.setBigEndian()}if(42!==this.readUint16())throw new Error("not a TIFF file");this._nextIFD=this.readUint32()}decodeIFD(t,e){let i;if(this.seek(this._nextIFD),e)i=new Jf;else{if(!t.kind)throw new Error("kind is missing");i=new Xf(t.kind)}const n=this.readUint16();for(let t=0;t<n;t++)this.decodeIFDEntry(i);if(!t.ignoreImageData){if(!(i instanceof Jf))throw new Error("must be a tiff ifd");this.decodeImageData(i)}return this._nextIFD=this.readUint32(),i}decodeIFDEntry(t){const e=this.offset,i=this.readUint16(),n=this.readUint16(),r=this.readUint32();if(n<1||n>12)return void this.skip(4);const s=function(t,e){const i=Vf.get(t);if(!i)throw new Error(`type not found: ${t}`);return i[0]*e}(n,r);s>4&&this.seek(this.readUint32());const o=function(t,e,i){const n=Vf.get(e);if(!n)throw new Error(`type not found: ${e}`);return n[1](t,i)}(this,n,r);if(t.fields.set(i,o),34665===i||34853===i){let e=this.offset,n="exif";34665===i?n="exif":34853===i&&(n="gps"),this._nextIFD=o,t[n]=this.decodeIFD({kind:n,ignoreImageData:!0},!1),this.offset=e}this.seek(e),this.skip(12)}decodeImageData(t){const e=t.orientation;if(e&&1!==e)throw ng("orientation",e);switch(t.type){case 0:case 1:case 2:case 3:this.readStripData(t);break;default:throw ng("image type",t.type)}if(this.applyPredictor(t),this.convertAlpha(t),0===t.type){const e=t.bitsPerSample,i=Math.pow(2,e)-1;for(let e=0;e<t.data.length;e++)t.data[e]=i-t.data[e]}}readStripData(t){const e=t.width,i=t.height,n=t.bitsPerSample,r=t.sampleFormat,s=e*i*t.samplesPerPixel,o=function(t,e,i){if(8===e)return new Uint8Array(t);if(16===e)return new Uint16Array(t);if(32===e&&3===i)return new Float32Array(t);throw ng("bit depth / sample format",`${e} / ${i}`)}(s,n,r),a=t.rowsPerStrip*e*t.samplesPerPixel,h=t.stripOffsets,l=t.stripByteCounts||function(t){if(1!==t.compression)throw new Error("missing mandatory StripByteCounts field in compressed image");const e=t.rowsPerStrip*t.width*t.samplesPerPixel*(t.bitsPerSample/8);return new Array(t.stripOffsets.length).fill(e)}(t);let c=s,u=0;for(let e=0;e<h.length;e++){let i=new DataView(this.buffer,this.byteOffset+h[e],l[e]),s=c>a?a:c;c-=s;let d=i;switch(t.compression){case 1:break;case 5:d=Hf(i);break;case 8:d=tg(i);break;case 2:throw ng("Compression","CCITT Group 3");case 32773:throw ng("Compression","PackBits");default:throw ng("Compression",t.compression)}u=this.fillUncompressed(n,r,o,d,u,s)}t.data=o}fillUncompressed(t,e,i,n,r,s){if(8===t)return function(t,e,i,n){for(let r=0;r<n;r++)t[i++]=e.getUint8(r);return i}(i,n,r,s);if(16===t)return function(t,e,i,n,r){for(let s=0;s<2*n;s+=2)t[i++]=e.getUint16(s,r);return i}(i,n,r,s,this.isLittleEndian());if(32===t&&3===e)return function(t,e,i,n,r){for(let s=0;s<4*n;s+=4)t[i++]=e.getFloat32(s,r);return i}(i,n,r,s,this.isLittleEndian());throw ng("bitDepth",t)}applyPredictor(t){const e=t.bitsPerSample;switch(t.predictor){case 1:break;case 2:if(8===e)!function(t,e,i){let n=0;for(;n<t.length;){for(let r=i;r<e*i;r+=i)for(let e=0;e<i;e++)t[n+r+e]=t[n+r+e]+t[n+r-(i-e)]&255;n+=e*i}}(t.data,t.width,t.components);else{if(16!==e)throw new Error(`Horizontal differencing is only supported for images with a bit depth of ${e}`);!function(t,e,i){let n=0;for(;n<t.length;){for(let r=i;r<e*i;r+=i)for(let e=0;e<i;e++)t[n+r+e]=t[n+r+e]+t[n+r-(i-e)]&65535;n+=e*i}}(t.data,t.width,t.components)}break;default:throw new Error(`invalid predictor: ${t.predictor}`)}}convertAlpha(t){if(t.alpha&&t.associatedAlpha){const{data:e,components:i,maxSampleValue:n}=t;for(let t=0;t<e.length;t+=i){const r=e[t+i-1];for(let s=0;s<i-1;s++)e[t+s]=Math.round(e[t+s]*n/r)}}}}function ng(t,e){return new Error(`Unsupported ${t}: ${e}`)}function rg(t={}){let{algorithm:e="matchToPrevious",ignoreBorder:i=[0,0]}=t;this.checkProcessable("matchAndCrop",{bitDepth:[8,16]});let n="matchToPrevious"===e,r=this[0],s=[];s[0]={position:[0,0],image:this[0]};let o=[0,0];for(let t=1;t<this.length;t++){let e=r.getBestMatch(this[t],{border:i});s[t]={position:[e[0]+o[0],e[1]+o[1]],image:this[t]},n&&(o[0]+=e[0],o[1]+=e[1],r=this[t])}let a=0,h=0,l=0,c=0;for(let t=0;t<s.length;t++){let e=s[t];e.position[0]>a&&(a=e.position[0]),e.position[0]<h&&(h=e.position[0]),e.position[1]>l&&(l=e.position[1]),e.position[1]<c&&(c=e.position[1])}h=0-h,c=0-c;for(let t=0;t<s.length;t++){let e=s[t];e.crop=e.image.crop({x:a-e.position[0],y:l-e.position[1],width:r.width-h-a,height:r.height-c-l})}let u=[];for(let t=0;t<s.length;t++)u[t]=s[t].crop;return new pg(u)}function sg(){this.checkProcessable("min",{bitDepth:[8,16]});let t=this[0].min;for(let e=1;e<this.length;e++)for(let i=0;i<t.length;i++)t[i]=Math.min(t[i],this[e].min[i]);return t}function og(){this.checkProcessable("min",{bitDepth:[8,16]});let t=this[0].max;for(let e=1;e<this.length;e++)for(let i=0;i<t.length;i++)t[i]=Math.max(t[i],this[e].max[i]);return t}function ag(t){let e=t.reduce(((t,e)=>t+e));if(0===e)throw new Error("unreachable");let i,n=0,r=0,s=e/2;for(;;){if(t[n]>0){if(void 0!==i)return(i+n)/2;if(r+=t[n],r>s)return n;r===s&&(i=n)}n++}}function hg(t){let e=0,i=0;for(let n=0;n<t.length;n++)e+=t[n],i+=t[n]*n;return 0===e?0:i/e}function lg(){this.checkProcessable("median",{bitDepth:[8,16]});let t=this.getHistograms({maxSlots:this[0].maxValue+1}),e=new Array(t.length);for(let i=0;i<t.length;i++){let n=t[i];e[i]=ag(n)}return e}function cg(t){this.checkProcessable("min",{bitDepth:[8,16]});let e=this[0].getHistogram(t);for(let i=1;i<this.length;i++){let n=this[i].getHistogram(t);for(let t=0;t<e.length;t++)e[t]+=n[t]}return e}function ug(t){this.checkProcessable("min",{bitDepth:[8,16]});let e=this[0].getHistograms(t),i=e[0].length;for(let n=1;n<this.length;n++){let r=this[n].getHistograms(t);for(let t=0;t<e.length;t++)for(let n=0;n<i;n++)e[t][n]+=r[t][n]}return e}function dg(){this.checkProcessable("averageImage",{bitDepth:[8,16]});let t=new Uint32Array(this[0].data.length);for(let e=0;e<this.length;e++){let i=this[e];for(let e=0;e<this[0].data.length;e++)t[e]+=i.data[e]}let e=vw.createFrom(this[0]),i=e.data;for(let e=0;e<this[0].data.length;e++)i[e]=t[e]/this.length;return e}function fg(){this.checkProcessable("max",{bitDepth:[8,16]});let t=vw.createFrom(this[0]);t.data.fill(0);for(const e of this)for(let i=0;i<t.data.length;i++)t.data[i]=Math.max(e.data[i],t.data[i]);return t}function gg(){this.checkProcessable("max",{bitDepth:[8,16]});let t=vw.createFrom(this[0]);t.data.fill(t.maxValue);for(const e of this)for(let i=0;i<t.data.length;i++)t.data[i]=Math.min(e.data[i],t.data[i]);return t}let mg={configurable:!0,enumerable:!1,get:void 0};class pg extends Array{constructor(t){if(Array.isArray(t)){super(t.length);for(let e=0;e<t.length;e++)this[e]=t[e]}else"number"==typeof t?super(t):super();this.computed=null}static load(t){return Promise.all(t.map(vw.load)).then((t=>new pg(t)))}static extendMethod(t,e,i={}){let{inPlace:n=!1,returnThis:r=!0,partialArgs:s=[]}=i;return pg.prototype[t]=n?function(...t){this.computed=null;let i=e.apply(this,[...s,...t]);return r?this:i}:function(...t){return e.apply(this,[...s,...t])},pg}static extendProperty(t,e,i={}){let{partialArgs:n=[]}=i;return mg.get=function(){if(null===this.computed)this.computed={};else if(xf()(t,this.computed))return this.computed[t];let i=e.apply(this,n);return this.computed[t]=i,i},Object.defineProperty(pg.prototype,t,mg),pg}checkProcessable(t,e={}){if("string"!=typeof t)throw new TypeError("checkProcessable requires as first parameter the processName (a string)");if(0===this.size)throw new TypeError(`The process: ${t} can not be applied on an empty stack`);this[0].checkProcessable(t,e);for(let i=1;i<this.length;i++){if((void 0===e.sameSize||e.sameSize)&&this[0].width!==this[i].width)throw new TypeError(`The process: ${t} can not be applied if width is not identical in all images`);if((void 0===e.sameSize||e.sameSize)&&this[0].height!==this[i].height)throw new TypeError(`The process: ${t} can not be applied if height is not identical in all images`);if((void 0===e.sameAlpha||e.sameAlpha)&&this[0].alpha!==this[i].alpha)throw new TypeError(`The process: ${t} can not be applied if alpha is not identical in all images`);if((void 0===e.sameBitDepth||e.sameBitDepth)&&this[0].bitDepth!==this[i].bitDepth)throw new TypeError(`The process: ${t} can not be applied if bitDepth is not identical in all images`);if((void 0===e.sameColorModel||e.sameColorModel)&&this[0].colorModel!==this[i].colorModel)throw new TypeError(`The process: ${t} can not be applied if colorModel is not identical in all images`);if((void 0===e.sameNumberChannels||e.sameNumberChannels)&&this[0].channels!==this[i].channels)throw new TypeError(`The process: ${t} can not be applied if channels is not identical in all images`)}}}Array[Symbol.species]||(pg.prototype.map=function(t,e){if("function"!=typeof t)throw new TypeError(`${t} is not a function`);let i=new pg(this.length);for(let n=0;n<this.length;n++)i[n]=t.call(e,this[n],n,this);return i}),function(t){t.extendMethod("matchAndCrop",rg),t.extendMethod("getMin",sg),t.extendMethod("getMax",og),t.extendMethod("getMedian",lg),t.extendMethod("getHistogram",cg),t.extendMethod("getHistograms",ug),t.extendMethod("getAverage",dg),t.extendMethod("getAverageImage",dg),t.extendMethod("getMaxImage",fg),t.extendMethod("getMinImage",gg)}(pg);const _g=/^data:[a-z]+\/(?:[a-z]+);base64,/;function wg(t,e,i){const n=Lf()(t);if(n)switch(n.mime){case"image/png":return function(t){const e=function(t,e){return new $d(t,void 0).decode()}(t);let i,n=e.channels,r=0;return 2===n||4===n?(i=n-1,r=1):i=n,e.palette?function(t){const e=t.width*t.height,i=t.palette[0].length,n=new Uint8Array(e*i),r=8/t.depth,s=t.depth<8?r:1,o=parseInt("1".repeat(t.depth),2),a=4===i;let h=0;for(let i=0;i<e;i++){const e=Math.floor(i/s);let l=t.data[e];t.depth<8&&(l=l>>>t.depth*(r-1-i%r)&o);const c=t.palette[l];n[h++]=c[0],n[h++]=c[1],n[h++]=c[2],a&&(n[h++]=c[3])}return new vw(t.width,t.height,n,{components:3,alpha:a,bitDepth:8})}(e):new vw(e.width,e.height,e.data,{components:i,alpha:r,bitDepth:e.depth})}(t);case"image/jpeg":return function(t){const e=(0,Df.decode)(t);let i;e.exif&&(i=yg(e.exif));const n=(0,uf.decode)(t,{useTArray:!0,maxMemoryUsageInMB:1024});let r=new vw(n.width,n.height,n.data,{meta:i});if(i&&i.tiff.tags.Orientation){const t=i.tiff.tags.Orientation;t>2&&(r=r.rotate({3:180,4:180,5:90,6:90,7:270,8:270}[t])),[2,4,5,7].includes(t)&&(r=r.flipX())}return r}(t);case"image/tiff":return function(t,e){let i=function(t,e){return new ig(t).decode(void 0)}(t);return 1===i.length?vg(i[0],e):new pg(i.map((function(t){return vg(t,e)})))}(t,i);default:return bg(r(n.mime))}return bg(r("application/octet-stream"));function r(i){return e||gf(t,i)}}function yg(t){const e={tiff:{fields:t.fields,tags:t.map}};return t.exif&&(e.exif=t.exif),t.gps&&(e.gps=t.gps),e}function vg(t,e){if(e||3!==t.type)return new vw(t.width,t.height,t.data,{components:2===t.type?3:1,alpha:t.alpha,colorModel:2===t.type?Sf:Ef,bitDepth:t.bitsPerSample.length?t.bitsPerSample[0]:t.bitsPerSample,meta:yg(t)});{const e=new Uint16Array(3*t.width*t.height),i=t.palette;let n=0;for(let r=0;r<t.data.length;r++){const s=i[t.data[r]];e[n++]=s[0],e[n++]=s[1],e[n++]=s[2]}return new vw(t.width,t.height,e,{components:3,alpha:t.alpha,colorModel:Sf,bitDepth:16,meta:yg(t)})}}function bg(t,e){return e=e||{},new Promise((function(i,n){let r=new pf;r.onload=function(){let t=r.width,n=r.height,s=_f(t,n).getContext("2d");s.drawImage(r,0,0,t,n);let o=s.getImageData(0,0,t,n).data;i(new vw(t,n,o,e))},r.onerror=function(){n(new Error(`Could not load ${t}`))},r.src=t}))}const xg={getValueXY(t,e,i){return this.data[(e*this.width+t)*this.channels+i]},setValueXY(t,e,i,n){return this.data[(e*this.width+t)*this.channels+i]=n,this.computed=null,this},getValue(t,e){return this.data[t*this.channels+e]},setValue(t,e,i){return this.data[t*this.channels+e]=i,this.computed=null,this},getPixelXY(t,e){return this.getPixel(e*this.width+t)},setPixelXY(t,e,i){return this.setPixel(e*this.width+t,i)},getPixel(t){const e=new Array(this.channels),i=t*this.channels;for(let t=0;t<this.channels;t++)e[t]=this.data[i+t];return e},setPixel(t,e){const i=t*this.channels;for(let t=0;t<e.length;t++)this.data[i+t]=e[t];return this.computed=null,this}};function Mg(t){return{width:t.width,height:t.height,components:t.components,alpha:t.alpha,colorModel:t.colorModel,bitDepth:t.bitDepth}}function Eg(t,e,i,n={}){const{out:r}=e;if(void 0===r)return n.copy?t.clone():vw.createFrom(t,i);{if(!vw.isImage(r))throw new TypeError("out must be an Image object");const e=Object.assign(Mg(t),i);for(const t in e)if(r[t]!==e[t])throw new RangeError(`cannot use out. Its ${t} must be "${e[t]}" (found "${r[t]}")`);return r}}function Sg(t,e,i){if(void 0!==e.inPlace&&"boolean"!=typeof e.inPlace)throw new TypeError("inPlace option must be a boolean");if(e.inPlace){if(void 0!==e.out)throw new TypeError("out option must not be set if inPlace option is true");return t}return Eg(t,e,null,i)}function kg(t={}){this.checkProcessable("abs",{bitDepth:[32]});const e=Sg(this,t);return function(t,e){for(let i=0;i<t.data.length;i++)e.data[i]=Math.abs(t.data[i])}(this,e),e}function Cg(t={}){this.checkProcessable("invert",{bitDepth:[1,8,16]});const e=Sg(this,t);return 1===this.bitDepth?function(t,e){for(let i=0;i<t.data.length;i++)e.data[i]=~t.data[i]}(this,e):(function(t,e){for(let i=0;i<t.data.length;i+=t.channels)for(let n=0;n<t.components;n++)e.data[i+n]=t.maxValue-t.data[i+n]}(this,e),this!==e&&function(t,e){if(1===t.alpha&&1===e.alpha)for(let i=0;i<t.size;i++)e.data[i*e.channels+e.components]=t.data[i*t.channels+t.components]}(this,e)),e}function Ig(){this.checkProcessable("flipX",{bitDepth:[8,16]});for(let t=0;t<this.height;t++){let e=t*this.width*this.channels;for(let t=0;t<Math.floor(this.width/2);t++){let i=t*this.channels+e,n=(this.width-t-1)*this.channels+e;for(let t=0;t<this.channels;t++){let e=this.data[i+t];this.data[i+t]=this.data[n+t],this.data[n+t]=e}}}return this}function Ag(){this.checkProcessable("flipY",{bitDepth:[8,16]});for(let t=0;t<Math.floor(this.height/2);t++)for(let e=0;e<this.width;e++){let i=e*this.channels+t*this.width*this.channels,n=e*this.channels+(this.height-1-t)*this.channels*this.width;for(let t=0;t<this.channels;t++){let e=this.data[i+t];this.data[i+t]=this.data[n+t],this.data[n+t]=e}}return this}function Tg(t={}){const{radius:e=1}=t;if(e<1)throw new Error("radius must be greater than 1");const i=2*e+1,n=new Array(i);for(let t=0;t<i;t++){n[t]=new Array(i);for(let e=0;e<i;e++)n[t][e]=1/(i*i)}return this.convolution(n)}var Rg=__webpack_require__(5520),Pg=__webpack_require__.n(Rg);function Dg(t,e={}){let{channels:i,allowAlpha:n,defaultAlpha:r}=e;return"boolean"!=typeof n&&(n=!0),void 0===i?function(t,e){let i=e?t.channels:t.components,n=new Array(i);for(let t=0;t<i;t++)n[t]=t;return n}(t,r):function(t,e,i){Array.isArray(e)||(e=[e]);for(let n=0;n<e.length;n++)e[n]=Fg(t,e[n],i);return e}(t,i,n)}function Fg(t,e,i=!0){if(void 0===e)throw new RangeError(`validateChannel : the channel has to be >=0 and <${t.channels}`);if("string"==typeof e){switch(t.colorModel){case Ef:break;case Sf:if("rgb".includes(e))switch(e){case"r":e=0;break;case"g":e=1;break;case"b":e=2}break;case kf:if("hsl".includes(e))switch(e){case"h":e=0;break;case"s":e=1;break;case"l":e=2}break;case Cf:if("hsv".includes(e))switch(e){case"h":e=0;break;case"s":e=1;break;case"v":e=2}break;case If:if("cmyk".includes(e))switch(e){case"c":e=0;break;case"m":e=1;break;case"y":e=2;break;case"k":e=3}break;default:throw new Error(`Unexpected color model: ${t.colorModel}`)}if("a"===e){if(!t.alpha)throw new Error("validateChannel : the image does not contain alpha channel");e=t.components}if("string"==typeof e)throw new Error(`validateChannel : undefined channel: ${e}`)}if(e>=t.channels)throw new RangeError(`validateChannel : the channel has to be >=0 and <${t.channels}`);if(!i&&e>=t.components)throw new RangeError("validateChannel : alpha channel may not be selected");return e}function Lg(t={}){let{radius:e=1,border:i="copy",channels:n}=t;if(this.checkProcessable("medianFilter",{bitDepth:[8,16]}),e<1)throw new Error("radius must be greater than 0");n=Dg(this,n);let r=e,s=e,o=vw.createFrom(this),a=new Array((2*r+1)*(2*s+1));for(let t=0;t<n.length;t++){let e=n[t];for(let t=s;t<this.height-s;t++)for(let i=r;i<this.width-r;i++){let n=0;for(let o=-s;o<=s;o++)for(let s=-r;s<=r;s++){let r=((t+o)*this.width+i+s)*this.channels+e;a[n++]=this.data[r]}let h=(t*this.width+i)*this.channels+e;o.data[h]=Pg()(a)}}if(this.alpha&&!n.includes(this.channels))for(let t=this.components;t<this.data.length;t+=this.channels)o.data[t]=this.data[t];return o.setBorder({size:[r,s],algorithm:i}),o}function Og(t={}){let{radius:e=1,sigma:i,channels:n,border:r="copy"}=t;this.checkProcessable("gaussian",{bitDepth:[8,16]});const s=function(t,e){const i=2*t+1,n=new Array(i),r=e||.3*(.5*(i-1)-1)+.8,s=-.5/(r*r);let o=0;for(let e=0;e<i;e++){const i=e-t,r=Math.exp(s*i*i);n[e]=r,o+=r}for(let t=0;t<i;t++)n[t]/=o;return n}(e,i);return this.convolution([s,s],{border:r,channels:n,algorithm:"separable"})}const Ng=[[-1,0,1],[-2,0,2],[-1,0,1]],Bg=[[-1,-2,-1],[0,0,0],[1,2,1]],zg=[[3,0,-3],[10,0,-10],[3,0,-3]],Ug=[[3,10,3],[0,0,0],[-3,-10,-3]];var Gg=__webpack_require__(414),Yg=__webpack_require__(8336),Xg=__webpack_require__.n(Yg);function Vg(t,e){return Math.round(Math.min(Math.max(t,0),e.maxValue))}function jg(t,e,i){if(void 0===i){const n=t.length+e.length-1;i=new Array(n)}!function(t){for(var e=0;e<t.length;e++)t[e]=0}(i);for(var n=0;n<t.length;n++)for(var r=0;r<e.length;r++)i[n+r]+=t[n]*e[r];return i}function qg(t,e,i,n){const r=new Array(t.length);let s,o,a,h;h=e[1],a=(h.length-1)/2,o=new Array(i+h.length-1),s=new Array(i);for(let e=0;e<n;e++){for(let n=0;n<i;n++)s[n]=t[e*i+n];jg(s,h,o);for(let t=0;t<i;t++)r[e*i+t]=o[a+t]}h=e[0],a=(h.length-1)/2,o=new Array(n+h.length-1),s=new Array(n);for(let t=0;t<i;t++){for(let e=0;e<n;e++)s[e]=r[e*i+t];jg(s,h,o);for(let e=0;e<n;e++)r[e*i+t]=o[a+e]}return r}__webpack_require__(9645),__webpack_require__(995);var Wg=__webpack_require__(8406);Wg.AbstractMatrix,Wg.CHO,Wg.CholeskyDecomposition,Wg.DistanceMatrix,Wg.EVD,Wg.EigenvalueDecomposition,Wg.LU,Wg.LuDecomposition;const Zg=Wg.Matrix,Kg=(Wg.MatrixColumnSelectionView,Wg.MatrixColumnView,Wg.MatrixFlipColumnView,Wg.MatrixFlipRowView,Wg.MatrixRowSelectionView,Wg.MatrixRowView,Wg.MatrixSelectionView,Wg.MatrixSubView,Wg.MatrixTransposeView,Wg.NIPALS,Wg.Nipals,Wg.QR,Wg.QrDecomposition,Wg.SVD),Hg=Wg.SingularValueDecomposition,$g=(Wg.SymmetricMatrix,Wg.WrapperMatrix1D,Wg.WrapperMatrix2D,Wg.correlation,Wg.covariance,Wg.Matrix,Wg.Matrix,Wg.determinant,Wg.inverse),Jg=(Wg.linearDependencies,Wg.pseudoInverse,Wg.solve);function Qg(t,e={}){let{channels:i,bitDepth:n,normalize:r=!1,divisor:s=1,border:o="copy",algorithm:a="auto"}=e,h={};n&&(h.bitDepth=n);let l,c,u=vw.createFrom(this,h);if(i=Dg(this,i),"separable"!==a)({kernel:t}=function(t){let e,i;if(!Array.isArray(t))throw new Error(`validateKernel: Invalid Kernel: ${t}`);if(Array.isArray(t[0])){if(0==(1&t.length)||0==(1&t[0].length))throw new RangeError("validateKernel: Kernel rows and columns should be odd numbers");e=Math.floor(t.length/2),i=Math.floor(t[0].length/2)}else{let n=Math.sqrt(t.length);if(!Xg()(n))throw new RangeError("validateKernel: Kernel array should be a square");i=e=Math.floor(Math.sqrt(t.length)/2);let r=new Array(n);for(let e=0;e<n;e++){r[e]=new Array(n);for(let i=0;i<n;i++)r[e][i]=t[e*n+i]}t=r}return{kernel:t,kWidth:i,kHeight:e}}(t));else if(!Array.isArray(t)||2!==t.length)throw new RangeError("separable convolution requires two arrays of numbers to represent the kernel");if("auto"===a){let e=function(t){const e=new Kg(t,{autoTranspose:!0});if(1!==e.rank)return null;const i=Math.sqrt(e.s[0]);return[e.U.to2DArray().map((t=>t[0]*i)),e.V.to2DArray().map((t=>t[0]*i))]}(t);null!==e?(a="separable",t=e):a=(t.length>9||t[0].length>9)&&this.width<=4096&&this.height<=4096?"fft":"direct"}"separable"===a?(l=Math.floor(t[0].length/2),c=Math.floor(t[1].length/2)):(l=Math.floor(t.length/2),c=Math.floor(t[0].length/2));let d,f,g,m,p,_,w=u.isClamped,y=new Array(this.height*this.width);for(m=0;m<i.length;m++){for(p=i[m],g=0;g<this.height;g++)for(f=0;f<this.width;f++)d=g*this.width+f,y[d]=this.data[d*this.channels+p];if("direct"===a)_=(0,Gg.direct)(y,t,{rows:this.height,cols:this.width,normalize:r,divisor:s});else if("separable"===a){if(_=qg(y,t,this.width,this.height),r){s=0;for(let e=0;e<t[0].length;e++)for(let i=0;i<t[1].length;i++)s+=t[0][e]*t[1][i]}if(1!==s)for(let t=0;t<_.length;t++)_[t]/=s}else _=(0,Gg.fft)(y,t,{rows:this.height,cols:this.width,normalize:r,divisor:s});for(g=0;g<this.height;g++)for(f=0;f<this.width;f++)d=g*this.width+f,u.data[d*this.channels+p]=w?Vg(_[d],u):_[d]}if(this.alpha&&!i.includes(this.channels))for(f=this.components;f<this.data.length;f+=this.channels)u.data[f]=this.data[f];return"periodic"!==o&&u.setBorder({size:[c,l],algorithm:o}),u}function tm(t={}){let{direction:e="xy",border:i="copy",kernelX:n,kernelY:r,channels:s,bitDepth:o=this.bitDepth}=t;switch(this.checkProcessable("gradientFilter",{bitDepth:[8,16]}),e){case"x":if(!n)throw new Error("kernelX option is missing");return Qg.call(this,n,{channels:s,border:i,bitDepth:o});case"y":if(!r)throw new Error("kernelY option is missing");return Qg.call(this,r,{channels:s,border:i,bitDepth:o});case"xy":{if(!n)throw new Error("kernelX option is missing");if(!r)throw new Error("kernelY option is missing");const t=Qg.call(this,n,{channels:s,border:i,bitDepth:32}),e=Qg.call(this,r,{channels:s,border:i,bitDepth:32});return t.hypotenuse(e,{bitDepth:o,channels:s})}default:throw new Error(`Unknown parameter direction: ${e}`)}}function em(t){return tm.call(this,Object.assign({},t,{kernelX:Ng,kernelY:Bg}))}function im(t){return tm.call(this,Object.assign({},t,{kernelX:zg,kernelY:Ug}))}Wg.wrap;var nm=__webpack_require__(2664),rm=__webpack_require__.n(nm);function sm(t={}){let{algorithm:e="range",channels:i,min:n=this.min,max:r=this.max}=t;if(this.checkProcessable("level",{bitDepth:[8,16,32]}),i=Dg(this,{channels:i}),i.length!==this.channel&&(Array.isArray(n)&&n.length===this.channels&&(n=n.filter(((t,e)=>i.includes(e)))),Array.isArray(r)&&r.length===this.channels&&(r=r.filter(((t,e)=>i.includes(e))))),"range"!==e)throw new Error(`level: algorithm not implement: ${e}`);return n<0&&(n=0),r>this.maxValue&&(r=this.maxValue),Array.isArray(n)||(n=rm()(i.length,n)),Array.isArray(r)||(r=rm()(i.length,r)),function(t,e,i,n){let r=1e-5,s=new Array(n.length);for(let o=0;o<n.length;o++)0===e[o]&&i[o]===t.maxValue||i[o]===e[o]?s[o]=0:s[o]=(t.maxValue+1-r)/(i[o]-e[o]),e[o]+=.499995/s[o];for(let i=0;i<n.length;i++){let r=n[i];if(0!==s[i])for(let n=0;n<t.data.length;n+=t.channels)t.data[n+r]=Math.min(Math.max(0,(t.data[n+r]-e[i])*s[i]+.5|0),t.maxValue)}}(this,n,r,i),this}var om=__webpack_require__(7811),am=__webpack_require__.n(om);function hm(t){if(isNaN(t)){if(t instanceof vw)return t.data;if(!am()(t))throw new Error("checkNumberArray: the value should be either a number, array or Image");return t}if(t<=0)throw new Error("checkNumberArray: the value must be greater than 0");return t}function lm(t,e={}){let{channels:i}=e;if(this.checkProcessable("add",{bitDepth:[8,16]}),i=Dg(this,{channels:i}),t=hm(t),isNaN(t)){if(this.data.length!==t.length)throw new Error("add: the data size is different");for(let e=0;e<i.length;e++){let n=i[e];for(let e=0;e<this.data.length;e+=this.channels)this.data[e+n]=Math.max(0,Math.min(this.maxValue,this.data[e+n]+t[e+n]>>0))}}else for(let e=0;e<i.length;e++){let n=i[e];for(let e=0;e<this.data.length;e+=this.channels)this.data[e+n]=Math.min(this.maxValue,this.data[e+n]+t>>0)}return this}function cm(t,e={}){let{channels:i}=e;if(this.checkProcessable("subtract",{bitDepth:[8,16]}),i=Dg(this,{channels:i}),t=hm(t),isNaN(t)){if(this.data.length!==t.length)throw new Error("subtract: the data size is different");for(let e=0;e<i.length;e++){let n=i[e];for(let e=0;e<this.data.length;e+=this.channels)this.data[e+n]=Math.max(0,Math.min(this.maxValue,this.data[e+n]-t[e+n]>>0))}}else for(let e=0;e<i.length;e++){let n=i[e];for(let e=0;e<this.data.length;e+=this.channels)this.data[e+n]=Math.max(0,this.data[e+n]-t>>0)}return this}function um(t,e={}){let{channels:i,absolute:n=!1}=e;if(this.checkProcessable("subtractImage",{bitDepth:[8,16]}),this.width!==t.width||this.height!==t.height)throw new Error("subtractImage: both images must have the same size");if(this.alpha!==t.alpha||this.bitDepth!==t.bitDepth)throw new Error("subtractImage: both images must have the same alpha and bitDepth");if(this.channels!==t.channels)throw new Error("subtractImage: both images must have the same number of channels");let r=this.clone();i=Dg(this,{channels:i});for(let e=0;e<i.length;e++)for(let s=i[e];s<this.data.length;s+=this.channels){let e=this.data[s]-t.data[s];r.data[s]=n?Math.abs(e):Math.max(e,0)}return r}function dm(t,e={}){let{bitDepth:i=this.bitDepth,channels:n}=e;if(this.checkProcessable("hypotenuse",{bitDepth:[8,16,32]}),this.width!==t.width||this.height!==t.height)throw new Error("hypotenuse: both images must have the same size");if(this.alpha!==t.alpha||this.bitDepth!==t.bitDepth)throw new Error("hypotenuse: both images must have the same alpha and bitDepth");if(this.channels!==t.channels)throw new Error("hypotenuse: both images must have the same number of channels");let r=vw.createFrom(this,{bitDepth:i});n=Dg(this,{channels:n});let s=r.isClamped;for(let e=0;e<n.length;e++)for(let i=n[e];i<this.data.length;i+=this.channels){let e=Math.hypot(this.data[i],t.data[i]);r.data[i]=s?Math.min(Math.max(Math.round(e),0),r.maxValue):e}return r}function fm(t,e={}){let{channels:i}=e;if(this.checkProcessable("multiply",{bitDepth:[8,16]}),t<=0)throw new Error("multiply: the value must be greater than 0");if(i=Dg(this,{channels:i}),t=hm(t),isNaN(t)){if(this.data.length!==t.length)throw new Error("multiply: the data size is different");for(let e=0;e<i.length;e++){let n=i[e];for(let e=0;e<this.data.length;e+=this.channels)this.data[e+n]=Math.max(0,Math.min(this.maxValue,this.data[e+n]*t[e+n]>>0))}}else for(let e=0;e<i.length;e++){let n=i[e];for(let e=0;e<this.data.length;e+=this.channels)this.data[e+n]=Math.min(this.maxValue,this.data[e+n]*t>>0)}return this}function gm(t,e={}){let{channels:i}=e;if(this.checkProcessable("divide",{bitDepth:[8,16]}),i=Dg(this,{channels:i}),t=hm(t),isNaN(t)){if(this.data.length!==t.length)throw new Error("divide: the: the data size is different");for(let e=0;e<i.length;e++){let n=i[e];for(let e=0;e<this.data.length;e+=this.channels)this.data[e+n]=Math.max(0,Math.min(this.maxValue,this.data[e+n]/t[e+n]>>0))}}else for(let e=0;e<i.length;e++){let n=i[e];for(let e=0;e<this.data.length;e+=this.channels)this.data[e+n]=Math.min(this.maxValue,this.data[e+n]/t>>0)}return this}var mm=__webpack_require__(4091);class pm{constructor(){if(new.target===pm)throw new Error("BaseRegression must be subclassed")}predict(t){if("number"==typeof t)return this._predict(t);if((0,mm.isAnyArray)(t)){const e=[];for(let i=0;i<t.length;i++)e.push(this._predict(t[i]));return e}throw new TypeError("x must be a number or array")}_predict(){throw new Error("_predict must be implemented")}train(){}toString(){return""}toLaTeX(){return""}score(t,e){if(!(0,mm.isAnyArray)(t)||!(0,mm.isAnyArray)(e)||t.length!==e.length)throw new Error("x and y must be arrays of the same length");const i=t.length,n=new Array(i);for(let e=0;e<i;e++)n[e]=this._predict(t[e]);let r=0,s=0,o=0,a=0,h=0,l=0,c=0;for(let t=0;t<i;t++)r+=n[t],s+=e[t],h+=n[t]*n[t],l+=e[t]*e[t],c+=n[t]*e[t],0!==e[t]&&(o+=(e[t]-n[t])*(e[t]-n[t])/e[t]),a+=(e[t]-n[t])*(e[t]-n[t]);const u=(i*c-r*s)/Math.sqrt((i*h-r*r)*(i*l-s*s));return{r:u,r2:u*u,chi2:o,rmsd:Math.sqrt(a/i)}}}var _m=__webpack_require__(6952),wm=__webpack_require__.n(_m);const ym={lambda:.1,kernelType:"gaussian",kernelOptions:{},computeCoefficient:!1};class vm extends pm{constructor(t,e,i){if(super(),!0===t)this.alpha=e.alpha,this.inputs=e.inputs,this.kernelType=e.kernelType,this.kernelOptions=e.kernelOptions,this.kernel=new(wm())(e.kernelType,e.kernelOptions);else{t=Zg.checkMatrix(t),i=Object.assign({},ym,i);const n=new(wm())(i.kernelType,i.kernelOptions),r=n.compute(t),s=t.rows;r.add(Zg.eye(s,s).mul(i.lambda)),this.alpha=Jg(r,e),this.inputs=t,this.kernelType=i.kernelType,this.kernelOptions=i.kernelOptions,this.kernel=n}}_predict(t){return this.kernel.compute([t],this.inputs).mmul(this.alpha).getRow(0)}toJSON(){return{name:"kernelRidgeRegression",alpha:this.alpha,inputs:this.inputs,kernelType:this.kernelType,kernelOptions:this.kernelOptions}}static load(t){if("kernelRidgeRegression"!==t.name)throw new TypeError("not a KRR model");return new vm(!0,t)}}function bm(t,e,i){const n=new vm(t,e,i),r=new Array(this.size);for(let t=0;t<this.width;t++)for(let e=0;e<this.height;e++)r[e*this.width+t]=[t,e];const s=n.predict(r),o=vw.createFrom(this);for(let t=0;t<this.size;t++)o.data[t]=Math.min(this.maxValue,Math.max(0,s[t][0]));return o}function xm(t={}){let{kernel:e=[[1,1,1],[1,1,1],[1,1,1]],iterations:i=1}=t;if(this.checkProcessable("dilate",{bitDepth:[1,8,16],components:1,alpha:0}),e.columns%2==0||e.rows%2==0)throw new TypeError("dilate: The number of rows and columns of the kernel must be odd");let n=!0;t:for(const t of e)for(const e of t)if(1!==e){n=!1;break t}let r=this;for(let t=0;t<i;t++)if(1===this.bitDepth)if(n){const t=r.clone();r=km(r,t,e.length,e[0].length)}else r=Sm(r,vw.createFrom(r),e);else r=n?Em(r,vw.createFrom(r),e.length,e[0].length):Mm(r,vw.createFrom(r),e);return r}function Mm(t,e,i){const n=i.length,r=i[0].length;let s=(n-1)/2,o=(r-1)/2;for(let a=0;a<t.height;a++)for(let h=0;h<t.width;h++){let l=0;for(let e=0;e<r;e++)for(let r=0;r<n;r++){if(1!==i[r][e])continue;let n=r-s+h,c=e-o+a;if(n<0||c<0||n>=t.width||c>=t.height)continue;const u=t.getValueXY(n,c,0);u>l&&(l=u)}e.setValueXY(h,a,0,l)}return e}function Em(t,e,i,n){const r=(i-1)/2,s=(n-1)/2,o=[];for(let e=0;e<t.width;e++)o.push(0);for(let i=0;i<t.height;i++){for(let e=0;e<t.width;e++){let n=0;for(let r=Math.max(0,i-s);r<Math.min(t.height,i+s+1);r++){const i=t.getValueXY(e,r,0);i>n&&(n=i)}o[e]=n}for(let n=0;n<t.width;n++){let s=0;for(let e=Math.max(0,n-r);e<Math.min(t.width,n+r+1);e++)o[e]>s&&(s=o[e]);e.setValueXY(n,i,0,s)}}return e}function Sm(t,e,i){const n=i.length,r=i[0].length;let s=(n-1)/2,o=(r-1)/2;for(let a=0;a<t.height;a++)for(let h=0;h<t.width;h++){let l=0;t:for(let e=0;e<r;e++)for(let r=0;r<n;r++){if(1!==i[r][e])continue;let n=r-s+h,c=e-o+a;if(!(c<0||n<0||n>=t.width||c>=t.height)&&1===t.getBitXY(n,c)){l=1;break t}}1===l&&e.setBitXY(h,a)}return e}function km(t,e,i,n){const r=(i-1)/2,s=(n-1)/2,o=[];for(let e=0;e<t.width;e++)o.push(1);for(let i=0;i<t.height;i++){for(let e=0;e<t.width;e++){o[e]=0;for(let n=Math.max(0,i-s);n<Math.min(t.height,i+s+1);n++)if(1===t.getBitXY(e,n)){o[e]=1;break}}for(let n=0;n<t.width;n++)if(1!==e.getBitXY(n,i))for(let s=Math.max(0,n-r);s<Math.min(t.width,n+r+1);s++)if(1===o[s]){e.setBitXY(n,i);break}}return e}function Cm(t={}){let{kernel:e=[[1,1,1],[1,1,1],[1,1,1]],iterations:i=1}=t;if(this.checkProcessable("erode",{bitDepth:[1,8,16],components:1,alpha:0}),e.columns%2==0||e.rows%2==0)throw new TypeError("erode: The number of rows and columns of the kernel must be odd");let n=!0;t:for(const t of e)for(const e of t)if(1!==e){n=!1;break t}let r=this;for(let t=0;t<i;t++)if(1===this.bitDepth)if(n){const t=r.clone();r=Rm(r,t,e.length,e[0].length)}else r=Tm(r,vw.createFrom(r),e);else r=n?Am(r,vw.createFrom(r),e.length,e[0].length):Im(r,vw.createFrom(r),e);return r}function Im(t,e,i){const n=i.length,r=i[0].length;let s=(n-1)/2,o=(r-1)/2;for(let a=0;a<t.height;a++)for(let h=0;h<t.width;h++){let l=t.maxValue;for(let e=0;e<r;e++)for(let r=0;r<n;r++){if(1!==i[r][e])continue;let n=r-s+h,c=e-o+a;if(n<0||c<0||n>=t.width||c>=t.height)continue;const u=t.getValueXY(n,c,0);u<l&&(l=u)}e.setValueXY(h,a,0,l)}return e}function Am(t,e,i,n){const r=(i-1)/2,s=(n-1)/2,o=[];for(let e=0;e<t.width;e++)o.push(0);for(let i=0;i<t.height;i++){for(let e=0;e<t.width;e++){let n=t.maxValue;for(let r=Math.max(0,i-s);r<Math.min(t.height,i+s+1);r++){const i=t.getValueXY(e,r,0);i<n&&(n=i)}o[e]=n}for(let n=0;n<t.width;n++){let s=t.maxValue;for(let e=Math.max(0,n-r);e<Math.min(t.width,n+r+1);e++)o[e]<s&&(s=o[e]);e.setValueXY(n,i,0,s)}}return e}function Tm(t,e,i){const n=i.length,r=i[0].length;let s=(n-1)/2,o=(r-1)/2;for(let a=0;a<t.height;a++)for(let h=0;h<t.width;h++){let l=1;t:for(let e=0;e<r;e++)for(let r=0;r<n;r++){if(1!==i[r][e])continue;let n=r-s+h,c=e-o+a;if(!(c<0||n<0||n>=t.width||c>=t.height)&&0===t.getBitXY(n,c)){l=0;break t}}1===l&&e.setBitXY(h,a)}return e}function Rm(t,e,i,n){const r=(i-1)/2,s=(n-1)/2,o=[];for(let e=0;e<t.width;e++)o.push(0);for(let i=0;i<t.height;i++){for(let e=0;e<t.width;e++){o[e]=1;for(let n=Math.max(0,i-s);n<Math.min(t.height,i+s+1);n++)if(0===t.getBitXY(e,n)){o[e]=0;break}}for(let n=0;n<t.width;n++)if(0!==e.getBitXY(n,i))for(let s=Math.max(0,n-r);s<Math.min(t.width,n+r+1);s++)if(0===o[s]){e.clearBitXY(n,i);break}}return e}function Pm(t={}){let{kernel:e=[[1,1,1],[1,1,1],[1,1,1]],iterations:i=1}=t;if(this.checkProcessable("open",{bitDepth:[8,16],components:1,alpha:0}),e.columns%2==0||e.rows%2==0)throw new TypeError("open: The number of rows and columns of the kernel must be odd");let n=this;for(let t=0;t<i;t++)n=n.erode({kernel:e}),n=n.dilate({kernel:e});return n}function Dm(t={}){let{kernel:e=[[1,1,1],[1,1,1],[1,1,1]],iterations:i=1}=t;if(this.checkProcessable("close",{bitDepth:[1,8,16],components:1,alpha:0}),e.columns%2==0||e.rows%2==0)throw new TypeError("close: The number of rows and columns of the kernel must be odd");let n=this;for(let t=0;t<i;t++)n=n.dilate({kernel:e}).erode({kernel:e});return n}function Fm(t={}){let{kernel:e=[[1,1,1],[1,1,1],[1,1,1]],iterations:i=1}=t;if(this.checkProcessable("topHat",{bitDepth:[8,16],components:1,alpha:0}),e.length%2==0||e[0].length%2==0)throw new TypeError("topHat: The number of rows and columns of the kernel must be odd");let n=this;for(let t=0;t<i;t++){let t=n.open({kernel:e});n=t.subtractImage(n,{absolute:!0})}return n}function Lm(t={}){let{kernel:e=[[1,1,1],[1,1,1],[1,1,1]],iterations:i=1}=t;if(this.checkProcessable("blackHat",{bitDepth:[8,16],components:1,alpha:0}),e.columns%2==0||e.rows%2==0)throw new TypeError("blackHat: The number of rows and columns of the kernel must be odd");let n=this;for(let t=0;t<i;t++){const t=n.close({kernel:e});n=t.subtractImage(n,{absolute:!0})}return n}function Om(t={}){let{kernel:e=[[1,1,1],[1,1,1],[1,1,1]],iterations:i=1}=t;if(this.checkProcessable("morphologicalGradient",{bitDepth:[8,16],components:1,alpha:0}),e.columns%2==0||e.rows%2==0)throw new TypeError("morphologicalGradient: The number of rows and columns of the kernel must be odd");let n=this;for(let t=0;t<i;t++){let t=n.dilate({kernel:e}),i=n.erode({kernel:e});n=t.subtractImage(i,{absolute:!0})}return n}function Nm(t,e){return Math.sqrt(Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2))}function Bm(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function zm(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Um(t,e,i,n,r,s,o,a,h,l,c,u){let[d,f]=[(i*t+n*e+r)/(h*t+l*e+1),(s*t+o*e+a)/(h*t+l*e+1)];return c.getValueXY(Math.floor(d),Math.floor(f),u)}function Gm(t,e={}){let{calculateRatio:i=!0}=e;if(4!==t.length)throw new Error(`The array pts must have four elements, which are the four corners. Currently, pts have ${t.length} elements`);let n,r,[s,o,a,h]=t,l=[s,o,a,h],[c,u,d,f]=function(t){let e=0,i=0,n=0,r=0,s=t[0][0],o=0;for(let e=1;e<t.length;e++)t[e][0]<s&&(s=t[e][0],o=e);let a=t[(o+1)%t.length][0],h=(o+1)%t.length;for(let e=1;e<t.length;e++)t[e][0]<a&&e!==o&&(a=t[e][0],h=e);return t[h][1]<t[o][1]?(e=t[h],r=t[o],o!==(h+1)%4?(i=t[(h+1)%4],n=t[(h+2)%4]):(i=t[(h+2)%4],n=t[(h+3)%4])):(r=t[h],e=t[o],h!==(o+1)%4?(i=t[(o+1)%4],n=t[(o+2)%4]):(i=t[(o+2)%4],n=t[(o+3)%4])),[e,i,n,r]}(l);i?[n,r]=function(t,e,i,n,r,s){let o=Math.max(Nm(t,e),Nm(n,i)),a=Math.max(Nm(t,n),Nm(e,i)),h=0,l=0,c=Math.ceil(r/2),u=Math.ceil(s/2),d=o/a,f=[t[0],t[1],1],g=[e[0],e[1],1],m=[n[0],n[1],1],p=[i[0],i[1],1],_=zm(Bm(f,p),m)/zm(Bm(g,p),m),w=zm(Bm(f,p),g)/zm(Bm(m,p),g),y=[_*g[0]-f[0],_*g[1]-f[1],_*g[2]-f[2]],v=[w*m[0]-f[0],w*m[1]-f[1],w*m[2]-f[2]],b=y[0],x=y[1],M=y[2],E=v[0],S=v[1],k=v[2],C=1/(M*k)*(b*E-(b*k+M*E)*c+M*k*c*c+(x*S-(x*k+M*S)*u+M*k*u*u));C=C>=0?Math.sqrt(C):Math.sqrt(-C);let I=new Zg([[C,0,c],[0,C,u],[0,0,1]]),A=I.transpose(),T=$g(A),R=$g(I),P=Zg.rowVector(y),D=Zg.rowVector(v),F=Math.sqrt(zm(P.mmul(T).mmul(R).to1DArray(),y)/zm(D.mmul(T).mmul(R).to1DArray(),v));return 0===F||0===d?(h=Math.ceil(o),l=Math.ceil(a)):F<d?(h=Math.ceil(o),l=Math.ceil(h/F)):(l=Math.ceil(a),h=Math.ceil(F*l)),[h,l]}(c,u,d,f,this.width,this.height):(n=Math.ceil(Math.max(Nm(c,u),Nm(f,d))),r=Math.ceil(Math.max(Nm(c,f),Nm(u,d))));let g=vw.createFrom(this,{width:n,height:r}),[m,p]=c,[_,w]=u,[y,v]=d,[b,x]=f,[M,E]=[0,0],[S,k]=[0,n-1],[C,I]=[r-1,n-1],[A,T]=[r-1,0],R=new Zg([[M,E,1,0,0,0,-M*m,-E*m],[S,k,1,0,0,0,-S*_,-k*_],[C,I,1,0,0,0,-C*y,-E*y],[A,T,1,0,0,0,-A*b,-T*b],[0,0,0,M,E,1,-M*p,-E*p],[0,0,0,S,k,1,-S*w,-k*w],[0,0,0,C,I,1,-C*v,-I*v],[0,0,0,A,T,1,-A*x,-T*x]]),P=Zg.columnVector([m,_,y,b,p,w,v,x]),D=new Hg(R).solve(P),[F,L,O,N,B,z,U,G]=D.to1DArray(),Y=new Zg(r,n);for(let t=0;t<this.channels;t++){for(let e=0;e<r;e++)for(let i=0;i<n;i++)Y.set(e,i,Um(e,i,F,L,O,N,B,z,U,G,this,t));g.setMatrix(Y,{channel:t})}return g}function Ym(t={}){let{x:e=0,y:i=0,width:n=this.width-e,height:r=this.height-i}=t;if(this.checkProcessable("crop",{bitDepth:[1,8,16]}),e=Math.round(e),i=Math.round(i),n=Math.round(n),r=Math.round(r),e>this.width-1||i>this.height-1)throw new RangeError(`crop: origin (x:${e}, y:${i}) out of range (${this.width-1}; ${this.height-1})`);if(n<=0||r<=0)throw new RangeError(`crop: width and height (width:${n}; height:${r}) must be positive numbers`);if(e<0||i<0)throw new RangeError(`crop: x and y (x:${e}, y:${i}) must be positive numbers`);if(n>this.width-e||r>this.height-i)throw new RangeError(`crop: (x: ${e}, y:${i}, width:${n}, height:${r}) size is out of range`);let s=this;return s=1===this.bitDepth?function(t,e,i,n,r,s){let o=r*t.channels,a=n+s,h=0,l=i*t.channels;for(let i=n;i<a;i++){let n=i*t.width*t.channels+l,r=n+o;for(;n<r;n++)t.getBit(n)&&e.setBit(h),++h}return e}(this,new vw(n,r,{kind:"BINARY",parent:this}),e,i,n,r):function(t,e,i,n,r,s){let o=r*t.channels,a=n+s,h=0,l=i*t.channels;for(let i=n;i<a;i++){let n=i*t.width*t.channels+l,r=n+o;for(;n<r;n++)e.data[h++]=t.data[n]}return e}(this,vw.createFrom(this,{width:n,height:r,position:[e,i]}),e,i,n,r),s}function Xm(t={}){this.checkProcessable("cropAlpha",{alpha:1});const{threshold:e=this.maxValue}=t;let i=function(t,e,i){for(let n=0;n<t.width;n++)for(let r=0;r<t.height;r++)if(t.getValueXY(n,r,i)>=e)return n;return-1}(this,e,this.components);if(-1===i)throw new Error("Could not find new dimensions. Threshold may be too high.");let n=function(t,e,i,n){for(let r=0;r<t.height;r++)for(let s=n;s<t.width;s++)if(t.getValueXY(s,r,i)>=e)return r;return-1}(this,e,this.components,i),r=function(t,e,i,n){for(let r=t.height-1;r>=0;r--)for(let s=n;s<t.width;s++)if(t.getValueXY(s,r,i)>=e)return r;return-1}(this,e,this.components,i),s=function(t,e,i,n,r,s){for(let o=t.width-1;o>=n;o--)for(let n=r;n<=s;n++)if(t.getValueXY(o,n,i)>=e)return o;return-1}(this,e,this.components,i,n,r);return this.crop({x:i,y:n,width:s-i+1,height:r-n+1})}function Vm(t,e){if(e<0||e>=t.channels)throw new RangeError(`channel must be included between 0 and ${t.channels-1}. Current value: ${e}`)}const jm={nearestneighbor:"nearestNeighbor",nearestneighbour:"nearestNeighbor",bilinear:"bilinear"};function qm(t){if("string"!=typeof t)throw new TypeError("interpolation must be a string");if(t=t.toLowerCase(),!jm[t])throw new RangeError(`invalid interpolation algorithm: ${t}`);return jm[t]}function Wm(t,e,i){const n=this.width/e,r=this.height/i;if(this.bitDepth>1)for(let s=0;s<e;s++){const e=Math.floor((s+.5)*n);for(let n=0;n<i;n++){const i=Math.floor((n+.5)*r);for(let r=0;r<this.channels;r++)t.setValueXY(s,n,r,this.getValueXY(e,i,r))}}else for(let s=0;s<e;s++){const e=Math.floor((s+.5)*n);for(let n=0;n<i;n++){const i=Math.floor((n+.5)*r);this.getBitXY(e,i)&&t.setBitXY(s,n)}}}function Zm(t={}){const{factor:e=1,interpolation:i=jm.nearestneighbor,preserveAspectRatio:n=!0}=t,r=qm(i);let s=t.width,o=t.height;if(s||(s=o&&n?Math.round(o*(this.width/this.height)):this.width),o||(o=n?Math.round(s*(this.height/this.width)):this.height),({width:s,height:o}=function(t,e,i){t=function(t){if("string"==typeof t){const e=t[t.length-1];t=parseFloat(t),"%"===e&&(t/=100)}return t}(t);let n=Math.round(t*e),r=Math.round(t*i);return n<=0&&(n=1),r<=0&&(r=1),{width:n,height:r}}(e,s,o)),s===this.width&&o===this.height){const t=this.clone();return t.position=[0,0],t}let a=Math.round((this.width-s)/2),h=Math.round((this.height-o)/2);const l=vw.createFrom(this,{width:s,height:o,position:[a,h]});if(r!==jm.nearestneighbor)throw new Error(`unsupported resize interpolation: ${r}`);return Wm.call(this,l,s,o),l}function Km(){this.checkProcessable("hsv",{bitDepth:[8,16],alpha:[0,1],colorModel:[Sf]});let t=vw.createFrom(this,{colorModel:Cf}),e=0,i=this.data;for(let n=0;n<i.length;n+=this.channels){let r=i[n],s=i[n+1],o=i[n+2],a=Math.min(r,s,o),h=Math.max(r,s,o),l=h-a,c=0,u=0===h?0:l/h,d=h;if(h!==a){switch(h){case r:c=(s-o)/l+(s<o?6:0);break;case s:c=(o-r)/l+2;break;case o:c=(r-s)/l+4;break;default:throw new Error("unreachable")}c/=6}t.data[e++]=c*this.maxValue,t.data[e++]=u*this.maxValue,t.data[e++]=d,this.alpha&&(t.data[e++]=i[n+3])}return t}function Hm(){this.checkProcessable("hsl",{bitDepth:[8,16],alpha:[0,1],colorModel:[Sf]});let t=vw.createFrom(this,{colorModel:kf}),e=Math.floor(this.maxValue/2),i=0,n=this.data;for(let r=0;r<n.length;r+=this.channels){let s=n[r],o=n[r+1],a=n[r+2],h=Math.max(s,o,a),l=Math.min(s,o,a),c=0,u=0,d=(h+l)/2;if(h!==l){let t=h-l;switch(u=d>e?t/(2-h-l):t/(h+l),h){case s:c=(o-a)/t+(o<a?6:0);break;case o:c=(a-s)/t+2;break;case a:c=(s-o)/t+4;break;default:throw new Error("unreachable")}c/=6}t.data[i++]=c*this.maxValue,t.data[i++]=u*this.maxValue,t.data[i++]=d,this.alpha&&(t.data[i++]=n[r+3])}return t}function $m(){this.checkProcessable("cmyk",{bitDepth:[8,16],alpha:[0,1],colorModel:[Sf]});let t=vw.createFrom(this,{components:4,colorModel:If}),e=0,i=this.data;for(let n=0;n<i.length;n+=this.channels){let r=i[n],s=i[n+1],o=i[n+2],a=Math.min(this.maxValue-r,this.maxValue-s,this.maxValue-o),h=(this.maxValue-r-a)/(1-a/this.maxValue),l=(this.maxValue-s-a)/(1-a/this.maxValue),c=(this.maxValue-o-a)/(1-a/this.maxValue);t.data[e++]=Math.round(h),t.data[e++]=Math.round(l),t.data[e++]=Math.round(c),t.data[e++]=Math.round(a),this.alpha&&(t.data[e++]=i[n+3])}return t}function Jm(){return new vw(this.width,this.height,this.getRGBAData(),{kind:"RGBA",parent:this})}const Qm={luma709:(t,e,i)=>6966*t+23436*e+2366*i>>15,luma601:(t,e,i)=>9798*t+19235*e+3735*i>>15,maximum:(t,e,i)=>Math.max(t,e,i),minimum:(t,e,i)=>Math.min(t,e,i),average:(t,e,i)=>(t+e+i)/3>>0,minmax:(t,e,i)=>(Math.max(t,e,i)+Math.min(t,e,i))/2,red:t=>t,green:(t,e)=>e,blue:(t,e,i)=>i,cyan(t,e,i,n){let r=Qm.black(t,e,i,n);return(n.maxValue-t-r)/(1-r/n.maxValue)>>0},magenta(t,e,i,n){let r=Qm.black(t,e,i,n);return(n.maxValue-e-r)/(1-r/n.maxValue)>>0},yellow(t,e,i,n){let r=Qm.black(t,e,i,n);return(n.maxValue-i-r)/(1-r/n.maxValue)>>0},black:(t,e,i,n)=>Math.min(n.maxValue-t,n.maxValue-e,n.maxValue-i),hue(t,e,i,n){let r=Qm.min(t,e,i),s=Qm.max(t,e,i);if(s===r)return 0;let o=0,a=s-r;switch(s){case t:o=(e-i)/a+(e<i?6:0);break;case e:o=(i-t)/a+2;break;case i:o=(t-e)/a+4;break;default:throw new Error("unreachable")}return o/6*n.maxValue>>0},saturation(t,e,i,n){let r=Qm.min(t,e,i),s=Qm.max(t,e,i);return 0===s?0:(s-r)/s*n.maxValue},lightness(t,e,i){let n=Qm.min(t,e,i);return(Qm.max(t,e,i)+n)/2}};Object.defineProperty(Qm,"luminosity",{enumerable:!1,value:Qm.lightness}),Object.defineProperty(Qm,"luminance",{enumerable:!1,value:Qm.lightness}),Object.defineProperty(Qm,"min",{enumerable:!1,value:Qm.minimum}),Object.defineProperty(Qm,"max",{enumerable:!1,value:Qm.maximum}),Object.defineProperty(Qm,"brightness",{enumerable:!1,value:Qm.maximum});const tp={};function ep(t={}){let{algorithm:e="luma709",keepAlpha:i=!1,mergeAlpha:n=!0}=t;if("string"!=typeof e&&"function"!=typeof e)throw new TypeError("algorithm must be a string or a function");this.checkProcessable("grey",{bitDepth:[8,16],alpha:[0,1]}),1===this.components&&(e="red"),i&=this.alpha,n&=this.alpha,i&&(n=!1);let r,s=Eg(this,t,{components:1,alpha:i,colorModel:Ef});if("function"==typeof e)r=e;else if(r=Qm[e.toLowerCase()],!r)throw new Error(`unsupported grey algorithm: ${e}`);let o=0;for(let t=0;t<this.data.length;t+=this.channels)n?s.data[o++]=Vg(r(this.data[t],this.data[t+1],this.data[t+2],this)*this.data[t+this.components]/this.maxValue,this):(s.data[o++]=Vg(r(this.data[t],this.data[t+1],this.data[t+2],this),this),s.alpha&&(s.data[o++]=this.data[t+this.components]));return s}function ip(t){let e=!1,i=0;for(let e=1;e<t.length-1;e++)if(t[e-1]<t[e]&&t[e+1]<t[e]&&(i++,i>2))return!1;return 2===i&&(e=!0),e}function np(t,e){let i=0;for(let n=0;n<=e;n++)i+=t[n];return i}function rp(t,e){let i=0;for(let n=0;n<=e;n++)i+=n*t[n];return i}function sp(t,e){let i=0;for(let n=0;n<=e;n++)i+=n*n*t[n];return i}function op(t){let e=new Array(t.length);for(let i=1;i<t.length-1;i++)e[i]=(t[i-1]+t[i]+t[i+1])/3;return e[0]=(t[0]+t[1])/3,e[t.length-1]=(t[t.length-2]+t[t.length-1])/3,e}function ap(t){let e=t.length,i=!1,n=0;for(let i=1;i<e-1;i++)if(t[i-1]<t[i]&&t[i+1]<t[i]&&(n++,n>2))return!1;return 2===n&&(i=!0),i}function hp(t,e){let i=0;for(let n=0;n<=e;n++)i+=t[n];return i}Object.keys(Qm).forEach((t=>{tp[t]=t}));const lp={huang:function(t){let e=0;for(let i=0;i<t.length;i++)if(0!==t[i]){e=i;break}let i=t.length-1;for(let n=t.length-1;n>=e;n--)if(0!==t[n]){i=n;break}let n=1/(i-e),r=new Array(t.length),s=0,o=0;for(let i=e;i<t.length;i++)s+=i*t[i],o+=t[i],r[i]=s/o;let a=new Array(t.length);s=o=0;for(let e=i;e>0;e--)s+=e*t[e],o+=t[e],a[e-1]=s/o;let h=-1,l=Number.MAX_VALUE;for(let e=0;e<t.length;e++){let i,s=0;for(let o=0;o<=e;o++)i=1/(1+n*Math.abs(o-r[e])),i<1e-6||i>.999999||(s+=t[o]*(-i*Math.log(i)-(1-i)*Math.log(1-i)));for(let r=e+1;r<t.length;r++)i=1/(1+n*Math.abs(r-a[e])),i<1e-6||i>.999999||(s+=t[r]*(-i*Math.log(i)-(1-i)*Math.log(1-i)));s<l&&(l=s,h=e)}return h},intermodes:function(t){let e=t.slice(),i=0;for(;!ip(e);){let n=0,r=0,s=e[0];for(let i=0;i<t.length-1;i++)n=r,r=s,s=e[i+1],e[i]=(n+r+s)/3;if(e[t.length-1]=(r+s)/3,i++,i>1e4)throw new Error("Intermodes Threshold not found after 10000 iterations")}let n=0;for(let i=1;i<t.length-1;i++)e[i-1]<e[i]&&e[i+1]<e[i]&&(n+=i);return Math.floor(n/2)},isodata:function(t){let e,i,n,r,s=0;for(let e=1;e<t.length;e++)if(t[e]>0){s=e+1;break}for(;;){e=0,n=0;for(let i=0;i<s;i++)n+=t[i],e+=t[i]*i;r=0,i=0;for(let e=s+1;e<t.length;e++)i+=t[e],r+=t[e]*e;if(n>0&&i>0&&(e/=n,r/=i,s===Math.round((e+r)/2)))break;if(s++,s>t.length-2)throw new Error("Threshold not found")}return s},li:function(t,e){let i,n,r,s,o,a,h,l,c,u,d,f;d=.5,u=0;for(let e=0;e<t.length;e++)u+=e*t[e];u/=e,h=u;do{a=h,i=a+.5|0,n=0,s=0;for(let e=0;e<=i;e++)n+=e*t[e],s+=t[e];l=0===s?0:n/s,r=0,o=0;for(let e=i+1;e<t.length;e++)r+=e*t[e],o+=t[e];c=0===o?0:r/o,f=(l-c)/(Math.log(l)-Math.log(c)),h=f<-Number.EPSILON?f-.5|0:f+.5|0}while(Math.abs(h-a)>.5);return i},maxentropy:function(t,e){let i=new Array(t.length);for(let n=0;n<t.length;n++)i[n]=t[n]/e;let n=new Array(t.length),r=new Array(t.length);n[0]=i[0],r[0]=1-n[0];for(let e=1;e<t.length;e++)n[e]=n[e-1]+i[e],r[e]=1-n[e];let s=0;for(let e=0;e<t.length;e++)if(Math.abs(n[e])>=Number.EPSILON){s=e;break}let o=t.length-1;for(let e=t.length-1;e>=s;e--)if(Math.abs(r[e])>=Number.EPSILON){o=e;break}let a,h,l,c=-1,u=Number.MIN_VALUE;for(let e=s;e<=o;e++){h=0;for(let r=0;r<=e;r++)0!==t[r]&&(h-=i[r]/n[e]*Math.log(i[r]/n[e]));l=0;for(let n=e+1;n<t.length;n++)0!==t[n]&&(l-=i[n]/r[e]*Math.log(i[n]/r[e]));a=h+l,u<a&&(u=a,c=e)}return c},mean:function(t,e){let i=0;for(let e=0;e<t.length;e++)i+=e*t[e];return Math.floor(i/e)},minerror:function(t,e){let i,n,r,s,o,a,h,l,c,u,d,f,g=-2,m=0;for(let e=0;e<t.length;e++)m+=e*t[e];for(m/=e,i=m;i!==g;){let e=np(t,i),m=np(t,t.length-1),p=rp(t,i),_=rp(t,t.length-1),w=sp(t,i);if(n=p/e,r=(_-p)/(m-e),s=e/m,o=(m-e)/m,a=w/e-n*n,h=(sp(t,t.length-1)-w)/(m-e)-r*r,l=1/a-1/h,c=n/a-r/h,u=n*n/a-r*r/h+Math.log10(a*(o*o)/(h*(s*s))),d=c*c-l*u,d<0)return i;g=i,f=(c+Math.sqrt(d))/l,i=isNaN(f)?g:Math.floor(f)}return i},minimum:function(t){if(t.length<2)return 0;let e=0,i=-1,n=-1,r=new Array(t.length);for(let e=0;e<t.length;e++)r[e]=t[e],t[e]>0&&(n=e);for(;!ap(r);)if(r=op(r),e++,e>1e4)return i;return i=function(t,e){let i;for(let n=1;n<e;n++)if(t[n-1]>t[n]&&t[n+1]>=t[n]){i=n;break}return i}(r,n),i},moments:function(t,e){let i,n,r,s,o,a,h=0,l=0,c=0,u=0,d=-1,f=t.length,g=new Array(f);for(let i=0;i<f;i++)g[i]=t[i]/e;for(let t=0;t<f;t++)h+=t*g[t],l+=t*t*g[t],c+=t*t*t*g[t];n=1*l-h*h,r=(-l*l+h*c)/n,s=(1*-c+l*h)/n,o=.5*(-s-Math.sqrt(s*s-4*r)),a=.5*(-s+Math.sqrt(s*s-4*r)),i=(a-h)/(a-o);for(let t=0;t<f;t++)if(u+=g[t],u>i){d=t;break}return d},otsu:function(t,e){let i=0,n=0,r=0,s=0,o=0;for(let e=0;e<t.length;e++)o+=e*t[e];for(let a=0;a<t.length;a++){n+=t[a];const h=e-n;if(0===n||0===h)continue;i+=a*t[a];const l=(o-i)/h,c=n*h*(i/n-l)*(i/n-l);c>=r&&(s=a,r=c)}return s},percentile:function(t){let e=-1,i=new Array(t.length),n=hp(t,t.length-1),r=1;for(let s=0;s<t.length;s++)i[s]=Math.abs(hp(t,s)/n-.5),i[s]<r&&(r=i[s],e=s);return e},renyientropy:function(t,e){let i,n,r,s=new Array(t.length),o=new Array(t.length),a=new Array(t.length),h=0,l=0,c=0,u=0,d=0,f=0;for(let i=0;i<t.length;i++)s[i]=t[i]/e;o[0]=s[0],a[0]=1-o[0];for(let e=1;e<t.length;e++)o[e]=o[e-1]+s[e],a[e]=1-o[e];n=0;for(let e=0;e<t.length;e++)if(Math.abs(o[e])>=Number.EPSILON){n=e;break}r=t.length-1;for(let e=t.length-1;e>=n;e--)if(Math.abs(a[e])>=Number.EPSILON){r=e;break}for(let e=n;e<=r;e++){let i=0,n=0,r=0;for(let a=0;a<=e;a++)0!==t[a]&&(i-=s[a]/o[e]*Math.log(s[a]/o[e])),n+=Math.sqrt(s[a]/o[e]),r+=s[a]*s[a]/(o[e]*o[e]);let g=0,m=0,p=0;for(let i=e+1;i<t.length;i++)0!==t[i]&&(g-=s[i]/a[e]*Math.log(s[i]/a[e])),m+=Math.sqrt(s[i]/a[e]),p+=s[i]*s[i]/(a[e]*a[e]);let _=i+g,w=2*(n*m>0?Math.log(n*m):0),y=-1*(r*p>0?Math.log(r*p):0);_>u&&(u=_,h=e),w>d&&(d=w,l=e),y>f&&(f=y,c=e)}let g,m=[h,l,c];m.sort(((t,e)=>t-e)),g=Math.abs(m[0]-m[1])<=5?Math.abs(m[1]-m[2])<=5?[1,2,1]:[0,1,3]:Math.abs(m[1]-m[2])<=5?[3,1,0]:[1,2,1];let p=o[m[2]]-o[m[0]];return i=Math.round(m[0]*(o[m[0]]+.25*p*g[0])+.25*m[1]*p*g[1]+m[2]*(a[m[2]]+.25*p*g[2])),i},shanbhag:function(t,e){let i=new Array(t.length);for(let n=0;n<t.length;n++)i[n]=t[n]/e;let n=new Array(t.length),r=new Array(t.length);n[0]=i[0],r[0]=1-n[0];for(let e=1;e<t.length;e++)n[e]=n[e-1]+i[e],r[e]=1-n[e];let s=0;for(let e=0;e<t.length;e++)if(Math.abs(n[e])>=Number.EPSILON){s=e;break}let o=t.length-1;for(let e=t.length-1;e>=s;e--)if(Math.abs(r[e])>=Number.EPSILON){o=e;break}let a,h,l,c,u=-1,d=Number.MAX_VALUE;for(let e=s;e<=o;e++){l=0,a=.5/n[e];for(let t=1;t<=e;t++)l-=i[t]*Math.log(1-a*n[t-1]);l*=a,c=0,a=.5/r[e];for(let n=e+1;n<t.length;n++)c-=i[n]*Math.log(1-a*r[n]);c*=a,h=Math.abs(l-c),h<d&&(d=h,u=e)}return u},triangle:function(t){let e=0,i=0,n=0,r=0;for(let i=0;i<t.length;i++)if(t[i]>0){e=i;break}e>0&&e--;for(let e=t.length-1;e>0;e--)if(t[e]>0){r=e;break}r<t.length-1&&r++;for(let e=0;e<t.length;e++)t[e]>i&&(n=e,i=t[e]);let s,o,a,h=!1;if(n-e<r-n){h=!0;let i=0,s=t.length-1;for(;i<s;){let e=t[i];t[i]=t[s],t[s]=e,i++,s--}e=t.length-1-r,n=t.length-1-n}if(e===n)return e;s=t[n],o=e-n,a=Math.sqrt(s*s+o*o),s/=a,o/=a,a=s*e+o*t[e];let l=e,c=0;for(let i=e+1;i<=n;i++){let e=s*i+o*t[i]-a;e>c&&(l=i,c=e)}if(l--,h){let e=0,i=t.length-1;for(;e<i;){let n=t[e];t[e]=t[i],t[i]=n,e++,i--}return t.length-1-l}return l},yen:function(t,e){let i=new Array(t.length);for(let n=0;n<t.length;n++)i[n]=t[n]/e;let n=new Array(t.length);n[0]=i[0];for(let e=1;e<t.length;e++)n[e]=n[e-1]+i[e];let r=new Array(t.length);r[0]=i[0]*i[0];for(let e=1;e<t.length;e++)r[e]=r[e-1]+i[e]*i[e];let s=new Array(t.length);s[t.length-1]=0;for(let e=t.length-2;e>=0;e--)s[e]=s[e+1]+i[e+1]*i[e+1];let o,a=-1,h=Number.MIN_VALUE;for(let e=0;e<t.length;e++)o=-1*(r[e]*s[e]>0?Math.log(r[e]*s[e]):0)+2*(n[e]*(1-n[e])>0?Math.log(n[e]*(1-n[e])):0),o>h&&(h=o,a=e);return a}},cp={};function up(t={}){let{algorithm:e=cp.otsu}=t;this.checkProcessable("getThreshold",{components:1,bitDepth:[8,16]});let i=lp[e.toLowerCase()];if(i)return i(this.getHistogram(),this.size);throw new Error(`unknown thresholding algorithm: ${e}`)}Object.keys(lp).forEach((t=>{cp[t]=t}));const dp="threshold";function fp(t={}){let{algorithm:e=dp,threshold:i=.5,useAlpha:n=!0,invert:r=!1}=t;this.checkProcessable("mask",{components:1,bitDepth:[8,16]}),i=e===dp?function(t,e){if(!e)throw Error("getThreshold : the maxValue should be specified");if("string"==typeof t){if("%"!==t[t.length-1])throw Error("getThreshold : if the value is a string it must finish by %");return parseFloat(t)/100*e}if("number"==typeof t)return t<1?t*e:t;throw Error("getThreshold : the value is not valid")}(i,this.maxValue):up.call(this,t);let s=new vw(this.width,this.height,{kind:"BINARY",parent:this}),o=0;if(this.alpha&&n)for(let t=0;t<this.data.length;t+=this.channels){let e=this.data[t]+(this.maxValue-this.data[t])*(this.maxValue-this.data[t+1])/this.maxValue;(r&&e<=i||!r&&e>=i)&&s.setBit(o),o++}else for(let t=0;t<this.data.length;t+=this.channels)(r&&this.data[t]<=i||!r&&this.data[t]>=i)&&s.setBit(o),o++;return s}function gp(t={}){let{size:e=0,algorithm:i="copy",color:n}=t;if(this.checkProcessable("pad",{bitDepth:[8,16]}),"set"===i){if(n.length!==this.channels)throw new Error(`pad: the color array must have the same length as the number of channels. Here: ${this.channels}`);for(let t=0;t<n.length;t++)0===n[t]&&(n[t]=.001)}else n=rm()(this.channels,null);Array.isArray(e)||(e=[e,e]);let r=this.width+2*e[0],s=this.height+2*e[1],o=this.channels,a=vw.createFrom(this,{width:r,height:s});!function(t,e,i,n){let r=t.width,s=t.height,o=e.width,a=t.channels;for(let h=0;h<r;h++)for(let l=0;l<s;l++)for(let s=0;s<a;s++){let c=(l*r+h)*a+s,u=((n+l)*o+i+h)*a+s;e.data[u]=t.data[c]}}(this,a,e[0],e[1]);for(let t=e[0];t<r-e[0];t++)for(let i=0;i<o;i++){let h=n[i]||a.data[(e[1]*r+t)*o+i];for(let n=0;n<e[1];n++)a.data[(n*r+t)*o+i]=h;h=n[i]||a.data[((s-e[1]-1)*r+t)*o+i];for(let n=s-e[1];n<s;n++)a.data[(n*r+t)*o+i]=h}for(let t=0;t<s;t++)for(let i=0;i<o;i++){let s=n[i]||a.data[(t*r+e[0])*o+i];for(let n=0;n<e[0];n++)a.data[(t*r+n)*o+i]=s;s=n[i]||a.data[(t*r+r-e[0]-1)*o+i];for(let n=r-e[0];n<r;n++)a.data[(t*r+n)*o+i]=s}return a}function mp(t=8){if(this.checkProcessable("colorDepth",{bitDepth:[1,8,16]}),![8,16].includes(t))throw Error("You need to specify the new colorDepth as 8 or 16");if(this.bitDepth===t)return this.clone();let e=vw.createFrom(this,{bitDepth:t});switch(t){case 8:if(1===this.bitDepth)for(let t=0;t<this.size;t++)this.getBit(t)&&(e.data[t]=255);else for(let t=0;t<this.data.length;t++)e.data[t]=this.data[t]>>8;break;case 16:if(1===this.bitDepth)for(let t=0;t<this.size;t++)this.getBit(t)&&(e.data[t]=65535);else for(let t=0;t<this.data.length;t++)e.data[t]=this.data[t]<<8|this.data[t];break;default:throw new Error("colorDepth conversion unexpected case")}return e}function pp(t,e={}){const{interpolation:i=jm.nearestneighbor,width:n=this.width,height:r=this.height}=e;if("number"!=typeof t)throw new TypeError("degrees must be a number");const s=qm(i),o=t*Math.PI/180,a=Math.floor(Math.abs(n*Math.cos(o))+Math.abs(r*Math.sin(o))),h=Math.floor(Math.abs(r*Math.cos(o))+Math.abs(n*Math.sin(o))),l=Math.cos(-o),c=Math.sin(-o);let u=a/2,d=h/2;a%2==0?(u-=.5,h%2==0?d-=.5:d=Math.floor(d)):(u=Math.floor(u),h%2==0?d-=.5:d=Math.floor(d));const f=Math.floor(n/2-u),g=Math.floor(r/2-d);if(1===this.bitDepth){const t=new vw(a,h,{kind:"BINARY",parent:this});switch(s){case jm.nearestneighbor:return function(t,e,i,n,r,s,o,a){for(let h=0;h<e.width;h+=1)for(let l=0;l<e.height;l+=1){let c=Math.round((h-r)*o-(l-s)*a+r)+i,u=Math.round((l-s)*o+(h-r)*a+s)+n;(c<0||c>=t.width||u<0||u>=t.height||t.getBitXY(c,u))&&e.setBitXY(h,l)}return e}(this,t,f,g,u,d,l,c);case jm.bilinear:return function(t,e,i,n,r,s,o,a){let h=t.width;for(let l=0;l<e.height;l++)for(let c=0;c<e.width;c++){let u=(c-r)*o-(l-s)*a+r+i,d=(l-s)*o+(c-r)*a+s+n,f=0|u,g=0|d,m=u-f,p=d-g;if(u<0||u>=t.width||d<0||d>=t.height)e.setBitXY(c,l);else{let i=g*t.width+f,n=t.getBit(i),r=t.getBit(i+1),s=t.getBit(i+h);(n|m&r-n|p&s-n|m&p&n-r-s+t.getBit(i+1+h))>0&&e.setBitXY(c,l)}}return e}(this,t,f,g,u,d,l,c);default:throw new Error(`unsupported rotate interpolation: ${s}`)}}else{const t=vw.createFrom(this,{width:a,height:h});switch(s){case jm.nearestneighbor:return function(t,e,i,n,r,s,o,a){for(let h=0;h<e.width;h+=1)for(let l=0;l<e.height;l+=1)for(let c=0;c<t.channels;c++){let u=Math.round((h-r)*o-(l-s)*a+r)+i,d=Math.round((l-s)*o+(h-r)*a+s)+n;u<0||u>=t.width||d<0||d>=t.height?1===t.alpha&&c===t.channels-1?e.setValueXY(h,l,c,0):e.setValueXY(h,l,c,t.maxValue):e.setValueXY(h,l,c,t.getValueXY(u,d,c))}return e}(this,t,f,g,u,d,l,c);case jm.bilinear:return function(t,e,i,n,r,s,o,a){let h=t.width*t.channels;for(let l=0;l<e.height;l++)for(let c=0;c<e.width;c++){let u=(c-r)*o-(l-s)*a+r+i,d=(l-s)*o+(c-r)*a+s+n,f=0|u,g=0|d,m=u-f,p=d-g;for(let i=0;i<t.channels;i++)if(u<0||u>=t.width||d<0||d>=t.height)1===t.alpha&&i===t.channels-1?e.setValueXY(c,l,i,0):e.setValueXY(c,l,i,t.maxValue);else{let n=(g*t.width+f)*t.channels+i,r=t.data[n],s=t.data[n+t.channels],o=t.data[n+h],a=r+m*(s-r)+p*(o-r)+m*p*(r-s-o+t.data[n+h+t.channels])|0;e.setValueXY(c,l,i,a)}}return e}(this,t,f,g,u,d,l,c);default:throw new Error(`unsupported rotate interpolation: ${s}`)}}}function _p(t,e){if(this.checkProcessable("rotate",{bitDepth:[1,8,16]}),"number"!=typeof t)throw new TypeError("angle must be a number");switch(t<0&&(t=360*Math.ceil(-t/360)+t),t%360){case 0:return this.clone();case 90:return yp.call(this);case 180:return vp.call(this);case 270:return wp.call(this);default:return pp.call(this,t,e)}}function wp(){if(1===this.bitDepth){const t=new vw(this.height,this.width,{kind:"BINARY",parent:this}),e=t.height-1;for(let i=0;i<this.height;i++)for(let n=0;n<this.width;n++)this.getBitXY(n,i)&&t.setBitXY(i,e-n);return t}{const t=vw.createFrom(this,{width:this.height,height:this.width}),e=t.height-1;for(let i=0;i<this.height;i++)for(let n=0;n<this.width;n++)for(let r=0;r<this.channels;r++)t.setValueXY(i,e-n,r,this.getValueXY(n,i,r));return t}}function yp(){if(1===this.bitDepth){const t=new vw(this.height,this.width,{kind:"BINARY",parent:this}),e=t.width-1;for(let i=0;i<this.height;i++)for(let n=0;n<this.width;n++)this.getBitXY(n,i)&&t.setBitXY(e-i,n);return t}{const t=vw.createFrom(this,{width:this.height,height:this.width}),e=t.width-1;for(let i=0;i<this.height;i++)for(let n=0;n<this.width;n++)for(let r=0;r<this.channels;r++)t.setValueXY(e-i,n,r,this.getValueXY(n,i,r));return t}}function vp(){if(1===this.bitDepth){const t=new vw(this.width,this.height,{kind:"BINARY",parent:this}),e=t.width-1,i=t.height-1;for(let n=0;n<this.height;n++)for(let r=0;r<this.width;r++)this.getBitXY(r,n)&&t.setBitXY(e-r,i-n);return t}{const t=vw.createFrom(this),e=t.width-1,i=t.height-1;for(let n=0;n<this.height;n++)for(let r=0;r<this.width;r++)for(let s=0;s<this.channels;s++)t.setValueXY(e-r,i-n,s,this.getValueXY(r,n,s));return t}}function bp(t,e={}){const i=Mg(t);this.checkProcessable("insert",i);let{x:n=0,y:r=0}=e;const s=Sg(this,e,{copy:!0}),o=Math.min(s.height,r+t.height),a=Math.min(s.width,n+t.width);if(1===s.bitDepth)for(let e=r;e<o;e++)for(let i=n;i<a;i++)t.getBitXY(i-n,e-r)?s.setBitXY(i,e):s.clearBitXY(i,e);else for(let e=r;e<o;e++)for(let i=n;i<a;i++)s.setPixelXY(i,e,t.getPixelXY(i-n,e-r));return s}function xp(t={}){let{size:e=0,algorithm:i="copy",color:n}=t;if(this.checkProcessable("setBorder",{bitDepth:[8,16,32,64]}),"set"===i){if(n.length!==this.channels)throw new Error(`setBorder: the color array must have the same length as the number of channels. Here: ${this.channels}`);for(let t=0;t<n.length;t++)0===n[t]&&(n[t]=.001)}else n=rm()(this.channels,null);Array.isArray(e)||(e=[e,e]);let r=e[0],s=e[1],o=this.channels;for(let t=r;t<this.width-r;t++)for(let e=0;e<o;e++){let i=n[e]||this.data[(t+this.width*s)*o+e];for(let n=0;n<s;n++)this.data[(n*this.width+t)*o+e]=i;i=n[e]||this.data[(t+this.width*(this.height-s-1))*o+e];for(let n=this.height-s;n<this.height;n++)this.data[(n*this.width+t)*o+e]=i}for(let t=0;t<this.height;t++)for(let e=0;e<o;e++){let i=n[e]||this.data[(t*this.width+r)*o+e];for(let n=0;n<r;n++)this.data[(t*this.width+n)*o+e]=i;i=n[e]||this.data[(t*this.width+this.width-r-1)*o+e];for(let n=this.width-r;n<this.width;n++)this.data[(t*this.width+n)*o+e]=i}return this}function Mp(t={}){let{preserveAlpha:e=!0}=t;if(this.checkProcessable("split",{bitDepth:[8,16]}),1===this.components)return new pg([this.clone()]);let i=new pg,n=this.data;if(this.alpha&&e)for(let t=0;t<this.components;t++){let e=vw.createFrom(this,{components:1,alpha:!0,colorModel:Ef}),r=0;for(let i=0;i<n.length;i+=this.channels)e.data[r++]=n[i+t],e.data[r++]=n[i+this.components];i.push(e)}else for(let t=0;t<this.channels;t++){let e=vw.createFrom(this,{components:1,alpha:!1,colorModel:Ef}),r=0;for(let i=0;i<n.length;i+=this.channels)e.data[r++]=n[i+t];i.push(e)}return i}function Ep(t,e={}){let{keepAlpha:i=!1,mergeAlpha:n=!1}=e;i&=this.alpha,n&=this.alpha,this.checkProcessable("getChannel",{bitDepth:[8,16]}),t=Fg(this,t);let r=vw.createFrom(this,{components:1,alpha:i,colorModel:Ef}),s=0;for(let e=0;e<this.data.length;e+=this.channels)n?r.data[s++]=this.data[e+t]*this.data[e+this.components]/this.maxValue:(r.data[s++]=this.data[e+t],i&&(r.data[s++]=this.data[e+this.components]));return r}function Sp(t=kp,e={}){let{mergeAlpha:i=!1,keepAlpha:n=!1}=e;i&=this.alpha,n&=this.alpha,this.checkProcessable("combineChannels",{bitDepth:[8,16]});let r=vw.createFrom(this,{components:1,alpha:n,colorModel:Ef}),s=0;for(let e=0;e<this.size;e++){let o=t(this.getPixel(e));i?r.data[s++]=o*this.data[e*this.channels+this.components]/this.maxValue:(r.data[s++]=o,n&&(r.data[s++]=this.data[e*this.channels+this.components]))}return r}function kp(t){return(t[0]+t[1]+t[2])/3}function Cp(t,e){if(this.checkProcessable("setChannel",{bitDepth:[8,16]}),e.checkProcessable("setChannel (image parameter check)",{bitDepth:[this.bitDepth],alpha:[0],components:[1]}),e.width!==this.width||e.height!==this.height)throw new Error("Images must have exactly the same width and height");let i=t=Fg(this,t);for(let t=0;t<e.data.length;t++)this.data[i]=e.data[t],i+=this.channels;return this}function Ip(t,e={}){let{shift:i=[0,0],average:n,channels:r,defaultAlpha:s,normalize:o,border:a=[0,0]}=e;if(this.checkProcessable("getSimilarity",{bitDepth:[8,16]}),Array.isArray(a)||(a=[a,a]),r=Dg(this,{channels:r,defaultAlpha:s}),this.bitDepth!==t.bitDepth)throw new Error("Both images must have the same bitDepth");if(this.channels!==t.channels)throw new Error("Both images must have the same number of channels");if(this.colorModel!==t.colorModel)throw new Error("Both images must have the same colorModel");void 0===n&&(n=!0);let h=Math.max(a[0],-i[0]),l=Math.min(this.width-a[0],this.width-i[0]),c=Math.max(a[1],-i[1]),u=Math.min(this.height-a[1],this.height-i[1]),d=rm()(r.length,0);for(let e=0;e<r.length;e++){let n=r[e],s=o?this.sum[n]:Math.max(this.sum[n],t.sum[n]),a=o?t.sum[n]:Math.max(this.sum[n],t.sum[n]);if(0!==s&&0!==a)for(let r=h;r<l;r++)for(let o=c;o<u;o++){let h=r*this.multiplierX+o*this.multiplierY+n,l=h+i[0]*this.multiplierX+i[1]*this.multiplierY;d[e]+=Math.min(this.data[h]/s,t.data[l]/a)}}return n?d.reduce(((t,e)=>t+e))/d.length:d}function Ap(t={}){let{sampling:e=[10,10],painted:i=!1,mask:n}=t;this.checkProcessable("getPixelsGrid",{bitDepth:[8,16],channels:1}),Array.isArray(e)||(e=[e,e]);const r=e[0],s=e[1],o=[],a=[],h=this.width/r,l=this.height/s;let c=Math.floor(h/2);for(let t=0;t<r;t++){let t=Math.floor(l/2);for(let e=0;e<s;e++){let e=Math.round(c),i=Math.round(t);n&&!n.getBitXY(e,i)||(o.push([e,i]),a.push(this.getPixelXY(e,i))),t+=l}c+=h}const u={xyS:o,zS:a};return i&&(u.painted=this.rgba8().paintPoints(o)),u}function Tp(t,e,i){const n=new Array(t);for(let i=0;i<t;i++)n[i]=new Array(e);if(i)for(let r=0;r<t;r++)for(let t=0;t<e;t++)n[r][t]=i;return n.width=t,n.height=e,Object.setPrototypeOf(n,Tp.prototype),n}function Rp(t,e={}){let{border:i}=e;if(this.checkProcessable("getChannel",{bitDepth:[8,16]}),this.bitDepth!==t.bitDepth)throw new Error("Both images must have the same bitDepth");if(this.channels!==t.channels)throw new Error("Both images must have the same number of channels");if(this.colorModel!==t.colorModel)throw new Error("Both images must have the same colorModel");let n=new Tp(t.width,t.height,-1/0),r=Math.floor(t.width/2),s=Math.floor(t.height/2),o=r,a=s,h=!1;for(;!h;){let e=n.localSearch(r,s,-1/0);for(let r=0;r<e.length;r++){let s=e[r],h=this.getSimilarity(t,{border:i,shift:[o-s[0],a-s[1]]});n[s[0]][s[1]]=h}let l=n.localMax(r,s);l.position[0]!==r||l.position[1]!==s?(r=l.position[0],s=l.position[1]):h=!0}return[r-o,s-a]}function Pp(t,e=0){this.checkProcessable("getRow",{bitDepth:[8,16]}),function(t,e){if(e<0||e>=t.height)throw new RangeError(`row must be included between 0 and ${t.height-1}. Current value: ${e}`)}(this,t),Vm(this,e);let i=new Array(this.width),n=0,r=t*this.width*this.channels+e,s=r+this.width*this.channels;for(let t=r;t<s;t+=this.channels)i[n++]=this.data[t];return i}function Dp(t,e=0){this.checkProcessable("getColumn",{bitDepth:[8,16]}),function(t,e){if(e<0||e>=t.width)throw new RangeError(`column must be included between 0 and ${t.width-1}. Current value: ${e}`)}(this,t),Vm(this,e);let i=new Array(this.height),n=0,r=this.width*this.channels;for(let s=e+t*this.channels;s<this.data.length;s+=r)i[n++]=this.data[s];return i}function Fp(t={}){let{channel:e}=t;if(this.checkProcessable("getMatrix",{bitDepth:[8,16]}),void 0===e){if(this.components>1)throw new RangeError("You need to define the channel for an image that contains more than one channel");e=0}let i=new Zg(this.height,this.width);for(let t=0;t<this.height;t++)for(let n=0;n<this.width;n++)i.set(t,n,this.getValueXY(n,t,e));return i}function Lp(t,e={}){t=new Zg(t);let{channel:i}=e;if(this.checkProcessable("getMatrix",{bitDepth:[8,16]}),void 0===i){if(this.components>1)throw new RangeError("You need to define the channel for an image that contains more than one channel");i=0}if(this.width!==t.columns||this.height!==t.rows)throw new RangeError("The size of the matrix must be equal to the size of the image");for(let e=0;e<this.height;e++)for(let n=0;n<this.width;n++)this.setValueXY(n,e,i,t.get(e,n));return this}function Op(){this.checkProcessable("getPixelsArray",{bitDepth:[8,16,32]});let t=new Array(this.size),e=0;for(let i=0;i<this.data.length;i+=this.channels){let n=new Array(this.components);for(let t=0;t<this.components;t++)n[t]=this.data[i+t];t[e++]=n}return t}function Np(t){let e=this,i=e.getClosestCommonParent(t),n=e.getRelativePosition(i,{defaultFurther:!0}),r=Bp(e,n),s=t.getRelativePosition(i,{defaultFurther:!0}),o=Bp(t,s),a=function(t,e){let i=0,n=0,r=[];for(;i<t.length&&n<e.length;)t[i][0]===e[n][0]&&t[i][1]===e[n][1]?(r.push(t[i]),i++,n++):t[i][0]<e[n][0]||t[i][0]===e[n][0]&&t[i][1]<e[n][1]?i++:n++;return r}(r,o),h={whitePixelsMask1:[],whitePixelsMask2:[],commonWhitePixels:[]};for(let i=0;i<a.length;i++){let r=a[i],o=[r[0]-n[0],r[1]-n[1]],l=[r[0]-s[0],r[1]-s[1]],c=e.getBitXY(o[0],o[1]),u=t.getBitXY(l[0],l[1]);1===c&&1===u&&h.commonWhitePixels.push(r)}for(let t=0;t<r.length;t++){let i,n;0!==t&&(i=Math.floor(t/e.width),n=t%e.width),1===e.getBitXY(i,n)&&h.whitePixelsMask1.push(r[t])}for(let e=0;e<o.length;e++){let i=0,n=0;0!==e&&(i=Math.floor(e/t.width),n=e%t.width),1===t.getBitXY(i,n)&&h.whitePixelsMask2.push(o[e])}return h}function Bp(t,e){let i=[];for(let n=0;n<t.height;n++)for(let r=0;r<t.width;r++){let t=[n,r];i.push([t[0]+e[0],t[1]+e[1]])}return i}function zp(t){let e,i=Up(this),n=Up(t);if(e=i>=n?Gp(this,i):Gp(t,n),0===i||0===n)return e;let r=this,s=t;for(;i!==n;)if(i>n){if(r=r.parent,null===r)return e;i-=1}else{if(s=s.parent,null===s)return e;n-=1}for(;r!==s&&null!==r&&null!==s;)if(r=r.parent,s=s.parent,null===r||null===s)return e;return r!==s?e:r}function Up(t){let e=0,i=t;for(;null!=i.parent;)i=i.parent,e++;return e}function Gp(t,e){let i=t;for(;e>0;)i=i.parent,e-=1;return i}Tp.prototype.localMin=function(t,e){let i=this[t][e],n=[t,e];for(let r=Math.max(0,t-1);r<Math.min(this.length,t+2);r++)for(let t=Math.max(0,e-1);t<Math.min(this[0].length,e+2);t++)this[r][t]<i&&(i=this[r][t],n=[r,t]);return{position:n,value:i}},Tp.prototype.localMax=function(t,e){let i=this[t][e],n=[t,e];for(let r=Math.max(0,t-1);r<Math.min(this.length,t+2);r++)for(let t=Math.max(0,e-1);t<Math.min(this[0].length,e+2);t++)this[r][t]>i&&(i=this[r][t],n=[r,t]);return{position:n,value:i}},Tp.prototype.localSearch=function(t,e,i){let n=[];for(let r=Math.max(0,t-1);r<Math.min(this.length,t+2);r++)for(let t=Math.max(0,e-1);t<Math.min(this[0].length,e+2);t++)this[r][t]===i&&n.push([r,t]);return n};const Yp={lowThreshold:10,highThreshold:30,gaussianBlur:1.1},Xp=[[-1,0,1],[-2,0,2],[-1,0,1]],Vp=[[-1,-2,-1],[0,0,0],[1,2,1]],jp={bitDepth:32,mode:"periodic"};function qp(t){return function(t,e){t.checkProcessable("Canny edge detector",{bitDepth:8,channels:1,components:1}),e=Object.assign({},Yp,e);const i=t.width,n=t.height,r=t.maxValue,s={sigma:e.gaussianBlur,radius:3},o=t.gaussianFilter(s),a=o.convolution(Vp,jp),h=o.convolution(Xp,jp),l=h.hypotenuse(a),c=t.constructor,u=new c(i,n,{kind:"GREY",bitDepth:32}),d=new c(i,n,{kind:"GREY",bitDepth:32}),f=new c(i,n,{kind:"GREY"});for(var g=1;g<i-1;g++)for(var m=1;m<n-1;m++){var p=(Math.round(Math.atan2(h.getValueXY(g,m,0),a.getValueXY(g,m,0))*(5/Math.PI))+5)%5;0===p&&(l.getValueXY(g,m,0)<=l.getValueXY(g,m-1,0)||l.getValueXY(g,m,0)<=l.getValueXY(g,m+1,0))||1===p&&(l.getValueXY(g,m,0)<=l.getValueXY(g-1,m+1,0)||l.getValueXY(g,m,0)<=l.getValueXY(g+1,m-1,0))||2===p&&(l.getValueXY(g,m,0)<=l.getValueXY(g-1,m,0)||l.getValueXY(g,m,0)<=l.getValueXY(g+1,m,0))||3===p&&(l.getValueXY(g,m,0)<=l.getValueXY(g-1,m-1,0)||l.getValueXY(g,m,0)<=l.getValueXY(g+1,m+1,0))||u.setValueXY(g,m,0,l.getValueXY(g,m,0))}for(g=0;g<i*n;++g){var _=u.data[g],w=0;_>e.highThreshold&&(w++,f.data[g]=r),_>e.lowThreshold&&w++,d.data[g]=w}var y=[];for(g=1;g<i-1;++g)for(m=1;m<n-1;++m)if(1===d.getValueXY(g,m,0))t:for(var v=g-1;v<g+2;++v)for(var b=m-1;b<m+2;++b)if(2===d.getValueXY(v,b,0)){y.push([g,m]),f.setValueXY(g,m,0,r);break t}for(;y.length>0;){var x=[];for(g=0;g<y.length;++g)for(m=-1;m<2;++m)for(v=-1;v<2;++v)if(0!==m||0!==v){var M=y[g][0]+m,E=y[g][1]+v;1===d.getValueXY(M,E,0)&&0===f.getValueXY(M,E,0)&&(x.push([M,E]),f.setValueXY(M,E,0,r))}y=x}return f}(this,t)}function Wp(t,e={}){let{position:i}=e;if(this.checkProcessable("extract",{bitDepth:[1,8,16]}),!i&&(i=t.getRelativePosition(this),!i))throw new Error("extract : can not extract an image because the relative position can not be determined, try to specify manually the position as an array of 2 elements [x,y].");if(this.bitDepth>1){let e=vw.createFrom(this,{width:t.width,height:t.height,alpha:1,position:i,parent:this});for(let n=0;n<t.width;n++)for(let r=0;r<t.height;r++){for(let t=0;t<this.channels;t++){let s=this.getValueXY(n+i[0],r+i[1],t);e.setValueXY(n,r,t,s)}t.getBitXY(n,r)||e.setValueXY(n,r,this.components,0)}return e}{let e=vw.createFrom(this,{width:t.width,height:t.height,position:i,parent:this});for(let n=0;n<t.height;n++)for(let r=0;r<t.width;r++)t.getBitXY(r,n)&&this.getBitXY(r+i[0],n+i[1])&&e.setBitXY(r,n);return e}}var Zp=__webpack_require__(8737),Kp=__webpack_require__.n(Zp);function Hp(t={}){const{x:e=0,y:i=0,inPlace:n=!0}=t,r=n?this:vw.createFrom(this);if(this.checkProcessable("floodFill",{bitDepth:1}),this.getBitXY(e,i))return r;const s=new(Kp());for(s.push(new $p(e,i));s.length>0;){const t=s.shift();r.setBitXY(t.x,t.y);for(let e=t.x+1;e<this.width&&!r.getBitXY(e,t.y)&&!this.getBitXY(e,t.y);e++)r.setBitXY(e,t.y),t.y+1<this.height&&!this.getBitXY(e,t.y+1)&&s.push(new $p(e,t.y+1)),t.y-1>=0&&!this.getBitXY(e,t.y-1)&&s.push(new $p(e,t.y-1));for(let e=t.x-1;e>=0&&!r.getBitXY(e,t.y)&&!this.getBitXY(e,t.y);e++)r.setBitXY(e,t.y),t.y+1<this.height&&!this.getBitXY(e,t.y+1)&&s.push(new $p(e,t.y+1)),t.y-1>=0&&!this.getBitXY(e,t.y-1)&&s.push(new $p(e,t.y-1))}return r}function $p(t,e){this.x=t,this.y=e}function Jp(){return Jp=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},Jp.apply(this,arguments)}function Qp(t,e,i){var n=function(t,e,i){return{h:t,s:2*(e*=(i<50?i:100-i)/100)/(i+e)*100,v:i+e}}(t,e,i);return function(t,e,i){var n,r=(i/=100)*(e/=100),s=t/60,o=r*(1-Math.abs(s%2-1)),a=i-r;return n=s>=0&&s<1?[r,o,0]:s>=1&&s<2?[o,r,0]:s>=2&&s<3?[0,r,o]:t>=3&&s<4?[0,o,r]:t>=4&&s<5?[o,0,r]:t>=5&&s<=6?[r,0,o]:[0,0,0],{r:Math.round(255*(n[0]+a)),g:Math.round(255*(n[1]+a)),b:Math.round(255*(n[2]+a))}}(n.h,n.s,n.v)}var t_={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]};function e_(t){let e=function(t){var e=t_[t.toLowerCase()];if(e)return{r:e[0],g:e[1],b:e[2],a:100}}(i=t)||function(t){if("#"===t[0]&&4===t.length)return{r:parseInt(t[1]+t[1],16),g:parseInt(t[2]+t[2],16),b:parseInt(t[3]+t[3],16),a:100}}(i)||function(t){if("#"===t[0]&&7===t.length)return{r:parseInt(t.slice(1,3),16),g:parseInt(t.slice(3,5),16),b:parseInt(t.slice(5,7),16),a:100}}(i)||function(t){var e=t.match(/rgb\(([^)]+)\)/);if(e){var i=e[1].split(/ *, */).map(Number);return{r:i[0],g:i[1],b:i[2],a:100}}}(i)||function(t){var e=t.match(/rgba\(([^)]+)\)/);if(e){var i=e[1].split(/ *, */).map(Number);return{r:i[0],g:i[1],b:i[2],a:100*i[3]}}}(i)||function(t){var e=t.match(/hsl\(([^)]+)\)/);if(e){var i=e[1].split(/ *, */);return Jp({},Qp(parseInt(i[0],10),parseInt(i[1],10),parseInt(i[2],10)),{a:100})}}(i)||function(t){var e=t.match(/hsla\(([^)]+)\)/);if(e){var i=e[1].split(/ *, */),n=parseInt(i[0],10),r=parseInt(i[1],10),s=parseInt(i[2],10),o=parseInt(100*parseFloat(i[3]),10);return Jp({},Qp(n,r,s),{a:o})}}(i);var i;return[e.r,e.g,e.b,Math.round(255*e.a/100)]}function i_(t,e,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?t+6*(e-t)*i:i<.5?e:i<2/3?t+(e-t)*(2/3-i)*6:t}function n_(t,e,i){let n,r,s,o,a,h;return i/=100,0==(e/=100)?o=a=h=255*i:(r=i<=.5?i*(e+1):i+e-i*e,n=2*i-r,s=t/360,o=i_(n,r,s+1/3),a=i_(n,r,s),h=i_(n,r,s-1/3)),{r:o,g:a,b:h}}function r_(t){let{color:e,colors:i,randomColors:n,numberColors:r=50}=t;if(e&&!Array.isArray(e)&&(e=e_(e)),e)return[e];if(i)return i=i.map((function(t){return Array.isArray(t)?t:e_(t)})),i;if(n){i=new Array(r);for(let t=0;t<r;t++)i[t]=[Math.floor(256*Math.random()),Math.floor(256*Math.random()),Math.floor(256*Math.random())]}return function(t){let e=new Array(t),i=0;for(let n=0;n<360;n+=360/t){i++;let t=n_(n,100,30+i%4*15);e[i-1]=[Math.round(255*t.r),Math.round(255*t.g),Math.round(255*t.b)]}return e}(r)}function s_(t,e,i={}){let{color:n="blue",colors:r,font:s="12px Helvetica",rotate:o=0}=i;if(this.checkProcessable("paintMasks",{channels:[3,4],bitDepth:[8,16],colorModel:Sf}),!Array.isArray(t))throw Error("paintLabels: labels must be an array");if(!Array.isArray(e))throw Error("paintLabels: positions must be an array");if(n&&!Array.isArray(n)&&(n=e_(n)),r=r?r.map((function(t){return Array.isArray(t)?t:e_(t)})):[n],t.length!==e.length)throw Error("paintLabels: positions and labels must be arrays from the same size");Array.isArray(s)||(s=[s]),Array.isArray(o)||(o=[o]);let a=this.getCanvas().getContext("2d");for(let i=0;i<t.length;i++){a.save();let n=r[i%r.length];a.fillStyle=`rgba(${n[0]},${n[1]},${n[2]},${n[3]/this.maxValue})`,a.font=s[i%s.length];let h=e[i];a.translate(h[0],h[1]),a.rotate(o[i%o.length]/180*Math.PI),a.fillText(t[i],0,0),a.restore()}return this.data=Uint8Array.from(a.getImageData(0,0,this.width,this.height).data),this}function o_(t,e={}){let{alpha:i=255,labels:n=[],labelsPosition:r=[],labelColor:s="blue",labelFont:o="12px Helvetica"}=e;this.checkProcessable("paintMasks",{channels:[3,4],bitDepth:[8,16],colorModel:Sf});let a=r_(Object.assign({},e,{numberColors:t.length}));Array.isArray(t)||(t=[t]);for(let e=0;e<t.length;e++){let n=t[e],r=a[e%a.length];for(let t=0;t<n.width;t++)for(let e=0;e<n.height;e++)if(n.getBitXY(t,e))for(let s=0;s<Math.min(this.components,r.length);s++)if(255===i)this.setValueXY(t+n.position[0],e+n.position[1],s,r[s]);else{let o=this.getValueXY(t+n.position[0],e+n.position[1],s);o=Math.round((o*(255-i)+r[s]*i)/255),this.setValueXY(t+n.position[0],e+n.position[1],s,o)}}if(Array.isArray(n)&&n.length>0){let e=this.getCanvas().getContext("2d");e.fillStyle=s,e.font=o;for(let i=0;i<Math.min(t.length,n.length);i++){let s=r[i]?r[i]:t[i].position;e.fillText(n[i],s[0],s[1])}this.data=Uint8Array.from(e.getImageData(0,0,this.width,this.height).data)}return this}function a_(t,e){let i=new Array(t);for(let n=0;n<t;n++)i[n]=new Array(e).fill(0);return i}const h_=[[0,0,1,0,0],[0,0,1,0,0],[1,1,1,1,1],[0,0,1,0,0],[0,0,1,0,0]],l_=[[0,1,0],[1,1,1],[0,1,0]];class c_{constructor(t={}){let{kind:e="cross",shape:i,size:n,width:r,height:s,filled:o=!0}=t;if(n&&(r=n,s=n),i)switch(i.toLowerCase()){case"square":case"rectangle":this.matrix=function(t,e,i){const n=a_(e,t);if(i.filled)for(let i=0;i<e;i++)for(let e=0;e<t;e++)n[i][e]=1;else{for(let i of[0,e-1])for(let e=0;e<t;e++)n[i][e]=1;for(let i=0;i<e;i++)for(let e of[0,t-1])n[i][e]=1}return n}(r,s,{filled:o});break;case"circle":case"ellipse":this.matrix=function(t,e,i){const n=a_(e,t);let r=1-e%2,s=1-t%2,o=Math.floor((t-1)/2),a=Math.floor((e-1)/2),h=o*o,l=a*a;if(i.filled)for(let e=0;e<=a;e++)for(let i=o-Math.floor(Math.sqrt(h-h*e*e/l));i<=o;i++)n[a-e][i]=1,n[a+e+r][i]=1,n[a-e][t-i-1]=1,n[a+e+r][t-i-1]=1;else{for(let e=0;e<=a;e++){let i=o-Math.floor(Math.sqrt(h-h*e*e/l));n[a-e][i]=1,n[a+e+r][i]=1,n[a-e][t-i-1]=1,n[a+e+r][t-i-1]=1}for(let t=0;t<=o;t++){let i=a-Math.floor(Math.sqrt(l-l*t*t/h));n[i][o-t]=1,n[i][o+t+s]=1,n[e-i-1][o-t]=1,n[e-i-1][o+t+s]=1}}return n}(r,s,{filled:o});break;case"triangle":this.matrix=function(t,e,i){if(!i.filled)throw new Error("Non filled triangle is not implemented");const n=a_(e,t);for(let i=0;i<e;i++){let r=Math.floor((1-i/e)*t/2);for(let e=r;e<t-r;e++)n[i][e]=1}return n}(r,s,{filled:o});break;default:throw new Error(`Shape: unexpected shape: ${i}`)}else{if(!e)throw new Error("Shape: expected a kind or a shape option");switch(e.toLowerCase()){case"cross":this.matrix=h_;break;case"smallcross":this.matrix=l_;break;default:throw new Error(`Shape: unexpected kind: ${e}`)}}this.height=this.matrix.length,this.width=this.matrix[0].length,this.halfHeight=this.height/2>>0,this.halfWidth=this.width/2>>0}getPoints(){let t=this.matrix,e=[];for(let i=0;i<t.length;i++)for(let n=0;n<t[0].length;n++)t[i][n]&&e.push([n-this.halfWidth,i-this.halfHeight]);return e}getMask(){let t=new vw(this.width,this.height,{kind:Af});for(let e=0;e<this.matrix.length;e++)for(let i=0;i<this.matrix[0].length;i++)this.matrix[e][i]&&t.setBitXY(i,e);return t}}function u_(t,e={}){let{shape:i}=e;this.checkProcessable("paintPoints",{bitDepth:[8,16]});let n=r_(Object.assign({},e,{numberColors:t.length})),r=new c_(i).getPoints(),s=Math.min(this.channels,n[0].length);for(let e=0;e<t.length;e++){let i=n[e%n.length],o=t[e][0],a=t[e][1];for(let t=0;t<r.length;t++){let e=r[t][0],n=r[t][1];if(o+e>=0&&a+n>=0&&o+e<this.width&&a+n<this.height){let t=(o+e+(a+n)*this.width)*this.channels;for(let e=0;e<s;e++)this.data[t+e]=i[e]}}}return this}function d_(t,e={}){let{color:i=[this.maxValue,0,0],closed:n=!1}=e;this.checkProcessable("paintPoints",{bitDepth:[1,8,16]});let r=Math.min(this.channels,i.length);for(let e=0;e<t.length-1+n;e++){let n=t[e],s=t[(e+1)%t.length],o=s[0]-n[0],a=s[1]-n[1],h=Math.max(Math.abs(o),Math.abs(a)),l=o/h,c=a/h,u=n[0],d=n[1];for(let t=0;t<=h;t++){let t=Math.round(u),e=Math.round(d);if(t>=0&&e>=0&&t<this.width&&e<this.height)if(1===this.bitDepth)this.setBitXY(t,e);else{let n=(t+e*this.width)*this.channels;for(let t=0;t<r;t++)this.data[n+t]=i[t]}u+=l,d+=c}}return this}function f_(t,e={}){let i=Object.assign({},e);this.checkProcessable("paintPolylines",{bitDepth:[8,16]});let n=r_(Object.assign({},e,{numberColors:t.length}));for(let e=0;e<t.length;e++)i.color=n[e%n.length],this.paintPolyline(t[e],i);return this}function g_(t,e={}){let{color:i=[this.maxValue,0,0],filled:n=!1}=e;this.checkProcessable("paintPoints",{bitDepth:[1,8,16]}),e.closed=!0;let r=function(t){let e=[];for(let i=0;i<t.length;i++)t[i][0]===t[(i+1)%t.length][0]&&t[i][1]===t[(i+1)%t.length][1]||t[i][0]===t[(i-1+t.length)%t.length][0]&&t[i][1]===t[(i-1+t.length)%t.length][1]||t[(i+1)%t.length][0]===t[(i-1+t.length)%t.length][0]&&t[(i-1+t.length)%t.length][1]===t[(i+1)%t.length][1]||e.push(t[i]);return e}(t);if(!1===n)return this.paintPolyline(t,e);{let n=Array(this.height);for(let t=0;t<this.height;t++){n[t]=[];for(let e=0;e<this.width;e++)n[t].push(0)}for(let t=0;t<r.length;t++){const e=m_(r[t],r[(t+1)%r.length]);for(let t=0;t<this.height;t++)for(let i=0;i<this.width;i++)p_(i,t,e,this.height)&&(n[t][i]=0===n[t][i]?1:0)}for(let t=0;t<this.height;t++)for(let e=0;e<this.width;e++)if(1===n[t][e])if(1===this.bitDepth)this.setBitXY(e,t);else{let n=Math.min(this.channels,i.length),r=(e+t*this.width)*this.channels;for(let t=0;t<n;t++)this.data[r+t]=i[t]}return this.paintPolyline(t,e)}}function m_(t,e){if(t[0]===e[0])return{a:0,b:t[0],vertical:!0};{const i=(e[1]-t[1])/(e[0]-t[0]);return{a:i,b:t[1]-i*t[0],vertical:!1}}}function p_(t,e,i,n){if(!0===i.vertical)return i.b<=t;if(0===i.a)return!1;{const r=(e-i.b)/i.a;return r<t&&r>=0&&r<=n}}function __(t,e={}){let i=Object.assign({},e);this.checkProcessable("paintPolygons",{bitDepth:[8,16]});let n=r_(Object.assign({},e,{numberColors:t.length}));for(let e=0;e<t.length;e++)i.color=n[e%n.length],this.paintPolygon(t[e],i);return this}function w_(t={}){let{maxSlots:e=256,channel:i,useAlpha:n=!0}=t;if(this.checkProcessable("getHistogram",{bitDepth:[1,8,16]}),void 0===i){if(this.components>1)throw new RangeError("You need to define the channel for an image that contains more than one channel");i=0}return v_.call(this,i,{useAlpha:n,maxSlots:e})}function y_(t={}){const{maxSlots:e=256,useAlpha:i=!0}=t;this.checkProcessable("getHistograms",{bitDepth:[8,16]});let n=new Array(i?this.components:this.channels);for(let t=0;t<n.length;t++)n[t]=v_.call(this,t,{useAlpha:i,maxSlots:e});return n}function v_(t,e){let{useAlpha:i,maxSlots:n}=e;if(1===this.bitDepth){let t=[0,0];for(let e=0;e<this.height;e++)for(let i=0;i<this.width;i++){let n=this.getBitXY(e,i);0===n?t[0]+=1:1===n&&(t[1]+=1)}return t}let r=Math.log2(n);if(!Xg()(r))throw new RangeError("maxSlots must be a power of 2, for example: 64, 256, 1024");let s=0;this.bitDepth>r&&(s=this.bitDepth-r);let o=this.data,a=rm()(Math.pow(2,Math.min(this.bitDepth,r)),0);if(i&&this.alpha){let e=this.channels-t-1;for(let i=t;i<o.length;i+=this.channels)a[o[i]>>s]+=o[i+e]/this.maxValue}else for(let e=t;e<o.length;e+=this.channels)a[o[e]>>s]++;return a}function b_(t={}){let{useAlpha:e=!0,nbSlots:i=512}=t;this.checkProcessable("getColorHistogram",{bitDepth:[8,16],components:[3]});let n=Math.log(i)/Math.log(8);if(n!==Math.floor(n))throw new RangeError("nbSlots must be a power of 8. Usually 8, 64, 512 or 4096");let r=this.bitDepth-n,s=this.data,o=rm()(Math.pow(8,n),0),a=Math.pow(2,2*n),h=Math.pow(2,n);for(let t=0;t<s.length;t+=this.channels){let i=(s[t]>>r)*a+(s[t+1]>>r)*h+(s[t+2]>>r);e&&this.alpha?o[i]+=s[t+this.channels-1]/this.maxValue:o[i]++}return o}function x_(){this.checkProcessable("min",{bitDepth:[8,16,32]});let t=rm()(this.channels,1/0);for(let e=0;e<this.data.length;e+=this.channels)for(let i=0;i<this.channels;i++)this.data[e+i]<t[i]&&(t[i]=this.data[e+i]);return t}function M_(){this.checkProcessable("max",{bitDepth:[8,16,32]});let t=rm()(this.channels,-1/0);for(let e=0;e<this.data.length;e+=this.channels)for(let i=0;i<this.channels;i++)this.data[e+i]>t[i]&&(t[i]=this.data[e+i]);return t}function E_(){this.checkProcessable("sum",{bitDepth:[8,16]});let t=rm()(this.channels,0);for(let e=0;e<this.data.length;e+=this.channels)for(let i=0;i<this.channels;i++)t[i]+=this.data[e+i];return t}function S_(t=0,e=0){this.checkProcessable("getMoment",{bitDepth:[1]});let i=0;for(let n=0;n<this.width;n++)for(let r=0;r<this.height;r++)1===this.getBitXY(n,r)&&(i+=n**t*r**e);return i}function k_(t={}){let{mask:e,region:i=3,removeClosePoints:n=0,invert:r=!1,maxEquals:s=2}=t,o=this;this.checkProcessable("localMaxima",{bitDepth:[8,16],components:1}),i*=4;let a=r?0:1,h=[1,0,-1,0,1,1,-1,-1,2,0,-2,0,2,2,-2,-2],l=[0,1,0,-1,1,-1,1,-1,0,2,0,-2,2,-2,2,-2],c=i<=8?1:2,u=[];for(let t=c;t<o.height-c;t++)for(let n=c;n<o.width-c;n++){if(e&&e.getBitXY(n,t)!==a)continue;let c=0,d=0,f=o.data[n+t*o.width];for(let e=0;e<i;e++)r?o.data[n+h[e]+(t+l[e])*o.width]>f&&c++:o.data[n+h[e]+(t+l[e])*o.width]<f&&c++,o.data[n+h[e]+(t+l[e])*o.width]===f&&d++;c+d===i&&d<=s&&u.push([n,t])}if(n>0)for(let t=0;t<u.length;t++)for(let e=t+1;e<u.length;e++)Math.sqrt(Math.pow(u[t][0]-u[e][0],2)+Math.pow(u[t][1]-u[e][1],2))<n&&(u[t][0]=u[t][0]+u[e][0]>>1,u[t][1]=u[t][1]+u[e][1]>>1,u.splice(e,1),e--);return u}function C_(){let t=this.getHistograms({maxSlots:this.maxValue+1}),e=new Array(t.length);for(let i=0;i<t.length;i++){let n=t[i];e[i]=hg(n)}return e}function I_(){let t=this.getHistograms({maxSlots:this.maxValue+1}),e=new Array(t.length);for(let i=0;i<t.length;i++){let n=t[i];e[i]=ag(n)}return e}function A_(){this.checkProcessable("points",{bitDepth:[1]});const t=[];for(let e=0;e<this.width;e++)for(let i=0;i<this.height;i++)1===this.getBitXY(e,i)&&t.push([e,i]);return t}function T_(){this.checkProcessable("extendedPoints",{bitDepth:[1]});const t=[];for(let e=0;e<this.height;e++)for(let i=0;i<this.width;i++)if(1===this.getBitXY(i,e))for(t.push([i,e]),1!==this.getBitXY(i+1,e)?(t.push([i+1,e]),t.push([i+1,e+1]),1!==this.getBitXY(i,e+1)&&t.push([i,e+1])):1!==this.getBitXY(i,e+1)&&(t.push([i,e+1]),t.push([i+1,e+1]));i<this.width-2&&1===this.getBitXY(i+1,e)&&1===this.getBitXY(i+2,e);)i++;return t}function R_(t,e={}){if(this===t)return[0,0];let i=[0,0],n=this;for(;n;){if(n===t)return i;n.position&&(i[0]+=n.position[0],i[1]+=n.position[1]),n=n.parent}return!!e.defaultFurther&&i}function P_(t={}){let{alpha:e=1}=t;this.checkProcessable("countAlphaPixels",{bitDepth:[8,16],alpha:1});let i=0;if(void 0!==e){for(let t=this.components;t<this.data.length;t+=this.channels)this.data[t]===e&&i++;return i}return this.size}function D_(t,e={}){const{sorted:i}=e;i||(t=t.slice().sort(L_));const n=t.length,r=new Array(2*n);let s=0;for(let e=0;e<n;e++){const i=t[e];for(;s>=2&&F_(r[s-2],r[s-1],i)<=0;)s--;r[s++]=i}const o=s+1;for(let e=n-2;e>=0;e--){const i=t[e];for(;s>=o&&F_(r[s-2],r[s-1],i)<=0;)s--;r[s++]=i}return r.slice(0,s-1)}function F_(t,e,i){return(e[1]-t[1])*(i[0]-t[0])-(e[0]-t[0])*(i[1]-t[1])}function L_(t,e){return t[0]===e[0]?t[1]-e[1]:t[0]-e[0]}function O_(){return D_(this.extendedPoints,{sorted:!1})}function N_(t,e){return[t[0]-e[0],t[1]-e[1]]}function B_(t){let e=Math.sqrt(t[0]**2+t[1]**2);return[t[0]/e,t[1]/e]}function z_(t,e,i){void 0===i&&(i=new Array(e.length));let n=Math.cos(t),r=Math.sin(t);for(let t=0;t<i.length;++t)i[t]=[n*e[t][0]-r*e[t][1],r*e[t][0]+n*e[t][1]];return i}function U_(t){let e=0;for(let i=0;i<t.length;i++){let n=t[i][0],r=t[i][1],s=t[i===t.length-1?0:i+1][0],o=t[i===t.length-1?0:i+1][1];e+=Math.sqrt((s-n)**2+(o-r)**2)}return e}function G_(t){let e=0;for(let i=0;i<t.length;i++)e+=t[i][0]*t[i===t.length-1?0:i+1][1]*.5,e-=t[i===t.length-1?0:i+1][0]*t[i][1]*.5;return Math.abs(e)}function Y_(t){let e=1/0,i=1/0,n=-1/0,r=-1/0;for(let s=0;s<t.length;s++)t[s][0]<e&&(e=t[s][0]),t[s][0]>n&&(n=t[s][0]),t[s][1]<i&&(i=t[s][1]),t[s][1]>r&&(r=t[s][1]);return[[e,i],[n,r]]}function X_(t={}){const{originalPoints:e=O_.call(this)}=t;if(0===e.length)return[];if(1===e.length)return[e[0],e[0],e[0],e[0]];const i=new Array(e.length);let n,r=1/0,s=0;for(let t=0;t<i.length;t++){let o=V_(e[t],e[(t+1)%i.length]);z_(-o,e,i);let a=i[t][0],h=i[t][1],l=i[(t+1)%i.length][0],c=i[(t+1)%i.length][1],u=!0,d=0,f=0,g=0;for(let t=0;t<i.length;t++){let e=(i[t][0]-a)/(l-a);!0===u?(u=!1,d=e,f=e):(e<d&&(d=e),e>f&&(f=e));let n=(-(l-a)*i[t][1]+l*h-c*a)/(l-a);Math.abs(n)>Math.abs(g)&&(g=n)}let m=[a+d*(l-a),h],p=[a+f*(l-a),h],_=Math.abs(g*(d-f)*(l-a));_<r&&(s=o,r=_,n=[m,p,[p[0],p[1]-g],[m[0],m[1]-g]])}return z_(s,n,n),n}function V_(t,e){let i=B_(N_(e,t)),n=Math.acos(i[0]);return i[1]<0?-n:n}var j_=__webpack_require__(2229),q_=__webpack_require__.n(j_),W_=__webpack_require__(4707),Z_=__webpack_require__.n(W_);function K_(t,e){let i=B_(N_(e,t)),n=Math.acos(i[0]);return i[1]<0?-n:n}class H_{constructor(t,e){this.map=t,this.id=e,this.minX=Number.POSITIVE_INFINITY,this.maxX=Number.NEGATIVE_INFINITY,this.minY=Number.POSITIVE_INFINITY,this.maxY=Number.NEGATIVE_INFINITY,this.meanX=0,this.meanY=0,this.surface=0,this.computed={}}getMask(t={}){const{scale:e=1,kind:i=""}=t;let n;switch(i){case"contour":n=this.contourMask;break;case"box":n=this.boxMask;break;case"filled":n=this.filledMask;break;case"center":n=this.centerMask;break;case"mbr":n=this.mbrFilledMask;break;case"hull":n=this.convexHullFilledMask;break;case"hullContour":n=this.convexHullMask;break;case"mbrContour":n=this.mbrMask;break;case"feret":n=this.feretMask;break;default:n=this.mask}return e<1&&(n=n.resize({factor:e}),n.parent=this.mask.parent,n.position[0]+=this.minX,n.position[1]+=this.minY),n}get mean(){throw new Error("Roi mean not implemented yet")}get center(){return this.computed.center||(this.computed.center=[this.width/2>>0,this.height/2>>0]),this.computed.center}get ratio(){return this.width/this.height}get width(){return this.maxX-this.minX+1}get height(){return this.maxY-this.minY+1}_computExternalIDs(){let t=this.borderIDs,e=this.borderLengths;this.computed.externalIDs=[],this.computed.externalLengths=[];let i=this.internalIDs;for(let n=0;n<t.length;n++)i.includes(t[n])||(this.computed.externalIDs.push(t[n]),this.computed.externalLengths.push(e[n]))}get externalIDs(){return this.computed.externalIDs||this._computExternalIDs(),this.computed.externalIDs}get externalLengths(){return this.computed.externalLengths||this._computExternalIDs(),this.computed.externalLengths}_computeBorderIDs(){let t=function(t){let e=t.map,i=e.data,n=new Set,r=new Map,s=new Set,o=[1,0,-1,0],a=[0,1,0,-1];for(let h=t.minX;h<=t.maxX;h++)for(let l=t.minY;l<=t.maxY;l++)if(i[h+l*e.width]===t.id)for(let c=0;c<4;c++){let u=h+o[c],d=l+a[c];if(u>=0&&d>=0&&u<e.width&&d<e.height){let o=u+d*e.width;if(i[o]!==t.id&&!s.has(o)){s.add(o),n.add(i[o]);let t=r.get(i[o]);t?r.set(i[o],++t):r.set(i[o],1)}}}let h=Array.from(n),l=h.map((function(t){return r.get(t)}));return{ids:h,lengths:l}}(this);this.computed.borderIDs=t.ids,this.computed.borderLengths=t.lengths}get borderIDs(){return this.computed.borderIDs||this._computeBorderIDs(),this.computed.borderIDs}get borderLengths(){return this.computed.borderLengths||this._computeBorderIDs(),this.computed.borderLengths}get boxIDs(){return this.computed.boxIDs||(this.computed.boxIDs=function(t){let e=new Set,i=t.map,n=i.data;for(let r of[0,t.height-1])for(let s=0;s<t.width;s++){let o=(r+t.minY)*i.width+s+t.minX;if(s-t.minX>0&&n[o]===t.id&&n[o-1]!==t.id){let t=n[o-1];e.add(t)}if(i.width-s-t.minX>1&&n[o]===t.id&&n[o+1]!==t.id){let t=n[o+1];e.add(t)}}for(let r of[0,t.width-1])for(let s=0;s<t.height;s++){let o=(s+t.minY)*i.width+r+t.minX;if(s-t.minY>0&&n[o]===t.id&&n[o-i.width]!==t.id){let t=n[o-i.width];e.add(t)}if(i.height-s-t.minY>1&&n[o]===t.id&&n[o+i.width]!==t.id){let t=n[o+i.width];e.add(t)}}return Array.from(e)}(this)),this.computed.boxIDs}get internalIDs(){return this.computed.internalIDs||(this.computed.internalIDs=function(t){let e=[t.id],i=t.map,n=i.data;if(t.height>2)for(let r=0;r<t.width;r++){let s=t.minY*i.width+r+t.minX;if(e.includes(n[s])){let r=n[s+i.width];e.includes(r)||t.boxIDs.includes(r)||e.push(r)}}let r=new Array(4);for(let s=1;s<t.width-1;s++)for(let o=1;o<t.height-1;o++){let a=(o+t.minY)*i.width+s+t.minX;if(e.includes(n[a])){r[0]=n[a-1],r[1]=n[a+1],r[2]=n[a-i.width],r[3]=n[a+i.width];for(let i=0;i<4;i++){let n=r[i];e.includes(n)||t.boxIDs.includes(n)||e.push(n)}}}return e}(this)),this.computed.internalIDs}get box(){return this.computed.box||(this.computed.box=function(t){let e=0,i=t.map,n=i.data,r=[0];t.height>1&&(r[1]=t.height-1);for(let s of r)for(let r=1;r<t.width-1;r++)n[(s+t.minY)*i.width+r+t.minX]===t.id&&e++;let s=[0];t.width>1&&(s[1]=t.width-1);for(let r of s)for(let s=0;s<t.height;s++)n[(s+t.minY)*i.width+r+t.minX]===t.id&&e++;return e}(this)),this.computed.box}get external(){return this.computed.external||(this.computed.external=function(t){let e=0,i=t.map,n=i.data;for(let r=1;r<t.width-1;r++)for(let s=1;s<t.height-1;s++){let o=(s+t.minY)*i.width+r+t.minX;n[o]===t.id&&(t.externalIDs.includes(n[o-1])||t.externalIDs.includes(n[o+1])||t.externalIDs.includes(n[o-i.width])||t.externalIDs.includes(n[o+i.width]))&&e++}return e+t.box}(this)),this.computed.external}get holesInfo(){return this.computed.holesInfo||(this.computed.holesInfo=function(t){let e=0,i=t.map.width,n=t.map.data;for(let r=1;r<t.width-1;r++)for(let s=1;s<t.height-1;s++){let o=(s+t.minY)*i+r+t.minX;t.internalIDs.includes(n[o])&&n[o]!==t.id&&e++}return{number:t.internalIDs.length-1,surface:e}}(this)),this.computed.holesInfo}get border(){return this.computed.border||(this.computed.border=function(t){let e=0,i=t.map,n=i.data;for(let r=1;r<t.width-1;r++)for(let s=1;s<t.height-1;s++){let o=(s+t.minY)*i.width+r+t.minX;n[o]===t.id&&(n[o-1]===t.id&&n[o+1]===t.id&&n[o-i.width]===t.id&&n[o+i.width]===t.id||e++)}return e+t.box}(this)),this.computed.border}get contourMask(){if(!this.computed.contourMask){let t=new vw(this.width,this.height,{kind:Af,position:[this.minX,this.minY],parent:this.map.parent});for(let e=0;e<this.width;e++)for(let i=0;i<this.height;i++)this.map.data[e+this.minX+(i+this.minY)*this.map.width]===this.id&&(e>0&&e<this.width-1&&i>0&&i<this.height-1&&this.map.data[e-1+this.minX+(i+this.minY)*this.map.width]===this.id&&this.map.data[e+1+this.minX+(i+this.minY)*this.map.width]===this.id&&this.map.data[e+this.minX+(i-1+this.minY)*this.map.width]===this.id&&this.map.data[e+this.minX+(i+1+this.minY)*this.map.width]===this.id||t.setBitXY(e,i));this.computed.contourMask=t}return this.computed.contourMask}get boxMask(){if(!this.computed.boxMask){let t=new vw(this.width,this.height,{kind:Af,position:[this.minX,this.minY],parent:this.map.parent});for(let e=0;e<this.width;e++)t.setBitXY(e,0),t.setBitXY(e,this.height-1);for(let e=0;e<this.height;e++)t.setBitXY(0,e),t.setBitXY(this.width-1,e);this.computed.boxMask=t}return this.computed.boxMask}get mask(){if(!this.computed.mask){let t=new vw(this.width,this.height,{kind:Af,position:[this.minX,this.minY],parent:this.map.parent});for(let e=0;e<this.width;e++)for(let i=0;i<this.height;i++)this.map.data[e+this.minX+(i+this.minY)*this.map.width]===this.id&&t.setBitXY(e,i);this.computed.mask=t}return this.computed.mask}get filledMask(){if(!this.computed.filledMask){let t=new vw(this.width,this.height,{kind:Af,position:[this.minX,this.minY],parent:this.map.parent});for(let e=0;e<this.width;e++)for(let i=0;i<this.height;i++){let n=e+this.minX+(i+this.minY)*this.map.width;this.internalIDs.includes(this.map.data[n])&&t.setBitXY(e,i)}this.computed.filledMask=t}return this.computed.filledMask}get centerMask(){if(!this.computed.centerMask){let t=new c_({kind:"smallCross"}).getMask();t.parent=this.map.parent,t.position=[this.minX+this.center[0]-1,this.minY+this.center[1]-1],this.computed.centerMask=t}return this.computed.centerMask}get convexHull(){if(!this.computed.convexHull){const t=[];for(let e=0;e<this.width;e++)for(let i=0;i<this.height;i++)this.map.data[e+this.minX+(i+this.minY)*this.map.width]===this.id&&(e>0&&e<this.width-1&&i>0&&i<this.height-1&&this.map.data[e-1+this.minX+(i+this.minY)*this.map.width]===this.id&&this.map.data[e+1+this.minX+(i+this.minY)*this.map.width]===this.id&&this.map.data[e+this.minX+(i-1+this.minY)*this.map.width]===this.id&&this.map.data[e+this.minX+(i+1+this.minY)*this.map.width]===this.id||(t.push([e,i]),t.push([e+1,i]),t.push([e,i+1]),t.push([e+1,i+1])));const e=D_(t);this.computed.convexHull={polyline:e,surface:G_(e),perimeter:U_(e)}}return this.computed.convexHull}get convexHullMask(){if(!this.computed.convexHullMask){const t=this.convexHull,e=new vw(this.width+1,this.height+1,{kind:Af,position:[this.minX,this.minY],parent:this.map.parent});e.paintPolyline(t.polyline,{closed:!0}),this.computed.convexHullMask=e}return this.computed.convexHullMask}get convexHullFilledMask(){if(!this.computed.convexHullFilledMask){const t=this.convexHull,e=new vw(this.width,this.height,{kind:Af,position:[this.minX,this.minY],parent:this.map.parent});for(let i=0;i<this.width;i++)for(let n=0;n<this.height;n++)1!==Z_()(t.polyline,[i,n])&&e.setBitXY(i,n);this.computed.convexHullFilledMask=e}return this.computed.convexHullFilledMask}get mbr(){if(!this.computed.mbr){let t=X_({originalPoints:this.convexHull.polyline});if(0===t.length)this.computed.mbr={width:0,height:0,surface:0,perimeter:0,rectangle:t};else{let e=t[0],i=t[1],n=t[2],r=Math.sqrt((e[0]-i[0])**2+(e[1]-i[1])**2),s=Math.sqrt((n[0]-i[0])**2+(n[1]-i[1])**2);this.computed.mbr={width:r,height:s,elongation:1-r/s,aspectRatio:r/s,surface:r*s,perimeter:2*(r+s),rectangle:t}}}return this.computed.mbr}get fillRatio(){return this.surface/(this.surface+this.holesInfo.surface)}get feretDiameters(){return this.computed.feretDiameters||(this.computed.feretDiameters=function(t={}){const{originalPoints:e=O_.call(this)}=t;if(0===e.length)return{min:0,max:0,minLine:[],maxLine:[],aspectRatio:1};if(1===e.length)return{min:1,max:1,minLine:[e[0],e[0]],maxLine:[e[0],e[0]],aspectRatio:1};const i=new Array(e.length);let n=1/0,r=0,s=[];for(let t=0;t<e.length;t++){let o=K_(e[t],e[(t+1)%e.length]);z_(-o,e,i);let a=0,h=[];for(let n=0;n<e.length;n++){let e=Math.abs(i[t][1]-i[n][1]);e>a&&(a=e,h=[],h.push([i[n][0],i[t][1]],[i[n][0],i[n][1]]))}a<n&&(n=a,r=o,s=h)}z_(r,s,s);let o=0,a=[],h=0;for(let t=0;t<e.length-1;t++)for(let i=t+1;i<e.length;i++){let n=(e[t][0]-e[i][0])**2+(e[t][1]-e[i][1])**2;n>h&&(h=n,o=Math.sqrt(n),a=[e[t],e[i]])}return{min:n,minLine:s,max:o,maxLine:a,aspectRatio:n/o}}({originalPoints:this.convexHull.polyline})),this.computed.feretDiameters}get eqpc(){return this.computed.eqpc||(this.computed.eqpc=2*Math.sqrt(this.surface/Math.PI)),this.computed.eqpc}get perimeterInfo(){return this.computed.perimeterInfo||(this.computed.perimeterInfo=function(t){let e=t.map,i=e.data,n=0,r=0,s=0,o=0;for(let a=0;a<t.width;a++)for(let h=0;h<t.height;h++){let l=(h+t.minY)*e.width+a+t.minX;if(i[l]===t.id){let c=0;switch((0===a||t.externalIDs.includes(i[l-1]))&&c++,(a===t.width-1||t.externalIDs.includes(i[l+1]))&&c++,(0===h||t.externalIDs.includes(i[l-e.width]))&&c++,(h===t.height-1||t.externalIDs.includes(i[l+e.width]))&&c++,c){case 1:n++;break;case 2:r++;break;case 3:s++;break;case 4:o++}}}return{one:n,two:r,three:s,four:o}}(this)),this.computed.perimeterInfo}get perimeter(){let t=this.perimeterInfo,e=2-Math.sqrt(2);return t.one+2*t.two+3*t.three+4*t.four-e*(t.two+2*t.three+t.four)}get ped(){return this.computed.ped||(this.computed.ped=this.perimeter/Math.PI),this.computed.ped}get feretMask(){if(!this.computed.feretMask){const t=new vw(this.width+1,this.height+1,{kind:Af,position:[this.minX,this.minY],parent:this.map.parent});t.paintPolyline(this.feretDiameters.minLine),t.paintPolyline(this.feretDiameters.maxLine),this.computed.feretMask=t}return this.computed.feretMask}get mbrMask(){if(!this.computed.mbrMask){let t=function(t){for(let e=0;e<t.length;e++)t[e][0]=Math.round(t[e][0]),t[e][1]=Math.round(t[e][1]);return t}(this.mbr.rectangle);if(t.length>0){const e=Y_(t),i=new vw(e[1][0]-e[0][0]+1,e[1][1]-e[0][1]+1,{kind:Af,position:[this.minX+e[0][0],this.minY+e[0][1]],parent:this.map.parent});t=function(t,e){void 0===e&&(e=new Array(t.length).fill(0).map((()=>[])));let i=Y_(t),n=i[0][0],r=i[0][1];for(let i=0;i<t.length;i++)e[i][0]=t[i][0]-n,e[i][1]=t[i][1]-r;return e}(t),i.paintPolyline(t,{closed:!0}),this.computed.mbrMask=i}else this.computed.mbrMask=new vw(1,1,{kind:Af,position:[this.minX,this.minY],parent:this.map.parent})}return this.computed.mbrMask}get mbrFilledMask(){if(!this.computed.mbrFilledMask){const t=new vw(this.width,this.height,{kind:Af,position:[this.minX,this.minY],parent:this.map.parent}),e=this.mask.minimalBoundingRectangle();for(let i=0;i<this.width;i++)for(let n=0;n<this.height;n++)1!==Z_()(e,[i,n])&&t.setBitXY(i,n);this.computed.mbrFilledMask=t}return this.computed.mbrFilledMask}get points(){if(!this.computed.points){let t=[];for(let e=0;e<this.height;e++)for(let i=0;i<this.width;i++){let n=(e+this.minY)*this.map.width+i+this.minX;this.map.data[n]===this.id&&t.push([i,e])}this.computed.points=t}return this.computed.points}get maxLengthPoints(){if(!this.computed.maxLengthPoints){let t,e=0;const i=this.points;for(let n=0;n<i.length;n++)for(let r=n+1;r<i.length;r++){let s=Math.pow(i[n][0]-i[r][0],2)+Math.pow(i[n][1]-i[r][1],2);s>=e&&(e=s,t=[i[n],i[r]])}this.computed.maxLengthPoints=t}return this.computed.maxLengthPoints}get maxLength(){if(!this.computed.maxLength){let t=Math.sqrt(Math.pow(this.maxLengthPoints[0][0]-this.maxLengthPoints[1][0],2)+Math.pow(this.maxLengthPoints[0][1]-this.maxLengthPoints[1][1],2));this.computed.maxLength=t}return this.computed.maxLength}get roundness(){return 4*this.surface/(Math.PI*this.feretDiameters.max**2)}get sphericity(){return 2*Math.sqrt(this.surface*Math.PI)/this.perimeter}get solidity(){return this.surface/this.convexHull.surface}get angle(){if(!this.computed.angle){let t=this.maxLengthPoints,e=180*-Math.atan2(t[0][1]-t[1][1],t[0][0]-t[1][0])/Math.PI;this.computed.angle=e}return this.computed.angle}toJSON(){return{id:this.id,minX:this.minX,maxX:this.maxX,minY:this.minY,maxY:this.maxY,meanX:this.meanX,meanY:this.meanY,height:this.height,width:this.width,surface:this.surface,mbrWidth:this.mbr.width,mbrHeight:this.mbr.height,mbrSurface:this.mbr.surface,eqpc:this.eqpc,ped:this.ped,feretDiameterMin:this.feretDiameters.min,feretDiameterMax:this.feretDiameters.max,aspectRatio:this.feretDiameters.aspectRatio,fillRatio:this.fillRatio,sphericity:this.sphericity,roundness:this.roundness,solidity:this.solidity,perimeter:this.perimeter}}}class $_{constructor(t,e){this.roiMap=t,this.options=e,this.roi=this.createRoi()}createRoi(){let t=this.roiMap.data,e={};this.roiMap.positive=0,this.roiMap.negative=0;for(let i=0;i<t.length;i++)t[i]&&!e[t[i]]&&(e[t[i]]=!0,t[i]>0?this.roiMap.positive++:this.roiMap.negative++);let i={};for(let t in e)i[t]=new H_(this.roiMap,1*t);let n=this.roiMap.width,r=this.roiMap.height;for(let e=0;e<r;e++)for(let r=0;r<n;r++){let s=e*n+r;if(0!==t[s]){const n=i[t[s]];r<n.minX&&(n.minX=r),r>n.maxX&&(n.maxX=r),e<n.minY&&(n.minY=e),e>n.maxY&&(n.maxY=e),n.meanX+=r,n.meanY+=e,n.surface++}}let s=[];for(let t in e)i[t].meanX/=i[t].surface,i[t].meanY/=i[t].surface,s.push(i[t]);return s}}function J_(t={}){const{algorithm:e="commonBorderLength",minCommonBorderLength:i=5,maxCommonBorderLength:n=100,minCommonBorderRatio:r=.3,maxCommonBorderRatio:s=1}=t;let o=function(t,e,r){return t[r]>=i&&t[r]<=n};"function"==typeof e&&(o=e),"commonborderratio"===e.toLowerCase()&&(o=function(t,e,i){let n=Math.min(t[i]/t[e],1);return n>=r&&n<=s});const a=this,h=a.commonBorderLength;let l={},c={};for(let t of Object.keys(h)){let e=h[t],i=Object.keys(e);for(let n of i)if(n!==t&&o(e,t,n)){let e=n;c[n]&&(e=c[n]);let i=t;if(c[t]&&(i=c[t]),Number(e)!==i){let t=Math.min(e,i),n=Math.max(e,i);if(l[t]||(l[t]={}),l[t][n]=!0,c[n]=t,l[n]){for(let e of Object.keys(l[n]))l[t][e]=!0,c[e]=t;delete l[n]}}}}let u=a.minMax,d=-u.min,f=u.max+d,g=new Array(f+1).fill(0);for(let t of Object.keys(c))g[Number(t)+d]=c[t];let m=a.data;for(let t=0;t<m.length;t++){let e=m[t];if(0!==e){let i=g[e+d];0!==i&&(m[t]=i)}}return a.computed={},a}class Q_{constructor(t,e){this.parent=t,this.width=t.width,this.height=t.height,this.data=e,this.negative=0,this.positive=0}get total(){return this.negative+this.positive}get minMax(){let t=Number.MAX_SAFE_INTEGER,e=Number.MIN_SAFE_INTEGER;for(let i=0;i<this.data.length;i++)this.data[i]<t&&(t=this.data[i]),this.data[i]>e&&(e=this.data[i]);return{min:t,max:e}}get commonBorderLength(){return function(t){let e=t.data,i=[1,0,-1,0],n=[0,1,0,-1],r=t.minMax,s=-r.min,o=r.max+s,a=[];for(let t=0;t<=o;t++)a.push(Object.create(null));for(let r=0;r<t.width;r++)for(let o=0;o<t.height;o++){let h=e[r+o*t.width];if(0!==h){let l=Object.create(null),c=!1;for(let u=0;u<4;u++){let d=r+i[u],f=o+n[u];if(d>=0&&f>=0&&d<t.width&&f<t.height){let i=e[d+f*t.width];h!==i&&(c=!0,0!==i&&void 0===l[i]&&(l[i]=!0,a[i+s][h]?a[i+s][h]++:a[i+s][h]=1))}else c=!0}c&&(a[h+s][h]?a[h+s][h]++:a[h+s][h]=1)}}let h={};for(let t=0;t<a.length;t++)Object.keys(a[t]).length>0&&(h[t-s]=a[t]);return h}(this)}mergeRoi(t={}){return J_.call(this,t)}mergeRois(t){const e=t[0],i=t.slice(1);for(let t=0;t<this.data.length;t++)i.includes(this.data[t])&&(this.data[t]=e)}rowsInfo(){let t=new Array(this.height),e=0;for(let i=0;i<this.data.length;i+=this.width){let n={row:e,positivePixel:0,negativePixel:0,zeroPixel:0,positiveRoi:0,negativeRoi:0,medianChange:0};t[e++]=n;let r={},s={},o=[],a=this.data[i],h=0;for(let t=i;t<i+this.width;t++){let e=this.data[t];a!==e&&(a=e,o.push(h),h=0),h++,e>0?(n.positivePixel++,r[e]||(r[e]=!0)):e<0?(n.negativePixel++,s[e]||(s[e]=!0)):n.zeroPixel++}o.push(h),n.medianChange=o.sort(((t,e)=>t-e))[Math.floor(o.length/2)],n.positiveRoiIDs=Object.keys(r),n.negativeRoiIDs=Object.keys(s),n.positiveRoi=n.positiveRoiIDs.length,n.negativeRoi=n.negativeRoiIDs.length}return t}colsInfo(){let t=new Array(this.width),e=0;for(let i=0;i<this.width;i++){let n={col:e,positivePixel:0,negativePixel:0,zeroPixel:0,positiveRoi:0,negativeRoi:0,medianChange:0};t[e++]=n;let r={},s={},o=[],a=this.data[i],h=0;for(let t=i;t<i+this.data.length;t+=this.width){let e=this.data[t];a!==e&&(a=e,o.push(h),h=0),h++,e>0?(n.positivePixel++,r[e]||(r[e]=!0)):e<0?(n.negativePixel++,s[e]||(s[e]=!0)):n.zeroPixel++}o.push(h),n.medianChange=o.sort(((t,e)=>t-e))[Math.floor(o.length/2)],n.positiveRoiIDs=Object.keys(r),n.negativeRoiIDs=Object.keys(s),n.positiveRoi=n.positiveRoiIDs.length,n.negativeRoi=n.negativeRoiIDs.length}return t}}function tw(t,e={}){const{allowCorners:i=!1}=e,n=65535;let r=new Int16Array(t.size),s=0,o=0,a=new Uint16Array(65536),h=new Uint16Array(65536);for(let e=0;e<t.width;e++)for(let i=0;i<t.height;i++)0===r[i*t.width+e]&&l(e,i);function l(e,l){let c=0,u=0,d=t.getBitXY(e,l),f=d?++s:--o;if(s>32767||o<-32768)throw new Error("Too many regions of interest");for(a[0]=e,h[0]=l;c<=u;){let e=a[c&n],s=h[c&n];if(r[s*t.width+e]=f,e>0&&0===r[s*t.width+e-1]&&t.getBitXY(e-1,s)===d&&(u++,a[u&n]=e-1,h[u&n]=s,r[s*t.width+e-1]=-32768),s>0&&0===r[(s-1)*t.width+e]&&t.getBitXY(e,s-1)===d&&(u++,a[u&n]=e,h[u&n]=s-1,r[(s-1)*t.width+e]=-32768),e<t.width-1&&0===r[s*t.width+e+1]&&t.getBitXY(e+1,s)===d&&(u++,a[u&n]=e+1,h[u&n]=s,r[s*t.width+e+1]=-32768),s<t.height-1&&0===r[(s+1)*t.width+e]&&t.getBitXY(e,s+1)===d&&(u++,a[u&n]=e,h[u&n]=s+1,r[(s+1)*t.width+e]=-32768),i&&(e>0&&s>0&&0===r[(s-1)*t.width+e-1]&&t.getBitXY(e-1,s-1)===d&&(u++,a[u&n]=e-1,h[u&n]=s-1,r[(s-1)*t.width+e-1]=-32768),e<t.width-1&&s>0&&0===r[(s-1)*t.width+e+1]&&t.getBitXY(e+1,s-1)===d&&(u++,a[u&n]=e+1,h[u&n]=s-1,r[(s-1)*t.width+e+1]=-32768),e>0&&s<t.height-1&&0===r[(s+1)*t.width+e-1]&&t.getBitXY(e-1,s+1)===d&&(u++,a[u&n]=e-1,h[u&n]=s+1,r[(s+1)*t.width+e-1]=-32768),e<t.width-1&&s<t.height-1&&0===r[(s+1)*t.width+e+1]&&t.getBitXY(e+1,s+1)===d&&(u++,a[u&n]=e+1,h[u&n]=s+1,r[(s+1)*t.width+e+1]=-32768)),c++,u-c>n)throw new Error("analyseMask can not finish, the array to manage internal data is not big enough.You could improve mask by changing MAX_ARRAY")}}return new Q_(t,r)}var ew=__webpack_require__(530),iw=__webpack_require__.n(ew);const nw=[-1,0],rw=[0,-1],sw=[null,null],ow=[-1,-1,0,1],aw=[0,-1,-1,-1],hw=[null,null,null,null];function lw(t,e={}){const{allowCorners:i=!1}=e;let n,r,s,o=4;if(i&&(o=8),8===o)n=ow,r=aw,s=hw;else{if(4!==o)throw new RangeError(`unsupported neighbours count: ${o}`);n=nw,r=rw,s=sw}const a=t.size,h=t.width,l=t.height,c=new Array(a),u=new Uint32Array(a),d=new(iw());let f=1;for(let e=0;e<l;e++)for(let i=0;i<h;i++){const o=i+e*h;if(t.getBit(o)){let t=null;for(let o=0;o<s.length;o++){const a=i+n[o],u=e+r[o];if(a>=0&&u>=0&&a<h&&u<l){let e=c[a+u*h];e?(s[o]=e,(!t||s[o].value<t.value)&&(t=s[o])):s[o]=null}}if(t){c[o]=t;for(let e=0;e<s.length;e++)s[e]&&s[e]!==t&&d.union(t,s[e])}else c[o]=d.add(f++)}}for(let e=0;e<l;e++)for(let i=0;i<h;i++){const n=i+e*h;t.getBit(n)&&(u[n]=d.find(c[n]).value)}return new Q_(t,u)}function cw(t={}){let{allowCorner:e=!0,onlyTop:i=!1,invert:n=!1}=t,r=this;r.checkProcessable("fromMaxima",{components:[1]});const s=1,o=2;let a=0,h=0,l=new Int16Array(r.size),c=new Int8Array(r.size),u=new Float32Array(r.size),d=1048575,f=new Uint16Array(d+1),g=new Uint16Array(d+1),m=0,p=0,_=new Uint16Array(d+1),w=new Uint16Array(d+1),y=0,v=0;for(function({maxima:t=!0}){for(let i=1;i<r.height-1;i++)for(let n=1;n<r.width-1;n++){let s=n+i*r.width;if(0===c[s]){let o=t?r.data[s]:-r.data[n+i*r.width];if(r.data[i*r.width+n-1]>o)continue;if(r.data[i*r.width+n+1]>o)continue;if(r.data[(i-1)*r.width+n]>o)continue;if(r.data[(i+1)*r.width+n]>o)continue;if(e){if(r.data[(i-1)*r.width+n-1]>o)continue;if(r.data[(i-1)*r.width+n+1]>o)continue;if(r.data[(i+1)*r.width+n-1]>o)continue;if(r.data[(i+1)*r.width+n+1]>o)continue}l[s]=t?++a:--h,b(n,i)||(t?--a:++h)}}}(r);m<p;)x(f[m&d],g[m&d],o),m++;return new Q_(r,l);function b(t,e){let i=p;y=0,v=1,_[0]=t,w[0]=e;let n=!0;for(;y<v;)n&=x(_[y&d],w[y&d],s),y++;if(!n){for(let t=0;t<v;t++){let e=_[t&d],i=w[t&d]*r.width+e;l[i]=0}p=i}return n}function x(t,e,n){let a=l[e*r.width+t],h=r.data[e*r.width+t];for(let m=e-1;m<=e+1;m++)for(let e=t-1;e<=t+1;e++){let t=m*r.width+e;if(0===c[t])switch(c[t]=1,u[t]=r.data[t]-h,n){case s:if(0===u[t]){if(0===e||0===m||e===r.width-1||m===r.height-1)return!1;l[t]=a,_[v&d]=e,w[v&d]=m,v++}else{if(u[t]>0)return!1;i||(l[t]=a,f[p&d]=e,g[p&d]=m,p++)}break;case o:u[t]<=0&&(l[t]=a,f[p&d]=e,g[p&d]=m,p++);break;default:throw new Error("unreachable")}}return!0}}function uw(t,e={}){let i=new c_(e),n=new Int16Array(this.size),r=0,s=i.getPoints();for(let e=0;e<t.length;e++){r++;let i=t[e][0],o=t[e][1];for(let t=0;t<s.length;t++){let e=s[t][0],a=s[t][1];i+e>=0&&o+a>=0&&i+e<this.width&&o+a<this.height&&(n[i+e+(o+a)*this.width]=r)}}return new Q_(this,n)}var dw=__webpack_require__(5307),fw=__webpack_require__.n(dw);const gw=[1,0,-1,0,1,1,-1,-1],mw=[0,1,0,-1,1,-1,1,-1];function pw(t={}){let{points:e,mask:i,image:n,fillMaxValue:r=this.maxValue,invert:s=!1}=t,o=n||this;o.checkProcessable("fromWaterShed",{bitDepth:[8,16],components:1}),s=!s,e||(e=o.getLocalMaxima({invert:s,mask:i}));let a=s?0:1,h=new Int16Array(o.size),l=o.width,c=o.height,u=new(fw())({comparator:(t,e)=>t[2]-e[2],strategy:fw().BinaryHeapStrategy});for(let t=0;t<e.length;t++){let i=e[t][0]+e[t][1]*l;h[i]=t+1;let n=o.data[i];(s&&n<=r||!s&&n>=r)&&u.queue([e[t][0],e[t][1],n])}for(;u.length>0;){let t=u.dequeue(),e=t[0]+t[1]*l;for(let n=0;n<4;n++){let d=t[0]+gw[n],f=t[1]+mw[n];if(d>=0&&f>=0&&d<l&&f<c){let c=d+f*l;if(!i||i.getBit(c)===a){let i=o.data[c];(s&&i<=r||!s&&i>=r)&&0===h[c]&&(h[c]=h[e],u.queue([t[0]+gw[n],t[1]+mw[n],i]))}}}}return new Q_(o,h)}class _w{constructor(t,e={}){this._image=t,this._options=e,this._options.label||(this._options.label="default"),this._layers={},this._painted=null}fromMaxima(t={}){let e=Object.assign({},this._options,t),i=cw.call(this._image,t);this._layers[e.label]=new $_(i,e)}fromPoints(t,e={}){let i=Object.assign({},this._options,e),n=uw.call(this._image,t,e);return this._layers[i.label]=new $_(n,i),this}putMap(t,e={}){let i=new Q_(this._image,t),n=Object.assign({},this._options,e);return this._layers[n.label]=new $_(i,n),this}fromWaterShed(t={}){let e=Object.assign({},this._options,t),i=pw.call(this._image,t);this._layers[e.label]=new $_(i,e)}fromMask(t,e={}){let i=Object.assign({},this._options,e),n=tw.call(this._image,t,e);return this._layers[i.label]=new $_(n,i),this}fromMaskConnectedComponentLabelingAlgorithm(t,e={}){let i=Object.assign({},this._options,e),n=lw.call(this._image,t,e);return this._layers[i.label]=new $_(n,i),this}getMap(t={}){let e=Object.assign({},this._options,t);return this._assertLayerWithLabel(e.label),this._layers[e.label].roiMap}rowsInfo(t={}){return this.getMap(t).rowsInfo()}colsInfo(t={}){return this.getMap(t).rowsInfo()}getRoiIds(t={}){let e=this.getRois(t);if(e){let t=new Array(e.length);for(let i=0;i<e.length;i++)t[i]=e[i].id;return t}throw new Error("ROIs not found")}getRois(t={}){let{label:e=this._options.label,positive:i=!0,negative:n=!0,minSurface:r=0,maxSurface:s=Number.POSITIVE_INFINITY,minWidth:o=0,maxWidth:a=Number.POSITIVE_INFINITY,minHeight:h=0,maxHeight:l=Number.POSITIVE_INFINITY,minRatio:c=0,maxRatio:u=Number.POSITIVE_INFINITY}=t;if(!this._layers[e])throw new Error(`this Roi layer (${e}) does not exist`);const d=this._layers[e].roi,f=[];for(const t of d)(t.id<0&&n||t.id>0&&i)&&t.surface>=r&&t.surface<=s&&t.width>=o&&t.width<=a&&t.height>=h&&t.height<=l&&t.ratio>=c&&t.ratio<=u&&f.push(t);return f}getRoi(t,e={}){const{label:i=this._options.label}=e;if(!this._layers[i])throw new Error(`this Roi layer (${i}) does not exist`);const n=this._layers[i].roi.find((e=>e.id===t));if(!n)throw new Error(`found no Roi with id ${t}`);return n}getMasks(t={}){let e=this.getRois(t),i=new Array(e.length);for(let n=0;n<e.length;n++)i[n]=e[n].getMask(t);return i}getAnalysisMasks(t={}){const{analysisProperty:e}=t;let i=`${e}Mask`,n=this.getRois(t);return 0!==n.length&&n[0][i]?n.map((t=>t[i])):[]}getData(t={}){let e=Object.assign({},this._options,t);return this._assertLayerWithLabel(e.label),this._layers[e.label].roiMap.data}paint(t={}){let{labelProperty:e,analysisProperty:i}=t;this._painted||(this._painted=this._image.rgba8());let n=this.getMasks(t);if(e){const i=this.getRois(t);t.labels=i.map((t=>function(t,e=""){let i=e.split(".");for(let e of i){if(void 0===t[e])return;t=t[e]}return t}(t,e)));const n=Math.max(...t.labels);let r=!1,s=!1;if(e.includes("surface")?r=!0:/(?:perimeter|min|max|external|width|height|length)/.test(e)&&(s=!0),isFinite(n)){let e="";if("pixel"!==t.unit&&t.pixelSize&&(s||r)){e=r?`${t.unit}^2`:t.unit;let i=r?"m^2":"m",n=r?t.pixelSize**2:t.pixelSize;const s=q_().swiftConverter(i,e);t.labels=t.labels.map((t=>s(n*t)))}t.labels=n>50?t.labels.map((t=>Math.round(t)+e)):n>10?t.labels.map((t=>t.toFixed(1)+e)):t.labels.map((t=>t.toFixed(2)+e))}t.labelsPosition=i.map((t=>[t.meanX,t.meanY]))}if(this._painted.paintMasks(n,t),i){let e=this.getAnalysisMasks(t);this._painted.paintMasks(e,{color:t.analysisColor,alpha:t.analysisAlpha})}return this._painted}getMask(t={}){let e=new vw(this._image.width,this._image.height,{kind:"BINARY"}),i=this.getMasks(t);for(let t=0;t<i.length;t++){let n=i[t];for(let t=0;t<n.width;t++)for(let i=0;i<n.height;i++)n.getBitXY(t,i)&&e.setBitXY(t+n.position[0],i+n.position[1])}return e}resetPainted(t={}){const{image:e}=t;this._painted=e?this.image.rgba8():this._image.rgba8()}mergeRoi(t={}){const e=this.getMap(t);return e.mergeRoi(t),this.putMap(e.data,t),this}mergeRois(t,e={}){if(!Array.isArray(t)||t.some((t=>!Number.isInteger(t))))throw new Error("Roi ids must be an array of integers");if(t.length<2)throw new Error("Roi ids must have at least two elements");if(new Set(t).size!==t.length)throw new Error("Roi ids must be all different");t.forEach((t=>this.getRoi(t)));const i=this.getMap(e);return i.mergeRois(t),this.putMap(i.data,e),this}findCorrespondingRoi(t,e={}){let i=this.getRois(e),n=[];for(let e=0;e<i.length;e++){let r=i[e],s=ww(r.minX,r.minY,r.points,t,Math.sign(r.id));n.push(s)}return n}_assertLayerWithLabel(t){if(!this._layers[t])throw new Error(`no layer with label ${t}`)}}function ww(t,e,i,n,r){let s={id:[],surface:[],roiSurfaceCovered:[],same:0,opposite:0,total:0};for(let r=0;r<i.length;r++){let o=i[r],a=o[0]+t+(o[1]+e)*n.width,h=n.data[a];(h>0||h<0)&&(s.id.includes(h)?s.surface[s.id.indexOf(h)]+=1:(s.id.push(h),s.surface.push(1)))}for(let t=0;t<s.id.length;t++)Math.sign(s.id[t])===r?s.same+=s.surface[t]:s.opposite+=s.surface[t],s.roiSurfaceCovered[t]=s.surface[t]/i.length;return s.total=s.opposite+s.same,s}const yw=Object.prototype.toString;class vw{constructor(e,i,n,r){if(1===arguments.length?(r=e,({width:e,height:i,data:n}=r)):n&&!n.length&&(r=n,({data:n}=r)),void 0===e&&(e=1),void 0===i&&(i=1),void 0===r&&(r={}),"object"!=typeof r||null===r)throw new TypeError("options must be an object");if(!Number.isInteger(e)||e<=0)throw new RangeError("width must be a positive integer");if(!Number.isInteger(i)||i<=0)throw new RangeError("height must be a positive integer");const{kind:s=Tf}=r;if("string"!=typeof s)throw new TypeError("kind must be a string");const o=function(t){const e=Rf[t];if(!e)throw new RangeError(`invalid image kind: ${t}`);return e}(s),a=Object.assign({},r);for(const t in o)void 0===a[t]&&(a[t]=o[t]);!function(e){const{components:i,alpha:n,bitDepth:r,colorModel:s}=e;if(!Number.isInteger(i)||i<=0)throw new RangeError(`invalid components: ${i}. Must be a positive integer`);if(0!==n&&1!==n&&"boolean"!=typeof n)throw new TypeError(`invalid alpha: ${n}: must be a boolean, 0 or 1`);if(!Pf.includes(r))throw new RangeError(`invalid bitDepth: ${r}. Must be one of ${Pf.join(", ")}`);if(!t[s])throw new RangeError(`invalid colorModel: ${s}. Must be one of ${Object.keys(t).join(", ")}`)}(a);const{components:h,bitDepth:l,colorModel:c}=a,u=a.alpha+0,d=e*i,f=h+u,g=32===l?Number.MAX_VALUE:2**l-1;if(void 0===n)n=function(t,e,i,n,r,s){const o=n*t;let a;switch(r){case 1:a=new Uint8Array(Math.ceil(o/8));break;case 8:a=new Uint8Array(o);break;case 16:a=new Uint16Array(o);break;case 32:a=new Float32Array(o);break;default:throw new Error(`Cannot create pixel array for bit depth ${r}`)}if(i)for(let t=e;t<a.length;t+=n)a[t]=s;return a}(d,h,u,f,l,g);else{const t=function(t,e,i){let n=e*t;return 1===i&&(n=Math.ceil(n/8)),n}(d,f,l);if(n.length!==t)throw new RangeError(`incorrect data size: ${n.length}. Should be ${t}`)}this.width=e,this.height=i,this.data=n,this.size=d,this.components=h,this.alpha=u,this.bitDepth=l,this.maxValue=g,this.colorModel=c,this.channels=f,this.meta=r.meta||{},Object.defineProperty(this,"parent",{enumerable:!1,writable:!0,configurable:!0,value:r.parent||null}),this.position=r.position||[0,0],this.computed=null,this.sizes=[this.width,this.height],this.multiplierX=this.channels,this.multiplierY=this.channels*this.width,this.isClamped=this.bitDepth<32,this.borderSizes=[0,0]}get[Symbol.toStringTag](){return"IJSImage"}static isImage(t){return"[object IJSImage]"===yw.call(t)}static fromCanvas(t){const e=t.getContext("2d").getImageData(0,0,t.width,t.height);return new vw(e.width,e.height,e.data)}static createFrom(t,e){const i=Mg(t);return Object.assign(i,{parent:t,position:[0,0]},e),new vw(i)}getRoiManager(t){return new _w(this,t)}clone(){const t=this.data.slice();return new vw(this.width,this.height,t,this)}apply(t){for(let e=0;e<this.height;e++)for(let i=0;i<this.width;i++){let n=(e*this.width+i)*this.channels;t.call(this,n)}}}!function(t){for(const e in xg)t.prototype[e]=xg[e]}(vw),function(t){for(const e in Ml)t.prototype[e]=Ml[e]}(vw),function(t){for(const e in vf)t.prototype[e]=vf[e]}(vw),vw.prototype.checkProcessable=function(t,e={}){let{bitDepth:i,alpha:n,colorModel:r,components:s,channels:o}=e;if("string"!=typeof t||0===t.length)throw new TypeError("processName must be a string");if(i&&(Array.isArray(i)||(i=[i]),!i.includes(this.bitDepth)))throw new TypeError(`The process: ${t} can only be applied if bit depth is in: ${i}`);if(n&&(Array.isArray(n)||(n=[n]),!n.includes(this.alpha)))throw new TypeError(`The process: ${t} can only be applied if alpha is in: ${n}`);if(r&&(Array.isArray(r)||(r=[r]),!r.includes(this.colorModel)))throw new TypeError(`The process: ${t} can only be applied if color model is in: ${r}`);if(s&&(Array.isArray(s)||(s=[s]),!s.includes(this.components))){let e=`The process: ${t} can only be applied if the number of components is in: ${s}`;throw 1===s.length&&1===s[0]?new TypeError(`${e}.\rYou should transform your image using "image.grey()" before applying the algorithm.`):new TypeError(e)}if(o&&(Array.isArray(o)||(o=[o]),!o.includes(this.channels)))throw new TypeError(`The process: ${t} can only be applied if the number of channels is in: ${o}`)},vw.prototype.getRGBAData=function(t={}){const{clamped:e}=t;this.checkProcessable("getRGBAData",{components:[1,3],bitDepth:[1,8,16,32]});const i=this.width*this.height*4;let n=e?new Uint8ClampedArray(i):new Uint8Array(i);return 1===this.bitDepth?function(t,e){for(let i=0;i<t.size;i++){const n=t.getBit(i);e[4*i]=255*n,e[4*i+1]=255*n,e[4*i+2]=255*n}}(this,n):32===this.bitDepth?(this.checkProcessable("getRGBAData",{alpha:0}),1===this.components?function(t,e){const i=t.min[0],n=t.max[0]-i;for(let r=0;r<t.size;r++){const s=Math.floor(255*(t.data[r]-i)/n);e[4*r]=s,e[4*r+1]=s,e[4*r+2]=s}}(this,n):3===this.components&&(this.checkProcessable("getRGBAData",{colorModel:[Sf]}),function(t,e){const i=Math.min(...t.min),n=Math.max(...t.max)-i;for(let r=0;r<t.size;r++){const s=Math.floor(255*(t.data[3*r]-i)/n),o=Math.floor(255*(t.data[3*r+1]-i)/n),a=Math.floor(255*(t.data[3*r+2]-i)/n);e[4*r]=s,e[4*r+1]=o,e[4*r+2]=a}}(this,n))):1===this.components?function(t,e){for(let i=0;i<t.size;i++)e[4*i]=t.data[i*t.channels]>>>t.bitDepth-8,e[4*i+1]=t.data[i*t.channels]>>>t.bitDepth-8,e[4*i+2]=t.data[i*t.channels]>>>t.bitDepth-8}(this,n):3===this.components&&(this.checkProcessable("getRGBAData",{colorModel:[Sf]}),function(t,e){for(let i=0;i<t.size;i++)e[4*i]=t.data[i*t.channels]>>>t.bitDepth-8,e[4*i+1]=t.data[i*t.channels+1]>>>t.bitDepth-8,e[4*i+2]=t.data[i*t.channels+2]>>>t.bitDepth-8}(this,n)),1===this.alpha?(this.checkProcessable("getRGBAData",{bitDepth:[8,16]}),function(t,e){for(let i=0;i<t.size;i++)e[4*i+3]=t.data[i*t.channels+t.components]>>t.bitDepth-8}(this,n)):function(t,e){for(let i=0;i<t.size;i++)e[4*i+3]=255}(this,n),n},vw.load=function(t,e){if("string"==typeof t)return function(t,e){const i=t.slice(0,64).match(_g);let n;return n=null!==i?Promise.resolve(function(t){let e,i,n,r,s=.75*t.length,o=t.length,a=0;"="===t[t.length-1]&&(s--,"="===t[t.length-2]&&s--);const h=new Uint8Array(s);for(let s=0;s<o;s+=4)e=ff[t.charCodeAt(s)],i=ff[t.charCodeAt(s+1)],n=ff[t.charCodeAt(s+2)],r=ff[t.charCodeAt(s+3)],h[a++]=e<<2|i>>4,h[a++]=(15&i)<<4|n>>2,h[a++]=(3&n)<<6|63&r;return h}(t.slice(i[0].length))):function(t,{withCredentials:e=!1}={}){return new Promise((function(i,n){let r=new self.XMLHttpRequest;r.open("GET",t,!0),r.responseType="arraybuffer",r.withCredentials=e,r.onload=function(t){200!==this.status?n(t):i(this.response)},r.onerror=n,r.send()}))}(t,e),n.then((n=>wg(new Uint8Array(n),i?t:void 0,e&&e.ignorePalette)))}(t,e);if(t instanceof ArrayBuffer)return Promise.resolve(wg(new Uint8Array(t),void 0,e&&e.ignorePalette));if(t.buffer)return Promise.resolve(wg(t,void 0,e&&e.ignorePalette));throw new Error('argument to "load" must be a string or buffer.')},vw.extendMethod=function(t,e,i={}){let{inPlace:n=!1,returnThis:r=!0,partialArgs:s=[]}=i;return vw.prototype[t]=n?function(...t){this.computed=null;let i=e.apply(this,[...s,...t]);return r?this:i}:function(...t){return e.apply(this,[...s,...t])},vw},vw.extendProperty=function(t,e,i={}){let{partialArgs:n=[]}=i;return Mf.get=function(){if(null===this.computed)this.computed={};else if(xf()(t,this.computed))return this.computed[t];let i=e.apply(this,n);return this.computed[t]=i,i},Object.defineProperty(vw.prototype,t,Mf),vw},function(t){let e={inPlace:!0};t.extendMethod("invert",Cg),t.extendMethod("abs",kg),t.extendMethod("level",sm,e),t.extendMethod("add",lm,e),t.extendMethod("subtract",cm,e),t.extendMethod("subtractImage",um),t.extendMethod("multiply",fm,e),t.extendMethod("divide",gm,e),t.extendMethod("hypotenuse",dm),t.extendMethod("background",bm),t.extendMethod("flipX",Ig),t.extendMethod("flipY",Ag),t.extendMethod("blurFilter",Tg),t.extendMethod("medianFilter",Lg),t.extendMethod("gaussianFilter",Og),t.extendMethod("sobelFilter",em),t.extendMethod("gradientFilter",tm),t.extendMethod("scharrFilter",im),t.extendMethod("dilate",xm),t.extendMethod("erode",Cm),t.extendMethod("open",Pm),t.extendMethod("close",Dm),t.extendMethod("topHat",Fm),t.extendMethod("blackHat",Lm),t.extendMethod("morphologicalGradient",Om),t.extendMethod("warpingFourPoints",Gm),t.extendMethod("crop",Ym),t.extendMethod("cropAlpha",Xm),t.extendMethod("resize",Zm).extendMethod("scale",Zm),t.extendMethod("hsv",Km),t.extendMethod("hsl",Hm),t.extendMethod("cmyk",$m),t.extendMethod("rgba8",Jm),t.extendMethod("grey",ep).extendMethod("gray",ep),t.extendMethod("mask",fp),t.extendMethod("pad",gp),t.extendMethod("colorDepth",mp),t.extendMethod("setBorder",xp,e),t.extendMethod("rotate",_p),t.extendMethod("rotateLeft",wp),t.extendMethod("rotateRight",yp),t.extendMethod("insert",bp),t.extendMethod("getRow",Pp),t.extendMethod("getColumn",Dp),t.extendMethod("getMatrix",Fp),t.extendMethod("setMatrix",Lp),t.extendMethod("getPixelsArray",Op),t.extendMethod("getIntersection",Np),t.extendMethod("getClosestCommonParent",zp),t.extendMethod("getThreshold",up),t.extendMethod("split",Mp),t.extendMethod("getChannel",Ep),t.extendMethod("combineChannels",Sp),t.extendMethod("setChannel",Cp),t.extendMethod("getSimilarity",Ip),t.extendMethod("getPixelsGrid",Ap),t.extendMethod("getBestMatch",Rp),t.extendMethod("cannyEdge",qp),t.extendMethod("convolution",Qg),t.extendMethod("extract",Wp),t.extendMethod("floodFill",Hp),t.extendMethod("paintLabels",s_,e),t.extendMethod("paintMasks",o_,e),t.extendMethod("paintPoints",u_,e),t.extendMethod("paintPolyline",d_,e),t.extendMethod("paintPolylines",f_,e),t.extendMethod("paintPolygon",g_,e),t.extendMethod("paintPolygons",__,e),t.extendMethod("countAlphaPixels",P_),t.extendMethod("monotoneChainConvexHull",O_),t.extendMethod("minimalBoundingRectangle",X_),t.extendMethod("getHistogram",w_).extendProperty("histogram",w_),t.extendMethod("getHistograms",y_).extendProperty("histograms",y_),t.extendMethod("getColorHistogram",b_).extendProperty("colorHistogram",b_),t.extendMethod("getMin",x_).extendProperty("min",x_),t.extendMethod("getMax",M_).extendProperty("max",M_),t.extendMethod("getSum",E_).extendProperty("sum",E_),t.extendMethod("getMoment",S_).extendProperty("moment",S_),t.extendMethod("getLocalMaxima",k_),t.extendMethod("getMedian",I_).extendProperty("median",I_),t.extendMethod("getMean",C_).extendProperty("mean",C_),t.extendMethod("getPoints",A_).extendProperty("points",A_),t.extendMethod("getExtendedPoints",T_).extendProperty("extendedPoints",T_),t.extendMethod("getRelativePosition",R_)}(vw);var bw=__webpack_require__(6732),xw=__webpack_require__.n(bw);const Mw={regression:{kernelType:"polynomial",kernelOptions:{degree:2,constant:1}},threshold:.02,roi:{minSurface:100,positive:!1},sampling:20,include:[]};function Ew(t,e,i){return t.post("data",[e,i]).then((function(t){for(let e in t)t[e]=new vw(t[e]);return t}))}const Sw={run:function(t,e,i){e=Object.assign({},Mw,e);const n=this.manager;return Array.isArray(t)?Promise.all(t.map((function(t){const r=Ew(n,t,e);return"function"==typeof i&&r.then(i),r}))):Ew(n,t,e)},work:function(){worker.on("data",(function(t,e,i){e=new IJS(e);const n={},r=[],s=e.grey(),o=s.sobelFilter();f("sobel",o);const a=o.level().mask({threshold:i.threshold});f("mask",a);const h=o.getRoiManager();h.fromMask(a);const l=h.getMask(i.roi);f("realMask",l);const c=s.getPixelsGrid({sampling:i.sampling,mask:l}),u=e.getBackground(c.xyS,c.zS,i.regression);f("background",u);const d=e.subtract(u);function f(t,e){i.include.includes(t)&&(n[t]=e,r.push(e.data.buffer))}n.result=d,r.push(d.data.buffer),t(n,r)}))}},kw=Sw;class Cw{constructor(){this._url=null,this._deps=[null]}checkUrl(){if(null===this._url)throw new Error("image worker must be initialized with an URL")}get url(){return this._url}set url(t){if("string"!=typeof t)throw new TypeError("worker URL must be a string");this._url=t,this._deps[0]=t}static extendMethod(t,e){let i,n,r={};function s(...t){return i||(this.checkUrl(),n=this.url,i=new(xw())(e.work,{deps:n}),r.manager=i),e.run.call(r,...t)}s.reset=function(){i&&(i.terminate(),i=new(xw())(e.work,{deps:n}),r.manager=i)},Cw.prototype[t]=s}}function Iw(t,e,i){let n=[],r=new ImageData(t.width,t.height),s=[Aw(e[0],e[1],e[2]),Tw(e[0],e[1],e[2]),Rw(e[0],e[1],e[2])];for(let e=0;e<t.data.length;e+=4){let o=t.data[e],a=t.data[e+1],h=t.data[e+2],l=[Aw(o,a,h),Tw(o,a,h),Rw(o,a,h)],c=Math.sqrt(.5053*Math.pow(l[0]-s[0],2)+.299*Math.pow(l[1]-s[1],2)+.1957*Math.pow(l[2]-s[2],2));n.push(c),Math.abs(c)===i&&(r.data[e]=255,r.data[e+3]=255)}return r}function Aw(t,e,i){return.29889531*t+.58662247*e+.11448223*i}function Tw(t,e,i){return.59597799*t-.2741761*e-.32180189*i}function Rw(t,e,i){return.21147017*t-.52261711*e+.31114694*i}function Pw(t,e,i,n){let r=t.contour,s=(t.color,{}),o=(n[2]-n[0])/e,a=(n[3]-n[1])/i;for(let t=0;t<r.length;t+=3){let e=r[t],i=r[t+1],n=r[t+2],o=[e,i,n];0===e&&0===i&&0===n||(o.toString()in s?s[o.toString()].push(t/3):s[o.toString()]=[t/3])}let h={type:"FeatureCollection",name:"polygonFeatures",crs:{type:"name",properties:{name:"EPSG:3857"}},features:[]};for(const t in s){let i=[];for(let n=0;n<s[t].length;n++){let r=s[t][n]%e,o=Math.floor(s[t][n]/e);i.push([r,o])}if(i.length<=3)continue;let r=Dw(i),l=[];for(let t=0;t<r.length;t++){let e=r[t][0],i=r[t][1];e=n[0]+e*o,i=n[3]-i*a,l.push([e,i])}h.features.push({type:"Feature",geometry:{type:"Polygon",coordinates:[l]},proprties:{prop:""}})}return h}function Dw(t){let e=t.slice(),i=[],n=e[0];i.push(n),e[0]=[NaN,NaN];let r=0,s=e.length-1,o=0;function a(t){return[[t[0]-1,t[1]-1],[t[0],t[1]-1],[t[0]+1,t[1]-1],[t[0]-1,t[1]],t,[t[0]+1,t[1]],[t[0]-1,t[1]+1],[t[0],t[1]+1],[t[0]+1,t[1]+1]]}for(let n=0;n<=i.length;n++){o++;let h=i.length,l=a(i[n]);t:for(let n=0;n<l.length;n++)for(let r=1;r<e.length&&4!==n;r++)if(l[n][0]===e[r][0]&&l[n][1]===e[r][1]&&NaN!=e[r][0]&&NaN!=e[r][1]){i.push(t[r]),e[r]=[NaN,NaN],s-=1;break t}if(i.length-h==0&&(i.pop(),n-=2,r+=1),o===e.length-1){console.log("breaked");break}}return i}!function(t){t.extendMethod("background",kw)}(Cw),new Cw;var Fw=__webpack_require__(9152);const Lw=class{constructor(t){this.highWaterMark=void 0!==t?t:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}canExpireCache(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark}expireCache(t){for(;this.canExpireCache();)this.pop()}clear(){this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}containsKey(t){return this.entries_.hasOwnProperty(t)}forEach(t){let e=this.oldest_;for(;e;)t(e.value_,e.key_,this),e=e.newer}get(t,e){const i=this.entries_[t];return K(void 0!==i,"Tried to get a value for a key that does not exist in the cache"),i===this.newest_||(i===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(i.newer.older=i.older,i.older.newer=i.newer),i.newer=null,i.older=this.newest_,this.newest_.newer=i,this.newest_=i),i.value_}remove(t){const e=this.entries_[t];return K(void 0!==e,"Tried to get a value for a key that does not exist in the cache"),e===this.newest_?(this.newest_=e.older,this.newest_&&(this.newest_.newer=null)):e===this.oldest_?(this.oldest_=e.newer,this.oldest_&&(this.oldest_.older=null)):(e.newer.older=e.older,e.older.newer=e.newer),delete this.entries_[t],--this.count_,e.value_}getCount(){return this.count_}getKeys(){const t=new Array(this.count_);let e,i=0;for(e=this.newest_;e;e=e.older)t[i++]=e.key_;return t}getValues(){const t=new Array(this.count_);let e,i=0;for(e=this.newest_;e;e=e.older)t[i++]=e.value_;return t}peekLast(){return this.oldest_.value_}peekLastKey(){return this.oldest_.key_}peekFirstKey(){return this.newest_.key_}peek(t){return this.entries_[t]?.value_}pop(){const t=this.oldest_;return delete this.entries_[t.key_],t.newer&&(t.newer.older=null),this.oldest_=t.newer,this.oldest_||(this.newest_=null),--this.count_,t.value_}replace(t,e){this.get(t),this.entries_[t].value_=e}set(t,e){K(!(t in this.entries_),"Tried to set a value for a key that is used already");const i={key_:t,newer:null,older:this.newest_,value_:e};this.newest_?this.newest_.newer=i:this.oldest_=i,this.newest_=i,this.entries_[t]=i,++this.count_}setSize(t){this.highWaterMark=t}};function Ow(t,e,i,n){return void 0!==n?(n[0]=t,n[1]=e,n[2]=i,n):[t,e,i]}function Nw(t,e,i){return t+"/"+e+"/"+i}function Bw(t){return Nw(t[0],t[1],t[2])}function zw(t){return(t[1]<<t[0])+t[2]}const Uw=class extends Lw{clear(){for(;this.getCount()>0;)this.pop().release();super.clear()}expireCache(t){for(;this.canExpireCache()&&!(this.peekLast().getKey()in t);)this.pop().release()}pruneExceptNewestZ(){if(0===this.getCount())return;const t=this.peekFirstKey().split("/").map(Number)[0];this.forEach((e=>{e.tileCoord[0]!==t&&(this.remove(Bw(e.tileCoord)),e.release())}))}};function Gw(t){return t?Array.isArray(t)?function(e){return t}:"function"==typeof t?t:function(e){return[t]}:null}const Yw=class extends L{constructor(t){super(),this.projection=si(t.projection),this.attributions_=Gw(t.attributions),this.attributionsCollapsible_=void 0===t.attributionsCollapsible||t.attributionsCollapsible,this.loading=!1,this.state_=void 0!==t.state?t.state:"ready",this.wrapX_=void 0!==t.wrapX&&t.wrapX,this.interpolate_=!!t.interpolate,this.viewResolver=null,this.viewRejector=null;const e=this;this.viewPromise_=new Promise((function(t,i){e.viewResolver=t,e.viewRejector=i}))}getAttributions(){return this.attributions_}getAttributionsCollapsible(){return this.attributionsCollapsible_}getProjection(){return this.projection}getResolutions(t){return null}getView(){return this.viewPromise_}getState(){return this.state_}getWrapX(){return this.wrapX_}getInterpolate(){return this.interpolate_}refresh(){this.changed()}setAttributions(t){this.attributions_=Gw(t),this.changed()}setState(t){this.state_=t,this.changed()}},Xw=[0,0,0],Vw=class{constructor(t){let e;if(this.minZoom=void 0!==t.minZoom?t.minZoom:0,this.resolutions_=t.resolutions,K(function(t,e,i){const n=((t,e)=>e-t)||a;return t.every((function(e,i){if(0===i)return!0;const r=n(t[i-1],e);return!(r>0||0===r)}))}(this.resolutions_),"`resolutions` must be sorted in descending order"),!t.origins)for(let t=0,i=this.resolutions_.length-1;t<i;++t)if(e){if(this.resolutions_[t]/this.resolutions_[t+1]!==e){e=void 0;break}}else e=this.resolutions_[t]/this.resolutions_[t+1];this.zoomFactor_=e,this.maxZoom=this.resolutions_.length-1,this.origin_=void 0!==t.origin?t.origin:null,this.origins_=null,void 0!==t.origins&&(this.origins_=t.origins,K(this.origins_.length==this.resolutions_.length,"Number of `origins` and `resolutions` must be equal"));const i=t.extent;void 0===i||this.origin_||this.origins_||(this.origin_=At(i)),K(!this.origin_&&this.origins_||this.origin_&&!this.origins_,"Either `origin` or `origins` must be configured, never both"),this.tileSizes_=null,void 0!==t.tileSizes&&(this.tileSizes_=t.tileSizes,K(this.tileSizes_.length==this.resolutions_.length,"Number of `tileSizes` and `resolutions` must be equal")),this.tileSize_=void 0!==t.tileSize?t.tileSize:this.tileSizes_?null:Te,K(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,"Either `tileSize` or `tileSizes` must be configured, never both"),this.extent_=void 0!==i?i:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],void 0!==t.sizes?this.fullTileRanges_=t.sizes.map(((t,e)=>{const n=new Ns(Math.min(0,t[0]),Math.max(t[0]-1,-1),Math.min(0,t[1]),Math.max(t[1]-1,-1));if(i){const t=this.getTileRangeForExtentAndZ(i,e);n.minX=Math.max(t.minX,n.minX),n.maxX=Math.min(t.maxX,n.maxX),n.minY=Math.max(t.minY,n.minY),n.maxY=Math.min(t.maxY,n.maxY)}return n})):i&&this.calculateTileRanges_(i)}forEachTileCoord(t,e,i){const n=this.getTileRangeForExtentAndZ(t,e);for(let t=n.minX,r=n.maxX;t<=r;++t)for(let r=n.minY,s=n.maxY;r<=s;++r)i([e,t,r])}forEachTileCoordParentTileRange(t,e,i,n){let r,s,o,a=null,h=t[0]-1;for(2===this.zoomFactor_?(s=t[1],o=t[2]):a=this.getTileCoordExtent(t,n);h>=this.minZoom;){if(void 0!==s&&void 0!==o?(s=Math.floor(s/2),o=Math.floor(o/2),r=Os(s,s,o,o,i)):r=this.getTileRangeForExtentAndZ(a,h,i),e(h,r))return!0;--h}return!1}getExtent(){return this.extent_}getMaxZoom(){return this.maxZoom}getMinZoom(){return this.minZoom}getOrigin(t){return this.origin_?this.origin_:this.origins_[t]}getResolution(t){return this.resolutions_[t]}getResolutions(){return this.resolutions_}getTileCoordChildTileRange(t,e,i){if(t[0]<this.maxZoom){if(2===this.zoomFactor_){const i=2*t[1],n=2*t[2];return Os(i,i+1,n,n+1,e)}const n=this.getTileCoordExtent(t,i||this.tmpExtent_);return this.getTileRangeForExtentAndZ(n,t[0]+1,e)}return null}getTileRangeForTileCoordAndZ(t,e,i){if(e>this.maxZoom||e<this.minZoom)return null;const n=t[0],r=t[1],s=t[2];if(e===n)return Os(r,s,r,s,i);if(this.zoomFactor_){const t=Math.pow(this.zoomFactor_,e-n),o=Math.floor(r*t),a=Math.floor(s*t);return e<n?Os(o,o,a,a,i):Os(o,Math.floor(t*(r+1))-1,a,Math.floor(t*(s+1))-1,i)}const o=this.getTileCoordExtent(t,this.tmpExtent_);return this.getTileRangeForExtentAndZ(o,e,i)}getTileRangeForExtentAndZ(t,e,i){this.getTileCoordForXYAndZ_(t[0],t[3],e,!1,Xw);const n=Xw[1],r=Xw[2];return this.getTileCoordForXYAndZ_(t[2],t[1],e,!0,Xw),Os(n,Xw[1],r,Xw[2],i)}getTileCoordCenter(t){const e=this.getOrigin(t[0]),i=this.getResolution(t[0]),n=ms(this.getTileSize(t[0]),this.tmpSize_);return[e[0]+(t[1]+.5)*n[0]*i,e[1]-(t[2]+.5)*n[1]*i]}getTileCoordExtent(t,e){const i=this.getOrigin(t[0]),n=this.getResolution(t[0]),r=ms(this.getTileSize(t[0]),this.tmpSize_),s=i[0]+t[1]*r[0]*n,o=i[1]-(t[2]+1)*r[1]*n;return ct(s,o,s+r[0]*n,o+r[1]*n,e)}getTileCoordForCoordAndResolution(t,e,i){return this.getTileCoordForXYAndResolution_(t[0],t[1],e,!1,i)}getTileCoordForXYAndResolution_(t,e,i,n,r){const s=this.getZForResolution(i),o=i/this.getResolution(s),a=this.getOrigin(s),h=ms(this.getTileSize(s),this.tmpSize_);let l=o*(t-a[0])/i/h[0],c=o*(a[1]-e)/i/h[1];return n?(l=ee(l,5)-1,c=ee(c,5)-1):(l=te(l,5),c=te(c,5)),Ow(s,l,c,r)}getTileCoordForXYAndZ_(t,e,i,n,r){const s=this.getOrigin(i),o=this.getResolution(i),a=ms(this.getTileSize(i),this.tmpSize_);let h=(t-s[0])/o/a[0],l=(s[1]-e)/o/a[1];return n?(h=ee(h,5)-1,l=ee(l,5)-1):(h=te(h,5),l=te(l,5)),Ow(i,h,l,r)}getTileCoordForCoordAndZ(t,e,i){return this.getTileCoordForXYAndZ_(t[0],t[1],e,!1,i)}getTileCoordResolution(t){return this.resolutions_[t[0]]}getTileSize(t){return this.tileSize_?this.tileSize_:this.tileSizes_[t]}getFullTileRange(t){return this.fullTileRanges_?this.fullTileRanges_[t]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,t):null}getZForResolution(t,e){return qt(h(this.resolutions_,t,e||0),this.minZoom,this.maxZoom)}tileCoordIntersectsViewport(t,e){return _n(e,0,e.length,2,this.getTileCoordExtent(t))}calculateTileRanges_(t){const e=this.resolutions_.length,i=new Array(e);for(let n=this.minZoom;n<e;++n)i[n]=this.getTileRangeForExtentAndZ(t,n);this.fullTileRanges_=i}};function jw(t){let e=t.getDefaultTileGrid();return e||(e=function(t,e,i,n){return function(t,e,i,n){n=void 0!==n?n:"top-left";const r=Ww(t,undefined,i);return new Vw({extent:t,origin:Et(t,n),resolutions:r,tileSize:i})}(Zw(t),0,void 0,void 0)}(t),t.setDefaultTileGrid(e)),e}function qw(t){const e=t||{},i=e.extent||si("EPSG:3857").getExtent(),n={extent:i,minZoom:e.minZoom,tileSize:e.tileSize,resolutions:Ww(i,e.maxZoom,e.tileSize,e.maxResolution)};return new Vw(n)}function Ww(t,e,i,n){e=void 0!==e?e:Ae,i=ms(void 0!==i?i:Te);const r=Ct(t),s=Rt(t);n=n>0?n:Math.max(s/i[0],r/i[1]);const o=e+1,a=new Array(o);for(let t=0;t<o;++t)a[t]=n/Math.pow(2,t);return a}function Zw(t){let e=(t=si(t)).getExtent();if(!e){const i=180*Re.degrees/t.getMetersPerUnit();e=ct(-i,-i,i,i)}return e}class Kw extends r{constructor(t,e){super(t),this.tile=e}}const Hw=class extends Yw{constructor(t){super({attributions:t.attributions,attributionsCollapsible:t.attributionsCollapsible,projection:t.projection,state:t.state,wrapX:t.wrapX,interpolate:t.interpolate}),this.on,this.once,this.un,this.opaque_=void 0!==t.opaque&&t.opaque,this.tilePixelRatio_=void 0!==t.tilePixelRatio?t.tilePixelRatio:1,this.tileGrid=void 0!==t.tileGrid?t.tileGrid:null;this.tileGrid&&ms(this.tileGrid.getTileSize(this.tileGrid.getMinZoom()),[256,256]),this.tileCache=new Uw(t.cacheSize||0),this.tmpSize=[0,0],this.key_=t.key||"",this.tileOptions={transition:t.transition,interpolate:t.interpolate},this.zDirection=t.zDirection?t.zDirection:0}canExpireCache(){return this.tileCache.canExpireCache()}expireCache(t,e){const i=this.getTileCacheForProjection(t);i&&i.expireCache(e)}forEachLoadedTile(t,e,i,n){const r=this.getTileCacheForProjection(t);if(!r)return!1;let s,o,a,h=!0;for(let t=i.minX;t<=i.maxX;++t)for(let l=i.minY;l<=i.maxY;++l)o=Nw(e,t,l),a=!1,r.containsKey(o)&&(s=r.get(o),a=2===s.getState(),a&&(a=!1!==n(s))),a||(h=!1);return h}getGutterForProjection(t){return 0}getKey(){return this.key_}setKey(t){this.key_!==t&&(this.key_=t,this.changed())}getOpaque(t){return this.opaque_}getResolutions(t){const e=t?this.getTileGridForProjection(t):this.tileGrid;return e?e.getResolutions():null}getTile(t,e,i,n,r){return R()}getTileGrid(){return this.tileGrid}getTileGridForProjection(t){return this.tileGrid?this.tileGrid:jw(t)}getTileCacheForProjection(t){const e=this.getProjection();return K(null===e||li(e,t),"A VectorTile source can only be rendered if it has a projection compatible with the view projection."),this.tileCache}getTilePixelRatio(t){return this.tilePixelRatio_}getTilePixelSize(t,e,i){const n=this.getTileGridForProjection(i),r=this.getTilePixelRatio(e),s=ms(n.getTileSize(t),this.tmpSize);return 1==r?s:gs(s,r,this.tmpSize)}getTileCoordForTileUrlFunction(t,e){e=void 0!==e?e:this.getProjection();const i=this.getTileGridForProjection(e);return this.getWrapX()&&e.isGlobal()&&(t=function(t,e,i){const n=e[0],r=t.getTileCoordCenter(e),s=Zw(i);if(!ot(s,r)){const e=Rt(s),i=Math.ceil((s[0]-r[0])/e);return r[0]+=e*i,t.getTileCoordForCoordAndZ(r,n)}return e}(i,t,e)),function(t,e){const i=t[0],n=t[1],r=t[2];if(e.getMinZoom()>i||i>e.getMaxZoom())return!1;const s=e.getFullTileRange(i);return!s||s.containsXY(n,r)}(t,i)?t:null}clear(){this.tileCache.clear()}refresh(){this.clear(),super.refresh()}updateCacheSize(t,e){const i=this.getTileCacheForProjection(e);t>i.highWaterMark&&(i.highWaterMark=t)}useTile(t,e,i,n){}};function $w(t,e){const i=/\{z\}/g,n=/\{x\}/g,r=/\{y\}/g,s=/\{-y\}/g;return function(o,a,h){if(o)return t.replace(i,o[0].toString()).replace(n,o[1].toString()).replace(r,o[2].toString()).replace(s,(function(){const t=o[0],i=e.getFullTileRange(t);if(!i)throw new Error("The {-y} placeholder requires a tile grid with extent");return(i.getHeight()-o[2]-1).toString()}))}}function Jw(t){return 1===t.length?t[0]:function(e,i,n){if(!e)return;const r=Ht(zw(e),t.length);return t[r](e,i,n)}}class Qw extends Hw{constructor(t){super({attributions:t.attributions,cacheSize:t.cacheSize,opaque:t.opaque,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tilePixelRatio:t.tilePixelRatio,wrapX:t.wrapX,transition:t.transition,interpolate:t.interpolate,key:t.key,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection}),this.generateTileUrlFunction_=this.tileUrlFunction===Qw.prototype.tileUrlFunction,this.tileLoadFunction=t.tileLoadFunction,t.tileUrlFunction&&(this.tileUrlFunction=t.tileUrlFunction),this.urls=null,t.urls?this.setUrls(t.urls):t.url&&this.setUrl(t.url),this.tileLoadingKeys_={}}getTileLoadFunction(){return this.tileLoadFunction}getTileUrlFunction(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction}getUrls(){return this.urls}handleTileChange(t){const e=t.target,i=D(e),n=e.getState();let r;1==n?(this.tileLoadingKeys_[i]=!0,r="tileloadstart"):i in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[i],r=3==n?"tileloaderror":2==n?"tileloadend":void 0),null!=r&&this.dispatchEvent(new Kw(r,e))}setTileLoadFunction(t){this.tileCache.clear(),this.tileLoadFunction=t,this.changed()}setTileUrlFunction(t,e){this.tileUrlFunction=t,this.tileCache.pruneExceptNewestZ(),void 0!==e?this.setKey(e):this.changed()}setUrl(t){const e=function(t){const e=[];let i=/\{([a-z])-([a-z])\}/.exec(t);if(i){const n=i[1].charCodeAt(0),r=i[2].charCodeAt(0);let s;for(s=n;s<=r;++s)e.push(t.replace(i[0],String.fromCharCode(s)));return e}if(i=/\{(\d+)-(\d+)\}/.exec(t),i){const n=parseInt(i[2],10);for(let r=parseInt(i[1],10);r<=n;r++)e.push(t.replace(i[0],r.toString()));return e}return e.push(t),e}(t);this.urls=e,this.setUrls(e)}setUrls(t){this.urls=t;const e=t.join("\n");this.generateTileUrlFunction_?this.setTileUrlFunction(function(t,e){const i=t.length,n=new Array(i);for(let r=0;r<i;++r)n[r]=$w(t[r],e);return Jw(n)}(t,this.tileGrid),e):this.setKey(e)}tileUrlFunction(t,e,i){}useTile(t,e,i){const n=Nw(t,e,i);this.tileCache.containsKey(n)&&this.tileCache.get(n)}}const ty=Qw;function ey(t,e){t.getImage().src=e}const iy=class extends ty{constructor(t){super({attributions:t.attributions,cacheSize:t.cacheSize,opaque:t.opaque,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tileLoadFunction:t.tileLoadFunction?t.tileLoadFunction:ey,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:t.wrapX,transition:t.transition,interpolate:void 0===t.interpolate||t.interpolate,key:t.key,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection}),this.crossOrigin=void 0!==t.crossOrigin?t.crossOrigin:null,this.tileClass=void 0!==t.tileClass?t.tileClass:Cs,this.tileCacheForProjection={},this.tileGridForProjection={},this.reprojectionErrorThreshold_=t.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1}canExpireCache(){if(this.tileCache.canExpireCache())return!0;for(const t in this.tileCacheForProjection)if(this.tileCacheForProjection[t].canExpireCache())return!0;return!1}expireCache(t,e){const i=this.getTileCacheForProjection(t);this.tileCache.expireCache(this.tileCache==i?e:{});for(const t in this.tileCacheForProjection){const n=this.tileCacheForProjection[t];n.expireCache(n==i?e:{})}}getGutterForProjection(t){return this.getProjection()&&t&&!li(this.getProjection(),t)?0:this.getGutter()}getGutter(){return 0}getKey(){let t=super.getKey();return this.getInterpolate()||(t+=":disable-interpolation"),t}getOpaque(t){return!(this.getProjection()&&t&&!li(this.getProjection(),t))&&super.getOpaque(t)}getTileGridForProjection(t){const e=this.getProjection();if(this.tileGrid&&(!e||li(e,t)))return this.tileGrid;const i=D(t);return i in this.tileGridForProjection||(this.tileGridForProjection[i]=jw(t)),this.tileGridForProjection[i]}getTileCacheForProjection(t){const e=this.getProjection();if(!e||li(e,t))return this.tileCache;const i=D(t);return i in this.tileCacheForProjection||(this.tileCacheForProjection[i]=new Uw(this.tileCache.highWaterMark)),this.tileCacheForProjection[i]}createTile_(t,e,i,n,r,s){const o=[t,e,i],a=this.getTileCoordForTileUrlFunction(o,r),h=a?this.tileUrlFunction(a,n,r):void 0,l=new this.tileClass(o,void 0!==h?0:4,void 0!==h?h:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return l.key=s,l.addEventListener(y,this.handleTileChange.bind(this)),l}getTile(t,e,i,n,r){const s=this.getProjection();if(!s||!r||li(s,r))return this.getTileInternal(t,e,i,n,s||r);const o=this.getTileCacheForProjection(r),a=[t,e,i];let h;const l=Bw(a);o.containsKey(l)&&(h=o.get(l));const c=this.getKey();if(h&&h.key==c)return h;const u=this.getTileGridForProjection(s),d=this.getTileGridForProjection(r),f=this.getTileCoordForTileUrlFunction(a,r),g=new Fs(s,u,r,d,a,f,this.getTilePixelRatio(n),this.getGutter(),((t,e,i,n)=>this.getTileInternal(t,e,i,n,s)),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.tileOptions);return g.key=c,h?(g.interimTile=h,g.refreshInterimChain(),o.replace(l,g)):o.set(l,g),g}getTileInternal(t,e,i,n,r){let s=null;const o=Nw(t,e,i),a=this.getKey();if(this.tileCache.containsKey(o)){if(s=this.tileCache.get(o),s.key!=a){const h=s;s=this.createTile_(t,e,i,n,r,a),0==h.getState()?s.interimTile=h.interimTile:s.interimTile=h,s.refreshInterimChain(),this.tileCache.replace(o,s)}}else s=this.createTile_(t,e,i,n,r,a),this.tileCache.set(o,s);return s}setRenderReprojectionEdges(t){if(this.renderReprojectionEdges_!=t){this.renderReprojectionEdges_=t;for(const t in this.tileCacheForProjection)this.tileCacheForProjection[t].clear();this.changed()}}setTileGridForProjection(t,e){const i=si(t);if(i){const t=D(i);t in this.tileGridForProjection||(this.tileGridForProjection[t]=e)}}clear(){super.clear();for(const t in this.tileCacheForProjection)this.tileCacheForProjection[t].clear()}},ny=class extends iy{constructor(t){const e=void 0!==(t=t||{}).projection?t.projection:"EPSG:3857",i=void 0!==t.tileGrid?t.tileGrid:qw({extent:Zw(e),maxResolution:t.maxResolution,maxZoom:t.maxZoom,minZoom:t.minZoom,tileSize:t.tileSize});super({attributions:t.attributions,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,interpolate:t.interpolate,opaque:t.opaque,projection:e,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileGrid:i,tileLoadFunction:t.tileLoadFunction,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:void 0===t.wrapX||t.wrapX,transition:t.transition,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection}),this.gutter_=void 0!==t.gutter?t.gutter:0}getGutter(){return this.gutter_}},ry=class extends ny{constructor(t){let e;e=void 0!==(t=t||{}).attributions?t.attributions:['&#169; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors.'];const i=void 0!==t.crossOrigin?t.crossOrigin:"anonymous",n=void 0!==t.url?t.url:"https://tile.openstreetmap.org/{z}/{x}/{y}.png";super({attributions:e,attributionsCollapsible:!1,cacheSize:t.cacheSize,crossOrigin:i,interpolate:t.interpolate,maxZoom:void 0!==t.maxZoom?t.maxZoom:19,opaque:void 0===t.opaque||t.opaque,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileLoadFunction:t.tileLoadFunction,transition:t.transition,url:n,wrapX:t.wrapX,zDirection:t.zDirection})}},sy=class extends iy{constructor(t){const e=void 0!==t.hidpi&&t.hidpi;super({cacheSize:t.cacheSize,crossOrigin:"anonymous",interpolate:t.interpolate,opaque:!0,projection:si("EPSG:3857"),reprojectionErrorThreshold:t.reprojectionErrorThreshold,state:"loading",tileLoadFunction:t.tileLoadFunction,tilePixelRatio:e?2:1,wrapX:void 0===t.wrapX||t.wrapX,transition:t.transition,zDirection:t.zDirection}),this.hidpi_=e,this.culture_=void 0!==t.culture?t.culture:"en-us",this.maxZoom_=void 0!==t.maxZoom?t.maxZoom:-1,this.apiKey_=t.key,this.imagerySet_=t.imagerySet,this.placeholderTiles_=t.placeholderTiles;const i="https://dev.virtualearth.net/REST/v1/Imagery/Metadata/"+this.imagerySet_+"?uriScheme=https&include=ImageryProviders&key="+this.apiKey_+"&c="+this.culture_;fetch(i).then((t=>t.json())).then((t=>this.handleImageryMetadataResponse(t)))}getApiKey(){return this.apiKey_}getImagerySet(){return this.imagerySet_}handleImageryMetadataResponse(t){if(200!=t.statusCode||"OK"!=t.statusDescription||"ValidCredentials"!=t.authenticationResultCode||1!=t.resourceSets.length||1!=t.resourceSets[0].resources.length)return void this.setState("error");const e=t.resourceSets[0].resources[0],i=-1==this.maxZoom_?e.zoomMax:this.maxZoom_,n=Zw(this.getProjection()),r=this.hidpi_?2:1,s=e.imageWidth==e.imageHeight?e.imageWidth/r:[e.imageWidth/r,e.imageHeight/r],o=qw({extent:n,minZoom:e.zoomMin,maxZoom:i,tileSize:s});this.tileGrid=o;const a=this.culture_,h=this.hidpi_,l=this.placeholderTiles_;if(this.tileUrlFunction=Jw(e.imageUrlSubdomains.map((function(t){const i=[0,0,0],n=e.imageUrl.replace("{subdomain}",t).replace("{culture}",a);return function(t,e,r){if(!t)return;Ow(t[0],t[1],t[2],i);const s=new URL(n.replace("{quadkey}",function(t){const e=t[0],i=new Array(e);let n,r,s=1<<e-1;for(n=0;n<e;++n)r=48,t[1]&s&&(r+=1),t[2]&s&&(r+=2),i[n]=String.fromCharCode(r),s>>=1;return i.join("")}(i))),o=s.searchParams;return h&&(o.set("dpi","d1"),o.set("device","mobile")),!0===l?o.delete("n"):!1===l&&o.set("n","z"),s.toString()}}))),e.imageryProviders){const t=ci(si("EPSG:4326"),this.getProjection());this.setAttributions((i=>{const n=[],r=i.viewState,s=this.getTileGrid(),o=s.getZForResolution(r.resolution,this.zDirection),a=s.getTileCoordForCoordAndZ(r.center,o)[0];return e.imageryProviders.map((function(e){let r=!1;const s=e.coverageAreas;for(let e=0,n=s.length;e<n;++e){const n=s[e];if(a>=n.zoomMin&&a<=n.zoomMax){const e=n.bbox;if(Pt(Ft([e[1],e[0],e[3],e[2]],t),i.extent)){r=!0;break}}}r&&n.push(e.attribution)})),n.push('<a class="ol-attribution-bing-tos" href="https://www.microsoft.com/maps/product/terms.html" target="_blank">Terms of Use</a>'),n}))}this.setState("ready")}};const oy=class extends iy{constructor(t){super({attributions:(t=t||{}).attributions,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,interpolate:t.interpolate,projection:t.projection,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileGrid:t.tileGrid,tileLoadFunction:t.tileLoadFunction,url:t.url,urls:t.urls,wrapX:void 0===t.wrapX||t.wrapX,transition:t.transition,zDirection:t.zDirection}),this.params_=t.params||{},this.hidpi_=void 0===t.hidpi||t.hidpi,this.tmpExtent_=[1/0,1/0,-1/0,-1/0],this.setKey(this.getKeyForParams_())}getKeyForParams_(){let t=0;const e=[];for(const i in this.params_)e[t++]=i+"-"+this.params_[i];return e.join("/")}getParams(){return this.params_}getRequestUrl_(t,e,i,n,r,s){const o=this.urls;if(!o)return;let a;return a=1==o.length?o[0]:o[Ht(zw(t),o.length)],function(t,e,i,n,r,s){const o=r.getCode().split(/:(?=\d+$)/).pop(),a=i/n,h=[Qt(Rt(e)/a,4),Qt(Ct(e)/a,4)];s.SIZE=h[0]+","+h[1],s.BBOX=e.join(","),s.BBOXSR=o,s.IMAGESR=o,s.DPI=Math.round(s.DPI?s.DPI*n:90*n);const l=t.replace(/MapServer\/?$/,"MapServer/export").replace(/ImageServer\/?$/,"ImageServer/exportImage");if(l==t)throw new Error("`options.featureTypes` should be an Array");return function(t,e){const i=[];Object.keys(e).forEach((function(t){null!==e[t]&&void 0!==e[t]&&i.push(t+"="+encodeURIComponent(e[t]))}));const n=i.join("&");return t=t.replace(/[?&]$/,""),(t+=t.includes("?")?"&":"?")+n}(l,s)}(a,i,(this.tileGrid||this.getTileGridForProjection(r)).getResolution(t[0]),n,r,s)}getTilePixelRatio(t){return this.hidpi_?t:1}updateParams(t){Object.assign(this.params_,t),this.setKey(this.getKeyForParams_())}tileUrlFunction(t,e,i){let n=this.getTileGrid();if(n||(n=this.getTileGridForProjection(i)),n.getResolutions().length<=t[0])return;1==e||this.hidpi_||(e=1);const r=n.getTileCoordExtent(t,this.tmpExtent_);let s=ms(n.getTileSize(t[0]),this.tmpSize);1!=e&&(s=gs(s,e,this.tmpSize));const o={F:"image",FORMAT:"PNG32",TRANSPARENT:!0};return Object.assign(o,this.params_),this.getRequestUrl_(t,s,r,e,i,o)}},ay=class{constructor(){this.apikeys={BingMapKey:"AoTrgwP6rdBDsqtY-wq-Z5aA31YHoSzOyKStmu8t0-ZLUbO2LS4PbYoNYNe2SPSx",ArcGISKey:"AAPK3890bdd7605a4e3d9adb68f5790780eczWSlc-Uyepn0n8XMnNwNaiymNVrEy4ihJruVsf2PVK_lD086faryQVtQkssjkq84"}}getKeys(){return this.apikeys}};async function hy(t,e,i){t.once("rendercomplete",(function(){const n=t.getSize();e.width=n[0],e.height=n[1];const r=i;Array.prototype.forEach.call(t.getViewport().querySelectorAll(".ol-layer canvas, canvas.ol-layer"),(function(t){if(t.width>0){const e=t.parentNode.style.opacity||t.style.opacity;let i;r.globalAlpha=""===e?1:Number(e);const n=t.style.transform;i=n?n.match(/^matrix\(([^\(]*)\)$/)[1].split(",").map(Number):[parseFloat(t.style.width)/t.width,0,0,parseFloat(t.style.height)/t.height,0,0],CanvasRenderingContext2D.prototype.setTransform.apply(r,i);const s=t.parentNode.style.backgroundColor;s&&(r.fillStyle=s,r.fillRect(0,0,t.width,t.height)),r.drawImage(t,0,0)}})),r.globalAlpha=1,r.setTransform(1,0,0,1,0,0)})),t.renderSync()}let ly={contourKernelSize:3,contourIterations:3,erodeKernelSize:3,erodeIterations:3,saveDefaults:()=>{sessionStorage.setItem("CONTOUR_KERNEL",ly.contourKernelSize),sessionStorage.setItem("CONTOUR_ITER",ly.contourIterations),sessionStorage.setItem("ERODE_KERNEL",ly.erodeKernelSize),sessionStorage.setItem("ERODE_ITER",ly.erodeIterations)}};const cy=ly;function uy(t,e){let i=document.createElement("div"),n=document.createElement("p");n.className="p",n.textContent=t;let r=document.createElement("input");r.style.marginLeft="10px",r.style.marginBottom="10px",r.className="input",r.value=e,r.addEventListener("change",(t=>{console.log(r.value)}));let s=r.value;return i.append(n,r),[i,s]}function dy(t){for(;t.firstChild;)t.removeChild(t.firstChild)}function fy(t,e){let i=Math.floor(e/2),n=[];for(let e=t[0]-i;e<=t[0]+i;e++)for(let r=t[1]-i;r<=t[1]+i;r++)n.push([e,r]);return n}function gy(t){let e=t/2,i=[],n=Math.floor(e);for(let e=0;e<t;e++){let e=[];for(let i=0;i<t;i++)e.push(0);i.push(e)}for(let r=0;r<t;r++)for(let s=0;s<t;s++){let o,a=n-r,h=n-s,l=Math.sqrt(Math.pow(a,2)+Math.pow(h,2)),c=n-1;if(Math.sqrt(Math.pow(c,2)+Math.pow(c,2)),l<=e&&0===r|r===t-1)i[r][s]=1;else if(l<=e){i[r][s]=1,o=s,i[r][t-1-o]=1;break}}return i}class my extends L{constructor(t){if(super(),this.on,this.once,this.un,this.id_=void 0,this.geometryName_="geometry",this.style_=null,this.styleFunction_=void 0,this.geometryChangeKey_=null,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),t)if("function"==typeof t.getSimplifiedGeometry){const e=t;this.setGeometry(e)}else{const e=t;this.setProperties(e)}}clone(){const t=new my(this.hasProperties()?this.getProperties():null);t.setGeometryName(this.getGeometryName());const e=this.getGeometry();e&&t.setGeometry(e.clone());const i=this.getStyle();return i&&t.setStyle(i),t}getGeometry(){return this.get(this.geometryName_)}getId(){return this.id_}getGeometryName(){return this.geometryName_}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}handleGeometryChange_(){this.changed()}handleGeometryChanged_(){this.geometryChangeKey_&&(I(this.geometryChangeKey_),this.geometryChangeKey_=null);const t=this.getGeometry();t&&(this.geometryChangeKey_=k(t,y,this.handleGeometryChange_,this)),this.changed()}setGeometry(t){this.set(this.geometryName_,t)}setStyle(t){this.style_=t,this.styleFunction_=t?function(t){if("function"==typeof t)return t;let e;return Array.isArray(t)?e=t:(K("function"==typeof t.getZIndex,"Expected an `ol/style/Style` or an array of `ol/style/Style.js`"),e=[t]),function(){return e}}(t):void 0,this.changed()}setId(t){this.id_=t,this.changed()}setGeometryName(t){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_),this.geometryName_=t,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),this.handleGeometryChanged_()}}const py=my;var _y=__webpack_require__(2582);class wy{constructor(t){this.opacity_=t.opacity,this.rotateWithView_=t.rotateWithView,this.rotation_=t.rotation,this.scale_=t.scale,this.scaleArray_=ms(t.scale),this.displacement_=t.displacement,this.declutterMode_=t.declutterMode}clone(){const t=this.getScale();return new wy({opacity:this.getOpacity(),scale:Array.isArray(t)?t.slice():t,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getOpacity(){return this.opacity_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getDisplacement(){return this.displacement_}getDeclutterMode(){return this.declutterMode_}getAnchor(){return R()}getImage(t){return R()}getHitDetectionImage(){return R()}getPixelRatio(t){return 1}getImageState(){return R()}getImageSize(){return R()}getOrigin(){return R()}getSize(){return R()}setDisplacement(t){this.displacement_=t}setOpacity(t){this.opacity_=t}setRotateWithView(t){this.rotateWithView_=t}setRotation(t){this.rotation_=t}setScale(t){this.scale_=t,this.scaleArray_=ms(t)}listenImageChange(t){R()}load(){R()}unlistenImageChange(t){R()}}const yy=wy;function vy(t){return Array.isArray(t)?ue(t):t}class by extends yy{constructor(t){super({opacity:1,rotateWithView:void 0!==t.rotateWithView&&t.rotateWithView,rotation:void 0!==t.rotation?t.rotation:0,scale:void 0!==t.scale?t.scale:1,displacement:void 0!==t.displacement?t.displacement:[0,0],declutterMode:t.declutterMode}),this.canvases_,this.hitDetectionCanvas_=null,this.fill_=void 0!==t.fill?t.fill:null,this.origin_=[0,0],this.points_=t.points,this.radius_=void 0!==t.radius?t.radius:t.radius1,this.radius2_=t.radius2,this.angle_=void 0!==t.angle?t.angle:0,this.stroke_=void 0!==t.stroke?t.stroke:null,this.size_,this.renderOptions_,this.render()}clone(){const t=this.getScale(),e=new by({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(t)?t.slice():t,displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return e.setOpacity(this.getOpacity()),e}getAnchor(){const t=this.size_,e=this.getDisplacement(),i=this.getScaleArray();return[t[0]/2-e[0]/i[0],t[1]/2+e[1]/i[1]]}getAngle(){return this.angle_}getFill(){return this.fill_}setFill(t){this.fill_=t,this.render()}getHitDetectionImage(){return this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.createHitDetectionCanvas_(this.renderOptions_)),this.hitDetectionCanvas_}getImage(t){let e=this.canvases_[t];if(!e){const i=this.renderOptions_,n=Vn(i.size*t,i.size*t);this.draw_(i,n,t),e=n.canvas,this.canvases_[t]=e}return e}getPixelRatio(t){return t}getImageSize(){return this.size_}getImageState(){return 2}getOrigin(){return this.origin_}getPoints(){return this.points_}getRadius(){return this.radius_}getRadius2(){return this.radius2_}getSize(){return this.size_}getStroke(){return this.stroke_}setStroke(t){this.stroke_=t,this.render()}listenImageChange(t){}load(){}unlistenImageChange(t){}calculateLineJoinSize_(t,e,i){if(0===e||this.points_===1/0||"bevel"!==t&&"miter"!==t)return e;let n=this.radius_,r=void 0===this.radius2_?n:this.radius2_;if(n<r){const t=n;n=r,r=t}const s=void 0===this.radius2_?this.points_:2*this.points_,o=2*Math.PI/s,a=r*Math.sin(o),h=n-Math.sqrt(r*r-a*a),l=Math.sqrt(a*a+h*h),c=l/a;if("miter"===t&&c<=i)return c*e;const u=e/2/c,d=e/2*(h/l),f=Math.sqrt((n+u)*(n+u)+d*d)-n;if(void 0===this.radius2_||"bevel"===t)return 2*f;const g=n*Math.sin(o),m=r-Math.sqrt(n*n-g*g),p=Math.sqrt(g*g+m*m)/g;if(p<=i){const t=p*e/2-r-n;return 2*Math.max(f,t)}return 2*f}createRenderOptions(){let t,e=Hn,i=Jn,n=0,r=null,s=0,o=0;this.stroke_&&(t=vy(this.stroke_.getColor()??Qn),o=this.stroke_.getWidth()??1,r=this.stroke_.getLineDash(),s=this.stroke_.getLineDashOffset()??0,i=this.stroke_.getLineJoin()??Jn,e=this.stroke_.getLineCap()??Hn,n=this.stroke_.getMiterLimit()??10);const a=this.calculateLineJoinSize_(i,o,n),h=Math.max(this.radius_,this.radius2_||0);return{strokeStyle:t,strokeWidth:o,size:Math.ceil(2*h+a),lineCap:e,lineDash:r,lineDashOffset:s,lineJoin:i,miterLimit:n}}render(){this.renderOptions_=this.createRenderOptions();const t=this.renderOptions_.size;this.canvases_={},this.hitDetectionCanvas_=null,this.size_=[t,t]}draw_(t,e,i){if(e.scale(i,i),e.translate(t.size/2,t.size/2),this.createPath_(e),this.fill_){let t=this.fill_.getColor();null===t&&(t=Kn),e.fillStyle=vy(t),e.fill()}t.strokeStyle&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineCap=t.lineCap,e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit,e.stroke())}createHitDetectionCanvas_(t){let e;if(this.fill_){let i=this.fill_.getColor(),n=0;"string"==typeof i&&(i=le(i)),null===i?n=1:Array.isArray(i)&&(n=4===i.length?i[3]:1),0===n&&(e=Vn(t.size,t.size),this.drawHitDetectionCanvas_(t,e))}return e?e.canvas:this.getImage(1)}createPath_(t){let e=this.points_;const i=this.radius_;if(e===1/0)t.arc(0,0,i,0,2*Math.PI);else{const n=void 0===this.radius2_?i:this.radius2_;void 0!==this.radius2_&&(e*=2);const r=this.angle_-Math.PI/2,s=2*Math.PI/e;for(let o=0;o<e;o++){const e=r+o*s,a=o%2==0?i:n;t.lineTo(a*Math.cos(e),a*Math.sin(e))}t.closePath()}}drawHitDetectionCanvas_(t,e){e.translate(t.size/2,t.size/2),this.createPath_(e),e.fillStyle=Kn,e.fill(),t.strokeStyle&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit,e.stroke())}}const xy=by;class My extends xy{constructor(t){super({points:1/0,fill:(t=t||{radius:5}).fill,radius:t.radius,stroke:t.stroke,scale:void 0!==t.scale?t.scale:1,rotation:void 0!==t.rotation?t.rotation:0,rotateWithView:void 0!==t.rotateWithView&&t.rotateWithView,displacement:void 0!==t.displacement?t.displacement:[0,0],declutterMode:t.declutterMode})}clone(){const t=this.getScale(),e=new My({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(t)?t.slice():t,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return e.setOpacity(this.getOpacity()),e}setRadius(t){this.radius_=t,this.render()}}const Ey=My;class Sy{constructor(t){t=t||{},this.color_=void 0!==t.color?t.color:null}clone(){const t=this.getColor();return new Sy({color:Array.isArray(t)?t.slice():t||void 0})}getColor(){return this.color_}setColor(t){this.color_=t}}const ky=Sy;class Cy{constructor(t){t=t||{},this.color_=void 0!==t.color?t.color:null,this.lineCap_=t.lineCap,this.lineDash_=void 0!==t.lineDash?t.lineDash:null,this.lineDashOffset_=t.lineDashOffset,this.lineJoin_=t.lineJoin,this.miterLimit_=t.miterLimit,this.width_=t.width}clone(){const t=this.getColor();return new Cy({color:Array.isArray(t)?t.slice():t||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})}getColor(){return this.color_}getLineCap(){return this.lineCap_}getLineDash(){return this.lineDash_}getLineDashOffset(){return this.lineDashOffset_}getLineJoin(){return this.lineJoin_}getMiterLimit(){return this.miterLimit_}getWidth(){return this.width_}setColor(t){this.color_=t}setLineCap(t){this.lineCap_=t}setLineDash(t){this.lineDash_=t}setLineDashOffset(t){this.lineDashOffset_=t}setLineJoin(t){this.lineJoin_=t}setMiterLimit(t){this.miterLimit_=t}setWidth(t){this.width_=t}}const Iy=Cy;class Ay{constructor(t){t=t||{},this.geometry_=null,this.geometryFunction_=Py,void 0!==t.geometry&&this.setGeometry(t.geometry),this.fill_=void 0!==t.fill?t.fill:null,this.image_=void 0!==t.image?t.image:null,this.renderer_=void 0!==t.renderer?t.renderer:null,this.hitDetectionRenderer_=void 0!==t.hitDetectionRenderer?t.hitDetectionRenderer:null,this.stroke_=void 0!==t.stroke?t.stroke:null,this.text_=void 0!==t.text?t.text:null,this.zIndex_=t.zIndex}clone(){let t=this.getGeometry();return t&&"object"==typeof t&&(t=t.clone()),new Ay({geometry:t??void 0,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:this.getRenderer()??void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})}getRenderer(){return this.renderer_}setRenderer(t){this.renderer_=t}setHitDetectionRenderer(t){this.hitDetectionRenderer_=t}getHitDetectionRenderer(){return this.hitDetectionRenderer_}getGeometry(){return this.geometry_}getGeometryFunction(){return this.geometryFunction_}getFill(){return this.fill_}setFill(t){this.fill_=t}getImage(){return this.image_}setImage(t){this.image_=t}getStroke(){return this.stroke_}setStroke(t){this.stroke_=t}getText(){return this.text_}setText(t){this.text_=t}getZIndex(){return this.zIndex_}setGeometry(t){"function"==typeof t?this.geometryFunction_=t:"string"==typeof t?this.geometryFunction_=function(e){return e.get(t)}:t?void 0!==t&&(this.geometryFunction_=function(){return t}):this.geometryFunction_=Py,this.geometry_=t}setZIndex(t){this.zIndex_=t}}let Ty=null;function Ry(t,e){if(!Ty){const t=new ky({color:"rgba(255,255,255,0.4)"}),e=new Iy({color:"#3399CC",width:1.25});Ty=[new Ay({image:new Ey({fill:t,stroke:e,radius:5}),fill:t,stroke:e})]}return Ty}function Py(t){return t.getGeometry()}const Dy=Ay;let Fy=null;class Ly extends w{constructor(t,e,i,n,r){super(),this.hitDetectionImage_=null,this.image_=t,this.crossOrigin_=i,this.canvas_={},this.color_=r,this.imageState_=void 0===n?0:n,this.size_=t&&t.width&&t.height?[t.width,t.height]:null,this.src_=e,this.tainted_}initializeImage_(){this.image_=new Image,null!==this.crossOrigin_&&(this.image_.crossOrigin=this.crossOrigin_)}isTainted_(){if(void 0===this.tainted_&&2===this.imageState_){Fy||(Fy=Vn(1,1,void 0,{willReadFrequently:!0})),Fy.drawImage(this.image_,0,0);try{Fy.getImageData(0,0,1,1),this.tainted_=!1}catch(t){Fy=null,this.tainted_=!0}}return!0===this.tainted_}dispatchChangeEvent_(){this.dispatchEvent(y)}handleImageError_(){this.imageState_=3,this.dispatchChangeEvent_()}handleImageLoad_(){this.imageState_=2,this.size_=[this.image_.width,this.image_.height],this.dispatchChangeEvent_()}getImage(t){return this.image_||this.initializeImage_(),this.replaceColor_(t),this.canvas_[t]?this.canvas_[t]:this.image_}getPixelRatio(t){return this.replaceColor_(t),this.canvas_[t]?t:1}getImageState(){return this.imageState_}getHitDetectionImage(){if(this.image_||this.initializeImage_(),!this.hitDetectionImage_)if(this.isTainted_()){const t=this.size_[0],e=this.size_[1],i=Vn(t,e);i.fillRect(0,0,t,e),this.hitDetectionImage_=i.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_}getSize(){return this.size_}getSrc(){return this.src_}load(){if(0===this.imageState_){this.image_||this.initializeImage_(),this.imageState_=1;try{void 0!==this.src_&&(this.image_.src=this.src_)}catch(t){this.handleImageError_()}this.image_ instanceof HTMLImageElement&&function(t,e){return e&&(t.src=e),t.src&&W?new Promise(((e,i)=>t.decode().then((()=>e(t))).catch((n=>t.complete&&t.width?e(t):i(n))))):function(t,e){return new Promise(((e,i)=>{function n(){s(),e(t)}function r(){s(),i(new Error("Image load error"))}function s(){t.removeEventListener("load",n),t.removeEventListener("error",r)}t.addEventListener("load",n),t.addEventListener("error",r)}))}(t)}(this.image_,this.src_).then((t=>{this.image_=t,this.handleImageLoad_()})).catch(this.handleImageError_.bind(this))}}replaceColor_(t){if(!this.color_||this.canvas_[t]||2!==this.imageState_)return;const e=this.image_,i=document.createElement("canvas");i.width=Math.ceil(e.width*t),i.height=Math.ceil(e.height*t);const n=i.getContext("2d");n.scale(t,t),n.drawImage(e,0,0),n.globalCompositeOperation="multiply",n.fillStyle=ie(this.color_),n.fillRect(0,0,i.width/t,i.height/t),n.globalCompositeOperation="destination-in",n.drawImage(e,0,0),this.canvas_[t]=i}}function Oy(t,e,i,n){return void 0!==i&&void 0!==n?[i/t,n/e]:void 0!==i?i/t:void 0!==n?n/e:1}class Ny extends yy{constructor(t){const e=void 0!==(t=t||{}).opacity?t.opacity:1,i=void 0!==t.rotation?t.rotation:0,n=void 0!==t.scale?t.scale:1,r=void 0!==t.rotateWithView&&t.rotateWithView;super({opacity:e,rotation:i,scale:n,displacement:void 0!==t.displacement?t.displacement:[0,0],rotateWithView:r,declutterMode:t.declutterMode}),this.anchor_=void 0!==t.anchor?t.anchor:[.5,.5],this.normalizedAnchor_=null,this.anchorOrigin_=void 0!==t.anchorOrigin?t.anchorOrigin:"top-left",this.anchorXUnits_=void 0!==t.anchorXUnits?t.anchorXUnits:"fraction",this.anchorYUnits_=void 0!==t.anchorYUnits?t.anchorYUnits:"fraction",this.crossOrigin_=void 0!==t.crossOrigin?t.crossOrigin:null;const s=void 0!==t.img?t.img:null;let o,a=t.src;if(K(!(void 0!==a&&s),"`image` and `src` cannot be provided at the same time"),void 0!==a&&0!==a.length||!s||(a=s.src||D(s)),K(void 0!==a&&a.length>0,"A defined and non-empty `src` or `image` must be provided"),K(!((void 0!==t.width||void 0!==t.height)&&void 0!==t.scale),"`width` or `height` cannot be provided together with `scale`"),void 0!==t.src?o=0:void 0!==s&&(o=s instanceof HTMLImageElement?s.complete?s.src?2:0:1:2),this.color_=void 0!==t.color?le(t.color):null,this.iconImage_=function(t,e,i,n,r){let s=void 0===e?void 0:fe.get(e,i,r);return s||(s=new Ly(t,t instanceof HTMLImageElement?t.src||void 0:e,i,n,r),fe.set(e,i,r,s)),s}(s,a,this.crossOrigin_,o,this.color_),this.offset_=void 0!==t.offset?t.offset:[0,0],this.offsetOrigin_=void 0!==t.offsetOrigin?t.offsetOrigin:"top-left",this.origin_=null,this.size_=void 0!==t.size?t.size:null,void 0!==t.width||void 0!==t.height){let e,i;if(t.size)[e,i]=t.size;else{const n=this.getImage(1);if(n.width&&n.height)e=n.width,i=n.height;else if(n instanceof HTMLImageElement){this.initialOptions_=t;const e=()=>{if(this.unlistenImageChange(e),!this.initialOptions_)return;const i=this.iconImage_.getSize();this.setScale(Oy(i[0],i[1],t.width,t.height))};return void this.listenImageChange(e)}}void 0!==e&&this.setScale(Oy(e,i,t.width,t.height))}}clone(){let t,e,i;return this.initialOptions_?(e=this.initialOptions_.width,i=this.initialOptions_.height):(t=this.getScale(),t=Array.isArray(t)?t.slice():t),new Ny({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,crossOrigin:this.crossOrigin_,offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,opacity:this.getOpacity(),rotateWithView:this.getRotateWithView(),rotation:this.getRotation(),scale:t,width:e,height:i,size:null!==this.size_?this.size_.slice():void 0,src:this.getSrc(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getAnchor(){let t=this.normalizedAnchor_;if(!t){t=this.anchor_;const e=this.getSize();if("fraction"==this.anchorXUnits_||"fraction"==this.anchorYUnits_){if(!e)return null;t=this.anchor_.slice(),"fraction"==this.anchorXUnits_&&(t[0]*=e[0]),"fraction"==this.anchorYUnits_&&(t[1]*=e[1])}if("top-left"!=this.anchorOrigin_){if(!e)return null;t===this.anchor_&&(t=this.anchor_.slice()),"top-right"!=this.anchorOrigin_&&"bottom-right"!=this.anchorOrigin_||(t[0]=-t[0]+e[0]),"bottom-left"!=this.anchorOrigin_&&"bottom-right"!=this.anchorOrigin_||(t[1]=-t[1]+e[1])}this.normalizedAnchor_=t}const e=this.getDisplacement(),i=this.getScaleArray();return[t[0]-e[0]/i[0],t[1]+e[1]/i[1]]}setAnchor(t){this.anchor_=t,this.normalizedAnchor_=null}getColor(){return this.color_}getImage(t){return this.iconImage_.getImage(t)}getPixelRatio(t){return this.iconImage_.getPixelRatio(t)}getImageSize(){return this.iconImage_.getSize()}getImageState(){return this.iconImage_.getImageState()}getHitDetectionImage(){return this.iconImage_.getHitDetectionImage()}getOrigin(){if(this.origin_)return this.origin_;let t=this.offset_;if("top-left"!=this.offsetOrigin_){const e=this.getSize(),i=this.iconImage_.getSize();if(!e||!i)return null;t=t.slice(),"top-right"!=this.offsetOrigin_&&"bottom-right"!=this.offsetOrigin_||(t[0]=i[0]-e[0]-t[0]),"bottom-left"!=this.offsetOrigin_&&"bottom-right"!=this.offsetOrigin_||(t[1]=i[1]-e[1]-t[1])}return this.origin_=t,this.origin_}getSrc(){return this.iconImage_.getSrc()}getSize(){return this.size_?this.size_:this.iconImage_.getSize()}getWidth(){const t=this.getScaleArray();return this.size_?this.size_[0]*t[0]:2==this.iconImage_.getImageState()?this.iconImage_.getSize()[0]*t[0]:void 0}getHeight(){const t=this.getScaleArray();return this.size_?this.size_[1]*t[1]:2==this.iconImage_.getImageState()?this.iconImage_.getSize()[1]*t[1]:void 0}setScale(t){delete this.initialOptions_,super.setScale(t)}listenImageChange(t){this.iconImage_.addEventListener(y,t)}load(){this.iconImage_.load()}unlistenImageChange(t){this.iconImage_.removeEventListener(y,t)}}const By=Ny;class zy{constructor(t){t=t||{},this.font_=t.font,this.rotation_=t.rotation,this.rotateWithView_=t.rotateWithView,this.scale_=t.scale,this.scaleArray_=ms(void 0!==t.scale?t.scale:1),this.text_=t.text,this.textAlign_=t.textAlign,this.justify_=t.justify,this.repeat_=t.repeat,this.textBaseline_=t.textBaseline,this.fill_=void 0!==t.fill?t.fill:new ky({color:"#333"}),this.maxAngle_=void 0!==t.maxAngle?t.maxAngle:Math.PI/4,this.placement_=void 0!==t.placement?t.placement:"point",this.overflow_=!!t.overflow,this.stroke_=void 0!==t.stroke?t.stroke:null,this.offsetX_=void 0!==t.offsetX?t.offsetX:0,this.offsetY_=void 0!==t.offsetY?t.offsetY:0,this.backgroundFill_=t.backgroundFill?t.backgroundFill:null,this.backgroundStroke_=t.backgroundStroke?t.backgroundStroke:null,this.padding_=void 0===t.padding?null:t.padding}clone(){const t=this.getScale();return new zy({font:this.getFont(),placement:this.getPlacement(),repeat:this.getRepeat(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(t)?t.slice():t,text:this.getText(),textAlign:this.getTextAlign(),justify:this.getJustify(),textBaseline:this.getTextBaseline(),fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()||void 0})}getOverflow(){return this.overflow_}getFont(){return this.font_}getMaxAngle(){return this.maxAngle_}getPlacement(){return this.placement_}getRepeat(){return this.repeat_}getOffsetX(){return this.offsetX_}getOffsetY(){return this.offsetY_}getFill(){return this.fill_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getStroke(){return this.stroke_}getText(){return this.text_}getTextAlign(){return this.textAlign_}getJustify(){return this.justify_}getTextBaseline(){return this.textBaseline_}getBackgroundFill(){return this.backgroundFill_}getBackgroundStroke(){return this.backgroundStroke_}getPadding(){return this.padding_}setOverflow(t){this.overflow_=t}setFont(t){this.font_=t}setMaxAngle(t){this.maxAngle_=t}setOffsetX(t){this.offsetX_=t}setOffsetY(t){this.offsetY_=t}setPlacement(t){this.placement_=t}setRepeat(t){this.repeat_=t}setRotateWithView(t){this.rotateWithView_=t}setFill(t){this.fill_=t}setRotation(t){this.rotation_=t}setScale(t){this.scale_=t,this.scaleArray_=ms(void 0!==t?t:1)}setStroke(t){this.stroke_=t}setText(t){this.text_=t}setTextAlign(t){this.textAlign_=t}setJustify(t){this.justify_=t}setTextBaseline(t){this.textBaseline_=t}setBackgroundFill(t){this.backgroundFill_=t}setBackgroundStroke(t){this.backgroundStroke_=t}setPadding(t){this.padding_=t}}const Uy=zy;let Gy=0;const Yy=0,Xy=1<<Gy++,Vy=1<<Gy++,jy=1<<Gy++,qy=1<<Gy++,Wy=1<<Gy++,Zy=Math.pow(2,5)-1,Ky={[Xy]:"boolean",[Vy]:"number",[jy]:"string",[qy]:"color",[Wy]:"number[]"},Hy=Object.keys(Ky).map(Number).sort(a);function $y(t){const e=[];for(const n of Hy)(t&(i=n))===i&&e.push(Ky[n]);var i;return 0===e.length?"untyped":e.length<3?e.join(" or "):e.slice(0,-1).join(", ")+", or "+e[e.length-1]}function Jy(t,e){return!!(t&e)}function Qy(t,e){return t===e}class tv{constructor(t,e){this.type=t,this.value=e}}class ev{constructor(t,e,...i){this.type=t,this.operator=e,this.args=i}}function iv(){return{variables:new Set,properties:new Set,featureId:!1,style:{}}}function nv(t,e,i){switch(typeof t){case"boolean":return new tv(Xy,t);case"number":return new tv(Vy,t);case"string":{let e=jy;return function(t){try{return he(t),!0}catch(t){return!1}}(t)&&(e|=qy),Qy(e&i,Yy)||(e&=i),new tv(e,t)}}if(!Array.isArray(t))throw new Error("Expression must be an array or a primitive value");if(0===t.length)throw new Error("Empty expression");if("string"==typeof t[0])return function(t,e,i){const n=t[0],r=sv[n];if(!r)throw new Error(`Unknown operator: ${n}`);return r(t,e,i)}(t,e,i);for(const e of t)if("number"!=typeof e)throw new Error("Expected an array of numbers");let n=Wy;return 3!==t.length&&4!==t.length||(n|=qy),i&&(n&=i),new tv(n,t)}const rv={Get:"get",Var:"var",Concat:"concat",GeometryType:"geometry-type",Any:"any",All:"all",Not:"!",Resolution:"resolution",Zoom:"zoom",Time:"time",Equal:"==",NotEqual:"!=",GreaterThan:">",GreaterThanOrEqualTo:">=",LessThan:"<",LessThanOrEqualTo:"<=",Multiply:"*",Divide:"/",Add:"+",Subtract:"-",Clamp:"clamp",Mod:"%",Pow:"^",Abs:"abs",Floor:"floor",Ceil:"ceil",Round:"round",Sin:"sin",Cos:"cos",Atan:"atan",Sqrt:"sqrt",Match:"match",Between:"between",Interpolate:"interpolate",Case:"case",In:"in",Number:"number",String:"string",Array:"array",Color:"color",Id:"id",Band:"band",Palette:"palette"},sv={[rv.Get]:dv((([t,e])=>void 0!==e?function(t){switch(t){case"string":return jy;case"color":return qy;case"number":return Vy;case"boolean":return Xy;case"number[]":return Wy;default:throw new Error(`Unrecognized type hint: ${t}`)}}(e.value):Zy),av(1,2),(function(t,e){const i=nv(t[1],e);if(!(i instanceof tv))throw new Error("Expected a literal argument for get operation");if("string"!=typeof i.value)throw new Error("Expected a string argument for get operation");return e.properties.add(i.value),3===t.length?[i,nv(t[2],e)]:[i]})),[rv.Var]:dv((([t])=>t.type),av(1,1),(function(t,e,i,n){const r=t[1];if("string"!=typeof r)throw new Error("Expected a string argument for var operation");if(e.variables.add(r),!("variables"in e.style)||void 0===e.style.variables[r])return[new tv(Zy,r)];const s=nv(e.style.variables[r],e);if(s.value=r,n&&!Jy(n,s.type))throw new Error(`The variable ${r} has type ${$y(s.type)} but the following type was expected: ${$y(n)}`);return[s]})),[rv.Id]:dv(Vy|jy,ov,(function(t,e){e.featureId=!0})),[rv.Concat]:dv(jy,av(2,1/0),hv(Zy)),[rv.GeometryType]:dv(jy,ov),[rv.Resolution]:dv(Vy,ov),[rv.Zoom]:dv(Vy,ov),[rv.Time]:dv(Vy,ov),[rv.Any]:dv(Xy,av(2,1/0),hv(Xy)),[rv.All]:dv(Xy,av(2,1/0),hv(Xy)),[rv.Not]:dv(Xy,av(1,1),hv(Xy)),[rv.Equal]:dv(Xy,av(2,2),hv(Zy),lv),[rv.NotEqual]:dv(Xy,av(2,2),hv(Zy),lv),[rv.GreaterThan]:dv(Xy,av(2,2),hv(Zy),lv),[rv.GreaterThanOrEqualTo]:dv(Xy,av(2,2),hv(Zy),lv),[rv.LessThan]:dv(Xy,av(2,2),hv(Zy),lv),[rv.LessThanOrEqualTo]:dv(Xy,av(2,2),hv(Zy),lv),[rv.Multiply]:dv((t=>{let e=Vy|qy;for(let i=0;i<t.length;i++)e&=t[i].type;return e}),av(2,1/0),hv(Vy|qy),lv),[rv.Divide]:dv(Vy,av(2,2),hv(Vy)),[rv.Add]:dv(Vy,av(2,1/0),hv(Vy)),[rv.Subtract]:dv(Vy,av(2,2),hv(Vy)),[rv.Clamp]:dv(Vy,av(3,3),hv(Vy)),[rv.Mod]:dv(Vy,av(2,2),hv(Vy)),[rv.Pow]:dv(Vy,av(2,2),hv(Vy)),[rv.Abs]:dv(Vy,av(1,1),hv(Vy)),[rv.Floor]:dv(Vy,av(1,1),hv(Vy)),[rv.Ceil]:dv(Vy,av(1,1),hv(Vy)),[rv.Round]:dv(Vy,av(1,1),hv(Vy)),[rv.Sin]:dv(Vy,av(1,1),hv(Vy)),[rv.Cos]:dv(Vy,av(1,1),hv(Vy)),[rv.Atan]:dv(Vy,av(1,2),hv(Vy)),[rv.Sqrt]:dv(Vy,av(1,1),hv(Vy)),[rv.Match]:dv((t=>{let e=Zy;for(let i=2;i<t.length;i+=2)e&=t[i].type;return e&=t[t.length-1].type,e}),av(4,1/0),uv,(function(t,e,i,n){const r=t.length-1;let s=nv(t[1],e).type;const o=nv(t[t.length-1],e);let a=void 0!==n?n&o.type:o.type;const h=new Array(r-2);for(let i=0;i<r-2;i+=2){const n=nv(t[i+2],e),r=nv(t[i+3],e);s&=n.type,a&=r.type,h[i]=n,h[i+1]=r}const l=jy|Vy|Xy;if(!Jy(l,s))throw new Error(`Expected an input of type ${$y(l)} for the interpolate operation, got ${$y(s)} instead`);if(Qy(a,Yy))throw new Error("Could not find a common output type for the following match operation: "+JSON.stringify(t));for(let i=0;i<r-2;i+=2){const n=nv(t[i+2],e,s),r=nv(t[i+3],e,a);h[i]=n,h[i+1]=r}return[nv(t[1],e,s),...h,nv(t[t.length-1],e,a)]})),[rv.Between]:dv(Xy,av(3,3),hv(Vy)),[rv.Interpolate]:dv((t=>{let e=qy|Vy;for(let i=3;i<t.length;i+=2)e&=t[i].type;return e}),av(6,1/0),uv,(function(t,e,i,n){const r=t[1];let s;switch(r[0]){case"linear":s=1;break;case"exponential":if(s=r[1],"number"!=typeof s)throw new Error(`Expected a number base for exponential interpolation, got ${JSON.stringify(s)} instead`);break;default:s=null}if(!s)throw new Error(`Invalid interpolation type: ${JSON.stringify(r)}`);s=nv(s,e);let o=nv(t[2],e);if(!Jy(Vy,o.type))throw new Error(`Expected an input of type number for the interpolate operation, got ${$y(o.type)} instead`);o=nv(t[2],e,Vy);const a=new Array(t.length-3);for(let i=0;i<a.length;i+=2){let n=nv(t[i+3],e);if(!Jy(Vy,n.type))throw new Error(`Expected all stop input values in the interpolate operation to be of type number, got ${$y(n.type)} at position ${i+2} instead`);let r=nv(t[i+4],e);if(!Jy(Vy|qy,r.type))throw new Error(`Expected all stop output values in the interpolate operation to be a number or color, got ${$y(r.type)} at position ${i+3} instead`);n=nv(t[i+3],e,Vy),r=nv(t[i+4],e,Vy|qy),a[i]=n,a[i+1]=r}return[s,o,...a]})),[rv.Case]:dv((t=>{let e=Zy;for(let i=1;i<t.length;i+=2)e&=t[i].type;return e&=t[t.length-1].type,e}),av(3,1/0),(function(t,e){const i=t[0],n=t.length-1;if(n%2==0)throw new Error(`An odd amount of arguments was expected for operation ${i}, got ${JSON.stringify(n)} instead`)}),(function(t,e,i,n){const r=nv(t[t.length-1],e);let s=void 0!==n?n&r.type:r.type;const o=new Array(t.length-1);for(let i=0;i<o.length-1;i+=2){const n=nv(t[i+1],e),r=nv(t[i+2],e);if(!Jy(Xy,n.type))throw new Error(`Expected all conditions in the case operation to be of type boolean, got ${$y(n.type)} at position ${i} instead`);s&=r.type,o[i]=n,o[i+1]=r}if(Qy(s,Yy))throw new Error("Could not find a common output type for the following case operation: "+JSON.stringify(t));for(let i=0;i<o.length-1;i+=2)o[i+1]=nv(t[i+2],e,s);return o[o.length-1]=nv(t[t.length-1],e,s),o})),[rv.In]:dv(Xy,av(2,2),(function(t,e){let i=t[2];if(!Array.isArray(i))throw new Error('The "in" operator was provided a literal value which was not an array as second argument.');if("string"==typeof i[0]){if("literal"!==i[0])throw new Error('For the "in" operator, a string array should be wrapped in a "literal" operator to disambiguate from expressions.');if(!Array.isArray(i[1]))throw new Error('The "in" operator was provided a literal value which was not an array as second argument.');i=i[1]}let n=jy|Vy;const r=new Array(i.length);for(let t=0;t<r.length;t++){const s=nv(i[t],e);n&=s.type,r[t]=s}if(Qy(n,Yy))throw new Error("Could not find a common type for the following in operation: "+JSON.stringify(t));return[nv(t[1],e,n),...r]})),[rv.Number]:dv(Vy,av(1,1/0),hv(Zy)),[rv.String]:dv(jy,av(1,1/0),hv(Zy)),[rv.Array]:dv((t=>3===t.length||4===t.length?Wy|qy:Wy),av(1,1/0),hv(Vy)),[rv.Color]:dv(qy,av(3,4),hv(Vy)),[rv.Band]:dv(Vy,av(1,3),hv(Vy)),[rv.Palette]:dv(qy,av(2,2),(function(t,e){const i=nv(t[1],e,Vy);if(i.type!==Vy)throw new Error(`The first argument of palette must be an number, got ${$y(i.type)} instead`);const n=t[2];if(!Array.isArray(n))throw new Error("The second argument of palette must be an array");const r=new Array(n.length);for(let t=0;t<r.length;t++){const i=nv(n[t],e,qy);if(!(i instanceof tv))throw new Error(`The palette color at index ${t} must be a literal value`);if(!Jy(i.type,qy))throw new Error(`The palette color at index ${t} should be of type color, got ${$y(i.type)} instead`);r[t]=i}return[i,...r]}))};function ov(t,e){const i=t[0];if(1!==t.length)throw new Error(`Expected no arguments for ${i} operation`);return[]}function av(t,e){return function(i,n){const r=i[0],s=i.length-1;if(t===e){if(s!==t)throw new Error(`Expected ${t} argument${1===t?"":"s"} for ${r}, got ${s}`)}else if(s<t||s>e)throw new Error(`Expected ${e===1/0?`${t} or more`:`${t} to ${e}`} arguments for ${r}, got ${s}`)}}function hv(t){return function(e,i){const n=e[0],r=e.length-1,s=new Array(r);for(let o=0;o<r;++o){const r=nv(e[o+1],i);if(!Jy(t,r.type)){const e=$y(t),i=$y(r.type);throw new Error(`Unexpected type for argument ${o} of ${n} operation, got ${e} but expected ${i}`)}r.type&=t,s[o]=r}return s}}function lv(t,e,i){const n=t[0],r=t.length-1;let s=Zy;for(let t=0;t<i.length;++t)s&=i[t].type;if(s===Yy)throw new Error(`No common type could be found for arguments of ${n} operation`);const o=new Array(r);for(let i=0;i<r;++i)o[i]=nv(t[i+1],e,s);return o}function uv(t,e){const i=t[0],n=t.length-1;if(n%2==1)throw new Error(`An even amount of arguments was expected for operation ${i}, got ${JSON.stringify(n)} instead`)}function dv(t,...e){return function(i,n,r){const s=i[0];let o=[];for(let t=0;t<e.length;t++)o=e[t](i,n,o,r)||o;let a="function"==typeof t?t(o):t;if(void 0!==r){if(!Jy(a,r))throw new Error(`The following expression was expected to return ${$y(r)}, but returns ${$y(a)} instead: ${JSON.stringify(i)}`);a&=r}if(a===Yy)throw new Error(`No matching type was found for the following expression: ${JSON.stringify(i)}`);return new ev(a,s,...o)}}function fv(t,e,i){const n=nv(t,i);if(!Jy(e,n.type)){const t=$y(e),i=$y(n.type);throw new Error(`Expected expression to be of type ${t}, got ${i}`)}return gv(n,i)}function gv(t,e){if(t instanceof tv){if(t.type===qy&&"string"==typeof t.value){const e=he(t.value);return function(){return e}}return function(){return t.value}}const i=t.operator;switch(i){case rv.Number:case rv.String:return function(t,e){const i=t.operator,n=t.args.length,r=new Array(n);for(let i=0;i<n;++i)r[i]=gv(t.args[i],e);switch(i){case rv.Number:case rv.String:return t=>{for(let e=0;e<n;++e){const n=r[e](t);if(typeof n===i)return n}throw new Error(`Expected one of the values to be a ${i}`)};default:throw new Error(`Unsupported assertion operator ${i}`)}}(t,e);case rv.Get:case rv.Var:return function(t,e){const i=t.args[0].value;switch(t.operator){case rv.Get:return t=>t.properties[i];case rv.Var:return t=>t.variables[i];default:throw new Error(`Unsupported accessor operator ${t.operator}`)}}(t);case rv.Id:return t=>t.featureId;case rv.Concat:{const i=t.args.map((t=>gv(t,e)));return t=>"".concat(...i.map((e=>e(t).toString())))}case rv.Resolution:return t=>t.resolution;case rv.Any:case rv.All:case rv.Not:return function(t,e){const i=t.operator,n=t.args.length,r=new Array(n);for(let i=0;i<n;++i)r[i]=gv(t.args[i],e);switch(i){case rv.Any:return t=>{for(let e=0;e<n;++e)if(r[e](t))return!0;return!1};case rv.All:return t=>{for(let e=0;e<n;++e)if(!r[e](t))return!1;return!0};case rv.Not:return t=>!r[0](t);default:throw new Error(`Unsupported logical operator ${i}`)}}(t,e);case rv.Equal:case rv.NotEqual:case rv.LessThan:case rv.LessThanOrEqualTo:case rv.GreaterThan:case rv.GreaterThanOrEqualTo:return function(t,e){const i=t.operator,n=gv(t.args[0],e),r=gv(t.args[1],e);switch(i){case rv.Equal:return t=>n(t)===r(t);case rv.NotEqual:return t=>n(t)!==r(t);case rv.LessThan:return t=>n(t)<r(t);case rv.LessThanOrEqualTo:return t=>n(t)<=r(t);case rv.GreaterThan:return t=>n(t)>r(t);case rv.GreaterThanOrEqualTo:return t=>n(t)>=r(t);default:throw new Error(`Unsupported comparison operator ${i}`)}}(t,e);case rv.Multiply:case rv.Divide:case rv.Add:case rv.Subtract:case rv.Clamp:case rv.Mod:case rv.Pow:case rv.Abs:case rv.Floor:case rv.Ceil:case rv.Round:case rv.Sin:case rv.Cos:case rv.Atan:case rv.Sqrt:return function(t,e){const i=t.operator,n=t.args.length,r=new Array(n);for(let i=0;i<n;++i)r[i]=gv(t.args[i],e);switch(i){case rv.Multiply:return t=>{let e=1;for(let i=0;i<n;++i)e*=r[i](t);return e};case rv.Divide:return t=>r[0](t)/r[1](t);case rv.Add:return t=>{let e=0;for(let i=0;i<n;++i)e+=r[i](t);return e};case rv.Subtract:return t=>r[0](t)-r[1](t);case rv.Clamp:return t=>{const e=r[0](t),i=r[1](t);if(e<i)return i;const n=r[2](t);return e>n?n:e};case rv.Mod:return t=>r[0](t)%r[1](t);case rv.Pow:return t=>Math.pow(r[0](t),r[1](t));case rv.Abs:return t=>Math.abs(r[0](t));case rv.Floor:return t=>Math.floor(r[0](t));case rv.Ceil:return t=>Math.ceil(r[0](t));case rv.Round:return t=>Math.round(r[0](t));case rv.Sin:return t=>Math.sin(r[0](t));case rv.Cos:return t=>Math.cos(r[0](t));case rv.Atan:return 2===n?t=>Math.atan2(r[0](t),r[1](t)):t=>Math.atan(r[0](t));case rv.Sqrt:return t=>Math.sqrt(r[0](t));default:throw new Error(`Unsupported numeric operator ${i}`)}}(t,e);case rv.Match:return function(t,e){const i=t.args.length,n=new Array(i);for(let r=0;r<i;++r)n[r]=gv(t.args[r],e);return t=>{const e=n[0](t);for(let r=1;r<i;r+=2)if(e===n[r](t))return n[r+1](t);return n[i-1](t)}}(t,e);case rv.Interpolate:return function(t,e){const i=t.args.length,n=new Array(i);for(let r=0;r<i;++r)n[r]=gv(t.args[r],e);return t=>{const e=n[0](t),r=n[1](t);let s,o;for(let a=2;a<i;a+=2){const i=n[a](t);let h=n[a+1](t);const l=Array.isArray(h);if(l&&(h=oe(h)),i>=r)return 2===a?h:l?pv(e,r,s,o,i,h):mv(e,r,s,o,i,h);s=i,o=h}return o}}(t,e);default:throw new Error(`Unsupported operator ${i}`)}}function mv(t,e,i,n,r,s){const o=r-i;if(0===o)return n;const a=e-i;return n+(1===t?a/o:(Math.pow(t,a)-1)/(Math.pow(t,o)-1))*(s-n)}function pv(t,e,i,n,r,s){if(0==r-i)return n;const o=ae(n),a=ae(s);let h=a[2]-o[2];return h>180?h-=360:h<-180&&(h+=360),ce(function(t){const e=Bt.rgb(Gt.xyz(t));return e[3]=t[3],e}([mv(t,e,i,o[0],r,a[0]),mv(t,e,i,o[1],r,a[1]),o[2]+mv(t,e,i,0,r,h),mv(t,e,i,n[3],r,s[3])]))}function _v(t){return!0}function wv(t){const e=iv(),i=t.length,n=new Array(i);for(let r=0;r<i;++r)n[r]=yv(t[r],e);const r={variables:{},properties:{},resolution:NaN,featureId:null},s=new Array(i);return function(t,o){if(r.properties=t.getPropertiesInternal(),r.resolution=o,e.featureId){const e=t.getId();r.featureId=void 0!==e?e:null}let a=0;for(let t=0;t<i;++t){const e=n[t](r);e&&(s[a]=e,a+=1)}return s.length=a,s}}function yv(t,e){const i=vv(t,"",e),n=bv(t,"",e),r=function(t,e){const i="text-",n=Mv(t,i+"value",e);if(!n)return null;const r=vv(t,i,e),s=vv(t,i+"background-",e),o=bv(t,i,e),a=bv(t,i+"background-",e),h=Mv(t,i+"font",e),l=xv(t,i+"max-angle",e),c=xv(t,i+"offset-x",e),u=xv(t,i+"offset-y",e),d=Ev(t,i+"overflow",e),f=Mv(t,i+"placement",e),g=xv(t,i+"repeat",e),m=Iv(t,i+"scale",e),p=Ev(t,i+"rotate-with-view",e),_=xv(t,i+"rotation",e),w=Mv(t,i+"align",e),y=Mv(t,i+"justify",e),v=Mv(t,i+"baseline",e),b=kv(t,i+"padding",e),x=new Uy({});return function(t){if(x.setText(n(t)),r&&x.setFill(r(t)),s&&x.setBackgroundFill(s(t)),o&&x.setStroke(o(t)),a&&x.setBackgroundStroke(a(t)),h&&x.setFont(h(t)),l&&x.setMaxAngle(l(t)),c&&x.setOffsetX(c(t)),u&&x.setOffsetY(u(t)),d&&x.setOverflow(d(t)),f){const e=f(t);if("point"!==e&&"line"!==e)throw new Error("Expected point or line for text-placement");x.setPlacement(e)}if(g&&x.setRepeat(g(t)),m&&x.setScale(m(t)),p&&x.setRotateWithView(p(t)),_&&x.setRotation(_(t)),w){const e=w(t);if("left"!==e&&"center"!==e&&"right"!==e&&"end"!==e&&"start"!==e)throw new Error("Expected left, right, center, start, or end for text-align");x.setTextAlign(e)}if(y){const e=y(t);if("left"!==e&&"right"!==e&&"center"!==e)throw new Error("Expected left, right, or center for text-justify");x.setJustify(e)}if(v){const e=v(t);if("bottom"!==e&&"top"!==e&&"middle"!==e&&"alphabetic"!==e&&"hanging"!==e)throw new Error("Expected bottom, top, middle, alphabetic, or hanging for text-baseline");x.setTextBaseline(e)}return b&&x.setPadding(b(t)),x}}(t,e),s=function(t,e){return"icon-src"in t?function(t,e){const i="icon-",n=i+"src",r=Fv(t[n],n),s=Cv(t,i+"anchor",e),o=Iv(t,i+"scale",e),a=xv(t,i+"opacity",e),h=Cv(t,i+"displacement",e),l=xv(t,i+"rotation",e),c=Ev(t,i+"rotate-with-view",e),u=Tv(t,i+"anchor-origin"),d=Rv(t,i+"anchor-x-units"),f=Rv(t,i+"anchor-y-units"),g=function(t,e){const i=t[e];if(void 0!==i)return Ov(i,e)}(t,i+"color"),m=function(t,e){const i=t[e];if(void 0!==i){if("string"!=typeof i)throw new Error(`Expected a string for ${e}`);return i}}(t,i+"cross-origin"),p=function(t,e){const i=t[e];if(void 0!==i)return Dv(i,e)}(t,i+"offset"),_=Tv(t,i+"offset-origin"),w=Av(t,i+"width"),y=Av(t,i+"height"),v=function(t,e){const i=t[e];if(void 0!==i){if("number"==typeof i)return ms(i);if(!Array.isArray(i))throw new Error(`Expected a number or size array for ${e}`);if(2!==i.length||"number"!=typeof i[0]||"number"!=typeof i[1])throw new Error(`Expected a number or size array for ${e}`);return i}}(t,i+"size"),b=Pv(t,i+"declutter"),x=new By({src:r,anchorOrigin:u,anchorXUnits:d,anchorYUnits:f,color:g,crossOrigin:m,offset:p,offsetOrigin:_,height:y,width:w,size:v,declutterMode:b});return function(t){return a&&x.setOpacity(a(t)),h&&x.setDisplacement(h(t)),l&&x.setRotation(l(t)),c&&x.setRotateWithView(c(t)),o&&x.setScale(o(t)),s&&x.setAnchor(s(t)),x}}(t,e):"shape-points"in t?function(t,e){const i="shape-",n=i+"points",r=Lv(t[n],n),s=vv(t,i,e),o=bv(t,i,e),a=Iv(t,i+"scale",e),h=Cv(t,i+"displacement",e),l=xv(t,i+"rotation",e),c=Ev(t,i+"rotate-with-view",e),u=Av(t,i+"radius"),d=Av(t,i+"radius1"),f=Av(t,i+"radius2"),g=Av(t,i+"angle"),m=Pv(t,i+"declutter-mode"),p=new xy({points:r,radius:u,radius1:d,radius2:f,angle:g,declutterMode:m});return function(t){return s&&p.setFill(s(t)),o&&p.setStroke(o(t)),h&&p.setDisplacement(h(t)),l&&p.setRotation(l(t)),c&&p.setRotateWithView(c(t)),a&&p.setScale(a(t)),p}}(t,e):"circle-radius"in t?function(t,e){const i="circle-",n=vv(t,i,e),r=bv(t,i,e),s=xv(t,i+"radius",e),o=Iv(t,i+"scale",e),a=Cv(t,i+"displacement",e),h=xv(t,i+"rotation",e),l=Ev(t,i+"rotate-with-view",e),c=Pv(t,i+"declutter-mode"),u=new Ey({radius:5,declutterMode:c});return function(t){return s&&u.setRadius(s(t)),n&&u.setFill(n(t)),r&&u.setStroke(r(t)),a&&u.setDisplacement(a(t)),h&&u.setRotation(h(t)),l&&u.setRotateWithView(l(t)),o&&u.setScale(o(t)),u}}(t,e):null}(t,e),o=xv(t,"z-index",e);if(!(i||n||r||s||_(t)))throw new Error("No fill, stroke, point, or text symbolizer properties in style: "+JSON.stringify(t));const a=new Dy;return function(t){let e=!0;if(i){const n=i(t);n&&(e=!1),a.setFill(n)}if(n){const i=n(t);i&&(e=!1),a.setStroke(i)}if(r){const i=r(t);i&&(e=!1),a.setText(i)}if(s){const i=s(t);i&&(e=!1),a.setImage(i)}return o&&a.setZIndex(o(t)),e?null:a}}function vv(t,e,i){const n=Sv(t,e+"fill-color",i);if(!n)return null;const r=new ky;return function(t){const e=n(t);return"none"===e?null:(r.setColor(e),r)}}function bv(t,e,i){const n=xv(t,e+"stroke-width",i),r=Sv(t,e+"stroke-color",i);if(!n&&!r)return null;const s=Mv(t,e+"stroke-line-cap",i),o=Mv(t,e+"stroke-line-join",i),a=kv(t,e+"stroke-line-dash",i),h=xv(t,e+"stroke-line-dash-offset",i),l=xv(t,e+"stroke-miter-limit",i),c=new Iy;return function(t){if(r){const e=r(t);if("none"===e)return null;c.setColor(e)}if(n&&c.setWidth(n(t)),s){const e=s(t);if("butt"!==e&&"round"!==e&&"square"!==e)throw new Error("Expected butt, round, or square line cap");c.setLineCap(e)}if(o){const e=o(t);if("bevel"!==e&&"round"!==e&&"miter"!==e)throw new Error("Expected bevel, round, or miter line join");c.setLineJoin(e)}return a&&c.setLineDash(a(t)),h&&c.setLineDashOffset(h(t)),l&&c.setMiterLimit(l(t)),c}}function xv(t,e,i){if(!(e in t))return;const n=fv(t[e],Vy,i);return function(t){return Lv(n(t),e)}}function Mv(t,e,i){if(!(e in t))return null;const n=fv(t[e],jy,i);return function(t){return Fv(n(t),e)}}function Ev(t,e,i){if(!(e in t))return null;const n=fv(t[e],Xy,i);return function(t){const i=n(t);if("boolean"!=typeof i)throw new Error(`Expected a boolean for ${e}`);return i}}function Sv(t,e,i){if(!(e in t))return null;const n=fv(t[e],qy|jy,i);return function(t){return Ov(n(t),e)}}function kv(t,e,i){if(!(e in t))return null;const n=fv(t[e],Wy,i);return function(t){return Dv(n(t),e)}}function Cv(t,e,i){if(!(e in t))return null;const n=fv(t[e],Wy,i);return function(t){const i=Dv(n(t),e);if(2!==i.length)throw new Error(`Expected two numbers for ${e}`);return i}}function Iv(t,e,i){if(!(e in t))return null;const n=fv(t[e],Wy|Vy,i);return function(t){return function(t,e){if("number"==typeof t)return t;const i=Dv(t,e);if(2!==i.length)throw new Error(`Expected an array of two numbers for ${e}`);return i}(n(t),e)}}function Av(t,e){const i=t[e];if(void 0!==i){if("number"!=typeof i)throw new Error(`Expected a number for ${e}`);return i}}function Tv(t,e){const i=t[e];if(void 0!==i){if("bottom-left"!==i&&"bottom-right"!==i&&"top-left"!==i&&"top-right"!==i)throw new Error(`Expected bottom-left, bottom-right, top-left, or top-right for ${e}`);return i}}function Rv(t,e){const i=t[e];if(void 0!==i){if("pixels"!==i&&"fraction"!==i)throw new Error(`Expected pixels or fraction for ${e}`);return i}}function Pv(t,e){const i=t[e];if(void 0!==i){if("string"!=typeof i)throw new Error(`Expected a string for ${e}`);if("declutter"!==i&&"obstacle"!==i&&"none"!==i)throw new Error(`Expected declutter, obstacle, or none for ${e}`);return i}}function Dv(t,e){if(!Array.isArray(t))throw new Error(`Expected an array for ${e}`);const i=t.length;for(let n=0;n<i;++n)if("number"!=typeof t[n])throw new Error(`Expected an array of numbers for ${e}`);return t}function Fv(t,e){if("string"!=typeof t)throw new Error(`Expected a string for ${e}`);return t}function Lv(t,e){if("number"!=typeof t)throw new Error(`Expected a number for ${e}`);return t}function Ov(t,e){if("string"==typeof t)return t;const i=Dv(t,e),n=i.length;if(n<3||n>4)throw new Error(`Expected a color with 3 or 4 values for ${e}`);return i}const Nv="renderOrder",Bv=class extends Dn{constructor(t){t=t||{};const e=Object.assign({},t);delete e.style,delete e.renderBuffer,delete e.updateWhileAnimating,delete e.updateWhileInteracting,super(e),this.declutter_=void 0!==t.declutter&&t.declutter,this.renderBuffer_=void 0!==t.renderBuffer?t.renderBuffer:100,this.style_=null,this.styleFunction_=void 0,this.setStyle(t.style),this.updateWhileAnimating_=void 0!==t.updateWhileAnimating&&t.updateWhileAnimating,this.updateWhileInteracting_=void 0!==t.updateWhileInteracting&&t.updateWhileInteracting}getDeclutter(){return this.declutter_}getFeatures(t){return super.getFeatures(t)}getRenderBuffer(){return this.renderBuffer_}getRenderOrder(){return this.get(Nv)}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}getUpdateWhileAnimating(){return this.updateWhileAnimating_}getUpdateWhileInteracting(){return this.updateWhileInteracting_}renderDeclutter(t){t.declutterTree||(t.declutterTree=new _y(9)),this.getRenderer().renderDeclutter(t)}setRenderOrder(t){this.set(Nv,t)}setStyle(t){this.style_=function(t){if(void 0===t)return Ry;if(!t)return null;if("function"==typeof t)return t;if(t instanceof Dy)return t;if(!Array.isArray(t))return wv([t]);if(0===t.length)return[];const e=t.length,i=t[0];if(i instanceof Dy){const i=new Array(e);for(let n=0;n<e;++n){const e=t[n];if(!(e instanceof Dy))throw new Error("Expected a list of style instances");i[n]=e}return i}if("style"in i){const i=new Array(e);for(let n=0;n<e;++n){const e=t[n];if(!("style"in e))throw new Error("Expected a list of rules with a style property");i[n]=e}return function(t){const e=iv(),i=function(t,e){const i=t.length,n=new Array(i);for(let r=0;r<i;++r){const i=t[r],s="filter"in i?fv(i.filter,Xy,e):_v;let o;if(Array.isArray(i.style)){const t=i.style.length;o=new Array(t);for(let n=0;n<t;++n)o[n]=yv(i.style[n],e)}else o=[yv(i.style,e)];n[r]={filter:s,styles:o}}return function(e){const r=[];let s=!1;for(let o=0;o<i;++o)if((0,n[o].filter)(e)&&(!t[o].else||!s)){s=!0;for(const t of n[o].styles){const i=t(e);i&&r.push(i)}}return r}}(t,e),n={variables:{},properties:{},resolution:NaN,featureId:null};return function(t,r){if(n.properties=t.getPropertiesInternal(),n.resolution=r,e.featureId){const e=t.getId();n.featureId=void 0!==e?e:null}return i(n)}}(i)}return wv(t)}(t),this.styleFunction_=null===t?void 0:function(t){let e;if("function"==typeof t)e=t;else{let i;Array.isArray(t)?i=t:(K("function"==typeof t.getZIndex,"Expected an `Style` or an array of `Style`"),i=[t]),e=function(){return i}}return e}(this.style_),this.changed()}},zv={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},Uv=[zv.FILL],Gv=[zv.STROKE],Yv=[zv.BEGIN_PATH],Xv=[zv.CLOSE_PATH],Vv=zv,jv=class{drawCustom(t,e,i,n){}drawGeometry(t){}setStyle(t){}drawCircle(t,e){}drawFeature(t,e){}drawGeometryCollection(t,e){}drawLineString(t,e){}drawMultiLineString(t,e){}drawMultiPoint(t,e){}drawMultiPolygon(t,e){}drawPoint(t,e){}drawPolygon(t,e){}drawText(t,e){}setFillStrokeStyle(t,e){}setImageStyle(t,e){}setTextStyle(t,e){}},qv=class extends jv{constructor(t,e,i,n){super(),this.tolerance=t,this.maxExtent=e,this.pixelRatio=n,this.maxLineWidth=0,this.resolution=i,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_=null,this.bufferedMaxExtent_=null,this.instructions=[],this.coordinates=[],this.tmpCoordinate_=[],this.hitDetectionInstructions=[],this.state={}}applyPixelRatio(t){const e=this.pixelRatio;return 1==e?t:t.map((function(t){return t*e}))}appendFlatPointCoordinates(t,e){const i=this.getBufferedMaxExtent(),n=this.tmpCoordinate_,r=this.coordinates;let s=r.length;for(let o=0,a=t.length;o<a;o+=e)n[0]=t[o],n[1]=t[o+1],ot(i,n)&&(r[s++]=n[0],r[s++]=n[1]);return s}appendFlatLineCoordinates(t,e,i,n,r,s){const o=this.coordinates;let a=o.length;const h=this.getBufferedMaxExtent();s&&(e+=n);let l=t[e],c=t[e+1];const u=this.tmpCoordinate_;let d,f,g,m=!0;for(d=e+n;d<i;d+=n)u[0]=t[d],u[1]=t[d+1],g=lt(h,u),g!==f?(m&&(o[a++]=l,o[a++]=c,m=!1),o[a++]=u[0],o[a++]=u[1]):g===et.INTERSECTING?(o[a++]=u[0],o[a++]=u[1],m=!1):m=!0,l=u[0],c=u[1],f=g;return(r&&m||d===e+n)&&(o[a++]=l,o[a++]=c),a}drawCustomCoordinates_(t,e,i,n,r){for(let s=0,o=i.length;s<o;++s){const o=i[s],a=this.appendFlatLineCoordinates(t,e,o,n,!1,!1);r.push(a),e=o}return e}drawCustom(t,e,i,n){this.beginGeometry(t,e);const r=t.getType(),s=t.getStride(),o=this.coordinates.length;let a,h,l,c,u;switch(r){case"MultiPolygon":a=t.getOrientedFlatCoordinates(),c=[];const e=t.getEndss();u=0;for(let t=0,i=e.length;t<i;++t){const i=[];u=this.drawCustomCoordinates_(a,u,e[t],s,i),c.push(i)}this.instructions.push([Vv.CUSTOM,o,c,t,i,nn]),this.hitDetectionInstructions.push([Vv.CUSTOM,o,c,t,n||i,nn]);break;case"Polygon":case"MultiLineString":l=[],a="Polygon"==r?t.getOrientedFlatCoordinates():t.getFlatCoordinates(),u=this.drawCustomCoordinates_(a,0,t.getEnds(),s,l),this.instructions.push([Vv.CUSTOM,o,l,t,i,en]),this.hitDetectionInstructions.push([Vv.CUSTOM,o,l,t,n||i,en]);break;case"LineString":case"Circle":a=t.getFlatCoordinates(),h=this.appendFlatLineCoordinates(a,0,a.length,s,!1,!1),this.instructions.push([Vv.CUSTOM,o,h,t,i,tn]),this.hitDetectionInstructions.push([Vv.CUSTOM,o,h,t,n||i,tn]);break;case"MultiPoint":a=t.getFlatCoordinates(),h=this.appendFlatPointCoordinates(a,s),h>o&&(this.instructions.push([Vv.CUSTOM,o,h,t,i,tn]),this.hitDetectionInstructions.push([Vv.CUSTOM,o,h,t,n||i,tn]));break;case"Point":a=t.getFlatCoordinates(),this.coordinates.push(a[0],a[1]),h=this.coordinates.length,this.instructions.push([Vv.CUSTOM,o,h,t,i]),this.hitDetectionInstructions.push([Vv.CUSTOM,o,h,t,n||i])}this.endGeometry(e)}beginGeometry(t,e){this.beginGeometryInstruction1_=[Vv.BEGIN_GEOMETRY,e,0,t],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[Vv.BEGIN_GEOMETRY,e,0,t],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)}finish(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}}reverseHitDetectionInstructions(){const t=this.hitDetectionInstructions;let e;t.reverse();const i=t.length;let n,r,s=-1;for(e=0;e<i;++e)n=t[e],r=n[0],r==Vv.END_GEOMETRY?s=e:r==Vv.BEGIN_GEOMETRY&&(n[2]=e,l(this.hitDetectionInstructions,s,e),s=-1)}setFillStrokeStyle(t,e){const i=this.state;if(t){const e=t.getColor();i.fillStyle=vy(e||Kn)}else i.fillStyle=void 0;if(e){const t=e.getColor();i.strokeStyle=vy(t||Qn);const n=e.getLineCap();i.lineCap=void 0!==n?n:Hn;const r=e.getLineDash();i.lineDash=r?r.slice():$n;const s=e.getLineDashOffset();i.lineDashOffset=s||0;const o=e.getLineJoin();i.lineJoin=void 0!==o?o:Jn;const a=e.getWidth();i.lineWidth=void 0!==a?a:1;const h=e.getMiterLimit();i.miterLimit=void 0!==h?h:10,i.lineWidth>this.maxLineWidth&&(this.maxLineWidth=i.lineWidth,this.bufferedMaxExtent_=null)}else i.strokeStyle=void 0,i.lineCap=void 0,i.lineDash=null,i.lineDashOffset=void 0,i.lineJoin=void 0,i.lineWidth=void 0,i.miterLimit=void 0}createFill(t){const e=t.fillStyle,i=[Vv.SET_FILL_STYLE,e];return"string"!=typeof e&&i.push(!0),i}applyStroke(t){this.instructions.push(this.createStroke(t))}createStroke(t){return[Vv.SET_STROKE_STYLE,t.strokeStyle,t.lineWidth*this.pixelRatio,t.lineCap,t.lineJoin,t.miterLimit,this.applyPixelRatio(t.lineDash),t.lineDashOffset*this.pixelRatio]}updateFillStyle(t,e){const i=t.fillStyle;"string"==typeof i&&t.currentFillStyle==i||(void 0!==i&&this.instructions.push(e.call(this,t)),t.currentFillStyle=i)}updateStrokeStyle(t,e){const i=t.strokeStyle,n=t.lineCap,r=t.lineDash,s=t.lineDashOffset,o=t.lineJoin,a=t.lineWidth,h=t.miterLimit;(t.currentStrokeStyle!=i||t.currentLineCap!=n||r!=t.currentLineDash&&!u(t.currentLineDash,r)||t.currentLineDashOffset!=s||t.currentLineJoin!=o||t.currentLineWidth!=a||t.currentMiterLimit!=h)&&(void 0!==i&&e.call(this,t),t.currentStrokeStyle=i,t.currentLineCap=n,t.currentLineDash=r,t.currentLineDashOffset=s,t.currentLineJoin=o,t.currentLineWidth=a,t.currentMiterLimit=h)}endGeometry(t){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;const e=[Vv.END_GEOMETRY,t];this.instructions.push(e),this.hitDetectionInstructions.push(e)}getBufferedMaxExtent(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=rt(this.maxExtent),this.maxLineWidth>0)){const t=this.resolution*(this.maxLineWidth+1)/2;nt(this.bufferedMaxExtent_,t,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_}},Wv=class extends qv{constructor(t,e,i,n){super(t,e,i,n)}drawFlatCoordinatess_(t,e,i,n){const r=this.state,s=void 0!==r.fillStyle,o=void 0!==r.strokeStyle,a=i.length;this.instructions.push(Yv),this.hitDetectionInstructions.push(Yv);for(let r=0;r<a;++r){const s=i[r],a=this.coordinates.length,h=this.appendFlatLineCoordinates(t,e,s,n,!0,!o),l=[Vv.MOVE_TO_LINE_TO,a,h];this.instructions.push(l),this.hitDetectionInstructions.push(l),o&&(this.instructions.push(Xv),this.hitDetectionInstructions.push(Xv)),e=s}return s&&(this.instructions.push(Uv),this.hitDetectionInstructions.push(Uv)),o&&(this.instructions.push(Gv),this.hitDetectionInstructions.push(Gv)),e}drawCircle(t,e){const i=this.state,n=i.fillStyle,r=i.strokeStyle;if(void 0===n&&void 0===r)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e),void 0!==i.fillStyle&&this.hitDetectionInstructions.push([Vv.SET_FILL_STYLE,Kn]),void 0!==i.strokeStyle&&this.hitDetectionInstructions.push([Vv.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,$n,0]);const s=t.getFlatCoordinates(),o=t.getStride(),a=this.coordinates.length;this.appendFlatLineCoordinates(s,0,s.length,o,!1,!1);const h=[Vv.CIRCLE,a];this.instructions.push(Yv,h),this.hitDetectionInstructions.push(Yv,h),void 0!==i.fillStyle&&(this.instructions.push(Uv),this.hitDetectionInstructions.push(Uv)),void 0!==i.strokeStyle&&(this.instructions.push(Gv),this.hitDetectionInstructions.push(Gv)),this.endGeometry(e)}drawPolygon(t,e){const i=this.state,n=i.fillStyle,r=i.strokeStyle;if(void 0===n&&void 0===r)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e),void 0!==i.fillStyle&&this.hitDetectionInstructions.push([Vv.SET_FILL_STYLE,Kn]),void 0!==i.strokeStyle&&this.hitDetectionInstructions.push([Vv.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,$n,0]);const s=t.getEnds(),o=t.getOrientedFlatCoordinates(),a=t.getStride();this.drawFlatCoordinatess_(o,0,s,a),this.endGeometry(e)}drawMultiPolygon(t,e){const i=this.state,n=i.fillStyle,r=i.strokeStyle;if(void 0===n&&void 0===r)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e),void 0!==i.fillStyle&&this.hitDetectionInstructions.push([Vv.SET_FILL_STYLE,Kn]),void 0!==i.strokeStyle&&this.hitDetectionInstructions.push([Vv.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,$n,0]);const s=t.getEndss(),o=t.getOrientedFlatCoordinates(),a=t.getStride();let h=0;for(let t=0,e=s.length;t<e;++t)h=this.drawFlatCoordinatess_(o,h,s[t],a);this.endGeometry(e)}finish(){this.reverseHitDetectionInstructions(),this.state=null;const t=this.tolerance;if(0!==t){const e=this.coordinates;for(let i=0,n=e.length;i<n;++i)e[i]=$i(e[i],t)}return super.finish()}setFillStrokeStyles_(){const t=this.state;void 0!==t.fillStyle&&this.updateFillStyle(t,this.createFill),void 0!==t.strokeStyle&&this.updateStrokeStyle(t,this.applyStroke)}};function Zv(t,e,i,n,r){const s=[];let o=i,a=0,h=e.slice(i,2);for(;a<t&&o+r<n;){const[i,n]=h.slice(-2),l=e[o+r],c=e[o+r+1],u=Math.sqrt((l-i)*(l-i)+(c-n)*(c-n));if(a+=u,a>=t){const e=(t-a+u)/u,d=$t(i,l,e),f=$t(n,c,e);h.push(d,f),s.push(h),h=[d,f],a==t&&(o+=r),a=0}else if(a<t)h.push(e[o+r],e[o+r+1]),o+=r;else{const t=u-a,e=$t(i,l,t/u),d=$t(n,c,t/u);h.push(e,d),s.push(h),h=[e,d],a=0,o+=r}}return a>0&&s.push(h),s}function Kv(t,e,i,n,r){let s,o,a,h,l,c,u,d,f,g,m=i,p=i,_=0,w=0,y=i;for(o=i;o<n;o+=r){const i=e[o],n=e[o+1];void 0!==l&&(f=i-l,g=n-c,h=Math.sqrt(f*f+g*g),void 0!==u&&(w+=a,s=Math.acos((u*f+d*g)/(a*h)),s>t&&(w>_&&(_=w,m=y,p=o),w=0,y=o-r)),a=h,u=f,d=g),l=i,c=n}return w+=h,w>_?[y,o]:[m,p]}const Hv={left:0,center:.5,right:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1},$v={Circle:Wv,Default:qv,Image:class extends qv{constructor(t,e,i,n){super(t,e,i,n),this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.anchorX_=void 0,this.anchorY_=void 0,this.height_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.scale_=void 0,this.width_=void 0,this.declutterMode_=void 0,this.declutterImageWithText_=void 0}drawPoint(t,e){if(!this.image_)return;this.beginGeometry(t,e);const i=t.getFlatCoordinates(),n=t.getStride(),r=this.coordinates.length,s=this.appendFlatPointCoordinates(i,n);this.instructions.push([Vv.DRAW_IMAGE,r,s,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([Vv.DRAW_IMAGE,r,s,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(e)}drawMultiPoint(t,e){if(!this.image_)return;this.beginGeometry(t,e);const i=t.getFlatCoordinates(),n=t.getStride(),r=this.coordinates.length,s=this.appendFlatPointCoordinates(i,n);this.instructions.push([Vv.DRAW_IMAGE,r,s,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([Vv.DRAW_IMAGE,r,s,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(e)}finish(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,super.finish()}setImageStyle(t,e){const i=t.getAnchor(),n=t.getSize(),r=t.getOrigin();this.imagePixelRatio_=t.getPixelRatio(this.pixelRatio),this.anchorX_=i[0],this.anchorY_=i[1],this.hitDetectionImage_=t.getHitDetectionImage(),this.image_=t.getImage(this.pixelRatio),this.height_=n[1],this.opacity_=t.getOpacity(),this.originX_=r[0],this.originY_=r[1],this.rotateWithView_=t.getRotateWithView(),this.rotation_=t.getRotation(),this.scale_=t.getScaleArray(),this.width_=n[0],this.declutterMode_=t.getDeclutterMode(),this.declutterImageWithText_=e}},LineString:class extends qv{constructor(t,e,i,n){super(t,e,i,n)}drawFlatCoordinates_(t,e,i,n){const r=this.coordinates.length,s=this.appendFlatLineCoordinates(t,e,i,n,!1,!1),o=[Vv.MOVE_TO_LINE_TO,r,s];return this.instructions.push(o),this.hitDetectionInstructions.push(o),i}drawLineString(t,e){const i=this.state,n=i.strokeStyle,r=i.lineWidth;if(void 0===n||void 0===r)return;this.updateStrokeStyle(i,this.applyStroke),this.beginGeometry(t,e),this.hitDetectionInstructions.push([Vv.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,$n,0],Yv);const s=t.getFlatCoordinates(),o=t.getStride();this.drawFlatCoordinates_(s,0,s.length,o),this.hitDetectionInstructions.push(Gv),this.endGeometry(e)}drawMultiLineString(t,e){const i=this.state,n=i.strokeStyle,r=i.lineWidth;if(void 0===n||void 0===r)return;this.updateStrokeStyle(i,this.applyStroke),this.beginGeometry(t,e),this.hitDetectionInstructions.push([Vv.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,$n,0],Yv);const s=t.getEnds(),o=t.getFlatCoordinates(),a=t.getStride();let h=0;for(let t=0,e=s.length;t<e;++t)h=this.drawFlatCoordinates_(o,h,s[t],a);this.hitDetectionInstructions.push(Gv),this.endGeometry(e)}finish(){const t=this.state;return null!=t.lastStroke&&t.lastStroke!=this.coordinates.length&&this.instructions.push(Gv),this.reverseHitDetectionInstructions(),this.state=null,super.finish()}applyStroke(t){null!=t.lastStroke&&t.lastStroke!=this.coordinates.length&&(this.instructions.push(Gv),t.lastStroke=this.coordinates.length),t.lastStroke=0,super.applyStroke(t),this.instructions.push(Yv)}},Polygon:Wv,Text:class extends qv{constructor(t,e,i,n){super(t,e,i,n),this.labels_=null,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=void 0,this.textRotation_=0,this.textFillState_=null,this.fillStates={},this.fillStates[Kn]={fillStyle:Kn},this.textStrokeState_=null,this.strokeStates={},this.textState_={},this.textStates={},this.textKey_="",this.fillKey_="",this.strokeKey_="",this.declutterImageWithText_=void 0}finish(){const t=super.finish();return t.textStates=this.textStates,t.fillStates=this.fillStates,t.strokeStates=this.strokeStates,t}drawText(t,e){const i=this.textFillState_,n=this.textStrokeState_,r=this.textState_;if(""===this.text_||!r||!i&&!n)return;const s=this.coordinates;let o=s.length;const a=t.getType();let h=null,l=t.getStride();if("line"!==r.placement||"LineString"!=a&&"MultiLineString"!=a&&"Polygon"!=a&&"MultiPolygon"!=a){let i=r.overflow?null:[];switch(a){case"Point":case"MultiPoint":h=t.getFlatCoordinates();break;case"LineString":h=t.getFlatMidpoint();break;case"Circle":h=t.getCenter();break;case"MultiLineString":h=t.getFlatMidpoints(),l=2;break;case"Polygon":h=t.getFlatInteriorPoint(),r.overflow||i.push(h[2]/this.resolution),l=3;break;case"MultiPolygon":const e=t.getFlatInteriorPoints();h=[];for(let t=0,n=e.length;t<n;t+=3)r.overflow||i.push(e[t+2]/this.resolution),h.push(e[t],e[t+1]);if(0===h.length)return;l=2}const n=this.appendFlatPointCoordinates(h,l);if(n===o)return;if(i&&(n-o)/2!=h.length/l){let t=o/2;i=i.filter(((e,i)=>{const n=s[2*(t+i)]===h[i*l]&&s[2*(t+i)+1]===h[i*l+1];return n||--t,n}))}this.saveTextStates_(),(r.backgroundFill||r.backgroundStroke)&&(this.setFillStrokeStyle(r.backgroundFill,r.backgroundStroke),r.backgroundFill&&this.updateFillStyle(this.state,this.createFill),r.backgroundStroke&&(this.updateStrokeStyle(this.state,this.applyStroke),this.hitDetectionInstructions.push(this.createStroke(this.state)))),this.beginGeometry(t,e);let c=r.padding;if(c!=ir&&(r.scale[0]<0||r.scale[1]<0)){let t=r.padding[0],e=r.padding[1],i=r.padding[2],n=r.padding[3];r.scale[0]<0&&(e=-e,n=-n),r.scale[1]<0&&(t=-t,i=-i),c=[t,e,i,n]}const u=this.pixelRatio;this.instructions.push([Vv.DRAW_IMAGE,o,n,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,void 0,this.declutterImageWithText_,c==ir?ir:c.map((function(t){return t*u})),!!r.backgroundFill,!!r.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,i]);const d=1/u,f=this.state.fillStyle;r.backgroundFill&&(this.state.fillStyle=Kn,this.hitDetectionInstructions.push(this.createFill(this.state))),this.hitDetectionInstructions.push([Vv.DRAW_IMAGE,o,n,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[d,d],NaN,void 0,this.declutterImageWithText_,c,!!r.backgroundFill,!!r.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_?Kn:this.fillKey_,this.textOffsetX_,this.textOffsetY_,i]),r.backgroundFill&&(this.state.fillStyle=f,this.hitDetectionInstructions.push(this.createFill(this.state))),this.endGeometry(e)}else{if(!Pt(this.getBufferedMaxExtent(),t.getExtent()))return;let i;if(h=t.getFlatCoordinates(),"LineString"==a)i=[h.length];else if("MultiLineString"==a)i=t.getEnds();else if("Polygon"==a)i=t.getEnds().slice(0,1);else if("MultiPolygon"==a){const e=t.getEndss();i=[];for(let t=0,n=e.length;t<n;++t)i.push(e[t][0])}this.beginGeometry(t,e);const n=r.repeat,c=n?void 0:r.textAlign;let u=0;for(let t=0,e=i.length;t<e;++t){let e;e=n?Zv(n*this.resolution,h,u,i[t],l):[h.slice(u,i[t])];for(let n=0,a=e.length;n<a;++n){const a=e[n];let h=0,d=a.length;if(null==c){const t=Kv(r.maxAngle,a,0,a.length,2);h=t[0],d=t[1]}for(let t=h;t<d;t+=l)s.push(a[t],a[t+1]);const f=s.length;u=i[t],this.drawChars_(o,f),o=f}}this.endGeometry(e)}}saveTextStates_(){const t=this.textStrokeState_,e=this.textState_,i=this.textFillState_,n=this.strokeKey_;t&&(n in this.strokeStates||(this.strokeStates[n]={strokeStyle:t.strokeStyle,lineCap:t.lineCap,lineDashOffset:t.lineDashOffset,lineWidth:t.lineWidth,lineJoin:t.lineJoin,miterLimit:t.miterLimit,lineDash:t.lineDash}));const r=this.textKey_;r in this.textStates||(this.textStates[r]={font:e.font,textAlign:e.textAlign||tr,justify:e.justify,textBaseline:e.textBaseline||er,scale:e.scale});const s=this.fillKey_;i&&(s in this.fillStates||(this.fillStates[s]={fillStyle:i.fillStyle}))}drawChars_(t,e){const i=this.textStrokeState_,n=this.textState_,r=this.strokeKey_,s=this.textKey_,o=this.fillKey_;this.saveTextStates_();const a=this.pixelRatio,h=Hv[n.textBaseline],l=this.textOffsetY_*a,c=this.text_,u=i?i.lineWidth*Math.abs(n.scale[0])/2:0;this.instructions.push([Vv.DRAW_CHARS,t,e,h,n.overflow,o,n.maxAngle,a,l,r,u*a,c,s,1]),this.hitDetectionInstructions.push([Vv.DRAW_CHARS,t,e,h,n.overflow,o?Kn:o,n.maxAngle,a,l,r,u*a,c,s,1/a])}setTextStyle(t,e){let i,n,r;if(t){const e=t.getFill();e?(n=this.textFillState_,n||(n={},this.textFillState_=n),n.fillStyle=vy(e.getColor()||Kn)):(n=null,this.textFillState_=n);const s=t.getStroke();if(s){r=this.textStrokeState_,r||(r={},this.textStrokeState_=r);const t=s.getLineDash(),e=s.getLineDashOffset(),i=s.getWidth(),n=s.getMiterLimit();r.lineCap=s.getLineCap()||Hn,r.lineDash=t?t.slice():$n,r.lineDashOffset=void 0===e?0:e,r.lineJoin=s.getLineJoin()||Jn,r.lineWidth=void 0===i?1:i,r.miterLimit=void 0===n?10:n,r.strokeStyle=vy(s.getColor()||Qn)}else r=null,this.textStrokeState_=r;i=this.textState_;const o=t.getFont()||Zn;ar(o);const a=t.getScaleArray();i.overflow=t.getOverflow(),i.font=o,i.maxAngle=t.getMaxAngle(),i.placement=t.getPlacement(),i.textAlign=t.getTextAlign(),i.repeat=t.getRepeat(),i.justify=t.getJustify(),i.textBaseline=t.getTextBaseline()||er,i.backgroundFill=t.getBackgroundFill(),i.backgroundStroke=t.getBackgroundStroke(),i.padding=t.getPadding()||ir,i.scale=void 0===a?[1,1]:a;const h=t.getOffsetX(),l=t.getOffsetY(),c=t.getRotateWithView(),u=t.getRotation();this.text_=t.getText()||"",this.textOffsetX_=void 0===h?0:h,this.textOffsetY_=void 0===l?0:l,this.textRotateWithView_=void 0!==c&&c,this.textRotation_=void 0===u?0:u,this.strokeKey_=r?("string"==typeof r.strokeStyle?r.strokeStyle:D(r.strokeStyle))+r.lineCap+r.lineDashOffset+"|"+r.lineWidth+r.lineJoin+r.miterLimit+"["+r.lineDash.join()+"]":"",this.textKey_=i.font+i.scale+(i.textAlign||"?")+(i.repeat||"?")+(i.justify||"?")+(i.textBaseline||"?"),this.fillKey_=n?"string"==typeof n.fillStyle?n.fillStyle:"|"+D(n.fillStyle):""}else this.text_="";this.declutterImageWithText_=e}}},Jv=class{constructor(t,e,i,n){this.tolerance_=t,this.maxExtent_=e,this.pixelRatio_=n,this.resolution_=i,this.buildersByZIndex_={}}finish(){const t={};for(const e in this.buildersByZIndex_){t[e]=t[e]||{};const i=this.buildersByZIndex_[e];for(const n in i){const r=i[n].finish();t[e][n]=r}}return t}getBuilder(t,e){const i=void 0!==t?t.toString():"0";let n=this.buildersByZIndex_[i];void 0===n&&(n={},this.buildersByZIndex_[i]=n);let r=n[e];return void 0===r&&(r=new(0,$v[e])(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),n[e]=r),r}};function Qv(t,e,i,n,r,s,o,a,h,l,c,u){let d=t[e],f=t[e+1],g=0,m=0,p=0,_=0;function w(){g=d,m=f,d=t[e+=n],f=t[e+1],_+=p,p=Math.sqrt((d-g)*(d-g)+(f-m)*(f-m))}do{w()}while(e<i-n&&_+p<s);let y=0===p?0:(s-_)/p;const v=$t(g,d,y),b=$t(m,f,y),x=e-n,M=_,E=s+a*h(l,r,c);for(;e<i-n&&_+p<E;)w();y=0===p?0:(E-_)/p;const S=$t(g,d,y),k=$t(m,f,y);let C;if(u){const t=[v,b,S,k];Li(t,0,4,2,u,t,t),C=t[0]>t[2]}else C=v>S;const I=Math.PI,A=[],T=x+n===e;let R;if(p=0,_=M,d=t[e=x],f=t[e+1],T){w(),R=Math.atan2(f-m,d-g),C&&(R+=R>0?-I:I);const t=(S+v)/2,e=(k+b)/2;return A[0]=[t,e,(E-s)/2,R,r],A}for(let t=0,u=(r=r.replace(/\n/g," ")).length;t<u;){w();let v=Math.atan2(f-m,d-g);if(C&&(v+=v>0?-I:I),void 0!==R){let t=v-R;if(t+=t>I?-2*I:t<-I?2*I:0,Math.abs(t)>o)return null}R=v;const b=t;let x=0;for(;t<u;++t){const o=a*h(l,r[C?u-t-1:t],c);if(e+n<i&&_+p<s+x+o/2)break;x+=o}if(t===b)continue;const M=C?r.substring(u-b,u-t):r.substring(b,t);y=0===p?0:(s+x/2-_)/p;const E=$t(g,d,y),S=$t(m,f,y);A.push([E,S,x/2,v,M]),s+=x}return A}function tb(t,e,i,n){let r=t[e],s=t[e+1],o=0;for(let a=e+n;a<i;a+=n){const e=t[a],i=t[a+1];o+=Math.sqrt((e-r)*(e-r)+(i-s)*(i-s)),r=e,s=i}return o}const eb=[1/0,1/0,-1/0,-1/0],ib=[],nb=[],rb=[],sb=[];function ob(t){return t[3].declutterBox}const ab=new RegExp("["+String.fromCharCode(1425)+"-"+String.fromCharCode(2303)+String.fromCharCode(64285)+"-"+String.fromCharCode(65023)+String.fromCharCode(65136)+"-"+String.fromCharCode(65276)+String.fromCharCode(67584)+"-"+String.fromCharCode(69631)+String.fromCharCode(124928)+"-"+String.fromCharCode(126975)+"]");function hb(t,e){return"start"===e?e=ab.test(t)?"right":"left":"end"===e&&(e=ab.test(t)?"left":"right"),Hv[e]}function lb(t,e,i){return i>0&&t.push("\n",""),t.push(e,""),t}const cb=class{constructor(t,e,i,n){this.overlaps=i,this.pixelRatio=e,this.resolution=t,this.alignFill_,this.instructions=n.instructions,this.coordinates=n.coordinates,this.coordinateCache_={},this.renderedTransform_=[1,0,0,1,0,0],this.hitDetectionInstructions=n.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=n.fillStates||{},this.strokeStates=n.strokeStates||{},this.textStates=n.textStates||{},this.widths_={},this.labels_={}}createLabel(t,e,i,n){const r=t+e+i+n;if(this.labels_[r])return this.labels_[r];const s=n?this.strokeStates[n]:null,o=i?this.fillStates[i]:null,a=this.textStates[e],h=this.pixelRatio,l=[a.scale[0]*h,a.scale[1]*h],c=Array.isArray(t),u=a.justify?Hv[a.justify]:hb(Array.isArray(t)?t[0]:t,a.textAlign||tr),d=n&&s.lineWidth?s.lineWidth:0,f=c?t:t.split("\n").reduce(lb,[]),{width:g,height:m,widths:p,heights:_,lineWidths:w}=function(t,e){const i=[],n=[],r=[];let s=0,o=0,a=0,h=0;for(let l=0,c=e.length;l<=c;l+=2){const u=e[l];if("\n"===u||l===c){s=Math.max(s,o),r.push(o),o=0,a+=h;continue}const d=e[l+1]||t.font,f=cr(d,u);i.push(f),o+=f;const g=hr(d);n.push(g),h=Math.max(h,g)}return{width:s,height:a,widths:i,heights:n,lineWidths:r}}(a,f),y=g+d,v=[],b=(y+2)*l[0],x=(m+d)*l[1],M={width:b<0?Math.floor(b):Math.ceil(b),height:x<0?Math.floor(x):Math.ceil(x),contextInstructions:v};1==l[0]&&1==l[1]||v.push("scale",l),n&&(v.push("strokeStyle",s.strokeStyle),v.push("lineWidth",d),v.push("lineCap",s.lineCap),v.push("lineJoin",s.lineJoin),v.push("miterLimit",s.miterLimit),v.push("setLineDash",[s.lineDash]),v.push("lineDashOffset",s.lineDashOffset)),i&&v.push("fillStyle",o.fillStyle),v.push("textBaseline","middle"),v.push("textAlign","center");const E=.5-u;let S=u*y+E*d;const k=[],C=[];let I,A=0,T=0,R=0,P=0;for(let t=0,e=f.length;t<e;t+=2){const e=f[t];if("\n"===e){T+=A,A=0,S=u*y+E*d,++P;continue}const r=f[t+1]||a.font;r!==I&&(n&&k.push("font",r),i&&C.push("font",r),I=r),A=Math.max(A,_[R]);const s=[e,S+E*p[R]+u*(p[R]-w[P]),.5*(d+A)+T];S+=p[R],n&&k.push("strokeText",s),i&&C.push("fillText",s),++R}return Array.prototype.push.apply(v,k),Array.prototype.push.apply(v,C),this.labels_[r]=M,M}replayTextBackground_(t,e,i,n,r,s,o){t.beginPath(),t.moveTo.apply(t,e),t.lineTo.apply(t,i),t.lineTo.apply(t,n),t.lineTo.apply(t,r),t.lineTo.apply(t,e),s&&(this.alignFill_=s[2],this.fill_(t)),o&&(this.setStrokeStyle_(t,o),t.stroke())}calculateImageOrLabelDimensions_(t,e,i,n,r,s,o,a,h,l,c,u,d,f,g,m){let p=i-(o*=u[0]),_=n-(a*=u[1]);const w=r+h>t?t-h:r,y=s+l>e?e-l:s,v=f[3]+w*u[0]+f[1],b=f[0]+y*u[1]+f[2],x=p-f[3],M=_-f[0];let E;return(g||0!==c)&&(ib[0]=x,sb[0]=x,ib[1]=M,nb[1]=M,nb[0]=x+v,rb[0]=nb[0],rb[1]=M+b,sb[1]=rb[1]),0!==c?(E=$([1,0,0,1,0,0],i,n,1,1,c,-i,-n),H(E,ib),H(E,nb),H(E,rb),H(E,sb),ct(Math.min(ib[0],nb[0],rb[0],sb[0]),Math.min(ib[1],nb[1],rb[1],sb[1]),Math.max(ib[0],nb[0],rb[0],sb[0]),Math.max(ib[1],nb[1],rb[1],sb[1]),eb)):ct(Math.min(x,x+v),Math.min(M,M+b),Math.max(x,x+v),Math.max(M,M+b),eb),d&&(p=Math.round(p),_=Math.round(_)),{drawImageX:p,drawImageY:_,drawImageW:w,drawImageH:y,originX:h,originY:l,declutterBox:{minX:eb[0],minY:eb[1],maxX:eb[2],maxY:eb[3],value:m},canvasTransform:E,scale:u}}replayImageOrLabel_(t,e,i,n,r,s,o){const a=!(!s&&!o),h=n.declutterBox,l=t.canvas,c=o?o[2]*n.scale[0]/2:0;return h.minX-c<=l.width/e&&h.maxX+c>=0&&h.minY-c<=l.height/e&&h.maxY+c>=0&&(a&&this.replayTextBackground_(t,ib,nb,rb,sb,s,o),function(t,e,i,n,r,s,o,a,h,l,c){t.save(),1!==i&&(t.globalAlpha*=i),e&&t.transform.apply(t,e),n.contextInstructions?(t.translate(h,l),t.scale(c[0],c[1]),function(t,e){const i=t.contextInstructions;for(let t=0,n=i.length;t<n;t+=2)Array.isArray(i[t+1])?e[i[t]].apply(e,i[t+1]):e[i[t]]=i[t+1]}(n,t)):c[0]<0||c[1]<0?(t.translate(h,l),t.scale(c[0],c[1]),t.drawImage(n,r,s,o,a,0,0,o,a)):t.drawImage(n,r,s,o,a,h,l,o*c[0],a*c[1]),t.restore()}(t,n.canvasTransform,r,i,n.originX,n.originY,n.drawImageW,n.drawImageH,n.drawImageX,n.drawImageY,n.scale)),!0}fill_(t){if(this.alignFill_){const e=H(this.renderedTransform_,[0,0]),i=512*this.pixelRatio;t.save(),t.translate(e[0]%i,e[1]%i),t.rotate(this.viewRotation_)}t.fill(),this.alignFill_&&t.restore()}setStrokeStyle_(t,e){t.strokeStyle=e[1],t.lineWidth=e[2],t.lineCap=e[3],t.lineJoin=e[4],t.miterLimit=e[5],t.lineDashOffset=e[7],t.setLineDash(e[6])}drawLabelWithPointPlacement_(t,e,i,n){const r=this.textStates[e],s=this.createLabel(t,e,n,i),o=this.strokeStates[i],a=this.pixelRatio,h=hb(Array.isArray(t)?t[0]:t,r.textAlign||tr),l=Hv[r.textBaseline||er],c=o&&o.lineWidth?o.lineWidth:0;return{label:s,anchorX:h*(s.width/a-2*r.scale[0])+2*(.5-h)*c,anchorY:l*s.height/a+2*(.5-l)*c}}execute_(t,e,i,n,r,s,o,a){let h;var l,c;this.pixelCoordinates_&&u(i,this.renderedTransform_)?h=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),h=Fi(this.coordinates,0,this.coordinates.length,2,i,this.pixelCoordinates_),c=i,(l=this.renderedTransform_)[0]=c[0],l[1]=c[1],l[2]=c[2],l[3]=c[3],l[4]=c[4],l[5]=c[5]);let d=0;const f=n.length;let g,m,p,_,w,y,v,b,x,M,E,S,k=0,C=0,I=0,A=null,T=null;const R=this.coordinateCache_,P=this.viewRotation_,D=Math.round(1e12*Math.atan2(-i[1],i[0]))/1e12,F={context:t,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:P},L=this.instructions!=n||this.overlaps?0:200;let O,N,B,z;for(;d<f;){const i=n[d];switch(i[0]){case Vv.BEGIN_GEOMETRY:O=i[1],z=i[3],O.getGeometry()?void 0===o||Pt(o,z.getExtent())?++d:d=i[2]+1:d=i[2];break;case Vv.BEGIN_PATH:C>L&&(this.fill_(t),C=0),I>L&&(t.stroke(),I=0),C||I||(t.beginPath(),_=NaN,w=NaN),++d;break;case Vv.CIRCLE:k=i[1];const n=h[k],l=h[k+1],c=h[k+2]-n,u=h[k+3]-l,f=Math.sqrt(c*c+u*u);t.moveTo(n+f,l),t.arc(n,l,f,0,2*Math.PI,!0),++d;break;case Vv.CLOSE_PATH:t.closePath(),++d;break;case Vv.CUSTOM:k=i[1],g=i[2];const U=i[3],G=i[4],Y=6==i.length?i[5]:void 0;F.geometry=U,F.feature=O,d in R||(R[d]=[]);const X=R[d];Y?Y(h,k,g,2,X):(X[0]=h[k],X[1]=h[k+1],X.length=2),G(X,F),++d;break;case Vv.DRAW_IMAGE:k=i[1],g=i[2],b=i[3],m=i[4],p=i[5];let V=i[6];const j=i[7],q=i[8],W=i[9],Z=i[10];let K=i[11];const H=i[12];let $=i[13];const J=i[14],Q=i[15];if(!b&&i.length>=20){x=i[19],M=i[20],E=i[21],S=i[22];const t=this.drawLabelWithPointPlacement_(x,M,E,S);b=t.label,i[3]=b;const e=i[23];m=(t.anchorX-e)*this.pixelRatio,i[4]=m;const n=i[24];p=(t.anchorY-n)*this.pixelRatio,i[5]=p,V=b.height,i[6]=V,$=b.width,i[13]=$}let tt,et,it,nt;i.length>25&&(tt=i[25]),i.length>17?(et=i[16],it=i[17],nt=i[18]):(et=ir,it=!1,nt=!1),Z&&D?K+=P:Z||D||(K-=P);let rt=0;for(;k<g;k+=2){if(tt&&tt[rt++]<$/this.pixelRatio)continue;const i=this.calculateImageOrLabelDimensions_(b.width,b.height,h[k],h[k+1],$,V,m,p,q,W,K,H,r,et,it||nt,O),n=[t,e,b,i,j,it?A:null,nt?T:null];if(a){if("none"===J)continue;if("obstacle"===J){a.insert(i.declutterBox);continue}{let t,e;if(Q){const i=g-k;if(!Q[i]){Q[i]=n;continue}if(t=Q[i],delete Q[i],e=ob(t),a.collides(e))continue}if(a.collides(i.declutterBox))continue;t&&(a.insert(e),this.replayImageOrLabel_.apply(this,t)),a.insert(i.declutterBox)}}this.replayImageOrLabel_.apply(this,n)}++d;break;case Vv.DRAW_CHARS:const st=i[1],ot=i[2],at=i[3],ht=i[4];S=i[5];const lt=i[6],ct=i[7],ut=i[8];E=i[9];const dt=i[10];x=i[11],M=i[12];const ft=[i[13],i[13]],gt=this.textStates[M],mt=gt.font,pt=[gt.scale[0]*ct,gt.scale[1]*ct];let _t;mt in this.widths_?_t=this.widths_[mt]:(_t={},this.widths_[mt]=_t);const wt=tb(h,st,ot,2),yt=Math.abs(pt[0])*ur(mt,x,_t);if(ht||yt<=wt){const i=Qv(h,st,ot,2,x,(wt-yt)*hb(x,this.textStates[M].textAlign),lt,Math.abs(pt[0]),ur,mt,_t,D?0:this.viewRotation_);t:if(i){const n=[];let r,s,o,h,l;if(E)for(r=0,s=i.length;r<s;++r){l=i[r],o=l[4],h=this.createLabel(o,M,"",E),m=l[2]+(pt[0]<0?-dt:dt),p=at*h.height+2*(.5-at)*dt*pt[1]/pt[0]-ut;const s=this.calculateImageOrLabelDimensions_(h.width,h.height,l[0],l[1],h.width,h.height,m,p,0,0,l[3],ft,!1,ir,!1,O);if(a&&a.collides(s.declutterBox))break t;n.push([t,e,h,s,1,null,null])}if(S)for(r=0,s=i.length;r<s;++r){l=i[r],o=l[4],h=this.createLabel(o,M,S,""),m=l[2],p=at*h.height-ut;const s=this.calculateImageOrLabelDimensions_(h.width,h.height,l[0],l[1],h.width,h.height,m,p,0,0,l[3],ft,!1,ir,!1,O);if(a&&a.collides(s.declutterBox))break t;n.push([t,e,h,s,1,null,null])}a&&a.load(n.map(ob));for(let t=0,e=n.length;t<e;++t)this.replayImageOrLabel_.apply(this,n[t])}}++d;break;case Vv.END_GEOMETRY:if(void 0!==s){O=i[1];const t=s(O,z);if(t)return t}++d;break;case Vv.FILL:L?C++:this.fill_(t),++d;break;case Vv.MOVE_TO_LINE_TO:for(k=i[1],g=i[2],N=h[k],B=h[k+1],y=N+.5|0,v=B+.5|0,y===_&&v===w||(t.moveTo(N,B),_=y,w=v),k+=2;k<g;k+=2)N=h[k],B=h[k+1],y=N+.5|0,v=B+.5|0,k!=g-2&&y===_&&v===w||(t.lineTo(N,B),_=y,w=v);++d;break;case Vv.SET_FILL_STYLE:A=i,this.alignFill_=i[2],C&&(this.fill_(t),C=0,I&&(t.stroke(),I=0)),t.fillStyle=i[1],++d;break;case Vv.SET_STROKE_STYLE:T=i,I&&(t.stroke(),I=0),this.setStrokeStyle_(t,i),++d;break;case Vv.STROKE:L?I++:t.stroke(),++d;break;default:++d}}C&&this.fill_(t),I&&t.stroke()}execute(t,e,i,n,r,s){this.viewRotation_=n,this.execute_(t,e,i,this.instructions,r,void 0,void 0,s)}executeHitDetection(t,e,i,n,r){return this.viewRotation_=i,this.execute_(t,1,e,this.hitDetectionInstructions,!0,n,r)}},ub=["Polygon","Circle","LineString","Image","Text","Default"],db={},fb=class{constructor(t,e,i,n,r,s){this.maxExtent_=t,this.overlaps_=n,this.pixelRatio_=i,this.resolution_=e,this.renderBuffer_=s,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=[1,0,0,1,0,0],this.createExecutors_(r)}clip(t,e){const i=this.getClipCoords(e);t.beginPath(),t.moveTo(i[0],i[1]),t.lineTo(i[2],i[3]),t.lineTo(i[4],i[5]),t.lineTo(i[6],i[7]),t.clip()}createExecutors_(t){for(const e in t){let i=this.executorsByZIndex_[e];void 0===i&&(i={},this.executorsByZIndex_[e]=i);const n=t[e];for(const t in n){const e=n[t];i[t]=new cb(this.resolution_,this.pixelRatio_,this.overlaps_,e)}}}hasExecutors(t){for(const e in this.executorsByZIndex_){const i=this.executorsByZIndex_[e];for(let e=0,n=t.length;e<n;++e)if(t[e]in i)return!0}return!1}forEachFeatureAtCoordinate(t,e,i,n,r,s){const o=2*(n=Math.round(n))+1,h=$(this.hitDetectionTransform_,n+.5,n+.5,1/e,-1/e,-i,-t[0],-t[1]),l=!this.hitDetectionContext_;l&&(this.hitDetectionContext_=Vn(o,o,void 0,{willReadFrequently:!0}));const c=this.hitDetectionContext_;let u;c.canvas.width!==o||c.canvas.height!==o?(c.canvas.width=o,c.canvas.height=o):l||c.clearRect(0,0,o,o),void 0!==this.renderBuffer_&&(u=[1/0,1/0,-1/0,-1/0],pt(u,t),nt(u,e*(this.renderBuffer_+n),u));const d=function(t){if(void 0!==db[t])return db[t];const e=2*t+1,i=t*t,n=new Array(i+1);for(let r=0;r<=t;++r)for(let s=0;s<=t;++s){const o=r*r+s*s;if(o>i)break;let a=n[o];a||(a=[],n[o]=a),a.push(4*((t+r)*e+(t+s))+3),r>0&&a.push(4*((t-r)*e+(t+s))+3),s>0&&(a.push(4*((t+r)*e+(t-s))+3),r>0&&a.push(4*((t-r)*e+(t-s))+3))}const r=[];for(let t=0,e=n.length;t<e;++t)n[t]&&r.push(...n[t]);return db[t]=r,r}(n);let f;function g(t,e){const i=c.getImageData(0,0,o,o).data;for(let a=0,h=d.length;a<h;a++)if(i[d[a]]>0){if(!s||"Image"!==f&&"Text"!==f||s.includes(t)){const i=(d[a]-3)/4,s=n-i%o,h=n-(i/o|0),l=r(t,e,s*s+h*h);if(l)return l}c.clearRect(0,0,o,o);break}}const m=Object.keys(this.executorsByZIndex_).map(Number);let p,_,w,y,v;for(m.sort(a),p=m.length-1;p>=0;--p){const t=m[p].toString();for(w=this.executorsByZIndex_[t],_=ub.length-1;_>=0;--_)if(f=ub[_],y=w[f],void 0!==y&&(v=y.executeHitDetection(c,h,i,g,u),v))return v}}getClipCoords(t){const e=this.maxExtent_;if(!e)return null;const i=e[0],n=e[1],r=e[2],s=e[3],o=[i,n,i,s,r,s,r,n];return Fi(o,0,8,2,t,o),o}isEmpty(){return _(this.executorsByZIndex_)}execute(t,e,i,n,r,s,o){const h=Object.keys(this.executorsByZIndex_).map(Number);let l,c,u,d,f,g;for(h.sort(a),this.maxExtent_&&(t.save(),this.clip(t,i)),s=s||ub,o&&h.reverse(),l=0,c=h.length;l<c;++l){const a=h[l].toString();for(f=this.executorsByZIndex_[a],u=0,d=s.length;u<d;++u)g=f[s[u]],void 0!==g&&g.execute(t,e,i,n,r,o)}this.maxExtent_&&t.restore()}},gb=class extends jv{constructor(t,e,i,n,r,s,o){super(),this.context_=t,this.pixelRatio_=e,this.extent_=i,this.transform_=n,this.transformRotation_=n?Jt(Math.atan2(n[1],n[0]),10):0,this.viewRotation_=r,this.squaredTolerance_=s,this.userTransform_=o,this.contextFillState_=null,this.contextStrokeState_=null,this.contextTextState_=null,this.fillState_=null,this.strokeState_=null,this.image_=null,this.imageAnchorX_=0,this.imageAnchorY_=0,this.imageHeight_=0,this.imageOpacity_=0,this.imageOriginX_=0,this.imageOriginY_=0,this.imageRotateWithView_=!1,this.imageRotation_=0,this.imageScale_=[0,0],this.imageWidth_=0,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=!1,this.textRotation_=0,this.textScale_=[0,0],this.textFillState_=null,this.textStrokeState_=null,this.textState_=null,this.pixelCoordinates_=[],this.tmpLocalTransform_=[1,0,0,1,0,0]}drawImages_(t,e,i,n){if(!this.image_)return;const r=Fi(t,e,i,n,this.transform_,this.pixelCoordinates_),s=this.context_,o=this.tmpLocalTransform_,a=s.globalAlpha;1!=this.imageOpacity_&&(s.globalAlpha=a*this.imageOpacity_);let h=this.imageRotation_;0===this.transformRotation_&&(h-=this.viewRotation_),this.imageRotateWithView_&&(h+=this.viewRotation_);for(let t=0,e=r.length;t<e;t+=2){const e=r[t]-this.imageAnchorX_,i=r[t+1]-this.imageAnchorY_;if(0!==h||1!=this.imageScale_[0]||1!=this.imageScale_[1]){const t=e+this.imageAnchorX_,n=i+this.imageAnchorY_;$(o,t,n,1,1,h,-t,-n),s.save(),s.transform.apply(s,o),s.translate(t,n),s.scale(this.imageScale_[0],this.imageScale_[1]),s.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),s.restore()}else s.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,e,i,this.imageWidth_,this.imageHeight_)}1!=this.imageOpacity_&&(s.globalAlpha=a)}drawText_(t,e,i,n){if(!this.textState_||""===this.text_)return;this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);const r=Fi(t,e,i,n,this.transform_,this.pixelCoordinates_),s=this.context_;let o=this.textRotation_;for(0===this.transformRotation_&&(o-=this.viewRotation_),this.textRotateWithView_&&(o+=this.viewRotation_);e<i;e+=n){const t=r[e]+this.textOffsetX_,i=r[e+1]+this.textOffsetY_;0!==o||1!=this.textScale_[0]||1!=this.textScale_[1]?(s.save(),s.translate(t-this.textOffsetX_,i-this.textOffsetY_),s.rotate(o),s.translate(this.textOffsetX_,this.textOffsetY_),s.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&s.strokeText(this.text_,0,0),this.textFillState_&&s.fillText(this.text_,0,0),s.restore()):(this.textStrokeState_&&s.strokeText(this.text_,t,i),this.textFillState_&&s.fillText(this.text_,t,i))}}moveToLineTo_(t,e,i,n,r){const s=this.context_,o=Fi(t,e,i,n,this.transform_,this.pixelCoordinates_);s.moveTo(o[0],o[1]);let a=o.length;r&&(a-=2);for(let t=2;t<a;t+=2)s.lineTo(o[t],o[t+1]);return r&&s.closePath(),i}drawRings_(t,e,i,n){for(let r=0,s=i.length;r<s;++r)e=this.moveToLineTo_(t,e,i[r],n,!0);return e}drawCircle(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),Pt(this.extent_,t.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=function(t,e,i){const n=t.getFlatCoordinates();if(!n)return null;const r=t.getStride();return Fi(n,0,n.length,r,e,i)}(t,this.transform_,this.pixelCoordinates_),i=e[2]-e[0],n=e[3]-e[1],r=Math.sqrt(i*i+n*n),s=this.context_;s.beginPath(),s.arc(e[0],e[1],r,0,2*Math.PI),this.fillState_&&s.fill(),this.strokeState_&&s.stroke()}""!==this.text_&&this.drawText_(t.getCenter(),0,2,2)}}setStyle(t){this.setFillStrokeStyle(t.getFill(),t.getStroke()),this.setImageStyle(t.getImage()),this.setTextStyle(t.getText())}setTransform(t){this.transform_=t}drawGeometry(t){switch(t.getType()){case"Point":this.drawPoint(t);break;case"LineString":this.drawLineString(t);break;case"Polygon":this.drawPolygon(t);break;case"MultiPoint":this.drawMultiPoint(t);break;case"MultiLineString":this.drawMultiLineString(t);break;case"MultiPolygon":this.drawMultiPolygon(t);break;case"GeometryCollection":this.drawGeometryCollection(t);break;case"Circle":this.drawCircle(t)}}drawFeature(t,e){const i=e.getGeometryFunction()(t);i&&(this.setStyle(e),this.drawGeometry(i))}drawGeometryCollection(t){const e=t.getGeometriesArray();for(let t=0,i=e.length;t<i;++t)this.drawGeometry(e[t])}drawPoint(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const e=t.getFlatCoordinates(),i=t.getStride();this.image_&&this.drawImages_(e,0,e.length,i),""!==this.text_&&this.drawText_(e,0,e.length,i)}drawMultiPoint(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const e=t.getFlatCoordinates(),i=t.getStride();this.image_&&this.drawImages_(e,0,e.length,i),""!==this.text_&&this.drawText_(e,0,e.length,i)}drawLineString(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),Pt(this.extent_,t.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const e=this.context_,i=t.getFlatCoordinates();e.beginPath(),this.moveToLineTo_(i,0,i.length,t.getStride(),!1),e.stroke()}if(""!==this.text_){const e=t.getFlatMidpoint();this.drawText_(e,0,2,2)}}}drawMultiLineString(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const e=t.getExtent();if(Pt(this.extent_,e)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const e=this.context_,i=t.getFlatCoordinates();let n=0;const r=t.getEnds(),s=t.getStride();e.beginPath();for(let t=0,e=r.length;t<e;++t)n=this.moveToLineTo_(i,n,r[t],s,!1);e.stroke()}if(""!==this.text_){const e=t.getFlatMidpoints();this.drawText_(e,0,e.length,2)}}}drawPolygon(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),Pt(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=this.context_;e.beginPath(),this.drawRings_(t.getOrientedFlatCoordinates(),0,t.getEnds(),t.getStride()),this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(""!==this.text_){const e=t.getFlatInteriorPoint();this.drawText_(e,0,2,2)}}}drawMultiPolygon(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),Pt(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=this.context_,i=t.getOrientedFlatCoordinates();let n=0;const r=t.getEndss(),s=t.getStride();e.beginPath();for(let t=0,e=r.length;t<e;++t){const e=r[t];n=this.drawRings_(i,n,e,s)}this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(""!==this.text_){const e=t.getFlatInteriorPoints();this.drawText_(e,0,e.length,2)}}}setContextFillState_(t){const e=this.context_,i=this.contextFillState_;i?i.fillStyle!=t.fillStyle&&(i.fillStyle=t.fillStyle,e.fillStyle=t.fillStyle):(e.fillStyle=t.fillStyle,this.contextFillState_={fillStyle:t.fillStyle})}setContextStrokeState_(t){const e=this.context_,i=this.contextStrokeState_;i?(i.lineCap!=t.lineCap&&(i.lineCap=t.lineCap,e.lineCap=t.lineCap),u(i.lineDash,t.lineDash)||e.setLineDash(i.lineDash=t.lineDash),i.lineDashOffset!=t.lineDashOffset&&(i.lineDashOffset=t.lineDashOffset,e.lineDashOffset=t.lineDashOffset),i.lineJoin!=t.lineJoin&&(i.lineJoin=t.lineJoin,e.lineJoin=t.lineJoin),i.lineWidth!=t.lineWidth&&(i.lineWidth=t.lineWidth,e.lineWidth=t.lineWidth),i.miterLimit!=t.miterLimit&&(i.miterLimit=t.miterLimit,e.miterLimit=t.miterLimit),i.strokeStyle!=t.strokeStyle&&(i.strokeStyle=t.strokeStyle,e.strokeStyle=t.strokeStyle)):(e.lineCap=t.lineCap,e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset,e.lineJoin=t.lineJoin,e.lineWidth=t.lineWidth,e.miterLimit=t.miterLimit,e.strokeStyle=t.strokeStyle,this.contextStrokeState_={lineCap:t.lineCap,lineDash:t.lineDash,lineDashOffset:t.lineDashOffset,lineJoin:t.lineJoin,lineWidth:t.lineWidth,miterLimit:t.miterLimit,strokeStyle:t.strokeStyle})}setContextTextState_(t){const e=this.context_,i=this.contextTextState_,n=t.textAlign?t.textAlign:tr;i?(i.font!=t.font&&(i.font=t.font,e.font=t.font),i.textAlign!=n&&(i.textAlign=n,e.textAlign=n),i.textBaseline!=t.textBaseline&&(i.textBaseline=t.textBaseline,e.textBaseline=t.textBaseline)):(e.font=t.font,e.textAlign=n,e.textBaseline=t.textBaseline,this.contextTextState_={font:t.font,textAlign:n,textBaseline:t.textBaseline})}setFillStrokeStyle(t,e){if(t){const e=t.getColor();this.fillState_={fillStyle:vy(e||Kn)}}else this.fillState_=null;if(e){const t=e.getColor(),i=e.getLineCap(),n=e.getLineDash(),r=e.getLineDashOffset(),s=e.getLineJoin(),o=e.getWidth(),a=e.getMiterLimit(),h=n||$n;this.strokeState_={lineCap:void 0!==i?i:Hn,lineDash:1===this.pixelRatio_?h:h.map((t=>t*this.pixelRatio_)),lineDashOffset:(r||0)*this.pixelRatio_,lineJoin:void 0!==s?s:Jn,lineWidth:(void 0!==o?o:1)*this.pixelRatio_,miterLimit:void 0!==a?a:10,strokeStyle:vy(t||Qn)}}else this.strokeState_=null}setImageStyle(t){let e;if(!t||!(e=t.getSize()))return void(this.image_=null);const i=t.getPixelRatio(this.pixelRatio_),n=t.getAnchor(),r=t.getOrigin();this.image_=t.getImage(this.pixelRatio_),this.imageAnchorX_=n[0]*i,this.imageAnchorY_=n[1]*i,this.imageHeight_=e[1]*i,this.imageOpacity_=t.getOpacity(),this.imageOriginX_=r[0],this.imageOriginY_=r[1],this.imageRotateWithView_=t.getRotateWithView(),this.imageRotation_=t.getRotation();const s=t.getScaleArray();this.imageScale_=[s[0]*this.pixelRatio_/i,s[1]*this.pixelRatio_/i],this.imageWidth_=e[0]*i}setTextStyle(t){if(t){const e=t.getFill();if(e){const t=e.getColor();this.textFillState_={fillStyle:vy(t||Kn)}}else this.textFillState_=null;const i=t.getStroke();if(i){const t=i.getColor(),e=i.getLineCap(),n=i.getLineDash(),r=i.getLineDashOffset(),s=i.getLineJoin(),o=i.getWidth(),a=i.getMiterLimit();this.textStrokeState_={lineCap:void 0!==e?e:Hn,lineDash:n||$n,lineDashOffset:r||0,lineJoin:void 0!==s?s:Jn,lineWidth:void 0!==o?o:1,miterLimit:void 0!==a?a:10,strokeStyle:vy(t||Qn)}}else this.textStrokeState_=null;const n=t.getFont(),r=t.getOffsetX(),s=t.getOffsetY(),o=t.getRotateWithView(),a=t.getRotation(),h=t.getScaleArray(),l=t.getText(),c=t.getTextAlign(),u=t.getTextBaseline();this.textState_={font:void 0!==n?n:Zn,textAlign:void 0!==c?c:tr,textBaseline:void 0!==u?u:er},this.text_=void 0!==l?Array.isArray(l)?l.reduce(((t,e,i)=>t+(i%2?" ":e)),""):l:"",this.textOffsetX_=void 0!==r?this.pixelRatio_*r:0,this.textOffsetY_=void 0!==s?this.pixelRatio_*s:0,this.textRotateWithView_=void 0!==o&&o,this.textRotation_=void 0!==a?a:0,this.textScale_=[this.pixelRatio_*h[0],this.pixelRatio_*h[1]]}else this.text_=""}},mb=.5,pb={Point:function(t,e,i,n,r){const s=i.getImage(),o=i.getText();let a;if(s){if(2!=s.getImageState())return;let h=t;if(r){const l=s.getDeclutterMode();if("none"!==l)if(h=r,"obstacle"===l){const r=t.getBuilder(i.getZIndex(),"Image");r.setImageStyle(s,a),r.drawPoint(e,n)}else o&&o.getText()&&(a={})}const l=h.getBuilder(i.getZIndex(),"Image");l.setImageStyle(s,a),l.drawPoint(e,n)}if(o&&o.getText()){let s=t;r&&(s=r);const h=s.getBuilder(i.getZIndex(),"Text");h.setTextStyle(o,a),h.drawText(e,n)}},LineString:function(t,e,i,n,r){const s=i.getStroke();if(s){const r=t.getBuilder(i.getZIndex(),"LineString");r.setFillStrokeStyle(null,s),r.drawLineString(e,n)}const o=i.getText();if(o&&o.getText()){const s=(r||t).getBuilder(i.getZIndex(),"Text");s.setTextStyle(o),s.drawText(e,n)}},Polygon:function(t,e,i,n,r){const s=i.getFill(),o=i.getStroke();if(s||o){const r=t.getBuilder(i.getZIndex(),"Polygon");r.setFillStrokeStyle(s,o),r.drawPolygon(e,n)}const a=i.getText();if(a&&a.getText()){const s=(r||t).getBuilder(i.getZIndex(),"Text");s.setTextStyle(a),s.drawText(e,n)}},MultiPoint:function(t,e,i,n,r){const s=i.getImage(),o=i.getText();let a;if(s){if(2!=s.getImageState())return;let h=t;if(r){const l=s.getDeclutterMode();if("none"!==l)if(h=r,"obstacle"===l){const r=t.getBuilder(i.getZIndex(),"Image");r.setImageStyle(s,a),r.drawMultiPoint(e,n)}else o&&o.getText()&&(a={})}const l=h.getBuilder(i.getZIndex(),"Image");l.setImageStyle(s,a),l.drawMultiPoint(e,n)}if(o&&o.getText()){let s=t;r&&(s=r);const h=s.getBuilder(i.getZIndex(),"Text");h.setTextStyle(o,a),h.drawText(e,n)}},MultiLineString:function(t,e,i,n,r){const s=i.getStroke();if(s){const r=t.getBuilder(i.getZIndex(),"LineString");r.setFillStrokeStyle(null,s),r.drawMultiLineString(e,n)}const o=i.getText();if(o&&o.getText()){const s=(r||t).getBuilder(i.getZIndex(),"Text");s.setTextStyle(o),s.drawText(e,n)}},MultiPolygon:function(t,e,i,n,r){const s=i.getFill(),o=i.getStroke();if(o||s){const r=t.getBuilder(i.getZIndex(),"Polygon");r.setFillStrokeStyle(s,o),r.drawMultiPolygon(e,n)}const a=i.getText();if(a&&a.getText()){const s=(r||t).getBuilder(i.getZIndex(),"Text");s.setTextStyle(a),s.drawText(e,n)}},GeometryCollection:function(t,e,i,n,r){const s=e.getGeometriesArray();let o,a;for(o=0,a=s.length;o<a;++o)(0,pb[s[o].getType()])(t,s[o],i,n,r)},Circle:function(t,e,i,n,r){const s=i.getFill(),o=i.getStroke();if(s||o){const r=t.getBuilder(i.getZIndex(),"Circle");r.setFillStrokeStyle(s,o),r.drawCircle(e,n)}const a=i.getText();if(a&&a.getText()){const s=(r||t).getBuilder(i.getZIndex(),"Text");s.setTextStyle(a),s.drawText(e,n)}}};function _b(t,e){return parseInt(D(t),10)-parseInt(D(e),10)}function wb(t,e){return.5*t/e}function yb(t,e,i,n,r,s,o){let a=!1;const h=i.getImage();if(h){const t=h.getImageState();2==t||3==t?h.unlistenImageChange(r):(0==t&&h.load(),h.listenImageChange(r),a=!0)}return function(t,e,i,n,r,s){const o=i.getGeometryFunction()(e);if(!o)return;const a=o.simplifyTransformed(n,r);i.getRenderer()?vb(t,a,i,e):(0,pb[a.getType()])(t,a,i,e,s)}(t,e,i,n,s,o),a}function vb(t,e,i,n){if("GeometryCollection"!=e.getType())t.getBuilder(i.getZIndex(),"Default").drawCustom(e,n,i.getRenderer(),i.getHitDetectionRenderer());else{const r=e.getGeometries();for(let e=0,s=r.length;e<s;++e)vb(t,r[e],i,n)}}const bb=class extends Ss{constructor(t){super(t),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.animatingOrInteracting_,this.hitDetectionImageData_=null,this.renderedFeatures_=null,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=[1/0,1/0,-1/0,-1/0],this.wrappedRenderedExtent_=[1/0,1/0,-1/0,-1/0],this.renderedRotation_,this.renderedCenter_=null,this.renderedProjection_=null,this.renderedRenderOrder_=null,this.replayGroup_=null,this.replayGroupChanged=!0,this.declutterExecutorGroup=null,this.clipping=!0,this.compositionContext_=null,this.opacity_=1}renderWorlds(t,e,i){const n=e.extent,r=e.viewState,s=r.center,o=r.resolution,a=r.projection,h=r.rotation,l=a.getExtent(),c=this.getLayer().getSource(),u=e.pixelRatio,d=e.viewHints,f=!(d[0]||d[1]),g=this.compositionContext_,m=Math.round(e.size[0]*u),p=Math.round(e.size[1]*u),_=c.getWrapX()&&a.canWrapX(),w=_?Rt(l):null,y=_?Math.ceil((n[2]-l[2])/w)+1:1;let v=_?Math.floor((n[0]-l[0])/w):0;do{const e=this.getRenderTransform(s,o,h,u,m,p,v*w);t.execute(g,1,e,h,f,void 0,i)}while(++v<y)}setupCompositionContext_(){if(1!==this.opacity_){const t=Vn(this.context.canvas.width,this.context.canvas.height,Ms);this.compositionContext_=t}else this.compositionContext_=this.context}releaseCompositionContext_(){if(1!==this.opacity_){const t=this.context.globalAlpha;this.context.globalAlpha=this.opacity_,this.context.drawImage(this.compositionContext_.canvas,0,0),this.context.globalAlpha=t,jn(this.compositionContext_),Ms.push(this.compositionContext_.canvas),this.compositionContext_=null}}renderDeclutter(t){this.declutterExecutorGroup&&(this.setupCompositionContext_(),this.renderWorlds(this.declutterExecutorGroup,t,t.declutterTree),this.releaseCompositionContext_())}renderFrame(t,e){const i=t.pixelRatio,n=t.layerStatesArray[t.layerIndex];!function(t,e,i){!function(t,e,i,n,r,s,o){t[0]=e,t[1]=i,t[2]=n,t[3]=r,t[4]=s,t[5]=o}(t,e,0,0,i,0,0)}(this.pixelTransform,1/i,1/i),J(this.inversePixelTransform,this.pixelTransform);const r=tt(this.pixelTransform);this.useContainer(e,r,this.getBackground(t));const s=this.context,o=s.canvas,a=this.replayGroup_,h=this.declutterExecutorGroup;let l=a&&!a.isEmpty()||h&&!h.isEmpty();if(!l&&!this.getLayer().hasListener(Ee)&&!this.getLayer().hasListener(Se))return null;const c=Math.round(t.size[0]*i),u=Math.round(t.size[1]*i);o.width!=c||o.height!=u?(o.width=c,o.height=u,o.style.transform!==r&&(o.style.transform=r)):this.containerReused||s.clearRect(0,0,c,u),this.preRender(s,t);const d=t.viewState;d.projection;this.opacity_=n.opacity,this.setupCompositionContext_();let f=!1;if(l&&n.extent&&this.clipping){const e=wi(n.extent);l=Pt(e,t.extent),f=l&&!at(e,t.extent),f&&this.clipUnrotated(this.compositionContext_,t,e)}return l&&this.renderWorlds(a,t),f&&this.compositionContext_.restore(),this.releaseCompositionContext_(),this.postRender(s,t),this.renderedRotation_!==d.rotation&&(this.renderedRotation_=d.rotation,this.hitDetectionImageData_=null),this.container}getFeatures(t){return new Promise((e=>{if(!this.hitDetectionImageData_&&!this.animatingOrInteracting_){const t=[this.context.canvas.width,this.context.canvas.height];H(this.pixelTransform,t);const e=this.renderedCenter_,i=this.renderedResolution_,n=this.renderedRotation_,r=this.renderedProjection_,s=this.wrappedRenderedExtent_,o=this.getLayer(),h=[],l=t[0]*mb,c=t[1]*mb;h.push(this.getRenderTransform(e,i,n,mb,l,c,0).slice());const u=o.getSource(),d=r.getExtent();if(u.getWrapX()&&r.canWrapX()&&!at(d,s)){let t=s[0];const r=Rt(d);let o,a=0;for(;t<d[0];)--a,o=r*a,h.push(this.getRenderTransform(e,i,n,mb,l,c,o).slice()),t+=r;for(a=0,t=s[2];t>d[2];)++a,o=r*a,h.push(this.getRenderTransform(e,i,n,mb,l,c,o).slice()),t-=r}this.hitDetectionImageData_=function(t,e,i,n,r,s,o){const h=Vn(t[0]*mb,t[1]*mb);h.imageSmoothingEnabled=!1;const l=h.canvas,c=new gb(h,mb,r,null,o),u=i.length,d=Math.floor(16777215/u),f={};for(let t=1;t<=u;++t){const e=i[t-1],o=e.getStyleFunction()||n;if(!o)continue;let a=o(e,s);if(!a)continue;Array.isArray(a)||(a=[a]);const h=(t*d).toString(16).padStart(7,"#00000");for(let t=0,i=a.length;t<i;++t){const i=a[t],n=i.getGeometryFunction()(e);if(!n||!Pt(r,n.getExtent()))continue;const s=i.clone(),o=s.getFill();o&&o.setColor(h);const l=s.getStroke();l&&(l.setColor(h),l.setLineDash(null)),s.setText(void 0);const c=i.getImage();if(c){const t=c.getImageSize();if(!t)continue;const e=Vn(t[0],t[1],void 0,{alpha:!1}),i=e.canvas;e.fillStyle=h,e.fillRect(0,0,i.width,i.height),s.setImage(new By({img:i,anchor:c.getAnchor(),anchorXUnits:"pixels",anchorYUnits:"pixels",offset:c.getOrigin(),opacity:1,size:c.getSize(),scale:c.getScale(),rotation:c.getRotation(),rotateWithView:c.getRotateWithView()}))}const u=s.getZIndex()||0;let d=f[u];d||(d={},f[u]=d,d.Polygon=[],d.Circle=[],d.LineString=[],d.Point=[]);const g=n.getType();if("GeometryCollection"===g){const t=n.getGeometriesArrayRecursive();for(let e=0,i=t.length;e<i;++e){const i=t[e];d[i.getType().replace("Multi","")].push(i,s)}}else d[g.replace("Multi","")].push(n,s)}}const g=Object.keys(f).map(Number).sort(a);for(let t=0,i=g.length;t<i;++t){const i=f[g[t]];for(const t in i){const n=i[t];for(let t=0,i=n.length;t<i;t+=2){c.setStyle(n[t+1]);for(let i=0,r=e.length;i<r;++i)c.setTransform(e[i]),c.drawGeometry(n[t])}}}return h.getImageData(0,0,l.width,l.height)}(t,h,this.renderedFeatures_,o.getStyleFunction(),s,i,n)}e(function(t,e,i){const n=[];if(i){const r=Math.floor(Math.round(t[0])*mb),s=Math.floor(Math.round(t[1])*mb),o=4*(qt(r,0,i.width-1)+qt(s,0,i.height-1)*i.width),a=i.data[o],h=i.data[o+1],l=i.data[o+2]+256*(h+256*a),c=Math.floor(16777215/e.length);l&&l%c==0&&n.push(e[l/c-1])}return n}(t,this.renderedFeatures_,this.hitDetectionImageData_))}))}forEachFeatureAtCoordinate(t,e,i,n,r){if(!this.replayGroup_)return;const s=e.viewState.resolution,o=e.viewState.rotation,a=this.getLayer(),h={},l=function(t,e,i){const s=D(t),o=h[s];if(o){if(!0!==o&&i<o.distanceSq){if(0===i)return h[s]=!0,r.splice(r.lastIndexOf(o),1),n(t,a,e);o.geometry=e,o.distanceSq=i}}else{if(0===i)return h[s]=!0,n(t,a,e);r.push(h[s]={feature:t,layer:a,geometry:e,distanceSq:i,callback:n})}};let c;const u=[this.replayGroup_];return this.declutterExecutorGroup&&u.push(this.declutterExecutorGroup),u.some((n=>c=n.forEachFeatureAtCoordinate(t,s,o,i,l,n===this.declutterExecutorGroup&&e.declutterTree?e.declutterTree.all().map((t=>t.value)):null))),c}handleFontsChanged(){const t=this.getLayer();t.getVisible()&&this.replayGroup_&&t.changed()}handleStyleImageChange_(t){this.renderIfReadyAndVisible()}prepareFrame(t){const e=this.getLayer(),i=e.getSource();if(!i)return!1;const n=t.viewHints[0],r=t.viewHints[1],s=e.getUpdateWhileAnimating(),o=e.getUpdateWhileInteracting();if(this.ready&&!s&&n||!o&&r)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;const a=t.extent,h=t.viewState,l=h.projection,c=h.resolution,d=t.pixelRatio,f=e.getRevision(),g=e.getRenderBuffer();let m=e.getRenderOrder();void 0===m&&(m=_b);const p=h.center.slice(),_=nt(a,g*c),w=_.slice(),y=[_.slice()],v=l.getExtent();if(i.getWrapX()&&l.canWrapX()&&!at(v,t.extent)){const t=Rt(v),e=Math.max(Rt(_)/2,t);_[0]=v[0]-e,_[2]=v[2]+e,Ke(p,l);const i=Lt(y[0],l);i[0]<v[0]&&i[2]<v[2]?y.push([i[0]+t,i[1],i[2]+t,i[3]]):i[0]>v[0]&&i[2]>v[2]&&y.push([i[0]-t,i[1],i[2]-t,i[3]])}if(this.ready&&this.renderedResolution_==c&&this.renderedRevision_==f&&this.renderedRenderOrder_==m&&at(this.wrappedRenderedExtent_,_))return u(this.renderedExtent_,w)||(this.hitDetectionImageData_=null,this.renderedExtent_=w),this.renderedCenter_=p,this.replayGroupChanged=!1,!0;this.replayGroup_=null;const b=new Jv(wb(c,d),_,c,d);let x;this.getLayer().getDeclutter()&&(x=new Jv(wb(c,d),_,c,d));const M=gi();let E;if(M){for(let t=0,e=y.length;t<e;++t){const e=_i(y[t]);i.loadFeatures(e,yi(c),M)}E=ci(M,l)}else for(let t=0,e=y.length;t<e;++t)i.loadFeatures(y[t],c,l);const S=function(t,e){const i=wb(t,e);return i*i}(c,d);let k=!0;const C=t=>{let i;const n=t.getStyleFunction()||e.getStyleFunction();if(n&&(i=n(t,c)),i){const e=this.renderFeature(t,S,i,b,E,x);k=k&&!e}},I=_i(_),A=i.getFeaturesInExtent(I);m&&A.sort(m);for(let t=0,e=A.length;t<e;++t)C(A[t]);this.renderedFeatures_=A,this.ready=k;const T=b.finish(),R=new fb(_,c,d,i.getOverlaps(),T,e.getRenderBuffer());return x&&(this.declutterExecutorGroup=new fb(_,c,d,i.getOverlaps(),x.finish(),e.getRenderBuffer())),this.renderedResolution_=c,this.renderedRevision_=f,this.renderedRenderOrder_=m,this.renderedExtent_=w,this.wrappedRenderedExtent_=_,this.renderedCenter_=p,this.renderedProjection_=l,this.replayGroup_=R,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0}renderFeature(t,e,i,n,r,s){if(!i)return!1;let o=!1;if(Array.isArray(i))for(let a=0,h=i.length;a<h;++a)o=yb(n,t,i[a],e,this.boundHandleStyleImageChange_,r,s)||o;else o=yb(n,t,i,e,this.boundHandleStyleImageChange_,r,s);return o}},xb=class extends Bv{constructor(t){super(t)}createRenderer(){return new bb(this)}},Mb=class{constructor(t){this.rbush_=new _y(t),this.items_={}}insert(t,e){const i={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3],value:e};this.rbush_.insert(i),this.items_[D(e)]=i}load(t,e){const i=new Array(e.length);for(let n=0,r=e.length;n<r;n++){const r=t[n],s=e[n],o={minX:r[0],minY:r[1],maxX:r[2],maxY:r[3],value:s};i[n]=o,this.items_[D(s)]=o}this.rbush_.load(i)}remove(t){const e=D(t),i=this.items_[e];return delete this.items_[e],null!==this.rbush_.remove(i)}update(t,e){const i=this.items_[D(e)];gt([i.minX,i.minY,i.maxX,i.maxY],t)||(this.remove(e),this.insert(t,e))}getAll(){return this.rbush_.all().map((function(t){return t.value}))}getInExtent(t){const e={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]};return this.rbush_.search(e).map((function(t){return t.value}))}forEach(t){return this.forEach_(this.getAll(),t)}forEachInExtent(t,e){return this.forEach_(this.getInExtent(t),e)}forEach_(t,e){let i;for(let n=0,r=t.length;n<r;n++)if(i=e(t[n]),i)return i;return i}isEmpty(){return _(this.items_)}clear(){this.rbush_.clear(),this.items_={}}getExtent(t){const e=this.rbush_.toJSON();return ct(e.minX,e.minY,e.maxX,e.maxY,t)}concat(t){this.rbush_.load(t.rbush_.all());for(const e in t.items_)this.items_[e]=t.items_[e]}};function Eb(t,e,i,n,r,s,o){let h,l;const c=(i-e)/n;if(1===c)h=e;else if(2===c)h=e,l=r;else if(0!==c){let s=t[e],o=t[e+1],c=0;const u=[0];for(let r=e+n;r<i;r+=n){const e=t[r],i=t[r+1];c+=Math.sqrt((e-s)*(e-s)+(i-o)*(i-o)),u.push(c),s=e,o=i}const d=r*c,f=function(t,e,i){let n,r;i=i||a;let s=0,o=t.length,h=!1;for(;s<o;)n=s+(o-s>>1),r=+i(t[n],e),r<0?s=n+1:(o=n,h=!r);return h?s:~s}(u,d);f<0?(l=(d-u[-f-2])/(u[-f-1]-u[-f-2]),h=e+(-f-2)*n):h=e+f*n}o=o>1?o:2,s=s||new Array(o);for(let e=0;e<o;++e)s[e]=void 0===h?NaN:void 0===l?t[h+e]:$t(t[h+e],t[h+n+e],l);return s}function Sb(t,e,i,n,r,s){if(i==e)return null;let o;if(r<t[e+n-1])return s?(o=t.slice(e,e+n),o[n-1]=r,o):null;if(t[i-1]<r)return s?(o=t.slice(i-n,i),o[n-1]=r,o):null;if(r==t[e+n-1])return t.slice(e,e+n);let a=e/n,h=i/n;for(;a<h;){const e=a+h>>1;r<t[(e+1)*n-1]?h=e:a=e+1}const l=t[a*n-1];if(r==l)return t.slice((a-1)*n,(a-1)*n+n);const c=(r-l)/(t[(a+1)*n-1]-l);o=[];for(let e=0;e<n-1;++e)o.push($t(t[(a-1)*n+e],t[a*n+e],c));return o.push(r),o}function kb(t,e,i,n){const r=[];let s=[1/0,1/0,-1/0,-1/0];for(let o=0,a=i.length;o<a;++o){const a=i[o];s=ft(t,e,a[0],n),r.push((s[0]+s[2])/2,(s[1]+s[3])/2),e=a[a.length-1]}return r}const Cb=[1,0,0,1,0,0];class Ib{constructor(t,e,i,n,r,s){this.styleFunction,this.extent_,this.id_=s,this.type_=t,this.flatCoordinates_=e,this.flatInteriorPoints_=null,this.flatMidpoints_=null,this.ends_=i,this.properties_=r,this.squaredTolerance_,this.stride_=n,this.simplifiedGeometry_}get(t){return this.properties_[t]}getExtent(){return this.extent_||(this.extent_="Point"===this.type_?dt(this.flatCoordinates_):ft(this.flatCoordinates_,0,this.flatCoordinates_.length,2)),this.extent_}getFlatInteriorPoint(){if(!this.flatInteriorPoints_){const t=Mt(this.getExtent());this.flatInteriorPoints_=fn(this.flatCoordinates_,0,this.ends_,2,t,0)}return this.flatInteriorPoints_}getFlatInteriorPoints(){if(!this.flatInteriorPoints_){const t=function(t,e){const i=[];let n,r=0,s=0;for(let o=0,a=e.length;o<a;++o){const a=e[o],h=vn(t,r,a,2);if(void 0===n&&(n=h),h===n)i.push(e.slice(s,o+1));else{if(0===i.length)continue;i[i.length-1].push(e[s])}s=o+1,r=a}return i}(this.flatCoordinates_,this.ends_),e=kb(this.flatCoordinates_,0,t,2);this.flatInteriorPoints_=gn(this.flatCoordinates_,0,t,2,e)}return this.flatInteriorPoints_}getFlatMidpoint(){return this.flatMidpoints_||(this.flatMidpoints_=Eb(this.flatCoordinates_,0,this.flatCoordinates_.length,2,.5)),this.flatMidpoints_}getFlatMidpoints(){if(!this.flatMidpoints_){this.flatMidpoints_=[];const t=this.flatCoordinates_;let e=0;const i=this.ends_;for(let n=0,r=i.length;n<r;++n){const r=i[n],s=Eb(t,e,r,2,.5);c(this.flatMidpoints_,s),e=r}}return this.flatMidpoints_}getId(){return this.id_}getOrientedFlatCoordinates(){return this.flatCoordinates_}getGeometry(){return this}getSimplifiedGeometry(t){return this}simplifyTransformed(t,e){return this}getProperties(){return this.properties_}getPropertiesInternal(){return this.properties_}getStride(){return this.stride_}getStyleFunction(){return this.styleFunction}getType(){return this.type_}transform(t){const e=(t=si(t)).getExtent(),i=t.getWorldExtent();if(e&&i){const t=Ct(i)/Ct(e);$(Cb,i[0],i[3],t,-t,0,0,0),Fi(this.flatCoordinates_,0,this.flatCoordinates_.length,2,Cb,this.flatCoordinates_)}}applyTransform(t){t(this.flatCoordinates_,this.flatCoordinates_,this.stride_)}clone(){return new Ib(this.type_,this.flatCoordinates_.slice(),this.ends_.slice(),this.stride_,Object.assign({},this.properties_),this.id_)}getEnds(){return this.ends_}enableSimplifyTransformed(){return this.simplifyTransformed=m(((t,e)=>{if(t===this.squaredTolerance_)return this.simplifiedGeometry_;this.simplifiedGeometry_=this.clone(),e&&this.simplifiedGeometry_.applyTransform(e);const i=this.simplifiedGeometry_.getFlatCoordinates();let n;switch(this.type_){case"LineString":i.length=Ki(i,0,this.simplifiedGeometry_.flatCoordinates_.length,this.simplifiedGeometry_.stride_,t,i,0),n=[i.length];break;case"MultiLineString":n=[],i.length=Hi(i,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,t,i,0,n);break;case"Polygon":n=[],i.length=Qi(i,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,Math.sqrt(t),i,0,n)}return n&&(this.simplifiedGeometry_=new Ib(this.type_,i,n,2,this.properties_,this.id_)),this.squaredTolerance_=t,this.simplifiedGeometry_})),this}}Ib.prototype.getFlatCoordinates=Ib.prototype.getOrientedFlatCoordinates;const Ab=Ib,Tb="addfeature",Rb="removefeature";function Pb(t,e){return[[-1/0,-1/0,1/0,1/0]]}function Db(t,e){return function(i,n,r,s,o){const a=this;!function(t,e,i,n,r,s,o){const a=new XMLHttpRequest;a.open("GET","function"==typeof t?t(i,n,r):t,!0),"arraybuffer"==e.getType()&&(a.responseType="arraybuffer"),a.withCredentials=false,a.onload=function(t){if(!a.status||a.status>=200&&a.status<300){const t=e.getType();let n;"json"==t?n=JSON.parse(a.responseText):"text"==t?n=a.responseText:"xml"==t?(n=a.responseXML,n||(n=(new DOMParser).parseFromString(a.responseText,"application/xml"))):"arraybuffer"==t&&(n=a.response),n?s(e.readFeatures(n,{extent:i,featureProjection:r}),e.readProjection(n)):o()}else o()},a.onerror=o,a.send()}(t,e,i,n,r,(function(t,e){a.addFeatures(t),void 0!==s&&s(t)}),o||g)}}class Fb extends r{constructor(t,e,i){super(t),this.feature=e,this.features=i}}const Lb=class extends Yw{constructor(t){super({attributions:(t=t||{}).attributions,interpolate:!0,projection:void 0,state:"ready",wrapX:void 0===t.wrapX||t.wrapX}),this.on,this.once,this.un,this.loader_=g,this.format_=t.format,this.overlaps_=void 0===t.overlaps||t.overlaps,this.url_=t.url,void 0!==t.loader?this.loader_=t.loader:void 0!==this.url_&&(K(this.format_,"`format` must be set when `url` is set"),this.loader_=Db(this.url_,this.format_)),this.strategy_=void 0!==t.strategy?t.strategy:Pb;const e=void 0===t.useSpatialIndex||t.useSpatialIndex;let i,n;this.featuresRtree_=e?new Mb:null,this.loadedExtentsRtree_=new Mb,this.loadingExtentsCount_=0,this.nullGeometryFeatures_={},this.idIndex_={},this.uidIndex_={},this.featureChangeKeys_={},this.featuresCollection_=null,Array.isArray(t.features)?n=t.features:t.features&&(i=t.features,n=i.getArray()),e||void 0!==i||(i=new U(n)),void 0!==n&&this.addFeaturesInternal(n),void 0!==i&&this.bindFeaturesCollection_(i)}addFeature(t){this.addFeatureInternal(t),this.changed()}addFeatureInternal(t){const e=D(t);if(!this.addToIndex_(e,t))return void(this.featuresCollection_&&this.featuresCollection_.remove(t));this.setupChangeEvents_(e,t);const i=t.getGeometry();if(i){const e=i.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(e,t)}else this.nullGeometryFeatures_[e]=t;this.dispatchEvent(new Fb(Tb,t))}setupChangeEvents_(t,e){e instanceof Ab||(this.featureChangeKeys_[t]=[k(e,y,this.handleFeatureChange_,this),k(e,s,this.handleFeatureChange_,this)])}addToIndex_(t,e){let i=!0;if(void 0!==e.getId()){const t=String(e.getId());if(t in this.idIndex_)if(e instanceof Ab){const n=this.idIndex_[t];n instanceof Ab?Array.isArray(n)?n.push(e):this.idIndex_[t]=[n,e]:i=!1}else i=!1;else this.idIndex_[t]=e}return i&&(K(!(t in this.uidIndex_),"The passed `feature` was already added to the source"),this.uidIndex_[t]=e),i}addFeatures(t){this.addFeaturesInternal(t),this.changed()}addFeaturesInternal(t){const e=[],i=[],n=[];for(let e=0,n=t.length;e<n;e++){const n=t[e],r=D(n);this.addToIndex_(r,n)&&i.push(n)}for(let t=0,r=i.length;t<r;t++){const r=i[t],s=D(r);this.setupChangeEvents_(s,r);const o=r.getGeometry();if(o){const t=o.getExtent();e.push(t),n.push(r)}else this.nullGeometryFeatures_[s]=r}if(this.featuresRtree_&&this.featuresRtree_.load(e,n),this.hasListener(Tb))for(let t=0,e=i.length;t<e;t++)this.dispatchEvent(new Fb(Tb,i[t]))}bindFeaturesCollection_(t){let e=!1;this.addEventListener(Tb,(function(i){e||(e=!0,t.push(i.feature),e=!1)})),this.addEventListener(Rb,(function(i){e||(e=!0,t.remove(i.feature),e=!1)})),t.addEventListener(O,(t=>{e||(e=!0,this.addFeature(t.element),e=!1)})),t.addEventListener(N,(t=>{e||(e=!0,this.removeFeature(t.element),e=!1)})),this.featuresCollection_=t}clear(t){if(t){for(const t in this.featureChangeKeys_)this.featureChangeKeys_[t].forEach(I);this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_){const t=t=>{this.removeFeatureInternal(t)};this.featuresRtree_.forEach(t);for(const t in this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[t])}this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};const e=new Fb("clear");this.dispatchEvent(e),this.changed()}forEachFeature(t){if(this.featuresRtree_)return this.featuresRtree_.forEach(t);this.featuresCollection_&&this.featuresCollection_.forEach(t)}forEachFeatureAtCoordinateDirect(t,e){const i=[t[0],t[1],t[0],t[1]];return this.forEachFeatureInExtent(i,(function(i){const n=i.getGeometry();if(n instanceof Ab||n.intersectsCoordinate(t))return e(i)}))}forEachFeatureInExtent(t,e){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(t,e);this.featuresCollection_&&this.featuresCollection_.forEach(e)}forEachFeatureIntersectingExtent(t,e){return this.forEachFeatureInExtent(t,(function(i){const n=i.getGeometry();if(n instanceof Ab||n.intersectsExtent(t)){const t=e(i);if(t)return t}}))}getFeaturesCollection(){return this.featuresCollection_}getFeatures(){let t;return this.featuresCollection_?t=this.featuresCollection_.getArray().slice(0):this.featuresRtree_&&(t=this.featuresRtree_.getAll(),_(this.nullGeometryFeatures_)||c(t,Object.values(this.nullGeometryFeatures_))),t}getFeaturesAtCoordinate(t){const e=[];return this.forEachFeatureAtCoordinateDirect(t,(function(t){e.push(t)})),e}getFeaturesInExtent(t,e){if(this.featuresRtree_){if(!(e&&e.canWrapX()&&this.getWrapX()))return this.featuresRtree_.getInExtent(t);const i=function(t,e){if(e.canWrapX()){const i=e.getExtent();if(!isFinite(t[0])||!isFinite(t[2]))return[[i[0],t[1],i[2],t[3]]];Lt(t,e);const n=Rt(i);if(Rt(t)>n)return[[i[0],t[1],i[2],t[3]]];if(t[0]<i[0])return[[t[0]+n,t[1],i[2],t[3]],[i[0],t[1],t[2],t[3]]];if(t[2]>i[2])return[[t[0],t[1],i[2],t[3]],[i[0],t[1],t[2]-n,t[3]]]}return[t]}(t,e);return[].concat(...i.map((t=>this.featuresRtree_.getInExtent(t))))}return this.featuresCollection_?this.featuresCollection_.getArray().slice(0):[]}getClosestFeatureToCoordinate(t,e){const i=t[0],n=t[1];let r=null;const s=[NaN,NaN];let o=1/0;const a=[-1/0,-1/0,1/0,1/0];return e=e||d,this.featuresRtree_.forEachInExtent(a,(function(t){if(e(t)){const e=t.getGeometry(),h=o;if(o=e instanceof Ab?0:e.closestPointXY(i,n,s,o),o<h){r=t;const e=Math.sqrt(o);a[0]=i-e,a[1]=n-e,a[2]=i+e,a[3]=n+e}}})),r}getExtent(t){return this.featuresRtree_.getExtent(t)}getFeatureById(t){const e=this.idIndex_[t.toString()];return void 0!==e?e:null}getFeatureByUid(t){const e=this.uidIndex_[t];return void 0!==e?e:null}getFormat(){return this.format_}getOverlaps(){return this.overlaps_}getUrl(){return this.url_}handleFeatureChange_(t){const e=t.target,i=D(e),n=e.getGeometry();if(n){const t=n.getExtent();i in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[i],this.featuresRtree_&&this.featuresRtree_.insert(t,e)):this.featuresRtree_&&this.featuresRtree_.update(t,e)}else i in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(e),this.nullGeometryFeatures_[i]=e);const r=e.getId();if(void 0!==r){const t=r.toString();this.idIndex_[t]!==e&&(this.removeFromIdIndex_(e),this.idIndex_[t]=e)}else this.removeFromIdIndex_(e),this.uidIndex_[i]=e;this.changed(),this.dispatchEvent(new Fb("changefeature",e))}hasFeature(t){const e=t.getId();return void 0!==e?e in this.idIndex_:D(t)in this.uidIndex_}isEmpty(){return this.featuresRtree_?this.featuresRtree_.isEmpty()&&_(this.nullGeometryFeatures_):!this.featuresCollection_||0===this.featuresCollection_.getLength()}loadFeatures(t,e,i){const n=this.loadedExtentsRtree_,r=this.strategy_(t,e,i);for(let t=0,s=r.length;t<s;++t){const s=r[t];n.forEachInExtent(s,(function(t){return at(t.extent,s)}))||(++this.loadingExtentsCount_,this.dispatchEvent(new Fb("featuresloadstart")),this.loader_.call(this,s,e,i,(t=>{--this.loadingExtentsCount_,this.dispatchEvent(new Fb("featuresloadend",void 0,t))}),(()=>{--this.loadingExtentsCount_,this.dispatchEvent(new Fb("featuresloaderror"))})),n.insert(s,{extent:s.slice()}))}this.loading=!(this.loader_.length<4)&&this.loadingExtentsCount_>0}refresh(){this.clear(!0),this.loadedExtentsRtree_.clear(),super.refresh()}removeLoadedExtent(t){const e=this.loadedExtentsRtree_;let i;e.forEachInExtent(t,(function(e){if(gt(e.extent,t))return i=e,!0})),i&&e.remove(i)}removeFeature(t){if(!t)return;const e=D(t);e in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[e]:this.featuresRtree_&&this.featuresRtree_.remove(t),this.removeFeatureInternal(t)&&this.changed()}removeFeatureInternal(t){const e=D(t),i=this.featureChangeKeys_[e];if(!i)return;i.forEach(I),delete this.featureChangeKeys_[e];const n=t.getId();return void 0!==n&&delete this.idIndex_[n.toString()],delete this.uidIndex_[e],this.dispatchEvent(new Fb(Rb,t)),t}removeFromIdIndex_(t){let e=!1;for(const i in this.idIndex_){const n=this.idIndex_[i];if(t instanceof Ab&&Array.isArray(n)&&n.includes(t))n.splice(n.indexOf(t),1);else if(this.idIndex_[i]===t){delete this.idIndex_[i],e=!0;break}}return e}setLoader(t){this.loader_=t}setUrl(t){K(this.format_,"`format` must be set when `url` is set"),this.url_=t,this.setLoader(Db(t,this.format_))}};class Ob extends Ui{constructor(t,e){super(),this.flatMidpoint_=null,this.flatMidpointRevision_=-1,this.maxDelta_=-1,this.maxDeltaRevision_=-1,void 0===e||Array.isArray(t[0])?this.setCoordinates(t,e):this.setFlatCoordinates(e,t)}appendCoordinate(t){c(this.flatCoordinates,t),this.changed()}clone(){const t=new Ob(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(t,e,i,n){return n<st(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Yi(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Vi(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!1,t,e,i,n))}forEachSegment(t){return mn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}getCoordinateAtM(t,e){return"XYM"!=this.layout&&"XYZM"!=this.layout?null:(e=void 0!==e&&e,Sb(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e))}getCoordinates(){return tn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinateAt(t,e){return Eb(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,this.stride)}getLength(){return tb(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getFlatMidpoint(){return this.flatMidpointRevision_!=this.getRevision()&&(this.flatMidpoint_=this.getCoordinateAt(.5,this.flatMidpoint_??void 0),this.flatMidpointRevision_=this.getRevision()),this.flatMidpoint_}getSimplifiedGeometryInternal(t){const e=[];return e.length=Ki(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,0),new Ob(e,"XY")}getType(){return"LineString"}intersectsExtent(t){return pn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=qi(this.flatCoordinates,0,t,this.stride),this.changed()}}const Nb=Ob;class Bb extends Ui{constructor(t,e){super(),e&&!Array.isArray(t[0])?this.setFlatCoordinates(e,t):this.setCoordinates(t,e)}appendPoint(t){c(this.flatCoordinates,t.getFlatCoordinates()),this.changed()}clone(){const t=new Bb(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(t,e,i,n){if(n<st(this.getExtent(),t,e))return n;const r=this.flatCoordinates,s=this.stride;for(let o=0,a=r.length;o<a;o+=s){const a=Zt(t,e,r[o],r[o+1]);if(a<n){n=a;for(let t=0;t<s;++t)i[t]=r[o+t];i.length=s}}return n}getCoordinates(){return tn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getPoint(t){const e=this.flatCoordinates.length/this.stride;return t<0||e<=t?null:new ln(this.flatCoordinates.slice(t*this.stride,(t+1)*this.stride),this.layout)}getPoints(){const t=this.flatCoordinates,e=this.layout,i=this.stride,n=[];for(let r=0,s=t.length;r<s;r+=i){const s=new ln(t.slice(r,r+i),e);n.push(s)}return n}getType(){return"MultiPoint"}intersectsExtent(t){const e=this.flatCoordinates,i=this.stride;for(let n=0,r=e.length;n<r;n+=i)if(ht(t,e[n],e[n+1]))return!0;return!1}setCoordinates(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=qi(this.flatCoordinates,0,t,this.stride),this.changed()}}const zb=Bb;class Ub extends Ui{constructor(t,e,i){if(super(),this.ends_=[],this.maxDelta_=-1,this.maxDeltaRevision_=-1,Array.isArray(t[0]))this.setCoordinates(t,e);else if(void 0!==e&&i)this.setFlatCoordinates(e,t),this.ends_=i;else{const e=t,i=[],n=[];for(let t=0,r=e.length;t<r;++t)c(i,e[t].getFlatCoordinates()),n.push(i.length);const r=0===e.length?this.getLayout():e[0].getLayout();this.setFlatCoordinates(r,i),this.ends_=n}}appendLineString(t){c(this.flatCoordinates,t.getFlatCoordinates().slice()),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const t=new Ub(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return t.applyProperties(this),t}closestPointXY(t,e,i,n){return n<st(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Xi(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),ji(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!1,t,e,i,n))}getCoordinateAtM(t,e,i){return"XYM"!=this.layout&&"XYZM"!=this.layout||0===this.flatCoordinates.length?null:(e=void 0!==e&&e,i=void 0!==i&&i,function(t,e,i,n,r,s,o){if(o)return Sb(t,e,i[i.length-1],n,r,s);let a;if(r<t[n-1])return s?(a=t.slice(0,n),a[n-1]=r,a):null;if(t[t.length-1]<r)return s?(a=t.slice(t.length-n),a[n-1]=r,a):null;for(let s=0,o=i.length;s<o;++s){const o=i[s];if(e!=o){if(r<t[e+n-1])return null;if(r<=t[o-1])return Sb(t,e,o,n,r,!1);e=o}}return null}(this.flatCoordinates,0,this.ends_,this.stride,t,e,i))}getCoordinates(){return en(this.flatCoordinates,0,this.ends_,this.stride)}getEnds(){return this.ends_}getLineString(t){return t<0||this.ends_.length<=t?null:new Nb(this.flatCoordinates.slice(0===t?0:this.ends_[t-1],this.ends_[t]),this.layout)}getLineStrings(){const t=this.flatCoordinates,e=this.ends_,i=this.layout,n=[];let r=0;for(let s=0,o=e.length;s<o;++s){const o=e[s],a=new Nb(t.slice(r,o),i);n.push(a),r=o}return n}getFlatMidpoints(){const t=[],e=this.flatCoordinates;let i=0;const n=this.ends_,r=this.stride;for(let s=0,o=n.length;s<o;++s){const o=n[s];c(t,Eb(e,i,o,r,.5)),i=o}return t}getSimplifiedGeometryInternal(t){const e=[],i=[];return e.length=Hi(this.flatCoordinates,0,this.ends_,this.stride,t,e,0,i),new Ub(e,"XY",i)}getType(){return"MultiLineString"}intersectsExtent(t){return function(t,e,i,n,r){for(let s=0,o=i.length;s<o;++s){if(pn(t,e,i[s],n,r))return!0;e=i[s]}return!1}(this.flatCoordinates,0,this.ends_,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);const i=Wi(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=0===i.length?0:i[i.length-1],this.changed()}}const Gb=Ub;class Yb extends Ui{constructor(t,e,i){if(super(),this.endss_=[],this.flatInteriorPointsRevision_=-1,this.flatInteriorPoints_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,!i&&!Array.isArray(t[0])){const n=t,r=[],s=[];for(let t=0,e=n.length;t<e;++t){const e=n[t],i=r.length,o=e.getEnds();for(let t=0,e=o.length;t<e;++t)o[t]+=i;c(r,e.getFlatCoordinates()),s.push(o)}e=0===n.length?this.getLayout():n[0].getLayout(),t=r,i=s}void 0!==e&&i?(this.setFlatCoordinates(e,t),this.endss_=i):this.setCoordinates(t,e)}appendPolygon(t){let e;if(this.flatCoordinates){const i=this.flatCoordinates.length;c(this.flatCoordinates,t.getFlatCoordinates()),e=t.getEnds().slice();for(let t=0,n=e.length;t<n;++t)e[t]+=i}else this.flatCoordinates=t.getFlatCoordinates().slice(),e=t.getEnds().slice(),this.endss_.push();this.endss_.push(e),this.changed()}clone(){const t=this.endss_.length,e=new Array(t);for(let i=0;i<t;++i)e[i]=this.endss_[i].slice();const i=new Yb(this.flatCoordinates.slice(),this.layout,e);return i.applyProperties(this),i}closestPointXY(t,e,i,n){return n<st(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(function(t,e,i,n,r){for(let s=0,o=i.length;s<o;++s){const o=i[s];r=Xi(t,e,o,n,r),e=o[o.length-1]}return r}(this.flatCoordinates,0,this.endss_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),function(t,e,i,n,r,s,o,a,h,l,c){c=c||[NaN,NaN];for(let s=0,u=i.length;s<u;++s){const u=i[s];l=ji(t,e,u,n,r,true,o,a,h,l,c),e=u[u.length-1]}return l}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,this.maxDelta_,0,t,e,i,n))}containsXY(t,e){return function(t,e,i,n,r,s){if(0===i.length)return!1;for(let o=0,a=i.length;o<a;++o){const a=i[o];if(dn(t,e,a,n,r,s))return!0;e=a[a.length-1]}return!1}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t,e)}getArea(){return function(t,e,i,n){let r=0;for(let s=0,o=i.length;s<o;++s){const o=i[s];r+=sn(t,e,o,n),e=o[o.length-1]}return r}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride)}getCoordinates(t){let e;return void 0!==t?(e=this.getOrientedFlatCoordinates().slice(),En(e,0,this.endss_,this.stride,t)):e=this.flatCoordinates,nn(e,0,this.endss_,this.stride)}getEndss(){return this.endss_}getFlatInteriorPoints(){if(this.flatInteriorPointsRevision_!=this.getRevision()){const t=kb(this.flatCoordinates,0,this.endss_,this.stride);this.flatInteriorPoints_=gn(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t),this.flatInteriorPointsRevision_=this.getRevision()}return this.flatInteriorPoints_}getInteriorPoints(){return new zb(this.getFlatInteriorPoints().slice(),"XYM")}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const t=this.flatCoordinates;xn(t,0,this.endss_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=En(this.orientedFlatCoordinates_,0,this.endss_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(t){const e=[],i=[];return e.length=function(t,e,i,n,r,s,o,a){for(let h=0,l=i.length;h<l;++h){const l=i[h],c=[];o=Qi(t,e,l,n,r,s,o,c),a.push(c),e=l[l.length-1]}return o}(this.flatCoordinates,0,this.endss_,this.stride,Math.sqrt(t),e,0,i),new Yb(e,"XY",i)}getPolygon(t){if(t<0||this.endss_.length<=t)return null;let e;if(0===t)e=0;else{const i=this.endss_[t-1];e=i[i.length-1]}const i=this.endss_[t].slice(),n=i[i.length-1];if(0!==e)for(let t=0,n=i.length;t<n;++t)i[t]-=e;return new kn(this.flatCoordinates.slice(e,n),this.layout,i)}getPolygons(){const t=this.layout,e=this.flatCoordinates,i=this.endss_,n=[];let r=0;for(let s=0,o=i.length;s<o;++s){const o=i[s].slice(),a=o[o.length-1];if(0!==r)for(let t=0,e=o.length;t<e;++t)o[t]-=r;const h=new kn(e.slice(r,a),t,o);n.push(h),r=a}return n}getType(){return"MultiPolygon"}intersectsExtent(t){return function(t,e,i,n,r){for(let s=0,o=i.length;s<o;++s){const o=i[s];if(wn(t,e,o,n,r))return!0;e=o[o.length-1]}return!1}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,3),this.flatCoordinates||(this.flatCoordinates=[]);const i=Zi(this.flatCoordinates,0,t,this.stride,this.endss_);if(0===i.length)this.flatCoordinates.length=0;else{const t=i[i.length-1];this.flatCoordinates.length=0===t.length?0:t[t.length-1]}this.changed()}}const Xb=Yb;class Vb extends Ni{constructor(t){super(),this.geometries_=t||null,this.changeEventsKeys_=[],this.listenGeometriesChange_()}unlistenGeometriesChange_(){this.changeEventsKeys_.forEach(I),this.changeEventsKeys_.length=0}listenGeometriesChange_(){if(this.geometries_)for(let t=0,e=this.geometries_.length;t<e;++t)this.changeEventsKeys_.push(k(this.geometries_[t],y,this.changed,this))}clone(){const t=new Vb(null);return t.setGeometries(this.geometries_),t.applyProperties(this),t}closestPointXY(t,e,i,n){if(n<st(this.getExtent(),t,e))return n;const r=this.geometries_;for(let s=0,o=r.length;s<o;++s)n=r[s].closestPointXY(t,e,i,n);return n}containsXY(t,e){const i=this.geometries_;for(let n=0,r=i.length;n<r;++n)if(i[n].containsXY(t,e))return!0;return!1}computeExtent(t){ut(t);const e=this.geometries_;for(let i=0,n=e.length;i<n;++i)mt(t,e[i].getExtent());return t}getGeometries(){return jb(this.geometries_)}getGeometriesArray(){return this.geometries_}getGeometriesArrayRecursive(){let t=[];const e=this.geometries_;for(let i=0,n=e.length;i<n;++i)e[i].getType()===this.getType()?t=t.concat(e[i].getGeometriesArrayRecursive()):t.push(e[i]);return t}getSimplifiedGeometry(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&t<this.simplifiedGeometryMaxMinSquaredTolerance)return this;const e=[],i=this.geometries_;let n=!1;for(let r=0,s=i.length;r<s;++r){const s=i[r],o=s.getSimplifiedGeometry(t);e.push(o),o!==s&&(n=!0)}if(n){const t=new Vb(null);return t.setGeometriesArray(e),t}return this.simplifiedGeometryMaxMinSquaredTolerance=t,this}getType(){return"GeometryCollection"}intersectsExtent(t){const e=this.geometries_;for(let i=0,n=e.length;i<n;++i)if(e[i].intersectsExtent(t))return!0;return!1}isEmpty(){return 0===this.geometries_.length}rotate(t,e){const i=this.geometries_;for(let n=0,r=i.length;n<r;++n)i[n].rotate(t,e);this.changed()}scale(t,e,i){i||(i=Mt(this.getExtent()));const n=this.geometries_;for(let r=0,s=n.length;r<s;++r)n[r].scale(t,e,i);this.changed()}setGeometries(t){this.setGeometriesArray(jb(t))}setGeometriesArray(t){this.unlistenGeometriesChange_(),this.geometries_=t,this.listenGeometriesChange_(),this.changed()}applyTransform(t){const e=this.geometries_;for(let i=0,n=e.length;i<n;++i)e[i].applyTransform(t);this.changed()}translate(t,e){const i=this.geometries_;for(let n=0,r=i.length;n<r;++n)i[n].translate(t,e);this.changed()}disposeInternal(){this.unlistenGeometriesChange_(),super.disposeInternal()}}function jb(t){const e=[];for(let i=0,n=t.length;i<n;++i)e.push(t[i].clone());return e}const qb=Vb,Wb=class{constructor(){this.dataProjection=void 0,this.defaultFeatureProjection=void 0,this.featureClass=py,this.supportedMediaTypes=null}getReadOptions(t,e){if(e){let i=e.dataProjection?si(e.dataProjection):this.readProjection(t);e.extent&&i&&"tile-pixels"===i.getUnits()&&(i=si(i),i.setWorldExtent(e.extent)),e={dataProjection:i,featureProjection:e.featureProjection}}return this.adaptOptions(e)}adaptOptions(t){return Object.assign({dataProjection:this.dataProjection,featureProjection:this.defaultFeatureProjection,featureClass:this.featureClass},t)}getType(){return R()}readFeature(t,e){return R()}readFeatures(t,e){return R()}readGeometry(t,e){return R()}readProjection(t){return R()}writeFeature(t,e){return R()}writeFeatures(t,e){return R()}writeGeometry(t,e){return R()}};function Zb(t,e,i){const n=i?si(i.featureProjection):null,r=i?si(i.dataProjection):null;let s=t;if(n&&r&&!li(n,r)){e&&(s=t.clone());const i=e?n:r,o=e?r:n;"tile-pixels"===i.getUnits()?s.transform(i,o):s.applyTransform(ui(i,o))}if(e&&i&&void 0!==i.decimals){const e=Math.pow(10,i.decimals),n=function(t){for(let i=0,n=t.length;i<n;++i)t[i]=Math.round(t[i]*e)/e;return t};s===t&&(s=t.clone()),s.applyTransform(n)}return s}const Kb={Point:ln,LineString:Nb,Polygon:kn,MultiPoint:zb,MultiLineString:Gb,MultiPolygon:Xb};function Hb(t,e){const i=t.geometry;if(!i)return[];if(Array.isArray(i))return i.map((e=>Hb({...t,geometry:e}))).flat();const n="MultiPolygon"===i.type?"Polygon":i.type;if("GeometryCollection"===n||"Circle"===n)throw new Error("Unsupported geometry type: "+n);const r=i.layout.length;return Zb(new Ab(n,"Polygon"===n?function(t,e,i){return Array.isArray(e[0])?(xn(t,0,e,i)||En(t=t.slice(),0,e,i),t):(bn(t,0,e,i)||Mn(t=t.slice(),0,e,i),t)}(i.flatCoordinates,i.ends,r):i.flatCoordinates,i.ends?.flat(),r,t.properties||{},t.id).enableSimplifyTransformed(),!1,e)}function $b(t,e){if(!t)return null;if(Array.isArray(t)){const i=t.map((t=>$b(t,e)));return new qb(i)}return Zb(new(0,Kb[t.type])(t.flatCoordinates,t.layout,t.ends),!1,e)}function Jb(t){if("string"==typeof t){return JSON.parse(t)||null}return null!==t?t:null}const Qb=class extends Wb{constructor(){super()}getType(){return"json"}readFeature(t,e){return this.readFeatureFromObject(Jb(t),this.getReadOptions(t,e))}readFeatures(t,e){return this.readFeaturesFromObject(Jb(t),this.getReadOptions(t,e))}readFeatureFromObject(t,e){return R()}readFeaturesFromObject(t,e){return R()}readGeometry(t,e){return this.readGeometryFromObject(Jb(t),this.getReadOptions(t,e))}readGeometryFromObject(t,e){return R()}readProjection(t){return this.readProjectionFromObject(Jb(t))}readProjectionFromObject(t){return R()}writeFeature(t,e){return JSON.stringify(this.writeFeatureObject(t,e))}writeFeatureObject(t,e){return R()}writeFeatures(t,e){return JSON.stringify(this.writeFeaturesObject(t,e))}writeFeaturesObject(t,e){return R()}writeGeometry(t,e){return JSON.stringify(this.writeGeometryObject(t,e))}writeGeometryObject(t,e){return R()}};function tx(t,e){if(!t)return null;let i;switch(t.type){case"Point":i=function(t){const e=t.coordinates;return{type:"Point",flatCoordinates:e,layout:Bi(e.length)}}(t);break;case"LineString":i=function(t){const e=t.coordinates,i=e.flat();return{type:"LineString",flatCoordinates:i,ends:[i.length],layout:Bi(e[0].length)}}(t);break;case"Polygon":i=function(t){const e=t.coordinates,i=[],n=e[0][0].length;return{type:"Polygon",flatCoordinates:i,ends:Wi(i,0,e,n),layout:Bi(n)}}(t);break;case"MultiPoint":i=function(t){const e=t.coordinates;return{type:"MultiPoint",flatCoordinates:e.flat(),layout:Bi(e[0].length)}}(t);break;case"MultiLineString":i=function(t){const e=t.coordinates,i=e[0][0].length,n=[];return{type:"MultiLineString",flatCoordinates:n,ends:Wi(n,0,e,i),layout:Bi(i)}}(t);break;case"MultiPolygon":i=function(t){const e=t.coordinates,i=[],n=e[0][0][0].length;return{type:"MultiPolygon",flatCoordinates:i,ends:Zi(i,0,e,n),layout:Bi(n)}}(t);break;case"GeometryCollection":i=function(t,e){const i=t.geometries.map((function(t){return tx(t)}));return i}(t);break;default:throw new Error("Unsupported GeoJSON type: "+t.type)}return i}function ex(t,e){const i=(t=Zb(t,!0,e)).getType();let n;switch(i){case"Point":n=function(t,e){return{type:"Point",coordinates:t.getCoordinates()}}(t);break;case"LineString":n=function(t,e){return{type:"LineString",coordinates:t.getCoordinates()}}(t);break;case"Polygon":n=function(t,e){let i;return e&&(i=e.rightHanded),{type:"Polygon",coordinates:t.getCoordinates(i)}}(t,e);break;case"MultiPoint":n=function(t,e){return{type:"MultiPoint",coordinates:t.getCoordinates()}}(t);break;case"MultiLineString":n=function(t,e){return{type:"MultiLineString",coordinates:t.getCoordinates()}}(t);break;case"MultiPolygon":n=function(t,e){let i;return e&&(i=e.rightHanded),{type:"MultiPolygon",coordinates:t.getCoordinates(i)}}(t,e);break;case"GeometryCollection":n=function(t,e){delete(e=Object.assign({},e)).featureProjection;return{type:"GeometryCollection",geometries:t.getGeometriesArray().map((function(t){return ex(t,e)}))}}(t,e);break;case"Circle":n={type:"GeometryCollection",geometries:[]};break;default:throw new Error("Unsupported geometry type: "+i)}return n}const ix=class extends Qb{constructor(t){t=t||{},super(),this.dataProjection=si(t.dataProjection?t.dataProjection:"EPSG:4326"),t.featureProjection&&(this.defaultFeatureProjection=si(t.featureProjection)),t.featureClass&&(this.featureClass=t.featureClass),this.geometryName_=t.geometryName,this.extractGeometryName_=t.extractGeometryName,this.supportedMediaTypes=["application/geo+json","application/vnd.geo+json"]}readFeatureFromObject(t,e){let i=null;i="Feature"===t.type?t:{type:"Feature",geometry:t,properties:null};const n=tx(i.geometry);if(this.featureClass===Ab)return Hb({geometry:n,id:i.id,properties:i.properties},e);const r=new py;return this.geometryName_?r.setGeometryName(this.geometryName_):this.extractGeometryName_&&"geometry_name"in i!==void 0&&r.setGeometryName(i.geometry_name),r.setGeometry($b(n,e)),"id"in i&&r.setId(i.id),i.properties&&r.setProperties(i.properties,!0),r}readFeaturesFromObject(t,e){let i=null;if("FeatureCollection"===t.type){i=[];const n=t.features;for(let t=0,r=n.length;t<r;++t){const r=this.readFeatureFromObject(n[t],e);r&&i.push(r)}}else i=[this.readFeatureFromObject(t,e)];return i.flat()}readGeometryFromObject(t,e){return function(t,e){return $b(tx(t),e)}(t,e)}readProjectionFromObject(t){const e=t.crs;let i;if(e)if("name"==e.type)i=si(e.properties.name);else{if("EPSG"!==e.type)throw new Error("Unknown SRS type");i=si("EPSG:"+e.properties.code)}else i=this.dataProjection;return i}writeFeatureObject(t,e){e=this.adaptOptions(e);const i={type:"Feature",geometry:null,properties:null},n=t.getId();if(void 0!==n&&(i.id=n),!t.hasProperties())return i;const r=t.getProperties(),s=t.getGeometry();return s&&(i.geometry=ex(s,e),delete r[t.getGeometryName()]),_(r)||(i.properties=r),i}writeFeaturesObject(t,e){e=this.adaptOptions(e);const i=[];for(let n=0,r=t.length;n<r;++n)i.push(this.writeFeatureObject(t[n],e));return{type:"FeatureCollection",features:i}}writeGeometryObject(t,e){return ex(t,this.adaptOptions(e))}};function nx(t){const e=new Lb({features:new ix({dataProjection:"EPSG:3857"}).readFeatures(t)});let i=new xb;if("lines"===t.name){let t=[];e.forEachFeature((e=>{let i=e.getGeometry();console.log(i.getFlatCoordinates().length,"bfor");let n=i.simplify(3);console.log(n.getFlatCoordinates().length,"after");let r=new py({geometry:n});t.push(r)}));let n=new Lb({features:t});i.setSource(n)}else i.setSource(e);return"junctions"===t.name&&i.setStyle(new Style({image:new Icon({src:"https://maps.google.com/mapfiles/kml/paddle/red-blank.png",anchor:[.5,1],scale:.5})})),i}let rx=new class{constructor(){let t=new ay;this.OSM_Standard=new ry,this.Bing_RoadsOnDemand=new sy({key:t.apikeys.BingMapKey,imagerySet:"RoadOnDemand"}),this.ArcGIS_sample=new oy({url:`https://basemapstyles-api.arcgis.com/arcgis/rest/services/styles/v2/styles/arcgis/streets?token=${t.apikeys.ArcGISKey}`,crossOrigin:"Anonymous"}),this.EsriXYZ=new ny({attributions:'Tiles © <a href="https://services.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer">ArcGIS</a>',url:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer/tile/{z}/{y}/{x}",maxZoom:19,crossOrigin:"Anonymous"}),this.EsriMaps=new ny({url:"https://services.arcgisonline.com/arcgis/rest/services/World_Topo_Map/MapServer/MapServer/tile/{z}/{y}/{x}"})}};const sx=document.getElementById("imgCanvas1"),ox=document.getElementById("imgCanvas2"),ax=sx.getContext("2d",{willReadFrequently:!0}),hx=ox.getContext("2d",{willReadFrequently:!0});var lx=document.createElement("canvas"),cx=document.createElement("canvas");lx.getContext("2d"),cx.getContext("2d"),new vw,new vw;const ux=document.getElementById("processImgBtn"),dx=document.getElementById("vectorizeBtn"),fx=(document.getElementById("compareBtn"),document.getElementById("downloadVector")),gx=document.getElementById("imageCov"),mx=document.getElementById("extentBox"),px=document.getElementById("zoomLevel"),_x=document.getElementById("FeatureType"),wx=document.getElementById("MapType1"),yx=document.getElementById("MapType2"),vx=document.getElementById("processOptions");let bx,xx,Mx,Ex,Sx,kx,Cx,Ix,Ax=!1,Tx=!1,Rx=!1,Px=!1,Dx=!1,Fx=!1,Lx=!1;_x.addEventListener("change",(t=>{"1"===_x.value?(dy(vx),Lx=!1):"2"===_x.value||"3"===_x.value&&!1===Lx&&(kx=function(t){document.createElement("br");let e=document.createElement("div");e.style.width="300px",e.style.background="white";let i=document.createElement("h3");i.className="h3",i.textContent="Enter parameters for Map 1";let n=document.createElement("h3");n.className="h3",n.textContent="Enter parameters for Map 2";let r=uy("Kernel Size",cy.erodeKernelSize),s=uy("Num of Iterations",cy.erodeIterations),o=uy("Kernel Size",cy.erodeKernelSize),a=uy("Num of Iterations",cy.erodeIterations);return cy.saveDefaults(),e.append(i,r[0],s[0],n,o[0],a[0]),t.append(e),[r[1],s[1],o[1],a[1]]}(vx),console.log(kx,"lp"),Lx=!0)})),ux.addEventListener("click",(t=>{if("1"===_x.value)alert("Choose a feature type from drop down");else if("2"===_x.value){if(!0===Ax){let t=ax.getImageData(0,0,sx.width,sx.height);bx=io(t,sx),Rx=!0}if(!0===Tx){let t=hx.getImageData(0,0,ox.width,ox.height);xx=io(t,ox),Px=!0}}else if("3"===_x.value){if(!0===Ax){let t=ax.getImageData(0,0,sx.width,sx.height);Mx=function(t,e,i){let n=function(t,e,i){let n=cv.matFromImageData(t);console.log(n);let r=new cv.Mat,s=cv.Mat.ones(e,e,cv.CV_8U),o=new cv.Point(-1,-1);return cv.erode(n,r,s,o,i,cv.BORDER_CONSTANT,cv.morphologyDefaultBorderValue()),n.delete(),s.delete(),r}(t,e,i),r=no(t),s=new Uint8ClampedArray(n.data.length);for(let t=0,e=0;n.data.length,e<r.data.length;t+=4,e++)s[t]=n.data[t],s[t+1]=r.data[e],s[t+3]=255;return new ImageData(s,300,300)}(t,parseInt(kx[0]),parseInt(kx[1])),console.log(kx),Rx=!0,ax.putImageData(Mx,0,0)}!0===Tx&&hx.getImageData(0,0,ox.width,ox.height)}})),dx.addEventListener("click",(t=>{if("2"===_x.value){if(!0===Rx){let t=Cx.getView().calculateExtent(Cx.getSize());Ex=Pw(bx,sx.width,sx.height,t),Dx=!0;let e=nx(Ex);Cx.addLayer(e),Rx=!1,console.log(Cx.getLayers())}else alert("Process image from map1 before vectorizing");if(!0===Px){let t=Ix.getView().calculateExtent(Ix.getSize());Sx=Pw(xx,ox.width,ox.height,t),Fx=!0;let e=nx(Sx);Cx.addLayer(e),Px=!1}}else if("3"===_x.value)if(!0===Rx){let t=Cx.getView().calculateExtent(Cx.getSize()),e=function(t,e,i,n){let r,s=[],o=!0,a=[],h=[],l=0,c=[],u=[],d=(n[2]-n[0])/e,f=(n[3]-n[1])/i;for(let e=0;e<t.length;e+=4)s.push(t[e]),c.push(t[e+1]);for(let t=0;t<s.length;t++)if(255===s[t]){let i=t%e,n=Math.floor(t/e);t:for(let r=25;r<=31;r+=2){let o=[],a=r,h=0,l=gy(r);for(let t=0-Math.floor(a/2);t<=Math.floor(a/2);t++){let r,s;for(let h=0-Math.floor(a/2);h<=Math.floor(a/2);h++){r=i+t,s=n+h;let a=s*e+r;o.push(c[a])}}for(let t=0;t<r;t++)for(let e=0;e<r;e++)l[t][e]*o[t*r+e]==255&&(h+=1);if(h>=8){u.push(t),s[t]=0;break t}}}let g=new Uint8ClampedArray(t.length);for(let t=0,e=0;t<g.length;t+=4,e++)g[t]=s[e],g[t+1]=0,g[t+2]=0,g[t+3]=255;let m=new ImageData(g,e,i),p=0;for(let t=0;t<s.length;t++)255===s[t]&&(p+=1);function _(){let t;for(let i=0;i<s.length;i++)if(255===s[i]){t=[i%e,Math.floor(i/e)];break}return t}function w(t){a.push(t),console.log(t,"ip");for(let t=0;t<p&&void 0!==a[t];t++){let i=a[t][0],n=a[t][1],r=n*e+i,o=fy([i,n],3),h=[];for(let t=0;t<o.length;t++){let i,n=o[t][0],a=o[t][1];n>=0&&a>=0&&(i=a*e+n),255===s[i]&&(h.push([n,a]),s[r]=0)}for(let t=0;t<h.length;t++){let e=!1;for(let i=0;i<a.length;i++){if(h[t][0]===a[i][0]&&h[t][1]===a[i][1]){e=!0;break}e=!1}!1===e&&a.push(h[t])}}console.log(a,"la"),a.length>=30?(h.push(a),l+=1,a=[]):a=[]}for(;o;){if(r=_(),void 0===r){o=!1;break}w(r)}let y=function(t,e,i,n,r){let s={type:"FeatureCollection",name:"junctions",crs:{type:"name",properties:{name:"EPSG:3857"}},features:[]},o=new Array(t.length);for(let s in t){let a=t[s]%e,h=Math.floor(t[s]/e),l=i[0]+a*n,c=i[3]-h*r;o[s]={x:l,y:c}}let a=(0,Fw.b)().eps(10).minPts(1).distance("EUCLIDEAN").data(o),h=(a(),a.getClusters());for(let t=0;t<h.length;t++){let e=[h[t].x,h[t].y];s.features.push({type:"Feature",geometry:{type:"Point",coordinates:e},proprties:{prop:""}})}return s}(u,e,n,d,f),v=function(t,e,i,n,r){let s={type:"FeatureCollection",name:"lines",crs:{type:"name",properties:{name:"EPSG:3857"}},features:[]};for(let e=0;e<t.length;e++){let o=[];for(let s=0;s<t[e].length;s+=3){let a=t[e][s][0],h=t[e][s][1],l=[i[0]+a*n,i[3]-h*r];o.push(l)}s.features.push({type:"Feature",geometry:{type:"LineString",coordinates:o},proprties:{prop:""}})}return s}(h,0,n,d,f);return console.log(l,v,"jjffj"),[y,v,m]}(Mx.data,300,300,t);Ex=e[0],Dx=!0;let i=nx(e[1]);Cx.addLayer(i),ax.putImageData(e[2],0,0),Rx=!1,dy(vx),Lx=!1}else alert("Process image from map1 before vectorizing")})),fx.addEventListener("click",(t=>{var e,i;!0===Dx?(e=JSON.stringify(Ex),(i=document.createElement("a")).setAttribute("href","data:application/json;charset=utf-8, "+encodeURIComponent(e)),i.setAttribute("download","layer.geojson"),document.body.appendChild(i),i.click(),document.body.removeChild(i)):alert("Generate vector file before downloading")})),gx.addEventListener("click",(t=>{if(!0===Ax&&!0===Ax){let t=ax.getImageData(0,0,sx.width,sx.height),e=hx.getImageData(0,0,ox.width,ox.height);no(t),no(e);let i=ax.getImageData(0,0,sx.width,sx.height),n=hx.getImageData(0,0,ox.width,ox.height);console.log(i,n),function(t,e){let i=bl(t.data),n=bl(e.data),r=new Array(i.length),s=new Array(n.length);for(let t=0;t<i.length;t++)i[t][0]&&i[t][1]&&255===i[t][2]?r[t]=255:r[t]=0;for(let t=0;t<n.length;t++)n[t][0]&&n[t][1]&&255===n[t][2]?s[t]=255:s[t]=0;let o=[r,s],a=o.length,h=new Array(a*a);for(let t=0;t<a;t++)for(let e=0;e<a;e++){let i=0,n=o[t],r=o[e],s=n.length,a=n.reduce(((t,e)=>t+e))/s,l=r.reduce(((t,e)=>t+e))/s;for(let t=0;t<s;t++)i+=(n[t]-a)*(r[t]-l)/s;h.push(i)}let l=Math.min(...h),c=Math.max(...h);console.log(l,c,h)}(i,n)}else alert("Select features from both maps")}));let Ox={1:rx.OSM_Standard,2:rx.Bing_RoadsOnDemand,3:rx.EsriXYZ,4:rx.ArcGIS_sample,5:rx.EsriMaps};!function(t,e){const i=new Rn({center:[8687373.06,3544749.53],zoom:13,constrainResolution:!0});Cx=new ws({layers:[new zs({source:t})],view:i,target:"map1"}),Ix=new ws({layers:[new zs({source:e})],view:i,target:"map2"}),mx.textContent="Extent: "+Cx.getView().calculateExtent(Cx.getSize()),px.textContent="Zoom Level: "+Cx.getView().getZoom(),Cx.on("moveend",(t=>{hy(Cx,sx,ax),!0===Dx&&(bx=void 0,Ex=void 0,Dx=!1),mx.textContent="Extent: "+Cx.getView().calculateExtent(Cx.getSize()),px.textContent="Zoom Level: "+Cx.getView().getZoom()})),Ix.on("moveend",(t=>{hy(Ix,ox,hx),!0===Fx&&(xx=void 0,Sx=void 0,Fx=!1)})),Cx.on("click",(t=>{let e=ax.getImageData(0,0,sx.width,sx.height);console.log(xl(t.pixel,e.data,300));let i=Iw(e,xl(t.pixel,e.data,300),0);ax.putImageData(i,0,0),Ax=!0})),Ix.on("click",(t=>{let e=hx.getImageData(0,0,ox.width,ox.height),i=Iw(e,xl(t.pixel,e.data,300),0);hx.putImageData(i,0,0),Tx=!0}))}(Ox[1],Ox[2]),wx.addEventListener("change",(t=>{})),yx.addEventListener("change",(t=>{}))})()})();